
## Lesson 7.3. Handling external files 
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## In this lesson you will learn the following concepts
<a name="this_lesson_you_will_learn_the_following_concepts_ELTTEXTE000249"></a>


- Handling text files (CSV, etc.).

- Handling directories.

- Handling XML files.

- Handling XLS files.





|   |   |
| --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=3&name=dur%E9e.png)<br> | <br>Estimated time: 20 mn |

| [Previous Lesson](../TutoWD/1410087549.md) | [Table of contents](../TutoWD/1410087560.md) | [Next Lesson](../TutoWD/1410087551.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Overview
<a name="overview_ELTTEXTE000296"></a>
WINDEV allows you to easily handle the most common data formats: 

- text files (INI, CSV, etc.),  

- XML files,

- XLS files, etc. 


Several families of WLanguage functions can be used to read and create these files. This allows you to easily read data generated by another software in your WINDEV applications or create files that require a specific formatting.

Furthermore, you can use multiple WLanguage functions to handle the directories containing the files.

In this chapter, we will focus on:

- Text files (text files, INI files and CSV files),

- XML files,

- XLS files,

- the management of directories.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Handling text or CSV files
<a name="handling_text_csv_files_ELTTEXTE000320"></a>


### Overview
<a name="overview_ELTPARAGRAPHE000047"></a>

External files are also called text files or files with direct access. These types of files usually contain text but they can also contain binary information such as images, sounds, etc.

In this lesson as in the entire WINDEV documentation, this will be referred to as **external files**.

WINDEV allows you to handle external files through programming. The WLanguage functions allow you to create, read and handle external files. All functions can easily be identified: they all start with the letter "f".

The notion of "record" does not necessarily exist in an external file. To handle an external file, you must know its structure, i.e. how the data is organized inside the file.

CSV files are text files that use a specific structure. Therefore, they can be handled like text files.

The .INI files are also text files that use a specific structure. To handle them, WINDEV includes two specific functions: [INIRead](../WDLang1/3013043.md) and [INIWrite](../WDLang1/3013039.md).
<a name="NOTE3_2"></a>


### Practical example
<a name="practical_example_ELTPARAGRAPHE000070"></a>

- Open the unit example named "Handling text files". 




- Test the "WIN_Text_File" window. This window groups the different operations that can be performed on the external files with WINDEV. 
![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=3&name=P7_Exemple%20Fichiers%20Texte%20-%20HC%20N%B0001.jpg&type=thumb)



The different buttons in the window allow you to:

- Create a text file.

- Read and write to a text file.

- Handle existing files (copy, delete, read information, etc.). 

- Copy a text file.




For more details on external file handling functions, see [Functions for handling directories and external files](../WDLang1/3036034.md).

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Handling directories
<a name="handling_directories_ELTTEXTE000350"></a>
WLanguage includes multiple functions to handle directories and files.
<a name="NOTE4_2"></a>


### Practical example
<a name="practical_example_ELTPARAGRAPHE000099"></a>

- Open the "Handling directories" unit example and test the corresponding window.




- This window groups the operations that can be performed on disks and directories:

	- create a directory,

	- get the current directory,

	- check the existence of a directory,

	- list directories,

	- copy and delete directories, etc.







For more details on directory handling functions, see [Functions for handling directories and external files](../WDLang1/3036034.md).

<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Handling XML files
<a name="handling_xml_files_ELTTEXTE000380"></a>


### Overview
<a name="overview_ELTPARAGRAPHE000121"></a>

XML (Extensible Markup Language) is a markup language, which means a language that presents information enclosed in tags. XML is a **metalanguage** used to invent new tags to isolate essential information a Web page may contain.

XML structures a document containing data. An HFSQL data file containing several items and records can be exported to an XML file for example (**XML\*** functions).

WINDEV supports:

- exporting files to XML ([TableToXML](../WDLang1/3074037.md), [TextToXML](../WDLang5/3081006.md), [HExportXML](../WDLang4/3044069.md)).

- importing XML data ([HImportXML](../WDLang4/3044007.md)).

- the use of an XML document via the advanced [XMLDocument](../WDLang5/1000018782.md) type and the WLanguage functions starting with XML.




The XML file can also be handled in the code editor directly. To do so:

1. Drag the XML file from the file explorer and drop it onto the "Project explorer" pane, in the "External descriptions" folder.

2. Drag the XML file from the "Project explorer" pane and drop it onto the code editor. The xmlDocument variable is automatically created as follows:
	
	```txt
	<Variable name> is xmlDocument, description =  <Document name>
	```


3. You can directly access the variable nodes by their names. These names are automatically proposed by the automatic completion mechanism of the code editor.



<a name="NOTE5_2"></a>


### Practical example
<a name="practical_example_ELTPARAGRAPHE000159"></a>

- Open the unit example named "Reading and writing in XML format". 




- Test the "WIN_HandleXML" window. This window is used to:

	- create an XML file. This file is created by the XML functions. 
![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=3&name=P7_Exemple%20fichier%20XML%20-%20HC%20N%B0001.jpg&type=thumb)


	- read an XML file.




- See the code associated with each button.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=3&name=note.png)<br> | Note | We won't go into details about all the features of the XML functions. <br>For more details, see [XML functions](../WDLang5/3081005.md). |





<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Handling XLS files
<a name="handling_xls_files_ELTTEXTE000428"></a>
To handle Excel files, WINDEV inclides:

- xlsXXX functions. These functions allow you to read the data in the different worksheets of an Excel file.

- advanced variables (xlsDocument, xlsRow, xlsColumn, xlsCell).



<a name="NOTE6_2"></a>


### Practical example
<a name="practical_example_ELTPARAGRAPHE000192"></a>

Let's quickly test these functions.



- To test the xlsXXX functions, open the unit example named "The Excel functions".




- Test the "WIN_XLSFunction" window. This window is used to:

	- import data from an Excel worksheet.

	- export data from a Table control to Excel.


 Go back to the editor to see the code of the different Button controls in the window.




- To test the advanced variables, open the unit example named "XLS type". 




- Test the "WIN_XLS_Type" window. 
![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=3&name=P7_Exemple%20fichier%20XLS%20-%20HC%20N%B0001.jpg&type=thumb)





- Go back to the editor to see the code of the different Button controls in the window.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=3&name=note.png)<br> | Note | We won't go into details about all the features of the XLS functions and the advanced types. <br>For more details, see [XLS file handling functions](../WDLang5/3080009.md). |





| [Previous Lesson](../TutoWD/1410087549.md) | [Table of contents](../TutoWD/1410087560.md) | [Next Lesson](../TutoWD/1410087551.md) |
| --- | --- | --- |




