
## sClose (Function)

***In french: sFerme***



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Closes the specified serial port, parallel port or infrared port.

**Remarks**: 

- A port must be closed as soon as it is no longer used.

- ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Infrared ports are not supported.

- ![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) Only serial ports are supported.  









<a name="Example1"></a>
<a name="sample_code"></a>

## Example


```wl
PortNum is int
PortNum = sOpen("COM1", 2000, 2000) // Open COM1
IF PortNum <> 0 THEN
	// Configure COM1: Rate 9600, even parity, 
	// 8 data bits, 1 stop bit
	sParameter(PortNum, 9600, 1, 8, 0)
	// Rest of process...
	sClose(PortNum) // Close COM1
ELSE
	Error("Error while opening COM1")
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Syntax

`sClose(<Port number>)`
---

**`<Port number>: (Integer)`**

Identifier of the port used: 

- Port number: 

	- Number of the serial port: 1, 2, 3, ... 32 for COM1, COM2, COM3, ... COM32.

	- Number of the parallel port: -1, -2, -3 or -4 for LPT1, LPT2, LPT3 or LPT4.

	- Number of the infrared port: 1, 2, 3, ... 32 for IR1, IR2, IR3, ... IR32.




- Port identifier returned by [sOpen](../WDLang3/3062013.md) (if this function was called with a port name). 
	![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) Only this type of parameter is available.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarks




### Closing the port after a read or write operation
<a name="closing_the_port_after_read_write_operation_ELTPARAGRAPHE000094"></a>

If **sClose** is run just after [sWrite](../WDLang3/3062009.md) ou [sRead](../WDLang3/3062012.md), some characters may not be written or read. Indeed, **sClose** can close the port before all the characters are written or read. To avoid this behavior, use [Multitask](../WDLang1/3015004.md).


```wl
Res = sOpen("COM2", 2000, 2000)
IF Res <> 0 THEN
	sParameter(Res, 9600, 0, 8, 0)
	sWrite(Res, Str)
	Multitask()
	sClose(Res)
END
```

![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) 

### Using an external library: RXTX
<a name="using_external_library_rxtx_ELTPARAGRAPHE000254"></a>

In Java, the use of functions for handling the serial and parallel ports ([sOpen](../WDLang3/3062013.md), [sWrite](../WDLang3/3062009.md), [sRead](../WDLang3/3062012.md), ...) requires the presence of an external library: RXTX. 

This library includes a Jar archive and one or more native libraries that depend on the operating system on which the application is run.
 
To use these functions: 

- the Jar archive (RXTXComm.jar) must: 

	- be found in the same directory as the Java application generated by WINDEV, 

	- be found in the execution classpath of the application, 

	- be directly included in the generated application (from the wizard for Java generation). 




- the native libraries corresponding to the operating system on which the application is run must be found: 

	- in the same directory as the Java application generated by WINDEV, 

	- in the path of the application libraries (librarypath).







The RXTX library and its documentation can be downloaded from: [http://users.frii.com/jarvi/rxtx/index.html](http://users.frii.com/jarvi/rxtx/index.html) (link valid at the time this documentation was published). 

**Caution**: The management of infrared ports is not available in Java. 
<a name="NOTE0_3"></a>

<a name="XComponent"></a>

## Business / UI classification:
Business Logic
## Component:
wd280com.dll
