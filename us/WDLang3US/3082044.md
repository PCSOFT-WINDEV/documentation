


## zipOpen (Function)

***In french: zipOuvre***



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Opens an existing archive. 

For the archives in "CAB" or "RAR" format, the archive is created if it does not exist. 

The archive can be:

- in WinZip or PKZip format (.ZIP extension).

- in WINDEV format (.WDZ extension).

- in Cabinet file format (.CAB extension).

- in RAR format (.RAR extension). 

- in 7z format (.7z extension). 

- in TAR format (.TAR extension). 

- in TGZ format (.TGZ extension). 

- in TAR.GZ format (.TAR.GZ extension). 

- an executable (.EXE) corresponding to a .WDZ file changed into a self-extracting archive. 







<a name="Example1"></a>
<a name="sample_code"></a>

## Example
<a class="notetitle" target="_blank" href="$DOC$=1000003082044&name=zipopen_function&product=WD">See additional examples</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![User code (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
```wl
MonArchive est un zipArchive
// Ouverture d'une archive
ResOuvreArchive = zipOuvre(MonArchive, "C:\MesArchives\Archive.zip")

// Affichage du message d'erreur si l'archive n'a pas été ouverte
SI ResOuvreArchive <> 0 ALORS
	Erreur(zipMsgErreur(ResOuvreArchive))
FIN
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Syntax

`<Result> = zipOpen(<Archive> , <Archive path> [, <Opening mode>])`
---

**`<Result>: (entier)`**



- 0 if the archive was opened,

- An error code (value greater than 0) otherwise. For more details on these error codes, see the [Remarks](#NOTE0_1).




**`<Archive>: (Character string or zipArchive variable)`**

Name of the archive to be used.
This name can correspond to:

- an archive name defined with [zipOpen](../WDLang3/3082044.md) or [zipCreate](../WDLang3/3082003.md).

- the name of a variable of type [zipArchive](../WDLang3/1000018679.md). 
	![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Variables of type [zipArchive](../WDLang3/1000018679.md) are not available in Java.




The archive is created if it does not exist (except for the "CAB" or "RAR" formats).  

**`<Archive path>: (Character string)`**

Path and name of archive (up to 260 characters). The archive extension can be specified. If the archive extension is not specified, the default extension is .WDZ.
![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) If the extension is not specified, the extension will be ".ZIP".![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) The archive path is a full path or a path relative to the working directory of the application (returned by [fDataDir](../WDLang1/3036001.md)). 

**`<Opening mode>: (Optional constant (or combination of constants))`**

Archive opening mode: 


|   |   |
| --- | --- |
| *zipCreateIfNotFound* | Creates the archive if it does not exist<br>(not available for .CAB and .RAR files) |
| *zipHeader64* | Allows you to create an archive larger than 4 GB on which [zipChangePath](../WDLang3/3082027.md) can be used.<br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) This constant is not available.<br><br>TAR or TGZ (TAR.GZ) archive: This constant is not available. |
| *zipRead* | Opening in read-only |
| *zipWrite* | Opening in read/write<br>(not available for .CAB and .RAR files) |


The default opening mode is: *zipCreateIfNotFound* + *zipWrite*.  
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) This parameter is not available: the opening mode used corresponds to *zipCreateIfNotFound* + *zipWrite*.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarks


### Error codes
<a name="error_codes_ELTPARAGRAPHE000218"></a>

The following error codes are returned:

- 1: The path passed as parameter does not exist.

- 2: Access denied: the user has no sufficient rights.

- 3: The archive is corrupted.

- 6: The files of the sub-archives are not arranged in order (when opening a multi-part archive).


The message corresponding to the error code is returned by [zipMsgError](../WDLang3/3082034.md).
Reminder: 

- ![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) Only ZIP, TAR and TGZ (TAR.GZ) archives are available.

- ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Only ZIP archives are available.







### Special case of the .GZ extension
<a name="special_case_the_extension_ELTPARAGRAPHE000244"></a>

'.tar.gz' files generated by GitHub should not be confused with compressed '.gz' files.
Content compressed in gzip format can be decompressed with [Uncompress](../WDLang1/3024009.md).

<a name="XComponent"></a>

## Business / UI classification:
Business Logic
## Component:
wd280zip.dll
