
## Handling RTF in an Edit control
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Rich Text Format
<a name="rich_text_format_ELTTEXTE000231"></a>
Rich Text Format (RTF) is used to encode text and simplify exchange between applications.

RTF is a "tag-based" format. In RTF, specific tags are used to specify the style of each word, group of words or sentences.

In WINDEV, you can handle RTF content via the "RTF" option of Edit and Static controls. 
You can also use the [RichEdit](../Proprietes/2510108.md) property to enable or disable RTF support for a given control.

- If the RTF text is displayed in a control that does not support RTF, the tags will be displayed.

- If the RTF content is displayed in a control that supports RTF, the tags will be automatically interpreted and the text will be formatted accordingly.




**Remark**: To use an RTF Edit control, the "RICHED20.DLL" file must be present on the current computer. In most cases, the "RICHED20.DLL" file is in the Windows system directory. If there is a more recent version of the RTF control on the computer, this version will be used.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## RTF Edit control
<a name="rtf_edit_control_ELTTEXTE000255"></a>
The RTF Edit control is used to display and edit RTF content.

The control automatically stores entered text as RTF. This text will contain all the necessary formatting tags.


### Remarks
<a name="remarks_ELTPARAGRAPHE000039"></a>

- An RTF toolbar can be displayed above the control. This toolbar allows the user to easily format the RTF text entered. For more details, see [RTF formatting toolbar](../WDChamp/9500104.md).

- In applications running on Windows Vista (or later), you can include the "Handwritten input" option. This option allows the user to directly write in the control using the mouse or a stylus. 

- A given string will be longer in an RTF Edit control than in a standard Edit control, because RTF tags are added.

- The RTF Edit control supports basic RTF, so it can be used on any platform. Specific characters such as page breaks, notes, ... are not supported.



<a name="NOTE2_2"></a>


### Supported RTF
<a name="supported_rtf_ELTPARAGRAPHE000052"></a>

The RTF file format supported is the same as the one supported by Wordpad. 

If the RTF file is generated by another tool (Word, etc.), it is recommended to open the file with Wordpad to check the RTF compatibility. The display of the file in Wordpad will provide a better preview of what will be printed.

In all cases, we recommend that you re-save the file in Wordpad to force RTF.

**Remark**: You also have the ability to force RTF with WINDEV or WEBDEV. To do so, use [RTFLoad](../WDLang1/3025041.md) to assign the RTF control.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Defining the initial content of an RTF edit control
<a name="defining_the_initial_content_rtf_edit_control_ELTTEXTE000291"></a>
To define the initial content of an RTF Edit control (solution 1): 

1. Go to the "Content" tab of the RTF Edit control description.

2. Type the content of the RTF control in "Initial content". To apply formatting to the text, display the formatting toolbar via the "RTF formatting toolbar" option in the context menu of "Initial content".

3. Validate the description window.



<a name="NOTE3_2"></a>
To define the initial content of an RTF Edit control (solution 2): 

1. Write the text and apply formatting in any RTF editor (Microsoft Word, WINDEV document editor, etc.).

2. Copy this text (Ctrl + C).

3. Go to the "Content" tab of the RTF Edit control description.

4. Paste the RTF content. The pasted text is displayed with its formatting.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Writing in an RTF Edit control programmatically (via RTF attributes)
<a name="writing_rtf_edit_control_programmatically_via_rtf_attributes_ELTTEXTE000321"></a>


### Using text attributes in an RTF Edit control
<a name="using_text_attributes_rtf_edit_control_ELTPARAGRAPHE000091"></a>

To use text attributes in an RTF Edit control: 

- select the text in the Edit control. The text selected by the user is highlighted by default. To select text, you can use the [Cursor](../Proprietes/2510025.md) and [CursorEnd](../Proprietes/2510047.md) properties, for example.

- use the [RTFSelection](../WDLang1/3025023.md) function. This function allows you to get and set the RTF attributes (bold, etc.) of a selection.




**Example: Applying bold formatting to the selected text**

The following code, which is used in the exit code of an RTF edit control, applies bold formatting to the selected text.


```wl
IF EDT_Edit1.CursorEnd > EDT_Edit1.Cursor THEN
	RTFSelection(EDT_Edit1, rtfBold, True)
END
```


<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Saving text in an RTF file
<a name="saving_text_rtf_file_ELTTEXTE000345"></a>
RTF formatting is automatically applied to the text entered in an RTF Edit control.

To save the content of an RTF Edit control to an RTF file:

1. Create the RTF file ([fCreate](../WDLang1/3036017.md)) or open an existing RTF file ([RTFLoad](../WDLang1/3025041.md)).

2. Copy the content of the RTF file into the current file ([fWrite](../WDLang1/3036014.md)).






**Example**: Creating a "MyDoc.RTF" file. This file contains the text entered in RTF_TEXT Edit control.


```wl
sFileName is string
sMyString is string
nFileID is int
sFileName = fSelect("", "", "Select a file...", ...
	"RTF files" + TAB + "*.RTF" + CR + "All files (*.*)" + TAB + "*.*", ...
	"RTF", fselCreate + fselExist)
nFileID = fOpen(sFileName, foCreateIfNotExist + foAdd + foReadWrite)
IF nFileID = -1 THEN
	Error("Cannot open the file")
ELSE
	// Fill the string to write into the file
	sMyString = EDT_Edit1
	// Write the block
	fWrite(nFileID, sMyString)
	// Close the file
	fClose(nFileID)
END
```

<a name="NOTE5_3"></a>


### Saving RTF text to an HFSQL data file item
<a name="saving_rtf_text_hfsql_data_file_item_ELTPARAGRAPHE000142"></a>

To save RTF text to an item of a data file, it is recommended to bind the Edit control to a Text Memo item.

As RTF includes many tags, "Character string" items are often too small.

<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Finding/Replacing text in an RTF Edit control
<a name="findingreplacing_text_rtf_edit_control_ELTTEXTE000375"></a>
To find and replace RTF content: 

1. Use [RTFSearch](../WDLang1/3025043.md) to find the desired text in the RTF Edit control.

2. Replace the text with [RTFReplace](../WDLang1/3025038.md).




**Example**: Find "WinDev 19" and replace with "WinDev 28". 


```wl
n is int
sSoughtWord is string = "WinDev 19"
sReplaceWord is string = "WinDev 28"
// Case-insensitive search, starting from the end of selection
n = RTFSearch(EDT_Edit1, sSoughtWord) 
// If the word is found
IF n-1 THEN
	// Replaces the word found
	RTFReplace(EDT_Edit1, sReplaceWord, n, n + Length(sSoughtWord))
END
```


<a name="NOTE7"></a>
<a name="NOTE7_1"></a>


## Handling characters in an RTF Edit control
<a name="handling_characters_rtf_edit_control_ELTTEXTE000399"></a>
WINDEV also allows you to handle the characters in a string or in an RTF control. For example: 

**Example**:  Limiting/Truncating the number of characters in an RTF string (excluding RTF tags). 


```wl
// Limits the RTF content to the number of characters specified in MaxNbChar
nMaxNbCharacters is int
nMaxNbCharacters = 3
RTFReplace(EDT_RTF_Text, "", nMaxNbCharacters + 1, Length(EDT_RTF_Text))
```


**Example**:  Calculating the number of characters in an RTF string (excluding RTF tags). 


```wl
// Retrieves the RTF content without formatting
sUnicode is UNICODE string
nNbCharacters is int

sUnicode = RTFToText(EDT_RTF_Text)
nNbCharacters = Length(sUnicode)
Info(nNbCharacters)
```







- ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=3&name=ManagementofRTF.gif) ***Unit examples (WINDEV)*** : **Management of RTF** <br>Using the main functions for RTF management in a WINDEV application:<br>- Load a file in RTF format<br>- Save a file in RTF format<br>- Find and select a word in an RTF text<br>- Display a text in RTF format<br>- Modify the characteristics of a selection (font, case, color, ...)
- ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=3&name=Thespecialcharacters.gif) ***Unit examples (WINDEV)*** : **The special characters** <br>Handling special characters in an RTF control and viewing the ASCII and ANSI codes.


