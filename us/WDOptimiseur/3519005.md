
## Starting WDOptimizer in command line
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Syntax
<a name="syntax_ELTTEXTE000232"></a>


### The following syntax enables you to start WDOptimizer in command line
<a name="the_following_syntax_enables_you_start_wdoptimizer_command_line_ELTPARAGRAPHE000011"></a>




```txt
WDOptimizer	 /Fic=<Directory>
	/Pwd=<Password>
	/Option=<Type of action performed>
	/Log=<Log file>
	/Mute=<Yes/No>
	/ExploreSubDir=<Yes/No>
	/CompressIndex=<Yes/No>
	/DelIndex=<Yes/No>
	/GetMemos=<Yes/No>
	/KeepCrossedRec=<Yes/No>
	/Charset=<Character set>
	/Density=<Density rate>
	/Language=<Display language>
	/Bck=<Yes/No>
```


The table below presents the different elements that can be found on the command line:

| **Parameter** | **Meaning** |
| --- | --- |
| /Fic=&lt;Directory&gt; | To process a single data file: full path of the data file to process.<br>To process a set of data files:<br><br>- path of a directory, <br><br>- INI file in export format generated by WDOptimizer. <br><br><br>To process the transactions: full path of the transaction file.<br>**Example**: c:\\temp\\file.fic |
| /Pwd=&lt;Password&gt; | Password associated with the data file to process (single data file) |
| /Option=&lt;Type of action to perform&gt; | Number corresponding to the option of WDOptimizer to start:<br>1: Check the index.<br>2: Optimize the speed of indexes (recalculate the statistics on the data files).<br>3: Rebuild indexes.<br>4: Rebuild the indexes and the memos.<br>5: Check and compress the indexes and the memos. |
| /Log=&lt;Log file&gt; | Full path of the log file (.log) to create. This file is created only if an option from 1 to 5 is selected. |
| /Mute=&lt;Yes/No&gt; | Yes to automatically validate the report window (No by default). |
| /ExploreSubDir=&lt;Yes/No&gt; | Yes to explore the sub-directories of the directory specified in "/Fic" (No by default). |
| /CompressIndex=&lt;Yes/No&gt; | Yes to delete the inactive records during a re-indexing operation (options 3 and 4) (No by default). |
| /DelIndex=&lt;Yes/No&gt; | Yes to delete the damaged records (options 3 and 4) (No by default). |
| /GetMemos=&lt;Yes/No&gt; | Yes to try to retrieve the data from the memo if it is damaged (option 5) (No by default). |
| /KeepCrossedRec=&lt;Yes/No&gt; | Yes to keep the crossed records (option 5) (No by default). |
| /Charset=&lt;Charset&gt; | Used to specify the character set used for the reindexing operation. You have the ability to use one of the constants corresponding to the character set to use.<br><br><br>\   \   \<br>\ --- \ --- \<br>\ *charsetArabic* \ Arabic characters \<br>\ *charsetBaltic* \ Baltic characters \<br>\ *charsetChinese* \ Chinese characters (People's Republic of China) \<br>\ *charsetDefault* \ Uses the computer's default character set. No character set is forced. \<br>\ *charsetEastEurope* \ Characters of Eastern Europe (Polish, ...) \<br>\ *charsetGreek* \ Greek characters \<br>\ *charsetHebrew* \ Hebrew characters \<br>\ *charsetJapanese* \ Japanese characters \<br>\ *charsetKorean* \ Korean characters \<br>\ *charsetOccidental* \ Roman characters in ANSI standard \<br>\ *charsetRussian* \ Russian characters \<br>\ *charsetThai* \ Thai characters \<br>\ *charsetTraditionalChinese* \ Traditional Chinese characters (Republic of Taiwan) \<br>\ *charsetTurkish* \ Turkish characters \<br>\ *charsetUTF8* \ Used to manage the countries with two character sets (Hong Kong) and the countries with no character set defined in Windows (Georgian and Armenian). \<br>\ *charsetVietnamese* \ Vietnamese characters \<br><br> |
| /Density=&lt;Density rate&gt; | Density rate of indices. This rate is set to 80 by default. <br>**The higher this rate is**, the denser and smaller the index is. In this case, iterations, searches, filters and queries will be faster. The additions of records and the modifications of records may be slower. <br>**The lower this rate is**, the less dense and the bigger the index will be. In this case, iterations, searches, filters and queries will be slower. The additions of records and the modifications of records will be faster. |
| /Language=&lt;Display language&gt; | "US" to start WDOptimizer in English (French by default). |
| /Bck=&lt;No&gt; | By default, the files to process are saved (only taken into account if /option = 5). No if you don't want to perform this backup. |



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Examples
<a name="examples_ELTTEXTE000256"></a>
The command line below is used to reindex the files found in "C:\\MyApp\\Data".


```wl
ExeRun("C:\MyDirectory\WDOptimizer.EXE /Fic=C:\MyApp\Data")
```

<a name="NOTE2_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![User code (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Example of procedure for re-indexing
<a name="example_procedure_for_reindexing_ELTPARAGRAPHE000181"></a>




```wl
// Global variables of project 
gsAppName is string = "MyApp"
gsDataDir is string = CompleteDir(fExeDir()) + "Data\"
```

```wl
//Procedure global to the project 
PROCEDURE gWdOptimizeAnalysis(_OptionNum = 5,_bSave = False)
// Control WOPTIMIZER for all the files of an application 
// while taking into account the password, exeActive and 
// WDOptimizer is locking when it is run. 
// After each reindex operation, WDOptimizer displays the message
// "The  'C:\ ...\MyFile.Fic' file was successfully reindexed".
// The user must click "OK".
// The option 5 of WDOptimizer is used by default
// By default, the files are not saved before optimization
// - Required: 
//   - The data files can be relocated in relation to the exe 
// (Global variables gsAppName and gsDataDir)
//  - WDOptimizer is always found beside the executable
//  - The files can have a physical name that differs from the logical name 
// as well as an extension <> ".FIC"
 
// Variables local to the process
sFileList, sFileName are strings
sSave is string = "False"
IF _bSave = True THEN sSave = "True"
	i is int = 1
	sDir is string = CompleteDir(fExeDir())
	 // Physical name of the file (name + extension)
	sPhysicalFileName is string
	// Password of the file 
	sPwd is string 
	sCommandLine is string

	// Check the presence of WDOPTIMIZER
	IF fDir(sDir + "WDOptimizer.EXE", frFile) = "" _OR_ ...
				fDir(sDir + "WDTool.WDK", frFile) = "" THEN 
			Error("WDOptimizer was not installed properly")
		RETURN
	END

	// List the analysis files
	sFileList = HListFile()
	sFileName = ExtractString(sFileList, i, CR)
	WHILE sFileName <> EOT 
		sPhysicalFileName = {sFileName}..PhysicalName + {sFileName}..Extension
		IF fDir(gsDataDir + sPhysicalFileName, frFile) <> "" THEN 
			// Take the passwords of some protected files into account  
		SWITCH Upper(sFileName)
			CASE "TOTO": sPwd = "toto"
			OTHER CASE: sPwd = ""  
		END
		IF sPwd <> "" THEN 
			sCommandLine = 
				sDir + "WDOptimizer.EXE   /File=" + ...
				gsDataDir + sPhysicalFileName + " /Pwd=" + sPwd + " /" + ...
					_OptionNum + " /" + sBackup
		ELSE
				sCommandLine = sDir + "WDOptimizer.EXE   /File=" + ...
					 gsDataDir + sPhysicalFileName + " /5 /" + sBackup
			END
		ExeRun(sCommandLine, exeActive, exeWait)
	END
	i++
	sFileName = ExtractString(sFileList, i, CR)
END
Info("The files found in '" + gsAppName + "' were successfully optimized")
```



