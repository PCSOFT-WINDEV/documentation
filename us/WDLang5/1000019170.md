
## Managing the XSD
			



## Overview
<a name="overview_ELTTEXTE000123"></a>
WINDEV, WINDEV Mobile and WEBDEV include several functions for handling the XML code. The XML code used must comply with the XML standard. For more details, see the documentation specific to XML. For more details on WLanguage functions, see [XML](../WDLang5/3081018.md).

WINDEV, WEBDEV and WINDEV Mobile allow you to import files in XSD format. An XSD file contains the description of the XML file of the same name. Knowing the structure of an XML document allows you to check the validity of this document. The description language for the content of an XSD document is also in XML format.

An example of XSD file:


```xml
<?xml version="1.0" encoding="UTF-8"?>
  <xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">
   <xsd:element name="personne">
      <xsd:complexType>
         <xsd:sequence>
            <xsd:element name="nom" type="xsd:string"/>
            <xsd:element name="prenom" type="xsd:string"/>
            <xsd:element name="date_naissance" type="xsd:date"/>
            <xsd:element name="email" type="xsd:string" minOccurs="0" maxOccurs="unbounded" />
         </xsd:sequence>
      </xsd:complexType>
   </xsd:element>
 </xsd:schema>
```


Followed by a valid XML file:


```xml
<?xml version="1.0" encoding="UTF-8"?>
 <personne xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xsi:noNamespaceSchemaLocation="personne.xsd">
   <nom>de Latour</nom>
   <prenom>Jean</prenom>
   <date_naissance>1967-08-13</date_naissance>
   <email>test@free.fr</email>
 </personne>
```


<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Importing an XSD file into a project
<a name="importing_xsd_file_into_project_ELTTEXTE000147"></a>
To import an XSD file into a project:

1. In the "Project explorer" pane, select "External descriptions".

2. Right-click and select "Import an XSD into this project". The import wizard starts. You can: 

	- Import an XSD file from the Internet. 

	- Import a local XSD file. 




3. Specify the characteristics of the XSD file to be imported. 

4. Validate. The XSD file is automatically added in the project explorer ("External descriptions" branch). It is ready to use.




Caution: 

- To work at runtime, the XSD file must not be present in a subdirectory of the project or executable.

- Only XSD files with schema version 1.0 are supported. 








## Using an imported description in the project
<a name="using_imported_description_the_project_ELTTEXTE000171"></a>
To use the description of the XML document, simply use the variables automatically generated by the import.

1. Declare an XML document in the format of the imported description. For example, if the imported description is named 'person':
	
	```wl
	cMonDoc est un xmlDocument <description="personne">
	```

	Remark: You can specify the file extension during the declaration. For example: 
	
	```wl
	cMonDoc est un xmlDocument <description="personne.xsd">
	```


2. Initialize the different variables that are included in the description of the XML document. For example, if the document includes the last name and the first name of a person:
	
	```wl
	cMonDoc.personne.nom = "DUPONT"
	cMonDoc.personne.prenom = "JEAN"
	```

	Remarks: 

	- Each element is separated by a dot **.**.

	- A help is proposed when entering the names of variables.

	- If the name of an element contains a special character (dash for example), it must be enclosed in simple quotes:
			
		```wl
		cMonDoc.personne.'id-personne' = "ValeurId"
		```





3. Several functions can be used to handle the XSD file in order to validate the description of the XML file: 
	


|   |   |
| --- | --- |
| [XMLSave](../WDLang5/1000019026.md) | Saves an XML document in a file. |
| [XMLValidDocument](../WDLang5/1000019272.md) | Validates an XML document from an XSD schema. |
| [XMLValidNode](../WDLang5/1000019280.md) | Validates an XML node, its children and its attributes from its description in the XSD schema linked to the XML document. |





### Example: Full creation of a file according to the XSD description given in example: 
<a name="example_full_creation_file_according_the_xsd_description_given_example_ELTPARAGRAPHE000073"></a>




```wl
cMonDoc est un xmlDocument <description="personne.xsd">

cMonDoc.personne.nom = "Dupont"
cMonDoc.personne.prenom = "Jean"
cMonDoc.personne.date_naissance = "19710211"
cMonDoc.personne.email[1] = "jean.dupont@mondomaine.com"
cMonDoc.personne.email[2] = "jean.dupont@autredomaine.com"

XMLSauve(cMonDoc, fRepExe() + ["\"] + "test.xml")

// Ou avec une vérification intermédiaire: 
SI XMLDocumentValide(cMonDoc) = Vrai ALORS
	XMLSauve(cMonDoc, fRepExe() + ["\"] + "test.xml")
	SI ErreurDétectée = Vrai ALORS
		Erreur("Impossible de sauvegarder le document XML", ErreurInfo())
	SINON
		Info("OK", fRepExe() + ["\"] + "test.xml")
	FIN
SINON
	Erreur("Le document XML est invalide", ErreurInfo()) 
FIN
```



