
## MongoAggregationPipeline (Function)

***In french: MongoPipelineAgrégation***



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Used to retrieve documents that enter a multi-stage pipeline and are transformed into aggregated results.
<a name="Example1"></a>
<a name="sample_code"></a>

## Example


```wl
sPipeline is string = ...
"["+CR+...
"  { ""$group"":"+CR+...
"    {"+CR+...
"      ""_id"": { ""state"": ""$state"", ""city"": ""$city"" },"+CR+...
"      ""pop"": { ""$sum"": ""$pop"" }"+CR+...
"    }"+CR+...
"  },"+CR+...
"  { ""$sort"": { ""pop"": 1 } },"+CR+...
"  { ""$group"":"+CR+...
"    {"+CR+...
"      ""_id"": ""$_id.state"","+CR+...
"      ""biggestCity"":  { ""$last"": ""$_id.city"" },"+CR+...
"      ""biggestPop"":   { ""$last"": ""$pop"" },"+CR+...
"      ""smallestCity"": {""$first"": ""$_id.city"" },"+CR+...
"      ""smallestPop"":  {""$first"": ""$pop"" }"+CR+...
"    }"+CR+...
"  },"+CR+...
"  { ""$project"":"+CR+...
"    {"+CR+...
"      ""_id"": 0,"+CR+...
"      ""state"": ""$_id"","+CR+...
"      ""biggestCity"":  {""nom"": ""$biggestCity"",  ""pop"": ""$biggestPop"" },"+CR+...
"      ""smallestCity"": {""nom"": ""$smallestCity"", ""pop"": ""$smallestPop"" }"+CR+...
"    }"+CR+...
"  }"+CR+...
"]"


let r = MongoAggregationPipeline(gCnt.Database["db"].Collection["zipcodes"], sPipeline)
FOR EACH v OF r
	Trace(VariantToJSON(v))
END
```

<a name="XSYNTAX"></a>

## Syntax
<a name="SYNTAX1"></a>

`<Result> = MongoAggregationPipeline(<Collection> , <Pipeline>)`
---

**`<Result>: (mongoResult variable)`**

[mongoResult](../WDLang4/1000022415.md) variable corresponding to the result. If a problem occurs, [ErrorInfo](../WDLang1/3013008.md) is used to identify the error.

**`<Collection>: (mongoCollection variable)`**

Name of the [mongoCollection](../WDLang4/1000022411.md) variable corresponding to the MongoDB collection where the document search will be performed.

**`<Pipeline>: (Character string)`**

json(string), bson(buffer) or variant document that describes the pipeline in mongoDB format. 



<a name="XComponent"></a>

