


## Description d'un champ Agenda (champ d'une fenêtre)
			





## Description d'un champ Agenda
<a name="description_champ_agenda_ELTTEXTE000288"></a>
Le champ Agenda peut être paramétré directement sous l'éditeur grâce à la fenêtre de description (onglet "Détail").

Les différentes options disponibles sont les suivantes : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Description%20Agenda_Fen%EAtre%20-%20HC%20N%B0001.gif&type=thumb)


- **Paramètres de l'agenda** : 

	- **Mode d'affichage et granularités** : Par défaut, les rendez-vous sont affichés : 

		- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) dans une semaine sur 5 jours, avec une granularité de déplacement et une granularité de durée de 30 minutes.


 En cliquant sur les options d'affichage, une fenêtre s'affiche permettant de définir les différentes options d'affichage : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Description%20Agenda_Fen%EAtre%20-%20HC%20N%B0002.gif&type=thumb)
Il est possible de définir les éléments suivants : 

- Mode d'affichage du champ Agenda : Permet de définir la durée de la plage visualisée : Journée, mois, semaine, ... ou nombre de jours personnalisé. 

- Granularité des rendez-vous : Correspond à la précision d'affichage du champ Agenda. Les rendez-vous peuvent commencer sur un multiple de XX minutes, heures, ... et avoir une durée multiple de XX minutes, heures, ... Le bouton fléché permet de saisir des valeurs prédéfinies. Le verrou permet de lier ou non les valeurs. 

- L'option "Mémoriser le mode" permet de mémoriser et de réappliquer le mode d'affichage choisi par l'utilisateur. 

- **Masque d'affichage de la date** : 
	Permet de définir le format de la date affichée en haut des colonnes "jour" du champ Agenda.

	- L'option "Afficher le numéro de semaine" permet d'indiquer si le numéro de semaine doit être affiché ou non. Il est alors possible de préciser son format. Dans le format, la chaîne '%1' correspond au numéro de semaine. Exemple de format : "Sem. %1".

	- L'option "Format ISO 8601" permet de s'assurer que la numérotation des semaines sera conforme à la norme ISO 8601.

	- L'option "Afficher le mois si nécessaire" permet d'indiquer le nom du mois en abrégé dans la première date affichée dans le champ (si le masque des dates n'affiche pas le mois). 




- **Plage horaire** : 

	- La plage horaire visible correspond à la plage horaire qui sera affichée dans le champ. 

	- La plage horaire ouvrable correspond à la plage horaire pour laquelle un rendez-vous pourra être défini.  
			Un clic sur la double flèche permet de modifier ces valeurs. 
			Pour définir des plages horaires spécifiques, utilisez la fonction [AgendaHeureOuvrable](../WDLang1/1000022530.md).

	- L'option "Modifier la plage lors du redimensionnement"  permet d'agrandir la plage horaire lors de l'agrandissement du champ. Par exemple, si la plage horaire est de 9h00 à 18h00, lors de l'agrandissement du champ, cette plage visible peut devenir de 6h00 à 23h00. La hauteur des lignes reste constante dans ce cas.




- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Caractéristiques du rendez-vous** : L'option "Chevauchement" permet de définir la gestion du chevauchement de plusieurs rendez-vous. Les rendez-vous pourront être côte à côte ou décalés.

- **Autres paramètres** : 

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) "Autoriser la sélection de périodes" : Permet à l'utilisateur de sélectionner une période à l'aide de la souris.

	- "Autoriser la saisie directe d'un rendez-vous" : Permet à l'utilisateur de saisir directement un rendez-vous dans le champ Agenda. 
			![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Par défaut, le rendez-vous passe en édition, et l'utilisateur peut saisir le titre du rendez-vous. 
			
			Il est possible d'afficher une fenêtre pour paramétrer les options du rendez-vous.

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) "Afficher et autoriser les rendez-vous à la journée entière" : Permet d'indiquer qu'un rendez-vous peut correspondre à une journée entière. Dans ce cas, une zone spécifique est affichée en haut du champ Agenda. Cette zone permet de saisir les rendez-vous à la journée.
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Agenda_Journee.gif&type=thumb)





- **Edition à la souris (au doigt)** :

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) "Modification de la durée" : Il est possible d'autoriser ou non l'utilisateur à modifier la durée d'un rendez-vous. 

	- "Déplacement". Il est possible d'autoriser ou non l'utilisateur à déplacer un rendez-vous. 

	- "Autoriser le chevauchement par l'utilisateur". Si cette option est sélectionnée, l'utilisateur pourra lors du déplacement de rendez-vous les faire se chevaucher. 
			![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Dans ce cas, les options définies pour le chevauchement des rendez-vous (décalage ou côte à côte) seront prises en compte.






<a name="NOTE3_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Un menu contextuel proposé automatiquement
<a name="menu_contextuel_propose_automatiquement_ELTPARAGRAPHE000157"></a>Le champ Agenda peut afficher un menu contextuel spécifique proposant des fonctionnalités automatiques à l'utilisateur. Ce menu est proposé par les FAA (Fonctionnalités Automatiques de vos Applications). 

Ce menu permet à l'utilisateur de : 

- Modifier le mode d'affichage du champ Agenda : affichage au jour, à la semaine, au mois ou encore affichage uniquement de la journée en cours. 

- Ajouter, supprimer ou modifier un rendez-vous lors de la sélection d'une plage horaire. 
	**Remarques** : Si le champ est lié à une source de données, la suppression réalisée dans le champ est effectuée en même temps dans la source de données liée. 

- Imprimer le contenu du champ Agenda. 




Pour plus de détails sur les fonctionnalités de ce menu contextuel (notamment l'impression), consultez [Fonctionnalités automatiques du champ Agenda](../WDChamp/1016327.md).
<a name="NOTE3_4"></a>


### Personnaliser la zone du rendez-vous
<a name="personnaliser_zone_rendezvous_ELTPARAGRAPHE000181"></a>Dans le champ Agenda, le rendez-vous est affiché dans une zone spécifique. Il est possible de traduire et de personnaliser cette zone : couleur du titre, couleur de fond du rendez-vous, ...

**Pour modifier l'aspect des rendez-vous proposé par défaut**, il est possible de modifier les options de style définies pour cet élément.  

1. Affichez la fenêtre de description du champ Agenda. 

2. Dans l'onglet "Style", sélectionnez l'élément "Rendez-vous" et modifiez les caractéristiques voulues.
	Vous pouvez : 

	- utiliser une ombre, 

	- utiliser un séparateur en pointillé entre les heures, 

	- définir les options de titre et fond : 

		- fond uni,

		- fond dégradé, 

		- Fond uni, titre multiligne et trait bas. Cette option permet d'afficher le titre sur plusieurs ligne (notamment si le rendez-vous n'est pas assez large pour afficher le titre en entier.




- définir les polices utilisées, ...




**Pour personnaliser l'affichage des rendez-vous** : 

1. Affichez la fenêtre de description du champ Agenda. 

2. Dans l'onglet "Général", sélectionnez la fenêtre interne utilisée pour les rendez-vous : 

	- "Aucune" : l'affichage par défaut sera utilisé. 

	- "Fenêtre prédéfinie" : Si cette option est sélectionnée, le composant interne WDFAA est immédiatement ajouté dans le projet en cours. 

		- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) La fenêtre interne "FI_WinDevVueRDV" est automatiquement associée à l'option "Fenêtre interne pour les rendez-vous". 


 Remarques : 

- Si le composant WDFAA existe déjà, seule la fenêtre est ajoutée au composant.  

- Cette fenêtre est également utilisée pour personnaliser les rendez-vous des champs Planning. 

- N'importe quelle fenêtre interne présente dans votre projet. 

3. Validez si nécessaire la fenêtre de description du champ. 




**Remarques** : 

- La fenêtre interne personnalisée est disponible dans le volet "Explorateur de projet", dans le dossier "Composants internes". Elle peut être modifiée dans l'éditeur de fenêtres. 
	**Attention** : cette fenêtre interne permet uniquement de personnaliser le dessin de l'affichage des rendez-vous. Seul l'événement "Déclarations globales" est exécuté. Aucun autre événement n'est exécuté. Il n'est ainsi pas possible d'ajouter des boutons ayant un code de clic spécifique. 

- Si vous utilisez la fenêtre prédéfinie proposée, les options de style du rendez-vous (sélectionnées dans l'onglet "Style") s'appliquent.

- La fenêtre interne proposée par défaut fonctionne uniquement en mode d'affichage Jour/Semaine. Cette fenêtre ne fonctionne pas en mode d'affichage Mois. 







