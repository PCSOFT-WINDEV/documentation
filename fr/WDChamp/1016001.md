


## Le champ Carrousel
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation du champ Carrousel
<a name="presentation_champ_carrousel_ELTTEXTE000286"></a>
Le champ Carrousel permet d'afficher un menu animé composé d'images.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CHP_Carroussel.gif)


**Pour créer un champ de type Carrousel** : 

1. Sous le volet "Création", dans le groupe "Autres champs", cliquez sur "Carrousel".

2. Cliquez dans la fenêtre à la position où le champ doit être créé.




Pour afficher les caractéristiques du champ, sélectionnez l'option "Description" dans le menu contextuel du champ :

- L'onglet "Général" permet de définir l'orientation, l'animation et l'image de fond.

- L'onglet "Détail" permet de définir le mode d'affichage du champ carrousel.

- L'onglet "Contenu" permet de définir les images et leur libellé affiché dans le champ carrousel.




**Remarque** : WINDEV permet de créer automatiquement un champ Carrousel à partir de plusieurs champs :  

1. Sélectionnez les champs à intégrer dans le champ Carrousel. 

2. Sous le volet "Modification", dans le groupe "Transformations", déroulez "Refactoring et permutations" et sélectionnez "Créer un carrousel avec la sélection".




Seuls les champs Image et les champs Bouton sont pris en compte pour créer ce carrousel.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Deux modes d'utilisation du champ Carrousel
<a name="deux_modes_utilisation_champ_carrousel_ELTTEXTE000310"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000061"></a>Pour optimiser le fonctionnement du champ Carrousel, WINDEV propose deux modes de fonctionnement :

- Utilisation du framework DotNet 3.0.

- Utilisation du framework WINDEV (GDI+).



<a name="NOTE2_2"></a>


### Framework DotNet 3.0
<a name="framework_dotnet_30_ELTPARAGRAPHE000071"></a>Pour baser le champ Carrousel sur le framework DotNet 3.0, il suffit de cocher l'option "Le champ est basé sur le framework DotNet 3.0
(les fonctions de la famille Xaml seront disponibles en plus pour ce champ)" dans l'onglet "Détail" de la fenêtre de description du champ.

Dans ce cas :

- Les fonctions de la famille Xaml sont disponibles sur ce champ.

- Il est possible de proposer le téléchargement du framework DotNet 3.0 si celui-ci n'est pas installé sur le poste de l'utilisateur. Ce framework est inclus sous Vista et téléchargeable pour Windows XP (sur le site de Microsoft).

- La première utilisation d'un champ utilisant le framework 3.0 (champ Carrousel, champ Cube ou champ Xaml) demande le chargement de ce framework, ce qui peut entraîner un délai (indépendant de notre volonté).

- Ce champ consomme beaucoup de ressources : il est conseillé de l'utiliser sur des postes ayant des configurations performantes.




Selon la configuration du poste, l'affichage du champ Carrousel sera effectué de la façon suivante :


|   |   |   |   |
| --- | --- | --- | --- |
|   | **Option "Téléchargement" cochée** | **Option "Téléchargement" décochée** |
| **Poste avec framework .NET 3.0** | **Poste sans framework .NET 3.0** | **Poste sans framework .NET 3.0** |
| **Poste avec framework GDI+** | Utilisation du framework .NET | Utilisation du framework GDI+ | Utilisation du framework GDI+ |
| **Poste sans framework GDI+** | x | Lien pour télécharger le framework .NET<br>Lien pour afficher une liste image | Utilisation d'une liste image (mode dégradé) |


**Limitations du champ Carrousel en mode DotNet 3.0** : 

- Le framework DotNet 3.0 ou supérieur doit être installé sur le poste. Ce framework est inclus sous Vista (et supérieur) et téléchargeable pour Windows XP (sur le site de Microsoft). 

- L'application ne peut pas être lancée depuis le réseau.

- Le GFI (Grisage des Fenêtres Inaccessibles) est désactivé sur toutes les fenêtres contenant un champ Carrousel.

- Ce champ ne fonctionne pas sous TSE.

- Ce champ utilise la librairie wd280xaml.dll. Cette librairie ne peut pas être renommée lors de la création de l'exécutable.



<a name="NOTE2_3"></a>


### Framework WINDEV (GDI+)
<a name="framework_windev_gdi_ELTPARAGRAPHE000154"></a>Pour baser le champ Carrousel sur le framework WINDEV, il suffit de cocher l'option "Le champ est basé sur le framework WINDEV (GDI+)" dans l'onglet "Détail" de la fenêtre de description du champ.

Dans ce cas, les fonctions de la famille Xaml ne sont pas disponibles sur ce champ.

Selon la configuration du poste, l'affichage du champ Carrousel sera effectué de la façon suivante :


|   |   |   |
| --- | --- | --- |
|   | **Poste avec framework .NET 3.0** | **Poste sans framework .NET 3.0** |
| **Poste avec framework GDI+** | Utilisation du framework GDI+ | Utilisation du framework GDI+ |
| **Poste sans framework GDI+** | x | Utilisation d'une liste image (mode dégradé) |


Pour plus de détails, consultez [Installation du Framework GDI+](../Editeurs/2020007.md).
<a name="NOTE2_4"></a>


### Mode dégradé
<a name="mode_degrade_ELTPARAGRAPHE000204"></a>La présence du framework DotNet 3.0 ou supérieure ou la présence du framework WINDEV (GDI+) est nécessaire à l'utilisation du champ Carrousel. Cependant, WINDEV propose un mode "dégradé" de ce champ, afin qu'il soit utilisable quelle que soit la configuration du poste de l'utilisateur final. Si l'utilisateur final ne possède pas le framework DotNet 3.0 ou le framework WINDEV (GDI+), en mode dégradé, le champ Carrousel sera automatiquement remplacé par une liste image.

**Pour utiliser ce mode dégradé dans vos applications** :

1. Affichez la description du champ Carrousel.

2. Dans l'onglet "Détail", vous pouvez paramétrer le champ Liste image utilisé grâce au bouton "Paramètres du champ Liste image".

3. Validez la description du champ.




Le champ Liste image sera utilisé selon le mode d'affichage du champ Carrousel choisi et la configuration du poste de l'utilisateur (voir paragraphes précédents).

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Notes
<a name="notes_ELTTEXTE000352"></a>


### Simuler l'absence du framework DotNet 3.0
<a name="simuler_absence_framework_dotnet_30_ELTPARAGRAPHE000225"></a>Lors du développement d'une application contenant un champ Carrousel, il peut être utile de savoir comment réagira l'application sur une machine ne disposant pas du framework DotNet 3.0 ou supérieur.

Pour simuler l'absence du framework sur une machine :

- soit utilisez la fonction [XamlDésactive](../WDLang1/1000015004.md).

- soit renommez la clé de registre suivante : "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework\\v3.0".


**Notes** : Il est possible de remplacer de façon automatique le champ Carrousel avec le framework DotNet par un champ Carrousel utilisant le framework WINDEV (GDI+).


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampCarrousel.gif) ***Exemples unitaires (WINDEV)*** : **Le champ Carrousel** <br>Utilisation du champ Carrousel de WINDEV.<br>Il se manipule exactement comme un champ Liste Image.<br>Diverses propriétés sont disponibles, avec notamment la possibilité de modifier l'orientation du carrousel.


