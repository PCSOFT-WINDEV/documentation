


## Evénements associés aux champs Table
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Evénements gérés par défaut
<a name="evenements_geres_par_defaut_ELTTEXTE000399"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) **WINDEV** et **WINDEV Mobile** gèrent par défaut les événements suivants (ordre d'apparition sous l'éditeur de code) :

| Evénement | Condition d'exécution |
| --- | --- |
| Initialisation | Exécuté à l'ouverture de la fenêtre. (\*)<br><br>**Cas particulier : Champ Table fichier rempli automatiquement**<br>Lors de l'exécution de ce code, le champ Table n'est pas encore rempli. Il est possible de forcer le remplissage du champ Table dans ce code avec :<br><br>- soit la fonction [TableAffiche](../WDLang1/3074003.md),<br><br>- soit les propriétés de gestion des champs Table fichier : [FichierParcouru](../Proprietes/2510040.md), [RubriqueParcourue](../Proprietes/2510111.md) ou [Filtre](../Proprietes/2510042.md).<br><br><br><br><br>Il est également possible de filtrer les enregistrements avec la fonction [HFiltre](../WDLang4/3044100.md). |
| Fin d'initialisation | Code présent uniquement pour les champs Table fichier remplis automatiquement :<br><br>Exécuté après le remplissage du champ Table. Ce code permet par exemple de sélectionner un élément dans le champ Table, d'ajouter ou de modifier un élément. |
| Entrée dans le champ Table | Exécuté lorsque le champ prend le focus. |
| Sortie du champ Table | Exécuté lors du changement de champ (touche TAB, changement de champ par la souris, ...). |
| Entrée en saisie d'une ligne du champ Table | Exécuté lorsque l'utilisateur sélectionne une ligne pour effectuer une saisie dans cette ligne. |
| Sortie d'une ligne du champ Table | Exécuté lors du changement de ligne ou lors du changement de champ (touche TAB, changement de champ par la souris, ...) à partir d'une ligne.<br><br>Dans ce code, la ligne en cours correspond à la ligne précédemment sélectionnée.<br><br>**Attention : Champ Table avec colonne interrupteur** :  la seule modification de l'interrupteur n'exécute pas le code de sortie de ligne. En effet, lors d'un clic sur une colonne interrupteur, WINDEV ne considère pas que l'utilisateur est entré en saisie dans la ligne . Les événements "Entrée en saisie d'une ligne" et "Sortie d'une ligne" ne sont pas exécutés. Pour gérer ce cas, il est conseillé d'utiliser le code de modification de la colonne. <br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Dans ce code, la ligne courante correspond à la nouvelle ligne sélectionnée. |
| Affichage d'une ligne du champ Table | Exécuté lorsque une nouvelle ligne doit être affichée dans le champ Table : ré-affichage du champ Table, scrolling ou déplacement dans le champ Table, ...<br><br>Cet événement est également exécuté lors de l'affectation d'une colonne. Si plusieurs colonnes sont affectées par programmation, le code d'affichage sera exécuté plusieurs fois. <br>**Conseil** : Si vous devez modifier plusieurs colonnes, utilisez la fonction [TableModifieLigne](../WDLang1/3074028.md) et non l'affectation directe.<br><br> |
| Sélection d'une ligne du champ Table | Exécuté lorsque l'utilisateur sélectionne une ligne (sans saisie).<br><br>Cet événement est également exécuté lorsque l'utilisateur clique sur une cellule en mode de sélection "Cellule Sélection simple" ou "Cellule : Sélection multiple". |
|   | Cet événement est automatiquement ajouté lorsque la fonctionnalité "Tirer pour rafraîchir" (Pull to Refresh) a été activée (onglet "Détail" de la fenêtre de description du champ Table). <br><br>Cet événement est exécuté lors de la détection de la gesture de rafraîchissement sur le champ Table. <br><br>A la fin de cet événement, le bandeau de rafraîchissement sera automatiquement masqué sauf si la fonction [TableRafraîchissementVisible](../WDLang1/1000021196.md) a été appelée.<br><br>Pour plus de détails, consultez  [Pull to Refresh sur les champs Table et Zone répétée (Android/iOS)](../WDChamp/9000156.md). |
| ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Filtrage des enregistrements (événement optionnel) | **Code présent uniquement pour les champs Table fichier remplis automatiquement** :<br>Exécuté juste avant l'affichage d'une ligne. Cet événement permet de filtrer les enregistrements à afficher dans le champ Table. Cet événement est détaillé à la fin de cette page. |
| ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Evénements de gestion du Drag and Drop (événements optionnels) | **Code présent uniquement pour les champs Table par programmation et les champs Table sur variable** : <br>Ces événements permettent de simplifier la gestion du Drag and Drop programmé. Les événements disponibles sont :<br><br>- Début du glisser/déplacer source.<br><br>- Fin du glisser/déplacer source.<br><br>- Entrée en glisser/déplacer cible.<br><br>- Survol en glisser/déplacer cible.<br><br>- Lâcher en glisser/déplacer cible.<br><br>- Sortie en glisser/déplacer cible.<br><br><br>**Remarque** : Si un de ces événements contient du code, le Drag and Drop n'est plus automatiquement géré pour le champ Table : il est nécessaire de gérer entièrement par programmation le Drag and Drop dans le champ Table. |
| Evénements de défilement (événements optionnels) | Ces événements permettent de simplifier la gestion du déplacement de l'ascenseur vertical du champ. Les événements disponibles sont :<br><br>- Début de défilement : Exécuté lors début du défilement de l'ascenseur vertical du champ. <br><br>- Pendant le défilement : Exécuté lors du défilement de l'ascenseur vertical du champ.  <br><br>- Fin de défilement : Exécuté à la fin du défilement de l'ascenseur vertical du champ. <br><br><br><br><br>Remarque : La fonction [AscenseurPosition](../WDLang1/1000021057.md) permet de connaître la position de l'ascenseur. |


(\*) Par défaut, l'événement "Initialisation" de chaque champ est exécuté selon l'ordre de création des différents champs dans la fenêtre. Pour modifier cet ordre d'exécution : 

1. Sous le volet "Fenêtre", dans le groupe "Ordre", cliquez sur "Initialisation". 

2. Dans la fenêtre qui s'affiche, utilisez les flèches situées sur la droite pour modifier l'ordre d'initialisation des champs.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Evénements optionnels
<a name="evenements_optionnels_ELTTEXTE000429"></a>
Plusieurs événements optionnels peuvent être gérés.
Pour ajouter un événement optionnel :

1. Sélectionnez le champ voulu.

2. Affichez la fenêtre de code de ce champ (touche F2).

3. Cliquez sur le lien "Ajouter d'autres événements à xxx" situé à la fin de la fenêtre de code, après le dernier événement.  <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Traitements_optionnels_WD_OK%20-%20HC%20N%B0001.gif)


4. La totalité des événements optionnels disponibles pour le champ est affichée. 

5. Cochez l'événement optionnel à ajouter et validez. 
	Remarque : Il est possible de sélectionner plusieurs événements optionnels. 

6. L'événement optionnel sélectionné est automatiquement ajouté dans les événements gérés par le champ.




Pour désactiver un événement optionnel, il suffit d'effectuer les mêmes manipulations pour afficher la liste des événements optionnels. Il suffit ensuite de décocher les événements optionnels à supprimer. 
Remarque : Si le code désactivé contient du code WLangage, ce code est automatiquement supprimé.Il est ainsi possible de gérer par exemple :

- le survol du champ par la souris,

- le bouton gauche enfoncé, relâché, avec un double-clic,

- le bouton droit enfoncé, relâché, avec double-clic,

- la roulette de la souris, ...




**Remarque** : Selon l'environnement (WINDEV, WEBDEV, WINDEV Mobile) et la plateforme de développement, les événements optionnels disponibles ne sont pas les mêmes.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Filtrage des enregistrements (Table fichier uniquement)
<a name="filtrage_des_enregistrements_table_fichier_uniquement_ELTTEXTE000469"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) L'événement "Filtrage des enregistrements" est exécuté juste après l'affichage d'une ligne du champ Table. Il est donc exécuté :

- lors de l'initialisation du champ Table.

- à chaque nouvel affichage d'une ligne du champ Table.




Cet événement permet de filtrer les enregistrements affichés dans le champ Table. 

Pour mettre en place un filtre, l'événement "Filtrage des enregistrements" doit renvoyer une valeur :

- <u><u><u><u>Vrai</u></u></u></u> pour signifier que l'enregistrement respecte le filtre et qu'il doit être affiché.

- <u><u><u><u>Faux</u></u></u></u> pour signifier que l'enregistrement ne respecte pas le filtre et qu'il ne doit pas être affiché.

- <u><u><u><u>Annuler</u></u></u></u> pour arrêter la lecture de la source de données de la table (cas très rare).




Exemple :

```wl
// -- Filtrage des enregistrements
// Affiche uniquement les clients dont commandes sont supérieures à 3000 euros
SI Commande.TotalTTC >=3000 ALORS 
	RENVOYER Vrai
SINON
	RENVOYER Faux
FIN
```
Dans ce code, les données manipulées concernent l'enregistrement en cours de lecture par le champ Table. Ces données proviennent du fichier de données ou de la requête liés au champ Table.

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Si un filtre automatique est réalisé sur le champ Table (fonction [TableActiveFiltre](../WDLang1/1000017149.md) ou filtre activé directement par l'utilisateur), le filtre défini par l'événement "Filtrage des enregistrements" se cumule au filtre automatique. Remarque : Sous WINDEV et WINDEV Mobile, l'événement "Filtrage des enregistrements" est un événement optionnel. Sous WEBDEV, cet événement est proposé par défaut.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Avant l'affichage de la bulle d'aide automatique de l'ascenseur
<a name="avant_affichage_bulle_aide_automatique_ascenseur_ELTTEXTE000493"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Sous Windows, la bulle d'aide de l'ascenseur des champs Table est affichée lorsque l'utilisateur clique sur la "cage" de l'ascenseur vertical. 
Cette bulle d'aide contient par défaut les informations suivantes : 

- Plage des lignes actuellement affichées dans le champ Table. 

- Nombre de lignes total du champ Table.

- Information sur l'élément actuellement affiché en première ligne du champ Table dans la colonne triée. 


L'événement "Avant l'affichage de la bulle d'aide automatique de l'ascenseur" est exécuté juste avant l'affichage de cette bulle d'aide. Il est ainsi possible par exemple d'afficher un texte spécifique dans la bulle d'aide à l'aide de la propriété [Bulle](../Proprietes/2510005.md). 


