
## Visualisateur de rapports : Proposer plusieurs états
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000136"></a>
Lors de l'impression d'un document, l'utilisateur final veut parfois : 

- choisir ou modifier l'orientation de son état (portrait ou paysage). 

- adapter l'impression à un format spécifique de papier : A4, A3, US Letter, ...




Cette fonctionnalité est disponible dans le visualisateur de rapports grâce aux groupes d'états. L'utilisateur peut choisir via une combo dans le visualisateur de rapports la présentation la plus adaptée à l'instant de l'impression. 

**Remarques** : 

- Cette fonctionnalité peut facilement être étendue par exemple pour proposer à l'utilisateur directement depuis le visualisateur de rapports un ensemble d'états statistiques selon les années, ...

- Pour proposer un même état dans différents formats, il est également possible d'utiliser l'ancrage des champs dans les états. Pour plus de détails, consultez [Ancrer des champs dans un état](../WDChamp/1013298.md). 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Principe
<a name="principe_ELTTEXTE000160"></a>
Pour permettre à l'utilisateur final de choisir l'orientation ou le format de son état : 

1. Plusieurs versions du même état sont créées sous l'éditeur d'états : 

	- un état en mode portrait / un état en mode paysage, 

	- un état au format A4 / un état au format A3 / ...




2. Un groupe d'états est créé par programmation. Ce groupe d'états contient les différentes versions de l'état. 

3. Un des états du groupe d'états est affiché dans le visualisateur de rapports. L'utilisateur peut alors sélectionner au moyen d'une combo la configuration de l'état à imprimer.  <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Groupe_etat%20-%20HC%20N%B0001.gif)





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Mise en place
<a name="mise_place_ELTTEXTE000184"></a>
Pour proposer différents modes d'impression d'un état : 

1. Créez l'état initial et les différentes versions de l'état utilisant un format différent (portrait, paysage, A4, A3, etc.). Chaque état possède un nom différent. 

2. Dans le code d'impression de l'état initial : 

	- Demandez l'affichage dans le visualisateur de rapports (fonction [iDestination](../WDLang5/3046074.md)). 

	- Ajoutez les différents états dans un groupe grâce à la fonction [iGroupeAjoute](../WDLang5/1000020580.md). Si l'état nécessite des paramètres pour son exécution, indiquez ces paramètres grâce à la fonction [iGroupeAjoute](../WDLang5/1000020580.md). 

	- Personnalisez si nécessaire l'image et le libellé présents dans la combo de sélection de l'état grâce à la fonction [iGroupeParamètre](../WDLang5/1000020581.md). Par défaut : 

		- une image correspondant au format est affichée. 

		- les caractéristiques de format sont indiquées (disponible dans l'onglet "Format" de la fenêtre de description de l'état). 




- Lancez l'impression de l'état dans le visualisateur de rapports (fonction [iGroupeImprime](../WDLang5/1000020582.md)). L'état spécifié est affiché dans le visualisateur de rapports. L'utilisateur peut sélectionner le format voulu grâce à la combo présente dans le visualisateur de rapports. 




Exemple de code : 

```wl
// Affichage dans le visualisateur de rapports
iDestination(iVisualisateur)
// Ajout de l'état au groupe
iGroupeAjoute(ETAT_Graphe_Portrait)
// Paramétrage de son libellé
iGroupeParamètre(ETAT_Graphe_Portrait, "Impression en mode Portrait")
// Ajout de l'état au groupe
iGroupeAjoute(ETAT_Graphe_Paysage)
// Paramétrage de son libellé
iGroupeParamètre(ETAT_Graphe_Paysage,"Impression en mode Paysage")
// Lancement de l'impression du premier état dans le visualisateur de rapports
iGroupeImprime()
```


<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Utilisation avancée des groupes d'états
<a name="utilisation_avancee_des_groupes_etats_ELTTEXTE000208"></a>
Les groupes d'états peuvent être utilisés pour proposer plusieurs états plus ou moins différents depuis le visualisateur de rapports. 

Quelques exemples : il est ainsi possible d'utiliser les groupes d'états pour afficher : 

- des états statistiques par année : le même état est affiché plusieurs fois. Seul le paramètre spécifiant l'année est modifié. L'utilisateur peut ainsi afficher directement les états concernant les différentes années depuis le visualisateur de rapports. 

- des états correspondant à un même thème : le groupe d'états comprendra par exemple, l'état de la fiche produit, l'état des statistiques de ventes, l'état des commandes pour le mois en cours, ...









