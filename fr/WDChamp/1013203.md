
## Champs Table, Liste et Combos fichier liés à des requêtes
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000275"></a>
Un champ Table, Liste ou Combo peut être utilisé pour afficher le contenu d'un fichier de données ou d'une requête.

Un champ Table, Liste ou Combo peut être liée à :

- une requête ***indépendante***. Cette requête existe déjà dans le projet : il suffit de sélectionner cette requête parmi les requêtes de votre projet.

- une requête ***intégrée au champ*** : cette requête sera créée dans l'assistant de création du champ Table (Liste ou Combo). Cette requête sera disponible uniquement pour ce champ et sera sauvegardée avec la fenêtre (ou la page) qui l'utilise. Dans ce cas, la fenêtre (ou la page) contient tous les éléments qui sont nécessaires à son fonctionnement.

- une requête ***paramétrée*** : cette requête (indépendante ou intégrée) nécessite des paramètres pour s'exécuter et afficher le résultat dans le champ Table, Liste ou Combo.




**Remarque** : Cette page d'aide présente le cas des champs Table, mais le fonctionnement est identique pour les champs Liste et Combo.





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Champ Table fichier basé sur une requête indépendante (non paramétrée)
<a name="champ_table_fichier_base_sur_une_requete_independante_non_parametree_ELTTEXTE000299"></a>


### Principe
<a name="principe_ELTPARAGRAPHE000038"></a>Un champ Table fichier basé sur une requête indépendante (non paramétrée) affiche les enregistrements de cette requête.

Par défaut, la requête est exécutée et chargée en mémoire lors de sa première utilisation. Le résultat d'une requête utilisée dans un champ Table fichier reste en mémoire lors de la fermeture de la fenêtre associée. Si cette requête est ré-utilisée, elle ne sera pas ré-exécutée.

Pour ré-exécuter cette requête, il est nécessaire d'utiliser :

- soit la fonction [HLibèreRequête](../WDLang4/1000019374.md).

- soit la fonction [HAnnuleDéclaration](../WDLang4/3044174.md).

- soit la fonction [TableAffiche](../WDLang1/3074003.md) (ou [ListeAffiche](../WDLang1/3049005.md) pour un champ Liste ou Combo).





<a name="NOTE2_2"></a>


### Utilisation des fonctions HAnnuleDéclaration / HLibèreRequête
<a name="utilisation_des_fonctions_hannuledeclaration_hlibererequete_ELTPARAGRAPHE000068"></a>

- Si la fonction [HAnnuleDéclaration](../WDLang4/3044174.md) n'est pas appelée, la prochaine initialisation du champ Table (réouverture de la fenêtre par exemple) ne ré-exécutera pas la requête. Les données récupérées lors de la dernière exécution de la requête seront utilisées. Si le champ Table est basé sur une requête paramétrée, consultez le paragraphe "Champ Table fichier basé sur une requête paramétrée (intégrée ou non)".

- Si la fonction [HAnnuleDéclaration](../WDLang4/3044174.md) est appelée, la prochaine initialisation du champ Table (réouverture de la fenêtre par exemple) ré-exécutera la requête.




**Note** : La fonction [HLibèreRequête](../WDLang4/1000019374.md) est basée sur la fonction [HAnnuleDéclaration](../WDLang4/3044174.md). Leur fonctionnement est identique. 

**Exemple** : 

```wl
// Code de fermeture de la fenêtre
HAnnuleDéclaration(TABLE_MaTable.FichierParcouru)
```



<a name="NOTE2_3"></a>


### Actualisation du contenu de la requête
<a name="actualisation_contenu_requete_ELTPARAGRAPHE000096"></a>Il est possible de forcer la ré-exécution de la requête avec la fonction [TableAffiche](../WDLang1/3074003.md) (ou [ListeAffiche](../WDLang1/3049005.md) pour un champ Liste ou Combo) en utilisant la constante ***taRéExécuteRequête***.



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Champ Table fichier basé sur une requête intégrée (non paramétrée)
<a name="champ_table_fichier_base_sur_une_requete_integree_non_parametree_ELTTEXTE000335"></a>


### Principe
<a name="principe_ELTPARAGRAPHE000112"></a>Un champ Table fichier basé sur une requête intégrée (non paramétrée) affiche les enregistrements de cette requête.

Par défaut, la requête est exécutée et chargée en mémoire lors de l'affichage du champ Table. Le résultat d'une requête intégrée à un champ Table fichier est automatiquement effacé de la mémoire lors de la fermeture de la fenêtre associée. Si cette requête est ré-utilisée, elle sera ré-exécutée.
<a name="NOTE3_2"></a>


### Actualisation du contenu de la requête
<a name="actualisation_contenu_requete_ELTPARAGRAPHE000121"></a>Il est possible de forcer la ré-exécution de la requête avec la fonction [TableAffiche](../WDLang1/3074003.md) (ou [ListeAffiche](../WDLang1/3049005.md) pour un champ Liste ou Combo) en utilisant la constante ***taRéExécuteRequête***.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Champ Table fichier basé sur une requête paramétrée (indépendante ou intégrée)
<a name="champ_table_fichier_base_sur_une_requete_parametree_independante_integree_ELTTEXTE000365"></a>


### Principe
<a name="principe_ELTPARAGRAPHE000136"></a>Lorsqu'un champ Table fichier est lié à une requête paramétrée (indépendante ou intégrée), il est nécessaire de passer des paramètres à la requête avant de l'exécuter.

Si ces paramètres ne sont pas spécifiés avant la première exécution de la requête, la requête ne sera pas exécutée, et le champ Table restera vide.

Pour passer les paramètres à la requête, il est possible :

- soit de spécifier les paramètres un par un en utilisant :

	- la notation suivante : 
			
		```txt
		<Nom Requête>.<Nom Paramètre1> = xxx
		<Nom Requête>.<Nom Paramètre2> = xxx
		<Nom Requête>.<Nom Paramètre3> = xxx
		```

			Dans ce cas, la requête est automatiquement exécutée lors de l'initialisation du champ Table.

	- le mot-clé [MaSource](../Motscles/1511001.md) :
			
		```txt
		MaSource.<Nom Paramètre1> = xxx
		MaSource.<Nom Paramètre2> = xxx
		MaSource.<Nom Paramètre3> = xxx
		```


	- l'indirection :
			
		```txt
		{"<Nom Requête>.<Nom Paramètre1>"} = xxx
		ou
		{"<Nom Requête>"}.<Nom Paramètre1> = xxx
		```





- soit de spécifier les paramètres en une seule fois à l'aide de la fonction [HExécuteRequête](../WDLang4/3044080.md).




Ce passage de paramètres peut être utilisé par exemple dans le code de déclaration des globales de la fenêtre ou dans le code d'initialisation du champ Table.

Pour prendre en compte ces paramètres, il suffit d'utiliser la fonction [TableAffiche](../WDLang1/3074003.md) (ou [ListeAffiche](../WDLang1/3049005.md) pour un champ Liste ou Combo).

Pour re-exécuter la requête avec des paramètres différents, il suffit de spécifier ces nouveaux paramètres puis d'utiliser la fonction [TableAffiche](../WDLang1/3074003.md) (ou [ListeAffiche](../WDLang1/3049005.md) pour un champ Liste ou Combo).


<a name="NOTE4_2"></a>


### Passage de paramètres à la requête : notation &lt;Nom Requête&gt;.&lt;Nom Paramètre1&gt; 
<a name="passage_parametres_requete_notation_ELTPARAGRAPHE000187"></a>Tous les paramètres de la requête ne doivent pas obligatoirement être précisés. Les conditions de la requête utilisant des paramètres non précisés seront ignorées. Pour plus de détails sur le passage de paramètres à une requête, consultez [Méthodes à utiliser pour passer des paramètres à une requête](../Editeurs/2032050.md).

**Remarque** : Si aucun paramètre de la requête n'est spécifié avant sa première exécution, la requête ne s'exécutera pas. Le champ Table associée à la requête restera vide.

**Attention** : A chaque exécution de la requête, tous les paramètres de la requête sont ré-initialisées. Les valeurs précédemment utilisées ne sont pas conservées. Il est nécessaire de redéfinir les paramètres souhaités de la requête pour l'exécuter à nouveau.


<a name="NOTE4_3"></a>


### Cas particuliers : Initialisation d'un champ Table ou utilisation de TableAffiche sans la constante taRéExécuteRequête
<a name="cas_particuliers_initialisation_champ_table_utilisation_tableaffiche_sans_constante_tareexecuterequete_ELTPARAGRAPHE000202"></a>

- Si aucun paramètre de la requête n'a été modifié depuis la dernière exécution de la requête, la requête n'est pas ré-exécutée. Le champ Table affichera les enregistrements correspondants à la dernière exécution de la requête.

- Après modification des paramètres de la requête, la fonction [TableAffiche](../WDLang1/3074003.md) (ou [ListeAffiche](../WDLang1/3049005.md) pour un champ Liste ou Combo) permet de ré-exécuter la requête. Le champ Table affiche alors les enregistrements correspondant aux paramètres spécifiés.





<a name="NOTE4_4"></a>


### Cas particulier : Utilisation de la fonction TableAffiche avec la constante taRéExécuteRequête
<a name="cas_particulier_utilisation_fonction_tableaffiche_avec_constante_tareexecuterequete_ELTPARAGRAPHE000217"></a>Pour forcer la ré-exécution de la requête, il suffit d'utiliser la fonction [TableAffiche](../WDLang1/3074003.md) (ou [ListeAffiche](../WDLang1/3049005.md) pour un champ Liste ou Combo) avec la constante *taRéExécuteRequête*.

**Rappel** : La structure des paramètres de la requête étant ré-initialisée à chaque exécution de la requête, n'oubliez pas de re-définir les paramètres souhaités avant d'utiliser cette fonction.




