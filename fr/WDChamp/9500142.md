
## FAA : Export de données (champ Table, Table hiérarchique, Zone répétée, Arbre, ...)
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000159"></a>
Vous souhaitez faire des simulations avec Excel, Word, LibreOffice, ... ? Rien de plus simple. Il suffit "d'exporter" le contenu du champ vers le logiciel de votre choix. Le fichier correspondant est automatiquement créé avec le contenu du champ exporté et peut être manipulé immédiatement sous votre logiciel préféré. 

Les champs proposant cette option sont les champs suivants : 

- Table et Table hiérarchique. 

- Arbre. 

- Zone répétée.

- Tableau croisé dynamique (uniquement vers Excel). 






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Réaliser un export
<a name="realiser_export_ELTTEXTE000183"></a>
Pour réaliser un export vers Excel, Word, ... :

1. Affichez le menu contextuel de la table et sélectionnez l'option "Exporter la table vers ...". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Exportez%20la%20table%20vers.jpg)

	Remarque : Si l'option est suivie d'un cadenas ou d'une étoile, un mot de passe est demandé avant de réaliser l'export.

2. Indiquez le nom du fichier Excel à créer ainsi que son emplacement. 

3. L'application propose alors d'ouvrir directement le fichier créé. 




Remarques : 

- Si le fichier existe déjà, vous avez la possibilité d'écraser le fichier existant ou de le fusionner avec le fichier en cours de création. La fusion permet de conserver toutes les modifications réalisées (par exemple, pour un fichier Excel, format des cellules, formules, ...). 

- Les colonnes de type "Numérique haute précision" (avec 38 chiffres significatifs) sont exportés sous Excel sous forme de nombre exponentiel.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Programmation
<a name="programmation_ELTTEXTE000207"></a>


### Nom du fichier d'export
<a name="nom_fichier_export_ELTPARAGRAPHE000045"></a>Par défaut, le nom de fichier proposé correspond au libellé du champ Table. Ce nom peut être modifié en programmation grâce à la propriété [Libellé](../Proprietes/2510053.md). 

Par exemple : 

```wl
// Pour que le fichier proposé à l'export soit "ExportStat2016"
TABLE_MaTable.Libellé = "ExportStat2016"
```



### Ne pas proposer un export
<a name="pas_proposer_export_ELTPARAGRAPHE000056"></a>Pour ne pas proposer un export dans un champ Table, Table hiérarchique, Arbre ou Zone répétée, il suffit d'utiliser la fonction [FAADésactive](../WDLang1/1000022018.md) : 

- avec la constante *faaTableVersExcel* pour désactiver le menu d'export vers Excel.

- avec la constante *faaTableVersWord* pour désactiver le menu d'export vers Word. 

- avec la constante *faaTableVersXML* pour désactiver le menu d'export vers XML. 




Les options de menu correspondantes ne seront plus affichées. 


### Exécuter un export
<a name="executer_export_ELTPARAGRAPHE000070"></a>Pour réaliser un export par programmation pour un champ Table, Table hiérarchique, Arbre ou Zone répétée, il suffit d'utiliser la fonction [FAAExécute](../WDLang1/1000022099.md) : 

- avec la constante *faaTableVersExcel* pour exporter le contenu du champ vers Excel.

- avec la constante *faaTableVersWord* pour exporter le contenu du champ vers Word. 

- avec la constante *faaTableVersXML* pour exporter le contenu du champ vers XML. 





### Modifier le libellé de l'option
<a name="modifier_libelle_option_ELTPARAGRAPHE000082"></a>Par défaut, l'option de menu permettant à l'utilisateur d'exporter le contenu du champ a pour libellé "Exporter vers Excel", "Exporter vers Word", "Exporter vers XML", ... Pour modifier ce libellé, utilisez la fonction [FAAChangeLibellé](../WDLang1/1000022100.md) : 

- avec la constante *faaTableVersExcel* pour modifier l'option d'export vers Excel.

- avec la constante *faaTableVersWord* pour modifier l'option d'export vers Word. 

- avec la constante *faaTableVersXML* pour modifier l'option d'export vers XML. 





### Sécuriser les exports
<a name="securiser_les_exports_ELTPARAGRAPHE000098"></a>Par défaut, les données affichées dans les champs Table, Table hiérarchique, Arbre ou Zone répétée peuvent être exportées. Si les données affichées dans ces champs sont confidentielles, il est possible : 

- soit d'interdire l'export. Dans ce cas, l'option correspondante n'est pas proposée. 

- soit de demander un mot de passe. Dans ce cas : 

	- un cadenas (ou une étoile '\*') est affiché dans l'option de menu correspondante. 

	- une fenêtre demandant un mot de passe est affichée avant de réaliser l'action. Si le mot de passe est invalide, l'action n'est pas effectuée.







Pour sécuriser les exports réalisés via le menu contextuel des champs Table, Table hiérarchique, Arbre ou Zone répétée, utilisez la fonction [FAASécuritéExport](../WDLang1/1000022481.md). 




