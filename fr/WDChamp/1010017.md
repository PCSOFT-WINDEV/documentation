


## Menu contextuel personnalisé
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000457"></a>
Les menus contextuels personnalisés sont créés sous l'éditeur de fenêtres et peuvent être manipulés par programmation.

Il est possible de créer des menus contextuels personnalisés et d'associer ces menus contextuels :

- soit à un ou plusieurs champs d'une fenêtre.

- soit à une fenêtre.




Remarques :

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Si un menu contextuel des FAA est disponible pour ce champ ou cette fenêtre, il est possible :

	- d'afficher ce menu des FAA (ou seulement quelques options).

	- d'afficher le menu contextuel personnalisé avant ou après le menu contextuel des FAA.

	- d'afficher uniquement le menu contextuel personnalisé.







Cette page d'aide présente comment : 

- [Créer un menu contextuel personnalisé](#NOTE2_1). 

- [Associer un menu contextuel personnalisé à un élément](#NOTE3_1). 

- [Lister les menus contextuels personnalisés disponibles](#NOTE4_1).

- [Editer un menu contextuel personnalisé](#NOTE5_1).  

- [Manipuler un menu contextuel personnalisé par programmation](#NOTE6_1).




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Créer un menu contextuel personnalisé
<a name="creer_menu_contextuel_personnalise_ELTTEXTE000481"></a>


### Créer un menu contextuel personnalisé
<a name="creer_menu_contextuel_personnalise_ELTPARAGRAPHE000061"></a>Pour créer un menu contextuel personnalisé :

1. Sous le volet "Fenêtre", dans le groupe "Barres et menus", déroulez "Menus contextuels" et sélectionnez "Nouveau menu contextuel". La fenêtre d'édition du nouveau menu contextuel personnalisé s'ouvre.
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Menu_contextuel_personnalis%E9%20-%20HC%20N%B0001.gif)


2. Modifiez si nécessaire la description du menu contextuel (nom du menu contextuel, ...) : 

	- Affichez le menu contextuel de l'option de la fenêtre d'accueil (clic droit dans la fenêtre d'accueil). 

	- Sélectionnez l'option "Description du menu contextuel". Vous pouvez : 

		- Modifier le nom du menu contextuel. 

		- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Indiquer si le menu doit utiliser : 

			- le look système. 

			- le look Windows 11.




- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Indiquer le libellé du menu contextuel.

- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Spécifier si le menu contextuel doit être déplacé dans l'action bar.

3. Ajoutez des options de menu dans le nouveau menu contextuel. Pour plus de détails, consultez [Manipuler les options de menu](../WDChamp/1010008.md).





### Autres modes de création
<a name="autres_modes_creation_ELTPARAGRAPHE000105"></a>Il est également possible de créer un menu contextuel personnalisé :

- depuis l'onglet "UI" de la description d'une fenêtre ou d'un champ d'une fenêtre. Il suffit de cliquer sur le bouton à droite de la combo "Menu contextuel" et de sélectionner l'option "Créer un nouveau menu contextuel". La fenêtre d'édition du nouveau menu contextuel personnalisé s'ouvre. Ce menu contextuel sera automatiquement associé à l'élément en cours (à tous les éléments en cas de multisélection).
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Menu_contextuel_personnalis%E9%20-%20HC%20N%B0002.gif)


- depuis la fenêtre "Gestion des menus contextuels". Il suffit de cliquer sur le bouton "Nouveau" et de saisir le nom du nouveau menu contextuel.
	Remarque : Pour ouvrir la fenêtre "Gestion des menus contextuels", sous le volet "Fenêtre", dans le groupe "Barres et menus", déroulez "Menus contextuels" et sélectionnez "Editer".







### Menu contextuel Windows 11
<a name="menu_contextuel_windows_11_ELTPARAGRAPHE000138"></a>Les menus contextuels Windows 11 ont un look spécifique :

- les espacements sont plus importants pour une meilleure visibilité,

- une animation est effectuée à l'ouverture,

- une ombre permet de mettre en relief le menu,

- une première ligne propose les options les plus utilisées sous l'apparence de mini-icônes.




Pour créer un menu contextuel au look Windows 11 : 

1. Sous le volet "Fenêtre", dans le groupe "Barres et menus", déroulez "Menus contextuels" et sélectionnez "Nouveau menu contextuel". La fenêtre d'édition du nouveau menu contextuel personnalisé s'ouvre.

2. Affichez la fenêtre de description du menu contextuel. Dans l'onglet "Général", pour l'option "Style du menu", sélectionnez l'option "Windows 11". 

3. Validez. 




Pour proposer une option de menu en première ligne sous forme d'icône : 

1. Sélectionnez l'option à afficher en première ligne. 

2. Affichez la fenêtre de description de l'option.

3. Dans l'onglet "UI" : 

	- Indiquez l'image de l'option et son nombre d'états. 

	- Cochez l'option "Afficher cette option comme bouton en haut du menu
(Style Windows 11)". 




4. Validez. L'option en cours s'affiche uniquement en tant qu'icône dans la première ligne du menu contextuel. 











### Limites
<a name="limites_ELTPARAGRAPHE000183"></a>




<a name="NOTE3_1"></a>


## Associer un menu contextuel personnalisé à un élément
<a name="associer_menu_contextuel_personnalise_element_ELTTEXTE000523"></a>


### Comment le faire ?
<a name="comment_faire_ELTPARAGRAPHE000223"></a>Pour associer un menu contextuel personnalisé existant à un ou plusieurs éléments (fenêtre ou champs) :

1. Sélectionnez le ou les éléments à associer à un menu contextuel existant.

2. Affichez l'onglet "UI" de la fenêtre de description du ou des éléments en cours (option "Description" du menu contextuel).

3. Le champ "Menu contextuel" permet de paramétrer le menu contextuel :

	- le bouton ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_Fleche.gif)
 permet de créer un nouveau menu contextuel.

	- la combo permet :

		- d'afficher le menu contextuel des FAA et de paramétrer les options qui seront affichées pour le champ en cours.

		- d'afficher un menu contextuel personnalisé. Ce menu contextuel peut remplacer le menu contextuel des FAA ou bien être affiché avant ou après le menu contextuel des FAA.




4. Validez.




Remarques :

- Pour éditer le menu contextuel personnalisé sélectionné, cliquez sur le bouton ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_Fleche.gif)
 à droite du champ "Menu contextuel" et sélectionnez l'option "Editer ce menu contextuel".

- Pour associer une fenêtre ou un champ à un menu contextuel personnalisé existant par programmation, utilisez la propriété [MenuContextuel](../Proprietes/2510077.md).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Pour plus de détails sur le menu contextuel des FAA, consultez [Configurer les menus des FAA](../Editeurs/2010040.md).





### Cas particulier : Menu contextuel d'un champ Table
<a name="cas_particulier_menu_contextuel_champ_table_ELTPARAGRAPHE000269"></a>

- Si des menus contextuels différents sont associés à un champ Table et à ses colonnes, le menu contextuel associé aux colonnes sera prioritaire. Lors d'un clic droit sur une colonne, seul le menu contextuel associé à la colonne sera affiché.

- Si toutes les colonnes d'un champ Table sont associées à un ou plusieurs menus contextuels, le menu contextuel associé à ce champ ne sera jamais affiché.

- Le menu contextuel des FAA associé à une colonne d'un champ Table correspond au menu associé au champ Table. Les options de ce menu ne sont pas paramétrables.





### Remarques
<a name="remarques_ELTPARAGRAPHE000276"></a>

- Il est possible d'associer un menu contextuel personnalisé aux champs d'une fenêtre (y compris aux colonnes d'un champ Table) et aux fenêtres.

- Il n'est pas possible d'associer un menu contextuel personnalisé aux éléments suivants :

	- champ Libellé,

	- champ Image non cliquable,

	- champ Jauge,

	- champ Forme,

	- option de menu. 




- Lors d'un "Copier/Coller" d'un champ d'une fenêtre vers une fenêtre, les différentes caractéristiques du champ copiées sont conservées. Si le champ copié est associé à un menu contextuel personnalisé, ce menu contextuel personnalisé sera disponible dans les deux fenêtres.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Lister les menus contextuels personnalisés disponibles
<a name="lister_les_menus_contextuels_personnalises_disponibles_ELTTEXTE000559"></a>
Pour connaître l'ensemble des menus contextuels personnalisés disponibles dans une fenêtre, sous le volet "Fenêtre", dans le groupe "Barres et menus", déroulez "Menus contextuels" et sélectionnez "Editer". Ces menus contextuels peuvent être associés à cette fenêtre ou aux champs de cette fenêtre.

<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Editer un menu contextuel personnalisé
<a name="editer_menu_contextuel_personnalise_ELTTEXTE000583"></a>
Un menu contextuel peut être édité par une des méthodes suivantes :

- sous le volet "Fenêtre", dans le groupe "Barres et menus", déroulez "Menus contextuels" et sélectionnez "&lt;NomMenuContextuel&gt;".

- depuis l'onglet "UI" de la description d'une fenêtre ou d'un champ associé à ce menu contextuel :

	- Sélectionnez le menu contextuel à éditer dans la combo "Menu contextuel".

	- Cliquez sur le bouton ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_Fleche.gif)
 à droite du champ "Menu contextuel" et sélectionnez l'option "Editer ce menu contextuel".




- depuis la fenêtre "Gestion des menus contextuels" :

	- Sélectionnez le menu contextuel à éditer.

	- Cliquez sur le bouton "Éditer".







Remarques : Pour plus de détails sur les modifications d'un menu contextuel personnalisé, consultez [Manipuler les options de menu sous l'éditeur](../WDChamp/1010008.md).

<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Supprimer un menu contextuel personnalisé
<a name="supprimer_menu_contextuel_personnalise_ELTTEXTE000607"></a>
Pour supprimer un menu contextuel personnalisé : 

1. Sous le volet "Fenêtre", dans le groupe "Barres et menus", déroulez "Menus contextuels" et sélectionnez "Editer".

2. Sélectionnez le menu contextuel personnalisé à supprimer.

3. Cliquez sur le bouton "Supprimer". La fenêtre et/ou les champs associés au menu contextuel supprimé ne seront plus associés à un menu contextuel personnalisé. Pour les champs ayant un menu contextuel système par défaut (menu des FAA), ce menu contextuel système remplacera le menu contextuel personnalisé supprimé.




<a name="NOTE7"></a>
<a name="NOTE7_1"></a>


## Manipuler un menu contextuel personnalisé par programmation
<a name="manipuler_menu_contextuel_personnalise_par_programmation_ELTTEXTE000631"></a>
Pour manipuler les menus contextuels personnalisés par programmation, les fonctions et propriétés suivantes sont disponibles :


|   |   |
| --- | --- |
| Fonction [ChampContextuel](../WDLang1/3025012.md) | Identifie le champ sur lequel un menu contextuel personnalisé a été ouvert (à utiliser dans le code du menu contextuel personnalisé). |
| Fonction [OuvreMenuContextuel](../WDLang1/3025029.md) | Permet d'ouvrir automatiquement le menu contextuel d'un champ ou d'une fenêtre. Il est possible de choisir le menu contextuel à ouvrir et sa position. |
| Propriété [MenuContextuel](../Proprietes/2510077.md) | Permet de connaître et de changer le menu contextuel personnalisé associé à un champ ou à une fenêtre. Permet également :<br><br>- d'associer ou non un champ à un menu contextuel.<br><br>- d'afficher ou non le menu contextuel système par défaut.<br><br><br> |

Remarque : Il est également possible de [manipuler les options de menu par programmation](../WDChamp/1010007.md).


