


## Etat Agenda
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000191"></a>
L'éditeur d'états offre la possibilité de créer des états de type "Agenda". 

L'état est alors constitué uniquement d'un champ Agenda. Ce type de champ est créé uniquement lors de la création d'un état Agenda : il ne peut pas être créé indépendamment de cet état. 

Exemple : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Etat_Agenda%20-%20HC%20N%B0001.gif&type=thumb)
Sous l'éditeur, ce champ est constitué de deux blocs : 

- Le bloc "En-tête" affichant les titres des colonnes de l'agenda. 

- Le bloc "Agenda" affichant les rendez-vous dans un champ Agenda. 



<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Etat_Agenda_Editeur%20-%20HC%20N%B0001.gif&type=thumb)




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Créer un état Agenda
<a name="creer_etat_agenda_ELTTEXTE000215"></a>


### Création de l'état
<a name="creation_etat_ELTPARAGRAPHE000037"></a>Pour créer un état de type "Agenda" : 

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif) parmi les boutons d'accès rapide. 

	- La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Etat" puis sur "Etat".

	- L'assistant de création d'un état se lance.




2. Sélectionnez un état de type "Agenda ou Planning". 

3. Indiquez dans la suite de l'assistant : 

	- le type d'état à créer ("Etat Agenda") avec les [informations spécifiques à la création d'un agenda](#NOTE2_2) : 

		- le mode d'affichage initial.

		- le nombre de jours affichés. 

		- la granularité du quadrillage. 




- le modèle utilisé si nécessaire,

- la source de données de l'état (fichier de données, requête, champ Agenda, ...). Pour plus de détails, consultez [Source de données d'un état](../WDChamp/1011055.md).



<a name="NOTE2_2"></a>


### Informations spécifiques à la création de l'état Agenda
<a name="informations_specifiques_creation_etat_agenda_ELTPARAGRAPHE000067"></a>Les informations spécifiques à la création de l'état Agenda sont les suivantes :

- Mode d'affichage initial : L'agenda peut être affiché : 

	- au jour,

	- à la semaine,

	- au mois. 




- La granularité du quadrillage. Cette granularité permet de définir la taille de la grille utilisée pour afficher le quadrillage du champ Agenda. Par défaut, cette granularité est de 30 minutes. Selon le nombre de jours à afficher, il est nécessaire de modifier cette information. 
	Cette caractéristique peut être modifiée par programmation grâce à la propriété [GranularitéQuadrillage](../Proprietes/1000020107.md). 




**Remarque** :  Si l'état Agenda est lié à une source de données (requête, fichier de données), il est nécessaire d'indiquer dans la suite de l'assistant les rubriques à prendre en compte pour l'affichage des rendez-vous. Les informations principales à indiquer sont : 

- le titre du rendez-vous. 

- la date de début et de fin du rendez-vous. 




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Caractéristiques d'un état Agenda et d'un champ Agenda
<a name="caracteristiques_etat_agenda_champ_agenda_ELTTEXTE000245"></a>
Il est possible de modifier les caractéristiques suivantes d'un état Agenda : 

- La source de données de l'état Agenda peut être modifiée dans l'onglet "Données" de la fenêtre de description de l'état (option "Description de l'état" dans le menu contextuel de l'état). 

- L'onglet "Général" de la fenêtre de description du champ Agenda permet de spécifier : 

	- le mode d'affichage initial : Jour, semaine, mois. 

	- le nombre de jours affichés. 

	- la plage horaire visible. 

	- le premier jour de la semaine.

	- la granularité du quadrillage.

	- l'affichage des rendez-vous à la journée entière. Si l'option "Afficher les rendez-vous à la journée entière" est cochée, l'état prend en charge les rendez-vous pour lesquels la caractéristique "Journée entière" est gérée (pour plus de détails, consultez [Variable de type RendezVous](../WDLang1/1000019244.md)). Dans ce cas, une zone permettant d'afficher les rendez-vous à la journée apparaît dans l'agenda : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Agenda_journee_Etat.gif)
Remarque : Vérifiez que la zone d'affichage des rendez-vous à la journée est correctement dimensionnée sous l'éditeur d'états. Il est possible de la redimensionner si nécessaire. 

	- le masque d'affichage de la date et des horaires. 

	- l'état personnalisé pour afficher les rendez-vous. 

		- Si l'option sélectionnée est "Aucun", l'affichage par défaut est utilisé. 

		- Si l'option "Etat prédéfini" est sélectionnée, un état prédéfini est automatiquement ajouté au projet. Par défaut, cet état a pour nom "ETAT_WinDevVueRDV" et est automatiquement utilisé pour l'affichage des rendez-vous.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Etat_WinDevvueRDV.gif)
Cet état peut être personnalisé, renommé, ...

		- Si l'option sélectionnée correspond à un état du projet, cet état sera utilisé pour afficher les rendez-vous.
						Il est conseillé de personnaliser l'état proposé par défaut.
						Le même état peut être utilisé pour personnaliser les rendez-vous dans un état planning ou agenda.  




- Si le champ Agenda est lié à une source de données (fichier de données, requête, ...), l'onglet "Contenu" de la fenêtre de description du champ permet de lier les données du rendez-vous avec les données présentes dans la source de données. 

- L'onglet "Style" de la fenêtre de description du champ Agenda permet de spécifier le style des rendez-vous affichés dans le champ Agenda. 




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Manipulation d'un agenda dans un état par programmation
<a name="manipulation_agenda_dans_etat_par_programmation_ELTTEXTE000269"></a>


### Fonctions WLangage
<a name="fonctions_wlangage_ELTPARAGRAPHE000133"></a>Différentes fonctions WLangage sont disponibles dans l'éditeur d'états pour manipuler les champs Agenda. Ces fonctions sont les suivantes : 



|   |   |
| --- | --- |
| [AgendaAjouteRendezVous](../WDLang1/1000018877.md) | Ajoute un nouveau rendez-vous dans un champ Agenda. |
| [AgendaChangeMode](../WDLang1/1000019497.md) | Modifie la plage temporelle affichée par un champ Agenda (Jour/Semaine/Mois). |
| [AgendaChangeZoom](../WDLang1/1000018883.md) | Modifie la plage temporelle affichée par un champ Agenda (Jour/Semaine/Mois). Cette fonction est conservée par compatibilité. |
| [AgendaCouleurFond](../WDLang1/1000020004.md) | Fixe une couleur de fond sur une plage horaire d'un champ Agenda. |
| [AgendaHeureAffichée](../WDLang1/1000018888.md) | Définit la plage horaire affichée par le champ Agenda en mode Jour ou Semaine. |
| [AgendaListeRendezVous](../WDLang1/1000018880.md) | Renvoie : <br><br>- la liste des rendez-vous compris entre deux dates données dans un champ Agenda, <br><br>- tous les rendez-vous d'un champ Agenda,<br><br>- un rendez-vous particulier (sélectionné ou survolé).<br><br><br> |
| [AgendaMode](../WDLang1/1000019545.md) | Renvoie le mode d'affichage par un champ Agenda : jour, semaine, mois, ... |
| [AgendaPosition](../WDLang1/1000018889.md) | Affiche un champ Agenda à partir d'une date spécifiée ou renvoie la date du premier jour (ou dernier jour) affiché dans un champ Agenda. |
| [AgendaSupprimeRendezVous](../WDLang1/1000018881.md) | Supprime un rendez-vous dans un champ Agenda. |
| [AgendaSupprimeTout](../WDLang1/1000018882.md) | Supprime tous les rendez-vous d'un champ Agenda. |
| [AgendaZoom](../WDLang1/1000018884.md) | Renvoie la plage temporelle affichée par un champ Agenda. |




<a name="NOTE4_2"></a>


### Propriétés WLangage
<a name="proprietes_wlangage_ELTPARAGRAPHE000141"></a>Différentes propriétés WLangage sont disponibles dans l'éditeur d'états pour manipuler les champs Agenda. Ces propriétés sont les suivantes : 



|   |   |
| --- | --- |
| [DateDébutPériodeAffichée](../Proprietes/1000020183.md) | La propriété **DateDébutPériodeAffichée** permet de connaître la date de début de la période affichée dans un champ Planning ou Agenda d'un état. |
| [DateFinPériodeAffichée](../Proprietes/1000020184.md) | La propriété **DateFinPériodeAffichée** permet de connaître la date de fin de la période affichée dans un champ Planning ou Agenda d'un état. |
| [GranularitéQuadrillage](../Proprietes/1000020107.md) | La propriété **GranularitéQuadrillage** permet de connaître et de modifier la taille de la grille utilisée pour l'affichage du quadrillage dans un champ Planning ou un champ Agenda d'un état. |
| [Hauteur](../Proprietes/2510050.md) | La propriété **Hauteur** permet de connaître et modifier la hauteur :<br><br>- d'un champ ou d'un bloc dans un état.<br><br>- d'un champ (présent dans une fenêtre), d'une fenêtre, d'une ligne d'un champ Table ou Liste (y compris Liste image), d'une option d'un champ Sélecteur ou Interrupteur, d'un haut ou d'un bas de rupture d'un champ Table ou d'un champ Zone répétée.<br><br>- d'un champ (présent dans une page), d'un haut ou bas de rupture d'un champ Table ou Zone répétée. Le champ peut être superposable ou non.<br><br>- d'une cellule de rupture d'un champ Table ou d'un champ Zone répétée.<br><br><br> |
| [Largeur](../Proprietes/2510059.md) | La propriété **Largeur** permet de connaître et modifier la largeur :<br><br>- d'un champ ou d'un bloc dans un état.<br><br>- d'un champ (présent dans une fenêtre), d'une fenêtre, d'une colonne de table ou d'une colonne de liste (y compris liste image).<br><br>- d'un champ (présent dans une page), d'une colonne de table ou d'une liste. Le champ peut être superposable ou non.<br><br><br> |
| [LibelléPériodeEntête](../Proprietes/1000020185.md) | La propriété **LibelléPériodeEntête** permet de connaître et de modifier le contenu du libellé de la période affiché dans l'entête d'un champ Planning ou Agenda dans un état. <br><br> |
| [Nom](../Proprietes/2510082.md) | La propriété **Nom** permet de connaître :<br><br>- le nom de la police associée à une variable de type Police.<br><br>- le nom d'un champ, d'un état ou d'un bloc d'un état.<br><br>- le nom d'un champ, d'un groupe de champs ou d'une fenêtre.<br><br>- le nom d'un champ, d'un groupe de champs ou d'une page.<br><br><br> |
| [PoliceContenuRendezVous](../Proprietes/1000020685.md) | La propriété **PoliceContenuRendezVous** permet de :<br><br>- Connaître les caractéristiques de la police utilisée pour le contenu des rendez-vous dans les états de type Planning et Agenda. <br><br>- Modifier les caractéristiques de la police utilisée pour le contenu des rendez-vous dans les états de type Planning et Agenda.<br><br><br> |
| [PoliceTitreRendezVous](../Proprietes/1000020684.md) | La propriété **PoliceTitreRendezVous** permet de :<br><br>- Connaître les caractéristiques de la police utilisée pour le titre des rendez-vous dans les états de type Planning et Agenda. <br><br>- Modifier les caractéristiques de la police utilisée pour le titre des rendez-vous dans les états de type Planning et Agenda.<br><br><br> |
| [Visible](../Proprietes/2510138.md) | La propriété **Visible** permet de :<br><br>- Savoir si un élément est visible.<br><br>- Rendre un élément visible ou invisible.<br><br><br> |
| [X](../Proprietes/2510135.md) | La propriété **X** permet de :<br><br>- Connaître l'abscisse d'un champ, d'une colonne d'un champ Table ou d'une fenêtre (position sur l'axe des X).<br><br>- Modifier l'abscisse d'un champ ou d'une fenêtre (position sur l'axe des X).<br><br><br> |
| [Y](../Proprietes/2510137.md) | La propriété **Y** permet de :<br><br>- Connaître l'ordonnée d'un champ ou d'une fenêtre (position sur l'axe des Y).<br><br>- Modifier l'ordonnée d'un champ ou d'une fenêtre (position sur l'axe des Y).<br><br><br> |






