


## Enchaîner des états
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000176"></a>
<a name="Enchainer"></a>
Dans certains cas, il peut être nécessaire d'imprimer des états différents à la suite, visibles en même temps dans le visualisateur de rapports. 

Les états composites répondent à ce besoin dans le cas où l'enchaînement des états est connu d'avance. 

Si l'enchaînement n'est pas connu d'avance et doit être programmé, il est possible d'utiliser l'enchaînement des états par programmation.

![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Enchainement_Etats.gif&type=thumb)
 
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Remarque : Il est également possible d'ajouter dans l'enchaînement : 

- un document de type Traitement de texte.

- un document PDF.

- un document XLS ou XLSX.

- un document de type diagramme.




<a name="NOTE2"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000200"></a>
<a name="NOTE2_1"></a>
Pour enchaîner des états par programmation : 

1. Pour ajouter : 

	- un état à l'enchaînement, utilisez la fonction [iEnchaînementAjoute](../WDLang5/1000020059.md). Cette fonction doit être utilisée pour chaque état à ajouter à l'enchaînement. Cette fonction permet de passer des paramètres à l'état à imprimer. 

	- ![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) un document de type Traitement de texte à l'enchaînement, utilisez la fonction [iEnchaînementAjouteDoc](../WDLang5/1000023089.md). Cette fonction permet de spécifier le document de type Traitement de texte à imprimer.

	- ![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) un document PDF à l'enchaînement, utilisez la fonction [iEnchaînementAjoutePDF](../WDLang5/1000023468.md). Cette fonction permet de spécifier le document de type PDF à imprimer.

	- ![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) un document XLS ou XLSX à l'enchaînement, utilisez la fonction [iEnchaînementAjouteXLS](../WDLang5/1000023518.md). Cette fonction permet de spécifier le document de type XLS ou XLSX à imprimer.

	- ![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) un diagramme (fichier WDDiag) à l'enchaînement, utilisez la fonction [iEnchaînementAjouteDiagramme](../WDLang5/1410088662.md). Cette fonction permet de spécifier le document de type diagramme à imprimer.




2. Pour finir l'enchaînement et lancer l'impression, utilisez la fonction [iEnchaînementImprime](../WDLang5/1000019903.md). 




Exemple : 

```wl
MonDocument est un Document = "c:\temp\conditiongenerales.docx"
MonTableur est une chaîne = "c:\temp\tarif.xls"

// Impression dans le visualisateur de rapports
iDestination(iVisualisateur)

// Ajout des états dans l'enchaînement
iEnchaînementAjoute(ETAT_Etat_Portrait)
iEnchaînementAjoute(ETAT_Etat_Paysage, 3)
// Ajout des conditions générales sous forme d'un document
iEnchaînementAjouteDoc(MonDocument)
// Ajout des tarifs sous forme d'une feuille XLS
iEnchaînementAjouteXLS(MonTableur)
iEnchaînementImprime()
```


**Remarques** : 

- Les pages des états présents dans l'enchaînement sont numérotées séquentiellement. Il est possible de modifier la numérotation grâce à la fonction [iNumPage](../WDLang5/3046013.md). 

- Les états présents dans l'enchaînement peuvent avoir des orientations différentes (portait et/ou paysage). 

- Les états ne sont pas exécutés au moment de l'exécution de la fonction [iEnchaînementAjoute](../WDLang5/1000020059.md) : seul leur nom et leurs paramètres sont mémorisés. 
	Ces états sont réellement exécutés lors de l'appel de la fonction [iEnchaînementImprime](../WDLang5/1000019903.md). 
	Attention : Si des états présents dans l'enchaînement sont basés sur une requête, l'initialisation de la requête doit être effectuée avec la fonction [iInitRequêteEtat](../WDLang5/1000003046021.md) dans le code d'initialisation de l'état (et non avant l'appel de la fonction [iEnchaînementAjoute](../WDLang5/1000020059.md)).





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDEtats.gif) ***Exemples didactiques (WINDEV)*** : **WD Etats** <br>Cet exemple montre les différentes méthodes pour réaliser un état :<br> <br>- impressions basées sur différentes sources de données (requêtes, variables, ...)<br>- impressions basées sur des champs (Table, Tableur, TCD, ...)<br>- impression d'états composés<br>- impressions spécifiques (portrait / paysage, état avec filigrane, état avec code-barres, ...)


