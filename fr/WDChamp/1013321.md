


## Manipuler un champ Sélecteur par programmation (syntaxe préfixée)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000113"></a>
WINDEV, WEBDEV et WINDEV Mobile permettent de manipuler un champ Sélecteur directement par programmation. Il suffit d'utiliser directement la variable du champ Sélecteur dans le code.

Quel que soit le type de sélecteur, il est possible d'associer à chaque option :

- ***un entier***. Cet entier peut prendre une valeur de 1 à N, N étant le nombre total d'options du sélecteur. La première option a le numéro 1, la seconde le numéro 2, ... Les options sont numérotées de haut en bas et de gauche à droite.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) ***une valeur renvoyée spécifique***. Cette valeur renvoyée est spécifiée dans l'onglet "Contenu" de la fenêtre de description du champ.


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) **Utiliser la numérotation ou les valeurs renvoyées ?**
La programmation des sélecteurs renvoyant un entier est différente de celle des sélecteurs renvoyant une valeur. L'avantage de l'utilisation des valeurs renvoyées est visible lors de l'insertion ou du déplacement d'une option dans le sélecteur :

- ***Si le sélecteur renvoie un entier***, l'insertion ou le déplacement d'une option dans le sélecteur oblige à revoir tout le code de gestion de la valeur du sélecteur (pour gérer le décalage des numéros).

- ***Si le sélecteur renvoie une valeur spécifique***, l'insertion d'une option dans le sélecteur entraîne uniquement la prise en compte de la nouvelle option. Le déplacement d'une option n'entraîne aucune modification.




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Remarque** : Plusieurs fonctions WLangage permettent d'ajouter, d'insérer ou de supprimer des options dans un champ Sélecteur. Pour plus de détails, consultez [Fonctions de gestion des champs Sélecteur](../WDLang1/1000021190.md).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Initialiser le choix d'un champ Sélecteur
<a name="initialiser_choix_champ_selecteur_ELTTEXTE000162"></a>
Par défaut, à l'affichage d'un champ Sélecteur, la première option est sélectionnée.

**Pour cocher une option d'un champ Sélecteur** : 

- si le champ Sélecteur renvoie un entier, utilisez la syntaxe suivante :
	
	```txt
	<Champ Sélecteur> = <Indice de l'option>
	```


- si le champ Sélecteur renvoie une valeur spécifique (uniquement sous WINDEV et WINDEV Mobile), utilisez la syntaxe suivante :
	
	```txt
	<Champ Sélecteur> = <Valeur de l'option>
	```



La sélection d'une option décoche l'option actuellement sélectionnée.

**Remarque** : Si le champ est associé à une rubrique d'un fichier de données, l'affectation est automatiquement réalisée en utilisant : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) la fonction [&lt;Fenêtre&gt;.DepuisFichier](../WDLang4/1000021387.md). 


Pour plus de détails, consultez [Champ Sélecteur lié à une rubrique](../WDChamp/1013250.md).
<a name="NOTE2_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Afficher un champ Sélecteur sans option par défaut
<a name="afficher_champ_selecteur_sans_option_par_defaut_ELTPARAGRAPHE000230"></a>Par défaut, un champ Sélecteur est toujours positionné sur une position (1 par défaut).

Pour afficher un champ Sélecteur sans option par défaut, il suffit d'affecter la valeur initiale du champ à :

- -1 pour un champ Sélecteur renvoyant un entier,

- "" (chaîne vide) pour un champ Sélecteur renvoyant une valeur.




**Remarque** : Par défaut, un champ Sélecteur sans valeur par défaut est inaccessible par TAB.

**Exemple** :

```wl
// Affichage du champ Sélecteur sans valeur initiale
SEL_MonSélecteur = -1 
// ou SEL_MonSélecteur = ""
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Récupérer l'option sélectionnée dans un champ Sélecteur
<a name="recuperer_option_selectionnee_dans_champ_selecteur_ELTTEXTE000245"></a>


### Cas d'un champ Sélecteur renvoyant un entier
<a name="cas_champ_selecteur_renvoyant_entier_ELTPARAGRAPHE000268"></a>**Pour récupérer l'indice de l'option sélectionnée** dans le champ Sélecteur, utilisez la syntaxe suivante : 

```txt
<Indice de l'option> = <Champ Sélecteur>
```

Dans ce cas, le paramètre &lt;Indice de l'option&gt; est un entier correspondant au numéro de l'option sélectionnée.

**Pour obtenir le libellé de l'option sélectionnée** dans le champ Sélecteur, utilisez la syntaxe suivante :

```txt
<Libellé de l'option> = <Champ Sélecteur>[<Champ Sélecteur>].Libellé
```

**Remarque** : Si le champ est associé à une rubrique d'un fichier de données, la récupération de la valeur saisie est automatiquement réalisée en utilisant : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) la fonction [&lt;Fenêtre&gt;.VersFichier](../WDLang4/1000021385.md).


Pour plus de détails, consultez [Lier un champ Sélecteur à une rubrique](../WDChamp/1013250.md).
<a name="NOTE3_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 

### Cas d'un champ Sélecteur renvoyant une valeur
<a name="cas_champ_selecteur_renvoyant_une_valeur_ELTPARAGRAPHE000312"></a>**Pour récupérer la valeur de l'option sélectionnée** dans le champ Sélecteur, utilisez la syntaxe suivante :

```txt
<Valeur de l'option> = <Champ Sélecteur>
```

Dans ce cas, le paramètre &lt;Valeur de l'option&gt; est une chaîne de caractères correspondant à la valeur renvoyée de l'option sélectionnée.

**Remarque** : La propriété [ValeurRenvoyée](../Proprietes/2510134.md) permet également de connaître et de modifier la valeur renvoyée par chaque option du champ Sélecteur.

**Pour récupérer l'indice de l'option sélectionnée**, il est nécessaire de réaliser un traitement spécifique. Exemple :

```wl
// Valeur renvoyée de l'option sélectionnée
Résultat1 = SEL_PlatDuJour
// Recherche de l'indice de l'option sélectionnée
Indice est un entier
I est un entier
POUR I = 1 _A_ SEL_PlatDuJour.Occurrence
	SI SEL_PlatDuJour[I].ValeurRenvoyée = Résultat1 ALORS Indice = I
FIN
```


**Pour obtenir le libellé de l'option sélectionnée** dans le champ Sélecteur, utilisez la syntaxe suivante :

```txt
<Libellé de l'option> = <Champ Sélecteur>[<Indice de l'option>].Libellé
```
**Remarque** : Si le champ est associé à une rubrique d'un fichier de données, la récupération de la valeur saisie est automatiquement réalisée en utilisant : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) la fonction [&lt;Fenêtre&gt;.VersFichier](../WDLang4/1000021385.md).


Pour plus de détails, consultez [Lier un champ Sélecteur à une rubrique](../WDChamp/1013250.md).
<a name="NOTE3_3"></a>


### SELON pré-rempli sur les champs Sélecteur
<a name="selon_prerempli_sur_les_champs_selecteur_ELTPARAGRAPHE000364"></a>Lors de la saisie sous l'éditeur de code de l'instruction SELON relative à un champ Sélecteur, l'éditeur de code ajoute automatiquement les CAS correspondant aux différentes options du champ Sélecteur. Le libellé de chaque option est ajouté automatiquement en commentaire de la ligne. 

Quelques exemples : 

- Code pour un champ Sélecteur renvoyant un entier : la saisie de "SELON SEL_Civilité" sous l'éditeur de code affiche : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Selon_auto_Selecteur2.gif)


- Code pour un champ Sélecteur renvoyant une valeur : la saisie de "SELON SEL_PlatDuJour" sous l'éditeur de code affiche : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Selon_auto_Selecteur1.gif)





<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Modifier le libellé d'un champ Sélecteur
<a name="modifier_libelle_champ_selecteur_ELTTEXTE000378"></a>
La propriété [Libellé](../Proprietes/2510053.md) permet de :

- **changer le libellé du champ Sélecteur** : 
	
	```txt
	<Champ Sélecteur>.Libellé = <Libellé>
	```


- **changer le libellé de toutes les options du champ Sélecteur** :
	Chaque option doit être séparée des autres par le caractère TAB.
	Il est possible de spécifier uniquement les premières options.
	
	```txt
	<Champ Sélecteur>.Libellé = <Option 1>+TAB+<Option 2>+TAB+<Option 3> ...
	```


- **récupérer et modifier le libellé d'une option** :
	
	```txt
	// Récupération du sous-libellé
	<Sous-Libellé> = <Champ Sélecteur>[<Indice de l'option>].SousLibellé
	
	// Modification du sous-libellé
	<Champ Sélecteur>[<Indice de l'option>].SousLibellé = <Nouveau sous-libellé>
	```




<a name="NOTE4_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 

### Cas des champs Sélecteur avec sous-libellés
<a name="cas_des_champs_selecteur_avec_souslibelles_ELTPARAGRAPHE000428"></a>La propriété [SousLibellé](../Proprietes/1000017232.md) permet de connaître et de modifier les sous-libellés des options du champ Sélecteur.

```txt
// Récupération du sous-libellé
<Sous-Libellé> = <Champ Sélecteur>[<Indice de l'option>].SousLibellé

// Modification du sous-libellé
<Champ Sélecteur>[<Indice de l'option>].SousLibellé = <Nouveau sous-libellé>
```


<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Modifier les couleurs des libellés des options d'un champ Sélecteur
<a name="modifier_les_couleurs_des_libelles_des_options_champ_selecteur_ELTTEXTE000437"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Pour modifier les couleurs des libellés des options d'un champ Sélecteur, il est possible d'utiliser la syntaxe suivante : 

```txt
<Champ Sélecteur>.Libellé = gStylo(<Couleur option 1>) + ...
	<Libellé option 1> + TAB + ...
	gStylo(<Couleur option N>) + <Libellé option N>
```
Le paramètre &lt;Couleur option&gt; correspond à :

- une couleur RVB (obtenue avec la fonction [RVB](../WDLang1/3029012.md)),

- une couleur TSL (obtenue avec la fonction [TSL](../WDLang1/3029057.md)),

- [une couleur prédéfinie du WLangage](../WDLang5/3010002.md).




<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Propriétés spécifiques aux champs Sélecteur
<a name="proprietes_specifiques_aux_champs_selecteur_ELTTEXTE000480"></a>
Les propriétés suivantes sont spécifiques à la gestion des caractéristiques d'un champ Sélecteur par programmation.


|   |   |
| --- | --- |
| [CadrageHorizontal](../Proprietes/2510023.md) | Permet de connaître et de modifier le cadrage horizontal d'un champ. |
| [CadrageVertical](../Proprietes/2510054.md) | Permet de connaître et de modifier le cadrage vertical d'un champ. |
| [Couleur](../Proprietes/2510071.md) | Permet de connaître et de modifier la couleur du texte des options du champ Sélecteur. |
| [CouleurFond](../Proprietes/2510022.md) | Permet de connaître et de modifier la couleur de fond du champ Sélecteur. |
| [NombreColonne](../Proprietes/2510083.md) | Permet de connaître le nombre de colonnes du champ Sélecteur. |
| [Occurrence](../WDLang1/3025009.md) | Permet de connaître le nombre d'options présentes dans un champ Sélecteur. |
| [SousLibellé](../Proprietes/1000017232.md) | Permet de connaître et de modifier le sous-libellé d'une option d'un champ Sélecteur. |
| [ValeurInitiale](../Proprietes/2510128.md) | Permet de connaître la valeur initiale d'un champ Sélecteur. |
| [ValeurRenvoyée](../Proprietes/2510134.md) | Permet de connaître et de modifier la valeur renvoyée par une option d'un champ Sélecteur. |


Pour connaître la liste complète des propriétés du WLangage pouvant être utilisées avec un champ Sélecteur, consultez [Propriétés associées à un champ Sélecteur](../WDChamp/1013253.md).


