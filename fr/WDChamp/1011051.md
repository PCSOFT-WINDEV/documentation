
## Afficher un état au format HTML dans le navigateur de l'internaute
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000183"></a>
Pour afficher un état au format HTML dans le navigateur de l'internaute, il est nécessaire de :

- générer le fichier HTML sur le serveur Web.

- afficher le fichier généré dans le navigateur de l'internaute. L'affichage du fichier peut être :

	- soit immédiat.

	- soit demandé par l'internaute (clic sur un lien par exemple).




- supprimer le fichier HTML du serveur Web.






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000207"></a>


### Générer un fichier HTML sur le serveur Web
<a name="generer_fichier_html_sur_serveur_web_ELTPARAGRAPHE000026"></a>Pour générer un fichier HTML sur le serveur Web :

1. Créez un nom unique pour le fichier HTML à générer. Le répertoire de création de ce fichier doit être accessible en lecture et en écriture (par exemple, le répertoire des fichiers de données ou le répertoire "&lt;MonProjet&gt;_WEB" du site). 
	Pour plus de détails sur la création d'un nom de fichier unique, consultez [Définir un nom unique pour le fichier généré](../WDChamp/1011009.md).

2. Si l'état contient des images, indiquez que ces images doivent être générées dans le répertoire "&lt;MonProjet&gt;_WEB" du site (fonction [iRepImageHTML](../WDLang5/3046078.md)).

3. Paramétrez la destination de l'impression grâce à la fonction [iDestination](../WDLang5/3046074.md) avec la constante *iHTML* (impression dans un fichier HTML).

4. Précisez le nom de l'état à imprimer dans la fonction [iImprimeEtat](../WDLang5/3046032.md). 
	Le fichier HTML est créé sur le serveur Web.





<a name="NOTE2_2"></a>


### Affichage du fichier HTML
<a name="affichage_fichier_html_ELTPARAGRAPHE000055"></a>L'affichage du fichier peut être :

- soit immédiat.

- soit demandé par l'internaute (clic sur un lien par exemple).




Pour afficher automatiquement le fichier généré dans le navigateur de l'internaute, il suffit de :

1. Extraire le nom et l'extension du fichier généré grâce à la fonction [fExtraitChemin](../WDLang1/3036026.md).

2. Afficher le fichier généré dans le navigateur de l'internaute grâce à la fonction [FichierAffiche](../WDLang2/3012005.md) ou [PageAffiche](../WDLang2/3058008.md).




Pour afficher le fichier généré après demande de l'internaute, il suffit de :

1. Extraire le nom et l'extension du fichier généré grâce à la fonction [fExtraitChemin](../WDLang1/3036026.md).

2. Afficher le fichier généré dans le navigateur de l'internaute. Il est par exemple possible :

	- soit d'utiliser la fonction [FichierAffiche](../WDLang2/3012005.md) ou [PageAffiche](../WDLang2/3058008.md).

	- soit de modifier l'URL du champ qui affiche le fichier HTML (propriété [URL](../Proprietes/2510132.md) d'un bouton ou d'un lien par exemple).

	- ...








<a name="NOTE2_3"></a>


### Suppression du fichier HTML
<a name="suppression_fichier_html_ELTPARAGRAPHE000101"></a>Pour limiter l'espace disque occupé par les états au format HTML sur le serveur Web, il est conseillé de supprimer régulièrement les états inutiles. Il est par exemple possible de créer une procédure effaçant les états réalisés dans la journée.

**Attention** : Ne supprimez pas l'état immédiatement après la fonction [FichierAffiche](../WDLang2/3012005.md) ou [PageAffiche](../WDLang2/3058008.md). Le fichier HTML généré doit exister pour être visualisé sur le navigateur de l'internaute.



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Exemple
<a name="exemple_ELTTEXTE000243"></a>
L'état "ETAT_FactureHTML" est un état affiché sur le poste de l'internaute au format HTML.

Le bouton "VisualisationFacture" permet de :

- générer le fichier HTML dans le répertoire "&lt;MonProjet&gt;_WEB" du site.

- visualiser l'état au format HTML.




Dans cet exemple, le code de clic serveur du bouton "VisualisationFacture" est le suivant :


```wl
// Générer un nom de fichier HTML unique
CheminFichier est une chaîne  
CheminFichier = fRepWeb() + "\" + DateSys() + HeureSys() + ".htm"
// Paramétrer la destination de l'impression 
iDestination(iHTML, CheminFichier) 
// Imprimer l'état ETAT_FactureHTML 
iImprimeEtat(ETAT_FactureHTML) 
// Extraire le nom et l'extension du fichier généré
NomFichier est une chaîne
NomFichier = fExtraitChemin(CheminFichier, fFichier + fExtension)
// Envoyer le fichier dans le navigateur 
PageAffiche(NomFichier)
```


**Remarque** : Il est possible d'ouvrir le fichier HTML directement à partir d'un bouton ou d'un lien. Il suffit de modifier l'action de ce champ avec la propriété [URL](../Proprietes/2510132.md) :


```wl
// Générer un nom de fichier HTML unique
CheminFichier est une chaîne  
CheminFichier = fRepWeb() + "\" + DateSys() + HeureSys() + ".htm"
// Paramétrer la destination de l'impression
iDestination(iHTML, CheminFichier) 
// Imprimer l'état ETAT_FactureHTML
iImprimeEtat(ETAT_FactureHTML) 
// Extraire le nom et l'extension du fichier généré
NomFichier est une chaîne  
NomFichier = fExtraitChemin(CheminFichier, fFichier + fExtension)
// Modification de l'action du champ Lien qui ouvrira le fichier HTML
LIEN_LienHTML.URL = "/" + RépertoireWeb() + "/" + NomFichier
```





