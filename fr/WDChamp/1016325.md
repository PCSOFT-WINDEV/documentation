


## Champ Agenda lié à un fichier de données ou une variable
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000183"></a>
Il est possible de créer des champs Agenda directement liés aux données. Vous pouvez créer :

- un **champ Agenda fichier** : le champ Agenda sera lié à un fichier de données ou à une requête. Dans ce cas, le fichier de données contient les caractéristiques des rendez-vous. 

- un **champ Agenda sur variable** : le champ Agenda sera lié à une variable (le plus souvent une instance de classe). Dans ce cas, la classe liste les rendez-vous avec leurs caractéristiques. 




La programmation des champs Agenda est grandement simplifiée : il n'est plus nécessaire d'utiliser directement les [fonctions Agendaxxx](../WDLang1/1000019021.md). 





## Comment le faire ?
<a name="comment_faire_ELTTEXTE000207"></a>


### Créer un champ Agenda fichier
<a name="creer_champ_agenda_fichier_ELTPARAGRAPHE000034"></a>Pour créer un champ Agenda fichier, il est possible : 

- soit d'utiliser l'assistant de création du champ Agenda. Il suffit de sélectionner l'option "Afficher les données d'un fichier ou d'une requête existante". Répondez ensuite aux questions de l'assistant et validez. 

- soit de modifier la description du champ Agenda. 




Pour modifier les caractéristiques d'un champ Agenda existant :

1. Affichez la fenêtre de description du champ (option "Description" du menu contextuel). 

2. Dans l'onglet "Contenu", sélectionnez l'option "Fichier" et sélectionnez la source de données utilisée. Cette source de données peut être : 

	- un fichier de données défini dans l'analyse,

	- une requête du projet,

	- une requête intégrée à la fenêtre ou à la page. 




3. Associez les différentes rubriques de la source de données aux caractéristiques du rendez-vous. Les éléments précédés d'une étoile sont obligatoires. 
	**Remarque** : Si le fichier de données associé ne contient pas directement la rubrique correspondante, il est possible de réaliser une liaison multi-fichiers. 

4. Validez la fenêtre de description du champ Agenda. Le champ Agenda est un champ Agenda fichier. 





### Créer un champ Agenda sur variable
<a name="creer_champ_agenda_sur_variable_ELTPARAGRAPHE000055"></a>Pour créer un champ Agenda sur variable, il est possible : 

- soit d'utiliser l'assistant de création du champ Agenda. Il suffit de sélectionner l'option "Afficher les données d'une variable existante". Répondez ensuite aux questions de l'assistant et validez. 

- soit de modifier la description du champ Agenda. 




Pour modifier les caractéristiques d'un champ Agenda existant : 

1. Affichez la fenêtre de description du champ (option "Description" du menu contextuel). 

2. Dans l'onglet "Contenu", sélectionnez l'option "Par variable" et sélectionnez la source de données utilisée (classe, ...). 

3. Associez les différents éléments (membres de la classe par exemple) de la source de données aux caractéristiques du rendez-vous. Les éléments précédés d'une étoile sont obligatoires. 

4. Validez la fenêtre de description du champ Agenda. Le champ Agenda est un champ Agenda sur variable. 






## Manipuler un champ Agenda fichier ou un champ Agenda sur variable
<a name="manipuler_champ_agenda_fichier_champ_agenda_sur_variable_ELTTEXTE000237"></a>


### Champ Agenda fichier
<a name="champ_agenda_fichier_ELTPARAGRAPHE000071"></a>Un champ Agenda fichier se manipule très simplement : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Si l'utilisateur manipule directement le champ Agenda via le menu contextuel, les ajouts, suppressions, modifications des rendez-vous sont automatiquement reportés dans la source de données liée au champ. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Si l'utilisateur manipule les rendez-vous via une fenêtre spécifique, il suffit de modifier directement le fichier de données lié au champ Agenda. Les données affichées seront automatiquement mises à jour. Il est également possible d'utiliser la fonction [AgendaAffiche](../WDLang1/1000019425.md) pour remettre à jour les données affichées dans le champ. 

- Si le champ Agenda autorise la modification de la durée et/ou le déplacement de rendez-vous, les modifications du rendez-vous sont automatiquement reportées dans le fichier de données lié au champ. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) La suppression réalisée dans le champ est effectuée en même temps dans la source de données liée.





### Champ Agenda sur variable
<a name="champ_agenda_sur_variable_ELTPARAGRAPHE000104"></a>Un champ Agenda sur variable se manipule très simplement : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Si l'utilisateur manipule directement le champ Agenda via le menu contextuel, les ajouts, suppressions, modifications des rendez-vous sont automatiquement reportés dans la source de données liée au champ. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Si l'utilisateur manipule les rendez-vous via une fenêtre spécifique, il suffit de modifier directement les éléments liés au champ Agenda (membres de classe par exemple). Les données affichées seront automatiquement mises à jour. Il est également possible d'utiliser la fonction [AgendaAffiche](../WDLang1/1000019425.md) pour remettre à jour les données affichées dans le champ. 

- Si le champ Agenda autorise la modification de la durée et/ou le déplacement de rendez-vous, les modifications du rendez-vous sont automatiquement reportées dans la source de données liée au champ. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) La suppression réalisée dans le champ est effectuée en même temps dans la source de données liée.





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WW_Agenda.gif) ***Exemples didactiques (WEBDEV)*** : **WW_Agenda** <br>L'exemple WW_Agenda est un exemple d'utilisation du champ Agenda pour WEBDEV.


