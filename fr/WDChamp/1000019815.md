


## Manipuler un champ Carte par programmation
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000279"></a>
WINDEV, WEBDEV et WINDEV Mobile permettent de manipuler un champ Carte directement par programmation. Il suffit d'utiliser directement la variable du champ Carte dans le code.

La variable du champ Carte correspond au nom du champ Carte.

Cette page d'aide détaille comment manipuler un champ Carte par programmation. 

**Remarque** : De nombreuses fonctions du WLangage sont spécifiques à la gestion des champs de type Carte. Pour plus de détails, consultez [les fonctions de gestion des champs Carte](../WDLang3/1000019955.md).





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Initialiser une carte
<a name="initialiser_une_carte_ELTTEXTE000303"></a>


### Afficher une carte
<a name="afficher_une_carte_ELTPARAGRAPHE000060"></a>A l'ouverture de la fenêtre contenant un champ Carte, une carte du monde est automatiquement affichée : la carte est centrée sur l'Europe avec un niveau de zoom minimal.

Il est possible d'afficher la dernière position mémorisée : il suffit de sélectionner l'option "Mémoriser la dernière position affichée" dans l'onglet "Général" de la fenêtre de description du champ Carte. Dans ce cas, la dernière position est affichée avec le même niveau de zoom. 

Pour afficher une carte correspondant à un lieu spécifique, utilisez : 

- soit la fonction [CarteAffichePosition](../WDLang3/1000019787.md) : Cette fonction peut être utilisée avec une position spécifique (variable de type [géoPosition](../WDLang3/1000019191.md)) ou sur une ville ou un monument. 
	Par exemple : 
	
	```wl
	// Centre la carte affichée par le champ "CARTE_Position" 
	// sur une position géographique 
	MaPosition est une geoPosition
	CarteAffichePosition(CARTE_Position, MaPosition)
	
	// Centre la carte affichée par le champ "CARTE_Position" sur une ville 
	// à partir de son nom
	CarteAffichePosition(CARTE_Position, "Montpellier, France")
	
	// Centre la carte affichée par le champ "CARTE_Position" sur un monument 
	// à partir de son nom
	CarteAffichePosition(CARTE_Position, "Tour Eiffel")
	```


- soit l'affectation directe avec une position spécifique. Dans ce cas, la position est affichée sans animation. 
	Exemple : 
	
	```wl
	// Centre la carte affichée par le champ "CARTE_Position" 
	// sur une position géographique
	MaPosition est une geoPosition
	CARTE_Position = MaPosition
	```





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Gérer des paramètres avancés (WEBDEV)
<a name="gerer_des_parametres_avances_webdev_ELTTEXTE000327"></a>
<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Fonctions WLangage utilisables avec les champs Carte
<a name="fonctions_wlangage_utilisables_avec_les_champs_carte_ELTTEXTE000351"></a>
Les fonctions WLangage utilisables avec les champs Carte peuvent être classées en plusieurs catégories : 

- Les fonctions permettant de gérer les positions sur la carte : 
	


|   |   |
| --- | --- |
| [CarteAffichePosition](../WDLang3/1000019787.md) | Centre la carte affichée dans un champ Carte sur une position géographique ou un lieu donné. |
| [CarteInfoPosition](../WDLang3/1000019951.md) | Renvoie les coordonnées en pixel du point d'un champ Carte correspondant à une position géographique (latitude et longitude). |
| [CarteInfoXY](../WDLang3/1000019950.md) | Renvoie la position géographique (latitude et longitude) correspondant à un point d'un champ Carte. |
| [CarteRécupèrePosition](../WDLang3/1000019790.md) | Renvoie la position géographique du point situé au centre de la carte actuellement affiché dans un champ Carte. |

- Les fonctions permettant de suivre le déplacement de l'appareil : 
	


|   |   |
| --- | --- |
| [CarteFinDéplacement](../WDLang3/1000019949.md) | Arrête le suivi du déplacement de l'appareil dans un champ Carte. |
| [CarteSuitDéplacement](../WDLang3/1000019953.md) | Affiche la position courante de l'appareil dans un champ Carte et met à jour cette position durant son déplacement. |

- Les fonctions permettant de gérer les marqueurs sur la carte. Ces fonctions utilisent des variables de type [Marqueur](../WDLang3/1000019940.md) permettant de définir toutes les caractéristiques des marqueurs. 
	


|   |   |
| --- | --- |
| [CarteAjouteMarqueur](../WDLang3/1000019794.md) | Ajoute un nouveau marqueur sur une carte affichée dans un champ Carte. |
| [CarteModifieMarqueur](../WDLang3/1000019796.md) | Modifie un marqueur affiché dans un champ Carte. |
| [CarteSupprimeMarqueur](../WDLang3/1000019795.md) | Supprime un marqueur d'une carte affichée par un champ Carte. |
| [CarteSupprimeTout](../WDLang3/1000019952.md) | Supprime dans un champ Carte : <br><br>	- tous les marqueurs, <br><br>	- toutes les formes,<br><br>	- toutes les images.<br><br><br> |

- Les fonctions permettant de gérer les itinéraires sur la carte. 
	


|   |   |
| --- | --- |
| [CarteAjouteItinéraire](../WDLang3/1000020383.md) | Ajoute un itinéraire sur un champ Carte. |
| [CarteSupprimeItinéraire](../WDLang3/1000020384.md) | Supprime un itinéraire d'un champ Carte. |

- Les fonctions permettant de manipuler des options supplémentaires de l'API Google de gestion des cartes : 
	


|   |   |
| --- | --- |
| [CarteConfigureAPIGgl](../WDLang3/1000021611.md) | Déclare des paramètres supplémentaires pour le champ Carte qui seront transmis à l'API Google. |
| [CarteExécuteJS](../WDLang3/1000021615.md) | Exécute du code natif de l'API Google Maps dans un champ Carte en Javascript. |
| [CarteRécupèreObjetJS](../WDLang3/1000021474.md) | Retourne l'instance de l'API d'un champ Carte. |



<a name="NOTE4_2"></a>


### Remarques
<a name="remarques_ELTPARAGRAPHE000170"></a>

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) La fonction [CarteLicenceGgl](../WDLang3/1000021299.md) permet de spécifier l'identifiant Google nécessaire dans le cadre d'une utilisation du champ Carte avec l'option Google Map API for Work. Pour plus de détails, consultez la licence d'utilisation de "Google Maps API". 
	

- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) La fonction [CarteLicenceBing](../WDLang3/1000022006.md) permet de spécifier la clé Bing nécessaire dans le cadre de l'utilisation du champ Carte dans une application en mode Universal Windows 10 app. 




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Propriétés spécifiques aux champs Carte
<a name="proprietes_specifiques_aux_champs_carte_ELTTEXTE000480"></a>
Les propriétés suivantes sont spécifiques à la gestion d'un champ Carte par programmation : 



|   |   |
| --- | --- |
| [ModeCarte](../Proprietes/1000019956.md) | Renvoie ou modifie le mode d'affichage de la carte dans le champ Carte. |
| [Valeur](../Proprietes/2510130.md) | Permet de centrer la carte sur la position correspondant à la variable de type [géoPosition](../WDLang3/1000019191.md) spécifiée. |
| [Zoom](../Proprietes/1000017201.md) | Renvoie ou modifie le niveau de zoom utilisé pour l'affichage de la carte. |


Pour connaître la liste complète des propriétés du WLangage pouvant être utilisées avec un champ Carte, consultez [Propriétés associées au champ Carte](../WDChamp/1000019814.md).



