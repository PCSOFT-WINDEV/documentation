


## Manipuler un champ Calendrier par programmation
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000283"></a>
WINDEV, WEBDEV et WINDEV Mobile permettent de manipuler un champ Calendrier directement par programmation. Il suffit d'utiliser directement la variable du champ Calendrier dans le code.

La variable du champ Calendrier correspond à la date sélectionnée (si le champ est multisélections ou avec sélection de période, la variable correspond à la première date sélectionnée). Cette date utilise le format spécifié dans le champ "Format mémorisé " de l'onglet "Général" de la description du champ. Cette variable est de type chaîne.

Le champ Calendrier peut être manipulé par programmation : 

- grâce aux fonctions WLangage ([fonctions Calendrier](../WDLang1/1000015008.md) et [fonctions de gestion des jours fériés](../WDLang1/3027029.md)).

- aux propriétés WLangage. 


Le champ Calendrier est associé à [plusieurs traitements WLangage](../WDChamp/1016303.md).

**Remarques** :

- Il est également possible de manipuler un jour d'un champ Calendrier par programmation. Pour plus de détails, consultez [Gestion des jours de calendrier](../WDChamp/1016304.md).

- WINDEV, WEBDEV et WINDEV Mobile gèrent automatiquement le changement de mois ou d'année par l'utilisateur.










<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Gestion des jours fériés
<a name="gestion_des_jours_feries_ELTTEXTE000307"></a>
La gestion des jours fériés est réalisée par programmation. Le WLangage met à votre disposition plusieurs fonctions débutant par JourFériéXXX.

Pour définir les jours fériés affichés dans un champ Calendrier, il faut utiliser la fonction [JourFériéAjoute](../WDLang1/1000017304.md). Cette fonction permet de définir la liste des jours fériés à utiliser. Cette fonction permet de personnaliser les jours fériés en fonction du pays et de la réglementation locale. Cette fonction doit être utilisée au début de l'application car elle a un effet global sur l'application.

Exemple :

```wl
// Suppression de tous les jours fériés
JourFériéSupprimeTout()
// Initialisation des 11 jours fériés communs aux départements français et DOM/TOM
JourFériéAjoute("0101")		// 1er Janvier
JourFériéAjoute(jfLundiDePâques)	// Lundi de Pâques
JourFériéAjoute("0501")		// 1er Mai
JourFériéAjoute("0508")		// 8 Mai
JourFériéAjoute(jfJeudiDeLAscension)	// Jeudi de l'Ascension
JourFériéAjoute(jfLundiDePentecôte)	// Lundi de Pentecôte
JourFériéAjoute("0714")		// 14 Juillet
JourFériéAjoute("0815")		// 15 Août (Assomption)
JourFériéAjoute("1101")		// Toussaint
JourFériéAjoute("1111")		// 11 Novembre
JourFériéAjoute("1225")		// Noël

// Ajout de 2 jours fériés supplémentaires pour la Moselle et l'Alsace
JourFériéAjoute("1226" + RC + jfVendrediSaint)
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Gestion de la multisélection
<a name="gestion_multiselection_ELTTEXTE000333"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Récupérer la multisélection
<a name="recuperer_multiselection_ELTPARAGRAPHE000101"></a>Un champ Calendrier peut être multisélection : le champ Calendrier permet alors de sélectionner plusieurs dates. Il suffit pour cela que l'option "       Sélection multiple" soit cochée dans l'onglet "Détail" de la fenêtre de description du champ. Il est également possible d'utiliser la propriété [Multisélection](../Proprietes/1000017054.md).

Pour récupérer les différentes dates sélectionnées, il suffit d'utiliser les [fonctions CalendrierXXX](../WDLang1/1000015008.md) du WLangage.

Exemple :

```wl
// Parcours des dates sélectionnées dans le champ Calendrier
POUR I = 1 _A_ CalendrierSelectOccurrence(CAL_Calendrier1)
	Trace(CalendrierSelect(CAL_Calendrier1, I))
FIN
```

<a name="NOTE3_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Gestion de la sélection d'une période
<a name="gestion_selection_une_periode_ELTPARAGRAPHE000132"></a>Un champ Calendrier peut proposer la sélection d'une période : le champ Calendrier permet alors de sélectionner la date de début et la date de fin de la période. Les jours présents entre ces deux dates sont automatiquement sélectionnés.

Pour permettre la sélection d'une période, il suffit que l'option "       Sélection de période" soit cochée dans l'onglet "Détail" de la fenêtre de description du champ.

En exécution, pour sélectionner une période, il suffit de cliquer directement dans le champ Calendrier : le premier clic permet de sélectionner la date de début de la période, le second clic permet de sélectionner la date de fin de la période.


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Si le bouton "Aujourd'hui" est affiché (onglet "Détail" de la fenêtre de description), le menu contextuel de ce bouton propose des périodes prédéfinies. L'utilisateur peut ainsi simplement sélectionner la période voulue.

Pour récupérer la date de début et la date de fin de la période sélectionnée, il suffit d'utiliser les propriétés [DateDébut](../Proprietes/1000017426.md) et [DateFin](../Proprietes/1000017427.md) du WLangage.

Exemple :

```wl
NbJour est un entier 
NbJour = DateDifférence(CAL_Calendrier1.DateDébut, CAL_Calendrier1.DateFin) + 1
Info("Période sélectionnée : du " + DateVersChaîne(CAL_Calendrier1.DateDébut) + ...
	" au " + DateVersChaîne(CAL_Calendrier1.DateFin) + ...
	" soit " + NbJour + " jour(s)")
```


<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Fonctions WLangage
<a name="fonctions_wlangage_ELTTEXTE000363"></a>


### Fonctions de gestion des jours fériés
<a name="fonctions_gestion_des_jours_feries_ELTPARAGRAPHE000172"></a>Les fonctions de gestion des jours fériés sont les suivantes :



|   |   |
| --- | --- |
| [JourFérié](../WDLang1/1000017303.md) | Indique si un jour est férié ou non. |
| [JourFériéAjoute](../WDLang1/1000017304.md) | Indique qu'un jour ou qu'une liste de jours est férié. |
| [JourFériéSupprimeTout](../WDLang1/1000017301.md) | Vide la liste de tous les jours fériés. |




<a name="NOTE5_2"></a>


### Fonctions de gestion du champ Calendrier
<a name="fonctions_gestion_champ_calendrier_ELTPARAGRAPHE000182"></a>Les fonctions de gestion du champ Calendrier sont les suivantes :



|   |   |
| --- | --- |
| [CalendrierPosition](../WDLang1/1000017281.md) | Renvoie le mois affiché dans un champ Calendrier. |
| [CalendrierSelect](../WDLang1/1000017283.md) | Renvoie la date sélectionnée dans un champ Calendrier. |
| [CalendrierSelectMoins](../WDLang1/1000017340.md) | Désélectionne une date dans un champ Calendrier multisélection. |
| [CalendrierSelectOccurrence](../WDLang1/1000017282.md) | Renvoie le nombre de jours sélectionnés dans un champ Calendrier. |
| [CalendrierSelectPlus](../WDLang1/1000017339.md) | Sélectionne une date dans un champ Calendrier. |





<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Propriétés spécifiques aux champs Calendrier
<a name="proprietes_specifiques_aux_champs_calendrier_ELTTEXTE000453"></a>
Les propriétés suivantes sont spécifiques à la gestion d'un champ Calendrier par programmation.


|   |   |
| --- | --- |
| [BorneMax](../Proprietes/2510009.md) | Permet de connaître et de modifier la borne maximale du champ Calendrier. |
| [BorneMin](../Proprietes/2510008.md) | Permet de connaître et de modifier la borne minimale du champ Calendrier. |
| [DateDébut](../Proprietes/1000017426.md) | Permet de connaître et de modifier la date de début d'une période sélectionnée dans un champ Calendrier. |
| [DateFin](../Proprietes/1000017427.md) | Permet de connaître et de modifier la date de fin d'une période sélectionnée dans un champ Calendrier. |
| [FormatMémorisé](../Proprietes/2510048.md) | Permet de connaître et de modifier le format de la valeur retournée par le champ Calendrier. |
| [Image](../Proprietes/2510034.md) | Permet de connaître et de modifier l'image de fond du champ Calendrier. |
| [Multisélection](../Proprietes/1000017054.md) | Permet de connaître et de modifier le mode de sélection d'un champ Calendrier |


Pour connaître la liste complète des propriétés du WLangage pouvant être utilisées avec un champ de type Calendrier, consultez [Propriétés associées au champ Calendrier](../WDChamp/1016302.md).


