
## Manipuler un champ Editeur de diagrammes par programmation
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000271"></a>
WINDEV et WEBDEV permettent de manipuler un champ Editeur de diagrammes par programmation. Il suffit d'utiliser directement la variable du champ dans le code.

Un champ Editeur de diagrammes peut également être manipulé par programmation grâce aux [Fonctions Diagramme](../WDLang1/1410088562.md).  

Cette page d'aide détaille comment manipuler un champ Editeur de diagrammes par programmation. 





## Manipuler le champ Editeur de diagrammes par programmation
<a name="manipuler_champ_editeur_diagrammes_par_programmation_ELTTEXTE000295"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000022"></a>Un champ Editeur de diagrammes permet de créer et d'afficher des diagrammes par programmation. Pour cela, le WLangage met à votre disposition : 

- Les [fonctions Diagramme](../WDLang1/1410088562.md). 

- Plusieurs types de variables spécifiques, permettant de manipuler les diagrammes et les formes du diagramme. Pour plus de détails, consultez [Variables de gestion des diagrammes](../WDLang1/1410088562.md). 







### Exporter un diagramme sous forme d'image
<a name="exporter_diagramme_sous_forme_image_ELTPARAGRAPHE000037"></a>Pour exporter un diagramme sous forme d'image, il est possible d'utiliser la fonction [DiagrammeVersImage](../WDLang1/1410088144.md). Cette fonction permet d'exporter le diagramme sous forme d'une variable de type [Image](../WDLang1/1000019650.md). Il suffit ensuite d'utiliser une des fonctions suivantes pour obtenir l'image du diagramme dans le format voulu : 



|   |   |
| --- | --- |
| [dSauveImageBMP](../WDLang1/3029026.md) | Sauve une image :<br><br>- soit dans un fichier au format BMP.<br><br>- soit en mémoire.<br><br><br> |
| [dSauveImageGIF](../WDLang1/3029040.md) | Sauve une image :<br><br>- soit dans un fichier au format GIF.<br><br>- soit en mémoire.<br><br><br> |
| [dSauveImageICO](../WDLang1/1000020798.md) | Sauve une image au format icône soit dans un fichier, soit en mémoire. |
| [dSauveImageJPEG](../WDLang1/3029038.md) | Sauve une image :<br><br>- soit dans un fichier au format JPEG.<br><br>- soit en mémoire.<br><br><br> |
| [dSauveImagePNG](../WDLang1/3029027.md) | Sauve une image :<br><br>- soit dans un fichier au format PNG.<br><br>- soit en mémoire.<br><br><br><br><br> |
| [dSauveImageTIFF](../WDLang1/1000020852.md) | Sauve une image au format TIFF dans un fichier ou en mémoire. |








### Gestion des bibliothèques de formes
<a name="gestion_des_bibliotheques_formes_ELTPARAGRAPHE000050"></a>Par défaut, des bibliothèques de formes sont fournies avec le champ Editeur de diagrammes. 

Il est possible de créer sa propre bibliothèque de formes. Une bibliothèque de formes correspond à un diagramme chargé en tant que bibliothèque. Ce diagramme peut être créé : 

- via le champ Editeur de diagrammes : 

	1. Créez un diagramme. 

	2. Importez les images correspondant aux formes voulues. 

	3. Enregistrez le diagramme créé dans un fichier au format ".wddiag". 




- par programmation :

	1. Créez une variable de type [Diagramme](../WDLang1/1410088055.md). Cette variable correspondra à la bibliothèque de formes. 

	2. Créez les différentes formes personnalisées. 

	3. Ajoutez les formes au diagramme "Bibliothèque". 

	4. Enregistrez le diagramme "Bibliothèque" dans un fichier ".wddiag". 







Une fois le diagramme "Bibliothèque" créé :  

1. Chargez le diagramme créé en tant que bibliothèque (fonction [DiagrammeChargeBibliothèque](../WDLang1/1410088356.md)). 

2. Ajoutez la bibliothèque au tableau des bibliothèques du diagramme final. 




Exemple de création d'une bibliothèque par programmation : 

```wl
sFichier est une chaîne = fRepTemp() + [ fSep ] + "bibli_perso.wddiag"

// Crée une bibliothèque entièrement par programmation
BibliTemp est un Diagramme

D1 est un diagOvale
D1.Largeur = 50
D1.Hauteur = 50
D1.Fond.Couleur = RougeFoncé
Ajoute(BibliTemp.Forme, D1)

D2 est un diagOvale
D2.Largeur = 50
D2.Hauteur = 70
D2.Fond.Couleur = VertFoncé
Ajoute(BibliTemp.Forme, D2)

// Utilise les formes du diagramme temporaire pour créer la bibliothèque
// Sauve le diagramme sur le disque
DiagrammeSauve(BibliTemp, sFichier)

// Charge le diagramme en tant que bibliothèque
MaBibli est un diagBibliothèque
DiagrammeChargeBibliothèque(MaBibli, sFichier)
MaBibli.Nom = "Perso"

// Ajoute la bibliothèque au champ Editeur de diagrammes
Ajoute(EDIAG_Diagramme.Bibliothèque, MaBibli)

ToastAffiche("La bibliothèque personnelle a été ajoutée dans la liste.")
```


Remarque : Si vous souhaitez utiliser uniquement vos propres bibliothèques, pensez à supprimer les bibliothèques proposées par défaut par PC SOFT. Pour cela, utilisez la fonction [TableauSupprimeTout](../WDLang1/3075010.md) sur le tableau des bibliothèques de votre diagramme. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Astuces de programmation
<a name="astuces_programmation_ELTTEXTE000395"></a>


### Comment récupérer les caractéristiques de la sélection dans un champ Editeur de diagrammes ? 
<a name="comment_recuperer_les_caracteristiques_selection_dans_champ_editeur_diagrammes_ELTPARAGRAPHE000093"></a>Les caractéristiques de la sélection effectuée dans un champ Editeur de diagrammes peuvent être récupérées via la propriété [Sélection](../Proprietes/1000023033.md) utilisée sur le champ. Si la sélection comprend plusieurs formes, il est possible de parcourir le tableau des formes. 

Exemple : 

```wl
// Obtenir la sélection dans un champ Editeur de diagrammes
MaSélection est un diagSélection <- EDIAG_MonDiagramme.Sélection
SI MaSélection.Forme.Occurrence > 0 ALORS
	// Obtenir les formes
	POUR TOUT stForme DE MaSélection.Forme	
		LIB_INFO_SELECTION = "Sélection de " + stForme.Nom + 
		" [ " + stForme.X + ", " + stForme.Y + " - " + stForme.Largeur + 
		"x" + stForme.Hauteur + " ]"	
	FIN
SINON
	LIB_INFO_SELECTION = "Cliquez sur une forme dans le diagramme pour connaître la sélection"
FIN
```



### Utilisation de la propriété Note des différentes formes
<a name="utilisation_propriete_note_des_differentes_formes_ELTPARAGRAPHE000104"></a>Les différentes variables de type [diagForme](../WDLang1/1410088082.md) ([diagOvale](../WDLang1/1410088135.md), [diagRectangle](../WDLang1/1410088083.md), ...) possèdent une propriété **Note**. Cette propriété peut être utilisée pour enregistrer tout type d'informations : numéro de la forme, type de la forme, information métier, ... Si le diagramme est enregistré sous forme d'un fichier "wddiag", les informations précisées à l'aide de la propriété **Note** sont également enregistrées. Il est ainsi possible de les relire et de les traiter lors du parcours des différentes formes d'un diagramme.

Cette astuce est utilisée dans l'exemple de [mise en place d'un diagramme interactif](../WDChamp/1410087174.md). 




### Comment connaître le type d'une forme ? 
<a name="comment_connaitre_type_une_forme_ELTPARAGRAPHE000124"></a>Pour connaître le type d'une forme, il suffit d'affecter la forme aux différentes variables disponibles.  

Exemple : 

```txt
POUR TOUTE forme DE EDIAG_MonDiagramme.Forme
	FormeImage est un diagImage <- forme
	SI FormeImage <> Null ALORS
   		// La forme est une image
	FIN
FIN
```




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Propriétés WLangage associées
<a name="proprietes_wlangage_associees_ELTTEXTE000469"></a>


### Propriétés spécifiques à la gestion d'un champ Editeur de diagrammes
<a name="proprietes_specifiques_gestion_champ_editeur_diagrammes_ELTPARAGRAPHE000214"></a>Les propriétés suivantes sont spécifiques à la gestion des caractéristiques d'un champ Editeur de diagrammes par programmation : 



|   |   |
| --- | --- |
| [Bibliothèque](../Proprietes/1410088357.md) | La propriété **Bibliothèque** permet de manipuler les différentes bibliothèques prédéfinies associées à un champ Editeur de diagrammes. Cette propriété permet d'accéder au tableau des bibliothèques du champ Editeur de diagrammes. |
| [CadrePageVisible](../Proprietes/1410088623.md) | La propriété **CadrePageVisible** permet de :<br><br>- savoir si le cadre des pages est affiché dans un champ Editeur de diagrammes.  <br><br>- afficher ou non le cadre des pages dans un champ Editeur de diagrammes.<br><br><br> |
| [ModeEdition](../Proprietes/1410089005.md) | La propriété **ModeEdition** permet de connaître et de modifier le mode d'édition du champ Editeur de diagrammes : sélection ou dessin à main levée. |
| [PanneauBibliothèqueVisible](../Proprietes/1410088468.md) | La propriété **PanneauBibliothèqueVisible** permet : <br><br>- de savoir si le panneau "Bibliothèque" est affichée dans un champ Editeur de diagrammes.  <br><br>- d'afficher ou non le panneau "Bibliothèque" dans un champ Editeur de diagrammes.<br><br><br> |
| [PanneauModifieurVisible](../Proprietes/1410088522.md) | La propriété **PanneauModifieurVisible** permet de : <br><br>- savoir si le panneau "Modifieur" est affichée dans un champ Editeur de diagrammes.  <br><br>- afficher ou non le panneau "Modifieur" dans un champ Editeur de diagrammes.<br><br><br> |
| [QuadrillageVisible](../Proprietes/1000023117.md) | La propriété **QuadrillageVisible** permet de : <br><br>- Savoir si le quadrillage est visible ou non dans un champ. <br><br>- Modifier la visibilité du quadrillage dans un champ.<br><br><br> |
| [Sélection](../Proprietes/1000023033.md) | La propriété **Sélection** permet d'obtenir les caractéristiques de la sélection (ou du curseur) : <br><br>- dans un champ Traitement de texte.<br>	Remarque : Cette sélection est située dans la partie en cours d'édition dans le champ (corps, entête ou pied de page). <br><br>- dans un champ Tableur.<br><br>- dans un champ Editeur HTML. <br><br>- dans un champ Editeur de diagrammes.<br><br><br> |





Pour connaître la liste complète des propriétés du WLangage pouvant être utilisées avec un champ de type Editeur de diagrammes, consultez [Propriétés associées au champ Editeur de diagrammes](../WDChamp/1410087170.md).




