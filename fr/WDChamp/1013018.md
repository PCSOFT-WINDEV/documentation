


## Manipuler un champ Code-barres par programmation
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000239"></a>
WINDEV, WEBDEV et WINDEV Mobile permettent de manipuler un champ Code-barres directement par programmation. Il suffit d'utiliser directement la variable du champ Code-barres dans le code.

La variable du champ Code-barres correspond au nom du champ Code-barres. Cette variable est de type texte.







<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Afficher un code-barres dans un champ Code-barres
<a name="afficher_codebarres_dans_champ_codebarres_ELTTEXTE000263"></a>


### Afficher un code-barres dans un champ Code-barres
<a name="afficher_codebarres_dans_champ_codebarres_ELTPARAGRAPHE000072"></a>Pour afficher un code-barres dans un champ Code-barres, une simple affectation suffit.

Quelques exemples :

- affectation directe :
	
	```wl
	CBA_ChampCodeBarres = "123456789"
	```


- affectation par variable :
	
	```wl
	CBA_ChampCodeBarres = Produit.CodeBarres
	```





**Cas des codes-barres de type QR Code** : 
Pour afficher un code-barres de type QR Code dans un champ Code-barres, il est possible d'utiliser directement une variable de type [CodeBarres](../WDLang5/1000019451.md). 
**Remarque** : Dans une fenêtre ou une page, si le champ est associé à une rubrique d'un fichier de données, la récupération de la valeur saisie est automatiquement réalisée en utilisant la fonction [EcranVersFichier](../WDLang4/3044146.md) ou [PageVersFichier](../WDLang4/3044022.md). Pour plus de détails, consultez [Lier un champ Code-barres à une rubrique](../WDChamp/1013010.md).
<a name="NOTE2_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Récupérer dans un champ Code-barres la valeur lue par un appareil spécialisé
<a name="recuperer_dans_champ_codebarres_valeur_lue_par_appareil_specialise_ELTPARAGRAPHE000114"></a>Il est possible de lire des code-barres et d'afficher la valeur correspondant à l'écran. Pour lire un code-barres :

1. Branchez un appareil spécialisé sur le port série de votre machine.

2. Lisez la valeur du code-barres grâce aux fonctions de gestion des ports série suivantes : 


|   |   |
| --- | --- |
| [sLit](../WDLang3/3062012.md) | Lit une chaîne de caractères dans le buffer d'entrée du port série spécifié. |
| [sOuvre](../WDLang3/3062013.md) | Ouvre et initialise :<br><br>	- soit un port série.<br><br>	- soit un port parallèle.<br><br>	- soit un port infrarouge.<br><br><br> |

3. Initialisez la valeur du code-barres lue dans un champ Code-barres correspondant au type du code-barres lu.




Exemple de lecture d'un code-barres avec un appareil spécialisé branché sur le port série COM1 :


```wl
// Déclaration des variables 
// Définition du nombre de caractères à lire 
NBCarALire est un entier = 13 
// Nombre d'octets en attente dans le buffer 
NbOctetAttente est un entier 
BufferPrn est une chaîne 	// Contenu du buffer 
PortSérie est un entier = 1 	// Port série COM1 

// Ouverture et initialisation du port série COM1 
SI sOuvre(PortSérie, 5000, 5000) ALORS 
	// Lecture du code-barres 
	// Récupération du nombre d'octets en attente 
	NbOctetAttente = sDansFileEntrée(PortSérie) 
	// Récupération de la valeur du code-barres uniquement 
	// si au moins 13 caractères ont été lus 
	SI NbOctetAttente >= NBCarALire ALORS 
		BufferPrn = sLit(PortSérie, NbOctetAttente) 
		// Récupération des 13 premiers caractères lus 
		BufferPrn = Gauche(BufferPrn, 13) 
		// Affichage de la valeur du code-barres dans le 
		// champ de saisie "SAI_CodeBarre" 
		SAI_CodeBarre = BufferPrn 
	FIN 
FIN
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Récupérer la valeur du code-barres affichée dans le champ Code-barres
<a name="recuperer_valeur_codebarres_affichee_dans_champ_codebarres_ELTTEXTE000313"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Pour récupérer la valeur du code-barres affiché dans un champ Code-barres :

- réalisez une simple affectation. 
	Par exemple :
	
	```wl
	ValeurCodeBarres = CBA_ChampCodebarres
	```


- récupérez une partie de la valeur. 
	Par exemple :
	
	```wl
	DébutCodeBarres = Gauche(CBA_ChampCodeBarres, 3)
	```


- utilisez la propriété [Valeur](../Proprietes/2510130.md).




**Remarque** : Si le champ est associé à une rubrique d'un fichier de données, la récupération de la valeur saisie est automatiquement réalisée en utilisant la fonction [EcranVersFichier](../WDLang4/3044146.md). Pour plus de détails, consultez [Lier un champ code-barres à une rubrique](../WDChamp/1013010.md).

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Propriétés spécifiques aux champs Code-barres
<a name="proprietes_specifiques_aux_champs_codebarres_ELTTEXTE000337"></a>
Les propriétés suivantes sont spécifiques à la gestion des caractéristiques d'un champ Code-barres par programmation.


|   |   |
| --- | --- |
| [CadrageHorizontal](../Proprietes/2510023.md) | Permet de connaître et de modifier le cadrage horizontal du champ Code-barres. |
| [CadrageVertical](../Proprietes/2510054.md) | Permet de connaître et de modifier le cadrage vertical du champ Code-barres. |
| [DndCible](../Proprietes/2510016.md) | Permet de connaître et de modifier le comportement du champ cible vis-à-vis du "Drag and Drop". |
| [DndSource](../Proprietes/2510014.md) | Permet de connaître et de modifier le comportement du champ source vis-à-vis du "Drag and Drop". |



Pour connaître la liste complète des propriétés du WLangage pouvant être utilisées avec un champ Code-barres, consultez [Propriétés associées à un champ Code-barres](../WDChamp/1013019.md).


