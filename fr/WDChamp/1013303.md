


## Manipuler un onglet dynamique par programmation
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000332"></a>
WINDEV permet de manipuler les champs Onglet dynamique par programmation grâce aux [fonctions OngletXXX](../WDLang1/1000021391.md) et à diverses propriétés du WLangage. Il est également possible d'utiliser directement la variable du champ Onglet dans le code. 

**Attention** : Les volets d'onglet statiques et les volets d'onglet dynamiques ne sont pas identifiés de la même manière : 

- les volets d'onglet statiques sont identifiés par le numéro du volet actif. 

- les volets d'onglet dynamiques sont identifiés par l'alias du volet actif.  




**Remarque** : Lorsque la fenêtre interne manipulée dans l'onglet dynamique utilise des fichiers de données HFSQL, il est important que la fenêtre interne utilise un contexte HFSQL indépendant. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Ouverture d'un volet d'onglet dynamique
<a name="ouverture_volet_onglet_dynamique_ELTTEXTE000356"></a>
Il est possible d'ouvrir un volet d'onglet dynamique de différentes façons : 

- via le bouton "+" du champ Onglet. Dans ce cas, les options précisées dans la fenêtre de description du champ Onglet sont prises en compte. 

- par programmation, via la fonction [OngletOuvre](../WDLang1/1000021369.md). 



<a name="NOTE2_2"></a>


### Ouvrir un volet d'onglet via le bouton "+"
<a name="ouvrir_volet_onglet_via_bouton_ELTPARAGRAPHE000045"></a>Pour ouvrir un volet d'onglet via le bouton "+" présent dans le champ Onglet : 

1. Dans la fenêtre de description du champ Onglet, onglet "Détail", cochez l'option "Avec bouton "Nouveau" (+)" et indiquez la "Fenêtre interne sur bouton Nouveau (+)" et le "Libellé par défaut du nouveau volet".

2. La fenêtre interne ouverte par le bouton "+" peut être : 

	- **une fenêtre interne spécifique** (par exemple ajout d'une fiche client). 
			Lorsque l'utilisateur cliquera sur le bouton "+", les volets d'onglet créés seront identiques, basés sur la même fenêtre interne. 
			Remarque : Si la fenêtre interne attend des paramètres, il est nécessaire d'ouvrir le volet d'onglet par programmation avec la fonction [OngletOuvre](../WDLang1/1000021369.md). 

	- **aucune fenêtre interne**. 
			Dans ce cas, il est nécessaire de préciser par programmation la fenêtre interne à ouvrir. Pour cela, il suffit d'utiliser la fonction [OngletOuvre](../WDLang1/1000021369.md) dans l'événement "Création d'un volet" du champ Onglet (voir le paragraphe [Ouvrir un volet d'onglet via la fonction OngletOuvre](#NOTE2_3)).  







Remarque : Le bouton "+" de l'onglet dynamique appelle automatiquement l'événement "Création d'un volet" du champ Onglet. Si cet événement utilise la fonction [OngletOuvre](../WDLang1/1000021369.md), cet événement sera prioritaire sur la fenêtre interne spécifiée dans l'interface.
<a name="NOTE2_3"></a>


### Ouvrir un volet d'onglet via la fonction OngletOuvre
<a name="ouvrir_volet_onglet_via_fonction_ongletouvre_ELTPARAGRAPHE000080"></a>Pour ouvrir un volet d'onglet, il est également possible d'utiliser la fonction [OngletOuvre](../WDLang1/1000021369.md). 

Cette fonction peut par exemple : 

- être utilisée dans un bouton pour ouvrir un volet d'onglet supplémentaire dans un champ Onglet. 

- être utilisé dans l'événement "Création d'un volet" du champ Onglet. 




La fonction [OngletOuvre](../WDLang1/1000021369.md) permet de : 

- Connaître l'alias du volet d'onglet. Cet alias permet de manipuler le volet d'onglet par programmation. Cet alias peut également être connu par la propriété [Valeur](../Proprietes/2510130.md) ou par la propriété [Alias](../Proprietes/2510004.md). 

- Spécifier le libellé du volet d'onglet. 

- Spécifier la fenêtre interne à ouvrir. 

- Passer des paramètres à la fenêtre interne à ouvrir. 




Exemple :

```wl
Alias_Onglet est une chaîne
// Nouvel onglet affichant la fiche du client en cours
Alias_Onglet = OngletOuvre(ONG_Menu, "Client "+ Client.IDClient, FI_FicheClient, Client.IDClient)
// Modification de l'image du volet d'onglet
ONG_Menu[Alias_Onglet].Image = "NvClient.png"
```

<a name="NOTE2_4"></a>


### Astuce : Proposer un volet "Menu" permettant à l'utilisateur de choisir le type de volet à créer
<a name="astuce_proposer_volet_menu_permettant_utilisateur_choisir_type_volet_creer_ELTPARAGRAPHE000121"></a>Certaines interfaces peuvent proposer à l'utilisateur, lors du clic sur le bouton "+", un menu lui permettant de choisir le type d'information à afficher. 

Pour réaliser ce type d'interface : 

1. Créez une fenêtre interne "Menu". Cette fenêtre interne contient les options permettant de choisir les données à afficher dans le nouveau volet d'onglet. Par exemple, cette fenêtre peut proposer à l'utilisateur d'afficher une fiche client, une facture ou la liste des commandes. 

2. Dans la fenêtre de description du champ Onglet, affichez l'onglet "Détail". 

3. Pour l'option "Fenêtre interne sur bouton Nouveau (+)", sélectionnez la fenêtre interne "Menu".

4. Validez.  




Dans ce cas : 

- L'utilisateur clique sur "+" pour ajouter un volet d'onglet. 

- Un nouveau volet d'onglet s'affiche, contenant le menu (fenêtre interne créée précédemment). 

- L'utilisateur choisit dans le menu le type de volet d'onglet à afficher. 

- Le volet d'onglet en cours (celui qui affiche le menu) est remplacé par le volet choisi.




Pour réaliser ce type d'interface, quelques adaptations sont nécessaires : 

- Dans le code de clic du bouton permettant de choisir le type de volet, il suffit d'utiliser la fonction [ChangeFenêtreSource](../WDLang1/3038053.md) en utilisant la syntaxe : 
	
	```txt
	ChangeFenêtreSource(<Fenêtre interne de choix>, <Fenêtre interne de remplacement>)
	```

	Par exemple : 
	
	```wl
	// Remplace la fenêtre de choix par une fiche
	ChangeFenêtreSource(FI_Choix, FI_Fiche)
	```


- Pour manipuler l'onglet ajouté, il suffit d'utiliser la syntaxe : 
	```txt
	<Fenêtre>.<Champ Onglet>[<Fenêtre>.<Champ Onglet>]
	```

	Par exemple, pour modifier le libellé de l'onglet ouvert : 
	
	```wl
	FEN_DYNMAIN.ONG_MDI[FEN_DYNMAIN.ONG_MDI].Libellé = "Fiche de " + HeureSys()
	```





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Manipuler un volet d'onglet dynamique
<a name="manipuler_volet_onglet_dynamique_ELTTEXTE000398"></a>
Pour manipuler un volet d'onglet dynamique, utilisez la syntaxe suivante :

```txt
ChampOnglet[AliasDuVoletOnglet].NomPropriété = ValeurPropriété
```


Par exemple :

```wl
ONG_MonOnglet[ONG_MonOnglet].Etat = Grisé
```


Remarques : 

- La fonction [VoletDuChamp](../WDLang1/1000021625.md) permet de connaître le nom du volet dynamique (l'alias) affichant un champ spécifique. 
	
	```wl
	// Clic sur bouton "BTN_MAJ"
	MonVolet est un Champ
	MonVolet <- VoletDuChamp(MoiMême)
	MonVolet.Libellé = MonVolet.Libellé + " (Modifié)"
	```


- La fonction [OngletEtat](../WDLang1/1000021637.md) permet de connaître l'état d'un volet d'onglet dynamique : actif, flottant, inexistant. 

- Il est possible de connaître les alias des volets dynamiques ouverts avec la fonction [EnumèreChamp](../WDLang1/3025005.md) utilisée sur le champ Onglet : 
	
	```wl
	// Remplir un champ Combo avec la liste des champs de la fenêtre
	i est un entier = 1
	ResChamp est une chaîne
	ResChamp = EnumèreChamp(ONG_MonOnglet, i)
	TANTQUE ResChamp <> ""
		i++
		Trace(ResChamp)
		ResChamp = EnumèreChamp(ONG_MonOnglet, i)
	FIN
	```





<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Changer le volet d'onglet dynamique actif
<a name="changer_volet_onglet_dynamique_actif_ELTTEXTE000422"></a>
Par défaut, le dernier volet d'onglet dynamique créé est activé. Il est possible de changer l'onglet en cours par programmation.

Pour activer un volet d'onglet dynamique : 

- Affectez le champ Onglet avec l'alias du volet d'onglet dynamique à activer : 
	
	```txt
	Nom du champ Onglet = AliasDuVoletOnglet
	```


- Utilisez la propriété [Valeur](../Proprietes/2510130.md).




Rappel : Pour activer un volet d'onglet statique, il suffit d'indiquer le numéro du volet à activer. 

```txt
Nom du champ Onglet = Numéro volet
```


<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Connaître le libellé du volet d'onglet dynamique actif
<a name="connaitre_libelle_volet_onglet_dynamique_actif_ELTTEXTE000446"></a>
Pour récupérer le libellé de l'onglet actif, il suffit d'utiliser la propriété [Libellé](../Proprietes/2510053.md) sur le volet d'onglet (identifié par son alias). 

Par exemple :

```wl
AliasOnglet1 est une chaîne = OngletOuvre(ONG_Test, "Mon onglet 1", "FI_FenêtreInterne")
Trace(ONG_Test[AliasOnglet1].Libellé)
```


La propriété [Libellé](../Proprietes/2510053.md) permet également de modifier le libellé du volet d'onglet.

<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Récupérer le nom de la fenêtre interne affichée dans un volet
<a name="recuperer_nom_fenetre_interne_affichee_dans_volet_ELTTEXTE000470"></a>
Pour récupérer le nom de la fenêtre interne affichée dans un volet dynamique, il est possible d'utiliser le code suivant : 


```wl
// Récupère le volet affiché 
oFenInterne est un Champ <- ONG_Test[AliasVolet1]

// Récupère la fenêtre interne associée au volet
sNomFenêtreInterne est une chaîne
sNomFenêtreInterne = EnumèreChamp(oFenInterne, 1, parOrdreDeCréation)
```


<a name="NOTE7"></a>
<a name="NOTE7_1"></a>


## Accéder au contenu de la fenêtre interne affichée dans un volet
<a name="acceder_contenu_fenetre_interne_affichee_dans_volet_ELTTEXTE000494"></a>
Pour accéder à la valeur d'un champ ou d'une variable de la fenêtre interne affichée dans un volet dynamique, il est possible d'utiliser les [opérateurs d'indirection](../Motscles/1512005.md) : 

```wl
// Récupère la valeur d'un champ de la fenêtre interne 
Info({AliasVolet1 + ".NomChamp", indChamp})

// Récupère la valeur d'une variable de la fenêtre interne
Info({AliasVolet1 + ".NomVariable", indVariable})

// Appel une procédure de la fenêtre interne
ExécuteTraitement(AliasVolet1 + ".pNomProcédure", trtProcédure)

// Equivalent à :
MaProcédure est une Procédure = gsAlias_Onglet + ".pNomProcédure"
MaProcédure()
```


L'utilisation de procédures locales à la fenêtre pour manipuler ses champs doit être préférée à l'accès direct aux champs et variables par indirection. Cela permet de garder la fenêtre interne autonome et facilite la maintenance.

<a name="NOTE8"></a>
<a name="NOTE8_1"></a>


## Propriétés spécifiques aux champs Onglet
<a name="proprietes_specifiques_aux_champs_onglet_ELTTEXTE000518"></a>
Les propriétés suivantes sont spécifiques à la gestion des caractéristiques d'un champ Onglet dynamique par programmation.



|   |   |
| --- | --- |
| [AvecBoutonFermeture](../Proprietes/1000021374.md) | La propriété **AvecBoutonFermeture** permet de : <br><br>- Savoir si tous les volets d'un onglet dynamique possèdent une croix de fermeture. <br><br>- Configurer tous les volets d'un onglet dynamique pour afficher une croix de fermeture.<br><br><br> |
| [AvecBoutonNouveau](../Proprietes/1000021377.md) | La propriété **AvecBoutonNouveau** permet de : <br><br>- Savoir si un champ Onglet dynamique propose une croix d'ajout.  <br><br>- Configurer un champ Onglet dynamique pour proposer ou non une croix d'ajout.<br><br><br> |
| [Détaché](../Proprietes/1000026078.md) | La propriété **Détaché** permet de savoir si un volet d'un champ Onglet ou d'un champ Ruban est détaché. |
| [FenêtreSiNouveau](../Proprietes/1000021381.md) | La propriété **FenêtreSiNouveau** permet de connaître et de modifier le nom de la fenêtre interne à ouvrir si l'utilisateur final ouvre un nouveau volet dans un champ Onglet dynamique. |
| [LibelléSiNouveau](../Proprietes/1000021380.md) | La propriété **LibelléSiNouveau** permet de connaître et de modifier le libellé du nouveau volet ouvert par l'utilisateur final dans un champ Onglet dynamique. |
| [MémoriserLaConfiguration](../Proprietes/1000021383.md) | La propriété **MémoriserLaConfiguration** permet de : <br><br>- Savoir si la configuration des volets d'un champ Onglet dynamique ou d'un champ Ruban est automatiquement sauvée et restaurée. <br><br>- Modifier la configuration des volets d'un champ Onglet dynamique ou d'un champ Ruban pour qu'elle soit automatiquement sauvée et restaurée ou non.<br><br><br> |
| [OngletDynamique](../Proprietes/1000021626.md) | La propriété **OngletDynamique** permet de :<br><br>- Connaître le type d'un champ Onglet (onglet statique ou onglet dynamique).<br><br>- Modifier le type d'un champ Onglet (onglet statique ou onglet dynamique).<br><br><br> |
| [VoletDétachable](../Proprietes/1000021382.md) | La propriété **VoletDétachable** permet de : <br><br>- Savoir si les volets d'un champ Onglet dynamique ou d'un champ Ruban peuvent être sortis de la fenêtre par l'utilisateur final. <br><br>- Autoriser ou non les volets d'un champ Onglet dynamique ou d'un champ Ruban à être sortis de la fenêtre par l'utilisateur final. <br><br><br> |





Pour connaître la liste complète des propriétés du WLangage pouvant être utilisées avec un champ de type Onglet, consultez [Propriétés associées à un champ Onglet](../WDChamp/1013223.md).


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDMulti-Fenetrage.gif) ***Exemples didactiques (WINDEV)*** : **WD Multi-Fenetrage** <br>Cet exemple permet de comprendre les bases de la gestion du Multi-fenêtrage et des onglets dynamiques avec WINDEV.<br><br>Cet exemple présente une interface simple de gestion de fiches client sous deux formes :<br>- multi fenêtrée avec une interface MDI,<br>- multi onglets avec un champ onglet dynamique.




