
## Modèles de fenêtres et héritage
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000221"></a>


### Principe de l'héritage et de la surcharge
<a name="principe_heritage_surcharge_ELTPARAGRAPHE000011"></a>Lorsque vous appliquez un modèle de fenêtres à une fenêtre, l'ensemble des champs et du code du modèle sont "copiés" dans la fenêtre. C'est le concept **d'héritage**.

Les champs du modèle sont visibles dans la fenêtre, sous l'éditeur de fenêtres. Un carré jaune est situé dans le coin haut gauche de chaque champ. Par défaut, les champs du modèle ne sont pas modifiables.

Le code du modèle est visible dans l'éditeur de code, dans les différents événements de la fenêtre ou de ses champs. Ce code WLangage est facilement identifiable : 

- les événements associés au modèle sont suivis de "(modèle &lt;Nom du modèle&gt;)" (par exemple : "*Clic sur le bouton Valider (modèle MonModèle)*").

- le fond des événements est grisé, car le code n'est pas modifiable.




Dans le cas de modèle de modèles, l'héritage se fait sur plusieurs niveaux.

Il est possible de **surcharger**les champs, les procédures locales et le code du modèle. La surcharge des champs, des procédures locales et du code permet de modifier, pour une fenêtre donnée, le code, les procédures locales et / ou les champs du modèle. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Surcharge des fenêtres
<a name="surcharge_des_fenetres_ELTTEXTE000245"></a>


### Surcharger les propriétés des fenêtres
<a name="surcharger_les_proprietes_des_fenetres_ELTPARAGRAPHE000031"></a>Surcharger les propriétés des fenêtres modèle consiste à modifier les caractéristiques de la fenêtre utilisant le modèle (par exemple les caractéristiques affichées dans la fenêtre de description).

Dès qu'une caractéristique de la fenêtre utilisant le modèle est modifiée (par exemple la largeur de la fenêtre), cette propriété est surchargée.

**Remarque** : La fenêtre modèle peut utiliser un gabarit avec des champs "Décor" (par exemple le gabarit ActiveVista). Ces champs permettent d'afficher le titre de la fenêtre, d'afficher les boutons système, ... Ces champs de décor sont considérés comme étant des propriétés de la fenêtre.


<a name="NOTE2_2"></a>


### Surcharger le code des fenêtres
<a name="surcharger_code_des_fenetres_ELTPARAGRAPHE000043"></a>Pour surcharger le code des fenêtres modèle :

1. Affichez les événements de la fenêtre (option "Code" du menu contextuel).

2. Si un événement existe dans la fenêtre modèle, cet événement apparaît en double dans la fenêtre utilisant le modèle. En effet, sont affichés :

	- l'événement issu du modèle. Cet événement apparaît en grisé et son intitulé est suivi de "(modèle &lt;Nom du modèle&gt;)".

	- l'événement de la fenêtre.




3. Le code saisi dans l'événement de la fenêtre sera exécuté de la manière suivante :  

	- l'événement de déclaration des globales est fusionné entre le modèle et la fenêtre utilisant le modèle. Il est donc nécessaire de ne pas utiliser des variables de même nom dans cet événement.

	- pour tous les événements (sauf celui de fermeture de la fenêtre) : les événements des modèles appliqués à la fenêtre sont exécutés en suivant leur ordre d'inclusion, puis l'événement correspondant à la fenêtre est exécuté.

	- pour l'événement de fermeture de la fenêtre : l'événement de fermeture de la fenêtre est exécuté, puis les événements des modèles appliqués à la fenêtre sont exécutés en suivant l'ordre inverse d'inclusion.









<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Surcharge des champs
<a name="surcharge_des_champs_ELTTEXTE000275"></a>


### Surcharger le look d'un champ (surcharge d'IHM)
<a name="surcharger_look_champ_surcharge_ihm_ELTPARAGRAPHE000064"></a>Pour surcharger l'interface d'un champ du modèle (un bouton par exemple) :

1. Affichez le menu contextuel d'un bouton du modèle présent dans la fenêtre.

2. Sélectionnez l'option "Surcharger le champ".

3. Le carré jaune a été remplacé par un carré bleu, indiquant que ce champ peut être surchargé.
	![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ModeleFen_IHMNonSurchargee.gif)![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ModeleFen_IHMSurchargee.gif)

4. Vous pouvez maintenant modifier tous les aspects de l'interface du bouton : dimensions, position, style, ... <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ModeleFen_IHMModifiee.gif)






<a name="NOTE3_2"></a>


### Surcharger le code d'un champ (surcharge de code)
<a name="surcharger_code_champ_surcharge_code_ELTPARAGRAPHE000084"></a>Pour surcharger le code d'un champ du modèle (code d'un bouton par exemple) :

1. Affichez le menu contextuel d'un bouton du modèle présent dans la fenêtre.

2. Sélectionnez l'option "Surcharger le champ".

3. Le carré jaune a été remplacé par un carré bleu, indiquant que ce champ peut être surchargé.

4. Affichez le code du bouton (option "Code" du menu contextuel).

5. Deux sections de code de clic sont présents : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ModeleFen_CodeNonSurcharge.gif)


	- le code de clic issu du modèle.

- le code de clic de la fenêtre. Une fonction a été automatiquement ajoutée : [ExécuteAncêtre](../WDLang1/3013063.md). Cette procédure exécute le code de clic du modèle.

6. Ajoutez le code du bouton spécifique à la fenêtre en cours, avant et/ou après la procédure d'appel au code du modèle. Vous pouvez supprimer la fonction [ExécuteAncêtre](../WDLang1/3013063.md) si vous ne souhaitez pas que le code du modèle soit exécuté.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ModeleFen_CodeSurcharge.gif)








<a name="NOTE3_3"></a>


### Remarques
<a name="remarques_ELTPARAGRAPHE000111"></a>

- Il n'est pas possible de supprimer un bouton surchargé d'un modèle.

- La surcharge d'une table surchage également les colonnes. Il est possible d'ajouter des colonnes dans une table héritée.

- Il est possible d'ajouter des volets à un onglet du modèle et de mettre des champs du modèle dans ce volet.

- La surcharge de style n'est pas disponible.






<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Gérer les propriétés surchargées d'un champ
<a name="gerer_les_proprietes_surchargees_champ_ELTTEXTE000311"></a>


### Connaître les propriétés surchargées :
<a name="connaitre_les_proprietes_surchargees_ELTPARAGRAPHE000124"></a>Pour connaître les propriétés d'un champ qui ont été surchargées :

1. Ouvrez le menu contextuel du champ.

2. Sélectionnez l'option "Propriétés surchargées".

3. La fenêtre de gestion des surcharges s'ouvre.




Il est possible depuis cette fenêtre de supprimer les propriétés surchargées. Il suffit de sélectionner la propriété voulue et de la supprimer.

Pour supprimer complètement toutes les surcharges effectuées sur un champ, il suffit de sélectionner la ligne intitulée "Surcharge complète".







## Surcharge des procédures locales
<a name="surcharge_des_procedures_locales_ELTTEXTE000335"></a>


### Surcharger le code d'une procédure locale
<a name="surcharger_code_une_procedure_locale_ELTPARAGRAPHE000142"></a>Pour surcharger le code d'une procédure locale depuis de volet "Explorateur de projet" :

1. Sélectionnez l'élément associé à la procédure locale (fenêtre, page, état, ...).

2. Déroulez les options de l'élément et sélectionnez l'option "Procédures locales" de l'élément.

3. Sélectionnez la procédure à surcharger.

4. Affichez le menu contextuel et sélectionnez l'option "Surcharger le code de la procédure locale".

5. Deux sections de code de clic sont présents : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=heritage_surcharge_proc.gif)


	- le code de la procédure issu du modèle.

- le code de la nouvelle procédure. Une fonction a été automatiquement ajoutée : [ExécuteAncêtre](../WDLang1/3013063.md). Cette fonction exécute le code de la procédure du modèle.

6. Ajoutez le code de la nouvelle procédure spécifique à l'élément en cours, avant et/ou après la procédure d'appel au code du modèle. Vous pouvez supprimer la fonction [ExécuteAncêtre](../WDLang1/3013063.md) si vous ne souhaitez pas que le code du modèle soit exécuté.
	**Attention** : le prototype de la procédure surchargée doit être identique au prototype de la nouvelle procédure.








<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Limitations
<a name="limitations_ELTTEXTE000359"></a>


- Il n'est pas possible d'utiliser une requête intégrée dans un champ du modèle. L'exécution de la fenêtre utilisant le modèle provoquera une erreur.

- Il n'est pas possible d'utiliser un menu dans un modèle : le menu ne sera pas recopié dans la fenêtre utilisant le modèle.

- La surcharge de style n'est pas disponible. 







