
## Imprimer au format PDF
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000300"></a>
WINDEV, WEBDEV et WINDEV Mobile permettent de créer un fichier PDF lors d'une impression. 

Ce fichier PDF peut être créé : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) à partir d'un état créé sous l'éditeur d'états. 

- à partir d'une impression réalisée à l'aide des fonctions WLangage. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) directement par l'utilisateur final via le visualisateur de rapports.




![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Remarques : 

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seules les impressions réalisées par programmation et au format PDF sont disponibles. Il n'est pas possible de réaliser une impression via l'éditeur d'états.

- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Seules les impressions au format PDF sont disponibles (impression d'états ou impression réalisée par programmation). 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 

## Imprimer un état créé avec l'éditeur d'états
<a name="imprimer_etat_cree_avec_editeur_etats_ELTTEXTE000324"></a>


### Imprimer un état au format PDF
<a name="imprimer_etat_format_pdf_ELTPARAGRAPHE000038"></a>Pour imprimer un état au format PDF : 

1. Créez l'état voulu sous l'éditeur d'états. 

2. Dans le traitement d'impression de l'état au format PDF : 

	- Configurez les options d'impression au format PDF grâce à la fonction [iParamètrePDF](../WDLang5/3046007.md). Vous pouvez définir :

		- le mot de passe utilisé pour l'ouverture du fichier PDF.

		- les options de compression des images.

		- les options de présence des signets.

		- les options de protection du fichier PDF. Il est également possible de définir le mot de passe permettant de modifier ces options de protection.

		- l'utilisation du format Unicode. 

		- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) l'utilisation du format PDF/A (la version gérée est PDF/A-1b). 




- Définissez la destination de l'état grâce à la fonction [iDestination](../WDLang5/3046074.md). Dans ce cas, l'état doit être imprimé au format PDF (constante *iPDF* ou *iPDFGénérique*). 

- Lancez l'impression de l'état au format PDF grâce à la fonction [iImprimeEtat](../WDLang5/3046032.md). 





### Remarques
<a name="remarques_ELTPARAGRAPHE000070"></a>

- L'ordre d'utilisation des fonctions [iDestination](../WDLang5/3046074.md) et [iParamètrePDF](../WDLang5/3046007.md) n'a aucune importance. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Il est possible de signer le fichier PDF généré grâce au [champ Signature](../WDChamp/1410087013.md). 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Si l'état doit être imprimé au format PDF/A, il est possible d'activer les erreurs d'UI spécifiques à ce format : 

	1. Affichez la fenêtre de description de l'état (option "Description de l'état" du menu contextuel). 

	2. Dans l'onglet "Options", cochez l'option "Activer les erreurs spécifiques à l'export PDF/A-1b et PDF/A-3b". 

	3. Validez la fenêtre de description de l'état et enregistrez l'état. Les erreurs sont affichées dans le volet "Erreurs de compilation".







- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Il est possible d'ouvrir directement le fichier PDF généré grâce à la fonction [LanceAppliAssociée](../WDLang1/3035007.md). 







### Exemples
<a name="exemples_ELTPARAGRAPHE000118"></a>


```wl
iDestination(iPdf) 
iImprimeEtat(ETAT_MonEtatPDF)
```



```wl
iDestination(iPdf)
// Protection du fichier PDF contre l'impression 
// et contre la sélection et le copier/coller 
// Pas de mot de passe pour l'ouverture du fichier PDF
// Mot de passe pour modifier les mesures de protection
iParamètrePDF(iProtectionImpression + iProtectionSélection, "", "Protection")
// Impression de l'état
iImprimeEtat(ETAT_MonEtatPDF)
```








<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Imprimer une impression programmée en WLangage
<a name="imprimer_une_impression_programmee_wlangage_ELTTEXTE000360"></a>


### Imprimer une impression WLangage au format PDF
<a name="imprimer_une_impression_wlangage_format_pdf_ELTPARAGRAPHE000131"></a>Pour réaliser une impression WLangage au format PDF : 

1. Définissez la destination de l'impression et les paramètres du fichier PDF à générer avec les fonctions :  

	- [iDestination](../WDLang5/3046074.md) pour définir l'impression au format PDF (constante *iPDF* ou *iPDFGénérique*). 

	- [iParamètrePDF](../WDLang5/3046007.md) pour configurer les options d'impression au format PDF. Vous pouvez définir :

		- le mot de passe utilisé pour l'ouverture du fichier.

		- les options de compression des images.

		- les options de présence des signets.

		- les options de protection du PDF. Il est également possible de définir le mot de passe permettant de modifier ces options de protection.

		- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) l'utilisation du format PDF/A (la version gérée est PDF/A-1b). 




2. Utilisez les fonctions d'impression pour définir le contenu de l'impression. 

3. Lancez l'impression grâce à la fonction [iFinImprime](../WDLang5/3046053.md). 





### Remarques
<a name="remarques_ELTPARAGRAPHE000160"></a>

- L'ordre d'utilisation des fonctions [iDestination](../WDLang5/3046074.md) et [iParamètrePDF](../WDLang5/3046007.md) n'a aucune importance. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Il est possible de signer le fichier PDF généré grâce à la fonction [iImprimeSignature](../WDLang5/1000021690.md). Cette fonction doit être utilisée en même temps que les fonctions d'impression. 

- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Il est possible d'ouvrir directement le fichier PDF généré grâce à la fonction [LanceAppliAssociée](../WDLang1/3035007.md). 





### Exemples
<a name="exemples_ELTPARAGRAPHE000203"></a>


```wl
// Création du PDF
iDestination(iPDF, "C:\Temp\MonPDF.PDF")
// Code d'impression
iCréePolice(1, 16, iGras, iRoman)
//Appel de procédures permettant d'imprimer le contenu
ImprimeTitre()
ImprimeTexte()
// Fin de l'impression et fermeture du fichier PDF créé
iFinImprime()
```


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
```wl
// Protection du PDF contre l'impression
// et contre la sélection et le copier/coller
// Pas de mot de passe pour l'ouverture du PDF
// Mot de passe pour modifier les mesures de protection
iParamètrePDF(iProtectionImpression + iProtectionSélection, "", "Protection")
// Création du PDF
iDestination(iPDF, "C:\Temp\MonPDF.PDF")
// Code d'impression
iCréePolice(1, 16, iGras, iRoman)
//Appel de procédures permettant d'imprimer le contenu
ImprimeTitre()
ImprimeTexte()
// Fin de l'impression et fermeture du fichier PDF créé
iFinImprime()
```


<a name="NOTE4"></a>
<a name="NOTE4_1"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

## Imprimer un PDF depuis le visualisateur de rapports
<a name="imprimer_pdf_depuis_visualisateur_rapports_ELTTEXTE000396"></a>


### Principe
<a name="principe_ELTPARAGRAPHE000217"></a>Dans les applications WINDEV, l'utilisateur final a la possibilité de choisir le mode d'impression depuis le visualisateur de rapports. Il peut choisir d'imprimer au format PDF si l'option "PDF" est disponible dans le volet "Exporter" du visualisateur de rapports. 

Dans ce cas, les options définies avec la fonction [iParamètrePDF](../WDLang5/3046007.md) sont automatiquement prises en compte. 


### Evénement "Avant réimpression de l'état"
<a name="evenement_avant_reimpression_etat_ELTPARAGRAPHE000229"></a>L'événement "Avant réimpression de l'état" permet de connaître le mode d'impression de l'état choisi par l'utilisateur. Il est possible dans cet événement de paramétrer par exemple les options de génération du fichier PDF en fonction de choix effectués par l'utilisateur. 

Exemple : Lors de l'impression via le visualisateur de rapports, le code suivant permet d'ouvrir une fenêtre pour demander le mot de passe du fichier PDF à générer : 


```wl
// -- Evénement Avant réimpression de l'état
SI iDestination = iPDF ALORS
	sMotdepasse est une chaîne = Ouvre(FEN_ParametragePDF)
	iParamètrePDF(sMotdepasse)
FIN
```




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Remarques et limitations
<a name="remarques_limitations_ELTTEXTE000426"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Remarques
<a name="remarques_ELTPARAGRAPHE000244"></a>Des fonctions spécifiques à la gestion des fichiers PDF sont également disponibles. Pour plus de détails, consultez [Fonctions de gestion des fichiers PDF](../WDLang6/1000015007.md). 


### Conseil général
<a name="conseil_general_ELTPARAGRAPHE000450"></a>Pour un meilleur rendu, utilisez des polices TrueType ou OpenType.

**Attention** : les polices OpenType ne sont pas incorporées dans le PDF généré. Il est nécessaire d'installer ces polices sur le poste client pour obtenir un rendu correct. 


### Disponibilité des champs dans les états
<a name="disponibilite_des_champs_dans_les_etats_ELTPARAGRAPHE000457"></a>Les champs suivants **ne sont pas** disponibles : 

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Champ RTF

- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Champ de saisie

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Champ Signature

- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Champ Agenda

- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Champ Planning

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Champ Diagramme de Gantt

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Champ Tableau croisé dynamique

- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Champ Tableur

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Champ HTML

- Champ Graphe : Seuls les champs Graphe créés à partir de la version 17 sont disponibles. 





### Champ au format RTF
<a name="champ_format_rtf_ELTPARAGRAPHE000491"></a>Limitations générales : 

- Le libellé au format RTF peut être tronqué lors d'un saut de page.

- Les tableaux contenus dans un champ RTF ne sont pas imprimés.

- Les images utilisées dans les champs RTF ne sont pas imprimées.


La fonction [iParamètre](../WDLang5/3046008.md) utilisée avec le paramètre "RTFWINDOWS=NON" ou avec la constante *iRTFAvecImagesEtTableaux* permet d'imprimer correctement les tableaux et les images contenus dans les champs RTF. ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Les champs RTF et les options de format RTF ne sont pas disponibles.
![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 

### PDF en fond d'état
<a name="pdf_fond_etat_ELTPARAGRAPHE000512"></a>Il n'est pas possible d'utiliser un PDF en image de fond de l'état.
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Impression au format PDF/A-1b
<a name="impression_format_pdfa1b_ELTPARAGRAPHE000521"></a>

- La transparence des images n'est pas gérée : 

	- Si l'image contient dans son format un fond transparent, l'image sera dessinée sur un fond blanc. 

	- Si la couleur "Magenta transparent" est utilisée, le rendu de l'image pourra être différent dans le PDF généré. 




- Les polices de type "Opentype" ne sont pas gérées car les polices "Opentype" ne sont pas incorporables dans le PDF généré. 

- Toutes les polices utilisées doivent être incorporables dans le PDF généré et doivent contenir tous les caractères affichés. 

	- En Windows, s'il manque des caractères, la police de substitution utilisée est "Arial Unicode ms". 

	- En Linux, s'il manque des caractères, une erreur est affichée. 







Astuce : Comment savoir si l'impression au format PDF/1-1b sera correcte ? 

- Si l'impression est réalisée à partir d'un état, il est possible d'activer les erreurs d'IHM spécifiques à ce format (onglet "Options" de la fenêtre de description de l'état, option "Activer les erreurs spécifiques à l'export PDF/A-1b"). 

- Dans tous les cas, lors d'un audit dynamique, les erreurs spécifiques à la gestion des PDF/A-1b sont détectées et affichées. 









