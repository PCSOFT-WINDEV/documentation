


## Fenêtre popup
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000251"></a>
WINDEV et WINDEV Mobile permettent d'ouvrir des fenêtres sous forme de popup.

Une fenêtre popup correspond à une fenêtre apparaissant lors d'un clic sur un champ et dans laquelle l'utilisateur va pouvoir sélectionner un élément.

Une fenêtre popup peut contenir tous les types de champs.

Exemple de fenêtre popup : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ComboFen.gif)


<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Créer une fenêtre popup
<a name="creer_une_fenetre_popup_ELTTEXTE000275"></a>
Pour créer une fenêtre popup : 

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif) parmi les boutons d'accès rapide. 

	- La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Fenêtre" puis sur "Fenêtre".

	- L'assistant de création d'une fenêtre se lance.




2. Affichez l'onglet "Standard".

3. Sélectionnez "Vierge pour Popup".

4. Sélectionnez si nécessaire le gabarit de la fenêtre popup et validez.




**Remarque** : Il est également possible d'utiliser un autre type de fenêtre en tant que fenêtre popup. Dans ce cas :

- la barre de titre de la fenêtre sera réduite (aucun titre ne sera affiché).

- la fenêtre ne pourra pas être maximisée ou réduite.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Ouvrir une fenêtre popup
<a name="ouvrir_une_fenetre_popup_ELTTEXTE000299"></a>


### Ouverture automatique à partir d'un champ Combo
<a name="ouverture_automatique_partir_champ_combo_ELTPARAGRAPHE000047"></a>Si la fenêtre popup est ouverte à partir d'un champ Combo, aucune programmation n'est nécessaire. Il suffit de :

1. Cocher l'option "Fenêtre popup" dans l'onglet "Contenu" du champ.

2. Sélectionner la fenêtre popup à ouvrir.


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les fenêtres popup ne peuvent pas être associées à un champ de type Combo. 
<a name="NOTE3_2"></a>


### Ouverture par programmation : 
<a name="ouverture_par_programmation_ELTPARAGRAPHE000061"></a>Les fonctions permettant d'ouvrir une fenêtre popup sont les suivantes :



|   |   |
| --- | --- |
| [OuvrePopup](../WDLang1/3038046.md) | Ouvre une fenêtre de type popup et attend sa fermeture. |
| [OuvrePopupPosition](../WDLang1/3038047.md) | Ouvre une fenêtre de type popup en précisant sa position d'ouverture et attend sa fermeture. |





![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ces fonctions ne sont pas disponibles. 
<a name="NOTE3_3"></a>


### Position de la fenêtre popup
<a name="position_fenetre_popup_ELTPARAGRAPHE000073"></a>Par défaut, la fenêtre popup s'ouvre sous le champ qui ouvre la fenêtre popup (champ Combo ou champ qui exécute la fonction [OuvrePopup](../WDLang1/3038046.md)).

S'il n'y a pas assez de place pour ouvrir la fenêtre popup, la fenêtre s'ouvrira soit au-dessus du champ, soit au-dessous du champ vers la gauche.

La fonction [OuvrePopupPosition](../WDLang1/3038047.md) permet de paramétrer précisément la position d'ouverture de la fenêtre popup.
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette fonctionnalité n'est pas disponible. 
<a name="NOTE3_4"></a>


### Programmation de la fenêtre popup
<a name="programmation_fenetre_popup_ELTPARAGRAPHE000093"></a>

- Le mot-clé [MonChampPopup](../Motscles/1511005.md) permet de manipuler le champ qui a ouvert une fenêtre popup.

- Il est possible de passer des paramètres à une fenêtre popup. Les paramètres sont alors récupérés dans l'événement "Déclarations globales" de la fenêtre popup. La première ligne de code de cet événement doit correspondre à la ligne suivante :
	
	```txt
	PROCEDURE <Nom de la fenêtre> (<Paramètre1> [, <Paramètre2> [, ...]])
	```

	Pour plus de détails, consultez [Fenêtre paramétrée](../WDChamp/1010026.md). 

- Il n'est pas possible d'ouvrir une fenêtre popup depuis une fenêtre popup.

- A partir d'une fenêtre popup, seule une fenêtre modale peut être ouverte (fonction [Ouvre](../WDLang1/3038035.md)). L'ouverture d'une fenêtre modale depuis une fenêtre popup ne ferme pas automatiquement la fenêtre popup. Il faut traiter la valeur de retour de la fonction [Ouvre](../WDLang1/3038035.md) et utiliser la fonction [Ferme](../WDLang1/3038018.md) pour fermer la fenêtre popup.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Fermer une fenêtre popup
<a name="fermer_une_fenetre_popup_ELTTEXTE000357"></a>


### Principe
<a name="principe_ELTPARAGRAPHE000124"></a>Une fenêtre popup se ferme automatiquement :

- soit dès qu'un élément est sélectionné.

- soit lorsque la fenêtre perd le focus.

- soit lors de l'appui sur la touche Echap du clavier.

- soit lors de l'appel de la fonction [Ferme](../WDLang1/3038018.md).




La valeur sélectionnée par l'utilisateur est renvoyée au champ qui a ouvert la fenêtre popup grâce à une des méthodes suivantes :

- soit par le mot-clé [RENVOYER](../Motscles/1510007.md) présent le code de fermeture de la fenêtre,

- soit par la fonction [Ferme](../WDLang1/3038018.md),

- soit par la propriété [ValeurRenvoyée](../Proprietes/2510134.md) utilisée avant la fermeture de la fenêtre.




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Fenêtre popup et champ Combo
<a name="fenetre_popup_champ_combo_ELTTEXTE000381"></a>


### Principe
<a name="principe_ELTPARAGRAPHE000156"></a>Dans les champs Combo, il est possible d'ouvrir directement une fenêtre popup à la place de la liste habituelle. Il suffit de cocher l'option "Fenêtre popup" dans l'onglet "Contenu" du champ et de sélectionner la fenêtre popup à ouvrir.

**Remarque** : Pour passer des paramètres à la fenêtre popup, il est nécessaire d'utiliser la fonction [OuvrePopup](../WDLang1/3038046.md).
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette fonctionnalité n'est pas disponible. 
<a name="NOTE5_2"></a>


### Valeur renvoyée par la fenêtre popup
<a name="valeur_renvoyee_par_fenetre_popup_ELTPARAGRAPHE000171"></a>En règle générale, la valeur renvoyée par la fenêtre popup correspond à la valeur affichée dans le champ Combo.

Lors de la fermeture de la fenêtre popup, plusieurs cas peuvent se présenter selon le type du champ Combo :

- ***Champ Combo par programmation sans saisie*** : 
	La valeur renvoyée est recherchée dans le champ Combo.
	Si la valeur est trouvée, cette valeur est sélectionnée dans le champ.
	Si la valeur n'est pas trouvée, cette valeur est ajoutée puis sélectionnée dans le champ.

- ***Champ Combo par programmation avec saisie*** :
	La valeur renvoyée est directement saisie dans le champ Combo.

- ***Champ Combo fichier sans saisie*** : 
	La valeur renvoyée doit correspondre à la valeur affichée dans le champ Combo.
	La valeur renvoyée est recherchée dans le champ.
	Si la valeur est trouvée, cette valeur est sélectionnée dans le champ.
	Si la valeur n'est pas trouvée, aucune valeur n'est affichée dans le champ.

- ***Champ Combo fichier avec saisie*** :
	La valeur renvoyée est directement saisie dans le champ Combo.


La valeur renvoyée doit donc être au format utilisé par la fonction [ListeAjoute](../WDLang1/3049004.md). Il est tout à fait possible d'utiliser le format suivant :

```txt
RENVOYER gValeurMémorisée(ValeurMémorisée) + ValeurAffichée
```



