


## Création d'un champ Tableau croisé dynamique
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Comment créer le champ Tableau croisé dynamique (dans une fenêtre) ?
<a name="comment_creer_champ_tableau_croise_dynamique_dans_une_fenetre_ELTTEXTE000168"></a>
Pour créer un champ de type Tableau croisé dynamique dans une fenêtre : 

1. Sous le volet "Création", dans le groupe "Données", déroulez "Table et Liste" et sélectionnez "Tableau croisé dynamique (TCD)". 

2. Cliquez dans la fenêtre à la position où le champ doit être créé. L'assistant de création du champ se lance. Cet assistant permet de définir les principaux éléments du tableau croisé dynamique. 

3. A la fin de l'assistant, le champ Tableau croisé dynamique est automatiquement créé avec le champ Bouton permettant de le remplir en exécution. 




Remarques : 

- Le champ Tableau croisé dynamique fonctionne : 

	- sur des bases de données HFSQL, 

	- sur d'autres bases de données via l'utilisation de tableaux de structures.  




- Il est possible d'imprimer le contenu du champ Tableau croisé dynamique via son menu contextuel. Pour plus de détails, consultez [Imprimer le contenu d'un champ Tableau croisé dynamique (FAA)](../WDChamp/1000029009.md). 

- Il est possible de créer un état basé sur un champ Tableau croisé dynamique. Pour plus de détails, consultez [Etat Tableau croisé dynamique](../WDChamp/1011092.md). 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Assistant de création du champ Tableau croisé dynamique
<a name="assistant_creation_champ_tableau_croise_dynamique_ELTTEXTE000192"></a>
L'assistant de création du champ Tableau croisé dynamique permet de définir les éléments de base du tableau. 

1. Tout d'abord, l'assistant permet de définir les **valeurs affichées** dans les cellules du tableau croisé dynamique. Une cellule d'un tableau croisé dynamique peut afficher par exemple la somme des ventes, la somme des quantités, le nombre de commandes, ...
	Il est donc nécessaire de définir pour chaque valeur affichée dans la cellule : 

	- le **fichier source**. Ce fichier correspond au fichier contenant la valeur utilisée pour le calcul. Par exemple, le fichier LigneCde pour calculer les ventes effectuées. 

	- le **calcul affiché**. Plusieurs calculs sont disponibles : somme, moyenne, comptage, ...

	- la **source du calcul**, c'est-à-dire la rubrique du fichier source à utiliser. Par exemple, pour calculer les ventes effectuées, la somme sera effectuée sur le prix de vente (rubrique Total_Ligne du fichier LigneCde). 
			Le bouton "Ajouter une valeur supplémentaire" permet de définir une nouvelle valeur qui sera affichée dans la cellule. 
			**Remarques** : 

		- Le champ Tableau croisé dynamique peut être basé sur une requête. Dans ce cas, le fichier source correspond à la requête. 

		- Le champ Tableau croisé dynamique peut être basé sur une variable de type Tableau de Structures. Dans ce cas, le fichier source correspond à la variable.




2. L'étape suivante consiste à définir **l'entête de colonnes** du champ Tableau croisé dynamique. L'entête des colonnes provient directement de vos fichiers de données. 
	Il peut y avoir un ou plusieurs entêtes de colonnes. 
	Pour chaque entête de colonne, l'assistant permet de définir : 

	- la liaison permettant d'accéder à la rubrique affichée dans l'entête. Cette liaison est effectuée à partir du fichier de données utilisé pour la source du calcul. 

	- si l'entête de colonne correspond à une rubrique de type Date, l'assistant propose le mode d'affichage de la date : Année, Semestre, Trimestre, Mois, Quinzaine, Semaine, Jour. Pour chaque mode d'affichage sélectionné, un nouveau regroupement sera effectué. Par exemple, si seuls les années, trimestres et mois sont affichés, l'entête de colonne sera le suivant :![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=TCD_Entete_Date.gif)
**Remarques** : 

		- Si le champ Tableau croisé dynamique est basé sur une requête, les différentes données affichées en entête de colonne proviennent directement de la requête. 

		- Si le champ Tableau croisé dynamique est basé sur une variable de type Tableau de Structures, les différentes données affichées en entête de colonne proviennent directement des membres de la structure. 




3. L'étape suivante consiste à définir **l'entête des lignes** du champ Tableau croisé dynamique. L'entête des lignes provient directement de vos fichiers de données. 
	Il peut y avoir un ou plusieurs entêtes de lignes. 
	Pour chaque entête de ligne, l'assistant permet de définir : 

	- la liaison permettant d'accéder à la rubrique affichée dans l'entête. Cette liaison est effectuée à partir du fichier de données utilisé pour la source du calcul. 

	- si l'entête de ligne correspond à une rubrique de type Date, l'assistant propose le mode d'affichage de la date : Année, Semestre, Trimestre, Mois, Quinzaine, Semaine, Jour. Pour chaque mode d'affichage sélectionné, un nouveau regroupement sera effectué.
			**Remarques** : 

		- Si le champ Tableau croisé dynamique est basé sur une requête, les différentes données affichées en entête de ligne proviennent directement de la requête. 

		- Si le champ Tableau croisé dynamique est basé sur une Tableau de Structures, les différentes données affichées en entête de ligne proviennent directement des membres de la structure. 




4. Donnez un nom au champ Tableau croisé dynamique et validez. 
	Remarque : Les dimensions du champ créé sont optimisées pour occuper l'espace disponible à la position indiquée. Si la taille du champ ne vous convient pas, utilisez la combinaison de touches Ctrl + Z : le champ retrouvera sa taille par défaut.




Le champ Tableau croisé dynamique est créé dans la fenêtre avec un champ Bouton "Calculer". Ce champ Bouton permet de lancer le calcul du champ Tableau croisé dynamique. 

**Attention** : Si la source du champ Tableau croisé dynamique est : 

- une requête, il est nécessaire d'exécuter la requête avant de lancer le calcul du champ Tableau croisé dynamique.

- un tableau de structures, il est nécessaire de remplir le tableau de structures avant de lancer le calcul du champ Tableau croisé dynamique.




Pour modifier les caractéristiques du champ Tableau croisé dynamique, affichez la description du champ (option "Description" du menu contextuel). Pour plus de détails, consultez [Description d'un champ Tableau croisé dynamique](../WDChamp/1000029007.md). 


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDTableauCroiseDynamique.gif) ***Exemples didactiques (WINDEV)*** : **WD TableauCroiséDynamique** <br>Cet exemple illustre l'utilisation du champ Tableau croisé dynamique.<br><br>Ce champ tableau croisé dynamique permet d'afficher des statistiques dynamiques en effectuant des regroupements.<br>Ces statistiques sont calculées à partir de la base de données.


