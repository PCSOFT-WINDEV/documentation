


## Impression d'un état en WEBDEV
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>
Lors de la création d'un état, il est possible de tester directement cet état depuis l'éditeur d'états.

Il est également possible d'intégrer cet état à vos applications ou à vos sites. L'utilisateur ou l'internaute pourra ainsi lancer l'impression de l'état directement depuis un bouton, une option de menu, ... par exemple.

Dans le cas d'un site WEBDEV, le poste serveur se chargera de préparer l'état au format choisi (PDF, HTML, ...). Selon vos besoins, vous pourrez alors :

- afficher cet état sur le navigateur de l'internaute,

- l'enregistrer sur le serveur et proposer à l'internaute de le télécharger ou de l'afficher, ...




Dans un site Intranet, il est également possible d'imprimer directement l'état sur une imprimante locale ou réseau connectée au serveur.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Principe d'impression en WEBDEV
<a name="principe_impression_webdev_ELTTEXTE000168"></a>
Quel que soit le type d'état à imprimer, le principe de lancement d'un état est le suivant (en code serveur) :

1. Spécifier le mode d'impression de l'état (impression directe, génération d'une page HTML, génération d'un fichier PDF, ...) avec la fonction [iDestination](../WDLang5/3046074.md).

2. Lancer l'impression avec la fonction [iImprimeEtat](../WDLang5/3046032.md).

3. Selon vos besoins, vous pourrez ensuite :

	- afficher le fichier généré sur le poste de l'internaute grâce à la fonction [FichierAffiche](../WDLang2/3012005.md).

	- envoyer un email à l'internaute pour lui proposer de télécharger le fichier créé.

	- ...







**Attention** : Si la destination de l'impression est un fichier HTML, PDF, XML ou RTF, vérifiez les points suivants :

- Vous disposez des droits d'écriture dans le répertoire dans lequel le document va être généré (par défaut, le document est généré dans le répertoire du site).
	Si vous générez un état au format PDF, ce fichier peut être enregistré dans le répertoire des données (chemin connu avec la fonction [fRepDonnées](../WDLang1/3036001.md))
	Si vous générez un état au format HTML, ce fichier doit être enregistré dans le répertoire _WEB du site (chemin connu avec la fonction [fRepWeb](../WDLang1/3036052.md)).

- Utilisez un nom spécifique pour chaque document généré sur le serveur. Dans le cas contraire, plusieurs impressions simultanées écraseraient les impressions déjà réalisées. 
	Utilisez par exemple les fonctions serveur [ConnexionOccurrence](../WDLang2/3012004.md) ou [DonneIdentifiant](../WDLang1/3013028.md) pour nommer vos états (par exemple : NomFichier = "EtatClient" + **ConnexionOccurrence**() + ".HTML").




Ce principe doit être adapté et complété selon la source de données utilisée dans chaque état.

Les paragraphes suivants présentent :

- [l'impression par programmation d'un état sur fichier de données.](../WDChamp/1011052.md)

- [l'impression par programmation d'un état sur une requête.](../WDChamp/1011013.md)

- [l'impression par programmation d'un état sur une vue HFSQL](../WDChamp/1011064.md). 

- [l'impression par programmation d'un état sur une zone mémoire.](../WDChamp/1011061.md)

- [l'impression par programmation d'un état sur un champ Table.](../WDChamp/1011012.md)

- [l'impression par programmation d'un état sur un champ Agenda.](../WDChamp/1011081.md)

- [l'impression par programmation d'un état sur un champ Planning.](../WDChamp/1011080.md)

- [l'impression par programmation d'un état sur un champ Table hiérarchique.](../WDChamp/1011082.md)

- [l'impression par programmation d'un état sur un fichier texte.](../WDChamp/1011011.md)

- [l'impression par programmation d'un état sur une requête SQL via une connexion.](../WDChamp/1011066.md)





