


## Le champ Table hiérarchique Fichier
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000207"></a>
Un champ Table hiérarchique fichier est une table hiérarchique liée à un fichier de données ou à une requête. Dans ce cas, la table hiérarchique ne peut être liée qu'à un fichier de données ou une requête chargée en mémoire.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000231"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Créer un champ Table hiérarchique fichier
<a name="creer_champ_table_hierarchique_fichier_ELTPARAGRAPHE000031"></a>Pour créer un champ de type Table hiérarchique fichier :

1. Sous le volet "Création", dans le groupe "Données", déroulez "Table et Liste" et sélectionnez "Table hiérarchique".

2. Cliquez dans la fenêtre à la position où le champ doit être créé.

3. Affichez l'onglet "Contenu" de la fenêtre de description du champ Table hiérarchique. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=TableH_Fichier_Contenu.gif&type=thumb)
Cet onglet permet de définir les différentes sources du champ Table hiérarchique. En effet, un champ Table hiérarchique fichier est liée à différentes sources, permettant d'afficher des enregistrements imbriqués.
	Sélectionnez le mode de remplissage "Fichier/Requête".

4. Définissez si nécessaire les liaisons des différentes colonnes du champ Table hiérarchique.




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Option "Remplissage différé des sous-niveaux (plus rapide)"**
Lorsque un champ Table hiérarchique fichier comporte de nombreux éléments et sous-éléments, son remplissage complet peut être long. 

L'option "Remplissage différé des sous-niveaux (plus rapide)" permet de remplir chaque sous-niveau uniquement lorsque l'utilisateur clique pour dérouler un niveau. Dans ce cas, la durée de remplissage est répartie et le remplissage initial est beaucoup plus rapide. 

**Note** : Pour utiliser cette option sur un champ Table hiérarchique rempli par programmation, utilisez la propriété [AjouteFilsDifféré](../Proprietes/1000020927.md). 
<a name="NOTE2_2"></a>


### Définir les sources du champ Table hiérarchique fichier (fenêtre de description du champ)
<a name="definir_les_sources_champ_table_hierarchique_fichier_fenetre_description_champ_ELTPARAGRAPHE000111"></a>Pour définir les sources du champ Table hiérarchique fichier : 

1. Affichez la fenêtre de description du champ. 

2. Dans l'onglet "Contenu", choisissez si nécessaire le remplissage "Fichier/Requête". 

3. Cliquez sur le bouton "Ajouter". Une source de type "&lt;Aucun&gt;" est automatiquement ajoutée.

4. Définissez les caractéristiques de cette source :

	- Source : correspond au fichier de données ou à la requête qui va être parcourue.

	- Parcours : correspond à la clé de parcours utilisée pour parcourir la source.

	- Affichée : correspond à la rubrique affichée dans la première colonne du champ Table hiérarchique.
			




5. Définissez si nécessaire la source de la liaison du niveau précédent. Par exemple, si le premier niveau parcourt le fichier Client, le second peut par exemple parcourir le fichier de données Commande. Les rubriques qui permettront la liaison sont "Client.IDClient" et "Commande.IDClient". Par défaut, la source de la liaison est automatiquement déduite des rubriques et des liaisons définies dans l'analyse.

6. Définissez autant de sources que nécessaire.




La première colonne du champ Table hiérarchique affiche les données "affichées" des différentes sources sélectionnées.

**Cas particulier : Champ Table hiérarchique fichier récursif**
Un champ Table hiérarchique fichier peut afficher des enregistrements dépendant de l'enregistrement précédent (cas classique d'une liaison récursive permettant par exemple de gérer les parents / enfants)<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=TableH_Fichier_Recursive.gif)
Pour gérer ce type de champ Table hiérarchique, il est possible de définir une liaison réflexive dans l'onglet "Contenu" de la fenêtre de description du champ.
Les lignes de type "racine" sont associées à un enregistrement pour lequel la rubrique de liaison correspond à 0 ou vide (selon le type de la rubrique).
<a name="NOTE2_3"></a>


### Définir les liaisons des différentes colonnes du champ Table hiérarchique fichier
<a name="definir_les_liaisons_des_differentes_colonnes_champ_table_hierarchique_fichier_ELTPARAGRAPHE000143"></a>Par défaut, la première colonne du champ Table hiérarchique fichier (colonne représentant la hiérarchie) affiche les éléments indiqués dans les sources (onglet "Contenu", valeur "Affiché" des différentes sources).

Le champ Table hiérarchique peut également afficher d'autres données dans ses autres colonnes.

Pour définir les liaisons des différentes colonnes : 

1. Créez si nécessaire une nouvelle colonne (bouton "Nouveau" de la fenêtre de description du champ Table hiérarchique) ou sélectionnez une colonne existante.

2. Affichez l'onglet "Liaison" et définissez la liaison voulue. La liaison peut être :

	- **mono-fichier** : dans ce cas, la liaison concerne un des fichiers source du champ Table hiérarchique. 
			Si une modification est réalisée dans les enregistrements affichés par le champ Table hiérarchique, cette modification est automatiquement reportée dans le fichier de données associé.

	- **multi-fichier** : dans ce cas, la liaison peut être réalisée avec un des fichiers reliés à un des fichiers source. 
			Si une modification est réalisée dans les enregistrements affichés par le champ Table hiérarchique, cette modification ne sera pas automatiquement reportée dans le fichier de données associé. Il est nécessaire de le gérer par programmation.




3. Validez.





