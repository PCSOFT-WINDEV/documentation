


## Evénements associés à une colonne de type Diagramme de Gantt
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Evénements gérés par défaut
<a name="evenements_geres_par_defaut_ELTTEXTE000190"></a>
WINDEV gère par défaut les événements suivants pour une colonne de type "Diagramme de Gantt" (ordre d'apparition sous l'éditeur de code) :

| Evénement | Condition d'exécution |
| --- | --- |
| Initialisation | Exécuté à l'ouverture de la fenêtre. \* |
| Avant création de la tâche | Exécuté lors de la sélection de l'option "Nouvelle tâche" dans le menu contextuel de la colonne de type "Diagramme de Gantt". |
| Entrée en saisie d'une tâche | Exécuté lors de la sélection de l'option "Nouvelle tâche" dans le menu contextuel de la colonne de type "Diagramme de Gantt". Cet événement est exécuté immédiatement après l'événement "Avant création de la tâche". |
| Sortie de saisie de la tâche | Exécuté lors de la sortie de la saisie d'une tâche (sortie lors de l'ajout d'une tâche ou lors de la modification d'une tâche par le menu contextuel par exemple). |
| Sélection d'une tâche | Exécuté lors de la sélection d'une tâche existant dans la colonne de type "Diagramme de Gantt". Cet événement est exécuté lors de l'ouverture du menu contextuel. |
| Déplacement d'une tâche | Exécuté lors du déplacement d'une tâche dans la colonne de type "Diagramme de Gantt" (déplacement effectué à la souris par exemple). |
| Redimensionnement d'une tâche | Exécuté lors du redimensionnement d'une tâche dans la colonne de type "Diagramme de Gantt" (redimensionnement effectué à la souris par exemple). |
| Suppression d'une tâche | Exécuté lors de la sélection de l'option "Supprimer la tâche" dans le menu contextuel de la colonne de type "Diagramme de Gantt". |
| Après liaison d'une tâche préalable à une tâche | Exécuté après la réalisation de la liaison via le menu contextuel (sélection de l'option "Lier une tâche préalable" et clic sur la tâche préalable). |
| Modification de l'avancement d'une tâche | Exécuté lorsque l'utilisateur change le curseur de la jauge d'avancement dans la tâche. |


(\*) Par défaut, l'événement "Initialisation" de chaque champ est exécuté selon l'ordre de création des différents champs dans la fenêtre. Pour modifier cet ordre d'exécution : 

1. Sous le volet "Fenêtre", dans le groupe "Ordre", cliquez sur "Initialisation".

2. Dans la fenêtre qui s'affiche, utilisez les flèches situées sur la droite pour modifier l'ordre d'initialisation des champs.





### Des événements avec procédures pour une utilisation rapide
<a name="des_evenements_avec_procedures_pour_une_utilisation_rapide_ELTPARAGRAPHE000077"></a>La majorité des événements associés à la colonne de type "Diagramme de Gantt" sont des événements exécutés : 

- lors de l'utilisation du menu contextuel de la colonne de type "Diagramme de Gantt". 

- lors de l'utilisation de la souris. 




Pour simplifier la manipulation des tâches, des procédures sont proposées dans chaque événement. Ces procédures prennent en paramètre directement : 

- la tâche à manipuler (variable de type [TâcheGantt](../WDLang1/1000020881.md)). 

- le lien à manipuler (variable de type [LienGantt](../WDLang1/1000021076.md)). 


Toutes les informations de l'élément manipulé par le menu contextuel ou par la souris sont automatiquement affectées à cette variable. 

**Exemple** : Pour mémoriser une tâche que l'utilisateur ajoute via le menu contextuel dans un fichier de données "Tache", il suffit de saisir dans l'événement "Entrée en saisie d'une tâche" : 

```txt
PROCEDURE EntréeEnSaisie(tgEditée est une TâcheGantt)

// Mémorisation des données
Tache.Titre = tgEditée.Titre
Tache.DateDébut = tgEditée.DateDébut
Tache.DateFin = tgEditée.DateFin
...
HAjoute(Tache)
```



### Utilisation avancée des événements avec procédure
<a name="utilisation_avancee_des_evenements_avec_procedure_ELTPARAGRAPHE000101"></a>Il est également possible de proposer à l'utilisateur de définir plus précisément les caractéristiques de sa tâche lors d'un ajout ou d'une modification. 

Il suffit pour cela de créer une fenêtre avec les informations à remplir. 

Dans le code, il suffit d'ouvrir la fenêtre par exemple dans l'événement "Entrée en saisie d'une tâche". Pour bloquer la saisie directe par le menu contextuel de la colonne, l'événement doit alors renvoyer <u><u><u><u>Faux</u></u></u></u>. 

Ce principe peut être appliqué à tous les événements appelés par le menu contextuel de la colonne. 

Exemple : 

```wl
PROCEDURE EntréeEnSaisie(tgEditée est une TâcheGantt)

// Ouvre la fenêtre de saisie d'une tâche
// avec la tâche sélectionné (en mode Création ou Modification)
Ouvre(FEN_SaisieTâche, tgEditée)

// Renvoie FAUX pour bloquer la saisie directe dans la colonne
RENVOYER Faux
```


<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Evénements optionnels
<a name="evenements_optionnels_ELTTEXTE000226"></a>
Plusieurs événements optionnels peuvent être gérés.
Pour ajouter un événement optionnel :

1. Sélectionnez le champ voulu.

2. Affichez la fenêtre de code de ce champ (touche F2).

3. Cliquez sur le lien "Ajouter d'autres événements à xxx" situé à la fin de la fenêtre de code, après le dernier événement.  <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Traitements_optionnels_WD_OK%20-%20HC%20N%B0001.gif)


4. La totalité des événements optionnels disponibles pour le champ est affichée. 

5. Cochez l'événement optionnel à ajouter et validez. 
	Remarque : Il est possible de sélectionner plusieurs événements optionnels. 

6. L'événement optionnel sélectionné est automatiquement ajouté dans les événements gérés par le champ.




Pour désactiver un événement optionnel, il suffit d'effectuer les mêmes manipulations pour afficher la liste des événements optionnels. Il suffit ensuite de décocher les événements optionnels à supprimer. 
Remarque : Si le code désactivé contient du code WLangage, ce code est automatiquement supprimé.Il est ainsi possible de gérer :

- le tri des colonnes (**événement "A chaque tri"**). Cet événement est exécuté lorsque l'utilisateur trie la colonne à l'aide des icônes ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IconeCroissant.gif) et ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IconeDecroissant.gif).

- l'utilisation de la loupe pour effectuer une recherche (**événement "A chaque recherche avec la loupe"**). Cet événement est exécuté lors de la recherche (pour chaque caractère saisi) à partir du champ de recherche "loupe".

- le redimensionnement de la colonne par l'utilisateur. 



<a name="NOTE2_2"></a>


### Code de tri d'une colonne
<a name="code_tri_une_colonne_ELTPARAGRAPHE000138"></a>Lorsque l'utilisateur clique sur le titre d'une colonne de table, le code de tri de la colonne est automatiquement appelé.

Pour connaître le sens du tri, il suffit de déclarer un paramètre au début du code de tri.

```wl
// -- A chaque tri de COL_Gantt
PROCEDURE Tri_col(bCroissant)
Trace(bCroissant ? "Tri croissant colonne" SINON "Tri décroissant")
```



