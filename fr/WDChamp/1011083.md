


## Etat Tableau hiérarchique
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000169"></a>
L'éditeur d'états offre la possibilité de créer des états de type "Tableau hiérarchique". 
L'état est alors constitué d'un tableau (comme les états Tableau). Par défaut, l'entête du tableau est imprimé dans le bloc Entête de page, les lignes de données dans le bloc Corps et la ligne des totaux dans le bloc Fin de document.

Ce tableau contient une colonne hiérarchique : cette colonne affichera la hiérarchie de l'état. 

Exemple : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Etat_Tableau_H.gif&type=thumb)


**Sources de l'état Tableau hiérarchique**
Les sources de l'état Tableau hiérarchique peuvent être : 

- un ou plusieurs fichiers de données,

- un champ Table hiérarchique,

- aucune. Dans ce cas-là, l'état est programmé grâce aux fonctions WLangage. 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Créer un état de type Tableau hiérarchique
<a name="creer_etat_type_tableau_hierarchique_ELTTEXTE000193"></a>


### Création
<a name="creation_ELTPARAGRAPHE000040"></a>Pour créer un état de type Table hiérarchique depuis l'éditeur d'états : 

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif)
 parmi les boutons d'accès rapide. 

	- La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Etat" puis sur "Etat".

	- L'assistant de création d'un état s'affiche.




2. Choisissez un état de type "Tableau hiérarchique". L'assistant propose les sources de données disponibles : 

	- un ou plusieurs fichiers de données 

	- un champ Table hiérarchique. 

	- de la programmation. 

	- pas de source de données. 




3. Si vous choisissez "D'un ou plusieurs fichiers de données", l'assistant permet de définir : 

	- les fichiers qui serviront de source à l'état : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Etat_TabH_Assistant.gif&type=thumb)


	- les rubriques à imprimer, leurs libellés et leurs blocs : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Etat_TabH_Assistant_rub.gif&type=thumb)

4. Si vous choisissez "D'un champ Table hiérarchique", l'assistant demande les éléments suivants :  

	- le nom du champ Table hiérarchique sur lequel sera basé l'état. Seuls les champs Table hiérarchique présents dans les fenêtres ou les pages du projet en cours sont proposés.

	- les lignes à imprimer : lignes sélectionnées ou toutes les lignes du champ. 

	- les rubriques (colonnes du champ Table hiérarchique) à imprimer, leurs libellés et leurs blocs. 

	- les calculs à réaliser (sur les rubriques numériques).




5. Spécifiez le format de la feuille sur laquelle l'état va être imprimé. Par défaut, l'état est imprimé sur une feuille au format A4.

6. Sélectionnez le gabarit à utiliser. 

7. Saisissez le nom et le titre de l'état (nom du fichier ".WDE" correspondant à l'état). Ce nom permettra d'identifier l'état dans vos programmes.
	![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Il est également possible d'indiquer si l'état peut être modifié par l'utilisateur final sous le logiciel "Etats et Requêtes". 

8. Validez la création de l'état. 

9. Si le tableau généré est trop grand, vous avez la possibilité de : 

	- Imprimer le tableau sur plusieurs pages (en largeur). Pour plus de détails, consultez [Impression multipage](../WDChamp/1011065.md). 

	- Utiliser le mode paysage,

	- Réduire le tableau. 




10. L'état en cours de création s'affiche sous l'éditeur d'états. 




Remarque : Si l'état est crée par programmation ou sans source de données, un état contenant uniquement une tableau avec une colonne hiérarchique est créé. 
<a name="NOTE2_2"></a>


### Remarques
<a name="remarques_ELTPARAGRAPHE000093"></a>

- L'onglet "Données" de la fenêtre de description de l'état permet de connaître et de modifier la source des données. Si l'état est basé sur : 

	- des fichiers de données, les différents niveaux de la hiérarchie sont visibles et modifiables. 

	- un champ Table hiérarchique, il est possible de définir les options d'impression de la hiérarchie. 




- Si l'état est basé sur un champ Table hiérarchique : 

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) La propriété [SélectionSeule](../Proprietes/2511017.md) permet de connaître et de modifier les enregistrements à imprimer dans l'état : impression de tous les enregistrements ou uniquement des enregistrements sélectionnés.

	- La propriété [ConserverHiérarchieVisible](../Proprietes/1000021055.md) permet de connaître et de modifier le mode d'impression de la hiérarchie : impression de la hiérarchie complète ou impression de la hiérarchie visible dans le champ.

	- La propriété [ProfondeurHiérarchique](../Proprietes/1000021027.md) permet de connaître la profondeur du champ définissant la hiérarchie. Il est ainsi possible par exemple de modifier les caractéristiques des éléments d'un niveau donné. 

	- Les propriétés [ImageDéroulée](../Proprietes/2513015.md) et [ImageEnroulée](../Proprietes/2513016.md) permettent de connaître et de modifier l'image déroulée ou enroulée associée au champ définissant la hiérarchie. Par défaut, aucune image n'est associée à la hiérarchie. 




- La hiérarchie d'un champ se définit dans l'onglet "Liaison" de la fenêtre de description du champ. 





