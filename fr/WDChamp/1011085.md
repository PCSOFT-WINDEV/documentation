


## Visualisateur de rapports (Aperçu avant impression)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000196"></a>
Le visualisateur de rapports permet de visualiser la présentation d'un état sans l'imprimer (pré-visualisation de l'état). La mise en page et le contenu de l'état peuvent ainsi être vérifiés. Il est bien entendu possible de lancer l'impression de l'état.

Le visualisateur de rapports est disponible : 

- sous l'éditeur d'états de WINDEV, WEBDEV, WINDEV Mobile. 

- dans le logiciel "Etats et Requêtes".

- lors de l'impression d'états depuis une application WINDEV. 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Fonctionnalités du visualisateur de rapports
<a name="fonctionnalites_visualisateur_rapports_ELTTEXTE000220"></a>
**Le visualisateur de rapports offre diverses possibilités** : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Apercu_impression%20-%20HC%20N%B0001.gif&type=thumb)


- Un menu sous forme de ruban constitué des volets suivants : 

	- [Aperçu](../WDChamp/1011089.md) : permet de gérer l'aperçu en cours : Zoom, mire, déplacement, déplacement entre les pages. 

	- [Imprimer](../WDChamp/1011090.md) : permet de gérer l'impression directe sur l'imprimante. 

	- [Exporter](../WDChamp/1011088.md) : permet de gérer les différents modes d'export de l'impression (PDF, Word, Excel, ...). 

	- [Rechercher](../WDChamp/1011087.md) : permet de gérer la recherche dans l'aperçu. 

	- [Annoter](../WDChamp/1011086.md) : permet d'annoter l'édition actuellement affichée dans l'aperçu.


 Ce menu est également disponible lors d'une impression réalisée en WLangage dans le visualisateur de rapports.

- Un menu contextuel reprenant la majorité des options.




**Remarque** : Pour visualiser un état dans le visualisateur de rapports, une imprimante doit être installée sur le poste en cours.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Autres fonctionnalités
<a name="autres_fonctionnalites_ELTTEXTE000244"></a>


- **Personnalisation** : Votre application utilise un gabarit ? Pourquoi ne pas utiliser ce gabarit également pour le visualisateur de rapports. 

- **Visualisateur de rapports et impression réalisée avec les fonctions WLangage** : Si vous réalisez une impression avec les fonctions WLangage, il est également possible de profiter des fonctionnalités du visualisateur de rapports. 

- **Paramétrage des différentes options** : Pour afficher uniquement certains volets ou certaines options :

	- soit utilisez la fonction [iParamètreVisualisateur](../WDLang5/1000024634.md). Cette fonction, utilisée dans l'événement "Initialisation" du projet, permet par exemple de choisir quels seront les volets et options affichés pour tous les états de l'application.

	- soit paramétrez directement les différentes options affichées pour chaque état dans la fenêtre de description de l'état (onglet "UI").




- **Impression depuis le visualisateur de rapports** : Pour savoir si l'utilisateur a effectué une impression depuis le visualisateur de rapports, utilisez la fonction [iImpressionDemandée](../WDLang5/3046029.md).




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Notes
<a name="notes_ELTTEXTE000268"></a>


### Effets d'affichage lors de zoom
<a name="effets_affichage_lors_zoom_ELTPARAGRAPHE000114"></a>Lors du zoom d'un état dans le visualisateur de rapports, des effets d'affichage peuvent apparaître. Par exemple, certains traits relativement fins peuvent ne pas apparaître dans le visualisateur de rapports. Ces traits seront par contre imprimés lors de l'édition de l'état sur une imprimante.
<a name="NOTE4_2"></a>


### Impression depuis le visualisateur de rapports
<a name="impression_depuis_visualisateur_rapports_ELTPARAGRAPHE000121"></a>Pour imprimer **la totalité d'un document** depuis le visualisateur de rapports, il est nécessaire d'attendre que toutes les pages soient affichées dans le visualisateur de rapports.
<a name="NOTE4_3"></a>


### Ré-exécution de l'état
<a name="reexecution_etat_ELTPARAGRAPHE000130"></a>L'état affiché dans le visualisateur de rapports est automatiquement ré-exécuté lorsque l'état est imprimé ou exporté depuis le visualisateur de rapports. Les événements WLangage associés à l'état sont ré-exécutés. 

Dans ce cas, les données affichées dans l'état peuvent être modifiées (prise en compte de données modifiées par d'autres utilisateurs par exemple).

Il est conseillé d'initialiser les variables utilisées par l'état dans le code d'initialisation de l'état (et non dans le champ Bouton qui lance le visualisateur de rapports).

**Remarque** : Les fonctions WLangage utilisées dans votre état peuvent renvoyer un résultat différent lors de la ré-exécution de l'état. Par exemple, si des fonctions WLangage de votre état manipulent la fenêtre en cours, lors de la ré-exécution de l'état, la fenêtre en cours correspondra à la fenêtre du visualisateur de rapports.
<a name="NOTE4_4"></a>


### Utilisation de Outlook Express et de l'envoi d'emails depuis le visualisateur de rapports
<a name="utilisation_outlook_express_envoi_emails_depuis_visualisateur_rapports_ELTPARAGRAPHE000143"></a>Si vous utilisez Outlook Express et l'envoi d'emails depuis le visualisateur de rapports, le problème suivant peut survenir : la fenêtre d'envoi d'email de Outlook Express ne permet plus la saisie des informations de l'email. Tous les champs sont grisés.

Il s'agit d'un dysfonctionnement de Outlook. 

Assurez-vous de disposer de la dernière mise à jour de Outlook.


