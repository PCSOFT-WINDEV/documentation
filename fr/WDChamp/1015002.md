


## Evénements associés aux champs Table hiérarchique
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Evénements gérés par défaut
<a name="evenements_geres_par_defaut_ELTTEXTE000346"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **WINDEV** et **WINDEV Mobile** gèrent par défaut les événements suivants (ordre d'apparition sous l'éditeur de code) :

| Evénement | Condition d'exécution |
| --- | --- |
| Initialisation | Exécuté à l'ouverture de la fenêtre. \*<br><br>**Cas particulier : Champ Table hiérarchique fichier rempli automatiquement**<br>Lors de l'exécution de ce code, le champ Table hiérarchique n'est pas encore rempli. Il est possible de forcer le remplissage du champ dans ce code avec :<br><br>- soit la fonction [TableAffiche](../WDLang1/3074003.md)<br><br>- soit les propriétés de gestion des champs Table fichier : [FichierParcouru](../Proprietes/2510040.md), [RubriqueParcourue](../Proprietes/2510111.md) ou [Filtre](../Proprietes/2510042.md).<br><br><br>Il est également possible de filtrer les enregistrements avec la fonction [HFiltre](../WDLang4/3044100.md). |
| Fin d'initialisation | **Code présent uniquement pour les champs Table hiérarchique fichier remplis automatiquement**<br>Exécuté après le remplissage du champ. Ce code permet par exemple de sélectionner un élément dans le champ Table hiérarchique, d'ajouter ou de modifier un élément. |
| Entrée dans le champ Table hiérarchique | Exécuté lorsque le champ prend le focus. |
| Sortie du champ Table hiérarchique | Exécuté lors du changement de champ (touche TAB, changement de champ par la souris, ...). |
| Entrée en saisie d'une ligne du champ Table hiérarchique | Exécuté lorsque l'utilisateur sélectionne une ligne pour effectuer une saisie dans cette ligne. |
| Sortie d'une ligne du champ Table hiérarchique | Exécuté lors du changement de ligne ou lors du changement de champ (touche TAB, changement de champ par la souris, ...) à partir d'une ligne. |
| Affichage d'une ligne du champ Table hiérarchique | Exécuté lorsqu'une nouvelle ligne doit être affichée dans le champ Table hiérarchique, par exemple lors d'une des actions suivantes : ré-affichage du champ, scrolling ou déplacement dans le champ, ... |
| Sélection d'une ligne du champ Table hiérarchique | Exécuté lorsque l'utilisateur sélectionne une ligne (sans saisie). <br><br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Les champs Table hiérarchique proposent l'option suivante : "Dérouler par un clic sur la ligne". Si cette option est cochée, il sera possible de dérouler la hiérarchie en cliquant sur la ligne (et non uniquement sur l'indicateur de la hiérarchie). <br><br><br><br><br> |
| Enroulé, Déroulé d'un noeud du champ Table hiérarchique | Exécuté lorsque l'utilisateur enroule ou déroule un noeud. <br>Remarque : La syntaxe NomTableHiérarchique[NomTableHiérarchique] utilisée dans cet événement permet de connaître le numéro de la ligne qui est enroulée/déroulée. |


(\*) Par défaut, l'événement "Initialisation" de chaque champ est exécuté selon l'ordre de création des différents champs dans la fenêtre. Pour modifier cet ordre d'exécution : 

1. Sous le volet "Fenêtre", dans le groupe "Ordre", cliquez sur "Initialisation".

2. Dans la fenêtre qui s'affiche, utilisez les flèches situées sur la droite pour modifier l'ordre d'initialisation des champs.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Evénements optionnels
<a name="evenements_optionnels_ELTTEXTE000412"></a>
Plusieurs événements optionnels peuvent être gérés.
Pour ajouter un événement optionnel :

1. Sélectionnez le champ voulu.

2. Affichez la fenêtre de code de ce champ (touche F2).

3. Cliquez sur le lien "Ajouter d'autres événements à xxx" situé à la fin de la fenêtre de code, après le dernier événement.  <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Traitements_optionnels_WD_OK%20-%20HC%20N%B0001.gif)


4. La totalité des événements optionnels disponibles pour le champ est affichée. 

5. Cochez l'événement optionnel à ajouter et validez. 
	Remarque : Il est possible de sélectionner plusieurs événements optionnels. 

6. L'événement optionnel sélectionné est automatiquement ajouté dans les événements gérés par le champ.




Pour désactiver un événement optionnel, il suffit d'effectuer les mêmes manipulations pour afficher la liste des événements optionnels. Il suffit ensuite de décocher les événements optionnels à supprimer. 
Remarque : Si le code désactivé contient du code WLangage, ce code est automatiquement supprimé.Il est ainsi possible de gérer par exemple :

- le survol du champ par la souris,

- le bouton gauche enfoncé, relâché, avec un double-clic,

- le bouton droit enfoncé, relâché, avec double-clic,

- la roulette de la souris, ...




**Remarque** : Selon l'environnement (WINDEV, WEBDEV, WINDEV Mobile) et la plateforme de développement, les événements optionnels disponibles ne sont pas les mêmes.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

## Filtrage des enregistrements (champ Table hiérarchique fichier uniquement)
<a name="filtrage_des_enregistrements_champ_table_hierarchique_fichier_uniquement_ELTTEXTE000452"></a>
L'événement "Filtrage des enregistrements" est exécuté juste après l'affichage d'une ligne du champ Table hiérarchique. Il est donc exécuté :

- lors de l'initialisation du champ.

- à chaque nouvel affichage d'une ligne du champ Table hiérarchique.




Cet événement permet de filtrer les enregistrements affichés dans le champ Table hiérarchique. 

Pour mettre en place un filtre, l'événement "Filtrage des enregistrements" doit renvoyer une valeur :

- <u><u><u><u>Vrai</u></u></u></u> pour signifier que l'enregistrement respecte le filtre et qu'il doit être affiché.

- <u><u><u><u>Faux</u></u></u></u> pour signifier que l'enregistrement ne respecte pas le filtre et qu'il ne doit pas être affiché.

- <u><u><u><u>Annuler</u></u></u></u> pour arrêter la lecture de la source de données du champ Table hiérarchique (cas très rare).




Exemple :

```wl
// -- Filtrage des enregistrements --
// Affiche uniquement les clients dont commandes sont supérieures à 3000 euros
SI Commande.TotalTTC >= 3000 ALORS 
	RENVOYER Vrai
SINON
	RENVOYER Faux
FIN
```
Dans ce code, les données manipulées concernent l'enregistrement en cours de lecture par le champ Table hiérarchique. Ces données proviennent du fichier de données ou de la requête liés au champ.

Si un filtre automatique est réalisé sur le champ Table hiérarchique (fonction [TableActiveFiltre](../WDLang1/1000017149.md) ou filtre activé directement par l'utilisateur), le filtre défini par l'événement "Filtrage des enregistrements" se cumule au filtre automatique. 

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

## Avant l'affichage de la bulle d'aide automatique de l'ascenseur
<a name="avant_affichage_bulle_aide_automatique_ascenseur_ELTTEXTE000478"></a>
La bulle d'aide de l'ascenseur des champs Table hiérarchique est affichée lorsque l'utilisateur clique sur la "cage" de l'ascenseur vertical de la table hiérarchique. 

Cette bulle d'aide contient par défaut les informations suivantes : 

- Plage des lignes actuellement affichées dans le champ Table hiérarchique. 

- Nombre de lignes total du champ Table hiérarchique.

- Informations sur l'élément actuellement affiché en première ligne du champ dans la colonne triée. 




L'événement optionnel "Avant l'affichage de la bulle d'aide automatique de l'ascenseur" est exécuté juste avant l'affichage de cette bulle d'aide. Il est ainsi possible par exemple d'afficher un texte spécifique dans la bulle d'aide du champ Table hiérarchique à l'aide de la propriété [Bulle](../Proprietes/2510005.md). 


