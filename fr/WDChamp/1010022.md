
## Gestion non modale d'une fenêtre
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000404"></a>
La fenêtre ouvrant une autre fenêtre est appelée ***fenêtre mère*** ; les fenêtres ouvertes par la fenêtre mère sont appelées ***fenêtres filles***. Toutes les fenêtres filles ouvertes par la même fenêtre mère sont des ***fenêtres soeurs***.

Ce mode d'ouverture permet de gérer le multi fenêtrage.

**Avec l'ouverture non modale d'une fenêtre fille :**

- la fenêtre fille peut être en saisie en même temps que la fenêtre mère qui l'a ouverte.

- après la fermeture d'une fenêtre fille, une autre fenêtre fille devient la fenêtre en cours, si il n'y a plus de fenêtre fille, c'est la fenêtre mère qui devient la fenêtre en cours

- si la fenêtre mère est fermée, ses fenêtres filles sont fermées. Si une fenêtre fille refuse d'être fermée, les fenêtres filles suivant cette fenêtre ne seront pas fermées ainsi que la fenêtre mère.

- si la fenêtre fille est iconisée, les autres fenêtres ne sont pas iconisées. L'icône de la fenêtre est celle de la fenêtre ou du projet, si la fenêtre n'a pas d'icône.

- si la fenêtre mère est iconisée, toutes ses filles deviennent invisibles temporairement.




**Avec l'ouverture non modale d'une fenêtre soeur :**

- toutes les fenêtres soeurs peuvent être en saisie en même temps.

- après la fermeture d'une fenêtre soeur, une autre fenêtre soeur devient la fenêtre en cours.

- si la fenêtre soeur est iconisée, les autres fenêtres ne sont pas iconisées. L'icône de la fenêtre est celle de la fenêtre ou du projet, si la fenêtre n'a pas d'icône.






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Ouverture d'une fenêtre
<a name="ouverture_une_fenetre_ELTTEXTE000428"></a>


### Ouverture d'une fenêtre mère
<a name="ouverture_une_fenetre_mere_ELTPARAGRAPHE000035"></a>Une fenêtre mère est ouverte grâce à la fonction [Ouvre](../WDLang1/3038035.md).


<a name="NOTE2_2"></a>


### Ouverture d'une fenêtre fille
<a name="ouverture_une_fenetre_fille_ELTPARAGRAPHE000046"></a>Une fenêtre fille est ouverte à partir d'une fenêtre de type mère MDI. Ces fenêtres filles peuvent être de type :

- "Fille MDI"

- "Libre"




Selon le type de la fenêtre, le mode d'ouverture de la fenêtre varie.

**1. Fenêtre de type "fille MDI"**

La fonction [MDIOuvre](../WDLang1/3052005.md) permet une ouverture non modale d'une fenêtre de type "Fille MDI" depuis une fenêtre de type "Mère MDI".

Lors de l'appel de la fonction [MDIOuvre](../WDLang1/3052005.md), les opérations suivantes sont effectuées :

1. Exécution de l'événement "Déclarations globales" de la fenêtre.

2. Exécution des événements d'initialisation des champs (l'ordre est indéterminé).

3. Affichage de la fenêtre (cette fenêtre est toujours fille de la fenêtre mère MDI). 
	Remarque : Les fenêtres filles MDI sont toujours ouvertes dans la fenêtre mère (elles ne peuvent pas être affichées en dehors de la fenêtre mère). La fonction [MDIMenuFenêtre](../WDLang1/3052004.md) permet d'arranger dans la fenêtre mère MDI l'affichage des fenêtres filles MDI ouvertes (affichage en cascade ou affichage en mosaïque).




La fonction [DonneFocusEtRetourUtilisateur](../WDLang1/1410088107.md) permet de forcer la saisie dans la fenêtre fille.

**2. Fenêtre "Libre" ouverte en tant que fenêtre fille**

La fonction [OuvreFille](../WDLang1/3038021.md) permet une ouverture non modale des fenêtres de type "Libre" à partir d'une fenêtre de type "Mère MDI".

Lors de l'appel de la fonction [OuvreFille](../WDLang1/3038021.md), les opérations suivantes sont effectuées :

1. Exécution de l'événement "Déclarations globales" de la fenêtre fille,

2. Exécution des événements d'initialisation des champs (l'ordre est indéterminé),

3. Exécution des événements suivant l'appel de la fonction [OuvreFille](../WDLang1/3038021.md) de la fenêtre mère,

4. Affichage de la fenêtre fille (la fenêtre mère reste la fenêtre en cours).
	Remarque : Les fenêtres filles non MDI peuvent être affichées en dehors de la fenêtre mère, elles peuvent être affichées à toutes coordonnées dans l'écran.




La fonction [DonneFocusEtRetourUtilisateur](../WDLang1/1410088107.md) permet de forcer la saisie dans la fenêtre fille.


<a name="NOTE2_3"></a>


### Ouverture d'une fenêtre soeur
<a name="ouverture_une_fenetre_soeur_ELTPARAGRAPHE000112"></a>Une fenêtre soeur est ouverte à partir d'une fenêtre fille. Ces fenêtres filles peuvent être de type :

- "Fille MDI"

- "Libre"




Selon le type de la fenêtre, le mode d'ouverture de la fenêtre varie.

**1. Fenêtre de type "fille MDI"**

La fonction [MDIOuvre](../WDLang1/3052005.md) permet une ouverture non modale d'une fenêtre de type "Fille MDI" depuis une fenêtre de type "Mère MDI" ou une fenêtre de type "Fille MDI". Les différentes fenêtres filles sont des fenêtres soeurs.

**2. Fenêtre "Libre" ouverte en tant que fenêtre soeur**

La fonction [OuvreSoeur](../WDLang1/3038045.md) permet une ouverture non modale des fenêtres de type "Libre" à partir d'une fenêtre fille.

Lors de l'appel de la fonction [OuvreSoeur](../WDLang1/3038045.md), les opérations suivantes sont effectuées :

1. Exécution de l'événement "Déclarations globales" de la fenêtre soeur,

2. Exécution des événements d'initialisation des champs (l'ordre est indéterminé),

3. Exécution des événements suivant l'appel de la fonction [OuvreSoeur](../WDLang1/3038045.md) de la fenêtre appelante,

4. Affichage de la fenêtre soeur.
	**Remarque** : Les fenêtres soeurs MDI sont toujours ouvertes dans la fenêtre mère (elles ne peuvent pas être affichées en dehors de la fenêtre mère). La fonction [MDIMenuFenêtre](../WDLang1/3052004.md) permet d'arranger dans la fenêtre mère MDI l'affichage des fenêtres filles MDI ouvertes (affichage en cascade ou affichage en mosaïque).




La fonction [DonneFocusEtRetourUtilisateur](../WDLang1/1410088107.md) permet de forcer la saisie dans la fenêtre soeur.

**Important** : Une fenêtre ne peut être ouverte avec la fonction [OuvreSoeur](../WDLang1/3038045.md) que si la fenêtre demandant l'ouverture a été ouverte avec la fonction [OuvreFille](../WDLang1/3038021.md) ou la fonction [OuvreSoeur](../WDLang1/3038045.md).


<a name="NOTE2_4"></a>


### Ouverture avec alias
<a name="ouverture_avec_alias_ELTPARAGRAPHE000173"></a>Une même fenêtre (fille ou soeur) peut être ouverte plusieurs fois en parallèle. Cette fenêtre est soeur d'elle même. Chaque fenêtre ouverte est différenciée par un **alias**. L'alias est passé en paramètre aux fonctions [OuvreSoeur](../WDLang1/3038045.md), [OuvreFille](../WDLang1/3038021.md) ou [MDIOuvre](../WDLang1/3052005.md). Si lors de l'ouverture d'une fenêtre déjà ouverte, aucun alias n'est donné, WINDEV attribue automatiquement un alias à la fenêtre.

**Remarque** : L'alias peut être modifié avec la fonction [FenChangeAlias](../WDLang1/3038028.md).

L'alias est utilisé pour identifier les fenêtres avec les fonctions acceptant en paramètre un nom de fenêtre (par exemple les fonctions [TitreEnCours](../WDLang1/3038023.md), [TitreSuivant](../WDLang1/3038043.md), [DonneFocusEtRetourUtilisateur](../WDLang1/1410088107.md), ...) ou pour manipuler un champ d'une fenêtre donnée.

L'alias est retourné par les fonctions [FenEnCours](../WDLang1/3038033.md) ou [FenPrécédente](../WDLang1/3038014.md).


```wl
// Ouverture de FICHECLI avec alias CLIENT1
OuvreSoeur("CLIENT1=FICHECLI")

// Changement de fenêtre avec saisie sur champ NOMCLI
DonneFocusEtRetourUtilisateur("CLIENT1.NOMCLI")

// Manipulation de champ avec alias
NomFenêtre est une Chaîne
NomFenêtre = FenPrécédente()
SI NomFenêtre.NomCli = "" ALORS
	// Nom du client non saisi
	Erreur("Le nom du client n'a pas été saisi")
	DonneFocusEtRetourUtilisateur(NomFenêtre + ".NOMCLI")
FIN
```




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Superposition des fenêtres
<a name="superposition_des_fenetres_ELTTEXTE000470"></a>
Après son ouverture, une fenêtre fille est affichée "par dessus" la fenêtre mère et une fenêtre soeur est affichée par dessus l'avant dernière fenêtre soeur.

**Pour spécifier que la fenêtre ouverte s'affiche :**

- par dessus toutes les fenêtres (mêmes inactives), mêmes celles des autres applications Windows en cours, il faut utiliser la constante ***DessusTout*** (fonctions [OuvreFille](../WDLang1/3038021.md), [OuvreSoeur](../WDLang1/3038045.md) ou [FenEtat](../WDLang1/3038030.md)).

- au dessus de ses soeurs (mêmes inactives), il faut utiliser la constante ***Dessus*** (fonctions [OuvreFille](../WDLang1/3038021.md), [OuvreSoeur](../WDLang1/3038045.md) ou [FenEtat](../WDLang1/3038030.md)).






<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Iconisation d'une fenêtre
<a name="iconisation_une_fenetre_ELTTEXTE000494"></a>


### Fenêtre "libre" ouverte avec la fonction OuvreFille ou OuvreSoeur
<a name="fenetre_libre_ouverte_avec_fonction_ouvrefille_ouvresoeur_ELTPARAGRAPHE000249"></a>Si la fenêtre est iconisée, les autres fenêtres ne sont pas iconisées. L'icône utilisée est celle de la fenêtre (ou du projet, si la fenêtre n'a pas d'icône associée).




### Fenêtre mère MDI
<a name="fenetre_mere_mdi_ELTPARAGRAPHE000255"></a>Si la fenêtre est iconisée, toutes les fenêtres filles sont iconisées. L'icône utilisée est celle de la fenêtre (ou du projet si la fenêtre n'a pas d'icône associée).




### Fenêtre fille MDI
<a name="fenetre_fille_mdi_ELTPARAGRAPHE000261"></a>Si la fenêtre est iconisée, elle est iconisée dans la fenêtre mère, l'icône utilisée est une partie de la barre de titre.

La fonction [MDIMenuFenêtre](../WDLang1/3052004.md) permet de réduire toutes les fenêtres filles MDI ouvertes en icône, puis de les restaurer.


### Rappels
<a name="rappels_ELTPARAGRAPHE000271"></a>

Une fenêtre peut être iconisée :

- soit avec la fonction [Iconise](../WDLang1/3038015.md).

- soit avec la fonction [FenTaille](../WDLang1/3038020.md).




Une fenêtre peut être restaurée :

- soit avec la fonction [Restaure](../WDLang1/3038042.md).

- soit avec la fonction [FenTaille](../WDLang1/3038020.md).






<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Fenêtre en cours
<a name="fenetre_cours_ELTTEXTE000536"></a>
Après l'ouverture d'une fenêtre, la fenêtre en cours n'est pas modifiée.

- La fonction [FenEnCours](../WDLang1/3038033.md) renvoie le nom de la fenêtre (ou de l'alias) en cours de saisie.

- La fonction [FenPrécédente](../WDLang1/3038014.md) renvoie le nom de la fenêtre (ou de l'alias) qui était précédemment en cours de saisie.




**Pour changer la fenêtre en cours de saisie** :

- soit l'utilisateur clique sur une fenêtre.

- soit par programmation, la fonction [DonneFocusEtRetourUtilisateur](../WDLang1/1410088107.md) force la saisie sur la fenêtre dont le nom est passé en paramètre (il faut que la fenêtre comporte au moins un champ en saisie).




La fonction [MDIActive](../WDLang1/3052002.md) retourne le nom de la fenêtre fille MDI qui est en avant plan.



<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Fermeture d'une fenêtre fille ou soeur
<a name="fermeture_une_fenetre_fille_soeur_ELTTEXTE000560"></a>
Les fenêtres filles et soeurs sont fermées avec la fonction [Ferme](../WDLang1/3038018.md).

**Après la fermeture d'une fenêtre fille**, une de ses soeurs devient active. Si aucune fenêtre soeur n'existe, la fenêtre mère devient active.

**Après la fermeture d'une fenêtre soeur**, une autre fenêtre soeur devient la fenêtre en cours.

**Si la fenêtre mère est fermée**, ses fenêtres filles sont fermées. Si une fenêtre fille refuse d'être fermée, la fermeture est interrompue : les fenêtres soeurs suivant la fille ne sont pas fermées ainsi que la fenêtre mère ; les fenêtres filles qui ont été fermées restent fermées.

**Pour empêcher la fermeture d'une fenêtre fille (non MDI)**, dans le code de fermeture de la fenêtre fille, ajoutez la ligne suivante :


```wl
// NomChamp est un champ de la fenêtre fille
DonneFocusEtRetourUtilisateur(NomChamp)
```


**Pour empêcher la fermeture d'une fenêtre fille MDI**, il faut : 

- créer un champ Bouton associé à la combinaison de touches Alt + F4.

- saisir le code suivant dans le code de clic du champ Bouton :
	
	```wl
	DonneFocusEtRetourUtilisateur()
	```





La fonction [MDIMenuFenêtre](../WDLang1/3052004.md) permet de fermer toutes les fenêtres filles MDI ouvertes.




