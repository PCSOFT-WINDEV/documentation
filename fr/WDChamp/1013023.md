


## Le champ Combo
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation du champ Combo
<a name="presentation_champ_combo_ELTTEXTE000443"></a>


### Champ d'une fenêtre, champ d'une page dynamique ou statique
<a name="champ_une_fenetre_champ_une_page_dynamique_statique_ELTPARAGRAPHE000011"></a>Le champ "Combo" permet d'afficher une liste d'éléments et de sélectionner un élément dans cette liste.

A la différence d'un champ Liste, un champ Combo n'est pas déroulé : le champ déroule la liste à la demande ou lors du positionnement du curseur sur la liste.

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Sous WINDEV, il est possible de :

- saisir directement une valeur dans un champ de saisie, si le champ Combo est avec saisie.

- afficher des éléments sous forme de table si le champ Combo contient plusieurs colonnes.

- afficher des éléments sous forme de liste image.

- [ouvrir une fenêtre popup](../WDChamp/1010031.md).

- redimensionner la largeur et la hauteur de la liste déroulée via le champ Combo (voir ci-dessous)




**Quelques exemples** :
![Champ Combo sans saisie, non déroulé](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=combo_fermee.gif)


![Champ Combo déroulé avec éléments sous forme de liste](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Combo_Ouverte.gif)
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Les exemples suivants concernent uniquement WINDEV.
![Champ Combo déroulé avec éléments sous forme de table](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=combo_Table.gif)


![Champ Combo avec saisie et saisie assistée](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Combo_saisie.gif)


![Champ Combo graphique](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=combo_dessin.gif)


![Champ Combo déroulé avec éléments sous forme de liste image](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Combo_ListView.GIF)


![Champ Combo ouvrant une fenêtre popup](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Combo_FenPopup.GIF)
Les éléments apparaissant dans un champ Combo peuvent être déterminés lors de la création du champ sous l'éditeur. Ces éléments :

- sont déterminés par programmation.

- proviennent d'un fichier de données ou d'une requête.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Créer un champ Combo
<a name="creer_champ_combo_ELTTEXTE000467"></a>


### Pour créer un champ de type Combo :
<a name="pour_creer_champ_type_combo_ELTPARAGRAPHE000090"></a>

1. Sous le volet "Création", dans le groupe "Champs usuels", cliquez sur "Combo".

2. Cliquez dans la fenêtre / page à la position où le champ doit être créé. L'assistant de création d'un champ Combo se lance automatiquement.




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Astuce** : Des exemples de champs Combo directement utilisables (avec si nécessaire les données et le code associé) peuvent être intégrés dans vos applications en déroulant l'option "Combo". La liste des champs disponibles apparaît avec pour chacun un aperçu au gabarit du projet et une option "Go" permettant de tester directement le champ proposé. Il suffit de cliquer sur le champ voulu pour le créer dans l'éditeur.

Pour afficher les caractéristiques du champ, sélectionnez l'option "Description" dans le menu contextuel du champ.

![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Pour les applications en mode Windows Store Apps, il est conseillé d'utiliser les combos natives (option "Combo native" dans l'onglet "Détail" de la fenêtre de description du champ).
<a name="NOTE2_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Type de la zone déroulée du champ Combo
<a name="type_zone_deroulee_champ_combo_ELTPARAGRAPHE000124"></a>Le type de la zone déroulée du champ Combo dépend des éléments affichés par le champ Combo. 

Le type de la zone déroulée du champ Combo peut être changé à tout moment grâce à l'option "Type déroulé" présente dans l'onglet "Contenu" de la fenêtre de description du champ Combo (option "Description" du menu contextuel).

Les types proposés sont les suivants :

- **Liste** : affiche des éléments sous forme de liste. 
	Dans le cas d'un champ Combo fichier, la rubrique affichée est définie dans l'onglet "Contenu" de la description du champ (option "Description" du menu contextuel).

- **Table** : affiche des éléments sous forme de table. Dès que le champ Combo doit afficher plus d'un élément, une "combo avec table" est automatiquement créée. 
	Pour afficher les caractéristiques des colonnes de la liste, sélectionnez l'option "Description Colonnes" dans le menu contextuel du champ (ou cliquez sur le bouton "Editer les colonnes" présent dans l'onglet "Contenu" de la description du champ Combo). 
	Dans le cas d'un champ Combo fichier, les différentes rubriques affichées sont définies dans les caractéristiques des colonnes de la liste (option "Description Colonnes" du menu contextuel ou bouton "Editer les colonnes" dans l'onglet "Contenu" de la description du champ).
	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Ce type de zone déroulée n'est pas disponible.
	![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) En WINDEV Linux, ce type de zone déroulée n'est pas disponible.

- **Liste image** : affiche des éléments sous forme de liste image. 
	Pour afficher les caractéristiques de la liste image, cliquez sur le bouton "Éditer la Liste image..." présent dans l'onglet "Contenu" de la description du champ Combo. 
	Dans le cas d'un champ Combo fichier, la rubrique associée au libellé de l'image et celle associée à l'image sont définies grâce aux options "Rubrique affichée" et "Rubrique image" présentes dans l'onglet "Contenu" de la description du champ Combo (option "Description" du menu contextuel).
	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Ce type de zone déroulée n'est pas disponible.
	![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) En WINDEV Linux, ce type de zone déroulée n'est pas disponible.

- **Fenêtre popup** : ouvre [une fenêtre popup](../WDChamp/1010031.md). 
	La fenêtre popup à ouvrir peut être sélectionnée dans l'onglet "Contenu" de la description du champ (option "Description" du menu contextuel).
	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Ce type de zone déroulée n'est pas disponible.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Caractéristiques d'un champ Combo
<a name="caracteristiques_champ_combo_ELTTEXTE000497"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Combo avec saisie : type et masques de la zone de saisie
<a name="combo_avec_saisie_type_masques_zone_saisie_ELTPARAGRAPHE000187"></a>Pour les champs Combo avec saisie, il est possible de paramétrer le champ de saisie du champ : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) définir le type des données saisies : Texte, Numérique, Monétaire, Date, Heure, Durée.

- définir un masque de saisie. Ce masque dépend bien sûr du type d'information (date, texte, ...) affiché dans le champ Combo. Pour chaque type, un grand nombre de masques de saisie est utilisable.
	Ces masques de saisie sont multilingues : il est possible de sélectionner des masques de saisies différents selon la langue d'exécution du projet.
	Ces masques de saisie peuvent être modifiés en programmation grâce à la propriété [MasqueSaisie](../Proprietes/2510033.md).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) définir un masque d'affichage. Ce masque d'affichage est disponible pour les champs Combo avec saisie de type Numérique, Monétaire, Date, Heure ou Durée. 
	Ces masques d'affichage sont multilingues : il est possible de sélectionner des masques d'affichage différents selon la langue d'exécution du projet.
	Ces masques d'affichage peuvent être modifiés en programmation grâce à la propriété [MasqueAffichage](../Proprietes/1000020008.md).



![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Combo_des_saisie%201.gif)
**Pour utiliser des masques multilingues** :

1. Cliquez sur l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Combo_des_saisie_btn_multilangue.gif)
 pour sélectionner des masques multilingues.

2. Pour chaque langue définie dans votre fenêtre, choisissez le masque approprié.

3. Validez. Seul le masque de saisie de la langue en cours sous l'éditeur est affiché. 



<a name="NOTE3_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Ajuster la taille de la zone déroulée
<a name="ajuster_taille_zone_deroulee_ELTPARAGRAPHE000231"></a>La taille de la zone déroulée peut être : 

- gérée automatiquement par WINDEV. Dans ce cas, elle s'ajuste automatiquement au contenu (par défaut). 

- définie sous l'éditeur. Dans ce cas, cette taille est fixe. 




La taille de la zone déroulée est paramétrée grâce à l'option "Hauteur", disponible dans l'onglet "Détail" de la fenêtre de description du champ. Si cette option vaut 0, la hauteur de la zone déroulée est déterminée automatiquement.  

Si la taille de la zone déroulée n'est pas automatique, il est possible d'ajuster la taille de la zone déroulée du champ Combo sous l'éditeur : 

1. Sélectionnez le champ Combo dans la fenêtre.

2. Cliquez sur le bouton "Spin" du champ Combo. Le curseur de la souris prend l'apparence d'une flèche verticale. La zone déroulée du champ Combo s'affiche sous forme d'un rectangle.

3. Redimensionnez selon vos besoins la taille de la zone déroulée en manipulant la poignée noire.




Pour modifier la taille de la zone déroulée du champ Combo au pixel près :

1. Affichez la fenêtre de description du champ Combo (option "Description" du menu contextuel).

2. Dans l'onglet "Détail", spécifiez la taille (en pixels) de la zone déroulée (options "Hauteur" et "Largeur").




**Remarques** :

- Par défaut, la largeur de la zone déroulée correspond à la largeur de la zone de saisie du champ Combo.

- Par défaut, la hauteur de la zone déroulée est optimisée en fonction des éléments affichés dans le champ Combo (option "Hauteur" égale à 0 dans l'onglet "Détail" de la description du champ Combo).

- Pour que les utilisateurs finaux puissent également modifier la taille de la zone déroulée directement dans l'application (grâce à la poignée de redimensionnement de la zone déroulée), cochez l'option "Redimensionnable" dans l'onglet "Détail" de la description du champ Combo (option "Description" de menu contextuel).

- Pour que la taille de la zone déroulée soit mémorisée lors de la fermeture de la fenêtre par l'utilisateur final, cochez l'option "Mémoriser la taille" dans l'onglet "Détail" de la description du champ Combo (option "Description" de menu contextuel). Ainsi, lors de la ré-ouverture de la fenêtre, la zone déroulée s'affichera selon la taille mémorisée.



<a name="NOTE3_3B"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Combo sans saisie : Recherche dans les valeurs du champ Combo
<a name="combo_sans_saisie_recherche_dans_les_valeurs_champ_combo_ELTPARAGRAPHE000269"></a>Pour les Champs Combo sans saisie listant de nombreuses informations, il est possible de proposer une zone de recherche permettant à l'utilisateur de retrouver facilement l'élément à sélectionner. ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=RechercheFAA%20-%20HC%20N%B0002.gif)


Pour mettre en place cette fonctionnalité : 

- depuis l'éditeur : cochez l'option "Avec recherche" dans l'onglet "Détail" de la fenêtre de description du champ Combo sans saisie. 

- par programmation : utilisez la propriété [RechercheFAA](../Proprietes/1000023445.md). 




Remarque : Le texte d'indication "Recherche" est automatiquement affiché dans la zone de recherche du champ Combo. Ce texte n'est pas paramétrable. 
<a name="NOTE3_3"></a>
<a name="NOTE3_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Dessin dans les champs Combo
<a name="dessin_dans_les_champs_combo_ELTPARAGRAPHE000302"></a>Il est possible de dessiner dans le champs Combo ou d'afficher une image grâce aux [fonctions de dessin spécifiques aux champs Liste et Combo](../WDLang1/3029028.md).

Remarque : Si une ligne d'un champ Combo affiche une image à l'aide de la fonction [gImage](../WDLang1/3029042.md), lorsque cette ligne est sélectionnée, l'image est reprise en ligne principale. 
<a name="NOTE3_7"></a>
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Limites en Java
<a name="limites_java_ELTPARAGRAPHE000319"></a>En Java, les caractéristiques suivantes ne sont pas gérées :

- bulle sur ascenseur.

- saisie obligatoire.

- hauteur et largeur de la zone déroulée personnalisées.

- numéro d'aide associé au champ Combo.

- masque d'affichage de la zone de saisie. 

- type de la zone de saisie. 




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Vocabulaire
<a name="vocabulaire_ELTTEXTE000551"></a>
Pour manipuler simplement un champ Combo, il est nécessaire de connaître le vocabulaire suivant :

| Nom | Définition |
| --- | --- |
| Bandeau de sélection | Permet de visualiser l'élément sélectionné dans la zone déroulée. Le plus souvent, une couleur spécifique est utilisée. |
| Combo Fichier | Le champ Combo est basé sur un fichier de données ou une requête. Les éléments du champ correspondent à des enregistrements du fichier de données.<br>Deux types de champ Combo fichier sont disponibles :<br><br>- ***Champ Combo fichier "Chargé en mémoire"*** : Le contenu du champ est chargé en mémoire puis affiché dans le champ. L'accès aux différents éléments du champ Combo est plus rapide. Ce mode est réservé pour des fichiers de données de moins de 100 000 enregistrements.<br><br>- ***Champ Combo fichier "Accès direct (sans limite)"*** : Le champ affiche directement le contenu du fichier de données ou de la requête. L'enregistrement en cours correspond à l'élément sélectionné. Chaque déplacement dans le champ entraîne un accès au fichier de données lié. Ce type de champ est réservé aux fichiers de données de plus de 100 000 enregistrements.<br><br><br> |
| Combo par programmation | Le champ Combo n'est basé ni sur un fichier de données ni sur une requête. Les éléments affichés dans le champ Combo sont déterminés par le développeur (dans la fenêtre de description ou par programmation). |
| Combo avec saisie | L'utilisateur peut saisir du texte dans le champ de saisie associé au champ Combo. Si l'option "Saisie assistée" est sélectionnée, l'utilisateur peut ainsi sélectionner rapidement l'élément en saisissant les premières lettres : les lettres saisies sont automatiquement complétées avec l'élément correspondant. |
| Combo sans saisie | L'utilisateur sélectionne l'élément dans la zone déroulée à l'aide du bandeau de sélection. |



<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Permuter
<a name="permuter_ELTTEXTE000575"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) WINDEV permet de transformer automatiquement un champ Combo standard en un champ Combo avec table et inversement : 

1. Sélectionnez le champ à transformer. 

2. Sous le volet "Modification", dans le groupe "Transformations", déroulez "Refactoring et permutations" et sélectionnez "Combo / Combo avec table".





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampCombo.gif) ***Exemples unitaires (WINDEV)*** : **Le champ Combo** <br>Utilisation du champ Combo
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDGestiondeParcinformatique.gif) ***Exemples complets (WINDEV)*** : **WD Gestion de Parc informatique** <br>Cet exemple illustre la gestion d'un parc informatique sous WINDEV.<br>Dans cet exemple, nous abordons les principaux thèmes suivants :<br>1/ les états imprimés, sur requête intégrée notamment,<br>2/ la représentation graphique de la situation géographique de la machine,<br>3/ les combos auto-alimentées de type fenêtre popup.<br>Résumé de l'exemple livré avec WINDEV :	<br>Cet exemple permet de gérer un parc informatique.<br>Pour chaque machine, on pourra définir ses caractéristiques propres, ses composants, la personne qui l'utilise ainsi que le bureau où la machine est située.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LeEyeMagnet.gif) ***Exemples unitaires (WINDEV)*** : **Le EyeMagnet** <br>Utilisation du mécanisme "eYe magnet" (appelé également mise en forme conditionnelle)<br>Le "eYe magnet" consiste à modifier l'aspect visuel d'un champ afin d'attirer l'attention de l'utilisateur sur ce champ. WINDEV permet de modifier cet aspect visuel automatiquement en fonction d'une série de conditions.


