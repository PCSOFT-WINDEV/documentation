


## Fonctions du WLangage utilisables dans un état
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000274"></a>
La plupart des fonctions du WLangage peuvent être utilisées dans les événements d'un état (créé avec l'éditeur d'états).

Cependant, certaines fonctions sont déconseillées telles que les fonctions d'impression spécifiques à l'impression en WLangage ou les fonctions d'accès aux enregistrements manipulés par l'état.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Fonctions du WLangage déconseillées dans un état
<a name="fonctions_wlangage_deconseillees_dans_etat_ELTTEXTE000298"></a>
Il est déconseillé d'utiliser les fonctions suivantes dans les événements de l'état, des blocs ou des champs. Si ces fonctions sont utilisées, l'exécution de l'état pourra être incorrecte.

**Fonctions d'impression** : [iEllipse](../WDLang5/3046009.md), [iFinImprime](../WDLang5/3046053.md), [iHauteurImage](../WDLang5/3046057.md), [iImprime](../WDLang5/3046031.md), [iImprimeCodeBarre](../WDLang5/3046020.md), [iImprimeImage](../WDLang5/3046017.md), [iImprimeMot](../WDLang5/3046034.md), [iImprimeZone](../WDLang5/3046027.md), [iImprimeZoneRTF](../WDLang5/3046023.md), [iLargeurImage](../WDLang5/3046061.md), [iLien](../WDLang5/3046018.md), [iLigne](../WDLang5/3046035.md), [iPosX](../WDLang5/3046015.md), [iPosY](../WDLang5/3046075.md), [iSauteLigne](../WDLang5/3046071.md), [iTrait](../WDLang5/3046050.md), [iTraitH](../WDLang5/3046051.md) et [iTraitV](../WDLang5/3046066.md).

**Fonctions d'accès à un enregistrement** : Toutes les fonctions HFSQL du WLangage entraînant la modification de l'enregistrement en mémoire ou de l'enregistrement en cours dans le fichier de base de l'état sont déconseillées dans les événements de l'état, du bloc ou des champs. En effet, ces fonctions risquent de modifier le parcours du fichier de base de l'état.

Ces fonctions sont principalement : [HAjoute](../WDLang4/3044147.md), [HCréation](../WDLang4/3044255.md), [HCréationSiInexistant](../WDLang4/3044254.md), [HDernier](../WDLang4/3044101.md), [HEcrit](../WDLang4/3044092.md), HLitxxxx, [HModifie](../WDLang4/3044042.md), [HPrécédent](../WDLang4/3044112.md), [HPositionne](../WDLang4/3044110.md), [HPremier](../WDLang4/3044113.md), [HRecherche](../WDLang4/3044130.md), [HRecule](../WDLang4/3044126.md), [HRaye](../WDLang4/3044121.md), [HSuivant](../WDLang4/3044027.md), [HSupprime](../WDLang4/3044018.md), ...|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | Sous [le logiciel Etats & Requêtes](../Presentation/3088004.md), les fonctions suivantes sont interdites :<br><br><br><br>\   \   \   \<br>\ --- \ --- \ --- \<br>\ [HAjouteUtilisateur](../WDLang4/3044281.md) \ [HArrêteServeur](../WDLang4/3044317.md) \ [HChangeRepJNL](../WDLang4/3044164.md) \<br>\ [HCopieFichier](../WDLang4/3044282.md) \ [HCréation](../WDLang4/3044255.md) \ [HCréationSiInexistant](../WDLang4/3044254.md) \<br>\ [HDBCréation](../WDLang4/3044171.md) \ [HEcrit](../WDLang4/3044092.md) \ [HImporteHF55](../WDLang4/3044055.md) \<br>\ [HImporteTexte](../WDLang4/3044011.md) \   \ [HLibère](../WDLang4/3044064.md) \<br>\ [HMigreCléComposéeReliée](../WDLang4/3044038.md) \ [HModifie](../WDLang4/3044042.md) \ [HModifieDroitBaseDeDonnées](../WDLang4/3044326.md) \<br>\ [HModifieDroitFichier](../WDLang4/3044327.md) \ [HModifieDroitServeur](../WDLang4/3044328.md) \ [HModifieGroupe](../WDLang4/3044308.md) \<br>\ [HModifiePropriétéBaseDeDonnées](../WDLang4/3044329.md) \ [HModifiePropriétéFichier](../WDLang4/3044330.md) \ [HModifiePropriétéServeur](../WDLang4/3044331.md) \<br>\ [HRaye](../WDLang4/3044121.md) \ [HRegénèreFichier](../WDLang4/3044122.md) \ [HSupprime](../WDLang4/3044018.md) \<br>\ [HSupprimeBaseDeDonnées](../WDLang4/3044332.md) \ [HSupprimeFichier](../WDLang4/3044294.md) \ [HSupprimeGroupe](../WDLang4/3044295.md) \<br>\ [HSupprimeLiaison](../WDLang4/3044314.md) \ [HSupprimeUtilisateur](../WDLang4/3044296.md) \ [HVueVersFichier](../WDLang4/3044021.md) \<br><br> |






<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Fonctions d'impression du WLangage utilisables dans un état
<a name="fonctions_impression_wlangage_utilisables_dans_etat_ELTTEXTE000340"></a>
Les fonctions d'impression suivantes peuvent être utilisées dans un état : 



|   |   |
| --- | --- |
| [iAperçu](../WDLang5/3046069.md) | Paramètre la destination de l'impression. |
| [iCadre](../WDLang5/3046044.md) | Imprime un cadre aux coordonnées spécifiées. |
| [iCadreArrondi](../WDLang5/3046024.md) | Imprime un cadre avec des bords arrondis aux coordonnées spécifiées. |
| [iConfigure](../WDLang5/3046072.md) | Configure l'imprimante pour une impression réalisée en WLangage :<br><br>- soit en ouvrant directement la fenêtre de configuration. <br><br>- soit en modifiant directement l'imprimante utilisée pour l'impression en cours. <br><br><br> |
| [iCréePolice](../WDLang5/3046045.md) | Crée une nouvelle police d'impression. |
| [iDernierFichier](../WDLang5/3046068.md) | Renvoie : <br><br>- le nom complet du dernier fichier généré lors de l'impression (PDF, RTF, Texte, ...).<br><br>- la liste des fichiers duplicata créés. <br><br><br> |
| [iEscape](../WDLang5/3046054.md) | Envoie une commande ESCAPE ou une commande de données à une imprimante. |
| [iFenêtreAbandon](../WDLang5/3046042.md) | Paramètre l'affichage de la fenêtre permettant l'abandon de l'impression en cours... |
| [iFermeEtat](../WDLang5/3046041.md) | Arrête immédiatement l'impression de l'état en cours. |
| [iFinEtat](../WDLang5/3046040.md) | Force l'arrêt de l'impression d'un état. |
| [iForceComplément](../WDLang5/3046046.md) | Force l'impression d'un bloc de complément de corps. |
| [iHautBasPageImbriqué](../WDLang5/3046047.md) | Imprime ou non les hauts et bas de page de l'état imbriqué. |
| [iHauteurPage](../WDLang5/3046052.md) | Calcule la hauteur de la page imprimable (en millimètres) en tenant compte des marges (hautes ou bases) définies. |
| [iHauteurRestantePage](../WDLang5/3046060.md) | Calcule la hauteur disponible (en millimètres) restant sur la page en cours en tenant compte des marges (hautes ou basses) définies. |
| [iHauteurTexte](../WDLang5/3046070.md) | Calcule la hauteur de la police du texte à imprimer (en millimètres). |
| [iHauteurZone](../WDLang5/3046062.md) | Calcule la hauteur nécessaire d'une zone de largeur fixe pour que l'ensemble d'un texte utilisant la police en cours puisse être imprimé dans cette zone. |
| [iImpressionAbandonnée](../WDLang5/3046006.md) | Permet de savoir si l'utilisateur a demandé l'abandon de l'impression du document en cours. |
| [iImpressionDemandée](../WDLang5/3046029.md) | Permet de savoir si l'utilisateur a demandé l'impression du document depuis le visualisateur de rapports. |
| [iImprimeBloc](../WDLang5/3046030.md) | Force l'impression d'un bloc de l'état en cours d'impression. |
| [iImprimeComplémentCorps](../WDLang5/3046019.md) | Force l'impression d'un bloc de complément de corps en spécifiant la hauteur du bloc de complément. |
| [iImprimeEtat](../WDLang5/3046032.md) | Imprime un état réalisé avec l'éditeur d'états. |
| [iInfoImprimante](../WDLang5/3046022.md) | Récupère les caractéristiques de l'imprimante en cours ou de l'imprimante par défaut. |
| [iInitRequêteEtat](../WDLang5/3046021.md) | Initialise la requête liée à l'état (cas d'une requête paramétrée). |
| [iInitRequêteEtatConnexion](../WDLang5/3046028.md) | Initialise la requête liée à l'état. |
| [iLargeurPage](../WDLang5/3046036.md) | Calcule la largeur de la page imprimable (en millimètres) en tenant compte des marges (gauches ou droites) définies. |
| [iLargeurTexte](../WDLang5/3046033.md) | Calcule la largeur (en millimètres) du texte à imprimer en fonction de la police spécifiée. |
| [iListeEtatsImbriqués](../WDLang5/3046005.md) | Renvoie : <br><br>- la liste des états imbriqués en cours d'impression (états lancés par la fonction [iImprimeEtat](../WDLang5/3046032.md) dans un des traitements de l'état en cours d'impression). <br><br>- la liste des états enchaînés en cours d'impression (fonction [iEnchaînementAjoute](../WDLang5/1000020059.md)).<br><br><br> |
| [iListeImprimante](../WDLang5/3046063.md) | Renvoie la liste des imprimantes installées sur le poste en cours. |
| [iMagentaTransparent](../WDLang5/3046003.md) | Modifie la gestion de la couleur Magenta afin que cette couleur soit considérée comme transparente ou non dans toutes les prochaines impressions. |
| [iMarge](../WDLang5/3046011.md) | Définit les marges "logiques" d'impression. |
| [iMMVersPica](../WDLang5/3046004.md) | Convertit les coordonnées d'un point (exprimées en millimètres) en coordonnées système. |
| [iNumPage](../WDLang5/3046013.md) | Renvoie ou initialise le numéro de la page en cours d'impression. |
| [iParamètre](../WDLang5/3046008.md) | Récupère le paramétrage de l'imprimante et paramètre l'impression. |
| [iParamètreAperçu](../WDLang5/3046001.md) | Paramètre l'aperçu avant impression :<br><br>- l'affichage d'un message concernant les ressources du poste en cours.<br><br>- l'affichage ou non des volets (et des boutons présents) du ruban. <br><br>- les options d'export disponible dans la mini-fenêtre d'aperçu. <br><br><br> |
| [iParamètrePDF](../WDLang5/3046007.md) | Fixe les options du fichier PDF généré. |
| [iPicaVersMM](../WDLang5/3046010.md) | Convertit les coordonnées d'un point (exprimées en coordonnées système) en millimètres. |
| [iPolice](../WDLang5/3046014.md) | Sélectionne la police par défaut. |
| [iPoliceDidot](../WDLang5/3046016.md) | Sélectionne l'unité à utiliser pour la hauteur des polices (créées avec la fonction [iCréePolice](../WDLang5/3046045.md)) : point DIDOT ou point PICA. |
| [iRAZ](../WDLang5/3046067.md) | Ré-initialise les paramètres d'impression (marges, police, format du papier, orientation, ...) mémorisés dans la librairie d'impression. |
| [iSautePage](../WDLang5/3046073.md) | Génère un saut de page : le code correspondant est envoyé dans la file d'impression de l'imprimante. |
| [iSelectPolice](../WDLang5/3046055.md) | Crée une nouvelle police d'impression depuis la fenêtre standard de sélection des polices de Windows... |
| [iStatusImpressionEtat](../WDLang5/3046043.md) | Renvoie l'état de l'impression en cours. |
| [iSubstBloc](../WDLang5/3046048.md) | Substitue un bloc de l'état par un autre bloc au cours de l'impression de l'état. |
| [iTerminePage](../WDLang5/3046038.md) | Force le passage à la page suivante au cours de l'impression d'un état. |







