
## Imprimer un état sur une des imprimantes connectées au serveur Web
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000171"></a>
Pour imprimer un état sur une des imprimantes connectées au serveur Web, il est nécessaire de :

- configurer le serveur Web. Cette configuration diffère en fonction du type des imprimantes utilisées (locales ou réseaux).

- spécifier l'imprimante à utiliser.

- imprimer l'état.




**Remarque** : Ce mode d'impression est conseillé pour les sites Intranet uniquement.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000195"></a>


### Configuration du serveur Web pour les imprimantes locales (dans le cas d'un serveur Web IIS uniquement)
<a name="configuration_serveur_web_pour_les_imprimantes_locales_dans_cas_serveur_web_iis_uniquement_ELTPARAGRAPHE000025"></a>Pour configurer le serveur Web pour les imprimantes locales (dans le cas d'un serveur Web IIS uniquement) : 

1. Dans IIS, utilisez un compte local au serveur (IUSR) pour les connexions anonymes. Ce compte IUSR correspond au compte "Invité Internet" et fait partie du groupe "Invité". 
	Pour connaître le compte IUSR du serveur Web en cours, consultez [Comment connaître le compte qui exécute le protocole AWP](../Editeurs/2037001.md).

2. Vérifiez que les imprimantes utilisées avec ce compte IUSR sont autorisées à imprimer (onglet "Sécurité" des propriétés des imprimantes).




**Remarque** : Aucune configuration spécifique n'est nécessaire pour les autres types de serveur Web.


<a name="NOTE2_2"></a>


### Configuration du serveur Web pour les imprimantes réseaux
<a name="configuration_serveur_web_pour_les_imprimantes_reseaux_ELTPARAGRAPHE000043"></a>Pour configurer le serveur Web pour les imprimantes réseaux : 

1. Selon le type de serveur Web utilisé :

	- **Dans IIS**, utilisez un compte du domaine pour les connexions anonymes. Ce compte doit faire partie du groupe "Invité du domaine". 
			Pour connaître le compte du domaine du serveur Web en cours, consultez [Comment connaître le compte du domaine qui exécute le protocole AWP](../Editeurs/2037001.md).

	- **Pour Apache**, utilisez un compte du domaine. 
			Pour connaître le compte du domaine du serveur Web en cours, consultez [Comment connaître le compte du domaine qui exécute le protocole AWP](../Editeurs/2037001.md).




2. Vérifiez que le compte du domaine est autorisé à écrire dans la base de registre Regedt32 :

	- Lancez Regedt32 (option "Démarrer .. Exécuter .. Regedt32" depuis le bureau de Windows).

	- Sélectionnez la clé "HKEY_LOCAL_MACHINE\\SOFTWARE\\PC SOFT\\WEBDEV\\28.0".

	- Sélectionnez l'option "Sécurité .. Autorisations". Vérifiez que le compte du domaine utilisé a le droit de créer des clés de registres (option "Contrôle total").




3. Vérifiez que les imprimantes utilisées sont accessibles par le serveur Web.

4. Vérifiez que les imprimantes utilisées avec le compte du domaine sont autorisées à imprimer (onglet "Sécurité" des propriétés des imprimantes).





<a name="NOTE2_3"></a>


### Sélectionner l'imprimante
<a name="selectionner_imprimante_ELTPARAGRAPHE000075"></a>Pour sélectionner l'imprimante :

- soit utilisez la fonction [iConfigure](../WDLang5/3046072.md). 
	**Remarque** : La fonction [iListeImprimante](../WDLang5/3046063.md) renvoie uniquement la liste des imprimantes locales installées sur le poste en cours.

- soit spécifiez l'imprimante à utiliser par défaut dans l'administrateur WEBDEV (bouton "Configurer les impressions", onglet "Configuration").





<a name="NOTE2_4"></a>


### Impression de l'état
<a name="impression_etat_ELTPARAGRAPHE000094"></a>Pour imprimer un état, utilisez la fonction [iImprimeEtat](../WDLang5/3046032.md).



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Exemple
<a name="exemple_ELTTEXTE000237"></a>
L'état "ETAT_NomEtat" doit être imprimé sur une imprimante locale ou réseau.

Le champ "LISTE_ListeImprimante" liste les différentes imprimantes locales et réseaux accessibles depuis le serveur Web.

Le bouton "BTN_ImpressionEtat" permet de :

- configurer l'imprimante à utiliser.

- imprimer l'état.




Dans cet exemple :

- le code d'initialisation du champ Liste "LISTE_ListeImprimante" est le suivant :
	
	```wl
	// Ajouter les imprimantes réseaux
	ListeAjoute(MoiMême, "\\Serveur1\HP 750") 
	ListeAjoute(MoiMême, "\\Serveur2\Canon LBP-1000") 
	// Ajouter les imprimantes locales 
	ListeAjoute(MoiMême, iListeImprimante())
	```


- le code de clic serveur du bouton "BTN_ImpressionEtat" est le suivant :
	
	```wl
	// Sélectionner l'imprimante utilisée
	iConfigure(LISTE_ListeImprimante[LISTE_ListeImprimante]) 
	// Imprimer l'état
	iImprimeEtat(ETAT_NomEtat) 
	// Si aucune imprimante n'est sélectionnée, 
	// l'impression sera effectuée sur l'imprimante sélectionnée 
	// dans l'administrateur WEBDEV
	```








