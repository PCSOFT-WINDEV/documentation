


## Evénements associés aux fenêtres
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Evénements gérés par défaut
<a name="evenements_geres_par_defaut_ELTTEXTE000480"></a>
WINDEV et WINDEV Mobile gèrent par défaut les événements suivants (ordre d'apparition sous l'éditeur de code) :


| Evénement | Condition d'exécution |
| --- | --- |
| Déclarations globales | Déclaration des variables globales à la fenêtre. C'est le premier code exécuté lors de l'ouverture de la fenêtre. |
| Fin d'initialisation | Exécuté lors de l'ouverture de la fenêtre.<br>L'ordre d'exécution des événements est le suivant :<br><br>- Initialisation des champs de la fenêtre (\*)<br><br>- Initialisation de la fenêtre<br><br>- Prise de focus<br><br><br>**Remarque** : Si du code de mise à jour de champs est mis dans cet événement, il peut apparaître un effet de clignotement. En effet, le code d'initialisation des champs est alors exécuté avant le code de mise à jour. |
| Fermeture | Exécuté lors de la fermeture de la fenêtre.<br>**Remarques** : <br><br>- Une reprise de saisie sur un des champs de la fenêtre dans ce code empêche la fenêtre de se fermer.<br><br>- Si un champ Bouton de type "Abandon" est présent dans la fenêtre, lors de la fermeture de la fenêtre, seul le code de clic de ce bouton est exécuté. <br><br><br> |
| Demande de mise à jour de l'affichage | Permet de regrouper le code de mise à jour des champs de la fenêtre : contenu des champs, état (visible, grisé, ...), libellé à mettre à jour, ...<br><br>Cet événement peut attendre des paramètres. Il suffit de déclarer une procédure dans l'événement. Par exemple : <br><br><pre><code>// Demande de mise à jour de l'affichage <br>PROCEDURE DemandeMiseAjour(TypeMiseAJour est un booléen)</code></pre><br><br><br>Cet événement est lancé sur demande grâce aux fonctions : <br><br>- [DemandeMiseAJourUI](../WDLang1/1000023899.md) ou [DemandeMiseAJourUIParent](../WDLang1/1000023900.md) : Exécute l'événement à la fin de l'événement en cours (lancement asynchrone). <br><br>- [ExécuteMiseAJourUI](../WDLang1/1000023901.md) ou [ExécuteMiseAJourUIParent](../WDLang1/1000023902.md) : Exécute immédiatement l'événement. <br><br><br>Lors de l'appel de ces fonctions, il est possible de préciser la valeur des paramètres attendus par l'événement. |
| ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Changement d'orientation | Exécuté lorsque l'utilisateur pivote l'écran. Il est par exemple possible de repositionner les champs lors du changement d'orientation de l'écran. |
| Fermeture d'une fenêtre fille de la fenêtre | Exécuté lors de la fermeture d'une fenêtre fille ouverte depuis la fenêtre en cours.<br><br>Il est possible de :<br><br>- connaître le nom de la fenêtre fille fermée grâce à la propriété [Nom](../Proprietes/2510082.md).<br><br>- récupérer la valeur de retour de la fenêtre fille grâce à la propriété [ValeurRenvoyée](../Proprietes/2510134.md).<br><br><br>Exemple :<br><br><pre><code>// -- Fermeture d'une fenêtre fille de FEN_ListeCommande<br>// Actualise la liste des commandes si besoin<br>SI MaFenêtreFille.ValeurRenvoyée = Vrai ALORS<br>	ListeCommande()<br>FIN</code></pre><br>Le mot-clé [MaFenêtreFille](../Motscles/1511021.md) permet de manipuler les caractéristiques de la fenêtre fille. |
|   | Permet de mettre à jour le contenu du Widget. Cet événement est exécuté :<br><br>- à l'ouverture d'une fenêtre de type Widget.<br><br>- à intervalle de temps régulier. Cet intervalle est fixé dans l'onglet "Détail" de la fenêtre de description.<br><br><br>Remarque : La fonction [WidgetAffiche](../WDLang3/1000020647.md) provoque le réaffichage du Widget et l'exécution de l'événement de rafraîchissement. |


(\*) Par défaut, l'événement "Initialisation" de chaque champ est exécuté selon l'ordre de création des différents champs dans la fenêtre. Pour modifier cet ordre d'exécution : 

1. Sous le volet "Fenêtre", dans le groupe "Ordre", cliquez sur "Initialisation". 

2. Dans la fenêtre qui s'affiche, utilisez les flèches situées sur la droite pour modifier l'ordre d'initialisation des champs.




**Attention** : Si un ou plusieurs champs utilisent la persistance des champs, le code "A chaque modification" peut être exécuté lors de l'initialisation du champ. Pour plus de détails, consultez [Persistance des champs](../WDChamp/9000019.md).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Evénements optionnels
<a name="evenements_optionnels_ELTTEXTE000504"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000144"></a>Plusieurs événements optionnels peuvent être gérés.
Pour ajouter un événement optionnel :

1. Sélectionnez le champ voulu.

2. Affichez la fenêtre de code de ce champ (touche F2).

3. Cliquez sur le lien "Ajouter d'autres événements à xxx" situé à la fin de la fenêtre de code, après le dernier événement.  ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Traitements_optionnels_WD_OK%20-%20HC%20N%B0001.gif)


4. La totalité des événements optionnels disponibles pour le champ est affichée. 

5. Cochez l'événement optionnel à ajouter et validez. 
	Remarque : Il est possible de sélectionner plusieurs événements optionnels. 

6. L'événement optionnel sélectionné est automatiquement ajouté dans les événements gérés par le champ.




Pour désactiver un événement optionnel, il suffit d'effectuer les mêmes manipulations pour afficher la liste des événements optionnels. Il suffit ensuite de décocher les événements optionnels à supprimer. 
Remarque : Si le code désactivé contient du code WLangage, ce code est automatiquement supprimé.Il est ainsi possible de gérer par exemple :

- [L'autorisation de fermeture](#NOTE2_2aa). 

- [La modification de la taille](#NOTE2_2a). 

- [La prise de focus](#NOTE2_2b). 

- [La perte de focus](#NOTE2_2c).

- [La modification des champs de la fenêtre](#NOTE2_2e).

- [La mise au premier plan de la fenêtre](#NOTE2_2).

- [La mise en arrière-plan de la fenêtre](#NOTE2_3). 

- [Le changement d'agencement](#NOTE2_4).

- [L'application du thème clair/sombre](#NOTE2_5).

- [Début de défilement](#NOTE2_6).

- [Pendant le défilement](#NOTE2_7).

- [Fin de défilement](#NOTE2_8).



<a name="NOTE2_2aa"></a>


### Evénement optionnel : Autorisation de fermeture
<a name="evenement_optionnel_autorisation_fermeture_ELTPARAGRAPHE000200"></a>Exécuté juste avant l'événement "Fermeture" de la fenêtre, cet événement permet par exemple de faire une vérification lors de la fermeture de la fenêtre. 

Cet événement peut permettre : 

- de demander une confirmation, 

- d'empêcher la fermeture de la fenêtre. Il suffit pour cela d'utiliser la ligne de code suivante : 
	
	```wl
	RENVOYER Faux
	```





**Attention** : 

- si un champ Bouton de type "Abandon" est présent dans la fenêtre, lors de la fermeture de la fenêtre, seul le code de clic de ce bouton est exécuté. 

- l'événement "Autorisation de fermeture" est exécuté uniquement lorsque la fermeture est déclenchée par la croix système de la fenêtre. Cet événement n'est pas exécuté lors d'un appel de la fonction [Ferme](../WDLang1/3038018.md).







<a name="NOTE2_2a"></a>


### Evénement optionnel : Modification de la taille
<a name="evenement_optionnel_modification_taille_ELTPARAGRAPHE000234"></a>Exécuté dans les cas suivants :

- Iconisation de la fenêtre

- Agrandissement ou changement de taille de la fenêtre

- Restauration de la fenêtre après iconisation




![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cet événement n'est pas disponible.
<a name="NOTE2_2b"></a>


### Evénement optionnel : Prise de focus
<a name="evenement_optionnel_prise_focus_ELTPARAGRAPHE000249"></a>Exécuté lorsque la fenêtre prend le focus (la barre de titre est active) et qu'une autre fenêtre de l'application perd le focus :

- l'utilisateur a cliqué sur une autre fenêtre de l'application

- la fonction [DonneFocusEtRetourUtilisateur](../WDLang1/1410088107.md) a été exécutée depuis une autre fenêtre de l'application




Cet événement ne sera pas exécuté :

- lors de l'ouverture de la première fenêtre du projet.

- lors de l'exécution de la fonction [OuvreFille](../WDLang1/3038021.md), [OuvreFenêtreMobile](../WDLang1/1000021018.md) ou [OuvreSoeur](../WDLang1/3038045.md) à partir de la fenêtre en cours.

- si la fonction [Ferme](../WDLang1/3038018.md) est appelée dans le code d'initialisation de la fenêtre.

- si l'utilisateur clique sur une fenêtre d'un autre programme, puis reclique sur la fenêtre initiale.




![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cet événement n'est pas disponible.
<a name="NOTE2_2c"></a>


### Evénement optionnel : Perte de focus
<a name="evenement_optionnel_perte_focus_ELTPARAGRAPHE000285"></a>Exécuté lorsque la fenêtre perd le focus lors du passage à une autre fenêtre. Cet événement est toujours appelé avant l'événement de prise de focus d'une autre fenêtre dans les cas suivants :

- fermeture de la fenêtre (avant l'événement de fermeture)

- l'utilisateur a cliqué sur une autre fenêtre de l'application

- la fonction [DonneFocusEtRetourUtilisateur](../WDLang1/1410088107.md) a été exécutée depuis une autre fenêtre de l'application




Cet événement ne sera pas exécuté : 

- si la fonction [DonneFocusEtRetourUtilisateur](../WDLang1/1410088107.md) vers une autre fenêtre a été exécutée dans le code d'initialisation de la fenêtre

- si la fonction [Ferme](../WDLang1/3038018.md) est appelée dans le code d'initialisation de la fenêtre

- si l'utilisateur clique sur une fenêtre d'un autre programme, puis reclique sur la fenêtre initiale


![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cet événement n'est pas disponible.
<a name="NOTE2_2e"></a>


### Evénement optionnel : A chaque modification
<a name="evenement_optionnel_chaque_modification_ELTPARAGRAPHE000315"></a>Exécuté lorsqu'un des champs de la fenêtre est modifié (saisie effectuée par l'utilisateur par exemple).
<a name="NOTE2_2"></a>
<a name="NOTE2_3"></a>
<a name="NOTE2_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Evénement optionnel : Changement d'agencement
<a name="evenement_optionnel_changement_agencement_ELTPARAGRAPHE000352"></a>Exécuté lorsque l'agencement est modifié automatiquement.   

Remarque : La fonction [FenChangeAgencement](../WDLang1/1000021056.md) ne déclenche pas cet événement. 
<a name="NOTE2_5"></a>
<a name="NOTE2_6"></a>


### Evénement optionnel : Début de défilement
<a name="evenement_optionnel_debut_defilement_ELTPARAGRAPHE000391"></a>Exécuté lors du début de défilement de l'ascenseur vertical de la fenêtre, utilisé pour faire défiler le contenu de la fenêtre (cas où le contenu de la fenêtre est plus important que la taille de la fenêtre). 
Cet événement permet par exemple de faire apparaître un champ lorsque le bas de la fenêtre est atteint ou de faire apparaître un champ lors de la remontée de l'ascenseur. 
Rappel : La fonction [AscenseurPosition](../WDLang1/1000021057.md) permet de connaître la position de l'ascenseur. 




<a name="NOTE2_7"></a>


### Evénement optionnel : Pendant le défilement
<a name="evenement_optionnel_pendant_defilement_ELTPARAGRAPHE000408"></a>Exécuté lors du défilement de l'ascenseur vertical de la fenêtre (cas où le contenu de la fenêtre est plus important que la taille de la fenêtre). 
Cet événement permet par exemple de faire apparaître un champ lorsque le bas de la fenêtre est atteint ou de faire apparaître un champ lors de la remontée de l'ascenseur. 
Rappel : La fonction [AscenseurPosition](../WDLang1/1000021057.md) permet de connaître la position de l'ascenseur. 
<a name="NOTE2_8"></a>


### Evénement optionnel : Fin de défilement
<a name="evenement_optionnel_fin_defilement_ELTPARAGRAPHE000424"></a>Exécuté à la fin défilement de l'ascenseur vertical de la fenêtre (cas où le contenu de la fenêtre est plus important que la taille de la fenêtre). 
Cet événement permet par exemple de faire apparaître un champ lorsque le bas de la fenêtre est atteint ou de faire apparaître un champ lors de la remontée de l'ascenseur. 
Rappel : La fonction [AscenseurPosition](../WDLang1/1000021057.md) permet de connaître la position de l'ascenseur. 


