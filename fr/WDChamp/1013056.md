


## Le champ RTF (Editeur d'états)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation du champ RTF
<a name="presentation_champ_rtf_ELTTEXTE000185"></a>


### Le champ RTF est uniquement utilisable dans un état
<a name="champ_rtf_est_uniquement_utilisable_dans_etat_ELTPARAGRAPHE000011"></a>Le champ "RTF" (Rich Text Format) permet d'afficher une chaîne de caractères formatée dans votre état. Cette chaîne de caractères est au format RTF, c'est-à-dire que des balises spécifiques permettent de définir la mise en forme de chaque caractère ou chaîne de caractères. Ces balises ne sont pas affichées dans le champ, bien entendu.

Par exemple, un champ "RTF" permet d'afficher le texte suivant :<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=RTFimage1.gif)


**Pour créer un champ "RTF" :**

1. Sous le volet "Création", dans le groupe "Texte", cliquez sur "RTF".

2. Cliquez dans l'état à la position où le champ doit être créé.




**Remarques** : 

- **A partir de la version 22, le champ RTF d'un état correspond à un champ Libellé de type RTF.** 

- Dans une fenêtre, il est possible d'utiliser un champ de saisie ou un libellé RTF. Pour plus de détails, consultez [Champ de saisie](../WDChamp/1013145.md) ou [Champ Libellé](../WDChamp/1013179.md).




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment modifier le texte d'un champ RTF d'un état ?
<a name="comment_modifier_texte_champ_rtf_etat_ELTTEXTE000209"></a>
Le texte d'un champ "RTF" peut être modifié :

- par programmation (propriété [Libellé](../Proprietes/2510053.md)).
	![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Remarque** : Il est également possible d'utiliser la fonction [RTFCharge](../WDLang1/3025041.md) pour affecter le champ RTF.

- sous l'éditeur d'états. 




**Pour modifier le texte du champ RTF sous l'éditeur d'états** : 

1. Sélectionnez le champ. Les poignées de sélection apparaissent autour du champ.

2. Cliquez une nouvelle fois sur le champ. Le curseur de la souris se transforme en curseur de saisie.

3. Saisissez le nouveau texte du champ.

4. Modifiez si nécessaire la mise en forme du texte grâce à la barre de mise en forme.

5. Dès qu'un clic est effectué en dehors du champ, le champ repasse en affichage.



<a name="NOTE2_2"></a>


### Remarques
<a name="remarques_ELTPARAGRAPHE000077"></a>

- Le texte affiché dans le champ RTF peut contenir la valeur d'une rubrique imprimée dans l'état.
	Pour insérer la valeur d'une rubrique ou d'un champ de l'état dans le texte du libellé, saisissez le nom de la rubrique ou du champ entre les caractères [% et %].
	Par exemple, le texte du champ peut correspondre à : Le fournisseur [%NomFournisseur%] vend le produit [%NomProduit%] pour [%PrixTTC%]. Les rubriques NomFournisseur, NomProduit et PrixTTC seront remplacées par leur valeur à l'exécution de l'état.

- Le texte affiché dans le champ RTF peut provenir d'une rubrique de type texte présente dans la source de données de l'état.
	Si le champ est lié à une rubrique, le nom de la rubrique associée est affiché dans la combo "Rubrique liée" de l'onglet "Général" de la description du champ.



<a name="NOTE2_3"></a>


### Limitations
<a name="limitations_ELTPARAGRAPHE000115"></a>Par défaut : 

- Le format des fichiers RTF gérés dans les impressions WINDEV et WEBDEV est le même que le format RTF géré par "Wordpad" (jusqu'à Windows XP). Quelques limites supplémentaires sont à noter lors de l'export d'un état vers un document RTF (par exemple, les tableaux et les zones de texte ne sont pas gérés).

- Pour imprimer un champ RTF, le fichier "RICHED20.DLL" doit être présent sur le poste en cours. Le fichier "RICHED20.DLL" est généralement présent dans le répertoire système de Windows.

- Si le fichier RTF est généré par un autre outil (Word...), afin de vérifier la compatibilité du RTF, il est conseillé d'ouvrir le fichier avec Wordpad. L'affichage du fichier sous Wordpad donnera un aperçu plus réel de ce qui sera imprimé.

- Dans tous les cas, il est conseillé de ré-enregistrer le fichier avec Wordpad pour forcer le format du RTF.

- Les options de zoom sur le champ RTF sont incompatibles avec l'affichage de liens dans le texte. Si des liens sont ajoutés avec la fonction [AjouteLien](../WDLang1/1000019038.md), le zoom sera automatiquement forcé à 100%.

- Il n'est pas possible de récupérer les tableaux et les images d'un document RTF dans un champ RTF.
	Pour récupérer les tableaux et les images d'un document RTF dans un champ RTF, cochez l'option "RTF  avec images et tableaux" (onglet "Général" de la fenêtre de description du champ). Dans ce cas, la compatibilité avec Wordpad et la présence du fichier RICHED20.DLL ne sont plus obligatoires.




Si vous utilisez la fonction [iParamètre](../WDLang5/3046008.md) avec le paramètre "RTFWINDOWS=NON" ou la constante *iRTFAvecImagesEtTableaux*, l'impression des tableaux et des images dans les champs RTF est disponible. La compatibilité avec Wordpad et la présence du fichier RICHED20.DLL ne sont plus obligatoires. 


