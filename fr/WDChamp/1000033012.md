


## Manipuler un champ Tableur par programmation (dans une fenêtre) (syntaxe préfixée)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000113"></a>
Un champ Tableur présent dans une fenêtre peut être manipulé par programmation. 

Pour manipuler un champ Tableur par programmation, WINDEV propose les [fonctions Tableur](../WDLang1/1000023883.md). 

Cette page d'aide détaille comment manipuler un champ Tableur dans une fenêtre par programmation. 

**Remarque** : Dans un état, la manipulation du champ Tableur est différente. Pour plus de détails, consultez [Manipuler un champ Tableur par programmation (dans un état)](../WDChamp/1000033010.md).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Manipuler le champ Tableur par programmation
<a name="manipuler_champ_tableur_par_programmation_ELTTEXTE000151"></a>


### Initialiser un champ Tableur
<a name="initialiser_champ_tableur_ELTPARAGRAPHE000174"></a>Le champ Tableur peut être initialisé avec des valeurs, des formules, ... dès son affichage selon différentes méthodes : 

- Par programmation, en utilisant les fonctions suivantes : 


|   |   |
| --- | --- |
| [&lt;Tableur&gt;.AjouteDonnée](../WDLang1/1000023711.md) | Ajoute une donnée dans un champ Tableur présent dans une fenêtre. |
| [&lt;Tableur&gt;.AjouteFormule](../WDLang1/1000023713.md) | Ajoute une formule de calcul dans un champ Tableur présent dans une fenêtre. |
| [&lt;Tableur&gt;.AutoriseProcédure](../WDLang1/1000023716.md) | Autorise l'utilisation d'une fonction/procédure WLangage dans une formule d'un champ Tableur. |

- En chargeant un fichier Excel (au format XLSX) à l'initialisation du champ (fonction [&lt;Tableur&gt;.Charge](../WDLang1/1000023719.md)). 

- Via la saisie directe sous l'éditeur de fenêtres. Pour plus de détails, consultez [Initialisation du champ Tableur sous l'éditeur de fenêtres](../WDChamp/1000033008.md).



<a name="NOTE2_2"></a>


### Manipuler le champ Tableur
<a name="manipuler_champ_tableur_ELTPARAGRAPHE000226"></a>Pour manipuler un champ Tableur par programmation, il suffit de spécifier son nom. 

Par exemple : 

```wl
// Affiche la barre de formule
TBLR_Tableur.BarreDeFormuleVisible = Vrai
```

Plusieurs [fonctions WLangage](../WDLang1/1000023883.md) et [propriétés](../WDChamp/1000033003.md) permettent de manipuler le champ Tableur.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Manipuler les cellules d'un champ Tableur par programmation
<a name="manipuler_les_cellules_champ_tableur_par_programmation_ELTTEXTE000242"></a>
<a name="NOTE3_3"></a>


### Manipuler les cellules du champ Tableur
<a name="manipuler_les_cellules_champ_tableur_ELTPARAGRAPHE000265"></a>**Pour manipuler une cellule d'un champ Tableur par programmation**, utilisez les notations suivantes : 

```txt
<Nom Champ Tableur>[<Ligne>, <Colonne>]
```
ou 

```txt
<Nom Champ Tableur>["<NomCellule>"]
```


Exemples : 

```wl
// Colore en rouge la cellule C1
TBLR_Tableur[1,3].CouleurFond = RougeClair

// Colore en vert la cellule B1
TBLR_Tableur["B1"].CouleurFond = VertClair
```


**Pour affecter une valeur à une cellule par programmation**, il est possible d'utiliser : 

- soit la fonction [&lt;Tableur&gt;.AjouteDonnée](../WDLang1/1000023711.md). 
	Exemple : Ajout d'une valeur dans la cellule "A2" : 
	
	```wl
	TBLR_Tableur.AjouteDonnée(2, 1, 12)
	```


- soit l'affectation directe à la cellule : 

	- soit en passant par la cellule. 
			Exemple : Ajout d'une valeur dans la cellule "A2" : 
			
		```wl
		TBLR_Tableur["A2"] = 12
		```


	- soit via la colonne et la ligne de la cellule. 
			Exemple : Ajout d'une valeur dans la cellule "A2" : 
			
		```wl
		TBLR_Tableur["A"][2] = 12
		```






Remarques : 

- L'affectation d'une valeur au format 'AAAAMMJJ' à une cellule au format Date transforme automatiquement la valeur en date. 

- L'affectation d'une valeur au format 'HHMM' à une cellule au format Heure transforme automatiquement la valeur en heure. 


**Exemple** : Parcours des cellules d'un champ Tableur : 

```wl
// Parcours des cellules d'un champ Tableur
sMaChaîne est une chaîne
POUR i = 1 A TBLR_MonTableur.NombreLigne
	POUR y = 1 A TBLR_MonTableur.NombreColonne
		sMaChaîne += TBLR_MonTableur[i][y] + TAB
	FIN
	Trace(sMaChaîne + RC)
	sMaChaîne = ""
FIN
```

<a name="NOTE2_3"></a>


### Astuce : Fusionner des cellules par programmation
<a name="astuce_fusionner_des_cellules_par_programmation_ELTPARAGRAPHE000320"></a>L'utilisateur final a la possibilité de fusionner les cellules sélectionnées grâce au ruban (ou à la barre d'outils) du champ Tableur. 

Pour fusionner les cellules sélectionnées par programmation, il suffit d'utiliser la fonction [ExécuteFAA](../WDLang1/3013060.md) avec la constante *faaTableurFusion* : 

```wl
TBLR_MonTableur.SelectPlus("A1", "C5")
ExécuteFAA(TBLR_MonTableur, faaTableurFusion)
```
Remarque : La fonction [&lt;Tableur&gt;.RécupèreFusion](../WDLang1/1000023731.md) permet de savoir si une cellule est fusionnée avec d'autres cellules et de récupérer la plage de cellules fusionnées. 
<a name="NOTE2_5"></a>


### Gérer les noms des cellules dans un champ Tableur
<a name="gerer_les_noms_des_cellules_dans_champ_tableur_ELTPARAGRAPHE000350"></a>Le champ Tableur propose différentes fonctions permettant de manipuler les noms des cellules : 



|   |   |
| --- | --- |
| [&lt;Tableur&gt;.AjouteNom](../WDLang1/1000023715.md) | Spécifie un nom pour identifier une cellule d'un champ Tableur. |
| [TableurListeNom](../WDLang1/1000023448.md) | Renvoie la liste des noms qui identifient une cellule d'un champ Tableur. |
| [TableurModifieNom](../WDLang1/1000023464.md) | Modifie le nom utilisé pour identifier une cellule d'un champ Tableur. |
| [TableurSupprimeNom](../WDLang1/1000023447.md) | Supprime un des noms permettant d'identifier une cellule d'un champ Tableur. |




<a name="NOTE2_6"></a>


### Gérer les commentaires dans un champ Tableur
<a name="gerer_les_commentaires_dans_champ_tableur_ELTPARAGRAPHE000395"></a>Le champ Tableur permet aussi bien : 

- d'ajouter des commentaires,

- d'afficher les commentaires existants dans fichier XLSX. 




Les commentaires sont manipulés : 

- via la propriété avancée **Commentaire**. Cette propriété permet de connaître et de modifier les commentaires associés à une cellule via les propriétés suivantes : 
	


|   |   |
| --- | --- |
| Position | Nom de la cellule associé. <br><br>Cette propriété est disponible en lecture seulement. |
| Rectangle | Variable de type [Rectangle](../Motscles/1514079.md). <br><br>Permet de définir le rectangle dans lequel le commentaire est affiché. Les propriétés **Largeur** et **Hauteur** déterminent la taille du rectangle (en millimètres), et les propriétés **X** et **Y** permettent de déterminer la position du commentaire (en millimètres) par rapport au début de la feuille en cours. |
| Texte | Texte du commentaire. |
| Visible | <br><br>	- <u><u><u><u>Vrai</u></u></u></u> pour afficher le commentaire, <br><br>	- <u><u><u><u>Faux</u></u></u></u> pour rendre le commentaire invisible. Dans ce cas, seul un triangle rouge dans le coin haut droit de la cellule permettra à l'utilisateur de savoir que la cellule est associée à un commentaire. <br><br><br> |


	Exemple : 
	
	```wl
	// Création d'un commentaire
	TBLR_MonTableur["B1"].Commentaire.Texte = "Texte de mon commentaire"
	TBLR_MonTableur["B1"].Commentaire.Visible = Vrai
	TBLR_MonTableur["B1"].Commentaire.Rectangle.Hauteur = 50
	TBLR_MonTableur["B1"].Commentaire.Rectangle.Largeur = 50
	TBLR_MonTableur["B1"].Commentaire.Rectangle.X = 50
	TBLR_MonTableur["B1"].Commentaire.Rectangle.Y = 50
	```


- via différentes fonctions WLangage : 
	


|   |   |
| --- | --- |
| [TableurListeCommentaire](../WDLang1/1000024881.md) | Liste tous les commentaires de la feuille courante d'un champ Tableur. |
| [TableurSelectCommentaire](../WDLang1/1000024883.md) | Permet de : <br><br>	- savoir si un commentaire est sélectionné dans un champ Tableur, <br><br>	- sélectionner ou désélectionner un commentaire dans un champ Tableur.<br><br><br> |






<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Champ Tableur : Manipuler par programmation un fichier comportant plusieurs feuilles de calcul
<a name="champ_tableur_manipuler_par_programmation_fichier_comportant_plusieurs_feuilles_calcul_ELTTEXTE000466"></a>
Pour activer la gestion de plusieurs feuilles de calcul : 

- Sous l'éditeur : Dans l'onglet "Détail" de la fenêtre de description du champ, cochez l'option "Autoriser la gestion de plusieurs feuilles de calcul".

- Par programmation, utilisez la propriété [MultiFeuille](../Proprietes/1000021639.md). 




Après activation de la gestion de plusieurs feuilles de calcul : 

- Il est possible de charger les différentes feuilles de calcul d'un fichier XLSX (fonction [&lt;Tableur&gt;.Charge](../WDLang1/1000023719.md)). 

- Différentes fonctions permettent de manipuler les différentes feuilles de calcul : 
	


|   |   |
| --- | --- |
| [&lt;Tableur&gt;.AjouteFeuille](../WDLang1/1000023712.md) | Ajoute une feuille de calcul dans un champ Tableur présent dans une fenêtre. |
| [&lt;Tableur&gt;.InsèreFeuille](../WDLang1/1000023726.md) | Insère une feuille de calcul dans un champ Tableur présent dans une fenêtre. |
| [TableurListeFeuille](../WDLang1/1000023450.md) | Renvoie la liste des feuilles de calcul présentes dans un champ Tableur. |
| [&lt;Tableur&gt;.SelectFeuille](../WDLang1/1000023736.md) | Sélectionne une feuille de calcul (identifiée par son nom) dans un champ Tableur. |
| [&lt;Tableur&gt;.SupprimeFeuille](../WDLang1/1000023741.md) | Supprime une feuille de calcul dans un champ Tableur présent dans une fenêtre. |

- Différentes propriété permettent de manipuler les différentes feuilles : 
	


|   |   |
| --- | --- |
| [FeuilleEnCours](../Proprietes/1000021640.md) | La propriété **FeuilleEnCours** permet de connaître et de modifier la feuille courante d'un champ Tableur. |
| [MultiFeuille](../Proprietes/1000021639.md) | La propriété **MultiFeuille** permet de : <br><br>	- Savoir si un champ Tableur gère plusieurs feuilles de calcul. <br><br>	- Modifier le mode de gestion des feuilles de calcul d'un champ Tableur.<br><br><br> |
| [NbFeuille](../Proprietes/1000021641.md) | La propriété **NbFeuille** permet de connaître le nombre de feuilles de calcul dans un champ Tableur. |
| [NomFeuille](../Proprietes/1000021646.md) | La propriété **NomFeuille** permet de connaître ou modifier le nom de la feuille de calcul en cours dans un champ Tableur. |

- L'utilisateur dispose de FAA (Fonctionnalités Automatiques de vos Applications) pour gérer les différentes feuilles de calcul.




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Propriétés spécifiques aux champs Tableur
<a name="proprietes_specifiques_aux_champs_tableur_ELTTEXTE000596"></a>
Les propriétés suivantes sont spécifiques à la gestion d'un champ Tableur par programmation.



|   |   |
| --- | --- |
| [BarreDeFormuleVisible](../Proprietes/1000021334.md) | La propriété **BarreDeFormuleVisible** permet de : <br><br>- Savoir si une barre de formule est affichée dans un champ Tableur. <br><br>- Afficher ou non une barre de formule dans un champ Tableur.<br><br><br> |
| [BarreOutilsVisible](../Proprietes/1000021333.md) | La propriété **BarreOutilsVisible** permet : <br><br>- de savoir si la barre d'outils ou le ruban est affichée dans un champ.  <br><br>- d'afficher ou non la barre d'outils ou le ruban dans un champ.<br><br><br> |
| [CheminFichier](../Proprietes/1000023104.md) | La propriété **CheminFichier** permet de connaître : <br><br>- le nom du fichier xlsx associé à un champ Tableur.<br><br>- le nom du fichier associé à un champ Editeur d'images. <br><br>- le nom du fichier PDF associée à un champ Lecteur PDF. <br><br>- le nom du fichier DOCX associé à un champ Traitement de texte. <br><br>- le nom du fichier wddiag associé à un champ Editeur de diagrammes. <br><br><br> |
| [EntêteVisible](../Proprietes/1000021335.md) | La propriété **EntêteVisible** permet de : <br><br>- Savoir si les entêtes de lignes et colonnes sont affichés dans un champ Tableur. <br><br>- Afficher ou non les entêtes de lignes et colonnes dans un champ Tableur.<br><br><br> |
| [FeuilleEnCours](../Proprietes/1000021640.md) | La propriété **FeuilleEnCours** permet de connaître et de modifier la feuille courante d'un champ Tableur. |
| [MultiFeuille](../Proprietes/1000021639.md) | La propriété **MultiFeuille** permet de : <br><br>- Savoir si un champ Tableur gère plusieurs feuilles de calcul. <br><br>- Modifier le mode de gestion des feuilles de calcul d'un champ Tableur.<br><br><br> |
| [NbFeuille](../Proprietes/1000021641.md) | La propriété **NbFeuille** permet de connaître le nombre de feuilles de calcul dans un champ Tableur. |
| [NomFeuille](../Proprietes/1000021646.md) | La propriété **NomFeuille** permet de connaître ou modifier le nom de la feuille de calcul en cours dans un champ Tableur. |
| [QuadrillageVisible](../Proprietes/1000023117.md) | La propriété **QuadrillageVisible** permet de : <br><br>- Savoir si le quadrillage est visible ou non dans un champ. <br><br>- Modifier la visibilité du quadrillage dans un champ.<br><br><br> |
| [SaisieFormule](../Proprietes/1000021337.md) | La propriété **SaisieFormule** permet de : <br><br>- savoir si l'utilisateur final peut saisir ou modifier des formules dans un champ Tableur. <br><br>- autoriser ou non l'utilisateur final à saisir ou modifier des formules dans un champ Tableur.<br><br><br> |
| [SaisieValeur](../Proprietes/1000021336.md) | La propriété **SaisieValeur** permet de : <br><br>- savoir si l'utilisateur final peut saisir ou modifier des valeurs dans un champ Tableur. <br><br>- autoriser ou non l'utilisateur final à saisir ou modifier des valeurs dans un champ Tableur.<br><br><br> |





Pour connaître la liste complète des propriétés du WLangage pouvant être utilisées avec un champ de type Tableur et avec ses cellules, consultez [Propriétés associées au champ Tableur](../WDChamp/1000033003.md).


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampTableur.gif) ***Exemples unitaires (WINDEV)*** : **Le champ Tableur** <br>Utilisation du champ Tableur.<br>Cet exemple présente comment :<br>- charger un fichier xlsx dans un champ tableur,<br>- sauver le tableur dans un fichier,<br>- remplir le champ avec des données provenant de la base de données,<br>- insérer des lignes, des colonnes,<br>- accéder aux cellules et les manipuler (modifier leur valeur, leur style,...),<br>- saisir des formules,<br>- etc.


