
## Alimentation d'un champ Graphe
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000181"></a>
Les données à afficher dans le champ Graphe peuvent provenir :

- d'une rubrique d'un fichier de données ou d'une requête.

- d'une colonne d'un champ Table présent dans la fenêtre ou la page en cours.
	

- d'un champ Liste présent dans la fenêtre ou la page en cours.
	

- d'un tableau WLangage.
	

- de données spécifiées directement dans la fenêtre de description du champ ou par programmation.

- d'un champ de l'état en cours (uniquement pour un état).




Le mode d'alimentation du graphe est spécifié dans l'assistant de création du champ et dans la fenêtre de description du champ ([onglet "Séries"](../WDChamp/3042081.md)).







<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Graphe alimenté par programmation
<a name="graphe_alimente_par_programmation_ELTTEXTE000205"></a>
La programmation nécessaire à l'alimentation du graphe est réalisée grâce aux fonctions suivantes : 



|   |   |
| --- | --- |
| [grAjouteDonnée](../WDLang3/3042023.md) | Ajoute une donnée dans un graphe. |
| [grBourseAjouteDonnée](../WDLang3/3042009.md) | Ajoute une donnée dans un graphe boursier (chandelier, barcharts ou minmax). |
| [grHMAjouteDonnée](../WDLang3/1000021628.md) | Ajoute une donnée dans un graphe de type Heatmap. |
| [grIncrémenteDonnée](../WDLang3/3042030.md) | Ajoute une valeur à une donnée dans un graphe. |
| [grNuageAjouteDonnéeXY](../WDLang3/3042032.md) | Ajoute une donnée dans un graphe de type "Nuage de points". |
| [grSMNAjouteDonnée](../WDLang3/1000021285.md) | Ajoute une donnée à un graphe de type Secteur multiniveau. |
| [grSurfaceAjouteDonnée](../WDLang3/1000020425.md) | Ajoute une donnée dans un graphe de type Surface. |





Par exemple :

- **Champ Graphe dans une fenêtre / page** :
	Le champ Graphe "GRF_MonSalaire" permet de visualiser l'évolution de son salaire sur les quatre dernières années dans un graphe de type Courbe.
	Les champs de saisie "SAI_Salaire1", "SAI_Salaire2", "SAI_Salaire3" et "SAI_Salaire4" permettent de saisir son salaire annuel de l'année correspondante.
	Dans cet exemple, saisissez le code suivant dans l'événement "Initialisation" du champ Graphe :
	
	```wl
	// Ajout des données dans le graphe
	grAjouteDonnée(GRF_MonSalaire, 1, SAI_Salaire1)
	grAjouteDonnée(GRF_MonSalaire, 1, SAI_Salaire2)
	grAjouteDonnée(GRF_MonSalaire, 1, SAI_Salaire3)
	grAjouteDonnée(GRF_MonSalaire, 1, SAI_Salaire4)
	```


- **Champ Graphe dans un état** : 
	L'état "ETAT_MonEtat" imprime les caractéristiques (nom, prénom, chiffre d'affaires) des 10 meilleurs clients.
	Le graphe "GRF_MonGraphe" affiche le chiffre d'affaires de chaque client sous forme d'un graphe en secteur.
	Dans cet exemple, saisissez le code suivant dans l'événement "Avant impression" du bloc Corps :
	
	```wl
	// Ajout des données dans le graphe
	grAjouteDonnée(GRF_MonGraphe, 1, MaSource.ChiffreAffaires)
	```






<a name="NOTE3_2"></a>


### Remarques
<a name="remarques_ELTPARAGRAPHE000086"></a>

- Si le mode d'alimentation est automatique, il est déconseillé de programmer l'alimentation du graphe (avec les fonctions [grAjouteDonnée](../WDLang3/3042023.md), [grNuageAjouteDonnéeXY](../WDLang3/3042032.md), [grBourseAjouteDonnée](../WDLang3/3042009.md) et [grIncrémenteDonnée](../WDLang3/3042030.md)).

- Le graphe est automatiquement créé par l'éditeur de fenêtres, de pages ou d'états. Il n'est pas nécessaire d'utiliser la fonction [grCrée](../WDLang3/3042005.md) pour le créer.

- L'aspect du graphe et/ou l'affichage de texte dans le graphe peut être modifié :

	- soit dans la description du graphe (option "Description" du menu contextuel du champ). Pour plus de détails, consultez [Le champ Graphe : Caractéristiques sous l'éditeur](../WDChamp/3042076.md).

	- soit par les [fonctions de gestion des graphes](../WDLang3/3042003.md).







<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Cas particulier
<a name="cas_particulier_ELTTEXTE000286"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Champ Graphe d'une fenêtre ou d'une page basé sur un champ Table construit avec la fonction ConstruitTableFichier
<a name="champ_graphe_une_fenetre_une_page_base_sur_champ_table_construit_avec_fonction_construittablefichier_ELTPARAGRAPHE000123"></a>Si vous créez un nouveau graphe alimenté par un champ Table rempli avec la fonction [ConstruitTableFichier](../WDLang1/3074002.md) à partir d'une requête, il est nécessaire d'indiquer que les colonnes correspondent à _COL1, _COL2, ...

Il est également possible d'utiliser la fonction [grSourceSérie](../WDLang3/3042067.md) pour modifier la source de la série.




