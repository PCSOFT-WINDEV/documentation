


## Rupture dans un champ Zone répétée
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000343"></a>
Une rupture dans un champ Zone répétée permet de regrouper des données correspondant à un ou plusieurs arguments.
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=RuptureZR.GIF)
Par exemple, il est possible de lister :

- les clients par pays et par ville,

- les factures par client,

- les produits selon leur famille et leur sous-famille, ...




Les ruptures dans les champs Zone répétée sont disponibles pour :

- Les champs Zone répétée fichier chargé en mémoire.

- Les champs Zone répétée mémoire.




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les ruptures ne sont pas disponibles en Java.

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Remarques : 

- En exécution, l'utilisateur peut à tout moment mémoriser l'état des ruptures en cours dans le champ Zone répétée (ruptures repliées, dépliées, ...). Pour plus de détails, consultez [Mémoriser les ruptures dans les champs Table/Zone répétée (FAA)](../WDChamp/9500138.md). 

- Il est possible de gérer les [ruptures dans un champ Zone répétée par programmation](#NOTE6_1). 






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Ajout d'une rupture
<a name="ajout_une_rupture_ELTTEXTE000367"></a>


### Ajouter une rupture
<a name="ajouter_une_rupture_ELTPARAGRAPHE000072"></a>Pour ajouter une rupture dans un champ Zone répétée :

1. Affichez la fenêtre de description du champ Zone répétée (option "Description" du menu contextuel).

2. Dans l'onglet "Contenu", cliquez sur le bouton 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=BtnRupture.GIF)
. La fenêtre de gestion des ruptures apparaît : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=FenRupture.GIF)


3. Sélectionnez la rubrique ou l'attribut sur lequel une rupture doit être effectuée. Il est possible de sélectionner plusieurs rubriques et/ou attributs pour effectuer plusieurs ruptures. 
	Les rubriques et attributs proposés diffèrent en fonction du type du champ Zone répétée :

	- ***Dans un champ Zone répétée lié à un fichier de données*** :

		- *parcours automatique* : la rubrique de parcours, les attributs liés à cette rubrique de parcours et les attributs liés à aucune rubrique sont proposés. Si la rubrique de parcours correspond à une clé composée, les composantes de cette clé composée, les attributs liés à ces composantes et les attributs liés à aucune rubrique sont proposés.

		- *parcours programmé* : les rubriques du fichier de données, les attributs liés à ces rubriques et les attributs liés à aucune rubrique sont proposés.




- ***Dans un champ Zone répétée lié à une requête*** :

	- *parcours automatique* : la rubrique de parcours, les attributs liés à cette rubrique de parcours et les attributs liés à aucune rubrique sont proposés. Si la rubrique de parcours n'est pas spécifié (option "&lt;Automatique&gt;"), les rubriques triés de la requête, les attributs liés à ces rubriques et les attributs liés à aucune rubrique sont proposés.

	- *parcours programmé* : les rubriques de la requête, les attributs liés à ces rubriques et les attributs liés à aucune rubrique sont proposés.

4. Validez la fenêtre de gestion des ruptures. 

5. Les ruptures seront réalisées selon leur ordre d'affichage dans le tableau des ruptures présent dans l'onglet "Contenu" de la description de la zone répétée. Modifiez si nécessaire cet ordre à l'aide des boutons fléchés à droite du tableau.

6. Indiquez le mode de fonctionnement des ruptures : 

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) si les ruptures doivent être des "Ruptures avec enroulé/déroulé". Si cette option est cochée, un bouton "+ /-" est automatiquement ajouté dans le haut de rupture. Ce bouton permettra à l'utilisateur d'enrouler ou de dérouler la rupture à sa convenance. 




7. Validez.




**Remarques** : 

- Des ruptures peuvent être créées aussi bien dans des zones répétées mono-colonnes que dans des zones répétées multicolonnes. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Un haut de rupture peut être toujours visible. Dans ce cas, lors du défilement, le bandeau de la rupture ne sera pas déplacé. Pour rendre un haut de rupture toujours visible : 

	- Sélectionnez le haut de rupture et affichez sa description (option "Description" du menu contextuel). 

	- Dans l'onglet "UI", cochez l'option "Haut de rupture toujours visible". 






<a name="NOTE2_2"></a>


### Haut et bas de rupture
<a name="haut_bas_rupture_ELTPARAGRAPHE000119"></a>Lors de l'ajout d'une nouvelle rupture, un haut et un bas de rupture sont automatiquement ajoutés à la zone répétée. Si la zone répétée possède plusieurs ruptures, il y a autant de hauts et de bas de ruptures que de ruptures.

Pour modifier les caractéristiques de ces hauts et bas de rupture (nom, visibilité, couleur de fond, ...), il suffit d'afficher leur fenêtre de description (option "Description" du menu contextuel).

Chaque haut et bas de rupture est associé à l'événement "Affichage d'une ligne". Cet événement est exécuté lorsqu'un nouveau haut ou bas de rupture est affiché dans la zone répétée.

Ces hauts et bas de rupture peuvent contenir des champs. Ces champs sont manipulables par programmation.

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Les sommes, moyennes et comptages sont automatiques dans les ruptures des zones répétées. Les champs des hauts et bas de ruptures peuvent afficher ces calculs. Pour plus de détails, consultez [calculs automatiques dans les ruptures de zones répétées](#NOTE4_1).
<a name="NOTE2_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) 

### Image des boutons de rupture 
<a name="image_des_boutons_rupture_ELTPARAGRAPHE000143"></a>Pour modifier l'image des boutons de rupture : 

1. Affichez la fenêtre de description du champ Zone répétée (option "Description" du menu contextuel).

2. Dans l'onglet "Contenu", une rupture est définie. 

3. Dans l'onglet "Style", sélectionnez l'élément "Rupture, cadre en création".

4. Cliquez sur le bouton "Image Plus/Moins des ruptures". 

5. Dans la zone qui s'affiche, saisissez le chemin de l'image du bouton des ruptures. Cette image est une image à 2 états (plus et moins) au format 24 x 12. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Rupture_Perso_Btn.gif&type=thumb)





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Manipulation des champs présents dans les hauts et les bas de ruptures
<a name="manipulation_des_champs_presents_dans_les_hauts_les_bas_ruptures_ELTTEXTE000403"></a>


### Initialiser les champs présents dans les hauts et les bas de ruptures
<a name="initialiser_les_champs_presents_dans_les_hauts_les_bas_ruptures_ELTPARAGRAPHE000159"></a>Pour initialiser les champs présents dans les hauts et les bas de ruptures :

- soit manipulez chaque champ de tous les hauts / bas de rupture : 
	
	```txt
	<Nom Champ>.<Nom Propriété> = <Valeur>
		ou
	<Nom Zone répétée>.<Nom Haut/Bas de rupture>.<Nom Champ>.<Nom Propriété> = <Valeur>
	```
Si &lt;Nom Propriété&gt; correspond à la propriété [Valeur](../Proprietes/2510130.md), seule la valeur du champ spécifié pour la répétition en cours est modifiée

- soit manipulez chaque champ d'une rupture donnée : 
	
	```txt
	<Nom Zone répétée>[<Indice>].<Nom Champ>.<Nom Propriété> = <Valeur>
	```
&lt;Indice&gt; doit correspondre à une des répétitions contenues dans la rupture voulue.

- soit manipulez chaque attribut de tous les hauts / bas de rupture :
	
	```txt
	<Nom Attribut> = <Valeur>
	```
La propriété associée à &lt;Nom Attribut&gt; sera initialisée.

- soit manipulez chaque attribut d'une rupture donnée : 
	
	```txt
	<Nom Attribut>[<Indice>] = <Valeur>
	```
La propriété associée à &lt;Nom Attribut&gt; sera initialisée.
	&lt;Indice&gt; doit correspondre à une des répétitions contenues dans la rupture voulue.




**Remarque** : Ces lignes de code doivent être présentes dans l'événement "Affichage d'une ligne du haut / bas de rupture".
<a name="NOTE3_2"></a>


### Récupérer la valeur des champs présents dans les hauts et les bas de ruptures
<a name="recuperer_valeur_des_champs_presents_dans_les_hauts_les_bas_ruptures_ELTPARAGRAPHE000190"></a>Pour récupérer la valeur des champs présents dans les hauts et les bas de ruptures :

- soit manipulez chaque champ de la rupture en cours :
	
	```txt
	<Valeur> = <Nom Champ>.<Nom Propriété>
		ou
	<Valeur> = <Nom Zone répétée>.<Nom Haut/Bas de rupture>.<Nom Champ>.<Nom Propriété>
	```


- soit manipulez chaque champ d'une rupture donnée :
	
	```txt
	<Valeur> = <Nom Zone répétée>[<Indice>].<Nom Champ>.<Nom Propriété>
	```
&lt;Indice&gt; doit correspondre à une des répétitions contenues dans la rupture voulue.

- soit manipulez chaque attribut de tous les hauts / bas de rupture : 
	
	```txt
	<Valeur> = <Nom Attribut>
	```
La valeur de la propriété associée à &lt;Nom Attribut&gt; sera récupérée.

- soit manipulez chaque attribut d'une rupture donnée :
	
	```txt
	<Valeur> = <Nom Attribut>[<Indice>]
	```
La valeur de la propriété associée à &lt;Nom Attribut&gt; sera récupérée.
	&lt;Indice&gt; doit correspondre à une des répétitions contenues dans la rupture voulue.




**Remarque** : Ces lignes de code doivent être présentes dans l'événement "Affichage d'une ligne du haut / bas de rupture".

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

## Calculs automatiques dans les ruptures des champs Zone répétée
<a name="calculs_automatiques_dans_les_ruptures_des_champs_zone_repetee_ELTTEXTE000433"></a>
Il est possible d'ajouter des calculs automatiques (somme, comptage et moyenne) dans les hauts et bas de rupture.

Pour mettre en place les calculs automatiques :

1. Insérez un champ Libellé ou un champ de saisie dans le haut/bas de rupture.

2. Affichez la fenêtre de description du champ (option "Description" du menu contextuel).

3. Dans l'onglet "UI", dans la zone "Dans une rupture, afficher", cliquez sur le lien "Aucun calcul" ou sur la description du calcul (si un calcul automatique a déjà été défini). La fenêtre de description d'un calcul automatique s'affiche.

4. Sélectionnez le calcul à effectuer. Vous pouvez choisir :

	- "La somme de" : le champ affichera la somme par rupture.

	- "La moyenne de": le champ affichera la moyenne sur la rupture.

	- "Le nombre (comptage) de" : le champ comptera le nombre d'éléments par rupture.




5. Sélectionnez l'élément sur lequel le calcul doit être effectué. Il est possible d'effectuer le calcul sur :

	- Un champ : le calcul sera effectué sur la propriété valeur du champ.

	- Un attribut de la zone répétée : le calcul sera effectué en utilisant la propriété de l'attribut.

	- Une rubrique du fichier de données (uniquement pour les zones répétées fichier).




6. Validez.




Astuces : 

- Selon le type d'information calculé, pensez à modifier le masque de saisie du champ qui affiche le calcul. 

- N'hésitez pas à utiliser la technologie des "eye magnet" sur les champs de saisie affichant des calculs dans les ruptures. Il sera ainsi possible de mettre en évidence un calcul (par exemple affichage d'un CA insuffisant en rouge). 




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Manipulation des hauts et des bas de ruptures par programmation
<a name="manipulation_des_hauts_des_bas_ruptures_par_programmation_ELTTEXTE000457"></a>


### Initialiser les hauts/bas de ruptures
<a name="initialiser_les_hautsbas_ruptures_ELTPARAGRAPHE000250"></a>Pour initialiser les hauts et bas de rupture, utilisez la syntaxe suivante : 

```txt
<Nom Haut/Bas de rupture>.<Nom Propriété> = <Valeur>
```


**Remarque** : Ces lignes de code doivent être présentes dans l'événement "Affichage d'une ligne du haut/bas de rupture".
<a name="NOTE5_2"></a>


### Fonctions associées aux hauts/bas de ruptures
<a name="fonctions_associees_aux_hautsbas_ruptures_ELTPARAGRAPHE000260"></a>Les fonctions associées aux hauts / bas de ruptures sont les suivantes :



|   |   |
| --- | --- |
| [ZoneRépétéeDéroule](../WDLang2/1000019771.md) | Déroule une rupture du champ Zone répétée sur une ligne donnée. |
| [ZoneRépétéeDérouleTout](../WDLang2/1000019774.md) | Déroule toutes les ruptures d'un champ Zone répétée avec rupture. |
| [ZoneRépétéeEnroule](../WDLang2/1000019770.md) | Enroule une rupture précédemment déroulée d'un champ Zone répétée. |
| [ZoneRépétéeEnrouleDéroule](../WDLang2/1000019970.md) | Sur une répétition/ligne donnée d'un champ Zone répétée : <br><br>- replie une rupture (si elle est déroulée),<br><br>- déplie une rupture (si elle est enroulée).<br><br><br> |
| [ZoneRépétéeEnrouleTout](../WDLang2/1000019772.md) | Enroule toutes les ruptures déroulées d'un champ Zone répétée. |
| [ZoneRépétéeIndiceRupture](../WDLang2/3083029.md) | Renvoie l'indice du haut et du bas de rupture d'une rupture donnée dans un champ Zone répétée. |




<a name="NOTE5_3"></a>


### Propriétés associées aux hauts / bas de ruptures
<a name="proprietes_associees_aux_hauts_bas_ruptures_ELTPARAGRAPHE000268"></a>Plusieurs propriétés permettent de manipuler les ruptures par programmation, principalement : 



|   |   |
| --- | --- |
| [Enroulé](../Proprietes/2513014.md) | La propriété **Enroulé** permet de :<br><br>- connaître ou définir l'état (enroulé ou déroulé) qui sera utilisé lors des prochains ajouts de lignes dans un champ Table hiérarchique.<br><br>- connaître ou modifier l'état enroulé/déroulé pour : <br><br>	- les ruptures d'un champ Table,<br><br>	- les ruptures d'un champ Zone répétée,<br><br>	- les cellules de rupture des champs Tables et Zone répétée,<br><br>	- un champ Tiroir,<br><br>	- un champ Ruban, <br><br>	- un champ Barre de navigation. <br><br>	- un champ Tableau croisé dynamique dans un état.<br><br><br><br><br><br> |





Pour connaître la liste complète des propriétés disponibles, consultez [Propriétés disponibles sur les ruptures (Zone répétée)](../WDChamp/1010045.md). 

<a name="NOTE6"></a>
<a name="NOTE6_1"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

## Gestion des ruptures dans les champs Zone répétée par programmation
<a name="gestion_des_ruptures_dans_les_champs_zone_repetee_par_programmation_ELTTEXTE000558"></a>
Les ruptures dans les champs Zone répétée peuvent être créées et manipulées par programmation grâce aux fonctions suivantes : 



|   |   |
| --- | --- |
| [RuptureAjoute](../WDLang1/1000022737.md) | Ajoute une rupture dans un champ Table ou dans un champ Zone Répétée. |
| [RuptureSupprime](../WDLang1/1000022738.md) | Supprime une rupture dans un champ Table ou dans un champ Zone répétée. |
| [RuptureSupprimeTout](../WDLang1/1000022739.md) | Supprime toutes les ruptures présentes dans un champ Table ou un champ Zone répétée. |





L'ajout d'une rupture dans une zone répétée est réalisé grâce à la fonction [RuptureAjoute](../WDLang1/1000022737.md). La rupture créé correspond à une variable de type [Champ](../WDLang1/1000020967.md) qui peut ensuite être manipulé avec les mêmes propriétés WLangage qu'une rupture créée sous l'éditeur. 


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=eCommerce.gif) ***Exemples complets (WEBDEV)*** : **eCommerce** <br>Le projet eCommerce est un site complet de commerce en ligne personnalisable via une interface d'administration Web.<br>- La partie vitrine / paiement du site est réalisée en AWP afin de permettre un référencement optimal des produits.<br>- La partie administration du site est réalisée en session classique WB pour garantir une sécurité optimale.


