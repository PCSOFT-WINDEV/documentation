


## Evénements associés aux champs Arbre 
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Evénements gérés par défaut
<a name="evenements_geres_par_defaut_ELTTEXTE000287"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Evénements gérés par WINDEV et WINDEV Mobile
<a name="evenements_geres_par_windev_windev_mobile_ELTPARAGRAPHE000013"></a>WINDEV et WINDEV Mobile gèrent par défaut les événements suivants (ordre d'apparition sous l'éditeur de code) :

| Evénement | Condition d'exécution |
| --- | --- |
| Initialisation | Exécuté à l'ouverture de la fenêtre. Permet par exemple, d'initialiser le contenu du champ Arbre. (\*) |
| Fin d'initialisation | **Code présent uniquement pour les champs Arbre fichier remplis automatiquement** :<br>Exécuté après le remplissage du champ Arbre. Ce code permet par exemple de dérouler ou enrouler un élément. |
| Entrée | Exécuté lorsque le curseur de la souris se positionne sur le champ Arbre. |
| Sortie | Exécuté lorsque le champ n'est plus sélectionné. |
| Clic | Exécuté lorsque l'utilisateur clique sur un élément du champ Arbre.<br>**Attention** : Lors d'un double clic sur un élément, le code de clic est exécuté puis le code de double-clic. |
| Entrée en saisie d'une ligne | Exécuté lorsque l'utilisateur sélectionne une ligne pour effectuer une saisie dans cette ligne.<br>**Attention** : Ce code est disponible uniquement si le champ Arbre autorise la saisie. |
| Sortie d'une ligne | Exécuté lors du changement de ligne ou lors du changement de champ (touche TAB, changement de champ par la souris, ...) à partir d'une ligne.<br>**Attention** : Ce code est disponible uniquement si le champ Arbre autorise la saisie. |
| Affichage d'une ligne | Exécuté lorsque une nouvelle ligne doit être affichée dans le champ Arbre. |
| Sélection d'une ligne | Exécuté lors d'une nouvelle sélection d'un élément dans le champ Arbre. |
| Clic droit | Exécuté lorsque l'utilisateur effectue un clic droit de la souris sur le champ Arbre (ou sur un de ses éléments). |
| Double clic | Exécuté lorsque l'utilisateur effectue un double-clic sur le champ Arbre (ou sur un de ses éléments). |
| Enroulé, déroulé d'un noeud | Exécuté lorsque une branche du champ Arbre est enroulée ou déroulée par clic ou double-clic de l'utilisateur ou encore par les icônes + ou -.<br><br>**Attention** : Lors d'un clic ou d'un double-clic, cet événement est exécuté avec l'événement "Clic". Cet événement est exécuté avant que l'action voulue soit réalisée.<br><br>**Remarque** : Cet événement peut accepter des paramètres (voir ci-dessous). |
| Filtrage des enregistrements<br>(événement optionnel) | **Evénement pris en compte dans le cas des champs Arbre fichier uniquement**<br><br>Exécuté juste avant l'affichage d'une ligne. Cet événement permet de filtrer les enregistrements à afficher dans le champ Arbre. Cet événement est détaillé à la fin de cette page. |


(\*) Par défaut, l'événement "Initialisation" de chaque champ est exécuté selon l'ordre de création des différents champs dans la fenêtre. Pour modifier cet ordre d'exécution : 

1. Sous le volet "Fenêtre", dans le groupe "Ordre", cliquez sur "Initialisation". 

2. Dans la fenêtre qui s'affiche, utilisez les flèches situées sur la droite pour modifier l'ordre d'initialisation des champs.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Cas particulier : Enroulé/Déroulé d'un noeud
<a name="cas_particulier_enroulederoule_noeud_ELTTEXTE000317"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) L'événement **"Enroulé, Déroulé d'un noeud"** est exécuté lorsque une branche du champ Arbre est enroulée ou déroulée par clic ou double-clic de l'utilisateur.

**Attention** : Cet événement ne doit pas supprimer le noeud en cours.

Cet événement peut accepter des paramètres.

Pour gérer ces paramètres, il est nécessaire de déclarer une procédure directement dans l'événement "Enroulé, Déroulé d'un noeud".

Cette procédure doit être déclarée avec la syntaxe suivante :

```txt
PROCEDURE <Nom de la procédure>([<Chemin de l'élément> [, <Enroulé> [, <Identifiant> ]]])
```
Où


|   |   |
| --- | --- |
| &lt;Chemin de l'élément&gt; | Variable de type Texte, contenant le chemin complet de l'élément actuellement enroulé ou déroulé. Il suffit d'indiquer un nom de variable, cette variable sera automatiquement initialisée à l'exécution. |
| &lt;Enroulé&gt; | Variable de type Booléen, permettant de savoir quelle est l'action réalisée par l'utilisateur (enroule = Vrai ou déroule = Faux). Il suffit d'indiquer un nom de variable, cette variable sera automatiquement initialisée à l'exécution. |
| &lt;Identifiant&gt; | Variable de type Texte, contenant l'identifiant de l'élément actuellement enroulé ou déroulé. Il suffit d'indiquer un nom de variable, cette variable sera automatiquement initialisée à l'exécution. L'identifiant a été fourni lors de l'appel à la fonction [ArbreAjoute](../WDLang1/3018012.md). |

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Il est possible de déclarer une procédure dans l'événement "Enroulé,Déroulé d'un noeud".**Exemple** : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ARBRECODE.gif)


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Evénements optionnels
<a name="evenements_optionnels_ELTTEXTE000341"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Pour ajouter un événement optionnel :

1. Sélectionnez le champ voulu.

2. Affichez la fenêtre de code de ce champ (touche F2).

3. Cliquez sur le lien "Ajouter d'autres événements à xxx" situé à la fin de la fenêtre de code, après le dernier événement.  ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Traitements_optionnels_WD_OK%20-%20HC%20N%B0001.gif)


4. La totalité des événements optionnels disponibles pour le champ est affichée. 

5. Cochez l'événement optionnel à ajouter et validez. 
	Remarque : Il est possible de sélectionner plusieurs événements optionnels. 

6. L'événement optionnel sélectionné est automatiquement ajouté dans les événements gérés par le champ.




Pour désactiver un événement optionnel, il suffit d'effectuer les mêmes manipulations pour afficher la liste des événements optionnels. Il suffit ensuite de décocher les événements optionnels à supprimer. 
Remarque : Si le code désactivé contient du code WLangage, ce code est automatiquement supprimé.Il est ainsi possible de gérer par exemple :

- le survol du champ par la souris,

- le bouton gauche enfoncé, relâché, avec un double-clic,

- le bouton droit enfoncé, relâché, avec double-clic,

- la roulette de la souris.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Filtrage des enregistrements (champ Arbre fichier uniquement)
<a name="filtrage_des_enregistrements_champ_arbre_fichier_uniquement_ELTTEXTE000381"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) L'événement "Filtrage des enregistrements" est exécuté juste après l'affichage d'une ligne du champ Arbre. Il est donc exécuté :

- lors de l'initialisation du champ Arbre.

- à chaque nouvel affichage d'une ligne du champ Arbre.




Cet événement permet de filtrer les enregistrements affichés dans le champ Arbre. 

Pour mettre en place un filtre, l'événement "Filtrage des enregistrements" doit renvoyer une valeur :

- <u><u><u><u>Vrai</u></u></u></u> pour signifier que l'enregistrement respecte le filtre et qu'il doit être affiché.

- <u><u><u><u>Faux</u></u></u></u> pour signifier que l'enregistrement ne respecte pas le filtre et qu'il ne doit pas être affiché.

- <u><u><u><u>Annuler</u></u></u></u> pour arrêter la lecture de la source de données du champ Arbre (cas très rare).




Exemple :

```wl
// -- Filtrage des enregistrements --
// Affiche uniquement les clients dont commandes sont supérieures à 3000 euros
SI Commande.TotalTTC >= 3000 ALORS 
	RENVOYER Vrai
SINON
	RENVOYER Faux
FIN
```


Dans ce code, les données manipulées concernent l'enregistrement en cours de lecture par le champ Arbre. Ces données proviennent du fichier de données ou de la requête liés au champ Arbre.


