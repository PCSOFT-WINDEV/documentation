


## Manipuler un élément d'un champ Arbre par programmation
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000323"></a>
Cette page d'aide présente comment manipuler les éléments d'un champ Arbre aussi bien par les fonctions WLangage que par manipulation directe.

Il est ainsi possible de :

- [Manipuler un élément d'un champ Arbre](#NOTE2_1),

- [Initialiser un élément d'un champ Arbre](#NOTE3_1),

- [Sélectionner un élément dans un champ Arbre](#NOTE4_1),

- [Récupérer l'élément sélectionné dans le champ Arbre](#NOTE5_1),

- [Utiliser les propriétés WLangage sur un élément d'un champ Arbre](#NOTE6_1). 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Manipuler directement les éléments d'un champ Arbre
<a name="manipuler_directement_les_elements_champ_arbre_ELTTEXTE000347"></a>


### Fonctions WLangage 
<a name="fonctions_wlangage_ELTPARAGRAPHE000044"></a>Dans les fonctions WLangage de gestion des champs Arbre, l'élément du champ Arbre se manipule grâce à son chemin complet (depuis la racine du champ Arbre). Ce chemin est au format suivant :

```txt
"<Nom de la racine>" + TAB + ["<Nom du 1er noeud>" + TAB + ...
["<Nom du 2ème noeud>" + TAB + [...]]]"<Nom de la feuille>"
```
Les différents éléments constituant le chemin des chaînes de caractères sont séparés par des caractères TAB.
<a name="NOTE2_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Manipulation directe
<a name="manipulation_directe_ELTPARAGRAPHE000057"></a>Pour manipuler directement un élément du champ Arbre (par exemple avec les propriétés WLangage), deux notations sont disponibles :

- Manipulation grâce à l'indice de l'élément :
	Il suffit d'utiliser la notation suivante : **&lt;Champ Arbre&gt; [ &lt;Indice de l'élément&gt;]**.
	Attention : Les indices spécifiés prennent uniquement en compte les éléments visibles.
	**Exemple** : Modification de la couleur du 5ème élément affiché dans un champ Arbre :
	
	```wl
	ARBRE_MonArbre[5].Couleur = RougeClair
	```


- Manipulation grâce au chemin complet de l'élément :
	Il suffit d'utiliser la notation suivante : **&lt;Champ Arbre&gt; [ &lt;Chemin de élément&gt;]**.
	Le chemin de l'élément est une chaîne de caractères de la forme : 
	
	```txt
	"<Nom de la racine>" + TAB + ["<Nom du 1er noeud>" + TAB + ...
	["<Nom du 2ème noeud>" + TAB + [...]]]"<Nom de la feuille>"
	```
**Exemple** : Modification de la couleur de l'élément "Ananas".
	
	```wl
	ARBRE_MonArbre["Recette" + TAB + "Dessert" + TAB + "Ananas"].Couleur = RougeClair
	```





Remarque : Il est également possible d'utiliser la notation suivante pour désigner l'élément en cours d'un champ Arbre :

```wl
MoiMême[ArbreSelect(MoiMême)]
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Initialiser un élément d'un champ Arbre
<a name="initialiser_element_champ_arbre_ELTTEXTE000377"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Initialiser un élément
<a name="initialiser_element_ELTPARAGRAPHE000107"></a>Pour initialiser un élément d'un champ Arbre, utilisez la fonction [ArbreAjoute](../WDLang1/3018012.md).

Lors de cet ajout, il est possible :

- [Associer un identifiant à un élément](../WDChamp/1013033.md). 

- [Associer une image aux éléments](../WDChamp/1013034.md). 



<a name="NOTE3_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Associer une bulle d'aide à un élément
<a name="associer_une_bulle_aide_element_ELTPARAGRAPHE000130"></a>Pour associer une bulle d'aide à un élément d'un champ Arbre, il est possible d'utiliser :

- soit les fonctions du WLangage permettant d'ajouter ou de modifier un élément d'un champ Arbre ([ArbreAjoute](../WDLang1/3018012.md), [ArbreInsère](../WDLang1/3018023.md), [ArbreModifie](../WDLang1/3018013.md)),

- soit la propriété [Bulle](../Proprietes/2510005.md) sur l'élément voulu.


Si le texte de la bulle d'aide de l'élément n'est pas précisé, le texte affiché sera celui de la bulle d'aide du champ Arbre (si il existe).

**Rappel** : Par défaut, la bulle d'aide associée aux différents champs est affichée. Pour choisir d'afficher ou non les bulles d'aide, utilisez la fonction [BulleActive](../WDLang1/3025014.md).

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Sélectionner un élément dans un champ Arbre
<a name="selectionner_element_dans_champ_arbre_ELTTEXTE000407"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Sélectionner l'élément de la ligne &lt;Indice&gt;
<a name="selectionner_element_ligne_ELTPARAGRAPHE000165"></a>Pour sélectionner l'élément de la ligne &lt;Indice&gt;, utilisez : 

- soit l'affectation directe : 
	
	```txt
	<Champ Arbre> = Indice
	```

	 Si la ligne est affichée dans le champ Arbre, l'élément correspondant est sélectionné.

- soit la fonction [ArbreSelectPlus](../WDLang1/3018002.md) : 
	
	```txt
	ArbreSelectPlus(<Champ Arbre>, <Nom complet de l'élément>)
	```




<a name="NOTE4_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Se positionner sur le dernier élément du champ Arbre
<a name="positionner_sur_dernier_element_champ_arbre_ELTPARAGRAPHE000193"></a>Pour se positionner sur le dernier élément du champ Arbre, utilisez la propriété [Occurrence](../Proprietes/2510097.md) : 

```txt
<Champ Arbre> = <Champ Arbre>.Occurrence
```


<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Récupérer l'élément sélectionné dans le champ Arbre
<a name="recuperer_element_selectionne_dans_champ_arbre_ELTTEXTE000437"></a>
Pour récupérer : 

- l'indice de l'élément sélectionné, utilisez la lecture directe de l'élément : 
	
	```txt
	Indice = <Champ Arbre>
	```


- le chemin complet de l'élément sélectionné, utilisez la fonction [ArbreSelect](../WDLang1/3018003.md) : 
	
	```txt
	<Chemin> = ArbreSelect(<Champ Arbre>)
	```


- l'identifiant de l'élément sélectionné, utilisez la fonction [ArbreRécupèreIdentifiant](../WDLang1/3018004.md). 
	




<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Propriétés WLangage associées aux élément d'un champ Arbre
<a name="proprietes_wlangage_associees_aux_element_champ_arbre_ELTTEXTE000461"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Utilisation des propriétés sur un élément d'un champ Arbre
<a name="utilisation_des_proprietes_sur_element_champ_arbre_ELTPARAGRAPHE000254"></a>De nombreuses propriétés WLangage peuvent être utilisées sur les éléments d'un champ Arbre.

Pour connaître la liste complète des propriétés du WLangage pouvant être utilisées avec un élément d'un champ de type Arbre, consultez [Propriétés associées à une ligne d'un champ Arbre](../WDChamp/1013016.md).
<a name="NOTE6_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Exemples
<a name="exemples_ELTPARAGRAPHE000270"></a>Exemple : Comment modifier la couleur d'un élément d'un champ Arbre :

```wl
ARBRE_MonArbre[5].Couleur = RougeClair
```

Exemple : Comment modifier la taille de la police d'un élément d'un champ Arbre :

```wl
ARBRE_MonArbre["Recette" + TAB + "Dessert" + TAB + "Ananas"].PoliceTaille = 14
```



