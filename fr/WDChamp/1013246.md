


## Evénements associés aux colonnes (champ Table)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Evénements gérés
<a name="evenements_geres_ELTTEXTE000283"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Evénements gérés par WINDEV et WINDEV Mobile
<a name="evenements_geres_par_windev_windev_mobile_ELTPARAGRAPHE000013"></a>WINDEV et WINDEV Mobile gèrent par défaut les événements suivants (ordre d'apparition sous l'éditeur de code) :

| Evénement | Condition d'exécution |
| --- | --- |
| Initialisation | Exécuté à l'ouverture de la fenêtre. \*<br><br>**Cas particulier : Champ Table fichier rempli automatiquement :**<br>Lors de l'exécution de ce code, le champ Table n'est pas encore rempli. Il est possible de forcer le remplissage du champ Table dans cet événement avec :<br><br>- soit la fonction [TableAffiche](../WDLang1/3074003.md).<br><br>- soit les propriétés de gestion des champs Table fichier : [FichierParcouru](../Proprietes/2510040.md), [RubriqueParcourue](../Proprietes/2510111.md) ou [Filtre](../Proprietes/2510042.md).<br><br><br>Il est également possible de filtrer les enregistrements avec la fonction [HFiltre](../WDLang4/3044100.md). |
| Entrée (dans la colonne) | Exécuté lorsque la colonne prend le focus. |
| Sortie (de la colonne) | Exécuté lors du changement de champ (touche TAB, changement de champ par la souris, ...). |
| A chaque modification | Exécuté lorsque l'utilisateur modifie le contenu d'une colonne. |


(\*) Par défaut, l'événement "Initialisation" de chaque champ est exécuté selon l'ordre de création des différents champs dans la fenêtre. Pour modifier cet ordre d'exécution : 

1. Sous le volet "Fenêtre", dans le groupe "Ordre", cliquez sur "Initialisation". 

2. Dans la fenêtre qui s'affiche, utilisez les flèches situées sur la droite pour modifier l'ordre d'initialisation des champs.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Evénements optionnels
<a name="evenements_optionnels_ELTTEXTE000307"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Plusieurs événements optionnels peuvent être gérés.
Pour ajouter un événement optionnel :

1. Sélectionnez le champ voulu.

2. Affichez la fenêtre de code de ce champ (touche F2).

3. Cliquez sur le lien "Ajouter d'autres événements à xxx" situé à la fin de la fenêtre de code, après le dernier événement.  <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Traitements_optionnels_WD_OK%20-%20HC%20N%B0001.gif)


4. La totalité des événements optionnels disponibles pour le champ est affichée. 

5. Cochez l'événement optionnel à ajouter et validez. 
	Remarque : Il est possible de sélectionner plusieurs événements optionnels. 

6. L'événement optionnel sélectionné est automatiquement ajouté dans les événements gérés par le champ.




Pour désactiver un événement optionnel, il suffit d'effectuer les mêmes manipulations pour afficher la liste des événements optionnels. Il suffit ensuite de décocher les événements optionnels à supprimer. 
Remarque : Si le code désactivé contient du code WLangage, ce code est automatiquement supprimé.

**Sur une colonne d'un champ Table, il est ainsi possible de gérer**:

- l'utilisation de la loupe pour effectuer une recherche (**événement "A chaque recherche avec la loupe"**). Cet événement est exécuté lors de la recherche (pour chaque caractère saisi) à partir du champ de recherche "loupe".

- le tri des colonnes (**événement "A chaque tri"**). Cet événement est exécuté lorsque l'utilisateur trie la colonne à l'aide des icônes ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IconeCroissant.gif) et ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IconeDecroissant.gif).

- le redimensionnement des colonnes (**événement "Redimensionnement de la colonne"**). Cet événement est exécuté lorsque l'utilisateur redimensionne la colonne. 

- la saisie du filtre par l'utilisateur (**événement "A chaque modification du filtre (saisie dans l'entête par l'utilisateur)"**). Cet événement est exécuté lorsque l'utilisateur saisit une nouvelle condition de filtre, après l'exécution du filtre. Par exemple, si l'utilisateur définit un filtre de type "Contient" et saisit "Fran", le champ Table est filtré suivant la condition, puis l'événement "A chaque modification du filtre" est exécuté. 

- le clic sur le titre de la colonne (**événement "Clic sur le titre de la colonne"**). Cet événement est exécuté lorsque l'utilisateur clique sur le titre de la colonne. 

- le double-clic sur la colonne (**événement "Double clic sur la colonne"**). Cet événement est exécuté lorsque l'utilisateur double-clique sur la colonne. 



<a name="NOTE2_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Code de tri d'une colonne
<a name="code_tri_une_colonne_ELTPARAGRAPHE000231"></a>Lorsque l'utilisateur clique sur le titre d'une colonne d'un champ Table, le code de tri de la colonne est automatiquement appelé.

Pour connaître le sens du tri, il suffit de déclarer un paramètre au début du code de tri.

```wl
// -- A chaque tri de COL_Colonne1 
PROCEDURE Tri(bCroissant)
Trace(bCroissant ? "Tri croissant colonne" SINON "Tri décroissant")
```



