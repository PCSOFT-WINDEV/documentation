


## Etat sur formulaire
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000294"></a>
<a name="formulaire"></a>
L'éditeur d'états offre la possibilité d'imprimer des états sur des formulaires pré-imprimés (fichier image ou fichier PDF). Par exemple, il est possible d'imprimer directement les produits commandés par les clients sur un bon de commande.

**En édition**, le formulaire apparaît en image de fond de l'état : le positionnement des champs pourra être réalisé au millimètre près.

Par exemple : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=EtatFormulaire.gif&type=thumb)


**En exécution**, il est possible d'imprimer ou non l'image du formulaire avec l'état. Par défaut, l'image du formulaire n'est pas imprimée avec l'état.

Par exemple :
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=EtatFormulaireExecution.gif&type=thumb)


**Remarque** : Pour imprimer des états sur des formulaires pré imprimés, il est possible :

- soit de créer un état fiche de type "Formulaire".

- soit d'intégrer un formulaire dans un état existant.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Créer un état de type Formulaire
<a name="creer_etat_type_formulaire_ELTTEXTE000318"></a>


### Création
<a name="creation_ELTPARAGRAPHE000056"></a>Pour créer un état de type "Formulaire" : 

- Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif)
 parmi les boutons d'accès rapide. 

- La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Etat" puis sur "Etat".

- L'assistant de création d'un état se lance. 




Dans l'assistant, sélectionnez "Etat sur formulaire" et validez. Dans cet assistant, il est nécessaire de spécifier :

- la source de données de l'état (fichier de données, requête, ...). Pour plus de détails, consultez [Source de données d'un état](../WDChamp/1011055.md).

- les informations spécifiques au formulaire (voir paragraphe ci-dessous).




**Remarque** : Avant de créer l'état "Formulaire", il est nécessaire de scanner le formulaire à 100% et de l'enregistrer sous forme de fichier image.
Les formats d'images supportés sous Windows sont :

- Bitmap (\*.BMP)

- Graphics Interchange Format (\*.gif)

- Joint Picture Experts Group (\*.jpg ; \*.jpeg)

- Kodak Photo CD (\*.pcd)

- PaintBrush (\*.pcx)

- Adobe Photoshop Format (\*.psd)

- TrueVision TARGA (\*.tga)

- Tagged Image File Format (\*.tif ; \*.tiff)
	Remarque : l'option "tiff mosaïque" de la norme tiff 6.0 n'est pas supportée. Dans ce cas, il est conseillé d'enregistrer l'image à la norme tiff 5.0. 

- Portable Network Graphics (\*.png)

- Windows MetaFiles (\*.emf ; \*.wmf)

- Icônes (\*.ico ; \*.icw)
	Remarques : 

	- Affichage HQ (Haute Qualité) disponible.

	- Gestion des planches au format BMP transparent (32 bits).




- Curseurs (\*.cur)

- Portable Document Format (\*.pdf)

- Scalable Vector Graphics (\*.svg)

- Images WINDEV (générées par l'éditeur d'images, \*.WDPIC).





<a name="NOTE2_2"></a>


### Informations spécifiques au formulaire
<a name="informations_specifiques_formulaire_ELTPARAGRAPHE000087"></a>Les informations spécifiques au formulaire sont les suivantes :

- ***le fichier contenant l'image du formulaire***. La taille de l'état est automatiquement calculée en fonction de la taille de l'image du formulaire. 
	Pour un format A4, la taille d'une image en 75 DPI doit être 595 x 842 pixels. Pour un format A4, la taille d'une image en 150 DPI doit être 1275 x 1753 pixels. 
	Si l'image du formulaire correspond à un fichier PDF contenant plusieurs pages, il est possible :

	- soit d'imprimer toutes les pages du PDF. Un état composé de plusieurs pages est alors créé sous l'éditeur d'états.

	- soit d'indiquer le numéro de la page à utiliser en fond de l'état. L'état imprimera uniquement une page du fichier PDF.




- ***l'impression ou non de l'image du formulaire***. 
	**Remarque** : Si l'image du formulaire est imprimée avec l'état, cette image ne sera pas imprimée au-delà des marges physiques de l'imprimante.

- *** le découpage du formulaire en fonction du nombre d'enregistrements imprimé par page*** :

	- si par exemple, le formulaire contient les caractéristiques d'un seul client, un seul enregistrement doit être imprimé par page. 
			Dans ce cas, l'état créé contient uniquement le bloc *Corps*.

	- si par exemple, le formulaire contient les caractéristiques de plusieurs clients, plusieurs enregistrements doivent être imprimés par page. 
			Dans ce cas, l'état créé contient un bloc *En-tête de page*, un bloc *Corps* et un bloc *Pied de page*. Pour chaque enregistrement imprimé sur la page, le bloc *Corps* sera répété. Pour imprimer correctement l'état, il est nécessaire de modifier la position des champs de l'état et la position de l'image du formulaire dans le bloc *Corps*. 
			Pour plus de détails sur le positionnement de l'image du formulaire dans les différents blocs, consultez le paragraphe Image du formulaire.







<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Intégrer un formulaire dans un état
<a name="integrer_formulaire_dans_etat_ELTTEXTE000379"></a>
Créer si nécessaire le fichier correspondant au formulaire. 
Si vous possédez le formulaire voulu uniquement sous forme papier, il est conseillé de scanner le formulaire à 100% et de l'enregistrer sous forme d'image.

Pour un format A4, la taille d'une image en 75 DPI doit être 595 x 842 pixels.

Pour un format A4, la taille d'une image en 150 DPI doit être 1275 x 1753 pixels.
Les formats d'images supportés sous Windows sont :

- Bitmap (\*.BMP)

- Graphics Interchange Format (\*.gif)

- Joint Picture Experts Group (\*.jpg ; \*.jpeg)

- Kodak Photo CD (\*.pcd)

- PaintBrush (\*.pcx)

- Adobe Photoshop Format (\*.psd)

- TrueVision TARGA (\*.tga)

- Tagged Image File Format (\*.tif ; \*.tiff)
	Remarque : l'option "tiff mosaïque" de la norme tiff 6.0 n'est pas supportée. Dans ce cas, il est conseillé d'enregistrer l'image à la norme tiff 5.0. 

- Portable Network Graphics (\*.png)

- Windows MetaFiles (\*.emf ; \*.wmf)

- Icônes (\*.ico ; \*.icw)
	Remarques : 

	- Affichage HQ (Haute Qualité) disponible.

	- Gestion des planches au format BMP transparent (32 bits).




- Curseurs (\*.cur)

- Portable Document Format (\*.pdf)

- Scalable Vector Graphics (\*.svg)

- Images WINDEV (générées par l'éditeur d'images, \*.WDPIC).





<a name="NOTE3_2"></a>


### Intégrer un formulaire dans un état
<a name="integrer_formulaire_dans_etat_ELTPARAGRAPHE000136"></a>Pour intégrer un formulaire dans un état : 

1. Affichez l'onglet "Fond" de la description de l'état (option "Description de l'état" dans le menu contextuel de l'état).

2. Sélectionnez l'image du formulaire ou le fichier PDF correspondant au formulaire.

3. Si le formulaire est un fichier PDF contenant plusieurs pages, indiquez :

	- si toutes les pages du PDF doivent être imprimées. L'éditeur d'états affichera alors toutes les pages du PDF. Les champs nécessaires à l'état pourront être positionnés sur les différentes pages de l'état sous l'éditeur.

	- la page contenant le formulaire à utiliser. Ce numéro de page peut être modifié par programmation grâce à la propriété [NuméroPage](../Proprietes/2510106.md). L'état affiché sous l'éditeur d'états ne contiendra qu'une seule page.




4. Spécifiez si l'image du formulaire doit être imprimée ou non en même temps que l'état.

	- Si l'image du formulaire est imprimée avec l'état, cette image ne sera pas imprimée au-delà des marges physiques de l'imprimante. Pour imprimer totalement l'image du formulaire, il est conseillé de cocher l'option "Ignorer les marges physiques de l'imprimante".

	- Si l'image du formulaire ne doit pas être imprimée avec l'état (cas d'une impression sur un papier pré-imprimé par exemple), l'option "Ignorer les marges physiques de l'imprimante" ne doit pas être sélectionnée. Dans le cas contraire, les champs imprimés seront décalés par rapport au formulaire pré-imprimé.







<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Notes
<a name="notes_ELTTEXTE000440"></a>


### Image du formulaire
<a name="image_formulaire_ELTPARAGRAPHE000159"></a>L'image du formulaire apparaît en fond de l'état. L'image est affichée en fond de chacun des blocs de l'état.

Si plusieurs blocs sont présents dans la page, il est possible de positionner correctement l'image dans chacun des blocs.

Pour déplacer l'image du formulaire affichée dans chaque bloc :

1. Sous le volet "Modification", dans le groupe "Profondeur et alignement", cliquez sur "Déplacer le fond". Le curseur de la souris se transforme en main.

2. Cliquez dans le bloc où l'image du formulaire doit être déplacée.

3. Pour déplacer l'image du formulaire d'un bloc :

	- vers le haut ou vers le bas : maintenez le bouton de la souris enfoncé et déplacez la souris.

	- vers la gauche ou vers la droite : maintenez le bouton de la souris et la touche Maj enfoncés et déplacez la souris.




4. Pour désactiver le mode de déplacement de l'image du formulaire, sous le volet "Modification", dans le groupe "Profondeur et alignement", cliquez à nouveau sur "Déplacer le fond".




**Remarque** : Le curseur de la souris doit être déplacé dans la zone du bloc pour être pris en compte.
<a name="NOTE4_2"></a>


### État multipages (basé sur un fichier PDF)
<a name="etat_multipages_base_sur_fichier_pdf_ELTPARAGRAPHE000204"></a>Si vous avez choisi que l'état affiche toutes les pages d'un fichier PDF, si l'état est basé sur un fichier de données ou une requête, les différentes pages seront imprimées pour chaque enregistrement de la source de données utilisée.

**Attention** : Ce type d'état peut consommer beaucoup de ressources mémoire (notamment en aperçu avant impression).


<a name="NOTE4_3"></a>


### Remarques : Utilisation d'un fichier PDF en fond de page
<a name="remarques_utilisation_fichier_pdf_fond_page_ELTPARAGRAPHE000217"></a>

- L'utilisation d'un fichier PDF en fond de page nécessite le [framework GDI+](../Editeurs/2020007.md).

- Sous l'éditeur, il est conseillé d'utiliser un zoom inférieur ou égal à 100% pour visualiser correctement le fichier PDF utilisé en fond d'état.





<a name="NOTE5_3"></a>


### Proposer une saisie dans un état sur formulaire
<a name="proposer_une_saisie_dans_etat_sur_formulaire_ELTPARAGRAPHE000232"></a>Plusieurs champs peuvent être intégrés dans un état formulaire pour proposer une saisie. L'utilisateur peut ainsi saisir directement des informations dans le visualisateur de rapport (WINDEV) ou dans le PDF généré. Les champs disponibles sont : 

- champ de saisie, 

- champ Interrupteur.

- champ Combo.




Pour plus de détails, consultez [Etats avec saisie](../WDChamp/1011074.md). 


