


## Caractéristiques des champs Table dans une fenêtre
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000474"></a>
Le champ Table permet aussi bien d'afficher et/ou de saisir des informations. Ces informations peuvent provenir d'une source de données, d'une variable WLangage ou elles peuvent également être déterminées par programmation.

Cette page d'aide présente les principales caractéristiques pouvant être définies pour un champ Table présent dans une fenêtre : 

- [Etat initial d'un champ Table](#NOTE2_1). 

- Options d'affichage d'un champ Table. 

	- [Mode de sélection des éléments dans le champ Table](#NOTE4_1). 

	- [Options d'affichage des colonnes](#NOTE4_2). 




- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) [Gérer le remplissage d'un champ Table par programmation](#NOTE5_Remplissage).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) [Afficher le détail d'une ligne dans une fenêtre interne](#NOTE5_FI_Detail_Ligne). 

- [Gestion des ascenseurs d'un champ Table](#NOTE5_1). 

- Options conservées par compatibilité. 

	- [Titres de colonnes mono-lignes](#NOTE6_1).

	- [Gestion du mode compatible 5.5](#NOTE6_2).







Il est également possible de définir la source des données affichée dans le champ. Pour plus de détails, consultez [Contenu d'un champ Table](../WDChamp/9500134.md). 



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Etat initial du champ Table
<a name="etat_initial_champ_table_ELTTEXTE000498"></a>
L'état initial d'un champ Table peut être :<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Champ_Table_Ini_WD.gif)
Cet état initial est défini lors de la création du champ et peut être modifié à tout moment dans l'onglet "UI" de la fenêtre de description du champ Table.

Les différentes possibilités sont les suivantes : 

- **Visible** : Le champ Table sera visible ou non. Cette option peut être modifiée en programmation grâce à la propriété [Visible](../Proprietes/2510138.md).

- **En saisie** : L'utilisateur pourra saisir dans les différentes colonnes du champ si ces colonnes sont en saisie.
	

- **Sélection (sans saisie)** : L'utilisateur ne pourra pas saisir dans les colonnes du champ. Il sera possible de sélectionner une ligne du champ :

	- soit en cliquant sur cette ligne.

	- soit en utilisant la fonction [TableSelectPlus](../WDLang1/3074031.md).
			La ligne sera sélectionnée grâce au bandeau de sélection.
			**Remarque** : La valeur du champ Table correspond à la ligne sélectionnée. A chaque sélection, le code de sélection de ligne est exécuté.




- **Ni saisie, ni sélection** : L'utilisateur ne pourra pas saisir dans les colonnes du champ. Il sera possible de sélectionner une ligne du champ uniquement par programmation grâce à la fonction [TableSelectPlus](../WDLang1/3074031.md). Cette ligne sera sélectionnée grâce au bandeau de sélection. L'utilisateur ne pourra pas modifier la position du bandeau de sélection.
	**Remarque** : La valeur du champ Table correspond à la ligne sélectionnée.
	**Conseil** : Cette option est conseillée lorsqu'il est nécessaire de mettre en valeur une ligne grâce au bandeau de sélection.

- **Grisé** : Le champ Table et ses colonnes seront grisés. L'utilisateur ne pourra pas saisir d'informations dans le champ.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Détail des options d'affichage
<a name="detail_des_options_affichage_ELTTEXTE000522"></a>


### Mode de sélection
<a name="mode_selection_ELTPARAGRAPHE000136"></a>Les modes de sélection déterminent comment les différents éléments d'un champ Table (ligne, colonne, cellule) pourront être sélectionnés aussi bien par l'utilisateur que par programmation. Ce mode de sélection est défini lors de la création du champ. Il peut être modifié à tout moment dans l'onglet "UI" de la fenêtre de description du champ Table.

Les modes de sélection disponibles sont les suivants :<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Champ_Table_ModeSel_WD16.gif)


- **Sans sélection** : Le bandeau de sélection ne sera pas affiché, cependant la ligne, la colonne ou la cellule sélectionnée aura le focus (elle sera entourée de pointillés). Il sera possible de sélectionner une ligne, une colonne ou une cellule par un clic sur cet élément ou par programmation.

- **Sélection simple** : La ligne, la colonne ou la cellule sélectionnée apparaîtra sous le bandeau de sélection. Il sera possible de sélectionner une ligne, une colonne ou une cellule par un clic sur cet élément ou par programmation.

- **Sélection multiple** : Il est possible de sélectionner simultanément plusieurs lignes, colonnes ou cellules du champ Table :

	- grâce à la touche Maj si les lignes, colonnes ou cellules se suivent, et à la touche Ctrl pour si les éléments ne se suivent pas.

	- par programmation.
			Dans ce cas, il y aura autant de bandeaux de sélection que d'éléments sélectionnés.







Remarques : 

- Si vous tentez de réaliser une sélection multiple par programmation alors que le mode de sélection est "Sélection simple", une erreur du WLangage sera affichée.

- Lors d'une sélection multiple par cellule, pour sélectionner une ligne, il est nécessaire de sélectionner toutes les cellules de la ligne. Pour simplifier cette opération, il est possible d'afficher un sélecteur de ligne (onglet "Style", élément "Sélecteur de ligne", option "Sélecteur" correspondant à "Flèche à gauche"). 




La récupération des éléments sélectionnés se fera : 

- avec la fonction [TableSelect](../WDLang1/3074020.md). Les constantes *tsLigne*, *tsColonne*, *tsLigneCellule* et *tsColonneCellule* permettent de récupérer respectivement les informations sur les lignes, les colonnes et les cellules sélectionnées. 

- avec la fonction [TableSelectOccurrence](../WDLang1/3074030.md). Les constantes *tsLigne*, *tsColonne* et *tsCellule* permettent de récupérer respectivement le nombre de lignes, colonnes et cellules sélectionnées. 




Exemple : L'exemple suivant permet de récupérer le numéro de la ligne et celui de la colonne des cellules sélectionnées dans le champ Table.  


```wl
// Récupération du nombre de cellules sélectionnées 
NbSelectionne est un entier 
NbSelectionne = TableSelectOccurrence(TABLE_StatsFiliales, tsCellule) 
// Parcours des cellules sélectionnées 
POUR i = 1 _A_ NbSelectionne 
	// Récupération de la ligne et de la colonne 
	nLigne = TableSelect(TABLE_StatsFiliales, i, tsLigneCellule) 
	nColonne = TableSelect(TABLE_StatsFiliales, i, tsColonneCellule) 
	// Traitement 
	... 
FIN
```

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seul le mode de sélection des lignes est disponible.
<a name="NOTE4_2"></a>


### Options d'affichage des colonnes
<a name="options_affichage_des_colonnes_ELTPARAGRAPHE000179"></a>De nombreuses options sont disponibles pour paramétrer l'affichage des colonnes. Ces options sont disponibles dans l'onglet "Détail" de la fenêtre de description du champ Table. 
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Champ_table_TitreCol19.gif)


Ces options sont les suivantes : 

- **Mémoriser la config. des colonnes** : Cette option permet de mémoriser la configuration des colonnes (taille, ordre, etc.) à la fermeture de la fenêtre ou de l'application. 

- **Menu 'Sélectionner les colonnes...'** : Cette option permet d'afficher un menu contextuel afin que l'utilisateur puisse sélectionner les colonnes à afficher ou a masquer dans le champ Table. 

- **Colonnes texte multilignes** : Cette option permet de rendre les colonnes de texte multilignes. Ainsi, le texte est entièrement affiché dans la cellule s'il ne peut pas entrer dans la colonne. 

- **Nb. max. de lignes affichées dans une ligne** : Dans la ligne d'un champ Table, il est possible d'afficher plusieurs lignes. Cette option permet de fixer le nombre de lignes affichées (évite par exemple d'avoir une cellule qui comporte 20 lignes, et qui augmente ainsi de manière démesurée la hauteur de la ligne). 

- **Nombre de colonnes fixées à gauche** : Cette option permet d'indiquer le nombre de colonnes fixées à gauche. Ces colonnes seront "collées" au côté gauche du champ et ne pourront pas être déplacées. L'ascenseur horizontal du champ ne permettra pas de déplacer ces colonnes. 
	L'utilisateur peut également fixer ou "défixer" les colonnes via le curseur "Verrou" ou via l'option "Colonne fixée" du menu contextuel du titre de la colonne. Pour plus de détails, consultez [Fixer les colonnes des champs Table](../WDChamp/9500109.md).
	Il est également possible de fixer une colonne par programmation grâce à la fonction [TableFixeColonne](../WDLang1/3074014.md). 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Angle du titre des colonnes** : Pour les colonnes ayant un titre important et un contenu de taille réduite, il est possible de réduire la taille des colonnes en inclinant le titre des colonnes (ou par exemple en le passant directement à la verticale). Il suffit d'indiquer l'angle voulu dans l'onglet "Détail" de la description du champ Table. Cette option est modifiable par programmation grâce à la propriété [AngleTitre](../Proprietes/1000019371.md).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Éditer les sur-entêtes de colonnes** : Il est possible de définir des sur-entêtes de colonnes. Un sur-entête de colonnes est un titre supplémentaire affiché au-dessus du titre d'une ou plusieurs colonnes. Pour plus de détails, consultez [Gestion des titres des colonnes dans un champ Table](../WDChamp/1013330.md). 




Remarque : Par défaut, les titres des colonnes sont multilignes. La hauteur de l'entête est automatiquement ajustée au nombre de lignes. Les titres de colonnes supportent le RTF.

<a name="NOTE5_Remplissage"></a>
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

## Gérer le remplissage d'un champ Table par programmation
<a name="gerer_remplissage_champ_table_par_programmation_ELTTEXTE000552"></a>
Pendant le remplissage d'un champ Table par programmation, il est possible d'afficher des informations spécifiques : 

- Jauge de progression, 

- Fenêtre d'information, ...




Pour afficher une information pendant le remplissage d'un champ Table/Table hiérarchique par programmation : 

1. Affichez la fenêtre de description du champ Table ou Table hiérarchique. 

2. Dans l'onglet "UI" de la fenêtre de description du champ, cochez l'option "Afficher une Fenêtre interne par dessus les lignes".

3. Spécifiez si nécessaire la fenêtre interne à utiliser. Il est possible de : 

	- utiliser la fenêtre proposée par défaut par WINDEV (option "Aucune"). 

	- importer dans le projet la fenêtre prédéfinie proposée par WINDEV pour la personnaliser (option "Fenêtre prédéfinie"). 
			Si cette option est sélectionnée, le composant interne WDFAA est immédiatement ajouté dans le projet en cours. La fenêtre interne "FI_EtatChargementTable" est automatiquement associée à l'option "Afficher une Fenêtre interne par dessus les lignes". 
			Remarque : Si le composant WDFAA existe déjà, seule la fenêtre est ajoutée au composant.  




4. Validez si nécessaire la fenêtre de description du champ. 

5. Pour activer ce mécanisme, utilisez les fonctions [TableDébutRemplissage](../WDLang1/1000022368.md) et [TableFinRemplissage](../WDLang1/1000022369.md) pour entourer le code de remplissage du champ Table. 




Remarques : 

- Par défaut, le message "Aucune donnée disponible" est affiché dans le champ Table vide. Lors du remplissage, une jauge infinie est affichée en bas du champ Table. 

- La fenêtre interne proposée par défaut contient 3 plans : 

	- Plan 1 contenant une jauge infinie.

	- Plan 2 contenant le libellé affiché si le champ Table est vide. Le libellé affiché par défaut est "Aucune donnée disponible". 

	- Plan 3 contenant le libellé affiché avant l'appel de la fonction [TableDébutRemplissage](../WDLang1/1000022368.md). 




- La fenêtre interne "FI_EtatChargementTable" est également utilisée pour gérer le remplissage des champs Zone répétée par programmation. 




<a name="NOTE5_FI_Detail_Ligne"></a>
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

## Afficher le détail d'une ligne dans une fenêtre interne
<a name="afficher_detail_une_ligne_dans_une_fenetre_interne_ELTTEXTE000576"></a>
Une ligne de table affiche un certain nombre d'information dans ses différentes colonnes. Mais pour obtenir une interface plus lisible, pourquoi ne pas afficher ces informations dans une fenêtre popup ? 

**Pour afficher une fenêtre correspondant au détail d'une ligne d'un champ Table/Table hiérarchique** : 

1. Affichez la fenêtre de description du champ Table ou Table hiérarchique. 

2. Dans l'onglet "UI" de la fenêtre de description du champ, dans la zone "Fenêtre interne de détails d'une ligne", indiquez : 

	- la fenêtre interne à utiliser pour afficher le détail d'une ligne. Cette fenêtre interne est une fenêtre interne de votre projet. 

	- le retrait gauche de la fenêtre interne (par rapport au champ). 

	- si la fenêtre interne doit être affichée également lors du survol de la ligne. Dans ce cas, la fenêtre interne sera affichée après 1 seconde de survol. 




3. Validez la fenêtre de description. 

4. Un signe "+" apparaît dans la première colonne du champ Table/Table hiérarchique. 




**En exécution** : 

- Un signe "+" / "-" permet à l'utilisateur de afficher/refermer le détail de la ligne. Il est possible de personnaliser cet élément via le style de la table (onglet "Style", élément "Image +/- FI de détails de ligne"). 

- La ligne est agrandie en hauteur pour afficher la fenêtre interne. La fenêtre interne est affichée en dessous des données de la ligne.




**Caractéristiques de la fenêtre interne** : 

- Pour obtenir des informations sur le champ Table/Table hiérarchique affichant le détail, la fenêtre interne utilisée doit utiliser le prototype suivant : 
	
	```txt
	PROCEDURE <Nom de la fenêtre interne>(<Table parente>, <Numéro de la ligne>)
	```
où : 

	- Table parente : correspond au nom du champ Table ou Table hiérarchique qui a affiché la fenêtre interne. 

	- Numéro de la ligne : correspond au numéro de la ligne qui a affiché la fenêtre interne. 


 Ces paramètres sont renseignés automatiquement lors de l'exécution. 

- La fenêtre interne peut contenir tout type de champs (y compris un champ Table). 

- La fenêtre interne peut permettre de modifier les informations affichées dans le champ Table. Dans ce cas, il est possible d'utiliser un bouton dans la fenêtre interne permettant de valider les données modifies. Le code de ce bouton peut être : 
	
	```wl
	EcranVersFichier()
	HEnregistre()
	TableAffiche(NomTable,taCourantBandeau)
	TableEnroule(NomTable)
	```


- Dans la fenêtre interne, il est possible d'accéder aux champs de la table parente. Par exemple, pour accéder à un champ présent dans une colonne conteneur : 
	
	```wl
	gCTable[gnNumLigne].BTN_Modifier.Etat = Grisé
	```


- Les champs de la fenêtre interne peuvent être ancrés : le redimensionnement de la table en largeur, ou le redimensionnement de la ligne en cours en hauteur agit sur ces ancrages. 

- Les libellés des champs dans la fenêtre interne peuvent avoir la couleur "Texte" pour adapter la couleur de ces libellés en sélection de ligne. 




**Remarques** : 

- Pour afficher/refermer la fenêtre interne par programmation, utilisez les fonctions [TableDéroule](../WDLang1/1000010007.md)/[TableEnroule](../WDLang1/1000010008.md). 

- La hauteur de la ligne affichant la fenêtre interne correspond à la hauteur initiale de la ligne plus celle de la fenêtre interne en édition (propriété [HauteurInitiale](../Proprietes/2510043.md)).

- L'image de fond définie pour la ligne est agrandie pour correspondre à la taille de la ligne déroulée. 

- Diverses propriétés permettent de manipuler les caractéristiques de la fenêtre interne par programmation : 
	


|   |   |
| --- | --- |
| [FenêtreDétailLigne](../Proprietes/1000022372.md) | La propriété **FenêtreDétailLigne** permet de connaître et de modifier le nom de la fenêtre interne utilisée pour afficher les détails d'une ligne d'un champ Table. |
| [RetraitDétailLigne](../Proprietes/1000022375.md) | La propriété **RetraitDétailLigne** permet de connaître ou de modifier la valeur du retrait à gauche de la fenêtre interne utilisée pour afficher les détails d'une ligne d'un champ Table. |

- Cas particuliers

	- Cette fonctionnalité n'est pas disponible sur les champs Table horizontale. 

	- L'interface de la fenêtre interne ne peut pas être modifiées par l'utilisateur final. 







<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Ascenseurs dans un champ Table
<a name="ascenseurs_dans_champ_table_ELTTEXTE000616"></a>
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Par défaut, les ascenseurs des champs Table (fichier, par programmation ou sur variable) sont proportionnels. La taille de l'ascenseur est proportionnelle au nombre d'éléments à afficher.

**Attention** : si un filtre est utilisé avec un ascenseur proportionnel, le parcours de la source de données est réalisé en tâche de fond. Le code de fin d'initialisation sera exécuté uniquement lorsque le parcours sera terminé. Selon la source de données à parcourir, ce traitement peut être exécuté relativement longtemps après l'ouverture de la fenêtre.

Les options concernant l'ascenseur sont regroupées dans l'onglet "Détail" de la description du champ Table :<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Champ_Table_Ascenseur.gif)


L'option **"Déplacement au pixel"** permet un déplacement fluide des lignes : au lieu de "sauter" d'une ligne à l'autre, le déplacement est réalisé pixel par pixel : une ligne "multiligne" d'un champ Table peut être tronquée si nécessaire à l'affichage.

Remarque : La désactivation de l'ascenseur proportionnel désactive la multisélection des lignes. 
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) L'option **"Déplacement au doigt"** permet d'indiquer que le champ Table accepte le scrolling au doigt (si le périphérique d'affichage est tactile). Cette option est activée par défaut en WINDEV Mobile sur les nouveaux champs Table créés. Elle est désactivée par défaut en WINDEV.

<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Options conservées par compatibilité avec les anciennes versions
<a name="options_conservees_par_compatibilite_avec_les_anciennes_versions_ELTTEXTE000640"></a>


### Forcer le titre en mono-ligne
<a name="forcer_titre_monoligne_ELTPARAGRAPHE000396"></a>Par défaut, le titre des colonnes d'un champ Table est multiligne. L'option "Forcer le titre en monoligne (8)" permet de retrouver le comportement par défaut de la version 8. 

Sur les champs Table créés avec la version 8 (ou précédente), cette option doit être décochée pour obtenir un titre de colonnes multiligne. 
<a name="NOTE6_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Mode de saisie compatible 5.5
<a name="mode_saisie_compatible_55_ELTPARAGRAPHE000411"></a>Ce mode permet de retrouver le mode d'utilisation des champs Table en version 5.5. Si le champ Table provient d'une application WINDEV 5.5 migrée, cette option est automatiquement cochée. Cette option est disponible dans l'onglet "Détail" de la description du champ Table.

**Cette option ne doit pas être utilisée pour les champs Table créés avec les versions 7 et supérieures de WINDEV**. 

Si vous décochez cette option, toutes les fonctionnalités des champs Table seront accessibles. Pour retrouver le fonctionnement des champs Table en WINDEV 5.5, il sera nécessaire d'adapter le code du champ.

Si vous cochez cette option, deux types de champs Table sont disponibles :

- soit champ Table en saisie sans sélection.

- soit champ Table avec sélection et sans saisie (si aucune colonne n'est en saisie ou si le champ Table est en sélection sans saisie).




**Rappel : en version 5.5, si le champ Table était défini** :

- "en saisie" et si une colonne au moins du champ était en saisie, le bandeau de sélection n'était pas affiché et il était possible de saisir dans le champ Table.

- "en saisie" (ou "inactive") et sans aucune colonne en saisie, l'utilisateur ne pouvait effectuer aucune saisie dans le champ Table mais il pouvait modifier la position du bandeau de sélection.





