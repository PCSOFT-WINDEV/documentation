
## Afficher un état au format PDF dans le navigateur de l'internaute
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000154"></a>
Pour afficher un état au format PDF dans le navigateur de l'internaute, il est nécessaire de :

- générer le fichier PDF sur le serveur Web.

- afficher le fichier généré dans le navigateur de l'internaute. L'affichage du fichier peut être :

	- soit immédiat.

	- soit demandé par l'internaute (clic sur un lien par exemple).




- supprimer le fichier PDF du serveur Web.






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000178"></a>


### Générer un fichier PDF sur le serveur Web
<a name="generer_fichier_pdf_sur_serveur_web_ELTPARAGRAPHE000026"></a>Pour générer un fichier PDF sur le serveur Web :

1. Créez un nom unique pour le fichier PDF à générer. Le répertoire de création de ce fichier doit être accessible en lecture et en écriture (par exemple, le répertoire des fichiers de données ou le répertoire "&lt;MonProjet&gt;_WEB" du site). 
	Pour plus de détails sur la création d'un nom de fichier unique, consultez [Définir un nom unique pour le fichier généré](../WDChamp/1011009.md).

2. Paramétrez la destination de l'impression grâce à la fonction [iDestination](../WDLang5/3046074.md) avec la constante *iPDF*(impression dans un fichier PDF).

3. Précisez le nom de l'état à imprimer dans la fonction [iImprimeEtat](../WDLang5/3046032.md). 
	Le fichier PDF est créé sur le serveur Web.





<a name="NOTE2_2"></a>


### Affichage du fichier PDF
<a name="affichage_fichier_pdf_ELTPARAGRAPHE000051"></a>L'affichage du fichier peut être :

- soit immédiat.

- soit demandé par l'internaute (clic sur un lien par exemple).




**Pour afficher automatiquement le fichier généré dans le navigateur de l'internaute,** il suffit d'utiliser la fonction [FichierAffiche](../WDLang2/3012005.md).

**Pour afficher le fichier généré après demande de l'internaute,** il est par exemple possible :

- soit d'utiliser la fonction [FichierAffiche](../WDLang2/3012005.md).

- soit de modifier l'URL du champ qui affiche le fichier PDF (propriété [URL](../Proprietes/2510132.md) d'un bouton ou d'un lien par exemple).

- ...





<a name="NOTE2_3"></a>


### Suppression du fichier PDF
<a name="suppression_fichier_pdf_ELTPARAGRAPHE000079"></a>Pour limiter l'espace disque occupé par les états au format PDF sur le serveur Web, il est conseillé de supprimer régulièrement les états inutiles. Il est par exemple possible de supprimer immédiatement l'état après affichage ou de créer une procédure effaçant les états réalisés dans la journée.



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Exemple
<a name="exemple_ELTTEXTE000214"></a>
L'état "ETAT_FacturePDF" est un état affiché sur le poste de l'internaute au format PDF.

Le bouton "VisualisationFacture" permet de :

- générer le fichier PDF dans le répertoire "&lt;MonProjet&gt;_WEB" du site.

- visualiser l'état au format PDF.

- supprimer l'état au format PDF après visualisation.




Dans cet exemple, le code de clic serveur du bouton "VisualisationFacture" est le suivant :


```wl
// Générer un nom de fichier PDF unique
UnFichier est une chaîne  
UnFichier = fRepWeb() + "\" + DateSys() + HeureSys() + ".pdf" 
// Paramétrer la destination de l'impression 
iDestination(iPDF, UnFichier) 
// Imprimer l'état ETAT_FacturePDF
iImprimeEtat(ETAT_FacturePDF) 
// Envoyer le fichier dans le navigateur 
FichierAffiche(UnFichier, "application/pdf") 
// Supprimer le fichier 
fSupprime(UnFichier)
```


**Remarque** : Il est possible d'ouvrir le fichier PDF directement à partir d'un bouton ou d'un lien. Il suffit de modifier l'action de ce champ avec la propriété [URL](../Proprietes/2510132.md) :


```wl
// Générer un nom de fichier PDF unique  
UnFichier est une chaîne  
UnFichier = fRepWeb() + "\" + DateSys() + HeureSys() + ".pdf" 
// Paramétrer la destination de l'impression 
iDestination(iPDF, UnFichier) 
// Imprimer l'état ETAT_FacturePDF
iImprimeEtat(ETAT_FacturePDF) 
// Récupération du nom du fichier PDF 
NomFichier est une chaîne  
NomFichier = fExtraitChemin(UnFichier, fFichier + fExtension) 
// Modification de l'action du champ Lien qui ouvrira le fichier PDF 
LIEN_LienPDF.URL = "/" + RépertoireWeb() + "/" + NomFichier
```





