
## Imprimer le contenu d'une table (FAA)
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000149"></a>
Un champ Table propose par défaut un menu contextuel automatique permettant à l'utilisateur de réaliser plusieurs manipulations sur les données affichées dans le champ Table. 

Une des options de ce menu contextuel permet à l'utilisateur d'imprimer le contenu du champ Table (option "Imprimer"). 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Fonctionnement
<a name="fonctionnement_ELTTEXTE000173"></a>


### Principe
<a name="principe_ELTPARAGRAPHE000018"></a>Plusieurs cas peuvent se présenter :

- Si un état a été créé par le développeur sur ce champ Table, cet état est imprimé.

- Si aucun état n'est lié à ce champ Table, l'utilisateur peut au choix :

	- imprimer directement le contenu du champ Table.

	- lancer le logiciel "Etats & Requêtes" (si ce logiciel est installé sur le poste de l'utilisateur). 







**Différences entre l'exécution et le mode test** : En mode test, l'option "Imprimer" propose d'imprimer directement ou de créer un état sur table. Cet état sera automatiquement lié au champ Table et sera proposé par défaut à l'utilisateur.

**Remarques** : 

- L'option "Imprimer" du menu contextuel du champ Table nécessite les librairies d'impression du framework WINDEV.

- En programmation, la fonction [FAADésactive](../WDLang1/1000022018.md) utilisée avec la constante *faaImprimeEtatSurTable* supprime l'option "Imprimer" pour le champ Table spécifié.





### Impression de l'état créé par le développeur
<a name="impression_etat_cree_par_developpeur_ELTPARAGRAPHE000039"></a>Si le développeur a créé un état sur le champ Table, l'option "Imprimer" permettra d'imprimer directement cet état. Aucune programmation spécifique n'est nécessaire. 


### Impression directe du contenu du champ Table
<a name="impression_directe_contenu_champ_table_ELTPARAGRAPHE000044"></a>L'impression directe du contenu du champ Table est disponible dans les cas suivants : 

- le développeur n'a pas prévu d'état pour le champ Table. 

- le logiciel "Etats & Requêtes" n'est pas installé sur le poste de l'utilisateur, 

- l'application ne permet pas le lancement du logiciel "Etats & Requêtes". 




Le contenu du champ Table est directement visualisé dans le visualisateur de rapports.

Si le nombre de lignes du champ Table est trop important (plus de 10 000 lignes), l'application demande confirmation à l'utilisateur (l'impression pouvant être relativement longue et consommatrice de ressources mémoire).

Si nécessaire, l'application : 

- propose d'imprimer en mode paysage, <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=FAA_Imprimer_Table_portrait.gif)


- informe que toutes les colonnes ne pourront pas être imprimées sur une même page. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=FAA_Imprimer_Table_grand.gif)
Dans ce dernier cas, l'utilisateur a la possibilité de redimensionner ses colonnes. Si aucun redimensionnement n'est effectué, le contenu du champ Table sera imprimé sur plusieurs pages si nécessaire.  




Les caractéristiques de l'impression proposée sont les suivantes :

- Le titre de l'impression correspond au titre du champ Table. Si aucun titre n'a été spécifié pour le champ, le texte "Etat sur table (FAA)" est imprimé.

- Les titres des colonnes sont imprimés sur chaque page.

- L'impression respecte les couleurs de fond utilisées pour les différentes cellules du champ Table.

- L'impression ne respecte pas les caractéristiques RTF des textes présents dans le champ Table.  

- Les compteurs, totaux, ... définis pour le champ Table ne sont pas imprimés. Seul un compteur des lignes du champ est imprimé en dessous du champ Table. Le libellé correspond au libellé défini pour le compteur sous l'éditeur de fenêtres.

- La date du jour est imprimée en haut à droite.

- Le numéro de la page courante et le nombre total de pages sont imprimés en bas à droite.

- La fusion horizontale des colonnes est respectée, sauf dans les cas suivants :

	- fusion avec une colonne invisible

	- fusion de colonnes se trouvant "à cheval" sur 2 pages.




- Les images présentes dans les champs Table sont imprimées uniquement si leur chemin est précisé. Les images présentes dans des mémos ne sont pas imprimées.

- L'impression réalisée prend en compte le sens d'écriture spécifié avec la propriété [SensEcriture](../Proprietes/2513020.md) au niveau de la fenêtre et/ou au niveau du champ Table.

- Les colonnes définies comme non exportables et non imprimables ne seront pas imprimées (propriété [VisibleEnExportEtImpression](../Proprietes/1000022320.md) ou option "Export et impression" dans l'onglet "Général" de la fenêtre de description de la colonne).





### Impression depuis le logiciel "Etats & Requêtes"
<a name="impression_depuis_logiciel_etats_requetes_ELTPARAGRAPHE000090"></a>Le logiciel "Etats & Requêtes" est automatiquement lancé. L'état est alors automatiquement créé dans le logiciel "Etats & Requêtes". L'utilisateur peut le mettre en forme selon ses besoins. Il suffit d'enregistrer l'état pour que celui-ci soit lié à la table et puisse être imprimé.

Si le développeur crée un état spécifique pour le champ Table dans une prochaine version, l'état créé par l'utilisateur sera l'état pris en compte à l'exécution.

Si le logiciel "Etats & Requêtes" n'est pas installé sur le poste de l'utilisateur, l'utilisateur peut l'installer automatiquement.

***Caractéristiques de l'état créé*** :

- L'état créé est un état de type "Etat sur Table".  

- Si l'état est automatiquement créé dans le logiciel "Etats & Requêtes", la fusion des colonnes est ignorée.







