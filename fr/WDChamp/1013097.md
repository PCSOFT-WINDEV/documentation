


## Alignement des éléments dans un champ Liste ou Combo (syntaxe préfixée)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000117"></a>
Les éléments d'un champ Combo (ou d'un champ Liste) peuvent être alignés selon différentes méthodes :

- Pour le texte :

	- Alignement des éléments par TAB. Il est possible de cadrer les éléments à gauche et à droite.

	- Alignement avec des espaces (méthode fonctionnant uniquement avec des polices non proportionnelles).




- Pour les numériques : Alignement des nombres sur le séparateur décimal.

- Pour les champs Combo avec saisie.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Les différentes méthodes d'alignement du texte
<a name="les_differentes_methodes_alignement_texte_ELTTEXTE000150"></a>


### Alignement des éléments grâce au caractère TAB
<a name="alignement_des_elements_grace_caractere_tab_ELTPARAGRAPHE000173"></a>Pour aligner chaque élément d'un champ Liste ou Combo, la solution la plus simple est d' **utiliser le caractère de contrôle TAB**. 


|   |   |
| --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Liste2.gif)<br> | <br><pre><code>// Le premier est complété pour réserver la taille<br>LISTE_LISTE2.Ajoute(Complète("MALTESE", 8) + TAB + "Corto")<br>LISTE_LISTE2.Ajoute("PICSOU" + TAB + "Jean")<br>LISTE_LISTE2.Ajoute("ANA" + TAB + "Yoko")</code></pre><br> |


<a name="NOTE2_1a"></a>
Avec le caractère TAB, la largeur de chaque élément est calculée en prenant comme référence le caractère "E". La largeur de référence est multipliée par le nombre de caractères de chacun des éléments.

**Important** : Le premier appel à la fonction [&lt;Liste&gt;.Ajoute](../WDLang1/1000017319.md) fixe les positions des tabulations pour la totalité du champ Liste et pour les autres champs Liste de la fenêtre. Ainsi, dès le premier [&lt;Liste&gt;.Ajoute](../WDLang1/1000017319.md), il faut penser à réserver une "place suffisante" pour les autres éléments du champ. Par exemple, si vous savez que le plus grand élément affiché dans le champ contiendra 20 lettres, vous pouvez fixer la taille grâce à la fonction [&lt;Type Chaîne Ansi&gt;.Complète](../WDLang1/1410089823.md).
<a name="NOTE2_2"></a>


### Cadrage des éléments à droite ou à gauche
<a name="cadrage_des_elements_droite_gauche_ELTPARAGRAPHE000218"></a>Par défaut, le texte des éléments est cadré à gauche. En effet, l'utilisation du caractère TAB permet d'aligner le texte des éléments sur la gauche.

Pour cadrer un élément à droite, il suffit d'utiliser le caractère EOT (avant le texte à afficher dans le champ Liste).

Quelle que soit la largeur du champ, les éléments utilisant le caractère EOT seront cadrés à droite.


|   |   |
| --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Liste3.gif)<br> | <br><pre><code>// Le premier est complété pour réserver la taille<br>LISTE_LISTE3.Ajoute(EOT + Complète("MALTESE", 8) + ...<br>	TAB + EOT + "Corto")<br>LISTE_LISTE3.Ajoute(EOT + "PICSOU" + TAB + EOT + "Jean")<br>LISTE_LISTE3.Ajoute(EOT + "ANA" + TAB + EOT + "Yoko")</code></pre><br> |


<a name="NOTE2_3"></a>


### Récupération des éléments d'un champ Liste
<a name="recuperation_des_elements_champ_liste_ELTPARAGRAPHE000242"></a>Lors de la récupération d'un élément d'un champ Liste, la ligne entière est retournée, y compris les éventuels caractères EOT et TAB.

Par exemple pour le champ Liste précédent, la fonction ci-dessous récupère le premier élément : 

```wl
Ligne = LISTE_Liste4[1]
```
La variable Ligne contient le texte : &lt;EOT&gt;MALTESE &lt;TAB&gt;&lt;EOT&gt;Corto

Ainsi, il ne faut pas oublier d'extraire, si nécessaire, les caractères EOT et TAB.
<a name="NOTE2_4"></a>


### Alignement avec des espaces (méthode utilisable uniquement avec des polices non proportionnelles)
<a name="alignement_avec_des_espaces_methode_utilisable_uniquement_avec_des_polices_non_proportionnelles_ELTPARAGRAPHE000258"></a>Dans les champs Liste comportant plusieurs éléments sur une même ligne, l'utilisation de polices de largeur variable rend souvent difficile l'alignement des éléments.

Par exemple, si le champ Liste utilise la police "Arial" et si elle comporte deux éléments, le code suivant affichera le champ Liste sous la forme ci-dessous (éléments non alignés) :


|   |   |
| --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Liste01.gif)<br> | <br><pre><code>LISTE_LISTE1.Ajoute(Complète("MALTESE", 8) + "Corto")<br>LISTE_LISTE1.Ajoute(Complète("PICSOU", 8) + "Jean")<br>LISTE_LISTE1.Ajoute(Complète("ANA", 8) + "Yoko")</code></pre><br> |


<a name="NOTE2_5"></a>
Bien que le texte soit complété à 8 caractères pour le premier élément, le second élément ne sera pas aligné.

En effet pour les polices proportionnelles, chaque caractère a une largeur qui lui est propre. Pour ces polices, l'alignement avec des espaces ne peut pas être utilisé.

Il peut toutefois être utilisé avec des polices non proportionnelles telles que "Courier".

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Alignement des numériques
<a name="alignement_des_numeriques_ELTTEXTE000287"></a>


### Alignement des numériques
<a name="alignement_des_numeriques_ELTPARAGRAPHE000310"></a>L'alignement des numériques est réalisé de la même façon que l'alignement du texte (voir paragraphe précédent). Il est cependant possible d'effectuer également un alignement des nombres sur le séparateur décimal.
<a name="NOTE3_2"></a>


### Alignement des nombres sur le séparateur décimal
<a name="alignement_des_nombres_sur_separateur_decimal_ELTPARAGRAPHE000320"></a>Pour aligner les nombres sur le séparateur décimal, il faut combiner l'utilisation des caractères TAB et EOT :

- la partie entière est cadrée à droite.

- la partie décimale (y compris le séparateur) est cadrée à gauche.




Comme nous l'avons déjà précisé, le premier appel à [&lt;Liste&gt;.Ajoute](../WDLang1/1000017319.md) détermine la largeur des éléments. Ainsi, il ne faut pas oublier de réserver la largeur des éléments lors de l'ajout de la première ligne dans le champ.


|   |   |
| --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Liste4.gif)<br> | <br><pre><code>LISTE_LISTE4.Ajoute(Complète("FRANCE", 7) + TAB + EOT + ...<br>	"  30" + TAB + ",00")<br>LISTE_LISTE4.Ajoute("CANADA" + TAB + EOT + "10" + TAB + ",00")<br>LISTE_LISTE4.Ajoute("SUISSE" + TAB + EOT + "246")</code></pre><br> |


<a name="NOTE3_3"></a>


### Récupération du contenu du champ Liste
<a name="recuperation_contenu_champ_liste_ELTPARAGRAPHE000350"></a>Lors de la récupération d'un élément d'un champ Liste, la ligne entière est retournée, y compris les éventuels caractères EOT et TAB.


Par exemple pour le champ précédent, la fonction ci-dessous récupère le premier élément du champ Liste : 

```wl
Ligne = LISTE_Liste4[1]
```
La variable Ligne contient le texte : "France " + TAB + EOT + " 30" + TAB + ",00"

Ainsi, il ne faut pas oublier d'extraire, si nécessaire, les caractères EOT et TAB.

<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Alignement dans les champs Combo avec saisie
<a name="alignement_dans_les_champs_combo_avec_saisie_ELTTEXTE000361"></a>
Toutes les méthodes d'alignement présentées précédemment sont disponibles dans les champs Combo avec ou sans saisie.

Cependant, si les caractères EOT et TAB sont utilisés pour aligner les éléments d'un champ Combo avec saisie, la valeur affichée dans le champ lors de la sélection de l'élément contient des caractères d'alignement.


|   |   |
| --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Liste5.gif)<br> | Il faut dans ce cas :<br><br>- soit utiliser une police de largeur fixe (de type "Courier") et aligner les éléments par des espaces sans utiliser les caractères TAB et EOT (cette solution est conseillée car plus simple).<br><br>- soit extraire les caractères EOT et TAB de l'élément sélectionné. Pour cela, il faut inclure le traitement adéquat dans l'événement "A chaque modification" du champ.<br><br><br> |

Dans ce cas, un élément ne peut pas être sélectionné dans le champ Combo avec le clavier, mais uniquement avec la souris.

**Pour un champ Combo dont les éléments ont été ajoutés selon le format suivant** :

```wl
ListeAjoute(LISTE_LISTE5, texte2 + TAB + EOT + "10" + TAB + ",00")
```

**Le traitement d'extraction de TAB et EOT est le suivant** :

```wl
// -- Sélection d'une ligne du champ Combo
// Extraction des caractères TAB 
Ch est une chaîne
Ch = MoiMême
// "FRANCE"+TAB+eot+30+tab+,00
Col1 est une chaîne = ExtraitChaîne(Ch, 1) // France
Col2 est une chaîne = ExtraitChaîne(Ch, 2) // eot+30
Col3 est une chaîne = ExtraitChaîne(Ch, 3) // ,00
// Extraction du caractère EOT
Col2 = ExtraitChaîne(Col2, 2, EOT) //30

MoiMême = SansEspace(Col1) + " " + SansEspace(Col2) + SansEspace(Col3)
```
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Liste6.gif)



