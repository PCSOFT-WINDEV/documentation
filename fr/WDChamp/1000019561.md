


## Menu contextuel automatique des champs Planning
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000242"></a>
Chaque champ Planning présent dans une fenêtre propose par défaut un menu à l'utilisateur.

Ce menu, disponible sans programmation, permet des actions utiles :

- Annuler ou refaire une action.

- Choix du mode d'affichage du planning : Jour, Semaine entière, Semaine de travail, Mois.

- Affichage des éléments pour aujourd'hui.

- Gestion des rendez-vous : Ajout, suppression, modification.

- Copie du contenu du rendez-vous.

- Impression du planning.

- Envoi du planning par email. 




Les actions effectuées dans le champ Planning peuvent être : 

- annulées via l'option "Annuler" du menu contextuel ou la combinaison de touches Ctrl + Z. 

- refaites via l'option "Refaire" du menu contextuel ou la combinaison de touches Ctrl + Y.


Ces actions correspondent notamment au déplacement, redimensionnement, suppression, ... de rendez-vous.

**Remarque** : Il est possible d'ajouter des choix à ce menu par programmation. Il suffit d'utiliser la propriété [MenuContextuel](../Proprietes/2510077.md).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Paramétrage
<a name="parametrage_ELTTEXTE000266"></a>


### Paramétrage du menu automatique dans un champ Planning
<a name="parametrage_menu_automatique_dans_champ_planning_ELTPARAGRAPHE000046"></a>Le menu contextuel du champ Planning peut bien évidemment être désactivé. Pour paramétrer l'affichage du menu contextuel du champ Planning, vous devez :

1. Afficher la fenêtre de description du champ Planning.

2. Sélectionner l'onglet "UI".

3. Choisir le menu désiré dans la combo "Menu contextuel". Il est possible de : 

	- "Afficher le menu des FAA (Système)" : Dans ce cas, le menu contextuel affiché sera le menu automatique du champ Planning. Pour plus de détails sur la configuration de ce menu, consultez [Configurer le menu des FAA](../Editeurs/2010040.md).

	- "Ajouter un menu contextuel" : Si cette option est cochée, vous pouvez sélectionner le menu contextuel personnalisé à afficher. ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=FAA_Menu_Agenda.gif)








Remarques : 

- Si les deux options sont cochées, le menu contextuel personnalisé peut être ajouté avant ou après le menu des FAA. 

- Si aucune option n'est sélectionnée, aucun menu contextuel ne sera sélectionné. L'option &lt;Désactivé&gt; sera affichée dans la fenêtre de description. 

- La propriété [MenuContextuel](../Proprietes/2510077.md) permet également de supprimer le menu contextuel spécifique aux FAA et de retrouver le menu Windows classique pour un champ spécifique.

- Par programmation, la fonction [FAADésactive](../WDLang1/1000022018.md) permet de supprimer certaines options du menu contextuel des FAA spécifiques aux champs Planning. Différentes constantes peuvent être utilisées selon l'option à désactiver : 

	- *faaImprimerPlanning* : permet de supprimer l'option d'impression du Planning. Attention, cette constante peut également supprimer l'option d'impression proposée par les champs Agenda.  

	- *faaEnvoyerFichierEmail* : permet de supprimer l'option permettant d'envoyer le planning par email. Attention, cette constante peut également supprimer l'option d'envoi par email proposée par les champs Agenda et les champs de saisie de type chemin.







<a name="NOTE3"></a>


## Détail des options
<a name="detail_des_options_ELTTEXTE000290"></a>
<a name="NOTE3_1"></a>


### Option "Imprimer"
<a name="option_imprimer_ELTPARAGRAPHE000098"></a>L'option "Imprimer" permet d'imprimer le contenu du champ Planning. Une fenêtre spécifique s'affiche permettant de configurer l'impression du planning. ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=FAA_Imp_Planning.gif)


Cette fenêtre permet de configurer : 

- l'orientation de l'état.

- la durée par page : jour, semaine, mois, ...

- la période à imprimer (plage de dates prises en compte). 




**Remarque** : Selon les options spécifiées pour la durée et la période, l'impression du planning peut être plus ou moins lisible et être réalisée sur plusieurs pages. Par exemple, un planning imprimé à la journée sur une semaine imprimera 1 page par jour. 

Le bouton "Imprimer" permet de lancer l'impression. 

Le contenu du champ Planning est directement visualisé dans le visualisateur de rapports.

Quelle que soit l'orientation choisie, le contenu du champ Planning est imprimé dans son intégralité entre les bornes spécifiées.   

Les caractéristiques de l'impression proposée sont les suivantes :

- Le titre de l'impression correspond au libellé du champ Planning. Si aucun libellé n'a été spécifié pour le champ Planning, l'état n'affiche aucun titre.

- L'impression respecte les couleurs utilisées dans le champ Planning.

- La date du jour est imprimée en bas à gauche.

- Le numéro de la page courante et le nombre total de pages sont imprimés en bas à droite.

- L'impression réalisée prend en compte le sens d'écriture spécifié avec la propriété [SensEcriture](../Proprietes/2513020.md) au niveau de la fenêtre et/ou au niveau du champ Planning.




**Remarques** : 

- L'option "Imprimer" du menu contextuel des champs Planning nécessite la livraison des librairies d'impression du framework WINDEV avec l'exécutable.

- Pour ne pas proposer l'option "Imprimer" dans le menu contextuel du champ Planning, utilisez la fonction [FAADésactive](../WDLang1/1000022018.md) avec la constante ***faaImprimerPlanning***.

- Pour personnaliser l'état associé à un champ Planning spécifique, il faut créer un nouvel état de type planning basé sur ce champ Planning. Il sera automatiquement associé au champ Planning et imprimé par l'option "Imprimer".



<a name="NOTE3_2"></a>


### Personnaliser la fenêtre de paramétrage de l'impression du planning (disponible à partir de la version 170078)
<a name="personnaliser_fenetre_parametrage_impression_planning_disponible_partir_version_170078_ELTPARAGRAPHE000140"></a>WINDEV offre la possibilité d'intégrer la fenêtre de configuration de l'impression du planning utilisée par la FAA dans votre application. Il est ainsi possible de personnaliser par exemple :

- l'apparence de cette fenêtre (modification du gabarit par exemple)

- les langues gérées par cette fenêtre. Cette possibilité est très intéressante pour traduire cette fenêtre dans les différentes langues proposées par l'application.  




**Pour intégrer la fenêtre de paramétrage de l'impression du planning dans votre application** : 

1. Sous le volet "Projet", dans le groupe "Projet", déroulez "Importer" et sélectionnez "Des éléments WINDEV et leurs dépendances".

2. Sélectionnez le sous-répertoire contenant les éléments à importer. La fenêtre de configuration de l'impression est présente dans le sous-répertoire "Programmes\\Donnees\\Fenêtres prédéfinies\\FAA" du répertoire d'installation de WINDEV.

3. WINDEV liste les éléments présents dans le répertoire. Ce répertoire contient les différents éléments correspondant aux FAA personnalisables. La fenêtre à importer est "WinDevFaa_ParamImpressionPlanningAgenda.wdw".

4. Validez. La fenêtre est intégrée au projet et peut être modifiée. Cette fenêtre personnalisée sera automatiquement prise en compte lors de l'exécution de l'application.




Remarques :

- La fenêtre ne doit pas être renommée.

- Si vous intégrez cette fenêtre dans votre application, vous risquez de ne pas profiter des améliorations de cette fenêtre effectuées au cours des mises à jour. Pensez à vérifier si cette fenêtre n'évolue pas.

- Attention : Pour modifier cette fenêtre, le fichier correspondant ne doit pas être en lecture seule. Modifiez les caractéristiques du fichier sous Windows si nécessaire. 

- Si vous utilisez dans votre projet un champ Agenda, la FAA d'impression du champ Agenda utilisera également cette fenêtre. 



<a name="NOTE3_3"></a>


### Option "Envoyer par email"
<a name="option_envoyer_par_email_ELTPARAGRAPHE000178"></a>L'option "Envoyer par email" permet : 

- d'imprimer le contenu du champ Planning dans un fichier "Planning.pdf". 

- de créer un nouveau message dans le logiciel de messagerie configuré par défaut et de joindre à ce message le fichier "Planning.pdf" généré. 




La procédure d'impression de l'agenda dans le fichier PDF est identique à la procédure d'impression réalisée par l'option de menu "Imprimer le planning" (voir paragraphe précédent). 

L'état planning généré n'est pas visualisé dans le visualisateur de rapports mais directement imprimé dans un fichier au format PDF. 

**Remarques** : 

- L'option "Envoyer par email" du menu contextuel des champs Planning nécessite la livraison des librairies du framework WINDEV d'impression et de génération des fichiers PDF avec l'exécutable.

- Pour ne pas proposer l'option "Envoyer par email" dans le menu contextuel du champ Planning, utilisez la fonction [FAADésactive](../WDLang1/1000022018.md) avec la constante ***faaEnvoyerFichierEmail***. Attention, cette constante peut également supprimer l'option d'envoi par email proposée par les champs Agenda et les champs de saisie de type chemin.





