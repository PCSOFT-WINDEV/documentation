


## Etat sur un champ Planning
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000257"></a>
L'état sur un champ Planning permet d'imprimer directement les informations affichées dans un champ Planning présent :

- dans une fenêtre ou une page de l'application. Cette fenêtre ou page doit être affichée lors de l'impression de l'état.

- dans une fenêtre interne ou une page interne : 

	- La fenêtre affichant la fenêtre interne doit être affichée.

	- La page affichant la page interne doit être affichée.







**Remarque** : Seul un état de type Planning peut être créé sur un champ Planning. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Caractéristiques de l'état sur un champ Planning
<a name="caracteristiques_etat_sur_champ_planning_ELTTEXTE000281"></a>
Chaque ligne et chaque colonne du champ Planning sont affichées dans l'état Planning. 

Lors de la création de l'état, il est possible de sélectionner le nombre de jours à afficher et le mode d'affichage des ressources (en ligne ou en colonne). 

Il est possible de créer un état sur un champ Planning depuis l'éditeur d'états : il suffit de sélectionner un état Planning basé sur un champ Planning. 

Lorsque l'état sur un champ Planning est créé, il est possible à tout moment de : 

- modifier la source de données de l'état (onglet "Données" de la description de l'état).

- modifier les caractéristiques du planning (onglet "Général" de la description du Planning). 




**Attention** : Il est impossible de tester un état sur un champ Planning directement depuis l'éditeur d'états, car la fenêtre ou la page contenant le champ Planning doit être ouverte. Pour tester un état sur un champ Planning, il est donc nécessaire de :

- créer un bouton dans la fenêtre ou la page du champ Planning. Ce bouton permet de lancer l'impression de l'état sur le champ Planning (fonction [iImprimeEtat](../WDLang5/3046032.md)). 
	Cas des fenêtres internes : Si le champ Planning est présent dans une fenêtre interne, il est conseillé de créer le bouton dans la fenêtre interne et non dans la fenêtre hôte.

- tester directement la fenêtre contenant le champ Planning puis l'état (grâce au bouton).
	Cas des fenêtres internes : il est nécessaire d'effectuer le test depuis la fenêtre accueillant la fenêtre interne.

- tester directement la page contenant le champ Planning puis l'état (grâce au bouton).
	Cas des pages internes : il est nécessaire d'effectuer le test depuis la page accueillant la page interne.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | [**Le logiciel Etats & Requêtes**](../Presentation/3088004.md) ne permet pas de créer des états sur un champ Planning. Cependant, il est possible de personnaliser des états sur un champ Planning créés sous l'éditeur d'états intégré (couleur, polices, taille, ...). |





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Créer un état sur un champ Planning depuis l'éditeur d'états
<a name="creer_etat_sur_champ_planning_depuis_editeur_etats_ELTTEXTE000323"></a>
L'éditeur d'états permet de créer un état de type Planning basé sur un champ Planning.

Après avoir créé l'état, l'impression de l'état nécessite une programmation en WLangage. Pour plus détails, consultez le paragraphe [Imprimer un état sur un champ Planning](#NOTE4_1).
<a name="NOTE3_2"></a>


### Créer un état sur un champ Planning depuis l'éditeur d'états
<a name="creer_etat_sur_champ_planning_depuis_editeur_etats_ELTPARAGRAPHE000072"></a>Pour créer un état sur un champ Planning depuis l'éditeur d'états :

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif)
 parmi les boutons d'accès rapide. 

	- La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Etat" puis sur "Etat". 

	- L'assistant de création d'un état s'affiche.




2. Choisissez un état de type "Agenda ou Planning". 

3. Sélectionnez "Etat Planning" et saisissez les caractéristiques de l'état : 

	- Nombre de jours à afficher, 

	- Granularité du quadrillage, 

	- Mode d'affichage des ressources. 
			Pour plus de détails  sur ces options, consultez [Etat Planning](../WDChamp/1011078.md). 




4. Sélectionnez la source de données de l'état (option "D'un champ planning").

5. Sélectionnez le champ Planning sur lequel sera basé l'état. Seuls les champs Planning présents dans les fenêtres ou les pages du projet en cours sont proposés.
	**Remarque** : Si le champ choisi ne possède pas les mêmes caractéristiques que l'état, l'éditeur d'états propose de modifier l'affichage de l'état.

6. Spécifiez le format de la feuille sur laquelle l'état va être imprimé. Par défaut, l'état est imprimé sur une feuille au format A4.

7. Saisissez le nom et le titre de l'état (nom du fichier ".WDE" correspondant à l'état). Ce nom permettra d'identifier l'état dans vos programmes.
	![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Il est également possible d'indiquer si l'état peut être modifié par l'utilisateur final sous le logiciel "Etats & Requêtes". 

8. Validez la création de l'état. 

9. Si nécessaire, indiquez le mode de réduction de l'état : 

	- Imprimer l'état sur plusieurs pages. Dans ce cas, l'utilisateur final devra assembler les pages. Pour plus de détails, consultez [Impression multipage](../WDChamp/1011065.md). 

	- Utiliser le mode paysage. 

	- Réduire l'état par rapport à l'original. Attention : selon le pourcentage de réduction choisi, l'état imprimé pourra devenir illisible. 




10. L'état en cours de création s'affiche sous l'éditeur d'états.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Imprimer un état sur un champ Planning
<a name="imprimer_etat_sur_champ_planning_ELTTEXTE000353"></a>


### Principe
<a name="principe_ELTPARAGRAPHE000121"></a>L'impression d'un état sur un champ Planning doit être réalisée uniquement à partir de la fenêtre ou la page affichant le champ Planning à imprimer. Il suffit de :

1. Créer un bouton dans la fenêtre (ou la page) contenant le champ Planning.

2. Paramétrer la destination de l'impression de l'état :

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) En WINDEV, grâce à la fonction [iDestination](../WDLang5/3046074.md) (visualisateur de rapports, impression dans un fichier HTML, ...).

	- 
			Pour plus de détails, consultez [Modes d'impression d'un état](../WDChamp/1011031.md).




3. Préciser le nom de l'état à imprimer grâce à la fonction [iImprimeEtat](../WDLang5/3046032.md).




**Remarques** :

- Si des paramètres supplémentaires doivent être passés à l'état, ces paramètres doivent être indiqués dans la fonction [iImprimeEtat](../WDLang5/3046032.md), après le nom de l'état à imprimer. Pour plus de détails, consultez [Etat paramétré](../WDChamp/1011008.md).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Si la fenêtre contenant le planning source de l'état est ouverte plusieurs fois (ouverture non modale par la fonction [OuvreFille](../WDLang1/3038021.md)), il faut passer en paramètre à l'état le nom complet du planning à imprimer. Par exemple : 
	
	```wl
	// La propriété NomComplet va contenir le nom de la fenêtre 
	// qui doit être ouverte avec un alias afin de distinguer chaque fenêtre
	iImprimeEtat(ETAT_Planning_Client, PLN_Client.NomComplet)
	```

	```wl
	// Code d'ouverture de l'état : 
	PROCEDURE ETAT_Planning_Client(NomPlanningSource)
	MonEtat.NomSource = NomPlanningSource
	```



|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | Sous [le logiciel Etats & Requêtes](../Presentation/3088004.md), il est possible d'imprimer un état :<br><br>- soit en lançant une impression (icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Ico_Imprimer.gif)<br>). <br><br>- soit en testant l'état (icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Ico_Go_Fenetre_WD_bl.gif)<br>). <br><br><br>Il n'est donc pas nécessaire de programmer l'impression de l'état. |




<a name="NOTE4_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Exemple WINDEV
<a name="exemple_windev_ELTPARAGRAPHE000189"></a>L'ensemble des informations à imprimer est contenu dans le champ Planning "PLN_PlanningClient" présent dans la fenêtre "FEN_Client".

L'état à imprimer est nommé "ETAT_PlanningClient" et s'imprime lors d'un clic sur le bouton "BTN_Imprimer".

Dans cet exemple, le code de clic du bouton "BTN_Imprimer" est le suivant :

```wl
// Ouvrir le visualisateur de rapports
iDestination(iVisualisateur)
// Imprimer l'état basé sur le planning "PLN_PlanningClient" 
iImprimeEtat(ETAT_PlanningClient)
```

<a name="NOTE4_3"></a>


