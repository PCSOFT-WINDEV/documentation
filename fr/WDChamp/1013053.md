


## Gestion des doublons dans les champs Arbre
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000155"></a>
WINDEV, WINDEV Mobile et WEBDEV permettent d'ajouter des doublons dans les éléments d'un champ Arbre. Le mécanisme de gestion des doublons dans les champs Arbre permet de manipuler simplement ces doublons.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Principe
<a name="principe_ELTTEXTE000179"></a>
La gestion des doublons dans les champs Arbre est basée sur la gestion des identifiants pour chaque élément d'un arbre.

En effet, lors de l'ajout, de l'insertion ou de la modification d'un élément dans un champ Arbre, il est possible de préciser un identifiant pour l'élément manipulé. Cet identifiant (déterminé par le développeur) va permettre d'identifier de façon unique le doublon manipulé par l'utilisateur.

**Le principe est simple** : il suffit d'utiliser un identifiant différent par doublon. Cet identifiant sera ensuite récupéré par les différentes fonctions de gestion des arbres et permettra ainsi d'identifier correctement le doublon manipulé.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Mise en place
<a name="mise_place_ELTTEXTE000203"></a>


### Définition d'un identifiant pour la gestion des doublons
<a name="definition_identifiant_pour_gestion_des_doublons_ELTPARAGRAPHE000035"></a>La définition d'un identifiant se fait simplement lors de l'ajout ou de la modification d'un élément dans un champ Arbre.

Pour associer un identifiant à un élément d'un champ Arbre, il suffit de préciser cet identifiant dans les fonctions de programmation suivantes :



|   |   |
| --- | --- |
| [ArbreAjoute](../WDLang1/3018012.md) | Ajoute un élément "feuille" (et tous les noeuds nécessaires) dans un champ Arbre. |
| [ArbreInsère](../WDLang1/3018023.md) | Insère une feuille à une position spécifique dans un champ Arbre. |
| [ArbreModifie](../WDLang1/3018013.md) | Modifie un élément (noeud ou feuille) dans un champ Arbre. |



Exemple :

```wl
RésultatArbre est un Booléen
RésultatArbre = ArbreAjoute(ARBRE_Arbre1, "Racine" + TAB + "Noeud" + TAB + "Feuille", ...
	aDéfaut, aDéfaut, "Id feuille")
RésultatArbre = ArbreAjoute(ARBRE_Arbre1, "Racine" + TAB + "Noeud" + TAB + "Feuille", ...
	aDéfaut, aDéfaut, "Id feuille 2", aAccepteDoublon)
```

<a name="NOTE3_2"></a>


### Manipulation directe d'un élément à l'aide de son identifiant
<a name="manipulation_directe_element_aide_son_identifiant_ELTPARAGRAPHE000054"></a>Pour manipuler un élément doublon, il est nécessaire de connaître et de préciser son identifiant.

Pour manipuler un élément dont on connaît le chemin, il suffit de compléter chaque élément du chemin si nécessaire par son identifiant en utilisant fonction [ArbreID](../WDLang1/3018027.md).

**Exemple** : Pour ajouter une feuille à l'élément "Racine"+TAB+"Noeud"+TAB+"Feuille" ayant pour identifiant "Id feuille", il suffit d'utiliser la syntaxe suivante :

```wl
RésultatArbre = ArbreAjoute(ARBRE_Arbre1, "Racine" + TAB + "Noeud" + TAB + "Feuille" + ...
	ArbreID("Id Feuille") + TAB + "Mon Elément", aDefaut, aDéfaut, "Mon Elément 1")
```


La fonction [ArbreID](../WDLang1/3018027.md) peut également être utilisée avec la syntaxe **&lt;Nom de l'arbre&gt; [ &lt;Chemin de élément&gt;]**.
Par exemple :

```wl
ARBRE_Arbre1["Racine" + TAB + "Noeud" + TAB + "Feuille" + ArbreID("Id Feuille") + ...
	TAB + "Mon Elément"]..Couleur = RougeClair
```

<a name="NOTE3_3"></a>


### Connaître l'identifiant d'un élément
<a name="connaitre_identifiant_element_ELTPARAGRAPHE000091"></a>Pour connaître l'identifiant d'un élément d'un arbre, il suffit d'utiliser la fonction [ArbreRécupèreIdentifiant](../WDLang1/3018004.md).

Dans le cas de la gestion des doublons, l'identifiant fait partie intégrante du chemin, puisqu'il permet d'identifier l'élément sélectionné.

Les fonctions WLangage renvoyant le chemin d'un élément (lors de la sélection d'un élément par exemple) peuvent donc renvoyer :

- soit le chemin de l'élément sans prendre en compte l'identifiant.

- soit le chemin de l'élément en y incluant si nécessaire l'identifiant de chaque élément du chemin.




Les fonctions concernées sont les suivantes :



|   |   |
| --- | --- |
| [ArbreListeFils](../WDLang1/3018016.md) | Liste les "fils" d'un noeud et les éléments "fils" de ces "fils" dans un champ Arbre. |
| [ArbrePosition](../WDLang1/3018005.md) | Affiche un champ Arbre à partir d'un élément (noeud ou feuille) spécifié ou renvoie le nom du premier élément affiché dans un champ Arbre. |
| [ArbreSelect](../WDLang1/3018003.md) | Renvoie le chemin complet de l'élément sélectionné dans un champ Arbre. |






- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampArbre_Treeview_.gif) ***Exemples unitaires (WINDEV)*** : **Le champ Arbre (Treeview)** <br>Utilisation du champ Arbre par programmation grâce aux fonctions Arbre du WLangage.


