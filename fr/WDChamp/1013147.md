


## Programmation des champs Table fichier
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000262"></a>
Voici les principaux points de la programmation des champs Table fichier. Le WLangage met à votre disposition de nombreuses fonctions permettant de gérer par programmation les champs Table fichier.

N'hésitez pas à consultez la documentation de ces fonctions. Pour plus de détails, consultez : [Liste des fonctions de gestion des champs Table](../WDLang1/3074009.md).



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Sélection, ajout et modification d'une ligne dans un champ Table fichier
<a name="selection_ajout_modification_une_ligne_dans_champ_table_fichier_ELTTEXTE000286"></a>
La sélection d'une ligne s'effectue avec la fonction [TableSelectPlus](../WDLang1/3074031.md).

Si aucune rubrique mémorisée n'est définie pour le champ Table fichier, il est également possible d'utiliser la syntaxe :

```txt
<Champ Table> = <Numéro de la ligne à sélectionner>
```

<a name="NOTE2_2"></a>
L'ajout et la modification d'une ligne dans le champ Table fichier (et d'un enregistrement dans le fichier de données) se décompose en deux phases :

1. Ajout ou modification de l'enregistrement dans le fichier de données (par une fenêtre ou une page de type fiche par exemple).

2. Réaffichage du champ Table fichier :

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) rafraîchissement du champ Table fichier.







<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Suppression d'une ligne dans un champ Table fichier
<a name="suppression_une_ligne_dans_champ_table_fichier_ELTTEXTE000316"></a>
Pour supprimer une ligne dans le champ Table fichier, utilisez la fonction [TableSupprime](../WDLang1/3074032.md). La fonction [TableSupprime](../WDLang1/3074032.md) supprime l'enregistrement correspondant dans le fichier de données.
**Important** : Pour supprimer un enregistrement dans le fichier de données, il ne faut pas utiliser la fonction [HSupprime](../WDLang4/3044018.md) sous peine de perte de données dans le fichier de données.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Gestion des colonnes calculées
<a name="gestion_des_colonnes_calculees_ELTTEXTE000340"></a>
La formule de calcul d'une colonne calculée doit être décrite dans l'événement "Affichage d'une ligne" du champ Table.

Exemple de code dans l'événement "Affichage d'une ligne" du champ Table : 

```wl
// COL_MsgAlerte : une colonne calculée 
// La colonne COL_MsgAlerte affiche "Alerte" si COL_Stock<200
SI COL_Stock < 200 ALORS
	COL_MsgAlerte = "Alerte"
SINON
	COL_MsgAlerte = ""
FIN
```

Par définition, une colonne calculée n'est pas reliée à une rubrique : la valeur affectée par le code d'affichage d'une ligne n'est pas mémorisée après un défilement des lignes du champ Table via l'ascenseur vertical. 

Par exemple, l'instruction "POUR TOUTE LIGNE" ne permettra pas d'affecter ou de récupérer la valeur d'une colonne calculée de toutes les lignes du champ Table fichier. 

Si le champ Table est un champ Table fichier "Chargé en mémoire" (option "Chargé en mémoire" cochée dans l'onglet "Contenu" de la fenêtre de description du champ), les colonnes calculées seront mémorisées lors de l'exécution du champ Table. 

<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Récupération du contenu d'une ligne, d'une colonne ou d'une cellule
<a name="recuperation_contenu_une_ligne_une_colonne_une_cellule_ELTTEXTE000364"></a>


### Important
<a name="important_ELTPARAGRAPHE000111"></a>Le contenu d'une ligne d'un champ Table fichier peut être récupéré :

- soit en récupérant la ligne entière. 

- soit cellule par cellule. 



<a name="NOTE5_2"></a>


### Valeur d'une cellule de la ligne en cours
<a name="valeur_une_cellule_ligne_cours_ELTPARAGRAPHE000123"></a>La cellule est identifiée par le nom de la colonne. La syntaxe à utiliser est la suivante :

```txt
<Valeur> = <Nom de la colonne>
```


Exemple : 

```wl
// COL_QTE est une colonne du champ Table
SI COL_QTE < 10 ALORS
	INFO("Quantité insuffisante")
FIN
```

<a name="NOTE5_3"></a>


### Valeur d'une cellule pour une ligne spécifique
<a name="valeur_une_cellule_pour_une_ligne_specifique_ELTPARAGRAPHE000137"></a>La cellule est identifiée par le nom de la colonne. La syntaxe à utiliser est la suivante :

```txt
<Valeur> = <Nom de la colonne>[<Indice de la ligne>]
```
Exemple : 

```wl
// Totalise le Prix présent dans la colonne COL_PHT 
// pour toutes les lignes de commande affichées
PrixTotal = 0
POUR Indice = 1 A TABLE_COMMANDE.Occurrence
	PrixTotal = PrixTotal + COL_PHT[Indice]
FIN
```

<a name="NOTE5_4"></a>


### Contenu de la ligne en cours
<a name="contenu_ligne_cours_ELTPARAGRAPHE000151"></a>La syntaxe à utiliser est la suivante :

```txt
<Valeur> = <Champ Table>
```
Il est également possible d'utiliser la syntaxe : 

```txt
<Valeur> = <Champ Table>[<Champ Table>]
```

<a name="NOTE5_5"></a>


### Contenu de la ligne X
<a name="contenu_ligne_ELTPARAGRAPHE000165"></a>La syntaxe à utiliser est la suivante :

```txt
<Valeur> = <Champ Table>[<Indice de la ligne>]
```


**Remarque** : L'indice de la ligne peut être donné par la fonction [TableSelect](../WDLang1/3074020.md).

```wl
// Récupère la ligne en cours du champ TABLE_CLIENT
LigneEnCours = TABLE_CLIENT

// Nom du client sélectionné
NomCli = COL_NOM[TableSelect(TABLE_CLIENT)]
```

<a name="NOTE5_6"></a>


### Contenu des lignes sélectionnées dans le cas d'une multisélection
<a name="contenu_des_lignes_selectionnees_dans_cas_une_multiselection_ELTPARAGRAPHE000187"></a>La syntaxe à utiliser est la suivante :

```txt
<Valeur> = <Champ Table>[<Indice de la ligne>]
```


**Remarque** : Pour connaître les indices des lignes sélectionnées, il faut utiliser les fonctions [TableSelectOccurrence](../WDLang1/3074030.md) et [TableSelect](../WDLang1/3074020.md).

```wl
// Trace le contenu des lignes sélectionnées
i est un entier
NbSelectionne est un entier = TableSelectOccurrence(TABLE_Produit) 
POUR i = 1 A NbSelectionne 
	Trace("Ligne sélectionnée : " + ...
			TABLE_Produit[TableSelect(TABLE_Produit, i)]) 
FIN 

// Equivalent à :
// POUR TOUTE LIGNE SELECTIONNEE DE TABLE_Produit
//	Trace("Ligne sélectionnée : " + TABLE_Produit[TableSelect(TABLE_Produit, i)])
// FIN
```

**Note** : Les champs Table fichier multisélections ne sont pas disponibles :

- Si le champ Table contient des ascenseurs proportionnels.

- Si le champ Table est de type "Compatible 5.5".

- Dans les champs Table affichés par les combos.




**Remarque** : La propriété [Multisélection](../Proprietes/1000017054.md) permet de connaître le mode de sélection d'un champ Table.


