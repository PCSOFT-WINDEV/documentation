


## Manipuler un champ Organigramme par programmation
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000241"></a>
Un champ Organigramme peut être : 

- manipulé par programmation. 

- lié à un fichier de données. 




Pour manipuler un champ Organigramme par programmation, WINDEV propose les [fonctions Organigramme](../WDLang1/1000019817.md). 

Cette page d'aide détaille comment manipuler un champ Organigramme par programmation. 



## Manipuler le champ Organigramme par programmation
<a name="manipuler_champ_organigramme_par_programmation_ELTTEXTE000265"></a>


### Ajouter un élément "racine"
<a name="ajouter_element_racine_ELTPARAGRAPHE000029"></a>Un élément "racine" d'un organigramme est l'élément à partir duquel toute la hiérarchie est construite. L'ajout d'un élément "racine" dans un champ Organigramme est réalisé grâce à la fonction [OrgaAjoute](../WDLang1/1000019729.md). 

Cette fonction accepte deux syntaxes : 

- syntaxe permettant de préciser les caractéristiques de l'élément : titre, image, ...
	Exemple : 
	
	```wl
	// Ajoute un élément racine 
	OrgaAjoute(ORGA_DRH, "Emma Moutier")
	```

	**Remarque** : La fonction [OrgaAjoute](../WDLang1/1000019729.md) permet d'insérer une image dans l'élément (à gauche du texte).

- syntaxe manipulant une variable de type [OrgaElément](../WDLang1/1000019713.md).
	
	```wl
	// Ajout d'éléments dans le champ Organigramme
	// Elément Racine
	ElémentPDG est un OrgaElément
	ElémentPDG.Titre = "Big Boss"
	OrgaAjoute(ORGA_DIRECTION, ElémentPDG)
	```

	**Remarque** : L'utilisation du type [OrgaElément](../WDLang1/1000019713.md) permet de configurer de nombreuses options spécifiques : 

	- bulle d'aide, 

	- couleur de fond de l'élément, 

	- image de fond de l'élément, 

	- police du titre et du contenu,

	- orientation de l'élément. 








### Ajouter des éléments fils
<a name="ajouter_des_elements_fils_ELTPARAGRAPHE000079"></a>L'ajout des éléments fils dans un champ Organigramme est réalisé grâce à la fonction [OrgaAjouteFils](../WDLang1/1000019763.md). Cette fonction accepte deux syntaxes : 

- syntaxe permettant de préciser les caractéristiques de l'élément : titre, contenu, ...
	
	```wl
	OrgaAjoute(ORGA_SansNom1, "Emma")
	OrgaAjouteFils(ORGA_SansNom1, 1, "Paul Moulin")
	OrgaAjouteFils(ORGA_SansNom1, 1, "Florence Marcellin")
	OrgaAjouteFils(ORGA_SansNom1, 3, "Gilles Preau")
	OrgaAjouteFils(ORGA_SansNom1, 3, "Jérome Deschamps")
	```


- syntaxe manipulant une variable de type [OrgaElément](../WDLang1/1000019713.md).
	
	```wl
	// Ajout d'éléments dans le champ Organigramme
	// Elément Racine
	ElémentPDG est un OrgaElément
	ElémentPDG.Titre = "Big Boss"
	OrgaAjoute(ORGA_DIRECTION, ElémentPDG)
	
	// Eléments fils
	Elément2 est un OrgaElément
	Elément2.Titre = "Production"
	OrgaAjouteFils(ORGA_DIRECTION, 1, Elément2)
	
	Elément3 est un OrgaElément
	Elément3.Titre = "Vente"
	OrgaAjouteFils(ORGA_DIRECTION, 1, Elément3)
	```

	La propriété **CouleurFond** de la variable [OrgaElément](../WDLang1/1000019713.md) permet de définir une couleur d'affichage pour un élément. Si aucune couleur de fond n'est définie, le champ Organigramme utilisera automatiquement la couleur par défaut. 





### Supprimer un élément
<a name="supprimer_element_ELTPARAGRAPHE000109"></a>La fonction [OrgaSupprime](../WDLang1/1000019758.md) permet de supprimer un élément du champ Organigramme et tous ses fils. 


```wl
// Supprime l'élément 15 et ses fils
OrgaSupprime(ORGA_MonOrganigramme, 15)
```


La fonction [OrgaSupprimeTout](../WDLang1/1000019749.md) permet de supprimer tous les éléments présents dans un champ Organigramme. 



## Manipuler un élément d'un champ Organigramme
<a name="manipuler_element_champ_organigramme_ELTTEXTE000308"></a>
Les éléments d'un champ Organigramme se manipulent grâce à leurs indices. Chaque élément du champ Organigramme est associé à un identifiant (indice). Cet indice est renvoyé : 

- par les fonctions [OrgaAjoute](../WDLang1/1000019729.md) et [OrgaAjouteFils](../WDLang1/1000019763.md). 

- par la fonction [OrgaInfoXY](../WDLang1/1000019759.md). 




Cet indice est utilisé par toutes les fonctions permettant de manipuler les éléments (sélection, suppression, ...). 

Pour manipuler ou modifier un élément spécifique du champ Organigramme, il suffit : 

- de définir une variable de type [OrgaElément](../WDLang1/1000019713.md). 

- de lui affecter l'élément voulu du champ Organigramme. 




L'élément peut être ensuite manipulé grâce aux propriétés du type [OrgaElément](../WDLang1/1000019713.md). 

Par exemple : 

```wl
MonElément est un OrgaElément 
MonElément = ORGA_MonOrganigramme[2]

Trace(MonElément.Titre)
```



### Changer l'orientation d'un élément
<a name="changer_orientation_element_ELTPARAGRAPHE000169"></a>Il est possible de modifier l'orientation d'un élément du champ Organigramme grâce à la propriété **Orientation90** du type [OrgaElément](../WDLang1/1000019713.md). Un élément fils peut ainsi être à droite de son père. 

Par exemple : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Orga_Horizontal.gif)
 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Orga_Horizontal2.gif)


Le code suivant permet par exemple de changer l'orientation de l'élément cliqué : 

```wl
// Sélection d'un élément de ORGA_SansNom1
MonElément est un OrgaElément 
MonElément = ORGA_SansNom1[ORGA_SansNom1]
MonElément.Orientation90 = PAS MonElément.Orientation90
ORGA_SansNom1[ORGA_SansNom1] <- MonElément
```




## Propriétés spécifiques aux champs Organigramme
<a name="proprietes_specifiques_aux_champs_organigramme_ELTTEXTE000338"></a>
Les propriétés suivantes sont spécifiques à la gestion d'un champ Organigramme par programmation.



|   |   |
| --- | --- |
| [HauteurElément](../Proprietes/1000020068.md) | La propriété **HauteurElément** permet de :<br><br>- Connaître ou modifier la hauteur des éléments d'un champ Organigramme. <br><br>- Connaître ou modifier la hauteur des cellules d'un champ Tableau de bord.<br><br><br> |
| [LargeurElément](../Proprietes/1000020066.md) | La propriété **LargeurElément** permet de :<br><br>- Connaître ou modifier la largeur des éléments d'un champ Organigramme.<br><br>- Connaître ou modifier la largeur des cellules d'un champ Tableau de bord.<br><br><br> |
| [MaxFeuilleParLigne](../Proprietes/1000020103.md) | La propriété **MaxFeuilleParLigne** permet de connaître et de modifier le nombre maximum d'éléments en ligne dans un champ Organigramme. |
| [Occurrence](../Proprietes/2510097.md) | La propriété **Occurrence** permet de connaître le nombre d'éléments présents dans un ensemble. |
| [OrientationElément](../Proprietes/1000020055.md) | La propriété **OrientationElément** permet de connaître et modifier l'orientation d'un champ Organigramme. |
| [Vertical](../Proprietes/2510133.md) | La propriété **Vertical** permet de :<br><br>- savoir si un champ est horizontal ou vertical.<br><br>- modifier le sens d'affichage des champs Table ou des champs Zone répétée (passage de vertical à horizontal et inversement). <br><br><br> |
| [Zoom](../Proprietes/1000017201.md) | La propriété **Zoom** permet de connaître ou de modifier la valeur du zoom utilisée : <br><br>- dans un champ Image.<br><br>- dans un champ Carte. <br><br>- dans un champ Organigramme.<br><br>- dans un champ Table, Table hiérarchique, Tableau Croisé Dynamique, Tableur ou Liste. <br><br>- dans un champ Traitement de texte. <br><br>- dans un champ Lecteur PDF.<br><br>- dans un champ Caméra.<br><br>- dans un champ Editeur de diagrammes; <br><br>- dans une fenêtre.<br><br><br> |





Pour connaître la liste complète des propriétés du WLangage pouvant être utilisées avec un champ de type Organigramme, consultez [Propriétés associées au champ Organigramme](../WDChamp/1000019791.md).


