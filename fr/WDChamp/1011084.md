
## Etat Diagramme de Gantt
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000259"></a>
L'éditeur d'états offre la possibilité de créer des états de type "Diagramme de Gantt". Ce type d'état est basé sur un champ Table (ou Table hiérarchique) affichant une colonne de type Diagramme de Gantt. 

Exemple : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Etat_gantt%20-%20HC%20N%B0002.gif&type=thumb)


<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Créer un état Diagramme de Gantt
<a name="creer_etat_diagramme_gantt_ELTTEXTE000283"></a>


### Création de l'état
<a name="creation_etat_ELTPARAGRAPHE000020"></a>Pour créer un état de type "Diagramme de Gantt" : 

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif)
 parmi les boutons d'accès rapide.

2. La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Etat" puis sur "Etat". 

3. L'assistant de création d'un état se lance. 

4. Sélectionnez un état de type "Diagramme de Gantt". Passez à l'étape suivante. 

5. Sélectionnez le champ Table (ou Table hiérarchique) à utiliser pour réaliser l'état de type Diagramme de Gantt. Indiquez si seules les lignes sélectionnées dans le champ  doivent être imprimées. Passez à l'étape suivante. 

6. Indiquez les rubriques à imprimer (c'est-à-dire les colonnes du champ Table ou Table hiérarchique). Pour chaque rubrique, il est possible d'indiquer le libellé de la rubrique et le bloc dans lequel la rubrique doit être positionnée. Passez à l'étape suivante. 

7. Indiquez si nécessaire les calculs à réaliser sur les différentes rubriques numériques de votre état. Cliquez sur "Aucun calcul" pour ne pas intégrer de calculs dans l'état. Passez à l'étape suivante.

8. Spécifiez le format de la feuille sur laquelle l'état va être imprimé. Par défaut, l'état est imprimé sur une feuille au format A4. Passez à l'étape suivante. 

9. Indiquez si nécessaire le gabarit à utiliser pour l'état. Passez à l'étape suivante.

10. Saisissez le nom et le titre de l'état (nom du fichier ".WDE" correspondant à l'état). Ce nom permettra d'identifier l'état dans vos programmes. Il est également possible d'indiquer si l'état peut être modifié par l'utilisateur final sous le logiciel "Etats & Requêtes". 

11. Validez la création de l'état. 

12. Si nécessaire, indiquez le mode de réduction de l'état : 

	- Imprimer l'état sur plusieurs pages. Dans ce cas, l'utilisateur final devra assembler les pages. Ce type d'impression est conseillé pour un état Diagramme de Gantt. Pour plus de détails, consultez [Impression multipage](../WDChamp/1011065.md). 

	- Utiliser le mode paysage. 

	- Réduire l'état par rapport à l'original. Attention : selon le pourcentage de réduction choisi, l'état imprimé pourra devenir illisible. 




13. L'état en cours de création s'affiche sous l'éditeur d'états.
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Etat_gantt%20-%20HC%20N%B0001.gif&type=thumb)










<a name="NOTE2_2"></a>


### Remarques
<a name="remarques_ELTPARAGRAPHE000053"></a>

- Les paramètres de style des tâches du Diagramme de Gantt de l'état sont automatiquement récupérés depuis le champ (couleur de fond, couleur d'avancement, ...). 

- Un état Tableau est automatiquement créé à partir du champ Table ou Table hiérarchique. La colonne de type Diagramme de Gantt présente dans la fenêtre est transformée sous l'éditeur d'états en une colonne de type Diagramme de Gantt.  



<a name="NOTE2_3"></a>


### Tester d'un état de type Diagramme de Gantt
<a name="tester_etat_type_diagramme_gantt_ELTPARAGRAPHE000061"></a>Il est impossible de tester un état de type Diagramme de Gantt directement depuis l'éditeur d'états car la fenêtre contenant le champ Table ou Table hiérarchique doit être ouverte. Pour tester un état de type Diagramme de Gantt, il est donc nécessaire de :

- créer si nécessaire un bouton dans la fenêtre contenant le champ Diagramme de Gantt. Ce bouton permet de lancer l'impression de l'état Diagramme de Gantt (fonction [iImprimeEtat](../WDLang5/3046032.md)). 
	Cas des fenêtres internes : Si le champ Diagramme de Gantt est présent dans une fenêtre interne, il est conseillé de créer le bouton dans la fenêtre interne et non dans la fenêtre hôte.

- tester directement la fenêtre contenant le champ Diagramme de Gantt puis l'état (grâce au bouton).
	Cas des fenêtres internes : il est nécessaire d'effectuer le test depuis la fenêtre accueillant la fenêtre interne.




|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | [**Le logiciel Etats & Requêtes**](../Presentation/3088004.md) ne permet pas de créer des états de type Diagramme de Gantt. Cependant, il est possible de personnaliser des états de type Diagramme de Gantt créés sous l'éditeur d'états intégré (couleur, polices, taille, ...).<br><br><br><br> |





<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Champ Diagramme de Gantt dans un état
<a name="champ_diagramme_gantt_dans_etat_ELTTEXTE000337"></a>
Dans un état de type Diagramme de Gantt, un tableau est automatiquement créé. Ce tableau contient un champ Diagramme de Gantt. 

La fenêtre de description du champ Diagramme de Gantt permet de configurer les caractéristiques suivantes : 

- **Affichage des tâches** (onglet "Général") : il est possible de sélectionner : 

	- la plage de sélection des tâches (de la première à la dernière ou sur un nombre de jours spécifique). 

	- le nombre de jours affichés.

	- la granularité du quadrillage.

	- la plage horaire visible.




- **L'état personnalisé pour afficher les tâches**. 

	- Si l'option sélectionnée est "Aucun", l'affichage par défaut est utilisé. 

	- Si l'option "Etat prédéfini" est sélectionnée, un état prédéfini est automatiquement ajouté au projet. Par défaut, cet état a pour nom "ETAT_WinDevVueTacheGantt" et est automatiquement utilisé pour l'affichage des tâches.![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Etat_WinDevvueGantt.gif)
 Cet état peut être personnalisé, renommé, ...

	- Si l'option sélectionnée correspond à un état du projet, cet état sera utilisé pour afficher les tâches.
			Il est conseillé de personnaliser l'état proposé par défaut. 




- **Affichage des dates** (onglet "Général") : Les options disponibles sont les suivantes : 

	- **Afficher le numéro de semaine** : Si cette option est cochée, le numéro de semaine est affiché dans le diagramme de Gantt. Il est alors possible de définir le masque d'affichage du numéro de la semaine. Par défaut, seul le numéro de semaine est affiché. Il est possible de spécifier un masque personnalisé en utilisant %1 pour le numéro de semaine (par exemple : Semaine %1). 

	- **Masque de la date** (onglet "Général").
			 Par défaut, le masque est "Automatique". Il est possible d'utiliser : 

		- un des masques prédéfinis proposés.

		- un masque personnalisé. Par exemple, le masque "MMMM AAAA||" permet de ne pas afficher les jours.  




- **Masque des horaires** (onglet "Général").
			 Par défaut, le masque est "Automatique". Il est possible d'utiliser : 

	- un des masques prédéfinis proposés.

	- un masque personnalisé. Par exemple, le masque "HH" permet de ne pas afficher les minutes.  

- **Découpage du diagramme en largeur** (onglet "UI"): Cette option permet de paramétrer la représentation du diagramme à l'impression. Il est possible de choisir une des options suivantes : 

	- Diagramme de Gantt en continu (Valeur par défaut) : Le diagramme de Gantt sera affiché en continu sur plusieurs pages. Cette option permet notamment une impression linéaire, sans interruption. 

	- Report des colonnes sur chaque page :  Les colonnes de "description" du diagramme de Gantt (Titre, durée, ...) seront reportées sur chaque page lors de l'impression du Diagramme de Gantt. 




- **Ancre sur champ** (onglet "UI") : grâce à cette option, un champ de l'état peut suivre l'étirement du champ Diagramme de Gantt. En effet, le champ Diagramme de Gantt s'étire selon les données imprimées. L'option "Ancre sur champ" est utile notamment si des colonnes ou des champs doivent être imprimés à droite du champ Diagramme de Gantt : ils suivront ainsi l'étirement du champ Diagramme de Gantt.

- **Style** des différents éléments du Diagramme de Gantt (onglet "Style"). 




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Imprimer un état de type Diagramme de Gantt
<a name="imprimer_etat_type_diagramme_gantt_ELTTEXTE000361"></a>
L'impression d'un état de type Diagramme de Gantt (sur un champ Table ou Table hiérarchique) doit être réalisée uniquement à partir de la fenêtre affichant le champ à imprimer. Il suffit de :

1. Créer un bouton dans la fenêtre contenant le champ.

2. Paramétrer la destination de l'impression de l'état grâce à la fonction [iDestination](../WDLang5/3046074.md) (visualisateur de rapports, impression dans un fichier HTML, ...).

3. Préciser le nom de l'état à imprimer grâce à la fonction [iImprimeEtat](../WDLang5/3046032.md).




**Remarques** :

- Si des paramètres supplémentaires doivent être passés à l'état, ces paramètres doivent être indiqués dans la fonction [iImprimeEtat](../WDLang5/3046032.md), après le nom de l'état à imprimer. Pour plus de détails, consultez [Etat paramétré](../WDChamp/1011008.md).

- Si la fenêtre contenant le champ source de l'état est ouverte plusieurs fois (ouverture non modale par la fonction [OuvreFille](../WDLang1/3038021.md)), il faut passer en paramètre à l'état le nom complet du champ à imprimer. 
	Par exemple : 
	
	```wl
	// La propriété NomComplet va contenir le nom de la fenêtre
	// qui doit être ouverte avec un alias afin de distinguer chaque fenêtre
	iImprimeEtat(ETAT_Gantt, TABLEH_Planning.NomComplet)
	```

	```wl
	// Code d'ouverture de l'état : 
	PROCEDURE ETAT_Gantt(NomTableHSource)
	MonEtat.NomSource = NomTableHSource
	```


- La propriété [SélectionSeule](../Proprietes/2511017.md) permet de connaître et de modifier les enregistrements à imprimer dans l'état : impression de tous les enregistrements ou uniquement des enregistrements sélectionnés.

- Si l'état est basé sur un champ Table hiérarchique, la propriété [ConserverHiérarchieVisible](../Proprietes/1000021055.md) permet de connaître et de modifier le mode d'impression de la hiérarchie : impression de la hiérarchie complète ou impression de la hiérarchie visible dans le champ.




|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | Sous [le logiciel Etats & Requêtes](../Presentation/3088004.md), il est possible d'imprimer un état :<br><br>- soit en lançant une impression (icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Icone_Imprimer.gif)<br>). <br><br>- soit en testant l'état (icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_GO_Fenetre_WD_bl.gif)<br>). <br><br><br>Il n'est donc pas nécessaire de programmer l'impression de l'état. |










### Exemple
<a name="exemple_ELTPARAGRAPHE000200"></a>L'ensemble des informations à imprimer est contenu dans le champ Table hiérarchique "TABLEH_Planning" présent dans la fenêtre "FEN_Gantt".

L'état à imprimer est nommé "ETAT_Gantt" et s'imprime lors d'un clic sur le champ Bouton "BTN_Imprimer".

Dans cet exemple, le code "Clic" du champ Bouton "BTN_Imprimer" est le suivant :


```wl
// Ouvrir le visualisateur de rapports
iDestination(iVisualisateur)
// Imprimer l'état basé sur le champ Table hiérarchique "TABLEH_Planning" 
iImprimeEtat(ETAT_Gantt)
```





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDGantt.gif) ***Exemples complets (WINDEV)*** : **WD Gantt** <br>L'exemple "WD Gantt" présente une utilisation avancée du champ Diagramme de Gantt.<br>Cet exemple permet de créer un diagramme de Gantt complet avec tâches, liaisons, tâches cumulatives et jalons.<br>Les tâches peuvent être éditées dans une fenêtre spécifique.<br>Le diagramme créé peut être sauvegardé dans un fichier pour être rechargé par la suite.




