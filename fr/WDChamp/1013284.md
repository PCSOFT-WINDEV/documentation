
## Manipuler un champ Zone répétée par programmation
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000237"></a>
WINDEV, WINDEV Mobile et WEBDEV permettent de manipuler un champ Zone répétée directement par programmation. Il suffit d'utiliser directement la variable du champ Zone répétée dans le code. 



La variable du champ Zone répétée correspond au nom du champ Zone répétée. Cette variable est de type entier. 





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Initialiser les différents champs/attributs d'un champ Zone répétée
<a name="initialiser_les_differents_champsattributs_champ_zone_repetee_ELTTEXTE000261"></a>
Pour initialiser les différents champs/attributs d'un champ Zone répétée :

- soit utilisez la fonction [ZoneRépétéeAjoute](../WDLang2/3083006.md) ou [ZoneRépétéeAjouteLigne](../WDLang2/3083004.md).

- soit manipulez directement chaque champ de la zone répétée : 
	
	```txt
	<Nom Zone répétée>[<Indice>].<Nom Champ>.<Nom Propriété> = <Valeur>
	```

	

- soit manipulez directement chaque champ de toutes les répétitions de la zone répétée : 
	
	```txt
	<Nom Zone répétée>.<Nom Champ>.<Nom Propriété> = <Valeur>
	```

	Si &lt;Nom Propriété&gt; correspond à la propriété [Valeur](../Proprietes/2510130.md), seule la valeur du champ spécifié pour la répétition en cours est modifiée.
	

- soit manipulez directement chaque attribut du champ Zone répétée :
	
	```txt
	<Nom Attribut>[<Indice>] = <Valeur>
	```


- soit manipulez directement chaque attribut du champ Zone répétée pour la répétition en cours :
	
	```txt
	<Nom Attribut> = <Valeur>
	```





Par exemple :

- Changer la valeur du champ de saisie "SAI_NomClient" dans le champ Zone répétée "ZR_Client" pour la répétition 8 :
	
	```wl
	ZR_Client[8].SAI_NomClient.Valeur = "Montgomery"
	// Equivalent à : ZR_Client[8].SAI_NomClient = "Montgomery"
	// En WEBDEV, un attribut permettant de modifier la valeur 
	// du champ "SAI_NomClient" doit exister
	```


- Changer la valeur du champ de saisie "SAI_NomClient" dans le champ Zone répétée "ZR_Client" pour la répétition en cours :
	
	```wl
	ZR_Client.SAI_NomClient.Valeur = "Montgomery"
	// Equivalent à : ZR_Client.SAI_NomClient = "Montgomery"
	// En WEBDEV, un attribut permettant de modifier la valeur 
	// du champ "SAI_NomClient" doit exister
	```


- Changer la couleur de fond du champ "SAI_NomClient" dans le champ Zone répétée "ZR_Client" pour la répétition 8 :
	
	```wl
	ZR_Client[8].SAI_NomClient.CouleurFond = BleuFoncé
	// En WEBDEV, un attribut permettant de modifier la couleur de fond
	// du champ "SAI_NomClient" doit exister
	```


- Rendre invisible le champ "SAI_TelClient" dans le champ Zone répétée "ZR_Client" pour toutes les répétitions :
	
	```wl
	ZR_Client.SAI_TelClient.Visible = Faux
	// En WEBDEV, un attribut permettant de modifier la visibilité
	// du champ "SAI_TelClient" doit exister
	```







- Modifier la largeur du champ "SAI_AdresseClient" lié à l'attribut "ATT_AttributLargeur" dans le champ Zone répétée "ZR_Client" pour la répétition 8 :
	
	```wl
	ATT_AttributLargeur[8] += 100
	// Equivalent à : ZR_Client[8].SAI_AdresseClient.Largeur += 100
	```


- Modifier la largeur du champ "SAI_AdresseClient" lié à l'attribut "ATT_AttributLargeur" dans le champ Zone répétée "ZR_Client" pour la répétition en cours :
	
	```wl
	ATT_AttributLargeur += 100
	```





**Remarque** : Ces lignes de code doivent être présentes dans l'événement "Affichage d'une ligne" du champ Zone répétée.





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Récupérer la valeur des différents champs/attributs d'un champ Zone répétée
<a name="recuperer_valeur_des_differents_champsattributs_champ_zone_repetee_ELTTEXTE000285"></a>
Pour récupérer la valeur des différents champs/attributs d'un champ Zone répétée :

- soit manipulez directement chaque champ du champ Zone répétée :
	
	```txt
	<Valeur> = <Nom Zone répétée>[<Indice>].<Nom Champ>.<Nom Propriété>
	```

	

- soit manipulez directement chaque champ de la zone répétée pour la répétition en cours :
	
	```txt
	<Valeur> = <Nom Zone répétée>.<Nom Champ>.<Nom Propriété>
	```

	

- soit manipulez directement chaque attribut du champ Zone répétée :
	
	```txt
	<Valeur> = <Nom Attribut>[<Indice>]
	```


- soit manipulez directement chaque attribut du champ Zone répétée pour la répétition en cours :
	
	```txt
	<Valeur> = <Nom Attribut>
	```





Par exemple :

- Connaître la valeur du champ de saisie "SAI_NomClient" du champ Zone répétée "ZR_Client" pour la répétition 8 :
	
	```wl
	ResNomClient = ZR_Client[8].SAI_NomClient.Valeur
	// Equivalent à : ResNomClient = ZR_Client[8].SAI_NomClient
	// En WEBDEV, un attribut permettant de modifier la valeur 
	// du champ "SAI_NomClient" doit exister
	```


- Connaître la valeur du champ de saisie "SAI_NomClient" dans le champ Zone répétée "ZR_Client" pour la répétition en cours :
	
	```wl
	ResNomClient = ZR_Client.SAI_NomClient.Valeur
	// Equivalent à : ResNomClient = ZR_Client.SAI_NomClient
	// En WEBDEV, un attribut permettant de modifier la valeur 
	// du champ "SAI_NomClient" doit exister
	```





- Connaître la couleur de fond du champ "SAI_NomClient" dans le champ Zone répétée "ZR_Client" pour la répétition 8 :
	
	```wl
	ResCouleur = ZR_Client[8].SAI_NomClient.CouleurFond
	// En WEBDEV, un attribut permettant de modifier la couleur de fond
	// du champ "SAI_NomClient" doit exister
	```


- Connaître la largeur du champ "SAI_AdresseClient" lié à l'attribut "ATT_AttributLargeur" dans le champ Zone répétée "ZR_Client" pour la répétition 8 :
	
	```wl
	ResLargeur = ATT_AttributLargeur[8]
	// Equivalent à : ResLargeur = ZR_Client[8].SAI_AdresseClient.Largeur
	```


- Connaître la largeur du champ "SAI_AdresseClient" lié à l'attribut "ATT_AttributLargeur" dans le champ Zone répétée "ZR_Client" pour la répétition en cours :
	
	```wl
	ResLargeur = ATT_AttributLargeur
	// Equivalent à : ResLargeur = ZR_Client.SAI_AdresseClient.Largeur
	```









<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Récupérer la valeur des différents champs/attributs d'une répétition d'un champ Zone répétée
<a name="recuperer_valeur_des_differents_champsattributs_une_repetition_champ_zone_repetee_ELTTEXTE000309"></a>


### Contenu de la répétition en cours
<a name="contenu_repetition_cours_ELTPARAGRAPHE000140"></a>Pour récupérer le contenu de la répétition en cours :


```txt
<Valeur> = <Nom Zone répétée>[<Nom Zone répétée>]
```


Le résultat est une chaîne de caractères contenant :

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) chaque attribut et/ou chaque champ séparé par TAB.



<a name="NOTE4_2"></a>


### Contenu d'une répétition spécifique
<a name="contenu_une_repetition_specifique_ELTPARAGRAPHE000158"></a>Pour récupérer le contenu de la répétition d'indice &lt;Indice&gt; :


```txt
<Valeur> = <Nom Zone répétée>[<Indice>]
```


Le résultat est une chaîne de caractères contenant :

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) chaque attribut et/ou chaque champ séparé par TAB.










<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Se positionner sur une répétition spécifique
<a name="positionner_sur_une_repetition_specifique_ELTTEXTE000339"></a>
Pour se positionner sur une répétition spécifique, utilisez la syntaxe suivante :


```txt
<Nom Zone répétée> = <Indice>
```


Par exemple :


```wl
// Ajout d'une répétition vide
ZoneRépétéeAjoute(ZR_Produit)
// Positionnement sur la répétition vide
ZR_Produit = ZoneRépétéeOccurrence(ZR_Produit)
```





