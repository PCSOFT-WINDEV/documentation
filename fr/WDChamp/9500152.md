


## Colonnes de type Combo dans les champs Table (syntaxe préfixée)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000104"></a>
Un champ Table (par programmation, fichier ou sur variable) peut comporter des colonnes de type Combo.

Les colonnes de type Combo peuvent être utilisées par exemple pour visualiser dans un champ Table les rubriques d'un fichier de données de type "Combo, Liste, Sélecteur ou Interrupteur". Les colonnes de type Combo permettent également d'afficher des images dans un champ Table.

**Rappel** : Pour afficher une image dans un champ Table, utilisez une colonne de type Image.

Pour plus de détails sur les champs Combo, consultez [Champ Combo](../WDChamp/1013023.md).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Créer une colonne de type Combo
<a name="creer_une_colonne_type_combo_ELTTEXTE000139"></a>
Pour créer une colonne de type Combo, il suffit de sélectionner l'option "Combo" dans le type de la colonne :<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Champ_Table_Combo.gif&type=thumb)


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Caractéristiques des colonnes de type Combo
<a name="caracteristiques_des_colonnes_type_combo_ELTTEXTE000166"></a>
D'une manière générale, une colonne de type Combo dans un champ Table a toutes les caractéristiques d'un champ Combo. Cette colonne de type Combo peut être par exemple liée à un fichier de données.

Plus particulièrement, les caractéristiques suivantes sont disponibles :

- Combo avec ou sans saisie (onglet "Détail" de la description de la colonne).

- Combo avec ou sans saisie assistée (onglet "Détail" de la description de la colonne).

- Combo triée ou non (cas des champs Combo par programmation uniquement, onglet "Détail" de la description de la colonne).

- Paramétrage du bouton associé à la combo de la colonne (onglet "Détail" de la description de la colonne).

- Paramétrage de la liste déroulée : largeur, hauteur, liste redimensionnable (onglet "Détail" de la description de la colonne). 

- Affichage ou non du bandeau de sélection dans la combo de la colonne (onglet "UI" de la description de la colonne). 

- Paramétrage du style de la combo de la colonne (onglet "Style", élément "Colonne combo (bouton)"). 




Si la colonne de type Combo n'est pas liée à une rubrique de fichier de données, il est possible de saisir le contenu initial de la colonne.

**Remarque** : La hauteur d'une ligne de la colonne de type Combo est celle de la hauteur d'une ligne du champ Table.
<a name="NOTE3_2"></a>
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Limites en Java
<a name="limites_java_ELTPARAGRAPHE000213"></a>En Java, les caractéristiques suivantes ne sont pas gérées :

- Le spin de la colonne de type Combo est visible uniquement sur la ligne en cours.

- La hauteur et la largeur déroulée personnalisée.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Programmation d'une colonne de type Combo
<a name="programmation_une_colonne_type_combo_ELTTEXTE000221"></a>


### Initialisation du contenu de la colonne de type Combo
<a name="initialisation_contenu_colonne_type_combo_ELTPARAGRAPHE000244"></a>Le contenu de la colonne de type Combo peut être initialisé :

- sous l'éditeur, dans le détail de la colonne : il ne peut alors pas être graphique.

- par programmation avec la fonction [&lt;Liste&gt;.Ajoute](../WDLang1/1000017319.md), par exemple dans l'événement "Initialisation" du champ Table.




Le contenu de la colonne de type Combo ne pourra pas être modifié, même si le champ Combo est en saisie. Ainsi, les valeurs proposées dans une colonne de type Combo seront les mêmes pour toutes les lignes du champ Table.
<a name="NOTE4_2"></a>


### Sélection d'un élément de la colonne de type Combo par programmation
<a name="selection_element_colonne_type_combo_par_programmation_ELTPARAGRAPHE000264"></a>Pour sélectionner un élément de la colonne de type Combo, il suffit de spécifier l'indice de l'élément de la combo à afficher. Cet indice peut être utilisé avec les [fonctions de gestion des champs Table](../WDLang1/1000024319.md).

Par exemple :

- ajout d'une ligne avec la fonction [&lt;Table&gt;.Ajoute](../WDLang1/1000023600.md) :
	
	```wl
	// TABLE_TableClient contient :
	// - une colonne de type Combo affichant la civilité des clients
	// (1 correspond à "Mr", 2 à "Mme" et 3 à "Melle")
	// - une colonne de type chaîne affichant le nom des clients
	// Ajout de "Mr" et "Dubois" à la fin de ce champ Table
	TABLE_TableClient.Ajoute(1 + TAB + "Dubois")
	```


- modification de la 5° ligne avec la fonction [&lt;Table&gt;.ModifieLigne](../WDLang1/1000024275.md) : 
	
	```wl
	// TABLE_TableClient contient :
	// - une colonne de type Combo affichant la civilité des clients
	// (1 correspond à "Mr", 2 à "Mme" et 3 à "Melle")
	// - une colonne de type chaîne affichant le nom des clients
	// Modification de la 5° ligne avec "Mme" et "Thomas"
	TABLE_TableClient.ModifieLigne(5, 2, "Thomas")
	```




<a name="NOTE4_3"></a>


### Récupération du contenu d'une colonne de type Combo
<a name="recuperation_contenu_une_colonne_type_combo_ELTPARAGRAPHE000306"></a>La valeur sélectionnée dans une colonne de type Combo peut être récupérée avec la propriété [Valeur](../Proprietes/2510130.md).
<a name="NOTE4_4"></a>


### Combo avec ou sans saisie
<a name="combo_avec_sans_saisie_ELTPARAGRAPHE000319"></a>

- **Important** :

	- **Dans une colonne de type Combo sans saisie**, il n'est pas possible de récupérer directement le contenu d'une combo : seul l'indice peut être connu. Pour connaître la valeur sélectionnée dans la colonne de type Combo, utilisez la propriété [ValeurAffichée](../Proprietes/2510129.md).

	- **Dans une colonne de type Combo avec saisie**, le contenu de la combo peut être récupéré directement.




- La colonne de type combo mémorise l'indice correspondant de la combo (si une rubrique est associée à la colonne, la rubrique mémorise l'indice également). Il est donc fondamental que le contenu du champ Combo ne soit pas modifié.

- Les événements associés à une colonne de type Combo sont identiques à ceux d'un champ Combo.

- Les colonnes de type Combo sans saisie et "en affichage seulement" ne se déroulent pas.



<a name="NOTE4_5"></a>


### Remarque
<a name="remarque_ELTPARAGRAPHE000338"></a>Les champs Combo dans les champs Table ont le même contenu pour toutes les lignes : seule la valeur sélectionnée change en fonction de la ligne. Il est toutefois possible depuis la version 14 de changer le contenu des colonnes de type Combo pour chaque ligne. Il faut pour cela utiliser la propriété [Contenu](../Proprietes/1000017242.md) de la colonne de type Combo.


