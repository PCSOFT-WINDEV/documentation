


## Le champ OLE
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation du champ OLE
<a name="presentation_champ_ole_ELTTEXTE000112"></a>
Le champ OLE permet de manipuler un objet OLE.

**Rappel** : OLE est un protocole d'échange de données et de commandes dont le principe consiste à imbriquer et lier des objets. Dès que l'objet incorporé est ouvert, la connexion Client/Serveur est ouverte.

Un **objet OLE** est un fichier qui contient :

- la référence du Serveur OLE qui a créé l'objet

- l'objet lui-même (image, document feuille...).




Plus techniquement, un objet OLE correspond à des données encapsulées contenant des données diverses telles que des textes, des images, des sons... L'encapsulation des données dans les objets OLE permet d'incorporer ces objets sans avoir besoin de connaître leur structure.

**Pour créer un champ de type OLE** : 

1. Sous le volet "Création", dans le groupe "Autres champs", cliquez sur "OLE".

2. Cliquez dans la fenêtre à la position où le champ doit être créé.




Pour afficher les caractéristiques du champ, sélectionnez l'option "Description" dans le menu contextuel du champ.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## WINDEV et les champs OLE
<a name="windev_les_champs_ole_ELTTEXTE000136"></a>
WINDEV est un client OLE. Les applications développées avec WINDEV demandent des données, affichent et stockent les objets OLE.

Les serveurs OLE mettent à disposition les objets aux clients qui en font la demande. Ce sont par exemple Paint Brush, Excel, WinWord...

En tant que client, WINDEV sait gérer des objets OLE. Il permet de :

- dessiner un objet dans un champ OLE. Un objet peut être par exemple une feuille Excel, une image graphique de Paint Brush...

- d'éditer un objet OLE dans un champ OLE. L'objet OLE peut être :

	- choisi sous l'éditeur ou par programmation.

	- défini en fonction d'un serveur ou d'un fichier de base.







Remarques :

- En programmation, un champ OLE est manipulé par des fonctions spécifiques. WINDEV n'est pas un serveur OLE.

- OLE version 1 et OLE version 2 sont gérés (les versions supérieures ne sont pas gérées).

- Un objet OLE ne peut pas être imprimé avec WINDEV. La mise à jour de l'objet s'effectue à la demande.

- Un champ OLE ne peut contenir qu'un seul objet OLE.





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDPilotagedeExcel.gif) ***Exemples didactiques (WINDEV)*** : **WD Pilotage de Excel** <br>Cet exemple montre comment piloter Excel via OLE Automation. <br>Toutes les fonctions d'Excel peuvent être ainsi pilotées.<br><br>Cet exemple nécessite une version Excel 97 ou supérieure.<br><br>Résumé de l'exemple livré avec WINDEV :	<br>Piloter un logiciel bureautique comme Excel peut s'avérer utile pour analyser des données provenant d'une base de données. <br>Grâce à la classe "CExcel" livrée avec WINDEV, ce traitement devient très simple.<br>Les principales fonctions de Excel sont directement pilotables (graphe, insertion d'objets, tris...).<br>Comment piloter Excel via OLE Automation ?<br>Un objet OLE Automation dispose de méthodes et de propriétés. Ceci permet de le piloter directement en WLangage.<br>Par exemple, pour mettre la cellule sélectionnée en gras :<br>MonObjetOLEAutomation>>Selection>>Font>>Bold = Vrai
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDPilotagedeWord.gif) ***Exemples didactiques (WINDEV)*** : **WD Pilotage de Word** <br>Cet exemple montre comment piloter Word via OLE Automation. <br>Toutes les fonctions de Word peuvent être ainsi pilotées.<br>Cet exemple est compatible avec les versions 97, 2000 et 2002 (XP) de Word. <br>Résumé de l'exemple livré avec WINDEV :	<br>Piloter un traitement de texte comme Word peut s'avérer utile pour permettre à  l'utilisateur de conserver ses habitudes depuis le logiciel développé avec WINDEV.<br>Grâce à la classe "CWord" livrée avec WINDEV, ce traitement devient très simple.<br>Les principales fonctions de Word peuvent être appelées directement (format de texte, insertion d'objets, publipostage...).<br>Comment piloter Word via OLE Automation ?<br>Un objet OLE Automation dispose de méthodes et de propriétés. Ceci permet de le piloter directement en WLangage.<br>Par exemple, pour mettre le texte sélectionné en gras :<br>MonObjetOLEAutomation>>Selection>>Font>>Bold = Vrai
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDPilotagedeOutlook.gif) ***Exemples didactiques (WINDEV)*** : **WD Pilotage de Outlook** <br>Ce programme réalisé avec WINDEV permet de lire et écrire dans les dossiers d'Outlook :<br>- Messagerie<br>- Calendrier<br>- Contacts<br>- Tâches<br>- Notes<br><br>Un dialogue OLE est utilisé pour lire et écrire des données dans les fichiers d'Outlook. <br>NB : il s'agit ici du logiciel Outlook livré avec les versions récentes de MS-Office. Il ne s'agit pas de "Outlook express". <br><br>"WD Pilotage de Outlook" présente également un exemple concret d'utilisation du databinding de WINDEV entre des variables du code et des champs.<br><br>C'est aussi un exemple qui présente la POO (Programmation Orientée Objet) et les diagrammes UML.


