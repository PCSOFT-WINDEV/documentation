


## Evénements associés à un champ Tableau croisé dynamique
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Evénements gérés par défaut dans une fenêtre
<a name="evenements_geres_par_defaut_dans_une_fenetre_ELTTEXTE000150"></a>
WINDEV gère par défaut les événements suivants (ordre d'apparition sous l'éditeur de code) :

| Evénement | Condition d'exécution |
| --- | --- |
| Initialisation | Exécuté à l'ouverture de la fenêtre. \* |
| Entrée | Exécuté lorsque le champ prend le focus. |
| Sortie | Exécuté lors du changement de champ (touche TAB, changement de champ par la souris, ...) |
| Affichage d'une cellule | Exécuté lors de l'affichage du résultat dans une cellule. |
| Sélection d'une cellule | Exécuté lors de la sélection d'une cellule (à la souris par exemple) |


(\*) Par défaut, l'événement "Initialisation" de chaque champ est exécuté selon l'ordre de création des différents champs dans la fenêtre. Pour modifier cet ordre d'exécution : 

1. Sous le volet "Fenêtre", dans le groupe "Ordre", cliquez sur "Initialisation".

2. Dans la fenêtre qui s'affiche, utilisez les flèches situées sur la droite pour modifier l'ordre d'initialisation des champs.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Evénements gérés par défaut dans un état
<a name="evenements_geres_par_defaut_dans_etat_ELTTEXTE000174"></a>
WINDEV gère par défaut les événements suivants (ordre d'apparition sous l'éditeur de code) :

| Evénement | Condition d'exécution |
| --- | --- |
| Initialisation | Exécuté lors de l'initialisation de l'état. |
| Avant impression | Exécuté avant l'impression du champ. |
| Avant impression de cellule | Exécuté avant l'impression d'une cellule du champ Tableau croisé dynamique. Cet événement permet de manipuler la valeur de la cellule du champ Tableau croisé dynamique avant impression. <br><br>Lors de la création d'un état Tableau croisé dynamique, un champ représentant la cellule est créé. Le nom de ce champ commence par "VAL_".<br><br>Vous pouvez par exemple modifier les propriétés de ce champ (couleur, couleur de fond, ...) en fonction de sa valeur :<br><br><pre><code>SI VAL_TCD > 400 alors<br>	VAL_TCD.Couleur = VertClair<br>	VAL_TCD.CouleurFond = RougeClair<br>FIN</code></pre><br> |



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Evénements optionnels (champ d'une fenêtre)
<a name="evenements_optionnels_champ_une_fenetre_ELTTEXTE000198"></a>
Plusieurs événements optionnels peuvent être gérés par un champ Tableau croisé dynamique présent dans une fenêtre. 
Pour ajouter un événement optionnel :

1. Sélectionnez le champ voulu.

2. Affichez la fenêtre de code de ce champ (touche F2).

3. Cliquez sur le lien "Ajouter d'autres événements à xxx" situé à la fin de la fenêtre de code, après le dernier événement.  <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Traitements_optionnels_WD_OK%20-%20HC%20N%B0001.gif)


4. La totalité des événements optionnels disponibles pour le champ est affichée. 

5. Cochez l'événement optionnel à ajouter et validez. 
	Remarque : Il est possible de sélectionner plusieurs événements optionnels. 

6. L'événement optionnel sélectionné est automatiquement ajouté dans les événements gérés par le champ.




Pour désactiver un événement optionnel, il suffit d'effectuer les mêmes manipulations pour afficher la liste des événements optionnels. Il suffit ensuite de décocher les événements optionnels à supprimer. 
Remarque : Si le code désactivé contient du code WLangage, ce code est automatiquement supprimé.Il est ainsi possible de gérer par exemple :

- le survol du champ par la souris,

- le bouton gauche enfoncé, relâché, avec un double-clic,

- le bouton droit enfoncé, relâché, avec double-clic,

- la roulette de la souris, ...




Pour plus de détails, consultez les [Evénements optionnels](../WDChamp/1014004.md).


