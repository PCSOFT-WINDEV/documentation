


## Manipuler un champ Combo par programmation
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000489"></a>
WINDEV, WINDEV Mobile et WEBDEV permettent de manipuler un champ Combo directement par programmation. Il suffit d'utiliser directement la variable du champ Combo dans le code. Cette variable est de type numérique.

La variable du champ Combo :

- correspond au nom du champ Combo.

- est initialisée avec l'indice de l'élément sélectionné dans le champ.




Pour manipuler un élément du champ Combo, il suffit d'utiliser la notation suivante :

```txt
<Champ Combo>[<Indice de l'élément>]
```


**Remarque** : De nombreuses fonctions du WLangage sont spécifiques à la gestion des champs de type Combo. Pour plus de détails, consultez : [les fonctions de gestion des champs Liste et Combo](../WDLang1/3049001.md) et [fonctions spécifiques à la gestion des champs Combo](../WDLang1/3026002.md).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Initialiser et remplir un champ Combo
<a name="initialiser_remplir_champ_combo_ELTTEXTE000513"></a>


### Initialiser un élément
<a name="initialiser_element_ELTPARAGRAPHE000039"></a>Pour initialiser un élément d'un champ Combo avec ou sans saisie, utilisez la fonction [ListeAjoute](../WDLang1/3049004.md).

Pour modifier un élément d'un champ Combo avec ou sans saisie, vous pouvez utiliser l'affectation directe :

```txt
<Champ Combo>[Indice] = <Valeur>
```

<a name="NOTE2_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Initialiser le champ de saisie (champ Combo avec saisie)
<a name="initialiser_champ_saisie_champ_combo_avec_saisie_ELTPARAGRAPHE000059"></a>Pour initialiser le champ de saisie d'un champ Combo avec saisie, utilisez :

- soit l'affectation directe :
	
	```txt
	<Champ Combo> = <Valeur>
	```


- soit la fonction [ListeAjoute](../WDLang1/3049004.md).
	
	```wl
	// Ajout d'éléments dans un champ Combo
	ListeAjoute(COMBO_COMBO1, "DUPOND")
	ListeAjoute(COMBO_COMBO1, Nom_Cli)
	```




<a name="NOTE2_3"></a>


### Remplir un champ Combo
<a name="remplir_champ_combo_ELTPARAGRAPHE000088"></a>Pour initialiser un champ Combo, il suffit d'utiliser une boucle d'itération pour initialiser tous les éléments du champ.

```txt
Indice est un entier
POUR Indice = <Position Début> A <Position Fin>
	ListeAjoute(<Champ Combo>, <Valeur>)
FIN
```
Exemple : 

```wl
i est un entier 
POUR i = 1 A 52 
	ListeAjoute(COMBO_COMBO, NOM[i]) 
FIN
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Sélectionner un élément dans un champ Combo
<a name="selectionner_element_dans_champ_combo_ELTTEXTE000549"></a>


### Sélectionner un élément dans un champ Combo
<a name="selectionner_element_dans_champ_combo_ELTPARAGRAPHE000112"></a>Pour sélectionner l'élément de la ligne &lt;Indice&gt;, utilisez :

- soit l'affectation directe :
	
	```txt
	<Champ Combo> = Indice
	```


- soit la fonction [ListeSelectPlus](../WDLang1/3049012.md) :
	
	```txt
	ListeSelectPlus(<Champ Combo>, <Indice>)
	```



![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) **Remarque** : Pour un champ Combo avec saisie, seule la seconde syntaxe est possible.

**Remarque** : Si le champ Combo est initialisé avec la fonction [gValeurMémorisée](../WDLang1/1410088363.md), il est nécessaire d'utiliser la valeur de la fonction [gValeurMémorisée](../WDLang1/1410088363.md) pour sélectionner un élément. 
Par exemple, si le champ Combo est initialisé avec le code : 

```wl
ListeAjoute(COMBO_Personne, "Mon texte" + gValeurMémorisée(ValeurMémorisée))
```
le code suivant permettra de sélectionner un élément : 

```wl
COMBO_Personne = ValeurMémorisée
```
<a name="NOTE3_2"></a>


### Sélectionner le dernier élément d'un champ Combo
<a name="selectionner_dernier_element_champ_combo_ELTPARAGRAPHE000154"></a>Pour se positionner sur le dernier élément du champ Combo, utilisez :

- soit la propriété [Occurrence](../WDLang1/3025009.md) : 
	
	```txt
	<Champ Combo> = <Champ Combo>.Occurrence
	```


- soit la fonction [ListeSelectPlus](../WDLang1/3049012.md) associée à la propriété [Occurrence](../WDLang1/3025009.md) :
	
	```txt
	ListeSelectPlus(<Champ Combo>, <Champ Combo>.Occurrence)
	```


- soit la fonction [ListeOccurrence](../WDLang1/3049014.md) :
	
	```txt
	<Champ Combo> = ListeOccurrence(<Champ Combo>)
	```



![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) **Remarque** : Pour un champ Combo avec saisie, seule la dernière syntaxe est possible.


<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Récupérer l'élément sélectionné dans le champ Combo
<a name="recuperer_element_selectionne_dans_champ_combo_ELTTEXTE000579"></a>


### Récupérer l'indice de l'élément sélectionné
<a name="recuperer_indice_element_selectionne_ELTPARAGRAPHE000206"></a>Pour récupérer l'indice de l'élément sélectionné, utilisez :

- soit la lecture directe de l'élément :
	
	```txt
	Indice = <Champ Combo>
	```





- soit la fonction [ListeSelect](../WDLang1/3049011.md) :
	
	```txt
	Indice = ListeSelect(<Champ Combo>)
	```



![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) **Remarque** : Ces deux syntaxes peuvent être utilisées dans les champs Combo avec ou sans saisie. Pour un champ Combo avec saisie, si l'élément a été modifié dans le champ de saisie, la fonction [ListeSelect](../WDLang1/3049011.md) renvoie le contenu du champ de saisie.
<a name="NOTE4_2"></a>


### Récupérer la valeur de l'élément sélectionné
<a name="recuperer_valeur_element_selectionne_ELTPARAGRAPHE000238"></a>Pour récupérer la valeur de l'élément sélectionné, utilisez une des syntaxes suivantes :

- Syntaxe 1 : Champ Combo sans saisie
	
	```txt
	indice est un entier = <Champ Combo>
	<Variable> = <Champ Combo>[indice]
	```


- Syntaxe 2 : Champ Combo sans saisie
	
	```txt
	<Variable> = <Champ Combo>[<Champ Combo>]
	```


- Syntaxe 3 : Champ Combo avec ou sans saisie : Propriété [ValeurAffichée](../Proprietes/2510129.md)
	
	
	```txt
	<Variable> = <Champ Combo>.ValeurAffichée
	```


- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Syntaxe spécifique : Champ Combo avec saisie :
	
	```txt
	<Variable> = <Champ Combo>
	```





<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Chercher un élément dans un champ Combo avec table
<a name="chercher_element_dans_champ_combo_avec_table_ELTTEXTE000609"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Pour rechercher un élément dans un champ Combo avec table, utilisez la fonction [TableCherche](../WDLang1/3074015.md).

**Rappel** : Pour effectuer une recherche dans un champ Combo "classique", utilisez la fonction [ListeCherche](../WDLang1/3049003.md).

<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Propriétés spécifiques à la gestion des champs Combo
<a name="proprietes_specifiques_gestion_des_champs_combo_ELTTEXTE000633"></a>
Les propriétés suivantes sont spécifiques à la gestion des champs Combo : 


|   |   |
| --- | --- |
| **Tout type de combo** |
| [CadrageHorizontal](../Proprietes/2510023.md) | Permet de connaître et de modifier le cadrage horizontal des éléments du champ Combo. |
| [Ellipse](../Proprietes/2510051.md) | Permet de connaître et modifier le mode de gestion de l'ellipse. |
| [HauteurLigne](../Proprietes/2510041.md) | Permet de connaître et de modifier la hauteur des lignes d'un champ Combo. |
| [Mémoire](../Proprietes/2510076.md) | Permet de savoir si le champ spécifié est un champ Combo par programmation ou un champ Combo fichier. |
| [Occurrence](../WDLang1/3025009.md) | Permet de connaître le nombre de lignes présentes dans un champ Combo. |
| [TypeRemplissage](../Proprietes/1000017723.md) | Permet de connaître le type de remplissage (fichier, par programmation, sur variable) d'un champ Combo. |
| [Vide](../Proprietes/2510126.md) | Permet de savoir si un champ Combo est vide. |
| **Champ Combo avec saisie uniquement** |
| [AvecSaisie](../Proprietes/1000020285.md) | Permet de connaître et de modifier le mode de saisie du champ Combo (combo avec ou sans saisie). |
| [Curseur](../Proprietes/2510025.md) | Permet de connaître et de modifier la position du curseur de la souris dans un champ. |
| [FinCurseur](../Proprietes/2510047.md) | Permet de connaître et de modifier la position de fin de sélection du curseur de la souris. |
| [FormatMémorisé](../Proprietes/2510048.md) | Permet de connaître et de modifier le format de la valeur retournée. |
| [MasqueAffichage](../Proprietes/1000020008.md) | Permet de connaître et de modifier le masque d'affichage. |
| [MasqueSaisie](../Proprietes/2510033.md) | Permet de connaître et de modifier le masque de saisie. |
| [Taille](../Proprietes/2510125.md) | Permet de connaître et de modifier le nombre maximum de caractères contenus dans le champ de saisie de la combo. |
| [TexteSélectionné](../Proprietes/1000017193.md) | Permet de connaître et de modifier le texte sélectionné dans le champ de saisie de la combo. |
| [TypeSaisie](../Proprietes/2510136.md) | Permet de connaître et de modifier le type de données saisies dans le champ de saisie de la combo. |
| **Champ Combo sans saisie uniquement** |
| [RechercheFAA](../Proprietes/1000023445.md) | Permet de : <br><br>- savoir si la recherche est active sur un champ Combo sans saisie, <br><br>- activer ou non la recherche via la FAA sur un champ Combo sans saisie. <br><br><br> |
| **Champ Combo par programmation uniquement** |
| [ContenuInitial](../Proprietes/2510021.md) | Permet de connaître le contenu initial d'un champ Combo par programmation. |
| [Triée](../Proprietes/2510115.md) | Permet de savoir si un champ Combo par programmation est triée et de trier un champ Combo par programmation. |
| **Champ Combo Fichier uniquement** |
| [FichierParcouru](../Proprietes/2510040.md) | Permet de connaître et de modifier le fichier de données ou la requête utilisé pour l'affichage des enregistrements dans les champs Combo fichier. |
| [ParcoursAuto](../Proprietes/2510093.md) | Permet de savoir si le parcours d'un champ Combo fichier est automatique ou programmé. |
| [RubriqueAffichée](../Proprietes/2510123.md) | Permet de connaître ou de modifier la rubrique affichée dans un champ Combo. |
| [RubriqueMémorisée](../Proprietes/2510110.md) | Permet de connaître ou de modifier la rubrique mémorisée d'un champ Combo. |
| [RubriqueParcourue](../Proprietes/2510111.md) | Permet de connaître et de modifier la rubrique utilisée pour le parcours automatique des champs Combo. |


Pour connaître la liste complète des propriétés du WLangage pouvant être utilisées avec un champ de type Combo, consultez [Propriétés associées au champ Combo](../WDChamp/1013014.md).


