
## Table et Zone répétée infinie
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000181"></a>
Un champ Table et/ou Zone répétée par programmation peut être rempli selon deux méthodes : 

- **Remplissage du champ dans sa totalité** : Toutes les données présentes dans le champ sont chargées à l'initialisation du champ. 
	**Avantage** : Toutes les valeurs sont présentes dans le champ. Il est possible de faire des recherches ou des tris sur les éléments contenus dans le champ. 
	**Inconvénient** : L'occupation mémoire du champ et de ses données peut être important. Dans le cas des applications mobiles, le chargement complet peut consommer inutilement de la bande passante et ralentir l'affichage. 

- **Remplissage si nécessaire (Table et Zone répétée infinie)** : Seules les données visibles par l'utilisateur sont chargées en mémoire. Les données supplémentaires sont chargées à la demande (par exemple en cas d'utilisation de l'ascenseur). 
	**Avantage** : Occupation mémoire faible. Dans le cas des applications mobiles, accélération de la vitesse d'affichage et limitation de la consommation de bande passante. 
	**Inconvénient** : Pas de tris ni de recherches tant que toutes les données ne sont pas disponibles. 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000205"></a>


### Paramétrage du champ
<a name="parametrage_champ_ELTPARAGRAPHE000030"></a>Pour activer le mécanisme du remplissage si nécessaire (Table infinie/Zone répétée infinie) : 

1. Affichez la fenêtre de description du champ. 

2. Dans l'onglet "Contenu", dans la zone "Table infinie"/"Zone répétée infinie" : 

	- Cochez la case "Appeler le traitement d'ajout d'éléments supplémentaires à la fin du défilement". 

	- Sélectionnez la fenêtre interne de patience (ou la page interne de patience) affichée lors du chargement des lignes supplémentaires. Il est possible de : 

		- Utiliser la fenêtre/page interne de patience par défaut, 

		- Utiliser la fenêtre/page pré-définie. Si cette option est sélectionnée, le composant interne WDFAA est immédiatement ajouté dans le projet en cours. Selon la plateforme, l'élément correspondant (fenêtre ou page) est automatiquement associé à l'option "Fenêtre interne de patience" ou "Page interne de patience". 

			- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) En WINDEV, la fenêtre interne s'appelle "FI_AjoutElementSuppl_WD". 


 Remarque : Si le composant WDFAA existe déjà, seule la fenêtre interne (ou la page interne) est ajoutée au composant.

- Utiliser une fenêtre/page interne de votre projet. 

- Indiquez le **nombre de lignes maximum** : Ce nombre correspond au nombre maximum de lignes pouvant être ajoutées au champ. Lorsque ce nombre sera atteint, l'événement "Ajout d'éléments supplémentaires" ne sera plus appelé. 

3. Validez la fenêtre de description du champ. 




Le paramétrage du champ Table ou Zone répétée infinie a ajouté : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) En WINDEV et WINDEV Mobile : l'événement "Ajout d'éléments supplémentaires" dans les événements du champ. 




**Remarque** : Cette option n'est pas disponible pour : 

- les champs Zone répétée horizontale, Zone répétée fichier et Zone répétée multicolonne. 

- les champs Table fichier. 





<a name="NOTE2_2"></a>


### Evénement "Ajout d'éléments supplémentaires"
<a name="evenement_ajout_elements_supplementaires_ELTPARAGRAPHE000083"></a>L'événement "Ajout d'éléments supplémentaires" doit contenir le code de mise à jour des données dans le champ. Par défaut, la fenêtre interne de patience est affichée pendant l'exécution de ce code. A la fin de l'exécution de ce code, la fenêtre interne de patience sera automatiquement masquée.

**Remarque** : Cet événement est appelé automatiquement : 

- lors de l'initialisation de la fenêtre, si le champ est vide. 

- après l'initialisation de la fenêtre, si toutes les lignes du champ sont visibles

- après l'agrandissement du champ, si toutes les lignes du champ sont visibles (alors qu'elles ne l'étaient pas avant l'agrandissement).

- après un défilement vers le bas, si la dernière ligne du champ est visible.




**Attention** : **Si la fenêtre interne par défaut est sélectionnée**, une jauge (fenêtre de patience) est affichée pendant l'exécution de l'événement "Ajout d'éléments supplémentaires". Cette jauge sera affichée uniquement si le thread principal peut s'exécuter pendant l'exécution de l'événement "Ajout d'éléments supplémentaires". 
Pour voir la jauge, il est nécessaire d'effectuer un traitement long du rafraîchissement (par exemple, requête HTTP ou parcours HFSQL) dans un thread exécuté depuis l'événement "Ajout d'éléments supplémentaires". Dans ce cas, il est nécessaire de gérer la jauge via les fonctions [TableAjoutEnCours](../WDLang1/1000021966.md) et [ZoneRépétéeAjoutEnCours](../WDLang2/1000021638.md).

Exemple de code pour l'événement "Ajout d'éléments supplémentaires" : Compléter un champ Table avec les derniers emails non lus : 

```wl
IdSession est un entier
EmailLu est un Email
 
// Charge les derniers messages non lus
EmailLitPremier(IdSession, EmailLu, emailNonLus)
TANTQUE PAS Email.EnDehors	
	// Traitement du message
	TableAjouteLigne(TABLE_Email, EmailLu.Expediteur, EmailLu.DateRéception, EmailLu.MessageID)
	EmailLitSuivant(IdSession, EmailLu, emailNonLus)
FIN
```


Remarque : Si l'événement "Ajout d'éléments supplémentaires" renvoie <u><u><u><u>Faux</u></u></u></u> : 

- la fenêtre interne de patience n'est plus affichée, 

- l'événement "Ajout d'éléments supplémentaires" n'est plus exécuté. 





<a name="NOTE2_3"></a>


### Personnalisation de la fenêtre ou page de patience
<a name="personnalisation_fenetre_page_patience_ELTPARAGRAPHE000123"></a>La jauge affichée pendant le chargement est contenue dans une fenêtre interne ou une page interne. 

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Par défaut, une fenêtre interne standard est utilisée, mais elle peut être intégrée au projet pour personnalisation. La gestion de la jauge est automatique. La fenêtre interne utilisée doit juste contenir un champ Jauge infini. 






