


## Android : Conditions d'utilisation du champ Carte
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000142"></a>
**Jusqu'à la version 180046 de WINDEV Mobile**, l'utilisation d'un champ Carte dans une application Android nécessitait l'utilisation de la librairie Google Maps API v1. 
Cette librairie est préinstallée sur la plupart des téléphones et des tablettes. Il suffit d'obtenir une clé générée à partir du certificat utilisé pour signer l'application pour pouvoir utiliser cette librairie dans l'application. Pour plus de détails, consultez [Conditions d'utilisation d'un champ Carte avant la version 180056](../WDChamp/1000019820.md).

La version 1 de cette librairie a été dépréciée par Google le 3 décembre 2012. A partir de 3 Mars 2013, il n'est plus possible de générer de nouvelles clés pour pouvoir utiliser la librairie en version 1. Toutefois les applications existantes continuent de fonctionner et il est possible de réutiliser les clés précédemment générées dans d'autres applications à condition qu'elles soient signées avec le même certificat que celui utilisé pour la génération de la clé.

**A partir de la version 180056 de WINDEV Mobile** : A partir du 3 mars 2013, pour les applications ne disposant pas d'une clé Google Maps API v1, il est donc nécessaire d'utiliser la version 2 de la librairie.
 
La marche à suivre pour l'utilisation de cette nouvelle librairie dans une application Android est assez différente et plus complexe. Cette page d'aide décrit les différentes étapes nécessaires.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Etapes nécessaires
<a name="etapes_necessaires_ELTTEXTE000166"></a>
L'utilisation de la librairie Google Maps API v2 dans une application Android se fait en plusieurs étapes. La plupart de ces étapes ne sont à faire qu'une seule fois. 

1. [Installer le SDK Google Play Services](#NOTE3_1). 

2. [Obtenir une clé pour l'utilisation de la librairie](#NOTE4_1).

3. Copier la clé dans l'assistant de génération de l'application Android. 






<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Etape 1 : Installer le SDK Google Play Services
<a name="etape_1_installer_sdk_google_play_services_ELTTEXTE000190"></a>
Le SDK Google Play Services peut être téléchargé et installé directement depuis le SDK Manager d'Android : 

1. Lancez l'exécutable SDK Manager.exe qui se trouve dans le répertoire d'installation du SDK Android (il est conseillé de lancer en tant qu'administrateur).

2. Dans la liste des packages, sélectionnez "Extra/Google Play services".

3. Cliquez sur le bouton d'installation.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Etape 2 : Obtenir une clé pour l'utilisation de la librairie
<a name="etape_2_obtenir_une_cle_pour_utilisation_librairie_ELTTEXTE000214"></a>
Pour accéder aux données Google Maps via le champ Carte, il est nécessaire de générer une clé qui sera intégrée au manifeste de l'application générée. L'obtention de cette clé est gratuite et sans restriction sur le nombre d'applications ou d'utilisateurs.

La librairie Google Maps API v2 utilise un système gestion de clé différent de celui utilisé par la version 1 de la librairie. Les clés générées pour la précédente version ne sont pas compatibles avec ce nouveau système.

L'obtention d'une clé se fait depuis la console d'administration des clés de Google API à partir du certificat utilisé pour signer l'application et de son nom de package et se déroule en plusieurs étapes.

**1. Récupérer l'empreinte SHA-1 du certificat**

L'assistant de génération d'une application Android contenant un champ Carte récupère automatiquement une empreinte SHA-1 du certificat. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Android_Carte1_Bis.gif&type=thumb)
**2. Création d'une "API project"**

Les étapes suivantes doivent être suivies : 

1. Depuis un navigateur, ouvrez la page de la [console Google API](https://code.google.com/apis/console/). 

2. Authentifiez-vous en utilisant un compte Google.

3. Créez un nouveau projet API Project ou utilisez un projet existant.

4. Dans la liste des API associés au projet, activez le service Google Maps Android API v2 en positionnant l'interrupteur sur ON. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Android_Google1.gif&type=thumb)


5. Acceptez les conditions d'utilisation du service. 




**3. Génération de la clé**

Les étapes suivantes doivent être suivies : 

1. Dans la console Google API, cliquez sur "Credentials". 

2. Cliquez sur "CREATE NEW KEY". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Android_Google2.gif&type=thumb)


3. Dans la fenêtre popup qui s'ouvre, cliquez sur "Android key". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Android_Google3.gif)


4. Collez l'empreinte SHA-1 du certificat (générée par WINDEV Mobile). <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Android_Google4.gif)


5. Récupérez la clé générée dans la section "Key for Android apps (with certificates)".<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Android_Google5.gif&type=thumb)


6. La clé obtenue peut être copiée dans l'assistant de génération de l'application Android. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Android_Carte1_Bis.gif&type=thumb)






