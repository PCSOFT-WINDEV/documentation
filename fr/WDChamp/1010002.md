


## Menus et options de menu : Trucs & Astuces
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000320"></a>
Nous vous présentons ici quelques manipulations spécifiques aux menus et aux options de menu :

- [remplacer le libellé d'une option de menu par le contenu d'un champ](#NOTE2_1).

- [ajouter de l'aide sur une option de menu](#NOTE2_2).

- [personnaliser l'apparence d'un menu](#NOTE2_3).

- [rendre invisible un menu principal](#NOTE2_4).

- [exécuter du code avant l'affichage d'un menu contextuel](#NOTE2_5).

- [afficher un menu contextuel grâce à un clic gauche](#NOTE2_6).

- [dissocier un menu contextuel d'un champ ou d'une fenêtre](#NOTE2_7).

- [récupérer le numéro de la ligne et de la colonne d'une table sur lesquelles un clic droit est réalisé](#NOTE2_8).

- [changer de menu contextuel lors de la sélection d'un élément d'un champ Arbre](#NOTE2_9).




**Remarques** :

- Pour plus de détails sur les menus et sur les options de menu, consultez :

	- [Gestion des menus contextuels dans une application](../WDChamp/1010011.md).

	- [Gestion des menus principaux des fenêtres](../WDChamp/1010010.md).

	- [Manipuler les options de menu sous l'éditeur](../WDChamp/1010008.md).

	- [Manipuler les options de menu par programmation](../WDChamp/1010007.md).




- Tous ces "Trucs & Astuces" sont utilisables avec les menus principaux et les menus contextuels sauf mention contraire.






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Trucs et astuces
<a name="trucs_astuces_ELTTEXTE000344"></a>


### Remplacer le libellé d'une option de menu par le contenu d'un champ
<a name="remplacer_libelle_une_option_menu_par_contenu_champ_ELTPARAGRAPHE000072"></a>Il suffit de :

- récupérer le contenu du champ.

- modifier le libellé de l'option de menu avec la propriété [Libellé](../Proprietes/2510053.md) ou avec la fonction [MenuLibellé](../WDLang1/3038009.md).




Exemples : 

- Le libellé de l'option de menu "MonOption" doit correspondre à la valeur saisie dans le champ "MonChamp".
	
	```wl
	MonOption.Libellé = MonChamp
	// Équivalent à : MenuLibellé(MonOption, MonChamp)
	```


- Le libellé de l'option de menu "MonOption" doit correspondre au contenu de la cellule appartenant à la colonne "COL_MaColonne" et à la ligne sélectionnée par l'utilisateur dans le champ Table "TABLE_MaTable" :
	
	```wl
	MonOption.Libellé = COL_MaColonne[TableSelect(TABLE_MaTable)]
	// Équivalent à :
	// MenuLibellé(MonOption, COL_MaColonne[TableSelect(TABLE_MaTable)])
	```




<a name="NOTE2_2"></a>


### Ajouter de l'aide sur une option de menu
<a name="ajouter_aide_sur_une_option_menu_ELTPARAGRAPHE000097"></a>Pour détailler la fonctionnalité de chaque option de menu, il est possible d'afficher un message d'aide dans la barre de message de la fenêtre lorsqu'une option est mise en surbrillance.

**Comment faire ?**
La saisie de ce message d'aide s'effectue dans l'onglet "Aide" de la fenêtre de description des options de menu (option "Description de l'option" du menu contextuel). Ce message d'aide peut être multilingue.
Remarque : Ce message d'aide peut être modifié par programmation grâce à la fonction [Message](../WDLang1/3021006.md) ou grâce à la propriété [Message](../Proprietes/2510078.md).
<a name="NOTE2_3"></a>


### Personnaliser l'apparence d'un menu
<a name="personnaliser_apparence_menu_ELTPARAGRAPHE000116"></a>Pour personnaliser l'apparence d'un menu, il suffit de personnaliser le style d'une option de ce menu. Ces modifications seront automatiquement reportées sur toutes les options du menu.

Il est possible de personnaliser :

- la couleur de fond d'un menu.

- la police (taille, couleur, ...) des options d'un menu.

- la couleur de fond de l'option survolée.

- la police (taille, couleur, ...) de l'option survolée.




Pour personnaliser l'apparence d'un menu : 

1. Sélectionnez une option de menu.

2. Affichez l'onglet "Style" de la fenêtre de description des options de menu (option "Description de l'option" du menu contextuel).

3. Pour personnaliser :

	- la ***couleur de fond du menu*** : sélectionnez "Fond de l'option" dans la combo "Élément" et sélectionnez la couleur de fond de l'option.

	- la ***police des options du menu*** : sélectionnez "Texte de l'option" dans la combo "Élément" et sélectionnez les caractéristiques de la police (attributs, taille, couleur, ...)

	- la ***couleur de fond de l'option survolée*** : sélectionnez "Fond de l'option (survol)" dans la combo "Élément" et sélectionnez la couleur de fond de l'option survolée.







Remarque : La couleur de fond ou la couleur du texte peut être :

- soit une couleur prédéfinie. Sélectionnez cette couleur parmi celles proposées dans la combo "Couleur".

- soit une couleur personnalisée. Définissez cette couleur à l'aide du sélecteur de couleurs (bouton "..." à droite de la combo "Couleur").




Par exemple :<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=MenuCouleurFond.gif)


**Cas particulier : Menu au look XP**
Seules les caractéristiques de la police des options de menu seront prises en compte si le menu utilise le look XP. Pour plus de détails, consultez [Utilisez le look XP dans vos fenêtres](../WDChamp/1010006.md).

![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Il n'est pas possible de personnaliser l'apparence d'un menu.
<a name="NOTE2_4"></a>


### Rendre invisible le menu principal d'une fenêtre
<a name="rendre_invisible_menu_principal_une_fenetre_ELTPARAGRAPHE000159"></a>Pour rendre invisible le menu principal d'une fenêtre, il suffit de rendre invisible toutes les options "principales" du menu.

Exemple : Les options "principales" du menu suivant sont "Fichiers" et "Impressions".<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=OptionPrincipale.gif)
Pour rendre invisible ce menu principal, saisissez le code suivant :

```wl
// Rendre invisibles les options "Fichiers" et "Impressions" 
Fichiers.Visible = Faux
Impressions.Visible = Faux
// Équivalent à :
// MenuInvisible(Fichiers) 
// MenuInvisible(Impressions)
```

<a name="NOTE2_5"></a>


### Exécuter du code avant d'afficher le menu contextuel
<a name="executer_code_avant_afficher_menu_contextuel_ELTPARAGRAPHE000171"></a>Pour exécuter du code avant d'afficher le menu contextuel, il suffit d'ajouter l'événement optionnel "Affichage menu contextuel" dans le code de l'élément (champ ou fenêtre) associé au menu contextuel.

Comment le faire ?

1. Affichez le code de l'élément (champ ou fenêtre) associé au menu contextuel (option "Code" du menu contextuel de l'élément).

2. Cliquez sur le lien "Ajouter d'autres événements à xxx" situé à la fin de la fenêtre de code, après le dernier événement.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Traitements_optionnels_WD_OK%20-%20HC%20N%B0001.gif)


3. Dans la liste des événements optionnels, sélectionnez l'événement "Affichage menu contextuel" et validez. 

4. Saisissez dans cet événement optionnel le code à exécuter avant l'affichage du menu contextuel.



<a name="NOTE2_6"></a>


### Afficher un menu contextuel grâce à un clic gauche
<a name="afficher_menu_contextuel_grace_clic_gauche_ELTPARAGRAPHE000186"></a>Pour afficher un menu contextuel grâce à un clic gauche, il suffit de simuler l'action d'un clic droit dans l'événement optionnel "Bouton gauche enfoncé" d'un élément (champ ou fenêtre).

Pour que le menu contextuel s'affiche uniquement lors d'un clic gauche (et non lors d'un clic droit), l'élément (champ ou fenêtre) ne doit pas être associé par défaut à un menu contextuel.

**Exemple** : Les opérations nécessaires à l'affichage d'un menu contextuel grâce à un clic gauche sont illustrées par l'exemple suivant : Le menu contextuel "MonMenu" s'affiche uniquement lors d'un clic gauche sur le champ de saisie "SAI_MonChamp".

1. Affichez le code du champ "SAI_MonChamp" (option "Code" du menu contextuel du champ).

2. Cliquez sur le lien "Ajouter d'autres événements à xxx" situé à la fin de la fenêtre de code, après le dernier événement.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Traitements_optionnels_WD_OK%20-%20HC%20N%B0001.gif)
Dans la liste des événements optionnels, sélectionnez l'événement "Bouton gauche enfoncé" et validez.

3. Dans cet événement optionnel, saisissez le code suivant :
	
	```wl
	// Associer le menu contextuel au champ
	SAI_MonChamp.MenuContextuel = MonMenu
	// Simuler un clic droit sur le bouton pour appeler 
	// le menu contextuel 
	SendMessage(Handle(MoiMême), 516, 0, 0) 
	SendMessage(Handle(MoiMême), 517, 0, 0) 
	// Dissocier le menu contextuel du champ 
	SAI_MonChamp.MenuContextuel = ""
	```




<a name="NOTE2_7"></a>


### Dissocier un menu contextuel d'un champ ou d'une fenêtre
<a name="dissocier_menu_contextuel_champ_une_fenetre_ELTPARAGRAPHE000205"></a>Pour dissocier un menu contextuel d'une champ ou d'une fenêtre, il suffit d'utiliser la propriété [MenuContextuel](../Proprietes/2510077.md) en lui passant en paramètre une chaîne vide ("").

Exemple

```wl
// Dissocier le menu contextuel du champ
SAI_MonChamp.MenuContextuel = ""
```
Remarque : Si un menu contextuel système est disponible, ce menu contextuel remplacera le menu contextuel personnalisé.
<a name="NOTE2_8"></a>


### Récupérer le numéro de la ligne et de la colonne d'un champ Table sur lesquelles un clic droit est réalisé
<a name="recuperer_numero_ligne_colonne_champ_table_sur_lesquelles_clic_droit_est_realise_ELTPARAGRAPHE000219"></a>Pour récupérer le numéro de la ligne et de la colonne d'un champ Table sélectionnées par un clic droit avant l'affichage du menu contextuel, utilisez la fonction [TableInfoXY](../WDLang1/3074007.md) dans l'événement optionnel "Bouton droit enfoncé".

**Exemple** : Les opérations nécessaires à la récupération du numéro de la ligne et de la colonne sélectionnées par un clic droit sont illustrées par l'exemple suivant : Le menu contextuel "MonMenu" est associé au champ Table "TABLE_MaTable". Ce menu permet de manipuler le contenu de la cellule à partir de laquelle le menu contextuel est ouvert.
La cellule sélectionnée est colorée en bleu avant l'affichage du menu contextuel.

1. Affichez le code du champ "TABLE_MaTable" (option "Code" du menu contextuel du champ).

2. Cliquez sur le lien "Ajouter d'autres événements à xxx" situé à la fin de la fenêtre de code, après le dernier événement.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Traitements_optionnels_WD_OK%20-%20HC%20N%B0001.gif)
Dans la liste des événements optionnels, sélectionnez l'événement "Bouton droit enfoncé" et validez.

3. Dans cet événement optionnel, saisissez le code suivant : 
	
	```wl
	// Récupérer la ligne et la colonne sélectionnées par un clic droit
	NumLigneSelect est un entier
	NumColSelect est un entier
	NumLigneSelect = TableInfoXY(MoiMême, tiNumLigne, SourisPosX(), SourisPosY()) 
	NumColSelect = TableInfoXY(MoiMême, tiNumColonne, SourisPosX(), SourisPosY()) 
	// Modifier la couleur de la cellule sélectionnée
	TABLE_MaTable[NumLigneSelect][NumColSelect].CouleurFond = BleuClair
	```




<a name="NOTE2_9"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Changer le menu contextuel en fonction de l'élément sélectionné dans un champ Arbre
<a name="changer_menu_contextuel_fonction_element_selectionne_dans_champ_arbre_ELTPARAGRAPHE000243"></a>Pour changer dynamiquement de menu contextuel lors de la sélection d'un élément dans un [champ Arbre](../WDChamp/1013037.md), utilisez la propriété [MenuContextuel](../Proprietes/2510077.md). Cette propriété doit être utilisée à l'interception du clic droit sur le champ Arbre (événement optionnel "Clic droit").

**Exemple** : Les opérations nécessaires au changement dynamique d'un menu contextuel lors d'un clic droit sur un élément d'un champ Arbre sont illustrées par l'exemple suivant : 
Les menus contextuels suivants sont associés au champ Arbre "ARBRE_Groupes" :

- ***ctxUtilisateur*** : permet de manipuler les utilisateurs listés dans le champ Arbre.

- ***ctxGroupe*** : permet de manipuler les groupes d'utilisateurs listés dans le champ Arbre. 
	Chaque noeud du champ Arbre représente un groupe d'utilisateurs. Chaque feuille du champ Arbre représente un utilisateur.




1. Affichez le code du champ Arbre "ARBRE_Groupes" (option "Code" du menu contextuel du champ).

2. Positionnez votre curseur dans l'événement optionnel "Clic droit de ARBRE_Groupes".

3. Dans cet événement, saisissez le code suivant : 
	
	```wl
	// -- Clic droit de ARBRE_Groupes
	// En fonction du type de l'élément sélectionné dans le champ Arbre, 
	// le menu contextuel à afficher est changé
	nTypeElement = ArbreTypeElement(ARBRE_Groupes, ArbreSelect(ARBRE_Groupes))
	 
	SELON nTypeElement
	 CAS aFeuille 	// C'est un utilisateur 
			ARBRE_Groupes.MenuContextuel = ctxUtilisateur
		CAS aNoeud	// C'est un groupe d'utilisateurs 
			ARBRE_Groupes.MenuContextuel = ctxGroupe 
		AUTRES CAS	// En cas d'erreur
			ARBRE_Groupes.MenuContextuel = ""
	FIN
	```



Résultat : 


|   |   |
| --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ctx_1.gif) | ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ctx_2.gif) |




