


## Manipuler un champ Bandeau défilant par programmation (syntaxe préfixée)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000092"></a>
Un champ Bandeau défilant peut être manipulé par programmation. Il suffit d'utiliser directement la variable du champ Bandeau défilant dans le code.

La variable du champ Bandeau défilant correspond au numéro du plan actif. Cette variable est de type entier.

Pour manipuler un champ Bandeau défilant par programmation, WEBDEV propose les [Fonctions de gestion du champ Bandeau défilant](../WDLang2/1000022632.md).

Cette page d'aide détaille comment manipuler un champ Bandeau défilant par programmation.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Défilement et parcours des plans
<a name="defilement_parcours_des_plans_ELTTEXTE000127"></a>


### Défilement automatique des plans dans un champ Bandeau défilant
<a name="defilement_automatique_des_plans_dans_champ_bandeau_defilant_ELTPARAGRAPHE000150"></a>Pour utiliser le défilement automatique d'un champ Bandeau défilant, il est possible : 

- soit de cocher l'option "Démarrer automatiquement le défilement" dans l'onglet "Détail" de la fenêtre de description du champ.

- soit d'utiliser la fonction WLangage [&lt;Bandeau défilant&gt;.LanceDéfilement](../WDLang2/1000022631.md). 




Dans ce cas, les différents plans visibles du champ Bandeau défilant seront automatiquement affichés dans le champ : 

- selon l'ordre définit dans l'onglet "Général" du champ Bandeau défilant. 

- avec la durée d'affichage définie dans l'onglet "Général" du champ Bandeau défilant. 


Pour arrêter le défilement automatique, utilisez la fonction [&lt;Bandeau défilant&gt;.ArrêteDéfilement](../WDLang2/1000022628.md).
<a name="NOTE2_2"></a>


### Défilement via les boutons gauche, droit et des puces
<a name="defilement_via_les_boutons_gauche_droit_des_puces_ELTPARAGRAPHE000184"></a>Si vous utilisez les boutons gauche, droit et les puces proposés dans le champ Bandeau défilant, aucune programmation spécifique n'est nécessaire. La gestion du passage d'un plan à un autre est automatiquement gérée. 

Remarques : 

- L'ordre des plans est celui défini dans la fenêtre de description du champ Bandeau défilant.

- Les plans invisibles ne sont pas pris en compte.



<a name="NOTE2_3"></a>


### Personnalisation du passage d'un plan à un autre
<a name="personnalisation_passage_plan_autre_ELTPARAGRAPHE000199"></a>Si vous utilisez des champs spécifiques pour passer d'un plan à un autre (par exemple des boutons spécifiques, placés hors du champ), vous pouvez gérer le passage d'un plan à un autre : 

- soit en utilisant les fonctions WLangage suivantes : 
	


|   |   |
| --- | --- |
| [&lt;Bandeau défilant&gt;.Dernier](../WDLang2/1000022630.md) | Affiche le dernier plan d'un champ Bandeau défilant. |
| [&lt;Bandeau défilant&gt;.Précédent](../WDLang2/1000022627.md) | Affiche le plan précédent d'un champ Bandeau défilant. |
| [&lt;Bandeau défilant&gt;.Premier](../WDLang2/1000022629.md) | Affiche le premier plan d'un champ Bandeau défilant. |
| [&lt;Bandeau défilant&gt;.Suivant](../WDLang2/1000022626.md) | Affiche le plan suivant d'un champ Bandeau défilant. |

- soit en utilisant la propriété [Valeur](../Proprietes/2510130.md) pour afficher le plan voulu. 
	Par exemple : 
	
	```wl
	// Affiche le plan 3 dans le champ Bandeau défilant
	BAN_Bannière.Valeur = 3
	```


- soit en affectant le champ Bandeau défilant avec la valeur du plan voulu. 
	Par exemple : 
	
	```txt
	NomChampBandeauDéfilant = NuméroDuPlan
	```



Remarque : Le numéro des plans et leur ordre est défini dans la fenêtre de description du champ Bandeau défilant.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Manipulation des plans d'un champ Bandeau défilant
<a name="manipulation_des_plans_champ_bandeau_defilant_ELTTEXTE000262"></a>


### Rendre un plan invisible
<a name="rendre_plan_invisible_ELTPARAGRAPHE000285"></a>Il est possible d'utiliser la propriété [Visible](../Proprietes/2510138.md) pour rendre un plan visible et inversement. La visibilité des plans est prise en compte lors du parcours des différents plans utilisés par le champ Bandeau défilant (parcours automatique ou programmé). 

Par exemple le code suivant permet de rendre invisible le plan 5 du champ BAN_Annonce au mois d'Août : 

```wl
DateJour est une Date
SI DateJour.Mois = 8 ALORS
	BAN_Annonce[5].Visible = Faux
FIN
```
Astuce : Il est possible de préparer un plan (par exemple concernant une promotion) et de ne le rendre visible qu'à une date donnée, pour une période donnée.


### Récupérer le plan en cours
<a name="recuperer_plan_cours_ELTPARAGRAPHE000302"></a>Pour récupérer le numéro du plan en cours : 

- réalisez une simple affectation. Par exemple :
	
	```txt
	NumPlanActif = NomChampBandeauDéfilant
	```


- utilisez la propriété [Valeur](../Proprietes/2510130.md).




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Propriétés disponibles sur un champ Bandeau défilant
<a name="proprietes_disponibles_sur_champ_bandeau_defilant_ELTTEXTE000315"></a>
Des propriétés WLangage sont disponibles pour manipuler : 

- le champ Bandeau défilant. 

- les plans associés au champ Bandeau défilant. 


Pour connaître la liste complète des propriétés du WLangage pouvant être utilisées avec un champ de type Bandeau défilant, consultez [Propriétés associées au champ Bandeau défilant](../WDChamp/1410087018.md).


