
## Télécharger un état au format PDF sur le poste de l'internaute
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000127"></a>
Pour proposer le téléchargement d'un état au format PDF sur le poste de l'internaute, il est nécessaire de : 

- générer le fichier PDF sur le serveur Web.

- proposer le téléchargement du fichier généré sur le poste de l'internaute. 

- supprimer le fichier PDF du serveur Web.






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000151"></a>


### Générer un fichier PDF sur le serveur Web
<a name="generer_fichier_pdf_sur_serveur_web_ELTPARAGRAPHE000023"></a>Pour générer un fichier PDF sur le serveur Web :

1. Créez un nom unique pour le fichier PDF à générer. Le répertoire de création de ce fichier doit être accessible en lecture et en écriture (par exemple, le répertoire des fichiers de données ou le répertoire "&lt;MonProjet&gt;_WEB" du site). 
	Pour plus de détails sur la création d'un nom de fichier unique, consultez [Définir un nom unique pour le fichier généré](../WDChamp/1011009.md).

2. Paramétrez la destination de l'impression grâce à la fonction [iDestination](../WDLang5/3046074.md) avec la constante *iPDF*(impression dans un fichier PDF).

3. Précisez le nom de l'état à imprimer dans la fonction [iImprimeEtat](../WDLang5/3046032.md). 
	Le fichier PDF est créé sur le serveur Web.





<a name="NOTE2_2"></a>


### Téléchargement du fichier PDF
<a name="telechargement_fichier_pdf_ELTPARAGRAPHE000048"></a>Pour proposer le téléchargement du fichier généré sur le poste de l'internaute, il suffit d'utiliser la fonction [FichierAffiche](../WDLang2/3012005.md).


<a name="NOTE2_3"></a>


### Suppression du fichier PDF
<a name="suppression_fichier_pdf_ELTPARAGRAPHE000059"></a>Pour limiter l'espace disque occupé par les états au format PDF sur le serveur Web, il est conseillé de supprimer régulièrement les états inutiles. Il est par exemple possible de supprimer immédiatement l'état après téléchargement ou de créer une procédure effaçant les états réalisés dans la journée.



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Exemple
<a name="exemple_ELTTEXTE000187"></a>
L'état "ETAT_CommandePDF" est un état au format PDF proposé en téléchargement.

Le bouton "BTN_TéléchargementCommande" permet de :

- générer le fichier PDF dans le répertoire "&lt;NomProjet&gt;_WEB" du site. 

- proposer le téléchargement de l'état au format PDF. 

- supprimer l'état au format PDF après téléchargement.




Dans cet exemple, le code de clic serveur du bouton "BTN_TéléchargementCommande" est le suivant :


```wl
// Générer un nom de fichier PDF unique
UnFichier est une chaîne = fRepWeb() + "\" + DateSys() + HeureSys() + ".pdf"  
// Paramétrer la destination de l'impression 
iDestination(iPDF, UnFichier)  
// Imprimer l'état ETAT_CommandePDF 
iImprimeEtat(ETAT_CommandePDF)  
// Proposer le téléchargement du fichier 
// Le nom du fichier proposé par défaut sera "Commande.pdf"  
FichierAffiche(UnFichier, "application/pdf", "Commande.pdf")  
// Supprimer le fichier 
fSupprime(UnFichier)
```





