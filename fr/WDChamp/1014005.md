
## Valider une page à partir d'un champ qui n'a pas d'action sur le serveur (champ Liste, Combo, ...)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000116"></a>
Par défaut, la validation d'une page doit être effectuée par un bouton de type "Envoyer la valeur des champs au serveur (submit)". 

Pour valider une page lors de la sélection d'un élément dans un champ Liste, Combo, Sélecteur ou Interrupteur, utilisez la fonction [PageValide](../WDLang2/3058020.md).



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Principe
<a name="principe_ELTTEXTE000140"></a>
La fonction [PageValide](../WDLang2/3058020.md) permet de valider une page par l'intermédiaire d'un bouton (visible ou non) dont seul le code de clic serveur est exécuté. Lors de l'utilisation de la fonction [PageValide](../WDLang2/3058020.md), les événements suivants sont exécutés :

- Envoi des données au serveur.

- Code de clic serveur du bouton.






<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Mise en place
<a name="mise_place_ELTTEXTE000164"></a>
Pour valider une page à partir d'un champ sans action (champ Liste, Combo, Interrupteur, ...) : 

1. Créez un nouveau bouton dans la page : ce bouton dynamique peut être de n'importe quel type, visible ou non. Ce bouton est utilisé pour lancer la validation de la page. Seul le code de clic serveur de ce bouton sera exécuté.

2. Dans le code de modification du champ sans action, utilisez la fonction [PageValide](../WDLang2/3058020.md), en précisant :

	- la page à valider si nécessaire.

	- le nom du bouton utilisé pour la validation (créé à l'étape numéro 1).

	- la frame (ou cadre) contenant le résultat de l'action du bouton (dans le cas d'un frameset par exemple).









<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Exemple
<a name="exemple_ELTTEXTE000188"></a>
La sélection d'un élément dans le champ Liste LISTE_CONTINENT permet d'afficher l'élément sélectionné dans une boîte de dialogue.

Le code du champ Liste est le suivant :


```wl
// -- Initialisation du champ LISTE_CONTINENT
ListeAjoute(LISTE_CONTINENT, "Afrique" + RC + "Amérique" + RC + "Asie" + RC + "Europe" + RC + ...
				"Océanie")

// -- Modification et sortie (onchange) du champ LISTE_CONTINENT
// Valide la page et lance l'exécution du code de clic serveur de BTN_Bouton1
PageValide("", BTN_Bouton1)
```


Code du bouton BTN_Bouton1 :


```wl
// -- Clic sur BTN_Bouton1 (code serveur)
Info("Sélection : " + LISTE_CONTINENT[LISTE_CONTINENT])
```





