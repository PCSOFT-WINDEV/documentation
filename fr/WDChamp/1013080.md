


## Les plans en WEBDEV
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000254"></a>
Les plans permettent de regrouper les champs d'un élément. Un plan est une "couche" d'un élément. Chaque élément peut être constitué de plusieurs plans.

WEBDEV propose la gestion des plans pour les éléments suivants : 

- les pages,

- les pages internes,

- les cellules,

- les zones de mise en page,

- les popups,

- les superchamps,

- les modèles de champs, 

- les modèles de pages. 




Les champs peuvent être placés sur différents plans. Un seul plan peut être affiché à la fois aussi bien dans l'éditeur de pages que lors de l'exécution du site.

Chaque champ de l'élément peut :

- appartenir à un plan. Ce champ ne sera affiché que lorsque le plan correspondant sera actif (c'est-à-dire visible).

- appartenir à plusieurs plans. Ce champ sera affiché lorsque un des plans associés au champ sera actif (c'est-à-dire visible).




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Mise en place : Activation de la gestion des plans
<a name="mise_place_activation_gestion_des_plans_ELTTEXTE000278"></a>


### Comment le faire ?
<a name="comment_faire_ELTPARAGRAPHE000036"></a>Pour utiliser les plans sous WEBDEV, il est nécessaire d'activer la gestion des plans pour l'élément voulu : 

1. Affichez la fenêtre de description de l'élément. 

2. Dans l'onglet "UI", cochez l'option "Activer la gestion des plans". 

3. Validez la fenêtre de description de l'élément. 

4. Les plans sont disponibles pour l'élément. Si l'affichage des plans est autorisé dans l'éditeur, le chiffre 1 permettant d'identifier le premier plan apparaît en haut à droite de l'élément. 
	Remarque : Pour gérer l'affichage du numéro de plan dans l'éditeur, sous le volet "Affichage", dans le groupe "Voir (tous les champs)", cochez l'option "Plans". 




Lorsque la gestion des plans est activée, il est possible de créer les différents champs voulus et de les associer aux différents plans. 
<a name="NOTE2_2"></a>


### Chargement différé des plans
<a name="chargement_differe_des_plans_ELTPARAGRAPHE000068"></a>Lors de l'activation des plans, il est possible de cocher l'option "Chargement différé du contenu des plans".

Cette option permet d'optimiser le chargement des données contenues dans les plans. En effet, si les plans contiennent beaucoup de données à afficher, le chargement d'une page peut être long. Il est donc possible d'optimiser en chargeant les données uniquement au moment de l'affichage du plan concerné : c'est le "chargement différé". 

Si l'option "Chargement différé du contenu des plans" est cochée lors de l'activation des plans, deux nouveaux événements sont associés à l'élément : 

- Chargement différé d'un plan (Serveur) en AJAX. 

- Chargement différé d'un plan (Navigateur). 




Dans ces événements, il est possible d'utiliser la propriété [Plan](../Proprietes/2510094.md) pour connaître le plan activé. Il est ainsi possible d'exécuter uniquement le traitement servant à initialiser les champs du plan concerné.

Exemple de code : 

```wl
// Code de chargement différé (serveur) de CELL_DIVERS
SELON CELL_DIVERS.Plan
	CAS 1 // Affichage de la liste des clients
   	ProcChargeTableClient()
	CAS 2 // Affichage des commandes du client sélectionné
   	IdClient est un entier = TABLE_Client.COL_NumClient
   	ProcChargeCdeClient(IdClient)
	CAS 3 // Détail de la commande
	NumCde est un entier = TABLE_Commande.COL_NumCommande
	ProcChargeDétailCommande(NumCde)
FIN
```

<a name="NOTE2_3"></a>


### Cas particuliers
<a name="cas_particuliers_ELTPARAGRAPHE000098"></a>

- **Champ Zone répétée** : Il est possible d'utiliser des plans pour chaque répétition. Il suffit de créer une cellule pour chaque répétition. Cette cellule contient les plans à afficher. Un attribut de type "Plan" permet de gérer le numéro du plan affiché.

- **Champ Table** : Il est possible d'utiliser des plans dans une colonne conteneur, en utilisant par exemple une cellule. 

- **Zoning** : 

	- Si les plans sont gérés au niveau de la page, le zoning est défini par plan. 

	- Dans chaque zone de mise en page, il est possible d'utiliser plusieurs plans. 




- **Champ Bandeau défilant** : Le champ Bandeau défilant utilise les plans pour afficher les différents éléments des bandeaux. Dans ce cas, la gestion des plans est spécifique. Pour plus de détails, consultez [Le champ Bandeau défilant](../WDChamp/1410087016.md).




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Manipulations sous l'éditeur
<a name="manipulations_sous_editeur_ELTTEXTE000314"></a>


### Affecter un ou plusieurs champs à un ou plusieurs plans
<a name="affecter_plusieurs_champs_plusieurs_plans_ELTPARAGRAPHE000116"></a>**Cas 1 : Création de champs** : 
Lors de la création d'un champ sur un élément contenant des plans, le champ créé est automatiquement associé au plan visible. 

**Cas 2 : Associer des champs existants à un ou plusieurs plans** : 
Pour affecter un ou plusieurs champs à un ou plusieurs plans : 

1. Sélectionnez le ou les champs. 

2. Sélectionnez :

	- soit l'option "Associer .. à un plan" du menu contextuel de la sélection. 

	- soit l'option "Associer .. à un plan" du menu contextuel du champ. 




3. Dans la fenêtre qui s'affiche, choisissez : 

	- un des plans disponibles.

	- plusieurs plans (pour cela, maintenez la touche Ctrl enfoncée pendant la sélection des plans). 




4. Validez. 




**Remarques** : 

- Un champ positionné sur un élément contenant des plans est toujours associé à un plan. 
	Il n'existe pas de plan 0, permettant de rendre un champ visible quelque soit le plan affiché. Pour gérer ce cas, il suffit de définir des zones différentes, par exemple une zone ne contenant pas de plans, et une zone contenant des plans. 

- Si un champ est associé à plusieurs plans, il devient automatiquement superposable. 

- Le nombre de plans est illimité. Cependant, l'éditeur de pages peut empêcher de sélectionner les plans supérieurs à 98.

- Un champ peut aussi être affecté à un plan depuis la fenêtre de description du champ (onglet "UI", option "Plan").

- Lors de l'affectation d'un champ à un plan, le plan auquel le champ est affecté est automatiquement affiché sous l'éditeur. 

- La fenêtre d'affectation à un plan liste les plans utilisés puis les plans vierges. Les boutons au bas de cette fenêtre permettent de simplifier le déplacement entre les différents types de plans.



<a name="NOTE3_2"></a>


### Sélectionner le plan affiché sous l'éditeur
<a name="selectionner_plan_affiche_sous_editeur_ELTPARAGRAPHE000151"></a>Pour afficher un plan spécifique sous l'éditeur, vous pouvez :

1. Sélectionner si nécessaire l'élément pour lequel les plans doivent être affichés. 

2. Utiliser les touches Pg prec et Pg suiv. Ces touches permettent d'afficher les différents plans de l'élément en cours (ou du champ parent de la sélection). 




Si l'affichage des plans est autorisé dans l'éditeur, le numéro du plan en cours est affiché en haut à droite de l'élément.  

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Changer de plan par programmation
<a name="changer_plan_par_programmation_ELTTEXTE000344"></a>
La propriété [Plan](../Proprietes/2510094.md) permet de :

- connaître et changer le plan actif d'un élément.

- connaître le plan associé à un champ.



<a name="NOTE4_2"></a>


### Changer de plan dans un élément
<a name="changer_plan_dans_element_ELTPARAGRAPHE000176"></a>Le changement de plan dans un élément peut être réalisé à tout moment. Souvent, un champ Bouton permet de changer de plan. 

Exemple : 

```wl
// Passage sur le plan 4 ajout de commande
PAGE_CRM.CELL_CelluleCde.Plan = 4
```
Le changement de plan est immédiat : seuls les champs associés au plan sont affichés. 
<a name="NOTE4_3"></a>


### Effets lors du changement de plan
<a name="effets_lors_changement_plan_ELTPARAGRAPHE000187"></a>Le changement de plan peut être accompagné d'effets. Il est possible de définir des effets : 

- **au niveau de l'élément qui gère les plans**. Dans l'onglet "Style", il suffit de : 

	- sélectionner l'élément "Effets". 

	- cliquer sur "Ajouter un effet". 

	- sélectionner un effet de changement de plan et de le paramétrer grâce au bouton "Détail". Il est possible de spécifier le déclencheur de l'effet (changement de plan, passage au plan précédent, ...)




- **au niveau des éléments présents dans le plan**, en gérant des effets spécifiques pour l'apparition ou la disparition des champs. Dans l'onglet "Style", il suffit de : 

	- sélectionner l'élément "Effets". 

	- cliquer sur "Ajouter un effet". 

	- sélectionner un effet d'apparition ou de disparition et de le paramétrer grâce au bouton "Détail" : plusieurs animations sont alors proposées.







Attention : Les effets fonctionnent uniquement si la page n'est pas ré-affichée. Pour que l'effet soit visible, la propriété [Plan](../Proprietes/2510094.md) doit être appelée en code navigateur ou en code serveur Ajax. 


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WW_Rewali.gif) ***Exemples complets (WEBDEV)*** : **WW_Rewali** <br>Cet exemple est un site de réservation de voyages.<br><br>Il propose des offres de voyages à des prix très attractifs.<br>Il est ensuite possible de choisir la durée du voyage, les dates de départ .. puis de valider l'achat jusqu'au paiment via Paypal.<br><br>Il utilise notamment le champ "bandeau défilant" et les plans.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WW_Assistant.gif) ***Exemples didactiques (WEBDEV)*** : **WW_Assistant** <br>Avec WEBDEV, il est possible de réaliser ses propres assistants Web, et ceci notamment grâce à la fonction WLangage 'PageAfficheDialogue' qui permet d'afficher une page de manière modale.<br><br>Ceci permet donc de créer un dialogue avec l'utilisateur.<br>Et pour passer d'un plan à un autre de l'assistant, il suffit d'utiliser le concept de plan présent également dans WEBDEV.


