
## Evénements associés aux pages
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Evénements gérés par défaut
<a name="evenements_geres_par_defaut_ELTTEXTE000340"></a>
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) WEBDEV gère par défaut les événements suivants (ordre d'apparition sous l'éditeur de code) :

| Evénement | Condition d'exécution |
| --- | --- |
| Déclarations globales <br>(Code serveur) | Déclaration des variables globales à la page. C'est le premier code exécuté lors de l'ouverture de la page. |
| Initialisation <br>(Code serveur) | Exécuté lors de l'ouverture de la page.<br>L'ordre d'exécution des événements est le suivant :<br><br>- Initialisation des champs de la page.<br><br>- Initialisation de la page.<br><br><br> |
| Chargement (onload) de la page <br>(Code navigateur) | Code navigateur exécuté lors de l'affichage de la page dans le navigateur (réalisé par exemple par les fonctions [PageAffiche](../WDLang2/3058008.md) ou [PageActualise](../WDLang2/3058011.md)). |
| Déchargement (onunload) de la page <br>(Code navigateur) | Code navigateur exécuté lors de l'affichage d'une nouvelle page dans le navigateur. |
| Rafraîchissement des données de la page <br>(Code serveur) | Evénement disponible uniquement si le rafraîchissement automatique des données a été défini pour la page (voir [Rafraîchissement des données de la page](../Editeurs/2030067.md)). Cet événement est exécuté lors du rafraîchissement de la page. Il permet par exemple de mettre à jour les champs voulus : remplissage d'une liste, ... Cet événement est un événement Ajax.<br><br>Si cet événement renvoie <u><u><u><u>Faux</u></u></u></u>, l'événement "Après rafraîchissement des données de la page (Code navigateur)" n'est pas exécuté. |
| Demande de mise à jour de l'affichage <br>(Code serveur) | Permet de regrouper le code de mise à jour des champs de la page : contenu des champs, état (visible, grisé, ...), libellé à mettre à jour, ...<br><br>Cet événement peut attendre des paramètres. Il suffit de déclarer une procédure dans l'événement. Par exemple : <br><br><pre><code>// Demande de mise à jour de l'affichage <br>PROCEDURE DemandeMiseAjour(TypeMiseAJour est un booléen)</code></pre><br><br><br><br><br>Cet événement est lancé sur demande grâce aux fonctions : <br><br>- [DemandeMiseAJourUI](../WDLang1/1000023899.md) ou [DemandeMiseAJourUIParent](../WDLang1/1000023900.md) : Exécute l'événement à la fin de l'événement en cours (lancement asynchrone). <br><br>- [ExécuteMiseAJourUI](../WDLang1/1000023901.md) ou [ExécuteMiseAJourUIParent](../WDLang1/1000023902.md) : Exécute immédiatement l'événement. <br><br><br>Lors de l'appel de ces fonctions, il est possible de préciser la valeur des paramètres attendus par l'événement. |
| Après rafraîchissement des données de la page <br>(Code navigateur) | Evénement disponible uniquement si le rafraîchissement automatique des données a été défini pour la page (voir [Rafraîchissement des données de la page](../Editeurs/2030067.md)). <br><br>Cet événement est exécuté après l'événement "Rafraîchissement des données de la page (Code serveur)". Il permet d'effectuer un traitement supplémentaire sur le navigateur. Si l'événement "Rafraîchissement des données de la page (Code serveur)" renvoie <u><u><u><u>Faux</u></u></u></u>, l'événement "Après rafraîchissement des données de la page (Code navigateur)" n'est pas exécuté. |
| Fermeture de la page <br>(Code serveur) | Exécuté lors de la fermeture de la page. |
| Synchronisation de la page <br>(Code serveur) | Code serveur permettant de gérer la synchronisation de la page lors de l'utilisation du bouton "Précédent" du navigateur. Pour plus de détails, consultez [La gestion du bouton"Précédent" du navigateur](../WDChamp/1012001.md). |


**Remarque** : Dans une page statique, seuls les codes navigateur sont disponibles.


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WW_Forum_PHP.gif) ***Exemples complets (WEBDEV)*** : **WW_Forum_PHP** <br>Cet exemple propose les fonctionnalités principales d'un forum utilisateur (création de forums, de sujets (ou topics) et de messages, modération par un administrateur, recherche, etc...)<br><br>WW_FORUM_PHP utilise entre autres les fonctionnalités suivantes :<br>- Champ riche<br>- AJAX<br>- ...
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WW_Blogs_php.gif) ***Exemples complets (WEBDEV)*** : **WW_Blogs_php** <br>Cet exemple est un site Php de gestion de blogs réalisé avec WEBDEV.<br>Un blog est un journal ou un recueil d'actualités sur un site Internet. <br>Il est consultable par tous, et chacun peut y apporter des commentaires.<br>L'auteur du blog écrit ses messages lorsqu'il le souhaite.<br>Il est possible de mettre en forme le texte, d'inclure des images, des citations, etc...<br>De plus, chaque blog peut être exporté en RSS.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Evénements optionnels
<a name="evenements_optionnels_ELTTEXTE000370"></a>
Plusieurs événements optionnels peuvent être gérés.

Pour ajouter un événement optionnel :

1. Sélectionnez le champ voulu.

2. Affichez la fenêtre de code de ce champ (touche F2).

3. Cliquez sur le lien "Ajouter d'autres événements à xxx" situé à la fin de la fenêtre de code, après le dernier événement.  ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Traitements_optionnels_WD_OK%20-%20HC%20N%B0001.gif)


4. La totalité des événements optionnels disponibles pour le champ est affichée. 

5. Cochez l'événement optionnel à ajouter et validez. 
	Remarque : Il est possible de sélectionner plusieurs événements optionnels. 

6. L'événement optionnel sélectionné est automatiquement ajouté dans les événements gérés par le champ.




Pour désactiver un événement optionnel, il suffit d'effectuer les mêmes manipulations pour afficher la liste des événements optionnels. Il suffit ensuite de décocher les événements optionnels à supprimer. 
Remarque : Si le code désactivé contient du code WLangage, ce code est automatiquement supprimé.

Il est ainsi possible de gérer par exemple :

- le bouton gauche enfoncé, relâché, avec un double-clic,

- le bouton droit enfoncé, relâché, avec double-clic, ...




Pour plus de détails, consultez les [Evénements optionnels](../WDChamp/1014004.md).


<a name="NOTE2_2"></a>


### Evénements optionnels de gestion du mode déconnecté
<a name="evenements_optionnels_gestion_mode_deconnecte_ELTPARAGRAPHE000245"></a>Pour optimiser la gestion des sites déconnectés, plusieurs événements optionnels spécifiques sont disponibles : 

| Evénement | Condition d'exécution |
| --- | --- |
| Passage en mode déconnecté (Code navigateur) | Exécuté lors du passage en mode déconnecté. |
| Passage en mode connecté (Code navigateur) | Exécuté lors du passage en mode connecté. |
| A chaque changement d'état du cache HTML (Code navigateur) | Permet de vérifier ce qu'il se passe au chargement de la page. Cet événement est appelé pour chaque vérification du cache. <br>Il est possible de récupérer ce que fait le navigateur grâce à la ligne de code suivante :<br><br><pre><code>Trace(JSInfoEvénement("type"))</code></pre><br>Il est ainsi possible de savoir :<br><br>- si le navigateur est en cours de mise à jour du cache,<br><br>- si une erreur est survenue<br><br>- si la mise à jour du cache est terminée<br><br>- si aucune mise à jour ne doit être effectuée, ....<br><br><br> |




<a name="NOTE2_3"></a>


### Evénement optionnel de gestion de l'historique de navigation
<a name="evenement_optionnel_gestion_historique_navigation_ELTPARAGRAPHE000281"></a>Pour optimiser la gestion des boutons précédent/suivant, un événement optionnel spécifique est disponible : "Déplacement dans l'historique de navigation (onpopstate)". 

Cet événement attend en paramètre les données à afficher. Ces données ont été mémorisées dans l'historique grâce aux fonctions [NavigateurHistoriqueAjoute](../WDLang2/1000023458.md) et [NavigateurHistoriqueModifie](../WDLang2/1000023459.md). 

Si l'internaute retourne en arrière dans l'historique et revient sur une entrée mémorisée dans l'historique, les données mémorisées seront transmises à l'événement "Déplacement dans l'historique de navigation" (événement optionnel de la page). Cet événement doit les traiter pour restaurer l'état de la page. Cet événement doit être associé à une procédure qui attend en paramètre les données transmises : 

```txt
// Evénement "Déplacement dans l'historique de navigation (onpopstate)"
PROCEDURE <NomProcédure>(<Données>)
```


Exemple : Cet exemple ajoute la page dans l'historique et mémorise l'heure d'insertion. Le retour sur la page précédente de l'historique affiche l'heure.

```wl
x est un Variant
x.Heure = HeureSys()
NavigateurHistoriqueAjoute(x, MaPage.Titre, "#avant") 

x.Heure = HeureSys()
NavigateurHistoriqueAjoute(x, MaPage.Titre, "#apres")
```

```wl
// Evénement "Déplacement dans l'historique de navigation (onpopstate)" 
PROCÉDURE TraitementHistorique(stEtat)
Info(stEtat.Heure)
```


Remarque : Selon les navigateurs, l'événement "Déplacement dans l'historique de navigation (onpopstate)" est également exécuté au chargement de la page et lors d'un retour à l'affichage initial de la page. Dans ce cas, le paramètre &lt;Données&gt; transmis à l'événement correspond à Null.


