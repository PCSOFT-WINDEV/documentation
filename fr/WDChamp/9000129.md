


## Imprimer un texte en filigrane
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000156"></a>
Un état (et bien entendu un duplicata) peut intégrer un texte complémentaire sous forme de filigrane, comme par exemple le terme "Confidentiel" ou "Duplicata" en travers de l'état. 

La création d'un filigrane peut être réalisée : 

- depuis le visualisateur de rapports (WINDEV uniquement).

- par programmation. 




**Remarques** : 

- Si un filigrane est défini pour un état, il est défini pour toutes les pages de l'état.  

- Un seul filigrane peut être défini pour un état. Il n'est pas possible de définir plusieurs filigranes. 

- Le filigrane est imprimé uniquement sur les pages contenant des informations. Il n'est pas imprimé sur des pages vides.




<a name="NOTE2"></a>


## Créer un filigrane depuis le visualisateur de rapports
<a name="creer_filigrane_depuis_visualisateur_rapports_ELTTEXTE000180"></a>
<a name="NOTE2_1"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Sous le volet "Annoter" du visualisateur de rapports, l'option "Filigrane" permet à l'utilisateur de créer à tout moment un filigrane dans l'état actuellement affiché. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Volet_Apercu_Annoter.gif&type=thumb)
Lors de l'utilisation de cette option, une fenêtre spécifique s'ouvre permettant à l'utilisateur de définir :

- la destination du filigrane : impression et/ou duplicata. 

- le positionnement du filigrane : diagonal montant, descendant ou horizontal. 

- le texte du filigrane, sa police, sa taille, sa couleur et son opacité. ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Fen_Filigrane.gif)





<a name="NOTE3"></a>


## Créer un filigrane par programmation
<a name="creer_filigrane_par_programmation_ELTTEXTE000204"></a>
<a name="NOTE3_1"></a>
Différentes méthodes permettent de créer un filigrane par programmation : 

- [Méthode 1 : Paramétrage complet : utilisation d'une variable de type Filigrane](#NOTE3_2). 

- [Méthode 2 : Paramétrage rapide : utilisation directe](#NOTE3_3).



<a name="NOTE3_2"></a>


### Méthode 1 : Paramétrage complet : utilisation d'une variable de type Filigrane
<a name="methode_1_parametrage_complet_utilisation_une_variable_type_filigrane_ELTPARAGRAPHE000063"></a>Cette méthode est la suivante : 

1. Définissez une variable de type [Filigrane](../WDLang5/1000019922.md). Cette variable contient toutes les caractéristiques du filigrane à imprimer. 

2. Utilisez la fonction [iParamètreFiligrane](../WDLang5/1000019939.md) pour ajouter le filigrane dans votre état. 

3. Lancez l'impression de l'état. 




Par exemple : 

- Code WLangage permettant d'imprimer un filigrane en fond d'un état créé avec l'éditeur d'états :
	
	```wl
	// Impression d'un filigrane en fond d'un état
	MonFiligrane est un Filigrane
	
	// Texte du filigrane
	MonFiligrane.Texte = "Confidentiel"
	// Police utilisée
	MonFiligrane.Police.Nom = "Arial"
	// Le filigrane sera imprimé en centré horizontalement et en bas
	MonFiligrane.Position = iCentreH + iBas
	
	// Impression dans le visualisateur de rapports
	iDestination(iVisualisateur)
	
	// Indique que le filigrane sera imprimé lors de l'impression 
	// et dans les duplicatas
	iParamètreFiligrane(iFiligraneImpression + ...
		iFiligraneDuplicata, MonFiligrane)
	
	// Lance l'impression de l'état
	iImprimeEtat(ETAT_Commercial)
	```


- Code WLangage permettant d'imprimer un filigrane en fond d'un état créé avec les fonctions d'impression :
	
	```wl
	MonFiligrane est un Filigrane
	
	// Texte du filigrane
	MonFiligrane.Texte = "Confidentiel"
	
	// Impression dans le visualisateur de rapports
	iDestination(iVisualisateur)
	
	// Mise en place d'un filigrane en fond du document uniquement
	iParametreFiligrane(iFiligraneImpression, MonFiligrane)
	
	// Imprime plusieurs pages avec filigrane
	POUR i = 6 A 10
		iImprime(" Page " + i)
		iSautePage()
	FIN
	// La dernière page est vide et n'a pas de filigrane
	
	// Termine l'impression
	iFinImprime()
	```




<a name="NOTE3_3"></a>


### Méthode 2 : Paramétrage rapide : utilisation directe
<a name="methode_2_parametrage_rapide_utilisation_directe_ELTPARAGRAPHE000089"></a>Cette méthode est la suivante : 

1. Utilisez directement la fonction [iParamètreFiligrane](../WDLang5/1000019939.md) pour spécifier le texte du filigrane à ajouter dans votre état. Dans ce cas, la police utilisée est "Arial", avec une taille automatique et une opacité de 20%. 

2. Lancez l'impression de l'état. 




Par exemple : 

- Code WLangage permettant d'imprimer un filigrane en fond d'un état créé avec l'éditeur d'états : 
	
	```wl
	// Impression dans le visualisateur de rapports
	iDestination(iVisualisateur)
	
	// Indique que le filigrane sera imprimé lors de l'impression 
	// et dans les duplicatas
	iParamètreFiligrane("Confidentiel")
	
	// Lance l'impression de l'état
	iImprimeEtat(ETAT_Commercial)
	```


- Code WLangage permettant d'imprimer un filigrane en fond d'un état créé avec les fonctions d'impression :
	
	```wl
	// Impression dans le visualisateur de rapports
	iDestination(iVisualisateur)
	
	// Mise en place d'un filigrane en fond du document uniquement
	iParametreFiligrane(iFiligraneImpression, "Confidentiel")
	
	// Imprime plusieurs pages avec filigrane
	POUR i = 6 A 10
		iImprime(" Page " + i)
		iSautePage()
	FIN
	// La dernière page est vide et n'a pas de filigrane
	
	// Termine l'impression
	iFinImprime()
	```






- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDEtats.gif) ***Exemples didactiques (WINDEV)*** : **WD Etats** <br>Cet exemple montre les différentes méthodes pour réaliser un état :<br> <br>- impressions basées sur différentes sources de données (requêtes, variables, ...)<br>- impressions basées sur des champs (Table, Tableur, TCD, ...)<br>- impression d'états composés<br>- impressions spécifiques (portrait / paysage, état avec filigrane, état avec code-barres, ...)




