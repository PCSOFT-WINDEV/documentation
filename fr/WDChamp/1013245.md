


## Caractéristiques des colonnes d'un champ Table dans une fenêtre
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000527"></a>
Les colonnes permettent d'afficher les informations dans un champ Table. Toutes les informations affichées dans une même colonne sont du même type.

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) Remarque : Les colonnes des champs Table hiérarchique ont les mêmes caractéristiques que les colonnes des champs Table.

Les types de données pouvant être affichés dans une colonne sont les suivants :


|   |   |
| --- | --- |
| <br><br>- Texte<br><br>- Monétaire<br><br>- Heure<br><br>- [Combo](../WDChamp/1013222.md)<br>	<br><br>- Image<br><br>- Jauge<br>	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Non disponible.<br><br><br> | <br><br>- Numérique<br><br>- Date<br><br>- Libellé<br><br>- Interrupteur<br>	<br><br>- Durée<br>	<br><br>- [Conteneur](../WDChamp/1013263.md)<br>	(non disponible en Java et en WINDEV Mobile)<br><br><br> |

**Remarque** : Pour utiliser la fonction [gImage](../WDLang1/3029042.md) dans une colonne, utilisez une colonne de type Texte.
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Il est possible de réaliser des calculs sur le contenu d'une ou de plusieurs colonnes. Pour plus de détails, consultez [Gestion des calculs dans les colonnes d'un champ Table](../WDChamp/1013201.md).

Pour chaque type de colonne, des caractéristiques spécifiques sont paramétrables.

La programmation de chaque type de colonne correspond à la programmation du champ simple correspondant.

Les paragraphes suivants présentent les principales caractéristiques des colonnes d'un champ Table affichées dans une fenêtre, disponibles quel que soit le type de la colonne. Pour les colonnes des champs Table affichées dans une page, consultez [Caractéristiques des colonnes d'un champ Table dans une page](../WDChamp/1013262.md).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Caractéristiques des colonnes d'un champ Table dans une fenêtre
<a name="caracteristiques_des_colonnes_champ_table_dans_une_fenetre_ELTTEXTE000551"></a>
La majorité des caractéristiques des colonnes d'un champ Table sont configurées dans l'onglet "Général" des caractéristiques de chacune des colonnes.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Champ_Table_Colonne.gif)

<a name="NOTE2_2a"></a>


### Image du titre de colonne
<a name="image_titre_colonne_ELTPARAGRAPHE000102"></a>Cette option permet de définir l'image qui sera utilisée en image de fond du titre de la colonne. 

<a name="NOTE2_5"></a>


### Colonne redimensionnable
<a name="colonne_redimensionnable_ELTPARAGRAPHE000114"></a>Si une colonne est redimensionnable : 

- L'utilisateur pourra manipuler la taille des colonnes à l'aide de la souris. 

- Cette colonne sera automatiquement redimensionnée lors de l'utilisation de l'option de menu "Ajuster toutes les colonnes" (option du menu contextuel de l'entête de la colonne). 




**Programmation** : 

- Il est possible de redimensionner la taille des colonnes grâce à la fonction [TableAjuste](../WDLang1/3074004.md).

- Il est possible d'ajuster la taille des colonnes à leur contenu en utilisant la fonction [FAAExécute](../WDLang1/1000022099.md) avec la constante *faaAjusterToutesLesColonnes*. 



<a name="NOTE2_3"></a>


### Colonne triable
<a name="colonne_triable_ELTPARAGRAPHE000141"></a>L'utilisateur pourra trier la colonne d'un simple clic sur son entête. Cette option est disponible :

- sur toutes les colonnes d'un champ Table par programmation ou d'un champ Table hiérarchique par programmation.  

- sur certaines colonnes d'un champ Table fichier (uniquement les colonnes basées sur des rubriques clé, non filtrées). 




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Le bouton "Options" permet de définir les caractéristiques du tri sur les colonnes de type Texte. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Colonne_de_table_Fenetre%20-%20HC%20N%B0002.gif)
En cochant l'option "Personnaliser le tri", il est possible de sélectionner le mode de tri ou les combinaisons de tri voulues. 
**Astuce : Activer l'option "Fonctions gXXX"** : Cette option permet de trier la colonne en fonction du contenu défini avec la fonction [gLien](../WDLang1/3029043.md). 
Pour utiliser cette fonctionnalité, il suffit d'utiliser la fonction [gLien](../WDLang1/3029043.md) dans l'événement d'affichage d'une ligne. Par exemple, pour afficher les dates en toutes lettres et pour trier la colonne selon la date, le code d'affichage de la ligne est le suivant : 

```wl
sDateTriable est chaîne

// Récupère le gLien pour le tri + la valeur à afficher	
sDateTriable = gLien(dDate) + DateVersJourEnLettre(dDate) + " " + ...
    dDate.Jour + " " + DateVersMoisEnLettre(dDate)+ " " + dDate.Année

// Affiche la date en toutes lettres et trie sur le format normal de date
TableAjouteLigne(TABLE_Commandes, Commande.NuméroInterneCommande, sDateTriable, ... )
```


Remarque : En exécution les icônes ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IconeCroissant.gif) et ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IconeDecroissant.gif) permettent de connaître à tout moment le sens de tri de la colonne. Il est possible de personnaliser les images utilisées. Pour plus de détails, consultez [Paramétrage des titres des colonnes dans un champ Table](../WDChamp/1013330.md).

**Programmation** : Le tri peut également être effectué par programmation grâce aux fonctions :


|   |   |
| --- | --- |
| [TableTrie](../WDLang1/3074035.md) | Permet de trier le contenu d'un champ Table ou Table hiérarchique sur une ou plusieurs colonnes |
| [TableTrieFils](../WDLang1/1000017025.md) | Permet de trier une branche d'un champ Table hiérarchique sur une ou plusieurs colonnes (tri lexicographique). |


La propriété [OptionTri](../Proprietes/1000017044.md) permet de définir les options de tri à utiliser. 
 
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Un événement optionnel peut également être géré : [A chaque tri sur la colonne](../WDChamp/1013246.md).
<a name="NOTE2_2"></a>


### Colonne déplaçable
<a name="colonne_deplacable_ELTPARAGRAPHE000211"></a>L'utilisateur pourra déplacer la colonne dans le champ Table et changer l'ordre des colonnes affichées.

<a name="NOTE2_4"></a>


### Recherche (Loupe / Filtre)
<a name="recherche_loupe_filtre_ELTPARAGRAPHE000223"></a>L'utilisateur pourra effectuer un filtre de type "Commence par" directement dans la colonne. Seuls les éléments commençant par les lettres saisies pour la colonne seront affichés. 
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Deux méthodes sont possibles :

- L'utilisateur saisit directement le mot recherché. Cette recherche s'effectue automatiquement dans la colonne triée.

- Un simple clic sur l'entête de la colonne avec loupe permet d'afficher un champ de saisie. L'utilisateur n'a plus qu'à saisir le mot recherché.


La loupe est disponible : 

- sur toutes les colonnes d'un champ Table par programmation.

- sur les colonnes des champs Table fichier à parcours automatique (uniquement les colonnes triables, basées sur des rubriques clé, non filtrées).




**Attention** : La loupe n'est pas disponible :

- sur les rubriques associées à une liaison multifichier.

- sur les champs Table utilisant un ascenseur non proportionnel (option "Ascenseur proportionnel" décochée dans l'onglet "Détail" de la fenêtre de description du champ Table).


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Il est possible de personnaliser l'image de la loupe. Pour plus de détails, consultez [Paramétrage des titres des colonnes des champs Table](../WDChamp/1013330.md).

**Programmation** : Cette fonctionnalité peut être effectuée par programmation grâce aux fonctions :


|   |   |
| --- | --- |
| [TableCherche](../WDLang1/3074015.md) | Recherche une valeur dans une colonne d'un champ Table par programmation, Table fichier ou Table hiérarchique. |
| [TableChercheFils](../WDLang1/1000017064.md) | Recherche une valeur dans une colonne d'un champ Table hiérarchique, dans une branche spécifiée. |


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Un événement optionnel peut également être géré : [A chaque recherche avec la loupe de colonne](../WDChamp/1013246.md).
<a name="NOTE2_7"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Export et impression
<a name="export_impression_ELTPARAGRAPHE000287"></a>La colonne de table pourra être prise en compte à l'impression et dans les exports : 

- Toujours, 

- Jamais,

- Si la colonne est visible dans la fenêtre. 




Remarque : Cette option sera prise en compte : 

- lors de la création d'un état sur Table/Table hiérarchique. 

- lors de l'impression du contenu de la table via l'option "Imprimer" du menu contextuel.

- lors de l'utilisation des options d'export du menu contextuel de la table. 

- lors de l'utilisation des fonctions d'export ([TableVersExcel](../WDLang1/3074033.md), [TableVersPressePapier](../WDLang1/1000017062.md), [TableVersTexte](../WDLang1/1000017061.md), [TableVersWord](../WDLang1/3074036.md) et [TableVersXML](../WDLang1/3074037.md)).




**Programmation** : Il est possible de paramétrer cette option par programmation grâce à la propriété [VisibleEnExportEtImpression](../Proprietes/1000022320.md).

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Colonne fixée, colonne ancrée
<a name="colonne_fixee_colonne_ancree_ELTTEXTE000611"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Colonne fixée
<a name="colonne_fixee_ELTPARAGRAPHE000331"></a>Une colonne fixée restera toujours affichée lors du défilement horizontal des colonnes du champ Table. Si la colonne n'est pas fixée, elle sera déplacée avec l'ensemble des colonnes. Les colonnes fixées sont toujours situées à gauche du champ Table.

Il est possible de définir le nombre de colonnes fixées dans la description du champ Table (onglet "Détail", option Nombre de colonnes fixées à gauche). Les x premières colonnes seront alors fixées.


<a name="NOTE3_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Colonne ancrée
<a name="colonne_ancree_ELTPARAGRAPHE000352"></a>La colonne ancrée est la colonne à laquelle les options d'ancrage seront appliquées. La largeur de la colonne évoluera en fonction de la taille de la fenêtre et de la taille du champ Table.

Il est possible de définir :

- le numéro de la colonne ancrée dans l'onglet "Général" de la fenêtre de description du champ Table.

- le taux d'ancrage en largeur d'une colonne dans l'onglet "UI" de la fenêtre de description de la colonne.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Colonne de type Jauge
<a name="colonne_type_jauge_ELTTEXTE000641"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Description
<a name="description_ELTPARAGRAPHE000370"></a>La configuration de la jauge est effectuée dans l'onglet "Général" de la description de la colonne. Il est possible de paramétrer :

- la valeur d'origine de la jauge,

- la valeur maximale de la jauge,

- l'image active et l'image de fond.




L'onglet "Détail" de la description de la colonne permet de paramétrer l'affichage du pourcentage de progression, ...
<a name="NOTE4_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Jauge avec une borne maximale différente pour chaque ligne du champ Table
<a name="jauge_avec_une_borne_maximale_differente_pour_chaque_ligne_champ_table_ELTPARAGRAPHE000387"></a>Il est possible d'afficher **une jauge avec une borne maximale différente pour chaque ligne**. Dans ce cas, il faut :

1. Affecter la propriété [BorneMax](../Proprietes/2510009.md) à 100 pour la colonne.

2. Dans le code d'affichage de ligne, faire le calcul voulu :
	
	```txt
	<Colonne Jauge> = <Valeur Jauge>*100/<Valeur Max>
	```




<a name="NOTE4_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Propriétés utilisables sur une cellule de type Jauge
<a name="proprietes_utilisables_sur_une_cellule_type_jauge_ELTPARAGRAPHE000406"></a>Il est possible d'utiliser les propriétés [BorneMax](../Proprietes/2510009.md) et [BorneMin](../Proprietes/2510008.md) sur les cellules de type Jauge, en utilisant la syntaxe suivante :

```txt
<Nom de la colonne>[<Numéro de la ligne>].BorneMax = <Valeur>
<Nom de la colonne>[<Numéro de la ligne>].BorneMin = <Valeur>
```


<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Colonne calculée et colonne de type Interrupteur (champ Table par programmation et champ Table fichier chargé en mémoire)
<a name="colonne_calculee_colonne_type_interrupteur_champ_table_par_programmation_champ_table_fichier_charge_memoire_ELTTEXTE000677"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Colonne calculée et colonne Interrupteur
<a name="colonne_calculee_colonne_interrupteur_ELTPARAGRAPHE000427"></a>Dans un champ Table fichier chargé en mémoire, il est possible de créer des **colonnes calculées** : ces colonnes ne sont pas liées à un fichier de données. Ces colonnes peuvent par exemple afficher un calcul, ...

Les **colonnes de type "Interrupteur"** dans un champ Table fichier chargé en mémoire sont des colonnes calculées spécifiques. Lors d'un déplacement de l'ascenseur, les cases cochées sont automatiquement conservées.

Remarque : Dans un champ Table fichier à accès direct, les colonnes calculées de type Interrupteur (non liées à une rubrique) ne sont pas conservées lors du défilement des lignes.
<a name="NOTE5_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Style des colonnes Interrupteur
<a name="style_des_colonnes_interrupteur_ELTPARAGRAPHE000442"></a>Il est possible de définir le style des Interrupteurs présents dans les colonnes : il est par exemple possible de choisir l'image qui sera utilisée lorsque l'option est sélectionnée.

Pour définir le style des colonnes interrupteur : 

1. Affichez la fenêtre de description du champ Table.

2. Dans l'onglet "Style", sélectionnez l'élément "Colonne interrupteur". Il est possible de :

	- sélectionner le style de la coche parmi un des styles prédéfinis.

	- choisir une image spécifique pour représenter la coche (option "Style de coche" correspondant à "Image de coche").






<a name="NOTE5_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Autres caractéristiques des colonnes Interrupteur
<a name="autres_caracteristiques_des_colonnes_interrupteur_ELTPARAGRAPHE000463"></a>Les colonnes de type Interrupteur proposent également les fonctionnalités suivantes : 

- Menu contextuel permettant de cocher/décocher les lignes de la table et de les filtrer. Pour plus de détails, consultez [Menu contextuel des colonnes Interrupteur (FAA)](../WDChamp/9500145.md). 

- Possibilité de ne pas afficher la case des interrupteurs non cochés dans un champ Table en affichage (option "Masquer la coche si décochée (en affichage)" dans l'onglet "Détail" de la fenêtre de description de la colonne ou propriété [VideSiZéro](../Proprietes/1000020766.md)).





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Styled'affichagedescellulesdetable.gif) ***Exemples unitaires (WINDEV)*** : **Style d'affichage des cellules de table** <br>Modification du style d'affichage des cellules de table.<br>La propriété ..StyleFond permet d'hachurer des cellules ou de faire un dégradé de couleur avec effet "tube".
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CalculsPersonnalises.gif) ***Exemples unitaires (WINDEV)*** : **Calculs Personnalisés** <br>Utilisation d'une formule saisie par l'utilisateur dans un champ Table.<br>La formule est simplement saisie dans la colonne puis mémorisée dans un fichier .INI pour être utilisée à chaque affichage de la table. Evidemment, la formule peut être modifiée à n'importe quel moment par l'utilisateur.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampTable_Tablehierarchique_colonnesdetypeJauge_.gif) ***Exemples unitaires (WINDEV)*** : **Le champ Table / Table hiérarchique (colonnes de type Jauge)** <br>Utilisation d'une colonne de type jauge ainsi que de la propriété ..TexteJauge dans un champ Table ou Table hiérarchique


