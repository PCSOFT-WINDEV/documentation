
## Manipuler un champ Tableau croisé dynamique par programmation
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000200"></a>
Un champ Tableau croisé dynamique peut être manipulé par programmation. 

Pour manipuler un champ Tableau croisé dynamique par programmation, WINDEV propose les [fonctions TCD](../WDLang1/1000020704.md). 

Cette page d'aide détaille comment manipuler un champ Tableau croisé dynamique par programmation. 





## Manipuler le champ Tableau croisé dynamique par programmation
<a name="manipuler_champ_tableau_croise_dynamique_par_programmation_ELTTEXTE000224"></a>


### Colorer les valeurs
<a name="colorer_les_valeurs_ELTPARAGRAPHE000022"></a>Depuis le menu contextuel de champ Tableau croisé dynamique, l'utilisateur final peut colorer facilement une valeur pour la mettre en évidence. Pour plus de détails, consultez [Fonctionnalités automatiques des champs Tableau Croisé Dynamique](../WDChamp/1000029008.md). 

Par programmation, il est possible d'accéder aux valeurs pour modifier leur style (couleur de texte ou de fond, ...). Il suffit de modifier les propriétés des valeurs dans l'événement "Affichage d'une cellule". 

Par exemple : 

```wl
// Si le CA est inférieur à 500, affiche la valeur en rouge
SI VAL_CA <= 500 ALORS
	VAL_CA.CouleurFond = RougePastel
FIN
```


Remarque : Il est possible de personnaliser le style de chaque élément de la cellule : couleur, police, couleur de fond, ... à l'aide de nombreuses propriétés. Pour plus de détails, consultez [Propriétés associées aux valeurs d'un champ Tableau croisé dynamique](../WDChamp/1000029003.md). 




### Ajouter un titre de colonne ou de ligne
<a name="ajouter_titre_colonne_ligne_ELTPARAGRAPHE000045"></a>Par défaut, les lignes ou les colonnes d'un champ Tableau croisé dynamique n'ont pas de titre. Il est possible d'en ajouter un avec la propriété [Libellé](../Proprietes/2510053.md) utilisée sur le nom de l'entête. 

Par exemple : 

- Tableau croisé dynamique n'affichant pas de titre : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=tcd_sanstitre.gif)


- Tableau croisé dynamique avec un titre : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=tcd_avectitre.gif)





Le code utilisé est le suivant : 

```wl
// Initialisation de TCD_Stats
COL_Continent.Libellé = "Continent"
COL_Pays.Libellé = "Pays"
COL_Type_Véhicule.Libellé = "Véhicule"
COL_DateCommande_Année.Libellé = "Année"
COL_DateCommande_Trimestre.Libellé = "Trimestre"
COL_DateCommande_Mois.Libellé = "Mois"
```



### Rendre une valeur invisible
<a name="rendre_une_valeur_invisible_ELTPARAGRAPHE000065"></a>Par défaut, toutes les valeurs d'un tableau croisé dynamique sont affichées. Dans certains cas, il peut être intéressant de calculer des valeurs mais de ne pas les afficher. Les valeurs existent dans le champ Tableau croisé dynamique et peuvent être par exemple utilisées pour réaliser un calcul, remplir un graphe, ...

Pour rendre une valeur invisible, il suffit d'utiliser la propriété [Visible](../Proprietes/2510138.md). 

Exemple : Un tableau croisé dynamique affiche dans chaque cellule le chiffre d'affaires et la quantité vendue. Un graphe est construit à partir de la quantité vendue et cette quantité ne doit pas être affichée dans le champ Tableau croisé dynamique. Il suffit d'utiliser la ligne de code suivante dans le code d'initialisation du champ Tableau croisé dynamique : 


```wl
VAL_Qté.Visible = Faux
```





### Connaître et modifier le masque utilisé pour l'affichage des valeurs
<a name="connaitre_modifier_masque_utilise_pour_affichage_des_valeurs_ELTPARAGRAPHE000082"></a>Pour connaître et modifier le type affiché pour une valeur d'un champ Tableau croisé dynamique, utilisez la propriété [TypeSaisie](../Proprietes/2510136.md). Il est possible d'utiliser les syntaxes suivantes : 


```txt
{{"Nom Valeur"}}..TypeSaisie = typSaisieDurée
```


ou bien : 


```txt
NomValeur.TypeSaisie = typSaisieDurée
```





### Modifier les axes affichés
<a name="modifier_les_axes_affiches_ELTPARAGRAPHE000099"></a>Il est possible de modifier les axes affichés ou d'inverser les lignes et les colonnes grâce à la fonction [TCDAxeXY](../WDLang1/1000021113.md). 

Exemple : 


```wl
// Modifie les lignes et les colonnes affichées
TCDAxeXY(TCD_Stats, "COL_Année" + RC + "COL_Trimestre", "COL_TypeVéhicule" + RC + "COL_Modèle")
```







### Modifier la source de données
<a name="modifier_source_donnees_ELTPARAGRAPHE000113"></a>Il est possible de modifier la source de données d'un champ Tableau croisé dynamique grâce à la propriété [FichierParcouru](../Proprietes/2510040.md). 

Exemple : 


```wl
// Modifie les lignes et les colonnes affichées
TCD_Stats.FichierParcouru = Stat2015
```


Attention : 

- Si le champ Tableau croisé dynamique est basé sur un fichier de données, le nouveau fichier de données source doit avoir la même structure que le fichier utilisé lors de la création du champ. 

- Si le champ Tableau croisé dynamique est basé sur un tableau de structures : 

	- le nouveau tableau de structures source doit avoir la même structure que la variable utilisée lors de la création du champ. 

	- le nom de la nouvelle structure doit être précédé par ":". Par exemple : 
			
		```wl
		TCD_Stats.FichierParcouru = ":MaNouvelleStructure"
		```













### Progression du calcul
<a name="progression_calcul_ELTPARAGRAPHE000283"></a>

- Pendant le calcul du champ Tableau croisé dynamique, une jauge de progression est affichée. 

- L'utilisateur a la possibilité d'annuler le calcul via un bouton "Annuler". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=FAA_TCD_Cellule_Jauge.gif)
 Pour savoir si le calcul a été effectué jusqu'au bout, utilisez la variable [ErreurDétectée](../WDLang1/3087001.md). 
	Exemple : 
	
	```wl
	PROCEDURE Chargement_TCD()
	
	TCDCalculeTout(TCD_Statistiques)
	SI ErreurDétectée = Vrai ALORS
		SELON Dialogue("Voulez-vous annuler le traitement en cours ?")
			// Annuler
			CAS 1
				Ferme()
			// Continuer
			CAS 0
				Chargement_TCD()
		FIN
	FIN
	```








### Propriétés spécifiques à la gestion des champs Tableau croisé dynamique
<a name="proprietes_specifiques_gestion_des_champs_tableau_croise_dynamique_ELTPARAGRAPHE000144"></a>Les propriétés spécifiques à la gestion des champs Tableau croisé dynamique sont les suivantes : 



|   |   |
| --- | --- |
| [AfficheOrphelin](../Proprietes/1000020697.md) | La propriété **AfficheOrphelin** permet de : <br><br>- Savoir si une ligne ou une colonne d'un champ Tableau croisé dynamique est affichée lorsqu'elle n'a pas de parent. <br><br>- Modifier le mode d'affichage d'une ligne ou d'une colonne d'un champ Tableau croisé dynamique lorsqu'elle n'a pas de parent. <br><br><br> |
| [Cumul](../Proprietes/1000020702.md) | La propriété **Cumul** permet de savoir si la valeur d'une colonne ou d'une ligne d'un champ Tableau croisé dynamique correspond à un total (total de fin de ligne ou de fin de colonne). |
| [Jauge](../Proprietes/1000020706.md) | La propriété **Jauge** permet de connaître et de modifier le champ Jauge utilisé durant le calcul d'un champ Tableau croisé dynamique (fonctions [TCDCalculeTout](../WDLang1/1000020539.md) et [TCDCalculeMiseAJour](../WDLang1/1000020534.md)). |
| [ProcédureFiltre](../Proprietes/1000020655.md) | La propriété **ProcédureFiltre** permet de connaître et de modifier la procédure à appeler pour filtrer sur un entête de ligne ou de colonne durant le calcul d'un tableau croisé dynamique. |
| [RetourALaLigneAuto](../Proprietes/1000021868.md) | La propriété **RetourALaLigneAuto** permet de : <br><br>- savoir si le retour à la ligne est automatiquement géré dans un champ de saisie multiligne, dans une colonne d'un champ Table (ou Table hiérarchique) ou dans un entête de ligne d'un champ Tableau croisé dynamique. <br><br>- indiquer le mode de gestion du retour à la ligne dans un champ de saisie multiligne, dans une colonne d'un champ Table (ou Table hiérarchique) ou dans un entête de ligne d'un champ Tableau croisé dynamique.<br><br><br> |





Pour connaître la liste complète des propriétés du WLangage pouvant être utilisées avec un champ de type Tableau croisé dynamique, consultez [Propriétés associées au champ Tableau croisé dynamique](../WDChamp/1000029003.md).




