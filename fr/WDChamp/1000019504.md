


## Evénements associés à un champ Planning
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Evénements gérés par défaut
<a name="evenements_geres_par_defaut_ELTTEXTE000346"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Evénements gérés par WINDEV et WINDEV Mobile
<a name="evenements_geres_par_windev_windev_mobile_ELTPARAGRAPHE000013"></a>

WINDEV et WINDEV Mobile gèrent par défaut les événements suivants (ordre d'apparition sous l'éditeur de code) :

| Evénement | Condition d'exécution |
| --- | --- |
| Initialisation | Exécuté à l'ouverture de la fenêtre. \* |
| Avant création du rendez-vous | Exécuté :<br><br>- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) lors de la sélection de l'option "Nouveau rendez-vous" dans le menu contextuel du champ Planning.<br><br>- lors de la saisie directe au clavier d'un nouveau rendez-vous.<br><br><br><br><br> |
| ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Entrée en saisie du rendez-vous | Exécuté :<br><br>- lors de la sélection de l'option "Nouveau rendez-vous" dans le menu contextuel du champ Planning.<br><br>- lors de la saisie directe au clavier d'un nouveau rendez-vous.<br><br><br>Cet événement est exécuté immédiatement après l'événement "Avant création du rendez-vous". |
| ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Sortie de saisie d'un rendez-vous | Exécuté lors de la sortie de la saisie d'un rendez-vous (sortie lors de l'ajout d'un rendez-vous ou lors de la modification d'un rendez-vous par le menu contextuel par exemple). |
| Sélection d'un rendez-vous | Exécuté lors de la sélection d'un rendez-vous existant dans le champ Planning. |
| Déplacement d'un rendez-vous | Exécuté lors du déplacement d'un rendez-vous dans le champ Planning. <br><br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Lors d'un déplacement à la souris, cet événement est exécuté à la fin du déplacement (sur le "lâcher" de la souris).<br>**Remarque** : Le déplacement effectué est annulé si cet événement exécute la ligne de code suivante : <br><br><pre><code>Renvoyer Faux</code></pre><br><br><br> |
| ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Redimensionnement d'un rendez-vous | Exécuté lors du redimensionnement d'un rendez-vous dans le champ Planning (redimensionnement effectué à la souris par exemple). Cet événement est exécuté à la fin du redimensionnement (sur le "lâcher" de la souris). |
| ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Suppression d'un rendez-vous | Exécuté :<br><br>- lors de la sélection de l'option "Supprimer le rendez-vous" dans le menu contextuel du champ Planning.<br><br>- lors de la suppression d'un rendez-vous effectué avec la touche SUPPR du clavier.<br><br><br> |
| ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Sélection d'une période | Exécuté lors de la sélection d'une plage horaire dans le champ Planning (clic sur une plage horaire par exemple). Lors de la sélection à la souris d'un ensemble de plages horaires, l'événement est exécuté pour chaque nouvelle plage sélectionnée. |
| A chaque changement de période | ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Exécuté lors de la modification de la période affichée dans le champ Planning (utilisation des boutons fléchés en haut à gauche du champ Planning ou changement de la période par programmation grâce aux fonctions [PlanningAffichePériodePrécédente](../WDLang1/1000019495.md) et [PlanningAffichePériodeSuivante](../WDLang1/1000019496.md)).<br><br> |
| Réaffectation d'un rendez-vous | Exécuté lorsque le déplacement d'un rendez-vous entraîne la modification de la ressource associée au rendez-vous. |
| ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) A chaque changement de mode d'affichage | Exécuté lorsque l'utilisateur change le mode d'affichage du champ Planning. Le nouveau mode peut être connu dans cet événement grâce à la fonction [PlanningMode](../WDLang1/1000019992.md). |


(\*) Par défaut, l'événement "Initialisation" de chaque champ est exécuté selon l'ordre de création des différents champs dans la fenêtre. Pour modifier cet ordre d'exécution : 

1. Sous le volet "Fenêtre", dans le groupe "Ordre", cliquez sur "Initialisation".

2. Dans la fenêtre qui s'affiche, utilisez les flèches situées sur la droite pour modifier l'ordre d'initialisation des champs.






## Evénements avec procédures
<a name="evenements_avec_procedures_ELTTEXTE000376"></a>
Pour simplifier la manipulation des rendez-vous d'un planning, des procédures sont proposées dans chaque événement. Ces procédures prennent en paramètre directement la variable rendez-vous (variable de type [RendezVous](../WDLang1/1000019244.md)) à manipuler. Toutes les informations du rendez-vous manipulé par le menu contextuel sont automatiquement affectées à cette variable. 

**Exemple** : Pour mémoriser dans un fichier de données RDV, un rendez-vous que l'utilisateur ajoute via le menu contextuel, il suffit de saisir dans l'événement "Sortie de saisie d'un rendez-vous" : 

```wl
PROCEDURE SortieDeSaisie(rdvEdité est un RendezVous)

// Mémorisation des données
RDV.Titre = rdvEdité.Titre
RDV.DateDébut = rdvEdité.DateDébut
RDV.DateFin = rdvEdité.DateFin
...
HAjoute(RDV)
```



### Utilisation avancée des événements avec procédure
<a name="utilisation_avancee_des_evenements_avec_procedure_ELTPARAGRAPHE000265"></a>Il est également possible de proposer à l'utilisateur de définir plus précisément les caractéristiques de son rendez-vous lors d'un ajout ou d'une modification. Il suffit pour cela de créer une fenêtre / page avec les informations à remplir. 

Dans le code, il suffit d'ouvrir la fenêtre ou page par exemple dans l'événement "Entrée en saisie d'un rendez-vous". Pour bloquer la saisie directe par le menu contextuel du planning, l'événement doit alors renvoyer <u><u><u><u>Faux</u></u></u></u>. 
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Ce principe peut être appliqué à tous les événements appelés par le menu contextuel du champ Planning. ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Exemple : 

```wl
PROCEDURE Edition(rdvEdité est un RendezVous)

// Ouvre la fenêtre de saisie d'un rendez-vous 
// avec le rendez-vous sélectionné (en mode Création ou Modification)
Ouvre(FEN_SaisieRDV_HFSQL, rdvEdité)

// Renvoie FAUX pour bloquer la saisie directe dans le champ Planning
RENVOYER Faux
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Evénements optionnels
<a name="evenements_optionnels_ELTTEXTE000406"></a>
Plusieurs événements optionnels peuvent être gérés.
Pour ajouter un événement optionnel :

1. Sélectionnez le champ voulu.

2. Affichez la fenêtre de code de ce champ (touche F2).

3. Cliquez sur le lien "Ajouter d'autres événements à xxx" situé à la fin de la fenêtre de code, après le dernier événement.  ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Traitements_optionnels_WD_OK%20-%20HC%20N%B0001.gif)


4. La totalité des événements optionnels disponibles pour le champ est affichée. 

5. Cochez l'événement optionnel à ajouter et validez. 
	Remarque : Il est possible de sélectionner plusieurs événements optionnels. 

6. L'événement optionnel sélectionné est automatiquement ajouté dans les événements gérés par le champ.




Pour désactiver un événement optionnel, il suffit d'effectuer les mêmes manipulations pour afficher la liste des événements optionnels. Il suffit ensuite de décocher les événements optionnels à supprimer. 
Remarque : Si le code désactivé contient du code WLangage, ce code est automatiquement supprimé.Il est ainsi possible de gérer par exemple :

- le survol du champ par la souris,

- le bouton gauche enfoncé, relâché, avec un double-clic,

- le bouton droit enfoncé, relâché, avec double-clic,

- la roulette de la souris, ...




Pour plus de détails, consultez les [Evénements optionnels](../WDChamp/1014004.md).


