


## Etat Tableau croisé
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000201"></a>
L'éditeur d'états offre la possibilité de créer des états de type "Tableau Croisé". L'état est alors constitué uniquement d'un tableau à deux entrées.

**Exemple** : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=etatTableaucroise2.gif&type=thumb)


**Source de données de l'état Tableau croisé** : 
L'état Tableau croisé peut être basé : 

- sur un ou plusieurs fichiers de données. Dans ce cas, une requête intégrée est utilisée. Cette requête est créée grâce à l'assistant de création de l'état "Tableau croisé". Pour plus de détails, consultez [Créer un état de type Tableau Croisé basé sur une requête](#NOTE2_1). 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) un champ Tableau croisé dynamique. Consultez [Etat Tableau croisé dynamique](../WDChamp/1011092.md) pour plus de détails.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) aucune source de données : cette option permet par exemple de préciser le champ Tableau croisé dynamique à utiliser uniquement à l'exécution, grâce à la propriété [NomSource](../Proprietes/2511035.md).




**Remarque** : Si l'état "Tableau croisé" est basé sur une requête, il est possible de modifier la requête intégrée dans l'éditeur de requêtes. Pour éditer la requête intégrée dans l'éditeur de requêtes :

1. Sélectionnez l'option "Description" du menu contextuel de l'état. La fenêtre de description de l'état s'affiche.

2. Affichez l'onglet "Données".

3. Cliquez sur le bouton "Éditer".




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Créer un état de type Tableau Croisé basé sur une requête
<a name="creer_etat_type_tableau_croise_base_sur_une_requete_ELTTEXTE000225"></a>
Pour créer un état de type "Tableau Croisé" basé sur une requête : 

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif)
 parmi les boutons d'accès rapide : 

2. La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Etat" puis sur "Etat".

3. L'assistant de création d'un état se lance. Sélectionnez "Tableau croisé".

4. L'assistant propose alors de sélectionner la source de l'état : choisissez "D'un ou de plusieurs fichiers". 




Dans cet assistant, il est nécessaire de spécifier :

- la rubrique correspondant aux intitulés des colonnes.
	**Remarque** : Si cette rubrique est de type "Date", l'assistant propose de :

	- conserver uniquement le jour, le mois ou l'année de ces dates.

	- définir la période à prendre en compte (date de début et date de fin).




- la rubrique correspondant aux intitulés des lignes.
	**Remarque** : Si cette rubrique est de type "Date", l'assistant propose de :

	- conserver uniquement le jour, le mois ou l'année de ces dates.

	- définir la période à prendre en compte (date de début et date de fin).




- l'information à afficher dans les cellules du tableau. Cette information peut correspondre :

	- soit au **nombre d'enregistrements correspondant à l'intersection des lignes et des colonnes**.
			Par exemple : le nombre de commandes effectuées par année et par client. Le client "Dubois" a effectué 2 commandes en 2000 et 3 en 2001.

	- soit à la **somme, la moyenne, le maximum ou le minimum d'une rubrique**.
			Par exemple : le nombre de produits commandés par produit et par année. En 2000, 279 canapés ont été commandés.

	- soit à une **rubrique**.
			Par exemple : la note attribuée par chaque juge pour un certain patineur. Au championnat d'Europe de 2000, le juge Italien a attribué la note 5.2 au patineur "A".




- le calcul des totaux pour les lignes et les colonnes du tableau (si nécessaire).

- le format de la feuille sur laquelle l'état va être imprimé. Par défaut, l'état est imprimé sur une feuille au format A4.

- le gabarit de l'état (si nécessaire).

- le nom et le titre de l'état. Ce nom (nom du fichier ".WDE" correspondant à l'état) permettra d'identifier l'état dans vos programmes.




L'état créé contient un champ Tableau pour afficher les données. 

Note : Lors de l'impression d'un état Tableau croisé, si le format de l'état ne permet pas d'afficher l'ensemble des colonnes du tableau, le tableau est automatiquement adapté au format d'impression de l'état (diminution des polices et adaptation de la taille des colonnes).

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Créer un état de type Tableau Croisé basé sur un champ Tableau croisé dynamique
<a name="creer_etat_type_tableau_croise_base_sur_champ_tableau_croise_dynamique_ELTTEXTE000249"></a>
Pour créer un état de type "Tableau croisé" : 

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif)
 parmi les boutons d'accès rapide. 

2. La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Etat" puis sur "Etat".

3. L'assistant de création d'un état se lance. 

4. Dans cet assistant, spécifiez :

	- le type d'état à créer : "Tableau croisé".

	- le champ Tableau croisé dynamique utilisé comme source de données.

	- le gabarit de l'état (si nécessaire).

	- le nom et le titre de l'état. Ce nom (nom du fichier ".WDE" correspondant à l'état) permettra d'identifier l'état dans vos programmes.







L'état créé contient un champ Tableau croisé dynamique pour afficher les données. 




### Caractéristiques du champ Tableau croisé dynamique (Editeur d'états)
<a name="caracteristiques_champ_tableau_croise_dynamique_editeur_etats_ELTPARAGRAPHE000131"></a>Il est possible de modifier les caractéristiques suivantes d'un état Tableau croisé contenant un champ Tableau croisé dynamique : 

- La source de données de l'état peut être modifiée dans l'onglet "Données" de la fenêtre de description de l'état (option "Description de l'état" du menu contextuel de l'état). 

- L'onglet "Général" de la fenêtre de description du champ Tableau croisé dynamique permet de spécifier : 

	- **le mode de calcul de la largeur des cellules** : les options disponibles sont les suivantes : 

		- Utiliser la largeur définie en édition :  les cellules seront affichées avec la même largeur que celle définie sous l'éditeur d'états.
						Remarque : Il est possible d'utiliser les poignées pour redimensionner la zone des données dans le champ Tableau croisé dynamique présent dans l'état. 

		- Remplir la page au maximum en largeur : s'il reste de la place dans la page, les cellules seront élargies pour combler l'espace vide.

		- Eviter les cellules tronquées : s'il reste de la place dans la page, les cellules seront éventuellement élargies pour afficher la totalité des données qu'elles contiennent.




- **le déroulement des dimensions** : les options disponibles sont les suivantes : 

	- Comme le champ : le niveau de détail affiché dans l'état sera le même que celui du champ Tableau croisé dynamique utilisé comme source de données.

	- Tout déroulé : toutes les données du Tableau croisé dynamique seront affichées.

	- Tout enroulé : seul le premier niveau de détail du Tableau croisé dynamique sera affiché.

- L'onglet "Style" de la fenêtre de description du champ TCD permet de définir le style du champ : l'option "Définir le style indépendamment du champ TCD imprimé" permet de définir un style spécifique pour le champ dans l'état. Si cette option est cochée, il est possible de spécifier le style des entêtes de lignes et des données.











- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDEtats.gif) ***Exemples didactiques (WINDEV)*** : **WD Etats** <br>Cet exemple montre les différentes méthodes pour réaliser un état :<br> <br>- impressions basées sur différentes sources de données (requêtes, variables, ...)<br>- impressions basées sur des champs (Table, Tableur, TCD, ...)<br>- impression d'états composés<br>- impressions spécifiques (portrait / paysage, état avec filigrane, état avec code-barres, ...)


