
## Fonctionnalités automatiques des champs Tableau croisé dynamique
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000412"></a>
Le champ Tableau croisé dynamique propose plusieurs Fonctionnalités Automatiques de vos Applications (FAA) permettant à l'utilisateur de profiter pleinement de toutes les possibilités du champ. 

L'utilisateur peut : 

- redimensionner la première colonne du champ Tableau croisé dynamique à la souris (colonne contenant les entêtes de ligne). 

- replier/déplier les colonnes et les lignes en cliquant sur les icônes "+" et "-" des entêtes. 

- afficher un menu contextuel lui permettant de réaliser de nombreuses actions sur les lignes et les colonnes. 

- afficher un menu contextuel sur les cellules. 

- sélectionner plusieurs lignes, colonnes ou cellules grâce aux touches Maj et Ctrl. Cette option est disponible uniquement si la multisélection est autorisée dans le champ. Pour plus de détails, consultez [Description d'un champ Tableau croisé dynamique](../WDChamp/1000029007.md). 

- faire une recherche dans les cellules du champ Tableau croisé dynamique en utilisant le raccourci Ctrl + F.




Les fonctionnalités du menu contextuel sur les lignes et les colonnes sont les suivantes : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=FAA_TCD.gif)


- [Supprimer/Réafficher plusieurs colonnes](#NOTE2_1)

- [Replier/Déplier les colonnes](#NOTE2_2),

- [Déplier un niveau et tous ses sous-niveaux](#NOTE2_2),

- [Ajouter des regroupements (semaine/mois/trimestre)](#NOTE2_Ajouter), 

- [Réorganiser les entêtes de lignes et de colonnes](#NOTE2_Reorganiser),

- [Inverser lignes et colonnes](#NOTE2_Inverser),

- [Comparer les périodes](#NOTE2_Comparer),

- Copier une ou plusieurs lignes,

- [Exporter le contenu du champ Tableau croisé dynamique vers un document Excel](#NOTE2_3),

- [Charger/Sauvegarder le contenu du champ Tableau croisé dynamique](#NOTE2_4),

- [Restaurer la taille et les regroupements initiaux](#NOTE2_5), 

- [Imprimer le contenu du champ](../WDChamp/1000029009.md).




Les fonctionnalités du menu contextuel sur les cellules sont les suivantes : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=FAA_TCD_Cellule.gif)


- Copier l'élément, copier la ligne, copier la colonne,

- [Exporter le contenu du champ Tableau croisé dynamique vers un document Excel](#NOTE2_3),

- [Changer la couleur de fond d'une cellule](#NOTE2_6). 

- [Charger/Sauvegarder le contenu du champ Tableau croisé dynamique](#NOTE2_4),

- [Restaurer la taille et les regroupements initiaux](#NOTE2_5).

- [Mémoriser la taille et les regroupements](#NOTE2_5B).

- [Imprimer le contenu du champ](../WDChamp/1000029009.md).




Remarque : Si la multisélection des lignes, des colonnes et des cellules a été activée sur le champ Tableau croisé dynamique, certaines opérations sont disponibles uniquement sur les lignes, colonnes ou cellules sélectionnées.

<a name="NOTE2"></a>


## Les fonctionnalités du menu contextuel
<a name="les_fonctionnalites_menu_contextuel_ELTTEXTE000436"></a>
<a name="NOTE2_1"></a>


### Supprimer les colonnes et les lignes
<a name="supprimer_les_colonnes_les_lignes_ELTPARAGRAPHE000122"></a>Certains tableaux croisés dynamiques peuvent être constitués d'un grand nombre de lignes et de colonnes (par exemple, si le tableau croisé dynamique affiche de nombreux niveaux hiérarchiques).

Pour obtenir un affichage plus concis, il est possible de :

- supprimer la colonne en cours. 

- supprimer toutes les colonnes identifiées avec la même information. Par exemple, sur un tableau croisé dynamique présentant des calculs sur plusieurs années, il est possible de supprimer le mois de février sur toutes les années affichées dans ce tableau. 

- supprimer toutes les colonnes sauf les colonnes identifiées avec la même information. Par exemple, sur un tableau croisé dynamique présentant des calculs sur plusieurs années, il est possible d'afficher seulement les mois de février de chaque année. Tous les autres mois seront supprimés. 




Ce mode d'affichage est également disponible sur les lignes.

**Lors de la suppression, le contenu du tableau croisé dynamique est recalculé : les totaux sont mis à jour.** 

Les colonnes et/ou les lignes supprimées peuvent être réaffichées à tout moment (option "Ré-afficher toutes les colonnes supprimées" par exemple). Lors du réaffichage, le contenu du tableau croisé dynamique est recalculé : les totaux sont mis à jour. 

**Attention** : Si une colonne ou une ligne n'est pas répétée, la seule action possible est de supprimer la colonne ou la ligne sélectionnée.
<a name="NOTE2_2"></a>


### Replier/Déplier les colonnes ou les lignes
<a name="replierdeplier_les_colonnes_les_lignes_ELTPARAGRAPHE000143"></a>Dans le cas d'un tableau croisé dynamique avec une hiérarchie très importante, il est possible : 

- de replier ou déplier en une seule action toutes les colonnes et/ou toutes les lignes. 

- déplier en une seul action un niveau et tous ses sous-niveaux (en colonne ou en ligne). 




Par exemple : 

- Si toutes les colonnes sont dépliées, le tableau croisé dynamique est très détaillé : tous les résultats intermédiaires sont visibles, du niveau le plus haut au niveau le plus bas. 

- Si toutes les colonnes sont repliées, le tableau croisé dynamique est synthétique : il présente uniquement les calculs de premier niveau. 



<a name="NOTE2_Ajouter"></a>


### Ajouter des regroupements : à la semaine, à la quinzaine, au semestre, ... 
<a name="ajouter_des_regroupements_semaine_quinzaine_semestre_ELTPARAGRAPHE000162"></a>Si le tableau croisé dynamique ne contient pas assez de détails, il est possible d'ajouter des colonnes pour affiner les statistiques affichées. 

Le menu contextuel des colonnes propose l'option "Ajouter". Grâce à cette option, il est possible d'ajouter les regroupements non affichés, par exemple : Semestre, Trimestre, Quinzaine, ...

Attention : cette option nécessite le recalcul du tableau croisé dynamique. Si plusieurs opérations doivent être effectuées, il est possible de reporter le recalcul des données. 
<a name="NOTE2_Reorganiser"></a>


### Réorganiser les entêtes de lignes et de colonnes
<a name="reorganiser_les_entetes_lignes_colonnes_ELTPARAGRAPHE000175"></a>Cette option permet de modifier l'affichage des lignes et des colonnes dans le champ Tableau Croisé dynamique. 

Lorsque cette option est sélectionnée, le tableau croisé dynamique passe en édition. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=TCD_Inverser_dim1.gif)


Il est alors possible : 

- de rendre visibles ou non des lignes ou des colonnes. 
	Pour rendre visibles des éléments, il suffit de sélectionner les éléments non affichés présents dans la zone "Entêtes non affichés" et de les déplacer vers l'emplacement voulu dans les lignes ou les colonnes. 
	Pour rendre invisibles des éléments, il suffit de sélectionner l'entête correspondant et de le déplacer vers la zone "Entêtes non affichés". 

- d'inverser les dimensions. Il suffit de sélectionner l'entête voulu et de le déplacer par un simple "Drag and Drop" vers la position voulue. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=TCD_Inverser_dim2.gif)




<a name="NOTE2_Inverser"></a>


### Inverser les entêtes de lignes et de colonnes
<a name="inverser_les_entetes_lignes_colonnes_ELTPARAGRAPHE000197"></a>Cette option permet de faire pivoter les données du champ Tableau croisé dynamique. Toutes les colonnes deviennent des lignes et toutes les lignes deviennent des colonnes. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WD%20-%20TCD%20Faire%20Pivoter.jpg)


**Remarque** : Pour inverser par programmation les lignes et colonnes d'un champ Tableau croisé dynamique, utilisez la fonction [FAAExécute](../WDLang1/1000022099.md) avec la constante *faaTcdInverseLigneColonne*.
<a name="NOTE2_Comparer"></a>


### Comparer les périodes
<a name="comparer_les_periodes_ELTPARAGRAPHE000212"></a>Cette option permet de comparer les données affichées dans le champ Tableau croisé dynamique sur 2 périodes. 

A la sélection de cette option : 

- Une fenêtre s'affiche permettant de saisir les caractéristiques de la comparaison : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=FAA_TCD_Comparer%20-%20HC%20N%B0001.gif&type=thumb)
La comparaison sera effectuée selon la période de référence indiquée dans cette fenêtre et non selon la période actuellement affichée par le tableau croisé dynamique. 

	- Période de référence. 

	- Période précédente de comparaison. 

	- L'affichage de l'évolution entre les années.




- La validation de cette fenêtre entraîne le recalcul des données affichées, pour obtenir uniquement les données de la comparaison. Par exemple : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=FAA_TCD_Comparer%20-%20HC%20N%B0002.gif&type=thumb)

	Si l'affichage de l'évolution entre les années a été demandé, l'évolution par rapport à la période précédente est affichée en vert ou en rouge selon qu'elle est positive ou négative. Le menu contextuel des données comparées propose les deux options suivantes pour améliorer la comparaison : 

	- Afficher les évolutions. 

	- Afficher les évolutions en pourcentage. 





Pour revenir à l'affichage normal du champ Tableau croisé dynamique, il est nécessaire de sélectionner l'option "Annuler la comparaison de périodes" du menu contextuel du champ. 

**Remarque** : Pour lancer la comparaison de périodes par programmation, utilisez la fonction [FAAExécute](../WDLang1/1000022099.md) avec la constante *faaComparerPériodeTcd*.




<a name="NOTE2_3"></a>


### Exporter le champ Tableau croisé dynamique vers Excel
<a name="exporter_champ_tableau_croise_dynamique_vers_excel_ELTPARAGRAPHE000248"></a>Cette option permet d'exporter le contenu du tableau croisé dynamique vers Excel. Cette option correspond à la fonction [TCDVersExcel](../WDLang1/1000020703.md). Il suffit d'indiquer le nom du fichier XLS à créer. Le document créé peut être ouvert directement. Le contenu du document XLS créé correspond exactement aux données affichées dans le tableau croisé dynamique. Les colonnes cachées ou repliées ne seront pas visibles dans le fichier XLS. 
<a name="NOTE2_4"></a>


### Charger/Sauvegarder le contenu du tableau croisé dynamique
<a name="chargersauvegarder_contenu_tableau_croise_dynamique_ELTPARAGRAPHE000258"></a>Pour éviter le recalcul d'un tableau croisé dynamique affiché précédemment, il est possible de sauvegarder le contenu du tableau croisé dynamique dans un fichier sur le disque afin de le ré-ouvrir plus tard ou de l'envoyer à une autre personne. Cette option correspond à la fonction [TCDSauve](../WDLang1/1000020471.md). 

Le fichier créé pourra être ré-ouvert ultérieurement (équivalent à la fonction [TCDCharge](../WDLang1/1000020507.md)). 

Attention : Le fichier créé ne pourra s'ouvrir que sur un tableau croisé dynamique de même nature (les colonnes et les lignes doivent correspondre).

Remarque : Le fichier de sauvegarde peut être crypté par un mot de passe. 

- Lors de l'enregistrement du fichier, il suffit de cocher l'option "Crypter avec un mot de passe" lors de la saisie du nom du fichier de sauvegarde. Dans ce cas, à la validation, une nouvelle fenêtre s'affiche demandant le mot de passe à utiliser : 

<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=FAA_TCD_Cryptage%20-%20HC%20N%B0002.gif)


- Lors du chargement du fichier, cette même fenêtre s'affiche si le fichier est crypté. Il suffit de saisir le mot de passe correspondant. 




La fenêtre de saisie du mot de passe est disponible en Français et Anglais. 
<a name="NOTE2_5"></a>


### Restaurer la taille et les regroupements initiaux
<a name="restaurer_taille_les_regroupements_initiaux_ELTPARAGRAPHE000287"></a>Cette option permet de retrouver le paramétrage par défaut du tableau croisé dynamique.


<a name="NOTE2_5B"></a>


### Mémoriser la taille et les regroupements
<a name="memoriser_taille_les_regroupements_ELTPARAGRAPHE000297"></a>Cette option permet de mémoriser le dernier paramétrage du tableau croisé dynamique. Ainsi, à la prochaine ouverture de la fenêtre, ce paramétrage sera automatiquement réutilisé. 

L'utilisateur n'a plus à reconfigurer le champ à chaque affichage. 
<a name="NOTE2_6"></a>
**Menu contextuel d'une cellule : changer la couleur de fond**
Le menu contextuel d'une cellule permet à l'utilisateur de changer simplement la couleur d'une cellule du champ Tableau croisé dynamique. Il est ainsi possible de retrouver facilement des éléments importants dans le tableau croisé dynamique. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=FAA_TCD_Cellule_Coul1.gif)


Astuce : La dernière couleur utilisée est automatiquement proposée dans le menu contextuel de la cellule. Pratique pour appliquer la même couleur sur plusieurs cellules. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=FAA_TCD_Cellule_Coul2.gif)




Lors d'une sauvegarde du contenu du tableau croisé dynamique (avec IHM), les couleurs spécifiées sont sauvegardées. 



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Paramétrage
<a name="parametrage_ELTTEXTE000520"></a>


### Paramétrage du menu automatique dans un champ Tableau croisé dynamique
<a name="parametrage_menu_automatique_dans_champ_tableau_croise_dynamique_ELTPARAGRAPHE000327"></a>Le menu contextuel d'un champ Tableau croisé dynamique peut bien évidemment être désactivé. Pour paramétrer l'affichage du menu contextuel, vous devez :

1. Ouvrir la fenêtre de description du champ Tableau croisé dynamique.

2. Sélectionner l'onglet "UI".

3. Choisir le menu désiré dans la combo "Menu contextuel". Il est possible de : 

	- "Afficher le menu des FAA (Système)" : Dans ce cas, le menu contextuel affiché sera le menu automatique du champ Tableau croisé dynamique (menu des FAA). Pour plus de détails sur la configuration de ce menu, consultez [Configurer le menu des FAA](../Editeurs/2010040.md).

	- "Ajouter un menu contextuel" : Si cette option est cochée, vous pouvez sélectionner le menu contextuel personnalisé à afficher. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Fonctionnalites_auto_Menu2.gif)








Remarques : 

- Si les deux options sont cochées, le menu contextuel personnalisé peut être ajouté avant ou après le menu des FAA. 

- Si aucune option n'est sélectionnée, aucun menu contextuel ne sera sélectionné. L'option &lt;Désactivé&gt; sera affichée dans la fenêtre de description. 

- La propriété [MenuContextuel](../Proprietes/2510077.md) permet également de supprimer le menu contextuel spécifique aux FAA et de retrouver le menu Windows classique pour un champ spécifique.











