
## Manipuler un champ Tableur par programmation (dans un état)
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000124"></a>
Un champ Tableur présent dans un état peut être manipulé par programmation. 

- Si le champ Tableur n'est lié à aucune donné, il est possible de l'initialiser par programmation. 

- Plusieurs propriétés sont spécifiques à la gestion d'un champ Tableur dans un état. 

- Le traitement "Avant impression de cellule" permet de modifier les cellules du champ Tableur. 




Remarques : 

- Il n'est pas possible de créer des cellules lors de l'impression. L'impression doit être effectuée depuis le champ Tableur présent dans une fenêtre ou depuis un document Excel. 

- Il n'est pas possible de modifier la hauteur ou la largeur des cellules, lignes ou colonnes. 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Initialisation d'un champ Tableur dans un état
<a name="initialisation_champ_tableur_dans_etat_ELTTEXTE000148"></a>
Pour initialiser un champ Tableur d'un état par programmation, il suffit d'affecter directement le fichier Excel au champ (par exemple dans le traitement d'ouverture de l'état ou dans le traitement d'initialisation du champ). 


```txt
<Nom_Champ_Tableur> = <Nom du fichier>
```


Par exemple : 

```wl
TBLR_Statistique = "Defile2015.xlsx"
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Propriétés spécifiques à la gestion d'un champ Tableur dans un état
<a name="proprietes_specifiques_gestion_champ_tableur_dans_etat_ELTTEXTE000172"></a>
Les propriétés spécifiques à la gestion des champs Tableur dans les états sont les suivantes : 



|   |   |
| --- | --- |
| [FeuilleImprimée](../Proprietes/1000021814.md) | La propriété **FeuilleImprimée** permet de connaître et de modifier la feuille à imprimer dans un champ Tableur présent dans un état. |
| [ModeAjustement](../Proprietes/1000021790.md) | La propriété **ModeAjustement** permet de connaître et de modifier le mode d'ajustement d'un champ Tableur dans un état. |
| [QuadrillageVisible](../Proprietes/1000023117.md) | La propriété **QuadrillageVisible** permet de : <br><br>- Savoir si le quadrillage est visible ou non dans un champ. <br><br>- Modifier la visibilité du quadrillage dans un champ.<br><br><br> |
| [ZoneImpression](../Proprietes/1000021809.md) | La propriété **ZoneImpression** permet de connaître et de modifier la zone à imprimer d'un champ Tableur présent dans un état. |





Pour connaître la liste complète des propriétés du WLangage pouvant être utilisées avec un champ de type Tableur et avec ses cellules, consultez [Propriétés associées au champ Tableur](../WDChamp/1000033003.md)

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Traitement "Avant impression de cellule"
<a name="traitement_avant_impression_cellule_ELTTEXTE000229"></a>
Le traitement "Avant impression de cellule" est un traitement associé au champ Tableur dans les états. 

Ce traitement permet de personnaliser les caractéristiques des cellules du champ Tableur. 

Il est possible d'utiliser : 

- le mot-clé **MoiMême** pour obtenir le nom de la cellule courante. 

- la syntaxe **MoiMême[MoiMême]** pour obtenir le contenu de la cellule. 




Astuce : **MoiMême[MoiMême]** correspond à une variable de type [xlsCellule](../WDLang5/1000017472.md). Toutes les propriétés de ce type de variable sont utilisables et permettent de modifier les caractéristiques de la cellule. 

Exemple : 


```wl
MaPolice est une Police
MaPolice.Nom = "Comic Sans MS"
MaPolice.Taille = 10
MaPolice.Gras = Vrai
MaPolice.Souligné = Vrai
MaPolice.Couleur = BleuPastel

UnCadre est un Cadre
UnCadre.Trait = TraitMixte
UnCadre.Epaisseur = 1
UnCadre.Bords = BordTous

SI MoiMême [= "B" ALORS
	MoiMême[MoiMême].CouleurFond = OrangePastel
	SI Droite(MoiMême[MoiMême],1) = 8 ALORS
		MoiMême[MoiMême].Police = MaPolice 
	FIN
	SI Droite(MoiMême[MoiMême],1) = 6 ALORS
		MoiMême[MoiMême].Cadre = UnCadre
	FIN
	SI Droite(MoiMême[MoiMême],1) = 2 ALORS
		MoiMême[MoiMême].Valeur = "RESET"
		MoiMême[MoiMême].Police.Couleur = Noir
		MoiMême[MoiMême].Police.Taille = 13
	FIN
FIN
```



