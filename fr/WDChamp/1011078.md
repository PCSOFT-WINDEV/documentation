
## Etat Planning
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000209"></a>
L'éditeur d'états offre la possibilité de créer des états de type "Planning". 

L'état est alors constitué uniquement d'un champ Planning. Ce type de champ est créé uniquement lors de la création d'un état Planning : il ne peut pas être créé indépendamment de cet état. 

Exemple : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Etat_Planning.gif&type=thumb)


Sous l'éditeur, ce champ est constitué de deux blocs : 

- Le bloc "En-tête" affichant les titres des colonnes du planning. 

- Le bloc "Planning" affichant dans un champ Planning les ressources avec les rendez-vous. 





![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Etat_Planning_Editeur.gif&type=thumb)


<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Créer un état Planning
<a name="creer_etat_planning_ELTTEXTE000233"></a>


### Création de l'état
<a name="creation_etat_ELTPARAGRAPHE000029"></a>Pour créer un état de type "Planning" : 

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif)
 parmi les boutons d'accès rapide. 

2. La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Etat" puis sur "Etat". 

3. L'assistant de création d'un état se lance. 

4. Dans cet assistant, spécifiez :

	- le type d'état à créer ("Etat Planning") avec les [informations spécifiques à la création d'un planning](#NOTE2_2) : 

		- le nombre de jours à afficher.

		- la granularité du quadrillage.

		- le mode d'affichage des ressources (ressources en lignes ou en colonnes).  




- le modèle utilisé si nécessaire,

- la source de données de l'état (fichier de données, requête, champ Planning, ...). Pour plus de détails, consultez [Source de données d'un état](../WDChamp/1011055.md).



<a name="NOTE2_2"></a>


### Informations spécifiques à la création du Planning
<a name="informations_specifiques_creation_planning_ELTPARAGRAPHE000062"></a>Les informations spécifiques à la création du Planning sont les suivantes :

- Nombre de jours à afficher dans le champ Planning : Il est possible d'imprimer le planning : 

	- d'une journée, 

	- d'une semaine sur 5 jours,

	- d'une semaine sur 7 jours,

	- d'un mois,

	- du premier au dernier rendez-vous,

	- avec un nombre de jours personnalisé. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Ass_Creation_pln.gif)





- La granularité du quadrillage. Cette granularité permet de définir la taille de la grille utilisée pour afficher le quadrillage du champ Planning. Par défaut, cette granularité est de 30 minutes. Selon le nombre de jours à afficher, il est nécessaire de modifier cette information. 
	Cette caractéristique peut être modifiée par programmation grâce à la propriété [GranularitéQuadrillage](../Proprietes/1000020107.md). 

- Le mode d'affichage des ressources. Les ressources peuvent être affichées en lignes ou en colonnes. 




**Remarque** :  Si l'état Planning est lié à une source de données (requête, fichier de données), il est nécessaire d'indiquer dans la suite de l'assistant les rubriques à prendre en compte pour l'affichage du planning et des rendez-vous. Les informations principales à indiquer sont : 

- le titre du rendez-vous

- la ressource associée au rendez-vous

- la date de début et de fin du rendez-vous




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Caractéristiques d'un état Planning et d'un champ Planning
<a name="caracteristiques_etat_planning_champ_planning_ELTTEXTE000263"></a>


### Caractéristiques du Planning (Editeur d'états)
<a name="caracteristiques_planning_editeur_etats_ELTPARAGRAPHE000094"></a>Il est possible de modifier les caractéristiques suivantes d'un état Planning : 

- La source de données de l'état Planning peut être modifiée dans l'onglet "Données" de la fenêtre de description de l'état (option "Description de l'état" du menu contextuel de l'état). 

- L'onglet "Général" de la fenêtre de description du champ Planning permet de spécifier : 

	- le nombre de jours à afficher dans le champ. 

	- la granularité du quadrillage.

	- la plage horaire visible. 

	- l'affichage des rendez-vous à la journée entière. Si l'option "Afficher les rendez-vous à la journée entière" est cochée, l'état prend en charge les rendez-vous pour lesquels la caractéristique "Journée entière" est gérée (pour plus de détails, consultez [Variable de type RendezVous](../WDLang1/1000019244.md)). Dans ce cas, une zone permettant d'afficher les rendez-vous à la journée apparaît dans le planning : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Planning_journee_Etat.gif)
Remarque : Vérifiez que la zone d'affichage des rendez-vous à la journée est correctement dimensionnée sous l'éditeur d'états. Il est possible de la redimensionner si nécessaire.

	- l'état personnalisé pour afficher les rendez-vous. 

		- Si l'option sélectionnée est "Aucun", l'affichage par défaut est utilisé. 

		- Si l'option "Etat prédéfini" est sélectionnée, un état prédéfini est automatiquement ajouté au projet. Par défaut, cet état a pour nom "ETAT_WinDevVueRDV" et est automatiquement utilisé pour l'affichage des rendez-vous.
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Etat_WinDevvueRDV.gif)
Cet état peut être personnalisé, renommé, ...

		- Si l'option sélectionnée correspond à un état du projet, cet état sera utilisé pour afficher les rendez-vous.
						Il est conseillé de personnaliser l'état proposé par défaut.
						Le même état peut être utilisé pour personnaliser les rendez-vous dans un état planning ou agenda.  




- le mode d'affichage des ressources : en lignes ou en colonnes. Si les ressources sont affichées en colonnes, il est possible de préciser le nombre de ressources affichées en colonnes. 

- le masque d'affichage des dates et des heures. 

- Si le champ Planning est lié à une source de données (fichier de données, requêtes, ...), l'onglet "Contenu" de la fenêtre de description du champ permet de lier les données du rendez-vous avec les données présentes dans la source de données. 

- L'onglet "Style" de la fenêtre de description du champ Planning permet de spécifier le style : 

	- du libellé des ressources.

	- des rendez-vous affichés dans le champ Planning. 









<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Manipulation d'un planning dans un état par programmation
<a name="manipulation_planning_dans_etat_par_programmation_ELTTEXTE000287"></a>


### Fonctions WLangage
<a name="fonctions_wlangage_ELTPARAGRAPHE000143"></a>Différentes fonctions WLangage sont disponibles dans l'éditeur d'états pour manipuler les champs Planning. Ces fonctions sont les suivantes : 



|   |   |
| --- | --- |
| [PlanningAjouteRendezVous](../WDLang1/1000019273.md) | Ajoute un nouveau rendez-vous dans un champ Planning. |
| [PlanningAjouteRessource](../WDLang1/1000019279.md) | Ajoute une nouvelle ressource dans un champ Planning. |
| [PlanningChangeMode](../WDLang1/1000019440.md) | Modifie la période (c'est-à-dire le nombre de jours) affichée par un champ Planning. |
| [PlanningCouleurFond](../WDLang1/1000019997.md) | Fixe une couleur de fond sur une plage horaire d'un champ Planning présent dans une fenêtre (par exemple, plage horaire correspondant au déjeuner, à un jour férié, ...). |
| [PlanningHeureAffichée](../WDLang1/1000019373.md) | Définit la plage horaire affichée par le champ Planning en mode Jour ou Semaine. |
| [PlanningListeRendezVous](../WDLang1/1000019276.md) | Renvoie : <br><br>- la liste des rendez-vous compris entre deux dates données dans un champ Planning, <br><br>- tous les rendez-vous d'un champ Planning,<br><br>- un rendez-vous particulier (sélectionné ou survolé). <br><br><br> |
| [PlanningMode](../WDLang1/1000019992.md) | Renvoie le mode d'affichage d'un champ Planning : jour, semaine, mois, ... |
| [PlanningPosition](../WDLang1/1000019372.md) | Affiche un champ Planning à partir d'une date spécifiée ou renvoie la date du premier jour (ou dernier jour) affiché dans un champ Planning. |
| [PlanningPositionDateHeure](../WDLang1/1000019998.md) | Affiche un champ Planning à partir d'une date spécifiée ou renvoie la date du premier jour (ou dernier jour) affiché dans un champ Planning. |
| [PlanningSupprimeRendezVous](../WDLang1/1000019274.md) | Supprime un rendez-vous dans un champ Planning. |
| [PlanningSupprimeRessource](../WDLang1/1000019282.md) | Supprime une ressource dans un champ Planning. |
| [PlanningSupprimeTout](../WDLang1/1000019275.md) | Supprime tous les rendez-vous et toutes les ressources d'un champ Planning. |






<a name="NOTE4_2"></a>


### Propriétés WLangage
<a name="proprietes_wlangage_ELTPARAGRAPHE000152"></a>Différentes propriétés WLangage sont disponibles dans l'éditeur d'états pour manipuler les champs Planning. Ces propriétés sont les suivantes : 



|   |   |
| --- | --- |
| [DateDébutPériodeAffichée](../Proprietes/1000020183.md) | La propriété **DateDébutPériodeAffichée** permet de connaître la date de début de la période affichée dans un champ Planning ou Agenda d'un état. |
| [DateFinPériodeAffichée](../Proprietes/1000020184.md) | La propriété **DateFinPériodeAffichée** permet de connaître la date de fin de la période affichée dans un champ Planning ou Agenda d'un état. |
| [GranularitéQuadrillage](../Proprietes/1000020107.md) | La propriété **GranularitéQuadrillage** permet de connaître et de modifier la taille de la grille utilisée pour l'affichage du quadrillage dans un champ Planning ou un champ Agenda d'un état. |
| [Hauteur](../Proprietes/2510050.md) | La propriété **Hauteur** permet de connaître et modifier la hauteur :<br><br>- d'un champ ou d'un bloc dans un état.<br><br>- d'un champ (présent dans une fenêtre), d'une fenêtre, d'une ligne d'un champ Table ou Liste (y compris Liste image), d'une option d'un champ Sélecteur ou Interrupteur, d'un haut ou d'un bas de rupture d'un champ Table ou d'un champ Zone répétée.<br><br>- d'un champ (présent dans une page), d'un haut ou bas de rupture d'un champ Table ou Zone répétée. Le champ peut être superposable ou non.<br><br>- d'une cellule de rupture d'un champ Table ou d'un champ Zone répétée.<br><br><br> |
| [Largeur](../Proprietes/2510059.md) | La propriété **Largeur** permet de connaître et modifier la largeur :<br><br>- d'un champ ou d'un bloc dans un état.<br><br>- d'un champ (présent dans une fenêtre), d'une fenêtre, d'une colonne de table ou d'une colonne de liste (y compris liste image).<br><br>- d'un champ (présent dans une page), d'une colonne de table ou d'une liste. Le champ peut être superposable ou non.<br><br><br> |
| [LibelléPériodeEntête](../Proprietes/1000020185.md) | La propriété **LibelléPériodeEntête** permet de connaître et de modifier le contenu du libellé de la période affiché dans l'entête d'un champ Planning ou Agenda dans un état. <br><br> |
| [Nom](../Proprietes/2510082.md) | La propriété **Nom** permet de connaître :<br><br>- le nom de la police associée à une variable de type Police.<br><br>- le nom d'un champ, d'un état ou d'un bloc d'un état.<br><br>- le nom d'un champ, d'un groupe de champs ou d'une fenêtre.<br><br>- le nom d'un champ, d'un groupe de champs ou d'une page.<br><br><br> |
| [PoliceContenuRendezVous](../Proprietes/1000020685.md) | La propriété **PoliceContenuRendezVous** permet de :<br><br>- Connaître les caractéristiques de la police utilisée pour le contenu des rendez-vous dans les états de type Planning et Agenda. <br><br>- Modifier les caractéristiques de la police utilisée pour le contenu des rendez-vous dans les états de type Planning et Agenda.<br><br><br> |
| [PoliceTitreRendezVous](../Proprietes/1000020684.md) | La propriété **PoliceTitreRendezVous** permet de :<br><br>- Connaître les caractéristiques de la police utilisée pour le titre des rendez-vous dans les états de type Planning et Agenda. <br><br>- Modifier les caractéristiques de la police utilisée pour le titre des rendez-vous dans les états de type Planning et Agenda.<br><br><br> |
| [Visible](../Proprietes/2510138.md) | La propriété **Visible** permet de :<br><br>- Savoir si un élément est visible.<br><br>- Rendre un élément visible ou invisible.<br><br><br> |
| [X](../Proprietes/2510135.md) | La propriété **X** permet de :<br><br>- Connaître l'abscisse d'un champ, d'une colonne d'un champ Table ou d'une fenêtre (position sur l'axe des X).<br><br>- Modifier l'abscisse d'un champ ou d'une fenêtre (position sur l'axe des X).<br><br><br> |
| [Y](../Proprietes/2510137.md) | La propriété **Y** permet de :<br><br>- Connaître l'ordonnée d'un champ ou d'une fenêtre (position sur l'axe des Y).<br><br>- Modifier l'ordonnée d'un champ ou d'une fenêtre (position sur l'axe des Y).<br><br><br> |
















- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDEtats.gif) ***Exemples didactiques (WINDEV)*** : **WD Etats** <br>Cet exemple montre les différentes méthodes pour réaliser un état :<br> <br>- impressions basées sur différentes sources de données (requêtes, variables, ...)<br>- impressions basées sur des champs (Table, Tableur, TCD, ...)<br>- impression d'états composés<br>- impressions spécifiques (portrait / paysage, état avec filigrane, état avec code-barres, ...)




