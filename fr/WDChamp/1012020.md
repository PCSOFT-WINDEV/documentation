
## Page paramétrée
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Passer des paramètres à une page lors de son ouverture
<a name="passer_des_parametres_une_page_lors_son_ouverture_ELTTEXTE000137"></a>




### Pour passer des paramètres à une page lors de son ouverture :
<a name="pour_passer_des_parametres_une_page_lors_son_ouverture_ELTPARAGRAPHE000012"></a>**1.** Déclarez une procédure dans l'événement "Déclarations globales" de la page. Le nom de cette procédure doit être identique au nom de la page. Les paramètres de cette procédure correspondent aux paramètres à passer à la page.

**Attention** : La déclaration de la procédure (mot-clé PROCEDURE) doit correspondre à la première ligne de l'événement "Déclarations globales".

Par exemple, la page PAGE_CALENDRIER permet de gérer la sélection d'une date dans un calendrier. Cette page attend un paramètre indiquant la date à sélectionner.


```wl
// -- Déclarations globales PAGE_CALENDRIER --

PROCEDURE PAGE_Calendrier(sDateSel)
// sDateSel : date précisant la date à sélectionner.
```


Ce paramètre est ensuite manipulable depuis n'importe quel événement de la page (bouton, procédures locales, ...).

Par exemple, dans l'événement "Initialisation" de la page PAGE_CALENDRIER :


```wl
// -- Initialisation PAGE_CALENDRIER --

// Le champ SAI_ChampDate est un champ de saisie
// Il contient la valeur du paramètre sDateSel
SAI_ChampDate = sDateSel
```


**2.** Passez le paramètre attendu par la page lors de son ouverture (fonction [PageAffiche](../WDLang2/3058008.md), [PageUtilise](../WDLang2/3058016.md), ...). Par exemple, le bouton BTN_CALENDRIER permet d'ouvrir la page PAGE_CALENDRIER. Lors de l'ouverture de cette page, la date du jour est passée en paramètre.


```wl
// -- Code de clic du bouton BTN_CALENDRIER --

// Ouverture de la page PAGE_CALENDRIER
// Passage de la date du jour en paramètre
PageAffiche(PAGE_CALENDRIER, DateDuJour())
```




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Tester une page paramétrée
<a name="tester_une_page_parametree_ELTTEXTE000161"></a>
Pour tester une page paramétrée :

1. Ouvrez la page paramétrée sous l'éditeur de pages.

2. Cliquez sur l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_Go_Page_bl.gif)
 (ou appuyez sur la touche F9). La fenêtre suivante apparaît :
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Page_Parametree%20-%20HC%20N%B0001.gif)


3. Spécifiez la valeur du ou des paramètres à utiliser pour le test de la page. Pour utiliser la valeur par défaut du ou des paramètres, saisissez le caractère "\*".

4. Validez. La page s'affiche selon la ou les valeurs spécifiées.






<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Notes
<a name="notes_ELTTEXTE000185"></a>


### Paramètres passés par valeur
<a name="parametres_passes_par_valeur_ELTPARAGRAPHE000060"></a>Si les paramètres passés à une page sont modifiés dans cette page, ces modifications seront prises en compte uniquement dans cette page. La valeur de ces paramètres n'est pas modifiée dans l'événement appelant.

Par exemple :

1. La variable *MaDate* est déclarée dans le code du bouton BTN_CALENDRIER. Cette variable contient la date du jour (par exemple : MaDate = DateDuJour()).

2. Cette variable est passée en paramètre à la page PAGE_CALENDRIER. Le paramètre *sDateSel* contient la valeur de la variable *MaDate*.

3. La valeur du paramètre *sDateSel* est modifiée dans la page PAGE_CALENDRIER (par exemple : sDateSel = "20020701")

4. La valeur de la variable *MaDate* n'est pas modifiée.





<a name="NOTE3_2"></a>


### Donner une valeur par défaut aux paramètres dans la déclaration
<a name="donner_une_valeur_par_defaut_aux_parametres_dans_declaration_ELTPARAGRAPHE000075"></a>Il est possible de donner une valeur par défaut aux paramètres dans la déclaration des paramètres.

Par exemple, pour donner une valeur par défaut dans l'exemple précédent, saisissez le code suivant dans l'événement "Déclarations globales" de la page PAGE_CALENDRIER :


```wl
// -- Déclarations globales de la page PAGE_CALENDRIER --

PROCEDURE PAGE_Calendrier(sDateSel = 20030101)
// sDateSel : date précisant la date à sélectionner.
```



<a name="NOTE3_3"></a>


### Portées des paramètres
<a name="portees_des_parametres_ELTPARAGRAPHE000087"></a>Les paramètres passés à une page sont globaux à tous les événements de cette page (initialisation, code d'un bouton, code d'une procédure locale, ...).




