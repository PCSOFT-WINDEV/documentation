


## Champ Tableur dans un état
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Créer un champ Tableur dans un état
<a name="creer_champ_tableur_dans_etat_ELTTEXTE000128"></a>


### Création du champ
<a name="creation_champ_ELTPARAGRAPHE000011"></a>Pour créer un champ de type Tableur : 

1. Sous le volet "Création", dans le groupe "Données", cliquez sur "Tableur". 

2. Cliquez dans l'état à la position où le champ doit être créé.




Pour afficher les caractéristiques du champ, sélectionnez l'option "Description" dans le menu contextuel du champ. 

**Remarque** : Les données affichées par un champ Tableur dans un état peuvent : 

- être déterminées par programmation (par exemple, affichage direct d'un fichier xls ou xlsx). 

- correspondre à une rubrique mémo d'un fichier de données ou d'une requête, ... 

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) correspondre à un champ Tableur présent dans une fenêtre. 

	- correspondre à une variable de type [xlsDocument](../WDLang5/1000017464.md). 







<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Caractéristiques du champ Tableur dans un état
<a name="caracteristiques_champ_tableur_dans_etat_ELTTEXTE000152"></a>
Les principales caractéristiques d'un champ Tableur dans un état sont définies dans les différents onglets de la fenêtre de description du champ : 

- Onglet "Général" : L'option **Mise à l'échelle** correspond à la propriété [ModeAjustement](../Proprietes/1000021790.md). Les différentes options disponibles sont : 

	- Pas de mise à l'échelle : La feuille du tableur est imprimée à ses dimensions. L'impression peut être effectuée sur plusieurs pages en largeur et en hauteur si nécessaire. 

	- Ajuster la feuille de calcul aux dimensions du champ : La feuille du tableur sera réduite pour entrer entièrement dans la zone du champ Tableur. 

	- Ajuster toutes les colonnes à la largeur du champ : Les colonnes de la feuille du tableur seront réduites ou agrandies pour que toutes les colonnes de la feuille du tableur soient affichées dans la largeur du champ. 

	- Ajuster toutes les lignes à la hauteur du champ : Les lignes de la feuille du tableur seront réduites ou agrandies pour que toutes les lignes de la feuille du tableur soient affichées dans la hauteur du champ. 




- Onglet "Liaison" : Permet de définir la liaison du champ Tableur. Le champ peut être : 

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) lié avec un champ d'une fenêtre de l'application.

	- lié à une variable. 

	- programmé ("Aucun" est sélectionné). Pour plus de détails, consultez [Manipuler un champ Tableur par programmation (dans un état)](../WDChamp/1000033010.md). 








### Manipulation d'un champ Tableur dans un état par programmation
<a name="manipulation_champ_tableur_dans_etat_par_programmation_ELTPARAGRAPHE000077"></a>Il est possible d'associer un champ Tableur d'un état : 

- à une variable de type [xlsDocument](../WDLang5/1000017464.md). Il suffit d'utiliser la ligne de code : 
	
	```txt
	<Champ Tableur> = <Variable xlsDocument>
	```


- à un fichier au format xls/xlsx. Il suffit d'utiliser la ligne de code : 
	
	```txt
	<Champ Tableur> = <Chemin du fichier xls/xlsx>
	```





Attention : Les fonctions de gestion des champs Tableur ne peuvent pas être utilisées sur le champ Tableur d'un état.


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDEtats.gif) ***Exemples didactiques (WINDEV)*** : **WD Etats** <br>Cet exemple montre les différentes méthodes pour réaliser un état :<br> <br>- impressions basées sur différentes sources de données (requêtes, variables, ...)<br>- impressions basées sur des champs (Table, Tableur, TCD, ...)<br>- impression d'états composés<br>- impressions spécifiques (portrait / paysage, état avec filigrane, état avec code-barres, ...)


