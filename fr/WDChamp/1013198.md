


## Manipuler un champ Liste image par programmation
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000337"></a>
WINDEV permet de manipuler un champ Liste image directement par programmation. Il suffit d'utiliser directement la variable du champ Liste image dans le code. Cette variable est de type numérique.

La variable du champ Liste image :

- correspond au nom du champ Liste image.

- est initialisée avec l'indice de l'élément sélectionné dans le champ Liste image.




**Remarque** : Pour manipuler un élément d'un champ Liste image auquel aucune rubrique mémorisée n'est associée, il suffit d'utiliser la notation suivante :

```txt
<Champ Liste image> [ <Indice de l'élément>]
```


<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Initialiser un champ Liste image
<a name="initialiser_champ_liste_image_ELTTEXTE000361"></a>


### Initialiser un élément
<a name="initialiser_element_ELTPARAGRAPHE000030"></a>Pour initialiser un élément d'un champ Liste image, utilisez la fonction [ListeAjoute](../WDLang1/3049004.md).

```wl
ListeAjoute(LSI_ListeImage1, "Soleil", "C:\IMG\Soleil.JPG")
ListeAjoute(LSI_ListeImage1, Photo)
```

<a name="NOTE2_2"></a>


### Remplir un champ Liste image
<a name="remplir_champ_liste_image_ELTPARAGRAPHE000048"></a>Pour initialiser un champ Liste image, il suffit d'utiliser une boucle d'itération pour initialiser tous les éléments du champ.

```txt
Indice est un entier
POUR Indice = <Position Début> A <Position Fin>
	ListeAjoute(<Champ Liste image>, <Valeur>, <Image>)
FIN
```



```wl
i est un entier
POUR i = 1 A 52
	ListeAjoute(LSI_ListeImage1, NOM[i], Image[i])
FIN
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Sélectionner un élément dans un champ Liste image
<a name="selectionner_element_dans_champ_liste_image_ELTTEXTE000391"></a>


### Sélectionner l'élément de la ligne &lt;Indice&gt;
<a name="selectionner_element_ligne_ELTPARAGRAPHE000072"></a>Pour sélectionner l'élément de la ligne &lt;Indice&gt;, utilisez : 

- soit l'affectation directe : 
	
	```txt
	<Champ Liste image> = Indice
	```


- soit la fonction [ListeSelectPlus](../WDLang1/3049012.md) : 
	
	```txt
	ListeSelectPlus(<Champ Liste image>, <Indice>)
	```




<a name="NOTE3_2"></a>


### Se positionner sur le dernier élément du champ Liste image
<a name="positionner_sur_dernier_element_champ_liste_image_ELTPARAGRAPHE000096"></a>Pour se positionner sur le dernier élément du champ Liste image, utilisez : 

- soit la propriété [Occurrence](../WDLang1/3025009.md) : 
	
	```txt
	<Champ Liste image>.Occurrence
	```


- soit la fonction [ListeSelectPlus](../WDLang1/3049012.md) associée à la propriété [Occurrence](../WDLang1/3025009.md) : 
	
	```txt
	ListeSelectPlus(<Champ Liste image>, <Champ Liste image>.Occurrence)
	```


- soit la fonction [ListeOccurrence](../WDLang1/3049014.md) : 
	
	```txt
	ListeOccurrence(<Champ Liste image>)
	```





<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Récupérer l'élément sélectionné dans le champ Liste image
<a name="recuperer_element_selectionne_dans_champ_liste_image_ELTTEXTE000421"></a>


### Récupérer l'indice de l'élément sélectionné
<a name="recuperer_indice_element_selectionne_ELTPARAGRAPHE000139"></a>Pour récupérer l'indice de l'élément sélectionné, utilisez : 

- soit la lecture directe de l'élément :
	
	```txt
	Indice = <Champ Liste image>
	```


- soit la fonction [ListeSelect](../WDLang1/3049011.md) : 
	
	```txt
	Indice = ListeSelect(<Champ Liste image>)
	```




<a name="NOTE4_1a"></a>
**Remarque** : Pour les champs Liste image multisélection, la fonction [ListeSelect](../WDLang1/3049011.md) permet de récupérer les éléments sélectionnés.

```wl
// Récupérer les éléments d'un champ Liste image multisélection
Rang est un entier = 0  // numéro de la sélection
Indice est un entier = 0  // indice de l'élément sélectionné
BOUCLE
	Rang = Rang + 1
	Indice = ListeSelect(LSI_ListeImage1, Rang)
	SI Indice = -1 ALORS SORTIR
FIN
```

<a name="NOTE4_2"></a>


### Récupérer la valeur de l'élément sélectionné
<a name="recuperer_valeur_element_selectionne_ELTPARAGRAPHE000179"></a>Pour récupérer la valeur de l'élément sélectionné, utilisez une des syntaxes suivants : 

- Syntaxe 1 :
	
	```txt
	Indice est un entier = <Champ Liste image>
	<Variable> = <Champ Liste image>[Indice]
	```


- Syntaxe 2 :
	
	```txt
	<Variable> = <Champ Liste image>[<Champ Liste image>]
	```


- Syntaxe 3 : Propriété [ValeurAffichée](../Proprietes/2510129.md)
	
	```txt
	<Variable> = <Champ Liste image>.ValeurAffichée
	```

	**Attention** : La valeur mémorisée en programmation peut être différente de la valeur affichée. Pour connaître la valeur mémorisée correspondant à une des lignes du champ Liste image, utilisez la propriété [ValeurMémorisée](../Proprietes/2510127.md).




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Propriétés spécifiques à la gestion des champs Liste image
<a name="proprietes_specifiques_gestion_des_champs_liste_image_ELTTEXTE000457"></a>
Les propriétés suivantes sont spécifiques à la gestion des champs Liste image :


|   |   |
| --- | --- |
| **Tout type de champ Liste image** |
| [Mémoire](../Proprietes/2510076.md) | Permet de savoir si le champ spécifié est un champ Liste image par programmation ou Liste image fichier. |
| [ModeListeImage](../Proprietes/2510079.md) | Change le mode d'affichage du champ Liste image (mode liste image, mode liste classique, mode panorama). |
| [Occurrence](../WDLang1/3025009.md) | Permet de connaître le nombre de lignes présentes dans un champ Liste image. |
| [OrientationVerticale](../Proprietes/2510092.md) | Permet de connaître et de modifier l'orientation d'un champ Liste image. |
| [TypeRemplissage](../Proprietes/1000017723.md) | Permet de connaître le type de remplissage (fichier, par programmation, sur variable) d'un champ Liste image. |
| [ValeurAffichée](../Proprietes/2510129.md) | Permet de connaître la valeur de la ligne en cours ou d'une ligne spécifique du champ Liste image. |
| [Vide](../Proprietes/2510126.md) | Permet de savoir si un champ Liste image est vide. |
| **Champ Liste image par programmation uniquement** |
| [Triée](../Proprietes/2510115.md) | Permet de savoir si un champ Liste image par programmation est triée et de trier un champ Liste image par programmation (tri réalisé en fonction des libellés des éléments). |
| **Champ Liste image Fichier uniquement** |
| [FichierParcouru](../Proprietes/2510040.md) | Permet de connaître et de modifier le fichier de données ou la requête utilisé pour l'affichage des enregistrements dans les champs Liste image fichier. |
| [ParcoursAuto](../Proprietes/2510093.md) | Permet de savoir si le parcours d'un champ Liste image fichier est automatique ou programmé. |
| [RubriqueAffichée](../Proprietes/2510123.md) | Permet de connaître ou de modifier la rubrique correspondant au libellé affiché dans un champ Liste image. |
| [RubriqueAffichéeImage](../Proprietes/2510109.md) | Permet de connaître ou de modifier la rubrique correspondant à l'image affichée dans un champ Liste image. |
| [RubriqueMémorisée](../Proprietes/2510110.md) | Permet de connaître ou de modifier la rubrique mémorisée d'un champ Liste image. |
| [RubriqueParcourue](../Proprietes/2510111.md) | Permet de connaître et de modifier la rubrique utilisée pour le parcours automatique des champs Liste image. |


Pour connaître la liste complète des propriétés du WLangage pouvant être utilisées avec un champ de type Liste image, consultez [Propriétés associées au champ Liste image](../WDChamp/1013219.md). 


