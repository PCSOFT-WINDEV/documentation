


## Création d'un état
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000403"></a>
L'éditeur d'états permet de créer simplement n'importe quel type d'état grâce à un assistant.

Les états créés avec l'éditeur d'états peuvent être imprimés : 

- depuis les applications WINDEV (Windows ou Linux).

- depuis les sites WEBDEV (Windows ou Linux).

- depuis les applications iOS.

- depuis les applications en mode Universal Windows App.

- depuis les applications Android.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Créer un état (via un assistant)
<a name="creer_etat_via_assistant_ELTTEXTE000427"></a>
<a name="Creer_etat"></a>
Pour créer un état :

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif)
 parmi les boutons d'accès rapide. 

	- La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Etat" puis sur "Etat".

	- L'assistant de création d'un état se lance.




2. Spécifiez dans les différentes étapes de l'assistant :

	- le type d'état à créer (fiche, tableau, etc.). Pour plus de détails, consultez [Types d'états](../WDChamp/1011054.md).

	- la source de données de l'état (fichier de données, requête, etc.). Pour plus de détails, consultez [Source de données d'un état](../WDChamp/1011055.md).

	- les éléments de l'état : 

		- [Tri : Ordre d'impression des données](#NOTE3_3). 

		- [Ruptures](#NOTE3_3). 

		- Rubriques / champs à afficher. 

		- [Calculs à effectuer (somme, moyenne, etc)](#NOTE3_4). 

		- [Format du papier](#NOTE3_5).

		- Utilisation de l'état avec le logiciel Etats et Requêtes.

		- [Gabarit de l'état](#NOTE3_6). 

		- Nom de l'état. 




3. Validez la création de l'état. L'état est alors généré et enregistré selon les différentes options choisies.




Ces différentes étapes sont réalisées grâce à l'assistant de création d'un état. A la fin de l'assistant, l'état correspondant aux options sélectionnées est automatiquement créé. L'état créé apparaît en édition sous l'éditeur d'états. Les différents blocs et champs de votre état ont été créés. Vous pouvez les modifier à votre convenance. La majorité des options choisies lors de la création de l'état pourra être modifiée par la suite.

L'état pourra ensuite être exécuté :

- soit depuis l'éditeur d'états,

- soit depuis une application WINDEV, 

- soit depuis une application WINDEV Mobile (pour iOS ou Android),

- soit depuis un site WEBDEV. 






<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Les différentes étapes de l'assistant
<a name="les_differentes_etapes_assistant_ELTTEXTE000451"></a>


### Les différents types d'états disponibles
<a name="les_differents_types_etats_disponibles_ELTPARAGRAPHE000093"></a>L'éditeur d'états permet de créer plusieurs types d'états. Tous ces types d'états sont disponibles sous l'éditeur d'états Utilisateur et l'éditeur d'états intégré.

Les différents types d'états disponibles sont les suivants :

- Etat Vierge.

- Etat Fiche.

- Etat Tableau.

- Etat Tableau croisé.

- Etat Tableau hiérarchique.

- Etat Diagramme de Gantt (non disponible sous WINDEV Mobile).

- Etat Agenda (non disponible sous WINDEV Mobile).

- Etat Planning (non disponible sous WINDEV Mobile).

- Etat Tableur (non disponible sous WINDEV Mobile).. 

- Etat Mailing personnalisé (non disponible sous WINDEV Mobile).

- Etat Etiquette.

- Etat sur Formulaire.

- Etat multicolonne.

- Etat composite (non disponible sous Android).




Pour plus de détails, consultez [Types d'états](../WDChamp/1011054.md).
<a name="NOTE3_2"></a>


### Les sources de données disponibles
<a name="les_sources_donnees_disponibles_ELTPARAGRAPHE000134"></a>La source de l'état détermine la provenance des données imprimées dans l'état. Plusieurs sources de données sont disponibles. Ces sources de données peuvent être sélectionnées dans l'assistant de création de l'état ou directement dans la fenêtre de description de l'état. 

Les sources de données disponibles sont les suivantes :

- **Fichier de données existant** : Les données à imprimer proviennent d'un fichier de données décrit dans l'analyse du projet. Ce fichier de données peut être de n'importe quel format (HFSQL Classic, Oracle, etc.).
	|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | Les fichiers de données et les rubriques de fichiers pouvant être utilisés dans les états créés avec le logiciel Etats & Requêtes sont définis par le développeur sous l'éditeur d'analyses. Pour plus de détails sur la préparation nécessaire à l'utilisation d'une application WINDEV avec le logiciel Etats & Requêtes, consultez [Diffuser le logiciel Etats & Requêtes](../Presentation/3088002.md). |








- **Requête** : Les données à imprimer proviennent d'une requête. Cette requête correspond :

	- soit à une requête précédemment créée et enregistrée sous l'éditeur de requêtes.

	- soit à une nouvelle requête qui sera construite lors de la création de l'état.




- **Champ Table ou Table hiérarchique, Agenda ou Planning, Zone répétée** présent dans une fenêtre ou dans une page : Les données à imprimer proviennent d'un champ spécifique présent dans une des fenêtres de l'application ou dans une des pages du site. Les enregistrements sont sélectionnés par le champ, l'état ne fait que les imprimer.
	|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | Le logiciel Etats & Requêtes ne permet pas de créer des états sur un champ Table, un champ Table hiérarchique, un champ Agenda, un champ Planning ou un champ Zone répétée. Cependant, il est possible de personnaliser des états sur un champ Table, Table hiérarchique, Agenda, Planning ou Zone répétée créés sous l'éditeur d'états intégré (couleur, polices, taille, colonne reliée, etc). |








- **Variable existante** : Les données à imprimer proviennent d'une variable WLangage du projet ou de l'état. Cette variable peut être une variable de type tableau simple, un membre d'une classe, un membre d'une structure ou un membre d'une variable de type avancé. 
	|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | Le logiciel Etats & Requêtes ne permet pas de créer ou de modifier des états sur variable. |








- **Pas de source de données** : L'état ne sera lié à aucune source de données.




- **Autres sources de données disponibles**

	- **Fichier de type texte** : Les données à imprimer sont lues dans un fichier Texte.

	- **Zone mémoire remplie par programmation (non disponible en WINDEV Mobile)** : Les données à imprimer correspondent aux enregistrements stockés dans une zone mémoire.
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | Le logiciel Etats & Requêtes ne permet pas de créer des états sur une zone mémoire. Cependant, il est possible de personnaliser les états sur zone mémoire créés avec l'éditeur d'états intégré (couleur, polices, taille, etc.). |





	- **Vue HFSQL** : Les données à imprimer proviennent d'une vue HFSQL sur un fichier de données HFSQL Classic.
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | Le logiciel Etats & Requêtes ne permet pas de créer des états sur une vue HFSQL. Cependant, il est possible de personnaliser des états sur une vue HFSQL créés sous l'éditeur d'états intégré (couleur, polices, taille, etc.). |





	- **Programmation de la lecture de la source de données** : Pour programmer et sélectionner vous-même les enregistrements à afficher dans l'état, choisissez un état sur une source programmée. 
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | Le logiciel Etats & Requêtes ne permet pas de créer des états sur une source de données programmée. |











Ces différentes sources de données sont détaillées dans [Sources de données](../WDChamp/1011055.md).

**Remarque** : Si vous sélectionnez une des sources de données précédemment citées, l'éditeur d'états se charge entièrement de la programmation du parcours des enregistrements à afficher dans l'état.
Pour programmer et sélectionner vous-même les enregistrements à afficher dans l'état, choisissez un état avec programmation de la lecture de la source de données. 
<a name="NOTE3_3"></a>


### Ruptures et tris
<a name="ruptures_tris_ELTPARAGRAPHE000207"></a>Les ruptures et les tris permettent de définir l'ordre de tri des données imprimées dans l'état et les options de regroupement des données.

- Si l'état est basé sur un fichier de données, les rubriques de parcours du fichier de données sont automatiquement proposées en rubrique de tri.

- Si l'état est basé sur une requête, les tris réalisés dans la requête sont automatiquement proposés pour les ruptures.

- Si l'état est basé sur une variable, seules les ruptures peuvent être définies : les tris doivent être réalisés par programmation.




**Le tri**
Pour rendre le résultat d'une requête plus lisible, il est possible de trier les enregistrements selon une ou plusieurs rubriques. Trier les enregistrements revient à classer les enregistrements dans un ordre croissant ou décroissant.
Par exemple, il est possible de trier les clients par leur nom, de A à Z.
Si votre état est basé sur une requête, l'ordre du tri est défini lors de la création de la requête. Il est cependant possible de :

- ajouter ou supprimer une rubrique de tri dans un état existant.

- modifier l'ordre de tri effectué sur une rubrique dans un état existant.


Pour affiner le tri, il est également possible d'utiliser :

- des fonctions du WLangage (fonctions [Gauche](../WDLang1/3024001.md), [Droite](../WDLang1/3024016.md), etc.).

- une procédure du WLangage (procédure serveur en WEBDEV). Cette procédure sera automatiquement appelée pour trier des enregistrements affichés dans l'état. Cette procédure devra être soit une procédure globale du projet, soit une procédure locale à l'état. Pour plus de détails, consultez [Procédure de tri](../WDChamp/1011035.md).




**Les ruptures**
La rupture permet de grouper les enregistrements correspondant à un même argument de tri.
Par exemple : 

- pour lister le cours des actions par jour, il suffira de trier les actions par date et de faire une rupture sur la date.

- pour lister les clients et les sociétés  par ville, il suffira de trier les clients par ville puis par nom de la société et de faire une rupture sur la ville.
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=EtatRupture.gif&type=thumb)





L'ajout d'une rupture génère automatiquement les blocs Début et Fin de rupture. Ces blocs permettent par exemple de :

- afficher le contenu de la rubrique de rupture (généralement dans le bloc Début de rupture).

- réaliser des calculs sur les enregistrements de la rupture (généralement dans le bloc Fin de rupture).


L'éditeur d'états propose deux types de ruptures :

- ***rupture automatique*** (la plus courante). La rupture est réalisée sur une rubrique appartenant à la source de données de l'état.

- ***rupture programmée***. La rupture est entièrement définie par programmation dans l'événement "Valeur de rupture" du bloc Début de rupture. Pour plus de détails sur la programmation d'une rupture, consultez [Ruptures dans un état](../WDChamp/1011028.md). 


.
<a name="NOTE3_4"></a>


### Réaliser des calculs dans un état
<a name="realiser_des_calculs_dans_etat_ELTPARAGRAPHE000282"></a>Si les données affichées dans l'état sont de type numérique, il est possible de réaliser des calculs sur ces données. Vous pouvez par exemple choisir de réaliser et d'afficher la valeur moyenne des commandes du client dans un état listant les commandes par client.

**Remarque** : La sélection des différents calculs réalisés dans un état est effectuée lors de la création de l'état. Cependant, de nouveaux calculs pourront être ajoutés une fois l'état créé grâce aux champs calculés.
<a name="NOTE3_5"></a>


### Gabarit
<a name="gabarit_ELTPARAGRAPHE000291"></a>Si le projet est associé à un gabarit (ou à un modèle), il est possible de sélectionner ce même gabarit (ou modèle) pour vos états. Vos états imprimés auront le même style que votre application. Ce gabarit (ou modèle) pourra être modifié après la création de l'état.

Attention : Les durées d'impression d'états contenant des images peuvent être relativement longues selon le type d'imprimante.
<a name="NOTE3_6"></a>


### Format d'impression de l'état
<a name="format_impression_etat_ELTPARAGRAPHE000300"></a>Le format d'un état permet de paramétrer :

- l'orientation de l'état.

- le format du papier.

- les marges d'impression.

- le nombre de colonnes de l'état. Par défaut, un état possède une colonne. Si l'état possède plus d'une colonne l'état est dit "multicolonne".




Si vous créez un état "Etiquette", il est également possible de paramétrer :

- le format de la planche d'étiquettes.

- l'espace entre les étiquettes.




Ces informations pourront être modifiées après création de l'état. Pour plus de détails, consultez [Description / manipulations d'un état](../WDChamp/1011071.md). 
<a name="NOTE3_7"></a>


### Enregistrement d'un état
<a name="enregistrement_etat_ELTPARAGRAPHE000322"></a>Pour enregistrer un état (au choix) : 

- sous le volet "Accueil", dans le groupe "Général", cliquez sur "Enregistrer".

- cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_Enregistrer.gif)
 parmi les boutons d'accès rapide.


Le fichier état créé a pour extension ".WDE".

L'état est automatiquement intégré dans la liste des éléments du projet.

Si vous utilisez l'éditeur d'états intégré, les états seront par défaut intégrés dans la bibliothèque : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) lors de la création de l'exécutable.





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDEtats.gif) ***Exemples didactiques (WINDEV)*** : **WD Etats** <br>Cet exemple montre les différentes méthodes pour réaliser un état :<br> <br>- impressions basées sur différentes sources de données (requêtes, variables, ...)<br>- impressions basées sur des champs (Table, Tableur, TCD, ...)<br>- impression d'états composés<br>- impressions spécifiques (portrait / paysage, état avec filigrane, état avec code-barres, ...)
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WMCRM.gif) ***Exemples multiplateforme (WINDEV Mobile)*** : **WM CRM** <br>WM CRM est un projet multi-plateformes Android et iOS.<br>Il présente comment on peut réaliser une application de CRM destinée aux tablettes Android et iPad.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WMNotedefrais.gif) ***Exemples multiplateforme (WINDEV Mobile)*** : **WM Note de frais** <br>Cet exemple permet de gérer vos notes de frais.<br><br>Voici les principales fonctionnalités de cette application :<br>- La saisie des factures<br>- Gestion des devises étrangères<br>- Ajout de justificatif photo pour les factures<br>- Envoi par mail de la note de frais<br>- Suivi des notes de frais<br>- ...
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WMGestionContacts.gif) ***Exemples multiplateforme (WINDEV Mobile)*** : **WM Gestion Contacts** <br>Cet exemple illustre la gestion de contacts pour Android et iOS.<br>Il permet de :<br>- lister les contacts du téléphone<br>- appeler les contacts<br>- envoyer des sms aux contacts<br>- ...
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WMGestiondeCommandes.gif) ***Exemples multiplateforme (WINDEV Mobile)*** : **WM Gestion de Commandes** <br>L'exemple WM Gestion de commandes est une gestion de commandes et factures simplifiée.<br>Cet exemple permet de :<br>- créer/modifier/supprimer un produit,<br>- créer/modifier/supprimer un client,<br>- contacter un client par email,<br>- voir l'historique des actions effectuées auprès d'un client,<br>- effectuer une commande, imprimer un bon de commande,<br>- facturer une commande, imprimer une facture.


