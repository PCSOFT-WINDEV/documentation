


## Etats avec saisie
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000377"></a>
<a name="Etat_Saisie"></a>
L'éditeur d'états permet de créer des états sous forme de formulaire, incluant différents champs permettant à l'utilisateur d'effectuer une saisie : 

- Champs de saisie. 

- Champs Interrupteur modifiable.

- Champs Combo.




Il est également possible d'intégrer un champ Lien dans ces formulaires afin que l'utilisateur puisse par exemple accéder à une page d'un site rapidement. 

Ces états formulaire peuvent être générés au format PDF.

Vous pouvez ainsi diffuser des états, si nécessaire au format PDF, qui permettent la saisie directe par l'utilisateur dans les zones spécifiées : formulaire administratif (déclaration de revenus, déclarations diverses, carte grise, ...).

Les données peuvent être juste imprimées ou encore mémorisées dans une base de données (lorsque la saisie est réalisée depuis le visualisateur de rapports). L'état devient alors un formulaire de saisie.

Les champs de saisie, Interrupteur ou Combo peuvent être utilisés sur tous les types d'états. Le plus souvent, ces types de champs sont utilisés sur [les états de type Formulaire](../WDChamp/1011067.md), utilisant par exemple un PDF en fond d'état.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000401"></a>


### Créer un état en saisie
<a name="creer_etat_saisie_ELTPARAGRAPHE000040"></a>Pour créer un état en saisie :

1. Créez un état selon vos besoins (pour plus de détails, consultez [Créer un état](../WDChamp/1011068.md)).

2. Dans les zones où une saisie doit être effectuée, créez les différents champs nécessaires : 

	- Champs de saisie : sous le volet "Création", dans le groupe "Interactions", cliquez sur "Saisie". 

	- Champs Interrupteur : sous le volet "Création", dans le groupe "Interactions", cliquez sur "Interrupteur". 

	- Champs Combo : sous le volet "Création", dans le groupe "Interactions", cliquez sur "Combo". 




3. Enregistrez l'état.

4. Lors d'une impression, l'utilisateur pourra saisir et sélectionner des données directement dans les champs de saisie. La saisie dans les différents champs est disponible :

	- dans le visualisateur de rapports.

	- dans les états imprimés au format PDF.







Remarque : Les champs Lien peuvent être également intégrés dans l'état : sous le volet "Création", dans le groupe "Interactions", cliquez sur "Lien". Ces liens pourront être utilisés : 

- dans le visualisateur de rapports.

- dans les états imprimés au format PDF.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Champ de saisie dans un formulaire
<a name="champ_saisie_dans_formulaire_ELTTEXTE000425"></a>


### Caractéristiques des champs de saisie
<a name="caracteristiques_des_champs_saisie_ELTPARAGRAPHE000121"></a>Lors de la création d'un champ de saisie dans un état, il est possible de définir :

- le type du champ (texte, numérique, date, heure),

- le masque associé : les masques proposés sont les masques gérés par le format PDF. Ils sont disponibles pour les numériques, les dates et les heures.

- la taille de saisie, c'est-à-dire le nombre maximum de caractères autorisé dans le champ. Si ce paramètre correspond à 0, il n'y a aucune limite.

- le cadrage horizontal,

- la présence ou non du cadre autour de la zone de saisie. 

- la valeur initiale,

- le style du libellé et de la zone de saisie.




**Remarques** :

- Champ de saisie multiligne : si l'utilisateur saisit plus de lignes que ce qui est visible, les lignes non visibles ne seront pas imprimées. Lors de la saisie, les champs de saisie gèrent un ascenseur vertical.

- Style de la zone de saisie : Dans cette version, seule la police "Arial" est utilisable.

- Le champ de saisie n'est pas lié à une rubrique d'un fichier de données, à une rubrique d'une requête ni à une variable. Pour afficher des informations provenant d'un fichier de données, d'une requête ou d'une variable, il est nécessaire de réaliser une affectation du champ par programmation.

- Le cadre de la zone de saisie n'est pas paramétrable (épaisseur, couleur, ...). Il est uniquement possible de le rendre visible ou invisible.

- Il n'est pas possible d'utiliser un type monétaire (le symbole Euro n'est pas géré).  

- Il n'est pas possible de faire des calculs entre les différents champs de saisie.



<a name="NOTE2_3"></a>


### Evénements associés à un champ de saisie dans un état
<a name="evenements_associes_champ_saisie_dans_etat_ELTPARAGRAPHE000145"></a>Les événements associés à un champ de saisie dans un état sont les suivants :

| Evénement | Condition d'exécution |
| --- | --- |
| Initialisation | Exécuté à l'ouverture de l'état. |
| Avant impression | Exécuté avant l'impression du champ. |
| Entrée | Exécuté lors de l'entrée du curseur de saisie dans le champ. |
| Sortie | Exécuté lors du changement de champ (touche TAB, changement de champ par la souris, ...). |
| Modification | Exécuté à chaque modification du contenu du champ (saisie ou effacement d'une lettre par exemple). |



<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Champ Interrupteur modifiable dans un formulaire
<a name="champ_interrupteur_modifiable_dans_formulaire_ELTTEXTE000455"></a>


### Caractéristiques du champ Interrupteur
<a name="caracteristiques_champ_interrupteur_ELTPARAGRAPHE000179"></a>Lors de la création d'un champ Interrupteur dans un état, il est possible de définir :

- le type du champ, modifiable ou non. Si le champ est modifiable, le champ Interrupteur sera utilisable par l'utilisateur final,

- le style : couleur de fond, image de fond, couleur de l'interrupteur.




**Remarque** : Le champ Interrupteur n'est pas lié à une rubrique d'un fichier de données, à une rubrique d'une requête ni à une variable. Pour afficher des informations provenant d'un fichier de données, d'une requête ou d'une variable, il est nécessaire de réaliser une affectation du champ par programmation.
<a name="NOTE4_3"></a>


### Evénements associés à un champ Interrupteur dans un état
<a name="evenements_associes_champ_interrupteur_dans_etat_ELTPARAGRAPHE000191"></a>Les événements associés à un champ Interrupteur dans un état sont les suivants :

| Evénement | Condition d'exécution |
| --- | --- |
| Initialisation | Exécuté à l'ouverture de l'état. |
| Avant impression | Exécuté avant l'impression du champ. |
| Entrée | Exécuté lorsque le champ prend le focus. |
| Sortie | Exécuté lors du changement de champ (touche TAB, changement de champ par la souris, ...). |
| A chaque modification | Exécuté à chaque modification du contenu du champ (sélection d'une option, dé-sélection d'une option par exemple). |



<a name="NOTE4b"></a>
<a name="NOTE4b_1"></a>


## Champ Combo dans un formulaire
<a name="champ_combo_dans_formulaire_ELTTEXTE000485"></a>


### Caractéristiques des champs Combo
<a name="caracteristiques_des_champs_combo_ELTPARAGRAPHE000225"></a>Lors de la création d'un champ Combo dans un état, il est possible de définir :

- le type du champ : combo avec ou sans saisie,

- pour les champs Combo avec saisie : 

	- le type de saisie, 

	- le masque associé : les masques proposés sont les masques gérés par le format PDF. Ils sont disponibles pour les numériques, les dates et les heures.

	- la taille de saisie, c'est-à-dire le nombre maximum de caractères autorisé dans le champ. Si ce paramètre correspond à 0, il n'y a aucune limite.

	- le style de la zone de saisie (police, couleur de fond)




- le style (couleur de fond, libellé). 




**Remarques** :

- Style de la zone de saisie : Dans cette version, seule la police "Arial" est utilisable.

- Le champ Combo n'est pas lié à une rubrique d'un fichier de données, à une rubrique d'une requête ni à une variable. Pour afficher des informations provenant d'un fichier de données, d'une requête ou d'une variable, il est nécessaire de réaliser une affectation du champ par programmation.



<a name="NOTE4b_3"></a>


### Evénements associés à un champ de saisie dans un état
<a name="evenements_associes_champ_saisie_dans_etat_ELTPARAGRAPHE000246"></a>Les événements associés à un champ de saisie dans un état sont les suivants :

| Evénement | Condition d'exécution |
| --- | --- |
| Initialisation | Exécuté à l'ouverture de l'état. |
| Avant impression | Exécuté avant l'impression du champ. |
| Entrée | Exécuté lors de l'entrée du curseur de saisie dans le champ. |
| Sortie | Exécuté lors du changement de champ (touche TAB, changement de champ par la souris, ...). |
| Modification | Exécuté à chaque modification du contenu du champ (saisie ou effacement d'une lettre par exemple). |



<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Saisie dans le visualisateur de rapports
<a name="saisie_dans_visualisateur_rapports_ELTTEXTE000515"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) Lorsqu'un état est affiché dans le visualisateur de rapports, les champs de saisie, les champs Interrupteur et les champs Combo sont actifs.

Dans ce cas, l'utilisateur pourra saisir les informations voulues puis imprimer l'état dans un des formats proposés. Un message est affiché dans le visualisateur de rapports pour informer l'utilisateur de la possibilité de saisir des informations.

Par défaut, l'utilisateur peut parcourir les champs de saisie grâce à la touche TAB : il parcourt les champs de saisie disponibles de haut en bas et de gauche à droite.

**Remarques** :

- Les événements associés aux champs de saisie, champs Interrupteur et Combo sont exécutés lors de leur manipulation dans le visualisateur de rapports.

- Il est possible d'afficher par programmation des données provenant de la base de données. Il suffit de lier l'état à un fichier de données ou à une requête, puis d'affecter la rubrique voulue au champ dans l'événement "Avant impression" du champ.

- Il est possible d'enregistrer par programmation des données modifiées par l'utilisateur dans le visualisateur de rapports. Prenons un exemple simple, la modification d'un enregistrement affiché dans l'état. Dans chaque champ dont la valeur doit être modifiée, il suffit de : 

	- affecter la valeur saisie à la rubrique, 

	- modifier l'enregistrement. 


 Ces actions sont réalisées dans l'événement "Sortie de champ". 
	Par exemple pour modifier le nom du client, le code correspondant est le suivant :
	
	```wl
	Client.Nom = SAI_Nom
	HModifie(Client)
	```





<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Saisie dans un fichier PDF
<a name="saisie_dans_fichier_pdf_ELTTEXTE000539"></a>
Lorsqu'un état est imprimé dans un fichier PDF, les champs de saisie, champs Interrupteur et Combo sont actifs. Dans ce cas, l'utilisateur pourra saisir le contenu des différents champs et imprimer le fichier PDF avec les données saisies et/ou sélectionnées.

**Remarques** :

- Les champs de saisie, les champs Interrupteur et Combo permettent de saisir des informations dans le fichier PDF. Ces informations seront prises en compte lors de l'impression. Si l'utilisateur final possède Adobe Acrobat en version complète, les données saisies pourront être enregistrées au format PDF (Acrobat Reader ne permet pas d'enregistrer les fichiers PDF).

- Il est possible d'afficher par programmation des données provenant de la base de données. Il suffit de lier l'état à un fichier de données ou à une requête, puis d'affecter la rubrique voulue au champ dans l'événement "Initialisation" ou "Avant impression" du champ.




<a name="NOTE7"></a>
<a name="NOTE7_1"></a>


## Saisie dans un état basé sur un formulaire PDF
<a name="saisie_dans_etat_base_sur_formulaire_pdf_ELTTEXTE000563"></a>
Les champs de saisie et les champs Interrupteur ou Combo sont particulièrement adaptés aux états "Formulaires". Les états "formulaires" sont basés sur un fichier image ou PDF.

Dans le cas d'un formulaire au format PDF contenant plusieurs pages, il est possible de créer un état affichant les différentes pages du PDF (option "Imprimer toutes les pages du PDF" dans l'onglet "Fond" de la description de l'état).

Ces pages sont visibles et modifiables sous l'éditeur d'états : il est possible de positionner les différents champs sur n'importe quelle page de l'état.

Pour plus de détails, consultez [Etats sur formulaire](../WDChamp/1011067.md).


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDEtats.gif) ***Exemples didactiques (WINDEV)*** : **WD Etats** <br>Cet exemple montre les différentes méthodes pour réaliser un état :<br> <br>- impressions basées sur différentes sources de données (requêtes, variables, ...)<br>- impressions basées sur des champs (Table, Tableur, TCD, ...)<br>- impression d'états composés<br>- impressions spécifiques (portrait / paysage, état avec filigrane, état avec code-barres, ...)


