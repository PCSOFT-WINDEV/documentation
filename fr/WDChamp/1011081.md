


## Etat sur un champ Agenda
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000240"></a>
L'état sur un champ Agenda permet d'imprimer directement les informations affichées dans un champ Agenda présent  :

- dans une fenêtre ou une page de l'application. Cette fenêtre ou page doit être affichée lors de l'impression de l'état.

- dans une fenêtre interne ou une page interne : 

	- La fenêtre affichant la fenêtre interne doit être affichée.

	- La page affichant la page interne doit être affichée.





|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | [**Le logiciel Etats & Requêtes**](../Presentation/3088004.md) ne permet pas de créer des états sur un champ Agenda. Cependant, il est possible de personnaliser des états sur un champ Agenda créés sous l'éditeur d'états intégré (couleur, polices, taille, ...). |



**Remarque** : Seul un état de type Agenda peut être créé sur un champ Agenda. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Caractéristiques de l'état sur un champ Agenda
<a name="caracteristiques_etat_sur_champ_agenda_ELTTEXTE000282"></a>
Chaque ligne et chaque colonne du champ Agenda sont affichées dans l'état Agenda. 

Lors de la création de l'état, il est possible de sélectionner le nombre de jours à afficher ainsi que le mode d'affichage des ressources (en ligne ou en colonne). 

Il est possible de créer un état sur un champ Agenda depuis l'éditeur d'états : il suffit de sélectionner un état Agenda basé sur un champ Agenda. 

Lorsque l'état sur un champ Agenda est créé, il est possible à tout moment de : 

- modifier la source de données de l'état (onglet "Données" de la description de l'état).

- modifier les caractéristiques de l'agenda (onglet "Général" de la description de l'agenda). 




**Attention** : Il est impossible de tester un état sur un champ Agenda directement depuis l'éditeur d'états car la fenêtre ou la page contenant le champ Agenda doit être ouverte. Pour tester un état sur un champ Agenda, il est donc nécessaire de :

- créer si nécessaire un bouton dans la fenêtre ou la page du champ Agenda. Ce bouton permet de lancer l'impression de l'état sur le champ Agenda (fonction [iImprimeEtat](../WDLang5/3046032.md)). 
	Cas des fenêtres internes ou des pages internes : Si le champ Agenda est présent dans une fenêtre interne ou une page interne, il est conseillé de créer le bouton dans la fenêtre/page interne et non dans la fenêtre/page hôte.

- tester directement la fenêtre contenant le champ Agenda puis l'état (grâce au bouton).
	Cas des fenêtres internes : il est nécessaire d'effectuer le test depuis la fenêtre accueillant la fenêtre interne.

- tester directement la page contenant le champ Agenda puis l'état (grâce au bouton).
	Cas des pages internes : il est nécessaire d'effectuer le test depuis la page accueillant la page interne.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Créer un état sur un champ Agenda depuis l'éditeur d'états
<a name="creer_etat_sur_champ_agenda_depuis_editeur_etats_ELTTEXTE000306"></a>
L'éditeur d'états permet de créer un état de type Agenda basé sur un champ Agenda.

Après avoir créé l'état, l'impression de l'état nécessite une programmation en WLangage. Pour plus détails, consultez le paragraphe Imprimer un état sur un champ Agenda.
<a name="NOTE3_2"></a>


### Créer un état sur un champ Agenda depuis l'éditeur d'états
<a name="creer_etat_sur_champ_agenda_depuis_editeur_etats_ELTPARAGRAPHE000069"></a>Pour créer un état sur un champ Agenda depuis l'éditeur d'états : 

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif)
 parmi les boutons d'accès rapide. 

	- La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Etat" puis sur "Etat". 

	- L'assistant de création d'un état s'affiche.




2. Choisissez un état de type "Agenda ou Planning". 

3. Sélectionnez "Etat Agenda" et saisissez les caractéristiques de l'état : 

	- Mode d'affichage,

	- Nombre de jours à afficher, 

	- Granularité du quadrillage. 
			Pour plus de détails sur ces options, consultez [Etat agenda](../WDChamp/1011079.md). 




4. Sélectionnez la source de données de l'état (option "D'un champ agenda").

5. Sélectionnez le champ Agenda sur lequel sera basé l'état. Seuls les champs Agenda présents dans les fenêtres ou les pages du projet en cours sont proposés.
	**Remarque** : Si le champ choisi ne possède pas les mêmes caractéristiques que l'état, l'éditeur d'états propose de modifier l'affichage de l'état.

6. Spécifiez le format de la feuille sur laquelle l'état va être imprimé. Par défaut, l'état est imprimé sur une feuille au format A4.

7. Saisissez le nom et le titre de l'état (nom du fichier ".WDE" correspondant à l'état). Ce nom permettra d'identifier l'état dans vos programmes.
	![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Il est également possible d'indiquer si l'état peut être modifié par l'utilisateur final sous le logiciel "Etats & Requêtes". 

8. Validez la création de l'état. 

9. Si nécessaire, indiquez le mode de réduction de l'état : 

	- Imprimer l'état sur plusieurs pages. Dans ce cas, l'utilisateur final devra assembler les pages. Pour plus de détails, consultez [Impression multipage](../WDChamp/1011065.md). 

	- Utiliser le mode paysage. 

	- Réduire l'état par rapport à l'original. Attention : selon le pourcentage de réduction choisi, l'état imprimé pourra devenir illisible. 




10. L'état en cours de création s'affiche sous l'éditeur d'états.




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Imprimer un état sur un champ Agenda
<a name="imprimer_etat_sur_champ_agenda_ELTTEXTE000336"></a>


### Imprimer un état sur un champ Agenda
<a name="imprimer_etat_sur_champ_agenda_ELTPARAGRAPHE000118"></a>L'impression d'un état sur un champ Agenda doit être réalisée uniquement à partir de la fenêtre (ou de la page) affichant le champ Agenda à imprimer. Il suffit de :

1. Créer un bouton dans la fenêtre (ou la page) contenant le champ Agenda.

2. Paramétrer la destination de l'impression de l'état :

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) En WINDEV, grâce à la fonction [iDestination](../WDLang5/3046074.md) (visualisateur de rapports, impression dans un fichier HTML, ...).

	- 
			Pour plus de détails, consultez [Modes d'impression d'un état](../WDChamp/1011031.md).




3. Préciser le nom de l'état à imprimer grâce à la fonction [iImprimeEtat](../WDLang5/3046032.md).




**Remarques** :

- Si des paramètres supplémentaires doivent être passés à l'état, ces paramètres doivent être indiqués dans la fonction [iImprimeEtat](../WDLang5/3046032.md), après le nom de l'état à imprimer. Pour plus de détails, consultez [Etat paramétré](../WDChamp/1011008.md).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Si la fenêtre contenant l'agenda source de l'état est ouverte plusieurs fois (ouverture non modale par la fonction [OuvreFille](../WDLang1/3038021.md)), il faut passer en paramètre à l'état le nom complet de l'agenda à imprimer. Par exemple : 
	
	```wl
	// Propriété NomComplet va contenir le nom de la fenêtre
	// qui doit être ouverte avec un alias afin de distinguer chaque fenêtre
	iImprimeEtat(ETAT_Agenda_Client, AGD_Client.NomComplet)
	```

	```wl
	// Code d'ouverture de l'état
	PROCEDURE ETAT_Agenda_Client(NomAgendaSource)
	MonEtat.NomSource = NomAgendaSource
	```



|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | Sous [le logiciel Etats & Requêtes](../Presentation/3088004.md), il est possible d'imprimer un état :<br><br>- soit en lançant une impression (icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Ico_Imprimer.gif)<br>). <br><br>- soit en testant l'état (icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Ico_Go_Fenetre_WD_bl.gif)<br>). <br><br><br>Il n'est donc pas nécessaire de programmer l'impression de l'état. |




<a name="NOTE5_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Exemple WINDEV
<a name="exemple_windev_ELTPARAGRAPHE000186"></a>L'ensemble des informations à imprimer est contenu dans le champ Agenda "AGD_AgendaClient" présent dans la fenêtre "FEN_Client".

L'état à imprimer est nommé "ETAT_AgendaClient" et s'imprime lors d'un clic sur le champ Bouton "BTN_Imprimer".

Dans cet exemple, le code de clic du champ Bouton "BTN_Imprimer" est le suivant :

```wl
// Ouvrir le visualisateur de rapports
iDestination(iVisualisateur)
 
// Imprimer l'état basé sur l'agenda "AGD_AgendaClient" 
iImprimeEtat(ETAT_AgendaClient)
```



