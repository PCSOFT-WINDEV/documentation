
## Evénements optionnels : Informations récupérées
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000448"></a>
WINDEV et WINDEV Mobile permettent d'ajouter simplement des événements optionnels aux événements proposés par défaut pour les différents éléments d'une application. Pour plus de détails, consultez [Evénements optionnels](../WDChamp/1014004.md). 

Selon l'événement optionnel utilisé, il est possible de récupérer des informations spécifiques grâce aux variables _EVE.LPARAM et _EVE.WPARAM. 







<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Actions réalisées par l'utilisateur
<a name="actions_realisees_par_utilisateur_ELTTEXTE000472"></a>
Le tableau suivant liste les différentes informations renvoyées dans les différents événements optionnels :


| Evénement optionnel | Information retournée dans la variable _EVE.LPARAM | Information retournée dans la variable _EVE.WPARAM |
| --- | --- | --- |
| Survol de la souris (WM_MOUSEMOVE)<br><br>Bouton gauche de la souris enfoncé (WM_LBUTTONDOWN)<br><br>Bouton gauche de la souris relâché (WM_LBUTTONUP)<br><br>Double-clic avec le bouton gauche de la souris (WM_LBUTTONDBLCLK)<br><br>Bouton droit de la souris enfoncé (WM_RBUTTONDOWN)<br><br>Bouton droit de la souris relâché (WM_RBUTTONUP)<br><br>Double-clic avec le bouton droit de la souris (WM_RBUTTONDBLCLK) | <br><br>- ***Poids fort*** (connu par la fonction [PoidsFort](../WDLang1/3014017.md)) : Position verticale (Y) du curseur de souris par rapport au champ ou à la fenêtre considérée (équivalent à la fonction [SourisPosY](../WDLang1/3071008.md)).<br><br>- ***Poids faible*** (connu par la fonction [PoidsFaible](../WDLang1/3014018.md)) : Position horizontale (X) du curseur de souris par rapport au champ ou à la fenêtre considérée (équivalent à la fonction [SourisPosX](../WDLang1/3071007.md)).<br><br><br> | Touche enfoncée sous forme d'une ***constante MK_XXX*** |
| Roulette de la souris (WM_MOUSEWHEEL) | <br><br>- ***Poids fort*** (connu par la fonction [PoidsFort](../WDLang1/3014017.md)) : Position verticale (Y) du curseur de souris par rapport au champ ou à la fenêtre considérée (équivalent à la fonction [SourisPosY](../WDLang1/3071008.md)).<br><br>- ***Poids faible*** (connu par la fonction [PoidsFaible](../WDLang1/3014018.md)) : Position horizontale (X) du curseur de souris par rapport au champ ou à la fenêtre considérée (équivalent à la fonction [SourisPosX](../WDLang1/3071007.md)).<br><br><br> | <br><br>- ***Poids fort*** (connu par la fonction [PoidsFort](../WDLang1/3014017.md)) : Sens de rotation de la roulette (nombre positif : déplacement vers le haut; nombre négatif : déplacement vers le bas)<br><br>- ***Poids faible*** (connu par la fonction [PoidsFaible](../WDLang1/3014018.md)) : Touche enfoncée sous forme d'une ***constante MK_XXX***<br><br><br> |
| Touche enfoncée (WM_KEYDOWN)<br>Touche relâchée (WM_KEYUP) |   | Touche enfoncée sous forme d'une ***constante VK_XXX*** |
| Touche appuyée (WM_CHAR) |   | Code ASCII de la touche appuyée (manipulable avec la fonction [Caract](../WDLang1/3024003.md)) |
| Touche système enfoncée (WM_SYSKEYDOWN)<br>Touche système relâchée (WM_SYSKEYUP) |   | Touche enfoncée sous forme d'une ***constante VK_XXX*** |
| Touche système appuyée (WM_SYSCHAR) |   | Code ASCII de la touche système appuyée |
| Ascenseur horizontal (WM_HSCROLL)<br>Ascenseur vertical (WM_VSCROLL) | Handle de l'ascenseur | <br><br>- ***Poids fort*** (connu par la fonction [PoidsFort](../WDLang1/3014017.md)) : Position de la cage de l'ascenseur<br><br>- ***Poids faible*** (connu par la fonction [PoidsFaible](../WDLang1/3014018.md)) : Méthode utilisée pour déplacer la cage de l'ascenseur, sous forme d'une ***constante SB_XXX***<br><br><br> |
| Affichage du menu contextuel (WM_CONTEXTMENU) | <br><br>- ***Poids fort*** (connu par la fonction [PoidsFort](../WDLang1/3014017.md)) : Position verticale (Y) du curseur de souris par rapport au champ ou à la fenêtre considérée (équivalent à la fonction [SourisPosY](../WDLang1/3071008.md)).<br><br>- ***Poids faible*** (connu par la fonction [PoidsFaible](../WDLang1/3014018.md)) : Position horizontale (X) du curseur de souris par rapport au champ ou à la fenêtre considérée (équivalent à la fonction [SourisPosX](../WDLang1/3071007.md)).<br><br><br>Remarque : Si ces valeurs sont égales à -1, le menu contextuel a été ouvert à l'aide de la touche Windows d'ouverture de menu contextuel | Handle de la fenêtre ou du champ depuis lequel le menu contextuel est appelé |
| Déplacement (WM_MOVE) | <br><br>- ***Poids fort*** (connu par la fonction [PoidsFort](../WDLang1/3014017.md)) :  <br><br>	- soit la position verticale du coin haut gauche de la fenêtre par rapport au coin haut gauche de l'écran (équivalent à la propriété [Y](../Proprietes/2510137.md)) <br><br>	- soit la position verticale du coin haut gauche du champ par rapport au coin haut gauche de la zone client de la fenêtre (équivalent à la propriété [Y](../Proprietes/2510137.md)).<br><br><br><br><br>- ***Poids faible*** (connu par la fonction [PoidsFaible](../WDLang1/3014018.md)) : <br><br>	- soit la position horizontale du coin haut gauche de la fenêtre par rapport au coin haut gauche de l'écran (équivalent à la propriété [X](../Proprietes/2510135.md))  <br><br>	- soit la position horizontale du coin haut gauche du champ par rapport au coin haut gauche de la zone client de la fenêtre (équivalent à la propriété [X](../Proprietes/2510135.md)).<br><br><br><br><br><br> |   |
| Changement de taille (WM_SIZE) | <br><br>- ***Poids fort*** (connu par la fonction [PoidsFort](../WDLang1/3014017.md)) : Hauteur du champ ou de la fenêtre (équivalent à la propriété [Hauteur](../Proprietes/2510050.md)).<br><br>- ***Poids faible*** (connu par la fonction [PoidsFaible](../WDLang1/3014018.md)) : Largeur du champ ou de la fenêtre (équivalent à la propriété [Largeur](../Proprietes/2510059.md)).<br><br><br> | Mode d'affichage d'une fenêtre (icônisée, maximisée, ...) sous forme d'une ***constante SIZE_XXX*** (équivalent à la fonction [FenTaille](../WDLang1/3038020.md)). |
| Prise de focus (WM_SETFOCUS) |   | Handle de la fenêtre ou du champ qui a pris le focus. |
| Perte de focus (WM_KILLFOCUS) |   | Handle de la fenêtre ou du champ qui a pris le focus. |




<a name="NOTE3_2"></a>


### Constantes MK_XXX
<a name="constantes_mkxxx_ELTPARAGRAPHE000219"></a>Les constantes MK_XXX sont les suivantes : 



|   |   |   |
| --- | --- | --- |
| MK_CONTROL | 8 | Touche Ctrl enfoncée. |
| MK_LBUTTON | 1 | Bouton gauche de la souris enfoncée. |
| MK_MBUTTON | 16 | Bouton du milieu de la souris enfoncée. |
| MK_RBUTTON | 2 | Bouton droit de la souris enfoncée. |
| MK_SHIFT | 4 | Touche Maj enfoncée |


Avant d'utiliser ces constantes, il est nécessaire de saisir les lignes de code suivantes : 

```wl
CONSTANTE
	MK_CONTROL=8
	MK_LBUTTON=1
	MK_MBUTTON=16
	MK_RBUTTON=2
	MK_SHIFT=4
FIN
```

<a name="NOTE3_3"></a>


### Constantes VK_XXX
<a name="constantes_vkxxx_ELTPARAGRAPHE000263"></a>Les constantes VK_XXX sont détaillées dans le fichier "KeyConst.WL" présent dans le sous-répertoire "Personnel\\Externe" du répertoire d'installation de WINDEV.

Avant d'utiliser ces constantes, il est nécessaire de saisir la ligne de code suivante : 

```wl
EXTERNE "KeyConst.WL"
```

<a name="NOTE3_4"></a>


### Constantes SB_XXX
<a name="constantes_sbxxx_ELTPARAGRAPHE000274"></a>Les constantes SB_XXX sont les suivantes :


|   |   | La cage de l'ascenseur a été déplacée grâce : |
| --- | --- | --- |
| SB_LINEDOWN | 1 | au bouton spin d'en bas |
| SB_LINEUP | 0 | au bouton spin d'en haut |
| SB_LINELEFT | 0 | au bouton spin à gauche |
| SB_LINERIGHT | 1 | au bouton spin à droite |
| SB_PAGEDOWN | 3 | à la barre de défilement en dessous de la cage de l'ascenseur |
| SB_PAGEUP | 2 | à la barre de défilement en dessus de la cage de l'ascenseur |
| SB_PAGELEFT | 2 | à la barre de défilement à gauche de la cage de l'ascenseur |
| SB_PAGERIGHT | 3 | à la barre de défilement à droite de la cage de l'ascenseur |
| SB_THUMBPOSITION | 4 | à la cage de l'ascenseur |
| SB_THUMBTRACK | 5 | à la cage de l'ascenseur |


Avant d'utiliser ces constantes, il est nécessaire de saisir les lignes de code suivantes :

```wl
CONSTANTE
	SB_LINEDOWN=1
	SB_LINEUP=0
	SB_LINELEFT=0
	SB_LINERIGHT=1
	SB_PAGEDOWN=3
	SB_PAGEUP=2
	SB_PAGELEFT=2
	SB_PAGERIGHT=3
	SB_THUMBPOSITION=4
	SB_THUMBTRACK=5
FIN
```

<a name="NOTE3_5"></a>


### Constantes SIZE_XXX
<a name="constantes_sizexxx_ELTPARAGRAPHE000349"></a>Les constantes SIZE_XXX sont les suivantes :


|   |   |   |
| --- | --- | --- |
| SIZE_MAXIMISED | 2 | La fenêtre est maximisée |
| SIZE_MINIMIZED | 1 | La fenêtre est iconisée |
| SIZE_RESTORED | 0 | La fenêtre est restaurée |


Avant d'utiliser ces constantes, il est nécessaire de saisir la ligne de code suivante :

```wl
CONSTANTE
	SIZE_RESTORED=0
	SIZE_MINIMIZED=1
	SIZE_MAXIMISED=2
FIN
```


<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Exemples
<a name="exemples_ELTTEXTE000520"></a>
L'exemple suivant permet de connaître le sens de rotation de la roulette de la souris : 

```wl
// -- Evénement optionnel : Roulette de la souris 
Sens est un entier 
Sens = PoidsFort(_EVE.wParam) 
SI Sens < 0 ALORS 
	Trace("La roulette de la souris va vers le bas") 
SINON 
	Trace("La roulette de la souris va vers le haut") 
FIN
```



<a name="NOTE4_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) L'exemple suivant permet d'ajouter l'icône de la fenêtre dans la barre des tâches lors de sa minimisation, et de l'enlever lors de sa maximisation.


```wl
// -- Evénement optionnel : Changement de taille 
// Déclaration des constantes 
CONSTANTE 
	SIZE_RESTORED=0 
	SIZE_MINIMIZED=1 
	SIZE_MAXIMISED=2
FIN 

// Ajout de l'icône "C:\Icones\Icone.ICO" dans la barre des tâches 
// lors de l'icônisation de la fenêtre 
SI _EVE.wParam = SIZE_MINIMIZED ALORS 
	SysIconeAjoute("C:\Icones\Icone.ICO") 
FIN 

// Suppression de l'icône "C:\Icones\Icone.ICO" 
// lors de la restauration de la fenêtre 

SI _EVE.wParam = SIZE_RESTORED ALORS SysIconeSupprime()
```

<a name="NOTE4_3"></a>
L'exemple suivant permet de supprimer la ligne en cours dans une table lors de l'appui sur la touche Suppr :

```wl
// -- Evénement optionnel : Touche relâchée 
// Intégration du fichier "KeyConst.wl" qui contient 
// les constantes standard de Windows 
EXTERNE "KeyConst.WL" 

// Touche [Suppr] relâchée ? 
SI _EVE.wParam = VK_DELETE ALORS 
	// Suppression de la ligne en cours ? 
		SI OuiNon("Supprimer la ligne en cours ?") = Oui ALORS 
			TableSupprime(MoiMême) 
		FIN 
FIN
```



