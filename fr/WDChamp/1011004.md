


## Enchaînement des événements associés aux états
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Enchaînement des événements
<a name="enchainement_des_evenements_ELTTEXTE000240"></a>
<a name="Enchainement_Traitement"></a>
Lors de l'impression d'un état, différentes opérations sont réalisées. L'ordre de réalisation de ces opérations est le suivant :


|   |   |
| --- | --- |
| **1.** | Exécution de l'événement "[Ouverture](../WDChamp/1011037.md)" de l'état. |
| **2.** | ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Exécution de l'événement "[Avant réimpression](../WDChamp/1011037.md)" de l'état (cas d'une impression directe ou d'un export depuis le visualisateur de rapports). |
| **3.** | Exécution des événements "[Initialisation](../WDChamp/1011042.md)" des blocs et "[Initialisation](../WDChamp/1013047.md)" des champs. |
| **4.** | Initialisation de la source de données. |
| **5.** | Pour les états basés sur un fichier de données, une vue HFSQL ou une zone mémoire :<br><br>- Exécution de l'événement "[Filtre](../WDChamp/1011037.md)" de l'état.<br><br>- Exécution des [procédures de tri](../WDChamp/1011035.md) de l'état.<br><br><br> |
| **6.** | Initialisation des marges et positionnement du mode Portrait/Paysage. |
| **7.** | Redimensionnement si nécessaire de l'état selon le format spécifié. |
| **8.** | Impression du bloc [Début de document](../WDChamp/1011053.md) et exécution de ses événements associés (\*). |
| **9.** | Impression du bloc [Entête de page](../WDChamp/1011045.md) et exécution de ses événements pour chaque page de l'état (\*). |
| **10.** | Boucle d'impression :<br><br>- Lecture de l'enregistrement<br><br>- Exécution de l'événement "[Filtre](../WDChamp/1011037.md)" de l'état (pour les états basés sur une requête ou sur une table). Si l'enregistrement ne correspond pas au filtre, passe à l'enregistrement suivant.<br><br>- Réalisation des calculs sur les valeurs des rubriques.<br><br>- Exécution de l'événement "[Lecture](../WDChamp/1011037.md)" de l'état.<br><br>- Test de la rupture :<br><br>	- soit sur la rubrique de rupture pour les ruptures automatiques. <br><br>	- soit sur la valeur retournée par l'événement "[Rupture](../WDChamp/1011028.md)" pour les ruptures programmées. <br><br><br> Si la valeur de rupture est modifiée, changement de rupture et impression d'un ou de plusieurs blocs [Haut de rupture](../WDChamp/1011038.md) et [Bas de rupture](../WDChamp/1011048.md).<br><br>- Impression du bloc [Corps](../WDChamp/1011020.md).<br><br><br>**Remarque** : Lors de l'impression d'un bloc [Haut de rupture](../WDChamp/1011038.md), [Bas de rupture](../WDChamp/1011048.md) ou [Corps](../WDChamp/1011020.md), les opérations suivantes sont réalisées :<br><br>- Exécution des événements "[Avant impression](../WDChamp/1011042.md)" du bloc et "[Avant impression](../WDChamp/1011042.md)" des champs du bloc.<br><br>- Réalisation des calculs sur les champs du bloc.<br><br>- Agrandissement des champs et des blocs auto-extensibles.<br><br>- Impression et exécution de l'événement "[Après impression](../WDChamp/1011042.md)" du bloc.<br><br><br> |
| **11.** | Impression du bloc [Fin de document](../WDChamp/1011044.md) et exécution de ses événements associés (\*). |
| **12.** | Impression du bloc [Pied de page](../WDChamp/1011046.md) et exécution de ses événements pour chaque page de l'état (\*). |
| **13.** | Exécution de l'événement "[Fermeture](../WDChamp/1011037.md)" de l'état. |


(\*) L'ordre d'impression des blocs [Début de document](../WDChamp/1011053.md), [Entête de page](../WDChamp/1011045.md), [Pied de page](../WDChamp/1011046.md) et [Fin de document](../WDChamp/1011044.md) peut être modifié dans l'onglet "Options" de la description de l'état (option "Description de l'état" du menu contextuel de l'état).

**Rappel** : Si la destination de l'impression est un fichier HTML ou XML, les blocs Haut de page et Bas de page ne sont générés qu'une seule fois.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Cas particuliers
<a name="cas_particuliers_ELTTEXTE000264"></a>


### Option "Saut de page après bloc"
<a name="option_saut_page_apres_bloc_ELTPARAGRAPHE000183"></a>Si l'option "Saut de page après le bloc" est cochée dans la description du bloc, l'enchaînement des événements est le suivant :

- Exécution de l'événement "Avant impression" du bloc.

- Exécution des événements du bloc "Entête de page" de la page suivante.

- Exécution de l'événement "Après impression" du bloc.





