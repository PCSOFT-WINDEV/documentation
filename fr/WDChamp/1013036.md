


## Enrouler/Dérouler un champ Arbre par programmation
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Enrouler/Dérouler un arbre par programmation
<a name="enroulerderouler_arbre_par_programmation_ELTTEXTE000116"></a>


- Pour enrouler un arbre par programmation, il suffit d'utiliser la fonction [ArbreEnroule](../WDLang1/3018008.md).

- Pour dérouler un arbre par programmation, il suffit d'utiliser la fonction [ArbreListeFils](../WDLang1/3018016.md) combinée avec une procédure locale spécifique.


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Remarque : Pour optimiser le remplissage d'un champ Arbre, il est possible d'utiliser la propriété [AjouteFilsDifféré](../Proprietes/1000020927.md) sur les lignes du champ Arbre. Cette propriété permet de définir la procédure à exécuter pour le remplissage du niveau à dérouler. La recherche et le remplissage des fils ne sont effectués que lorsque l'utilisateur demande à les voir.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Exemple
<a name="exemple_ELTTEXTE000140"></a>
Les différents codes suivants permettent :

- d'initialiser un champ Arbre. 

- de dérouler une partie du champ Arbre.

- d'enrouler le champ Arbre.




1. Initialiser le champ Arbre par programmation :
	
	```wl
	ArbreAjoute(ARBRE_RecetteTV, "Recette" + TAB + "Dessert", "GATEAU-.BMP", "GATEAU-.BMP")
	ArbreAjoute(ARBRE_RecetteTV, "Recette" + TAB + "Dessert" + TAB + "Glace")
	ArbreAjoute(ARBRE_RecetteTV, "Recette" + TAB + "Dessert" + TAB + "Glace" + ...
			TAB + "Vanille", "SUIVAN5-.BMP")
	ArbreAjoute(ARBRE_RecetteTV, "Recette" + TAB + "Dessert" + TAB + "Glace" + ...
			TAB + "Fraise", "SUIVAN5-.BMP")
	ArbreAjoute(ARBRE_RecetteTV, "Recette" + TAB + "Dessert" + TAB + "Glace" + ...
			TAB + "Chocolat", "SUIVAN5-.BMP")
	ArbreAjoute(ARBRE_RecetteTV, "Recette" + TAB + "Dessert" + TAB + "Coupe")
	ArbreAjoute(ARBRE_RecetteTV, "Recette" + TAB + "Dessert" + TAB + "Coupe" + ...
			TAB + "Pêche Melba", "SUIVAN5-.BMP")
	ArbreAjoute(ARBRE_RecetteTV, "Recette" + TAB + "Dessert" + TAB + "Coupe" + ...
			TAB + "Poire belle hélène", "SUIVAN5-.BMP")
	ArbreAjoute(ARBRE_RecetteTV, "Recette" + TAB + "Dessert" + TAB + "Coupe" + ...
			TAB + "Colonel", "SUIVAN5-.BMP")
	ArbreAjoute(ARBRE_RecetteTV, "Recette" + TAB + "Dessert" + TAB + "Tarte aux pommes")
	ArbreAjoute(ARBRE_RecetteTV, "Recette" + TAB + "Dessert" + TAB + "Tarte aux pommes" + ...
			TAB + "à la crème fraîche", "SUIVAN5-.BMP")
	ArbreAjoute(ARBRE_RecetteTV, "Recette" + TAB + "Dessert" + TAB + "Tarte aux pommes" + ...
			TAB + "au calvados", "SUIVAN5-.BMP")
	ArbreAjoute(ARBRE_RecetteTV, "Recette" + TAB + "Dessert" + TAB + "Crème brûlée", "SUIVAN5-.BMP")
	ArbreAjoute(ARBRE_RecetteTV, "Recette" + TAB + "Dessert" + TAB + "Vacherin", "SUIVAN5-.BMP")
	```


2. Dérouler tous les éléments : La procédure "DérouleTout" est appelée pour chaque "fils" trouvé. Cette procédure déroule tous les noeuds "fils" enroulés du noeud "Dessert".
	
	```wl
	// Liste les "fils" du noeud "Desserts" dans l'arbre "ARBRE_RecetteTV"
	// La procédure "DérouleTout" est appelée
	// pour chaque "fils" trouvé du noeud "Dessert"
	Res = ArbreListeFils(ARBRE_RecetteTV, "Recette" + TAB + "Dessert", "DérouleTout")
	```

	```wl
	// Procédure locale "DérouleTout"
	// Cette procédure déroule tous les noeuds "fils" enroulés du noeud "Desserts"
	PROCEDURE DérouleTout(ARBRE_RecetteTV, CheminFils, FilsTrouvé, Niveau, Pointeur)
	// L'élément trouvé est-il une feuille ?
	SI ArbreTypeElement(ARBRE_RecetteTV, CheminFils + FilsTrouvé) = aFeuille ALORS
		RETOUR  // Retour à la fonction ArbreListeFils
	SINON
		// L'élément trouvé est-il enroulé ?
		SI ArbreEtat(ARBRE_RecetteTV, CheminFils + FilsTrouvé) = aEnroule ALORS
			ArbreDéroule(ARBRE_RecetteTV, CheminFils + FilsTrouvé)
		FIN
	FIN
	```


3. Enrouler le noeud "Dessert".
	
	```wl
	// Enroule le noeud "Dessert" dans l'arbre "ARBRE_RecetteTV"
	Res = ArbreEnroule(ARBRE_RecetteTV, "Recette" + TAB + "Dessert")
	```






