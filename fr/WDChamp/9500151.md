


## Image avec défilement automatique (WEBDEV) (syntaxe préfixée)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000085"></a>


### Champ d'une page
<a name="champ_une_page_ELTPARAGRAPHE000108"></a>Le champ Image à défilement automatique permet de visualiser un ensemble d'images présent dans un ou plusieurs répertoires du site. Le parcours des images est effectué automatiquement. 

Le changement d'images peut être automatique ou manuel (grâce aux fonctions WLangage). 

Des effets de transition peuvent être appliqués. 

Il est ainsi possible de créer simplement des bannières publicitaires ou des diaporama. 

Le défilement automatique est proposé sur les champs suivants : 

- Champ Image.

- Champ Image cliquable.

- Champ Vignette.


Remarque : Si les différentes images utilisées par le défilement automatique ont des tailles différentes, le mode d'affichage précisé dans l'onglet "Général" du champ est automatiquement appliqué.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Utiliser une image à défilement automatique dans un site WEBDEV
<a name="utiliser_une_image_defilement_automatique_dans_site_webdev_ELTTEXTE000127"></a>
Pour utiliser une image à défilement automatique dans un site WEBDEV : 

1. Créez un champ Image.

2. Affichez la fenêtre de description du champ (option "Description" du menu contextuel du champ Image).

3. Dans l'onglet "UI", dans la zone "Défilement automatique", cochez l'option "Faire défiler les images d'un répertoire ou d'une liste programmée" puis indiquez les différentes options concernant le défilement : 

	- **Durée entre chaque image** : indique le délais d'affichage de l'image.  

	- **Démarrer automatiquement**. Si cette option n'est pas sélectionnée, il est possible de démarrer le défilement grâce à la fonction [&lt;Image&gt;.LanceDéfilement](../WDLang2/1000023749.md). 

	- **Parcourir le répertoire de l'image (Onglet Général)** : Cette option permet de parcourir toutes les images présentes dans le répertoire actuellement sélectionné pour le champ Image (ou le répertoire de l'image actuellement associée au champ Image). Dans ce cas, le parcours n'est pas récursif : les images des sous-répertoires ne sont pas parcourues.  

	- **Trier le contenu du défilement** : Cette option permet d'afficher les images parcourues selon leur nom. Sélectionnez si nécessaire le répertoire de parcours des images (champ "Image").




4. Validez la fenêtre de description du champ. 




Si vous avez choisi un démarrage automatique du défilement et un répertoire des images, le défilement est automatiquement réalisé lors du test de la page. 

**Remarque** : **Il est possible de combiner les effets de transition avec le défilement**.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Programmation d'une image à défilement automatique
<a name="programmation_une_image_defilement_automatique_ELTTEXTE000192"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000215"></a>Les champs proposant un défilement automatique peuvent être manipulés par programmation grâce à différentes fonctions et propriétés WLangage. Ces fonctions et propriétés sont disponibles également en code navigateur et en PHP.


### Définition des images à afficher lors du défilement
<a name="definition_des_images_afficher_lors_defilement_ELTPARAGRAPHE000225"></a>Les images affichées dans le champ lors du défilement peuvent être : 

- présentes dans le répertoire sélectionné dans la fenêtre de description du champ. 

- associées au champ par programmation. Exemples : 

	- Une liste d'images est associée au champ : 
			
		```wl
		// Affectation en code serveur
		IMG_Image = "chiffres_0.png" + RC + "chiffres_1.png" + RC + ...
				"chiffres_2.png" + RC + "chiffres_3.png"
		```


	- Un répertoire contenant des images est associé au champ : 
			
		```wl
		IMG_Image = "images"
		```
Ce code permet d'associer un ensemble d'images ou un répertoire au champ. Le chemin est relatif au répertoire des images du site (répertoire _WEB).








### Fonctions WLangage
<a name="fonctions_wlangage_ELTPARAGRAPHE000246"></a>Différentes fonctions du WLangage permettent de gérer les images à défilement automatique. Ces fonctions sont les suivantes :



|   |   |
| --- | --- |
| [&lt;Image&gt;.ArrêteDéfilement](../WDLang2/1000023746.md) | Arrête le défilement automatique des images. |
| [&lt;Image&gt;.Dernier](../WDLang2/1000023748.md) | Affiche la dernière image du défilement. |
| [&lt;Image&gt;.LanceDéfilement](../WDLang2/1000023749.md) | Lance le défilement automatique des images. |
| [&lt;Image&gt;.Occurrence](../WDLang2/1000023750.md) | Renvoie le nombre total d'images prises en compte par le défilement. |
| [&lt;Image&gt;.PositionDéfilement](../WDLang2/1000023751.md) | Retourne l'image affichée. |
| [&lt;Image&gt;.Précédent](../WDLang2/1000023752.md) | Affiche l'image précédente du défilement. |
| [&lt;Image&gt;.Premier](../WDLang2/1000023753.md) | Affiche la première image du défilement. |
| [&lt;Image&gt;.Suivant](../WDLang2/1000023754.md) | Affiche l'image suivante du défilement. |





Exemple de programmation du défilement : 

```wl
// Programmation des images du bandeau défilant.
// Possibilité de donner le répertoire des images de son choix
// Au premier affichage, choix aléatoire de la 1er photo.
// =================
// Déclaration de globales
gnNombreImagesDefilement est un entier
gnImageDemarrage est un entier
gsNomImageDefilement	est une chaîne

// Initialisation de la page
<BLOC Gestion du Bandeau défilant>
	gsNomImageDefilement = fListeFichier(fRepWeb() + fSep + "BandeauxAccueil" + 
			fSep + "*.jpg", frNonRécursif)
	POUR TOUTE CHAÎNE sUnFichier DE gsNomImageDefilement SEPAREE PAR RC	
		gnNombreImagesDefilement++
	FIN
	InitHasard()
	gnImageDemarrage = Hasard(1, gnNombreImagesDefilement)
	
	NumImageDepartDefilement est un entier = gnImageDemarrage
	
	POUR I = 1 À NumImageDepartDefilement
		IMG_Presentation.Suivant()
	FIN
	IMG_Presentation.LanceDéfilement()
<FIN>
```

<a name="NOTE4_2"></a>


### Propriétés WLangage
<a name="proprietes_wlangage_ELTPARAGRAPHE000343"></a>Différentes propriétés du WLangage permettent de gérer les images à défilement automatique. Ces propriétés sont les suivantes :


|   |   |
| --- | --- |
| [OptionTri](../Proprietes/1000017044.md) | Permet de définir le mode de tri des images lors du défilement. |
| [Triée](../Proprietes/2510115.md) | Permet de savoir si le champ trie les images lors du défilement et permet de trier les images lors du défilement. |
| [Valeur](../Proprietes/2510130.md) | Renvoie le chemin du répertoire des images. |
| [ValeurAffichée](../Proprietes/2510129.md) | Renvoie le chemin de l'image actuellement affichée. |



- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampImage_animationsettransitions_.gif) ***Exemples unitaires (WEBDEV)*** : **Le champ Image (animations et transitions)** <br>Présentation de fonctionnalités d'animations et d'effets proposés en standard dans WEBDEV et le WLangage sur le champ Image.



