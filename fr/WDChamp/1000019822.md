


## Personnaliser l'affichage d'un champ Organigramme
			





## Présentation
<a name="presentation_ELTTEXTE000167"></a>
Pour personnaliser l'interface d'un champ Organigramme, il suffit d'utiliser des fenêtres internes spécifiques. 

Il est ainsi possible d'utiliser pour chaque champ Organigramme d'une même application des fenêtres internes différentes selon les informations affichées dans l'organigramme. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Importer la fenêtre interne de description de l'élément
<a name="importer_fenetre_interne_description_element_ELTTEXTE000191"></a>


### Importer la fenêtre interne représentant un élément
<a name="importer_fenetre_interne_representant_element_ELTPARAGRAPHE000017"></a>L'affichage de chaque élément d'un champ Organigramme repose sur une fenêtre interne spécifique. Cette fenêtre interne est livrée avec WINDEV et peut être importée dans un projet. 

Pour importer cette fenêtre interne : 

1. Affichez la fenêtre de description du champ Organigramme. 

2. Dans l'onglet "Général", dans l'option "Fenêtre interne pour les éléments", sélectionnez "Fenêtre prédéfinie".

3. Le composant interne WDFAA est automatiquement ajouté dans le projet en cours. La fenêtre interne "FI_WinDevVueOrgaElement" est automatiquement associée à l'option "Fenêtre interne pour les éléments". 
	Remarque : Si le composant WDFAA existe déjà, seule la fenêtre est ajoutée au composant. 

4. Validez la fenêtre de description du champ. 




Remarque : Il est également possible d'importer directement la fenêtre prédéfinie : sous le volet "Projet", dans le groupe "Projet", déroulez "Importer" et sélectionnez "Des éléments WinDev et leurs dépendances". La fenêtre interne "FI_WinDevVueOrgaElement" est présente dans le répertoire "Programmes\\Données\\Fenêtres prédéfinies\\FAA".

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Personnaliser la fenêtre interne
<a name="personnaliser_fenetre_interne_ELTTEXTE000215"></a>
La fenêtre interne correspondant à un élément du champ Organigramme peut être entièrement personnalisée. Il est par exemple possible d'ajouter de nouveaux champs pour afficher davantage d'informations. 

Il peut être également possible de modifier le code de la fenêtre interne.


### Afficher des informations supplémentaires
<a name="afficher_des_informations_supplementaires_ELTPARAGRAPHE000062"></a>Dans la fenêtre interne, les informations affichées correspondent par défaut à les éléments de la variable [OrgaElément](../WDLang1/1000019713.md). Il peut être nécessaire d'afficher des données spécifiques à l'application. 

Pour effectuer simplement le lien entre un élément de l'organigramme et une entité de l'application (un collaborateur, une filiale, ...), il suffit d'utiliser la propriété ID de la variable [OrgaElément](../WDLang1/1000019713.md) : 

- Pour un organigramme rempli par programmation, il suffit lors de l'ajout d'un élément de type [OrgaElément](../WDLang1/1000019713.md), de renseigner la propriété **ID** avec l'identifiant de l'entité (par exemple, un identifiant automatique de fichier). 

- Pour un organigramme basé sur un fichier de données, la propriété **ID** est automatiquement renseignée à partir des clés de la liaison récursive définie. 




Dans le code de la fenêtre interne, l'élément à afficher est passé en paramètre via une variable de type [OrgaElément](../WDLang1/1000019713.md). 

```wl
PROCEDURE FI_WinDevVueOrgaElement(gOrgaElement est un OrgaElément)
```
Il suffit alors d'utiliser la propriété **ID** pour rechercher toutes les informations annexes à afficher via cet identifiant. 

Dans l'exemple suivant, la variable de type [OrgaElément](../WDLang1/1000019713.md) contient les informations sur un membre du personnel. La propriété **ID** contient l'identifiant du fichier "Personnel". 

Il suffit alors de rechercher les informations souhaitées dans les autres fichiers de la base via cet identifiant. 

```wl
// Recherche le collaborateur à partir de son ID 
HLitRecherchePremier(Personnel, IDPersonnel, gOrgaElement.ID) 
// Remplit les informations du collaborateur 
LIB_ORGAELEMENT_TELEPHONE = Personnel.Téléphone
BTN_ORGAELEMENT_EMAIL.Libellé = Personnel.Email 
LIB_ORGAELEMENT_TITRE = Personnel.Nom + ESP + Personnel.Prénom
```



### Modifier la forme de l'élément
<a name="modifier_forme_element_ELTPARAGRAPHE000096"></a>La propriété **ImageFond** de la variable de type [OrgaElément](../WDLang1/1000019713.md) permet de modifier visuellement le rendu de l'élément.

Cette propriété permet en effet de définir l'image qui sera affichée en fond de la fenêtre interne. Il est alors possible d'afficher des formes par exemple :  

```wl
// Absolue (affiché dans un carré) 
Absolue est un OrgaElément 
Absolue.Contenu = "Absolue"
Absolue.ImageFond = "orgaschema_02_Fuschia.png"
nParent = OrgaAjoute(ORGA_SCHEMA, Absolue) 
// Processus (affiché dans un losange) 
Chauffe est un OrgaElément 
Chauffe.Contenu = "Chauffe, refroidissement, filtrage"
Chauffe.ImageFond = "orgaschema_01.png" 
nParent = OrgaAjouteFils(ORGA_SCHEMA, nParent, Chauffe)
```


<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Utiliser plusieurs fenêtres internes dans un même champ Organigramme
<a name="utiliser_plusieurs_fenetres_internes_dans_meme_champ_organigramme_ELTTEXTE000251"></a>
Grâce aux fenêtres internes, chaque champ Organigramme peut donc avoir (dans une même application) un rendu différent et unique. 

Il est également possible, dans un même champ organigramme, d'utiliser plusieurs fenêtres internes.

Cette fonctionnalité est particulièrement utile pour les organigrammes affichant des éléments de différents types, qui ont des informations différentes. 

Pour paramétrer la fenêtre interne à utiliser pour un élément du champ Organigramme, il suffit d'utiliser la propriété **FIDessin** de la variable de type [OrgaElément](../WDLang1/1000019713.md). 


