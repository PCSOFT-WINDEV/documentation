


## Manipuler un champ Liste par programmation
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000377"></a>
WINDEV, WEBDEV et WINDEV Mobile permettent de manipuler un champ Liste directement par programmation. Il suffit d'utiliser directement la variable du champ Liste dans le code. Cette variable est de type numérique.

La variable du champ Liste :

- correspond au nom du champ Liste.

- est initialisée avec l'indice de l'élément sélectionné dans le champ Liste.




Pour manipuler un élément du champ Liste, il suffit d'utiliser la notation suivante : 

```txt
<Champ Liste> [<Indice de l'élément>]
```


**Remarque** : De nombreuses fonctions du WLangage sont spécifiques à la gestion des champs de type Liste. Pour plus de détails, consultez [les fonctions de gestion des champs Liste](../WDLang1/3049001.md).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Initialiser un champ Liste
<a name="initialiser_champ_liste_ELTTEXTE000401"></a>


### Initialiser un élément
<a name="initialiser_element_ELTPARAGRAPHE000035"></a>Pour initialiser un élément d'un champ Liste, utilisez la fonction [ListeAjoute](../WDLang1/3049004.md).

**Remarque** : Pour modifier un élément d'un champ Liste, il est possible d'utiliser la syntaxe : 

```txt
<Champ Liste>[Indice] = <valeur>
```
Par exemple : 

```wl
// Ajout d'éléments
ListeAjoute(LISTE_LISTE1, "DUPOND")
ListeAjoute(LISTE_LISTE1, Nom_Cli)
// Modification d'éléments
LISTE_LISTE1[3] = "DUPONT"
```

<a name="NOTE2_2"></a>


### Remplir un champ Liste
<a name="remplir_champ_liste_ELTPARAGRAPHE000057"></a>Pour initialiser un champ Liste, il suffit d'utiliser une boucle d'itération pour initialiser tous les éléments du champ Liste.

```txt
Indice est un entier
POUR Indice = <Position Début> A <Position Fin>
	ListeAjoute(<Champ Liste>, <Valeur>)
FIN
```
Exemple :

```wl
i est un entier
POUR i = 1 A 52
	ListeAjoute(LISTE_LISTE1, NOM[i])
FIN
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Sélectionner un élément dans un champ Liste
<a name="selectionner_element_dans_champ_liste_ELTTEXTE000431"></a>


### Sélectionner une ligne
<a name="selectionner_une_ligne_ELTPARAGRAPHE000081"></a>Pour sélectionner l'élément de la ligne &lt;Indice&gt;, utilisez :

- soit l'affectation directe : 
	
	```txt
	<Champ Liste> = Indice
	```


- soit la fonction [ListeSelectPlus](../WDLang1/3049012.md) : 
	
	```txt
	ListeSelectPlus(<Champ Liste>, <Indice>)
	```




<a name="NOTE3_2"></a>


### Se positionner sur le dernier élément
<a name="positionner_sur_dernier_element_ELTPARAGRAPHE000105"></a>Pour se positionner sur le dernier élément du champ Liste, utilisez :

- soit la propriété [Occurrence](../WDLang1/3025009.md) : 
	
	```txt
	<Champ Liste>.Occurrence
	```


- soit la fonction [ListeSelectPlus](../WDLang1/3049012.md) associée à la propriété [Occurrence](../WDLang1/3025009.md) : 
	
	```txt
	ListeSelectPlus(<Champ Liste>, <Champ Liste>.Occurrence)
	```


- soit la fonction [ListeOccurrence](../WDLang1/3049014.md) : 
	
	```txt
	ListeOccurrence(<Champ Liste>)
	```





<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Récupérer l'élément sélectionné dans un champ Liste
<a name="recuperer_element_selectionne_dans_champ_liste_ELTTEXTE000461"></a>


### Récupérer l'indice de l'élément sélectionné
<a name="recuperer_indice_element_selectionne_ELTPARAGRAPHE000148"></a>Pour récupérer l'indice de l'élément sélectionné, utilisez :

- soit la lecture directe de l'élément : 
	
	```txt
	Indice = <Champ Liste>
	```


- soit la fonction [ListeSelect](../WDLang1/3049011.md) : 
	
	```txt
	Indice = ListeSelect(<Champ Liste>)
	```





**Remarque** : Pour les champs Liste multisélection, la fonction [ListeSelect](../WDLang1/3049011.md) permet de récupérer les éléments sélectionnés.

```wl
// Récupérer les éléments d'un champ Liste multisélection
Rang est un entier = 0  // numéro de la sélection
Indice est un entier = 0  // indice de l'élément sélectionné
BOUCLE
	Rang = Rang + 1
	Indice = ListeSelect(LISTE_LISTE1, Rang)
	SI Indice = -1 ALORS SORTIR
FIN
```

<a name="NOTE4_2"></a>


### Récupérer la valeur de l'élément sélectionné
<a name="recuperer_valeur_element_selectionne_ELTPARAGRAPHE000184"></a>Pour récupérer la valeur de l'élément sélectionné, utilisez une des syntaxes suivantes :

- **Syntaxe 1** :
	
	```txt
	Indice est un entier = <Champ Liste>
	<Variable> = <Champ Liste>[Indice]
	```


- **Syntaxe 2** :
	
	```txt
	<Variable> = <Champ Liste>[<Champ Liste>]
	```


- **Syntaxe 3** : Propriété [ValeurAffichée](../Proprietes/2510129.md) (en code serveur uniquement)
	
	```txt
	<Variable> = <Champ Liste>[Indice].ValeurAffichée
	```





**Attention** : La valeur mémorisée en programmation peut être différente de la valeur affichée. Pour connaître la valeur mémorisée correspondant à une des lignes du champ Liste, utilisez la propriété [ValeurMémorisée](../Proprietes/2510127.md).

<a name="NOTE4BIS"></a>
<a name="NOTE4BIS_1"></a>


## Parcourir les éléments d'un champ Liste
<a name="parcourir_les_elements_champ_liste_ELTTEXTE000491"></a>
L'instruction **POUR TOUT** permet d'effectuer différents types de parcours d'un champ Liste : 

- Parcours des éléments du champ. La syntaxe utilisée est la suivante : 
	
	```txt
	POUR TOUTE LIGNE [<Indice> [, <Compteur>]] DE <Champ Liste>
	  ...
	FIN
	```
 où : 

	- &lt;Indice&gt; : Variable optionnelle de type Entier. A chaque itération, contient l'indice de la ligne en cours.

	- &lt;Compteur&gt; : Variable optionnelle de type Entier. Cette variable compte le nombre d'itérations.




- Parcours des éléments des éléments sélectionnés. La syntaxe utilisée est la suivante : 
	
	```txt
	POUR TOUTE LIGNE SELECTIONNEE [<Indice>, [<Compteur>]] DE <Champ Liste>
	    ...
	FIN
	```
 où : 

	- &lt;Indice&gt; : Variable de type Entier. A chaque itération, contient l'indice de la ligne sélectionnée en cours.

	- &lt;Compteur&gt; : Variable optionnelle de type Entier. Cette variable compte le nombre d'itérations (nombre de lignes sélectionnées par exemple).







Pour plus de détails, consultez [Instruction POUR TOUT / POUR TOUS (parcours de champs)](../Motscles/1510017.md). 

<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Propriétés spécifiques à la gestion des champs Liste
<a name="proprietes_specifiques_gestion_des_champs_liste_ELTTEXTE000515"></a>
Les propriétés suivantes sont spécifiques à la gestion des champs Liste :  



|   |   |
| --- | --- |
| **Tout type de champs Liste** |
| [CadrageHorizontal](../Proprietes/2510023.md) | Permet de connaître et de modifier le cadrage horizontal des éléments du champ Liste. |
| [HauteurLigne](../Proprietes/2510041.md) | Permet de connaître et de modifier la hauteur des lignes d'un champ Liste. |
| [Mémoire](../Proprietes/2510076.md) | Permet de savoir si le champ spécifié est un champ Liste par programmation ou un champ Liste fichier. |
| [Occurrence](../WDLang1/3025009.md) | Permet de connaître le nombre de lignes présentes dans un champ Liste. |
| [TypeRemplissage](../Proprietes/1000017723.md) | Permet de connaître le type de remplissage (liaison fichier, par programmation, liaison variable) d'un champ de type Table, Liste, Liste image, Combo ou Zone répétée. |
| [ValeurAffichée](../Proprietes/2510129.md) | Permet de connaître la valeur de la ligne en cours ou d'une ligne spécifique du champ Liste. |
| [ValeurMémorisée](../Proprietes/2510127.md) | Permet de connaître la valeur actuellement mémorisée lors de la sélection d'une ligne du champ Liste. |
| [Vide](../Proprietes/2510126.md) | Permet de savoir si un champ Liste est vide. |
| **Champ Liste par programmation uniquement** |
| [ContenuInitial](../Proprietes/2510021.md) | Permet de connaître le contenu initial d'un champ Liste par programmation. |
| [Triée](../Proprietes/2510115.md) | Permet de savoir si un champ Liste par programmation est triée et de trier un champ Liste par programmation. |
| **Champ Liste Fichier uniquement** |
| [FichierParcouru](../Proprietes/2510040.md) | Permet de connaître et de modifier le fichier de données ou la requête utilisé pour l'affichage des enregistrements dans les champs Liste fichier. |
| [ParcoursAuto](../Proprietes/2510093.md) | Permet de savoir si le parcours d'un champ Liste fichier est automatique ou programmé. |
| [RubriqueAffichée](../Proprietes/2510123.md) | Permet de connaître ou de modifier la rubrique affichée dans un champ Liste. |
| [RubriqueMémorisée](../Proprietes/2510110.md) | Permet de connaître ou de modifier la rubrique mémorisée d'un champ Liste. |
| [RubriqueParcourue](../Proprietes/2510111.md) | Permet de connaître et de modifier la rubrique utilisée pour le parcours automatique des champs Liste. |


Pour connaître la liste complète des propriétés du WLangage pouvant être utilisées avec un champ de type Liste, consultez [Propriétés associées au champ Liste.](../WDChamp/1013182.md)


