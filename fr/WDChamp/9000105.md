


## Les modèles d'états
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000377"></a>
WINDEV, WINDEV Mobile et WEBDEV permettent de créer des modèles d'états. Ces modèles contiennent tous les éléments graphiques et le code communs à l'ensemble des états de votre application.

Les modifications effectuées dans un modèle d'états sont automatiquement reportées sur tous les états utilisant ce modèle.

Un modèle d'états permet de respecter la charte graphique définie pour une application.

L'utilisation de modèles d'états dans vos applications permet de :

- simplifier la création des états de l'application.

- simplifier la mise en page des états de l'application.

- simplifier la mise à jour de la charte graphique de l'application.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Création d'un modèle d'états
<a name="creation_modele_etats_ELTTEXTE000401"></a>
Un modèle d'états peut être créé :

- [soit directement, comme un nouvel état](#NOTE2_2).

- [soit à partir d'un état existant](#NOTE2_3).



<a name="NOTE2_2"></a>


### Créer un modèle d'états
<a name="creer_modele_etats_ELTPARAGRAPHE000040"></a>Pour créer un modèle d'états :

1. Créez un nouveau modèle d'états : 

	- Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif) parmi les boutons d'accès rapide. 

	- La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Etat" puis sur "Modèle d'états".

	- L'éditeur d'états affiche un nouvel état dans un cadre vert intitulé "Modèle d'états".




2. Créez tous les champs nécessaires. Ces champs seront présents sur tous les états utilisant le modèle.

3. Saisissez si nécessaire :

	- les événements associés à l'état.

	- les événements associés aux différents champs du modèle.
			Ces événements seront automatiquement importés dans les états utilisant le modèle.




4. Donnez un nom à votre modèle (onglet "Général" de la fenêtre de description).

5. Enregistrez le modèle d'états (![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_Enregistrer.gif) ou Ctrl + S). <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Modeles%20d'etats%20-%20HC%20N%B0001.gif&type=thumb)



Le modèle d'états correspond à un fichier d'extension ".WTE".
<a name="NOTE2_3"></a>


### Créer un modèle d'états à partir d'un état existant
<a name="creer_modele_etats_partir_etat_existant_ELTPARAGRAPHE000069"></a>Pour créer un modèle d'états à partir d'un état existant :

1. Ouvrez l'état choisi comme modèle.

2. Conservez uniquement les champs nécessaires au modèle. Ces champs seront présents sur tous les états utilisant le modèle d'états.

3. Conservez uniquement le code des événements nécessaires au modèle. Ces événements seront automatiquement importés dans les états utilisant le modèle.

4. Donnez si nécessaire un nom à votre état (onglet "Général" de la fenêtre de description).

5. Sous le volet "Accueil", dans le groupe "Général", déroulez "Enregistrer" et sélectionnez "Enregistrer comme un modèle".




L'état en cours devient un modèle :

- son nom est précédé de "Modèle".

- un cadre vert entoure l'état dans l'éditeur d'états.

- le modèle d'états apparaît dans le volet "Explorateur de projet" dans le dossier "Modèles d'états".




Le modèle d'états correspond à un fichier d'extension ".WTE".

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Appliquer un modèle d'états
<a name="appliquer_modele_etats_ELTTEXTE000437"></a>


### Créer un nouvel état basé sur un modèle d'états
<a name="creer_nouvel_etat_base_sur_modele_etats_ELTPARAGRAPHE000104"></a>Pour créer un nouvel état basé sur un modèle d'états :

1. Créez un nouvel état : 

	- Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif) parmi les boutons d'accès rapide. 

	- La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Etat" puis sur "Etat".

	- L'assistant de création d'un état se lance.




2. Sélectionnez le type d'état à créer. Passez à l'étape suivante de l'assistant.

3. Choisissez votre modèle dans la liste des modèles disponibles.

4. Finissez l'assistant et validez. Le nouvel état apparaît sous l'éditeur.




Un carré jaune permet d'identifier les éléments appartenant au modèle d'états. Ces éléments pourront être modifiés :

- dans le modèle d'états : la modification sera effective pour tous les états utilisant ce modèle.

- dans l'état par le [mécanisme de "surcharge de champs"](../WDChamp/9000106.md) : la modification sera effective uniquement pour l'état. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Modeles%20d'etats%20-%20HC%20N%B0002.gif&type=thumb)




<a name="NOTE3_2"></a>


### Appliquer un modèle sur un état existant
<a name="appliquer_modele_sur_etat_existant_ELTPARAGRAPHE000131"></a>Pour appliquer un modèle sur un état existant :

1. Affichez l'état sous l'éditeur d'états.

2. Sous le volet "Modification", dans le groupe "Modèles et gabarit", déroulez "Modèles" et sélectionnez "Hériter d'un modèle".

3. Sélectionnez le modèle d'états à appliquer.

4. Validez.

5. Indiquez si vous souhaitez mettre à jour les propriétés de l'état depuis le modèle. Si vous répondez "Oui", la liste des propriétés à surcharger apparaît. Dans cette fenêtre, vous pouvez sélectionner les propriétés de l'état initial à conserver. Le modèle d'états appliqué sera automatiquement surchargé pour les propriétés conservées. Pour toutes les autres caractéristiques, l'état sera automatiquement lié au modèle.

6. Validez.




Remarque : Par défaut, les caractéristiques d'orientation ainsi que la hauteur de l'état et de ses différents blocs sont automatiquement surchargées.
<a name="NOTE3_3"></a>


### Spécificités des blocs
<a name="specificites_des_blocs_ELTPARAGRAPHE000159"></a>Un état contient des blocs uniques : début de document, haut de page, corps, bas de page, fin de document, ...

Lors de l'insertion d'un modèle dans un état, les blocs de même type sont fusionnés automatiquement :

- le code est automatiquement hérité (de manière cumulative si il y a plusieurs modèles),

- les propriétés sont héritées,

- le bloc contient les champs du modèle et ceux de l'état.




Seul le modèle principal définit les propriétés des blocs.

**Cas particulier : les blocs d'itération**
Les blocs d'itération n'étant pas des blocs uniques, ils ne seront pas fusionnés.
<a name="NOTE3_4"></a>


### Remarques
<a name="remarques_ELTPARAGRAPHE000178"></a>

- Il est possible d'appliquer plusieurs modèles à un état. Dans ce cas, les champs des différents modèles sont présent dans l'état, ainsi que les différents événements de chacun des modèles. Les propriétés de l'état (orientation, hauteur des blocs, ...) ne peuvent être liées qu'à un seul modèle.

- La surcharge de styles au niveau des modèles n'est pas gérée.

- Il n'est pas possible d'utiliser dans les modèles :

	- des tableaux,

	- des ruptures,

	- des sources de données.







<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Ouvrir le modèle associé à un état
<a name="ouvrir_modele_associe_etat_ELTTEXTE000479"></a>
Pour ouvrir le modèle associé à un état :

1. Affichez l'état sous l'éditeur d'états.

2. Dans le menu contextuel d'un élément du modèle, sélectionnez l'option "Ouvrir le modèle".




**Autre possibilité** : 

1. Listez les modèles associés à l'état : sous le volet "Modification", dans le groupe "Modèles et gabarit", déroulez "Modèles" et sélectionnez "Liste des modèles utilisés".

2. Sélectionnez le modèle voulu et cliquez sur le bouton "Ouvrir le modèle".




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Reporter les modifications effectuées sur un modèle
<a name="reporter_les_modifications_effectuees_sur_modele_ELTTEXTE000503"></a>
Lors de la modification d'un modèle d'états, il est possible de reporter ces modifications sur un ou plusieurs états utilisant ce modèle dans le projet en cours.

Ce report des modifications est proposé à l'enregistrement du modèle. 

Il peut également être effectué à tout moment :

- depuis le modèle : sous le volet "Modification", dans le groupe "Modèles et gabarit", déroulez "Modèles" et sélectionnez "Mettre à jour les états associés".

- depuis n'importe quel état utilisant le modèle, en ouvrant la liste des modèles utilisés : 

	- sous le volet "Modification", dans le groupe "Modèles et gabarit", déroulez "Modèles" et sélectionnez "Liste des modèles utilisés".

	- cliquez sur le bouton "Mettre à jour le modèle sélectionné".







**Remarque** : Le report des modifications du modèle est effectué en fonction des caractéristiques surchargées dans les états qui utilisent le modèle.

<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Tester un modèle d'états
<a name="tester_modele_etats_ELTTEXTE000527"></a>
Pour tester un modèle d'états :

1. Ouvrez le modèle d'état à tester : 

	- directement en cliquant sur son nom dans l'explorateur de projet.

	- à partir d'un état utilisant le modèle d'état (par exemple en sélectionnant l'option "Ouvrir le modèle" du menu contextuel d'un des champs).




2. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Ico_Go_Fenetre_WD_bl.gif).




<a name="NOTE7"></a>
<a name="NOTE7_1"></a>


## Liste des modèles utilisés
<a name="liste_des_modeles_utilises_ELTTEXTE000551"></a>
Pour afficher la liste des modèles utilisés pour un état : 

1. Ouvrez l'état voulu sous l'éditeur d'états. 

2. Sous le volet "Modification", dans le groupe "Modèles et gabarit", déroulez "Modèles" et sélectionnez "Liste des modèles utilisés".




Depuis cette fenêtre, il est possible de :

- "Ouvrir un modèle" : ouvre le modèle sélectionné dans l'éditeur d'états.

- "Se mettre à jour" : les champs et le code du modèle sont mis à jour dans l'état.

- "Ajouter" : ajoute un modèle à l'état en cours.

- "Dissocier" : les champs du modèle présents dans l'état sont dissociés du modèle. Le modèle est supprimé de la liste des modèles utilisés, mais ses champs ne sont pas supprimés de l'état.

- "Supprimer" : supprime le modèle (champs et code) de l'état.




<a name="NOTE8"></a>
<a name="NOTE8_1"></a>


## Synchronisation des états et des modèles d'états
<a name="synchronisation_des_etats_des_modeles_etats_ELTTEXTE000575"></a>
Il est possible de synchroniser les états et leurs modèles lors de la création d'exécutables, de composants, ... 

1. Affichez la fenêtre de description du projet : sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description".

2. Affichez l'onglet "Options" de la description du projet. 

3. Cochez l'option "Synchroniser les modèles lors de la génération".





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDEtats.gif) ***Exemples didactiques (WINDEV)*** : **WD Etats** <br>Cet exemple montre les différentes méthodes pour réaliser un état :<br> <br>- impressions basées sur différentes sources de données (requêtes, variables, ...)<br>- impressions basées sur des champs (Table, Tableur, TCD, ...)<br>- impression d'états composés<br>- impressions spécifiques (portrait / paysage, état avec filigrane, état avec code-barres, ...)


