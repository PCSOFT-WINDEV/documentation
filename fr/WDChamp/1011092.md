
## Champ Tableau croisé dynamique d'un état
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000122"></a>
L'éditeur d'états offre la possibilité de créer des états de type "Tableau croisé". Dans ce cas, deux possibilités se présentent pour une application WINDEV : 

- la source de données correspond à plusieurs fichiers de données : un état tableau croisé basé sur une requête sera créé. 

- la source de données correspond à un champ Tableau croisé dynamique présent dans une fenêtre (cas présenté dans cette page) : l'état créé contient un champ Tableau croisé dynamique. 




Lors de la création d'un état basé sur un champ Tableau croisé dynamique d'une fenêtre, l'état est alors constitué uniquement d'un champ Tableau croisé dynamique. Ce type de champ est créé uniquement lors de la création de ce type d'état : il ne peut pas être créé indépendamment de cet état. 

Sous l'éditeur, ce champ est constitué de deux blocs : 

- Le bloc "En-tête" affichant les titres des colonnes du Tableau croisé dynamique. 

- Le bloc "Tableau croisé dynamique" affichant les titres des lignes et les données associées. 




Pour plus de détails sur les différentes sources d'un état de type "Tableau croisé", consultez [Etat Tableau croisé](../WDChamp/1011062.md).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Créer un état Tableau croisé basé sur un champ Tableau croisé dynamique
<a name="creer_etat_tableau_croise_base_sur_champ_tableau_croise_dynamique_ELTTEXTE000146"></a>


### Création de l'état
<a name="creation_etat_ELTPARAGRAPHE000031"></a>Pour créer un état de type "Tableau croisé dynamique" : 

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif)
 parmi les boutons d'accès rapide. 

2. La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Etat" puis sur "Etat".

3. L'assistant de création d'un état se lance. 

4. Dans cet assistant, spécifiez :

	- le type d'état à créer : "Tableau croisé".

	- le champ Tableau croisé dynamique utilisé comme source de données.

	- le gabarit de l'état (si nécessaire).

	- le nom et le titre de l'état. Ce nom (nom du fichier ".WDE" correspondant à l'état) permettra d'identifier l'état dans vos programmes.







<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Caractéristiques d'un état Tableau croisé dynamique et d'un champ Tableau croisé dynamique
<a name="caracteristiques_etat_tableau_croise_dynamique_champ_tableau_croise_dynamique_ELTTEXTE000170"></a>


### Caractéristiques du Tableau croisé dynamique (Editeur d'états)
<a name="caracteristiques_tableau_croise_dynamique_editeur_etats_ELTPARAGRAPHE000052"></a>Il est possible de modifier les caractéristiques suivantes d'un état Tableau croisé dynamique : 

- La source de données de l'état peut être modifiée dans l'onglet "Données" de la fenêtre de description de l'état (option "Description de l'état" du menu contextuel de l'état). 

- L'onglet "Général" de la fenêtre de description du champ Tableau croisé dynamique permet de spécifier : 

	- **le mode de calcul de la largeur des cellules** : les options disponibles sont les suivantes : 

		- Utiliser la largeur définie en édition :  les cellules seront affichées avec la même largeur que celle définie sous l'éditeur d'états.
						Remarque : Il est possible d'utiliser les poignées pour redimensionner la zone des données dans le champ Tableau croisé dynamique présent dans l'état. 

		- Remplir la page au maximum en largeur : s'il reste de la place dans la page, les cellules seront élargies pour combler l'espace vide.

		- Eviter les cellules tronquées : s'il reste de la place dans la page, les cellules seront éventuellement élargies pour afficher la totalité des données qu'elles contiennent.




- **le déroulement des dimensions** : les options disponibles sont les suivantes : 

	- Comme le champ : le niveau de détail affiché dans l'état sera le même que celui du champ Tableau croisé dynamique utilisé comme source de données.

	- Tout déroulé : toutes les données du Tableau croisé dynamique seront affichées.

	- Tout enroulé : seul le premier niveau de détail du Tableau croisé dynamique sera affiché.

- L'onglet "Style" de la fenêtre de description du champ TCD permet de définir le style du champ : l'option "Définir le style indépendamment du champ TCD imprimé" permet de définir un style spécifique pour le champ dans l'état. Si cette option est cochée, il est possible de spécifier le style des entêtes de lignes et des données.









- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDEtats.gif) ***Exemples didactiques (WINDEV)*** : **WD Etats** <br>Cet exemple montre les différentes méthodes pour réaliser un état :<br> <br>- impressions basées sur différentes sources de données (requêtes, variables, ...)<br>- impressions basées sur des champs (Table, Tableur, TCD, ...)<br>- impression d'états composés<br>- impressions spécifiques (portrait / paysage, état avec filigrane, état avec code-barres, ...)




