


## Programmation des calculs automatiques dans les colonnes d'un champ Table
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## A quel moment les calculs sont effectués ?
<a name="quel_moment_les_calculs_sont_effectues_ELTTEXTE000281"></a>
Les calculs sont effectués :

- lors de l'initialisation du champ Table. 

- lorsqu'un traitement effectue un ajout ou une modification sur un champ Table avec calculs :

	- les totaux sont recalculés à la fin du traitement (ou lors de l'utilisation de la fonction [Multitache](../WDLang1/3015004.md)).

	- si la valeur d'un calcul est demandée (voir paragraphe suivant), ce calcul est immédiatement ré-effectué.







La propriété [TotauxActif](../Proprietes/2510122.md) permet d'interdire ou de forcer les calculs effectués dans un champ Table. 

**Attention** : Si la propriété [AffichageActif](../Proprietes/2510015.md) est utilisée sur le champ Table et correspond à <u><u><u><u>Faux</u></u></u></u>, les calculs automatiques ne sont pas mis à jour. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Récupérer la valeur d'un calcul
<a name="recuperer_valeur_calcul_ELTTEXTE000305"></a>
Le résultat des différents calculs réalisés dans un champ Table peuvent être manipulés par programmation.

Plusieurs constantes permettent d'identifier la ligne de calcul d'une colonne :



|   |   |
| --- | --- |
| *ligneComptage* | Ligne contenant le résultat du comptage. |
| *ligneMaximum* | Ligne contenant la valeur maximale des cellules de la colonne. |
| *ligneMinimum* | Ligne contenant la valeur minimale des cellules de la colonne. |
| *ligneMoyenne* | Ligne contenant le résultat d'une moyenne. |
| *ligneTotal* | Ligne contenant le résultat d'un total. |


**Pour récupérer la valeur d'un calcul, il suffit d'utiliser la syntaxe suivante** :

```txt
<Nom de la colonne>[<Type du calcul>]
```

Exemple :


```wl
// Récupère le calcul de moyenne effectué dans la colonne COL_NOTE
Trace(COL_NOTE[LigneMoyenne])
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Modifier les caractéristiques des calculs par programmation
<a name="modifier_les_caracteristiques_des_calculs_par_programmation_ELTTEXTE000329"></a>
WINDEV permet de modifier les caractéristiques (police, couleur, ...) du résultat d'une colonne par programmation grâce aux propriétés WLangage. Il est par exemple possible d'utiliser les propriétés du WLangage pour modifier la couleur du résultat, sa couleur de fond, sa police, ... Cependant, il n'est pas possible de modifier le contenu de la cellule résultat par programmation.

**Pour utiliser une propriété du WLangage sur le résultat d'une colonne**, la syntaxe à utiliser est la suivante :


```txt
<Nom de la colonne>[<Type du calcul>].<Propriété>
```

Exemple :


```wl
// Colore en rouge le résultat de la moyenne. Le fond est en bleu
COL_NOTE[LigneMoyenne].Couleur = RougeClair
COL_NOTE[LigneMoyenne].CouleurFond = BleuClair
```

<a name="NOTE3_2"></a>


### Propriétés utilisables sur les cellules de calcul des colonnes
<a name="proprietes_utilisables_sur_les_cellules_calcul_des_colonnes_ELTPARAGRAPHE000105"></a>


|   |   |
| --- | --- |
| [Couleur](../Proprietes/2510071.md) | Permet de connaître et de modifier la couleur du texte affiché dans une cellule de calcul. |
| [CouleurFond](../Proprietes/2510022.md) | Permet de connaître et de modifier la couleur de fond d'une cellule de calcul. |
| [Etat](../Proprietes/2510039.md) | Permet de connaître et de modifier l'état d'affichage de la ligne contenant la cellule de calcul. |
| [Hauteur](../Proprietes/2510050.md) | Permet de connaître et de modifier la hauteur d'une cellule de calcul. |
| [Largeur](../Proprietes/2510059.md) | Permet de connaître et de modifier la largeur d'une cellule de calcul. |
| [Libellé](../Proprietes/2510053.md) | Permet de connaître et de modifier le libellé de la ligne contenant une cellule de calcul. |
| [Nom](../Proprietes/2510082.md) | Permet de connaître le nom d'une cellule de calcul. |
| [Note](../Proprietes/2510085.md) | Permet de connaître et de modifier les notes associées à une cellule de calcul. |
| [Police](../Motscles/1514045.md) | Permet de connaître et de modifier la police utilisée dans une cellule de calcul. |
| [PoliceBarrée](../Proprietes/2510091.md) | Permet de connaître et de modifier l'attribut "Barré" pour une cellule de calcul. |
| [PoliceCondensée](../Proprietes/2510096.md) | Permet de savoir si les caractères des éléments de la colonne sont condensés ou non, et de condenser ou non les caractères des éléments de la colonne. |
| [PoliceEtendue](../Proprietes/2510104.md) | Permet de savoir si les caractères des éléments de la colonne sont étendus ou non et d'étendre ou non les caractères des éléments de la colonne. |
| [PoliceGras](../Proprietes/2510103.md) | Permet de connaître et de modifier l'attribut "Gras" pour les éléments de la colonne. |
| [PoliceItalique](../Proprietes/2510102.md) | Permet de connaître et de modifier l'attribut "Italique" pour les éléments de la colonne. |
| [PoliceLarge](../Proprietes/2510101.md) | Permet de savoir si les caractères des éléments de la colonne sont élargis ou non, et d'élargir ou non les caractères des éléments de la colonne. |
| [PoliceNom](../Proprietes/2510100.md) | Permet de connaître et de modifier la police utilisée pour les éléments de la colonne. |
| [PoliceSoulignée](../Proprietes/2510099.md) | Permet de connaître et de modifier l'attribut "Souligné" pour les éléments de la colonne. |
| [PoliceTaille](../Proprietes/2510072.md) | Permet de connaître et de modifier la taille de la police utilisée pour les éléments de la colonne. |
| [Visible](../Proprietes/2510138.md) | Permet de savoir si une colonne est visible et de rendre visible / invisible une colonne. |



<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Exporter les résultats des calculs
<a name="exporter_les_resultats_des_calculs_ELTTEXTE000359"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Export via les FAA (Fonctionnalités Automatiques de vos Applications) du champ Table
<a name="export_via_les_faa_fonctionnalites_automatiques_vos_applications_champ_table_ELTPARAGRAPHE000214"></a>Le menu contextuel des champs Table et Table hiérarchique propose par défaut des options permettant d'exporter le contenu du champ. 

Lors de cet export, les résultats des calculs automatiques sont exportés. 

**Remarques** : 

- Seule la valeur est exportée, pas le libellé. 

- Lors de l'export sous Excel, la cellule correspondant au calcul contient la formule Excel correspondante. 





### Export via les fonctions WLangage
<a name="export_via_les_fonctions_wlangage_ELTPARAGRAPHE000228"></a>Diverses fonctions WLangage permettent d'exporter le contenu d'un champ Table dans un format spécifique (Word, Excel, XML, ...). Lors de cet export, par défaut les lignes correspondant à un calcul sont également exportées.

Pour ne pas exporter les lignes de calculs, il suffit de spécifier la constante *taSansTotaux* dans les fonctions suivantes :



|   |   |
| --- | --- |
| [TableVersExcel](../WDLang1/3074033.md) | Crée un fichier Excel avec les données d'un champ Table ou Table hiérarchique. |
| [TableVersPressePapier](../WDLang1/1000017062.md) | Copie le contenu d'un champ Table ou Table hiérarchique dans le presse-papiers. |
| [TableVersTexte](../WDLang1/1000017061.md) | Crée une chaîne de caractères avec les données d'un champ Table ou Table hiérarchique. |
| [TableVersWord](../WDLang1/3074036.md) | Crée un fichier Word (.RTF) avec les données d'un champ Table ou Table hiérarchique. |
| [TableVersXML](../WDLang1/3074037.md) | Crée un fichier XML avec les données d'un champ Table ou Table hiérarchique. |






