
## Champ Combo lié à un fichier de données
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000100"></a>
Un champ Liste ou Combo peut être utilisé pour afficher le contenu d'un fichier de données, par exemple pour qu'un utilisateur sélectionne un enregistrement.

Lorsqu'un champ Combo est lié à un fichier de données, ce champ pourra être initialisé avec le contenu du fichier de données :

- soit **automatiquement** : aucun code spécifique n'est nécessaire pour initialiser le champ. Les caractéristiques du parcours du fichier de données lié au champ sont décrites dans l'onglet "Contenu" de la description du champ.

- soit par **programmation** : Il est nécessaire de saisir le code de parcours du fichier de données lié au champ Combo dans le code d'initialisation du champ. Cette méthode est déconseillée.




**Remarque** : Lors de la création d'un champ Combo, l'assistant demande les différents renseignements nécessaires à la création d'un champ Combo lié à un fichier de données.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Astuce : Comment rafraîchir le contenu d'un champ Combo auto-alimentée dont la source est une requête ?
<a name="astuce_comment_rafraichir_contenu_champ_combo_autoalimentee_dont_source_est_une_requete_ELTTEXTE000124"></a>
Si vous utilisez un champ Combo basé sur une requête avec initialisation automatique, pour rafraîchir le contenu du champ, il suffit de saisir le code suivant (par exemple dans le code d'initialisation du champ). Ce code effectue les opérations suivantes :

1. Ré-exécution de la requête de base du champ Combo (en spécifiant les paramètres de la requête si nécessaire) avec la fonction [HExécuteRequête](../WDLang4/3044080.md).

2. Ré-affichage du contenu du champ Combo avec la fonction [ListeAffiche](../WDLang1/3049005.md).





```wl
// -- Initialisation d'un champ Combo
HExécuteRequête(MaREQ, hRequêteDéfaut, Param1, Param2) 
ListeAffiche(COMBO_NomCombo, taDébut)
```




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Code d'initialisation d'un champ Combo lié à un fichier de données par programmation
<a name="code_initialisation_champ_combo_lie_fichier_donnees_par_programmation_ELTTEXTE000148"></a>
Si vous utilisez un champ Combo basé sur un fichier de données avec initialisation programmée, il est nécessaire de saisir le code de parcours du fichier de données dans le code d'initialisation du champ.

**Par exemple** : Initialisation d'un champ Combo avec les clients du fichier de données CLIENT.


```wl
// -- Initialisation d'un champ Combo
HLitPremier(CLIENT, NomCli)
TANTQUE PAS HEnDehors()
	ListeAjoute(COMBO_Combo1, Client.NomCli)
	HLitSuivant(CLIENT, NomCli)
FIN
```





