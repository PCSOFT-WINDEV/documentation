


## Champ Tableur dans une fenêtre
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Créer un champ Tableur dans une fenêtre
<a name="creer_champ_tableur_dans_une_fenetre_ELTTEXTE000303"></a>


### Création du champ
<a name="creation_champ_ELTPARAGRAPHE000011"></a>Pour créer un champ de type Tableur : 

1. Sous le volet "Création", dans le groupe "Champs graphiques", déroulez "Bureautique" et sélectionnez "Tableur".

2. Cliquez dans la fenêtre à la position où le champ doit être créé.




Remarque : Les dimensions du champ créé sont optimisées pour occuper l'espace disponible à la position indiquée. Si la taille du champ ne vous convient pas, utilisez la combinaison de touches Ctrl + Z : le champ retrouvera sa taille par défaut.

Pour afficher les caractéristiques du champ, sélectionnez l'option "Description" dans le menu contextuel du champ.


### Remarques
<a name="remarques_ELTPARAGRAPHE000035"></a>

- Les données affichées par un champ Tableur peuvent : 

	- être déterminées par programmation.

	- saisies directement sous l'éditeur de fenêtres. 

	- provenir d'une variable. Cette variable doit être de type buffer et contenir la feuille Excel.

	- provenir d'un fichier de données ou d'une requête. Dans ce cas, la rubrique liée au champ peut correspondre à une rubrique mémo contenant la feuille Excel voulue. 




- Un menu des FAA spécifique est automatiquement associé au champ Tableur. Pour plus de détails, consultez [Fonctionnalités Automatiques de vos Applications (FAA) du champ Tableur](../WDChamp/1000033006.md). 

- Les valeurs maximales du champ Tableur sont : 

	- 16384 colonnes.

	- 1048576 lignes.

	- 4096 feuilles. 







<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Caractéristiques du champ Tableur dans une fenêtre
<a name="caracteristiques_champ_tableur_dans_une_fenetre_ELTTEXTE000337"></a>
Sous l'éditeur de fenêtres, il est possible : 

- de décrire les différentes caractéristiques du champ Tableur grâce à la fenêtre de description du champ.  

- d'initialiser directement le champ Tableur en saisissant les valeurs présentes dans les différentes cellules. 



<a name="NOTE2_2"></a>


### Fenêtre de description du champ Tableur
<a name="fenetre_description_champ_tableur_ELTPARAGRAPHE000066"></a>Les principales options du champ Tableur sont définies dans l'onglet "Détail" de la fenêtre de description du champ. 

Ces options sont les suivantes : 

- Options de saisie : 

	- **Autoriser la saisie de valeurs** : L'utilisateur final pourra saisir des valeurs dans les cellules du champ Tableur. Cette option peut être modifiée par programmation grâce à la propriété [SaisieValeur](../Proprietes/1000021336.md). 

	- **Autoriser la saisie de formules** : L'utilisateur final pourra saisir des formules dans les cellules du champ Tableur. Cette option peut être modifiée par programmation grâce à la propriété [SaisieFormule](../Proprietes/1000021337.md). 




- Options d'affichage : 

	- **Afficher les entêtes de lignes et de colonnes** (3) : Les noms des cellules sont affichés dans le champ Tableur (des lettres pour les colonnes, des chiffres pour les lignes). Cette option peut être modifiée par programmation grâce à la propriété [EntêteVisible](../Proprietes/1000021335.md). 

	- **Avec barre de saisie de formule** (2) : Une barre de calcul est affichée en haut du champ. Cette barre permet de saisir les formules. Cette option peut être modifiée par programmation grâce à la propriété [BarreDeFormuleVisible](../Proprietes/1000021334.md). 

	- **Barre d'outils** (1) : Permet d'afficher une barre d'outils en en haut du champ. Cette barre d'outils permet de mettre en forme les cellules sélectionnées. Il est possible d'afficher : 

		- Aucune barre. 

		- Une barre d'outils (compatibilité 22) : Affiche le menu sous forme de barre d'outils. Cette option peut être modifiée par programmation grâce à la propriété [BarreOutilsVisible](../Proprietes/1000021333.md). Cette barre d'outils peut être personnalisée (voir [Personnaliser la barre d'outils](#NOTE3_1)). 

		- Un ruban (par défaut pour un champ créé à partir de la version 23). Ce ruban peut être personnalisé (voir [Personnaliser le ruban](#NOTE3_3)). 




- Autres paramètres : 

	- **Hauteur d'une ligne** : Permet de définir la hauteur d'une ligne dans la feuille de calcul. Le bouton "Marges" permet de définir si nécessaire les marges de la cellule. 

	- **Autoriser la gestion de plusieurs feuilles de calcul** (4) : Cette option permet de gérer plusieurs feuilles dans le champ Tableur. Les onglets de gestion des feuilles de calcul sont affichés en bas à gauche du champ Tableur. Un menu contextuel permet à l'utilisateur de gérer les feuilles de calcul. Cette option peut être modifiée grâce à la propriété [MultiFeuille](../Proprietes/1000021639.md). 




<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Tableur%20Execution%20-%20HC%20N%B0001.gif)

<a name="NOTE2_3"></a>


### Initialisation du champ Tableur sous l'éditeur de fenêtres
<a name="initialisation_champ_tableur_sous_editeur_fenetres_ELTPARAGRAPHE000149"></a>Pour initialiser le champ Tableur sous l'éditeur de fenêtres : 

1. Sélectionnez le champ Tableur. 

2. Cliquez deux fois sur le champ ou affichez le menu contextuel du champ et sélectionnez l'option "Editer le contenu". 

3. Un cadre jaune apparaît autour du champ Tableur pour indiquer que le contenu du champ est en édition. 

4. Saisissez les différentes valeurs voulues dans les cellules du champ. Il est possible de saisir des valeurs, des formules, d'utiliser toutes les options de la barre de mise en forme ou du ruban.

5. Les valeurs saisies sont automatiquement sauvegardées avec le champ. 




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Personnaliser un champ Tableur
<a name="personnaliser_champ_tableur_ELTTEXTE000373"></a>


### Personnaliser la barre d'outils
<a name="personnaliser_barre_outils_ELTPARAGRAPHE000164"></a>Pour personnaliser la barre d'outils du champ Tableur, il suffit d'utiliser des fenêtres internes spécifiques. 

Pour personnaliser la barre d'outils : 

1. Sous le volet "Projet", dans le groupe "Projet", déroulez "Importer" et sélectionnez "Des éléments WINDEV et leurs dépendances". 

2. Sélectionnez le répertoire "Programmes\\Données\\Fenêtres prédéfinies\\FAA".

3. Sélectionnez les fenêtres : 

	- WinDevFaa_SelCadreTBLR.wdw : Fenêtre permettant de sélectionner les options de cadre des cellules du champ Tableur. 

	- WinDevFaa_SelCouleur.wdw : Fenêtre permettant de sélectionner la couleur de la police. 

	- FI_WinDevFaa_BarreTBLR.wdw : Fenêtre correspondant à la barre d'outils. 




4. Validez. 

5. Personnalisez la fenêtre "FI_WinDevFaa_BarreTBLR" à votre convenance.
	Attention : les noms des champs ne doivent pas être modifiés. 




Si le champ Tableur utilise une barre d'outils (option "Avec barre d'outils" dans l'onglet "Détail" de la description du champ ou propriété [BarreOutilsVisible](../Proprietes/1000021333.md)), la barre d'outils personnalisée sera utilisée. 
<a name="NOTE3_2"></a>


### Personnaliser la barre de formules
<a name="personnaliser_barre_formules_ELTPARAGRAPHE000202"></a>Pour personnaliser la barre de formule, il suffit de la recréer. 

Pour créer une barre de formule personnalisée : 

1. Créez deux champs : 

	- Un champ Libellé par exemple, permettant de visualiser les coordonnées de la cellule ou de la plage de cellule sélectionnée. 

	- Un champ de saisie permettant de saisir la formule. 




2. Créez deux boutons : 

	- Un bouton permettant de valider la saisie de la formule. 

	- Un bouton permettant d'annuler la saisie de la formule. 




3. Par programmation : 

	- Indiquez le rôle des deux premiers champs (visualisation des coordonnées ou saisie de la formule) grâce à la fonction [TableurChampFormule](../WDLang1/1000021647.md). Par exemple : 
			
		```wl
		// -- Code d'initialisation du champ Tableur
		// Enlève la barre de formule par défaut
		TBLR_MonTableur.BarreDeFormuleVisible = Faux
		// Définit le champ permettant de visualiser 
		// les coordonnées de la cellule sélectionnée dans le champ Tableur
		TableurChampFormule(TBLR_MonTableur, tblrfSélection, LIB_Sélection)
		// Définit le champ permettant de saisir les formules dans le champ Tableur
		TableurChampFormule(TBLR_MonTableur, tblrfFormule, SAI_Formule)
		```


	- Définissez les actions des deux boutons grâce à la fonction [FAAExécute](../WDLang1/1000022099.md). Par exemple :
		```wl
		// -- Code de clic du bouton permettant de valider la formule
		// Utilisation de la fonction FAAExécute
		FAAExécute(TBLR_MonTableur, faaValiderSaisieFonc)
		```

		```wl
		// -- Code de clic du bouton permettant d'annuler la formule
		// Utilisation de la fonction FAAExécute
		FAAExécute(TBLR_MonTableur, faaAnnulerSaisieFonc)
		```








**Attention** : Pour utiliser une barre de formule personnalisée, il est nécessaire de désactiver la barre de formule par défaut : 

- sous l'éditeur : option "Avec barre de saisie de formule" dans l'onglet "Détail" de la description du champ. 

- par programmation : propriété [BarreDeFormuleVisible](../Proprietes/1000021334.md).



<a name="NOTE3_3"></a>


### Personnaliser le ruban
<a name="personnaliser_ruban_ELTPARAGRAPHE000243"></a>Pour personnaliser le ruban du champ Tableur, il suffit d'utiliser des fenêtres internes spécifiques. 

Pour personnaliser le ruban : 

1. Affichez l'onglet "Détail" de la fenêtre de description du champ Tableur. 

2. Dans la zone "Barre d'outils", vérifiez que l'option "Ruban" est bien sélectionnée. 

3. Dans la zone "FI source du ruban", sélectionnez la fenêtre prédéfinie par défaut. 

4. La fenêtre "FI_WinDevFAA_BarreTableur" est automatiquement intégrée dans votre projet. Cette fenêtre interne (disponible en français et anglais) peut être modifiée selon vos besoins. Cette fenêtre contient tout le code nécessaire à la gestion du champ Tableur. Nous vous conseillons de vérifier les erreurs d'UI ainsi que le bon fonctionnement de la fenêtre après toute modification. 




Remarque : Il est également possible d'utiliser une fenêtre interne pour proposer un ruban spécifique. Vous pouvez utiliser n'importe quelle fenêtre interne de votre projet pour réaliser ce bandeau.


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampTableur.gif) ***Exemples unitaires (WINDEV)*** : **Le champ Tableur** <br>Utilisation du champ Tableur.<br>Cet exemple présente comment :<br>- charger un fichier xlsx dans un champ tableur,<br>- sauver le tableur dans un fichier,<br>- remplir le champ avec des données provenant de la base de données,<br>- insérer des lignes, des colonnes,<br>- accéder aux cellules et les manipuler (modifier leur valeur, leur style,...),<br>- saisir des formules,<br>- etc.


