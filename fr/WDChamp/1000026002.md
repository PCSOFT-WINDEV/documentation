


## Evénements associés à un champ TimeLine
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Evénements gérés par défaut
<a name="evenements_geres_par_defaut_ELTTEXTE000181"></a>
WINDEV gère par défaut les événements suivants (ordre d'apparition sous l'éditeur de code) :

| Evénement | Condition d'exécution |
| --- | --- |
| Initialisation | Exécuté à l'ouverture de la fenêtre. \* |
| Avant création de l'événement | Exécuté :<br><br>- lors de la sélection de l'option "Nouvel événement" dans le menu contextuel du champ TimeLine.<br><br>- lors de la saisie directe au clavier d'un nouvel événement.<br><br><br> |
| Entrée en saisie d'un événement | Exécuté :<br><br>- lors de la sélection de l'option "Nouvel événement" dans le menu contextuel du champ TimeLine.<br><br>- lors de la saisie directe au clavier d'un nouvel événement.<br><br><br>Cet événement est exécuté immédiatement après l'événement "Avant création de l'événement". |
| Sortie de saisie de l'événement | Exécuté lors de la sortie de la saisie d'un événement (sortie lors de l'ajout d'un événement ou lors de la modification d'un événement par le menu contextuel par exemple). |
| Sélection d'un événement | Exécuté lors de la sélection d'un événement existant dans le champ TimeLine. |
| Déplacement d'un événement | Exécuté lors du déplacement d'un événement dans le champ TimeLine. Lors d'un déplacement à la souris, cet événement est exécuté à la fin du déplacement (sur le "lâcher" de la souris). |
| Redimensionnement d'un événement | Exécuté lors du redimensionnement d'un événement dans le champ TimeLine (redimensionnement effectué à la souris par exemple). Cet événement est exécuté à la fin du redimensionnement (sur le "lâcher" de la souris). |
| Suppression d'un événement | Exécuté :<br><br>- lors de la sélection de l'option "Supprimer l'événement" dans le menu contextuel du champ TimeLine.<br><br>- lors de la suppression d'un événement effectué avec la touche SUPPR du clavier.<br><br><br> |
| Sélection d'une période | Exécuté lors de la sélection d'une plage horaire dans le champ TimeLine (clic sur une plage horaire par exemple). Lors de la sélection à la souris d'un ensemble de plages horaires, l'événement est exécuté pour chaque nouvelle plage sélectionnée. |
| Réaffectation d'un événement | Exécuté lorsque le déplacement d'un événement entraîne la modification de la piste associée à l'événement. |
| A chaque Modification | Exécuté lors du déplacement de la réglette dans le champ TimeLine. |


(\*) Par défaut, l'événement "Initialisation" de chaque champ est exécuté selon l'ordre de création des différents champs dans la fenêtre. Pour modifier cet ordre d'exécution : 

1. Sous le volet "Fenêtre", dans le groupe "Ordre", cliquez sur "Initialisation".

2. Dans la fenêtre qui s'affiche, utilisez les flèches situées sur la droite pour modifier l'ordre d'initialisation des champs.






## Evénements avec procédures
<a name="evenements_avec_procedures_ELTTEXTE000205"></a>
Pour simplifier la manipulation des événements d'un champ TimeLine, des procédures sont proposées dans chaque événement. Ces procédures prennent en paramètre directement la variable de type [EvénementTimeline](../WDLang1/1000020612.md) à manipuler. Toutes les informations de l'événement manipulé par le menu contextuel sont automatiquement affectées à cette variable. 

**Exemple** : Pour mémoriser dans un fichier de données EVT, un événement que l'utilisateur ajoute via le menu contextuel, il suffit de saisir le code suivant dans l'événement "Sortie de saisie de l'événement" : 

```wl
PROCEDURE SortieDeSaisie(evtModifie est un EvénementTimeline)

// Mémorisation des données
EVT.Titre = evtModifie.Titre
EVT.EvtDébut = evtModifie.Début
EVT.EvtFin = evtModifie.Fin
...
HAjoute(EVT)
```



### Utilisation avancée des événements avec procédure
<a name="utilisation_avancee_des_evenements_avec_procedure_ELTPARAGRAPHE000102"></a>Il est également possible de proposer à l'utilisateur de définir plus précisément les caractéristiques de son événement lors d'un ajout ou d'une modification. Il suffit pour cela de créer une fenêtre avec les informations à remplir. 

Dans le code, il suffit d'ouvrir la fenêtre par exemple dans l'événement "Entrée en saisie d'un événement". Pour bloquer la saisie directe par le menu contextuel du champ TimeLine, l'événement doit alors renvoyer <u><u><u><u>Faux</u></u></u></u>. 

Ce principe peut être appliqué à tous les événements appelés par le menu contextuel du champ TimeLine.

Exemple : 

```wl
PROCEDURE Edition(evtEdité est un EvénementTimeline)

// Ouvre la fenêtre de saisie d'un événement 
// avec l'événement sélectionné (en mode Création ou Modification)
Ouvre(FEN_SaisieEVT_HFSQL, evtEdité)

// Renvoie FAUX pour bloquer la saisie directe dans le champ TimeLine 
RENVOYER Faux
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Evénements optionnels
<a name="evenements_optionnels_ELTTEXTE000235"></a>
Plusieurs événements optionnels peuvent être gérés.
Pour ajouter un événement optionnel :

1. Sélectionnez le champ voulu.

2. Affichez la fenêtre de code de ce champ (touche F2).

3. Cliquez sur le lien "Ajouter d'autres événements à xxx" situé à la fin de la fenêtre de code, après le dernier événement.  ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Traitements_optionnels_WD_OK%20-%20HC%20N%B0001.gif)


4. La totalité des événements optionnels disponibles pour le champ est affichée. 

5. Cochez l'événement optionnel à ajouter et validez. 
	Remarque : Il est possible de sélectionner plusieurs événements optionnels. 

6. L'événement optionnel sélectionné est automatiquement ajouté dans les événements gérés par le champ.




Pour désactiver un événement optionnel, il suffit d'effectuer les mêmes manipulations pour afficher la liste des événements optionnels. Il suffit ensuite de décocher les événements optionnels à supprimer. 
Remarque : Si le code désactivé contient du code WLangage, ce code est automatiquement supprimé.Il est ainsi possible de gérer par exemple :

- le survol du champ par la souris,

- le bouton gauche enfoncé, relâché, avec un double-clic,

- le bouton droit enfoncé, relâché, avec double-clic,

- la roulette de la souris, ...




Pour plus de détails, consultez les [Evénements optionnels](../WDChamp/1014004.md).


