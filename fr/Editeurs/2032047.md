


## Création d'une requête de suppression 
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000152"></a>
<a name="Requete_Suppression"></a>
Une **requête de suppression** (instruction SQL correspondante [DELETE](../Editeurs/2034001.md)) permet de supprimer des enregistrements d'un fichier présent dans une base de données.

Pour effectuer cette suppression, les principales caractéristiques de la requête de suppression sont les suivantes :

- le fichier de données dans lequel des données vont être supprimées.

- les conditions de sélection des enregistrements à supprimer (clients habitant Nantes, produits dont le prix est supérieur à 40 Euros, etc.).




Pour plus de détails sur les conditions de sélection d'une requête, consultez [Conditions de sélection d'une requête](../Editeurs/2032019.md).

Par exemple, suppression des commandes passées avant le 1er Janvier 2010 :<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Requete_RequeteSuppression.gif)
L'éditeur de requêtes génère automatiquement le code SQL de cette requête. 

**Pour visualiser le code SQL d'une requête** : 

1. Affichez le menu contextuel du graphe de la requête.

2. Sélectionnez l'option "Code SQL".




Vous pouvez également utiliser la touche F2. 

```sql
DELETE FROM 
	COMMANDE
WHERE 
	COMMANDE.DateCommande < '20100101'
```
|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png) | Important | [Le logiciel Etats & Requêtes](../Presentation/3088004.md) ne permet pas de créer des requêtes de suppression. |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000194"></a>
Pour créer une nouvelle requête de suppression :

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif) parmi les boutons d'accès rapide. 

	- La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Requête".

	- L'assistant de création d'une requête se lance.




2. Choisissez de créer une requête de suppression avec l'assistant (option "Suppression (DELETE)").

3. Si votre projet n'est pas lié à une analyse, spécifiez l'analyse à laquelle la requête doit être rattachée.

4. Passez à l'étape suivante de l'assistant.

5. Sélectionnez le fichier de données dans lequel des données vont être supprimées.
	Passez à l'étape suivante.

6. Définissez les conditions de sélection en cliquant sur la colonne "Condition" des rubriques concernées. Pour plus de détails sur les conditions de sélection d'une requête, consultez [Conditions de sélection d'une requête](../Editeurs/2032019.md).
	Passez à l'étape suivante.

7. Précisez si nécessaire l'enchaînement des conditions de sélection avec les opérateurs conditionnels ET et OU :

	- *Opérateur conditionnel ET* : les enregistrements conservés auront répondu aux deux conditions. Par exemple, la requête sélectionne les clients dont le nom commence par la lettre "A" ET habitant à Nantes.

	- *Opérateur conditionnel OU* : les enregistrements conservés auront répondu à une des deux conditions ou aux deux conditions. Par exemple, la requête sélectionne les clients habitant à Toulouse OU habitant à Brest.
			Passez à l'étape suivante.




8. Saisissez le nom de la requête (nom du fichier ".WDR" correspondant à la requête). Ce nom permettra d'identifier la requête dans vos programmes.

9. Spécifiez le libellé de la requête en décrivant succinctement le rôle de la requête. Ce libellé sera utilisé dans le dossier du projet.

10. Validez la description de la requête. La représentation graphique de la requête s'affiche automatiquement sous l'éditeur de requêtes.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Notes
<a name="notes_ELTTEXTE000218"></a>


- Pour modifier l'ensemble des caractéristiques d'une requête : sous le volet "Requête", dans le groupe "Edition", cliquez sur "Description". Pour plus de détails, consultez [Description d'une requête](../Editeurs/2032038.md).

- Pour générer le code SQL correspondant à cette requête, sélectionnez l'option "Code SQL" du menu contextuel de la requête. Si des modifications sont effectuées dans la description de la requête, ces modifications seront automatiquement répercutées dans le code SQL correspondant.

- Il est également possible de créer une requête à partir d'un ou de plusieurs fichiers de données décrits sous l'éditeur d'analyses : il suffit de faire un "Drag and Drop" du ou des fichiers de données sélectionnés dans le volet "Analyse" vers l'éditeur de requêtes.

- Il est possible de tester la requête créée directement depuis l'éditeur de requêtes. Pour plus de détails, consultez [Tester une requête](../Editeurs/2019011.md). 





