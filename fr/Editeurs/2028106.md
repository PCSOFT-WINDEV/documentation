


## WDInst : Personnaliser le programme d'installation
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000255"></a>
Par défaut, l'éditeur d'installation WDInst propose un programme d'installation standard.

Il est possible de personnaliser cet installeur pour proposer une installation personnalisée. 

Cette personnalisation est disponible : 

- pour les installations autonomes : installation standard, installation compacte ou installation par package MSI. 

- pour les installations avec mise à jour automatique (Live Update). 




Pour personnaliser l'installeur utilisé sous WDInst, sélectionnez l'option "Paramètres de l'installation .. Options de l'installeur". 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Choix du type d'installeur à utiliser
<a name="choix_type_installeur_utiliser_ELTTEXTE000279"></a>
La fenêtre des options de l'installeur permet de choisir le type d'installeur à utiliser : 

- installeur standard.

- installeur MSI.

- installeur compact. 

- installeur personnalisé. 

- pas d'installeur. 




La sélection du type d'installeur est réalisée par le lien "Changer" présent dans le titre de la fenêtre.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Installeur standard ou personnalisé
<a name="installeur_standard_personnalise_ELTTEXTE000303"></a>


### Installeur standard
<a name="installeur_standard_ELTPARAGRAPHE000044"></a>L'installeur standard est l'installeur fourni par défaut avec WINDEV pour installer les applications WINDEV. 

L**'onglet "Framework WINDEV"** permet de spécifier le mode de gestion du framework de l'installeur. Il est possible de : 

- copier le framework WINDEV avec l'installation. Dans ce cas, la taille du programme d'installation pourra être relativement importante. Il sera possible de personnaliser l'installeur (onglet "Personnalisation de l'installeur"). 

- télécharger le framework WINDEV depuis un serveur FTP. Dans ce cas, l'utilisateur devra avoir un accès à Internet. Si cette option est sélectionnée, l'onglet "Paramètres FTP" permet de configurer le téléchargement du framework. 

- utiliser le framework WINDEV présent sur le poste de l'utilisateur. Dans ce cas, le téléchargement du framework sera déclenché uniquement si le framework WINDEV n'est pas trouvé sur le poste d'installation. 




Cet onglet permet également de gérer le nettoyage des anciens frameworks. L'option "Supprimer les anciens frameworks présents dans le répertoire de destination" permet de supprimer toutes les anciennes versions du framework WINDEV présent dans le ou les répertoires d'installation.

L**'onglet "UAC"** permet de spécifier si l'installeur nécessite l'UAC ou non. 

L**'onglet "Plug-in"** permet d'indiquer le chemin du plug-in à inclure dans le programme d'installation standard. Pour plus de détails, consultez [Personnaliser le programme d'installation (Plug-in)](../Editeurs/2028109.md). 

L**'onglet "Polices"** permet d'indiquer les polices de caractères à déployer et à installer sur le poste client. Vous pouvez ajouter les fichiers TTF ou OTF correspondant aux polices à installer.
Remarque : Veuillez vérifier que vous possédez bien le droit de diffuser ces polices.


### Installeur personnalisé : cas d'une installation individuelle
<a name="installeur_personnalise_cas_une_installation_individuelle_ELTPARAGRAPHE000076"></a>Le programme d'installation standard (appelé "WDSetup") est fourni avec les exemples de WINDEV. Si vous voulez personnaliser le programme d'installation, il suffit de modifier le projet "WDSetup".

**Remarque** : Si vous utilisez un programme d'installation personnalisé (projet "WDSetup" personnalisé), il est nécessaire de conserver le fichier ".WXF" pour tester ce programme d'installation personnalisé. Pour plus de détails, consultez le [fichier ".WXF"](../Editeurs/2028055.md).

Pour personnaliser le programme d'installation (sous WINDEV) : 

1. Ouvrez le projet "WDSetup". 
	Par défaut, ce projet est présent dans le sous-répertoire "Exemples" du répertoire d'installation de WINDEV.
	Remarque : Cet exemple est également disponible dans les "Exemples complets" affichés dans la page d'accueil de WINDEV (Ctrl + &lt;).

2. Personnalisez ce projet (modification de l'aspect des fenêtres, gestion de langues supplémentaires, ...).

3. Créez un nouvel exécutable : cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_generation_exe.gif) parmi les boutons d'accès rapide.


**Remarque** : Le nom de cet exécutable n'a pas d'importance.

Pour utiliser un programme d'installation personnalisé (sous WDInst) : 

1. Sélectionnez l'option "Paramètres de l'installation .. Options de l'installeur".

2. Sélectionnez l'option "Installateur standard" (si nécessaire grâce au lien "Changer").

3. Dans l'onglet "Framework WINDEV", sélectionnez "Copiez le framework WINDEV avec l'installation".

4. Dans l'onglet "Personnalisation de l'installeur", sélectionnez l'option "Utiliser un installeur personnalisé" et sélectionnez l'exécutable du programme d'installation personnalisé.

5. Dans l'onglet "DLL de l'installeur", sélectionnez les librairies (fichiers ".DLL") associées au programme d'installation personnalisé.




**Remarque** : Ces librairies (fichiers ".DLL") sont présentes dans le sous-répertoire "EXE" du projet d'installation personnalisé.


### Installation personnalisée : cas d'une installation avec mise à jour réseau
<a name="installation_personnalisee_cas_une_installation_avec_mise_jour_reseau_ELTPARAGRAPHE000112"></a>Par défaut, le programme d'installation standard est utilisé pour réaliser l'installation de référence et l'installation de l'application cliente. 

Il est désormais possible d'utiliser un installeur différent pour l'installation de référence et l'installation de l'application cliente. 

Rappel : 

- L'application de l'installeur (appelé "WDSetup") est fourni avec les exemples de WINDEV. Si vous voulez personnaliser le programme d'installation, il suffit de modifier le projet "WDSetup".

- Si vous utilisez un programme d'installation personnalisé (projet "WDSetup" personnalisé), il est nécessaire de conserver le fichier ".WXF" pour tester ce programme d'installation personnalisé. Pour plus de détails, consultez le [fichier ".WXF"](../Editeurs/2028055.md).




Pour personnaliser le programme d'installation (sous WINDEV) : 

1. Ouvrez le projet "WDSetup". 
	Par défaut, ce projet est présent dans le sous-répertoire "Exemples" du répertoire d'installation de WINDEV.
	Remarque : Cet exemple est également disponible dans les "Exemples complets" affichés dans la page d'accueil.

2. Personnalisez ce projet (modification de l'aspect des fenêtres, gestion de langues supplémentaires, ...).

3. Créez un nouvel exécutable : cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_generation_exe.gif) parmi les boutons d'accès rapide.


**Remarque** : Le nom de cet exécutable n'a pas d'importance.

Pour utiliser un programme d'installation personnalisé pour une application avec mise à jour réseau (sous WDInst) : 

1. Sélectionnez l'option "Paramètres de l'installation .. Options de l'installeur".

2. Sélectionnez l'option "Installateur standard" (si nécessaire grâce au lien "Changer"). 

3. Dans l'onglet "Framework WINDEV", sélectionnez "Copier le framework WINDEV avec l'installation".

4. Dans l'onglet "Personnalisation 
de l'installeur", il est possible de : 

	- personnaliser ou non l'installeur de l'application cliente. Pour personnaliser l'installeur, sélectionnez l'option "Utiliser un installeur personnalisé" et sélectionnez l'exécutable du programme d'installation personnalisé.

	- personnaliser ou non l'installeur de référence. Pour personnaliser l'installeur, sélectionnez l'option "Utiliser un installeur personnalisé" et sélectionnez l'exécutable du programme d'installation personnalisé. 
			 Attention : il est nécessaire d'utiliser un installeur standard pour déployer une installation de référence dans le Cloud des applications PC SOFT. 




5. Dans l'onglet "DLL de l'installeur", sélectionnez les librairies (fichiers ".DLL") associées au programme d'installation personnalisé.


**Remarque** : Ces librairies (fichiers ".DLL") sont présentes dans le sous-répertoire "EXE" du projet d'installation personnalisé.


### Gestion de l'UAC
<a name="gestion_uac_ELTPARAGRAPHE000166"></a>Par défaut, l'installation d'une application WINDEV déclenche l'UAC. 

L'onglet " UAC" permet de modifier ce mode de fonctionnement : 

- pour les installations individuelles : l'UAC est désactivée pour l'installation sur le poste de l'utilisateur final. 

- pour les installations réseau avec mise à jour automatique. Dans ce cas, l'UAC peut être désactivée : 

	- pour l'installeur de l'utilisateur final, 

	- pour l'installeur de la version de référence, 

	- pour les deux. 







Attention : L'option "L'installeur NE nécessite PAS les droits administrateur" entraîne certaines restrictions : pas d'installation de fichiers dans les répertoires systèmes (Program Files, Windows, ...), pas de modifications des fichiers et paramètres systèmes (win.ini, path, ...). 

L'installation échouera si les droits ne sont pas suffisants. Dans la mesure du possible, l'assistant d'installation guidera l'utilisateur dans ses choix pour lui permettre d'installer l'application. 

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Installeur MSI
<a name="installeur_msi_ELTTEXTE000345"></a>
Pour personnaliser un programme d'installation MSI (sous WDInst) : 

1. Sélectionnez l'option "Paramètres de l'installation .. Options de l'installeur".

2. Sélectionnez l'option "Service Windows Installer (.msi)" (si nécessaire grâce au lien "Changer").

3. Dans l'onglet "Propriétés du produit installé", indiquez les propriétés de l'application à installer. 

4. Dans l'onglet "Propriétés du fichier MSI", indiquez les propriétés du fichier MSI qui sera généré. 




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Installeur compact
<a name="installeur_compact_ELTTEXTE000369"></a>
Pour personnaliser un programme d'installation compact (sous WDInst) : 

1. Sélectionnez l'option "Paramètres de l'installation .. Options de l'installeur".

2. Sélectionnez l'option "Installeur compact" (si nécessaire grâce au lien "Changer").

3. Le bouton "Traduction des messages de l'installeur compact" permet de personnaliser l'installeur en fournissant les traductions des messages affichés lors de l'installation. 





