


## WDInst : Configurer le poste d'installation 
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000344"></a>
Lors de la création du programme d'installation, l'éditeur d'installation WDInst permet de configurer le poste sur lequel le programme va être installé. Il est possible de :

- Proposer l'exécution d'un programme à la fin de l'installation (avec ou sans ligne de commande).

- Modifier la base de registre :

	- modifier l'identifiant utilisé pour la désinstallation de l'application,

	- modifier ou créer des entrées.




- Modifier ou créer le fichier "AutoExec.BAT".

- Modifier ou créer des fichiers ".INI".




Par défaut, le programme d'installation proposera de lancer le programme à la fin de l'installation et aucune modification ne sera effectuée sur les postes utilisateurs.

La configuration du poste d'installation est réalisée sous l'éditeur d'installation WDInst. Pour lancer WDInst, sous le volet "Outils", dans le groupe "Utilitaires", cliquez sur "WDInst".

L'assistant de création du programme d'installation permet également de configurer le poste d'installation.

**Remarque** : Pour demander à l'utilisateur de confirmer les différentes modifications effectuées sur le système lors de l'installation de l'application :

1. Lancez WDInst si ce n'est pas déjà fait : sous le volet "Outils", dans le groupe "Utilitaires", cliquez sur "WDInst".

2. Sélectionnez l'option "Paramètres de l'installation .. Configuration du système".

3. Cochez l'option "Demander confirmation avant modification".




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Proposer l'exécution d'un programme
<a name="proposer_execution_programme_ELTTEXTE000368"></a>
Par défaut, le programme d'installation propose le lancement de l'exécutable de l'application à la fin de l'installation. L'option "Lancer le programme" est cochée. En cliquant sur le bouton "Terminer", l'exécutable est automatiquement lancé.

L'éditeur d'installation WDInst permet de :

- Spécifier l'exécutable à lancer et d'associer des paramètres à cet exécutable. Seul un exécutable (fichier ".EXE") présent dans la liste des fichiers à installer peut être lancé.

- Ne pas proposer le lancement de l'exécutable de l'application à la fin de l'installation.




**Remarque** : Si des modifications sont effectuées dans le fichier "AutoExec.BAT", il est conseillé de ne pas exécuter de programme à la fin de l'installation. En effet, les modifications apportées dans ce fichier seront prises en compte uniquement au prochain démarrage de l'ordinateur.
<a name="NOTE2_2"></a>


### Spécifier l'exécutable à lancer et associer des paramètres à cet exécutable
<a name="specifier_executable_lancer_associer_des_parametres_cet_executable_ELTPARAGRAPHE000078"></a>Pour spécifier l'exécutable à lancer et associer des paramètres à cet exécutable : 

1. Sélectionnez l'option "Paramètres de l'installation .. Fin de l'installation".

2. Saisissez l'exécutable à exécuter à la fin de l'installation de l'application (option "Ligne de commande").
	L'exécutable à lancer correspond :

	- Au nom et au chemin complet du fichier exécutable. Il est possible d'utiliser les mots-clés suivants :

		- **- &lt;RepInst&gt;** : répertoire d'installation choisi par l'utilisateur lors de l'installation.

		- **- &lt;LectInst&gt;** : lecteur du répertoire d'installation choisi par l'utilisateur lors de l'installation.

		- **- &lt;FicInst&gt;** : répertoire d'installation des fichiers de données. L'éditeur d'installation WDInst permet de paramétrer ce répertoire. 
						Pour plus de détails, consultez [Paramétrer le répertoire des fichiers de données](../Editeurs/2028017.md).

		- **- &lt;RepWin&gt;** : répertoire de Windows des postes utilisateurs.




- Aux paramètres d'exécution du programme installé (si nécessaire).
			Par exemple : "&lt;RepInst&gt;\\MonAppli.EXE /Param".



<a name="NOTE2_3"></a>


### Ne pas proposer le lancement de l'exécution de l'application à la fin de l'installation
<a name="pas_proposer_lancement_execution_application_fin_installation_ELTPARAGRAPHE000105"></a>Pour ne pas proposer le lancement de l'exécution de l'application à la fin de l'installation : 

1. Sélectionnez l'option "Paramètres de l'installation .. Fin de l'installation".

2. Effacez le contenu de l'option "Ligne de commande".




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Modifier l'identifiant utilisé pour la désinstallation de l'application
<a name="modifier_identifiant_utilise_pour_desinstallation_application_ELTTEXTE000404"></a>
Si vous avez choisi de permettre la désinstallation de l'application, un identifiant spécifique est automatiquement créé dans la base de registre. Cet identifiant peut être modifié grâce à l'éditeur d'installation WDInst.

Par défaut, cet identifiant est "&lt;NomApplicationSansEspace&gt;". Par exemple, "WDClient" pour l'application "WD Client". Cet identifiant peut contenir ou non des espaces.

Cet identifiant sera créé dans la clé :

- "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall" sous Windows 2000 et NT

- "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall" sous Windows 98 et Me.



<a name="NOTE3_2"></a>


### Modifier l'identifiant utilisé pour la désinstallation de l'application
<a name="modifier_identifiant_utilise_pour_desinstallation_application_ELTPARAGRAPHE000129"></a>Pour modifier l'identifiant utilisé pour la désinstallation de l'application : 

1. Sélectionnez l'option "Paramètres de l'installation .. Fin de l'installation".

2. Saisissez le nouvel identifiant de l'application.




**Remarque** : Cet identifiant peut contenir ou non des espaces.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Modifier ou créer le fichier "AutoExec.BAT"
<a name="modifier_creer_fichier_autoexecbat_ELTTEXTE000434"></a>
Il est possible de modifier ou de créer le fichier "AutoExec.BAT" sur les postes d'installation. Ce fichier sera modifié ou créé (si nécessaire) au prochain démarrage de l'ordinateur. Dans ce cas, le redémarrage de l'ordinateur est automatiquement proposé à la fin de l'installation de l'application.

Le fichier "AutoExec.BAT" permet par exemple :

- d'ajouter le répertoire de l'exécutable de l'application dans le PATH,

- de lancer l'application au démarrage du poste d'installation,

- etc.




**Rappels** :

- Le fichier "AutoExec.BAT" s'exécute automatiquement au démarrage de l'ordinateur.

- Le PATH liste les répertoires dans lesquels les exécutables (fichiers ".EXE") et les librairies (fichiers ".DLL") sont recherchés en priorité.



<a name="NOTE4_2"></a>


### Modifier ou créer le fichier "AutoExec.BAT"
<a name="modifier_creer_fichier_autoexecbat_ELTPARAGRAPHE000159"></a>Pour modifier ou créer le fichier "AutoExec.BAT" : 

1. Sélectionnez l'option "Paramètres de l'installation .. Configuration du système".

2. Saisissez la ligne de commande à ajouter ou à modifier dans le fichier "AutoExec.BAT".

3. Spécifiez l'emplacement de la "ligne de commande" correspondante dans le fichier "AutoExec.BAT" (combo "Emplacement") :

	- ***Au début***. Correspond à la première "ligne de commande" du fichier "AutoExec.BAT".

	- ***A la fin***. Correspond à la dernière "ligne de commande" du fichier "AutoExec.BAT".

	- ***Après le PATH***. En positionnant une "ligne de commande" après le PATH, l'exécutable et/ou les librairies utilisés dans cette ligne de commande seront recherchés dans les répertoires du PATH.




4. Dans le cas où la même ligne de commande existe déjà dans le fichier "AutoExec.BAT", il est possible :

	- Soit de remplacer la ligne de commande existante. Sélectionnez le paramètre "Remplacement" (combo "Type").

	- Soit d'ajouter la ligne de commande. Sélectionnez le paramètre "Ajout" (combo "Type").







**Remarque** : Pour ajouter directement le répertoire d'installation de l'application dans le PATH, utilisez les boutons :

- "Au début". Le répertoire d'installation de l'application sera le **premier** répertoire du PATH.

- "A la fin". Le répertoire d'installation de l'application sera le **dernier** répertoire du PATH.




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Modifier ou créer des fichiers ".INI"
<a name="modifier_creer_des_fichiers_ini_ELTTEXTE000464"></a>
Lors de l'installation d'une application WINDEV, il est possible de modifier ou de créer des fichiers ".INI" sur les postes d'installation. Ces fichiers seront associés à l'application installée.

Les fichiers ".INI" permettent par exemple de :

- Personnaliser l'application selon l'utilisateur connecté

- Définir les paramètres par défaut de l'application




Les fichiers ".INI" pourront ensuite être lus et modifiés directement depuis l'application (fonctions [INILit](../WDLang1/3013043.md) et [INIEcrit](../WDLang1/3013039.md) du WLangage).
<a name="NOTE5_2"></a>
Par exemple, pour enregistrer la langue d'exécution du programme d'installation dans le fichier "MonAppli.INI" (présent dans le répertoire d'installation de l'application) :

- Fichier ".INI" : &lt;RepInst&gt;\\MonAppli.INI

- Section : LANGUE

- Paramètre : LANGUE_INSTALL

- Valeur : &lt;Langue&gt;




Le mot-clé **&lt;Langue&gt;** sera automatiquement remplacé lors de l'installation par le numéro de la langue d'exécution du programme d'installation (ce numéro est utilisable avec la fonction [Nation](../WDLang1/3054014.md)).

Dans notre exemple, si le numéro de la langue d'exécution est 3, le paramètre suivant sera ajouté dans le fichier "MonAppli.INI" :

```txt
[LANGUE]
LANGUE_INSTALL=3
```

<a name="NOTE5_3"></a>


### Modifier ou créer des fichiers ".INI" lors de l'installation
<a name="modifier_creer_des_fichiers_ini_lors_installation_ELTPARAGRAPHE000221"></a>Pour modifier ou créer des fichiers ".INI" lors de l'installation : 

1. Sélectionnez l'option "Paramètres de l'installation .. Configuration du système".

2. Spécifiez le fichier ".INI" considéré. Ce fichier sera créé si nécessaire. Vous pouvez indiquer :

	- Le nom et le chemin complet du fichier.
			Il est possible d'utiliser les mots-clés suivants :

		- **&lt;RepInst&gt;** : répertoire d'installation choisi par l'utilisateur lors de l'installation.

		- **&lt;LectInst&gt;** : lecteur du répertoire d'installation choisi par l'utilisateur lors de l'installation.

		- **&lt;FicInst&gt;** : répertoire d'installation des fichiers de données. L'éditeur d'installation WDInst permet de paramétrer ce répertoire. Pour plus de détails, consultez [Paramétrer le répertoire des fichiers de données](../Editeurs/2028017.md).

		- **&lt;RepWin&gt;** : répertoire de Windows des postes utilisateurs.
						Par exemple : "&lt;RepInst&gt;\\MonRépertoire\\MonFichier.INI".




- Le nom du fichier. Le fichier sera recherché ou créé dans le répertoire de Windows. Par exemple : "MonFichier.INI".

- Aucun fichier. Le fichier "WIN.INI" sera modifié.

3. Spécifiez la section à modifier ou à créer.

4. Spécifiez le paramètre à modifier ou à créer.

5. Spécifiez la valeur du paramètre.
	Pour récupérer le numéro de la langue d'exécution du programme d'installation, utilisez le mot-clé **&lt;Langue&gt;**.




<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Modifier ou créer des entrées dans la base de registre
<a name="modifier_creer_des_entrees_dans_base_registre_ELTTEXTE000500"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000254"></a>Lors de l'installation d'une application WINDEV, il est possible de modifier ou de créer des entrées dans la base de registre.

La base de registre permet par exemple de :

- Personnaliser l'application selon l'utilisateur connecté

- Définir les paramètres par défaut de l'application




La base de registre pourra ensuite être lue et modifiée directement depuis l'application (fonctions [RegistreEcrit](../WDLang1/3065006.md), [RegistreLit](../WDLang1/3065012.md) , ...).
<a name="NOTE6_2"></a>
Par exemple, pour enregistrer dans la base de registre la langue d'exécution du programme d'installation, saisissez :

- Clé : HKEY_LOCAL_MACHINE\\Software\\MaSociété\\MonAppli\\1.0\\

- Nom : Langue

- Valeur : &lt;Langue&gt;




Le mot-clé **&lt;Langue&gt;** sera automatiquement remplacé lors de l'installation par le numéro de la langue d'exécution du programme d'installation (ce numéro est utilisable avec la fonction [Nation](../WDLang1/3054014.md)).
<a name="NOTE6_3"></a>


### Modifier ou créer des entrées dans la base de registre lors de l'installation
<a name="modifier_creer_des_entrees_dans_base_registre_lors_installation_ELTPARAGRAPHE000288"></a>Pour modifier ou créer des entrées dans la base de registre lors de l'installation : 

1. Sélectionnez l'option "Paramètres de l'installation .. Configuration du système".

2. Spécifiez la clé considérée (chemin complet). Cette clé sera créée si nécessaire.

3. Spécifiez le nom de la valeur à modifier. Cette valeur sera créée si nécessaire.

4. Spécifiez la nouvelle valeur. 
	Pour récupérer le numéro de la langue d'exécution du programme d'installation, utilisez le mot-clé **&lt;Langue&gt;**.





