
## Visibilité des éléments d'un composant externe
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000162"></a>
Lors de la création d'un composant externe, il est possible de définir les éléments du composant externe qui seront accessibles ou non par l'utilisateur du composant.

- Si l'élément est accessible, l'utilisateur du composant verra cet élément dans la liste des éléments du projet. Il pourra manipuler cet élément par programmation (comme s'il s'agissait d'un élément créé dans son projet). 
	Remarque : Le code de cet élément n'est cependant pas visible.

- Si l'élément n'est pas accessible, l'utilisateur ne saura même pas que cet élément existe.




**Attention** : selon le mode de déclaration des éléments du projet (classe, collection de procédures, ...), les éléments accessibles ou non peuvent varier. Le tableau ci-dessous récapitule les différentes façons d'accéder à un élément en fonction de son mode de déclaration.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Tableau récapitulatif des éléments et des options de visibilité
<a name="tableau_recapitulatif_des_elements_des_options_visibilite_ELTTEXTE000186"></a>


| Élément | Non accessible | Accessible |
| --- | --- | --- |
| Classe | Aucun accès à la classe, à ses membres ou à ses méthodes | La syntaxe utilisée pour accéder à la classe, à ses membres ou à ses méthodes doit être conforme à la syntaxe de la POO dans WINDEV. |
|   |   | Si le membre ou la méthode est public (cas par défaut) dans le composant, le membre ou la méthode seront publics dans le projet utilisant le composant.<br><br>Si le membre ou la méthode est protégé dans le composant, le membre ou la méthode seront protégés dans le projet utilisant le composant.<br><br>Si le membre ou la méthode est privé dans le composant, le membre ou la méthode ne seront pas accessibles dans le projet utilisant le composant. |
| Fenêtre | Aucun accès à la fenêtre | Les variables globales de la fenêtre ne peuvent pas être manipulées. Si ces variables doivent être manipulées, il est nécessaire d'inclure dans le composant des procédures permettant de lire ou de modifier les variables globales de la fenêtre. |
|   |   | Si ces procédures sont sans attribut d'accès dans le composant, ces procédures seront invisibles dans le projet utilisant le composant.<br><br>Si ces procédures sont publiques dans le composant, ces procédures seront publiques dans le projet utilisant le composant.<br><br>Si ces procédures sont privées dans le composant, ces procédures ne seront pas accessibles dans le projet utilisant le composant. |
| Collection de procédures | Aucun accès aux procédures | Les variables globales de la collection de procédures ne peuvent pas être manipulées. Si ces variables doivent être manipulées, il est nécessaire d'inclure dans le composant des procédures permettant de lire ou de modifier les variables globales de la collection de procédures. |
|   |   | Si la procédure est sans attribut d'accès dans le composant, cette procédure est invisible dans le projet utilisant le composant.<br><br>Si la procédure est publique dans le composant, la procédure sera publique dans le projet utilisant le composant.<br><br>Si la procédure est privée dans le composant, la procédure ne sera pas accessible dans le projet utilisant le composant. |
| Projet (fichier WDP, WWP ou WPP) | Le projet peut être intégré ou non au composant. Il n'est pas possible de définir des options de visibilité. Le projet sera toujours invisible.<br><br>Si le projet est intégré au composant, le code d'initialisation du projet et de fermeture du projet seront automatiquement exécutés au chargement / déchargement du composant.<br><br>Attention : si l'analyse intégrée au composant est protégée par un mot de passe, il est nécessaire d'intégrer le projet au composant pour spécifier ce mot de passe. |
| Analyse | L'analyse peut être intégrée ou non au composant. Il n'est pas possible de définir des options de visibilité. L'analyse sera toujours invisible.<br><br>Attention : si une analyse est intégrée dans le composant et si un mot de passe a été défini pour cette analyse, il est nécessaire d'intégrer le projet au composant. |
| Requête | Les requêtes peuvent être intégrées ou non au composant. Il n'est pas possible de définir des options de visibilité. Les requêtes seront toujours invisibles. |


**Remarque** : Par défaut, les éléments d'un composant utilisent un [contexte HFSQL indépendant](../WDChamp/1010029.md).


<a name="NOTE2_2"></a>


### Comment utiliser une variable globale depuis un composant
<a name="comment_utiliser_une_variable_globale_depuis_composant_ELTPARAGRAPHE000106"></a>Le but du composant étant généralement d'être autonome, il n'est pas recommandé d'utiliser une variable globale du projet depuis celui-ci.

La méthode recommandée est cependant la suivante :

- créez une variable globale dans le composant.

- créez dans le composant une procédure permettant d'initialiser cette variable globale.

- depuis le code d'initialisation du projet, et à chaque modification de la valeur des variables globales du projet, appelez cette procédure pour affecter une valeur similaire aux variables globales du composant.







