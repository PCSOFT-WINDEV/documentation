
## Créer un assemblage .NET à nom fort
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000087"></a>
Avant de créer un assemblage .NET, tous les éléments nécessaires à cet assemblage doivent avoir été développés dans un projet WINDEV.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Créer un assemblage .NET à nom fort à partir d'un projet WINDEV
<a name="creer_assemblage_net_nom_fort_partir_projet_windev_ELTTEXTE000111"></a>
Pour créer un assemblage .NET à nom fort : 

1. Créez un fichier ".snk".

	- Le fichier snk contient le couple "clé publique/clé privé" utilisé pour signer numériquement les assemblages créés par une entreprise. Généralement, le même fichier snk est utilisé pour signer tous les produits d'une entreprise.

	- Ce fichier doit évidement être gardé secret pour éviter qu'une tierce personne ne puisse signer ses propres assemblages avec la même signature.

	- Pour générer un fichier ".snk", il est nécessaire d'utiliser le générateur livré avec le SDK .NET (fichier sn.exe). La ligne de commande à utiliser pour générer un fichier snk est la suivante : "sn.exe -k MonFichierSNK.snk"

	- Un fichier exemple est fourni avec WINDEV, dans le répertoire "Programmes\\Donnees\\Exemple.snk" du répertoire d'installation de WINDEV. Ce fichier permet de tester la génération d'assemblage à nom fort.
			Remarque : ce fichier étant diffusé avec WINDEV, il ne permet pas d'identifier de manière unique les assemblages que vous générerez.




2. Dans l'assistant de génération d'assemblage .NET, spécifiez l'emplacement du fichier snk précédemment créé.

3. L'assemblage à nom fort peut être copié dans le répertoire C:\\Windows\\assembly (également appelé GAC).




Remarques : 

- Si vous utilisez une version 2.0 du framework pour compiler votre assemblage, WINDEV ne crée pas de liens entre l'assemblage généré et les DLLs nécessaires à son exécution. Ces DLLs ne seront donc pas copiées avec l'assemblage dans le répertoire GAC. Ces DLLs doivent être placées dans un répertoire accessible par le PATH.

- A partir de Windows Vista, si l'UAC est activé, vous pouvez obtenir une erreur du type "Accès refusé" lors de la copie dans le répertoire "c:\\Windows\\Assembly". Dans ce cas : 

	- lancez le programme "Invite de commande" (cmd.exe) en tant qu'administrateur. 

	- utilisez l'utilitaire "gacutil". Exemple : *gacutil.exe -I "c:\\Mes Projets\\Mon Projet\\Exe\\MonAssemblage.dll"*




- Si ces DLLs sont copiées, il est conseillé de copier la DLL wdxxxnet.dll également dans le GAC.







