
## Rubriques de type Enumération et Combinaison
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000219"></a>
WINDEV, WEBDEV et WINDEV Mobile mettent à votre disposition les types de variable [Enumération](../Motscles/1514067.md) et [Combinaison](../Motscles/1514074.md). Ces types permettent de gérer des ensembles de valeurs. 

Cette page d'aide vous présente : 

- [Comment créer une rubrique Enumération et Combinaison sous l'éditeur d'analyses](#NOTE2). 

- [Comment convertir une rubrique existante vers le type Enumération ou Combinaison](#NOTE3).




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Création de rubriques de type Enumération et Combinaison sous l'éditeur d'analyses
<a name="creation_rubriques_type_enumeration_combinaison_sous_editeur_analyses_ELTTEXTE000243"></a>


### Création d'une rubrique de type Enumération
<a name="creation_une_rubrique_type_enumeration_ELTPARAGRAPHE000031"></a>Pour créer une rubrique de type Enumération :

1. Créez une nouvelle rubrique dans la fenêtre de description des rubriques du fichier de données (option "Description des rubriques" du menu contextuel du fichier sous l'éditeur d'analyses). 

2. Choisissez le type "Enumération, Combinaison". 

3. Dans l'onglet "Général" de la description de la rubrique, cliquez sur le bouton à droite de la combo "Type", puis sélectionnez "Créer une nouvelle énumération". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=TypeRubEnumCombin%20-%20HC%20N%B0003.gif&type=thumb)


4. La fenêtre d'édition d'une énumération s'affiche :
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=RubriqueEnumCombin2%20-%20HC%20N%B0001.gif)


	- Précisez le nom de l'énumération.

- Ajoutez des valeurs (bouton ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=RubriqueEnumCombinBoutonPlus.gif)
) ou saisissez directement les valeurs dans la table.

- Pour chaque valeur, précisez éventuellement la valeur associée ou l'alias (un alias est une valeur de l'énumération ayant la même valeur qu'une autre valeur de l'énumération, mais avec un nom différent).




Vous pourrez utiliser cette énumération comme n'importe quelle variable de type Enumération définie dans l'éditeur de code. Pour plus de détails, consultez [Le type Enumération](../Motscles/1514067.md).

Remarque : Si vous avez défini une variable de type Enumération dans l'éditeur de code, pour utiliser cette variable dans une rubrique de l'analyse, vous devez recréer cette énumération dans l'éditeur d'analyses.
<a name="NOTE2_2"></a>


### Création d'une rubrique de type Combinaison
<a name="creation_une_rubrique_type_combinaison_ELTPARAGRAPHE000058"></a>Pour créer une rubrique de type Combinaison :

1. Créez une nouvelle rubrique dans la fenêtre de description des rubriques du fichier de données (option "Description des rubriques" du menu contextuel du fichier sous l'éditeur d'analyses). 

2. Choisissez le type "Enumération,Combinaison"
	

3. Dans l'onglet "Général" de la description de la rubrique, cliquez sur le bouton à droite de la combo "Type", puis sélectionner "Créer une nouvelle combinaison".

4. La fenêtre d'édition d'une combinaison s'affiche :
	
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=RubriqueEnumCombin2%20-%20HC%20N%B0002.gif)


	- Précisez le nom de la combinaison.

- Ajoutez des valeurs (bouton ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=RubriqueEnumCombinBoutonPlus.gif)
) ou saisissez directement les valeurs dans la table.

- Pour chaque valeur, précisez éventuellement la valeur associée ou l'alias.




Vous pourrez utiliser cette combinaison comme n'importe quelle variable de type Combinaison définie dans l'éditeur de code. Pour plus de détails sur le type Combinaison, consultez [Le type Combinaison](../Motscles/1514074.md).

Remarque : Si vous avez défini une variable de type Combinaison dans l'éditeur de code, pour utiliser cette variable dans une rubrique de l'analyse, vous devez recréer cette combinaison dans l'éditeur d'analyses.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## "Conversion" d'une rubrique existante vers le type Enumération ou Combinaison
<a name="conversion_une_rubrique_existante_vers_type_enumeration_combinaison_ELTTEXTE000273"></a>
Si vos fichiers de données existants utilisent des rubriques que vous souhaitez transformer en Enumération ou Combinaison (pour faciliter la maintenance du code, éviter les affectations de valeurs indésirables, etc.), plusieurs possibilités s'offrent à vous :

- "convertir" la rubrique existante en variable de type Enumération ou Combinaison. Cette solution est la plus rigoureuse mais est plus complexe à mettre en oeuvre (surtout si vous avez des fichiers de données en production).

- utiliser une rubrique de type entier ou chaîne pour mémoriser la valeur ou le nom des éléments de l'énumération ou de la combinaison. Cette solution est plus simple à mettre en oeuvre, mais elle n'empêche pas les valeurs indésirables. Elle permet aussi de mémoriser une valeur d'énumération ou de combinaison dans une base non HFSQL (MySQL, Oracle, ...) où les types Enumération et Combinaison ne sont pas disponibles.





### "Convertir" une rubrique en une variable de type Enumération ou Combinaison
<a name="convertir_une_rubrique_une_variable_type_enumeration_combinaison_ELTPARAGRAPHE000094"></a>La "conversion" doit être réalisée en plusieurs étapes :

1. Ajoutez une nouvelle rubrique "Enumération, Combinaison" dans la description du fichier de données voulu (voir paragraphes précédents).

2. Modifiez les fichiers de données physiques. Cette modification peut être faite :

	- soit directement depuis l'éditeur d'analyses via la "Synchronisation de la Structure et des Données déployées". Utilisez cette solution si vous avez accès directement aux fichiers de données depuis le poste de développement.

	- soit par programmation via la fonction WLangage [HModifieStructure](../WDLang4/1000019439.md). Utilisez cette solution si vous n'avez pas accès aux fichiers de données (applications déployées par exemple).




3. Remplissez la nouvelle rubrique Enumération ou Combinaison à partir du contenu de la rubrique entier (ou chaîne de caractères) originale. Il suffit d'utiliser la fonction WLangage [EnumérationDepuisValeur](../WDLang1/1000020768.md) ou [CombinaisonDepuisValeur](../WDLang1/1000020770.md). Cette fonction renvoie l'option d'une énumération ou combinaison à partir d'une valeur donnée.
	Attention : il est nécessaire d'avoir défini une valeur pour chaque option de l'énumération ou de la combinaison. Si le nom de l'option fait office de valeur, utilisez la fonction WLangage [EnumérationDepuisNom](../WDLang1/1000020769.md) ou [CombinaisonDepuisNom](../WDLang1/1000020771.md).
	
	```wl
	// Si la rubrique Etat (entier) contient une valeur valide pour l'énumération
	SI EnumérationVérifieValeur(EEtatCommande, Commande.Etat) ALORS
		// Remplit la rubrique Enumération avec la valeur correspondante
		Commande.EtatEnum = EnumérationDepuisValeur(EEtatCommande, Commande.Etat)
		// Modifie l'enregistrement
		HModifie(Commande)
	FIN
	```


4. Supprimez l'ancienne rubrique entier ou chaîne de caractères.

5. Eventuellement, renommez la nouvelle rubrique avec le nom de l'ancienne.





### Utilisation d'une rubrique de type entier ou chaîne
<a name="utilisation_une_rubrique_type_entier_chaine_ELTPARAGRAPHE000127"></a>Il est également possible d'utiliser une énumération ou combinaison sans modifier votre analyse existante. Vous pouvez mémoriser la valeur ou le nom de l'option de l'énumération ou combinaison dans une variable de type entier ou chaîne de caractères.

Dans ce cas, les conversions sont effectuées lors de la lecture et de l'écriture via les fonctions WLangage.

Par exemple, pour l'énumération suivante :

```wl
// Enumération avec valeurs associées
EEtatCommande est une Enumération
	EnAttenteValidation = 1
	EnPréparation = 2
	EnExpédition = 3
	EnLivraison = 4
	Livré = 5
FIN
```


Vous pouvez choisir de mémoriser l'état de la commande dans une rubrique de type :

- entier : dans ce cas, la valeur de l'option (1, 2, ...) sera mémorisée,

- chaîne de caractères : dans ce cas, le nom de l'option (EnAttenteValidation, EnPréparation, ...) sera mémorisé.


Attention : par défaut, si vous ne définissez explicitement aucune valeur pour les options, la valeur de l'option sera équivalente à son nom.

Pour récupérer l'énumération ou la combinaison depuis la rubrique, vous devez utiliser les fonctions WLangage :

- [EnumérationDepuisValeur](../WDLang1/1000020768.md) ou [EnumérationDepuisNom](../WDLang1/1000020769.md) pour une énumération.

- [CombinaisonDepuisValeur](../WDLang1/1000020770.md) ou [CombinaisonDepuisNom](../WDLang1/1000020771.md) pour une combinaison.




Par exemple : 

```wl
// Lit l'enregistrement voulu
HLitPremier(Commande)
// Définit une variable de type Enumération
eMaCommande est un EEtatCommande
// Récupère l'énumération depuis la rubrique
eMaCommande = EnumérationDepuisValeur(EEtatCommande, Commande.EtatCommande)
```


Pour affecter une rubrique à partir d'une énumération ou combinaison, vous pouvez indiquer directement la variable de type Enumération ou Combinaison. Vous affectez ainsi directement la valeur définie pour l'option (équivalent à la propriété [Valeur](../Motscles/1514067.md)).

```wl
// Définit une variable de type énumération
eMaCommande est un EEtatCommande
// Applique une valeur à la variable
eMaCommande = EnAttenteValidation
// Affecte directement la rubrique avec la variable Enumération
// Equivalent à Commande.EtatCommande = eMaCommande.Valeur
Commande.EtatCommande = eMaCommande
```


Pour mémoriser le libellé de l'option, vous pouvez utiliser la propriété [Nom](../Motscles/1514067.md).

```wl
// Mémorise le nom de l'option dans la rubrique
Commande.EtatCommande = eMaCommande..Nom
```



