
## Saisir du code Java
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000219"></a>
Il est possible de saisir du code Java : 

- dans les applications Java générées avec WINDEV. 

- dans les applications Android générées avec WINDEV Mobile. 




Vous pouvez ainsi créer des procédures globales entièrement en Java.

Ces procédures Java peuvent appeler directement les procédures WLangage de votre projet. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment créer une procédure en code Java ?
<a name="comment_creer_une_procedure_code_java_ELTTEXTE000243"></a>


### Saisir le code d'une procédure globale en Java
<a name="saisir_code_une_procedure_globale_java_ELTPARAGRAPHE000027"></a>Pour saisir le code d'une procédure globale en Java : 

1. Créez une nouvelle procédure globale (par exemple option "Nouvelle procédure globale" du menu contextuel des collections de procédures dans le volet "Explorateur de projet"). Indiquez le nom de cette procédure.

2. La procédure est créée sous l'éditeur de code. 

3. Dans l'entête de la procédure, cliquez sur le logo "WL" pour changer le type de code. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=android_java_natif_avant.gif&type=thumb)


4. Dans la liste qui s'ouvre, sélectionnez "Java". 

5. Le bandeau devient violet et les caractères "Java" apparaissent devant le nom de la procédure. Le code existant est mis en commentaires. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=android_java_natif_apres.gif)


6. Saisissez le code Java directement dans l'éditeur de code de WINDEV et / ou WINDEV Mobile.




**Remarque** : Pour revenir en code WLangage, il suffit de cliquer sur "Java" dans le bandeau de la procédure et de sélectionner "WLangage".


<a name="NOTE2_2"></a>


### Remarques importantes
<a name="remarques_importantes_ELTPARAGRAPHE000046"></a>

- Le passage de paramètres à une procédure Java est réalisé automatiquement par valeur.

- Les paramètres des procédures écrites en code Java doivent obligatoirement être typées avec un type primitif (entier, réel, chaîne, ...). 
	Attention : Le type float n'est pas géré, il peut être remplacé par le type double.

- Les valeurs de retour des méthodes doivent obligatoirement correspondre à un type primitif (entier, réel, chaîne, ...). 
	Attention : Le type float n'est pas géré, il peut être remplacé par le type double.

- Attention : il est nécessaire d'ajouter les imports correspondant aux classes Java utilisées dans le code Java natif saisi (grâce au mot-clé "Import"). Par souci de lisibilité, il est recommandé d'ajouter ces imports avant la déclaration de la méthode.

- Dans les lignes de code présentes avant le prototype de la fonction Java, seuls les commentaires et les imports sont pris en compte. Tout autre code sera ignoré et pourra déclencher une erreur (notamment de parenthèse manquante). 

- Java est "case-sensitive" : veillez à respecter les minuscules et les majuscules dans les noms des fonctions.





<a name="NOTE2_3"></a>


### Génération de l'application
<a name="generation_application_ELTPARAGRAPHE000079"></a>

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les classes Java utilisées dans le code Java natif doivent être spécifiées dans l'assistant de génération de l'application Java (étape "Autres fichiers de l'archive"). 
	Remarque : Il n'est pas possible de tester ces classes en GO. Il est nécessaire de générer l'application puis de la lancer. 

- **Prise en compte automatique des classes externes** : Pour que les classes externes Java soient automatiquement prises en compte lors de la génération de l'application : 

	- Ajoutez les fichiers dans le dossier "Autres" du volet "Explorateur de projet" (via l'option "Ajouter des éléments" du menu contextuel).
			Attention : Les fichiers Java doivent être encodés en UTF-8. 

	- Si la classe Java appartient à un package, la déclaration de ce package doit être la première ligne du fichier de la classe. Si le package n'est pas spécifié, le fichier sera mis dans &lt;Package_NomAppli&gt;.wdgen avec les autres fichiers ".java" générés.







<a name="NOTE3"></a>
<a name="NOTE3_1"></a>




## Comment exécuter une procédure WLangage ?
<a name="comment_executer_une_procedure_wlangage_ELTTEXTE000279"></a>


### Exécuter une procédure WLangage depuis le code Java
<a name="executer_une_procedure_wlangage_depuis_code_java_ELTPARAGRAPHE000111"></a>Pour exécuter une procédure WLangage depuis le code Java, il suffit d'appeler une des méthodes suivantes en fonction du type de la valeur renvoyée par la procédure :

| Nom de la méthode | Type Java de retour |
| --- | --- |
| appelProcedureWL | void (pas de valeur de retour) |
| appelProcedureWL_String | String |
| appelProcedureWL_int | int |
| appelProcedureWL_double | double |
| appelProcedureWL_long | long |
| appelProcedureWL_boolean | boolean |



Lors de l'appel de la méthode choisie : 

- le premier paramètre à passer à la méthode correspond au nom de la procédure WLangage à exécuter. 

- les paramètres suivants correspondent aux paramètres attendus par la procédure WLangage si nécessaire. Il est possible d'utiliser des paramètres de n'importe quel type simple Java (string, int, double, long, boolean, ...). Si le paramètre spécifié ne correspond pas à un type simple Java, il sera automatiquement converti en "string" par appel de sa méthode "toString()". 




**Exemple** : 

Code de la procédure WLangage : 


```wl
PROCEDURE GLOBALE MaProcédure(n est un entier, b est un booléen, s est une chaîne)
... 

RENVOYER s
```


Pour appeler la procédure MaProcédure depuis le code Java : 


```txt
appelProcedureWL_String("MaProcedure",5,false,"test")
```



<a name="NOTE3_2"></a>


### Remarques importantes
<a name="remarques_importantes_ELTPARAGRAPHE000165"></a>

- Si la procédure à exécuter est une procédure locale, il est recommandé de donner son nom complet en précisant le nom de l'élément auquel appartient la procédure. Exemple : "FEN_Fenetre1.MaProcedure". 

- Le nom de la procédure à exécuter ne doit contenir que des caractères alphanumériques non accentués.

- Si la procédure à exécuter retourne une valeur, cette valeur sera automatiquement convertie dans le type primitif Java correspondant à la méthode utilisée pour l'appel de la procédure. Si la conversion ne peut pas être effectuée, une erreur fatale sera déclenchée.

- Les paramètres de la procédure sont passés par copie.







- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WMNotedefrais.gif) ***Exemples multiplateforme (WINDEV Mobile)*** : **WM Note de frais** <br>Cet exemple permet de gérer vos notes de frais.<br><br>Voici les principales fonctionnalités de cette application :<br>- La saisie des factures<br>- Gestion des devises étrangères<br>- Ajout de justificatif photo pour les factures<br>- Envoi par mail de la note de frais<br>- Suivi des notes de frais<br>- ...


