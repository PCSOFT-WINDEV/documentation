
## Saisir du code C#
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000125"></a>
Il est possible de saisir du code C# dans les applications WINDEV (applications et composants Windows, assemblages .NET).

Vous pouvez ainsi créer des procédures globales entièrement en code C#.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment créer une procédure en code C# ?
<a name="comment_creer_une_procedure_code_ELTTEXTE000149"></a>
Pour saisir le code d'une procédure globale en code C# : 

1. Créez une nouvelle procédure globale (par exemple option "Nouvelle procédure globale" du menu contextuel des collections de procédures dans le volet "Explorateur de projet"). Indiquez le nom de cette procédure.
	Attention : le nom de la procédure ne doit pas contenir de caractères accentués. 

2. La procédure est créée sous l'éditeur de code. 

3. Dans l'entête de la procédure, cliquez sur le logo "WL" pour changer le type de code. ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CSHARP_Code_WL.gif)


4. Dans la liste qui s'ouvre, sélectionnez "C#". 

5. Le bandeau devient bleu clair et les caractères "C#" apparaissent devant le nom de la procédure. Le code existant est mis en commentaires. ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CSHARP_Code.gif)


6. Saisissez le code C# directement dans l'éditeur de code de WINDEV.




Remarques : 

- Pour revenir en code WLangage, il suffit de cliquer sur "C#" dans le bandeau de la procédure et de sélectionner "WLangage".

- Le nom de la procédure C# ne doit pas contenir d'accents. Dans le cas contraire, les accents sont supprimés lors du passage au code C#. 





<a name="NOTE2_2"></a>


### Remarques importantes
<a name="remarques_importantes_ELTPARAGRAPHE000040"></a>

- Le passage de paramètres à une procédure C# est réalisé automatiquement par valeur.

- Les paramètres des procédures écrites en code C# doivent obligatoirement être typées avec un type primitif (entier, réel, chaîne, ...). Les types gérés sont : 

	- char

	- wchar_t

	- float

	- double

	- int

	- long

	- short

	- void

	- bool

	- BOOL




- Evitez les commentaires de type "/\*". Les commentaires WLangage ("//") sont gérés. 






<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Comment appeler des classes C# ?
<a name="comment_appeler_des_classes_ELTTEXTE000179"></a>


### Utilisation d'assemblages .NET existants
<a name="utilisation_assemblages_net_existants_ELTPARAGRAPHE000063"></a>Si votre procédure en code C# utilise des classes C#, intégrez les assemblages nécessaires dans le projet. 

Remarque : Les déclarations "using" situées avant les prototypes des procédures en C# sont prises en compte pour toute la collection. 




### Ajout de classes C# spécifiques
<a name="ajout_classes_specifiques_ELTPARAGRAPHE000071"></a>Il est possible d'intégrer directement des classes C# en ajoutant des fichiers source ".cs" directement dans la liste des éléments du projet :

- soit par la liste des éléments,

- soit en sélectionnant "Autres" dans le bouton droit de l'explorateur de projet. 









