


## Tests automatiques de procédures et de classes
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000134"></a>
Les tests automatiques d'une procédure ou d'une classe permettent de tester les différentes fonctionnalités de la procédure ou de la classe.

**Remarque : Utilisation sous Windows Vista (et supérieur)** : Actuellement pour enregistrer et rejouer des tests unitaires automatiques, le mécanisme de l'UAC (contrôle des comptes utilisateurs) doit être désactivé.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment créer le test ?
<a name="comment_creer_test_ELTTEXTE000158"></a>


### Pour créer un test automatique sur une procédure (ou une méthode de classe) :
<a name="pour_creer_test_automatique_sur_une_procedure_une_methode_classe_ELTPARAGRAPHE000020"></a>***1ère méthode***

1. Affichez le volet "Explorateur de projet" si nécessaire.

2. Sélectionnez dans le volet "Explorateur de projet", le nom de la méthode ou de la procédure (globale ou locale) à tester. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Test_auto_proc%20-%20HC%20N%B0001.gif)


3. Dans le menu contextuel, sélectionnez l'option "Tests unitaires .. Créer un test unitaire".

4. Un nouveau scénario de test est automatiquement créé. Le scénario du test contient l'appel à la fonction. La saisie du code nécessaire au test de la procédure ou de la méthode est à la charge du développeur. Si la méthode ou la procédure attendent des paramètres, il est possible de créer un jeu de données de test.




***2ème méthode***

1. Affichez le volet "Code" si nécessaire.

2. Sélectionnez dans le volet "Code", le nom de la méthode ou de la procédure à tester.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Test_auto_proc%20-%20HC%20N%B0002.gif)


3. Dans le menu contextuel, sélectionnez l'option "Tests unitaires .. Créer un test unitaire".

4. Un nouveau scénario de test est automatiquement créé. Le scénario du test contient l'appel à la fonction. La saisie du code nécessaire au test de la procédure ou de la méthode est à la charge du développeur. Si la méthode ou la procédure attendent des paramètres, il est possible de créer un jeu de données de test.




***3ème méthode***

1. Affichez la procédure ou la méthode sous l'éditeur de code.

2. Sous le volet "Tests automatiques", dans le groupe "Tests", déroulez "Nouveau" et sélectionnez "Enregistrer un nouveau scénario".<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Test_auto_proc%20-%20HC%20N%B0003.gif)


3. Un nouveau scénario de test est automatiquement créé. Le scénario du test contient l'appel à la fonction. La saisie du code nécessaire au test de la procédure ou de la méthode est à la charge du développeur. Si la méthode ou la procédure attendent des paramètres, il est possible de créer un jeu de données de test.




***4ème méthode (uniquement pour la création du premier scénario de test sur une procédure)***

1. Affichez la procédure ou la méthode sous l'éditeur de code.

2. Ouvrez le menu contextuel de la flèche présente dans le bandeau de la procédure (clic droit) et sélectionnez l'option "Créer un test associé". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Test_auto_proc%20-%20HC%20N%B0005.gif)

	Remarques :

	- Si aucun scénario de test n'est associé à la procédure, la flèche est sur fond gris <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Test_auto_proc%20-%20HC%20N%B0004.gif)
. Si un test ou plus est associé à la procédure, l'icône est sur fond vert <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Test_auto_proc%20-%20HC%20N%B0006.gif)
. 

	- Si un test a déjà été associé à la procédure, le menu contextuel de la flèche propose de : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Test_auto_proc%20-%20HC%20N%B0007.gif)


		- lancer tous les scénarios associés à la procédure . 

- voir les tests associés à la procédure (c'est-à-dire les scénarios qui appellent directement ou indirectement la procédure).   

3. Un nouveau scénario de test est automatiquement créé. Le scénario du test contient l'appel à la fonction. La saisie du code nécessaire au test de la procédure ou de la méthode est à la charge du développeur. Si la méthode ou la procédure attendent des paramètres, il est possible de créer un jeu de données de test.




Remarque : Quelle que soit la méthode utilisée pour créer un scénario de tests, il est possible de créer un jeu de données de tests. Pour créer ce jeu de données, utilisez la fonction [TestAjouteItération](../WDLang1/1000017015.md). Pour plus de détail, consultez [Code d'un scénario](../Editeurs/2019033.md).


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDExempledetestunitaire.gif) ***Exemples didactiques (WINDEV)*** : **WD Exemple de test unitaire** <br>Cet exemple présente l'utilisation de l'éditeur de test unitaire intégré de WINDEV dans plusieurs cas concrets :<br>- le test d'une fenêtre <br>- le test d'une procédure globale<br>- le test d'un procédure globale à partir d'un jeu de données de test (disponible à partir des versions 12)


