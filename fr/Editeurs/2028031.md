


## Sélectionner les fichiers à installer et le framework de l'installeur
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000283"></a>
L'assistant d'installation permet de : 

- [Sélectionner et configurer les fichiers à installer](#NOTE2_1). Cette étape est très importante. 

- [Spécifier le framework WINDEV utilisé par l'installeur](#NOTE3_1). 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Fichiers à installer
<a name="fichiers_installer_ELTTEXTE000307"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000025"></a>Un des points les plus importants lors de la création d'une installation est la sélection des fichiers à installer.

Par défaut, le programme d'installation sélectionne automatiquement tous les fichiers présents dans le sous-répertoire EXE de votre projet à l'exception des fichiers de données (".FIC", ".NDX", ".MMO"). Les fichiers sélectionnés seront installés sur les postes utilisateurs.

Les fichiers affichés en vert correspondent aux nouveaux fichiers à installer depuis la dernière génération de l'installation.

**Pour ajouter des fichiers à installer**, cliquez sur le bouton "Ajouter" et sélectionnez les fichiers à ajouter.

**Pour supprimer des fichiers de l'installation**, sélectionnez le fichier, puis cliquez sur le bouton "Enlever".

**Pour configurer les propriétés d'installation de chaque fichier**, sélectionnez le fichier puis cliquez sur le bouton "Propriétés". Il est par exemple possible de créer un raccourci avec une ligne de commande pour un ou plusieurs fichiers, de gérer les versions des fichiers lors de la mise à jour de l'application, gérer la modification automatique des données, ... Pour plus de détails, consultez le paragraphe [Propriétés des fichiers](#NOTE4_1).



### Cas d'une installation avec mise à jour automatique
<a name="cas_une_installation_avec_mise_jour_automatique_ELTPARAGRAPHE000044"></a>Si vous réalisez une installation avec mise à jour automatique, l'assistant de création du programme d'installation offre la possibilité de choisir pour chaque fichier le poste sur lequel il doit être installé. Chaque fichier peut être installé :

- uniquement sur le poste serveur (par exemple les fichiers de données partagés par tous les utilisateurs).

- uniquement sur les postes utilisateurs (par exemple l'exécutable de l'application).

- à la fois sur le poste serveur et sur les postes utilisateurs (par exemple un fichier ".INI" permettant de configurer l'application installée sur le serveur avec les paramètres par défaut et les applications installées sur les postes utilisateurs avec les paramètres spécifiques aux utilisateurs).




Pour spécifier les postes sur lesquels chacun des fichiers doit être installé, il suffit de cocher la case :

- "Serveur" pour les fichiers à installer sur le serveur. Ces fichiers seront installés lors de l'exécution du programme d'installation sur le serveur.

- "Client" pour les fichiers à installer sur les postes utilisateurs. Ces fichiers seront installés lors de l'exécution du programme d'installation sur les postes utilisateurs.

- "Serveur" et "Client" pour les fichiers à installer sur le serveur et sur les postes utilisateurs.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Framework WINDEV
<a name="framework_windev_ELTTEXTE000343"></a>


### Mode d'installation du framework
<a name="mode_installation_framework_ELTPARAGRAPHE000063"></a>Le framework WINDEV correspond à l'ensemble des DLL WINDEV. Par défaut, le framework WINDEV est intégré dans le programme d'installation. Tous les éléments du framework nécessaires au fonctionnement de l'application sont automatiquement installés avec l'application.

Mais pour créer des programmes d'installation plus "petits", il est possible :

- soit de télécharger le framework WINDEV sur le site de PC SOFT. 

- soit de ne pas installer le framework. Le framework installé sur le poste des utilisateurs sera utilisé. Si ce framework n'existe pas, il sera téléchargé.



<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Fichier_a_installer%20-%20HC%20N%B0007.gif&type=thumb)


**Remarques** : 

- L'utilisation du téléchargement du Framework WINDEV est possible même si votre application utilise des DLLs renommées.

- Le téléchargement du Framework est effectué via le protocole HTTPS. Si le téléchargement via https échoue, le téléchargement est effectué via FTP. 



<a name="NOTE3_2"></a>


### Téléchargement du framework
<a name="telechargement_framework_ELTPARAGRAPHE000087"></a>L'option "Télécharger le Framework WINDEV sur le site de PC SOFT" permet de créer une installation de taille réduite.

Si votre application contient des exécutables qui utilisent un framework commun renommé, il est possible d'indiquer le répertoire d'installation du framework (étape suivante de l'assistant). Par défaut, le répertoire d'installation est "&lt;srProgramFilesCommun&gt;\\ &lt;Nom de la société&gt; \\Framework\\".

Le programme d'installation utilisera la connexion Internet du poste en cours et la fenêtre suivante sera affichée : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Fichier_a_installer%20-%20HC%20N%B0008.gif&type=thumb)


A chaque lancement de l'exécutable, tous les fichiers du framework WINDEV seront alors automatiquement chargés sur le site PC SOFT. La version du framework téléchargé correspondra à la version de WINDEV avec laquelle l'exécutable a été créé.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Install_Framework2.gif)


**Remarque** : Pour traduire les différents éléments de cette fenêtre, cliquez que le bouton "Paramètres FTP", puis sur le bouton "Traduire".
<a name="NOTE3_3"></a>


### Emplacement du framework
<a name="emplacement_framework_ELTPARAGRAPHE000104"></a>Par défaut, le Framework commun est installé dans le répertoire "&lt;Répertoire d'installation des éléments communs à plusieurs applications&gt;\\PC SOFT\\&lt;Version de WINDEV&gt;\\Framework",

Où :

- "&lt;Répertoire d'installation des éléments communs à plusieurs applications&gt;" correspond au répertoire renvoyé par la fonction [SysRep](../WDLang1/3073026.md) (avec la constante *srProgramFilesCommun*).

- "&lt;Version de WINDEV&gt;" correspond au numéro de version de WINDEV avec laquelle l'exécutable a été créé (par exemple, "28.0" si l'exécutable a été créé avec WINDEV 28).




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Propriétés des fichiers à installer
<a name="proprietes_des_fichiers_installer_ELTTEXTE000379"></a>


### Onglet "Chemin"
<a name="onglet_chemin_ELTPARAGRAPHE000125"></a>Cet onglet permet de spécifier : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Fichier_a_installer%20-%20HC%20N%B0001.gif&type=thumb)


- le répertoire d'installation du fichier. Les raccourcis suivants peuvent être utilisés :

	- **&lt;RepInst&gt;** : répertoire d'installation choisi par l'utilisateur lors de l'installation

	- **&lt;LectInst&gt;** : lecteur du répertoire d'installation choisi par l'utilisateur lors de l'installation.

	- **&lt;RepWin&gt;** : répertoire de Windows des postes utilisateurs.

	- **&lt;FicInst&gt;** : répertoire d'installation des fichiers de données. L'assistant de création du programme d'installation permet de paramétrer ce répertoire. Pour plus de détails, consultez [Paramétrer le répertoire des fichiers de données](../Editeurs/2028086.md).

	- **&lt;srProgramFiles&gt;** : Répertoire "Program Files" des postes utilisateurs.




- le nom du fichier installé. Par défaut, le fichier a le même nom. Mais il est possible de donner lors de l'installation, un nom différent au fichier.



<a name="NOTE4_2"></a>


### Onglet "Raccourcis"
<a name="onglet_raccourcis_ELTPARAGRAPHE000145"></a>Cet onglet permet de créer pour le fichier sélectionné :

- un raccourci dans le menu "Démarrer"

- et / ou un raccourci sur le bureau.

- et / ou un raccourci dans la barre de démarrage.



<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Fichier_a_installer%20-%20HC%20N%B0002.gif&type=thumb)


Pour créer un raccourci : 

1. Sélectionnez le type de raccourci à créer.

2. Saisissez le libellé du raccourci dans chaque langue gérée par le programme d'installation.

3. Saisissez le groupe de programmes dans lequel le raccourci doit être créé.
	**Remarque** : Si ce groupe de programmes n'existe pas sur le poste utilisateur, ce groupe sera créé.

4. Spécifiez si nécessaire les paramètres du raccourci. L'exécution de ce raccourci lancera une ligne de commande. 
	Par exemple, la ligne de commande : "C:\\MonRépertoire\\MonApplication.EXE /Login = Will" est composée :

	- du chemin complet du fichier associé au raccourci.
			Dans notre exemple : "C:\\MonRépertoire\\MonApplication.EXE".

	- des paramètres du raccourci.
			Dans notre exemple : "/Login = Will".







**Remarque** : Par défaut, pour chaque exécutable installé, un raccourci sera créé :

- dans le menu "Démarrer" du poste d'installation.

- sur le bureau du poste d'installation.



<a name="NOTE4_3"></a>


### Onglet "Version"
<a name="onglet_version_ELTPARAGRAPHE000181"></a>Par défaut, lors de la mise à jour d'une application, si des fichiers de même nom existent déjà dans le répertoire d'installation, ces fichiers sont remplacés (même si les fichiers remplacés sont plus récents que les fichiers installés). Aucune fenêtre d'avertissement ne s'affiche pour confirmer ces remplacements.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Fichier_a_installer%20-%20HC%20N%B0003.gif&type=thumb)


Pour gérer les collisions :

- Pour installer le fichier sélectionné même si un fichier de même nom plus récent est présent dans le répertoire d'installation, cochez l'option "Remplacer le fichier même s'il est plus récent".

- Pour ne pas installer le fichier sélectionné si un fichier de même nom est présent dans le répertoire d'installation, cochez l'option "Ne pas installer si le fichier existe déjà".

- Pour demander à l'utilisateur la confirmation du remplacement du fichier sélectionné, cochez l'option "Demander la confirmation du remplacement du fichier".

- Pour renommer le fichier existant, cochez l'option "Renommer le fichier remplacé sous le nom ci-dessous", et saisissez le nom et l'extension du fichier remplacé. Par exemple : "MonImage_Bak.GIF".



<a name="NOTE4_4"></a>


### Onglet "Options"
<a name="onglet_options_ELTPARAGRAPHE000196"></a>Cet onglet permet de définir les options d'installation et de compactage des fichiers ainsi que le groupe auquel le fichier est associé.

Pour plus de détails sur les options de compactage, consultez [WDInst - Paramétrer les caractéristiques des fichiers à installer](../Editeurs/2028033.md).

Pour plus de détails sur les groupes, consultez [WDInst - Groupe de fichiers](../Editeurs/2028010.md)
<a name="NOTE4_5"></a>


### Onglet "HFSQL" (uniquement pour les exécutables et les fichiers de données)
<a name="onglet_hfsql_uniquement_pour_les_executables_les_fichiers_donnees_ELTPARAGRAPHE000212"></a>Cet onglet permet de :

- indiquer si la modification automatique des données est gérée.

- gérer l'existence de fichiers au format Hyper File 5.5.




Si le fichier sélectionné est un index, il est également possible de demander la suppression de l'index de l'installation, et sa reconstruction automatique pendant l'installation.
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Fichier_a_installer%20-%20HC%20N%B0005.gif&type=thumb)

<a name="NOTE4_6"></a>


### Onglet "Framework" (uniquement pour les exécutables)
<a name="onglet_framework_uniquement_pour_les_executables_ELTPARAGRAPHE000226"></a>Cet onglet permet de préciser le mode d'utilisation du framework. Les informations affichées dans cet onglet ne sont pas modifiables et dépendent des informations indiquées dans l'écran de l'assistant. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Fichier_a_installer%20-%20HC%20N%B0006.gif&type=thumb)
Les différentes possibilités sont les suivantes :

- **Ne pas installer le framework pour cet exécutable**. Dans ce cas, si le framework n'est pas installé sur le poste en cours, l'utilisateur pourra le télécharger.

- **Utilise le framework WINDEV commun**. Utilise le framework commun installé sur le poste de l'utilisateur. Si ce framework commun n'est pas installé, l'utilisateur pourra le télécharger.

- **Utilise le framework commun renommé** : Utilise le framework commun renommé installé sur le poste de l'utilisateur. Si ce framework n'est pas installé, l'utilisateur pourra le télécharger.

- **Utilise un framework propre à l'exécutable** : Utilise le framework spécifié lors de la création de l'exécutable.

- **Utilise un framework propre à l'exécutable (DLL renommées)** : Utilise le framework spécifié lors de la création de l'exécutable.





