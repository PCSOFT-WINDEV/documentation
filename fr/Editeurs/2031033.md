


## Créer les pages Relation d'un pattern RAD WEBDEV
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Les étapes de la création de pattern RAD
<a name="les_etapes_creation_pattern_rad_ELTTEXTE000264"></a>
Les différentes étapes permettant de créer un Pattern RAD WEBDEV sont les suivantes :

1. [Création du projet de type "Pattern RAD"](../Editeurs/2031021.md).

2. Création des différentes pages du pattern.

	- [Page Fiche](../Editeurs/2031031.md).

	- [Page Table](../Editeurs/2031032.md).

	- **Page de relation**.

	- [Boutons et pages vision plus](../Editeurs/2031035.md).

	- [Menus](../Editeurs/2031034.md).




3. [Génération du Pattern RAD](../Editeurs/2031023.md).

4. [Utilisation du Pattern RAD](../Editeurs/2031024.md).




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Quelles pages doivent être créées ?
<a name="quelles_pages_doivent_etre_creees_ELTTEXTE000288"></a>


### Les fichiers à créer
<a name="les_fichiers_creer_ELTPARAGRAPHE000043"></a>Rappel : Pour réaliser un pattern RAD permettant de faire un projet complet, les fichiers suivants sont nécessaires :

- Une fiche pour RADFichierA.

- Une fiche pour RADFichierB. Un bouton Vision plus (ou une combo popup) doit permettre de sélectionner un élément du fichier RADFichierA.

- Une fiche pour RADFichierC. Un bouton Vision plus (ou une combo popup) doit permettre de sélectionner un élément du fichier RADFichierB.

- Une table pour RADFichierA.

- Une table pour RADFichierB.

- Une table pour RADFichierC.

- Une page de relation RADFichierB / RADFichierD.




Le menu général du site peut être inclus dans le modèle associé aux pages.
<a name="NOTE2_2"></a>


### Norme à suivre
<a name="norme_suivre_ELTPARAGRAPHE000060"></a>Cette page d'aide présente différentes règles applicables à la conception des pages du Pattern RAD. Ces règles ont été utilisées pour concevoir les différents Patterns livrés avec WEBDEV 16.

Ces règles sont une recommandation. Vous pouvez évidemment mettre en place et utiliser vos propres normes.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Les pages de relation
<a name="les_pages_relation_ELTTEXTE000318"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000071"></a>Les pages de relation permettent d'afficher simultanément des informations provenant de plusieurs fichiers. Dans un exemple simple, ce type de pages permettrait d'afficher les commandes et les lignes de commandes correspondantes. Ce type de page peut être Fiche + Table.

Une page Fiche + Table regroupe les éléments des fiches et les éléments des tables.  

La fiche est constituée des éléments suivants :

- Un superchamp : Ce superchamp contient les champs de la fiche à afficher. Ce superchamp est lié au fichier à afficher.

- De boutons Retour et Valider. 




La table est constituée des éléments suivants :

- Une table : Cette table est une table fichier.

- De boutons permettant de réaliser des actions de base : Ajouter, Modifier, Supprimer.




Dans le pattern RAD, une seule page de relation doit être créée : elle relie RADFichierB à RADFichierD.

**Exemple** : Page de relation dans le pattern RAD Simple : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Pattern_RAD_WWRelation.gif)

<a name="NOTE3_2"></a>


### Créer une page de relation
<a name="creer_une_page_relation_ELTPARAGRAPHE000095"></a>Pour créer une page de relation : 

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif) parmi les boutons d'accès rapide. 

	- La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Page" puis sur "Page".

	- L'assistant de création d'une page se lance.

	- Sélectionnez "Vierge" et validez. 




2. Dans la fenêtre de description, saisissez le nom de la page. Ce nom doit obligatoirement contenir le nom du fichier affiché dans la fiche (quelques exemples : PAGE_Relation_RADFichierA, PAGE_Rel_RADFichierA, ...).
	Remarque : Si vous voulez indiquer à l'utilisateur le nom du fichier en cours, utilisez le nom du fichier (RADFichierA par exemple) dans un libellé. Le terme RADFichierX sera automatiquement remplacé par le libellé du fichier décrit dans l'analyse.

3. Enregistrez la page.

4. La page doit être séparée en deux parties :

	- une partie Fiche : dans cette partie seront affichée les caractéristiques de la fiche sur le fichier RADFichierB.

	- une partie Table : dans cette partie seront affichées les caractéristiques de la table sur le fichier RADFichierD. Des boutons permettent également de gérer les enregistrements présents dans la table.








### Création de la partie Fiche
<a name="creation_partie_fiche_ELTPARAGRAPHE000116"></a>Pour créer la partie Fiche : 

1. Créez un superchamp dans la page : sous le volet "Création", dans le groupe "Conteneurs", cliquez sur "Superchamp". Ce superchamp va afficher les champs de la fiche. Positionnez ce champ dans la page et définissez sa taille. Si tous les champs ne peuvent pas entrer dans la taille définie, des ascenseurs apparaîtront automatiquement.

2. Dans la fenêtre de description du superchamp, indiquez le nom du superchamp. Ce nom doit être obligatoirement SC_Fiche_ (SC_ est le préfixe de la charte de programmation : il n'est pas nécessaire si vous n'utilisez pas de charte de programmation). Par exemple : SC_Fiche_RADFichierB.

3. Dans l'onglet "Contenu" de la fenêtre de description du superchamp, spécifiez :

	- le fichier parcouru : RADFichierB.

	- la rubrique parcourue : IDRADFichierB.




4. Affectez le superchamp à un groupe (Bouton "Groupes..." dans l'onglet "Détail" de la description du superchamp). Ce groupe permet de passer les champs de la fiche en affichage dans le code d'initialisation de la page. Ce groupe peut s'appeler par exemple "GR_PartieFiche".





### Création de la partie Table
<a name="creation_partie_table_ELTPARAGRAPHE000141"></a>Pour créer la partie Table :

1. Créez un champ Table dans la page : sous le volet "Création", dans le groupe "Données", déroulez "Table" et sélectionnez "Table".

2. Dans l'assistant de création de table, indiquez les caractéristiques suivantes :

	- Sélectionnez l'option "Afficher les données d'un fichier ou d'une requête".

	- Sélectionnez le fichier de base de la table : RADFichierD.

	- Conservez les rubriques proposées. La clé de parcours est IDRADFichierBRel.

	- Validez le nom de la table.




3. Positionnez le champ Table dans la page et définissez sa taille. Si nécessaire les colonnes correspondant aux identifiants peuvent être invisibles.





### Création des boutons
<a name="creation_des_boutons_ELTPARAGRAPHE000167"></a>Pour créer les différents boutons :

1. Créez et positionnez les différents boutons permettant de gérer les enregistrements affichés dans la table. Ces boutons peuvent avoir n'importe quel nom. 
	Il est conseillé de mettre :

	- un bouton d'ajout de ligne,

	- un bouton de suppression de ligne,

	- un bouton permettant de valider et de retourner sur la page précédente.




2. Cas du ***bouton d'ajout*** (bouton Ajouter une ligne par exemple).
	Ce bouton peut par exemple ajouter un enregistrement dans la table. Le code du bouton Ajouter peut être par exemple : 
	
	```wl
	// Initialisation du nouvel enregistrement
	HRAZ(RADFichierD)
	
	// On affecte l'identifiant de RADFichierB 
	// dans la rubrique correspondante du fichier RADFichierD
	RADFichierD.IDRADFichierBRel = RADFichierB.IDRADFichierB
	
	// Ajout de l'enregistrement
	HAjoute(RADFichierD)
	
	// Mise à jour de la table
	TableAffiche(TABLE_RADFichierD)
	
	CAS ERREUR:
		Erreur("Une erreur est survenue pendant l'ajout.", HErreurInfo())
		RETOUR
	```

	Dans le code du bouton d'ajout, il est conseillé d'activer le gestion automatique des erreurs (Option "Si Erreur : ", avec le traitement automatique "Exécuter le traitement d'erreur ("CAS ERREUR:" dans le code)").
	

3. Cas du ***bouton de suppression*** (bouton Supprimer une ligne par exemple).
	Ce bouton peut par exemple supprimer un enregistrement sélectionné dans la table. 
	Le code du bouton Supprimer peut être par exemple :
	
	```wl
	// Si la suppression est confirmée, suppression de la ligne de la table et de
	// l'enregistrement correspondant dans le fichier RADFichierD
	SI OuiNon("Voulez-vous vraiment supprimer l'enregistrement ?") ALORS 
		// Suppression de l'enregistrement à partir de la table
		 TableSupprime(TABLE_RADFichierD)
		// Positionnement sur l'enregistrement courant
		 TableAffiche(TABLE_RADFichierD, taCourantPremier)
	FIN
	
	CAS ERREUR:
		 Erreur("Une erreur est survenue pendant la suppression.", HErreurInfo())
		 RETOUR
	```

	Dans le code du bouton de suppression, il est conseillé d'activer le gestion automatique des erreurs (Option "Si Erreur : ", avec le traitement automatique "Exécuter le traitement d'erreur ("CAS ERREUR:" dans le code)").

4. Cas du ***bouton de retour*** (bouton "Retour" par exemple).
	
	```wl
	// Est-ce que l'on vient d'une page ?
	SI PagePrécédente() = "" ALORS
		// Oui, on affiche cette page
		PageAffiche(PagePrécédente())
	SINON
		// Non, on retourne à la page d'accueil
		PageAffiche(PAGE_Accueil) 
	FIN
	```

	**Remarque** : Ce code nécessite la présence dans le pattern RAD d'une page nommée "PAGE_Accueil". Cette page peut par exemple être la page d'accueil du site et contenir uniquement le menu général du site. Pour plus de détails, consultez [Page de menu](../Editeurs/2031034.md).

5. Saisissez le code de déclaration des globales de la page. Voici un exemple :
	
	```wl
	// Affichage des enregistrements 
	FichierVersPage()
	
	// Filtre pour la table des RADFichierD
	HFiltre(RADFichierD,IDRADFichierBRel,RADFichierB.IDRADFichierB)
	
	// La partie fiche est en affichage seulement
	GR_PartieFiche..Etat = AffichageSeulement
	```

	Ce code permet :

	- d'afficher la valeur des enregistrements dans la fiche et dans la table

	- de passer les champs de la fiche en mode "Affichage seulement".




6. Saisissez le code de fermeture de la page. Ce code permet de désactiver le filtre :
	
	```wl
	// Désactive le filtre
	HDésactiveFiltre(RADFichierD)
	```






