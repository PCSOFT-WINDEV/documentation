


## Utiliser le résultat d'une requête
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000218"></a>
Le résultat d'une requête de sélection peut être utilisé dans :

- une application WINDEV, WINDEV Mobile ou un site WEBDEV,

- une fenêtre (créée avec l'assistant sous WINDEV ou WINDEV Mobile),

- une page (créée avec l'assistant sous WEBDEV),

- un champ d'une fenêtre (table, liste, combo, ... sous WINDEV ou WINDEV Mobile),

- un champ d'une page (zone répétée, table, liste, combo, ... sous WEBDEV),

- un état.




Le résultat d'une requête d'insertion, de modification ou de suppression peut être utilisé uniquement dans un programme.|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | Rappel : Le logiciel Etats & Requêtes ne permet pas de créer : des requêtes d'insertion, des requêtes de modification, des requêtes de suppression. |



Pour utiliser le résultat d'une requête en programmation, consultez [Exécution de la requête et manipulation du résultat avec les fonctions du WLangage](../Editeurs/2032027.md).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Requête dans une fenêtre ou dans une page
<a name="requete_dans_une_fenetre_dans_une_page_ELTTEXTE000260"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000035"></a>

Il est possible d'utiliser une requête comme source de données d'une fenêtre ou d'une page. La fenêtre ou la page affichera les enregistrements sélectionnés par la requête.

|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | Les requêtes créées avec le logiciel Etats & Requêtes pourront être exécutés depuis une application WINDEV uniquement si cette application gère les requêtes créées avec le logiciel Etats & Requêtes. |






<a name="NOTE2_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Utiliser une requête dans une fenêtre
<a name="utiliser_une_requete_dans_une_fenetre_ELTPARAGRAPHE000049"></a>Pour utiliser une requête dans une fenêtre : 

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif)
 parmi les boutons d'accès rapide. 

	- La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Fenêtre" puis sur "Fenêtre".

	- L'assistant de création d'une fenêtre se lance.




2. Dans l'onglet R.A.D., choisissez le Pattern RAD à utiliser et le type de fenêtre à créer.

3. Spécifiez si nécessaire le gabarit de la fenêtre et validez la création. L'assistant de création d'une fenêtre s'affiche.

4. Dans l'assistant de création, sélectionnez la requête à associer à la fenêtre et les rubriques à afficher dans la fenêtre.

5. Validez. La fenêtre créée affichera les informations provenant de la requête associée.



<a name="NOTE2_3"></a>

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Requête dans un champ d'une fenêtre WINDEV ou d'une page WEBDEV
<a name="requete_dans_champ_une_fenetre_windev_une_page_webdev_ELTTEXTE000314"></a>
Tous les champs pouvant être reliés à une source de données peuvent être associés à une ou plusieurs rubriques résultat de la requête (champs de saisie, liste, table, ...).

Il est possible d'utiliser une requête comme source de données d'un champ. Le champ affichera les enregistrements sélectionnés par la requête.

|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | Les requêtes créées avec le logiciel Etats & Requêtes pourront être exécutés depuis une application WINDEV uniquement si cette application gère les requêtes créées avec le logiciel Etats & Requêtes. |




<a name="NOTE3_2"></a>


### Afficher le résultat de la requête dans un champ Liste, Combo, Zone répétée ou Table 
<a name="afficher_resultat_requete_dans_champ_liste_combo_zone_repetee_table_ELTPARAGRAPHE000100"></a>Pour afficher le résultat de la requête dans un champ Liste, Combo, Zone répétée ou Table :

1. Ouvrez la fenêtre ou la page dans laquelle le champ Liste, Combo, Zone répétée ou Table doit être ajouté.

2. Insérez le champ associé à la requête (via le volet "Création" du ruban). L'assistant de création du champ se lance.

3. Spécifiez que les informations affichées dans le champ proviennent d'une requête existante.

4. Sélectionnez la requête à associer au champ et les rubriques à afficher dans le champ.

5. Validez. Le champ créé affichera les informations provenant de la requête associée.

6. Saisissez si nécessaire la ligne de code suivante dans le traitement d'initialisation du champ. Cette ligne de code permet d'initialiser et d'exécuter la requête, et d'afficher le résultat de la requête dans le champ en cours. 
	
	```txt
	HExécuteRequête(<Nom de la requête associée>)
	```




<a name="NOTE3_3"></a>


### Utiliser une rubrique résultat de la requête dans un champ :
<a name="utiliser_une_rubrique_resultat_requete_dans_champ_ELTPARAGRAPHE000116"></a>Pour utiliser une rubrique résultat de la requête dans un champ (autre qu'un champ Liste, Combo, Zone répétée ou Table) :

1. Ouvrez la fenêtre ou la page dans laquelle un champ associé à une requête doit être ajouté.

2. Créez le champ associé à la requête.

3. Sous le volet "Modification", dans le groupe "Aide à l'édition", cliquez sur "Description". La fenêtre de description du champ s'affiche.

4. Affichez l'onglet "Liaison" de la fenêtre de description du champ.

5. Sélectionnez la rubrique à afficher dans l'option "Rubrique reliée".

6. Validez. Le champ créé affichera les informations provenant de la requête associée.

7. Saisissez si nécessaire la ligne de code suivante dans le traitement d'initialisation du champ. Cette ligne de code permet d'initialiser et d'exécuter la requête, et d'afficher le résultat de la requête dans le champ en cours.
	
	```txt
	HExécuteRequête(<Nom de la requête associée>)
	```





**Remarque** : Lors de la création d'un champ Table associé à une requête, il est possible de :

1. Sélectionner directement la requête dans le volet "Projet".

2. Effectuer un "Drag and Drop" (Glisser/Déplacer) vers la fenêtre. Une table associée à la requête est automatiquement créée dans la fenêtre ou dans la page.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Requête dans un état
<a name="requete_dans_etat_ELTTEXTE000368"></a>
Il est possible d'utiliser une requête comme source de données d'un état. L'état affichera les enregistrements sélectionnés par la requête.

Pour utiliser une requête dans un état, consultez [Etat sur Requête](../WDChamp/1011013.md).

**Astuce** : Sous le volet "Requête", dans le groupe "Liaison Fichier", l'option "Créer un état" permet de créer automatiquement un état basé sur la requête de sélection en cours.


