


## Store Privé pour applications mobiles
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000379"></a>
Pour diffuser vos applis, vous disposez de 2 possibilités :

- utiliser un store public tel que Apple Store ou Google Play. 

- diffuser vous-même vos applications.


La diffusion d'applications professionnelles à travers un store public est toujours délicate. Et la diffusion d'applications par une méthode directe n'est pas possible à grande échelle car toutes les opérations sont à effectuer manuellement : copie sur chaque téléphone, mise à jour, autorisations.

A partir de la version 26, WINDEV Mobile offre une solution idéale pour la diffusion de vos applications professionnelles : WINDEV Mobile fournit un Store Privé prêt à l'emploi !

Le principe de mise en place et d'utilisation est très simple : 

1. Installez tous les pré-requis pour l'utilisation du Store Privé. 

2. Dans le projet, activez la fonctionnalité "Store Privé" et compilez les applications (iOS et / ou Android). 

3. Uploadez les applis sur le serveur du Store Privé. 

4. Définissez les utilisateurs autorisés. 

5. Transmettez l'URL ou le QRCode (généré automatiquement) aux utilisateurs. 

6. Les utilisateurs téléchargent l'application, s'authentifient et utilisent l'application.

7. Par la suite, uploadez des "Mises à Jour" : les utilisateurs seront avertis et pourront accepter la Mise à Jour (téléchargement automatique).




**Attention : Sous iOS, une licence [Organization](../Editeurs/1000019864.md) doit être souscrite.** 

Remarque : Cette page d'aide présente la mise en place de la fonctionnalité "Store Privé". Pour la mise en place de la fonctionnalité Groupware utilisateur, consultez [Groupware utilisateur Mobile (Android et iOS)](../Editeurs/1410086648.md).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Mettre en place le Store Privé pour une application mobile
<a name="mettre_place_store_prive_pour_une_application_mobile_ELTTEXTE000403"></a>
Pour mettre en place le Store Privé pour une application mobile : 

1. [Etape 1 : Configurez votre serveur](#NOTE2_2). 

2. [Etape 2 : Activez le Store Privé dans votre projet mobile](#NOTE2_3). 

3. Etape 3 : Générez et uploadez l'application sur le Store Privé : 

	- [Application Android](#NOTE2_4). 

	- [Application iOS](#NOTE2_5).






<a name="NOTE2_2"></a>


### Etape 1 : Configuration du serveur
<a name="etape_1_configuration_serveur_ELTPARAGRAPHE000065"></a>Deux cas peuvent se présenter : 

- **Vous utilisez une plateforme PCSCloud** : les éléments nécessaires sont installés par défaut sur votre plateforme. 
	Rappel : PCSCloud est une solution payante, clé en main. Pour plus de détails, consultez [PCSCloud](https://pcscloud.net/FR/cloud_developpement.awp).

- **Vous n'utilisez pas une plateforme PCSCloud** : installez les éléments suivants : 

	- un serveur HFSQL,

	- le serveur réservé, en demandant l'installation des modules pour le Groupware utilisateur mobile (WDBaaS).


 Pour plus de détails, consultez la page [Configuration d'un serveur BaaS (Groupware utilisateur et Store Privé)](../Editeurs/1000021311.md).



<a name="NOTE2_3"></a>


### Etape 2 : Activez le Store Privé dans votre projet mobile
<a name="etape_2_activez_store_prive_dans_votre_projet_mobile_ELTPARAGRAPHE000087"></a>Pour activer le Store Privé dans votre projet WINDEV Mobile : 

1. Ouvrez votre projet sous WINDEV Mobile. 

2. Sous le volet "Projet", dans le groupe "Projet", cliquez sur "GPU / Store Privé". 

3. La fenêtre de description de la configuration de projet en cours apparaît. 

4. Dans la zone "Déploiement dans un Store Privé", cliquez sur le bouton "Modifier". 

5. La fenêtre de configuration du Store Privé apparaît. 

6. Sélectionnez l'onglet "Général" : 

	- Activez les services MBaaS : cliquez sur "Actif". 

	- Sélectionnez la fonctionnalité voulue : "Store Privé : Gestion des versions et des mises à jour de l'application".

	- Dans la zone "Serveur d'application du GPU et du Store Privé (webservice et site d'administration)", indiquez le serveur à utiliser. Dans le cas d'un nouveau serveur, sélectionnez le type de serveur à utiliser : 

		- **Plateforme PCSCloud**. Dans ce cas, indiquez les caractéristiques de votre plateforme PCSCloud. 
						Rappel : Cette option permet de profiter d'un serveur Web, d'un serveur réservé et d'un moteur HFSQL Client/Serveur déjà installés et configurés. 

		- **Serveur réseau ou Internet** avec le protocole utilisé. Saisissez les informations communiquées lors de l'installation du serveur réservé pour le groupware utilisateur/Store Privé : 

			- le nom du serveur, l'utilisateur et le mot de passe. 

			- le nom du serveur et le token. 




- Les URLs des sites d'administration sont automatiquement renseignées avec les informations spécifiées auparavant. 
			ATTENTION : Les URL spécifiées ne fonctionneront qu'à la validation de la fenêtre de paramétrage. En effet, lors de la validation de cette fenêtre, les modules installés avec le serveur d'application réservé sont automatiquement configurés.  

7. Dans l'onglet "Store Privé", indiquez : 

	- Le mode de téléchargement des mises à jour (uniquement en Android) : 

		- En WIFI uniquement : les mises à jour seront téléchargées sur l'appareil des utilisateurs uniquement si ceux-ci disposent d'un accès en Wi-Fi. 

		- En WIFI et avec le forfait mobile : les mises à jour seront téléchargées dès qu'un accès sera disponible. 


 En iOS, le paramétrage doit être effectué dans la console de l'application. 

- Les interactions avec l'utilisateur pour les mises à jour facultatives. Il est possible de prévenir l'utilisateur d'une mise à jour facultative en utilisant une des deux méthodes suivantes : 

	- Afficher une fenêtre dans l'application : dans ce cas, une fenêtre proposant la mise à jour sera automatiquement affichée. 

	- Envoyer une notification : dans ce cas, une notification préviendra l'utilisateur d'une mise à jour disponible (les notifications doivent être activées pour l'application). 

8. Dans l'onglet "Options", indiquez : 

	- Les options de personnalisation des emails : 

		- Validation d'inscription : Personnalisez si nécessaire les textes envoyés aux utilisateurs qui viennent de s'inscrire. 

		- Mot de passe oublié : Personnalisez si nécessaire les textes envoyés aux utilisateurs qui oublient leur mot de passe.

		- Installation de l'application (Store Privé) : Personnalisez le texte de l'email envoyé pour le téléchargement de l'application.




- La langue des fichiers : Par défaut, les fichiers de données utilisés par le Store Privé sont en français mais il est possible d'utiliser les fichiers de données en langue anglaise.

9. Validez la fenêtre de gestion du Store Privé. 




**Attention : Lors de la validation de la fenêtre de paramétrage du Store Privé, les actions suivantes sont réalisées :**  

- Déclaration de l'application en cours dans le serveur d'application réservé pour le Store Privé. 

- Activation des sites de gestion des utilisateurs et de leurs droits. 

- Mise à jour du fichier XML contenant la description des fenêtres de l'application sur le serveur. 

- Définition d'un utilisateur par défaut : 

	- Définition d'un Store Privé jusqu'à la version 28 : l'utilisateur par défaut a pour login "superviseur" et pour mot de passe "superviseur".

	- Définition d'un Store Privé à partir de la version 28 update 1 (280066) : l'utilisateur par défaut a pour login "admin" et pour mot de passe "admin". 
			Remarque : Lors de la première connexion au Store Privé, il est demandé de modifier le mot de passe de l'administrateur.






<a name="NOTE2_4"></a>


### Etape 3 : Générez et uploadez l'application sur le Store Privé (Android)
<a name="etape_3_generez_uploadez_application_sur_store_prive_android_ELTPARAGRAPHE000176"></a>**Pour générer votre application Android** : 

1. Sous le volet "Projet", dans le groupe "Génération", cliquez sur "Générer". 

2. Dans l'assistant de génération, dans l'étape "Mode de génération", choisissez l'option "Générer pour un déploiement libre (store privé, flotte d'entreprise, etc.)". 

3. Validez les différentes étapes de l'assistant selon les options voulues. 

4. Le fichier apk correspondant à l'application est généré dans le sous répertoire "Exe" du répertoire du projet. 
	Pour afficher ce dossier dans l'explorateur de fichiers, sous le volet "Accueil", dans le groupe "Général", déroulez l'option ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_Rep_Projet.gif)
 et sélectionnez "Explorer le répertoire de génération". 






**Pour uploader l'application** : 

1. Lancez un site d'administration via un des liens présents dans l'onglet "Général" de la fenêtre de gestion du groupware utilisateur/Store Privé : 

	- soit l'URL correspondant à l'application en exploitation. Les utilisateurs et les mots de passe définis seront utilisés lorsque l'application sera déployée. 

	- soit l'URL correspondant au mode test. Les utilisateurs et les mots de passe définis seront utilisés lors d'un test sur le téléphone (Go de l'application).  




2. Connectez-vous au site d'administration. 

	- Définition d'un Store Privé jusqu'à la version 28 : Utilisez le login "superviseur" et le mot de passe "superviseur". 

	- Définition d'un Store Privé à partir de la version 28 Update 1 (280066) : utilisez le login "admin" et le mot de passe "admin".




3. Le site d'administration du Store Privé permet d'uploader des versions de l'application via son APK pour une application Android. Un code-barres peut être généré pour permettre une installation facile sur les appareils Android.

	- Cliquez sur le "+" présent à droite de "Applications". 

	- Dans la popup qui s'affiche, précisez : le nom de l'application, sa description, l'image associée. 

	- L'application apparaît dans le Store Privé. Il est alors possible : 

		- Définir les droits pour le téléchargement. 

		- Uploader la première version de l'application (bouton "Uploader la première version"). Dans la popup qui s'affiche, indiquez le fichier apk à télécharger et validez. Saisissez si nécessaire les commentaires associés. 






<a name="NOTE2_5"></a>


### Etape 3 : Générez et uploadez l'application sur le Store Privé (iOS)
<a name="etape_3_generez_uploadez_application_sur_store_prive_ios_ELTPARAGRAPHE000229"></a>Avant de générer une application iOS, assurez-vous que vous possédez un certificat permettant de réaliser un déploiement "Entreprise" (voir [Déploiement In-House](../Editeurs/1000019926.md)). 

**Pour générer votre application iOS** : 

1. Sous le volet "Projet", dans le groupe "Génération", cliquez sur "Générer".

2. Dans l'assistant de génération, dans l'étape "Signature", indiquez les fichiers "Provisioning profile" nécessaires. 

3. Validez les différentes étapes de l'assistant selon les options voulues. 

4. Le fichier xxx.xcode.gen correspondant à l'application est généré dans le sous répertoire "Exe" du répertoire du projet. 

5. Affichez ce dossier dans l'explorateur de fichier : sous le volet "Accueil", dans le groupe "Général", déroulez l'option ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_Rep_Projet.gif)
 et sélectionnez "Explorer le répertoire de génération". 

6. Copiez le répertoire "&lt;Nom du projet&gt;.xcode.gen", généré dans le répertoire EXE sur un support externe (clé USB, disque dur externe, répertoire partagé avec le MAC sur le réseau).

7. Collez ce dossier sur le MAC qui va compiler l'application.

8. Ouvrez le dossier sur le MAC et ouvrez le fichier nommé "Nom_du_projet.xcodeproj".

9. Le projet se lance sous Xcode. 




**Sous Xcode** (attention : les manipulations décrites fonctionnent à la date d'écriture de cette documentation et peuvent être sujettes à modification) : 

1. Dans l'onglet "Signing and capabilities", vérifiez que vous possédez un certificat de déploiement valide. 

2. Dans la liste déroulante en haut à gauche, sélectionnez les options de compilation. Sélectionnez le scheme "Any iOS device". 
	Attention : le fichier "info.plist" du projet doit être au format XML et non au format binaire.

3. Pour lancer la compilation, cliquez sur l'option de menu "Product .. Archive". 

4. Quand le traitement est terminé, une fenêtre montre l'archive IPA, cliquez sur "Distribute App". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=MDM_IOS_01.gif)
L'assistant se lance.

5. Dans l'assistant : 

	- Sélectionnez "Enterprise". ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=MDM_IOS_02.gif)


	- Cliquez sur "Next" deux fois.

- L'assistant demande les URL correspondant aux informations sur l'application. Ces URL doivent être de type "https" (il suffit de saisir "https" dans les champs). ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=MDM_IOS_04.gif)




**Pour uploader l'application** : 

1. Lancez un site d'administration via un des liens présents dans l'onglet "Général" de la fenêtre de gestion du groupware utilisateur/Store Privé : 

	- soit l'URL correspondant à l'application en exploitation. Les utilisateurs et les mots de passe définis seront utilisés lorsque l'application sera déployée. 

	- soit l'URL correspondant au mode test. Les utilisateurs et les mots de passe définis seront utilisés lors d'un test sur le téléphone (Go de l'application).  




2. Connectez-vous au site d'administration. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=MDM_IOS_08.gif&type=thumb)


	- Jusqu'à la version 28 : Utilisez le login "superviseur" et le mot de passe "superviseur". 

- à partir de la version 28 Update 1 (280066) : utilisez le login "admin" et le mot de passe "admin".

3. Le site WDBaaS propose d'uploader des versions de l'application via son archive (fichier ".ipa" et fichier ".manifest"). 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=MDM_IOS_09.gif)


4. Lorsque l'application est uploadée, un code-barres est généré pour permettre une installation facile sur les appareils iOS. Il suffit de transmettre ce code-barre à l'utilisateur qui va le scanner avec son iPhone. Cet utilisateur doit avoir été décrit et activé dans l'administrateur du Store Privé pour la base de production. 




**Cas particulier : 1ère installation sur un appareil iOS à partir du code-barres**

- Lorsque l'utilisateur scanne le code-barres correspondant à l'application, il doit tout d'abord accepter le certificat du développeur de l'application. Cette opération est à effectuer uniquement une seule fois. 

- Le téléchargement de l'application est fait en HTTPS par iOS. Si le certificat du serveur Web qui héberge le site WDBaaS n'a pas été émis par une autorité de confiance reconnue par iOS, il faudra ajouter le certificat dans iOS. Voici la procédure à suivre (cette procédure est correcte au moment de la rédaction de cette page) :

	- sur l'appareil iOS, cliquer sur le .cer (reçu par email...),

	- sélectionner l'appareil,

	- un message indique de le profil est téléchargé ("Profil téléchargé...") : cliquer sur "Fermer". 

	- accéder à l'app "Réglages",

	- sélectionner "Général",

	- sélectionner "Gestion des profils et de l'appareil",

	- sélectionner le profil qui vient d'être installé,

	- cliquer sur "installer" et valider les confirmations.

	- retourner dans le menu "Général",

	- sélectionner "Informations",

	- sélectionner "Réglages des certificats",

	- sélectionner le certificat ajouté précédemment dans le profil,

	- sélectionner "Activer",

	- accepter la confirmation d'ajout dans les certificats racines.







**Cas particulier : Mise à jour de l'application pour un appareil iOS**
Après modification de l'application, les utilisateurs doivent pouvoir se mettre à jour. Le processus sous Xcode est identique, il faut créer une nouvelle archive. La nouvelle version (IPA et manifest.plist) doit être uploadée.
La nouvelle version est maintenant disponible dans l'administrateur du Store Privé. A la prochaine utilisation de l'application, la mise à jour sera automatiquement proposée.

Remarques : 

- Seul un utilisateur ayant l'option "Superviseur" peut accéder au site de gestion des applications. 

- Un bandeau spécifique permet de savoir si le site de gestion des applications est utilisé en mode test. 





