


## Test automatique créé par l'utilisateur
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000208"></a>
WINDEV permet à l'utilisateur d'enregistrer un scénario de test pour le transmettre au service qualité ou au développeur. L'utilisateur peut ainsi transmettre simplement un protocole de reproduction difficilement explicable.

Le développeur pourra importer directement le ou les tests dans son projet. Ces tests pourront être lancés par exemple pour reproduire le problème de l'utilisateur, et être ainsi ajoutés aux tests automatiques disponibles sur l'application.

Le fichier scénario est un fichier d'extension "wsct".

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Mise en place
<a name="mise_place_ELTTEXTE000232"></a>


### Création et enregistrement du scénario
<a name="creation_enregistrement_scenario_ELTPARAGRAPHE000022"></a>La création du scénario peut être réalisée :

- directement dans l'application, **par programmation**, grâce à la fonction [dbgDébutEnregistrement](../WDLang1/1000017160.md). Différentes fonctions WLangage sont disponibles :
	


|   |   |
| --- | --- |
| [dbgDébutEnregistrement](../WDLang1/1000017160.md) | Démarre l'enregistrement du scénario. |
| [dbgFinEnregistrement](../WDLang1/1000017161.md) | Termine l'enregistrement du scénario |



- sans modifier l'application, **grâce à un fichier spécifique**. Il suffit de créer un fichier &lt;Nom Executable&gt;.WX à côté de l'exécutable de l'application. 
	Ce fichier doit contenir les lignes suivantes :
	
	```txt
	[Scenario]
	Actif = <0/1>
	Fichier = <Nom du fichier WSCT>
	CheminDLL = <Chemin DLL de test>
	```

	**Détaillons ces lignes :**

	- Actif : Ce paramètre doit correspondre à 0 pour ne pas enregistrer, et 1 pour enregistrer le scénario

	- Fichier : Nom du fichier scénario (fichier d'extension "wsct"). Ce nom peut être construit avec les éléments suivants :
			


|   |   |
| --- | --- |
| [%RepExe%] | Répertoire de l'exécutable, toujours complété par le caractère "\\". Ce répertoire est équivalent au résultat de la fonction [fRepExe](../WDLang1/3036049.md). |
| [%NomExe%] | Nom de l'exécutable. |
| [%Date%] | Date de lancement du fichier scénario. |
| [%Heure%] | Heure de lancement du fichier scénario. |
| [%NomUtilisateur%] | Nom de l'utilisateur courant. |
| [%NomMachine%] | Nom de la machine. |
| [%RepDonnees%] | Répertoire des fichiers de données HFSQL spécifié par l'utilisateur lors de l'installation de l'application. Ce répertoire est équivalent au résultat de la fonction [fRepDonnées](../WDLang1/3036001.md). |
| [%RepDonneesUtilisateur%] | Répertoire pour les données de l'utilisateur courant de l'application courante. Ce répertoire est équivalent au résultat de la fonction [fRepDonnéesUtilisateur](../WDLang1/3036071.md). |




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Importation d'un scénario dans un projet
<a name="importation_scenario_dans_projet_ELTTEXTE000256"></a>
Pour importer dans un projet un scénario créé par l'utilisateur : 

1. Ouvrez dans WINDEV le projet voulu.

2. Sous le volet "Tests automatiques", dans le groupe "Tests", déroulez "Nouveau" et sélectionnez "Importer un scénario enregistré sur l'application".

3. Sélectionnez le fichier scénario à importer (extension wsct).

4. Le scénario est automatiquement importé dans le projet :

	- Pour chaque fenêtre manipulée dans le scénario, un test automatique est créé. Si des tests existent déjà pour la fenêtre, les tests importés sont automatiquement créés dans les tests associés à la fenêtre.

	- Les tests importés sont automatiquement mis en construction : c'est au développeur de regarder les tests et de les activer si nécessaire.

	- Les fenêtres de description correspondant aux tests importés sont affichées sous l'éditeur : il est ainsi possible de revoir chaque test un par un.








