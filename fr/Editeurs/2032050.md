


## Deux méthodes pour passer des paramètres à une requête 
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000169"></a>
<a name="Deux_methodes"></a>
Pour passer des paramètres à une requête paramétrée utilisée dans une fenêtre ou dans un champ (par exemple champ Liste, Combo ou Table), le WLangage offre deux possibilités :

- soit passer les paramètres directement dans la fonction WLangage [HExécuteRequête](../WDLang4/3044080.md).

- soit utiliser la notation *&lt;Nom de la requête&gt;.&lt;Nom du paramètre&gt;*, puis la fonction [HExécuteRequête](../WDLang4/3044080.md).




Cette page d'aide présente le mode d'utilisation et les avantages de chacune de ces méthodes.

**Remarque** : Si la requête paramétrée est utilisée dans un état, le mode de passage des paramètres varie. Pour plus de détails, consultez [Comment utiliser une requête paramétrée dans un état](../Editeurs/2032032.md).



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Utiliser la fonction HExécuteRequête pour passer les paramètres à une requête
<a name="utiliser_fonction_hexecuterequete_pour_passer_les_parametres_une_requete_ELTTEXTE000199"></a>


### Syntaxe à utiliser
<a name="syntaxe_utiliser_ELTPARAGRAPHE000037"></a>Lors de l'exécution d'une requête avec la fonction [HExécuteRequête](../WDLang4/3044080.md), les derniers paramètres passés à la fonction correspondent aux paramètres de la requête.

La syntaxe utilisée est la suivante :

```txt
<Résultat> = HExécuteRequête(<Nom requête> [, <Connexion>] [, <Mode> [, <Paramètres> [, ...]]])
```

Attention : Dans ce cas :

- Les valeurs des paramètres de la requête doivent être indiquées dans leur ordre d'initialisation (visible sous l'éditeur de requêtes). Chaque paramètre doit correspondre au type attendu. Les différents paramètres sont séparés par une virgule.

- Pour spécifier les paramètres de la requête, il est nécessaire de spécifier le mode d'initialisation de la requête.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Utiliser la notation &lt;Nom de la requête&gt;.&lt;Nom du paramètre&gt;
<a name="utiliser_notation_ELTTEXTE000223"></a>


### Syntaxe à utiliser
<a name="syntaxe_utiliser_ELTPARAGRAPHE000057"></a>Pour passer des paramètres à une requête, il est possible de préciser au moteur HFSQL tous les paramètres de la requête avant d'exécuter la requête. Cette méthode permet de préciser les différents paramètres dans n'importe quel ordre (intéressant pour les requêtes nécessitant de nombreux paramètres).

La syntaxe à utiliser est la suivante :

```txt
<Nom de la requête>.<Nom du paramètre 1> = <Valeur du paramètre 1>
<Nom de la requête>.<Nom du paramètre 2> = <Valeur du paramètre 2>
...
<Nom de la requête>.<Nom du paramètre N> = <Valeur du paramètre N>

<Résultat> = HExécuteRequête(<Nom de la requête> 
	[, <Connexion>] [, <Mode>])
```

Attention :

- Le nom du paramètre doit être le nom spécifié lors de la création de la requête sous l'éditeur de requête. Ce nom doit être différent d'un nom de rubrique.

- Il n'est pas possible d'utiliser d'[opérateurs d'indirection](../Motscles/1512005.md) ou la compilation dynamique (fonction [Compile](../WDLang1/3013015.md)) avec cette syntaxe.

- A chaque exécution de la requête avec la fonction [HExécuteRequête](../WDLang4/3044080.md), les paramètres sont ré-initialisés (remis à 0).

- Si au moins un paramètre est spécifié dans la fonction [HExécuteRequête](../WDLang4/3044080.md), tous les paramètres spécifiés précédemment seront ignorés.

- La valeur du paramètre peut correspondre à NULL.

- Si un des paramètres n'est pas précisé, la condition correspondante ne sera pas prise en compte.






<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Ne pas spécifier tous les paramètres
<a name="pas_specifier_tous_les_parametres_ELTTEXTE000247"></a>


### Paramètres de la requête non précisés
<a name="parametres_requete_non_precises_ELTPARAGRAPHE000094"></a>Quelle que soit la façon de passer les paramètres à la requête, tous les paramètres de la requête ne doivent pas obligatoirement être précisés. Les conditions de la requête utilisant des paramètres non précisés seront ignorées.



Exemple : Soit la requête "REQ_Clients_nom_prénom" dont le code SQL est le suivant :

```sql
SELECT * FROM CLIENT WHERE NOM = {Param1} AND PRENOM = {Param2}
```


- Les 2 paramètres sont donnés : 
	
	```wl
	HExécuteRequête(REQ_Clients_nom_prénom, hRequêteDéfaut, "Dupond", "Jean")
	```
exécutera la requête 
	
	```sql
	SELECT * FROM CLIENT WHERE NOM = 'Dupond' AND PRENOM = 'Jean'
	```


- Seul le nom est donné : 
	
	```wl
	HExécuteRequête(REQ_Clients_nom_prénom, hRequêteDéfaut, "Dupond" )
	```
exécutera la requête 
	
	```sql
	SELECT * FROM CLIENT WHERE NOM = 'Dupond'
	```


- Seul le prénom est donné. Le nom doit cependant être spécifié et correspondre à NULL. 
	
	```wl
	sNom est un Variant = Null 
	// Utilisation du variant obligatoire 
	// pour variable de type Null (non renseignée)
	
	HExécuteRequête(REQ_Clients_nom_prénom, hRequêteDéfaut, sNom, "Jean")
	
	// OU
	
	HExécuteRequête(REQ_Clients_nom_prénom, hRequêteDéfaut, Null, "Jean")
	```
exécutera la requête : 
	
	```sql
	SELECT * FROM CLIENT WHERE PRENOM = 'Jean'
	```






