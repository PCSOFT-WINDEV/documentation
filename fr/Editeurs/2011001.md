
## Editeur d'analyses : les différents types de liaisons
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000259"></a>
Les liaisons entre les fichiers de données peuvent être de plusieurs types :

- [parallèle](#NOTE2_1).

- [facultative](#NOTE3_1).

- [de complément](#NOTE4_1).

- [partagée](#NOTE5_1).

- [complexe](#NOTE6_1).






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Liaison parallèle
<a name="liaison_parallele_ELTTEXTE000283"></a>




### Définition
<a name="definition_ELTPARAGRAPHE000037"></a>Dans le cas d'une liaison parallèle, **chaque enregistrement** d'un fichier de données ("Produit") est relié à **un enregistrement** dans un autre fichier de données ("Information"), et **réciproquement**.
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LiaisonParallele.gif)


Pour gérer une liaison parallèle, l'identifiant du fichier de données "Produit" est copié dans le fichier de données "Information". Cet identifiant est également clé unique dans le fichier de données "Information".

Le fichier de données "Produit" est le fichier propriétaire. Le fichier de données "Information" est le fichier membre.


<a name="NOTE2_2"></a>




### Remarques
<a name="remarques_ELTPARAGRAPHE000052"></a>

- Ce type de liaison est rare car les deux fichiers de données peuvent être regroupés en un seul.

- Le parallélisme des enregistrements dans le fichier de données est respecté si les opérations suivantes sont exécutées simultanément sur les deux fichiers de données :

	- création d'un enregistrement

	- suppression d'un enregistrement

	- réindexation avec compactage









<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Liaison facultative
<a name="liaison_facultative_ELTTEXTE000313"></a>




### Définition
<a name="definition_ELTPARAGRAPHE000068"></a>Dans le cas d'une liaison facultative, **chaque enregistrement** d'un fichier de données ("Catégorie") a **aucun ou un seul enregistrement** associé dans un autre fichier de données ("Groupe"). **Chaque enregistrement** de l'autre fichier de données ("Groupe") a **aucun ou un seul enregistrement** associé dans le premier fichier de données ("Catégorie").
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LiaisonFacultative.gif)


Une liaison facultative est réalisée en copiant l'identifiant de chacun des fichiers des données dans l'autre fichier de données.



<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Liaison de complément
<a name="liaison_complement_ELTTEXTE000337"></a>




### Définition
<a name="definition_ELTPARAGRAPHE000083"></a>Dans le cas d'une liaison de complément, **chaque enregistrement** d'un fichier de données("Produit") a **aucun ou un seul enregistrement** associé dans un autre fichier de données ("Détail"). **Chaque enregistrement** de l'autre fichier de données ("Détail") a **nécessairement un enregistrement** associé dans le premier fichier de données ("Produit").
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Liaisoncomplement.gif)


Les liaisons de complément sont assez fréquentes. Elles sont notamment utilisées lorsqu'un enregistrement peut avoir des compléments d'informations optionnels.

Pour gérer une liaison de complément, la clé du fichier de données "Produit" est copiée dans le fichier de données "Détail". Pour assurer la cardinalité maximale de 1, elle reste clé unique. L'unicité de cette clé interdit l'insertion de plus d'un enregistrement dans "Détail" pour un enregistrement de "Produit".

Le fichier propriétaire est "Produit", le fichier membre est "Détail".



<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Liaison partagée
<a name="liaison_partagee_ELTTEXTE000361"></a>




### Définition
<a name="definition_ELTPARAGRAPHE000102"></a>Dans le cas d'une liaison partagée, un **même enregistrement** dans un fichier de données ("Fournisseur") peut être **partagé par plusieurs enregistrements** dans un autre fichier de données ("Produit").

Pour gérer une liaison partagée, la clé du fichier de données "Fournisseur" est copiée dans le fichier de données "Produit". Elle devient clé multiple pour accélérer la vérification de l'intégrité.

Le fichier propriétaire est "Fournisseur", le fichier membre est "Produit".

Selon la cardinalité, il est possible de distinguer quatre types de liaisons partagées :

- Liaison partagée de cardinalité 0,n - 0,1

- Liaison partagée de cardinalité 0,n - 1,1

- Liaison partagée de cardinalité 1,n - 0,1

- Liaison partagée de cardinalité 1,n - 1,1





<a name="NOTE5_2"></a>




### Liaison partagée de cardinalité 0,N - 0,1
<a name="liaison_partagee_cardinalite_0n_01_ELTPARAGRAPHE000122"></a>Avec ce type de liaison :

- un propriétaire peut ne pas avoir de membre (un fournisseur n'a pas obligatoirement de produit).

- un membre peut ne pas avoir de propriétaire (un produit n'a pas obligatoirement de fournisseur).



<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LiaisonPartagee_0N01.gif)



<a name="NOTE5_3"></a>




### Liaison partagée de cardinalité 0,N - 1,1
<a name="liaison_partagee_cardinalite_0n_11_ELTPARAGRAPHE000136"></a>Avec ce type de liaison :

- un propriétaire peut ne pas avoir de membre (un fournisseur peut n'avoir aucun produit).

- chaque membre a un seul propriétaire (chaque produit a un seul fournisseur).



<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LiaisonPartagee_0N11.gif)


**Remarque** : Ce type de liaison est fréquente. WINDEV permet de créer automatiquement les fenêtres permettant de gérer les fichiers liés par un liaison de type 0,N - 1,1.


<a name="NOTE5_4"></a>




### Liaison partagée de cardinalité 1,N - 0,1
<a name="liaison_partagee_cardinalite_1n_01_ELTPARAGRAPHE000152"></a>Avec ce type de liaison :

- chaque propriétaire a au moins un membre (un fournisseur a au moins un produit).

- un membre peut ne pas avoir de propriétaire (un produit peut avoir aucun fournisseur).



<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LiaisonPartagee_1N01.gif)



<a name="NOTE5_5"></a>




### Liaison partagée de cardinalité 1,N - 1,1
<a name="liaison_partagee_cardinalite_1n_11_ELTPARAGRAPHE000166"></a>Avec ce type de liaison :

- chaque propriétaire a au moins un membre (chaque fournisseur a au moins un produit).

- chaque membre a un seul propriétaire (chaque produit a un seul fournisseur).



<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LiaisonPartagee_1N11.gif)




<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Liaison complexe
<a name="liaison_complexe_ELTTEXTE000409"></a>


### Définition
<a name="definition_ELTPARAGRAPHE000181"></a>

Dans le cas d'une liaison "complexe", il est nécessaire de gérer un fichier de liaison appelé **fichier de relation**.

Le fichier de relation sera automatiquement créé. Il contiendra une clé unique composée des deux clés des fichiers de données reliés.

Le fichier de relation peut également contenir des informations spécifiques à la liaison.

Une liaison complexe se décompose alors en deux liaisons de type partagé.


<a name="NOTE6_2"></a>




### Exemple de liaison complexe
<a name="exemple_liaison_complexe_ELTPARAGRAPHE000196"></a>Une commande (fichier "Commande") peut contenir un ou plusieurs produits. Un produit (fichier "Produit") peut être utilisé dans plusieurs commandes.

Dans ce cas, il faut avoir un fichier de liaison (fichier "LigneCommande").

Le fichier "LigneCommande" contient :

- une clé unique composée des clés de Produit et de Commande.

- le nombre de produits commandés.




Les liaisons entre fichiers sont les suivantes :
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LiaisonPartagee_1N1N.gif)





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDLienreflexif.gif) ***Exemples didactiques (WINDEV)*** : **WD Lien reflexif** <br>Cet exemple illustre la gestion d'un lien réflexif avec les fonctions WLangage.<br>Dans cet exemple, nous abordons les principaux thèmes suivants :<br>1/ Remplissage d'un champ avec contenu HFSQL (gestion automatique du lien réflexif).<br>2/ Remplissage par programmation.


