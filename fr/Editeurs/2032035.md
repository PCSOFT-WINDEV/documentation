


## Création d'une requête composée 
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000146"></a>
<a name="Requete_composee"></a>
Une ***requête composée*** (instruction SQL correspondante : [UNION](../Editeurs/2034004.md)) permet de combiner plusieurs requêtes de sélection. Chaque requête de sélection doit porter sur des fichiers de données de structure identique.

Par exemple, sélection des clients dont le nom commence par la lettre 'A' et des prospects habitant Nice. Pour réaliser cette sélection, il est nécessaire de combiner les deux requêtes suivantes :

- sélection des clients dont le nom commence par la lettre 'A'. Cette requête est basée sur le fichier de données "Client".

- sélection des prospects habitant Londres. Cette requête est basée sur le fichier de données "Prospect".




Les fichiers de données "Client" et "Prospect" sont de même structure dans l'analyse.

Les enregistrements communs aux deux fichiers de données ("Client" et "Prospect") peuvent :

- soit apparaître une seule fois dans le résultat de la requête (opérateur [UNION](../Editeurs/2034004.md)).

- soit apparaître deux fois dans le résultat de la requête (opérateur [UNION ALL](../Editeurs/2034004.md)).




Pour combiner des requêtes, il est nécessaire de connaître :

- le nom des requêtes à combiner.

- si les enregistrements communs doivent apparaître une seule ou plusieurs fois dans le résultat de la requête.




**Remarque** : Les rubriques apparaissant dans le résultat de la requête composée correspondent aux rubriques de la première requête exécutée. Ainsi, dans notre exemple, les personnes qui sont à la fois client et prospect, dont le nom commence par la lettre 'A' et habitant Londres n'apparaîtront qu'une seule fois dans le résultat de la requête. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Requete_RequeteComposee.gif)
L'éditeur de requêtes génère automatiquement le code SQL de cette requête. 

**Pour visualiser le code SQL d'une requête** : 

1. Affichez le menu contextuel du graphe de la requête.

2. Sélectionnez l'option "Code SQL".




Vous pouvez également utiliser la touche F2. 

Par exemple :

```sql
SELECT 
	CLIENT.NomClient AS NomClient
FROM 
	CLIENT
WHERE 
	CLIENT.NomClient LIKE 'A%'

UNION

SELECT 
	PROSPECT.NomClient AS NomClient
FROM 
	PROSPECT
WHERE 
	PROSPECT.VILLE = 'Londres'
```
Pour que les personnes qui sont à la fois client et prospect, dont le nom commence par la lettre 'A' et habitant Londres apparaissent plusieurs fois dans le résultat de la requête, le code SQL suivant : 

```sql
SELECT 
	CLIENT.NomClient AS NomClient
FROM 
	CLIENT
WHERE 
	CLIENT.NomClient LIKE 'A%'

UNION ALL

SELECT 
	PROSPECT.NomClient AS NomClient
FROM 
	PROSPECT
WHERE 
	PROSPECT.VILLE = 'Londres'
```


<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000170"></a>
Pour créer une nouvelle requête composée :

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif) parmi les boutons d'accès rapide. 

	- Dans la fenêtre qui s'affiche, cliquez sur "Requête".

	- L'assistant de création d'une requête se lance.




2. Choisissez l'option "Union (UNION)" et validez.

3. Si votre projet n'est pas lié à une analyse, spécifiez l'analyse à laquelle la requête doit être rattachée.

4. La fenêtre de description de la requête s'affiche.

5. Saisissez le nom et le libellé de la requête.

6. Sélectionnez les différentes requêtes à combiner (cadre de gauche).

7. Choisissez de conserver ou de supprimer du résultat les enregistrements communs entre les requêtes combinées (bouton "Conserver les doublons / Supprimer les doublons").

8. Triez si nécessaire le résultat de la requête (bouton "Trier").

9. Validez la fenêtre de description de la requête. La représentation graphique de la requête s'affiche automatiquement sous l'éditeur de requêtes.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Notes
<a name="notes_ELTTEXTE000194"></a>


- Pour modifier les caractéristiques d'une requête, sous le volet "Requête", dans le groupe "Edition", cliquez sur "Description". Pour plus de détails, consultez [Description d'une requête](../Editeurs/2032038.md).

- Pour générer le code SQL correspondant à cette requête, sélectionnez l'option "Code SQL" du menu contextuel de la requête. Si des modifications sont effectuées dans la description de la requête, ces modifications seront automatiquement répercutées dans le code SQL correspondant.





