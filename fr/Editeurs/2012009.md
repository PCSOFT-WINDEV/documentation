
## C# : Appel de procédure WLangage
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000095"></a>
Une procédure globale en WLangage peut être appelée directement depuis le code d'une procédure globale en C#. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000119"></a>
Pour appeler une procédure WLangage directement depuis le code d'une procédure globale en C# : 

1. Saisissez le code de la procédure WLangage. La procédure WLangage doit respecter quelques règles : 

	- Avoir un nom acceptable en C#. 

	- Les paramètres de la procédure WLangage ainsi que la valeur de retour doivent être typés avec les types gérés : booléen, entier, réel, chaîne, buffer. Il est préférable de passer les paramètres par valeur en utilisant le mot-clé "LOCAL". 

	- L'attribut d'extension "C#" doit être ajouté à la procédure WLangage. 


 Exemple : 
	
	```wl
	PROCEDURE nWL_AjouteUn(LOCAL n est un entier), C# : entier
	RENVOYER n+1
	```


2. Il suffit ensuite d'appeler la procédure depuis le code C#. 
	Par exemple : 
	
	```txt
	int nCSharp_RenvoieInt(int i)
	{
	return nWL_AjouteUn(i);
	}
	```





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Exemple d'utilisation d'un assemblage
<a name="exemple_utilisation_assemblage_ELTTEXTE000143"></a>
Une procédure globale en C# peut appeler des fonctions d'un assemblage en utilisant **using** :

Par exemple : 

- Procédure globale affichant un message de type "OuiNon" : 
	
	```txt
	using System.Windows.Forms;
	
	public static bool pTEST(string _sMessage, string _sTitre)
	{
	
	DialogResult result;
	
	result = MessageBox.Show (_sMessage, _sTitre, MessageBoxButtons.YesNo, 
									MessageBoxIcon.Question);
	
	return  (result == System.Windows.Forms.DialogResult.Yes);
		
	}
	```


- Appel de la procédure depuis le WLangage (code de clic d'un bouton ou autre) : 
	
	```wl
	soit bRes = pTEST("C'est mon message", "Mon titre paramétré")
	
	Info("le OuiNon en C# a retourné " + (bRes ? "Oui" SINON "Non"))
	```










