


## Perso-dossiers dans l'analyse
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000190"></a>
Lors de la manipulation d'analyses comportant de nombreuses descriptions de fichiers de données, le graphe de l'analyse est difficilement lisible. Pour gérer ces analyses importantes, WINDEV, WEBDEV et WINDEV Mobile proposent d'utiliser les perso-dossiers dans l'analyse. 

Les perso-dossiers permettent de regrouper plusieurs descriptions de fichiers de données. 

Ces "perso-dossiers" permettent de simplifier : 

- la recherche et la visualisation de la description d'un fichier de données présent dans une analyse importante. 

- la manipulation des groupes de fichiers de données par programmation. 
	Par exemple, il est possible de réaliser un changement de connexion sur tous les fichiers de données d'un perso-dossier grâce à la fonction [HChangeConnexion](../WDLang4/3044150.md) : il suffit d'indiquer le nom du perso-dossier à manipuler directement dans la fonction WLangage (voir la liste des fonctions disponibles ci-dessous). 
	Cette fonctionnalité est disponible pour les fichiers de données HFSQL Classic, HFSQL Client/Serveur et les fichiers de données manipulés par les Accès Natifs. 




Ces regroupements s'effectuent dans le [volet "Analyse"](../Editeurs/2027012.md) ou directement dans le graphe de l'analyse. Ces perso-dossiers ne sont pas créés physiquement.

L'exemple suivant regroupe les fichiers de données selon leur catégorie : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=GroupeAnalyses.gif)


**Limitations** :

- Un perso-dossier peut être vide et ne contenir aucune description de fichier de données.

- Il n'est pas obligatoire d'associer une description d'un fichier de données à un perso-dossier.

- Un perso-dossier ne peut pas appartenir à un autre perso-dossier.

- Deux perso-dossiers ne peuvent pas avoir le même nom.

- Un perso-dossier ne peut pas avoir le même nom qu'une description d'un fichier de données.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Manipulations des perso-dossiers dans l'analyse
<a name="manipulations_des_persodossiers_dans_analyse_ELTTEXTE000220"></a>
Les différentes manipulations possibles sur les perso-dossiers dans l'analyse sont les suivantes :

- créer un perso-dossier.

- renommer un perso-dossier.

- supprimer un perso-dossier.

- associer une description de fichier à un perso-dossier.

- dissocier une description de fichier d'un perso-dossier.


Pour manipuler les perso-dossiers dans l'analyse, le volet "Analyse" doit être affiché. Pour afficher le volet "Analyse", sous le volet "Accueil", dans le groupe "Environnement", déroulez "Volets" et sélectionnez "Volets" puis "Analyse".
<a name="NOTE2_2"></a>


### Manipuler un perso-dossier
<a name="manipuler_persodossier_ELTPARAGRAPHE000075"></a>Pour créer un perso-dossier :

1. Dans le volet "Analyse" (ou dans le graphe de l'analyse), sélectionnez l'option "Nouveau perso-dossier" du menu contextuel (clic droit). Un nouveau perso-dossier est automatiquement créé.

2. Saisissez le nom de ce perso-dossier et validez (touche Entrée).




Pour renommer un perso-dossier :

1. Sélectionnez le perso-dossier à renommer dans le volet "Analyse".

2. Affichez le menu contextuel (clic droit) et sélectionnez l'option "Renommer" (ou appuyez sur la touche F2).

3. Saisissez le nouveau nom de ce perso-dossier et validez (touche Entrée).




Pour supprimer un perso-dossier :

1. Sélectionnez le perso-dossier à supprimer (dans le volet "Analyse" ou dans le graphe de l'analyse).

2. Affichez le menu contextuel (clic droit) et sélectionnez l'option "Supprimer". 

3. Le perso-dossier est supprimé. Les fichiers de données associés à ce perso-dossier sont automatiquement dissociés de ce perso-dossier.




Pour associer une description de fichier à un perso-dossier :

1. Sélectionnez la description de fichier à associer au perso-dossier.

2. Réalisez un "Drag and Drop" de la description vers le perso-dossier auquel la description doit appartenir. La description est automatiquement associée au perso-dossier.
	**Remarque** : Si la description appartenait déjà à un perso-dossier, la description est uniquement associée au nouveau perso-dossier.




Pour dissocier une description de fichier d'un perso-dossier :

1. Sélectionnez la description de fichier à dissocier dans le volet "Analyse".

2. Affichez le menu contextuel (clic droit) et sélectionnez l'option "Enlever du perso-dossier". 

3. La description de fichier est automatiquement dissociée du perso-dossier.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Actions possibles sur un perso-dossier
<a name="actions_possibles_sur_persodossier_ELTTEXTE000250"></a>


### Personnaliser la représentation graphique du perso-dossier
<a name="personnaliser_representation_graphique_persodossier_ELTPARAGRAPHE000112"></a>La personnalisation d'un perso-dossier consiste à afficher une image spécifique en image de fond du perso-dossier.

Pour personnaliser la représentation graphique d'un perso-dossier :

1. Sélectionnez le perso-dossier dans le graphe de l'analyse. 

2. Affichez le menu contextuel (clic droit) et sélectionnez l'option "Description".

3. Cochez l'option "Représentation du perso-dossier dans le graphe de l'analyse" et sélectionnez l'image voulue. Cette image sera affichée dans la représentation graphique du perso-dossier.

4. Validez.



<a name="NOTE3_2"></a>


### Impression du contenu du perso-dossier
<a name="impression_contenu_persodossier_ELTPARAGRAPHE000130"></a>Il est possible d'imprimer le dossier des éléments présent dans le perso-dossier : 

1. Sélectionnez le perso-dossier dans le volet "Analyse". 

2. Affichez le menu contextuel (clic droit) et sélectionnez l'option "Imprimer".




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Manipulation des groupes/perso-dossiers par programmation
<a name="manipulation_des_groupespersodossiers_par_programmation_ELTTEXTE000280"></a>
Plusieurs fonctions WLangage permettent de manipuler les perso-dossiers par programmation : 



|   |   |
| --- | --- |
| [HChangeConnexion](../WDLang4/3044150.md) | Change dynamiquement la connexion associée à un fichier de données. |
| [HChangeLocalisation](../WDLang4/3044167.md) | Modifie le mode de recherche des fichiers de données physiques (.FIC, .NDX, ...). |
| [HChangeRep](../WDLang4/3044168.md) | Modifie le chemin d'accès à un fichier de données (c'est-à-dire le répertoire dans lequel le fichier sera manipulé). |
| [HCréationSiInexistant](../WDLang4/3044254.md) | Effectue les opérations suivantes : <br><br>- Si le fichier n'existe pas, crée à vide un fichier de données (fichier d'extension ".FIC") avec le fichier d'index et le fichier mémo si nécessaire.La fonction est équivalente à [HCréation](../WDLang4/3044255.md). <br><br>- Si le fichier existe, ouvre le fichier.<br><br><br> |
| [HFerme](../WDLang4/3044073.md) | Ferme soit un fichier de données, soit tous les fichiers de données ouverts par l'utilisateur en cours : tous les fichiers de données physiques correspondant sont fermés pour l'utilisateur en cours. |
| [HForceEcriture](../WDLang4/3044004.md) | Force le système d'exploitation du poste sur lequel les fichiers de données sont présents à écrire les données directement sur le disque. |
| [HListeFichier](../WDLang4/3044045.md) | Renvoie la liste des fichiers :<br><br>- de l'analyse en cours ou d'une analyse spécifique reconnue par le moteur HFSQL. Les fichiers définis par les fonctions [HDéclare](../WDLang4/3044203.md), [HDéclareExterne](../WDLang4/3044204.md) et [HDécritFichier](../WDLang4/3044206.md) sont pris en compte.<br><br>- disponibles sur une connexion par un accès natif ou par un driver OLE DB.<br><br>- d'un groupe de fichiers défini dans l'éditeur d'analyses.<br><br><br> |
| [HOuvre](../WDLang4/3044120.md) | Ouvre un fichier de données. |
| [HPasse](../WDLang4/3044108.md) | Fixe le mot de passe utilisé pour créer ou pour ouvrir un fichier de données. |






