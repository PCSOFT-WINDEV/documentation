


## Création d'une requête d'insertion 
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000163"></a>
<a name="Requete_insertion"></a>
Une **requête d'insertion** (instruction SQL correspondante [INSERT](../Editeurs/2034001.md)) permet d'ajouter des enregistrements dans un fichier d'une base de données.

Les informations nécessaires pour réaliser une requête d'insertion sont :

- le fichier de données dans lequel des données vont être insérées.

- les rubriques dans lesquelles de nouvelles valeurs vont être insérées.




Par exemple, création d'un nouveau client dans le fichier de données "Client" : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Requete_RequeteInsertion.gif)
 L'éditeur de requêtes génère automatiquement le code SQL de cette requête. 

**Pour visualiser le code SQL d'une requête** : 

1. Affichez le menu contextuel du graphe de la requête.

2. Sélectionnez l'option "Code SQL".




Vous pouvez également utiliser la touche F2. 

Dans notre exemple :

```sql
INSERT INTO CLIENT
	( 
		Civilite,	
		NomClient,	
		Societe,	
		Adresse1,	
		CodePostal,	
		Ville
	)
VALUES
	( 
		'Melle',	
		'Montgomery',	
		'UNISOFT',	
		'15 Avenue Paul Rimbaud',	
		'75000',	
		'Paris'
	 )
```
|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png) | Important | [Le logiciel Etats & Requêtes](../Presentation/3088004.md) ne permet pas de créer des requêtes d'insertion. |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000205"></a>


### Créer une requête d'insertion
<a name="creer_une_requete_insertion_ELTPARAGRAPHE000046"></a>Pour créer une nouvelle requête d'insertion :

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif) parmi les boutons d'accès rapide. 

	- La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Requête".

	- L'assistant de création de requêtes se lance.




2. Choisissez de créer une requête d'insertion (option "Ajout (INSERT)").<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ass_creation_req_insertion%20-%20HC%20N%B0001.gif&type=thumb)


3. Si votre projet n'est pas lié à une analyse, spécifiez l'analyse à laquelle la requête doit être rattachée.
	Passez à l'étape suivante de l'assistant.

4. Sélectionnez le fichier de données dans lequel des données vont être insérées.
	Passez à l'étape suivante.

5. Les nouvelles valeurs vont être insérées dans les différentes rubriques du fichier de données. Pour chaque rubrique concernée : 

	- Cliquez dans la colonne "Valeur/Paramètre". 

	- Dans la fenêtre popup qui s'affiche, spécifiez la valeur ou le paramètre contenant la valeur à insérer. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ass_creation_req_insertion%20-%20HC%20N%B0005.gif&type=thumb)
Les nouvelles valeurs à insérer peuvent correspondre à :

		- la valeur par défaut définie dans l'analyse.

		- une valeur à spécifier. Précisez cette valeur.

		- une valeur contenue dans un paramètre. Précisez le nom du paramètre.

		- une valeur nulle.




- Validez votre choix.

6. Répétez les opérations de l'étape précédente pour chaque rubrique dans laquelle une valeur doit être insérée. 
	Remarque : le bouton ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ass_creation_req_insertion%20-%20HC%20N%B0004.gif) permet de générer automatiquement un paramètre pour chaque rubrique non renseignée.

7. Passez à l'étape suivante.

8. Saisissez le nom de la requête (nom du fichier ".WDR" correspondant à la requête). Ce nom permettra d'identifier la requête dans vos programmes.

9. Spécifiez le libellé de la requête en décrivant succinctement le rôle de la requête. Ce libellé sera utilisé dans le dossier du projet.
	Remarque : Le nom de la requête se définit automatiquement à partir du libellé saisi.

10. Validez la description de la requête. La représentation graphique de la requête s'affiche automatiquement sous l'éditeur de requêtes.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Notes
<a name="notes_ELTTEXTE000229"></a>


- Pour modifier les caractéristiques d'une requête : sous le volet "Requête", dans le groupe "Edition", cliquez sur "Description". Pour plus de détails, consultez [Description d'une requête](../Editeurs/2032038.md).

- Pour générer le code SQL correspondant à cette requête, sélectionnez l'option "Code SQL" du menu contextuel de la requête. Si des modifications sont effectuées dans la description de la requête, ces modifications seront automatiquement répercutées dans le code SQL correspondant.

- Il est également possible de créer une requête à partir d'un ou de plusieurs fichiers de données décrits sous l'éditeur d'analyses : il suffit de faire un "Drag and Drop" du ou des fichiers de données sélectionnés dans le volet "Analyse" vers l'éditeur de requêtes.

- Il est possible de tester la requête créée directement depuis l'éditeur de requêtes. Pour plus de détails, consultez [Tester une requête](../Editeurs/2019011.md).





