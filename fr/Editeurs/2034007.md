


## SQL : Gestion des jointures (INNER JOIN, OUTER JOIN) 
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000201"></a>
Pour sélectionner des enregistrements provenant de plusieurs fichiers de données, il est nécessaire d'utiliser des jointures dans la requête SQL.

Deux types de jointures peuvent être utilisés dans des requêtes en code SQL :

- les jointures internes.

- les jointures externes.




**Remarque** : Ces jointures sont utilisables :

- dans le code SQL des requêtes créées sous l'éditeur de requêtes et exécutées par la fonction [HExécuteRequête](../WDLang4/3044080.md).

- dans le code SQL des requêtes exécutées avec la fonction du WLangage [HExécuteRequêteSQL](../WDLang4/3044084.md).




Il est impossible d'effectuer des imbrications de jointures.

Pour plus de détails sur les instructions SQL, consultez une documentation spécifique au langage SQL.

Pour connaître toutes les commandes SQL (fonctions, clauses, opérateurs, ...) utilisables dans une requête SQL gérée par HFSQL, consultez [Commandes utilisables dans une requête SQL gérée par HFSQL](../Editeurs/2034006.md).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Jointures internes
<a name="jointures_internes_ELTTEXTE000225"></a>


### Définition
<a name="definition_ELTPARAGRAPHE000043"></a>Une jointure interne permet de sélectionner les enregistrements ayant des correspondances entre deux fichiers joints.

Par exemple, pour lister les clients ayant déjà passé des commandes, il est nécessaire de lier les fichiers "Client" et "Commande" grâce à une jointure interne. La requête sélectionnera uniquement les clients liés à au moins un numéro de commande. Les clients n'ayant jamais passé de commande ne seront pas listés.
<a name="NOTE2_2"></a>


### Format d'utilisation
<a name="format_utilisation_ELTPARAGRAPHE000052"></a>Différentes syntaxes sont possibles :

- Syntaxe 1 : Correspondance sur des rubriques identiques présentes dans des fichiers différents (utilisation du WHERE). 
	
	```txt
	SELECT ...
	FROM Fichier1, Fichier2, Fichier3
	WHERE Fichier1.NomRubrique1 = Fichier2.NomRubrique1
		Fichier2.NomRubrique2 = Fichier3.NomRubrique2
	```


- Syntaxe 2 : Correspondance sur des rubriques identiques présentes dans des fichiers différents (utilisation de INNER JOIN) : syntaxe compatible avec la majorité des bases de données : SQL Server, Access, MySQL et Oracle (sauf versions très anciennes de Oracle).
	
	```txt
	SELECT ...
	FROM (Fichier1 INNER JOIN Fichier2
	ON Fichier1.NomRubrique1 = Fichier2.NomRubrique1)
	INNER JOIN Fichier3
	ON Fichier2.NomRubrique2 = Fichier3.NomRubrique2
	```





Il est également possible de réaliser des liaisons entre plusieurs fichiers sur des rubriques différentes.
<a name="NOTE2_3"></a>


### Exemple :
<a name="exemple_ELTPARAGRAPHE000068"></a>
```sql
SELECT CLIENT.NomClient,
COMMANDE.NumCde
FROM CLIENT, COMMANDE
WHERE CLIENT.NumClient = COMMANDE.NumClient
```


équivalent à :

```sql
SELECT CLIENT.NomClient,
COMMANDE.NumCde
FROM (CLIENT INNER JOIN COMMANDE
ON CLIENT.NumClient = COMMANDE.NumClient)
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Jointures externes
<a name="jointures_externes_ELTTEXTE000261"></a>


### Définition
<a name="definition_ELTPARAGRAPHE000080"></a>Une jointure externe permet de sélectionner à la fois :

- les enregistrements ayant des correspondances entre les deux fichiers joints.

- les enregistrements n'ayant pas de correspondance dans le premier, le second ou dans tous les fichiers joints.




Par exemple, pour connaître le montant total dépensé par chaque client :

- En utilisant une jointure interne, seuls les clients ayant déjà passé une commande (dont le montant dépensé sera différent de 0) seront sélectionnés.

- En utilisant une jointure externe, tous les clients seront sélectionnés, même ceux n'ayant jamais passé de commande.



<a name="NOTE3_2"></a>


### Les différents types de jointures externes
<a name="les_differents_types_jointures_externes_ELTPARAGRAPHE000095"></a>


|   |   |
| --- | --- |
| FULL OUTER JOIN | Permet de sélectionner :<br><br>- les enregistrements satisfaisant à la jointure.<br><br>- les enregistrements du premier fichier cité qui ne satisfont pas la jointure. Le nom du premier fichier cité est placé à gauche de la jointure OUTER JOIN.<br><br>- les enregistrements du second fichier cité qui ne satisfont pas la jointure. Le nom du second fichier cité est placé à droite de la jointure OUTER JOIN.<br><br><br> |
| LEFT OUTER JOIN | **Jointure la plus courante**. Permet de sélectionner :<br><br>- les enregistrements satisfaisant à la jointure.<br><br>- les enregistrements du premier fichier cité qui ne satisfont pas la jointure. Le nom du premier fichier cité est placé à gauche de la jointure OUTER JOIN.<br><br><br> |
| RIGHT OUTER JOIN | Permet de sélectionner :<br><br>- les enregistrements satisfaisant à la jointure.<br><br>- les enregistrements du second fichier cité qui ne satisfont pas la jointure. Le nom du second fichier cité est placé à droite de la jointure OUTER JOIN.<br><br><br> |


<a name="NOTE3_3"></a>


### Format d'utilisation
<a name="format_utilisation_ELTPARAGRAPHE000123"></a>Les syntaxes disponibles sont les suivantes :

- Syntaxe 1 : Correspondance sur des rubriques identiques présentes dans des fichiers différents. 
	
	```txt
	SELECT ...
	FROM (Fichier1 LEFT/RIGHT/FULL JOIN Fichier2
	ON Fichier1.NomRubrique1 = Fichier2.NomRubrique1)
	LEFT/RIGHT/FULL JOIN Fichier3
	ON Fichier2.NomRubrique2 = Fichier3.NomRubrique2
	```


- Syntaxe 2 : Correspondance sur des rubriques identiques présentes dans des fichiers différents : syntaxe compatible avec SQL Server, Access, et MySQL.
	
	```txt
	SELECT ...
	FROM Fichier1 LEFT/RIGHT/FULL JOIN Fichier2
	ON Fichier1.NomRubrique1 = Fichier2.NomRubrique1,
	
	LEFT/RIGHT/FULL JOIN Fichier3
	ON Fichier2.NomRubrique2 = Fichier3.NomRubrique2
	```





Il est également possible de réaliser des liaisons entre plusieurs fichiers sur des rubriques différentes.
<a name="NOTE3_4"></a>


### Exemple 1 :
<a name="exemple_1_ELTPARAGRAPHE000139"></a>
```sql
SELECT CLIENT.NomClient,
SUM(COMMANDE.TotalTTC) AS TotalTTC
FROM CLIENT LEFT OUTER JOIN COMMANDE
ON (CLIENT.NumClient = COMMANDE.NumClient)
GROUP BY CLIENT.NomClient
```

<a name="NOTE3_5"></a>


### Exemple 2 :
<a name="exemple_2_ELTPARAGRAPHE000146"></a>
```sql
SELECT CLIENT.NumClient,
COUNT(DISTINCT PRODUIT.Reference) AS NbProduits
FROM CLIENT LEFT OUTER JOIN COMMANDE
ON CLIENT.NumClient = COMMANDE.NumClient,
COMMANDE JOIN LIGNECDE 
ON COMMANDE.NumCde = LIGNECDE.NumCde,
LIGNECDE JOIN PRODUIT
ON LIGNECDE.Reference = PRODUIT.Reference
GROUP BY CLIENT.NumClient, PRODUIT.Reference
```


Équivalent à :

```sql
SELECT CLIENT.NomClient,
COUNT(DISTINCT PRODUIT.Reference) AS NbProduits
FROM CLIENT, COMMANDE, LIGNECDE, PRODUIT
WHERE CLIENT.NumClient = COMMANDE.NumClient(+)
AND COMMANDE.NumCde = LIGNECDE.NumCde
AND LIGNECDE.Reference = PRODUIT.Reference
GROUP BY CLIENT.NumClient, PRODUIT.Reference
```
 
Également équivalent à :

```sql
SELECT CLIENT.NumClient,
COUNT(DISTINCT PRODUIT.Reference) AS NbProduits
FROM ((CLIENT LEFT OUTER JOIN COMMANDE
ON CLIENT.NumClient = COMMANDE.NumClient)
JOIN LIGNECDE 
ON COMMANDE.NumCde = LIGNECDE.NumCde)
JOIN PRODUIT
ON LIGNECDE.Reference = PRODUIT.Reference
GROUP BY CLIENT.NumClient, PRODUIT.Reference
```



