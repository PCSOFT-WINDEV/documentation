
## Manipuler une base de données depuis une application Java
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>




## Présentation
<a name="presentation_ELTTEXTE000335"></a>
Dès qu'un projet WINDEV est défini comme étant un projet Java, vous pouvez commencer à développer votre application.
Grâce au WLangage, vous pouvez manipuler n'importe quel type de base de données :

- base de données HFSQL.

- base de données non HFSQL. Cette base de données peut être manipulée par un driver JDBC ou par un accès natif WINDEV.


Pour manipuler ces bases de données, WINDEV met à votre disposition :

- [Les fonctions HFSQL](#NOTE2) qui permettent de manipuler directement les fichiers de données (base de données de type HFSQL, MySQL accédée par JDBC, SQL Server accédée par JDBC).

- [Les fonctions SQL](#NOTE5) qui permettent de manipuler directement les fichiers de données (base de données de type HFSQL ou accédée par JDBC (MySQL, SQL Server, Oracle, DB2, ...)).  

- [Le RAD Java](#NOTE8) qui permet de développer rapidement les fenêtres manipulant vos fichiers de données.






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>




## Accéder aux fichiers de données grâce aux fonctions HFSQL
<a name="acceder_aux_fichiers_donnees_grace_aux_fonctions_hfsql_ELTTEXTE000365"></a>
Une application JAVA développée avec WINDEV permet de manipuler des fichiers de données quelle que soit la plateforme sur laquelle l'application Java s'exécute (Windows, Linux ou Mac).

L'utilisation d'une base de données depuis une application Java peut être réalisée par les fonctions HFSQL. Les librairies du Framework WINDEV étant disponibles sous ces environnements, l'accès à la base de données HFSQL par les fonctions HFSQL est immédiat.

**Remarque** : Si l'option "Créer automatiquement les fichiers de donnés si non présents à leur ouverture" est cochée (dans la fenêtre de description du projet, onglet "Fichiers"), les fichiers de données correspondants seront automatiquement créés si nécessaire.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>




## Fonctions HFSQL dans un projet Java
<a name="fonctions_hfsql_dans_projet_java_ELTTEXTE000389"></a>


### Accéder aux fichiers HFSQL
<a name="acceder_aux_fichiers_hfsql_ELTPARAGRAPHE000050"></a>La manipulation des fichiers HFSQL dans un projet Java se fait de la même manière que dans un projet Windows.

Selon la plateforme d'exécution (Windows, Linux ou MacOSX), les librairies nécessaires à l'accès aux bases de données HFSQL peuvent varier. Pour connaître le détail des fichiers nécessaires, consultez [Gestion des bases de données dans des applications Java WINDEV](../Editeurs/9000018.md). 

**Remarque** : Par défaut, les fichiers de données sont installés avec l'archive Java. Il est possible d'installer les fichiers de données dans un répertoire différent. Dans ce cas, il est nécessaire de spécifier le nouveau chemin dans l'application grâce à la fonction [HChangeRep](../WDLang4/3044168.md).


### Configuration du mode d'exécution des applications Java utilisant HFSQL sous MacOSX
<a name="configuration_mode_execution_des_applications_java_utilisant_hfsql_sous_macosx_ELTPARAGRAPHE000065"></a>La version minimale de MacOSX nécessaire pour utiliser des bases de données HFSQL avec une application Java est 10.5.8.


<a name="NOTE3_2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![ODBC](https://doc.pcsoft.fr/ext/images/fr/ODBC.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Accéder à une base de données MySQL, SQL Server ou SQLite par JDBC
<a name="acceder_une_base_donnees_mysql_sql_server_sqlite_par_jdbc_ELTPARAGRAPHE000076"></a>Pour manipuler les fichiers de données décrits dans l'analyse d'un projet Java, il suffit de :


1. Décrire une connexion avec la fonction [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md). Lors de la définition de cette connexion, il est nécessaire de spécifier le driver JDBC à utiliser.

2. Associer cette connexion aux différents fichiers de l'analyse grâce à la fonction [HChangeConnexion](../WDLang4/3044150.md).
	Exemple pour une connexion à une base de données MySQL :
	
	```wl
	HOuvreConnexion("MaConnexionMySQL", "Login", "MotDePasse", ...
		"jdbc:mysql://MonServeur/MaBase", "MaBase", ...
		hAccesJDBCMySQL, 0, "com.mysql.jdbc.Driver")
	HChangeConnexion("*", "MaConnexionMySQL")
	```

	Exemple pour une connexion à une base de données SQLite :
	
	```wl
	ConnexionSQLite est une Connexion
	
	// Paramètres de la connexion
	ConnexionSQLite.Provider = hAccèsJDBCSQLite
	ConnexionSQLite.Serveur = "jdbc:sqlite:mabase.db"
	ConnexionSQLite.Accès = hOLectureEcriture
	ConnexionSQLite.InfosEtendues = "org.sqlite.JDBC"
	// Ouverture de la connexion
	HOuvreConnexion(ConnexionSQLite)
	```

	Remarques dans le cas de l'accès à SQLite : 

	- Les propriétés [Nom](../Proprietes/2510082.md) et [MotDePasse](../Proprietes/2510086.md) sont inutiles,

	- La propriété [Serveur](../Proprietes/2512105.md) permet de configurer l'emplacement et le nom du fichier de la base de données (ici : le fichier s'appelle mabase.db et il se situe dans le répertoire d'exécution de l'application).




3. Lorsque la connexion est définie, vous pouvez utiliser les fonctions HFSQL pour manipuler les enregistrements des fichiers de données.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Accédez aux fichiers de données grâce aux fonctions SQL
<a name="accedez_aux_fichiers_donnees_grace_aux_fonctions_sql_ELTTEXTE000425"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000121"></a>Une application JAVA développée avec WINDEV permet de manipuler des fichiers de données quelle que soit la plateforme sur laquelle l'application Java s'exécute (Windows, Linux ou Mac).

L'utilisation d'une base de données depuis une application Java peut être réalisée par les fonctions SQL. Les librairies du Framework WINDEV étant disponibles sous ces environnements, l'accès à la base de données HFSQL par les fonctions SQL est immédiat.

<a name="NOTE5"></a>
<a name="NOTE5_1"></a>




## Fonctions SQL dans un projet Java
<a name="fonctions_sql_dans_projet_java_ELTTEXTE000449"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) 

### Accéder aux fichiers HFSQL
<a name="acceder_aux_fichiers_hfsql_ELTPARAGRAPHE000135"></a>Pour manipuler les fichiers HFSQL décrits dans l'analyse d'un projet Java, il suffit de :

1. Décrire une connexion avec la fonction [SQLConnecte](../WDLang4/3072005.md). Lors de la définition de cette connexion, il est nécessaire de spécifier l'analyse utilisée (fichier .WDD), ainsi que la base de données (HFSQL).
	Exemple :
	
	```wl
	nNumConnexion est un entier
	nNumConnexion = SQLConnecte("ClientJava.wdd", "", "", "", "HYPER FILE", "", "")
	```


2. Lorsque la connexion est établie, vous pouvez utiliser les fonctions SQL pour manipuler les enregistrements des fichiers de données HFSQL.




**Remarques** :

- Par défaut, les fichiers de données sont installés avec l'archive Java. Il est possible d'installer les fichiers de données dans un répertoire différent. Dans ce cas, il est nécessaire de spécifier le nouveau chemin dans l'application grâce à la fonction [HChangeRep](../WDLang4/3044168.md).

- Pour accéder aux fichiers HFSQL, les librairies suivantes doivent se trouver dans le même répertoire que l'archive Java de l'application (elles sont automatiquement copiées par WINDEV au moment de la génération Java) :

	- **sous Windows** : wd280hf.dll, wd280sql.dll, wd280jav.dll, wd280vm.dll, wd280uni.dll. Les librairies Windows sont présentes dans le sous-répertoire "Programmes" du répertoire d'installation de WINDEV.

	- **sous Linux** : wd280hf.so, wd280sql.so, wd280jav.so, wd280vm.so, wd280uni.so. Les librairies Linux sont présentes dans le sous-répertoire "Programmes\\Framework" du répertoire d'installation de WINDEV.

	- **sous MacOSX** : wd280hf.dylib, wd280sql.dylib, wd280jav.dylib, wd280vm.dylib. Les librairies MacOSX sont présentes dans le sous-répertoire "Programmes\\Framework" du répertoire d'installation de WINDEV.




- Le fichier de l'analyse (fichier WDD) spécifié dans la syntaxe de [SQLConnecte](../WDLang4/3072005.md) doit être accessible depuis l'application Java.



<a name="NOTE5_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![ODBC](https://doc.pcsoft.fr/ext/images/fr/ODBC.png) 

### Accéder à une base de données non HFSQL par JDBC
<a name="acceder_une_base_donnees_non_hfsql_par_jdbc_ELTPARAGRAPHE000198"></a>Pour manipuler les fichiers de données décrits dans l'analyse d'un projet Java, il suffit de :

1. Décrire une connexion avec la fonction [SQLConnecte](../WDLang4/3072005.md). Lors de la définition de cette connexion, il est nécessaire de spécifier l'analyse utilisée (fichier .WDD), ainsi que la base de données (HFSQL).
	Exemple pour une connexion à une base de données MySQL :
	
	```wl
	nNumConnexion est un entier
	nNumConnexion = SQLConnecte("jdbc:mysql://Venus/test", "test", ...
			"mysql", "", "JDBC", NomDriverNomMysql)
	```


2. Lorsque la connexion est établie, vous pouvez utiliser les fonctions SQL pour manipuler les enregistrements des fichiers de données.




<a name="NOTE8"></a>
<a name="NOTE8_1"></a>




## Utilisez le RAD Java
<a name="utilisez_rad_java_ELTTEXTE000479"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### RAD disponibles
<a name="rad_disponibles_ELTPARAGRAPHE000220"></a>Comme sur tout projet WINDEV associé à une analyse, vous pouvez utiliser le RAD pour générer les fenêtres de votre application Java.
Vous pouvez créer des fenêtres fiche, table, ... Le RAD Java prend en compte toutes les spécificités de la génération Java (champs, traitements, fonctions utilisables dans une application WINDEV générée en Java).
Deux types de pattern RAD sont utilisables directement en JAVA :

- Le pattern RAD Simple. 

- Le pattern RAD Compatible 11. 


Le code généré par les autres patterns doit être adapté pour fonctionner en Java.
<a name="NOTE8_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Pattern RAD Simple
<a name="pattern_rad_simple_ELTPARAGRAPHE000238"></a>Ce pattern est adapté à la génération d'une application Java. Comme sur tout projet WINDEV associé à une analyse, vous pouvez utiliser le RAD pour générer les fenêtres de votre application Java.

**Remarque** : Par défaut, le pattern RAD simple manipule des fichiers HFSQL. Si vous voulez utiliser une connexion par JDBC, il est nécessaire d'adapter le code généré. Il suffit de décrire la connexion à utiliser ([HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md)) en spécifiant le driver JDBC à utiliser. Cette connexion est ensuite associée aux différents fichiers de l'analyse grâce à la fonction [HChangeConnexion](../WDLang4/3044150.md).

Exemple pour une connexion à une base de données MySQL :

```wl
HOuvreConnexion("MaConnexionMySQL", "Login", "MotDePasse", ...
	"jdbc:mysql://MonServeur/MaBase", "MaBase", ...
	hAccesJDBCMySQL, 0, "com.mysql.jdbc.Driver")
HChangeConnexion("*", "MaConnexionMySQL")
```

<a name="NOTE8_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Pattern RAD Compatible 11
<a name="pattern_rad_compatible_11_ELTPARAGRAPHE000261"></a>Quel que soit le type de fenêtre à générer, le premier écran de l'assistant permet de spécifier le type de connexion à la base de données :

- HFSQL.

- JDBC.


En sélectionnant "HFSQL", l'assistant classique de création de fenêtre est proposé.
Dans le cas d'une connexion via un driver JDBC, l'étape suivante de la création de la fenêtre permet de spécifier les paramètres de connexion à la base de données utilisant le driver JDBC :

![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=RAD_Java.gif)
Les fenêtres générées par le RAD Java utilisent les fonctions SQL du WLangage. La connexion à la base de données est réalisée grâce à la fonction [SQLConnecte](../WDLang4/3072005.md).
<a name="NOTE8_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Erreurs de compilation
<a name="erreurs_compilation_ELTPARAGRAPHE000283"></a>Un RAD Java effectué avec WINDEV version 10 ou inférieure peut provoquer des erreurs de compilation en version 18 sur les champs présents dans les onglets.

Pour résoudre ces erreurs, préfixez le nom du champ par le nom de l'onglet auquel il appartient. Par exemple, pour le champ "MonChamp" appartenant à l'onglet "MonOnglet", utilisez la notation "MonOnglet.MonChamp".




