


## Briques de code
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000204"></a>
L'éditeur de code vous propose de saisir des "Briques de code". Ces "Briques de code" sont des morceaux de code que vous utilisez souvent. Vous pouvez créer toutes vos briques de code : elles vous seront proposées en permanence pour vous faire gagner du temps.

Ces briques de code peuvent être paramétrées : par exemple, le nom du fichier de données, de la rubrique de parcours, ou encore le nom de la fenêtre peut être un paramètre de votre brique de code. Lors de son utilisation, l'éditeur de code vous demandera de saisir les différents paramètres nécessaires : aucun risque d'erreur !

Les briques de code sont facilement déplaçables d'un projet à l'autre, d'un poste à l'autre, ...

Chaque brique de code est associée à un mot-clé ce qui simplifie sa recherche.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000228"></a>


### Gestionnaire de briques de code
<a name="gestionnaire_briques_code_ELTPARAGRAPHE000029"></a>L'éditeur de code propose un gestionnaire de briques de code. Ce gestionnaire permet de :

- Ajouter une brique de code.

- Modifier une brique de code.

- Utiliser une brique de code.

- Supprimer une brique de code.




Pour afficher ce gestionnaire :  

- Sous l'éditeur de code, sélectionnez l'option "Briques de code .. Afficher toutes les briques de code" du menu contextuel.

- Sous le volet "Accueil", dans le groupe "Environnement", déroulez "Volets" et sélectionnez "Volets" puis "Briques de code". 

<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=BriqueCode_Gestionnaire16.gif)
 
**Remarque** : Par défaut, le gestionnaire de briques de code est vide. Si vous aviez défini des briques de code personnelles dans les versions antérieures, celles-ci sont automatiquement importées. Pour afficher les éléments standard (c'est-à-dire les raccourcis proposés par défaut sur les fonctions WLangage), sélectionnez l'option "Afficher les briques standard" du bouton fléché. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=BriqueCode_Menu.gif)

<a name="NOTE2_2"></a>


### Créer une brique de code
<a name="creer_une_brique_code_ELTPARAGRAPHE000063"></a>La création d'une brique de code peut être effectuée :

- directement depuis le gestionnaire de briques de code. Il suffit de cliquer sur le bouton "+" et de saisir les différentes informations demandées.

- directement depuis l'éditeur de code. Il suffit de sélectionner le code correspondant à  la brique de code et de faire un "Drag and Drop" vers le gestionnaire de briques de code. La fenêtre de description de la brique de code apparaît, avec les informations nécessaires remplies. Si la première ligne de code correspond à  un commentaire, ce commentaire devient automatiquement le titre de la brique de code.




La fenêtre de description d'une brique de code contient les éléments suivants : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=BriqueCode_Description.gif)


1. Titre de la brique de code. Ce titre apparaît dans le gestionnaire de briques de code.

2. Abréviation associée à  la brique de code. Cette abréviation peut être un mot ou un ensemble de mots. Cette abréviation permet d'utiliser la brique de code plus simplement : il suffit de saisir l'abréviation sous l'éditeur de code et d'utiliser la touche F5 : la brique de code correspondante est automatiquement insérée.

3. Code correspondant à la brique de code.

4. Bouton permettant d'insérer des champs automatiques. Il est possible d'insérer les informations suivantes : 

	- **la date et l'heure** de l'insertion de la brique de code dans le code (au format défini dans les paramètres de langues de Windows)

	- **insertion automatique du code sélectionné** : dans ce cas, lorsque la brique de code est "droppée" du gestionnaire de code vers l'éditeur de code, le code actuellement sélectionné sous l'éditeur de code est inséré à  l'endroit indiqué. Cette option est intéressante par exemple dans le cas d'une brique de code permettant de faire un traitement répétitif (boucle, ...).

	- **login** de l'utilisateur insérant la brique de code

	- **paramètre** : cette option permet de remplacer le code sélectionné dans la brique de code par §&lt;Nom du paramètre&gt;§. Vous pouvez remplacer &lt;Nom du paramètre&gt; par le nom voulu. Si la brique de code contient cette option, une fenêtre de saisie des paramètres sera automatiquement affichée lors de l'utilisation de la brique de code.

	- **paramètre avec valeur par défaut** : cette option permet de remplacer le code sélectionné dans la brique de code par §&lt;Nom du paramètre&gt;=&lt;Valeur&gt;§. Vous pouvez remplacer &lt;Nom du paramètre&gt; par le nom voulu et &lt;Valeur&gt; par la valeur par défaut du paramètre. Si la brique de code contient cette option, une fenêtre de saisie des paramètres sera automatiquement affichée lors de l'utilisation de la brique de code.

	- **position du curseur** : cette option permet de déterminer la position du curseur après l'utilisation de la brique de code. Il est ainsi possible par exemple de mettre le curseur dans la partie de code à saisir.







**Emplacement des briques de code** : 
Les briques de code ajoutées sont mémorisées par défaut dans le répertoire "Personnel\\Briques de code" du répertoire d'installation du produit utilisé. Ce répertoire peut être modifié dans les options de WINDEV, WEBDEV ou WINDEV Mobile : 

1. Sous le volet "Accueil", dans le groupe "Environnement", déroulez "Options" et sélectionnez "Options générales de WINDEV/WEBDEV/WINDEV Mobile".

2. Affichez l'onglet "Répertoires" et modifiez le répertoire des briques de code. 




**Remarque** : Le gestionnaire des briques de code permet de gérer l'ensemble des abréviations de l'éditeur de code. Chaque abréviation peut permettre d'accéder à une fonction, une procédure, une propriété, ou un ensemble de ligne de code. Le gestionnaire de briques de code inclut le glossaire présent dans les versions précédentes. Il est possible de créer une brique de code correspondant uniquement à un nom de fonction WLangage. 
<a name="NOTE2_3"></a>


### Utiliser les briques de code
<a name="utiliser_les_briques_code_ELTPARAGRAPHE000109"></a>Pour utiliser les briques de code, plusieurs possibilités sont à  votre disposition :

- Drag and Drop depuis le gestionnaire de briques de code.

- Utilisation de la touche F5 sur le mot-clé associé à la brique de code.




**Remarques** : 

- Lors de la saisie du raccourci correspondant à une brique de code, la saisie assistée propose la brique de code correspondante. Il suffit de la sélectionner et de valider pour l'intégrer au code en cours. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=BriqueCode_Code.gif)


- L'option "Brique de code" du menu contextuel de l'éditeur de code liste les dix dernières briques de code et permet également de les utiliser directement.



<a name="NOTE2_4"></a>


### Partager des briques de code
<a name="partager_des_briques_code_ELTPARAGRAPHE000127"></a>Vous voulez partager vos briques de code entre développeurs ou entre WINDEV, WEBDEV et WINDEV Mobile ?

Il suffit de configurer le répertoire des briques de code dans les options du produit utilisé : 

1. Sous le volet "Accueil", dans le groupe "Environnement", déroulez "Options" et sélectionnez "Options générales de WINDEV/WEBDEV/WINDEV Mobile". 

2. Affichez l'onglet "Répertoires" et modifiez le répertoire des briques de code. 



<a name="NOTE2_5"></a>


### Récupérer les données d'un glossaire personnalisé
<a name="recuperer_les_donnees_glossaire_personnalise_ELTPARAGRAPHE000151"></a>Si vous aviez personnalisé votre glossaire dans une version précédente, il est possible de récupérer ces données :  

1. Sélectionnez l'option "Importer un glossaire" du bouton fléché. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=BriqueCode_Menu.gif)


2. Sélectionnez le fichier "WX_Gloss.fic" présent dans le sous-répertoire "Personnel" du produit utilisé. Le fichier est automatiquement importé.  





