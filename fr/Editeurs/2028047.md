
## Répertoire d'installation
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000323"></a>
L'assistant de création d'installation permet de spécifier le répertoire d'installation. 

Dans l'étape "Répertoire d'installation" de l'assistant, il est possible de préciser : 

- [le paramétrage de base](#NOTE2_1), 

- [le paramétrage avancé](#NOTE3_1), 

- [la prise en charge de l'UAC pour l'installeur](#NOTE4_1). 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Paramétrage de base
<a name="parametrage_base_ELTTEXTE000347"></a>


### Chemin par défaut de l'installation sur la machine de l'utilisateur final
<a name="chemin_par_defaut_installation_sur_machine_utilisateur_final_ELTPARAGRAPHE000031"></a>Le paramétrage de l'installation permet de sélectionner le répertoire d'installation proposé par défaut. L'utilisateur pourra modifier ce répertoire lors de l'installation de l'application.

Par défaut, ce répertoire est "C:\\Program Files\\&lt;NomApplication&gt;".


### Chemin par défaut de l'installation de référence (installation réseau uniquement)
<a name="chemin_par_defaut_installation_reference_installation_reseau_uniquement_ELTPARAGRAPHE000040"></a>Le paramétrage de l'installation permet de sélectionner le répertoire d'installation de l'installation de référence proposé par défaut. L'utilisateur pourra modifier ce répertoire lors de l'installation de l'application.

Ce chemin n'est pas obligatoire. 



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Paramétrage avancé du répertoire d'installation
<a name="parametrage_avance_repertoire_installation_ELTTEXTE000377"></a>
Pour accéder au paramétrage avancé de l'installation de votre application, cliquez sur le bouton "Avancé".

Ces paramètres avancés permettent de :

- [Proposer à l'utilisateur de sauvegarder les fichiers remplacés](#NOTE3_2).

- [Exécuter un programme à la fin de l'installation](#NOTE3_3).

- [Paramétrer une installation silencieuse](#NOTE3_Silence).

- [Modifier l'identifiant utilisé pour la désinstallation de l'application](#NOTE3_4).

- [Modifier ou créer le fichier "AutoExec.BAT"](#NOTE3_5).

- [Modifier ou créer des fichiers ".INI"](#NOTE3_6).

- [Modifier ou créer des valeurs dans la base de registre](#NOTE3_7).





<a name="NOTE3_2"></a>


### Proposer à l'utilisateur de sauvegarder les fichiers remplacés
<a name="proposer_utilisateur_sauvegarder_les_fichiers_remplaces_ELTPARAGRAPHE000084"></a>Lors de la mise à jour d'une application, il est possible d'intégrer dans le programme d'installation un plan supplémentaire. Ce plan supplémentaire propose à l'utilisateur de sauvegarder les fichiers remplacés dans un répertoire de sauvegarde. Par défaut, ce répertoire de sauvegarde sera nommé "Sauvegarde_ &lt;DateSauvegarde&gt;_ &lt;HeureSauvegarde&gt;".

![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Info_affiches_install%20-%20HC%20N%B0003.gif)


Cette sauvegarde pourra être utilisée par exemple en cas d'échec de l'installation. Pour utiliser cette sauvegarde, l'utilisateur devra copier les fichiers présents dans le répertoire de sauvegarde vers le répertoire d'installation de l'application.

Par défaut, la sauvegarde des fichiers remplacés est proposée aux utilisateurs.


<a name="NOTE3_3"></a>


### Exécuter un programme à la fin de l'installation
<a name="executer_programme_fin_installation_ELTPARAGRAPHE000098"></a>Par défaut, le programme d'installation propose à l'utilisateur de lancer l'exécutable de l'application à la fin de l'installation. L'option "Lancer le programme" est cochée. En cliquant sur le bouton "Terminer", l'exécutable est automatiquement lancé.

L'assistant de création du programme d'installation permet de spécifier l'exécutable à lancer et d'associer des paramètres à cet exécutable. Seul un exécutable (fichier ".EXE") peut être lancé.

L'exécutable à lancer correspond :

- au nom et au chemin complet du fichier exécutable. Il est possible d'utiliser les mots-clés suivants :

	- **&lt;RepInst&gt;** : répertoire d'installation choisi par l'utilisateur lors de l'installation.

	- **&lt;LectInst&gt;** : lecteur du répertoire d'installation choisi par l'utilisateur lors de l'installation.

	- **&lt;FicInst&gt;** : répertoire d'installation des fichiers de données. L'assistant de création du programme d'installation permet de paramétrer ce répertoire. Pour plus de détails, consultez [Paramétrer le répertoire des fichiers de données](../Editeurs/2028045.md).

	- **&lt;RepWin&gt;** : répertoire de Windows des postes utilisateurs.

	- **&lt;RepSys&gt;** : répertoire système.

	- **&lt;RepRef&gt;** : répertoire de référence pour les installations avec mise à jour automatique uniquement.




- aux paramètres d'exécution du programme installé (si nécessaire).




Par exemple : "&lt;RepInst&gt;\\MonAppli.EXE /Param".

Remarque : Si des modifications sont effectuées dans le fichier "AutoExec.BAT", il est conseillé de ne pas exécuter de programme à la fin de l'installation. En effet, les modifications apportées dans ce fichier seront prises en compte uniquement au prochain démarrage de l'ordinateur.


<a name="NOTE3_Silence"></a>


### Paramétrer une installation silencieuse
<a name="parametrer_une_installation_silencieuse_ELTPARAGRAPHE000129"></a>Les installations de la version de référence et de la version cliente peuvent être réalisées de façon silencieuse. Dans ce cas, l'installation se fera sans demander aucune intervention de la part de l'utilisateur. Les options définies par défaut seront automatiquement utilisées. 

Les options disponibles sont : 

- **Installation cliente silencieuse** : l'installation de l'application pour l'utilisateur final ne nécessite aucune action de la part de l'utilisateur. 

- **Déploiement de la version de référence silencieux** (disponible uniquement lors d'une installation avec mise à jour automatique) : l'installation de la version de référence de l'installation réseau sera effectuée sans intervention de l'utilisateur.  





<a name="NOTE3_4"></a>


### Modifier l'identifiant utilisé pour la désinstallation de l'application
<a name="modifier_identifiant_utilise_pour_desinstallation_application_ELTPARAGRAPHE000142"></a>Si vous avez choisi de permettre la désinstallation de votre application, un identifiant spécifique est automatiquement créé dans la base de registre. Cet identifiant peut être modifié grâce à l'assistant de création du programme d'installation.

Par défaut, cet identifiant est "&lt;NomApplicationSansEspace&gt;". Par exemple, "WDClient" pour l'application "WD Client". Cet identifiant peut contenir ou non des espaces.

Cet identifiant sera créé dans la clé :

- "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall" sous Windows 2000 et NT.

- "HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall" sous Windows 98 et Me.





<a name="NOTE3_5"></a>


### Modifier ou créer le fichier "AutoExec.BAT"
<a name="modifier_creer_fichier_autoexecbat_ELTPARAGRAPHE000157"></a>Il est possible de modifier ou de créer le fichier "AutoExec.BAT" sur les postes d'installation. Ce fichier sera modifié ou créé (si nécessaire) au prochain démarrage de l'ordinateur. Dans ce cas, le redémarrage de l'ordinateur est automatiquement proposé à la fin de l'installation de l'application.

Le fichier "AutoExec.BAT" permet par exemple de :

- ajouter le répertoire de l'exécutable de l'application dans le PATH.

- lancer l'application au démarrage du poste d'installation.

- ...




Rappels :

- Le fichier "AutoExec.BAT" s'exécute automatiquement au démarrage de l'ordinateur.

- Le PATH liste les répertoires dans lesquels les exécutables (fichiers ".EXE") et les librairies (fichiers ".DLL") sont recherchés en priorité.





<a name="NOTE3_6"></a>


### Modifier ou créer des fichiers ".INI"
<a name="modifier_creer_des_fichiers_ini_ELTPARAGRAPHE000176"></a>Lors de l'installation d'une application WINDEV, il est possible de modifier ou de créer des fichiers ".INI" sur les postes d'installation. Ces fichiers seront associés à l'application installée.

Les fichiers ".INI" permettent par exemple de :

- personnaliser l'application selon l'utilisateur connecté.

- définir les paramètres par défaut de l'application.

- ...




Les fichiers ".INI" pourront ensuite être lus et modifiés directement depuis l'application (fonctions [INILit](../WDLang1/3013043.md) et [INIEcrit](../WDLang1/3013039.md) du WLangage).

**Exemple de modification**
Par exemple, pour enregistrer la langue d'exécution du programme d'installation dans le fichier "MonAppli.INI" (présent dans le répertoire d'installation de l'application) :

- Fichier ".INI" : &lt;RepInst&gt;\\MonAppli.INI

- Section : LANGUE

- Paramètre : LANGUE_INSTALL

- Valeur : &lt;Langue&gt;




Le mot-clé **&lt;Langue&gt;** sera automatiquement remplacé lors de l'installation par le numéro de la langue d'exécution du programme d'installation (ce numéro est utilisable avec la fonction [Nation](../WDLang1/3054014.md)).

Dans notre exemple, si le numéro de la langue d'exécution est 3, le paramètre suivant sera ajouté dans le fichier "MonAppli.INI" : 

```txt
[LANGUE]
LANGUE_INSTALL=3
```



<a name="NOTE3_7"></a>


### Modifier ou créer des valeurs dans la base de registre
<a name="modifier_creer_des_valeurs_dans_base_registre_ELTPARAGRAPHE000215"></a>Lors de l'installation d'une application WINDEV, il est possible de modifier ou de créer des entrées dans la base de registre.

La base de registre permet par exemple de :

- personnaliser l'application selon l'utilisateur connecté.

- définir les paramètres par défaut de l'application.

- ...




La base de registre pourra ensuite être lue et modifiée directement depuis l'application (fonctions [RegistreEcrit](../WDLang1/3065006.md), [RegistreLit](../WDLang1/3065012.md), ...).

Exemple de modification
Par exemple, pour enregistrer dans la base de registre la langue d'exécution du programme d'installation, saisissez :

- Clé : HKEY_LOCAL_MACHINE\\Software\\MaSociété\\MonAppli\\1.0\\

- Nom : Langue

- Valeur : &lt;Langue&gt;


Le mot-clé **&lt;Langue&gt;** sera automatiquement remplacé lors de l'installation par le numéro de la langue d'exécution du programme d'installation (ce numéro est utilisable avec la fonction [Nation](../WDLang1/3054014.md)).



<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Prise en charge de l'UAC pour l'installeur
<a name="prise_charge_uac_pour_installeur_ELTTEXTE000443"></a>
Par défaut, l'installation d'une application WINDEV déclenche l'UAC.

Pour accéder au paramétrage de la prise en charge de l'UAC, cliquez sur le bouton "Prise en charge de l'UAC".

La fenêtre qui s'affiche permet de modifier ce mode de fonctionnement grâce à l'option "L'installeur NE nécessite PAS les droits administrateur" : 

- pour les installations individuelles : l'UAC est désactivée pour l'installation sur le poste de l'utilisateur final. 

- pour les installations réseau avec mise à jour automatique. Dans ce cas, l'UAC peut être désactivée : 

	- pour l'installeur de l'utilisateur final, 

	- pour l'installeur de la version de référence, 

	- pour les deux. 







Attention : L'option "Ne nécessite pas les droits administrateur" entraîne certaines restrictions : pas d'installation de fichiers dans les répertoires systèmes (Program Files, Windows...), pas de modifications des fichiers et paramètres systèmes (win.ini, path, ...). 

L'installation échouera si les droits ne sont pas suffisants. Dans la mesure du possible, l'assistant d'installation guidera l'utilisateur dans ses choix pour lui permettre d'installer l'application. 

Remarque : Il est également possible de configurer la prise en charge de l'UAC pour l'installeur dans les [options avancées de l'installeur](../Editeurs/2028108.md). Ces options sont accessibles dans l'étape "Support" de l'assistant de création d'installation. 






