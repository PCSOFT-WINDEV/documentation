


## Tests automatiques sur un exécutable
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000226"></a>
WINDEV propose de lancer les différents tests d'un projet directement sur l'exécutable correspondant. Il est ainsi possible de tester un exécutable dans les conditions réelles d'un déploiement.

**Le principe est simple** : 

1. Un automate de test (WDAutomate.exe) fonctionnant avec son propre framework permet de lancer l'exécutable voulu.

2. L'exécutable à tester doit être dans les conditions d'utilisation des utilisateurs finaux (avec si nécessaire les accès aux bases de données utilisées ou à une base de test équivalente, le framework utilisé, ...).

3. Pour lancer les différents tests, l'exécutable à tester charge une bibliothèque spécifique contenant les tests.

4. Les différents tests sont exécutés et le résultat est enregistré dans les Centres de Contrôle. Le résultat est visible :

	- depuis l'automate de tests (en sélectionnant l'exécutable et la bibliothèque de tests).

	- depuis WINDEV (pour la version du projet avec laquelle l'exécutable a été créé).







Remarque : Les tests automatiques ne fonctionnent pas sur une session TSE non interactive. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Lancer les tests automatiques d'un exécutable depuis WINDEV
<a name="lancer_les_tests_automatiques_executable_depuis_windev_ELTTEXTE000250"></a>
Pour lancer directement les tests automatiques sur un exécutable depuis WINDEV : 

1. Créez l'exécutable : déroulez ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_generation_exe.gif)
 parmi les boutons d'accès rapide et sélectionnez "Générer l'exécutable Windows (32 bits)" par exemple.

2. Générez la bibliothèque de tests : sous le volet "Tests automatiques", dans le groupe "Automate de test", cliquez sur "Générer la bibliothèque". La bibliothèque de tests est de la forme TEST_&lt;NomProjet&gt;.WDL. Cette bibliothèque est créée dans le sous-répertoire "Données des tests automatiques" du projet.

3. Lancez les tests sur l'exécutable : sous le volet "Tests automatiques", dans le groupe "Automate de test", cliquez sur "Lancer l'automate". Dans cette fenêtre, vous devez sélectionner :

	- Le produit concerné (WINDEV).

	- L'exécutable à tester.

	- La bibliothèque de tests à utiliser.

	- La ligne de commande (si nécessaire).

	- Les tests à exécuter.
			Remarque : Si l'exécutable contient des composants internes, les tests automatiques de ces composants internes apparaissent également dans la liste des tests pouvant être exécutés.




4. Cliquez sur le bouton "Lancer les tests". Les tests sont automatiquement exécutés et le résultat est ensuite affiché dans l'automate de tests.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Lancer les tests automatiques d'un exécutable sans WINDEV
<a name="lancer_les_tests_automatiques_executable_sans_windev_ELTTEXTE000274"></a>
Les tests automatiques d'un exécutable WINDEV peuvent être lancés sans que le produit correspondant ne soit installé sur le poste en cours. Cependant, certains fichiers sont nécessaires :

- Fichiers nécessaires au lancement de l'automate de tests :

	- WDAutomate.exe

	- WDOutil.wdk

	- wd280xx.dll

	- wd280test.dll




- Fichiers nécessaires à l'enregistrement des résultats des tests : Fichiers de données des Centres de Contrôle. Au moins un Centre de Contrôle doit être installé sur le poste.
	Les fichiers de données des Centres de Contrôle doivent être ceux utilisés sur le poste de développement (afin de pouvoir consulter le résultat des tests). Plusieurs cas peuvent se présenter :

	- si les Centres de Contrôle utilisent une base Client/Serveur, les données des Centres de Contrôle sont partagées par les postes.

	- si les Centres de Contrôle utilisent une base HFSQL Classic en réseau, les données des Centres de Contrôle sont présentes dans un répertoire partagé.




- Exécutable à tester avec son framework (et les accès nécessaires au test). 

- Bibliothèque de tests et données de test (le sous-répertoire du projet "Données des tests automatiques" doit être copié sur le poste)


Le résultat des tests automatiques pourra être consulté directement sous WINDEV : il suffit d'ouvrir le projet correspondant à l'exécutable.
<a name="NOTE4_2"></a>


### Attention
<a name="attention_ELTPARAGRAPHE000104"></a>Pour tester un exécutable créé avec une version précédente de WINDEV, l'automate doit avoir accès à la librairie WD280Test.DLL correspondant à la version de l'exécutable. 

Il est donc nécessaire de copier la librairie WD280Test.DLL correspondant à la version de l'exécutable testé à côté de WDAutomate.exe.
<a name="NOTE4_3"></a>


### Ligne de commande
<a name="ligne_commande_ELTPARAGRAPHE000117"></a>Il est possible d'exécuter WDAutomate en ligne de commande avec deux syntaxes : 

- Syntaxe 1 : Passage de l'exécutable et de la bibliothèque de test directement : 
	
	```txt
	WDAutomate [EXE=<Nom et chemin de l'exécutable a tester>] 
		[/WDL=<Nom et chemin de la bibliothèque de tests automatiques>]
	```


- Syntaxe 2 : Utilisation d'un fichier de script : 
	
	```txt
	WDAutomate [/SCRIPT=<Chemin du fichier de script>]
	```
Dans ce cas le &lt;Chemin du fichier de script&gt; correspond à un fichier texte au format XML avec le contenu suivant : 
	
	```txt
	<?xml version="1.0"?>
	<EnsembleTest>
	  <EXE>Nom et chemin de l'exécutable à tester</EXE>
	  <LC>Ligne de commande à passer à l'exécutable</LC>
	  <WDL>Nom et chemin de la bibliothèque de tests automatiques</WDL>
	</EnsembleTest>
	```

	Dans ce cas, le résultat des scripts lancés sera présent dans une balise &lt;Résultats&gt; du fichier de script. 




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Enregistrer le test automatique d'un exécutable sans WINDEV
<a name="enregistrer_test_automatique_executable_sans_windev_ELTTEXTE000310"></a>
L'enregistrement de scénario de test peut être activé par une entrée dans le fichier .wx de l'application.

**Rappel** : Le fichier .wx doit permet de paramétrer certaines fonctionnalités de l'exécutable. Il doit porter le même nom que le .EXE et se trouver dans le même répertoire. Son extension est .wx (en majuscules ou minuscules).

Il est nécessaire d'ajouter dans le fichier .wx la section suivante :

```txt
[SCENARIO]
ACTIF=1
FICHIER=<nom et chemin du fichier scénario de test à enregistrer 
(ce fichier doit porter l'extension .wsct)>
CHEMINDLL=<chemin des dll nécessaires à l'enregistrement de scénario>
```
Cette méthode peut être employée si l'exécutable n'utilise pas la même version des DLL que l'automate de test (WDAutomate.exe) et qu'il est donc impossible de faire cohabiter les deux applications dans le même répertoire.

Deux DLLs supplémentaire sont nécessaire pour l'enregistrement de test : wd280test.dll et wdtest.dll.


### Traduction des entrées du fichier .wx
<a name="traduction_des_entrees_fichier_ELTPARAGRAPHE000153"></a>Les entrées du fichier .wx peuvent être en français ou en anglais. En anglais, la section à ajouter est la suivante :

```txt
[SCENARIO]
ENABLED=1
FILE=<nom et chemin du fichier scénario de test à enregistrer 
(ce fichier doit porter l'extension .wsct)>
DLLPATH=<chemin des dll nécessaires à l'enregistrement de scénario>
```


<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Evénement "Test automatique" du projet
<a name="evenement_test_automatique_projet_ELTTEXTE000340"></a>
WINDEV permet d'activer ou non l'événement "Test automatique" du projet. Sous le volet "Tests automatiques", cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_regroup.gif)
 du groupe "Tests" et sélectionnez :

- soit "Activer le code de test automatique du projet".

- soit "Désactiver le code de test automatique du projet".




Cet événement est exécuté avant le code d'initialisation du projet dans le cas d'un test automatique. Ce code permet de traiter certains cas particuliers où le test automatique peut être bloqué : ouverture d'une fenêtre dans le code d'initialisation du projet (fenêtre de paramétrage, fenêtre de licence, fenêtre de login personnalisée, etc.).

L'événement "Test automatique" du projet permet d'utiliser par exemple la fonction [PiloteFenêtre](../WDLang1/1000009009.md) pour valider la fenêtre.


