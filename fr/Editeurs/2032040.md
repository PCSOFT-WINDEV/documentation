


## Mode de création de requêtes : requête indépendante ou intégrée 
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000241"></a>
L'éditeur de requêtes peut être utilisé de deux façons différentes pour créer une requête :

- création de la requête directement sous l'éditeur de requêtes : 

	- Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif) parmi les boutons d'accès rapide. 

	- La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Requêtes" et sélectionnez le type de requête à créer.
			Cette requête correspond à un élément du projet (fichier ".WDR") et peut être utilisée comme source de données d'un état, d'un champ d'une fenêtre ou d'une page (champ Liste, Combo ou Table), en programmation, dans une autre requête, ... La **requête est dite indépendante**.




- création de la requête lors de la création du champ Liste, Table ou de l'état basé sur cette requête (option "Une requête que je veux définir maintenant" dans l'assistant de création du champ ou de l'état). Aucun fichier spécifique n'est créé. La **requête est dite intégrée**.




Une requête intégrée ne peut pas être utilisée comme source de données d'un élément (état, ...) différent de celui où cette requête a été créée.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000265"></a>


### Champ d'une fenêtre ou d'une page : passer du mode intégré au mode indépendant
<a name="champ_une_fenetre_une_page_passer_mode_integre_mode_independant_ELTPARAGRAPHE000030"></a>Pour extraire une requête d'un champ d'une fenêtre ou d'une page :

1. Affichez la fenêtre ou la page sous l'éditeur.

2. Sélectionnez le champ basé sur une requête intégrée.

3. Dans le menu contextuel du champ, sélectionnez l'option "Requête intégrée .. Ouvrir la requête associée". 
	Attention : la fenêtre ou la page doit avoir été enregistrée au moins une fois.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Requete_menuIntegre.gif)


4. L'éditeur de requêtes s'ouvre et affiche le graphe de la requête. Sous le volet "Accueil", dans le groupe "Général", déroulez "Enregistrer" et sélectionnez "Exporter .. Vers une requête indépendante".

5. Enregistrez la nouvelle requête. La requête est désormais indépendante. Vous pouvez l'utiliser dans toutes les fenêtres, les pages et états de votre projet.



<a name="NOTE2_2"></a>


### Etat basé sur une requête intégrée : Passer du mode intégré au mode indépendant
<a name="etat_base_sur_une_requete_integree_passer_mode_integre_mode_independant_ELTPARAGRAPHE000058"></a>Pour extraire une requête d'un état : 

1. Affichez l'état sur requête intégrée (sous l'éditeur d'états).

2. Sélectionnez l'option "Éditer la requête" du menu contextuel de l'état. La requête s'affiche sous l'éditeur de requêtes. Attention : l'état doit avoir été enregistré au moins une fois.

3. Sous le volet "Accueil", dans le groupe "Général", déroulez "Enregistrer" et sélectionnez "Exporter .. Vers une requête indépendante".

4. Enregistrez la nouvelle requête. La requête est désormais indépendante.



<a name="NOTE2_3"></a>


### Manipuler une rubrique de la requête intégrée par programmation
<a name="manipuler_une_rubrique_requete_integree_par_programmation_ELTPARAGRAPHE000082"></a>Pour accéder à une rubrique de la requête intégrée depuis un des codes du champ ou de l'état associé à cette requête, utilisez la syntaxe : 

```txt
MaSource.MaRubrique
```

Ce mot-clé [MaSource](../Motscles/1511001.md) permet notamment de manipuler les paramètres d'une requête intégrée (dans les états, les champs Combo, Liste et Table fichier).

**Remarque** : le mot-clé [MaSource](../Motscles/1511001.md) ne doit pas être utilisé dans le code d'initialisation du champ ou dans le code d'ouverture de l'état.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Comment manipuler les requêtes indépendantes ou intégrées ?
<a name="comment_manipuler_les_requetes_independantes_integrees_ELTTEXTE000301"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Sous l'éditeur de pages ou de fenêtres : Tableau récapitulatif
<a name="sous_editeur_pages_fenetres_tableau_recapitulatif_ELTPARAGRAPHE000105"></a>

| Type de requête | Requête intégrée | Requête indépendante |
| --- | --- | --- |
| **Fonction d'initialisation** | **Requête non paramétrée** : Initialisation automatique.<br><br>**Requête paramétrée** : Il est nécessaire de spécifier les paramètres :<br><br>- soit avec la fonction [hExécuteRequête](../WDLang4/3044080.md).<br><br>- soit en utilisant la notation &lt;Nom requête&gt;.&lt;Nom paramètre&gt; ou MaSource.&lt;Nom paramètre&gt;.<br><br><br> | **Requête non paramétrée** : Initialisation automatique.<br>Il est également possible d'utiliser la fonction [hExécuteRequête](../WDLang4/3044080.md).<br><br>**Requête paramétrée** : Il est nécessaire de spécifier les paramètres :<br><br>- soit avec la fonction [hExécuteRequête](../WDLang4/3044080.md).<br><br>- soit en utilisant la notation &lt;Nom requête&gt;.&lt;Nom paramètre&gt;.<br><br><br> |
| **Fonction permettant de passer le paramètre hRequêteSansCorrection** | Transformer la requête intégrée en requête indépendante | [hExécuteRequête](../WDLang4/3044080.md) |


Pour plus de détails sur la gestion des requêtes dans les champs, consultez [Champs Table, Liste et Combo fichier liés à des requêtes](../WDChamp/1013203.md).
<a name="NOTE3_2"></a>


### Sous l'éditeur d'états : Tableau récapitulatif
<a name="sous_editeur_etats_tableau_recapitulatif_ELTPARAGRAPHE000159"></a>

| Type de requête | Requête intégrée | Requête indépendante |
| --- | --- | --- |
| **Fonction d'initialisation** | **Requête non paramétrée** : [iInitRequêteEtat](../WDLang5/3046021.md)<br><br>**Requête paramétrée** : Il est nécessaire de spécifier les paramètres :<br><br>- soit avec la fonction [iInitRequêteEtat](../WDLang5/3046021.md).<br><br>- soit en utilisant la notation MaSource.&lt;Nom paramètre&gt;.<br><br><br> | [hExécuteRequête](../WDLang4/3044080.md), [iInitRequêteEtat](../WDLang5/3046021.md) |
| **Fonction permettant de passer le paramètre hRequêteSansCorrection** | Transformer la requête intégrée en requête indépendante | [hExécuteRequête](../WDLang4/3044080.md) |




