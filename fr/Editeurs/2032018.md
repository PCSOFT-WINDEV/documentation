


## Jointures entre les fichiers de données d'une requête de sélection 
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000201"></a>
Lorsque plusieurs fichiers de données sont utilisés dans une requête, l'éditeur de requêtes recherche automatiquement les liaisons décrites dans l'analyse entre ces fichiers de données. Ces liaisons sont appelées des jointures sous l'éditeur de requêtes.

Par exemple, la requête suivante sélectionne les numéros des commandes passées par les clients habitant à Toulouse. Les fichiers de données COMMANDE et CLIENT sont reliés par la rubrique NumClient. L'éditeur de requêtes a automatiquement défini la jointure entre ces deux fichiers de données.

![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Requete_exemplePlusieursFic.gif)
**Remarque** : Les liaisons entre les fichiers de données apparaissent dans la représentation graphique de la requête uniquement si les deux fichiers de données reliés sont utilisés par la requête.

Par défaut, l'éditeur de requêtes crée automatiquement les jointures. Cependant, ces jointures peuvent ne pas correspondre au résultat voulu. Il est donc possible d'ajouter ou de supprimer les jointures. Les paragraphes suivants décrivent comment effectuer ces opérations.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000225"></a>


### Ajouter une jointure dans la requête de sélection en cours
<a name="ajouter_une_jointure_dans_requete_selection_cours_ELTPARAGRAPHE000024"></a>Pour ajouter une jointure dans la requête de sélection en cours :

1. Sélectionnez l'option "Éditer la jointure" avec un clic droit sur la jointure. La fenêtre de description des jointures de la requête s'affiche.

2. Cliquez sur le bouton "Ajouter une jointure". Une fenêtre permettant de définir une nouvelle jointure s'affiche.

3. Spécifiez les caractéristiques de la jointure à ajouter.

4. Validez. La jointure est automatiquement ajoutée dans la requête.




Il est ainsi possible de créer des jointures multiples entre deux fichiers de données.
<a name="NOTE2_2"></a>


### Supprimer une jointure dans la requête de sélection en cours
<a name="supprimer_une_jointure_dans_requete_selection_cours_ELTPARAGRAPHE000038"></a>Pour supprimer une jointure dans la requête de sélection en cours :

1. Sélectionnez l'option "Éditer la jointure" avec un clic droit sur la jointure. La fenêtre de description des jointures de la requête s'affiche.

2. Sélectionnez la jointure à supprimer.

3. Cliquez sur le bouton "Supprimer la jointure". La jointure est automatiquement supprimée. Les jointures entre les fichiers de données sont automatiquement optimisées pour conserver le bon fonctionnement de la requête.



<a name="NOTE2_3"></a>


### Notion de jointure externe dans la requête de sélection en cours
<a name="notion_jointure_externe_dans_requete_selection_cours_ELTPARAGRAPHE000049"></a>Lors du calcul d'une jointure entre deux fichiers de données (fichier "Parent" et fichier "Fils"), par défaut seuls les enregistrements ayant une correspondance dans les deux fichiers de données sont conservés. Toutefois, il est possible grâce à la notion de "Jointure externe" de définir une règle pour inclure également : 

- les enregistrements du fichier "Parent" qui n'ont pas de correspondance dans le fichier "Fils".

- les enregistrements du fichier "Fils" qui n'ont pas de correspondance dans le fichier "Parent".




Pour définir une jointure externe dans la requête de sélection en cours :

1. Sélectionnez l'option "Éditer la jointure" avec un clic droit sur la jointure. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Jointure_Requ%EAte%20-%20HC%20N%B0001.gif)


2. La fenêtre de description des jointures de la requête s'affiche.

3. Sélectionnez la jointure à modifier.

4. Sur cette jointure, deux options sont disponibles permettant de définir une jointure externe ("Inclure également"). 

5. Sélectionnez la ou les options correspondant au résultat voulu.
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Jointure_Requ%EAte%20-%20HC%20N%B0002.gif&type=thumb)


6. Validez. 



<a name="NOTE2_4"></a>


### Editer les conditions d'une jointure dans la requête de sélection en cours
<a name="editer_les_conditions_une_jointure_dans_requete_selection_cours_ELTPARAGRAPHE000071"></a>Pour éditer les conditions d'une jointure dans la requête de sélection en cours :

1. Sélectionnez l'option "Éditer la jointure" avec un clic droit sur la jointure. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Jointure_Requ%EAte%20-%20HC%20N%B0001.gif)


2. La fenêtre de description des jointures de la requête s'affiche. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Jointure_Requ%EAte%20-%20HC%20N%B0002.gif&type=thumb)


3. Sélectionnez la jointure à éditer.

4. Cliquez sur le bouton "Editer les conditions de la jointure". La fenêtre d'édition des conditions s'affiche.![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Jointure_Requ%EAte%20-%20HC%20N%B0003.gif)


5. Vous pouvez : 

	- Ajouter une nouvelle condition. ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Jointure_Requ%EAte%20-%20HC%20N%B0003%201.gif)


	- Modifier une condition. ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Jointure_Requ%EAte%20-%20HC%20N%B0003%202.gif)





### Ajouter une condition
<a name="ajouter_une_condition_ELTPARAGRAPHE000093"></a>Pour ajouter une condition : 

1. Cliquez sur le bouton ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Jointure_Requ%EAte%20-%20HC%20N%B0003%201.gif)
. La fenêtre de création d'une condition s'affiche.![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Jointure_Requ%EAte%20-%20HC%20N%B0004.gif)


2. Sélectionnez la rubrique pour laquelle la condition doit être créée (1). Seules les rubriques de type "clé" sont proposées.

3. Sélectionnez l'opération à réaliser parmi la liste proposée (2). 

4. Sélectionnez le type de l'élément à comparer pour l'opération à réaliser (3) : 

	- la valeur : cette option est sélectionnée dans le cas d'une valeur statique (en dur) dans la requête.

	- le paramètre : cette option est sélectionnée dans le cas d'un passage de paramètres lors de l'exécution de la requête.

	- la rubrique : cette option est sélectionnée dans le cas d'une comparaison avec une rubrique d'un autre fichier de la requête. Seules les rubriques de type "clé" sont proposées.




5. Validez. La condition est ajoutée à la condition précédente. 

6. Pensez à vérifier l'enchaînement logique des conditions ainsi créées. 




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Limitations et remarques
<a name="limitations_remarques_ELTTEXTE000273"></a>


### Jointures spécifiques
<a name="jointures_specifiques_ELTPARAGRAPHE000116"></a>Les jointures du type (A Join B on x=y) Join C on y=z ne sont pas gérées.

Pour exécuter des requêtes avec de telles jointures, il est nécessaire d'utiliser la fonction [HExécuteRequête](../WDLang4/3044080.md) ou [HExécuteRequêteSQL](../WDLang4/3044084.md) avec la constante *hRequêteSansCorrection*.
<a name="NOTE3_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Syntaxe SQL Server des jointures
<a name="syntaxe_sql_server_des_jointures_ELTPARAGRAPHE000133"></a>La syntaxe SQL Server des jointures est gérée (en édition d'une requête SQL et en exécution). Pour exécuter ces requêtes, il est possible d'utiliser la fonction [HExécuteRequête](../WDLang4/3044080.md) ou [HExécuteRequêteSQL](../WDLang4/3044084.md).
<a name="NOTE3_3"></a>


### Paramètres avancés
<a name="parametres_avances_ELTPARAGRAPHE000146"></a>Par défaut, les jointures utilisent la syntaxe ISO (INNER JOIN / LEFT OUTER JOIN / RIGHT OUTER JOIN / FULL JOIN). Il est possible d'utiliser également la syntaxe Oracle des jointures. Cependant, cette syntaxe compatible avec Oracle 7 n'est pas conseillée. 

Pour utiliser la syntaxe Oracle : 

1. Affichez la fenêtre de description de la requête. 

2. Cliquez sur le bouton "Avancé". 

3. Dans l'onglet "Jointures", sélectionnez le type de syntaxe voulue. 





