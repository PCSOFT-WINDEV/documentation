
## Importer des classes et des collections de procédures (fichier texte)
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000141"></a>
A partir de la version 23, il est possible d'importer des classes ou des collections de procédures existantes au format texte.

Ainsi, les équipes de développement peuvent par exemple créer un générateur de classes correspondant à leur architecture de développement.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Importer une classe sous forme de fichier texte
<a name="importer_une_classe_sous_forme_fichier_texte_ELTTEXTE000165"></a>


### Comment le faire ?
<a name="comment_faire_ELTPARAGRAPHE000018"></a>Pour importer une classe sous forme d'un fichier texte dans un projet : 

1. Ouvrez le projet voulu. 

2. Dans le volet "Explorateur de projet", sélectionnez le dossier "Classes". 

3. Dans le menu contextuel (clic droit), sélectionnez l'option "Importer des fichiers texte". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Import_classe_txt%20-%20HC%20N%B0001.gif)


4. Dans le sélecteur de fichiers qui s'ouvre, sélectionnez le ou les fichier(s) texte(s) à importer et validez. 
	Rappel : Les touches Maj ou Ctrl permettent d'effectuer une multisélection. 

5. La ou les classes sont importées dans le projet. 





### Remarques
<a name="remarques_ELTPARAGRAPHE000032"></a>

- Le nom du fichier texte correspond au nom de la classe à importer. Par exemple, le fichier "ClasseA.txt" permet d'importer la description de la classe "ClasseA".  

- Il est possible de sélectionner plusieurs fichiers. Chaque fichier texte correspond à une classe. 

- Si une classe du même nom est déjà présente dans le projet, l'éditeur de code propose de ne pas importer la classe ou d'écraser son contenu avec celui du fichier importé. 

- Les symboles '...' pour indiquer qu"une ligne de code se poursuit sur la ligne suivante ne sont pas gérés. Si le fichier texte contient ces symboles, il ne sera pas importé. 

- Les commentaires se situant avant une déclaration (procédure, ...) sont considérés comme appartenant à la procédure précédente.

- Les déclarations de procédures contenant les symboles '::' ne sont pas gérées. 

- Pour importer des propriétés, il suffit de remplacer le mot PROCEDURE par le mot PROPRIETE dans le fichier texte contenant le code de la classe et de ses propriétés (voir exemple ci-dessous).





### Exemples
<a name="exemples_ELTPARAGRAPHE000043"></a>Exemples de fichiers texte : 

- fichier "ClasseA.txt" : 
	
	```txt
	ClasseA est une Classe
		n est un entier
	FIN
	
	PROCÉDURE Constructeur()
	n = 5
	
	PROCÉDURE Destructeur()
	
	
	PROCÉDURE GetN()
	RENVOYER n
	```


- fichier "ClasseB.txt" : 
	
	```txt
	ClasseB est une Classe
		pclA est ClasseA dynamique
	FIN
	
	
	PROCÉDURE Constructeur()
	
	PROCÉDURE Destructeur()
	
	PROCÉDURE Test()
	SI pclA = Null ALORS
		trace("pas alloué")
	SINON
		trace(:pclA:GetN())
	FIN
	
	PROCÉDURE Init(pclA=Null)
	pclA = pclA
	```


- Fichier "cAnimal.txt" contenant des propriétés : 
	
	```txt
	cAnimal est une Classe
		
		PRIVÉ
		m_sIdentifiant est une chaîne
		
		PROTÉGÉ
		m_sNomAnimal est une chaîne 
		m_ImageAnimal est une Image 
	
	FIN
	
	PROCÉDURE Constructeur(sNom est une chaîne)
	
	// Définit l'identifiant de l'animal
	m_sIdentifiant = DonneGUID()
	
	// Mémorise le nom de l'animal
	m_sNomAnimal = sNom
	
	PROCÉDURE Destructeur()
	
	
	PROPRIETE Identifiant()
	
	RENVOYER m_sIdentifiant
	PROPRIETE Identifiant(Valeur)
	
	// Pas de modification possible pour l'identifiant
	dbgAssertion(Faux, "L'identifiant ne peut pas être modifié")
	PROPRIETE NomAnimal()
	
	RENVOYER m_sNomAnimal
	PROPRIETE NomAnimal(Valeur)
	
	m_sNomAnimal = Valeur
	PROPRIETE ImageAnimal()
	
	RENVOYER m_ImageAnimal
	PROPRIETE ImageAnimal(Valeur)
	
	m_ImageAnimal = Valeur
	```





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Importer une collection de procédures sous forme de fichier texte
<a name="importer_une_collection_procedures_sous_forme_fichier_texte_ELTTEXTE000201"></a>


### Comment le faire ?
<a name="comment_faire_ELTPARAGRAPHE000062"></a>Pour importer une collection de procédures sous forme d'un fichier texte dans un projet : 

1. Ouvrez le projet voulu. 

2. Dans le volet "Explorateur de projet", sélectionnez le dossier "Procédures". 

3. Dans le menu contextuel (clic droit), sélectionnez l'option "Importer des fichiers texte". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Import_classe_txt%20-%20HC%20N%B0002.gif)

	

4. Dans le sélecteur de fichiers qui s'ouvre, sélectionnez le ou les fichier(s) texte(s) à importer et validez. 
	Rappel : Les touches Maj ou Ctrl permettent d'effectuer une multisélection. 

5. La ou les collections de procédures sont importées dans le projet. 





### Remarques
<a name="remarques_ELTPARAGRAPHE000081"></a>

- Le nom du fichier texte correspond au nom de la collection de procédures à importer. Par exemple, le fichier "Coll_bCompareFichiers.txt" permet d'importer la description de la collection de procédures "Coll_bCompareFichiers".  

- Il est possible de sélectionner plusieurs fichiers. Chaque fichier texte correspond à une collection de procédures. 

- Si une collection de procédures du même nom est déjà présente dans le projet, l'éditeur de code de ne pas importer la collection de procédures ou d'écraser son contenu avec celui du fichier importé. 

- Les symboles '...' pour indiquer qu"une ligne de code se poursuit sur la ligne suivante ne sont pas gérés. Si le fichier texte contient ces symboles, il ne sera pas importé. 

- Les déclarations de procédures contenant les symboles '::' ne sont pas gérées.

- Les commentaires se situant avant une déclaration (procédure, ...) sont considérés comme appartenant à la procédure précédente. Par exemple, il ne faut pas écrire  : 
	
	```txt
	// Description des paramètres d'entrée/sortie de 'gVérifieValeurRubrique' :
	//
	// Syntaxe :
	//gVérifieValeurRubrique (<RubriqueHF>, <ValeurFichierTexte>, <sNomRubrique>, <nNumEnr>)
	//
	// Paramètres :
	//	RubriqueHF : <indiquez ici le rôle de RubriqueHF>
	//	ValeurFichierTexte : <indiquez ici le rôle de ValeurFichierTexte>
	//	sNomRubrique : <indiquez ici le rôle de sNomRubrique>
	// 	nNumEnr : <indiquez ici le rôle de nNumEnr>
	// Valeur de retour :
	// 	Aucune
	PROCÉDURE gVérifieValeurRubrique(RubriqueHF,ValeurFichierTexte,sNomRubrique,nNumEnr)
	```

	mais il faut écrire : 
	```txt
	PROCÉDURE gVérifieValeurRubrique(RubriqueHF,ValeurFichierTexte,sNomRubrique,nNumEnr)
	// Description des paramètres d'entrée/sortie de 'gVérifieValeurRubrique' :
	//
	// Syntaxe :
	//gVérifieValeurRubrique (<RubriqueHF>, <ValeurFichierTexte>, <sNomRubrique>, <nNumEnr>)
	//
	// Paramètres :
	//	RubriqueHF : <indiquez ici le rôle de RubriqueHF>
	//	ValeurFichierTexte : <indiquez ici le rôle de ValeurFichierTexte>
	//	sNomRubrique : <indiquez ici le rôle de sNomRubrique>
	// 	nNumEnr : <indiquez ici le rôle de nNumEnr>
	// Valeur de retour :
	// 	Aucune
	```


- Le code importé peut contenir des procédures internes. 





