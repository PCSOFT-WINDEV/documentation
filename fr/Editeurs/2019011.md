


## Test d'une requête
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000261"></a>
<a name="Test_Requete"></a>
L'éditeur de requêtes permet de tester directement le résultat de la requête (icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Ico_Go_Fenetre_WD_bl.gif) ou option "Tester la requête" du menu contextuel de la requête).

Lors du test de la requête, le code d'initialisation du projet est exécuté.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Requete_ResultatTestRequete.gif)
**Remarques** :

- Il est possible de lancer plusieurs tests de requête en même temps.

- Il est possible de relancer le dernier test effectué (fenêtre, requête, état, ...) depuis n'importe quel élément du projet grâce à l'option "GO .. Relancer le dernier test" présente dans les boutons d'accès rapide. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=GO_Relancer_le_dernier_test%20-%20HC%20N%B0001.gif)


- Lors du test d'une [requête paramétrée](../Editeurs/2032045.md), une fenêtre permettant de spécifier les différents paramètres s'affiche. 
	Dans cette fenêtre, vous pouvez sélectionner une valeur existante grâce à l'icône ![Valeur existante](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=OrdreAffichage.gif). Le menu suivant apparaît :<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Requete_MenuVisuValeur.gif)
Il est alors possible :

	- soit de sélectionner une des valeurs possibles parmi celles présentes dans le fichier,

	- soit de visualiser la totalité du fichier. 
			**Attention** : Cette option est disponible uniquement si le Live Data est activé. 




- Le bouton ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IconeCalculette.gif) permet d'afficher automatiquement la moyenne, le total, les valeurs minimale et maximale des différentes rubriques résultat de type numérique.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png) | Important | [Le logiciel Etats & Requêtes](../Presentation/3088006.md) ne permet pas de tester :<br><br>- des requêtes d'insertion, <br><br>- des requêtes de modification, <br><br>- des requêtes de suppression. <br><br><br>Lors du test d'une requête sous [l'éditeur de requêtes Utilisateur](../Presentation/3088006.md), l'événement "Initialisation du projet" est exécuté. |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Résultat du test de la requête
<a name="resultat_test_requete_ELTTEXTE000303"></a>


### Résultat du test
<a name="resultat_test_ELTPARAGRAPHE000073"></a>Selon le type de requête testé, le résultat du test est différent :

- Le résultat d'une *requête de sélection* correspond aux enregistrements sélectionnés par la requête.

- Le résultat d'une *requête d'insertion* correspond à l'enregistrement qui va être inséré. Lors du test, l'enregistrement est directement inséré dans le fichier.

- Le résultat d'une *requête de modification* correspond aux enregistrements qui vont être modifiés. Lors du test, il est possible :

	- soit de visualiser uniquement les enregistrements qui vont être modifiés,

	- soit de modifier directement les enregistrements dans le fichier.




- Le résultat d'une *requête de suppression* correspond aux enregistrements qui vont être supprimés. Lors du test, il est possible :

	- soit de visualiser uniquement les enregistrements qui vont être supprimés,

	- soit de supprimer directement les enregistrements dans le fichier.






<a name="NOTE2_2"></a>


### Manipulation du résultat
<a name="manipulation_resultat_ELTPARAGRAPHE000091"></a>Le résultat de la requête peut ensuite au choix être :

- Exporté vers un fichier texte.

- Exporté vers un fichier XML.

- Exporté vers un fichier Excel.

- Exporté vers un fichier HFSQL.

- Imprimé.




Il est également possible de copier un enregistrement du résultat de la requête dans le presse-papiers.

Pour plus de détails, consultez [Résultat d'une requête en mode Test](../Editeurs/2032017.md).

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Notes
<a name="notes_ELTTEXTE000333"></a>


### Gestion des mots de passe des fichiers de données
<a name="gestion_des_mots_passe_des_fichiers_donnees_ELTPARAGRAPHE000113"></a>Si un des fichiers de données participant à la requête est protégé par mot de passe, lors du test de la requête :

- Si le mot de passe est précisé dans le code d'initialisation du projet (fonction [HPasse](../WDLang4/3044108.md)), la requête est exécutée.

- Si la gestion des erreurs HFSQL n'a pas été personnalisée (fonction [HSurErreur](../WDLang4/3044017.md)) et si le mot de passe n'est pas précisé par programmation, la fenêtre standard de demande du mot de passe est affichée. 
	**Remarque** : si la gestion des erreurs est personnalisée dans le code d'initialisation du projet, cette gestion des erreurs sera utilisée.



<a name="NOTE3_2"></a>


### Prendre en compte la constante hRequêteSansCorrection lors du test (requête utilisant une connexion)
<a name="prendre_compte_constante_hrequetesanscorrection_lors_test_requete_utilisant_une_connexion_ELTPARAGRAPHE000131"></a>Par défaut, WINDEV et WEBDEV interprètent les requêtes SQL sur OLE DB et sur ODBC via le provider OLE DB.

Pour que la requête ne soit pas interprétée lors d'un test sous l'éditeur de requêtes :

- *Requête de sélection* :

	1. Affichez la description de la requête (option "Description de la requête" dans le menu contextuel de la requête).

	2. Dans la partie droite, cliquez sur le bouton "Avancé". La fenêtre des paramètres avancés s'affiche.

	3. Affichez l'onglet "hRequêteSansCorrection".

	4. Cochez l'option "Exécuter avec hRequêteSansCorrection en mode test".

	5. Sélectionnez dans la liste la connexion à utiliser. La liste présente les différentes connexions définies dans l'éditeur d'analyses. Il est également possible de saisir directement le nom d'une connexion dynamique (définie par programmation grâce à la fonction [HDécritConnexion](../WDLang4/3044205.md)).
			**Attention** : Si vous utilisez une connexion dynamique, cette connexion doit être définie :

		- soit dans le code d'initialisation du projet,

		- soit dans un code exécuté depuis le code d'initialisation du projet.




- *Requête d'insertion, de modification ou de suppression* : 

	1. Affichez la description de la requête (option "Description de la requête" du menu contextuel de la requête, onglet "Général").

	2. Cochez l'option "Exécuter avec hRequêteSansCorrection en mode test".

	3. Sélectionnez dans la liste la connexion à utiliser. La liste présente les différentes connexions définies dans l'éditeur d'analyses. Il est également possible de saisir directement le nom d'une connexion dynamique (définie par programmation grâce à la fonction [HDécritConnexion](../WDLang4/3044205.md)).
			**Attention** : Si vous utilisez une connexion dynamique, cette connexion doit être définie :

		- soit dans le code d'initialisation du projet

		- soit dans un code exécuté depuis le code d'initialisation du projet.







Ce mode peut par exemple être utilisée si vous saisissez directement le code SQL de votre requête sous l'éditeur de requêtes.
**Remarque** : En exécution, la constante *hRequêteSansConnexion* peut être précisée directement dans la fonction [HExécuteRequête](../WDLang4/3044080.md).

**Les effets de la constante HRequêteSansConnexion**


| HRequêteSansCorrection n'est pas spécifié | HRequêteSansCorrection est spécifié |
| --- | --- |
| Détermination automatique de la connexion associée aux fichiers de données présents dans la requête. | La connexion à utiliser doit être précisée dans la fonction **HExécuteRequêteSQL**. |
| Remplacement de tous les signes propriétaires PC SOFT (exemple : ']=' commence par) par leur équivalent en SQL standard. | Aucun remplacement n'est effectué. Il est nécessaire d'utiliser les signes SQL standard. |
| Formatage des dates et des heures selon le format utilisée par la base de données utilisée.<br>Par exemple, les dates WINDEV sont au format 'AAAAMMJJ', alors que sous Access, les dates sont au format #AAAAJJMM# ou #AAAAMMJJ# selon la langue du système. | Aucun formatage n'est effectué. Il est nécessaire d'utiliser le format reconnu par la base de données. |
| Formatage des flottants (le séparateur de décimal peut être '.' ou ',') | Aucun formatage des flottants n'est réalisé. |
| Selon la base de données utilisée, remplacement des noms d'alias par les noms complets des rubriques dans les clauses WHERE, ORDER BY et GROUP BY.<br>Par exemple, le moteur JET (Access, DBase, ...) n'accepte pas de noms d'alias dans la clause Where d'une requête | Aucun remplacement n'est effectué. Il est nécessaire d'utiliser directement dans le code de la requête les noms complets des rubriques dans les clauses WHERE, ORDER BY et GROUP BY. |




