
## Utiliser plusieurs bibliothèques dans une application 
			






	<B><B>Avertissement</B></B>

	A partir de la version <B><B>18</B></B>,  l'utilisation de plusieurs bibliothèques n'est pas conseillée. Il est recommandé de remplacer les bibliothèques secondaires par des composants (internes ou externes). 



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000257"></a>
Une bibliothèque est un fichier de type WDL qui contient toutes les ressources : fenêtres, états, classes, collections de procédures, ... Ce fichier est utilisé par l'exécutable ou par le moteur WEBDEV (cas d'un site dynamique). 

Pour optimiser le chargement sous l'éditeur d'un projet volumineux (plusieurs centaines de fenêtres par exemple), il est conseillé de découper ce projet. 

Pour découper un projet de taille importante, il est possible : 

- soit d'utiliser des projets indépendants : chaque projet génère un exécutable indépendant. Ces exécutables s'appellent entre eux. Le principal inconvénient de cette méthode est le suivant : ces exécutables ne partagent pas leurs ressources. 

- soit d'utiliser des bibliothèques secondaires : 

	- Un projet principal permet de générer la bibliothèque principale et l'exécutable. 

	- Des projets secondaires (de type "Bibliothèque") permettent de générer les bibliothèques secondaires utilisées par le projet principal. En exécution, le programme ouvre la bibliothèque principale et les bibliothèques secondaires : toutes les ressources sont partagées entre les différentes bibliothèques. 













<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Comment créer les différents types de bibliothèques ?
<a name="comment_creer_les_differents_types_bibliotheques_ELTTEXTE000281"></a>


### Créer la bibliothèque principale
<a name="creer_bibliotheque_principale_ELTPARAGRAPHE000034"></a>La bibliothèque principale d'une application est créée :

- lors de la création de l'exécutable (en WINDEV et WINDEV Mobile).

- lors de la création du programme d'installation (en WEBDEV).




Sont automatiquement inclus dans cette bibliothèque tous les composants du projet en cours. Il est possible d'ajouter ou de supprimer des éléments lors de la création de la bibliothèque.

Pour plus de détails, consultez : 

- [Créer un exécutable](../Editeurs/2025002.md).

- [Déploiement d'un site](../Editeurs/2028039.md). 





<a name="NOTE3_2"></a>


### Créer les projets secondaires et les bibliothèques secondaires
<a name="creer_les_projets_secondaires_les_bibliotheques_secondaires_ELTPARAGRAPHE000056"></a>Pour créer les projets secondaires : 

1. Sous l'éditeur, créez un nouveau projet de type "Bibliothèque".

	- Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif) parmi les boutons d'accès rapide. Dans la roue qui s'affiche, cliquez sur "Projet". L'assistant de création d'un projet se lance. 

	- Dans l'écran "Description - Type de projet", sélectionnez "Bibliothèque". 

	- Suivez les différentes étapes de l'[assistant de création de projet](../Editeurs/2030032.md). 




2. Intégrez tous les éléments nécessaires au projet : 

	- partagez si nécessaire l'analyse du projet principal, 

	- si vous avez un existant, importez les fenêtres, états gérés par le projet secondaire,

	- créez les éléments gérés par le projet secondaire. 




3. Configurez les options de la bibliothèque : Dans l'explorateur de projet : 

	- sélectionnez la configuration de projet correspondant à votre bibliothèque.

	- sélectionnez l'option "Description" du menu contextuel. 

	- Dans l'onglet "Compatibilité", sélectionnez les options de compatibilité de la bibliothèque : 

		- Utilisation dans des projets WINDEV uniquement ou non, 

		- Activation des erreurs de compilation 64 bits,

		- Activation des erreurs de compilation Linux.

		- Validez.




4. Créez la bibliothèque : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=genererbibliotheque.gif)L'assistant de création de bibliothèque se lance. 

5. Sélectionnez les éléments à intégrer dans la bibliothèque. La bibliothèque aura par défaut le nom du projet en cours. Vous pouvez :

	- **Ajouter des éléments** (bouton "Ajouter"): 
			Tout type de fichier peut être ajouté à la liste des éléments insérés dans la bibliothèque : images, fichiers texte, ...

	- **Supprimer des éléments** (bouton "Enlever")
			Les fichiers correspondants et leur dépendance ne seront pas pris en compte dans la bibliothèque.

	- **Créer la bibliothèque à partir d'une description de bibliothèque existante** (bouton "WDU"). 
			Lors de la création d'une bibliothèque WINDEV ou WINDEV Mobile, un fichier ".WDU" du même nom est automatiquement créé. Ce fichier contient toutes les références des éléments intégrés à la bibliothèque. Il suffit de sélectionner le fichier WDU contenant les éléments à prendre en compte. 
			**IMPORTANT** : Cliquez sur le bouton "Avancé" et cochez l'option "Oui : la bibliothèque peut être incluse dans d'autres projets". 




6. Indiquez les langues présentes dans la bibliothèque. Il est possible d'utiliser :

	- une ou plusieurs langues associées au projet

	- toutes les langues du projet

	- uniquement la langue en cours




7. Si votre bibliothèque contient des classes, il est possible de configurer pour chaque classe :

	- si la classe est visible : La classe pourra être utilisée dans un autre projet comme une classe du projet : il sera par exemple possible de déclarer un objet de la classe ou de dériver cette classe.

	- si la classe est cachée : La classe ne pourra pas être utilisée dans un autre projet.




8. Indiquez les informations de version de la bibliothèque : 

	- le nom de la **société**. Par exemple, le nom de la société éditrice.

	- une brève **description**. Par exemple : "Gestion des pièces en stock".

	- le **copyright**

	- la version de la bibliothèque. Tous les caractères (chiffre et lettre) sont autorisés. Par exemple : "1.01A".
			Il est recommandé de :

		- utiliser un numéro de version différent à chaque création de la bibliothèque. 

		- incrémenter automatiquement le ou les derniers caractères (chiffre ou lettre) du numéro de version à chaque création de la bibliothèque (cochez l'option "Incrémentation automatique de la version à chaque création"). 
						Par exemple :
						- le numéro de version "1.01A" deviendra "1.01B".
						- le numéro de version "A15Z" deviendra "A16A". 




9. Indiquez si la bibliothèque doit prendre en compte les mises à jour par Patch. Il suffira alors de copier le fichier correspondant au Patch dans le répertoire de la bibliothèque. Pour plus de détails sur les patchs d'application, consultez [Patch d'application](../Editeurs/2030031.md).

10. Validez la création de la bibliothèque (et si nécessaire la sauvegarde du projet). 




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Intégrer des bibliothèques secondaires dans le projet principal
<a name="integrer_des_bibliotheques_secondaires_dans_projet_principal_ELTTEXTE000311"></a>


### Attention
<a name="attention_ELTPARAGRAPHE000152"></a>Pour intégrer une bibliothèque secondaire dans une bibliothèque principale, l'option "Oui : la bibliothèque peut être incluse dans d'autres projets" doit avoir été choisie lors de la création de la bibliothèque.


<a name="NOTE4_2"></a>


### Intégrer une bibliothèque secondaire dans un projet
<a name="integrer_une_bibliotheque_secondaire_dans_projet_ELTPARAGRAPHE000160"></a>Pour intégrer une bibliothèque secondaire dans un projet :

1. Sélectionnez l'option "Atelier .. Bibliothèque .. Bibliothèques externes".

2. Ajoutez la / les bibliothèques secondaire(s) à intégrer au projet.

3. Validez.




Seules les classes définies comme visibles de la bibliothèque secondaire pourront être manipulées dans le projet. Il sera possible de déclarer un objet de cette classe ou encore de dériver cette classe. La classe est reconnue dans le projet. La [complétion automatique](../Editeurs/2013001.md) (si elle est activée) proposera cette classe. Aucune erreur n'apparaîtra lors de la compilation du projet.

Les classes intégrées dans une bibliothèque secondaire peuvent par exemple ouvrir des fenêtres présentes elles aussi dans la bibliothèque secondaire.


<a name="NOTE4_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Lors de la création de l'exécutable de l'application principale**, la bibliothèque secondaire est automatiquement sélectionnée et copiée dans le répertoire de l'exécutable. Cette bibliothèque sera automatiquement chargée lors du lancement de l'exécutable.

<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Utiliser des bibliothèques externes par programmation
<a name="utiliser_des_bibliotheques_externes_par_programmation_ELTTEXTE000347"></a>
Lors du lancement de l'exécutable, la bibliothèque principale du projet est automatiquement chargée. Si les bibliothèques secondaires n'ont pas été intégrées au projet, il est nécessaire d'utiliser en programmation :

- La fonction [ChargeWDL](../WDLang1/3013020.md) pour charger une bibliothèque secondaire dans le projet. Les éléments présents dans la bibliothèque secondaire pourront être manipulés par programmation (fenêtres, états, classes, ...).

- La fonction [DéchargeWDL](../WDLang1/3013013.md) pour décharger une bibliothèque secondaire.




Si une bibliothèque est fermée par la fonction [DéchargeWDL](../WDLang1/3013013.md), les fichiers de données HyperFileSQL ouverts dans la WDL ne sont pas automatiquement fermés.

Tout accès aux fichiers de données HyperFileSQL provoquera une erreur "La WDL XXX a été déchargée". Il est conseillé d'utiliser la fonction [HFerme](../WDLang4/3044073.md) sur les fichiers de données ouverts dans une WDL qui va être va déchargée.

**Remarque** : Dans ce cas, la bibliothèque secondaire doit être présente dans le répertoire de l'exécutable et doit être intégrée dans la liste des fichiers à installer lors du déploiement de l'application.




