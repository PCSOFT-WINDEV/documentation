
## Image Docker du serveur d'application WEBDEV
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000151"></a>
A partir de la version 24, un conteneur Docker contenant le serveur d'application WEBDEV est présent dans Docker Hub :
[https://hub.docker.com/r/windev/webdev](https://hub.docker.com/r/windev/webdev)


L'installation d'un serveur d'Application WEBDEV Linux devient simplissime : 1 ligne à taper ou à scripter !
Selon le type de serveur (10 connexions simultanées ou illimité), le numéro de série du serveur vous sera demandé.

Remarque : Seule la version 64 bits est disponible. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000175"></a>


### Configuration nécessaire
<a name="configuration_necessaire_ELTPARAGRAPHE000027"></a>

- Le site doit être [adapté à un déploiement sous Linux](../Editeurs/9000055.md). Notamment, l'option "Activer les erreurs de compilation pour la compatibilité Linux" doit être active. Cette option est disponible dans l'onglet "Compatibilité" de la fenêtre de description de la configuration courante.

- La distribution Linux utilisée n'a pas d'importance. Cependant, pour utiliser le conteneur Docker contenant le serveur d'application WEBDEV, il est nécessaire de maîtriser Docker et notamment il est nécessaire de :

	- savoir installer un nouveau conteneur à partir de l'image Docker du serveur d'application WEBDEV,

	- gérer au moins un volume nécessaire à la persistance des données,

	- gérer la configuration réseau à l'intérieur de Docker. Par exemple, il faut pouvoir gérer le cas où un ou plusieurs conteneurs avec l'image du serveur d'application WEBDEV doivent accéder à des données hébergées par un serveur HFSQL Client/Serveur.










### Exécution de l'image (création du conteneur)
<a name="execution_image_creation_conteneur_ELTPARAGRAPHE000041"></a>

- Le nom de l'image prédéfinie est : 
	
	```txt
	"windev/webdev:<Version>"
	```


- Il faut activer le serveur d'application en transmettant le numéro de série sur la ligne de commande. Le paramètre à transmettre est de la forme : 
	
	```txt
	--configuration="<Numéro de série>-<Clé d'activation>"
	```
Si ce paramètre n'est pas indiqué, le serveur d'application utilisé sera un Serveur d'application 10 connexions.  

- Pour avoir une persistance des applications et de leurs données (par exemple en cas changement de l'image), il faut : 

	- Utiliser un volume. La commande de création d'un volume : 
			
		```txt
		"docker volume create <NomVolume>"
		```


	- Monter le volume dans le conteneur sur 
			
		```txt
		"/var/lib/WEBDEV/<Version majeure.mineure>/"
		```





- Un compte WEBDEV et un compte Linux (les deux) nommés "webdevuser" seront créés :

	- Un mot de passe sera généré et leur sera affecté.

	- Il est important de consulter la sortie du conteneur : 

		- soit en effectuant un lancement interactif avec "-it", 

		- soit en consultant les logs du conteneur avec la syntaxe : 
						
			```txt
			"docker logs <ID du conteneur>"
			```








Exemple de ligne de commande : 

```txt
docker run -p 80:80 -v WB:/var/lib/WEBDEV/24.0/ 
windev/webdev:FR240054h --configuration="<Numéro de série>-<Clé d'activation>"
```



### Notes (important)
<a name="notes_important_ELTPARAGRAPHE000073"></a>

- Si un nouveau conteneur utilise les données d'un volume existant (par exemple les données d'un précédent conteneur suite à une MAJ de l'image : changement de version (mineure) de WEBDEV) :

	- Cette opération est possible uniquement avec une même version majeure.

	- Attention ! Un nouveau mot de passe est créé, ce mot de passe est appliqué au compte WEBDEV et un compte Linux (les deux) nommés "webdevuser", il faut donc changer le mot de passe lors des futurs déploiements de sites.




- Pour se connecter à l'administrateur distant "http[s]://&lt;serveur&gt;/WDAdminWeb" :

	- Le compte WEBDEV de déploiement : 
		```txt
		webdevuser/<Mot de passe généré et affiché>
		```





- La bibliothèque libqtgui5 est installée : les images générées et les impressions sont disponibles. En revanche une seule police est installée.

- Rappel des commandes de base de docker :

	- Arrêt d'un conteneur : 
			
		```txt
		"docker stop <ID>"
		```


	- Redémarrage d'un conteneur : 
			
		```txt
		"docker start <ID>"
		```


	- Attention ! Pas de relancement interactif : 
			
		```txt
		"docker start -i <ID>"
		```
En effet, cela déclenche l'envoi du signal SIGWINCH que Apache interprète comme une commande d'arrêt.










