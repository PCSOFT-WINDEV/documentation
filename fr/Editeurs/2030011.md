


## Evénements associés au projet 
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Evénements gérés par défaut
<a name="evenements_geres_par_defaut_ELTTEXTE000316"></a>
WINDEV, WEBDEV et WINDEV Mobile gèrent par défaut les événements suivants (ordre d'apparition sous l'éditeur de code) :

| Evénement | Conditions d'exécution |
| --- | --- |
| Initialisation | Exécuté lors du lancement de l'application. L'ordre d'exécution des événements au lancement d'une application (y compris lors d'un test) est le suivant :<br><br>- Initialisation des composants "chargés au lancement de l'application".<br><br>	- Initialisation des sous-composants(\*).<br><br>	- Initialisation des classes du composant.<br><br>	- Initialisation des collections de procédures du composant.<br><br>	- Initialisation du projet du composant(\*).<br><br><br><br><br>- Initialisation des classes.<br><br>- Initialisation des collections de procédures.<br><br>- Initialisation du projet.<br><br>- Initialisation de la première fenêtre du projet ou de l'élément testé.<br><br><br>(\*) L'événement "Initialisation" d'un composant est exécuté uniquement lorsque le composant utilise le même contexte d'exécution que le projet. Pour plus de détails sur les options de génération du composant, consultez [Créer et générer un composant externe](../Editeurs/2014002.md).<br><br>Si la fonction [Utilise](../WDLang1/3038044.md) est exécutée, l'événement d'initialisation du projet est interrompu (toutes les lignes de code suivant la fonction [Utilise](../WDLang1/3038044.md) ne seront pas exécutées).<br><br>**Exemples**<br>Quelques exemples d'utilisation de cet événement :<br><br>- Initialisation des variables globales au projet.<br><br>- Création des fichiers de données (fonctions [HCréation](../WDLang4/3044255.md) et [HCréationSiInexistant](../WDLang4/3044254.md)).<br><br>- Définition des répertoires de création de fichiers de données (fonctions [HChangeRep](../WDLang4/3044168.md) et [HSubstRep](../WDLang4/3044028.md)).<br><br>- Description des connexions temporaires à une base de données (fonction [HDécritConnexion](../WDLang4/3044205.md)).<br><br><br> |
|   | Utilisé si le site est exécuté avec des sessions prélancées. <br><br>Pour gérer les sessions prélancées, deux événements sont associés au projet :<br><br>- l'événement "Initialisation du projet", exécuté avant l'arrivée de la requête sur le Serveur d'application WEBDEV. Ce code est exécuté lors du lancement de la session prélancée. <br><br>- l'événement "Initialisation du projet après connexion au site", exécuté lorsque le Serveur d'application WEBDEV traite la requête. <br><br><br><br><br>Attention : Certaines fonctions WLangage ne doivent pas être utilisées dans l'événement "Initialisation du projet". Elles doivent être déplacées dans l'événement "Initialisation du projet après connexion au site". <br><br>Pour plus de détails, consultez [Sessions prélancées](../WDLang2/1000019485.md). |
| Fermeture | Exécuté lors de la fermeture de l'application (par exemple lors de la fermeture de la dernière fenêtre de l'application par exemple).<br>L'ordre d'exécution des événements lors de la fermeture du projet est le suivant :<br><br>- Fermeture du projet.<br><br>- Evénement de terminaison des collections de procédures.<br><br>- Evénement de terminaison des classes.<br><br>- Fermeture des composants (fermeture du projet du composant, puis de ses collections de procédures, puis de ses classes, et de ses sous-composants).<br><br><br>**Cet événement ne sera pas exécuté :**<br><br>- Lors de l'exécution de la fonction [FinProgramme](../WDLang1/3013033.md) avec le paramètre "Code de fermeture" non spécifié ou égal à "Faux".<br><br>- Lors de l'exécution de la fonction [AppliContrôle](../WDLang1/3013003.md) avec le paramètre "Exécution fermeture du projet" non spécifié ou égal à "Faux".<br><br><br> |
| ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Fermeture de session | Exécuté dans les cas suivants si l'application est en cours d'utilisation :<br><br>- Lors de la fermeture de la session de l'utilisateur en cours.<br><br>- Lors de l'arrêt du système du poste en cours.<br><br>- Lors du redémarrage du poste en cours.<br><br><br>Dans ces cas, seul cet événement sera exécuté. Les événements de fermeture de projet et de terminaison des classes et des collections de procédures ne seront pas exécutés.<br>**Remarque** : Selon le système d'exploitation du poste en cours, le système d'exploitation tente d'arrêter violemment l'application après un certain temps.<br><br>**Exemples**<br>Quelques exemples d'utilisation de cet événement :<br><br>- Libération des librairies chargées en mémoire grâce à la fonction [DéchargeDLL](../WDLang1/3014009.md) (si des librairies ont été chargées en mémoire).<br><br>- Libération des classes, des objets OLE Automation et des tableaux dynamiques (mot-clé [Libérer](../Motscles/1511012.md)).<br><br>- Annulation des transactions en cours (fonction [HTransactionAnnule](../WDLang4/3044001.md)).<br><br>- Fermeture des fichiers HFSQL (fonction [HFerme](../WDLang4/3044073.md)).<br><br>- Envoi de messages d'information à d'autres postes (fonction [SendMessage](../WDLang1/3015003.md)).<br><br>- Exécution de l'événement de fermeture du projet grâce à la fonction [FinProgramme](../WDLang1/3013033.md) avec le paramètre "Code de fermeture" égal à "Vrai".<br><br><br> |
| ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) <br>Test automatique | Evénement optionnel.<br><br>Pour activer cet événement, sous le volet "Tests automatiques", dans le groupe "Tests", cliquez sur le bouton de regroupement (![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_regroup.gif)<br>) et sélectionnez l'option "Activer le code de test automatique du projet".<br><br>Pour désactiver cet événement, sous le volet "Tests automatiques", dans le groupe "Tests", cliquez sur le bouton de regroupement (![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_regroup.gif)<br>) et sélectionnez l'option "Désactiver le code de test automatique du projet".<br><br>Cet événement est exécuté avant le code d'initialisation du projet dans le cas d'un test automatique. Ce code permet de traiter certains cas particuliers où le test automatique peut être bloqué : ouverture d'une fenêtre dans le code d'initialisation du projet (fenêtre de paramétrage, fenêtre de licence, fenêtre de login personnalisée, ...).<br><br>Le code de test automatique du projet permet d'utiliser par exemple la fonction [PiloteFenêtre](../WDLang1/1000009009.md) pour valider la fenêtre. |
|   | Exécuté lorsque l'application passe en arrière-plan. Cet événement permet par exemple de sauvegarder les données.<br><br>Remarque : Cet événement est exécuté APRES l'événement optionnel des fenêtres "Mise en arrière-plan de l'application depuis la fenêtre". |
|   | Exécuté lorsque l'application est réactivée et passe au premier plan. Cet événement permet par exemple de rafraîchir les données affichées.<br><br>Remarques :<br><br>- Cet événement n'est pas exécuté au démarrage de l'application.<br><br>- Cet événement est exécuté AVANT l'événement optionnel des fenêtres "Mise au premier plan de l'application sur la fenêtre".<br><br><br> |
|   | Exécuté dans les cas suivants : <br><br>- Au lancement de l'application (après l'événement "Initialisation" du projet).<br><br>- Lors du changement de thème réalisé par programmation avec la fonction [ChangeThème](../WDLang3/1000025266.md) uniquement si la constante *avecExécutionDeCode* a été spécifiée.<br><br>- Lors du changement de thème automatiquement effectué par le système : modification des paramètres système, changement d'heure jour/nuit, activation/désactivation de l'économiseur de batterie, ...<br><br><br><br><br>Remarque : Cet événement est disponible uniquement si la gestion du thème sombre est activée. Pour plus de détails, consultez [Gestion du thème sombre mobile](../WDLang3/1000025338.md). <br><br> |
|   | Exécuté au lancement du Serveur d'application WEBDEV et également au lancement d'une application.<br><br>Remarque : Les tâches planifiées WEBDEV n'étant pas persistantes, cet événement permet d'ajouter des tâches planifiées WEBDEV par programmation (fonction [ServeurAppliAjouteTâchePlanifiée](../WDLang2/1000022347.md)).<br><br> |
|   | Exécuté lors de l'installation et lors de la mise à jour d'une application ou lors du déblocage d'une application. |
|   | Exécuté lors de l'arrêt du serveur d'application WEBDEV. |




