
## Groupware utilisateur et LDAP
			

<DIV class="specObsolete">
	<IMG style="float:left;margin-right:10px;" src="https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=warning_big.png"><B>Avertissement</B><BR>
	A partir de la version <B>18</B>,  le groupware utilisateur évolue. Cette page d'aide correspond au groupware utilisateur conservé par compatibilité. Pour obtenir cette page d'aide pour la nouvelle version du Groupware utilisateur, consultez [Groupware Utilisateur et LDAP](../Editeurs/1000021178.md). 
</DIV><a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000176"></a>
LDAP est un protocole de plus en plus utilisé dans les entreprises. LDAP est un protocole permettant l'interrogation et la modification de services d'annuaires. Active Directory de Microsoft par exemple fournit les services d'accès LDAP à ses données.

Dans une entreprise, un utilisateur d'ordinateur se voit en général affecter par le responsable "système" un compte et un mot de passe pour accéder à sa machine.

Ce compte et ce mot de passe peuvent directement être utilisés par le groupware utilisateur de WINDEV et WEBDEV, avec la possibilité de définir des droits spécifiques.

**Remarque** : Le groupware utilisateur fonctionne avec Active Directory. Il ne fonctionne pas avec openLDAP.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000200"></a>


### Branchement du groupware utilisateur sur un annuaire LDAP sans gestion de droits
<a name="branchement_groupware_utilisateur_sur_annuaire_ldap_sans_gestion_droits_ELTPARAGRAPHE000031"></a>Pour brancher le groupware utilisateur sur un annuaire LDAP sans gestion de droits :

1. Configurez le groupware utilisateur (option "Atelier .. Paramétrer le groupware utilisateur").

2. Dans l'onglet "Général", cochez les options :

	- Utiliser un annuaire LDAP pour l'authentification des utilisateurs.

	- Sans gestion des droits







Dans ce cas, le groupware utilisateur ne crée pas de fichiers de données. Il ne sera pas possible à un superviseur de définir les droits sur les fenêtres et sur les pages.

Au lancement de l'application, la fenêtre ou page de login demande à l'utilisateur de s'identifier. Si l'utilisateur est enregistré dans l'annuaire LDAP, l'application se lancera, sinon elle se fermera.


<a name="NOTE2_2"></a>


### Branchement du groupware utilisateur sur un annuaire LDAP avec gestion de droits
<a name="branchement_groupware_utilisateur_sur_annuaire_ldap_avec_gestion_droits_ELTPARAGRAPHE000049"></a>Pour brancher le groupware utilisateur sur un annuaire LDAP avec gestion de droits :

1. Configurez le groupware utilisateur (option "Atelier .. Paramétrer le groupware utilisateur").

2. Dans l'onglet "Général", cochez uniquement l'option "Utiliser un annuaire LDAP pour l'authentification des utilisateurs".




Dans ce cas, le groupware utilisateur crée des fichiers de données pour la gestion des utilisateurs et des droits. Il est possible à un superviseur de définir les droits sur les fenêtres et sur les pages.

**Cas 1 : La base de données du groupware utilisateur est vide. La base LDAP existe**

**Lors de la mise en place de l'application, une configuration supplémentaire doit être réalisée**.

1. Se connecter à l'application en tant que Superviseur (Login "Superviseur", Mot de passe "Superviseur").

2. Choisir "Configurer le groupware".

3. Sélectionner l'option "Importer des utilisateurs de l'annuaire LDAP". Une fenêtre s'affiche permettant de réaliser l'importation de tous les utilisateurs.
	Remarque : Si vous n'êtes pas authentifié sur le serveur LDAP (1ère utilisation par exemple), un login et un mot de passe d'un utilisateur LDAP vont vous être demandés. Il est nécessaire que l'utilisateur LDAP choisi ait les droits nécessaires pour lister les utilisateurs de l'annuaire LDAP.

4. Cliquez sur le bouton "Importer". L'importation est réalisée, tous les utilisateurs LDAP apparaissent dans la liste des utilisateurs.
	Remarque : Il est conseillé de donner les droits du superviseur à un utilisateur spécifique et de supprimer l'utilisateur "Superviseur" existant par défaut.

5. Il est possible d'affecter des droits aux différents utilisateurs importés.




**Cas 2 : La base de données du groupware utilisateur existe déjà. L'application se connecte à une base LDAP**

Seuls les utilisateurs présents dans la base du groupware utilisateur et dans la base LDAP pourront se connecter à l'application (mêmes logins des utilisateurs). Le mot de passe à utiliser est le mot de passe LDAP. Les utilisateurs qui ne sont pas présents dans la base LDAP ne pourront pas lancer l'application.

Les droits pourront être gérés sur les utilisateurs présents à la fois dans la base du groupware et dans la base LDAP.

**Note : L'utilisation d'un annuaire LDAP avec gestion des droits permet de passer simplement du mode LDAP au mode sans LDAP. Il suffit de cocher l'option "Utiliser un annuaire LDAP".**


<a name="NOTE2_3"></a>


### Lancement de l'application
<a name="lancement_application_ELTPARAGRAPHE000084"></a>**En mode lancement automatique** : 
Les caractéristiques du serveur LDAP doivent être saisies dans l'onglet "LDAP" de la fenêtre de paramétrage du groupware utilisateur.

Pour connaître le nom de l'utilisateur, il suffit d'utiliser la fonction [gpwRécupInfoUtilisateur](../WDLang6/3041004.md) :


```wl
Info("Bonjour "+ gpwRecupInfoUtilisateur(gpwInfoLogin))
```


**En mode lancement manuel** : 
Pour utiliser l'annuaire LDAP, il est nécessaire d'ouvrir une session LDAP grâce à la fonction [gpwOuvreSessionLDAP](../WDLang6/1000017055.md) avant d'utiliser la fonction [gpwOuvre](../WDLang6/3041002.md) :

```wl
gpwOuvreSessionLDAP("xx.monentreprise.com", 389, 3, Faux)
gpwOuvre()
```


Pour identifier un utilisateur sans ouvrir de fenêtre de login, le code suivant peut être utilisé :

```wl
gpwOuvreSessionLDAP("xx.monentreprise.com", 389, 3, Faux)
SI gpwLogin("FP", "MotPasse")<>gpwOk ALORS
	Erreur("Utilisateur ou mot de passe incorrect")
	FinProgramme()
FIN
```

<a name="NOTE2_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Installation de l'application utilisant un annuaire LDAP
<a name="installation_application_utilisant_annuaire_ldap_ELTPARAGRAPHE000116"></a>Les paramètres de l'annuaire LDAP peuvent être saisis lors de l'installation de l'application, par l'utilisateur.

Pour cela, lors de la création de l'installation de l'application utilisant le groupware utilisateur (option "Atelier .. Créer la procédure d'installation"), cochez l'option "Personnaliser le chemin des fichiers du groupware lors de l'installation" dans l'écran "Paramètres des bases de données".

Dans ce cas, lors de l'installation de l'application, un écran spécifique au groupware utilisateur s'affichera. Cet écran permettra à la personne installant l'application :

- de configurer l'emplacement des fichiers de données propres au groupware utilisateur. Pour plus de détails sur les fichiers de données du groupware utilisateur et leur emplacement, consultez [Fichiers de données du groupware utilisateur](../Editeurs/2018002.md).

- d'activer l'historique des connexions.

- d'activer l'authentification des utilisateurs par un annuaire LDAP. Dans ce cas, il sera nécessaire de saisir l'adresse du serveur, le numéro de port et la version de LDAP utilisée.





