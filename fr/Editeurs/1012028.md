
## Manipulation d'objets Javascript externes depuis le WLangage
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000086"></a>
Le WLangage en mode "Navigateur" permet l'interface avec les API Web telles que celles proposées par Google ou Yahoo. L'interaction avec les composants externes proposés par ces sites est simplifiée.

Il est possible d'allouer des objets Javascript externes en code Navigateur écrit en WLangage.

L'utilisation d'objets Javascript externes ne nécessite plus obligatoirement l'usage du langage Javascript : la programmation peut s'effectuer en WLangage



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Exemple : Récupération d'une liste de tâches dans un agenda Google
<a name="exemple_recuperation_une_liste_taches_dans_agenda_google_ELTTEXTE000110"></a>
Pour récupérer une liste de tâches dans un agenda Google : 

1. Intégrez dans la page l'interface de programmation de l'agenda Google.

	- Affichez l'onglet "Avancé" de la description de la page.

	- Dans l'onglet "HTML", ajoutez la ligne de code suivante dans le code HTML de l'entête de page : 
			
		```txt
		<script type="text/javascript">google.load("gdata", "1");</script>
		```
Ce code est fourni dans la documentation Google. 

	- Dans l'onglet "Javascript", cliquez sur le bouton "Ajouter une ressource Web". Saisissez l'adresse permettant d'inclure le service d'agenda : 
			
		```txt
		http://www.google.com/jsapi?key=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
		```
(le code de la clé correspond à votre code personnel).




2. Saisissez le code navigateur permettant de récupérer la liste des tâches :
	
	```wl
	MonServiceAgenda est un objet dynamique
	MonServiceAgenda = allouer un objet "google.gdata.calendar.CalendarService"
	MesTâches est un tableau dynamique
	MesTâches = MonServiceAgenda:feed:entry
	// Parcours du tableau pour remplir la liste
	POUR i = 1 A Dimension(MesTâches)
		ListeAjoute(LISTE_Choix_Tâche, MesTâches[i]:getTitle():getText())
	FIN
	```








