


## Utiliser un composant externe dans une application
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000288"></a>
Un composant externe peut être réutilisé à tout moment dans n'importe quelle application : il suffit de connaître le répertoire des fichiers du composant externe.

Cette page d'aide présente comment :

- [Intégrer un composant externe dans une application](#NOTE2_1).

- [Manipuler les éléments d'un composant externe par programmation](#NOTE3_1).

- [Mettre à jour un composant externe dans une application utilisant un composant](#NOTE4_1).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) [Créer l'exécutable de l'application utilisant un composant externe](#NOTE5_1).

- [Déployer et mettre à jour l'application utilisant un composant externe](#NOTE6_1).




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Intégrer le composant dans le projet
<a name="integrer_composant_dans_projet_ELTTEXTE000312"></a>


### Intégrer un composant dans un projet
<a name="integrer_composant_dans_projet_ELTPARAGRAPHE000038"></a>Pour intégrer un composant dans un projet : 

1. Ouvrez le projet sous WINDEV, WEBDEV ou WINDEV Mobile.

2. Sous le volet "Projet", dans le groupe "Projet", déroulez "Importer" et sélectionnez "Un composant externe .. A partir d'un fichier". Un sélecteur de fichiers s'ouvre.

3. Sélectionnez le fichier WDI du composant à importer. Selon le mode de diffusion choisi, ce fichier peut être présent :

	- soit dans le répertoire de création du composant si le poste de création et d'utilisation du composant sont identiques,

	- soit dans le répertoire où les fichiers du composant ont été mis à disposition,

	- soit dans le répertoire où la procédure d'installation du composant a copié les fichiers du composant.
			Pour plus de détails, consultez [Distribuer un composant](../Editeurs/2014007.md).




4. Validez. La fenêtre de description du composant sélectionné apparaît. Cette fenêtre présente :

	- la description du composant (société, version, ...). 
			Il est possible de choisir le mode de chargement du composant (au lancement du projet ou à la première utilisation d'un élément du composant). Par défaut, le composant est chargé à la première utilisation d'un élément du composant.

	- la documentation du composant. Cette documentation permet de savoir comment utiliser les différents éléments du composant.




5. Validez. Les différents éléments accessibles et utilisables du composant apparaissent dans le volet "Explorateur du projet". Une icône spécifique indique que l'élément provient d'un composant.



<a name="NOTE2_2"></a>


### Fichiers automatiquement copiés lors de l'intégration du composant dans un projet
<a name="fichiers_automatiquement_copies_lors_integration_composant_dans_projet_ELTPARAGRAPHE000077"></a>Lors de l'intégration du composant dans le projet, tous les fichiers nécessaires au composant sont automatiquement copiés dans le répertoire du projet :

- Le fichier *&lt;Nom du composant&gt;.WDI* est copié dans le répertoire du projet.

- Le fichier* &lt;Nom du composant&gt;.WDK* est copié dans le sous-répertoire EXE du projet.

- Si des fichiers ont été spécifiés dans le fichier optionnel *&lt;Nom du composant&gt;.WDO*, ces fichiers sont recopiés dans le répertoire EXE du projet (en respectant l'arborescence précisée dans le fichier WDO).




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Manipuler les éléments d'un composant par programmation
<a name="manipuler_les_elements_composant_par_programmation_ELTTEXTE000342"></a>
Les éléments visibles d'un composant intégré dans un projet peuvent être manipulés uniquement par programmation.

**Pour manipuler un élément du composant (fenêtre, ...) par programmation**, il suffit de manipuler l'élément comme s'il s'agissait d'un élément créé dans le projet. 

1. Consultez la documentation de l'élément. 
	Pour cela, effectuez une des manipulations suivantes : 

	- double-cliquez sur l'élément depuis le volet "Explorateur du projet".

	- appuyez sur la touche F2 depuis le code de l'élément. 




2. La documentation de l'élément apparaît sous l'éditeur de code. Cette documentation présente les paramètres nécessaires à l'utilisation de l'élément (paramètres attendus en entrée ou en sortie, ...).

3. Utilisez l'élément selon les informations précisées dans la documentation comme si cet élément appartenait au projet. 

	- Pour ouvrir une fenêtre, utilisez par exemple la fonction [Ouvre](../WDLang1/3038035.md) en passant si nécessaire les paramètres attendus par cette fenêtre.
			
		```wl
		Ouvre(FenêtreDuComposant [, Param1, Param2])
		```


	- Pour imprimer un état, utilisez la fonction [iImprimeEtat](../WDLang5/3046032.md) en passant si nécessaire les paramètres attendus par cet état.
			
		```wl
		iImprimeEtat(EtatComposant [, Param1, Param2])
		```


	- Pour appeler une procédure, utilisez la syntaxe habituelle.
			
		```wl
		ProcédureDuComposant(Param1,Param2)
		```


	- Pour utiliser une classe, déclarez une variable du type de la classe.
			
		```wl
		MaVariable est un objet ClasseDuComposant
		```

			La variable s'utilise par la suite comme une variable objet normale.







En cas de conflit avec un élément du projet, il suffit de préfixer le nom de l'élément par le nom du composant. Par exemple : 

```wl
Ouvre(MonComposant.MaFenêtre)
```


Pour utiliser le nom de l'élément dans une variable, il est nécessaire de préciser le nom du composant. Par exemple : 

```wl
sFenêtre est une chaîne = "MonComposant.MaFenêtre"
Ouvre(sFenêtre)
```


Aucune fonction WLangage spécifique à la manipulation du composant n'est nécessaire.
<a name="NOTE3_2"></a>


### Remarque : la documentation technique du composant
<a name="remarque_documentation_technique_composant_ELTPARAGRAPHE000135"></a>La documentation technique du composant est disponible :

- lors de l'intégration d'un composant dans un projet : sous le volet "Projet", dans le groupe "Projet", déroulez "Importer" et sélectionnez "Un composant externe .. A partir d'un fichier".

- à tout moment, dans la description des composants intégrés dans le projet : 

	- Sous le volet "Explorateur de projet", sélectionnez le dossier "Composants externes". 

	- Affichez le menu contextuel et sélectionnez "Liste des composants externes importés dans le projet". 

	- Le bouton [Description] permet d'obtenir les informations et la documentation du composant.






<a name="NOTE3_3"></a>


### Conflits de noms
<a name="conflits_noms_ELTPARAGRAPHE000167"></a>**Attention** : si un élément de votre projet et un élément du composant ont le même nom, pour utiliser l'élément du composant, il est nécessaire de préfixer cet élément par le nom du composant.

Par exemple, la fenêtre "Menu" est disponible dans le projet en cours et dans le composant "Email" utilisé par le projet. Pour ouvrir la fenêtre "Menu" du composant "Email", il est nécessaire d'utiliser la syntaxe suivante :

```wl
Ouvre("Email.Menu")
```

<a name="NOTE3_4"></a>


### Utiliser une procédure d'un composant en compilation dynamique
<a name="utiliser_une_procedure_composant_compilation_dynamique_ELTPARAGRAPHE000177"></a>Pour utiliser une procédure d'un composant en compilation dynamique : 

1. Il est nécessaire que le composant soit chargé. Le composant peut être défini comme "Chargé au lancement de l'application" ou chargé grâce à la fonction [ComposantCharge](../WDLang1/3014023.md).

2. Il est nécessaire d'utiliser le nom complet pour désigner la procédure et de faire suivre ce nom de parenthèses pour indiquer qu'une procédure doit être utilisée (et non une variable globale) : 
	
	```wl
	NomComposant.NomCollection.NomProcédure()
	```

	**Remarque** : Il est également possible d'utiliser la fonction [Exécute](../WDLang1/3013041.md) :
	
	```wl
	Exécute("NomComposant.NomCollection.NomProcédure")
	```




<a name="NOTE3_5"></a>


### Classes et composants
<a name="classes_composants_ELTPARAGRAPHE000199"></a>Un composant peut comporter des classes dans son interface. Il est possible de dériver ces classes dans le projet hôte, de surcharger les méthodes virtuelles, de faire du polymorphisme. L'héritage entre plusieurs niveaux de composants est disponible.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Mise à jour d'un composant
<a name="mise_jour_composant_ELTTEXTE000390"></a>


- **Lorsque une nouvelle version d'un composant est disponible**, il suffit d'installer les nouveaux fichiers de cette mise à jour dans le répertoire d'installation du composant (selon le mode d'installation utilisé). Pour plus de détails sur les différents modes d'installation d'un composant, consultez [Distribuer un composant](../Editeurs/2014007.md).

- **Lors de l'ouverture du projet utilisant ce composant**, le changement de version du composant sera automatiquement détecté et une mise à jour du projet sera proposée. Il est conseillé de recompiler le projet.
	Remarque : Il est possible de forcer la mise à jour d'un composant depuis la liste des composants présents dans le projet : 

	- Sous le volet "Explorateur de projet", sélectionnez le dossier "Composants externes". 

	- Affichez le menu contextuel et sélectionnez "Liste des composants externes importés dans le projet". 

	- Cliquez sur bouton "Mise à jour".




- **Si le composant a été distribué avec une application WINDEV**, il est nécessaire de mettre le composant à jour. Pour plus de détails, consultez [Déploiement d'une application utilisant un composant](../Editeurs/2014004.md).




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

## Création de l'exécutable
<a name="creation_executable_ELTTEXTE000414"></a>
La création de l'exécutable (utilisant le composant) se fait de la même manière que pour une application classique WINDEV. Les DLLs nécessaires au fonctionnement du composant sont automatiquement détectées.

<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Déploiement d'une application utilisant un composant
<a name="deploiement_une_application_utilisant_composant_ELTTEXTE000438"></a>
Le déploiement d'une application utilisant un ou plusieurs composants se fait de la même façon que le déploiement d'une application classique.

Pour plus de détails sur le déploiement d'une application utilisant un ou plusieurs composants, consultez [Déploiement d'une application utilisant un composant](../Editeurs/2014004.md).


