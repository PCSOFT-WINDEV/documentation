


## Création d'une requête de modification 
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000167"></a>
<a name="Requete_modification"></a>
Une requête de modification (instruction SQL correspondante [UPDATE](../Editeurs/2034001.md)) permet de modifier des enregistrements dans un fichier d'une base de données.

Pour obtenir cette modification, les principales caractéristiques de la requête sont les suivantes :

- le fichier de données dans lequel des données vont être modifiées.

- les rubriques dans lesquelles des valeurs vont être modifiées.

- les conditions de sélection des enregistrements (clients habitant Nantes, produits dont le prix est supérieur à 40 Euros, ...).




Pour plus de détails sur les conditions de sélection d'une requête, consultez [Conditions de sélection d'une requête](../Editeurs/2032019.md).

Par exemple, la cliente N° 45762 s'est mariée. Sa civilité et son nom de famille ont été modifiés. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Requete_RequeteModification.gif)
L'éditeur de requêtes génère automatiquement le code SQL de cette requête. 

**Pour visualiser le code SQL d'une requête** : 

1. Affichez le menu contextuel du graphe de la requête.

2. Sélectionnez l'option "Code SQL".




Vous pouvez également utiliser la touche F2. 

Dans notre exemple :

```sql
UPDATE 
	CLIENT
SET
	Civilite = 'Mme',	
	NomClient = 'VAUVERT'
WHERE 
	CLIENT.NumClient = 45762
```
|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | [Le logiciel Etats & Requêtes](../Presentation/3088004.md) ne permet pas de créer des requêtes de modification. |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000209"></a>
Pour créer une nouvelle requête de modification :

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif)
 parmi les boutons d'accès rapide. 

	- La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Requête".

	- L'assistant de création d'une requête se lance.




2. Choisissez de créer une requête de modification (option "Modification (UPDATE)").

3. Si votre projet n'est pas lié à une analyse, spécifiez l'analyse à laquelle la requête doit être rattachée.
	Passez à l'étape suivante de l'assistant.

4. Sélectionnez le fichier de données dans lequel des données vont être modifiées.
	Passez à l'étape suivante de l'assistant.

5. Pour chaque rubrique dont la valeur doit être modifiée, cliquez sur la colonne "Valeur/Paramètre". Une fenêtre permettant de sélectionner la valeur ou le paramètre à modifier s'ouvre.

6. Spécifiez la valeur ou le paramètre contenant la valeur à modifier. Les valeurs à modifier peuvent correspondre à :

	- la valeur par défaut définie dans l'analyse.

	- une valeur à spécifier. Précisez cette valeur.

	- une valeur contenue dans un paramètre. Précisez le nom du paramètre.

	- une valeur nulle.




7. Validez votre choix.

8. Répétez les opérations 5 à 7 pour chaque rubrique dans laquelle une valeur doit être modifiée.

9. Définissez les conditions de sélection. Cliquez dans la colonne "Condition" des différentes rubriques concernées. Pour plus de détails sur les conditions de sélection d'une requête, consultez [Conditions de sélection d'une requête](../Editeurs/2032019.md).
	Passez à l'étape suivante de l'assistant.

10. Précisez si nécessaire l'enchaînement des conditions de sélection avec les opérateurs conditionnels ET et OU :

	- *Opérateur conditionnel ET* : les enregistrements conservés auront répondu aux deux conditions. Par exemple, la requête sélectionne les clients dont le nom commence par la lettre "A" ET habitant à Nantes.

	- *Opérateur conditionnel OU* : les enregistrements conservés auront répondu à une des deux conditions ou aux deux conditions. Par exemple, la requête sélectionne les clients habitant à Toulouse OU habitant à Brest.
			Passez à l'étape suivante de l'assistant.




11. Saisissez le nom de la requête (nom du fichier ".WDR" correspondant à la requête). Ce nom permettra d'identifier la requête dans vos programmes.

12. Spécifiez le libellé de la requête en décrivant succinctement le rôle de la requête. Ce libellé sera utilisé dans le dossier du projet.
	Remarque : Le nom de la requête se définit automatiquement à partir du libellé saisi.

13. Validez la description de la requête. La représentation graphique de la requête s'affiche automatiquement sous l'éditeur de requêtes.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Notes
<a name="notes_ELTTEXTE000233"></a>


- Il est possible de modifier l'ensemble des caractéristiques d'une requête : sous le volet "Requête", dans le groupe "Edition", cliquez sur "Description". Pour plus de détails, consultez [Description d'une requête](../Editeurs/2032038.md).

- Pour générer le code SQL correspondant à cette requête, sélectionnez l'option "Code SQL" du menu contextuel de la requête. Si des modifications sont effectuées dans la description de la requête, ces modifications seront automatiquement répercutées dans le code SQL correspondant.

- Il est également possible de créer une requête à partir d'un ou de plusieurs fichiers de données décrits sous l'éditeur d'analyses : il suffit de faire un "Drag and Drop" du ou des fichiers de données sélectionnés dans le volet "Analyse" vers l'éditeur de requêtes.

- Il est possible de tester la requête créée directement depuis l'éditeur de requêtes. Pour plus de détails, consultez [Tester une requête](../Editeurs/2019011.md). 





