


## Rubriques utilisées dans une requête de sélection 
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000297"></a>
<a name="Rub_Req_sel"></a>
Une requête créée avec l'éditeur de requêtes peut contenir plusieurs types de rubriques :

- **rubriques de l'analyse** à laquelle la requête est rattachée. 
	Ces rubriques correspondent aux rubriques des fichiers de données décrits dans l'analyse. Il est possible d'appliquer sur ces rubriques des opérations de calcul.
	Remarque : Il est possible d'utiliser une rubrique d'index full-text : la requête effectuera alors une recherche full-text. 

- **rubriques d'une requête** du projet en cours. Ces rubriques correspondent aux rubriques utilisées dans les requêtes intégrées à l'application.

- **rubriques de calcul**. Ce type de rubrique permet d'effectuer un [calcul sur les valeurs d'une rubrique](../Editeurs/2032020.md) : somme, moyenne, maximum et minimum.

- **rubriques de comptage**. Ce type de rubrique permet de compter le nombre d'enregistrements présents dans la requête ou le nombre d'enregistrements présents dans un groupement d'enregistrements.

- **rubriques "calculées"**. Ce type de rubrique permet d'ajouter au résultat de la requête une rubrique dont la valeur correspond à une formule de calcul sur des rubriques. Par exemple, PrixHT \* TauxTVA.




Le choix des rubriques intervenant dans une requête se fait lors de la création de la requête. Il est cependant possible d'ajouter, de modifier ou de supprimer les rubriques utilisées dans une requête. Les paragraphes suivants décrivent comment effectuer ces opérations.

**Remarque** : Les rubriques dont la valeur est affichée dans le résultat de la requête sont appelées *rubriques résultat*.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment ajouter une rubrique dans la requête de sélection en cours ?
<a name="comment_ajouter_une_rubrique_dans_requete_selection_cours_ELTTEXTE000321"></a>


### Ajouter une rubrique dans la requête en cours
<a name="ajouter_une_rubrique_dans_requete_cours_ELTPARAGRAPHE000036"></a>**Pour ajouter une rubrique dans la requête en cours** :

1. Affichez la fenêtre de description de la requête : sous le volet "Requête", dans le groupe "Edition", cliquez sur "Description".

2. Dans la partie gauche, double-cliquez sur la rubrique à ajouter. La rubrique ajoutée apparaît automatiquement dans la partie centrale.

3. Validez.


Remarque : Il est également possible d'ajouter une rubrique dans la requête en cours à partir d'une ou de plusieurs rubriques décrites sous l'éditeur d'analyses : il suffit de faire un "Drag and Drop" du ou des rubriques sélectionnées dans le volet "Analyse" vers l'éditeur de requêtes.


### Effectuer une recherche full-text
<a name="effectuer_une_recherche_fulltext_ELTPARAGRAPHE000059"></a>**Pour effectuer une recherche full-text** : 

1. Sélectionnez l'option "Description de la requête" du menu contextuel de la requête. La fenêtre de description de la requête s'affiche.

2. Dans la partie gauche de la fenêtre, double-cliquez sur la rubrique "Index_FullText" à ajouter. L'écran de description de la recherche apparaît.

3. Indiquez les paramètres de la recherche "full-text" à effectuer :

	- l'index pris en compte.

	- la valeur de recherche (valeur ou paramètre). Si la valeur est décrite directement dans la requête, un assistant permet de saisir toutes les conditions nécessaires sur la valeur de recherche.

	- le tri du résultat de la requête selon l'indice de pertinence de la recherche pour chaque enregistre­ment. 
			Remarque : seuls les enregistrements ayant un indice de pertinence supérieur à 0 sont conservés dans le résultat de la requête.






<a name="NOTE2_2"></a>


### Ajouter une rubrique de comptage dans la requête en cours
<a name="ajouter_une_rubrique_comptage_dans_requete_cours_ELTPARAGRAPHE000076"></a>**Pour ajouter une rubrique de comptage dans la requête en cours** :

1. Affichez la fenêtre de description de la requête : sous le volet "Requête", dans le groupe "Edition", cliquez sur "Description".

2. Dans la partie droite, déroulez sur le bouton "Compter".

3. Pour compter :

	- le nombre de valeurs de la rubrique sélectionnée dans le résultat de la requête : sélectionnez l'option "Sur la rubrique sélectionnée".
			Par exemple, cette option peut être utilisée pour connaître le nombre de clients ayant un téléphone portable (rubrique "TelPortable" renseignée).

	- le nombre de valeurs d'une autre rubrique dans le résultat de la requête : sélectionnez l'option "Sur une nouvelle rubrique" et sélectionnez la rubrique voulue.

	- le nombre d'enregistrements d'un fichier ou d'une requête (en fonction des conditions de sélection de la requête en cours) : sélectionnez l'option "Sur un fichier ou une requête".
			Par exemple, cette option peut être utilisée pour connaître le nombre de produits présents dans le fichier "Produit".





Remarque : Quel que soit le comptage effectué, il est possible de préciser si le comptage doit prendre en compte les doublons ou non (option Count(Distinct) en SQL).
<a name="NOTE2_3"></a>


### Ajouter une rubrique de type "calculée" dans la requête en cours
<a name="ajouter_une_rubrique_type_calculee_dans_requete_cours_ELTPARAGRAPHE000109"></a>**Pour ajouter une rubrique de type "calculée" dans la requête en cours** :

1. Affichez la fenêtre de description de la requête : sous le volet "Requête", dans le groupe "Edition", cliquez sur "Description".

2. Dans la partie gauche, déroulez le bouton "Rubrique calculée" et sélectionnez l'option "Nouvelle rubrique calculée". La fenêtre de description d'une rubrique calculée s'affiche. Cette fenêtre permet de saisir le code SQL correspondant au calcul à effectuer. Dans cette fenêtre, il est possible :

	- de manipuler les rubriques des fichiers de l'analyse en cours et des requêtes du projet en cours.

	- de saisir des instructions SQL. La liste des instructions SQL disponibles est affichée. Il suffit de double-cliquer sur une instruction pour la faire apparaître dans la partie code.

	- de saisir des fonctions WLangage. La liste des fonctions WLangage disponibles est affichée. Il suffit de double-cliquer sur une fonction pour la faire apparaître dans la partie code. Pour utiliser une fonction WLangage, son nom doit être précédé des lettres "WL.".

	- d'imbriquer les fonctions WLangage et le code SQL utilisé.




3. Précisez la formule mathématique de la rubrique et validez. La rubrique est automatiquement ajoutée.




**Remarque** : Utiliser des paramètres dans le code de la rubrique calculée. 
Pour utiliser des paramètres dans le code de la rubrique, il suffit de mettre le nom du paramètre entre accolades. Par exemple :

```txt
LEFT(MaRubrique, {NomParamètre})
```
Attention : En mode test et en exécution réelle, le résultat peut être différent. En effet, en mode test, la valeur du paramètre est toujours passée en tant que chaîne.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Comment modifier une rubrique de type "rubrique calculée" dans la requête en cours ?
<a name="comment_modifier_une_rubrique_type_rubrique_calculee_dans_requete_cours_ELTTEXTE000363"></a>
**Pour modifier une rubrique de type "rubrique calculée" dans la requête en cours** :

1. Affichez la fenêtre de description de la requête : sous le volet "Requête", dans le groupe "Edition", cliquez sur "Description".

2. Dans la partie centrale, sélectionnez la rubrique de type Rubrique calculée à modifier.

3. Dans la partie gauche, cliquez sur le bouton "Rubrique calculée" et sélectionnez l'option "Modifier la rubrique calculée". La fenêtre de description d'une rubrique calculée s'affiche.

4. Modifiez la formule et validez.


**Remarque** : Utiliser des paramètres dans le code de la rubrique calculée. 
Pour utiliser des paramètres dans le code de la rubrique, il suffit de mettre le nom du paramètre entre accolades. Par exemple :

```txt
LEFT(MaRubrique, {NomParamètre})
```
Attention : En mode test et en exécution réelle, le résultat peut être différent. En effet, en mode test, la valeur du paramètre est toujours passée en tant que chaîne.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Comment renommer une rubrique dans la requête en cours ?
<a name="comment_renommer_une_rubrique_dans_requete_cours_ELTTEXTE000387"></a>
**Pour renommer une rubrique résultat dans la requête en cours** (création d'un alias) :

1. Affichez la fenêtre de description de la requête : sous le volet "Requête", dans le groupe "Edition", cliquez sur "Description".

2. Dans la partie centrale, sélectionnez la rubrique à renommer.

3. Dans la partie droite, cliquez sur le bouton "Afficher/Renommer".

4. Saisissez le nouveau nom de la rubrique et validez. La rubrique est automatiquement renommée.




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Comment afficher/rendre invisible une rubrique dans la requête en cours ?
<a name="comment_afficherrendre_invisible_une_rubrique_dans_requete_cours_ELTTEXTE000411"></a>
**Pour afficher/rendre invisible une rubrique dans le résultat de la requête** :

1. Affichez la fenêtre de description de la requête : sous le volet "Requête", dans le groupe "Edition", cliquez sur "Description".

2. Dans la partie centrale, sélectionnez la rubrique à afficher/rendre invisible.

3. Dans la partie droite, cliquez sur le bouton "Afficher/Renommer".

4. Répondez "Non" à la question "Afficher cette rubrique ?".




Remarque : Pour afficher/rendre invisible une rubrique dans le résultat de la requête, il est également possible de :

- afficher le menu contextuel de la rubrique voulue (clic droit).

- sélectionner l'option "Afficher la rubrique" ou "Ne pas afficher".




<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Comment supprimer une rubrique de la requête en cours ?
<a name="comment_supprimer_une_rubrique_requete_cours_ELTTEXTE000435"></a>
**Pour supprimer une rubrique de la requête en cours** :

1. Affichez la fenêtre de description de la requête : sous le volet "Requête", dans le groupe "Edition", cliquez sur "Description".

2. Dans la partie centrale, sélectionnez la rubrique à supprimer et appuyez sur la touche Suppr. La rubrique est automatiquement supprimée de la requête.




Remarques :

- La suppression d'une rubrique supprime les conditions de sélection existantes sur cette rubrique.

- Pour supprimer une rubrique, il est également possible de sélectionner l'option "Supprimer la rubrique" dans le menu contextuel de la rubrique.





