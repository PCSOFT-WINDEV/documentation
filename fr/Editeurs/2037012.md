
## Configuration du serveur IIS 7/7.5
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Installation de IIS 7
<a name="installation_iis_7_ELTTEXTE000219"></a>
Le serveur IIS 7 est livré avec Windows Vista/7. Pour configurer IIS 7 pour WEBDEV, il est nécessaire d'installer certains éléments de IIS 7.

Pour installer IIS 7 : 

1. Ouvrez le panneau de configuration de Windows ("Démarrer .. Panneau de configuration").

2. Double-cliquez sur "Programmes et fonctionnalités".

3. Cliquez sur "Activer / Désactiver des fonctionnalités Windows".

4. Dans la fenêtre qui s'affiche, cliquez sur l'option "Services Internet (IIS)" et sélectionnez les options suivantes :




Pour Windows Vista et 7, les options se présentent de la façon suivante :

- **Pour Windows Vista :** ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IIS_Version7.gif)


- **Pour Windows 7 :** ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IIS7_SevenFR.gif)







Les options suivantes doivent être cochées :


|   |   |
| --- | --- |
| Compatibilité avec la métabase IIS et la configuration IIS 6 | Permet la configuration de IIS 7 par la métabase.<br><br>Cette option est obligatoire. |
| Console de gestion IIS | Permet de configurer IIS 7<br>Cette option n'est pas obligatoire, mais nécessaire pour effectuer une configuration manuelle de IIS 7. |
| Console de gestion FTP | Permet de configurer le serveur FTP |
| Serveur FTP | Nécessaire pour effectuer un déploiement à distance. |
| Journalisation HTTP | Nécessaire pour utiliser WDStatistiques |
| CGI | Permet d'afficher les pages dynamiques WEBDEV<br><br>Option obligatoire. |
| Contenu statique | Permet de gérer les fichiers statiques (.CSS, images, ...). <br><br>Option obligatoire. |
| Document par défaut | Permet de gérer la page par défaut du site |
| Authentification de base | Nécessaire pour effectuer un déploiement à distance. |

Remarque : Attention : Si vous utilisez un anti-virus, il peut être nécessaire de le désactiver pour que le test d'un site WEBDEV avec IIS 7 fonctionne.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Configuration du serveur pour le protocole CGI (AWP)
<a name="configuration_serveur_pour_protocole_cgi_awp_ELTTEXTE000243"></a>
Pour configurer le serveur Web :

1. Ouvrez le gestionnaire de service Internet Microsoft (Option "Démarrer .. Exécuter .. Inetmgr.exe" depuis le bureau de Windows).

2. Placez-vous à la racine du poste dans le TreeView de gauche et cliquez sur le bouton "Restrictions ISAPI et CGI". Cliquez sur "Ajouter".

3. Indiquez le chemin :

	- du fichier WD280AWP.EXE présent dans le sous-répertoire Programmes\\MOTEUR\\WINDOWS\\AWP. Ce chemin ne doit pas contenir d'espaces.

	- du fichier WD280INSTAWP.EXE présent dans le sous-répertoire Programmes\\MOTEUR\\WINDOWS\\AWP. Ce chemin ne doit pas contenir d'espaces.




4. Cochez l'option "Autoriser l'exécution du chemin de l'extension".

5. Validez.

6. Dans le Treeview à gauche, double-cliquez sur "Sites Web" puis sélectionnez l'option "Default Web Site". Dans le menu contextuel de cette option, sélectionnez "Ajouter un répertoire virtuel".

7. Dans l'écran qui s'affiche :

	- Indiquez l'alias du protocole CGI : wd280awp.

	- Sélectionnez le répertoire du protocole CGI (sous-répertoire Programmes\\MOTEUR\\WINDOWS\\AWP du répertoire d'installation de WEBDEV). Ce chemin ne doit pas contenir d'espaces. Cliquez sur OK.




8. Sélectionnez WD280AWP dans le treeview.

9. Double-cliquez sur le bouton "Mappages de gestionnaires".

10. Sélectionnez l'option "Modifier les autorisations du gestionnaire".

11. Dans la fenêtre qui s'affiche, sélectionnez les options "Lecture", "Script", "Exécution".

12. Validez.






<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Configuration du serveur pour les sites WEBDEV
<a name="configuration_serveur_pour_les_sites_webdev_ELTTEXTE000267"></a>
Pour configurer le serveur Web :

1. Ouvrez le gestionnaire de service Internet Microsoft (Option "Démarrer .. Exécuter .. Inetmgr.exe" depuis le bureau de Windows.

2. Dans le Treeview à gauche, double-cliquez sur "Sites", puis sélectionnez l'option "Default Web Site" (ou sélectionnez le site WEB par défaut où les sites dynamiques WEBDEV doivent être installés). Dans le menu contextuel de cette option, sélectionnez "Ajouter un répertoire virtuel".

3. Dans l'écran qui s'affiche :

	- Indiquez l'alias du répertoire contenant les images de votre projet : &lt;MonProjet&gt;_WEB. Par exemple MARKET_WEB.

	- Sélectionnez le répertoire contenant les images de votre projet : &lt;Nom Projet&gt;_WEB. Par exemple : C:\\WWprojet\\MARKET\\MARKET_WEB.




4. Cliquez sur OK.

5. Sélectionnez le nom de votre alias dans le treeview à gauche.

6. Double-cliquez sur le bouton "Mappage de gestionnaire".

7. Sélectionnez l'option "Modifier les autorisations de la fonction" dans la liste de liens à droite.

8. Dans la fenêtre qui s'affiche, sélectionnez les options "Lecture", "Script" et validez.

9. Sélectionnez à nouveau le site Web dans le treeview à gauche ("Default Web Site" s'il n'y a qu'un site).

10. Double-cliquez sur le bouton "Mappages de gestionnaires".

11. Sélectionnez l'option "Ajouter un mappage de scripts" dans la liste des liens à droite.

12. Dans la fenêtre qui s'affiche :

	- Dans le champ "Chemin des demandes", indiquez le nom de votre projet précédé d'un slash. Par exemple : "/MARKET_WEB". 

	- Dans le champ "Exécutable", indiquez le chemin du fichier WD280AWP.EXE présent dans le sous-répertoire "Programmes\\MOTEUR\\WINDOWS\\AWP". Vous pouvez utiliser le bouton "..." pour sélectionner ce fichier. Exemple : "C:\\WebDev\\AWP\\WD280awp.exe".
			Attention : 

		- Par défaut, le sélecteur de fichiers filtre uniquement les librairies ("\*.dll") en bas à droite. Basculez le filtre sur les exécutables ("\*.exe") pour sélectionner le fichier. 

		- Si le chemin contient des espaces, ajoutez des guillemets au début et à la fin.




- Le contenu du champ "Nom" n'a pas d'importance. 

- Cliquez sur le bouton "Restriction des demandes". 

	- Dans le volet "Mappage", décochez "Appeler le gestionnaire seulement si une demande est mappée à".

	- Dans le volet "Verbes", vérifiez que le sélecteur est sur "Tous les verbes". 

	- Dans le volet "Accès", vérifiez que le sélecteur est sur "Script".




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Configuration du serveur pour les sites utilisant des pages AWP (Active Web Pages)
<a name="configuration_serveur_pour_les_sites_utilisant_des_pages_awp_active_web_pages_ELTTEXTE000291"></a>
Pour configurer le serveur : 

1. Ouvrez le gestionnaire de service Internet Microsoft.

2. Dans le treeview à gauche, double-cliquez sur "Sites Web", puis sélectionnez l'option "Default Web Site" (ou sélectionnez le site WEB par défaut où les sites dynamiques WEBDEV doivent être installés).

3. Double-cliquez sur l'option "Mappages de gestionnaires".

4. Ajoutez un mappage de script :

	- le chemin des demandes est : \*.awp

	- indiquez le chemin du fichier WD280AWP.EXE présent dans le sous-répertoire Programmes\\MOTEUR\\WINDOWS\\AWP. Ce chemin ne doit pas contenir d'espaces.

	- donnez un nom quelconque.




5. Validez et répondez "Non" au message.







