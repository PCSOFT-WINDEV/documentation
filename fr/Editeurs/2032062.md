


## Création d'une requête de sélection 
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000240"></a>
<a name="Requete_selection"></a>
Une ***requête de sélection*** (instruction SQL correspondante [SELECT](../Editeurs/2034001.md)) permet de visualiser une sélection d'enregistrements dans une base de données. C'est le type de requête le plus utilisé.

Pour obtenir cette sélection, les principales caractéristiques de la requête sont les suivantes :

- le type de jointure entre les fichiers de données utilisés (si plusieurs fichiers de données sont utilisés),

- les conditions de sélection des enregistrements (clients habitant Nantes, produits dont le prix est supérieur à 40 Euros, ...),

- le regroupement des valeurs d'une rubrique (regroupement des produits par type, des clients par âge, ...),

- les opérations effectuées sur le contenu des rubriques (somme totale des commandes d'un client, somme moyenne dépensée par client, ...),

- le tri du résultat de la requête (résultat trié par codes postaux, par prix, ...).




Par exemple, vous voulez obtenir la somme totale des commandes par client habitant Londres. Seuls les clients ayant un cumul des commandes supérieur à 3000 Euros seront conservés. Le résultat sera trié par ordre croissant du cumul des commandes. Pour réaliser cette requête, le résultat sera automatiquement regroupé par nom du client et par ville. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Requete_RequeteSelection.gif)
 L'éditeur de requêtes génère automatiquement le code SQL de cette requête. 

**Pour visualiser le code SQL d'une requête** : 

1. Affichez le menu contextuel du graphe de la requête.

2. Sélectionnez l'option "Code SQL".




Vous pouvez également utiliser la touche F2. 

```sql
SELECT 
	CLIENT.NomClient AS NomClient,	
	CLIENT.VILLE AS VILLE,	
	SUM(COMMANDE.TotalTTC) AS la_somme_TotalTTC
FROM 
	CLIENT,	
	COMMANDE
WHERE 
	CLIENT.NumClient = COMMANDE.NumClient
	AND
	(
		CLIENT.VILLE = 'Londres'
	)
GROUP BY 
	CLIENT.NomClient,	
	CLIENT.VILLE
HAVING 
	SUM(COMMANDE.TotalTTC) > 3000
ORDER BY 
	la_somme_TotalTTC ASC
```


Pour plus de détails sur la fenêtre de description d'une requête de sélection et son utilisation, consultez : 

- [Fenêtre de description d'une requête de sélection](../Editeurs/2032049.md). 

- [Fenêtre de description d'une requête de sélection : Utilisation](../Editeurs/2032046.md).




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000264"></a>
Pour créer une requête de sélection, deux méthodes sont disponibles :

- création à l'aide de la fenêtre de description d'une requête de sélection.

- création à l'aide d'un assistant simplifié.



<a name="NOTE2_2"></a>


### Créer une nouvelle requête de sélection avec la fenêtre de description d'une requête de sélection
<a name="creer_une_nouvelle_requete_selection_avec_fenetre_description_une_requete_selection_ELTPARAGRAPHE000059"></a>Pour créer une nouvelle requête de sélection avec la fenêtre de description d'une requête de sélection :

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif) parmi les boutons d'accès rapide. 

	- Dans la fenêtre qui s'affiche, cliquez sur "Requête".

	- L'assistant de création d'une requête se lance.




2. Choisissez de créer une requête de sélection (option "Sélection (SELECT)"). 
	Passez à l'étape suivante de l'assistant.

3. Si votre projet n'est pas lié à une analyse, spécifiez l'analyse à laquelle la requête doit être rattachée. Validez.

4. La fenêtre de description de la requête s'affiche.

5. Saisissez le nom de la requête (nom du fichier ".WDR" correspondant à la requête). Ce nom permettra d'identifier la requête dans vos programmes.

6. Spécifiez le libellé de la requête en décrivant succinctement le rôle de la requête. Ce libellé sera utilisé dans le dossier du projet.

7. Dans [la partie gauche](../Editeurs/2032011.md), sélectionnez les différentes rubriques utilisées par la requête.
	Remarque : Pour simplifier la sélection des rubriques, affichez ces rubriques par fichier de données associé, par requête associée ou par ordre alphabétique.
	Pour plus de détails sur les rubriques d'une requête, consultez [Rubriques intervenant dans une requête](../Editeurs/2032004.md).

8. Dans [la partie centrale](../Editeurs/2032011.md), sélectionnez la rubrique sur laquelle une action doit être réalisée (condition de sélection, tri, ...).

9. Dans [la partie droite](../Editeurs/2032039.md), définissez les actions à réaliser sur la rubrique sélectionnée (condition de sélection, tri, ...).
	Pour plus de détails, consultez :

	- [les conditions de sélection d'une requête](../Editeurs/2032019.md),

	- [les opérations possibles dans une requête](../Editeurs/2032020.md),

	- [l'ordre de tri des enregistrements d'une requête](../Editeurs/2032005.md).




10. Supprimez si nécessaire les enregistrements "doublons" du résultat de la requête (bouton "Supprimer les doublons"). 
	Dans ce cas, chaque enregistrement du résultat de la requête sera unique. Par exemple, si une requête affiche tous les clients ayant passé au moins une commande, les clients ayant passé plusieurs commandes n'apparaîtront qu'une seule fois dans le résultat de la requête.

11. Validez la fenêtre. La représentation graphique de la requête s'affiche automatiquement.

12. Sous le volet "Accueil", dans le groupe "Général", déroulez "Enregistrer" et cliquez sur "Enregistrer" pour sauvegarder la requête.



<a name="NOTE2_3"></a>


### Créer une nouvelle requête de sélection avec l'assistant simplifié
<a name="creer_une_nouvelle_requete_selection_avec_assistant_simplifie_ELTPARAGRAPHE000128"></a>Pour créer une nouvelle requête de sélection avec l'assistant simplifié :

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif) parmi les boutons d'accès rapide.  Dans la fenêtre qui s'affiche, cliquez sur "Requête". L'assistant de création d'une requête se lance.

2. Choisissez de créer une requête de sélection (option "Sélection (SELECT)"), cochez l'option "Utiliser l'assistant simplifié".
	Passez à l'étape suivante de l'assistant.

3. Si votre projet n'est pas lié à une analyse, spécifiez l'analyse à laquelle la requête doit être rattachée.
	Passez à l'étape suivante de l'assistant.

4. Sélectionnez les différentes rubriques utilisées par la requête.
	Remarque : Pour simplifier la sélection des rubriques, affichez ces rubriques par fichier de données associé, par requête associée ou par ordre alphabétique.
	Pour plus de détails sur les rubriques d'une requête, consultez [Rubriques intervenant dans une requête](../Editeurs/2032004.md).
	Passez à l'étape suivante de l'assistant.

5. Sélectionnez l'ordre de visualisation des rubriques. Passez à l'étape suivante.

6. Indiquez si des conditions de sélection doivent être décrites ou non. 
	Passez à l'étape suivante.
	Si des conditions de sélections doivent être définies :

	- sélectionnez la rubrique sur laquelle une condition de sélection doit être ajoutée.

	- choisissez les critères de sélection (égale à, supérieur à, ...) de la condition. Cette condition peut porter sur une valeur donnée, un paramètre, les enregistrements sélectionnées par une autre requête, ...
			Répétez cette étape pour toutes les conditions de sélection à définir.




7. Spécifiez si les enregistrements sélectionnés par la requêtes doivent être triés ou non.
	Dans ce cas, sélectionnez la rubrique de tri et spécifiez l'ordre de tri.

8. Saisissez le nom de la requête (nom du fichier ".WDR" correspondant à la requête). Ce nom permettra d'identifier la requête dans vos programmes.

9. Spécifiez le libellé de la requête en décrivant succinctement le rôle de la requête. Ce libellé sera utilisé dans le dossier du projet.
	Remarque : Le nom de la requête se définit automatiquement à partir du libellé saisi.

10. Validez la description de la requête. La représentation graphique de la requête s'affiche automatiquement sous l'éditeur de requêtes.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Notes
<a name="notes_ELTTEXTE000300"></a>


- Pour modifier les caractéristiques d'une requête, sous le volet "Requête", dans le groupe "Edition", cliquez sur "Description". Pour plus de détails, consultez [Description d'une requête](../Editeurs/2032038.md).

- Pour générer le code SQL correspondant à cette requête, sélectionnez l'option "Code SQL" du menu contextuel de la requête. Si des modifications sont effectuées dans la description de la requête, ces modifications seront automatiquement répercutées dans le code SQL correspondant.

- Il est également possible de créer une requête à partir d'un ou de plusieurs fichiers de données décrits sous l'éditeur d'analyses : il suffit de faire un "Drag and Drop" du ou des fichiers de données sélectionnés dans le volet "Analyse" vers l'éditeur de requêtes.





