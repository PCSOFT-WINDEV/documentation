


## Paramètres des bases de données (Programme d'installation)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000390"></a>
L'assistant de création du programme d'installation prend en compte l'installation de la base de données avec l'application et propose différents éléments optionnels. 

Ces modules additionnels pour l'utilisation d'une base de données permettent d'ajouter des options supplémentaires au programme d'installation. L'utilisateur pourra ainsi accéder aux paramètres avancés de l'installation. 

Il est possible de :

- [Paramétrer la synchronisation des données déployées (modification automatique des fichiers de données)](#NOTE2_1).

- [Indexer les fichiers HFSQL pendant l'installation](#NOTE3_1).

- [Intégrer l'installation d'un serveur HFSQL Client/Serveur](#NOTE4_1).

- [Configurer l'emplacement des fichiers de données de l'application](#NOTE5_1).

- [Déployer des fichiers de données sur un serveur HFSQL](#NOTE6_1).

- [Personnaliser l'emplacement des fichiers du groupware lors de l'installation](#NOTE7_1).

- [Inclure le MDAC dans l'installation](#NOTE8_1).

- [Installer le driver ODBC pour HFSQL](#NOTE9_1).

- [Installer le provider OLEDB pour HFSQL](#NOTE10_1).

- [Installer et paramétrer les modules de réplication universelle assistée](#NOTE11_1).






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Paramétrer la synchronisation des données déployées (modification automatique des fichiers de données)
<a name="parametrer_synchronisation_des_donnees_deployees_modification_automatique_des_fichiers_donnees_ELTTEXTE000420"></a>
Si l'option "Paramétrer la synchronisation des données déployées (modif. auto)" est cochée, la modification automatique des données sera effectuée lors de l'installation de l'application en cours.

La modification automatique des données permet de mettre à jour la description des fichiers de données présents sur les postes utilisateurs. Pour plus de détails, consultez :

- [La modification automatique des données](../WDLang4/3044195.md).

- [Paramétrer la modification automatique des fichiers de données](../Editeurs/2028043.md).




**Remarques** : 

- Si cette option est cochée, la modification automatique des données sera effectuée (qu'elle soit nécessaire ou non). Si la modification automatique est effectuée sur des données déjà à jour, cette modification n'aura aucune incidence sur l'application.

- Par défaut, la modification automatique des données est "silencieuse". Pour donner la possibilité à l'utilisateur final de personnaliser la modification automatique des données, il est nécessaire d'utiliser l'éditeur d'installation. 




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Indexer les fichiers HFSQL pendant l'installation
<a name="indexer_les_fichiers_hfsql_pendant_installation_ELTTEXTE000444"></a>
L'option "Indexer les fichiers HFSQL pendant l'installation" permet de réduire la taille du programme d'installation en supprimant les fichiers d'index du programme d'installation. Ces fichiers d'index seront automatiquement re-créés sur le poste de l'utilisateur final lors de l'installation de l'application.

Vous pouvez sélectionner les fichiers pour lesquels les fichiers d'index doivent être supprimés.

**Remarques** :

- Cette fonctionnalité n'est pas disponible pour les fichiers de données protégés par mot de passe.

- Cette fonctionnalité est disponible uniquement sur les fichiers de données HFSQL Classic. Pour des fichiers HFSQL Client/Serveur, la configuration est effectuée grâce à l'option "Déployer des fichiers de données sur un serveur HFSQL".




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Intégrer l'installation d'un serveur HFSQL
<a name="integrer_installation_serveur_hfsql_ELTTEXTE000468"></a>
L'option "Intégrer l'installation d'un serveur HFSQL" permet de redistribuer l'installation d'un serveur HFSQL Client/Serveur. Pour plus de détails, consultez [Installer un serveur HFSQL Client/Serveur](../Editeurs/2028081.md).

<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Configurer l'emplacement des fichiers de données de l'application
<a name="configurer_emplacement_des_fichiers_donnees_application_ELTTEXTE000492"></a>
L'option "Configurer l'emplacement des fichiers de données de l'application" permet de définir l'emplacement des fichiers de données de l'application. 

Les connexions suivantes sont listées :

- La connexion nommée "***Emplacement par défaut***" : Cette connexion correspond à l'emplacement des fichiers HyperFileSQL Classic présents dans l'analyse et associés à aucune connexion. Par défaut, les fichiers de données sont créés dans les répertoires spécifiés lors de la description des fichiers dans l'analyse.

- Les connexions définies dans l'analyse.




Les informations de connexion utilisées par l'application seront présentes dans le fichier d'extension ".WX" présent à côté de l'exécutable.

Le bouton "Paramètres" permet de configurer ces connexions si nécessaire :  

- Si l'option "Toutes les connexions utilisent les mêmes paramètres" est cochée, une seule connexion pourra être paramétrée.

- Si l'option "Chaque connexion est paramétrée différemment" est cochée, toutes les connexions peuvent être paramétrées une à une.




L'écran de paramétrage de la connexion permet :

- soit d'utiliser les valeurs données dans l'analyse du projet.

- soit d'utiliser les valeurs données dans le fichier .WER (cas d'une réplication universelle).

- soit d'utiliser de nouvelles valeurs. Dans ce cas, il est possible de définir une nouvelle connexion avec toutes ses caractéristiques.

- soit d'utiliser les valeurs saisies lors de l'installation. Dans ce cas, c'est l'utilisateur qui indique l'emplacement des données lors de l'installation de l'application. Les valeurs par défaut proposées à l'utilisateur peuvent être saisies dans l'écran de paramétrage.

- de conserver les paramètres du serveur. Cette option est disponible uniquement si l'installation d'un serveur HFSQL a été intégrée à l'installation de l'application.



<a name="NOTE5_2"></a>


### Remarques
<a name="remarques_ELTPARAGRAPHE000125"></a>

- Si les paramètres de la connexion sont modifiés entre deux installations, il est possible de forcer les nouveaux paramètres grâce à l'option "Les paramètres ci-dessus remplaceront les valeurs saisies lors d'une installation précédente".

- La variable ***FicInst*** permet d'utiliser le chemin des fichiers de données pour des fichiers HFSQL Classic. Le chemin utilisé est celui défini dans les propriétés HFSQL Classic d'une connexion à une base de données HFSQL Classic (ISAM).



<a name="NOTE5_3"></a>


### Installation d'une application qui crée des fichiers de données HFSQL Classic
<a name="installation_une_application_qui_cree_des_fichiers_donnees_hfsql_classic_ELTPARAGRAPHE000133"></a>Par défaut, les fichiers de données sont créés dans les répertoires spécifiés lors de la description des fichiers dans l'analyse. Cependant, il est possible de modifier ces répertoires :

- lors de la création de l'exécutable de l'application.

- par programmation grâce aux fonctions [HSubstRep](../WDLang4/3044028.md) ou [HChangeRep](../WDLang4/3044168.md).

- lors de la création du programme d'installation (paramétrage de la connexion nommée "***Emplacement par défaut***")

- lors de l'installation. Le répertoire de création des fichiers de données sera alors sélectionné par l'utilisateur.




Si votre application utilise des fichiers de données, vous pouvez ***permettre à l'utilisateur de paramétrer l'emplacement des fichiers de données*** lors de l'installation de l'application. Le répertoire sélectionné par l'utilisateur sera automatiquement utilisé pour l'ensemble des fichiers de données créés par l'application.

**Remarque** : Ce répertoire sera proposé par défaut lors de l'installation des mises à jour de l'application. Cette option permet d'éviter de programmer l'emplacement des fichiers de données (avec la fonction [HSubstRep](../WDLang4/3044028.md) par exemple).

**Rappel** : Dans tous les cas, le répertoire de création des fichiers de données HFSQL Classic est défini selon l'ordre de priorité suivant :

1. Répertoire spécifié grâce aux fonctions [HSubstRep](../WDLang4/3044028.md) ou [HChangeRep](../WDLang4/3044168.md).

2. Répertoire sélectionné lors de l'installation de l'application (si cette option est proposée à l'utilisateur).

3. Répertoire sélectionné lors de la création de l'exécutable.

4. Répertoire spécifié lors de la description des fichiers dans l'analyse.




Ainsi, le répertoire défini par les fonctions [HSubstRep](../WDLang4/3044028.md) ou [HChangeRep](../WDLang4/3044168.md) est prioritaire sur tous les autres répertoires définis.
<a name="NOTE5_4"></a>


### Installation d'une application et de ses fichiers de données HFSQL Classic
<a name="installation_une_application_ses_fichiers_donnees_hfsql_classic_ELTPARAGRAPHE000179"></a>Ces fichiers de données sont installés dans le répertoire spécifié dans l'assistant de création du programme d'installation.

Dans le cas d'une installation réseau, ces fichiers de données seront installés dans le sous-répertoire "&lt;NomExécutable&gt;" du répertoire d'installation de l'application sur le poste serveur. Ce répertoire peut être modifié si nécessaire dans l'écran de paramétrage de la connexion nommée "***Emplacement par défaut***".

<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Déployer des fichiers de données sur un serveur HFSQL
<a name="deployer_des_fichiers_donnees_sur_serveur_hfsql_ELTTEXTE000534"></a>
Lors de la création du programme d'installation de l'application, il est également possible de déployer directement les fichiers de données HFSQL Client/Serveur sur le serveur voulu grâce à l'option "Déployer des fichiers de données sur un serveur HFSQL".

Pour chaque fichier de données de l'application, il est possible d'indiquer grâce au bouton "Propriétés" :

- la connexion qui doit être associée à ce fichier de données. 

- l'emplacement actuel du fichier de données à installer (l'emplacement du fichier de données source).

- si l'index doit être copié ou non. Si l'index n'est pas copié, il sera automatiquement reconstruit lors de l'installation. Cette option permet de limiter la taille du programme d'installation si le fichier d'index est très important.




**Remarque** : L'emplacement actuel des fichiers de données peut correspondre aux fichiers de données présents sur un serveur accessible ou bien aux fichiers de données recopiés en local.

<a name="NOTE7"></a>
<a name="NOTE7_1"></a>


## Personnaliser l'emplacement des fichiers du groupware lors de l'installation
<a name="personnaliser_emplacement_des_fichiers_groupware_lors_installation_ELTTEXTE000558"></a>


### Groupware utilisateur après la version 18
<a name="groupware_utilisateur_apres_version_18_ELTPARAGRAPHE000205"></a>Si votre application gère le [groupware utilisateur](../Editeurs/1000021152.md), l'option "Personnaliser l'emplacement des fichiers du groupware lors de l'installation" permet de configurer l'emplacement des fichiers de données du Groupware Utilisateur. 

Par défaut, ces fichiers de données sont créés dans le sous-répertoire "GPW_&lt;Nom Application&gt;" du répertoire d'installation de l'application. Il est cependant possible de modifier ce répertoire. Le tableau suivant présente les différents moyens proposés par WINDEV pour modifier ce répertoire.

**Comment modifier le répertoire de création de ces fichiers ?** 

- Lors de la configuration du groupware utilisateur (attention : ce répertoire est utilisé uniquement pour les tests de l'application).

- Lors de la création de l'exécutable de l'application.

- Lors de l'installation de l'application. Ce répertoire est alors sélectionné par l'utilisateur.




**Quel est l'ordre de priorité appliqué pour définir le répertoire de création de ces fichiers ?**

1. Le répertoire sélectionné par l'utilisateur lors de l'installation de l'application (si le programme d'installation permet à l'utilisateur de sélectionner ce répertoire).

2. Le répertoire sélectionné lors de la création de l'exécutable de l'application.

3. Le répertoire par défaut (sous-répertoire "GPW_&lt;NomApplication&gt;" du répertoire d'installation de l'application).


Ainsi, le répertoire sélectionné par l'utilisateur est prioritaire sur tous les autres répertoires définis.

Pour proposer à l'utilisateur le paramétrage de l'emplacement des fichiers du groupware utilisateur, cochez l'option "Personnaliser l'emplacement des fichiers du groupware lors de l'installation".


### Groupware utilisateur avant la version 18
<a name="groupware_utilisateur_avant_version_18_ELTPARAGRAPHE000231"></a>Si votre application gère le [groupware utilisateur](../Editeurs/2018001.md), deux catégories de fichiers sont gérées :

- ***Les fichiers de données permettant d'identifier les utilisateurs***. Ces fichiers de données peuvent être communs à plusieurs applications.

- ***Les fichiers de données permettant de gérer les droits des utilisateurs sur les différentes fenêtres de l'application***. Ces fichiers sont spécifiques à l'application.




Pour plus de détails sur ces fichiers, consultez [Les fichiers du groupware utilisateur](../Editeurs/2018002.md).

Par défaut, ces fichiers de données sont créés dans le sous-répertoire "GPW_&lt;Nom Application&gt;" du répertoire d'installation de l'application. Il est cependant possible de modifier ce répertoire. Le tableau suivant présente les différents moyens proposés par WINDEV pour modifier ce répertoire.

|   | Fichiers de données permettant <br>d'identifier les utilisateurs | Fichiers de données permettant <br>de gérer les droits des utilisateurs |
| --- | --- | --- |
| Comment modifier le répertoire de création de ces fichiers ? | <br><br>- Lors de la configuration du groupware utilisateur (attention : ce répertoire est utilisé uniquement pour les tests de l'application).<br><br>- Lors de la création de l'exécutable de l'application.<br><br>- Lors de l'installation de l'application. Ce répertoire est alors sélectionné par l'utilisateur.<br><br><br> | <br><br>- Lors de l'installation de l'application. Ce répertoire est alors sélectionné par l'utilisateur.<br><br><br> |
| Quel est l'ordre de priorité appliqué pour définir le répertoire de création de ces fichiers ? | <br><br>1. Le répertoire sélectionné par l'utilisateur lors de l'installation de l'application (si le programme d'installation permet à l'utilisateur de sélectionner ce répertoire).<br><br>2. Le répertoire sélectionné lors de la création de l'exécutable de l'application.<br><br>3. Le répertoire par défaut (sous-répertoire "GPW_&lt;NomApplication&gt;" du répertoire d'installation de l'application).<br><br><br>Ainsi, le répertoire sélectionné par l'utilisateur est prioritaire sur tous les autres répertoires définis. | <br><br>1. Le répertoire sélectionné par l'utilisateur lors de l'installation de l'application (si le programme d'installation permet à l'utilisateur de sélectionner ce répertoire).<br><br>2. Le répertoire par défaut (sous-répertoire "GPW_&lt;NomApplication&gt;" du répertoire d'installation de l'application).<br><br><br>Ainsi, le répertoire sélectionné par l'utilisateur est prioritaire sur le répertoire par défaut. |


Pour proposer à l'utilisateur le paramétrage de l'emplacement des fichiers du groupware utilisateur, cochez l'option "Personnaliser l'emplacement des fichiers du groupware lors de l'installation".

<a name="NOTE8"></a>
<a name="NOTE8_1"></a>


## Inclure le MDAC dans l'installation
<a name="inclure_mdac_dans_installation_ELTTEXTE000588"></a>
Si votre application manipule une base de données via OLE DB, les éléments suivants doivent être installés sur les postes utilisateurs :

- Un provider OLE DB (par exemple "MSDAORA", "OraOLEDB.Oracle", "SQLOLEDB", ...).

- Le MDAC (Microsoft Data Access Component) version 2.6 minimum.




Si le MDAC n'est pas installé, seule la connexion à la base OLE DB sera possible : il sera impossible de lire les tables (un message signale que cette interface n'est pas prise en charge).

**Attention** : La licence de redistribution du MDAC précise qu'il est nécessaire de télécharger l'exécutable du MDAC (depuis le site Internet de Microsoft) pour obtenir le droit de le redistribuer avec une application. Avant d'effectuer les manipulations décrites dans les paragraphes suivants, il est donc nécessaire de télécharger l'exécutable du MDAC sur le poste en cours.

Vous pouvez télécharger l'exécutable du MDAC depuis le site Internet de Microsoft aux adresses suivantes (adresse valide lors de la réalisation de cette documentation) : [http://www.microsoft.com/data](http://www.microsoft.com/data)

**Pour distribuer le MDAC à vos utilisateurs :**

1. Cochez l'option "Inclure le MDAC dans l'installation".

2. Dans la suite de l'assistant, spécifiez le chemin de l'exécutable du MDAC. Un lien vous propose de télécharger l'exécutable du MDAC à partir du site Internet de Microsoft.




Remarque : Si le MDAC est intégré dans l'installation, le programme d'installation sera de taille plus importante. Le programme d'installation du MDAC utilisé sera celui présent sur le poste du développeur.

<a name="NOTE9"></a>
<a name="NOTE9_1"></a>


## Installer le driver ODBC pour HFSQL
<a name="installer_driver_odbc_pour_hfsql_ELTTEXTE000612"></a>
Pour manipuler une base de données HFSQL depuis une application non WINDEV, il est nécessaire d'installer et de configurer le driver ODBC sur HFSQL sur le poste utilisateur. Pour plus de détails, consultez [Le driver ODBC sur HFSQL](../WDLang4/3044179.md).

**Remarque** : Le driver ODBC sur HFSQL permet uniquement de **lire et d'écrire** dans une base de données HFSQL depuis une application non WINDEV.

**Pour inclure le driver ODBC dans le programme d'installation** :

1. Cochez l'option "Installer le driver ODBC pour HFSQL".

2. Dans la suite de l'assistant, saisissez le nom permettant d'identifier la base de données HFSQL lors de l'utilisation du driver ODBC sur HFSQL.




<a name="NOTE10"></a>
<a name="NOTE10_1"></a>


## Installer le provider OLE DB pour HFSQL
<a name="installer_provider_ole_pour_hfsql_ELTTEXTE000636"></a>
Pour manipuler une base de données HFSQL depuis une application non WINDEV, il est nécessaire d'installer le provider OLE DB sur HFSQL sur le poste utilisateur.

**Remarque** : Le provider OLE DB sur HFSQL permet de **lire et d'écrire** dans une base de données HFSQL depuis une application non WINDEV.

**Pour inclure le provider OLE DB dans le programme d'installation**, cochez l'option "Installer le provider OLE DB pour HFSQL".

<a name="NOTE11"></a>
<a name="NOTE11_1"></a>


## Installer et paramétrer les modules de réplication universelle assistée
<a name="installer_parametrer_les_modules_replication_universelle_assistee_ELTTEXTE000660"></a>
Si votre application contient un fichier de description de la réplication universelle assistée (fichier .WER), l'assistant d'installation propose automatiquement de configurer l'installation de la réplication universelle assistée.

Pour plus de détails, consultez [Installation d'une application utilisant la réplication universelle assistée](../Editeurs/2028095.md).


