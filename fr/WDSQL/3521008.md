


## WDSQL : Création d'une requête SQL
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000213"></a>
Lorsque la connexion à la base de données est établie, WDSQL permet de créer différents types de requêtes SQL :

- ***Requête de sélection*** (instruction SELECT) : visualisation d'une sélection d'enregistrements dans la base de données.

- ***Requête d'insertion*** (instruction INSERT) : ajout d'enregistrements dans un fichier de le base de données.

- ***Requête de modification*** (instruction UPDATE) : modification des enregistrements d'un fichier de la base de données.

- ***Requête de suppression*** (instruction DELETE) : suppression des enregistrements d'un fichier de la base de données.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Créer une requête SQL
<a name="creer_une_requete_sql_ELTTEXTE000237"></a>
Il est possible de créer des requêtes :

- Directement depuis la fenêtre principale de WDSQL.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDSQL%20-%20HC%20N%B0007.gif&type=thumb)


- A l'aide de l'assistant de création de requêtes de WDSQL.




Après création, ces requêtes peuvent être :

- Enregistrées (option "Fichier .. Enregistrer une requête" ou raccourci F4 ou icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDSQL%20-%20HC%20N%B0006%201.gif)). Le fichier créé est de type ".SQL".

- [Exécutées](../WDSQL/3521014.md).

- Imprimées (cliquez sur l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDSQL%20-%20HC%20N%B0006%202.gif)).

- Modifiées directement sous WDSQL.




**Attention** : Une requête créée sous WDSQL ne peut pas être modifiée sous WINDEV. Pour utiliser une requête créée sous WDSQL, il suffit de réaliser un copier-coller du code SQL :

- soit vers une fenêtre de code SQL sous WINDEV,

- soit dans le paramètre "Texte de la requête en SQL" de la fonction **HExécuteRequêteSQL** du WLangage.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Créer une requête SQL directement depuis la fenêtre principale de WDSQL
<a name="creer_une_requete_sql_directement_depuis_fenetre_principale_wdsql_ELTTEXTE000261"></a>


### Pour créer une requête directement depuis la fenêtre principale de WDSQL
<a name="pour_creer_une_requete_directement_depuis_fenetre_principale_wdsql_ELTPARAGRAPHE000052"></a>WDSQL propose différents moyens pour vous aider dans la création de la requête en SQL :

- Visualisation et/ou utilisation des rubriques existantes dans la base de données en cours : cliquez sur l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDSQL%20-%20HC%20N%B0006%204.gif). Pour plus de détails, consultez [Structure d'une base de données](../WDSQL/3521012.md).

- Visualisation et/ou utilisation des différents mot-clés SQL : cliquez sur l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDSQL%20-%20HC%20N%B0006%208.gif).




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Créer une requête SQL à l'aide de l'assistant
<a name="creer_une_requete_sql_aide_assistant_ELTTEXTE000285"></a>
Pour l'opération suivante, nous considérons que la connexion à la base de données a été établie.

**Pour créer une requête de sélection à l'aide de l'assistant** :

1. Sélectionnez l'option "Fichier .. Créer une requête" (ou cliquez sur l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDSQL%20-%20HC%20N%B0006%205.gif)).

2. Dans l'assistant, sélectionnez l'option "Une requête de sélection" et passez à l'étape suivante.

3. Sélectionnez les différentes rubriques de la requête.
	**Remarque** : Si la base de données en cours est une base de données Oracle ou SQL Server, il est possible de visualiser les tables créées par un utilisateur donné. Il suffit de sélectionner l'utilisateur dans la combo "Utilisateur".

4. Définissez si nécessaire les conditions de sélection pour chaque rubrique.

5. Triez si nécessaire les enregistrements selon une ou plusieurs rubriques :

	- ***Dans l'ordre croissant*** : cliquez dans la colonne "Tri" correspondant à la ou les rubriques de tri. L'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=TriCroissant.gif) apparaît.

	- ***Dans l'ordre décroissant*** : cliquez dans la colonne "Tri" correspondant à la ou les rubriques de tri. L'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=TriDecroissant.gif) apparaît.




6. Si l'option "Ne pas afficher les doublons" est cochée, chaque enregistrement du résultat de la requête sera unique. 
	Par exemple, si une requête affiche tous les clients ayant passé au moins une commande, les clients ayant passé plusieurs commandes n'apparaîtront qu'une seule fois dans le résultat de la requête.

7. Si des rubriques de tri ont été définies, spécifiez l'enchaînement de ces rubriques de tri. Pour plus de détails, consultez le paragraphe [Définition de plusieurs rubriques de tri](#NOTE5_1).

8. Validez. Le code SQL de la requête créée s'affiche automatiquement dans la fenêtre principale de WDSQL.



<a name="NOTE4_2"></a>
Pour l'opération suivante, nous considérons que la connexion à la base de données a été établie.

**Pour créer une requête d'insertion à l'aide de l'assistant** : 

1. Sélectionnez l'option "Fichier .. Créer une requête" (ou cliquez sur l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDSQL%20-%20HC%20N%B0006%205.gif)).

2. Dans l'assistant, sélectionnez l'option "Une requête d'insertion" et passez à l'étape suivante.

3. Sélectionnez le fichier de données dans lequel des données vont être insérées. La liste des rubriques du fichier s'affiche automatiquement.
	**Remarque** : Si la base de données en cours est une base de données Oracle ou SQL Server, il est possible de visualiser les tables créées par un utilisateur donné. Il suffit de sélectionner l'utilisateur dans la combo "Utilisateur".

4. Saisissez les nouvelles valeurs à insérer dans la colonne "Valeur" et validez. Le code SQL de la requête créée s'affiche automatiquement dans la fenêtre principale de WDSQL.



<a name="NOTE4_3"></a>
Pour l'opération suivante, nous considérons que la connexion à la base de données a été établie.

**Pour créer une requête de modification à l'aide de l'assistant** : 

1. Sélectionnez l'option "Fichier .. Créer une requête" (ou cliquez sur l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDSQL%20-%20HC%20N%B0006%205.gif)).

2. Dans l'assistant, sélectionnez l'option "Une requête de modification" et passez à l'étape suivante.

3. Sélectionnez le fichier de données dans lequel des données vont être modifiées. La liste des rubriques du fichier s'affiche automatiquement.
	**Remarque** : Si la base de données en cours est une base de données Oracle ou SQL Server, il est possible de visualiser les tables créées par un utilisateur donné. Il suffit de sélectionner l'utilisateur dans la combo "Utilisateur".

4. Saisissez les nouvelles valeurs dans la colonne "Valeur".

5. Définissez les conditions de sélection pour chaque enregistrement à modifier et validez. Le code SQL de la requête créée s'affiche automatiquement dans la fenêtre principale de WDSQL.



<a name="NOTE4_4"></a>
Pour l'opération suivante, nous considérons que la connexion à la base de données a été établie.

**Pour créer une requête de suppression à l'aide de l'assistant** : 

1. Sélectionnez l'option "Fichier .. Créer une requête" (ou cliquez sur l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDSQL%20-%20HC%20N%B0006%205.gif)).

2. Dans l'assistant, sélectionnez l'option "Une requête de suppression" et passez à l'étape suivante.

3. Sélectionnez le fichier de données dans lequel des données vont être supprimées. La liste des rubriques du fichier s'affiche automatiquement.
	**Remarque** : Si la base de données en cours est une base de données Oracle ou SQL Server, il est possible de visualiser les tables créées par un utilisateur donné. Il suffit de sélectionner l'utilisateur dans la combo "Utilisateur".

4. Définissez les conditions de sélection pour chaque enregistrement à supprimer et validez. Le code SQL de la requête créée s'affiche automatiquement dans la fenêtre principale de WDSQL.




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Définition de plusieurs rubriques de tri
<a name="definition_plusieurs_rubriques_tri_ELTTEXTE000327"></a>
Lorsque plusieurs rubriques de tri sont définies, les tris sont imbriqués. Le tri commence par la première rubrique du tableau des rubriques de tri.

Par exemple, lors de la création de la requête, dans la fenêtre ci-dessous, le résultat de la requête est trié :

- tout d'abord par le total TTC des commandes (ordre croissant),

- ensuite par la ville des clients (ordre décroissant),

- pour finir par le nom des clients (ordre croissant).

<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDSQL%20-%20HC%20N%B0005.gif&type=thumb)
Dans l'étape suivante de l'assistant, les flèches situées à droite de la fenêtre permettent de modifier l'enchaînement des rubriques de tri.

Le code SQL correspondant à cet exemple sera le suivant :

```sql
SELECT CLIENT.NomClient, CLIENT.Ville, COMMANDE.TotalTTC
	FROM CLIENT, COMMANDE
	WHERE CLIENT.Ville LIKE 'Paris'
	ORDER BY TotalTTC ASC, Ville DESC, NomClient ASC
```



