
## WDSQL : Connexion à une base de données
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000167"></a>
La première opération à effectuer pour utiliser WDSQL est la connexion avec une base de données. Lorsque cette connexion est établie, il est possible de créer et d'exécuter des requêtes SQL sur la base de données manipulée.

Plusieurs types de connexion sont possibles :

- Connexion directe à une base de données HFSQL Classic.

- Connexion à une base de données via un provider OLE DB.

- Connexion à une base de données via un driver ODBC.

- Connexion à une base de données via un accès natif.




**Remarque** : WDSQL permet de mémoriser les paramètres de plusieurs connexions. Pour plus de détails, consultez le paragraphe "Connexion personnelle".



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000197"></a>


### Etablir une connexion avec une base de données
<a name="etablir_une_connexion_avec_une_base_donnees_ELTPARAGRAPHE000029"></a>Pour établir une connexion avec une base de données :

1. Lancez WDSQL : un assistant permet de définir les paramètres de connexion. 
	Si WDSQL est déjà lancé, sélectionnez l'option "Fichier .. Connexion" (ou cliquez sur l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDSQL%20-%20HC%20N%B0001%201.gif)
). La connexion en cours est automatiquement fermée. 
	**Remarque** : Les paramètres de la dernière connexion établie sont automatiquement proposés.

2. Sélectionnez le mode d'accès à la base de données (option "Connexion par").
	**Remarque** : WDSQL permet :

	- Soit de définir les paramètres d'une connexion. La connexion peut être réalisée via :

		- un provider OLE DB,

		- un driver ODBC,

		- un accès natif (AS/400, Oracle, SQL Server, ...).




- Soit d'utiliser une connexion mémorisée (appelée "Connexion personnelle"). Pour plus de détails, consultez le paragraphe [Connexion personnelle](#NOTE3_1).

3. Spécifiez la source de données de la connexion. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDSQL%20-%20HC%20N%B0002.gif&type=thumb)
Cette source de données peut correspondre :

	- soit au nom et au chemin complet de la base de données. 
			Par exemple :

		- pour HFSQL : "C:\\MonRépertoire\\BaseDeDonnéesHF.WDD"

		- pour Access : "C:\\MonRépertoire\\BaseDeDonnéesAccess.MDB"




- soit au nom ou à l'alias du serveur.
			Par exemple pour Oracle : "Serveur_Oracle"

- soit au répertoire contenant le fichier xBase (".DBF").
			Par exemple : "C:\\MonRépertoirexBase"

4. Saisissez si nécessaire le nom de l'utilisateur permettant de se connecter à la base de données. 
	**Remarque** : Ce nom a été défini lors de la création de la base de données. Il peut exister plusieurs utilisateurs ayant des droits différents sur une même base de données.

5. Saisissez si nécessaire le mot de passe. Ce mot de passe correspond :

	- Soit au mot de passe en exécution de l'analyse WINDEV (cas d'une base de données HFSQL). Ce mot de passe a été défini dans la description de l'analyse.

	- Soit au mot de passe utilisé pour se connecter à la base de données (cas d'une base de données Oracle, SQL Server, ...). Ce mot de passe a été défini lors de la création de la base de données.
			**Remarque** : Pour proposer automatiquement ce mot de passe lors du prochain lancement de l'assistant de connexion, cochez l'option "Mémoriser le mot de passe de la connexion".




6. Passez à l'étape suivante. La liste des différents fichiers (ou tables) présents dans la base de données s'affiche.
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDSQL%20-%20HC%20N%B0003.gif&type=thumb)


7. Cochez les fichiers (ou tables) à manipuler avec SQL sous WDSQL. Pour chaque fichier sélectionné, spécifiez si nécessaire le mot de passe et le chemin correspondant. 
	**Remarque** : Si un mot de passe identique a été utilisé pour tous les fichiers sélectionnés, saisissez ce mot de passe pour le premier fichier sélectionné et cochez l'option "Le mot de passe est identique pour tous les fichiers".

8. Passez à l'étape suivante. 
	**Remarque** : Si certains fichiers sélectionnés proviennent d'une analyse WINDEV 5.5, précisez le répertoire de cette (ou ces) analyse.

9. La connexion est établie. Spécifiez l'opération à effectuer :

	- [Création d'une nouvelle requête SQL](../WDSQL/3521008.md).

	- Édition d'une requête SQL déjà créée avec WDSQL.

	- Lancement de l'outil WDSQL.







**Remarque** : Si les paramètres de connexion spécifiés ne sont pas corrects, la connexion n'est pas établie et l'assistant de connexion se relance automatiquement.



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Connexion personnelle
<a name="connexion_personnelle_ELTTEXTE000221"></a>
WDSQL permet de mémoriser les paramètres de 20 connexions. Ces connexions sont alors appelées "Connexions personnelles".

Pour mémoriser les paramètres d'une connexion personnelle :

1. Cliquez sur le bouton [...] présent à droite de la liste "Connexion par". La fenêtre des connexions personnelles s'affiche.

2. Saisissez le nom de la connexion (combo "Nom de la connexion").

3. Spécifiez les paramètres de connexion et validez. Ces paramètres sont détaillés dans les opérations 2 à 5 du paragraphe précédent.




Pour utiliser les paramètres d'une connexion personnelle :

1. Cliquez sur le bouton [...] présent à droite de la liste "Connexion par". La fenêtre des connexions personnelles s'affiche.

2. Sélectionnez le nom de la connexion (liste "Nom de la connexion") et validez.







