


## Diffuser le logiciel Etats & Requêtes
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000561"></a>
<a name="Diffuser_presentation"></a>
Cette page présente les différentes manipulations à effectuer pour qu'une application WINDEV puisse être manipulée avec le logiciel Etats & Requêtes.

Le logiciel "Etats & Requêtes" est gratuit et librement redistribuable avec vos applications WINDEV. Consultez la licence pour les conditions d'utilisation et de redistribution de ce logiciel.
**Remarque : Cette page d'aide est réservée au développeur de l'application WINDEV.**
<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Diffuser le logiciel Etats & Requêtes avec votre application WINDEV
<a name="diffuser_logiciel_etats_requetes_avec_votre_application_windev_ELTTEXTE000585"></a>
Pour diffuser le logiciel Etats & Requêtes avec votre propre application WINDEV, le fournisseur de l'application WINDEV doit :

- Indiquer au niveau du projet que l'application autorise le lancement du logiciel Etats & Requêtes.

- Définir dans l'analyse les fichiers de données et les rubriques manipulables avec le logiciel Etats & Requêtes, et si nécessaire les noms des fichiers de données et des rubriques disponibles dans les différentes langues.

- Définir les états modifiables sous le logiciel Etats & Requêtes.

- Définir les requêtes visibles sous le logiciel Etats & Requêtes.

- Créer l'exécutable et le programme d'installation de l'application WINDEV.

- Installer l'application WINDEV chez les utilisateurs finaux.




**Remarque** : Afin de diminuer la taille du programme d'installation, le logiciel "Etats & Requêtes" peut être téléchargé directement depuis votre application :

- soit par le [menu automatique](../Editeurs/9000070.md),

- soit par le visualisateur de rapports,

- soit lors de l'utilisation de la fonction [LanceEtatsEtRequêtes](../WDLang1/3013067.md).



<a name="NOTE2_2"></a>


### Traduire les noms des fichiers de données et des rubriques
<a name="traduire_les_noms_des_fichiers_donnees_des_rubriques_ELTPARAGRAPHE000047"></a>Vous diffusez le logiciel "Etats & Requêtes" dans des pays différents (il existe en français et en anglais). Les langues utilisées sont différentes : espagnol, roumain, chinois, suédois, ...

Si l'utilisateur final souhaite créer des états ou des requêtes, il doit manipuler les noms des fichiers de données et des rubriques. Ces noms sont utilisés dans l'analyse par le concepteur de l'application. Ces noms sont bien souvent en français, ce qui n'est pas pratique pour l'utilisateur chinois ou roumain.

Il est possible d'indiquer une traduction pour les noms des fichiers de données et des rubriques dans l'analyse.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Les étapes en détail
<a name="les_etapes_detail_ELTTEXTE000615"></a>


### Étape 1 : Paramétrage du projet
<a name="etape_1_parametrage_projet_ELTPARAGRAPHE000060"></a>Pour utiliser le logiciel Etats & Requêtes à partir de votre application WINDEV, il est nécessaire de configurer le projet de votre application.

1. Affichez la fenêtre de description du projet : sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description".

2. Dans l'onglet "Avancé", cochez l'option "Autoriser le lancement de "Etats et Requêtes"".

3. Validez.




Remarques :

- Par défaut, les projets WINDEV autorisent le lancement du logiciel Etats & Requêtes.

- Le code d'initialisation du projet est exécuté lors d'un test d'un état ou d'une requête depuis le logiciel Etats & Requêtes. Dans ce cas, la fonction [EnModeTest](../WDLang1/3013011.md) renvoie <u><u><u><u>Faux</u></u></u></u>.



<a name="NOTE3_2"></a>


### Étape 2 : Paramétrage de l'analyse : Fichiers de données et rubriques visibles
<a name="etape_2_parametrage_analyse_fichiers_donnees_rubriques_visibles_ELTPARAGRAPHE000099"></a>Par défaut, tous les fichiers de données et leurs rubriques sont manipulables sous le logiciel Etats & Requêtes. L'utilisateur final peut utiliser ces données dans ses états et ses requêtes personnalisées.

Pour limiter les données manipulables sous le logiciel Etats & Requêtes (par exemple si votre application contient des données sensibles), il est nécessaire de modifier l'analyse WINDEV : il suffit de rendre les fichiers de données et/ou les rubriques voulues "invisibles" sous le logiciel Etats & Requêtes.

Remarque : Les états et les requêtes créés directement depuis WINDEV et basés sur des fichiers de données et/ou des rubriques invisibles peuvent être exécutés et/ou modifiés depuis le logiciel Etats & Requêtes.

Pour définir un fichier de données invisible sous le logiciel Etats & Requêtes :

1. Sous l'éditeur d'analyses de WINDEV, sélectionnez le fichier de données voulu.

2. Affichez la fenêtre de description des rubriques du fichier (option "Description du fichier de données" du menu contextuel).

3. Dans l'onglet "Etats et Requêtes", décochez l'option "Visible par l'utilisateur final dans le logiciel "États et Requêtes"".

4. Validez.


Remarque : Toutes les rubriques du fichier de données seront automatiquement rendues invisibles.

Pour définir une rubrique de fichier de données invisible sous le logiciel Etats & Requêtes :

1. Sous l'éditeur d'analyses de WINDEV, sélectionnez le fichier de données contenant la rubrique voulue.

2. Affichez la fenêtre de description du fichier (option "Description des rubriques" du menu contextuel).

3. Sélectionnez la rubrique voulue.

4. Dans l'onglet "Etats et Requêtes", décochez l'option "Visible par l'utilisateur final dans le logiciel "États et Requêtes"".

5. Validez.


Remarque : La propriété [VisibleUtilisateurFinal](../Proprietes/2512109.md) permet également de connaître ou de modifier la visibilité d'une rubrique sous le logiciel Etats & Requêtes.

**Attention** : Pour prendre en compte les modifications effectuées dans l'analyse WINDEV, il est bien entendu nécessaire de générer l'analyse WINDEV : sous le volet "Analyse", dans le groupe "Analyse", déroulez "Génération" et sélectionnez "Génération".
<a name="NOTE3_3"></a>


### Étape 2 bis : Paramétrage de l'analyse : Traduction des noms de fichiers et de rubriques
<a name="etape_2_bis_parametrage_analyse_traduction_des_noms_fichiers_rubriques_ELTPARAGRAPHE000154"></a>Par défaut, lorsque l'utilisateur final manipule les fichiers de données et les rubriques lors de la création d'un état ou d'une requête, tous les noms utilisés correspondent à ceux définis par le développeur dans l'analyse. Ces noms ne sont bien souvent pas dans la langue de l'utilisateur. Il est possible de proposer une traduction pour les éléments suivants directement dans l'analyse WINDEV :

- Nom du fichier de données,

- Libellé du fichier de données,

- Nom de la rubrique,

- Libellé de la rubrique.


Remarque : Si votre projet doit être traduit, pensez à traduire ces informations. WDMSG extrait et ré-intègre automatiquement ces informations.

Pour définir les paramètres multilingues d'un fichier de données sous le logiciel Etats & Requêtes :

1. Sous l'éditeur d'analyses de WINDEV, sélectionnez le fichier de données voulu.

2. Affichez la fenêtre de description des rubriques du fichier (option "Description du fichier de données" du menu contextuel).

3. Dans l'onglet "Etats et Requêtes", indiquez le nom du fichier de données et son libellé dans les différentes langues gérées par l'analyse.
	**Remarque** : Le nom utilisé ne doit pas correspondre à un nom de fichier de données existant dans l'analyse.

4. Validez.




Pour définir les paramètres multilingues d'une rubrique de fichier sous le logiciel Etats & Requêtes :

1. Sous l'éditeur d'analyses de WINDEV, sélectionnez le fichier de données contenant la rubrique voulue.

2. Affichez la fenêtre de description du fichier (option "Description des rubriques" du menu contextuel).

3. Sélectionnez la rubrique voulue.

4. Dans l'onglet "Etats et Requêtes", indiquez le nom de la rubrique et son libellé dans les différentes langues gérées par l'analyse.

5. Validez.




**Attention** : Pour prendre en compte les modifications effectuées dans l'analyse WINDEV, il est bien entendu nécessaire de générer l'analyse WINDEV : sous le volet "Analyse", dans le groupe "Analyse", déroulez "Génération" et cliquez sur "Génération".
<a name="NOTE3_4"></a>


### Étape 3 : Paramétrage des états
<a name="etape_3_parametrage_des_etats_ELTPARAGRAPHE000199"></a>Pour rendre un état de votre application modifiable sous le logiciel Etats & Requêtes :

1. Ouvrez l'état sous l'éditeur d'états.

2. Affichez la fenêtre de description de l'état (option "Description de l'état" du menu contextuel de l'état).

3. Dans l'onglet "Options", cochez l'option "État modifiable sous États et Requêtes".

4. Cochez :

	- l'option "Interface modifiable uniquement" pour que l'interface de l'état uniquement soit modifiable sous Etats & Requêtes.

	- l'option "Tout modifiable (interface et code)" pour que l'état soit entièrement modifiable sous Etats & Requêtes.




5. Validez et enregistrez l'état.




Remarques :

- La propriété [InterfaceModifiableAvecEtatsEtRequêtes](../Proprietes/2511075.md) permet de savoir si l'interface d'un état est modifiable sous le logiciel Etats & Requêtes.

- La propriété [ToutModifiableAvecEtatsEtRequêtes](../Proprietes/2511076.md) permet de savoir si un état est entièrement modifiable sous le logiciel Etats & Requêtes.



<a name="NOTE3_5"></a>


### Étape 3 bis : Paramétrage des requêtes
<a name="etape_3_bis_parametrage_des_requetes_ELTPARAGRAPHE000238"></a>Par défaut, une requête n'est ni visible ni modifiable sous le logiciel Etats & Requêtes.
Il est uniquement possible de la rendre visible sous le logiciel Etats & Requêtes. Il n'est pas possible de la rendre modifiable. 

Pour rendre une requête de votre application visible sous le logiciel Etats & Requêtes :

1. Ouvrez la requête sous l'éditeur de requêtes.

2. Affichez la fenêtre de description de la requête (option "Description de la requête" du menu contextuel de la requête).

3. Cliquez sur le bouton "Avancé".

4. Dans l'onglet "Etats & Requêtes", cochez l'option "Visible sous 'Etats  Requêtes'".

5. Validez et enregistrez la requête.




Remarque : Les requêtes sont uniquement visibles sous le logiciel Etats & Requêtes. Elles ne sont pas modifiables. Le logiciel Etats & Requêtes permet de faire les manipulations suivantes sur une requête : 

- exécuter et visualiser le résultat de la requête. 

- utiliser la requête comme base pour la construction d'autres requêtes. 

- réaliser une copie de la requête (option "Enregistrer sous"). 

- utiliser la requête comme source de données d'un  état.



<a name="NOTE3_6"></a>


### Étape 4 : Création de l'exécutable et diffusion de l'application
<a name="etape_4_creation_executable_diffusion_application_ELTPARAGRAPHE000265"></a>La création et la diffusion d'une application WINDEV utilisant le logiciel Etats & Requêtes se fait de la même façon que pour une application classique. C'est lors de la création de la procédure d'installation, que vous pouvez indiquer les paramètres spécifiques au logiciel Etats & Requêtes.

Lorsque votre application WINDEV est entièrement décrite (fenêtres, états, requêtes, etc.), créez l'exécutable correspondant. Pour plus de détails, consultez [Création d'un exécutable](../Editeurs/2025002.md).

Créez ensuite le programme d'installation (pour plus de détails, consultez [Programme d'installation](../Editeurs/2028001.md)). Dans l'assistant de création du programme d'installation, dans l'étape "Modules complémentaires" :

1. Cochez l'option "Intégrer l'installation de Etats et Requêtes". Le package d'installation du logiciel Etats et Requêtes est automatiquement recherché. Ce pack d'installation est présent dans le sous-répertoire "Install\\Etats et Requêtes" du répertoire d'installation de WINDEV.
	**Attention** : Incorporer le logiciel Etats et Requêtes augmente la taille de votre installation de façon non négligeable (environ 160 Mo).
	Il est également possible de distribuer le pack d'installation Etats et Requêtes séparément. Si le logiciel Etats et Requêtes n'est pas inclus dans l'installation, il pourra être téléchargé directement depuis l'application (soit par le menu automatique, soit depuis le visualisateur de rapports d'un état, soit par la fonction [LanceEtatsEtRequêtes](../WDLang1/3013067.md)). Par défaut, le logiciel est téléchargé sur un site FTP de PC SOFT. Il est possible de personnaliser l'adresse de téléchargement du logiciel (par exemple site d'une société, ...). Pour plus de détails, consultez le paragraphe "Personnaliser l'adresse de téléchargement".

2. Spécifiez si nécessaire les répertoires correspondant aux états et requêtes modifiés ou créés par l'utilisateur final :

	- le répertoire des états et requêtes personnels correspond au répertoire des états et requêtes visibles uniquement par l'utilisateur qui les a créés.

	- le répertoire des états et requêtes partagés correspond au répertoire des états et requêtes visibles par tous les utilisateurs de l'application.




3. Autorisez ou non la modification de ces répertoires lors de l'installation de l'application.




**Remarque** : La fonction [fRepEtatsEtRequêtes](../WDLang1/3036065.md) permet de connaître le répertoire des états et requêtes personnels et/ou partagés.
<a name="NOTE3_7"></a>


### Étape 5 : Installation de l'application WINDEV chez vos utilisateurs finaux
<a name="etape_5_installation_application_windev_chez_vos_utilisateurs_finaux_ELTPARAGRAPHE000301"></a>L'installation d'une application utilisant le logiciel Etats & Requêtes est identique à l'installation d'une application classique.

Lors de l'installation, si vous avez inclus le logiciel "Etats & Requêtes" dans le programme d'installation, l'utilisateur devra simplement indiquer s'il souhaite installer le logiciel Etats & Requêtes.

Si le logiciel Etats & Requêtes n'a pas été inclus dans le programme d'installation, le téléchargement de ce logiciel sera automatiquement proposé lors de l'utilisation du menu automatique, lors de la visualisation d'un état, ou lors du lancement du logiciel.
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LanceEtatsEtRequ%EAtes%20-%20HC%20N%B0001.gif)

<a name="NOTE3_8"></a>


### Personnaliser l'adresse de téléchargement
<a name="personnaliser_adresse_telechargement_ELTPARAGRAPHE000313"></a>Si le logiciel Etats & Requêtes n'a pas été inclus dans le programme d'installation, le téléchargement de ce logiciel sera automatiquement proposé lors de l'utilisation du menu automatique, lors de la visualisation d'un état, ou lors du lancement du logiciel.

Par défaut l'adresse de téléchargement correspond à un site FTP de PC SOFT.

**Pour utiliser un autre site** :

1. Créez un fichier texte LoginFTP.INI. Ce fichier doit être placé dans le même répertoire que l'exécutable de l'application.

2. Ce fichier doit contenir les éléments suivants : 
	
	```txt
	[FTP]
	Login = Login de l'utilisateur sur le serveur FTP
	PSW = Mot de passe de l'utilisateur sur le serveur FTP
	Serv = Serveur FTP (par exemple ftp.pcsoft.fr)
	Dir = Répertoire de téléchargement (par exemple WX28/latest)
	```





**Remarques** :

- Si le pack de téléchargement est à la racine, il faut mettre uniquement "." dans l'entrée Dir.

- Le nom du fichier à télécharger est "WD280PACKER.exe".




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Utiliser le logiciel Etats & Requêtes
<a name="utiliser_logiciel_etats_requetes_ELTTEXTE000681"></a>


### Lancement du logiciel Etats & Requêtes
<a name="lancement_logiciel_etats_requetes_ELTPARAGRAPHE000338"></a>Pour que les utilisateurs finaux personnalisent les états de votre application ou créent leurs propres états et leurs propres requêtes, il suffit de lancer le logiciel Etats & Requêtes.

Pour permettre à vos utilisateurs finaux de lancer le logiciel Etats & Requêtes :

- soit affichez vos états dans le visualisateur de rapports. Les utilisateurs finaux pourront lancer le logiciel Etats & Requêtes en cliquant l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Diffuser%20EtatsRequetes%20-%20HC%20N%B0006%201%202.GIF)
.

- soit ajoutez le menu "?" dans la fenêtre principale de votre application : sous le volet "Fenêtre", dans le groupe "Barres et menus", déroulez "Menu principal" et sélectionnez "Ajouter le menu '?'". Dans l'assistant de création de ce menu, cochez les options "Créer, modifier un état" et "Créer, modifier une requête".

- soit utilisez la fonction [LanceEtatsEtRequêtes](../WDLang1/3013067.md) dans votre application.




Si le logiciel "Etats et requêtes" n'est pas installé, une fenêtre s'affichera permettant de télécharger le logiciel.
<a name="NOTE4_2"></a>


### Paramétrage des options des fichiers de données
<a name="parametrage_des_options_des_fichiers_donnees_ELTPARAGRAPHE000370"></a>Les utilisateurs finaux peuvent paramétrer les fichiers de données manipulés par le projet ouvert sous le logiciel "Etats & Requêtes". Il est possible de paramétrer :

- le répertoire des fichiers de données utilisé pour test.

- [le live data](../Editeurs/2021005.md) (qui permet de voir les données lors de la manipulation de l'état sous l'éditeur).




Pour paramétrer les options des fichiers de données : 

- Sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description".

- Sélectionnez l'onglet "Fichiers".




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Principe d'utilisation des états
<a name="principe_utilisation_des_etats_ELTTEXTE000711"></a>


### Modification d'un état
<a name="modification_etat_ELTPARAGRAPHE000401"></a>Lors de la modification d'un état, le fichier correspondant (fichier ".WDE") est automatiquement extrait de la bibliothèque de l'application et copié dans le répertoire des "Etats et requêtes personnels" (défini lors de la création de la procédure d'installation de l'application WINDEV).

C'est cet état que l'utilisateur final modifie.
<a name="NOTE5_2"></a>


### Utilisation d'un état modifié
<a name="utilisation_etat_modifie_ELTPARAGRAPHE000410"></a>L'état modifié peut être testé directement sous le logiciel "Etats & Requêtes". Dans ce cas, le traitement d'initialisation du projet sera exécuté.

Par défaut, seul l'utilisateur ayant réalisé des modifications sur un état utilisera cet état modifié dans l'application WINDEV.

Pour qu'un état modifié soit utilisé par tous les autres utilisateurs de l'application, l'utilisateur final doit sélectionner l'option "Fichier .. Partager l'élément avec les autres utilisateurs". Le fichier correspondant à l'état modifié (fichier " .WDE") sera alors automatiquement supprimé du répertoire des "Etats et requêtes personnels" et copié dans le répertoire des "Etats et requêtes partagés".

Lors de l'exécution d'un état depuis l'application WINDEV, le fichier de l'état est recherché :

- tout d'abord, dans le répertoire des "Etats et requêtes personnels".

- puis, dans le répertoire des "Etats et requêtes partagés".

- enfin, dans la bibliothèque de l'application WINDEV.




**Remarque** : Une indication présente dans le titre de la fenêtre du visualisateur de rapports informe les utilisateurs que l'état utilisé correspond à un état modifié.

Pour utiliser à nouveau l'état dans sa version originale, il suffit à vos utilisateurs finaux de supprimer physiquement le fichier de l'état modifié (fichier ".WDE") dans le répertoire des "Etats et requêtes personnels" et/ou dans le répertoire des "Etats et requêtes partagés".
<a name="NOTE5_3"></a>


### Utilisation d'un nouvel état
<a name="utilisation_nouvel_etat_ELTPARAGRAPHE000431"></a>Vos utilisateurs finaux pourront imprimer leurs nouveaux états directement depuis le logiciel Etats & Requêtes :

- soit en lançant une impression (icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Ico_imprimer.GIF)
).

- soit en testant l'état (icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Ico_Go_Fenetre_WD_bl.GIF)
).
	Dans ce cas, le traitement d'initialisation du projet est exécuté.




Il n'est donc pas nécessaire de programmer l'impression de l'état.

Pour que l'impression d'états réalisés avec le logiciel Etats & Requêtes soit possible directement à partir d'une application WINDEV, vous devez prévoir cette fonctionnalité dans votre application.

Vous pouvez par exemple intégrer une fenêtre permettant à l'utilisateur final de :

- sélectionner un état réalisé avec le logiciel Etats & Requêtes.

- lancer l'exécution de cet état.



<a name="NOTE5_4"></a>


### Noms de rubriques et de fichiers multilingues
<a name="noms_rubriques_fichiers_multilingues_ELTPARAGRAPHE000456"></a>Vous avez définis des noms et des libellés multilingues pour vos fichiers de données et vos rubriques : lors de la modification ou de la création d'un état, l'utilisateur aura accès aux noms et libellés correspondant à la langue en cours.

Par exemple, l'application est utilisée en espagnol. L'utilisateur demande à modifier un des états affichés. Lorsque la source de l'état sera éditée, les noms des fichiers de données et des rubriques seront visualisés en espagnol.

**Remarque** : Si l'état est inclus dans l'exécutable, les libellés et les noms des rubriques et des fichiers de données seront affichés dans la langue originale.

<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Principe d'utilisation des requêtes
<a name="principe_utilisation_des_requetes_ELTTEXTE000753"></a>


### Modification d'une requête de l'application
<a name="modification_une_requete_application_ELTPARAGRAPHE000469"></a>Les requêtes de l'application peuvent être uniquement visibles sous le logiciel Etats & Requêtes. Elles ne sont pas modifiables. Le logiciel Etats & Requêtes permet de faire les manipulations suivantes sur une requête : 

- exécuter et visualiser le résultat de la requête. 

- utiliser la requête comme base pour la construction d'autres requêtes. 

- réaliser une copie de la requête (option "Enregistrer sous"). Une nouvelle requête sera alors créée. 

- utiliser la requête comme source de données d'un état.



<a name="NOTE6_2"></a>


### Utilisation d'une nouvelle requête
<a name="utilisation_une_nouvelle_requete_ELTPARAGRAPHE000481"></a>Vos utilisateurs finaux pourront exécuter leurs nouvelles requêtes :

- soit directement depuis le logiciel Etats & Requêtes en cliquant sur l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Ico_Go_Fenetre_WD_bl.GIF)
.
	Dans ce cas, le traitement d'initialisation du projet sera exécuté.

- soit depuis l'application WINDEV.




Pour que l'exécution de requêtes réalisées avec le logiciel Etats & Requêtes soit possible directement à partir d'une application WINDEV, vous devez prévoir cette fonctionnalité dans votre application.

Vous pouvez par exemple intégrer une fenêtre permettant à l'utilisateur final de :

- sélectionner une requête avec le logiciel Etats & Requêtes.

- lancer l'exécution de cette requête et afficher son résultat dans une table (en utilisant par exemple la fonction [ConstruitTableFichier](../WDLang1/3074002.md)).



<a name="NOTE6_3"></a>


### Noms de rubriques et de fichiers multilingues
<a name="noms_rubriques_fichiers_multilingues_ELTPARAGRAPHE000505"></a>Vous avez défini des noms et des libellés multilingues pour vos fichiers de données et vos rubriques : lors de la création d'une requête, l'utilisateur aura accès aux noms et libellés correspondant à la langue en cours.

Par exemple, l'application est utilisée en espagnol. L'utilisateur demande à créer une requête. Lors de la création de la requête, les noms des fichiers de données et des rubriques seront visualisés en espagnol.

**Remarques** :

- Si la requête est incluse dans l'exécutable, les libellés et les noms des rubriques et des fichiers de données seront affichés dans la langue originale.

- Le code SQL de la requête reste dans la langue originale.





