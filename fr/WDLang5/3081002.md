


## XMLAjouteFils (Fonction)

***En anglais : XMLAddChild***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute une balise fille dans un document XML. Cette balise fille est ajoutée à la fin de la liste des attributs de la position courante.






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ajout d'une nouvelle ligne de commande
XMLParent("CdeXML")
XMLAjouteFils("CdeXML", "lignecommande", "", Vrai)
XMLAjouteAttribut("CdeXML", "numero", "2")

// Ajout de la balise "codeproduit"
XMLAjouteFils("CdeXML", "codeproduit", "sro2125")

// Ajout de la balise "designation"
XMLAjouteFils("CdeXML", "designation", "souris optique")

// Ajout de la balise "quantité"
XMLAjouteFils("CdeXML", "quantité", "15")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`XMLAjouteFils(<Document XML> , <Balise> [, <Valeur de la balise> [, <Changement de position> [, <Option>]]])`
---

**`<Document XML> : (Chaîne de caractères)`**

Nom du document XML dans lequel l'ajout doit être effectué. Ce document contient le code XML et a été créé avec la fonction [XMLDocument](../WDLang5/3081008.md).

**`<Balise> : (Chaîne de caractères)`**

Nom de la balise à ajouter. 
Si ce paramètre correspond à la constante *CDATA*, le contenu de la balise CDATA ne sera pas interprété par le parseur XML. Il est par exemple possible de mettre une image au format binaire dans cette balise. Attention : l'encodage utilisé doit respecter l'encodage du document XML.



**`<Valeur de la balise> : (Chaîne de caractères optionnelle)`**

Valeur de la nouvelle balise. Par défaut, ce paramètre correspond à une chaîne vide.

**`<Changement de position> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> pour se positionner sur l'élément ajouté. Dans ce cas, l'élément ajouté devient la position courante. 

- <u><u><u><u>Faux</u></u></u></u> (valeur par défaut) pour ne pas modifier la position courante lors de l'ajout.




**`<Option> : (Constante optionnelle de type Entier)`**

Options d'ajout. Les valeurs possibles sont :



|   |   |
| --- | --- |
| *XMLEncodeEtCommercial* | Si le caractère "&" ("et" commercial) est présent dans la valeur de la balise ajoutée, il sera encodé sous la forme "&".<br>Si cette constante n'est pas spécifiée, il est nécessaire d'encoder le caractère "&" dans la balise XML. Aucun encodage ne sera effectué. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Gestion de l'ajout 
<a name="gestion_ajout_ELTPARAGRAPHE000089"></a>

- Si la position courante est un attribut, la nouvelle balise est ajoutée à la fin de la liste courante des balises filles de la balise qui contient l'attribut.

- La position courante dans le document ne change pas pendant l'appel à la fonction **XMLAjouteFils** sauf si le paramètre &lt;Changement de position&gt; est à <u><u><u><u>Vrai</u></u></u></u>.


**Remarque** : La fonction [XMLDocument](../WDLang5/3081008.md) ne crée pas de racine pour le document. Pour créer un premier fils dans un document vide, il est obligatoire que ce document contienne une racine.
<a name="NOTE0_2"></a>


### Enregistrer les modifications dans le fichier XML
<a name="enregistrer_les_modifications_dans_fichier_xml_ELTPARAGRAPHE000109"></a>Pour enregistrer les modifications effectuées dans un fichier XML, vous devez :

1. Utiliser la fonction [XMLConstruitChaîne](../WDLang5/3081016.md). Cette fonction récupère et met en forme le contenu d'un document XML.

2. Enregistrer la chaîne de caractères générée par la fonction [XMLConstruitChaîne](../WDLang5/3081016.md) dans un fichier XML. Pour cela, il suffit d'utiliser la fonction [fSauveTexte](../WDLang1/3036046.md).




Exemple :

```wl
// Après modification du document XML 
SourceXML = XMLConstruitChaîne("DocXML")
// Enregistrement du fichier XML
fSauveTexte("ExampleModifié.xml", SourceXML)
```

<a name="NOTE0_3"></a>


### Fonctions XML et threads
<a name="fonctions_xml_threads_ELTPARAGRAPHE000269"></a>Si votre application utilise des threads, le document XML est partagé entre tous ces threads. Pour plus de détails sur la gestion des threads, consultez [Gestion des threads](../WDLang1/3077026.md).

<a name="XComposante"></a>

## Composante :
wd280xml.dll
