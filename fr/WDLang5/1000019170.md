
## Gestion du XSD
			



## Présentation
<a name="presentation_ELTTEXTE000123"></a>
WINDEV, WINDEV Mobile et WEBDEV mettent à votre disposition des fonctions permettant de manipuler du code XML. Le code XML manipulé doit être strictement conforme à la norme XML. Pour plus de détails, consultez une documentation spécifique sur XML. Pour plus de détails sur les fonctions WLangage, consultez la page d'aide [XML](../WDLang5/3081018.md).

WINDEV, WEBDEV et WINDEV Mobile permettent d'importer des fichiers au format XSD. Un fichier XSD contient la description du fichier XML de même nom. En effet, la connaissance de la structure d'un document XML permet notamment de vérifier la validité de ce document. Le langage de description de contenu d'un document XSD est aussi au format XML.

Un exemple de fichier XSD :

```xml
<?xml version="1.0" encoding="UTF-8"?>
  <xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">
   <xsd:element name="personne">
      <xsd:complexType>
         <xsd:sequence>
            <xsd:element name="nom" type="xsd:string"/>
            <xsd:element name="prenom" type="xsd:string"/>
            <xsd:element name="date_naissance" type="xsd:date"/>
            <xsd:element name="email" type="xsd:string" minOccurs="0" maxOccurs="unbounded" />
         </xsd:sequence>
      </xsd:complexType>
   </xsd:element>
 </xsd:schema>
```


Suivi d'un fichier XML valide :


```xml
<?xml version="1.0" encoding="UTF-8"?>
 <personne xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xsi:noNamespaceSchemaLocation="personne.xsd">
   <nom>de Latour</nom>
   <prenom>Jean</prenom>
   <date_naissance>1967-08-13</date_naissance>
   <email>test@free.fr</email>
 </personne>
```


<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Importer un fichier XSD dans un projet
<a name="importer_fichier_xsd_dans_projet_ELTTEXTE000147"></a>
Pour importer un fichier XSD dans un projet :

1. Dans le volet "Explorateur de projet", sélectionnez "Descriptions externes".

2. Faites un clic droit et sélectionnez l'option "Importer un XSD dans ce projet". L'assistant d'importation se lance. Vous pouvez : 

	- Importer un XSD présent sur Internet. 

	- Importer un fichier XSD local. 




3. Indiquez les caractéristiques du XSD à importer. 

4. Validez. Le XSD est automatiquement ajouté dans l'explorateur de projet (dans la branche "Descriptions externes"). Il est prêt à être utilisé.




Attention : 

- Pour fonctionner en exécution, le fichier XSD ne doit pas être présent dans un sous-répertoire du projet ou dans un sous-répertoire de l'exécutable.

- Seuls les fichiers XSD avec un schéma en version 1.0 sont gérés. 








## Utiliser une description importée dans le projet
<a name="utiliser_une_description_importee_dans_projet_ELTTEXTE000171"></a>
Pour utiliser la description du document XML, il suffit d'utiliser les variables générées automatiquement par l'importation.

1. Déclarez un document XML au format de la description qui a été importée. Par exemple, si la description importée se nomme 'personne' :
	
	```wl
	cMonDoc est un xmlDocument <description="personne">
	```

	Remarque : Il est possible d'indiquer l'extension du fichier lors de la déclaration. Par exemple : 
	
	```wl
	cMonDoc est un xmlDocument <description="personne.xsd">
	```


2. Initialisez les différentes variables composant la description du document XML. Par exemple, si le document est composé du nom et du prénom de la personne :
	
	```wl
	cMonDoc.personne.nom = "DUPONT"
	cMonDoc.personne.prenom = "JEAN"
	```

	Remarques : 

	- Chaque élément est séparé par un point **.**.

	- Une assistance est proposée lors de la saisie des noms des variables.

	- Si le nom d'un élément contient un caractère spécial (tiret par exemple), il doit être entouré d'apostrophes (simples quotes) :
			
		```wl
		cMonDoc.personne.'id-personne' = "ValeurId"
		```





3. Plusieurs fonctions permettent d'utiliser le fichier XSD pour valider la description du fichier XML : 
	


|   |   |
| --- | --- |
| [XMLDocumentValide](../WDLang5/1000019272.md) | Valide un document XML à partir d'un schéma XSD. |
| [XMLNoeudValide](../WDLang5/1000019280.md) | Valide un noeud XML, ses fils et ses attributs à partir de sa description dans le schéma XSD lié au document XML. |
| [XMLSauve](../WDLang5/1000019026.md) | Sauvegarde un document XML dans un fichier. |





### Exemple : Création complète d'un fichier se basant sur la description XSD donnée en exemple : 
<a name="exemple_creation_complete_fichier_basant_sur_description_xsd_donnee_exemple_ELTPARAGRAPHE000072"></a>


```wl
cMonDoc est un xmlDocument <description="personne.xsd">

cMonDoc.personne.nom = "Dupont"
cMonDoc.personne.prenom = "Jean"
cMonDoc.personne.date_naissance = "19710211"
cMonDoc.personne.email[1] = "jean.dupont@mondomaine.com"
cMonDoc.personne.email[2] = "jean.dupont@autredomaine.com"

XMLSauve(cMonDoc, fRepExe() + ["\"] + "test.xml")

// Ou avec une vérification intermédiaire : 
SI XMLDocumentValide(cMonDoc) = Vrai ALORS
	XMLSauve(cMonDoc, fRepExe() + ["\"] + "test.xml")
	SI ErreurDétectée = Vrai ALORS
		Erreur("Impossible de sauvegarder le document XML", ErreurInfo())
	SINON
		Info("OK", fRepExe() + ["\"] + "test.xml")
	FIN
SINON
	Erreur("Le document XML est invalide", ErreurInfo()) 
FIN
```







