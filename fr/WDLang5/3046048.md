
## iSubstBloc (Fonction)

***En anglais : iSubstBlock***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Substitue un bloc de l'état par un autre bloc au cours de l'impression de l'état.

Après l'exécution de la fonction **iSubstBloc**, lorsque le bloc initial devra être imprimé, les événements suivants seront exécutés :

- événement "Avant impression" du bloc de substitution.

- impression du bloc de substitution.

- événement "Après impression" du bloc de substitution.




![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) **Attention** : L'utilisation de cette fonction sous Linux nécessite une configuration spécifique. Pour plus de détails, consultez [Imprimer sous Linux](../Editeurs/9000078.md). 


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Substitution du haut de page
iSubstBloc(HautPage, Itération1)
// Fin de la substitution du haut de page
iSubstBloc(HautPage, "")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`iSubstBloc(<Bloc à substituer> , <Nouveau bloc>)`
---

**`<Bloc à substituer> : (Chaîne de caractères)`**

Nom logique du bloc à remplacer. Ce nom a été défini sous l'éditeur d'états, dans la description du bloc (onglet "Général", champ "Nom").

**`<Nouveau bloc> : (Chaîne de caractères)`**

Nom logique du bloc utilisé pour la substitution. Ce nom a été défini sous l'éditeur d'états, dans la description du bloc. 
Si ce paramètre correspond à une chaîne vide (""), la substitution en cours pour le bloc &lt;Bloc à substituer&gt; est annulée. 
Si ce paramètre est égal à &lt;Bloc à substituer&gt;, la substitution en cours est annulée.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Substitution du premier bloc de haut de page
<a name="substitution_premier_bloc_haut_page_ELTPARAGRAPHE000086"></a>Pour substituer le premier bloc de haut de page, la fonction **iSubstBloc** doit être utilisée dans un événement d'initialisation de l'état (par exemple, dans un des événements du bloc de début de document ou dans l'événement "Ouverture" de l'état). Ces événements seront exécutés avant l'impression de ce bloc.


<a name="NOTE0_2"></a>




### Substitution du bloc bas de page
<a name="substitution_bloc_bas_page_ELTPARAGRAPHE000098"></a>Pour éviter les problèmes d'affichage, la hauteur du bloc de bas de page et la hauteur de son bloc de substitution doivent être identiques.


<a name="NOTE0_3"></a>




### Divers
<a name="divers_ELTPARAGRAPHE000107"></a>

- Il est possible d'obtenir le même effet en effectuant les opérations suivantes :

	1. Rendre le bloc invisible (propriété [Visible](../Proprietes/2510138.md)).

	2. Utiliser la fonction [iImprimeBloc](../WDLang5/3046030.md).




- Pour substituer un bloc de bas de page, il est conseillé d'utiliser des blocs de même hauteur.

- Dans la majorité des cas, il est conseillé d'utiliser des plans dans les états, plus simples à utiliser et à mettre en place que la substitution de blocs. Pour plus de détails, consultez [Les plans](../WDChamp/1013078.md). 







- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDEtats.gif) ***Exemples didactiques (WINDEV)*** : **WD Etats** <br>Cet exemple montre les différentes méthodes pour réaliser un état :<br> <br>- impressions basées sur différentes sources de données (requêtes, variables, ...)<br>- impressions basées sur des champs (Table, Tableur, TCD, ...)<br>- impression d'états composés<br>- impressions spécifiques (portrait / paysage, état avec filigrane, état avec code-barres, ...)



<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280etat.dll
