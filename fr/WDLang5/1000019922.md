
## Filigrane (Type de variable)

***En anglais : Watermark***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **Filigrane** permet de manipuler le texte imprimé en filigrane dans les états créées avec l'éditeur d'états ou par programmation.

Le type **Filigrane** permet de définir toutes les caractéristiques avancées du texte en filigrane. Les caractéristiques de ce texte peuvent être définies et modifiées à l'aide de différentes propriétés WLangage.

**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Impression d'un filigrane en fond d'un état
MonFiligrane est un Filigrane

// Texte du filigrane
MonFiligrane.Texte = "Confidentiel"
// Police utilisée
MonFiligrane.Police.Nom = "Arial"
// Le filigrane sera imprimé en centré horizontalement et en bas
MonFiligrane.Position = iCentreH + iBas

// Impression dans le visualisateur de rapports
iDestination(iVisualisateur)

// Indique que le filigrane sera imprimé lors de l'impression et dans les duplicata
iParametreFiligrane(ifiligraneImpression + ifiligraneDuplicata, MonFiligrane)

// Lance l'impression de l'état
iImprimeEtat(ETAT_Commercial)
```

<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Propriétés spécifiques à la description des variables de type Filigrane
<a name="proprietes_specifiques_description_des_variables_type_filigrane_ELTPARAGRAPHE000041"></a>

Les propriétés suivantes peuvent être utilisées pour manipuler un texte en filigrane :

| Nom de la propriété | Type manipulé | Effet |
| --- | --- | --- |
| Angle | Constante de type Entier | Angle d'inclinaison du texte du filigrane. Cet angle peut correspondre à une des constantes suivantes : <br><br>- *iAnglePolice* : l'angle d'inclinaison du texte correspond à l'angle défini dans la police. <br><br>- *iDiagonaleDescendante* : le texte est imprimé sur une diagonale à 45° descendante. <br><br>- *iDiagonaleMontante* : le texte est imprimé sur une diagonale à 45° montante. <br><br>- *iHorizontale* : le texte est imprimé à l'horizontale.<br><br><br><br><br> |
| Opacité | Entier | Pourcentage d'opacité du texte du filigrane. Ce pourcentage varie de 0 (texte invisible) à 100 (texte complètement opaque). |
| Police | Variable de type [Police](../Motscles/1514045.md) | Caractéristiques de la police à utiliser pour le texte du filigrane. |
| Position | Constante de type Entier | Constante ou combinaison de constante permettant de déterminer la position du texte du filigrane : <br><br>- *iBas* : le texte est aligné en bas de la zone de texte. <br><br>- *iCentreH* : le texte est centré horizontalement dans la zone de texte. <br><br>- *iCentreV* : le texte est centré verticalement dans la zone de texte. <br><br>- *iDroite* : le texte est aligné à droite de la zone de texte<br><br><br> |
| Taille | Constante de type Entier | Taille de la police. Cette taille correspond à une des constantes suivantes :  <br><br>- *iAutomatique* : la taille de police est automatiquement choisie en fonction de la longueur du texte du filigrane et de la largeur de l'état. <br><br>- *iTaillePolice* : la taille définie dans la police est utilisée.<br><br><br> |
| Texte | Chaîne de caractères | Texte du filigrane. |


<a name="NOTE0_2"></a>


### Fonctions utilisant les variables de type Filigrane
<a name="fonctions_utilisant_les_variables_type_filigrane_ELTPARAGRAPHE000110"></a>


|   |   |
| --- | --- |
| [iParamètreFiligrane](../WDLang5/1000019939.md) | Ajoute un texte en filigrane dans un état (état créé sous l'éditeur d'états ou état imprimé). |




<a name="NOTE0_3"></a>


### Réinitialisation
<a name="reinitialisation_ELTPARAGRAPHE000117"></a>Pour réinitialiser le contenu d'une variable de type **Filigrane**, il est possible d'utiliser la fonction [VariableRAZ](../WDLang1/3013069.md).


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDEtats.gif) ***Exemples didactiques (WINDEV)*** : **WD Etats** <br>Cet exemple montre les différentes méthodes pour réaliser un état :<br> <br>- impressions basées sur différentes sources de données (requêtes, variables, ...)<br>- impressions basées sur des champs (Table, Tableur, TCD, ...)<br>- impression d'états composés<br>- impressions spécifiques (portrait / paysage, état avec filigrane, état avec code-barres, ...)


