


## CodeBarres (Type de variable)

***En anglais : BarCodes***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **CodeBarres** permet de manipuler les informations contenues dans un code-barres. Les caractéristiques de ce code-barres peuvent être définies et modifiées à l'aide de différentes propriétés WLangage. 

Les utilisations du type codeBarres sont les suivantes : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Le type **CodeBarres** est utilisé principalement : 

	- pour générer des codes-barres dans les fenêtres et dans les états.

	- pour décoder les codes-barres de type QR Code (présents dans une image).

	- pour imprimer des codes-barres (fonction [iImprimeCodeBarre](../WDLang5/3046020.md)). 








**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple




```wl
MonQRCode est un CodeBarres 
MonQRCode.TypeContenu = cbTypeTexte 
MonQRCode.TypeCodeBarres = CB_QRCODE 
MonQRCode.Contenu = "http://www.pcsoft.fr" 

// Affectation à un champ Code-barres
CBA_ChampCB = MonQRCode
```



```wl
// Génération d'un QRCode avec une image
// ------------- Code d'initialisation du code-barres ou de l'état
QRCodeAvecImage est un CodeBarres
// Image à mettre au centre du code-barres
ImageCentreQRCode est une Image
ImageCentreQRCode = IMG_DRAPEAU
// Type du code-barres
QRCodeAvecImage.TypeCodeBarres = CB_QRCODE
QRCodeAvecImage.TypeContenu = cbTypeTexte
// Image au centre
QRCodeAvecImage.Image = ImageCentreQRCode
// Niveau de correction d'erreur élevé pour compenser l'image au centre
QRCodeAvecImage.CorrectionErreur = qrcodeNiveauH
QRCodeAvecImage.ProportionImage = 3
// Pour une proportion d'image de 3%, une correction de niveau L (qrcodeNiveauL) serait insuffisante
// pour avoir un code-barres lisible

// Valeur (initiale)
QRCodeAvecImage.Contenu = "https://www.pcsoft.fr"
// Dans un état, la valeur peut-être ré-affectée :
//- par une liaison fichier sur le champ
//- dans le code avant impression 
//- dans le code de lecture des données de l'état
// ou bien n'importe où après

// Affectation à un champ Code-barres
CBA_Facture = QRCodeAvecImage

// ------------- Code avant impression
CBA_Facture.Valeur = "QR Code avec un drapeau au centre !"
```

<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Propriétés spécifiques à la description des variables de type CodeBarres
<a name="proprietes_specifiques_description_des_variables_type_codebarres_ELTPARAGRAPHE000102"></a>Les propriétés suivantes peuvent être utilisées pour manipuler un code-barres :

| **Nom de la propriété** | **Type manipulé** | **Effet** |
| --- | --- | --- |
| Contenu | Tout type | Valeur du code-barres. <br><br>- Pour les codes-barres de type QR Code, le type de cette valeur dépend de la propriété **TypeContenu**. <br>	Consultez la note ci-dessous pour connaître la correspondance entre le type de contenu et le type de la valeur. <br><br>- Pour les codes-barres autres que QR Code, lors de la lecture d'un code-barres, cette propriété est toujours de type "Chaîne de caractères" et sa valeur est identique à celle de la propriété **ValeurBrute**.<br><br><br> |
| CorrectionErreur | Constante de type Entier | Niveau de correction de l'erreur : permet de définir le seuil de lecture d'un code-barres endommagé. <br><br>Cette propriété est disponible uniquement pour : <br><br>- les codes-barres de type QR Code. <br><br>- les codes-barres de type PDF-417.<br><br>- les codes-barres de type Aztec.<br><br><br><br><br>**Les constantes disponibles pour les QR Code** sont : <br><br>- *qrcodeNiveauH* : environ 30% des mots encodés peuvent être restaurés.<br><br>- *qrcodeNiveauL* : environ 7% des mots encodés peuvent être restaurés.<br><br>- *qrcodeNiveauM* : environ 15% des mots encodés peuvent être restaurés.<br><br>- *qrcodeNiveauQ* : environ 25% des mots encodés peuvent être restaurés.<br><br><br>Le niveau de correction choisi entraîne : <br><br>- le changement de la taille du code-barres.<br><br>- la modification du nombre maximum de caractères possibles dans le code-barres.<br><br><br><br><br>Plus le niveau de correction est élevé, plus le dessin du code-barres aura une taille importante et moins il sera possible de dessiner des données. Par contre, plus le niveau de correction sera élevé, plus le code-barres sera lisible si le support est endommagé.<br><br>**Conseils** : <br><br>- Si le code-barres contient une URL, le niveau L est suffisant. <br><br>- Si un logo est inséré dans le code-barres, il vaut mieux passer à un niveau supérieur (M ou Q). <br><br>- Si le code-barres est destiné à l'impression d'étiquettes pour un entrepôt, il faut utiliser le niveau H. <br><br><br><br><br>**Pour les codes-barres de type PDF-417**, le niveau de correction de l'erreur correspond à un entier compris entre 0 et 8. <br><br>**Pour les codes-barres de type Aztec**, le niveau de correction correspond à un entier compris entre 5 et 95, représentant le pourcentage de correction d'erreur. La valeur par défaut est 33. Si la valeur donnée est <br><br>- inférieure à 5, la valeur retenue sera 5, <br><br>- supérieure à 95, la valeur retenue sera 95, <br><br>- négative, la valeur retenue sera 33 (valeur par défaut). <br><br><br><br><br> |
| Image |   | Image ajoutée au centre du code-barres (uniquement pour les codes-barres de type QR Code). Cette image peut correspondre à : <br><br>- une variable de type [Image](../WDLang1/1000019650.md), <br><br>- une chaîne de caractères contenant le chemin du fichier image à utiliser, <br><br>- une rubrique de type mémo image, ...<br><br><br><br><br> |
| Options | Constante ou combinaison de constantes de type entier | Caractéristiques du code-barres. Ces caractéristiques sont utilisées notamment lors de l'impression d'un code-barres avec la fonction [iImprimeCodeBarre](../WDLang5/3046020.md). Les constantes pouvant être utilisées sont les suivantes : <br><br>- *CB_Bas* : Code-barres positionné en bas du rectangle destination.<br><br>- *CB_CaractèreControle* : Code-barres contenant des caractères de contrôle (valable uniquement pour les codes-barres de type *CB_CODE128*, *CB_DATAMATRIX*, *CB_EAN128*, *CB_GS1_128* et *CB_PDF417*). Par défaut, les caractères de contrôle sont encadrés par les caractères "&lt;" et "&gt;". Pour ne pas interpréter ces caractères comme caractères de contrôle, il suffit de doubler le premier "&lt;" :  <br><br>	- "&lt;C40&gt;" = caractère de contrôle   <br><br>	- "&lt;&lt;AB&gt;" = chaîne &lt;AB&gt; à encoder dans le code-barres.<br><br><br><br><br><br>Pour plus de détails sur les caractères acceptés, consultez [Les différents types de codes-barres](../WDLang5/3046064.md).<br><br>- *CB_CaractèreVérification* : Code-barres contenant des caractères de vérification (valable uniquement pour les codes-barres de type *CB_CODE128*, *CB_DATAMATRIX*, *CB_EAN128*, *CB_GS1_128* et *CB_PDF417*).<br>	Si cette option est sélectionnée, les constantes *CB_CaractèreControle* et *CB_JeuxCaractères* sont automatiquement prises en compte.<br><br>- *CB_CentreH* : Centrage horizontal du code-barres dans le rectangle destination.<br><br>- *CB_CentreV* : Centrage vertical du code-barres dans le rectangle destination.<br><br>- *CB_Droite* : Code-barres aligné à droite dans le rectangle destination.<br><br>- *CB_Etendu* : Code-barres étendu (valable uniquement pour les codes-barres de type *CB_CODE39* et *CB_CODE93*).<br><br>- *CB_FormateTexte* : Formate le texte affiché pour les codes-barres de type *EAN 128* : des parenthèses sont ajoutées autour des AIs dans le texte imprimé.<br><br>- *CB_Gauche* : Code-barres aligné à gauche dans le rectangle destination.<br><br>- *CB_Haut* : Code-barres positionné en haut du rectangle destination.<br><br>- *CB_IgnoreFormatage* : Ignore les parenthèses d'un code 128, EAN-128 ou GS1-128 (valable uniquement pour les codes-barres de type *CB_CODE128*, *CB_EAN128* et *CB_GS1_128*).<br>	Les parenthèses sont utilisées pour rendre le code-barres plus lisible par un humain, mais ne sont pas dessinées dans le code.<br><br>- *CB_JeuxCaractères* : Code-barres utilisant un ou plusieurs jeux de caractères utilisés pour la compression du code-barres. Ce jeu de caractères doit être défini dans la valeur du code-barres.<br>	Pour plus de détails sur les jeux de caractères, consultez [Les différents types de codes-barres](../WDLang5/3046064.md).<br><br>- *CB_NonProportionnel* : Ajuste le code-barres à la taille du rectangle destination.<br><br>- *CB_SansTexte* : N'affiche pas le texte sous le code-barres (valable uniquement pour les codes-barres de type *CB_UPCA*, *CB_UPCB*, *CB_EAN13* et *CB_EAN8*).<br><br>- *CB_Texte* : Affiche le texte sous le code-barres. <br>	Le texte est normalisé pour les codes-barres de type *CB_UPCA*, *CB_UPCE*, *CB_EAN13* et *CB_EAN8*. <br>	Pour les autres types de codes-barres, le texte peut dépasser du cadre d'affichage du code-barres.<br><br>- *CB_TexteCentre* : Centre le texte sous le code-barres (valable uniquement pour les codes-barres de type *CB_CODE128*, *CB_CODE93*, *CB_CODE11*, *CB_EAN128*, *CB_CODE39*, *CB_INTER2OF5*, *CB_CODABAR*, *CB_MSI*).<br><br>- *CB_TexteDroite* : Aligne à droite le texte sous le code-barres (valable uniquement pour les codes-barres de type *CB_CODE128*, *CB_CODE93*, *CB_CODE11*, *CB_EAN128*, *CB_CODE39*, *CB_INTER2OF5*, *CB_CODABAR*, *CB_MSI*). <br><br>- *CB_TexteGauche* : Aligne à gauche le texte sous le code-barres (valable uniquement pour les codes-barres de type *CB_CODE128*, *CB_CODE93*, *CB_CODE11*, *CB_EAN128*, *CB_CODE39*, *CB_INTER2OF5*, *CB_CODABAR*, *CB_MSI*).<br><br>- *CB_Vérification* : Code-barres avec caractères de vérification (valable uniquement pour les codes-barres de type *CB_CODE39*, *CB_CODE93*, *CB_INTER2OF5* et *CB_CODABAR*).<br><br>- *CB_Vertical* : Imprime le code-barres verticalement.<br><br>- *CB_90* : Imprime le code-barres verticalement.<br><br>- *CB_180* : Imprime le code-barres en faisant une rotation à 180 degrés.<br><br>- *CB_270* : Imprime le code-barres en faisant une rotation à 270 degrés.<br><br><br> |
| ProportionImage | Réel | Pourcentage de la surface du code-barres occupée par l'image ajoutée au centre du code-barres (uniquement pour les codes-barres de type QR Code pour lesquels la propriété **Image** est spécifiée). Cette valeur ne doit pas dépasser la moitié de la surface réservée pour la correction d'erreur.<br><br><br>\   \   \<br>\ --- \ --- \<br>\ Valeur de la propriété CorrectionErreur \ Valeur maximale de la propriété ProportionImage \<br>\ qrcodeNiveauH \ 5 \<br>\ qrcodeNiveauL \ 1 \<br>\ qrcodeNiveauM \ 3 \<br>\ qrcodeNiveauQ	 \ 5 \<br><br><br> |
| TypeCodeBarres | Constante de type Entier | Type de code-barres : <br><br>- *CB_AZTEC* : Code-barres de type AZTEC.<br><br>- *CB_MAXICODE* : Code-barres de type MaxiCode.<br>	<br><br>- *CB_QRCODE* : Code-barres de type QR Code. Cette constante est utilisée par défaut lors de la création d'une variable de type CodeBarres. <br><br>- *CB_UPCA* : Code-barres de type UPC-A.<br><br>- *CB_UPCE* : Code-barres de type UPC-E.<br><br>- *CB_EAN8* : Code-barres de type EAN8.<br><br>- *CB_EAN13* : Code-barres de type EAN13.<br><br>- *CB_CODE39* : Code-barres de type Code39.<br><br>- *CB_CODE93* : Code-barres de type Code93.<br><br>- *CB_CODE128* : Code-barres de type Code128.<br><br>- *CB_GS1_128* : Code-barres de type GS1-128 (nouveau nom du code-barres EAN128).<br><br>- *CB_INTER2OF5* : Code-barres de type Interleaved 2 of 5.<br><br>- *CB_DATAMATRIX* : Code-barres de type DATAMATRIX.<br>	<br><br>- *CB_PDF417* : Code-barres de type PDF417.<br><br>- *CB_CODABAR* : Code-barres de type Codabar.<br><br>- *CB_CODE11* : Code-barres de type Code11.<br>	<br><br>- *CB_EAN128* : Code-barres de type EAN128.<br>	<br><br>- *CB_MSI* : Code-barres de type MSI.<br>	<br><br><br><br><br>Ces types sont également disponibles pour les impressions réalisées à l'aide de la fonction [iImprimeCodeBarre](../WDLang5/3046020.md). |
| TypeContenu | Constante de type Entier | Nature des données stockées dans le code-barres : <br><br>- *cbTypeTexte* (valeur par défaut lors de la création de la variable) : Texte brut<br><br>- *cbTypeTéléphone* : Numéro de téléphone<br><br>- *cbTypeSMS* : Numéro de SMS<br><br>- *cbTypeEmail* : Adresse email<br><br>- *cbTypeContact* : Description d'un contact<br><br>- *cbTypePosition* : Position géographique<br><br>- *cbTypeURL* : URL (signet). Pour insérer une adresse http dans le code-barres, utilisez le type *cbTypeTexte*.  <br>	Cette constante est conservée par compatibilité et doit être utilisée dans des cas très spécifiques. <br><br>- *cbTypeMarket* : Lien vers une application sur Google Play (pour une application Android uniquement)<br><br>- *cbTypeWiFi* : Paramètres de connexion à un réseau Wi-Fi (pour une application Android uniquement)<br><br><br>**Remarque** : Ces natures de données sont disponibles pour les codes-barres 2D (par exemple QR Code, Aztec, datamatrix, PDF417, ...). Pour les codes-barres autres que les codes-barres 2D, la nature des données est toujours de type texte. |
| ValeurBrute | Chaîne de caractères Unicode | Valeur brute du code-barres. <br><br>Pour les codes-barres autres que ceux de type QR Code, la valeur de cette propriété est identique à celle de la propriété **Contenu**.<br><br>**Cette propriété est disponible en lecture seulement**.<br><br> |


<a name="NOTE0_2"></a>


### Correspondance entre la propriété Contenu et la propriété TypeContenu 
<a name="correspondance_entre_propriete_contenu_propriete_typecontenu_ELTPARAGRAPHE000403"></a>

| Type de contenu | Type de la valeur (Propriété Contenu) | Remarque |
| --- | --- | --- |
| *cbTypeTexte* | Chaîne de caractères | Exemple : "WinDev c'est bien !" |
| *cbTypeTéléphone* | Chaîne de caractères | Exemple : "0612345678" |
| *cbTypeSMS* | Chaîne de caractères<br>En lecture : Les membres de la [structure SMS](../WDLang3/3068003.md) (SMS.Message et SMS.Numéro) seront automatiquement renseignés avec les valeurs lues dans le code-barres. le contenu correspondra à une chaîne de la forme : &lt;Numéro&gt; + RC + &lt;Message&gt;<br><br>En génération : S'ils existent, les membres de la [structure SMS](../WDLang3/3068003.md) (SMS.Message et SMS.Numéro) seront automatiquement pris en compte. Il est également possible d'utiliser une chaîne de caractères de la forme : &lt;Numéro&gt; + RC + &lt;Message&gt; | Exemple : "0612345678&lt;RC&gt;Texte à envoyer" |
| *cbTypeURL* | Chaîne de caractères<br><br>Correspond à un signet. Le contenu sera encodé sous la forme "urlto::URL". Par exemple : "urlto::http://www.pcsoft.fr". Certains décodeurs ne supportent pas ce type de contenu. <br><br>Pour spécifier une adresse http, utilisez le type de contenu *cbTypeTexte*. <br><br>Remarque : Cette constante est conservée par compatibilité et doit être utilisée dans des cas très spécifiques. | Exemple : "http://www.google.fr" |
| *cbTypeMarket* | Chaîne de caractères | Exemple : "market://search?q=pname:com.societe.application" |
| *cbTypeWiFi* | Chaîne de caractères | Chaîne de caractères de la forme : <br>&lt;SSID&gt; + TAB + &lt;Protocole de sécurité&gt;+ TAB + &lt;Clé&gt;<br>Exemple : "MonRéseau&lt;TAB&gt;WPA&lt;TAB&gt;mdp" |
| *cbTypeEmail* | Chaîne de caractères | Exemple : "nom@mail.com" |
| *cbTypeContact* | Vide. <br>En lecture : Les membres de la [structure mContact](../WDLang3/1000006111.md) seront automatiquement renseignés avec les valeurs lues dans le code-barres.<br>En génération : Les membres de la [structure mContact](../WDLang3/1000006111.md) seront automatiquement utilisés pour générer le code-barres. |   |
| *cbTypePosition* | Variable de type [géoPosition](../WDLang3/1000019191.md).<br><br>En lecture : Les propriétés **Latitude** et **Longitude** de la variable seront automatiquement renseignées avec les valeurs lues dans le code-barres.<br>En génération : Les propriétés **Latitude** et **Longitude** de la variable seront automatiquement utilisées pour générer le code-barres. |   |


<a name="NOTE0_3"></a>


### Fonctions utilisant des variables de type CodeBarres
<a name="fonctions_utilisant_des_variables_type_codebarres_ELTPARAGRAPHE000502"></a>


|   |   |
| --- | --- |
| [CBCapture](../WDLang5/1000019456.md) | Décode les informations stockées dans un code-barres en utilisant la caméra de l'appareil (Android, iPhone, iPad). |
| [CBDécode](../WDLang5/1000019633.md) | Décode les informations stockées dans un code-barres de type QR Code. |
| [iImprimeCodeBarre](../WDLang5/3046020.md) | Imprime un code-barres (à l'intérieur d'un rectangle). |





**Remarque** : Pour réinitialiser le contenu d'une variable de type **CodeBarres**, il est possible d'utiliser la fonction [VariableRAZ](../WDLang1/3013069.md).


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=AndroidInventaire.gif) ***Android (WINDEV Mobile)*** : **Android Inventaire** <br>Cette application permet de réaliser les inventaires et d'enregistrer les résultats dans une base de données.


