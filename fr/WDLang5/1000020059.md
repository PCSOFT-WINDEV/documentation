


## iEnchaînementAjoute (Fonction)

***En anglais : iSequencingAdd***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute un état dans un enchaînement d'impressions d'états.

Remarque : L'enchaînement d'impressions d'états permet d'imprimer des états différents à la suite, visibles comme une seule impression dans le visualisateur de rapports. Il est possible d'ajouter divers types de documents dans cet enchaînement. Pour plus de détails, consulter [Enchaîner des états](../WDChamp/9000128.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
iDestination(iVisualisateur)
iEnchaînementAjoute(ETAT_Etat1)
iEnchaînementAjoute(ETAT_Etat2, 3)
iEnchaînementImprime()
```
<a name="Exemple2"></a>

```wl
// Ouvrir le visualisateur de rapports
iDestination(iVisualisateur)
POUR TOUT Activités 
	// Ajoute l'état des activités pour l'activité en cours
	iEnchaînementAjoute(ETAT_Activités, Activités.IDActivités, Activités.IDActivités)
	// Ajoute l'état du matériel correspondant à l'activité en cours
	iEnchaînementAjoute(ETAT_MatérielEquipement, Activités.NomActivité)
FIN
iEnchaînementImprime()
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`iEnchaînementAjoute(<Etat> [, <Paramètre 1> [... [, <Paramètre N>]]])`
---

**`<Etat> : (Chaîne de caractères)`**

Nom de l'état : 

- Nom logique de l'état, défini sous l'éditeur d'états.

- Nom physique de l'état (avec son chemin), si le code compilé est intégré à l'état.




**`<Paramètre 1> : (Paramètres optionnels (le type correspond au type du paramètre))`**

Paramètre optionnel attendu par l'état pour son exécution. Ce paramètre a été défini dans le code d'ouverture de l'état. Ce paramètre peut être par exemple un nom de vue, de zone mémoire, etc.
**Attention** : Si l'état comprend des bornes (borne minimale et borne maximale), les deux premiers paramètres doivent correspondre respectivement à la borne minimale et à la borne maximale.
**Attention :  Ce paramètre est passé par valeur à l'état et non par adresse**.



**`<Paramètre N> : (Paramètres optionnels (le type correspond au type du paramètre))`**

Paramètre optionnel attendu par l'état pour son exécution. Ce paramètre a été défini dans le code d'ouverture de l'état. Ce paramètre peut être par exemple un nom de vue, de zone mémoire, etc.
**Attention** : Si l'état comprend des bornes (borne minimale et borne maximale), les deux premiers paramètres doivent correspondre respectivement à la borne minimale et à la borne maximale.
**Attention :  Ce paramètre est passé par valeur à l'état et non par adresse**.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Initialisation des sources de données des états enchaînés
<a name="initialisation_des_sources_donnees_des_etats_enchaines_ELTPARAGRAPHE000076"></a>Les états ne sont pas exécutés au moment de l'exécution de la fonction **iEnchaînementAjoute** : seul leur nom et leurs paramètres sont mémorisés. 

Ces états sont réellement exécutés lors de l'appel de la fonction [iEnchaînementImprime](../WDLang5/1000019903.md). 

Attention : Si des états présents dans l'enchaînement sont basés sur une requête, l'initialisation de la requête doit être effectuée avec la fonction [iInitRequêteEtat](../WDLang5/1000003046021.md) dans l'événement "Initialisation" de l'état (et non avant l'appel de la fonction **iEnchaînementAjoute**). 


### Gestion des numéros de pages
<a name="gestion_des_numeros_pages_ELTPARAGRAPHE000097"></a>Si les états présents dans l'enchaînement affichent le numéro de page, les numéros de page se suivront pour les différents états enchaînés. 

Par exemple, si le premier état de l'enchaînement est numéroté de 1 à 10, le second état sera numéroté de 11 à 20, et ainsi de suite. 

Pour forcer le numéro de page d'un état de l'enchaînement, utilisez la fonction [iNumPage](../WDLang5/3046013.md) dans l'état voulu. 


### Utilisation de variables globales
<a name="utilisation_variables_globales_ELTPARAGRAPHE000109"></a>Les états enchaînées peuvent manipuler des variables globales dans les différents événements WLangage associés à l'état. Dans ce cas, la valeur de la variable globale prise en compte est celle correspondant à l'impression ou à la prévisualisation effective. 

Si la valeur d'une variable globale est modifiée entre l'appel de la fonction **iEnchaînementAjoute**  et la fonction [iEnchaînementImprime](../WDLang5/1000019903.md), sa valeur dans l'état correspondra à la dernière valeur qui lui a été affectée. 


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDEtats.gif) ***Exemples didactiques (WINDEV)*** : **WD Etats** <br>Cet exemple montre les différentes méthodes pour réaliser un état :<br> <br>- impressions basées sur différentes sources de données (requêtes, variables, ...)<br>- impressions basées sur des champs (Table, Tableur, TCD, ...)<br>- impression d'états composés<br>- impressions spécifiques (portrait / paysage, état avec filigrane, état avec code-barres, ...)

<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280etat.dll
