


## &lt;Variable gglConnexion&gt;.Requête (Fonction)

***En anglais : &lt;gglConnection variable&gt;.Request***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Effectue une requête de communication (requête HTTP) à un service Google.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Connexion
Cnx est un gglConnexion
...
SI Cnx.Connecte() = Faux ALORS
	Erreur(ErreurInfo())
FIN

// Requête sans paramètres
ReqXml est une chaîne = Cnx.Requête(gglServiceDocuments, ...
		"http://docs.google.com/feeds/documents/private/full") 
// Requête avec paramètres (recherche du mot "Casimir")
ReqXml = Cnx.Requête(gglServiceDocuments, ...
		"http://docs.google.com/feeds/documents/private/full ?q=Casimir")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Connexion Google>.Requête(<Service Google> , <Requête HTTP> [, <Données à envoyer> [, <Type de la requête>]])`
---

**`<Résultat> : (Chaîne de caractères Ansi)`**



- Réponse du serveur, 

- Chaîne vide ("") en cas d'erreur (variable [ErreurDétectée](../WDLang1/3087001.md) à <u><u><u><u>Vrai</u></u></u></u>).




**`<Connexion Google> : (Variable de type gglConnexion)`**

Nom de la variable de type [gglConnexion](../WDLang5/1000018009.md) à utiliser. Cette connexion a été validée avec la fonction [&lt;Variable gglConnexion&gt;.Connecte](../WDLang5/1000021455.md).

**`<Service Google> : (Constante de type entier)`**

Service Google sur lequel la requête doit être effectuée :


|   |   |
| --- | --- |
| *gglServiceAgenda* | Service "Agenda Google Calendar" : Agenda Google |
| *gglServiceContacts* | Service "Google Contacts" : Gestion des contacts Google. <br><br><br>	<B><B><B><B>Avertissement</B></B></B></B><br><br>	 A partir du 15 juin 2021, l'API Contacts de Google utilisée par cette fonctionnalité n'est plus disponible ([https://developers.google.com/contacts/v3/announcement](https://developers.google.com/contacts/v3/announcement)). Pour plus de détails, consultez [Gestion des contacts Google](../WDLang5/1000017761.md).<br>
 |
| *gglServiceDocuments* | Service "Google Documents List" : Gestion des documents |
| *gglServicePicasa* | Service "Picasa" |
| *gglServiceStaticMaps* | Service "Google Static Maps" : Gestion des cartes et plans |



**`<Requête HTTP> : (Chaîne de caractères)`**

URL complète de la requête (c'est-à-dire avec si nécessaire les paramètres stockés dans l'URL). Pour plus de détails sur le contenu de l'URL à envoyer, consultez la documentation Google correspondant au service utilisé.

**`<Données à envoyer> : (Chaîne de caractères optionnelle)`**

Données à envoyer sur le serveur. Pour plus de détails sur les données à envoyer et leur format, consultez la documentation Google correspondant au service utilisé.

**`<Type de la requête> : (Constante optionnelle de type entier)`**

Type de la requête HTTP à envoyer :


|   |   |
| --- | --- |
| *gglHTTPDelete* | Requête de type Delete. |
| *gglHTTPGet* | Requête de type Get. |
| *gglHTTPPost* | Requête de type Post. |
| *gglHTTPPut* | Requête de type Put. |


Si le paramètre &lt;Données à envoyer&gt; est précisé, les requêtes sont de type ***gglHTTPPost*** par défaut.
Si le paramètre &lt;Données à envoyer&gt; n'est pas précisé, les requêtes sont de type ***ggHTTPGet*** par défaut.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Cas d'erreurs possibles : 
<a name="cas_erreurs_possibles_ELTPARAGRAPHE000251"></a>

- La connexion Internet n'est pas valide.

- L'authentification n'a pas pu être réalisée correctement.

- Le serveur renvoie une erreur.




Pour savoir si une erreur est survenue, utilisez la variable [ErreurDétectée](../WDLang1/3087001.md).

<a name="XComposante"></a>

## Composante :
wd280ggl.dll
