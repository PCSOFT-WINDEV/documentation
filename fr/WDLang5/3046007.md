
## iParamètrePDF (Fonction)

***En anglais : iParameterPDF***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Fixe les options du fichier PDF généré. Vous pouvez définir :

- le mot de passe utilisé pour l'ouverture du fichier.

- les options de compression des images.

- les options de présence des signets. 

- les options de protection du PDF. Il est également possible de définir le mot de passe permettant de modifier ces options de protection.

- le format du fichier (Unicode, PDF/A). 




A partir de la version 27, une variable de type [pdfParamètre](../WDLang6/1410087857.md) permet de définir toutes les options de génération du fichier PDF. 

Ce paramétrage est pris en compte lors de l'impression dans un fichier PDF (fichier généré à partir du visualisateur de rapports ou directement à l'aide de la fonction [iDestination](../WDLang5/3046074.md)).




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Affichage de deux pages entières avec défilement et page de couverture
Params est un pdfParamètre
Params.Qualité = iQualitéElevée
Params.Zoom = zoomPleineLargeur
Params.AffichagePage = affDeuxPages + affAvecDéfilement + affAvecCouverture
iParamètrePDF(Params)
iDestination(iPDFGénérique)
iImprimeEtat(MonEtat)

LanceAppliAssociée(iDernierFichier())
```



```wl
// Protection du PDF contre l'impression 
// et contre la sélection et le copier/coller
// Pas de mot de passe pour l'ouverture du PDF
// Mot de passe pour modifier les mesures de protection
iParamètrePDF(iProtectionImpression + iProtectionSélection, "", "Protection")
// Création du PDF
iDestination(iPDF, "C:\Temp\MonPDF.PDF")
// Code d'impression
iCréePolice(1, 16, iGras, iRoman)
ImprimeTitre()
ImprimeTexte()
// Fin de l'impression et fermeture du fichier PDF créé
iFinImprime()
```


<a name="Exemple2"></a>



```wl
// Aucune protection du document généré
// Qualité maximale des images 
iParamètrePDF("", "", iQualitéMaximale)

// Création du PDF
iDestination(iPDF, "C:\Temp\MonPDF.PDF")
// Code d'impression
iCréePolice(1, 16, iGras, iRoman)
ImprimeTitre()
ImprimeTexte()
Imprimeimage()
// Fin de l'impression et fermeture du fichier PDF créé
iFinImprime()
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Paramétrer le fichier PDF via une variable de type pdfParamètre

`iParamètrePDF(<Paramètres>)`
---

**`<Paramètres> : (Variable de type pdfParamètre)`**

Nom de la variable [pdfParamètre](../WDLang6/1410087857.md) décrivant toutes les options du fichier PDF à générer. Le format du PDF généré peut notamment être spécifié par cette variable. 


<a name="SYNTAXE2"></a>

### Protéger le fichier PDF par un mot de passe

`iParamètrePDF(<Mot de passe> [, <Mot de passe de protection>] [, <Qualité et signet>])`
---

**`<Mot de passe> : (Chaîne de caractères)`**



- Mot de passe utilisé pour l'ouverture du fichier PDF, 

- Chaîne vide si aucun mot de passe ne doit être utilisé.




**`<Mot de passe de protection> : (Chaîne de caractères optionnelle)`**

Mot de passe utilisé pour permettre la modification des mesures de protection du fichier PDF.

Attention : La norme PDF ne supporte que les mots de passe en alphabet latin non accentué (exemples : les accents, les caractères chinois, les caractères russes sont interdits).

**`<Qualité et signet> : (Constante ou combinaison de constantes optionnelle de type Entier)`**

Configure :

- Niveau de compression des couleurs et des niveaux de gris.

- Gestion des signets. 

- Gestion de l'Unicode.





|   |   |
| --- | --- |
| *iPDFNiveauGris* | PDF généré en noir et blanc. <br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas disponible. |
| *iPDFUnicode* | PDF au format Unicode.<br>Remarques :<br><br>- L'utilisation de cette constante est conseillée si les caractères présents dans le fichier PDF sont mal encodés.<br><br>- Si cette constante est utilisée, la taille du fichier PDF généré augmentera de manière non négligeable.<br><br><br><br><br> |
| *iQualitéAutomatique* | Niveau de compression calculé automatiquement afin d'obtenir une qualité correcte du PDF généré (notamment pour les images).<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas disponible. |
| *iQualitéElevée* | Niveau de compression faible permettant d'obtenir une qualité élevée du PDF généré.<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas disponible. |
| *iQualitéFaible* | Niveau de compression élevé.<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas disponible. |
| *iQualitéMaximale* | Niveau de compression minimal pour obtenir une qualité maximale. Cette constante est conseillée pour réaliser un fichier PDF destiné à l'impression.<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas disponible. |
| *iQualitéMinimale* | Niveau de compression maximal. La qualité obtenue sera minimale. Cette constante peut être utilisée pour réaliser un fichier PDF destiné à être visualisé à l'écran.<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas disponible. |
| *iQualitéMoyenne* | Niveau de compression moyen.<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas disponible. |
| *iSignetAucun* | Aucun signet n'est pris en compte dans le PDF. |
| *iSignetPage* | Les signets sont pris en compte dans le PDF. Un signet est automatiquement défini pour chaque page du PDF. Chaque signet a pour nom "Page &lt;numéro de la page&gt;" (par exemple "Page 1"). |






<a name="SYNTAXE3"></a>

### Sélectionner les options de protection

`iParamètrePDF(<Options de protection> [, <Mot de passe> , <Mot de passe de protection>] [, <Qualité et signet>])`
---

**`<Options de protection> : (Constante ou combinaison de constantes de type Entier)`**

Format et protection demandée :


|   |   |
| --- | --- |
| *iPDFA3b* | PDF au format PDF/A-3b : <br><br>- Tous les éléments nécessaires à l'affichage ou l'impression du fichier PDF sont intégrés au fichier généré. La taille du fichier généré est donc plus importante. <br><br>- Il est possible d'ajouter des fichiers au format XML, CSV, traitement de texte, tableur, ... au fichier PDF. Cet ajout peut être effectué grâce à la fonction [iAjoutePièceJointe](../WDLang5/1000024059.md). <br><br><br><br><br>Attention : Cette option est prise en compte uniquement pour l'impression courante. <br><br>Remarque : Ce format implique certaines limitations : <br><br>- Transparence des images non gérée. <br><br>- Polices de type OpenType non gérées. <br><br>- Utilisation de polices incorporables. <br><br><br><br><br>Pour plus de détails, consultez [Gestion du format PDF/A](#NOTE0_2). <br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |
| *iPDFA*<br>ou<br>*iPDFA1b* | PDF au format PDF/A-1b. Tous les éléments nécessaires à l'affichage ou l'impression du fichier PDF sont intégrés au fichier généré. La taille du fichier généré est donc plus importante. <br><br>Attention : Cette option est prise en compte uniquement pour l'impression courante. <br><br>Remarque : Ce format implique certaines limitations : <br><br>- Transparence des images non gérée. <br><br>- Polices de type OpenType non gérées. <br><br>- Utilisation de polices incorporables. <br><br><br><br><br>Pour plus de détails, consultez [Gestion du format PDF/A](#NOTE0_2). <br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |
| *iPDFNiveauGris* | PDF généré en noir et blanc. |
| *iPDFUnicode* | PDF au format Unicode<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas disponible. |
| *iProtectionAucune* | Aucune protection du fichier PDF. |
| *iProtectionCommentaire* | Protection contre l'ajout ou la modification de commentaires. |
| *iProtectionImpression* | Le fichier PDF ne pourra pas être imprimé. |
| *iProtectionModification* | Le contenu du fichier PDF ne pourra pas être modifié. |
| *iProtectionSélection* | Le contenu du fichier PDF ne pourra pas être copié ou extrait du fichier. |





**`<Mot de passe> : (Chaîne de caractères optionnelle)`**



- Mot de passe utilisé pour l'ouverture du fichier PDF, 

- Chaîne vide si aucun mot de passe ne doit être utilisé.




**`<Mot de passe de protection> : (Chaîne de caractères optionnelle)`**

Mot de passe utilisé pour permettre la modification des mesures de protection du fichier PDF. 

Si ce mot de passe correspond à une chaîne vide (""), un mot de passe est automatiquement généré.

**`<Qualité et signet> : (Constante ou combinaison de constantes optionnelle de type Entier)`**

Configure :

- Qualité de compression des couleurs et des niveaux de gris.

- Gestion des signets.  

- Gestion de l'Unicode.





|   |   |
| --- | --- |
| *iPDFUnicode* | PDF au format Unicode. <br><br>**Remarque** : A partir de la version 21, cette constante peut être utilisée dans le paramètre &lt;Options de protection&gt;. <br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas disponible. |
| *iQualitéElevée* | Qualité de compression élevée<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas disponible. |
| *iQualitéFaible* | Qualité de compression faible<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas disponible. |
| *iQualitéMaximale* | Qualité de compression maximale<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas disponible. |
| *iQualitéMinimale* | Qualité de compression minimale<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas disponible. |
| *iQualitéMoyenne* | Qualité de compression moyenne<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas disponible. |
| *iSignetAucun* | Aucun signet n'est pris en compte dans le PDF |
| *iSignetPage* | Les signets sont pris en compte dans le PDF. Un signet est automatiquement défini pour chaque page du PDF. Chaque signet a pour nom "Page &lt;numéro de la page&gt;" (par exemple "Page 1"). |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- La fonction **iParamètrePDF** n'est pas prise en compte au milieu d'une impression.

- Le paramétrage réalisé avec la fonction **iParamètrePDF** est actif :

	- soit jusqu'à la fin de l'application ou du site,

	- soit jusqu'à la prochaine utilisation de la fonction **iParamètrePDF**,

	- soit jusqu'à la prochaine utilisation de la fonction [iRAZ](../WDLang5/3046067.md).




- Si le mode PDF/A-1b est activé via la fonction **iParamètrePDF** avant d'afficher l'aperçu avant impression : 

	- L'option d'export en mode PDF est modifiée : "PDF/A" est affiché à la place de "PDF".

	- Pour toutes les impressions réalisées depuis l'aperçu (impression directe, ...), les limitations seront identiques à celles de l'export au format PDF/A : transparence des images, substitution de polices, ... 




- Par défaut, le PDF généré utilise est en version 1.4. Pour générer le fichier PDF avec une version spécifique, utilisez une variable de type [pdfParamètre](../WDLang6/1410087857.md). La version de génération peut être paramétrée avec la propriété **Version**.  



<a name="NOTE0_2"></a>


### Gestion du format PDF/A
<a name="gestion_format_pdfa_ELTPARAGRAPHE000404"></a>Limitations : 


- La transparence des images n'est pas gérée : 

	- Si l'image contient dans son format un fond transparent, l'image sera dessinée sur un fond blanc. 

	- Si la couleur "Magenta transparent" est utilisée, le rendu de l'image pourra être différent dans le PDF généré. 




- Les polices de type "Opentype" ne sont pas gérées car les polices "Opentype" ne sont pas incorporables dans le PDF généré. 

- Toutes les polices utilisées doivent être incorporables dans le PDF généré et doivent contenir tous les caractères affichés. 

	- En Windows, s'il manque des caractères, la police de substitution utilisée est "Arial Unicode ms". 

	- En Linux, s'il manque des caractères, une erreur est affichée. 







Astuce : Comment savoir si l'impression au format PDF/1-1b sera correcte ? 

- Si l'impression est réalisée à partir d'un état, il est possible d'activer les erreurs d'IHM spécifiques à ce format (onglet "Options" de la fenêtre de description de l'état, option "Activer les erreurs spécifiques à l'export PDF/A-1b"). 

- Dans tous les cas, lors d'un audit dynamique, les erreurs spécifiques à la gestion des PDF/A-1b sont détectées et affichées.




<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280prn.dll
