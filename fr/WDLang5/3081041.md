
## Gestion XML : Exemple d'utilisation
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000092"></a>
Cet exemple d'application gère un fichier XML nommé "commande.xml". Ce fichier contient des données relatives à une commande.

**Cet exemple utilise la gestion des fichiers XML à l'aide des chaînes de caractères**.

Extrait du contenu de "commande.xml" : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Fichier_XML.gif)


<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Exemple d'utilisation
<a name="exemple_utilisation_ELTTEXTE000116"></a>
Le code WLangage suivant permet de : 

- créer un document XML à partir du fichier "Commande.XML" :
	
	```wl
	// Récupération du contenu XML du fichier "commande.xml"
	MaSourceXML est une chaîne = fChargeTexte("C:\MesCommandes\Commande.xml")
	// Création du document XML
	XMLDocument("CdeXML", MaSourceXML)
	SI ErreurDétectée = Vrai ALORS
		Erreur("Erreur lors de la création du document XML")
		RETOUR
	FIN
	```


- parcourir le document XML et récupérer le contenu des éléments :
	
	```wl
	// Positionne sur l'élément ""
	XMLPremier("CdeXML")
	// Descend d'un niveau et positionne sur l'élément ""
	XMLFils("CdeXML")
	// Récupère le numéro de la commande
	NumCde est un entier = Val(XMLDonnée("CdeXML")) //contient 1
	// Positionne sur l'élément suivant
	XMLSuivant("CdeXML")
	// Récupère la date de la commande
	DateCde est une chaîne = XMLDonnée("CdeXML") //"20/11/2002"
	```


- rechercher un élément dans le document XML et récupérer son contenu :
	
	```wl
	// Recherche du code produit
	XMLRecherche("CdeXML", "codeproduit", XMLBalise + XMLNiveauCourant + XMLSousElément)
	SI XMLTrouve("CdeXML") = Vrai ALORS
		CP est une chaîne = XMLDonnée("CdeXML") // contient "CDR-1080"
	FIN
	```


- ajouter des éléments dans le document XML :
	
	```wl
	// Ajout d'une nouvelle ligne de commande
	XMLParent("CdeXML")
	XMLParent("CdeXML")
	XMLAjouteFils("CdeXML", "lignecommande", "", Vrai)
	XMLAjouteAttribut("CdeXML", "numero", "2")
	
	// Ajout de la balise "codeproduit"
	XMLAjouteFils("CdeXML", "codeproduit", "sro2125")
	
	// Ajout de la balise "designation"
	XMLAjouteFils("CdeXML", "designation", "souris optique")
	
	// Ajout de la balise "quantité"
	XMLAjouteFils("CdeXML", "quantité", "15")
	```


- enregistrer les modifications effectuées dans le fichier XML :
	
	```wl
	// Mise en forme du contenu du document XML
	FichierXML est une chaîne = XMLConstruitChaîne("CdeXML")
	
	// Enregistrement du fichier XML
	fSauveTexte("C:\MesCommandes\Commande.xml", FichierXML)
	```


- fermer le document XML et afficher le résultat :
	
	```wl
	//Fermeture du document
	XMLTermine("CdeXML")
	
	// Affichage des données
	Info("Numéro de commande : " + NumCde, "Date de commande : " + DateCde, "Code produit : " + CP)
	```








