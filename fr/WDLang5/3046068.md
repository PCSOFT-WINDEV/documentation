
## iDernierFichier (Fonction)

***En anglais : iLastFile***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie : 

- le nom complet du dernier fichier généré lors de l'impression (PDF, RTF, Texte, ...).

- la liste des fichiers duplicata créés. 









<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Impression en mode PDF
iDestination(iPDF)
// Impression de l'état en mode PDF
iImprimeEtat(ETAT_Etat1)
// Ouverture du fichier
LanceAppliAssociée(iDernierFichier())
```


<a name="Exemple2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Paramétrage des duplicata réalisés depuis le visualisateur de rapports
iParamètreDuplicata(iDplImpression, "C:\Temp", "MonDuplicata_%d_%h", "MMJJAAAA", "HHMMSS")

// Impression d'un duplicata automatique depuis le visualisateur de rapports
iDestination(iVisualisateur)
iImprimeEtat(ETAT_Facture)

// Parcours des duplicatas créés automatiquement depuis le visualisateur de rapports
ListeDuplicata est une chaîne
ListeDuplicata = iDernierFichier(iListeDuplicata)
Duplicata est une chaîne
Duplicata = ExtraitChaîne(ListeDuplicata, rangPremier, RC)
TANTQUE Duplicata <> EOT
	// Impression du duplicata
	iImprimeDuplicata(Duplicata)
	// Passage au duplicata suivant
	Duplicata = ExtraitChaîne(ListeDuplicata, rangSuivant, RC)
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = iDernierFichier([<Options>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Information demandée.

**`<Options> : (Constante optionnelle de type Entier)`**

Permet de paramétrer le résultat renvoyé. Les constantes disponibles sont les suivantes : 


|   |   |
| --- | --- |
| *iFichier*<br>(Valeur par défaut) | Renvoie le chemin complet du dernier fichier généré lors de l'impression (PDF, XLS, ...). |
| *iListeDuplicata* | Renvoie la liste des derniers duplicata créés lors de l'impression sous la forme : <br><br><pre><code><Chemin complet du 1er duplicata> + RC + ... <br>+ RC + <Chemin complet du nième duplicata></code></pre><br><br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |









<a name="XComposante"></a>

## Composante :
wd280prn.dll
