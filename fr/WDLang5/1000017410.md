


## GglRécupèreAgenda (Fonction)

***En anglais : GglGetCalendar***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère un agenda Google et ses événements à partir de son titre ou identifiant. Cette fonction utilise le service Agenda Google Calendar.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1001000017410&name=gglrecupereagenda_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Connexion
Cnx est un gglConnexion
...
SI GglConnecte(Cnx) = Faux ALORS
	Erreur(ErreurInfo())
FIN

// Récupération de l'agenda nommé "Travail"
Agenda est un gglAgenda = GglRécupèreAgenda(Cnx, "Travail")
// Parcours des événements de l'agenda
SI ErreurDétectée = Faux ALORS
	 Evt est un gglEvénement
	 POUR TOUT Evt de Agenda
		Trace(Evt.Titre)
	 FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = GglRécupèreAgenda(<Connexion Google> [, <Titre ou Identifiant> [, <Début des événements> [, <Fin des événements> [, <Chaîne à rechercher>]]]])`
---

**`<Résultat> : (Variable de type gglAgenda)`**

Variable de type [gglAgenda](../WDLang5/1000017418.md) contenant les caractéristiques de l'agenda récupéré.

**`<Connexion Google> : (Variable de type gglConnexion)`**

Nom de la variable de type [gglConnexion](../WDLang5/1000018009.md) à utiliser. Cette connexion a été validée avec la fonction [GglConnecte](../WDLang5/1000017332.md).

**`<Titre ou Identifiant> : (Chaîne de caractères Unicode optionnelle)`**

Titre ou identifiant de l'agenda recherché. Si ce paramètre correspond à une chaîne vide (""), le premier agenda disponible est récupéré (par défaut).

**`<Début des événements> : (DateHeure optionnelle)`**

Date et heure de début des événements à récupérer. 
Si &lt;Début des événements&gt; et &lt;Fin des événements&gt; ne sont pas renseignés, seuls les événements futurs sont récupérés (événements à partir de la date du jour). 
Si seul &lt;Début des événements&gt; est renseigné, tous les événements postérieurs à cette date sont récupérés (la date limite par défaut définie par Google est le 01/01/2031).

**`<Fin des événements> : (DateHeure optionnelle)`**

Date et heure de fin des événements à récupérer. 
Si &lt;Début des événements&gt; et &lt;Fin des événements&gt; ne sont pas renseignés, seuls les événements futurs sont récupérés (événements à partir de la date du jour). 
Si seul &lt;Fin des événements&gt; est renseigné, tous les événements antérieurs à cette date sont récupérés (la date limite par défaut définie par Google est le 01/01/1970).

**`<Chaîne à rechercher> : (Chaîne de caractères optionnelle)`**

Texte à rechercher dans les événements de l'agenda. Si ce paramètre est spécifié, seuls les événements contenant le texte indiqué seront listés. La recherche est effectuée sur le nom et la description de l'agenda. Cette recherche n'est pas sensible à la casse. Par défaut, ce paramètre correspond à une chaîne vide.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Cas d'erreurs possibles : 
<a name="cas_erreurs_possibles_ELTPARAGRAPHE000080"></a>

- La connexion Internet n'est pas valide.

- L'authentification n'a pas pu être réalisée correctement.

- La réponse XML du serveur n'est pas lisible.

- L'agenda n'a pas pu être trouvé.




Pour savoir si une erreur est survenue, utilisez la variable [ErreurDétectée](../WDLang1/3087001.md).

<a name="XComposante"></a>

## Composante :
wd280ggl.dll
