


## xlsDocument (Type de variable)

***En anglais : xlsDocument ***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Une variable de type **xlsDocument** permet de décrire et modifier un document Excel.

**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000018059&name=xlsdocument_type_variable&product=WD">Voir des exemples supplémentaires</a>

```wl
MaFeuille est un xlsDocument
NomFichierXLS est une chaîne
NomFichierXLS = fSélecteur(fRepExe(), "", "Sélectionnez un fichier...", ...
	"Tous fichiers (*.*)" + TAB + "*.*", "*", fselOuvre + fselExiste)
SI NomFichierXLS = "" ALORS RETOUR
MaFeuille = xlsOuvre(NomFichierXLS, xlsEcriture)

// On va mettre OK dans la case A 25
MaFeuille[25,"A"] = "OK"
// Sauvegarde
xlsSauve(MaFeuille)
```


<a name="Exemple2"></a>

```wl
IDFicXLS est un xlsDocument 
NomFichierXLS est une chaîne = fRepExe + "\Suivi d'affaires1.xls"

IDFicXLS = xlsOuvre(NomFichierXLS, xlsEcriture)
SI ErreurDétectée = Faux ALORS
	Azz est un entier = xlsFeuilleEnCours(IDFicXLS)
	Info("Feuille en cours dans le fichier Excel : " + Azz)
	// Changement de feuille
	SI xlsFeuilleEnCours(IDFicXLS, 2) = Vrai ALORS
		Info("La feuille courante a été modifiée.")
		// Lecture d'une cellule pour test
		Info(xlsDonnée(IDFicXLS, 11, 2))
	SINON
		Erreur("Le fichier sélectionné ne comporte pas de seconde feuille !")
	FIN 
SINON
	Erreur("Attention ! le fichier est déjà ouvert sur un poste de travail !")
FIN
```

<a name="XSYNTAXE"></a>
<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Propriétés spécifiques à la description des variables de type xlsDocument
<a name="proprietes_specifiques_description_des_variables_type_xlsdocument_ELTPARAGRAPHE000041"></a>Les propriétés suivantes peuvent être utilisées pour manipuler une variable de type **xlsDocument** :

|   |   | <br><br> |
| --- | --- | --- |
| Nom | Type manipulé | Effet |
| Cellule | Tableau de [xlsCellule](../WDLang5/1000017472.md) | Cellules du document XLS. |
| Colonne | Tableau de [xlsColonne](../WDLang5/1000017471.md) | Colonne du document XLS. |
| DroiteAGauche | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> si la feuille courante est en mode de lecture "Droite vers la gauche".<br><br>- <u><u><u><u>Faux</u></u></u></u> si la feuille courante est en mode de lecture "Gauche vers la droite".<br><br><br> |
| Feuille | Entier | Numéro de la feuille en cours (identique à la fonction [xlsFeuilleEnCours](../WDLang5/3080022.md)). |
| Fichier | Chaîne de caractères | Nom et chemin complet du fichier XLS associé au document. **Cette propriété est disponible en lecture seulement**. Elle est affectée lors de l'utilisation de la fonction [xlsOuvre](../WDLang5/3080017.md).  <br>Remarque : lors de l'affectation d'une variable de type **xlsDocument** dans une autre, cette propriété n'est pas recopiée (sauf lors de l'appel de la fonction [xlsOuvre](../WDLang5/3080017.md)). |
| Ligne | Tableau de [xlsLigne](../WDLang5/1000017325.md) | Ligne du document XLS. |
| Modifié | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> si le document a été modifié<br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.<br><br><br>Cette propriété est remise à <u><u><u><u>Faux</u></u></u></u> après l'utilisation de la fonction [xlsSauve](../WDLang5/1000018057.md). |
| NombreColonne | Entier | Nombre de colonnes présentes dans le document (identique à la fonction [xlsNbColonne](../WDLang5/3080014.md)). **Cette propriété est disponible en lecture seulement**. |
| NombreFeuille | Entier | Nombre de feuilles présentes dans le document (identique à la fonction [xlsNbFeuille](../WDLang5/3080023.md)). **Cette propriété est disponible en lecture seulement**. |
| NombreLigne | Entier | Nombre de lignes présentes dans le document (identique à la fonction [xlsNbLigne](../WDLang5/3080011.md)). **Cette propriété est disponible en lecture seulement**. |
| NomFeuille | Chaîne de caractères | Nom de la feuille en cours. Cette propriété peut correspondre à une chaîne de 1 à 31 caractères. Elle est insensible à la casse. |
| RecalculAuChargement | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> si les formules du document doivent être recalculées lors de l'ouverture du document sous Excel ou OpenOffice.<br><br>- <u><u><u><u>Faux</u></u></u></u> si aucun calcul ne doit être effectué  lors de l'ouverture du document sous Excel ou OpenOffice.<br><br><br><br><br>Remarque : Seules les formules initialement présentes dans le document peuvent être recalculées. |
| Version | Entier | Version du document XLS (identique à la fonction [xlsVersion](../WDLang5/3080018.md)). **Cette propriété est disponible en lecture seulement**. |


<a name="NOTE0_2"></a>


### Accéder à une colonne d'un document Excel
<a name="acceder_une_colonne_document_excel_ELTPARAGRAPHE000199"></a>Pour accéder à une colonne d'un document Excel, il est possible d'utiliser les syntaxes suivantes :

- MonDocumentXLS.Colonne[1] : Accède à la colonne 1 du fichier Excel.

- MonDocumentXLS.Colonne["A"] : Accède à la colonne A du fichier Excel.



<a name="NOTE0_3"></a>


### Accéder à une cellule d'un document Excel
<a name="acceder_une_cellule_document_excel_ELTPARAGRAPHE000221"></a>Pour accéder à une cellule d'un document Excel, il est possible d'utiliser les syntaxes suivantes :

- MonDocumentXLS[1,2] : Accède à la cellule de la ligne 1 et de la colonne 2 du fichier Excel.

- MonDocumentXLS[5, "A"] : Accède à la cellule de la ligne 5 et de la colonne A du fichier Excel.



<a name="NOTE0_4"></a>


### Accéder à une cellule d'une colonne d'un document Excel
<a name="acceder_une_cellule_une_colonne_document_excel_ELTPARAGRAPHE000243"></a>Pour accéder à une cellule d'une colonne d'un document Excel, il est possible d'utiliser les syntaxes suivantes :

- MonDocumentXLS.Colonne[1].Cellule : Renvoie la valeur de la cellule de la colonne 1 pour la ligne en cours. 

- MonDocumentXLS.Colonne["A"].Cellule : Renvoie la valeur de la cellule de la colonne "A" pour la ligne en cours.  



<a name="NOTE0_5"></a>


### Accéder à une cellule d'une ligne d'un document Excel
<a name="acceder_une_cellule_une_ligne_document_excel_ELTPARAGRAPHE000265"></a>Pour accéder à une cellule d'une ligne d'un document Excel, il est possible d'utiliser la syntaxe suivante :

- MonDocumentXLS.Ligne[1].Cellule[2] : Accède à la cellule de la ligne 1 et de la colonne 2 du fichier Excel.

- MonDocumentXLS.Ligne[5].Cellule["A"] : Accède à la cellule de la ligne 5 et de la colonne A du fichier Excel.



<a name="NOTE0_6"></a>


### Fonctions WLangage manipulant des variables de type xlsDocument
<a name="fonctions_wlangage_manipulant_des_variables_type_xlsdocument_ELTPARAGRAPHE000299"></a>

- Syntaxe classique : 
	


|   |   |
| --- | --- |
| [xlsAjouteFeuille](../WDLang5/1000017285.md) | Ajoute ou insère une nouvelle feuille dans un document Excel. |
| [xlsDéfusionneCellule](../WDLang5/1410089538.md) | Supprime la fusion d'une plage de cellules. |
| [xlsDonnée](../WDLang5/3080021.md) | Récupère le contenu d'une cellule d'un fichier XLS. |
| [xlsFerme](../WDLang5/3080015.md) | Ferme un fichier XLS. |
| [xlsFeuilleEnCours](../WDLang5/3080022.md) | Permet de connaître ou de modifier la feuille courante d'un fichier XLS. |
| [xlsFusionneCellule](../WDLang5/1410089537.md) | Fusionne les cellules spécifiées dans un document Excel. |
| [xlsMsgErreur](../WDLang5/3080016.md) | Renvoie le libellé de la dernière erreur due à une fonction XLS. |
| [xlsNbColonne](../WDLang5/3080014.md) | Renvoie le nombre de colonnes d'une feuille d'un fichier XLS. |
| [xlsNbColonnes](../WDLang5/3080007.md) | La fonction xlsNbColonnes est conservée uniquement pour compatibilité. |
| [xlsNbFeuille](../WDLang5/3080023.md) | Renvoie le nombre de feuilles d'un fichier XLS. |
| [xlsNbLigne](../WDLang5/3080011.md) | Renvoie le nombre de lignes d'un fichier XLS. |
| [xlsNbLignes](../WDLang5/3080013.md) | La fonction xlsNbLignes est conservée uniquement pour compatibilité. |
| [xlsOuvre](../WDLang5/3080017.md) | Ouvre un fichier Excel (fichiers xls ou xlsx). |
| [xlsRecalculeTout](../WDLang5/1410089617.md) | Recalcule toutes les formules d'un document Excel au format XLSX. |
| [xlsRécupèreFusion](../WDLang5/1410089567.md) | Permet de savoir si une cellule est fusionnée avec d'autres cellules et d'obtenir la plage des cellules fusionnées correspondante. |
| [xlsSauve](../WDLang5/1000018057.md) | Sauve un document XLS. |
| [xlsSupprimeFeuille](../WDLang5/1000017288.md) | Supprime une feuille du document Excel. |
| [xlsTitreColonne](../WDLang5/3080012.md) | Récupère l'intitulé d'une colonne d'un fichier XLS. |
| [xlsTypeColonne](../WDLang5/3080019.md) | Renvoie le type des données saisies dans une colonne d'un fichier XLS. |
| [xlsVersion](../WDLang5/3080018.md) | Renvoie la version d'Excel avec laquelle le fichier a été enregistré. |




- Syntaxe préfixée : 
	


|   |   |
| --- | --- |
| [&lt;Variable xlsDocument&gt;.AjouteFeuille](../WDLang5/1000021509.md) | Ajoute ou insère une nouvelle feuille dans un document Excel. |
| [&lt;Variable xlsDocument&gt;.DéfusionneCellule](../WDLang5/1410089571.md) | Supprime la fusion de la cellule spécifiée. |
| [&lt;Variable xlsDocument&gt;.Ferme](../WDLang5/1000021510.md) | Ferme un fichier XLS. |
| [&lt;Variable xlsDocument&gt;.FusionneCellule](../WDLang5/1410089568.md) | Fusionne les cellules spécifiées dans un document Excel. |
| [&lt;Variable xlsDocument&gt;.RecalculeTout](../WDLang5/1410089739.md) | Recalcule toutes les formules d'un document Excel au format XLSX. |
| [&lt;Variable xlsDocument&gt;.RécupèreFusion](../WDLang5/1410089569.md) | Permet de savoir si une cellule est fusionnée avec d'autres cellules et d'obtenir la plage des cellules fusionnées correspondante. |
| [&lt;Variable xlsDocument&gt;.Sauve](../WDLang5/1000021511.md) | Sauve un document XLS. |
| [&lt;Variable xlsDocument&gt;.SupprimeFeuille](../WDLang5/1000021512.md) | Supprime une feuille du document Excel. |





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Typexls.gif) ***Exemples unitaires (WINDEV)*** : **Type xls** <br>Manipulation des types de variable xlsDocument, xlsColonne, xlsLigne et xlsCellule.<br>Cet exemple a pour but d'offrir une première approche, simple, de la manipulation de ces types de variables.


