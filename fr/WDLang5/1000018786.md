
## xmlNoeud (Type de variable)

***En anglais : xmlNode***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **xmlNoeud** permet de manipuler un noeud d'un document XML. Les caractéristiques de ce noeud peuvent être définies et modifiées à l'aide de différentes propriétés WLangage.

Ce type de variable est utilisé par : 

- le type [xmlDocument](../WDLang5/1000018782.md). 

- le type [xpathRésultat](../WDLang5/1000021967.md).




**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MonTexteXML est une chaîne = [
<?xml version="1.0"?>
<!DOCTYPE PLAY SYSTEM "play.dtd">
<PLAY>
<TITLE>The Tragedy of Romeo and Juliet</TITLE>
<ACT><TITLE>ACT I</TITLE>
<PROLOGUE><TITLE>PROLOGUE</TITLE></PROLOGUE>
<SCENE><TITLE>SCENE I.  Verona. A public place.</TITLE></SCENE>
</ACT>
<ACT><TITLE>ACT II</TITLE>

<PROLOGUE><TITLE>PROLOGUE</TITLE></PROLOGUE>
<SCENE><TITLE>SCENE I.  A lane by the wall of Capulet's orchard.</TITLE></SCENE>
</ACT>
<ACT><TITLE>ACT III</TITLE>

<PROLOGUE><TITLE>PROLOGUE</TITLE></PROLOGUE>
<SCENE><TITLE>SCENE I.  A public place.</TITLE></SCENE>
</ACT>
</PLAY>
]

// Chargement d'un document XML
RomeoEtJuliette est un xmlDocument
RomeoEtJuliette = XMLOuvre(MonTexteXML, depuisChaîne)

// Affichage du titre des actes
Acte est un xmlNoeud
POUR TOUT Acte DE RomeoEtJuliette.PLAY sur ACT
	Trace(Acte.TITLE)
FIN
```


<a name="Exemple2"></a>



```wl
// Validation à partir du schéma défini lors de la déclaration
cMonNoeud est un xmlNoeud, description="schemaXSDDuProjet.NoeudRacine"
// La variable peut également être déclarée de la façon suivante :
// cMonNoeud est un xmlNoeud <description="schemaXSDDuProjet.NoeudRacine">
cMonNoeud.Texte = "21"
SI XMLNoeudValide(cMonNoeud) = Faux ALORS
	Erreur(ErreurInfo())
SINON
	Info("Le noeud XML est valide") 
FIN
```




## Remarques
<a name="NOTE0_1"></a>


### Déclaration d'une variable de type xmlNoeud
<a name="declaration_une_variable_type_xmlnoeud_ELTPARAGRAPHE000068"></a>

Les variables de type **xmlNoeud** peuvent être déclarées en indiquant un noeud modèle (noeud dans un fichier XSD). La structure de ce document XSD sera lue par WINDEV et permettra de disposer de la complétion automatique sur les noms des noeuds directement dans l'éditeur de code.

Pour déclarer une variable de type xmlNoeud avec un document exemple :

1. Ajoutez le document XML ou XSD dans le projet. 

2. Le document XML ou XSD apparaît dans le navigateur de projet, dans la branche "Descriptions XML". Il est possible de visualiser sa structure.

3. Déclarez la variable de la façon suivante :
	
	```txt
	<Nom de la variable> est un xmlNoeud, description =  <Chemin du noeud dans le document XSD>
	```





Remarque : la syntaxe de déclaration du noeud peut également être obtenue en réalisant un "Drag and Drop" du noeud depuis l'explorateur de projet. 

Vous pouvez maintenant accéder directement aux noeuds fils de la variable par leurs noms. Ces noms sont proposés automatiquement par le mécanisme de complétion automatique de l'éditeur de code.
<a name="NOTE0_2"></a>


### Propriétés spécifiques à la description des variables de type xmlNoeud
<a name="proprietes_specifiques_description_des_variables_type_xmlnoeud_ELTPARAGRAPHE000087"></a>Les propriétés suivantes peuvent être utilisées pour manipuler une variable de type **xmlNoeud** :

| **Nom** | **Type manipulé** | **Effet** |
| --- | --- | --- |
| Attribut | Tableau de [xmlAttribut](../WDLang5/1000018799.md) | Tableau des attributs XML associés au noeud. |
| Existe | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> si le noeud existe, <br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. <br><br><br>Cette propriété est utilisée par exemple pour tester l'existence d'un fils particulier d'un noeud de document.<br>**Cette propriété est disponible en lecture seulement**. |
| Namespace | Variable de type [xmlNamespace](../WDLang5/1000018803.md) | Namespace XML du noeud. |
| NamespaceDéclaré | Tableau de [xmlNamespace](../WDLang5/1000018803.md) | Tableau des namespaces XML déclarés par le noeud. |
| NoeudFils | Tableau de [xmlNoeud](../WDLang5/1000018786.md) | Tableau des noeuds fils. |
| Nom | Chaîne de caractères UNICODE | Nom du noeud.<br><br> |
| Occurrence | Entier | Nombre de noeuds de même niveau et de même nom dans le document XML.<br>**Cette propriété est disponible en lecture seulement**. |
| SourceXML | Chaîne de caractères UNICODE | Fragment de code XML correspondant au noeud. Cette propriété retourne également le code XML des noeuds fils.<br>**Cette propriété est disponible en lecture seulement**. |
| Texte | Chaîne de caractères UNICODE | Texte contenu dans le noeud. |
| Type | Entier | Type de noeud. Les différents types possibles sont :<br><br>- *XMLBalise* (valeur par défaut) : Noeud XML simple pouvant contenir des fils. <br>	Par exemple : <br>	<br><pre><code><NOEUD> <NOEUDFILS> </NOEUDFILS> </NOEUD></code></pre><br><br><br>- *XMLTexte* : Noeud XML contenant du texte. <br>	Par exemple : <br>	<br><pre><code><NOEUD> Texte </NOEUD></code></pre><br><br><br>- *XMLCDATA* : Noeud XML contenant des données qui ne doivent pas être prises en compte par l'analyseur XML.<br>	Par exemple : <br>	<br><pre><code><NOEUD><![CDATA[Ces données ne sont pas <br>		traitées par l'analyseur XML]]> <br>	</NOEUD></code></pre><br><br><br><br><br><br>**Remarques** : <br><br>- Le type ne peut être affecté qu'une seule fois. La propriété est ensuite en lecture seule.<br><br>- Si la propriété **Nom** est affectée, le noeud sera automatiquement de type *XMLBalise*.<br><br>- Si la propriété **Texte** est affectée, le noeud sera automatiquement de type *XMLTexte*.<br><br>- Lors de l'affectation de la propriété **Texte**, tous les noeuds fils de type *XMLTexte*et *XMLCData* sont supprimés.<br><br><br> |





![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Attention : L'ordre d'itération n'est pas nécessairement l'ordre de déclaration des attributs dans le document (généralement les attributs sont listés dans l'ordre alphabétique). 


