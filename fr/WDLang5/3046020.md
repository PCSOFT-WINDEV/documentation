
## iImprimeCodeBarre (Fonction)

***En anglais : iPrintBarCode***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Imprime un code-barres (à l'intérieur d'un rectangle).

**Remarque** : L'impression est envoyée au spooler d'imprimante. Pour imprimer réellement la page, utilisez la fonction [iFinImprime](../WDLang5/3046053.md).




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Impression de codes-barres
// Code-barres de type Interleaved 2 of 5
iImprimeCodeBarre("12345678905", CB_INTER2OF5, 10, 10, 23, 50)
// Code-barres de type UPCA
iImprimeCodeBarre("12345678905+22", CB_UPCA, 10, 10, 23, 50)
```


<a name="Exemple2"></a>

```wl
MonQRCode est un CodeBarres
MonQRCode.Contenu = "http://www.pcsoft.fr"
MonQRCode.TypeContenu = cbTypeTexte
MonQRCode.TypeCodeBarres = CB_QRCODE
iImprimeCodeBarre(MonQRCode, 10, 20, 50, 60)
```


<a name="Exemple3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
```wl
iDestination(iVisualisateur)
MonCode est un CodeBarres
MonCode.Contenu = "1234567"
MonCode.TypeCodeBarres = CB_EAN8
MonCode.Options = CB_Gauche + CB_SansTexte
iCadre(10, 20, 100 ,60)
iImprimeCodeBarre(MonCode, 10, 20, 100, 60)

iFinImprime()
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Imprimer un code-barres

`iImprimeCodeBarre(<Valeur du code-barres> , <Type> , <X1> , <Y1> , <X2> , <Y2> [, <Code étendu>])`
---

**`<Valeur du code-barres> : (Chaîne de caractères)`**

Chaîne de caractères à représenter sous forme de code-barres.

**`<Type> : (Constante de type entier)`**

Type du code-barres à représenter (les différents types de codes-barres gérés par WINDEV sont présentés dans la page [Gestion des codes-barres](../WDLang5/3046064.md)).


|   |   |   |
| --- | --- | --- |
| *CB_AZTEC* | Code-barres de type Aztec. |   |
| *CB_CODE128* | Code-barres de type Code128. |   |
| *CB_CODE39* | Code-barres de type Code39. | Code-barres utilisable avec &lt;Code Étendu&gt; correspondant à *CB_Etendu* ou *CB_Vérification*<br><br>La valeur du code-barres peut contenir les caractères de début et de fin (caractère "\*"). Dans ce cas, ces caractères seront ajoutés dans le dessin du code-barres et imprimés dans le texte sous le code-barres.<br><br>Si ces caractères ne sont pas présents dans la valeur du code-barres, ils seront automatiquement ajoutés dans le dessin du code-barres.<br><br> Par contre, ils n'apparaîtront pas dans le texte affiché sous le code-barres. |
| *CB_CODE93* | Code-barres de type Code93. | Code-barres utilisable avec &lt;Code Étendu&gt; correspondant à *CB_Etendu* ou *CB_Vérification*). |
| *CB_CODE11* | Code-barres de type Code11. | Ce type de code-barres n'est pas disponible. |
| *CB_INTER2OF5* | Code-barres de type Interleaved 2 of 5. | Code-barres utilisable avec &lt;Code Étendu&gt; correspondant à *CB_Vérification*. |
| *CB_CODABAR* | Code-barres de type Codabar. | Code-Barres utilisable avec &lt;Code Étendu&gt; correspondant à *CB_Vérification*. |
| *CB_DATAMATRIX* | Code-barres de type Data Matrix. |   |
| *CB_EAN128* | Code-barres de type EAN-128. | Ce type de code-barres n'est pas disponible. |
| *CB_EAN13* | Code-barres de type EAN-13. | Valeurs possibles du code-barres :<br><br>- 12 caractères,<br><br>- 12 caractères + 2 caractères supplémentaires (exemple "012345678912+22")<br><br>- 12 caractères + 5 caractères supplémentaires (exemple "01234567891+22335")<br><br><br>Un caractère de contrôle est automatiquement inséré après le 12ème caractère. |
| *CB_EAN8* | Code-barres de type EAN-8. | Valeurs possibles du code-barres :<br><br>- 7 caractères,<br><br>- 7 caractères + 2 caractères supplémentaires (exemple "0123456+22")<br><br>- 12 caractères + 5 caractères supplémentaires (exemple "0123456+22335")<br><br><br>Un caractère de contrôle est automatiquement inséré après le 7ème caractère. |
| *CB_GS1_128* | Code-barres de type GS1-128 (nouveau nom du code-barres EAN-128). |   |
| *CB_MAXICODE* | Code-barres de type MaxiCode. |   |
| *CB_MSI* | Code-barres de type MSI. | Ce type de code-barres n'est pas disponible. |
| *CB_PDF417* | Code-barres de type PDF417. |   |
| *CB_UPCA* | Code-barres de type UPC-A. | Valeurs possibles du code-barres :<br><br>- 11 caractères,<br><br>- 11 caractères + 2 caractères supplémentaires (exemple "01234567891+22")<br><br>- 11 caractères + 5 caractères supplémentaires (exemple "01234567891+22335")<br><br><br>Un caractère de contrôle est automatiquement inséré après le 11ème caractère. |
| *CB_UPCE* | Code-barres de type UPC-E. | Valeurs possibles du code-barres :<br><br>- 11 caractères,<br><br>- 11 caractères + 2 caractères supplémentaires (exemple "01234567891+22")<br><br>- 11 caractères + 5 caractères supplémentaires (exemple "01234567891+22335")<br><br><br>Un caractère de contrôle est automatiquement inséré après le 11ème caractère. |



**`<X1> : (Réel)`**

Coordonnée horizontale (colonne ou abscisse) du coin haut gauche du rectangle dans lequel le code-barres va être dessiné (en millimètres). 
Valeur comprise entre 0 et la largeur de la page (donnée par [iLargeurPage](../WDLang5/3046036.md)).

**`<Y1> : (Réel)`**

Coordonnée verticale (ligne ou ordonnée) du coin haut gauche du rectangle dans lequel le code-barres va être dessiné (en millimètres). 
Valeur comprise entre 0 et la hauteur de la page (donnée par [iHauteurPage](../WDLang5/3046052.md)).

**`<X2> : (Réel)`**

Coordonnée horizontale (colonne ou abscisse) du coin bas droit du rectangle dans lequel le code-barres va être dessiné (en millimètres). 
Valeur comprise entre 0 et la largeur de la page (donnée par [iLargeurPage](../WDLang5/3046036.md)).

**`<Y2> : (Réel)`**

Coordonnée verticale (ligne ou ordonnée) du coin bas droit du rectangle dans lequel le code-barres va être dessiné (en millimètres). 
Valeur comprise entre 0 et la hauteur de la page (donnée par [iHauteurPage](../WDLang5/3046052.md)).

**`<Code étendu> : (Constante (ou combinaison de constantes) optionnelle de type entier)`**

Caractéristiques du code-barres.


|   |   |
| --- | --- |
| *CB_90* | Imprime le code-barres verticalement.<br><br>Codes-barres concernés : tous |
| *CB_180* | Imprime le code-barres en faisant une rotation à 180 degrés.<br><br>Codes-barres concernés : tous |
| *CB_270* | Imprime le code-barres en faisant une rotation à 270 degrés.<br><br>Codes-barres concernés : tous |
| *CB_Bas* | Code-barres positionné en bas du rectangle destination.<br><br>Codes-barres concernés : tous |
| *CB_CaractèreControle* | Code-barres contenant des caractères de contrôle. Par défaut, les caractères de contrôle sont encadrés par les caractères "&lt;" et "&gt;". Pour ne pas interpréter ces caractères comme caractères de contrôle, il suffit de doubler le premier "&lt;" :  <br><br>- "&lt;C40&gt;" = caractère de contrôle   <br><br>- "&lt;&lt;AB&gt;" = chaîne &lt;AB&gt; à encoder dans le code-barres.<br><br><br>Pour plus de détails sur les caractères acceptés, consultez [Les différents types de codes-barres](../WDLang5/3046064.md).<br><br>Codes-barres concernés : codes-barres de type *CB_CODE128*, *CB_DATAMATRIX*, *CB_EAN128*, *CB_GS1_128*, *CB_PDF417*. |
| *CB_CaractèreVérification* | Code-barres contenant des caractères de vérification.<br>Si cette option est sélectionnée, les constantes *CB_CaractèreControle* et *CB_JeuxCaractères* sont automatiquement prises en compte.<br><br>Codes-barres concernés : codes-barres de type *CB_CODE128*, *CB_DATAMATRIX*, *CB_EAN128*, *CB_GS1_128*, *CB_PDF417*. |
| *CB_CentreH* | Centrage horizontal du code-barres dans le rectangle destination.<br><br>Codes-barres concernés : tous |
| *CB_CentreV* | Centrage vertical du code-barres dans le rectangle destination.<br><br>Codes-barres concernés : tous |
| *CB_Droite* | Code-barres aligné à droite dans le rectangle destination.<br><br>Codes-barres concernés : tous |
| *CB_Etendu* | Code-barres étendu.<br><br>Codes-barres concernés : codes-barres de type *CB_CODE39* et *CB_CODE93*. |
| *CB_FormateTexte* | Formate le texte affiché : des parenthèses sont ajoutées autour des AIs dans le texte imprimé.<br><br>Codes-barres concernés : codes-barres de type *EAN 128* ou *GS1-128*. |
| *CB_Gauche* | Code-barres aligné à gauche dans le rectangle destination.<br><br>Codes-barres concernés : tous |
| *CB_Haut* | Code-barres positionné en haut du rectangle destination.<br><br>Codes-barres concernés : tous |
| *CB_IgnoreFormatage* | Ignore les parenthèses d'un code 128, EAN-128 ou GS1-128.<br>Les parenthèses sont utilisées pour rendre le code-barres plus lisible par un humain, mais ne sont pas dessinées dans le code.<br><br>Codes-barres concernés : codes-barres de type *CB_CODE128*, *CB_EAN128* et *CB_GS1_128*. |
| *CB_JeuxCaractères* | Code-barres utilisant un ou plusieurs jeux de caractères utilisés pour la compression du code-barres. Ce jeu de caractères doit être défini dans la valeur du code-barres.<br>Pour plus de détails sur les jeux de caractères, consultez [Les différents types de codes-barres](../WDLang5/3046064.md).<br><br>Codes-barres concernés : tous |
| *CB_NonProportionnel* | Ajuste le code-barres à la taille du rectangle destination.<br><br>Codes-barres concernés : tous |
| *CB_SansTexte* | N'affiche pas le texte sous le code-barres.<br><br>Codes-barres concernés :  codes-barres de type *CB_UPCA*, *CB_UPCB*, *CB_EAN13* et *CB_EAN8*. |
| *CB_Texte* | Affiche le texte sous le code-barres. <br>Le texte est normalisé pour les codes-barres de type *CB_UPCA*, *CB_UPCE*, *CB_EAN13* et *CB_EAN8*.<br>Pour les autres types de codes-barres, le texte peut dépasser du cadre d'affichage du code-barres.<br><br>Codes-barres concernés : tous |
| *CB_TexteCentre* | Centre le texte sous le code-barres. <br><br>Codes-barres concernés : codes-barres de type *CB_CODE128*, *CB_CODE93*, *CB_CODE11*, *CB_EAN128*, *CB_CODE39*, *CB_INTER2OF5*, *CB_CODABAR*, *CB_MSI*. <br><br> |
| *CB_TexteDroite* | Aligne à droite le texte sous le code-barres.  <br><br>Codes-barres concernés : codes-barres de type *CB_CODE128*, *CB_CODE93*, *CB_CODE11*, *CB_EAN128*, *CB_CODE39*, *CB_INTER2OF5*, *CB_CODABAR*, *CB_MSI*. <br><br> |
| *CB_TexteGauche* | Aligne à gauche le texte sous le code-barres. <br><br>Codes-barres concernés : codes-barres de type *CB_CODE128*, *CB_CODE93*, *CB_CODE11*, *CB_EAN128*, *CB_CODE39*, *CB_INTER2OF5*, *CB_CODABAR*, *CB_MSI*. <br><br> |
| *CB_Vérification* | Code-barres avec caractères de vérification.<br><br>Codes-barres concernés : codes-barres de type *CB_CODE39*, *CB_CODE93*, *CB_INTER2OF5* et *CB_CODABAR*. |
| *CB_Vertical* | Imprime le code-barres verticalement.<br><br>Codes-barres concernés : tous |




<a name="SYNTAXE2"></a>

### Imprimer un code-barres (variable de type CodeBarres)

`iImprimeCodeBarre(<Code-barres> , <X1> , <Y1> , <X2> , <Y2>)`
---

**`<Code-barres> : (Variable de type CodeBarres)`**

Nom de la variable de type [CodeBarres](../WDLang5/1000019451.md) contenant la description du code-barres à imprimer. 

**`<X1> : (Réel)`**

Coordonnée horizontale (colonne ou abscisse) du coin haut gauche du rectangle dans lequel le code-barres va être dessiné (en millimètres). 
Valeur comprise entre 0 et la largeur de la page (donnée par [iLargeurPage](../WDLang5/3046036.md)).

**`<Y1> : (Réel)`**

Coordonnée verticale (ligne ou ordonnée) du coin haut gauche du rectangle dans lequel le code-barres va être dessiné (en millimètres). 
Valeur comprise entre 0 et la hauteur de la page (donnée par [iHauteurPage](../WDLang5/3046052.md)).

**`<X2> : (Réel)`**

Coordonnée horizontale (colonne ou abscisse) du coin bas droit du rectangle dans lequel le code-barres va être dessiné (en millimètres). 
Valeur comprise entre 0 et la largeur de la page (donnée par [iLargeurPage](../WDLang5/3046036.md)).

**`<Y2> : (Réel)`**

Coordonnée verticale (ligne ou ordonnée) du coin bas droit du rectangle dans lequel le code-barres va être dessiné (en millimètres). 
Valeur comprise entre 0 et la hauteur de la page (donnée par [iHauteurPage](../WDLang5/3046052.md)).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Codes-barres UPC et EAN : Taille des codes-barres
<a name="codesbarres_upc_ean_taille_des_codesbarres_ELTPARAGRAPHE000472"></a>La norme des codes UPC et EAN fixe les proportions hauteur/largeur des codes-barres. Par défaut, les dessins de ces codes-barres respectent cette norme. Il est toutefois possible de dessiner des codes-barres "non conformes" en utilisant la constante *CB_NonProportionnel*.

**Remarque** : L'espace donné pour dessiner le code-barres peut ne pas être occupé à 100%. En effet, la taille de chaque barre est calculée afin d'obtenir un code-barres toujours lisible.


<a name="NOTE0_2"></a>




### Taille des codes-barres
<a name="taille_des_codesbarres_ELTPARAGRAPHE000483"></a>La largeur effective du dessin d'un code-barres peut-être inférieure à la largeur spécifiée.

En effet, la largeur de chaque barre composant un code-barres est calculée à partir de la largeur de la barre la plus étroite du code-barres. La largeur de chaque barre doit être un nombre entier de pixels.

Exemple de calcul de la largeur du code-barres :

- La largeur du dessin doit être de 130 pixels.

- Le dessin contient 10 barres étroites de largeur 1 et 5 barres larges de largeur 2.

- Calcul de la largeur d'une barre étroite = 110 / (10 + 5\*2) = 5 pixels

- Calcul de la largeur totale du dessin = 5 \* (10 +5\*2) = 100 pixels




Avec l'utilisation de la constante *CB_CentreH*, le dessin commencera donc à (110-100) /2 = 5 pixels du bord gauche et se terminera à 5 pixels du bord droit.


<a name="NOTE0_3"></a>




### Impression d'un code-barres de type DataMatrix ou PDF417
<a name="impression_codebarres_type_datamatrix_pdf417_ELTPARAGRAPHE000503"></a>Lors de l'impression d'un code-barres DataMatrix ou PDF417 avec la fonction **iImprimeCodeBarre**, les options suivantes sont prises en compte :

Data Matrix

- Taille de la matrice calculée en fonction de la taille de la chaîne et optimisée pour obtenir une matrice carrée.

- Jeu de caractères : WINDEV optimise le choix des jeux de caractères afin d'écrire le code-barres le plus petit possible.




PDF417

- Taille de la matrice calculée en fonction de la chaîne

- Niveau de correction calculé selon la longueur (après compression) des données à encoder :

	- de 1 à 40 caractères : niveau 2

	- de 41 à 160 caractères : niveau 3

	- de 161 à 320 caractères : niveau 4

	- à partir de 321 caractères : niveau 5 




- Hauteur de ligne : 4

- Jeu de caractères : WINDEV optimise le choix des jeux de caractères afin d'écrire le code-barres le plus petit possible.




Pour plus de détails sur les jeux de caractères pris en compte et les caractères de contrôle, consultez [Les différents types de codes-barres](../WDLang5/3046064.md).



<a name="XComposante"></a>

## Composante :
wd280prn.dll
