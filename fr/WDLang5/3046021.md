


## iInitRequêteEtat (Fonction)

***En anglais : iInitReportQuery***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Initialise la requête liée à l'état (cas d'une requête paramétrée). Cette fonction peut être appelée :

- soit dans l'événement "Initialisation" de l'état,

- soit avant la fonction [iImprimeEtat](../WDLang5/3046032.md).




**Remarques** :

- Si l'état est lié à une requête non paramétrée, utilisez directement la fonction [iImprimeEtat](../WDLang5/3046032.md).

- Si l'état est lié à une requête (paramétrée ou non) utilisant une connexion spécifique (connexion à une base de données par un provider OLE DB par exemple), utilisez la fonction [iInitRequêteEtatConnexion](../WDLang5/3046028.md).

- Si l'état est inclus dans un état composite, la fonction **iInitRequêteEtat** doit obligatoirement être appelée dans l'événement "Initialisation" de l'état. 


![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) **Attention** : L'utilisation de cette fonction sous Linux nécessite une configuration spécifique. Pour plus de détails, consultez [Imprimer sous Linux](../Editeurs/9000078.md). 

|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | Si la requête est créée avec le logiciel Etats & Requêtes, il n'est pas nécessaire d'utiliser la fonction **iInitRequêteEtat** pour spécifier les paramètres de la requête. En effet, si l'état sur une requête paramétrée est exécuté depuis le logiciel Etats & Requêtes, une fenêtre s'affiche permettant de saisir les paramètres de la requête. |




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003046021&name=iinitrequeteetat_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
iInitRequêteEtat(ETAT_BulletinScolaire, "Dupond", "2020")
iImprimeEtat(ETAT_BulletinScolaire)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`iInitRequêteEtat(<Etat manipulé> [, <Paramètre 1 de la requête> [... [, <Paramètre N de la requête>]]])`
---

**`<Etat manipulé> : (Nom d'un état)`**

Nom logique de l'état à imprimer.

**`<Paramètre 1 de la requête> : (Type du paramètre de la requête (optionnel))`**

Premier paramètre de la requête définie comme source de l'état (si la requête attend un paramètre).





**`<Paramètre N de la requête> : (Type du paramètre de la requête (optionnel))`**

Dernier paramètre de la requête définie comme source de l'état (si la requête attend un paramètre).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Champ Etat Interne : état basé sur une requête paramétrée
<a name="champ_etat_interne_etat_base_sur_une_requete_parametree_ELTPARAGRAPHE000123"></a>Si l'état associé à un champ de type "Etat interne" est basé sur une requête paramétrée, utilisez la fonction **iInitRequêteEtat** pour passer les paramètres à la requête. Cette fonction doit être utilisée dans l'événement "Avant impression" du bloc contenant le champ "Etat Interne".

Pour plus de détails sur les "Etats Interne", consultez [Champs de type Etat Interne](../WDChamp/1013044.md).
<a name="NOTE0_2"></a>


### Exécution d'une requête et état basé sur cette requête
<a name="execution_une_requete_etat_base_sur_cette_requete_ELTPARAGRAPHE000140"></a>Lors de l'impression d'un état basé sur une requête, si la requête a déjà été exécutée, elle n'est pas ré-exécutée. Pour forcer la ré-exécution de la requête (ajout d'enregistrements par exemple), il suffit d'utiliser les fonctions [HExécuteRequête](../WDLang4/3044080.md) ou **iInitRequêteEtat**.
<a name="NOTE0_3"></a>


### Libération de la requête
<a name="liberation_requete_ELTPARAGRAPHE000155"></a>Lors de l'impression d'un état basé sur une requête initialisée avec la fonction **iInitRequêteEtat**, la requête est libérée à la fin de l'impression de l'état (comportement identique à l'appel de la fonction [HAnnuleDéclaration](../WDLang4/3044174.md)).
<a name="NOTE0_4"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000170"></a>

- Si certains paramètres attendus par la requête ne sont pas précisés (valeur correspondant à NULL par exemple), les conditions de sélection correspondant à ces paramètres seront ignorées.

- Si le nombre de paramètres précisés dans la fonction **iInitRequêteEtat** est supérieur au nombre de paramètres attendus par la requête, les paramètres supplémentaires sont ignorés.




<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280etat.dll
