
## iImprimeZoneRTF (Fonction)

***En anglais : iPrintAreaRTF***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Imprime un texte au format RTF dans une zone rectangulaire. L'impression n'est pas lancée (seule la fonction [iFinImprime](../WDLang5/3046053.md) permet de lancer l'impression).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003046023&name=iimprimezonertf_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
iImprimeZoneRTF(TexteRTF, 0, 0, dHauteur, 200)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = iImprimeZoneRTF(<Texte RTF> , <X1> , <Y1> , <X2> , <Y2> [, <Début> [, <Fin>]])`
---

**`<Résultat> : (Entier)`**

Indice du dernier élément RTF imprimé dans la zone rectangulaire (comptage spécifique de WINDEV/WEBDEV). 

**`<Texte RTF> : (Chaîne de caractères)`**

Chaîne de caractères au format RTF à imprimer dans une zone spécifique.

**`<X1> : (Réel)`**

Coordonnée horizontale (colonne ou abscisse) du coin haut gauche de la zone d'impression (en millimètres). 
Valeur comprise entre 0 et la largeur de la page (donnée par [iLargeurPage](../WDLang5/3046036.md)).

**`<Y1> : (Réel)`**

Coordonnée verticale (ligne ou ordonnée) du coin haut gauche de la zone d'impression (en millimètres). 
Valeur comprise entre 0 et la hauteur de la page (donnée par [iHauteurPage](../WDLang5/3046052.md)).

**`<X2> : (Réel)`**

Coordonnée horizontale (colonne ou abscisse) du coin bas droit de la zone d'impression (en millimètres). 
Valeur comprise entre 0 et la largeur de la page (donnée par [iLargeurPage](../WDLang5/3046036.md)).

**`<Y2> : (Réel)`**

Coordonnée verticale (ligne ou ordonnée) du coin bas droit de la zone d'impression (en millimètres). 
Valeur comprise entre 0 et la hauteur de la page (donnée par [iHauteurPage](../WDLang5/3046052.md)).

**`<Début> : (Entier optionnel)`**

Indice du premier caractère du &lt;Texte RTF&gt; à imprimer. Si ce paramètre n'est pas indiqué, le &lt;Texte RTF&gt; est imprimé depuis le premier caractère.

**`<Fin> : (Entier optionnel)`**

Indice du dernier caractère du &lt;Texte RTF&gt; à imprimer. Si ce paramètre n'est pas indiqué, le &lt;Texte RTF&gt; est imprimé jusqu'au dernier caractère.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Imprimer un texte RTF justifié
<a name="imprimer_texte_rtf_justifie_ELTPARAGRAPHE000070"></a>Pour imprimer un texte en conservant sa justification avec la fonction **iImprimeZoneRTF**, il est nécessaire d'utiliser préalablement la fonction [iParamètre](../WDLang5/3046008.md) de la façon suivante :


```wl
iParamètre("JustificationRTF=Oui")
```


Si les paramètres permettant de découper le texte RTF sont utilisés (paramètres &lt;Début&gt; et &lt;Fin&gt;), la justification du texte sera conservée.


<a name="NOTE0_2"></a>




### Imprimer un texte RTF contenant des sauts de page
<a name="imprimer_texte_rtf_contenant_des_sauts_page_ELTPARAGRAPHE000089"></a>Le code suivant permet d'imprimer un texte RTF contenant des sauts de page en impression programmée :


```wl
// Affiche le visualisateur de rapports
iDestination(iVisualisateur)
// Conversion du texte
sTexte est une chaîne = RTFVersTexte(SAI_SaisieTexte)
// Taille du texte
nTailleTexte est un entier = Taille(sTexte)
// Suppression du nombre de sauts de page à la taille du texte
nTailleTexte -= ChaîneOccurrence(sTexte, Caract(12))
// Le RC doit correspondre à un seul caractères
nTailleTexte -= ChaîneOccurrence(sTexte, Caract(13))

// Boucle sur toutes les pages
nDébut est un entier
nTaille est un entier = -1
BOUCLE
	// Imprime la page
	nDébut = nTaille + 1
	nTaille = iImprimeZoneRTF(SAI_SaisieTexte, 0, 0, iLargeurPage(), iHauteurPage(), nDébut, -1)
	// Saute la page si il reste des pages
	SI nTaille < nTailleTexte ET nTaille > nDébut ALORS 
		iSautePage()
	FIN
A FAIRE TANTQUE nTaille < nTailleTexte ET nTaille > nDébut 
// Fin de l'impression
iFinImprime()
```



<a name="NOTE0_3"></a>




### Imprimer un texte RTF 
<a name="imprimer_texte_rtf_ELTPARAGRAPHE000100"></a>Pour que la fonction **iImprimeZoneRTF** fonctionne, le fichier "RICHED20.DLL" doit être présent sur le poste en cours.

Le fichier "RICHED20.DLL" est généralement présent dans le répertoire système de Windows.



<a name="XComposante"></a>

## Composante :
wd280prn.dll
