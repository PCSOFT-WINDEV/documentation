


## iDestination (Fonction)

***En anglais : iDestination***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Paramètre et renvoie la destination de l'impression.

Il est possible d'imprimer :

- **directement sur l'imprimante** ([syntaxe 1](#SYNTAXE1) et [syntaxe 2](#SYNTAXE2)). 
	

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) dans une [mini-fenêtre d'aperçu](../WDChamp/1011094.md) ([syntaxe 1](#SYNTAXE1)).

- **directement dans un fichier** texte, HTM, RTF, PDF, PRN ou XML ([syntaxe 3](#SYNTAXE3)).
	
	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Dans cette version, l'impression se fait uniquement dans un fichier PDF.

- **directement un duplicata** ([syntaxe 4](#SYNTAXE4)).

- **directement sur un fax** ([syntaxe 5](#SYNTAXE5) et [syntaxe 6](#SYNTAXE6), envoi d'un état vers un numéro de fax par exemple). Pour plus de détails sur la gestion des fax, consultez [Envoyer des fax](../WDLang3/3037002.md). 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) dans le visualisateur de rapports ([syntaxe 7](#SYNTAXE7)). L'utilisateur peut ainsi visualiser le résultat de l'impression à l'écran, page par page. Dans ce visualisateur, il est possible de :

	- faire défiler les pages (page suivante et page précédente si elles existent),

	- lancer l'impression,

	- modifier l'échelle de l'aperçu,

	- afficher la première ou la dernière page,

	- connaître le numéro de la page en cours, ...







![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Seules les impressions au format PDF sont disponibles.![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Remarque : La fonction **iDestination** permet également de connaître le type d'impression effectuée (utilisation dans le code d'ouverture de l'état ou dans le code "Avant réimpression" de l'état). Pour plus de détails, consultez la [syntaxe 8](#SYNTAXE8).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Impression au format HTML
iDestination(iHTML, "C:\Mes documents\MonEtat.HTM")
// "C:\Mes documents\MonEtat.HTM" correspond au nom et
// au chemin du fichier HTM qui sera créé avec l'état "ETAT_MonEtatRécap"
iImprimeEtat(ETAT_MonEtatRécap)
```


<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Impression au format PDF
NomFichier est une chaîne = ComplèteRep(fRepDonnées()) + "f" + Facture + Client + ".PDF"
iDestination(iPDFGénérique, NomFichier)
iImprimeEtat(ETAT_Facture, Client, Facture)
// Teste si on est sur un site WEBDEV
SI EnModeWeb() = Vrai ALORS
	// Impression effectuée depuis un site WEBDEV
	// Envoi du fichier à l'internaute
	FichierAffiche(NomFichier, "application/pdf")
	Multitâche(0)
	// Suppression du fichier sur le serveur
	fSupprime(NomFichier)
FIN
```


<a name="Exemple3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Imprimante PCL à utiliser
iDestination(iPCL, "\\MonRéseau\MonImprimante")
// Impression au format PCL : iDestination(iPCL, "\Mes documents\MonFichier.PCL")
```


<a name="Exemple4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Génération d'un fichier PRN 
iDestination(iFichierImprimante, "C:\Temp\Monimpression.prn")
```


<a name="Exemple5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Génération d'un fichier PDF et ouverture du logiciel de messagerie par défaut
iDestination(iEmailPDF, "MaPieceJointe.PDF")

// Configuration du logiciel de mail (optionnel)
iParamètreExport(iExportEmailDestinataire, "Wam@CrazyMail.com; Celia.Wat@ZMail.fr")
iParamètreExport(iExportEmailExpéditeur, "Cemoy@Berrymail.com")
iParamètreExport(iExportEmailSujet, "Résultat des ventes de l'année")
iImprimeEtat(ETAT_MonEtat)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Imprimer directement sur l'imprimante ou dans un mini-aperçu

`iDestination([<Destination> [, <Nom du document>]])`
---

**`<Destination> : (Constante optionnelle de type entier)`**

Destination de l'impression.


|   |   |
| --- | --- |
| *iImprimante* | Impression directe sur l'imprimante. <br><br> |
| *iMiniAperçu* | Impression dans un mini-aperçu. Ce mini-aperçu permet de visualiser les différentes pages à imprimer et de définir les options d'impression. Il est également possible de réaliser des exports. <br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |



**`<Nom du document> : (Chaîne de caractères optionnelle)`**



- Si l'impression est directe (constante *iImprimante*), correspond au nom à donner à l'impression. Ce nom permettra d'identifier l'impression dans la liste des documents traités par l'imprimante.

- Si l'impression est réalisée dans un mini-aperçu (constante *iMiniAperçu*), correspond au titre de la fenêtre du mini-aperçu.
	Si ce paramètre n'est pas précisé, le titre par défaut correspondra à "Prévisualisation de l'état " suivi du nom de l'état. 
	Si l'utilisateur a la possibilité de générer des fichiers (Word, PDF, ...) depuis le mini-aperçu avant impression, le titre de l'aperçu sera automatiquement proposé comme nom de fichier. Si ce paramètre n'est pas précisé, le nom du fichier correspondra au nom de l'état.





<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Imprimer directement sur une imprimante PCL

`iDestination(<iPCL> , <Imprimante à utiliser>)`
---

**`<iPCL> : (Constante)`**

*iPCL* : Constante permettant d'imprimer directement sur une imprimante PCL.

Attention : il n'est pas possible d'imprimer en mode paysage sur une imprimante PCL.

**`<Imprimante à utiliser> : (Chaîne de caractères)`**

Chemin et nom de l'imprimante PCL utilisée. Cette imprimante doit être accessible.

**Si cette imprimante est accessible via Bluetooth**, ce paramètre doit correspondre à la chaîne "&lt;Nom du port virtuel de sortie de Bluetooth&gt;:".
Si plusieurs imprimantes utilisent la technologie Bluetooth, lors de l'impression, une fenêtre permet à l'utilisateur de sélectionner l'imprimante à utiliser. 

**Si cette imprimante est accessible par Wi-Fi ou par réseau**, ce paramètre doit correspondre au nom et au chemin UNC de l'imprimante.


<a name="SYNTAXE3"></a>

### Imprimer dans un fichier (HTM, PCL, PDF, PRN, RTF, XLS, XML, ...)

`iDestination([<Type du fichier destination> [, <Nom du fichier à créer>]])`
---

**`<Type du fichier destination> : (Constante optionnelle de type entier)`**

Permet de paramétrer le type de fichier à créer :


|   |   |
| --- | --- |
| *iEmailPDF* | Impression directe dans un fichier PDF et ouverture du logiciel de messagerie du poste en cours. <br>Ce fichier PDF est directement joint à un nouveau email créé en utilisant le client MAPI installé par un logiciel de messagerie du poste en cours. Le client MAPI doit être installé dans le même mode de compilation (32/64 bits) que l'application.<br>Le fichier a pour nom &lt;Nom de l'état&gt;.PDF (où &lt;Nom de l'état&gt; correspond au nom de l'état défini sous l'éditeur d'états). Ce fichier est créé dans le répertoire de l'application. Si le paramètre &lt;Nom du fichier à créer&gt; est précisé, le nom du fichier sera &lt;Nom du fichier à créer&gt;.PDF. <br>Remarque : Il est possible de paramétrer les éléments de l'email créé avec la fonction [iParamètreExport](../WDLang5/1000017026.md).  <br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *iFichier* | Impression directe dans un fichier texte. Le fichier a pour nom &lt;Nom de l'état&gt;.TXT (où &lt;Nom de l'état&gt; correspond au nom de l'état défini sous l'éditeur d'états). Ce fichier est créé dans le répertoire de l'application. Si le paramètre &lt;Nom du fichier à créer&gt; est précisé, le nom du fichier sera &lt;Nom du fichier à créer&gt;.TXT. <br>**Attention** : le paramétrage de l'imprimante est important. Consultez [les remarques](#NOTE0_5).<br><br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *iFichierGénérique* | Impression directe dans un fichier texte. Le fichier a pour nom &lt;Nom de l'état&gt;.TXT (où &lt;Nom de l'état&gt; correspond au nom de l'état défini sous l'éditeur d'états). Ce fichier est créé dans le répertoire de l'application. Si le paramètre &lt;Nom du fichier à créer&gt; est précisé, le nom du fichier sera &lt;Nom du fichier à créer&gt;.TXT.<br>**Ce mode d'impression n'utilise pas le driver d'imprimante courant ce qui garantit un résultat identique d'un poste à l'autre.**<br><br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *iFichierImprimante* | Impression directe dans un fichier PRN (fichier &lt;Nom du fichier à créer&gt;). Le paramètre &lt;Nom du fichier à créer&gt; doit contenir le nom complet du fichier PRN. <br>**Attention** : le paramétrage de l'imprimante est important. Consultez [les remarques](#NOTE0_6).<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *iHTML* | Impression directe dans un fichier HTML avec utilisation de feuille de styles. Le fichier a pour nom &lt;Nom de l'état&gt;.HTM (où &lt;Nom de l'état&gt; correspond au nom de l'état défini sous l'éditeur d'états). Ce fichier est créé dans le répertoire de l'application. <br>** Ce mode d'impression doit être utilisé pour gérer les superpositions dans les pages HTML.**<br>Si le paramètre &lt;Nom du fichier à créer&gt; est précisé, le nom du fichier sera &lt;Nom du fichier à créer&gt;.HTM. Aucun aperçu ne sera affiché.<br>**Attention** : le paramétrage de l'imprimante est important. Consultez [les remarques](#NOTE0_5).<br><br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *iHTMLGénérique* | Impression directe dans un fichier HTML avec utilisation d'une feuille de styles. Le fichier a pour nom &lt;Nom de l'état&gt;.HTM (où &lt;Nom de l'état&gt; correspond au nom de l'état défini sous l'éditeur d'états). Ce fichier est créé dans le répertoire de l'application.<br>**Ce mode d'impression doit être utilisé pour gérer les superpositions dans les pages HTML**.<br>Si le paramètre &lt;Nom du fichier à créer&gt; est précisé, le nom du fichier sera &lt;Nom du fichier à créer&gt;.HTM. Aucun aperçu ne sera affiché.<br>**Ce mode d'impression n'utilise pas le driver d'imprimante courant ce qui garantit un résultat identique d'un poste à l'autre**.<br><br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *iHTMLGénériqueSansCSS* | Impression directe dans un fichier HTML sans utilisation d'une feuille de styles. Le fichier a pour nom &lt;Nom de l'état&gt;.HTM (où &lt;Nom de l'état&gt; correspond au nom de l'état défini sous l'éditeur d'états). Ce fichier est créé dans le répertoire de l'application. <br> **Ce mode d'impression ne gère pas les superpositions dans les pages HTML**.<br>Si le paramètre &lt;Nom du fichier à créer&gt; est précisé, le nom du fichier sera &lt;Nom du fichier à créer&gt;.HTM. Aucun aperçu ne sera affiché. <br>**Ce mode d'impression n'utilise pas le driver d'imprimante courant ce qui garantit un résultat identique d'un poste à l'autre**.<br><br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *iHTMLSansCSS* | Impression directe dans un fichier HTML sans utilisation d'une feuille de styles. Le fichier a pour nom &lt;Nom de l'état&gt;.HTM (où &lt;Nom de l'état&gt; correspond au nom de l'état défini sous l'éditeur d'états). Ce fichier est créé dans le répertoire de l'application.<br>**Ce mode d'impression ne gère pas les superpositions dans les pages HTML**.<br>Si le paramètre &lt;Nom du fichier à créer&gt; est précisé, le nom du fichier sera &lt;Nom du fichier à créer&gt;.HTM. Aucun aperçu ne sera affiché. <br>**Attention** : le paramétrage de l'imprimante est important. Consultez [les remarques](#NOTE0_2).<br><br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *iPCL* | Impression directe dans un fichier **PCL** (fichier &lt;Nom de l'état&gt;.PCL créé dans le répertoire de l'application).<br> Si le paramètre &lt;Nom du fichier à créer&gt; est précisé, le nom du fichier sera &lt;Nom du fichier à créer&gt;.PCL.<br><br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *iPDF* | Impression directe dans un fichier **PDF**. Le fichier a pour nom &lt;Nom de l'état&gt;.PDF (où &lt;Nom de l'état&gt; correspond au nom de l'état défini sous l'éditeur d'états). Ce fichier est créé dans le répertoire de l'application. <br>Si le paramètre &lt;Nom du fichier à créer&gt; est précisé, le nom du fichier sera &lt;Nom du fichier à créer&gt;.PDF.<br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible.<br><br><br>	<B><B><B><B>Avertissement</B></B></B></B><br><br>	A partir de la version <B><B><B><B>27</B></B></B></B>,  cette constante est conservée par compatibilité. Il est conseillé d'utiliser la constante **iPDFGénérique** qui permet une génération optimisée du fichier PDF.<br>
 |
| *iPDFGénérique* | Impression directe dans un fichier **PDF**. Le fichier a pour nom &lt;Nom de l'état&gt;.PDF (où &lt;Nom de l'état&gt; correspond au nom de l'état défini sous l'éditeur d'états). Ce fichier est créé dans le répertoire de l'application. <br>Si le paramètre &lt;Nom du fichier à créer&gt; est précisé, le nom du fichier sera &lt;Nom du fichier à créer&gt;.PDF.<br>**Attention** : Il n'est pas possible d'utiliser un format supérieur au format A4.<br>**Ce mode d'impression n'utilise pas le driver d'imprimante courant ce qui garantit un résultat identique d'un poste à l'autre**.<br><br><br><br><br><br> |
| *iRTF* | Impression directe dans un fichier **RTF**. Le fichier a pour nom &lt;Nom de l'état&gt;.RTF (où &lt;Nom de l'état&gt; correspond au nom de l'état défini sous l'éditeur d'états). Ce fichier est créé dans le répertoire de l'application. <br>Si le paramètre &lt;Nom du fichier à créer&gt; est précisé, le nom du fichier sera &lt;Nom du fichier à créer&gt;.RTF. Aucun aperçu ne sera affiché.<br>**Attention** : le paramétrage de l'imprimante est important. Consultez [les remarques](#NOTE0_4).<br><br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *iRTFGénérique* | Impression directe dans un fichier **RTF**. Le fichier a pour nom &lt;Nom de l'état&gt;.RTF (où &lt;Nom de l'état&gt; correspond au nom de l'état défini sous l'éditeur d'états). Ce fichier est créé dans le répertoire de l'application. <br>Si le paramètre &lt;Nom du fichier à créer&gt; est précisé, le nom du fichier sera &lt;Nom du fichier à créer&gt;.RTF. Aucun aperçu ne sera affiché. <br>**Ce mode d'impression n'utilise pas le driver d'imprimante courant ce qui garantit un résultat identique d'un poste à l'autre**.<br><br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *iXLS* | Impression directe dans un fichier XLS. Le fichier a pour nom &lt;Nom de l'état&gt;.XLS (où &lt;Nom de l'état&gt; correspond au nom de l'état défini sous l'éditeur d'états). Ce fichier est créé dans le répertoire de l'application. <br>Si le paramètre &lt;Nom du fichier à créer&gt; est précisé, le nom du fichier sera &lt;Nom du fichier à créer&gt;.XLS. Aucun aperçu ne sera affiché.<br><br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *iXLSGénérique* | Impression directe dans un fichier XLS. Le fichier a pour nom &lt;Nom de l'état&gt;.XLS (où &lt;Nom de l'état&gt; correspond au nom de l'état défini sous l'éditeur d'états). Ce fichier est créé dans le répertoire de l'application. <br>Si le paramètre &lt;Nom du fichier à créer&gt; est précisé, le nom du fichier sera &lt;Nom du fichier à créer&gt;.XLS. Aucun aperçu ne sera affiché.<br>**Ce mode d'impression n'utilise pas le driver d'imprimante courant ce qui garanti un résultat identique d'un poste à l'autre**.<br><br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *iXML* | Impression directe dans un fichier XML. Le fichier a pour nom &lt;Nom de l'état&gt;.XML (où &lt;Nom de l'état&gt; correspond au nom de l'état défini sous l'éditeur d'états). Ce fichier est créé dans le répertoire de l'application. <br>Si le paramètre &lt;Nom du fichier à créer&gt; est précisé, le nom du fichier sera &lt;Nom du fichier à créer&gt;.XML. Aucun aperçu ne sera affiché.<br><br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *iXMLGénérique* | Impression directe dans un fichier XML. Le fichier a pour nom &lt;Nom de l'état&gt;.XML (où &lt;Nom de l'état&gt; correspond au nom de l'état défini sous l'éditeur d'états). Ce fichier est créé dans le répertoire de l'application. <br>Si le paramètre &lt;Nom du fichier à créer&gt; est précisé, le nom du fichier sera &lt;Nom du fichier à créer&gt;.XML. Aucun aperçu ne sera affiché.<br>**Ce mode d'impression n'utilise pas le driver d'imprimante courant ce qui garantit un résultat identique d'un poste à l'autre**.<br><br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |



**`<Nom du fichier à créer> : (Chaîne de caractères optionnelle)`**

Nom du fichier généré. Si ce paramètre n'est pas précisé, le nom du fichier généré correspond au "Nom de l'état". Dans le cas d'une impression au format PRN (avec la constante *iFichierImprimante*), le nom complet du fichier à créer doit être spécifié.  


<a name="SYNTAXE4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Imprimer un duplicata

`iDestination(<Type destination> [, <Nom du fichier à créer> [, <Certificat> [, <Mot de passe>]]])`
---

**`<Type destination> : (Constante de type entier)`**

Permet de paramétrer le type de fichier à créer :


|   |   |
| --- | --- |
| *iDuplicata* | Impression directe dans un fichier duplicata. Le fichier a pour nom &lt;Nom de l'état&gt;.DPL (où &lt;Nom de l'état&gt; correspond au nom de l'état défini sous l'éditeur d'états). Ce fichier est créé dans le répertoire de l'application.<br><br>**Attention** : Cette constante permet d'imprimer uniquement un duplicata et non de réaliser une impression. <br>**Pour réaliser un duplicata d'une impression**, il est conseillé d'utiliser la fonction [iParamètreDuplicata](../WDLang5/1000018845.md) puis la fonction **iDestination** pour imprimer sur l'imprimante.<br><br> |



**`<Nom du fichier à créer> : (Chaîne de caractères optionnelle)`**

Nom du fichier duplicata à créer (sans l'extension). Le fichier créé sera &lt;Nom du fichier à créer&gt;.DPL. 

Si ce paramètre correspond à chaîne vide (""), le nom du fichier généré correspond au "Nom de l'état".DPL. 

**`<Certificat> : (Variable de type Certificat)`**

Nom de la variable de type [Certificat](../WDLang1/1000019287.md) contenant le certificat à utiliser pour signer le duplicata. 

**`<Mot de passe> : (Chaîne de caractères)`**

Mot de passe du duplicata généré.


<a name="SYNTAXE5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Imprimer directement sur un Fax sans gestion d'un compte-rendu (Windows 2000 et XP)

`iDestination(<iFax> , <Numéro de Fax à composer>)`
---

**`<iFax> : (Constante)`**

*iFax* : Constante permettant d'imprimer directement sur un fax.

**`<Numéro de Fax à composer> : (Chaîne de caractères)`**

Numéro de téléphone correspondant au fax où doit être envoyée l'impression. 
**Attention** : Un modem doit être installé sur le poste en cours. Le numéro de fax doit correspondre aux spécifications indiquées lors de la configuration du modem.  


<a name="SYNTAXE6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Imprimer directement sur un Fax avec gestion d'un compte-rendu (Windows 2000 et XP)

`<Résultat> = iDestination(<iFax> , <Numéro de Fax à composer> , <Nom du fax> [, <Nom ou identifiant du serveur de fax>])`
---

**`<Résultat> : (Entier)`**



- Identifiant de la connexion au serveur de fax, 

- 0 en cas d'erreur. Le message d'erreur correspondant peut être obtenu avec la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<iFax> : (Constante)`**

*iFax* : Constante permettant d'imprimer directement sur un fax.

**`<Numéro de Fax à composer> : (Chaîne de caractères)`**

Numéro de téléphone correspondant au fax où doit être envoyée l'impression. 
Attention : un modem doit être installé sur le poste en cours. Le numéro de fax doit correspondre aux spécifications indiquées lors de la configuration du modem.

**`<Nom du fax> : (Chaîne de caractères)`**

Nom permettant d'identifier le fax envoyé. Il sera alors possible de connaître l'état du fax envoyé grâce à la fonction [FaxEtat](../WDLang3/3037001.md).

**`<Nom ou identifiant du serveur de fax> : (Chaîne de caractères ou entier optionnelle)`**

***Nom de partage du poste serveur de fax***. 
Si ce paramètre n'est pas précisé ou correspond à une chaîne vide, le serveur de fax correspond au serveur de fax par défaut. 
Attention : il est nécessaire de démarrer le serveur de fax et de le configurer en mode d'envoi. Pour plus de détails, consultez [Envoyer des fax](../WDLang3/3037002.md). 
***Identifiant du serveur de fax*** : Si la fonction [FaxConnecte](../WDLang3/3037005.md) a été utilisée avant la fonction **iAperçu**, ce paramètre peut correspondre à l'identifiant de la connexion au serveur de fax renvoyé par la fonction [FaxConnecte](../WDLang3/3037005.md).  


<a name="SYNTAXE7"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Imprimer dans le visualisateur de rapports

`iDestination(<Destination> [, <Zoom> [, <Titre du visualisateur de rapports> [, <Boutons d'impression> [, <Position horizontale> [, <Position verticale> [, <Largeur> [, <Hauteur>]]]]]]])`
---

**`<Destination> : (Constante de type entier)`**

Affichage dans le visualisateur de rapports : 


|   |   |
| --- | --- |
| *iVisualisateur* | Impression dans le visualisateur de rapports. |





**`<Zoom> : (Constante optionnelle de type entier)`**

Zoom à l'ouverture du visualisateur de rapports.


|   |   |
| --- | --- |
| *i2Pages*<br>*iapZoom2Pages* | Aperçu affichant 2 pages en même temps. |
| *i100*<br>*iapZoom100* | Aperçu avec un zoom de 100%. |
| *iapZoomLargeurPage* | Aperçu affichant la largeur entière de la page. |
| *iPage*<br>*iapZoomPage* | Aperçu en zoom arrière : la page sera totalement affichée dans la fenêtre de zoom. |
| *iZoomDéfaut*<br>*iapZoomDéfaut*<br>(valeur par défaut) | Correspond :<br><br>- lors d'une première utilisation, à *iapZoomPage*.<br><br>- lors des utilisations suivantes, au dernier zoom défini par l'utilisateur dans le visualisateur de rapports.<br><br><br> |
| Valeur de 10 à 999 | Aperçu avec le zoom indiqué. |


Si ce paramètre n'est pas précisé, la valeur prise par défaut correspond :

- lors de la première utilisation de la fonction, à *iapZoomPage*.

- lors des utilisations suivantes, au zoom défini par l'utilisateur dans le visualisateur de rapports.




**`<Titre du visualisateur de rapports> : (Chaîne de caractères optionnelle)`**

Titre affiché dans la barre de titre de la fenêtre. Si ce paramètre n'est pas précisé, le titre par défaut correspondra à "Prévisualisation de l'état " suivi du nom de l'état. 
Si l'utilisateur a la possibilité de générer des fichiers (Word, PDF, ...) depuis le visualisateur de rapports, le titre de l'aperçu sera automatiquement proposé comme nom de fichier. Si ce paramètre n'est pas précisé, le nom du fichier correspondra au nom de l'état.

**`<Boutons d'impression> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> (par défaut) pour afficher les boutons permettant à l'utilisateur de lancer l'impression, 

- <u><u><u><u>Faux</u></u></u></u> pour ne pas afficher les boutons.




**`<Position horizontale> : (Entier optionnel)`**

Position horizontale de la fenêtre du visualisateur de rapports (en pixels). Par défaut, la position horizontale correspond à 100 pixels.

**`<Position verticale> : (Entier optionnel)`**

Position verticale de la fenêtre du visualisateur de rapports (en pixels). Par défaut, la position verticale correspond à 100 pixels.

**`<Largeur> : (Entier optionnel)`**

Dimensions de la fenêtre du visualisateur de rapports (en pixels). Par défaut, les dimensions de cette fenêtre sont 640 (largeur) et 480 (hauteur).

**`<Hauteur> : (Entier optionnel)`**

Dimensions de la fenêtre du visualisateur de rapports (en pixels). Par défaut, les dimensions de cette fenêtre sont 640 (largeur) et 480 (hauteur).  


<a name="SYNTAXE8"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
### Connaître la destination de l'impression en cours

`<Résultat> = iDestination()`
---

**`<Résultat> : (Constante optionnelle de type entier)`**

Type d'impression effectuée :


|   |   |
| --- | --- |
| *iDuplicata* | Impression directe dans un fichier duplicata. <br><br>Utilisation dans l'événement "Avant réimpression" : Cette constante est renvoyée si le bouton "Duplicata" est utilisé dans le visualisateur de rapports. |
| *iEmail* | Impression directe dans un email. <br><br>Utilisation dans l'événement "Avant réimpression" : Cette constante est renvoyée si le bouton "Email avec contenu intégré" est utilisé dans le visualisateur de rapports. |
| *iEmailPDF* | Impression directe dans un PDF attaché à un email. <br><br>Utilisation dans l'événement "Avant réimpression" : Cette constante est renvoyée si le bouton "Email avec PDF attaché" est utilisé dans le visualisateur de rapports. |
| *iFichier* | Impression directe dans un fichier texte. |
| *iFichierGénérique* | Impression directe dans un fichier texte. |
| *iFichierImprimante* | Impression directe dans un fichier PRN (fichier &lt;Nom du fichier à créer&gt;). |
| *iHTML* | Impression directe dans un fichier HTML avec utilisation de feuille de styles. <br><br>Utilisation dans l'événement "Avant réimpression" : Cette constante est renvoyée si le bouton "HTML" est utilisé dans le visualisateur de rapports. |
| *iHTMLGénérique* | Impression directe dans un fichier HTML avec utilisation d'une feuille de styles. |
| *iHTMLGénériqueSansCSS* | Impression directe dans un fichier HTML sans utilisation d'une feuille de styles. |
| *iHTMLSansCSS* | Impression directe dans un fichier HTML sans utilisation d'une feuille de styles. |
| *iImprimante* | Impression directe sur l'imprimante. <br><br>Utilisation dans l'événement "Avant réimpression" : Cette constante est renvoyée si le bouton "Imprimer" est utilisé dans le viasualisateur de rapports. |
| *iPCL* | Impression directe dans un fichier PCL. |
| *iPDF* | Impression directe dans un fichier PDF. <br><br>Utilisation dans l'événement "Avant réimpression" : Cette constante est renvoyée si le bouton "PDF" est utilisé dans le visualisateur de rapports. |
| *iPDFGénérique* | Impression directe dans un fichier PDF. |
| *iRTF* | Impression directe dans un fichier RTF. <br><br>Utilisation dans l'événement "Avant réimpression" : Cette constante est renvoyée si le bouton "Word" est utilisé dans le visualisateur de rapports. |
| *iRTFGénérique* | Impression directe dans un fichier RTF. |
| *iXLS* | Impression directe dans un fichier XLS. <br><br>Utilisation dans l'événement "Avant réimpression" : Cette constante est renvoyée si le bouton "XLS" est utilisé dans le visualisateur de rapports. |
| *iXLSGénérique* | Impression directe dans un fichier XLS. |
| *iXML* | Impression directe dans un fichier XML. <br><br>Utilisation dans l'événement "Avant réimpression" : Cette constante est renvoyée si le bouton "XML" est utilisé dans le visualisateur de rapports. |
| *iXMLGénérique* | Impression directe dans un fichier XML. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Quand utiliser la fonction iDestination ? 
<a name="quand_utiliser_fonction_docparampagetitleshort_ELTPARAGRAPHE000913"></a>La fonction **iDestination** doit être la première fonction d'impression appelée. Elle doit donc figurer avant les fonctions [iImprime](../WDLang5/3046031.md), [iCréePolice](../WDLang5/3046045.md), etc. Mais la fonction **iDestination** doit être appelée **après** les fonctions [iConfigure](../WDLang5/3046072.md) ou [iParamètre](../WDLang5/3046008.md).

**Remarque** : La fonction **iDestination** peut être appelée avant l'exécution d'un état (avec [iImprimeEtat](../WDLang5/3046032.md)) pour choisir la destination de l'exécution de l'état.
<a name="NOTE0_2B"></a>
<a name="NOTE0_2C"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Impression au format PDF
<a name="impression_format_pdf_ELTPARAGRAPHE000972"></a>Le fichier PDF généré peut être directement imprimé via la fonction [iImprimePDF](../WDLang5/1000020519.md).

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Le fichier PDF généré peut également être visualisé via le champ [Lecteur PDF](../WDChamp/1410087036.md). 
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Impression en HTML
<a name="impression_html_ELTPARAGRAPHE000993"></a>

- Si l'impression est réalisée dans une page HTML avec une feuille de styles (constante *iHTMLCSS*), la feuille de styles est intégrée au fichier HTML. L'impression est identique en HTML et sur une imprimante. Les superpositions sont gérées et la gestion de la taille des polices est précise.

- Si l'impression est réalisée dans une page HTML sans feuille de styles (constante *iHTML*), les limitations suivantes peuvent être observées :

	- gestion de la taille des polices non précise

	- superposition non gérée. Il est par exemple impossible d'écrire sur une image.




- Les polices orientées à 90° ne sont pas imprimées correctement dans le fichier HTML : le texte est affiché avec une police horizontale.

- Les cadres arrondis ne sont pas imprimés. Ils sont remplacés par des cadres non arrondis.



<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Impression en XLS
<a name="impression_xls_ELTPARAGRAPHE001008"></a>

- Les champs Image, Code-barres et Graphe ne sont pas imprimés.



<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Impression en RTF
<a name="impression_rtf_ELTPARAGRAPHE001017"></a>

- L'impression au format RTF gère uniquement le texte (avec son style) et les images. Il est impossible de gérer la superposition d'objets (lignes ou images). Il est impossible de mettre par exemple plusieurs lignes de texte à côté d'une image.

- Les polices orientées à 90° ne sont pas imprimées correctement dans le fichier HTML : le texte est affiché avec une police horizontale.

- Pour imprimer en RTF, le fichier "RICHED20.DLL" doit être présent sur le poste en cours. Le fichier "RICHED20.DLL" est généralement présent dans le répertoire système de Windows.

- Les cadres ne sont pas imprimés.

- Les tableaux sont gérés par le format RTF. La couleur de la police et la couleur de fond des cellules sont conservées.



<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Configuration de l'imprimante pour l'impression en HTML, RTF et Texte
<a name="configuration_imprimante_pour_impression_html_rtf_texte_ELTPARAGRAPHE001032"></a>

- Si l'impression est réalisée dans un **fichier texte**, seul le texte est récupéré : les traits, les images, ... sont ignorés.

- L'impression en HTML, en RTF et en mode texte se base sur la configuration et la résolution de l'imprimante en cours. Ainsi si l'imprimante en cours est configurée avec des marges et en mode paysage, ces options seront utilisées pour l'impression en mode HTML, texte, ou RTF.

- Plus l'imprimante est configurée avec une résolution fine, plus l'impression en RTF, texte ou HTML sera de bonne qualité.

- **Pour éviter certains problèmes de superposition** lors d'une impression en mode HTML, il suffit parfois d'un simple réglage des paramètres de l'imprimante.



<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Impression au format PRN
<a name="impression_format_prn_ELTPARAGRAPHE001047"></a>Lors d'une impression au format PRN, le fichier PRN est spécifique à l'imprimante sélectionnée. Ce fichier est directement créé par le driver de l'imprimante, c'est un fichier binaire interprétable par l'imprimante.

Ce fichier peut être imprimé en différé sur l'imprimante spécifiée lors de l'impression ou sur toute autre imprimante du même type par la commande DOS "Print". La syntaxe de cette commande est :

```txt
Print /D:\\<Nom du poste>\<Nom de l'imprimante déclaré> <Nom du fichier prn>
```

**Exemple** :

```txt
Print /D:\\Poste_Doc\CanonLBP Sortie.prn
```

**Remarque** : Pour une imprimante réseau, il est nécessaire d'utiliser le nom du partage et non le nom de l'imprimante. Le nom du partage est connu dans l'onglet "Partage" de la description de l'imprimante.
<a name="NOTE0_7"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Impression en XML
<a name="impression_xml_ELTPARAGRAPHE001064"></a>Lors d'une impression au format XML, seules les données sont imprimées. Les caractéristiques de mise en page (traits, ...) ne sont pas prises en compte.
<a name="NOTE0_8"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Caractéristiques d'impression
<a name="caracteristiques_impression_ELTPARAGRAPHE001073"></a>

- **Lors d'une impression au format PDF**, il est possible de paramétrer les caractéristiques du fichier PDF créé grâce à la fonction [iParamètrePDF](../WDLang5/3046007.md).

- **Lors d'une impression au format XLS**, il est possible de paramétrer les caractéristiques du fichier XLS créé grâce à la fonction [iParamètreXLS](../WDLang5/1000017224.md).



<a name="NOTE0_9"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Impression sur un fax
<a name="impression_sur_fax_ELTPARAGRAPHE001089"></a>Deux syntaxes permettent d'envoyer une impression sur un fax :

- **Fax sans aucune gestion de compte-rendu**. L'impression (réalisée par la suite avec la fonction [iImprimeEtat](../WDLang5/3046032.md) par exemple) est directement envoyée au numéro de téléphone spécifié.

- **Fax avec gestion de compte-rendu**. L'impression (réalisée par la suite avec la fonction [iImprimeEtat](../WDLang5/3046032.md) par exemple) est envoyée au numéro de téléphone spécifié, par l'intermédiaire d'un serveur de fax. La fonction **iAperçu** renvoie l'identifiant de la connexion à ce serveur de fax. Cet identifiant, ainsi que le nom donné au fax, permettent de suivre l'envoi du fax grâce aux [fonctions Fax](../WDLang3/3037003.md). Pour plus de détails sur la gestion des fax, consultez [Envoyer des fax](../WDLang3/3037002.md).



<a name="NOTE0_10"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Impression d'un fax en mode paysage
<a name="impression_fax_mode_paysage_ELTPARAGRAPHE001113"></a>Pour paramétrer l'impression d'un fax en mode paysage (impression de plusieurs fax, dont un en mode paysage), il est nécessaire d'utiliser les fonctions d'impression dans l'ordre suivant :

1. Fonction **iDestination** avec la constante *iFax*.

2. Fonction [iParamètre](../WDLang5/3046008.md) permettant de passer en mode paysage.




Si cet ordre n'est pas respecté, le paramétrage du mode paysage ne sera pas pris en compte par le driver de gestion des fax.

Exemple :

```wl
iDestination(iFax, "00046032032", "Fax")
iParamètre("ORIENTATION=PAYSAGE")
iImprime("Impression en paysage")
iFinImprime()
```

<a name="NOTE0_11"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Utiliser un serveur de fax installé sur un poste différent du poste en cours
<a name="utiliser_serveur_fax_installe_sur_poste_different_poste_cours_ELTPARAGRAPHE001136"></a>Il est possible d'utiliser un serveur de fax installé sur un poste différent du poste en cours. Dans ce cas, le poste sur lequel est installé le serveur de fax doit être un poste avec Windows Server 2003. Le serveur de fax doit être partagé. Il suffit alors d'utiliser le nom du poste serveur de fax dans la fonction **iDestination**.

Le poste à partir duquel les fax sont envoyés doit posséder un serveur de fax local.

Par exemple, si le serveur de fax est installé sur le poste "ServeurFax1", il suffit d'utiliser la syntaxe :

```wl
iDestination(iFax, "00046032032", "Fax", "\\ServeurFax1\Fax_Partage")
```

<a name="NOTE0_12"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Fin d'impression
<a name="fin_impression_ELTPARAGRAPHE001153"></a>La fonction [iFinImprime](../WDLang5/3046053.md) doit nécessairement être appelée pour terminer l'édition sauf après un appel à la fonction [iImprimeEtat](../WDLang5/3046032.md).

Les prochaines impressions seront effectuées sur l'imprimante, sauf si la fonction **iDestination** est à nouveau exécutée.

<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280prn.dll
