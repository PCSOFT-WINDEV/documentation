


## iImprimeImage (Fonction)

***En anglais : iPrintImage***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Envoie au buffer d'impression l'image à imprimer. L'impression n'est pas lancée (seule la fonction [iFinImprime](../WDLang5/3046053.md) permet de lancer l'impression). Le mode d'impression de l'image dépend des paramètres passés à la fonction **iImprimeImage**.

**Remarque** : Cette fonction ne doit pas être utilisée pour imprimer l'image de fond d'un état. Pour définir l'image de fond d'un état, utilisez la propriété [ImageFond](../Proprietes/2510056.md). La propriété [ImageFondImprimée](../Proprietes/1000021350.md) permet de spécifier si l'image doit être imprimée avec l'état.

![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Seules les images au format JPEG peuvent être imprimées.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003046017&name=iimprimeimage_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Imprime Fleur.JPG ligne 20 mm, colonne 50 mm sans étirement ni réduction
iImprimeImage("Fleur.JPG", 20, 50)
iFinImprime()
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Impression d'une image dans une zone délimitée

`iImprimeImage(<Nom de l'image> , <X1> , <Y1> , <X2> , <Y2> [, <Echelle>])`
---

**`<Nom de l'image> : (Chaîne de caractères ou variable de type Image)`**



- Nom du fichier contenant l'image à imprimer. Ce fichier doit être dans l'un des formats d'images reconnus.

- Nom d'une rubrique de type mémo Image. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) Nom d'une variable de type [Image](../WDLang1/1000019650.md).




![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre doit correspondre à un fichier image au format JPEG.

**`<X1> : (Réel)`**

Coordonnée horizontale (colonne ou abscisse) du coin haut gauche de la position de l'image (en millimètres). 
Valeur comprise entre 0 et la largeur de la page (donnée par [iLargeurPage](../WDLang5/3046036.md)).

**`<Y1> : (Réel)`**

Coordonnée verticale (ligne ou ordonnée) du coin haut gauche de la position de l'image (en millimètres). 
Valeur comprise entre 0 et la hauteur de la page (donnée par [iHauteurPage](../WDLang5/3046052.md)).

**`<X2> : (Réel)`**

Coordonnée horizontale (colonne ou abscisse) du coin bas droit du cadre dans lequel l'image doit être imprimée (en millimètres). 
Valeur comprise entre 0 et la largeur de la page (donnée par [iLargeurPage](../WDLang5/3046036.md)).

**`<Y2> : (Réel)`**

Coordonnée verticale (ligne ou ordonnée) du coin bas droit du cadre dans lequel l'image doit être imprimée (en millimètres). 
Valeur comprise entre 0 et la hauteur de la page (donnée par [iHauteurPage](../WDLang5/3046052.md)).

**`<Echelle> : (Entier ou constante de type entier (optionnel))`**

Paramètre l'échelle du zoom réalisé sur l'image.


|   |   |
| --- | --- |
| *iAffichageHomoCentré* | L'image est étirée ou réduite pour occuper de manière optimale l'espace défini sans être déformée. Elle est centrée dans la zone définie par &lt;X1&gt;, &lt;Y1&gt;, &lt;X2&gt; et &lt;Y2&gt;.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Img_HomoCentre.GIF)<br> |
| *iAffichageHomothétique* | L'image est affichée en &lt;X1&gt; &lt;Y1&gt; sans déformation. Elle occupe soit toute la hauteur définie par &lt;X1&gt; et &lt;X2&gt;, soit toute la largeur définie par &lt;Y1&gt; et &lt;Y2&gt;.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Img_Homo.GIF)<br> |
| *iAffichageNormal*<br>(Valeur par défaut) | L'image est affichée dans la totalité du rectangle défini par &lt;X1&gt;, &lt;Y1&gt;, &lt;X2&gt; et &lt;Y2&gt;. L'image peut être déformée.<br><br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Img_Normal.GIF)<br> |

![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre n'est pas supporté.


<a name="SYNTAXE2"></a>

### Impression d'une image à une position définie

`iImprimeImage(<Nom de l'image> , <X1> , <Y1> [, <Echelle>])`
---

**`<Nom de l'image> : (Chaîne de caractères ou variable de type Image)`**



- Nom du fichier contenant l'image à imprimer. Ce fichier doit être dans l'un des formats d'images reconnus.

- Nom d'une rubrique de type mémo Image. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) Nom d'une variable de type [Image](../WDLang1/1000019650.md).




**`<X1> : (Réel)`**

Coordonnée horizontale (colonne ou abscisse) du coin haut gauche de la position de l'image (en millimètres). 
Valeur comprise entre 0 et la largeur de la page (donnée par [iLargeurPage](../WDLang5/3046036.md)).

**`<Y1> : (Réel)`**

Coordonnée verticale (ligne ou ordonnée) du coin haut gauche de la position de l'image (en millimètres). 
Valeur comprise entre 0 et la hauteur de la page (donnée par [iHauteurPage](../WDLang5/3046052.md)).

**`<Echelle> : (Entier ou constante de type entier (optionnel))`**

Échelle du zoom réalisé sur l'image (comprise entre 0 et 999).

Si ce paramètre n'est pas précisé ou égal à 0, l'image est affichée telle quelle en &lt;X1&gt; &lt;Y1&gt; (équivalent à &lt;Échelle&gt; = 100).  


<a name="SYNTAXE3"></a>

### Impression d'une partie d'une image 

`iImprimeImage(<Nom du fichier> , <X1> , <Y1> , <X2> , <Y2> , <X3> , <Y3> , <X4> , <Y4> [, <Échelle>])`
---

**`<Nom du fichier> : (Chaîne de caractères)`**



- Nom du fichier contenant l'image à imprimer. Ce fichier doit être dans l'un des formats d'images reconnus.

- Nom d'une rubrique de type mémo Image. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) Nom d'une variable de type [Image](../WDLang1/1000019650.md).




**`<X1> : (Réel)`**

Coordonnée horizontale (colonne ou abscisse) du coin haut gauche de la position de l'image (en millimètres). 
Valeur comprise entre 0 et la largeur de la page (donnée par [iLargeurPage](../WDLang5/3046036.md)).

**`<Y1> : (Réel)`**

Coordonnée verticale (ligne ou ordonnée) du coin haut gauche de la position de l'image (en millimètres). 
Valeur comprise entre 0 et la hauteur de la page (donnée par [iHauteurPage](../WDLang5/3046052.md)).

**`<X2> : (Réel)`**

Coordonnée horizontale (colonne ou abscisse) du coin bas droit du cadre dans lequel l'image doit être imprimée (en millimètres). 
Valeur comprise entre 0 et la largeur de la page (donnée par [iLargeurPage](../WDLang5/3046036.md)).

**`<Y2> : (Réel)`**

Coordonnée verticale (ligne ou ordonnée) du coin bas droit du cadre dans lequel l'image doit être imprimée (en millimètres). 
Valeur comprise entre 0 et la hauteur de la page (donnée par [iHauteurPage](../WDLang5/3046052.md)).

**`<X3> : (Réel)`**

Coordonnée horizontale (colonne ou abscisse) du coin haut gauche de la partie de l'image à imprimer (en millimètres).

**`<Y3> : (Réel)`**

Coordonnée verticale (ligne ou ordonnée) du coin haut gauche de la partie de l'image à imprimer (en millimètres).

**`<X4> : (Réel)`**

Coordonnée horizontale (colonne ou abscisse) du coin bas droit de la partie de l'image à imprimer (en millimètres).

**`<Y4> : (Réel)`**

Coordonnée verticale (ligne ou ordonnée) du coin bas droit de la partie de l'image à imprimer (en millimètres).

**`<Échelle> : (Entier ou constante de type entier (optionnel))`**

Paramètre l'échelle du zoom réalisé sur l'image.


|   |   |
| --- | --- |
| *iAffichageHomoCentré* | La partie de l'image est étirée ou réduite pour occuper de manière optimale l'espace défini sans être déformée. Elle occupe :<br><br>- soit toute la hauteur définie par &lt;X1&gt;et &lt;X2&gt; : l'image est centrée horizontalement.<br><br>- soit toute la largeur définie par &lt;Y1&gt; et &lt;Y2&gt; : l'image est centrée verticalement.<br><br><br>Si nécessaire, l'image est agrandie proportionnellement. |
| *iAffichageHomothétique* | La partie de l'image est affichée en &lt;X1&gt; &lt;Y1&gt; sans déformation. Elle occupe soit toute la hauteur définie par &lt;X1&gt; et &lt;X2&gt;, soit toute la largeur définie par &lt;Y1&gt; et &lt;Y2&gt;. Si nécessaire, l'image est agrandie proportionnellement. |
| *iAffichageNormal*<br>(Valeur par défaut) | La partie de l'image (définie par &lt;X3&gt;, &lt;Y3&gt;, &lt;X4&gt; et &lt;Y4&gt;) est affichée dans la totalité du rectangle défini par &lt;X1&gt;, &lt;Y1&gt;, &lt;X2&gt; et &lt;Y2&gt;. L'image peut être déformée. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Divers
<a name="divers_ELTPARAGRAPHE000253"></a>

- L'origine (0,0) est située dans le coin supérieur gauche de la feuille. Elle tient compte des marges physiques de l'imprimante.

- Si l'image ne rentre pas dans la zone définie et si un centrage a été demandé (&lt;Échelle&gt; = 999), alors l'option de centrage est abandonnée.



<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Impression dans un fichier HTML
<a name="impression_dans_fichier_html_ELTPARAGRAPHE000263"></a>Si la fonction **iImprimeImage** est utilisée lors d'une impression dans un état (créé avec l'éditeur d'états) au format HTML, l'image imprimée sera déformée.
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Impression en PDF
<a name="impression_pdf_ELTPARAGRAPHE000275"></a>Si seules les coordonnées du point haut gauche de l'image sont indiquées, la largeur de l'image dépend du DPI de l'imprimante.

En impression PDF, le PDF a le même DPI que l'imprimante courante : dans ce cas, la largeur de l'image dans le PDF va correspondre à la largeur de l'image dans l'aperçu.

En impression PDF générique, le PDF a le même DPI que l'écran (pour ne pas dépendre d'une imprimante). L'image risque de ne pas avoir la largeur voulue.

Il est conseillé d'indiquer les coordonnées du point bas droit de l'image, pour avoir toujours le même résultat (en PDF, PDF générique et quelque soit le DPI de l'imprimante).

<a name="XComposante"></a>

## Composante :
wd280prn.dll
