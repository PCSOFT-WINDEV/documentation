


## XMLDonnée (Fonction)

***En anglais : XMLData***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie la valeur de l'élément en cours (balise ou attribut XML) ou d'un de ses attributs.

Pour sélectionner un élément, utilisez les fonctions de recherche et de parcours XML ([XMLPremier](../WDLang5/3081024.md), [XMLDernier](../WDLang5/3081013.md), [XMLFils](../WDLang5/3081012.md), ...).








<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Valeur de l'attribut "Produit" de l'élément en cours
Valeur est une chaîne
Valeur = XMLDonnée("DocXML", "Produit")

// Test de la valeur
SI Valeur = "" ALORS
	Erreur("L'attribut Produit n'a pas de valeur")
SINON
	Info("La valeur de l'attribut Produit est : " + Valeur)
FIN
```


<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Valeur d'une balise
Valeur est une chaîne
Valeur = XMLDonnée("DocXML")

// Positionné sur une balise ?
SI ErreurDétectée = Vrai ALORS
	Erreur(ErreurInfo())
SINON
	// Test de la valeur
	SI Valeur = "" ALORS
		Erreur("L'élément en cours n'a pas de valeur")
	SINON
		Info("La valeur de l'élément courant est : " + Valeur)
	FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = XMLDonnée(<Document XML> [, <Attribut> [, <Mode de recherche>]])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Valeur de l'élément en cours ou de l'attribut spécifié.

- Chaîne vide ("") :

	- si l'élément en cours n'a pas de valeur.

	- si l'élément en cours n'a pas pour fils l'attribut spécifié.

	- si aucun élément n'est en cours. Dans ce cas, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour obtenir plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).

	- si l'élément en cours est déjà un attribut. Dans ce cas, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour obtenir plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).







**`<Document XML> : (Chaîne de caractères)`**

Nom du document XML manipulé. Ce document contient le code XML à analyser et a été créé avec la fonction [XMLDocument](../WDLang5/3081008.md).

**`<Attribut> : (Chaîne de caractères optionnelle)`**

Nom de l'attribut fils de la balise en cours pour lequel la valeur doit être renvoyée. Cet attribut est recherché parmi les fils directs de l'élément en cours. Si ce paramètre n'est pas précisé (ou correspond à Null ou chaîne vide), la fonction **XMLDonnée** renvoie la valeur de la balise en cours.

**`<Mode de recherche> : (Constante optionnelle de type Entier)`**

Mode de recherche de l'attribut parmi les fils de l'élément en cours.  


|   |   |
| --- | --- |
| *XMLCommencePar* | Recherche du premier attribut dont le nom commence par le contenu du paramètre &lt;Attribut&gt;. |
| *XMLContient* | Recherche du premier attribut dont le nom contient la valeur du paramètre &lt;Attribut&gt;. |
| *XMLExact*<br>(Valeur par défaut) | Recherche du premier attribut dont le nom correspond exactement à la valeur du paramètre &lt;Attribut&gt;. |
| *XMLIgnoreLaCasse* | Recherche du premier attribut dont le nom correspond à la valeur du paramètre &lt;Attribut&gt; en ignorant la casse.<br>Peut être combiné avec les constantes *XMLContient*, *XMLCommencePar* ou* XMLExact.* |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Connaître l'élément courant 
<a name="connaitre_element_courant_ELTPARAGRAPHE000140"></a>

- Le type de l'élément courant peut être connu avec la fonction [XMLTypeElément](../WDLang5/3081031.md).

- Le nom de l'élément courant peut être connu avec la fonction [XMLNomElément](../WDLang5/3081026.md).



<a name="NOTE0_2"></a>


### Fonctions XML et threads
<a name="fonctions_xml_threads_ELTPARAGRAPHE000281"></a>Si votre application utilise des threads, le document XML est partagé entre tous ces threads. Pour plus de détails sur la gestion des threads, consultez [Gestion des threads](../WDLang1/3077026.md).

<a name="XComposante"></a>

## Composante :
wd280xml.dll
