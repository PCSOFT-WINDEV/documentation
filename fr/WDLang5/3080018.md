


## xlsVersion (Fonction)

***En anglais : xlsVersion***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie la version d'Excel avec laquelle le fichier a été enregistré. Si plusieurs versions ont été utilisées, seul le numéro de version le plus élevé est renvoyé.

**Remarque** : La version d'Excel peut être connue uniquement :

- si le fichier Excel existe.

- si le fichier Excel est ouvert.





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003080018&name=xlsversion_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Ouverture d'un fichier XLS
IDFichierXLS = xlsOuvre("C:\MonRépertoire\Fichier.XLS")
...
// Version d'Excel
ResVersion = xlsVersion(IDFichierXLS)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Syntaxe utilisant le type xlsDocument

`<Résultat> = xlsVersion(<Document XLS>)`
---

**`<Résultat> : (Entier)`**



- Version d'Excel (3, 4, 5, 8), 100 pour les fichiers XLSX.  Si plusieurs versions ont été utilisées, seul le numéro de version le plus élevé est renvoyé.

- 0 en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [xlsMsgErreur](../WDLang5/3080016.md) ou la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Document XLS> : (Variable de type xlsDocument)`**

Nom de la variable de type [xlsDocument](../WDLang5/1000017464.md) correspondant au fichier XLS à manipuler.  


<a name="SYNTAXE2"></a>

### Syntaxe conservée par compatibilité avec la version 12

`<Résultat> = xlsVersion(<Identifiant du fichier XLS>)`
---

**`<Résultat> : (Entier)`**



- Version d'Excel (3, 4, 5, 8), 100 pour les fichiers XLSX. Si plusieurs versions ont été utilisées, seul le numéro de version le plus élevé est renvoyé.

- 0 en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [xlsMsgErreur](../WDLang5/3080016.md) ou la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Identifiant du fichier XLS> : (Entier)`**

Identifiant du fichier XLS à manipuler, renvoyé par la fonction [xlsOuvre](../WDLang5/3080017.md).  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
La fonction **xlsVersion** génère une erreur dans les cas suivants :

- le fichier XLS spécifié n'est pas ouvert.

- la version d'Excel est inconnue.




<a name="XComposante"></a>

## Composante :
wd280xls.dll
