


## XMLInsèreElément (Fonction)

***En anglais : XMLInsertElement***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Insère un élément (balise ou attribut) XML dans un document XML. La position d'insertion est relative à la position courante.

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Un document XML ne peut contenir qu'une seule balise à sa racine. 






<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = XMLInsèreElément(<Document XML> , <Nom de l'élément> [, <Valeur de l'élément inséré> [, <Position d'insertion> [, <Changement de position>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'insertion a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire (la variable [ErreurDétectée](../WDLang1/3087001.md) est alors à <u><u><u><u>Vrai</u></u></u></u>). 
	Pour obtenir plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Document XML> : (Chaîne de caractères)`**

Document XML dans lequel l'insertion doit être effectuée.

**`<Nom de l'élément> : (Chaîne de caractères)`**

Nom de l'élément à ajouter. L'élément ajouté est du même type que l'élément en cours : 

- Si l'élément en cours est une balise, l'élément inséré sera une balise. 

- Si l'élément en cours est un attribut, l'élément inséré sera un attribut.




**`<Valeur de l'élément inséré> : (Chaîne de caractères optionnelle)`**

Valeur du nouvel élément. Par défaut, ce paramètre correspond à une chaîne vide ("").

**`<Position d'insertion> : (Constante optionnelle de type Entier)`**

Position où l'ajout est effectué par rapport à l'élément courant. Ce paramètre peut prendre pour valeur :


|   |   |
| --- | --- |
| *XMLElémentPrécédent* | L'insertion s'effectue juste avant l'élément courant, dans la même branche.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée pour les attributs. |
| *XMLElémentSuivant* | L'insertion s'effectue juste après l'élément courant, dans la même branche.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée pour les attributs. |
| *XMLSousElément*<br>(Valeur par défaut) | L'insertion s'effectue sur le niveau courant. La partie insérée sera un sous élément de l'élément courant. |



**`<Changement de position> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> pour se positionner sur l'élément ajouté. Dans ce cas, l'élément ajouté devient la position courante. 

- <u><u><u><u>Faux</u></u></u></u> (valeur par défaut) pour ne pas modifier la position courante lors de l'ajout.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Enregistrer les modifications dans le fichier XML
<a name="enregistrer_les_modifications_dans_fichier_xml_ELTPARAGRAPHE000126"></a>Pour enregistrer les modifications effectuées dans un fichier XML, vous devez :

1. Utiliser la fonction [XMLConstruitChaîne](../WDLang5/3081016.md). Cette fonction récupère et met en forme le contenu d'un document XML.

2. Enregistrer la chaîne de caractères générée par la fonction [XMLConstruitChaîne](../WDLang5/3081016.md) dans un fichier XML. Pour cela, il suffit d'utiliser la fonction [fSauveTexte](../WDLang1/3036046.md).




Exemple :

```wl
// Après modification du document XML 
SourceXML = XMLConstruitChaîne("DocXML")
// Enregistrement du fichier XML
fSauveTexte("ExampleModifié.xml", SourceXML)
```


<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280xml.dll
