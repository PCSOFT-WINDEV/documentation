


## xlsOuvre (Fonction)

***En anglais : xlsOpen***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ouvre un fichier Excel (fichiers xls ou xlsx). 

**Remarque** : Pour créer un fichier Excel sans utiliser un fichier initial, il suffit de créer une variable de type [xlsDocument](../WDLang5/1000017464.md) (la fonction **xlsOuvre** est alors inutile).

![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Seul le format xlsx est supporté.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003080017&name=xlsouvre_fonction&product=WD">Voir des exemples supplémentaires</a>
Exemple d'ouverture de fichier Excel avec récupération d'un entier

```wl
doc est un xlsDocument
doc = xlsOuvre(fRepExe() + ["\"] + "gpac.xls")

SI ErreurDétectée() ALORS
	Erreur(ErreurInfo())
	RETOUR
FIN

Info("Contenu de la cellule [1,1] :", doc[1,1])

xlsFerme(doc)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = xlsOuvre(<Chemin du fichier XLS> [, <Mode d'ouverture> [, <Mot de passe>]])`
---

**`<Résultat> : (Variable de type xlsDocument)`**

Nom de la variable de type [xlsDocument](../WDLang5/1000017464.md) correspondant au fichier XLS. Cette variable peut être utilisée dans toutes les fonctions XLS. **L'utilisation de ce type de variable permet de modifier les documents XLS.**


	<B><B><B><B>Avertissement</B></B></B></B>

	 **Résultat compatible avec la version 12.** Par compatibilité, cette variable peut être convertie en un entier correspondant à l'identifiant du fichier XLS spécifié. Cet identifiant pourra être utilisé dans toutes les fonctions XLS fonctionnant avec l'identifiant du fichier. L'utilisation de cette syntaxe avec identifiant permet uniquement de lire les documents XLS : aucune modification n'est possible.



En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u> et la fonction [ErreurInfo](../WDLang1/3013008.md) permet de connaître la cause de l'erreur.

**`<Chemin du fichier XLS> : (Chaîne de caractères)`**

Chemin complet ou relatif du fichier XLS à ouvrir (260 caractères maximum).

**`<Mode d'ouverture> : (Constante de type entier optionnelle)`**

Indique le mode d'ouverture du fichier XLS. 
Par défaut : 

- le fichier Excel est ouvert en lecture. Il est possible d'écrire dans le fichier Excel avec une autre application. 

- le fichier Excel utilise le mode de gestion multi-feuilles des fichiers XLS.





|   |   |
| --- | --- |
| *xlsCompatible* | Permet d'ouvrir le fichier Excel en mode compatible version 10. <br><br>Dans ce mode : <br><br>- Seule une seule feuille du classeur est gérée. <br><br>- Unicode n'est pas géré. <br><br>- Les regroupements de chaînes ne sont pas gérés. <br><br>- Certaines fonctions (par exemple [xlsDonnée](../WDLang5/3080021.md) ou [xlsNbLigne](../WDLang5/3080011.md)) peuvent donner des résultats incohérents.<br><br><br><br>	<B><B><B><B>Avertissement</B></B></B></B><br><br>	A partir de la version <B><B><B><B>11</B></B></B></B>,  cette constante est conservée par compatibilité.<br>
 |
| *xlsEcriture* | Ouvre le fichier Excel en mode "Lecture / Ecriture" : le fichier XLS est ouvert et bloqué jusqu'à sa fermeture. <br>Attention : les modifications réalisées dans le fichier XLS pourront être prises en compte uniquement si vous utilisez une variable de type [xlsDocument](../WDLang5/1000017464.md). |



**`<Mot de passe> : (Chaîne de caractères optionnelle)`**

Mot de passe d'ouverture du fichier XLS à manipuler. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Utilisation des fonctions XLS en lecture et en écriture
<a name="utilisation_des_fonctions_xls_lecture_ecriture_ELTPARAGRAPHE000116"></a>Pour manipuler les fichiers XLS en lecture et en écriture, il est nécessaire d'utiliser une variable de type [xlsDocument](../WDLang5/1000017464.md). Ce type de variable permet également de manipuler les fichiers spécifiques à Office 2007 (fichiers .xlsx) en lecture et en écriture.

L'utilisation de l'identifiant du fichier est conservée par compatibilité avec la version 12. Les documents XLS (y compris les fichiers ".xlsx" spécifiques à Office 2007) manipulés avec cet identifiant ne pourront pas être modifiés (même si la constante *xlsEcriture*est spécifiée).

Exemple utilisant la syntaxe conservée par compatibilité : 

```wl
IDFichierXLS est un entier
IDFichierXLS = xlsOuvre(ComplèteRep(fRepExe()) + "GPACS.XLS")
SI ErreurDétectée = Faux ALORS
		Info("Le fichier XLS a été ouvert")
		// Fermeture du fichier 
		xlsFerme(IDFichierXLS)
	SINON
		Info(ErreurInfo())
	FIN
FIN
```

<a name="NOTE0_2"></a>


### Le fichiers XLS n'a pas pu être ouvert
<a name="fichiers_xls_pas_etre_ouvert_ELTPARAGRAPHE000131"></a>Les cas d'erreurs possibles sont les suivants : 

- Le fichier XLS spécifié n'a pas été trouvé.

- Le fichier XLS spécifié n'existe pas.

- Le fichier XLS spécifié ne peut pas être ouvert.

- Le fichier XLS spécifié est invalide.

- Pas assez de mémoire pour ouvrir le fichier XLS.

- La version d'Excel utilisée est inconnue ou trop ancienne (les fonctions XLS ne peuvent pas lire les fichiers au format Excel version 2 ou inférieure).




Pour connaître le libellé de l'erreur, utilisez la fonction [xlsMsgErreur](../WDLang5/3080016.md) (si vous utilisez la syntaxe compatible avec la version 12) ou la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.

<a name="XComposante"></a>

## Composante :
wd280xls.dll
