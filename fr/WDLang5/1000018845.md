


## iParamètreDuplicata (Fonction)

***En anglais : iParameterDuplicate***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Paramètre la création automatique du duplicata généré lors de la prochaine impression (impression sur une imprimante physique) : 

- nom du fichier duplicata.

- répertoire de création du duplicata.

- mot de passe du duplicata.

- signature du duplicata.




Cette fonction doit être utilisée avant de lancer l'impression pour laquelle un duplicata doit être conservé. Ce paramétrage est pris en compte uniquement pour cette impression.   

Les duplicata sont disponibles sur les états programmés (créés avec les fonctions iXXX) et les états générés par l'éditeur d'états.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Paramétrage du duplicata de la facture
iParamètreDuplicata(iDplImpression, "C:\Temp", "MonDuplicata_%d_%h", ...
	"JJJJ JJ MMMM AAAA", "HH.MM.SS")

// Impression avec duplicata depuis le visualisateur de rapports
iDestination(iVisualisateur)
iImprimeEtat(ETAT_Facture)
```


<a name="Exemple2"></a>

```wl
// Paramétrage du duplicata signé de la facture 
MonCertificat est un Certificat
SélectionCertificat est un booléen
SélectionCertificat = CertificatSélecteur(MonCertificat)

// Annulation ou erreur
SI SélectionCertificat = Faux ALORS RETOUR

// Teste si le certificat sélectionné est valide pour signer
SI MonCertificat.ValidePourSignature = Faux ALORS
	Info("Le certificat sélectionné ne permet pas de générer une signature.")
	RETOUR
FIN

iParamètreDuplicata(iDplImpression, "C:\Temp", "MonDuplicata_%d_%h", ...
		"JJJJ JJ MMMM AAAA", "HH.MM.SS")
iParamètreDuplicata(iDplCertificat, MonCertificat)

// Impression avec duplicata depuis le visualisateur de rapports
iDestination(iVisualisateur)
iImprimeEtat(ETAT_Facture)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Paramétrer le fichier duplicata à créer : répertoire, nom, mot de passe, ...

`iParamètreDuplicata(<Options> [, <Répertoire de création> [, <Nom du fichier à imprimer> [, <Format de la date> [, <Format de l'heure> [, <Mot de passe>]]]]])`
---

**`<Options> : (Constante de type Entier)`**

Options de création des duplicata : 


|   |   |
| --- | --- |
| *iDplAucun* | Aucun duplicata n'est créé. |
| *iDplImpression* | Un duplicata est automatiquement créé à chaque impression effectuée sur une imprimante.<br><br>**Remarque** : Le duplicata n'est pas généré si l'utilisateur utilise une des options d'export (pdf, email, ...) depuis le visualisateur de rapports |



**`<Répertoire de création> : (Chaîne de caractères optionnelle)`**

Chemin du répertoire de création des duplicata. Par défaut, ce paramètre correspond au répertoire courant.

**`<Nom du fichier à imprimer> : (Chaîne de caractères optionnelle)`**

Nom du fichier à imprimer (avec son extension). Ce nom peut contenir la date et l'heure de création du duplicata grâce aux balises suivantes : 

- %d pour indiquer la date de création du duplicata. 

- %h pour indiquer l'heure de création du duplicata. 




**Exemple** : "MonDuplicata_%d_%h.dpl" donnera par exemple le fichier "MonDuplicata_04092009_1426.dpl".

Par défaut, le nom du fichier duplicata créé correspond à "Dupli_AAAAMMJJ_HHMMSS.dpl".

**`<Format de la date> : (Chaîne de caractères optionnelle)`**

Format de la date utilisée dans le nom du fichier. Ce paramètre peut contenir un mot, une phrase, ... Les caractères spécifiques représentant les différents éléments de la date (AAAA, AA, MM ou JJ) seront automatiquement remplacés par leur valeur. Dans cette chaîne :

- AAAA représente l'année,

- M représente le mois (le zéro n'est pas affiché devant le numéro du mois), 

- MM représente le mois sur 2 chiffres,

- MMM représente le mois en lettres sur 3 caractères (par exemple jan),

- MMMM représente le mois en lettres complet (par exemple janvier),

- J représente le jour (le zéro n'est pas affiché devant le numéro du jour), 

- JJ représente le jour sur 2 chiffres,

- JJJ représente le jour en lettres sur 3 caractères (par exemple lun),

- JJJJ représente le jour en lettres complet (par exemple lundi).




Si ce paramètre correspond à la constante *maskDateSystème*, le format utilisé correspond au format défini dans la description du projet pour la langue en cours. Pour définir ce format : 
**1.** Sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description". 
**2.** Affichez l'onglet "Langues".

Si ce paramètre n'est pas spécifié, le format utilisé par défaut est JJ/MM/AAAA.

**`<Format de l'heure> : (Chaîne de caractères optionnelle)`**

Format de l'heure utilisée dans le nom du fichier. Ce paramètre correspond à une chaîne de caractères (une phrase par exemple). Les caractères spécifiques représentant les différents éléments de l'heure (HH, MM, SS, CC ou AP) seront automatiquement remplacés par leur valeur. Dans cette chaîne :

- HH représente le nombre d'heures,

- MM représente le nombre de minutes,

- SS représente le nombre de secondes,

- CC représente le nombre de centièmes de seconde,

- AP représente "AM" ou "PM" (si "AM" est présent dans le format, l'heure est affichée sur 12 heures).




Si ce paramètre n'est spécifié, le format du résultat est HH:MM:SS:CC.

**`<Mot de passe> : (Chaîne de caractères optionnelle)`**

Mot de passe des fichiers duplicata générés.


<a name="SYNTAXE2"></a>

### Paramétrer la signature du duplicata

`iParamètreDuplicata(<Options> , <Certificat>)`
---

**`<Options> : (Constante de type Entier)`**

Options de signature des duplicata : 


|   |   |
| --- | --- |
| *iDplCertificat* | Utilise le certificat spécifié pour signer le duplicata.<br><br>**Remarque** : Depuis le visualisateur de rapports, cette signature sera utilisée : <br><br>- si l'état est imprimé via l'option d'export "Duplicata"  : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_duplicata.gif)<br><br>- si l'état est imprimé via l'option d'impression sur une imprimante.<br><br><br> |



**`<Certificat> : (Variable de type Certificat)`**

Nom de la variable de type [Certificat](../WDLang1/1000019287.md) correspondant au certificat à utiliser pour signer le duplicata.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Impression d'un duplicata depuis le visualisateur de rapports
<a name="impression_duplicata_depuis_visualisateur_rapports_ELTPARAGRAPHE000135"></a>Si un duplicata a été demandé avant d'afficher l'impression dans le visualisateur de rapports, le duplicata sera généré lors de l'impression physique réalisée depuis le visualisateur de rapports. 

Si une annotation ou un champ de saisie est modifié dans le visualisateur de rapports, un nouveau duplicata sera généré lors de la prochaine impression physique. 

Si l'impression est effectuée sur plusieurs imprimantes différentes, un duplicata sera généré pour chaque imprimante. 

La configuration définie avec la fonction **iParamètreDuplicata** est utilisée pour : 

- les duplicata générés lors de l'impression

- les duplicata générés par l'option "Duplicata" (![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_duplicata.gif)) présente dans le visualisateur de rapports. 




**Notes** : 

- La liste des fichiers duplicata créés pour la dernière impression effectuée peut être connue grâce à la fonction [iDernierFichier](../WDLang5/3046068.md). 

- Pour ne plus créer automatiquement de duplicata depuis le visualisateur de rapports, utilisez la fonction **iParamètreDuplicata** avec la constante *iDplAucun*. 

- Pour ne pas proposer l'impression de duplicata depuis le visualisateur de rapports (option ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_duplicata.gif)), utilisez la fonction [iParamètreVisualisateur](../WDLang5/1000024634.md). 

- Les duplicata sont générés uniquement lors d'une impression sur une imprimante. Les duplicata ne sont pas générés si l'utilisateur utilise une des options d'export (pdf, email, ...) proposées dans le visualisateur de rapports. 




<a name="XComposante"></a>

## Composante :
wd280prn.dll
