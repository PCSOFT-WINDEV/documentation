


## xlsDonnée (Fonction)

***En anglais : xlsData***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère le contenu d'une cellule d'un fichier XLS. Selon le mode d'ouverture du fichier XLS, le résultat peut varier :

- En mode multi-feuilles, la donnée récupérée est située sur la feuille sélectionnée avec la fonction [xlsFeuilleEnCours](../WDLang5/3080022.md).

- En mode compatible, la donnée récupérée est toujours située sur la première feuille du classeur.




**Remarque** : Le contenu d'une cellule d'un fichier XLS peut être récupéré uniquement si :

- Le fichier XLS existe.

- Le fichier XLS est ouvert.



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003080021&name=xlsdonnee_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Déclaration des variables
ResDonnée est une chaîne
IDFichierXLS est un entier

// Ouverture d'un fichier XLS
IDFichierXLS = xlsOuvre("C:\MonRépertoire\Fichier.XLS")
SI IDFichierXLS <> -1 ALORS
	// Récupération de la valeur d'une cellule
	ResDonnée = xlsDonnée(IDFichierXLS, 3, 4)
	...
FIN
```
<a name="Exemple2"></a>

```wl
cMonFicXLS est xlsDocument

cMonFicXLS = xlsOuvre(sMonFichier, xlsEcriture)
SI ErreurDétectée = Faux ALORS
	Azz est un entier = xlsFeuilleEnCours(cMonFicXLS)
	Info("Feuille en cours dans le fichier Excel : " + Azz)
	// Changement de feuille
	SI xlsFeuilleEnCours(cMonFicXLS, 2) = Vrai ALORS
		Info("La feuille courante a été modifiée.")
		// Lecture d'une cellule pour test
		Info(xlsDonnée(cMonFicXLS, 11, 2))
	SINON
		Erreur("Le fichier sélectionné ne comporte pas de seconde feuille !")
	FIN 
SINON
	Erreur(ErreurInfo(errComplet))
FIN
xlsFerme(cMonFicXLS)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Syntaxe utilisant le type xlsDocument

`<Résultat> = xlsDonnée(<Document XLS> , <Numéro de la ligne> , <Numéro de la colonne> [, <Lignes et colonnes vides>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Contenu de la cellule spécifiée. 

- Si le contenu de la cellule correspond à une chaîne vide (""), cela peut correspondre à une erreur. Dans ce cas, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u> et la fonction [xlsMsgErreur](../WDLang5/3080016.md) renvoie le libellé de l'erreur.




**`<Document XLS> : (Variable de type xlsDocument)`**

Nom de la variable de type [xlsDocument](../WDLang5/1000017464.md) à utiliser.

**`<Numéro de la ligne> : (Entier)`**

Numéro de la ligne de la cellule à lire.

**`<Numéro de la colonne> : (Entier)`**

Numéro de la colonne de la cellule à lire.

**`<Lignes et colonnes vides> : (Booléen optionnel)`**

Mode de prise en compte des colonnes et des lignes vides : 



|   |   |
| --- | --- |
| *Faux* | Les lignes et les colonnes entièrement vides sont prises en compte. |
| *Vrai*<br>(par défaut) | Les lignes et les colonnes entièrement vides ne sont pas prises en compte. |




<a name="SYNTAXE2"></a>

### Syntaxe conservée par compatibilité avec la version 12

`<Résultat> = xlsDonnée(<Identifiant du fichier XLS> , <Numéro de la ligne> , <Numéro de la colonne> [, <Lignes et colonnes vides>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Contenu de la cellule spécifiée. 

- Si le contenu de la cellule correspond à une chaîne vide (""), cela peut correspondre à une erreur. Dans ce cas, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u> et la fonction [xlsMsgErreur](../WDLang5/3080016.md) renvoie le libellé de l'erreur.




**Remarque** : Si le fichier Excel a été ouvert en mode compatible, le contenu de la cellule est limité à 255 caractères.

**`<Identifiant du fichier XLS> : (Entier)`**

Identifiant du fichier XLS à manipuler, renvoyé par la fonction [xlsOuvre](../WDLang5/3080017.md).

**`<Numéro de la ligne> : (Entier)`**

Numéro de la ligne de la cellule à lire.

**`<Numéro de la colonne> : (Entier)`**

Numéro de la colonne de la cellule à lire.

**`<Lignes et colonnes vides> : (Booléen optionnel)`**

Mode de prise en compte des colonnes et des lignes vides :



|   |   |
| --- | --- |
| *Faux* | Les lignes et les colonnes entièrement vides sont prises en compte. |
| *Vrai*<br>(par défaut) | Les lignes et les colonnes entièrement vides ne sont pas prises en compte. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Contenu des cellules : prise en compte des lignes et colonnes vides
<a name="contenu_des_cellules_prise_compte_des_lignes_colonnes_vides_ELTPARAGRAPHE000130"></a>Les lignes et les colonnes vides peuvent être prises en compte ou non. Par exemple :
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=xlsDonnee.gif)

```wl
xlsDonnée(IDFichierXLS, 2, 3, Vrai) 
// Retourne le contenu de la cellule D2 : "23"
xlsDonnée(IDFichierXLS, 2, 3, Faux) 
// Retourne le contenu de la cellule C2 : ""
```
Dans cet exemple, la colonne C (qui est entièrement vide) peut être prise en compte ou non.
<a name="NOTE0_2"></a>


### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000140"></a>En cas d'erreur, la fonction **xlsDonnée** renvoie une chaîne vide (""). Pour connaître le libellé de l'erreur, utilisez la fonction [xlsMsgErreur](../WDLang5/3080016.md) ou la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.

La fonction **xlsDonnée** génère une erreur dans les cas suivants :

- La ligne et/ou la colonne spécifiée sont vides.

- Le fichier XLS spécifié n'existe pas.

- Le fichier XLS spécifié n'est pas ouvert.



<a name="NOTE0_3"></a>


### Type de donnée récupérée
<a name="type_donnee_recuperee_ELTPARAGRAPHE000165"></a>Quel que soit le format de cellule défini sous Excel, la fonction **xlsDonnée** renvoie une chaîne.

Attention : Le type "Numérique haute précision" n'est pas supporté par Excel : la valeur du numérique récupéré sera tronquée.


|   |   |
| --- | --- |
| **Si le contenu de la cellule spécifiée est de type** : | **Le résultat est converti en** : |
| Numérique | Chaîne |
| Date | Chaîne au format JJ/MM/AAAA |
| Heure | Chaîne au format HH:MM:SS |



<a name="XComposante"></a>

## Composante :
wd280xls.dll
