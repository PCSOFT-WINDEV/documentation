


## XMLLit (Fonction)

***En anglais : XMLRead***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie la valeur d'un élément XML ou la valeur de l'attribut d'un élément XML.  








<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MonDoc est une chaîne = fChargeTexte("exemple.xml")
XMLDocument("DOM", MonDoc)
sNomFonction est une chaîne = XMLLit("DOM","/Exemple/Aide/Fonction")
sTypeFonction est une chaîne = XMLLit("DOM","Aide/Fonction/@type")
sNomFonction2 est une chaîne = XMLLit("DOM","Aide/Fonction[2]")
sImage est une chaîne = XMLLit("DOM","Aide[2]/@image")
sTypeImage est une chaîne = XMLLit("DOM","/Exemple/Aide[@image=""trait.jpg""]/@format", "NonDefini")
XMLTermine("DOM")
// S'applique au document XML suivant:
// <Exemple>
// <Aide>
// <Fonction type="1">Lire</Fonction>
// <Fonction>Ecrire</Fonction>
// </Aide>
// <Aide image="trait.jpg" format="jpg" />
// </Exemple>
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = XMLLit(<Document XML> , <Chemin de l'élément à lire> [, <Non trouvé>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Valeur de l'élément ou de l'attribut, 

- Chaîne vide ("") ou la valeur du paramètre &lt;Non trouvé&gt; dans les cas suivants :

	- si l'élément n'a pas été trouvé.

	- si l'élément n'a pas de valeur

	- si la requête XPath n'est pas une requête de sélection d'enregistrements.
			Dans ce cas, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u> et la fonction [ErreurInfo](../WDLang1/3013008.md) permet d'obtenir plus de détails sur l'erreur.







**`<Document XML> : (Chaîne de caractères)`**

Nom du document XML dans lequel la lecture doit être effectuée. Ce document contient le code XML à analyser et a été créé avec la fonction [XMLDocument](../WDLang5/3081008.md).

**`<Chemin de l'élément à lire> : (Chaîne de caractères)`**

Peut correspondre :

- au chemin dans le XML de la valeur à lire. Attention : la casse utilisée est prise en compte (minuscules et majuscules). Pour lire la valeur d'un attribut, il suffit de faire précéder le nom de l'attribut par le caractère "@".

- au texte d'une requête XPath à exécuter. La requête XPath doit être de type "sélection d'enregistrements". Si plusieurs éléments répondent à la sélection, le premier trouvé est utilisé.




Si ce chemin ne commence pas par "/", le nom du noeud racine est automatiquement ajouté. Si le document XML n'a pas de racine, &lt;Résultat&gt; correspond à &lt;Non trouvé&gt;.

**`<Non trouvé> : (Chaîne de caractères optionnelle)`**

Texte à renvoyer si l'élément n'a pas été trouvé. Par défaut, ce paramètre correspond à une chaîne vide ("").  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Cas particuliers
<a name="cas_particuliers_ELTPARAGRAPHE000100"></a>

- La fonction **XMLLit** ne modifie pas la position courante dans le document.

- Il n'est pas possible d'imbriquer plusieurs requêtes XML de parcours.

- La fonction **XMLLit** ne doit pas être utilisée avec une variable de type [XMLDocument](../WDLang5/1000018782.md). Pour lire le contenu d'une variable de type [XMLDocument](../WDLang5/1000018782.md), utilisez la syntaxe "POUR TOUT".



<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Assistant de code
<a name="assistant_code_ELTPARAGRAPHE000123"></a>L'éditeur de code propose un assistant de code permettant de générer le code de la fonction **XMLLit**. Pour l'utiliser, tapez "XMLLit(" sous l'éditeur de code puis sélectionnez l'option "Assistant de la fonction XMLLit".

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280xml.dll
