
## CBDécode (Fonction)

***En anglais : BCDecode***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Décode les informations stockées dans un code-barres. Ce code-barres est contenu dans une image (image affichée dans un champ Image, fichier d'une image ou image en mémoire).

Le type des code-barres décodés dépend de la plateforme d'exécution :   

- ![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Seuls les QR Code peuvent être décodés.




**Attention** : Le code-barres doit couvrir une partie suffisante de l'image source et être suffisamment contrasté et net pour que le décodage soit réalisé.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
```wl
// Décodage d'un QR Code à partir d'un champ Caméra
s est un Buffer
s = dSauveImageBMP(CAM_SansNom1, enMémoire)
cb est un CodeBarres 
cb = CBDécode(s)
SI ErreurDétectée = Faux _ET_ cb.TypeCodeBarres = CB_QRCODE 
		_ET_ cb.TypeContenu = cbTypeEmail ALORS
    	Info("Adresse email : " + cb.Contenu)
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = CBDecode(<Image>)`
---

**`<Résultat> : (Variable de type CodeBarres)`**

Variable de type [CodeBarres](../WDLang5/1000019451.md) initialisée avec les informations lues dans le code-barres.

**`<Image> : (Chaîne de caractères)`**

Image du code-barres à décoder. Ce paramètre peut correspondre : 

- soit au nom d'un champ Image. 

- soit au buffer d'une image retourné par les fonctions [dSauveImageBmp](../WDLang1/3029026.md), [dSauveImageGif](../WDLang1/3029040.md), [dSauveImageJpeg](../WDLang1/3029038.md) et [dSauveImagePNG](../WDLang1/3029027.md). 

- soit au nom d'un fichier image. 









## Remarques
<a name="NOTE0_1"></a>


### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000096"></a>Pour savoir si la récupération a échoué, utilisez : 

- soit la variable [ErreurDétectée](../WDLang1/3087001.md), 

- ![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) soit la propriété **TypeCodeBarre** de la variable [CodeBarres](../WDLang5/1000019451.md). Si cette propriété est différente de CB_QRCODE, le code-barres n'a pas été détecté ou décodé.



<a name="NOTE0_2"></a>


### Décodage de QRCode
<a name="decodage_qrcode_ELTPARAGRAPHE000114"></a>Le tableau suivant présente la correspondance entre la propriété **TypeContenu** et la propriété **Contenu** de la variable [CodeBarres](../WDLang5/1000019451.md) : 

| Type de contenu | Type de la valeur (..Contenu) | Remarque |
| --- | --- | --- |
| *cbTypeTexte* | Chaîne de caractères | Exemple : "WINDEV c'est bien !" |
| *cbTypeTéléphone* | Chaîne de caractères | Exemple : "0612345678" |
| *cbTypeSMS* | Chaîne de caractères<br>Les membres de la [structure SMS](../WDLang3/3068003.md) (SMS.Message et SMS.Numéro) seront automatiquement renseignés avec les valeurs lues dans le code-barres. Le contenu correspondra à une chaîne de la forme : &lt;Numéro&gt; + RC + &lt;Message&gt; | Exemple : "0612345678&lt;RC&gt;Texte à envoyer" |
| *cbTypeURL* | Chaîne de caractères | Exemple : "http://www.google.fr" |
| *cbTypeMarket* | Chaîne de caractères | Exemple : "market://search?q=pname:com.societe.application" |
| *cbTypeWiFi* | Chaîne de caractères | Chaîne de caractères de la forme : <br>&lt;SSID&gt; + TAB + &lt;Protocole de sécurité&gt;+ TAB + &lt;Clé&gt;<br>Exemple : "MonRéseau&lt;TAB&gt;WPA&lt;TAB&gt;mdp" |
| *cbTypeEmail* | Chaîne de caractères | Exemple : "nom@mail.com" |
| *cbTypeContact* | Vide. <br>Les membres de la [structure mContact](../WDLang3/1000006111.md) seront automatiquement renseignés avec les valeurs lues dans le code-barres.<br> |   |
| *cbTypePosition* | Variable de type [géoPosition](../WDLang3/1000019191.md).<br><br>Les propriétés **Latitude** et **Longitude** de la variable seront automatiquement renseignées avec les valeurs lues dans le code-barres. |   |





<a name="XComposante"></a>

## Composante :
wd280barc.dll
