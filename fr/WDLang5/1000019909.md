


## CBCalculeCaractèreDeVérification (Fonction)

***En anglais : BCCalculateControlCharacter***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Retourne le code de contrôle d'un code-barres.

**Remarque** : Cette fonction n'est pas disponible pour les codes-barres de type DataMatrix, PDF417, QR-Code.  
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MonCodeBarres est un CodeBarres
MonCodeBarres.Contenu = "012345678901"
MonCodeBarres.TypeCodeBarres = CB_EAN13
CaractVérif est une chaîne
CaractVérif = CBCalculeCaractèreDeVérification(MonCodeBarres)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Caractère de vérification d'un code-barres présent dans une variable de type CodeBarres

`<Résultat> = CBCalculeCaractèreDeVérification(<Code-barres>)`
---

**`<Résultat> : (Chaîne de caractères)`**

Caractère(s) de vérification du code-barres.

En cas d'erreur, la fonction [ErreurInfo](../WDLang1/3013008.md) retourne le détail de l'erreur.  

**`<Code-barres> : (Variable de type CodeBarres)`**

Nom de la variable de type [CodeBarres](../WDLang5/1000019451.md) contenant la description du code-barres à analyser. 


<a name="SYNTAXE2"></a>

### Caractère de vérification d'un code-barres spécifique

`<Résultat> = CBCalculeCaractèreDeVérification(<Type de code-barres> , <Valeur du code-barres> , <Code étendu>)`
---

**`<Résultat> : (Chaîne de caractères)`**

Caractère(s) de vérification du code-barres.

En cas d'erreur, la fonction [ErreurInfo](../WDLang1/3013008.md) retourne le détail de l'erreur. 

**`<Type de code-barres> : (Entier)`**

Type du code-barres à analyser (les différents types de codes-barres gérés par WINDEV sont présentés dans la page [Gestion des codes-barres](../WDLang5/3046064.md)).


|   |   |   |
| --- | --- | --- |
| *CB_CODABAR* | Code-barres de type Codabar. | Code-barres utilisable avec &lt;Code Étendu&gt; correspondant à *CB_Vérification*. |
| *CB_CODE11* | Code-barres de type Code11. |   |
| *CB_CODE39* | Code-barres de type Code39. | Code-barres utilisable avec &lt;Code Étendu&gt; correspondant à *CB_Etendu* ou *CB_Vérification*<br>La valeur du code-barres peut contenir les caractères de début et de fin (caractère "\*"). Dans ce cas, ces caractères seront ajoutés dans le dessin du code-barres et imprimés dans le texte sous le code-barres.<br>Si ces caractères ne sont pas présents dans la valeur du code-barres, ils seront automatiquement ajoutés dans le dessin du code-barres.<br> Par contre, ils n'apparaîtront pas dans le texte affiché sous le code-barres. |
| *CB_CODE93* | Code-barres de type Code93. | Code-barres utilisable avec &lt;Code Étendu&gt; correspondant à *CB_Etendu* ou *CB_Vérification*). |
| *CB_CODE128* | Code-barres de type Code128. |   |
| *CB_EAN8* | Code-barres de type EAN-8. | Valeurs possibles du code-barres :<br><br>- 7 caractères,<br><br>- 7 caractères + 2 caractères supplémentaires (exemple "0123456+22")<br><br>- 12 caractères + 5 caractères supplémentaires (exemple "0123456+22335")<br><br><br>Un caractère de contrôle est automatiquement inséré après le 7ème caractère. |
| *CB_EAN13* | Code-barres de type EAN-13. | Valeurs possibles du code-barres :<br><br>- 12 caractères,<br><br>- 12 caractères + 2 caractères supplémentaires (exemple "012345678912+22")<br><br>- 12 caractères + 5 caractères supplémentaires (exemple "01234567891+22335")<br><br><br>Un caractère de contrôle est automatiquement inséré après le 12ème caractère. |
| *CB_EAN128* | Code-barres de type EAN-128. |   |
| *CB_GS1_128* | Code-barres de type GS1-128 (nouveau nom du code-barres EAN-128). |   |
| *CB_INTER2OF5* | Code-barres de type Interleaved 2 of 5. | Code-barres utilisable avec &lt;Code Étendu&gt; correspondant à *CB_Vérification*. |
| *CB_MSI* | Code-barres de type MSI. |   |
| *CB_UPCA* | Code-barres de type UPC-A. | Valeurs possibles du code-barres :<br><br>- 11 caractères,<br><br>- 11 caractères + 2 caractères supplémentaires (exemple "01234567891+22")<br><br>- 11 caractères + 5 caractères supplémentaires (exemple "01234567891+22335")<br><br><br>Un caractère de contrôle est automatiquement inséré après le 11ème caractère. |
| *CB_UPCE* | Code-barres de type UPC-E. | Valeurs possibles du code-barres :<br><br>- 11 caractères,<br><br>- 11 caractères + 2 caractères supplémentaires (exemple "01234567891+22")<br><br>- 11 caractères + 5 caractères supplémentaires (exemple "01234567891+22335")<br><br><br>Un caractère de contrôle est automatiquement inséré après le 11ème caractère. |



**`<Valeur du code-barres> : (Chaîne de caractères)`**

Valeur du code-barres à manipuler. 

**`<Code étendu> : (Constante ou combinaison de constantes de type Entier)`**

Caractéristiques du code-barres.


|   |   |
| --- | --- |
| *CB_CaractèreControle* | Code-barres contenant des caractères de contrôle (valable uniquement pour les codes-barres de type *CB_CODE128* et *CB_EAN128*). Par défaut, les caractères de contrôle sont encadrés par les caractères "&lt;" et "&gt;". Pour ne pas interpréter ces caractères comme caractères de contrôle, il suffit de doubler le premier "&lt;" :  <br><br>- "&lt;C40&gt;" = caractère de contrôle,<br><br>- "&lt;&lt;AB&gt;" = chaîne &lt;AB&gt; à encoder dans le code-barres.<br><br><br><br><br>Pour plus de détails sur les caractères acceptés, consultez [Les différents types de codes-barres](../WDLang5/3046064.md). |
| *CB_CaractèreVérification* | Code-barres contenant des caractères de vérification (valable uniquement pour les codes-barres de type *CB_CODE128* et *CB_EAN128*).<br>Si cette option est sélectionnée, les constantes *CB_CaractèreControle* et *CB_JeuxCaractères* sont automatiquement prises en compte. |
| *CB_Etendu* | Code-barres étendu (valable uniquement pour les codes-barres de type *CB_CODE39* et *CB_CODE93*). |
| *CB_IgnoreFormatage* | Ignore les parenthèses d'un code 128 ou EAN-128 (valable uniquement pour les codes-barres de type *CB_CODE128* et *CB_EAN128*).<br>Les parenthèses sont utilisées pour rendre le code-barres plus lisible par un humain, mais ne sont pas dessinées dans le code. |
| *CB_JeuxCaractères* | Code-barres utilisant un ou plusieurs jeux de caractères utilisés pour la compression du code-barres. Ce jeu de caractères doit être défini dans la valeur du code-barres.<br>Pour plus de détails sur les jeux de caractères, consultez [Les différents types de codes-barres](../WDLang5/3046064.md). |
| *CB_Vérification* | Code-barres avec caractères de vérification (valable uniquement pour les codes-barres de type *CB_CODE39*, *CB_CODE93*, *CB_INTER2OF5* et *CB_CODABAR*). |





<a name="XComposante"></a>

## Composante :
wd280barc.dll
