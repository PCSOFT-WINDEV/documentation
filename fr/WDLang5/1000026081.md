
## htmlNoeud (Type de variable)

***En anglais : htmlNode***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **htmlNoeud** permet de définir toutes les caractéristiques avancées d'un noeud d'un document HTML. Les caractéristiques de ce noeud peuvent être définies et modifiées à l'aide de différentes propriétés WLangage. 

**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MonDocument est un htmlDocument

// Récupère le document depuis le champ d'affichage HTML
MonDocument = HTM_Source.ValeurAffichée


// On veut récupérer uniquement les tarifs de livraison en points relais en fonction du poids
// On récupère les pays
// Dans le thead / 2ème TR / 3 premiers TD
sPays1, sPays2, sPays3 est une chaîne

// On récupère le tableau des headers
tabHeader est un tableau de htmlNoeud = MonDocument.ChercheElémentParBalise("thead")

// Sur le premier élément, on prend le deuxième fils (le deuxième TR)
// Le premier fils de ce TR, c'est le TD du premier pays
// A l'intérieur du TD, il peut y avoir d'autre balises (span, p) pour gérer les styles
// Mais le contenu final est dedans, donc on peut récupérer le HTMLInterne du TD et 
// Le convertir "directement" en texte

sPays1 = HTMLVersTexte(tabHeader[1].tr[2].td[1]..HTMLInterne)
// Le second fils de ce TR, c'est le TD du second pays
sPays2 = HTMLVersTexte(tabHeader[1].tr[2].td[2]..HTMLInterne)
// Le troisième fils de ce TR, c'est le TD du troisième pays
sPays3 = HTMLVersTexte(tabHeader[1].tr[2].td[3]..HTMLInterne)

sPoids, sTarifPays1, sTarifsPays2, sTarifPays3 sont des chaînes

// Modifie les titres des colonnes de la table
TABLE_Tarifs.COL_Pays1.Libellé = sPays1
TABLE_Tarifs.COL_Pays2.Libellé = sPays2
TABLE_Tarifs.COL_Pays3.Libellé = sPays3

POUR i = 1 _À_ 9

	// On récupère le poids et les tarifs par pays

	sPoids = MonDocument.html.body.div.div.table.tbody.tr[i].td[1]..Texte
	sTarifPays1 = MonDocument.html.body.div.div.table.tbody.tr[i].td[3]..Texte
	sTarifsPays2 = MonDocument.html.body.div.div.table.tbody.tr[i].td[4]..Texte
	sTarifPays3 = MonDocument.html.body.div.div.table.tbody.tr[i].td[5]..Texte
	
	TABLE_Tarifs.AjouteLigne(sPoids, sTarifPays1, sTarifsPays2, sTarifPays3)
	
FIN
```





## Déclaration
<a name="declaration_ELTTEXTE000295"></a>
<a name="SYNTAXE1"></a>

### Déclarer un noeud

`MaVariable est un htmlNoeud`
---

Pour décrire un noeud HTML, le nom du noeud peut ensuite être spécifié par la propriété **NomBalise**. 


<a name="SYNTAXE2"></a>

### Créer un noeud HTML

`MaVariable est un htmlNoeud (<Nom balise>)`
---

**`<Nom balise> : (Chaîne de caractères)`**

Nom du noeud à créer.  









<a name="NOTE0"></a>

## Remarques
<a name="NOTE0_1"></a>


### Propriétés spécifiques à la description des variables de type htmlNoeud
<a name="proprietes_specifiques_description_des_variables_type_htmlnoeud_ELTPARAGRAPHE000044"></a>Les propriétés suivantes peuvent être utilisées pour manipuler un noeud d'un document HTML :

| Nom de la propriété | Type manipulé | Effet |
| --- | --- | --- |
| Attribut | Tableau de [htmlAttribut](../WDLang5/1000025912.md) | Attributs pour un noeud de type *htmlNoeudElément*. |
| Existe | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> si le noeud existe réellement dans le document, <br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. <br><br><br>**Cette propriété est disponible en lecture seulement**. |
| HTMLExterne | Chaîne de caractères | Code HTML incluant le noeud courant (sous-noeud compris). <br><br>**Cette propriété est disponible en lecture seulement**. |
| HTMLInterne | Chaîne de caractères | Code HTML des sous-noeuds dans le noeud courant. |
| Indice | Entier | Indice du noeud dans son parent.  <br><br>**Cette propriété est disponible en lecture seulement**. |
| NoeudFils | Tableau de variables de type **htmlNoeud** | Noeuds fils pour un noeud de type *htmlNoeudElément*. |
| NomBalise | Chaîne de caractères | Nom de la balise si le noeud est de type *htmlNoeudElément*, chaîne vide ("") dans les autres cas. |
| Occurrence | Entier | Nombre d'éléments de même nom. <br><br>**Cette propriété est disponible en lecture seulement**. |
| Parent | Variable de type **htmlNoeud** | Noeud parent, NULL si le noeud est la racine. <br><br>**Cette propriété est disponible en lecture seulement**. |
| Texte | Chaîne de caractères | Contenu du noeud encodé dans l'alphabet courant. <br><br>- Si le noeud est de type *htmlNoeudTexte*, *htmlNoeudCommentaire* ou *htmlNoeudCDATA*, la propriété renvoie et affecte le noeud.<br><br>- Si le noeud est de type *htmlNoeudElément*, la propriété renvoie la concaténation du texte de tous les sous-noeuds.<br><br><br>L'affectation de la propriété vide les sous-noeuds et les remplace par un sous-noeud de type texte contenant la valeur affectée. |
| Type | Constante de type Entier | Type du noeud : <br><br>- *htmlNoeudCommentaire* : Noeud de type commentaire. <br><br>- *htmlNoeudCDATA* : Noeud CDATA (compatibilité XHTML). <br><br>- *htmlNoeudElément* : Noeud de type élément, une balise du HTML.  <br><br>- *htmlNoeudTexte* : Noeud de type texte.<br><br><br> |


<a name="NOTE0_2"></a>
Pour un noeud de type *htmlNoeudElément*, les opérateurs suivants sont disponibles : 

- Opérateur "." : L'opérateur "." permet d'accéder aux sous-éléments par leur nom de balise. 

- Opérateur ":" : L'opérateur ":" permet d'accéder aux attributs par leur nom. 

- Opérateur [ &lt;indice&gt; ] : Cet opérateur permet d'accéder aux sous-éléments frère de même nom par leur indice. 

- Opérateur [ &lt;nom&gt; ] : Cet opérateur permet d'accéder aux sous-éléments par leur nom de balise. 




Les noeuds de type *htmlNoeudElément* peuvent contenir des sous-noeuds. 

**Parcours des sous-noeuds**

- La syntaxe "POUR TOUT x DE VariableNoeud" permet de parcourir tous les sous-noeuds.

- La syntaxe "POUR TOUT x DE VariableNoeud EN PROFONDEUR" permet de parcourir récursivement tous les sous-noeuds.
	



<a name="NOTE0_3"></a>


### Création d'un noeud texte
<a name="creation_noeud_texte_ELTPARAGRAPHE000190"></a>La déclaration d'un noeud texte peut être effectuée via une des syntaxes suivante : 

- Déclaration implicite : 
	
	```txt
	o est un htmlNoeud
	o.Texte = "A"
	```


- Déclaration explicite : 
	
	```txt
	o est un htmlNoeud
	o.Type = htmlNoeudTexte
	o.Texte = "A"
	```






<a name="NOTE0_4"></a>


### Fonctions WLangage manipulant des variables de type htmlNoeud
<a name="fonctions_wlangage_manipulant_des_variables_type_htmlnoeud_ELTPARAGRAPHE000205"></a>

- syntaxe classique : 
	


|   |   |
| --- | --- |
| [HTMLChercheElémentParBalise](../WDLang5/1000026272.md) | Cherche les éléments d'un document HTML (ou d'un noeud HTML) correspondant à une balise. |
| [HTMLChercheElémentParClasse](../WDLang5/1000026177.md) | Cherche les éléments d'un document HTML (ou d'un noeud HTML) pour lesquels l'attribut "class" correspond à une valeur spécifique. |
| [HTMLChercheElémentParID](../WDLang5/1000025915.md) | Cherche l'élément d'un document HTML (ou d'un noeud HTML) dont l'attribut "ID" correspond à une valeur spécifique. |
| [HTMLChercheElémentParNom](../WDLang5/1000025913.md) | Cherche les éléments d'un document HTML (ou d'un noeud HTML) dont l'attribut "name" correspond à une valeur spécifique. |
| [HTMLDésencadreTousLesFils](../WDLang5/1410087613.md) | Supprime le noeud spécifié dans un document HTML sans supprimer ses fils, qui prennent sa place. |
| [HTMLEncadre](../WDLang5/1410087611.md) | Encadre le noeud spécifié dans un noeud donné d'un document HTML. |
| [HTMLEncadreTousLesFils](../WDLang5/1410087612.md) | Encadre tous les fils du noeud donné dans un nouveau noeud dans un document HTML. |
| [HTMLInsèreAprès](../WDLang5/1410087610.md) | Ajoute un noeud après le noeud spécifié dans un document HTML. |
| [HTMLInsèreAvant](../WDLang5/1410087609.md) | Ajoute un noeud avant le noeud spécifié dans un document HTML. |
| [HTMLInsèreDernierFils](../WDLang5/1410087616.md) | Ajoute un fils après les fils du noeud courant dans un document HTML. |
| [HTMLInsèrePremierFils](../WDLang5/1410087615.md) | Ajoute un fils au début des fils du noeud courant dans un document HTML. |
| [HTMLModifieAttribut](../WDLang5/1410087618.md) | Ajoute ou modifie un attribut du noeud courant du document HTML. |
| [HTMLSupprime](../WDLang5/1410087614.md) | Supprime le noeud spécifié et son arborescence dans un document HTML. |
| [HTMLSupprimeAttribut](../WDLang5/1410087619.md) | Supprime un attribut donné |
| [HTMLSupprimeFils](../WDLang5/1410087617.md) | Supprime un noeud donné dans le noeud courant d'un document HTML. |

- syntaxe préfixée : 
	


|   |   |
| --- | --- |
| [&lt;Variable htmlNoeud&gt;.ChercheElémentParBalise](../WDLang5/1000026313.md) | Cherche les éléments d'un noeud HTML correspondant à une balise. |
| [&lt;Variable htmlNoeud&gt;.ChercheElémentParClasse](../WDLang5/1000026315.md) | Cherche les éléments d'un noeud HTML pour lesquels l'attribut "class" correspond à une valeur spécifique. |
| [&lt;Variable htmlNoeud&gt;.ChercheElémentParID](../WDLang5/1000026317.md) | Cherche l'élément d'un noeud HTML dont l'attribut "ID" correspond à une valeur spécifique. |
| [&lt;Variable htmlNoeud&gt;.ChercheElémentParNom](../WDLang5/1000026319.md) | Cherche les éléments d'un noeud HTML dont l'attribut "name" correspond à une valeur spécifique. |
| [&lt;Variable htmlNoeud&gt;.DésencadreTousLesFils](../WDLang5/1410088108.md) | Supprime le noeud spécifié dans un document HTML sans supprimer ses fils, qui prennent sa place. |
| [&lt;Variable htmlNoeud&gt;.Encadre](../WDLang5/1410088117.md) | Encadre le noeud spécifié dans un noeud donné d'un document HTML. |
| [&lt;Variable htmlNoeud&gt;.EncadreTousLesFils](../WDLang5/1410088109.md) | Encadre tous les fils du noeud donné dans un nouveau noeud dans un document HTML. |
| [&lt;Variable htmlNoeud&gt;.InsèreAprès](../WDLang5/1410088110.md) | Ajoute un noeud après le noeud spécifié dans un document HTML. |
| [&lt;Variable htmlNoeud&gt;.InsèreAvant](../WDLang5/1410088111.md) | Ajoute un noeud avant le noeud spécifié dans un document HTML. |
| [&lt;Variable htmlNoeud&gt;.InsèreDernierFils](../WDLang5/1410088112.md) | Ajoute un fils après les fils du noeud courant dans un document HTML. |
| [&lt;Variable htmlNoeud&gt;.InsèrePremierFils](../WDLang5/1410088113.md) | Ajoute un fils au début des fils du noeud courant dans un document HTML. |
| [&lt;Variable htmlNoeud&gt;.ModifieAttribut](../WDLang5/1410088114.md) | Ajoute ou modifie un attribut du noeud courant du document HTML. |
| [&lt;Variable htmlNoeud&gt;.Supprime](../WDLang5/1410088115.md) | Supprime le noeud spécifié et son arborescence dans un document HTML. |
| [&lt;Variable htmlNoeud&gt;.SupprimeAttribut](../WDLang5/1410088118.md) | Supprime un attribut donné |
| [&lt;Variable htmlNoeud&gt;.SupprimeFils](../WDLang5/1410088116.md) | Supprime un noeud donné dans le noeud courant d'un document HTML. |







- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LeTypeHTMLDocument.gif) ***Exemples unitaires (WINDEV)*** : **Le Type HTMLDocument** <br>Cet exemple permet de montrer comment utiliser le Type WLangage HTMLDocument.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDExportHTML.gif) ***Exemples didactiques (WINDEV)*** : **WD Export HTML** <br>Cet exemple illustre l'export de données au format HTML avec les fonctions WLangage.<br>Dans cet exemple, nous abordons les thèmes suivants :<br>1/ les manipulations des balises HTML<br>2/ la génération d'un état HTML<br><br>La génération d'une page HTML est réalisée à partir de données contenues dans une table mémoire.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDImportationdepageHTML.gif) ***Composants (WINDEV)*** : **WD Importation de page HTML** <br>Cet exemple illustre comment importer des pages HTML avec les fonctions WLangage.<br>Dans cet exemple, nous abordons deux thèmes principaux :<br>1/ comment importer un objet présent sur un site Web<br>2/ comment analyser un fichier HTML<br>Résumé de l'exemple livré avec WINDEV :	<br>Cet exemple permet de sauvegarder en local une page HTML présente sur un site Web. <br>Cette page est alors analysée afin d'importer également toutes ses dépendances (images, applets…). Cet exemple n'est pas un aspirateur de site. Il permet uniquement de télécharger des pages une par une.<br>Le principe utilisé dans cet exemple peut également permettre la récupération d'informations dans des pages dont vous connaissez le format. (exemple : récupération quotidienne de cotations boursières)


