


## xlsTypeColonne (Fonction)

***En anglais : xlsColumnType***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie le type des données saisies dans une colonne d'un fichier XLS. Selon le mode d'ouverture du fichier XLS, le résultat peut varier :

- En mode multi-feuilles, la colonne manipulée se trouve sur la feuille sélectionnée avec la fonction [xlsFeuilleEnCours](../WDLang5/3080022.md).

- En mode compatible, la colonne manipulée se trouve toujours sur la première feuille du classeur.




**Remarque** : Le type des données saisies dans une colonne d'un fichier XLS ne peut être renvoyé que si :

- Le fichier XLS existe.

- Le fichier XLS est ouvert.





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003080019&name=xlstypecolonne_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Ouverture d'un fichier XLS
IDFichierXLS = xlsOuvre("C:\MonRépertoire\Fichier.XLS")
SI IDFichierXLS <> -1 ALORS
	// Type des données saisies
	ResTitreColonne = xlsTypeColonne(IDFichierXLS, 4)
	SELON ResTitreColonne
		CAS xlsTypeChaîne : Info("Données de type chaîne")
		CAS xlsTypeDate : Info("Données de type Date")
		CAS xlsTypeDouble : Info("Données de type numérique")
		CAS xlsTypeHeure : Info("Données de type heure")
		CAS xlsTypeDateHeure : Info("Données de type DateHeure")
		CAS xlsTypeDurée : Info("Données de type Durée")
		CAS xlsTypeMonétaire : Info("Données de type Monétaire")
	FIN
	...
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Syntaxe utilisant le type xlsDocument

`<Résultat> = xlsTypeColonne(<Document XLS> , <Numéro de la colonne> [, <Colonnes vides>])`
---

**`<Résultat> : (Constante de type entier)`**

Type des données saisies dans la colonne spécifiée :


|   |   |
| --- | --- |
| *xlsTypeChaîne* | Colonne "chaîne de caractères" ou colonne contenant des données de différents types |
| *xlsTypeDate* | Colonne "date" |
| *xlsTypeDateHeure* | Colonne "dateheure" |
| *xlsTypeDouble* | Colonne "numérique" |
| *xlsTypeDurée* | Colonne "durée" |
| *xlsTypeErreur* | En cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [xlsMsgErreur](../WDLang5/3080016.md) ou la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*. |
| *xlsTypeHeure* | Colonne "heure" |
| *xlsTypeMonétaire* | Colonne "monétaire" |
| *xlsTypeVide* | Colonne entièrement vide si &lt;Colonnes Vides&gt; = <u><u><u><u>Faux</u></u></u></u> |



**`<Document XLS> : (Variable de type xlsDocument)`**

Nom de la variable de type [xlsDocument](../WDLang5/1000017464.md) correspondant au fichier XLS à manipuler.

**`<Numéro de la colonne> : (Entier)`**

Numéro de la colonne à lire.

**`<Colonnes vides> : (Booléen optionnel)`**

Mode de prise en compte des colonnes vides :


|   |   |
| --- | --- |
| *Faux* | Les colonnes entièrement vides sont prises en compte |
| *Vrai*<br>(par défaut) | Les colonnes entièrement vides ne sont pas prises en compte |




<a name="SYNTAXE2"></a>

### Syntaxe conservée par compatibilité avec la version 12

`<Résultat> = xlsTypeColonne(<Identifiant du fichier XLS> , <Numéro de la colonne> [, <Colonnes vides>])`
---

**`<Résultat> : (Constante de type entier)`**

Type des données saisies dans la colonne spécifiée :


|   |   |
| --- | --- |
| *xlsTypeChaîne* | Colonne "chaîne de caractères" ou colonne contenant des données de différents types |
| *xlsTypeDate* | Colonne "date" |
| *xlsTypeDateHeure* | Colonne "dateheure" |
| *xlsTypeDouble* | Colonne "numérique" |
| *xlsTypeDurée* | Colonne "durée" |
| *xlsTypeErreur* | En cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [xlsMsgErreur](../WDLang5/3080016.md) ou la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*. |
| *xlsTypeHeure* | Colonne "heure" |
| *xlsTypeMonétaire* | Colonne "monétaire" |
| *xlsTypeVide* | Colonne entièrement vide si &lt;Colonnes Vides&gt; = Faux |



**`<Identifiant du fichier XLS> : (Entier)`**

Identifiant du fichier XLS à manipuler, renvoyé par la fonction [xlsOuvre](../WDLang5/3080017.md).

**`<Numéro de la colonne> : (Entier)`**

Numéro de la colonne à lire.

**`<Colonnes vides> : (Booléen optionnel)`**

Mode de prise en compte des colonnes vides :


|   |   |
| --- | --- |
| *Faux* | Les colonnes entièrement vides sont prises en compte |
| *Vrai*<br>(par défaut) | Les colonnes entièrement vides ne sont pas prises en compte |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Type des données saisies d'une colonne : prise en compte des colonnes vides
<a name="type_des_donnees_saisies_une_colonne_prise_compte_des_colonnes_vides_ELTPARAGRAPHE000187"></a>Les colonnes vides peuvent être prises en compte ou non. Par exemple :<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=xlsTypeColonne.gif)

```wl
xlsTypeColonne(IDFichierXLS, 2, Vrai) // Retourne xlsTypeChaîne
xlsTypeColonne(IDFichierXLS, 2, Faux) // Retourne xlsTypeVide
```

<a name="NOTE0_2"></a>


### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000196"></a>La fonction **xlsTypeColonne** génère une erreur dans les cas suivants :

- La colonne spécifiée n'existe pas (colonne négative par exemple).

- Le fichier XLS spécifié n'est pas ouvert.




<a name="XComposante"></a>

## Composante :
wd280xls.dll
