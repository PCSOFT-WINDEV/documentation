


## SFAjoute (Fonction)

***En anglais : SFAdd***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Crée un enregistrement dans un fichier d'une base de données Salesforce. Ce fichier peut être un fichier prédéfini ou un fichier personnalisé.

**Remarque** : Un "enregistrement Salesforce" est également appelé un "objet Salesforce".




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Connexion à Salesforce
Cnx est une sfConnexion
Cnx.Login = "balthazar@gmail.com"
Cnx.MotDePasse = "azerty" + "XXB12VCZ54"
SI SFConnecte(Cnx) = Faux ALORS
	Erreur("La connexion a échoué")
	RETOUR
FIN

// Définition des enregistrements
MesEnregistrements est un tableau de sfObjets
UnEnregistrement est un sfObjet
UnEnregistrement..TypeObjet = "Mileage__c"
UnEnregistrement..Date__c = "2009-02-14"
UnEnregistrement..Miles__c = 333
Ajoute(MesEnregistrements, UnEnregistrement)

UnEnregistrement..Date__c = "2009-02-15"
UnEnregistrement..Miles__c = 222
Ajoute(MesEnregistrements, UnEnregistrement)

// Ajout des enregistrements
tabRes est un tableau de sfRésultatSauvegarde
tabRes = SFAjoute(Cnx, MesEnregistrements)

// Lecture du résultat
res est un sfRésultatSauvegarde
err est une sfErreur
POUR TOUT res DE tabRes
	Trace("---------- " + res..ID + " : " + res..Succès + " ----------")
	POUR TOUT err DE res..Erreur
		Trace("Erreur : " + err..CodeErreur + " -> " + err..Message + "(" + err..Rubrique + ")")
	FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = SFAjoute(<Connexion Salesforce> , <Enregistrements à créer>)`
---

**`<Résultat> : (Variable de type Tableau)`**

Tableau de variables de type [sfRésultatSauvegarde](../WDLang5/1000018460.md) contenant les données résultat, notamment les identifiants des enregistrements effectivement créés.

**`<Connexion Salesforce> : (Variable de type sfConnexion)`**

Nom de la variable de type [sfConnexion](../WDLang5/1000017579.md) à utiliser.

**`<Enregistrements à créer> : (Variable de type Tableau)`**

Tableau de variables de type [sfObjet](../WDLang5/1000018439.md) correspondant aux enregistrements (objets Salesforce) à créer.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Cas d'erreurs possibles : 
<a name="cas_erreurs_possibles_ELTPARAGRAPHE000081"></a>

- La connexion Internet n'est pas valide.

- L'authentification n'a pas pu être réalisée correctement.

- La réponse XML du serveur n'est pas lisible.




Pour savoir si une erreur est survenue, utilisez la variable [ErreurDétectée](../WDLang1/3087001.md).

<a name="XComposante"></a>

## Composante :
wd280ggl.dll
