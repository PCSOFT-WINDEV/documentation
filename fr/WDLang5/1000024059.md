
## iAjoutePièceJointe (Fonction)

***En anglais : iAddAttachment***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute une pièce jointe dans un fichier PDF généré par l'export PDF d'une impression. Cet export doit être fait : 

- soit avec la fonction [iDestination](../WDLang5/3046074.md) (constante *iPDF* ou *iPDFGénérique*). 

- soit depuis le visualisateur de rapports (également appelé "aperçu avant impression"). 

- soit depuis le mini-aperçu avant impression.  





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Destination PDF
iDestination(iPDFGénérique, "c:\chemin\pdf.pdf")

// Ajoute une pièce jointe
iAjoutePièceJointe("c:\chemin\pj.xls", "Feuille de calcul d'exemple", "application/vnd.ms-excel")

// Positionne un signet et un texte à 5 cm du haut de la page
iPosY(50)
iAjouteSignet("page 1 ligne 1", "Première ligne de la première page", "page1")
iImprime("Première ligne de la première page")

// Fin de l'impression
iFinImprime()
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Ajouter une pièce jointe (sous forme de fichier) à un fichier PDF

`iAjoutePièceJointe(<Fichier à ajouter> [, <Description> [, <Type MIME>]])`
---

**`<Fichier à ajouter> : (Chaîne de caractères)`**

Chemin complet ou relatif du fichier présent sur le disque à ajouter à la suite du fichier PDF généré par l'impression. 

**`<Description> : (Chaîne de caractères optionnelle)`**

Courte description du fichier à intégrer. 

**`<Type MIME> : (Chaîne de caractères ou constante de type chaîne optionnelle)`**

Type Mime associé au fichier ajouté : 

- Nom du type MIME à utiliser. Plus de 150 types sont définis dans la norme de communication MIME (disponible sur Internet). Les valeurs les plus courantes et reconnues par la plupart des navigateurs sont :

	- "application/pdf" : document au format PDF (\*.pdf)

	- "text/html" : page HTML (\*.htm, \*.html)

	- "text/plain": fichier texte (\*.txt)

	- "image/gif" : image au format GIF (\*.gif)

	- "image/jpeg" : image au format JPEG (\*.jpg, \*.jpeg)

	- "video/mpeg" : vidéo au format MPEG (\*.mpg, \*.mpeg)




- Type MIME correspondant à une des constantes suivantes : 
	


|   |   |
| --- | --- |
| *typeMimeApplicationXML* | Contenu de type XML. |
| *typeMimeBinaire* | Contenu de type binaire (flux d'octets). |
| *typeMimeDOC* | Contenu de type fichier Word (\*.doc) |
| *typeMimeDOCX* | Contenu de type fichier Word (\*.docx) |
| *typeMimeGIF* | Contenu de type image au format GIF (\*.gif) |
| *typeMimeHTML* | Contenu de type page HTML (\*.htm, \*.html) |
| *typeMimeJPEG* | Contenu de type image au format JPEG (\*.jpg, \*.jpeg) |
| *typeMimeJSON* | Contenu de type JSON. |
| *typeMimePDF* | Contenu de type document PDF (\*.pdf) |
| *typeMimePNG* | Contenu de type image au format JPEG (\*.png) |
| *typeMimeSOAP* | Contenu SOAP au format XML. |
| *typeMimeTexte* | Contenu au format texte (\*.txt) |
| *typeMimeTexteXML* | Contenu texte au format XML |
| *typeMimeXLS* | Contenu au format Excel (\*.xls) |
| *typeMimeXLSX* | Contenu au format Excel (\*.xlsx) |
| *typeMimeZIP* | Contenu au format ZIP (\*.zip) |







<a name="SYNTAXE2"></a>

### Ajouter une pièce jointe (sous forme de Buffer) à un fichier PDF 

`iAjoutePièceJointe(<Buffer à ajouter> , <Nom pièce jointe> [, <Description> [, <Type MIME> [, <Date de création> [, <Date de modification>]]]])`
---

**`<Buffer à ajouter> : (Buffer)`**

Contenu à ajouter à la suite du fichier PDF généré par l'impression.

**`<Nom pièce jointe> : (Chaîne de caractères)`**

Nom de la pièce jointe qui sera affiché dans le fichier PDF. 
Attention : l'extension de la pièce jointe doit être indiquée.

**`<Description> : (Chaîne de caractères optionnelle)`**

Courte description du contenu à intégrer. 

**`<Type MIME> : (Chaîne de caractères ou constante de type chaîne optionnelle)`**

Type Mime associé au contenu ajouté : 

- Nom du type MIME à utiliser. Plus de 150 types sont définis dans la norme de communication MIME (disponible sur Internet). Les valeurs les plus courantes et reconnues par la plupart des navigateurs sont :

	- "application/pdf" : document au format PDF (\*.pdf)

	- "text/html" : page HTML (\*.htm, \*.html)

	- "text/plain": fichier texte (\*.txt)

	- "image/gif" : image au format GIF (\*.gif)

	- "image/jpeg" : image au format JPEG (\*.jpg, \*.jpeg)

	- "video/mpeg" : vidéo au format MPEG (\*.mpg, \*.mpeg)




- Type MIME correspondant à une des constantes suivantes : 
	


|   |   |
| --- | --- |
| *typeMimeApplicationXML* | Contenu de type XML. |
| *typeMimeBinaire* | Contenu de type binaire (flux d'octets). |
| *typeMimeDOC* | Contenu de type fichier Word (\*.doc) |
| *typeMimeDOCX* | Contenu de type fichier Word (\*.docx) |
| *typeMimeGIF* | Contenu de type image au format GIF (\*.gif) |
| *typeMimeHTML* | Contenu de type page HTML (\*.htm, \*.html) |
| *typeMimeJPEG* | Contenu de type image au format JPEG (\*.jpg, \*.jpeg) |
| *typeMimeJSON* | Contenu de type JSON. |
| *typeMimePDF* | Contenu de type document PDF (\*.pdf) |
| *typeMimePNG* | Contenu de type image au format JPEG (\*.png) |
| *typeMimeSOAP* | Contenu SOAP au format XML. |
| *typeMimeTexte* | Contenu au format texte (\*.txt) |
| *typeMimeTexteXML* | Contenu texte au format XML |
| *typeMimeXLS* | Contenu au format Excel (\*.xls) |
| *typeMimeXLSX* | Contenu au format Excel (\*.xlsx) |
| *typeMimeZIP* | Contenu au format ZIP (\*.zip) |






**`<Date de création> : (DateHeure optionnelle)`**

Date UTC de création de la pièce jointe. 

**`<Date de modification> : (DateHeure optionnelle)`**

Date UTC de modification de la pièce jointe. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Format du fichier PDF
<a name="format_fichier_pdf_ELTPARAGRAPHE000092"></a>La fonction **iAjoutePièceJointe** permet uniquement d'ajouter des fichiers dans les fichiers PDF au format PDF standard et PDF/A-3b. 

Rappel : Le choix du format de génération du fichier PDF peut être fait grâce à la fonction [iParamètrePDF](../WDLang5/3046007.md). 

Attention : Le format PDF/A-1b interdit l'intégration de pièces-jointes : la fonction **iAjoutePièceJointe** génère une erreur fatale dans ce cas.

<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280prn.dll
