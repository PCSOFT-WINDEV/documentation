


## iGroupeAjoute (Fonction)

***En anglais : iGroupAdd***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute un état à un groupe d'états. 

**Remarque** : La mise en place d'un groupe d'états permet d'afficher une combo spécifique dans le visualisateur de rapports. Les différents états du groupe sont listés dans cette combo et peuvent être affichés dans le visualisateur de rapports. Cette fonctionnalité permet notamment de proposer à l'utilisateur : 

- un état dans sa version portrait et dans sa version paysage. 

- un état dans différents formats : A3, A4, letter US, ... 



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Destination de l'impression
iDestination(iVisualisateur)
// Création du groupe d'états
iGroupeAjoute(ETAT_CA_Annee_A4_Portrait, 2012)
iGroupeAjoute(ETAT_CA_Annee_A4_Paysage, 2012)
// Affichage du premier état du groupe dans le visualisateur de rapports
iGroupeImprime()
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = iGroupeAjoute(<Nom de l'état> [, <Paramètre 1> [... [, <Paramètre N>]]])`
---

**`<Résultat> : (Entier)`**

Indice de l'état dans le groupe d'états.

**`<Nom de l'état> : (Chaîne de caractères)`**

Nom de l'état à ajouter dans le groupe.

**`<Paramètre 1> : (Paramètres optionnels (le type correspond au type du paramètre))`**

Paramètre optionnel attendu par l'état pour son exécution. Ce paramètre a été défini dans l'événement "Ouverture" de l'état. Ce paramètre peut être par exemple un nom de vue, de zone mémoire, etc.
Ce paramètre sera passé à l'état lors de son affichage dans le visualisateur de rapports ou lors de son impression. 



**`<Paramètre N> : (Paramètres optionnels (le type correspond au type du paramètre))`**

Paramètre optionnel attendu par l'état pour son exécution. Ce paramètre a été défini dans l'événement "Ouverture" de l'état. Ce paramètre peut être par exemple un nom de vue, de zone mémoire, etc.
Ce paramètre sera passé à l'état lors de son affichage dans le visualisateur de rapports ou lors de son impression. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Les paramètres par référence ne sont pas gérés : l'appel à la fonction **iGroupeAjoute** fait une copie de la valeur des paramètres au moment de l'appel.

- Par défaut, une icône et un libellé sont ajoutés dans la combo. Il est possible de personnaliser ces informations grâce à la fonction [iGroupeParamètre](../WDLang5/1000020581.md). Le libellé par défaut correspond aux dimensions et à l'orientation de l'état.  

- L'état sélectionné par défaut peut être configuré grâce à la fonction [iGroupeImprime](../WDLang5/1000020582.md). 




- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDEtats.gif) ***Exemples didactiques (WINDEV)*** : **WD Etats** <br>Cet exemple montre les différentes méthodes pour réaliser un état :<br> <br>- impressions basées sur différentes sources de données (requêtes, variables, ...)<br>- impressions basées sur des champs (Table, Tableur, TCD, ...)<br>- impression d'états composés<br>- impressions spécifiques (portrait / paysage, état avec filigrane, état avec code-barres, ...)


<a name="XComposante"></a>

## Composante :
wd280etat.dll
