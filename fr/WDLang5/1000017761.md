


## Gestion des contacts Google (syntaxe préfixée)
			

<DIV class="specObsolete">
	<IMG style="float:left;margin-right:10px;" src="https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=warning_big.png"><B>Avertissement</B><BR>
	 A partir du 15 juin 2021, l'API Contacts de Google utilisée par cette fonctionnalité n'est plus disponible ([https://developers.google.com/contacts/v3/announcement](https://developers.google.com/contacts/v3/announcement)). <br>Pour utiliser les contacts de Google, consultez l'API People proposée en remplacement par Google&nbsp;:  [https://developers.google.com/people](https://developers.google.com/people). 
La fonction [&lt;Variable restRequête&gt;.Envoie](../WDLang3/1410089811.md) simplifie l'intégration d'une API REST dans vos développements.
</DIV>

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000119"></a>
Le service Google Contact permet de gérer des contacts sur Internet. WINDEV et WEBDEV permettent par exemple de réaliser une application qui synchronise les contacts d'un applicatif existant avec les contacts de Google Contact.

**Avertissement** : Avant d'utiliser une fonctionnalité reliée à des services Google, nous vous conseillons vivement de vous reporter à la licence d'utilisation de ce service. Certaines restrictions peuvent s'appliquer. Le contenu des licences peut varier avec le temps.

PC SOFT dégage toute responsabilité de l'usage qui peut être fait des fonctions d'accès natif. Il vous appartient de vérifier que l'usage que vous faites respecte la licence du fournisseur du service.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment gérer les contacts Google ?
<a name="comment_gerer_les_contacts_google_ELTTEXTE000149"></a>


### Gérer les contacts Google
<a name="gerer_les_contacts_google_ELTPARAGRAPHE000172"></a>Pour gérer les contacts Google : 

1. Créez si nécessaire un compte Google. La création de ce compte peut être réalisée grâce à l'adresse suivante :  [http://code.google.com/intl/fr/apis/maps/signup.html](http://code.google.com/intl/fr/apis/maps/signup.html). Attention : l'adresse de cette page peut être modifiée depuis la date de rédaction de cette page.
	Le compte Google est identifié par une adresse email et le mot de passe associé. 

2. Dans le code de votre application, créez une variable de type [gglConnexion](../WDLang5/1000018009.md). Cette variable contient les caractéristiques de la connexion à votre compte Google.



<a name="NOTE2_2"></a>


### Créer un contact Google
<a name="creer_contact_google_ELTPARAGRAPHE000193"></a>Un contact Google peut être créé soit par l'interface de Google, soit par programmation à l'aide des fonctions WLangage.

Pour créer un contact Google grâce aux fonctions WLangage :

1. Créez une variable de type [gglContact](../WDLang5/1000017434.md).

2. Définissez les caractéristiques du contact grâce aux propriétés du type [gglContact](../WDLang5/1000017434.md).

3. Validez la création du contact grâce à la fonction [&lt;Variable gglConnexion&gt;.Ecrit](../WDLang5/1000021460.md).



<a name="NOTE2_3"></a>


### Remarque
<a name="remarque_ELTPARAGRAPHE000220"></a>Si vous utilisez un proxy pour accéder à Internet, il est nécessaire de configurer le proxy (fonction [Proxy](../WDLang3/3043002.md)) pour utiliser les fonctions Google.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Comment récupérer un contact Google ?
<a name="comment_recuperer_contact_google_ELTTEXTE000228"></a>
Pour récupérer un contact Google : 

1. Déclarez un tableau de variables de type [gglContact](../WDLang5/1000017434.md).

2. Utilisez la fonction [&lt;Variable gglConnexion&gt;.ListeContact](../WDLang5/1000017757.md). Cette fonction permet de lister les contacts. Les contacts trouvés sont affectés au tableau de variables de type gglContact.




Exemple :

```wl
Cnx est un gglConnexion
...

// Récupère tous les contacts
tabContacts est un tableau de 0 gglContact 
tabContacts = Cnx.ListeContact() 
// Parcours des contacts
MonContact est un gglContact
POUR TOUT MonContact DE tabContacts
	Trace(MonContact.Nom)
FIN
```


<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Comment modifier ou supprimer des contacts Google ?
<a name="comment_modifier_supprimer_des_contacts_google_ELTTEXTE000273"></a>


### Principe
<a name="principe_ELTPARAGRAPHE000296"></a>Le principe est simple : Il est nécessaire de rechercher et de se positionner sur le contact à modifier ou à supprimer avant de réaliser l'opération voulue.
<a name="NOTE4_2"></a>


### Modifier un contact
<a name="modifier_contact_ELTPARAGRAPHE000306"></a>Pour modifier un contact :

1. Récupérez la liste des contacts.

2. Recherchez le contact à modifier.

3. Modifiez les caractéristiques du contact.

4. Validez les modifications grâce à la fonction [&lt;Variable gglConnexion&gt;.Ecrit](../WDLang5/1000021460.md).




Exemple :

```wl
Cnx est un gglConnexion
...

// Récupère tous les contacts
tabContacts est un tableau de 0 gglContact 
tabContacts = Cnx.ListeContact() 
// Parcours des contacts
MonContact est un gglContact
POUR TOUT MonContact DE tabContacts
	SI MonContact.Nom = "MOULAIN" ALORS
			MonContact..AdressePostale[1].Adresse = "34080 Montpellier"
			// Mise à jour effective des changements sur le serveur
			Cnx.Ecrit(MonContact)
	FIN
FIN
```

<a name="NOTE4_3"></a>


### Supprimer un contact
<a name="supprimer_contact_ELTPARAGRAPHE000334"></a>Pour supprimer un contact :

1. Récupérez la liste des contacts.

2. Recherchez le contact à supprimer.

3. Supprimez le contact grâce à la fonction [&lt;Variable gglConnexion&gt;.Supprime](../WDLang5/1000021461.md).




Exemple :

```wl
Cnx est un gglConnexion
...

// Récupère tous les contacts
tabContacts est un tableau de 0 gglContact 
tabContacts = Cnx.ListeContact() 
// Parcours des contacts
MonContact est un gglContact
POUR TOUT MonContact DE tabContacts
	SI MonContact.Nom = "MOULAIN" ALORS
			// Suppression
			Cnx.Supprime(MonContact)
	FIN
FIN
```



- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=AccesauxcontactsdeGoogle.gif) ***Exemples unitaires (WINDEV)*** : **Accès aux contacts de Google** <br>Utilisation des fonctions gglXxx pour accéder aux contacts définis dans votre compte Google.


