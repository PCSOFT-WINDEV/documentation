


## Manipulez vos fichiers XLS (syntaxe préfixée)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000070"></a>
En syntaxe préfixée, WINDEV et WEBDEV permettent de manipuler les fichiers Excel via la **Manipulation dynamique des feuilles XLS et XLSX**. 

Cette méthode utilise différents types de variables ainsi que des fonctions WLangage. Cette méthode permet de gérer les fichiers Excel (fichiers XLS ou XLSX) **en lecture et en écriture**.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Manipulation dynamique des fichiers XLS et XLSX
<a name="manipulation_dynamique_des_fichiers_xls_xlsx_ELTTEXTE000110"></a>
<a name="NOTE2_2"></a>
Pour manipuler les fichiers XLS et XLSX, le WLangage met à votre disposition :

- différents types de variables. Ces types de variables permettent de manipuler un document XLS, une ligne ou une colonne XLS, une cellule XLS.

- différentes fonctions WLangage manipulant les différents types de données.




Pour manipuler les fichiers XLS et XLSX :

1. Déclarez une variable de type [xlsDocument](../WDLang5/1000017464.md). Ce type de variable permet de décrire et de modifier un document Excel.

2. Ouvrez si nécessaire le fichier XLS (fonction [xlsOuvre](../WDLang5/3080017.md)) et associez-le à la variable de type [xlsDocument](../WDLang5/1000017464.md).

3. Vous pouvez manipuler les différents éléments du document Excel :

	- soit avec les fonctions WLangage.

	- soit avec les propriétés du type [xlsDocument](../WDLang5/1000017464.md).







Exemple :

```wl
MonFicXLS est un xlsDocument 
UnFichier est une chaîne 
UnFichier = fRepExe + "\Suivi d'affaires1.xls"

MonFicXLS = xlsOuvre(UnFichier, xlsEcriture)
SI ErreurDétectée = Faux ALORS
	Azz est un entier = MonFicXLS..Feuille
	Info("Feuille en cours dans le fichier Excel : " + Azz)
	// Changement de feuille
	SI MonFicXLS..Feuille = 2 ALORS
		Info("La feuille courante a été modifiée.")
		// Lecture d'une cellule pour test
		Info(xlsDonnée(IDFicXLS, 11, 2))
	SINON
		Erreur("Le fichier sélectionné ne comporte pas de seconde feuille !")
	FIN 
SINON
	Erreur("Attention ! le fichier est déjà ouvert sur un poste de travail !")
FIN
```

**Remarques** :

- Si le fichier Excel est ouvert en mode lecture/écriture (constante *xlsEcriture*), le fichier est ouvert et bloqué jusqu'à sa fermeture. Pour sauvegarder les modifications réalisées, utilisez la fonction [&lt;Variable xlsDocument&gt;.Sauve](../WDLang5/1000021511.md).

- Les fonctions XLS ne nécessitent pas l'installation du logiciel "Microsoft Excel" sur le poste des utilisateurs.

- Les fichiers XLS et les fichiers spécifiques à Office 2007 (fichiers .xlsx) sont gérés.





