


## XMLSauve (Fonction)

***En anglais : XMLSave***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Sauvegarde un document XML dans un fichier.

Si une description XSD a été utilisée, celle-ci est automatiquement utilisée pour valider le document XML lors de sa sauvegarde. 






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MonDocumentXML est un xmlDocument
...
Filtre est une chaîne = "Fichiers XML (*.xml)" + TAB + "*.xml" + RC + ...
			"Tous fichiers (*.*)" + TAB + "*.*"
FichierSortie est une chaîne = fSélecteur("", "", "Sélectionnez un fichier XML ...", ...
			Filtre, "xml", fselCrée)
SI FichierSortie <>"" ALORS
	XMLSauve(MonDocumentXML, FichierSortie, XMLDocumentDéfaut)
	SI ErreurDétectée = Vrai ALORS
		ErreurConstruit("Une erreur s'est produite pendant la sauvegarde : %1", ...
				ErreurInfo(errComplet))
	FIN
FIN
```
<a name="Exemple2"></a>

```wl
// La description du fichier XML nommé "flux" a été importée dans le projet. 
// Un ficher XML vierge va être créé à partir de cette description.
// Le ficher XML n'existe pas encore physiquement.
// Chargement du contenu XML
MonDocXML est un xmlDocument,description="flux"
MonDocXML.rss.Channel[1].Title = gsParamTitre
MonDocXML.rss.Channel[1].Link = gsParamAdresseSite
MonDocXML.rss.Channel[1].Description = gsParamDescriptionSite
MonDocXML.rss.Channel[1].Copyright = gsParamCopyright
MonDocXML.rss.Channel[1].Webmaster = gsParamAdesseContact
MonDocXML.rss.Channel[1].Image = gsParamURLImageSite
MonDocXML.rss.Channel[1].Generator = "Easy RSS"
// Sauvegarde du fichier
XMLSauve(MonDocXML, gsCheminFichierXML)
// Sauvegarde du fichier avec mise en forme (nouveauté 22)
XMLSauve(MonDocXML, gsCheminFichierXML_Avec_MiseEnForme, XMLMiseEnForme)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`XMLSauve(<Document XML> [, <Nom et chemin du fichier>] [, <Options>])`
---

**`<Document XML> : (Variable de type xmlDocument)`**

Variable de type [xmlDocument](../WDLang5/1000018782.md) contenant le document à sauvegarder. Cette variable peut être le résultat d'un appel à la fonction [XMLOuvre](../WDLang5/1000018792.md) ou avoir été déclarée et initialisée directement.

**`<Nom et chemin du fichier> : (Chaîne de caractères ANSI ou Unicode optionnelle)`**

Nom et chemin complet (ou relatif) du fichier texte à créer. Il est possible d'utiliser un chemin UNC.

Si ce paramètre n'est pas spécifié ou vaut "" (chaîne vide) :

- Lors du premier appel à **XMLSauve** sur ce document, le document XML est sauvegardé à l'emplacement spécifié lors de son ouverture (fonction [XMLOuvre](../WDLang5/1000018792.md)).

- Lors des appels suivants à **XMLSauve**, le document XML est sauvegardé à l'emplacement spécifié lors de la précédente sauvegarde.

- Si le document XML n'a pas été ouvert par la fonction [XMLOuvre](../WDLang5/1000018792.md) (ouvert depuis une URL, une chaîne ou si le document a été créé), une erreur est affichée.




**`<Options> : (Constante optionnelle de type Entier)`**

Options de sauvegarde du document XML.
Les valeurs possibles sont :


|   |   |
| --- | --- |
| *XMLDocumentDéfaut*<br>(valeur par défaut) | Sauvegarde le document XML avec un entête. |
| *XMLMiseEnForme* | Sauvegarde le document XML avec une mise en forme (indentation et retours chariot). <br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *XMLSansEntête* | Sauvegarde le document XML sans entête. Cette constante peut être utilisée par exemple lorsque le document XML manipulé correspond à un fragment d'un document plus important, concaténé avec d'autres documents XML par la suite. |
| *xvSansValidation* | Sauvegarde le document XML sans prendre en compte le modèle XSD précisé lors de la description du document XML.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
Lors de la description d'un document XML, il est possible de spécifier le fichier XSD qui servira de modèle de validation au fichier XML. Par exemple :

```wl
cMonDoc est un XMLDocument <description="personne.xsd">
```
 
Par défaut, ce fichier XSD est pris en compte lors de la sauvegarde du document : la validité du document est automatiquement vérifiée avant de sauvegarder le document XML (équivalent à la fonction [XMLDocumentValide](../WDLang5/1000019272.md)). Pour ne pas effectuer cette validation, il suffit d'utiliser la constante *xvSansValidation*. 

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280xml.dll
