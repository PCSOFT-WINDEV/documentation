


## iImprimeEtat (Fonction)

***En anglais : iPrintReport***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Imprime un état réalisé avec l'éditeur d'états.

**Attention** : Selon la source de données de l'état, le code WLangage nécessaire à l'impression de l'état est différent. Pour plus de détails et des exemples, consultez :

- [Imprimer un état basé sur un fichier de données HFSQL](../WDChamp/1011052.md).

- [Imprimer un état sur requête](../WDChamp/1011013.md).

- [Imprimer un état sur une vue HFSQL](../WDChamp/1011064.md).

- [Imprimer un état sur une zone mémoire](../WDChamp/1011061.md).
	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette option n'est pas disponible dans cette version.

- [Imprimer un état sur un champ Table](../WDChamp/1011012.md).
	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette option n'est pas disponible dans cette version.

- [Imprimer un état sur un fichier texte](../WDChamp/1011011.md).

- [Imprimer un état sur une requête SQL sur fichier ODBC](../WDChamp/1011066.md).
	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette option n'est pas disponible dans cette version.




![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Les états sont disponibles au format PDF sous Linux. Pour plus de détails, consultez [Imprimer sous Linux](../Editeurs/9000078.md).



|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | Avec le logiciel Etats & Requêtes, il est possible d'imprimer un état via une des solutions suivantes :<br><br>- en lançant une impression (icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Ico_Imprimer.gif)<br>).<br><br>- en testant l'état (icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Ico_Go_Fenetre_WD_bl.gif)<br>).<br><br><br>Il n'est donc pas nécessaire de programmer l'impression de l'état.<br><br>Pour que l'impression d'états réalisés avec le logiciel Etats & Requêtes soit possible directement à partir d'une application WINDEV, le fournisseur de l'application WINDEV doit prévoir cette fonctionnalité dans son application.<br><br>Le fournisseur peut par exemple intégrer une fenêtre permettant à l'utilisateur final de :<br><br>- sélectionner un état réalisé avec le logiciel Etats & Requêtes.<br><br>- lancer l'exécution de cet état.<br><br><br> |




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003046032&name=iimprimeetat_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Impression simple sur imprimante
iImprimeEtat(ETAT_Facture)
```
<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Impression dans le visualisateur de rapports (aperçu)
iDestination(iVisualisateur)
iImprimeEtat(ETAT_Facture)
```
<a name="Exemple3"></a>

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = iImprimeEtat(<Etat> [, <Paramètre 1> [... [, <Paramètre N>]]])`
---

**`<Résultat> : (Type du résultat retourné par l'état (optionnel))`**

Valeur renvoyée par l'état lors de son impression. Cette valeur est renvoyée : 

- soit par le mot-clé [RENVOYER](../Motscles/1510007.md) présent dans le code de fermeture de l'état. 

- soit par la propriété [ValeurRevoyée](../Proprietes/2510134.md) utilisée avant la fermeture de l'état.




**`<Etat> : (Nom d'état ou chaîne de caractères)`**

Etat à imprimer : 

- Nom de l'état, défini sous l'éditeur d'états.

- Nom physique de l'état (avec son chemin), si le code compilé est intégré à l'état.




**`<Paramètre 1> : (Paramètres optionnels (le type correspond au type du paramètre))`**

Paramètre optionnel attendu par l'état pour son exécution. Ce paramètre a été défini dans le code d'ouverture de l'état. Ce paramètre peut être par exemple un nom de vue, de zone mémoire, etc.
**Attention** : Si l'état comprend des bornes (borne minimale et borne maximale), les deux premiers paramètres doivent correspondre respectivement à la borne minimale et à la borne maximale.



**`<Paramètre N> : (Paramètres optionnels (le type correspond au type du paramètre))`**

Paramètre optionnel attendu par l'état pour son exécution. Ce paramètre a été défini dans le code d'ouverture de l'état. Ce paramètre peut être par exemple un nom de vue, de zone mémoire, etc.
**Attention** : Si l'état comprend des bornes (borne minimale et borne maximale), les deux premiers paramètres doivent correspondre respectivement à la borne minimale et à la borne maximale.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Principe d'impression d'un état
<a name="principe_impression_etat_ELTPARAGRAPHE000196"></a>La fonction **iImprimeEtat** lit la source de données de l'état (fichiers de données, requête, champ Table, ...). Pour chaque enregistrement, la fonction **iImprimeEtat** imprime le bloc *Corps*. Les autres blocs sont imprimés uniquement lorsque nécessaire :

- Au début du document, le bloc *Début de document* sera imprimé.

- A la fin du document, le bloc *Fin de document* sera imprimé.

- En haut de chaque page, le bloc *Haut de page* sera imprimé.

- En bas de chaque page, le bloc de *Bas de page* sera imprimé.

- En cas de rupture, le bloc *Corps* de la rupture sera encadré par les blocs *Haut de rupture* et *Bas de rupture*.



<a name="NOTE0_2"></a>


### Etat avec borne minimale et maximale
<a name="etat_avec_borne_minimale_maximale_ELTPARAGRAPHE000217"></a>Si l'état a été créé sous l'éditeur d'états en spécifiant des bornes minimales et maximales, les deux premiers paramètres passés à l'état grâce à la fonction **iImprimeEtat** doivent correspondre respectivement à la borne minimale et à la borne maximale.

Exemple : un état sur le fichier Client a été créé. Cet état parcourt le fichier sur la rubrique clé "NumClient". Cet état a été défini comme étant borné, avec fourniture des bornes minimales et maximales (onglet "Données" de la fenêtre de description de l'état. 

Le code suivant permet d'imprimer l'état pour les clients 2 à 5 : 

```wl
iDestination(iVisualisateur)
iImprimeEtat(ETAT_Clients_Prospects, "2", "5")
```

<a name="NOTE0_3"></a>


### Exécution d'une requête et état basé sur cette requête
<a name="execution_une_requete_etat_base_sur_cette_requete_ELTPARAGRAPHE000239"></a>Lors de l'impression d'un état basé sur une requête, si la requête a déjà été exécutée, elle n'est pas ré-exécutée. Pour forcer la ré-exécution de la requête (ajout d'enregistrements par exemple), il suffit d'utiliser les fonctions [HExécuteRequête](../WDLang4/3044080.md) ou [iInitRequêteEtat](../WDLang5/3046021.md).
<a name="NOTE0_4"></a>


### Destination de l'impression
<a name="destination_impression_ELTPARAGRAPHE000254"></a>Il est possible de choisir la destination de l'impression de l'état grâce à la fonction [iDestination](../WDLang5/3046074.md).

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) La fonction [iDestination](../WDLang5/3046074.md) utilisée avec la constante *iVisualisateur* permet d'afficher l'impression dans un visualisateur de rapports. L'utilisateur peut ensuite choisir le mode d'impression (PDF, imprimante, ...). Pour savoir si l'impression a été effectuée depuis le visualisateur de rapports, il suffit d'utiliser la fonction [iImpressionDemandée](../WDLang5/3046029.md).
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Passage de paramètres
<a name="passage_parametres_ELTPARAGRAPHE000278"></a>Les paramètres indiqués par la fonction **iImprimeEtat** correspondent aux paramètres définis dans le code d'ouverture de l'état à l'aide de la syntaxe suivante :

```txt
PROCEDURE <NomEtat> (<NomParam1>, <NomParam2> = "<ValeurParDéfaut>", ...
	<NomParamN> = "<ValeurParDéfaut>")
```
**Rappel** : Certains paramètres passés à une procédure peuvent être optionnels. Lors de la déclaration de la procédure, les paramètres optionnels doivent être décrits en dernière position (à droite), avec une valeur par défaut précédée du signe "=". Pour plus de détails, consultez [Paramètre d'une procédure](../Motscles/1513001.md).

Si l'état est basé sur une requête, il sera nécessaire d'utiliser la fonction [iInitRequêteEtat](../WDLang5/3046021.md) pour passer les paramètres de la requête avant de lancer l'exécution de l'état.
<a name="NOTE0_6"></a>


### Imprimer un état d'un composant
<a name="imprimer_etat_composant_ELTPARAGRAPHE000300"></a>Pour imprimer un état d'un composant, il suffit d'utiliser directement le nom de l'état du composant (le composant étant intégré dans le projet). Par exemple :

```wl
iImprimeEtat(EtatDuComposant)
```


En cas de conflit avec un élément du projet, il suffit de préfixer le nom de l'élément par le nom du composant. Par exemple :

```wl
iImprimeEtat(MonComposant.Etat)
```


Pour utiliser le nom de l'état dans une variable, il est nécessaire de préciser le nom du composant. Par exemple :

```wl
sEtat est une chaîne = "MonComposant.MonEtat"
iImprimeEtat(sEtat)
```

<a name="NOTE0_8"></a>


### Etats imbriqués
<a name="etats_imbriques_ELTPARAGRAPHE000331"></a>Il est possible d'appeler la fonction **iImprimeEtat** au sein même d'un état. Pour plus de détails, consultez l'aide sur les [Etats imbriqués](../WDChamp/1011001.md). 

<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280etat.dll


