


## XMLConstruitChaîne (Fonction)

***En anglais : XMLBuildString***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère et met en forme le contenu d'un document XML. 
Ce document XML peut : 

- avoir été créé avec la fonction [XMLDocument](../WDLang5/3081008.md) et modifié grâce aux fonctions XML.

- correspondre à une variable de type [xmlDocument](../WDLang5/1000018782.md). 


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) La chaîne de caractères correspondante pourra être enregistrée sous forme d'un fichier XML grâce à la fonction [fSauveTexte](../WDLang1/3036046.md). Rappel : La fonction [fSauveTexte](../WDLang1/3036046.md) crée un fichier texte uniquement au format ANSI. Pour créer un fichier texte au format Unicode, utilisez les fonctions [fOuvre](../WDLang1/3036036.md) / [fEcrit](../WDLang1/3036014.md).![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Dans le document XML obtenu, la liste des attributs est triée par ordre alphabétique.![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Si le document XML à mettre en forme contient la déclaration d'une DTD interne, la description de cette DTD ne sera pas retranscrite dans le document XML obtenu. 






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003081016&name=xmlconstruitchaine_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
SourceXML est une chaîne
Res est un booléen
// Chargement du contenu XML
SourceXML = fChargeTexte("exemple.xml")

// Création du document XML
Res = XMLDocument("DocXML", SourceXML)

// Modification du document XML
...

// Récupération et mise en forme du document XML
SourceXML = XMLConstruitChaîne("DocXML")

// Enregistrement du fichier XML
fSauveTexte("ExampleModifié.xml", SourceXML)
```
<a name="Exemple2"></a>

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Récupérer le source d'un document XML créé avec la fonction XMLDocument

`<Résultat> = XMLConstruitChaîne(<Nom du Document XML> [, <Options de création> [, <Format de sortie>]])`
---

**`<Résultat> : (Chaîne de caractères)`**

Document XML mis en forme. Ce résultat peut être :

- manipulé directement en mémoire.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) enregistré dans un fichier au format XML grâce à la fonction [fSauveTexte](../WDLang1/3036046.md).

- ...




**`<Nom du Document XML> : (Chaîne de caractères)`**

Nom du document XML à mettre en forme. Ce document a été créé grâce à la fonction [XMLDocument](../WDLang5/3081008.md) et a été modifié grâce aux [fonctions XML](../WDLang5/3081005.md).

**`<Options de création> : (Constante optionnelle de type Entier)`**

Combinaison des valeurs suivantes :


|   |   |
| --- | --- |
| *XMLDocumentDéfaut* <br>(valeur par défaut) | Génère le code XML avec un entête et à partir de la racine. |
| *XMLMiseEnForme* | Génère le code XML avec une mise en forme (indentation et retours chariot). |
| *XMLPositionCourante* | Génère le code XML à partir de la position courante dans le document XML (au lieu de la racine). |
| *XMLSansEntête* | Génère le code XML sans entête. |



**`<Format de sortie> : (Constante optionnelle de type Entier)`**

Indique l'encodage utilisé dans l'entête du fichier :


|   |   |
| --- | --- |
| *XMLEncodageAucun*<br>(Valeur par défaut) | Aucun encodage |
| *XMLEncodageIso8859_1* | Encodage selon l'alphabet latin |
| *XMLEncodageIso8859_2* | Encodage selon Iso8859_2 |
| *XMLEncodageIso8859_3* | Encodage selon Iso8859_3 |
| *XMLEncodageIso8859_4* | Encodage selon Iso8859_4 |
| *XMLEncodageIso8859_5* | Encodage selon Iso8859_5 |
| *XMLEncodageIso8859_6* | Encodage selon Iso8859_6 |
| *XMLEncodageIso8859_7* | Encodage selon Iso8859_7 |
| *XMLEncodageIso8859_8* | Encodage selon Iso8859_8 |
| *XMLEncodageIso8859_9* | Encodage selon Iso8859_9 |
| *XMLEncodageIso8859_15* | Encodage selon l'alphabet latin-9 |
| *XMLEncodageUTF8* | Encodage UNICODE 8 |
| *XMLEncodageUTF16* | Encodage UNICODE<br>Remarque : dans ce cas, la fonction **XMLConstruitChaîne** génère un entête de 2 octets pour préciser le "Byte Order". |


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Par défaut, l'encodage utilisé sera l'encodage Iso8859_1 (alphabet latin).


<a name="SYNTAXE2"></a>

### Récupérer le source d'un document XML contenu dans une variable de type xmlDocument

`<Résultat> = XMLConstruitChaîne(<Document XML> [, <Options de création>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Document XML mis en forme. Ce résultat peut être :

- manipulé directement en mémoire.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) enregistré dans un fichier au format XML grâce à la fonction [fSauveTexte](../WDLang1/3036046.md).

- ...




**`<Document XML> : (Variable de type xmlDocument)`**

Variable de type [xmlDocument](../WDLang5/1000018782.md) contenant le document XML à mettre en forme.

**Attention** : L'encodage du résultat correspond à la propriété **Encodage** de la variable [xmlDocument](../WDLang5/1000018782.md). Si aucun encodage n'est spécifié, le document XML sera encodé par défaut en UTF8.

**`<Options de création> : (Constante optionnelle de type Entier)`**

Combinaison des valeurs suivantes :


|   |   |
| --- | --- |
| *XMLDocumentDéfaut* <br>(valeur par défaut) | Génère le code XML avec un entête et à partir de la racine. |
| *XMLMiseEnForme* | Génère le code XML avec une mise en forme (indentation et retours chariot).<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *XMLSansEntête* | Génère le code XML sans entête. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Fonctions XML et threads
<a name="fonctions_xml_threads_ELTPARAGRAPHE000427"></a>Si votre application utilise des threads, le document XML est partagé entre tous ces threads. Pour plus de détails sur la gestion des threads, consultez [Gestion des threads](../WDLang1/3077026.md).

<a name="XComposante"></a>

## Composante :
wd280xml.dll
