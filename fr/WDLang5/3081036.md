


## XMLSupprime (Fonction)

***En anglais : XMLDelete***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Supprime l'élément courant d'un document XML, ainsi que toute la branche qui en découle.






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003081036&name=xmlsupprime_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Suppression lors d'une recherche
// Positionne à la racine du document
XMLRacine(:m_sNomDoc)
BOUCLE
	// Recherche tous les "txsr" à partir de la racine pour les supprimer
	XMLRecherche(:m_sNomDoc, CParagraphe::CST_TAG , XMLBalise + XMLSousElément + XMLContinue, ...
		XMLExact)
	SI XMLTrouve(:m_sNomDoc) ALORS
		XMLSupprime(:m_sNomDoc)
	SINON
		SORTIR 
	FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = XMLSupprime(<Document XML>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la suppression est effectuée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La variable [ErreurDétectée](../WDLang1/3087001.md) est alors à <u><u><u><u>Vrai</u></u></u></u>. Pour obtenir plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Document XML> : (Chaîne de caractères)`**

Document XML dans lequel la suppression doit être effectuée. 

- Si l'élément courant est un attribut, l'attribut sera supprimé. 

- Si l'élément courant est une balise, la balise sera supprimée, ainsi que tous ses attributs et tous ses sous-éléments.  






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Position courante
<a name="position_courante_ELTPARAGRAPHE000089"></a>Après la suppression, la position courante est déplacée vers le parent de l'élément supprimé.
<a name="NOTE0_2"></a>


### Suppression lors d'une recherche
<a name="suppression_lors_une_recherche_ELTPARAGRAPHE000096"></a>La fonction **XMLSupprime** utilisée lors d'une recherche annule la recherche. Exemple à ne pas faire (ce code ne fonctionne pas) :

```wl
// Positionne à la racine du document
XMLRacine(:m_sNomDoc)
// Recherche tous les "txsr" à partir de la racine pour les supprimer
XMLRecherche(:m_sNomDoc, CParagraphe::CST_TAG, XMLBalise + XMLSousElément + XMLContinue, XMLExact)
TANTQUE XMLTrouve(:m_sNomDoc)
	XMLSupprime(:m_sNomDoc)
     // Elément suivant dans la recherche
	XMLSuivant(:m_sNomDoc)
FIN
XMLAnnuleRecherche(:m_sNomDoc)
```
Le code à utiliser est donné en exemple de la fonction.
<a name="NOTE0_3"></a>


### Enregistrer les modifications dans le fichier XML
<a name="enregistrer_les_modifications_dans_fichier_xml_ELTPARAGRAPHE000108"></a>Pour enregistrer les modifications effectuées dans un fichier XML, vous devez :

1. Utiliser la fonction [XMLConstruitChaîne](../WDLang5/3081016.md). Cette fonction récupère et met en forme le contenu d'un document XML.

2. Enregistrer la chaîne de caractères générée par la fonction [XMLConstruitChaîne](../WDLang5/3081016.md) dans un fichier XML. Pour cela, il suffit d'utiliser la fonction [fSauveTexte](../WDLang1/3036046.md).




Exemple :

```wl
// Après modification du document XML 
SourceXML = XMLConstruitChaîne("DocXML")
// Enregistrement du fichier XML
fSauveTexte("ExampleModifié.xml", SourceXML)
```


<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280xml.dll
