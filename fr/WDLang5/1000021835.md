


## FBOuvreSession (Fonction)

***En anglais : FBStartSession***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet l'authentification et la connexion à Facebook.






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MaSession est une fbSession
MaSession.AppID = "1702546803104741"
MaSession.AppSecret = "badf00ddeadbeefbadc0deoff1ce8ecd"
MaSession.Permission = [fbInfoProfil, fbEmail]
SI FBOuvreSession(MaSession) ALORS
	Info("Connecté")
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Authentification synchrone

`<Résultat> = FBOuvreSession(<Session>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la connexion a réussi, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. 




**`<Session> : (Variable de type fbSession)`**

Nom de la variable de type [fbSession](../WDLang5/1000021851.md) correspondant à la connexion à initialiser. 


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) 
### Authentification asynchrone

`FBOuvreSession(<Session> , <Procédure WLangage>)`
---

**`<Session> : (Variable de type fbSession)`**

Nom de la variable de type [fbSession](../WDLang5/1000021851.md) correspondant à la connexion à initialiser. 

**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure WLangage (également nommée "callback") appelée lors de la connexion. Cette procédure est de la forme : 

```txt
<Nom de la procédure>(Connexion, Session)
```
 où : 

- &lt;Connexion&gt; vaut : 

	- <u><u><u><u>Vrai</u></u></u></u> si la connexion a réussi, 

	- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. 




- &lt;Session&gt; est une variable de type [fbSession](../WDLang5/1000021851.md) correspondant à la connexion initialisée. 






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Ouverture de la session
<a name="ouverture_session_ELTPARAGRAPHE000125"></a>

- La fonction **FBOuvreSession** permet de s'authentifier auprès d'un serveur Facebook. Cette fonction initialise la connexion avec le serveur et doit être appelée avant toute communication avec Facebook.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Une fenêtre permettant à l'utilisateur de saisir son login et son mot de passe est automatiquement ouverte.

- La fonction **FBOuvreSession** doit être appelée uniquement depuis le thread principal de l'application.



<a name="NOTE0_2"></a>
<a name="NOTE0_3"></a>


### Fermeture de la session
<a name="fermeture_session_ELTPARAGRAPHE000170"></a>Une session Facebook ouverte est persistante : elle restera ouverte : 

- jusqu'à la fermeture de l'application. 

- jusqu'à l'utilisation de la fonction [FBFermeSession](../WDLang5/1000021836.md).



<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Incompatibilité entre l'ActiveX IE (et oAuth2) et l'utilisation d'assemblage .NET
<a name="incompatibilite_entre_activex_oauth2_utilisation_assemblage_net_ELTPARAGRAPHE000188"></a>Lorsque vous utilisez un champ HTML dans WINDEV, ce champ utilise l'ActiveX système "Navigateur Web Microsoft". Cet ActiveX est également utilisé par WINDEV pour toutes les authentifications OAuth2 (Facebook, Twitter, Google, etc) qui demandent une validation pour la connexion via du code HTML.

Si dans un même projet vous utilisez un champ HTML (ou une authentification OAuth2) et un assemblage ".Net", vous risquez de rencontrer une incompatibilité entre les couches .NET de Microsoft et l'ActiveX.

Il existe une API qui permet de gérer cette cohabitation. Pour cela vous devez utiliser la ligne de code suivante dans le code d'initialisation du projet ou dans le code d'initialisation de classes ou de procédure globale si l'initialisation de l'objet ".Net" est faite dans la classe ou la collection de procédure :

```wl
// Permet de gérer la cohabitation de l'ActiveX IE et de .NET
API("OLE32", "CoInitializeEx", Null, 2)
```

<a name="NOTE0_5"></a>



<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280ggl.dll
