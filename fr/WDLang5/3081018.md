


## Gestion du XML
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000271"></a>
WINDEV, WINDEV Mobile et WEBDEV mettent à votre disposition des fonctions permettant de manipuler du code XML. Le code XML manipulé doit être strictement conforme à la norme XML. Pour plus de détails, consultez une documentation spécifique sur XML.

Le code XML est utilisé par exemple :

- dans les systèmes d'information (Intranet, ...).

- dans les dialogues avec les Webservices. Pour plus de détails sur la gestion des Webservices XML, consultez [Importation de service Web XML](../WDLang3/3086001.md) et [Générer un service Web XML](../WDLang3/3086002.md).






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Définition
<a name="definition_ELTTEXTE000295"></a>
XML est un langage comportant des balises et des attributs (appelés "éléments" dans cette aide).

La structure d'un code XML correspond à une arborescence : les informations sont ordonnées selon une hiérarchie.

Voici le vocabulaire utilisé pour décrire les différentes parties d'un code XML :

![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=schema_xml.gif)

Un code (ou contenu) XML correspond :

- soit au contenu d'un fichier XML.

- soit à une réponse d'un Webservice XML.




Grâce aux fonctions XML, il est possible de :

- lire, rechercher, analyser le contenu d'un fichier XML.

- modifier le contenu d'un fichier XML.

- mettre en forme le contenu d'un fichier XML.

- exécuter une requête XPATH dans le contenu d'un fichier XML.

- examiner les réponses reçues des Webservices XML.

- importer des données (fonction [HImporteXML](../WDLang4/3044007.md)).




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Principe d'utilisation
<a name="principe_utilisation_ELTTEXTE000319"></a>


### Deux méthodes
<a name="deux_methodes_ELTPARAGRAPHE000076"></a>Deux méthodes peuvent être utilisées pour manipuler un document XML : 

1. [Utilisation d'une variable de type xmlDocument](#NOTE3_2) (**Méthode conseillée**). Cette méthode permet d'utiliser un fichier de type XSD.

2. [Utilisation d'une variable de type chaîne pour stocker le document XML](#NOTE3_3). Le document XML peut être ensuite manipulé grâce aux différentes fonctions XML. 



<a name="NOTE3_2"></a>


### Utilisation d'une variable de type xmlDocument
<a name="utilisation_une_variable_type_xmldocument_ELTPARAGRAPHE000090"></a>Les variables de type **xmlDocument** peuvent être déclarées en indiquant un document exemple (un fichier XML) ou un document modèle (un fichier XSD). La structure de ce document sera lue par WINDEV, WEBDEV et WINDEV Mobile. Il sera ainsi possible de disposer de la complétion automatique sur les noms des noeuds directement dans l'éditeur de code.

Pour déclarer une variable de type xmlDocument avec un document exemple :

1. Ajoutez le document XML dans le projet grâce à une des méthodes suivantes : 

	- sous le volet "Projet", dans le groupe "Projet", déroulez "![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_listeprojet.gif) Liste des éléments" et cliquez sur "Liste des éléments du projet". La liste des éléments du projet s'affiche. Cliquez sur le bouton "Ajouter" et sélectionnez le document XML.

	- réalisez un "Drag and Drop" du fichier vers le dossier "Descriptions externes" du volet "Explorateur de projet".

	- dans le volet "Explorateur de projet", sélectionnez le dossier "Descriptions externes", puis sélectionnez : 

		- soit l'option "Importer un XML ou un JSON dans ce projet" du menu contextuel.

		- soit l'option "Importer un XSD dans ce projet" du menu contextuel.




2. Le document XML apparaît sous le dossier "Descriptions externes" de l'explorateur de projet. Il est possible de visualiser sa structure.

3. Déclarez la variable de la façon suivante :
	
	```txt
	<Nom de la variable> est un xmlDocument , description =  <Nom du document>
	```

	&lt;Nom du document&gt; peut correspondre au nom du document exemple (avec ou sans son extension) ou au nom du document modèle (avec ou sans son extension). 
	**Remarques** : 

	- Cette déclaration peut être obtenue automatiquement en "droppant" le nom du document XML directement depuis le volet "Explorateur de projet". 

	- Dans le cas de l'utilisation d'un document exemple, il est également possible d'utiliser la syntaxe suivante : 
			
		```txt
		<Nom de la variable> est un xmlDocument
		<Nom de la variable> = XMLOuvre(<Nom du document>)
		```





4. Vous pouvez maintenant accéder directement aux noeuds de la variable par leurs noms. Ces noms sont proposés automatiquement par le mécanisme de complétion automatique de l'éditeur de code.




Remarque : La fonction [XMLSauve](../WDLang5/1000019026.md) permet de sauvegarder le document XML. Si un fichier XSD a été utilisé, il sera automatiquement pris en compte.
<a name="NOTE3_3"></a>


### Utilisation d'une variable de type chaîne
<a name="utilisation_une_variable_type_chaine_ELTPARAGRAPHE000097"></a>Pour manipuler un code XML :

1. Stockez dans une variable de type chaîne le code XML à manipuler (fonction [fChargeTexte](../WDLang1/3036006.md)). Ce code peut provenir d'un fichier XML ou d'une réponse d'un service Web XML.

2. Créez un document XML (fonction [XMLDocument](../WDLang5/3081008.md)). Ce document est stocké en mémoire et contient l'ensemble du code XML à manipuler.

3. Manipulez votre document XML grâce aux fonctions WLangage. Il est possible de :

	- Parcourir le code XML (fonctions [XMLDernier](../WDLang5/3081013.md), [XMLEnDehors](../WDLang5/3081009.md), [XMLFils](../WDLang5/3081012.md), [XMLParent](../WDLang5/3081022.md), [XMLPrécédent](../WDLang5/3081023.md), [XMLPremier](../WDLang5/3081024.md), [XMLRacine](../WDLang5/3081019.md), [XMLSuivant](../WDLang5/3081030.md), [XMLTrouve](../WDLang5/3081020.md)).

	- Effectuer des recherches (fonctions [XMLRecherche](../WDLang5/3081025.md), [XMLAnnuleRecherche](../WDLang5/3081001.md), [XMLExtraitChaîne](../WDLang5/3081017.md)).

	- Récupérer des informations sur les éléments (balises ou attributs) du document. (fonctions [XMLDonnée](../WDLang5/3081004.md), [XMLNomElément](../WDLang5/3081026.md), [XMLNomParent](../WDLang5/3081035.md), [XMLTypeElément](../WDLang5/3081031.md)).

	- Modifier le document XML (fonctions [XMLAjouteAttribut](../WDLang5/3081011.md), [XMLAjouteFils](../WDLang5/3081002.md), [XMLInsèreDocument](../WDLang5/3081014.md), [XMLInsèreElément](../WDLang5/3081007.md), [XMLModifie](../WDLang5/3081037.md), [XMLRenomme](../WDLang5/3081021.md), [XMLSupprime](../WDLang5/3081036.md)).

	- Exécuter une requête XPath dans un document XML (fonctions [XMLExécuteXPath](../WDLang5/3081015.md), [XMLPosition](../WDLang5/3081028.md), [XMLRésultat](../WDLang5/3081027.md)).

	- Convertir une chaîne de caractères au format ANSI en une chaîne de caractères au format XML et inversement (fonctions [TexteVersXML](../WDLang5/3081006.md) ou [XMLVersTexte](../WDLang5/3081029.md)).




4. Enregistrez si nécessaire les modifications effectuées (fonctions [XMLConstruitChaîne](../WDLang5/3081016.md) et [fSauveTexte](../WDLang1/3036046.md)).

5. Fermez le document XML (fonction [XMLTermine](../WDLang5/3081034.md)).




Remarque : Il est également possible de créer un document XML :

- avec les données d'une table (fonction [TableVersXML](../WDLang1/3074037.md)).

- à partir d'une partie d'un document XML existant (fonction [XMLExtraitDocument](../WDLang5/3081010.md)).





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LectureetecritureauformatXML.gif) ***Exemples unitaires (WINDEV)*** : **Lecture et écriture au format XML** <br>Utilisation des fonctions de XMLxxx pour :<br>- Créer un document XML<br>- Lire un document XML
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ParseurXML.gif) ***Exemples unitaires (WINDEV)*** : **Parseur XML** <br>Analyse du contenu d'un fichier XML grâce aux fonctions XMLxxx de WINDEV
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDColorationSyntaxique.gif) ***Exemples didactiques (WINDEV)*** : **WD Coloration Syntaxique** <br>Cet exemple propose une classe de base permettant d'effectuer une coloration syntaxique classique sur du texte. <br>Cette coloration est basée sur une analyse brute des lemmes d'un texte afin d'en identifier les éléments d'un langage de programmation par exemple.<br>Elle peut être surchargée ou dérivée afin de personnaliser le système et le langage de coloration.<br>L'exemple fourni permet de coloriser du code SQL et du code XML, mais peut être étendu pour coloriser d'autres langages ou d'autres formes de texte.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDMultimedia.gif) ***Exemples complets (WINDEV)*** : **WD Multimedia** <br>Cet exemple montre comment jouer des vidéos (AVI, MPEG...), des sons (CD AUDIO, MP3, WAV) et des animations avec le champ Multimédia de WINDEV.


