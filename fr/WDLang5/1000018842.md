
## iImprimeDuplicata (Fonction)

***En anglais : iPrintDuplicate***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Imprime un duplicata d'un état. Ce duplicata peut être imprimé : 

- dans le visualisateur de rapports,

- directement sur l'imprimante,

- dans un fichier (pdf, ...). 




Ce duplicata a été créé : 

- soit explicitement par la fonction [iDestination](../WDLang5/3046074.md) (en utilisant la constante *iDuplicata*). 

- soit directement depuis le visualisateur de rapports (option d'impression du duplicata ou utilisation de la fonction [iParamètreDuplicata](../WDLang5/1000018845.md) avant de lancer le visualisateur de rapports).




**Remarque** : Il est possible de récupérer la liste des duplicata créés pour l'impression en cours grâce à la fonction [iDernierFichier](../WDLang5/3046068.md).  
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Création du duplicata
iDestination(iDuplicata, "C:\Temp\MonDuplicata.dpl")
iImprimeEtat(ETAT_Facture)

// Impression du duplicata dans le visualisateur de rapports
iDestination(iVisualisateur)
iImprimeDuplicata("C:\Temp\MonDuplicata.dpl")
```


<a name="Exemple2"></a>

```wl
// Paramétrage des duplicata réalisés depuis le visualisateur de rapports
iParamètreDuplicata(iDplImpression, "C:\Temp", "MonDuplicata_%d_%h", "MMJJAAAA", "HHMMSS")

// Impression d'un duplicata via le visualisateur de rapports
iDestination(iVisualisateur)
iImprimeEtat(ETAT_Facture)

// Parcours des duplicata créés automatiquement depuis le visualisateur de rapports
sListeDuplicata est une chaîne
sListeDuplicata = iDernierFichier(iDuplicata)
sDuplicata est une chaîne
sDuplicata = ExtraitChaîne(sListeDuplicata, rangPremier, RC)
TANTQUE sDuplicata <> EOT
	// Impression du duplicata
	iImprimeDuplicata(sDuplicata)
	// Passage au duplicata suivant
	sDuplicata = ExtraitChaîne(sListeDuplicata, rangSuivant, RC)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = iImprimeDuplicata(<Fichier duplicata> [, <Mot de passe>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'impression du duplicata a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Fichier duplicata> : (Chaîne de caractères)`**

Nom du fichier de type duplicata (fichier .dpl) à imprimer. Par défaut, le fichier duplicata est recherché dans le répertoire en cours. Il est possible de spécifier si nécessaire le chemin complet du fichier duplicata à imprimer. 

**`<Mot de passe> : (Chaîne de caractères optionnelle)`**

Mot de passe du fichier duplicata à imprimer. Ce mot de passe doit être identique à celui utilisé lors de la création du duplicata. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Erreurs les plus courantes
<a name="erreurs_les_plus_courantes_ELTPARAGRAPHE000067"></a>Les erreurs les plus courantes pouvant être rencontrées sont les suivantes : 

- 90025 : Mot de passe incorrect. Le mot de passe utilisé pour créer le fichier duplicata et celui utilisé pour ouvrir le fichier duplicata sont différents. 

- 90026 : Mauvais format. Le format du fichier duplicata n'est pas correct. Il est corrompu. 

- 90027 : Version trop récente. Le fichier duplicata a été généré avec une version plus récente (de WINDEV ou WEBDEV) que la version utilisée pour lire le fichier duplicata. 



<a name="NOTE0_2"></a>


### Limitations
<a name="limitations_ELTPARAGRAPHE000078"></a>

- Il ne faut pas utiliser la fonction [iFinImprime](../WDLang5/3046053.md) avec la fonction **iImprimeDuplicata**. 

- Les fonctions d'impression ne doivent pas être utilisées lors de l'impression d'un duplicata. Par exemple, le code suivant ne doit pas être utilisé : 
	
	```wl
	iDestination(iVisualisateur)
	iImprime("Ceci est interdit")
	iImprimeDuplicata("C:\Temp\MonDuplicata.dpl")
	```





<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280prn.dll
