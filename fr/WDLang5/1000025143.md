


## &lt;Etat&gt;.InitRequête (Fonction)

***En anglais : &lt;Report&gt;.InitQuery***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Initialise la requête liée à l'état (cas d'une requête paramétrée). Cette fonction peut être appelée :

- soit dans l'événement "Initialisation" de l'état,

- soit avant la fonction [&lt;Etat&gt;.Imprime](../WDLang5/1000024554.md).




**Remarques** :

- Si l'état est lié à une requête non paramétrée, utilisez directement la fonction [&lt;Etat&gt;.Imprime](../WDLang5/1000024554.md).

- Si l'état est lié à une requête (paramétrée ou non) utilisant une connexion spécifique (connexion à une base de données par un provider OLE DB par exemple), utilisez la fonction [&lt;Etat&gt;.InitRequêteConnexion](../WDLang5/1000025144.md).

- Si l'état est inclus dans un état composite, la fonction **&lt;Etat&gt;.InitRequête** doit obligatoirement être appelée dans l'événement "Initialisation" de l'état. 


![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) **Attention** : L'utilisation de cette fonction sous Linux nécessite une configuration spécifique. Pour plus de détails, consultez [Imprimer sous Linux](../Editeurs/9000078.md). 

|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ER.png)<br> | Important | Si la requête est créée avec le logiciel Etats & Requêtes, il n'est pas nécessaire d'utiliser la fonction **&lt;Etat&gt;.InitRequête** pour spécifier les paramètres de la requête. En effet, si l'état sur une requête paramétrée est exécuté depuis le logiciel Etats & Requêtes, une fenêtre s'affiche permettant de saisir les paramètres de la requête. |




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
ETAT_BulletinScolaire.InitRequête("Dupond", "2020") 
ETAT_BulletinScolaire.Imprime()
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Etat manipulé>.InitRequête([<Paramètre 1 de la requête> [... [, <Paramètre N de la requête>]]])`
---

**`<Etat manipulé> : (Nom d'état)`**

Nom logique de l'état à imprimer.

**`<Paramètre 1 de la requête> : (Type du paramètre de la requête (optionnel))`**

Premier paramètre de la requête définie comme source de l'état (si la requête attend un paramètre).



**`<Paramètre N de la requête> : (Type du paramètre de la requête (optionnel))`**

Dernier paramètre de la requête définie comme source de l'état (si la requête attend un paramètre).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Champ Etat Interne : état basé sur une requête paramétrée
<a name="champ_etat_interne_etat_base_sur_une_requete_parametree_ELTPARAGRAPHE000280"></a>Si l'état associé à un champ de type "Etat interne" est basé sur une requête paramétrée, utilisez la fonction **&lt;Etat&gt;.InitRequête** pour passer les paramètres à la requête. Cette fonction doit être utilisée dans l'événement "Avant impression" du bloc contenant le champ "Etat Interne".

Pour plus de détails sur les "Etats Interne", consultez [Champs de type Etat Interne](../WDChamp/1013044.md).
<a name="NOTE0_2"></a>


### Exécution d'une requête et état basé sur cette requête
<a name="execution_une_requete_etat_base_sur_cette_requete_ELTPARAGRAPHE000298"></a>Lors de l'impression d'un état basé sur une requête, si la requête a déjà été exécutée, elle n'est pas ré-exécutée. Pour forcer la ré-exécution de la requête (ajout d'enregistrements par exemple), il suffit d'utiliser les fonctions [&lt;Source&gt;.ExécuteRequête](../WDLang4/1000024944.md) ou **&lt;Etat&gt;.InitRequête**.
<a name="NOTE0_3"></a>


### Libération de la requête
<a name="liberation_requete_ELTPARAGRAPHE000316"></a>Lors de l'impression d'un état basé sur une requête initialisée avec la fonction **&lt;Etat&gt;.InitRequête**, la requête est libérée à la fin de l'impression de l'état (comportement identique à l'appel de la fonction [&lt;Source&gt;.AnnuleDéclaration](../WDLang4/1000024192.md)).
<a name="NOTE0_4"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000334"></a>

- Si certains paramètres attendus par la requête ne sont pas précisés (valeur correspondant à NULL par exemple), les conditions de sélection correspondant à ces paramètres seront ignorées.

- Si le nombre de paramètres précisés dans la fonction **&lt;Etat&gt;.InitRequête** est supérieur au nombre de paramètres attendus par la requête, les paramètres supplémentaires sont ignorés.




<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280etat.dll
