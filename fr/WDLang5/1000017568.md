
## GglAdresseVersCoordonnées (Fonction)

***En anglais : GglAddressToCoordinates***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère les coordonnées (couple latitude/longitude) d'une adresse. Cette fonction utilise le service de cartographie Google Maps.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MaCléGoogle est une chaîne
MaCléGoogle = "Exemple de clé Google"
LocParis est un gglCoordonnée
LocParis = GglAdresseVersCoordonnées(MaCléGoogle, "Paris, France")
LocHome est un gglCoordonnée
LocHome = GglAdresseVersCoordonnées(MaCléGoogle, "3 rue Puech Villa, 34197 Montpellier")
```


<a name="Exemple2"></a>



```wl
MaCléGoogle est une chaîne
MaCléGoogle = "Exemple de clé Google"

// Affichage d'une carte à partir d'une adresse physique
MonZoom est un entier = 12
gglParamètres est un gglParamètreCarte
Latitude, Longitude sont des réels
Localisation est un gglCoordonnée
M1 est un gglMarqueur

// Récupération de la longitude et latitude d'une adresse physique
Localisation = GglAdresseVersCoordonnées(MaCléGoogle, "3 rue de puech villa 34000 Montpellier")
Latitude = Localisation.Latitude
Longitude = Localisation.Longitude

// Création du marqueur pour cette adresse
M1.Latitude = Latitude		
M1.Longitude = Longitude
M1.Couleur = 0x0000FF 
M1.Taille = gglPetit
Ajoute(gglParamètres.Marqueur, M1)

// Affichage de l'adresse dans un champ Image
IMG_MAP = GglRécupèreCarte(MaCléGoogle, Latitude, Longitude, Zoom, IMG_MAP.Largeur, ...
		IMG_MAP.Hauteur, gglPlan, gglParamètres)
```



<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE2"></a>

### Récupérer l'adresse d'un lieu en précisant la clé Google

`<Résultat> = GglAdresseVersCoordonnées(<Clé Google> , <Localisation>)`
---

**`<Résultat> : (Variable de type gglCoordonnée)`**

Variable de type [gglCoordonnée](../WDLang5/1000017489.md) contenant la latitude et la longitude de l'adresse demandée.

**`<Clé Google> : (Chaîne de caractères)`**

Clé d'authentification au service de cartographie Google Maps. Cette clé est fournie par Google.

**`<Localisation> : (Chaîne de caractères)`**

Lieu demandé (nom de ville, pays, adresse complète, ...).  


<a name="SYNTAXE1"></a>



|   |
| --- |
| Cette syntaxe est obsolète à partir du 11 Juin 2018. Désormais, la licence Google ayant évolué, seule la syntaxe utilisant la clé Google doit être utilisée. |


### Récupérer l'adresse d'un lieu

`<Résultat> = GglAdresseVersCoordonnées(<Localisation>)`
---

**`<Résultat> : (Variable de type gglCoordonnée)`**

Variable de type [gglCoordonnée](../WDLang5/1000017489.md) contenant la latitude et la longitude de l'adresse demandée.

**`<Localisation> : (Chaîne de caractères)`**

Lieu demandé (nom de ville, pays, adresse complète, ...).  





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Cas d'erreurs possibles : 
<a name="cas_erreurs_possibles_ELTPARAGRAPHE000071"></a>

- La connexion Internet n'est pas valide.

- Le serveur renvoie une erreur car les coordonnées ne sont pas trouvables.


Pour vérifier si une erreur a été rencontrée, utilisez la variable [ErreurDétectée](../WDLang1/3087001.md).


<a name="NOTE0_2"></a>




### Clé pour le service de cartographie Google Map
<a name="cle_pour_service_cartographie_google_map_ELTPARAGRAPHE000086"></a>Pour obtenir la clé nécessaire à l'utilisation du service Google de cartographie Google Maps, connectez-vous à la console Google API : utilisez l'adresse suivante : [https://developers.google.com/console](https://developers.google.com/console). 

Dans la console : 

1. Cliquez sur "Créer un projet" si nécessaire. Donnez le nom de votre projet. Un identifiant est automatiquement proposé pour votre projet. Validez. Le projet est créé. 

2. Dans le menu de gauche, cliquez sur "API et authentification" puis sur "API". 

3. Choisissez les services dont l'application a besoin : "Geocoding API" et "Places API". 

4. Dans le menu de gauche, cliquez sur "Identifiants".

5. Cliquez ensuite sur le bouton "Créer une clé". 

6. Cliquez ensuite sur "Clé de serveur". 

7. Terminez en cliquant sur le bouton "Créer".

8. La clé est créée et peut être utilisée dans la fonction **GglAdresseVersCoordonnées**.




<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280ggl.dll
