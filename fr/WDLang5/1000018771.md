


## &lt;Variable sfConnexion&gt;.Modifie (Fonction)

***En anglais : &lt;sfConnection variable&gt;.Modify***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie les enregistrements d'un fichier défini dans Salesforce. Ce fichier peut être un fichier prédéfini Salesforce ou un fichier personnalisé.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Connexion à Salesforce
Cnx est une sfConnexion
Cnx..Login = "balthazar@gmail.com"
Cnx..MotDePasse = "azerty" + "XXB12VCZ54"
SI Cnx.Connecte() = Faux ALORS
	Erreur("La connexion a échoué")
	RETOUR
FIN

tabObjets est un tableau de sfObjet
ResRequête est un sfRésultatExécuteRequête
sTexteRequête est chaîne = "SELECT RecordTypeId, Beneficiaire__c, "...
		"ID, Indice_de_mobiliot__c FROM BCM__c WHERE NAME='" + sRecherche + "'"

ResRequête = Cnx.ExécuteRequête(sTexteRequête)

UnEnregistrement est un sfObjet
POUR TOUT UnEnregistrement DE ResRequête.Objet 
	UnEnregistrement.Indice_de_mobiliot__c = "698" // Modification 
	Ajoute(tabObjets, UnEnregistrement) 
FIN

tabRes est un tableau de sfRésultatSauvegarde
tabRes = Cnx.Modifie(tabObjets)
POUR TOUT res DE tabRes
	Trace("Succès = "+res..Succès)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Modifier les enregistrements existants

`<Résultat> = <Connexion Salesforce>.Modifie(<Enregistrements à modifier>)`
---

**`<Résultat> : (Variable de type Tableau)`**

Tableau de variables de type [sfRésultatSauvegarde](../WDLang5/1000018460.md) contenant les données résultat, notamment les identifiants des objets effectivement modifiés.

**`<Connexion Salesforce> : (Variable de type sfConnexion)`**

Nom de la variable de type [sfConnexion](../WDLang5/1000017579.md) à utiliser.

**`<Enregistrements à modifier> : (Variable de type Tableau)`**

Tableau de variables de type [sfObjet](../WDLang5/1000018439.md) correspondant aux enregistrements Salesforce à modifier. Ce tableau ne peut pas contenir plus de 200 éléments.


<a name="SYNTAXE2"></a>

### Modifier les enregistrements existants ou créer des enregistrements

`<Résultat> = <Connexion Salesforce>.Modifie(<Enregistrements à modifier ou créer> , <Mode> , <Identifiant externe>)`
---

**`<Résultat> : (Variable de type Tableau)`**

Tableau de variables de type [sfRésultatSauvegarde](../WDLang5/1000018460.md) contenant les données résultat, notamment les identifiants des objets effectivement modifiés.

**`<Connexion Salesforce> : (Variable de type sfConnexion)`**

Nom de la variable de type [sfConnexion](../WDLang5/1000017579.md) à utiliser.

**`<Enregistrements à modifier ou créer> : (Variable de type Tableau)`**

Tableau de variables de type [sfObjet](../WDLang5/1000018439.md) correspondant aux enregistrements Salesforce à modifier ou créer. Ce tableau ne peut pas contenir plus de 200 éléments.

**`<Mode> : (Entier)`**

Mode de modification utilisé :


|   |   |
| --- | --- |
| *sfCréationSiInexistant* | Si l'enregistrement n'existe pas, il est automatiquement créé. |



**`<Identifiant externe> : (Chaîne de caractères)`**

Dans le cas d'un fichier personnalisé, nom de la rubrique définie comme identificateur de rubrique unique à partir d'un système externe. 

- Cette rubrique permet d'identifier l'enregistrement à modifier. 

- Cette rubrique et sa valeur sont présentes dans l'objet [sfObjet](../WDLang5/1000018439.md) à modifier. 

	- Si la valeur n'existe pas, l'enregistrement sera automatiquement créé. 

	- Si la valeur existe une seule fois, l'enregistrement est mis à jour. 

	- Si la valeur existe plusieurs fois, une erreur est renvoyée.









<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Cas d'erreurs possibles
<a name="cas_erreurs_possibles_ELTPARAGRAPHE000254"></a>

- La connexion Internet n'est pas valide.

- L'authentification n'a pas pu être réalisée correctement.

- La réponse XML du serveur n'est pas lisible.




Pour savoir si une erreur est survenue, utilisez la variable [ErreurDétectée](../WDLang1/3087001.md).

<a name="XComposante"></a>

## Composante :
wd280ggl.dll
