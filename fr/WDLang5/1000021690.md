
## iImprimeSignature (Fonction)

***En anglais : iPrintSignature***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Imprime une image de la signature dans une zone rectangulaire. L'impression n'est pas lancée (seule la fonction [iFinImprime](../WDLang5/3046053.md) permet de lancer l'impression).

Remarque : Cette signature sera utilisée par exemple pour signer les fichiers PDF générés ou les duplicatas. 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Récupération de la liste des certificats disponibles sur le poste
tabCertificat est un tableau de Certificats
tabCertificat = CertificatListe()

// Ouverture du visualisateur de rapports
iDestination(iVisualisateur)
iImprimeSignature(iSignatureApprobation, tabCertificat[1], "Mon certificat", 10, 10, 200, 200)
iFinImprime()
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Imprimer une signature définie par un certificat

`<Résultat> = iImprimeSignature(<Type de signature> , <Certificat> , <Libellé> , <X1> , <Y1> , <X2> , <Y2>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'impression de la signature a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'échec.




**`<Type de signature> : (Constante de type Entier)`**

Type et format de la signature à effectuer : 

- Type de signature : 
	


|   |   |
| --- | --- |
| *iSignatureApprobation* | Signature d'approbation. Une signature d'approbation correspond à une marque appliquée par une tierce personne pour indiquer qu'elle approuve le contenu du document. |
| *iSignatureCertification* | Signature de certification. Une signature de certification correspond à un sceau appliqué sur le document pour garantir son intégrité. |



- Format de signature (combinable avec un des types de signature) : 
	

	- Format de signature PAdES:
			


|   |   |
| --- | --- |
| *iSignature_CAdES_B* | Format de signature CAdES Basic (CMS Advanced Electronic Signature). |
| *iSignature_CAdES_C* | Format de signature CAdES C (CMS Advanced Electronic Signature). |
| *iSignature_CAdES_T* | Format de signature CAdES Trust token (CMS Advanced Electronic Signature). |
| *iSignature_CAdES_X* | Format de signature CAdES X Type 2 (CMS Advanced Electronic Signature).  |
| *iSignature_CAdES_XL* | Format de signature CAdES XL Type 2 (CMS Advanced Electronic Signature). |




**`<Certificat> : (Variable de type Certificat)`**

Nom de la variable de type [Certificat](../WDLang1/1000019287.md) contenant la signature à utiliser.

**`<Libellé> : (Chaîne de caractères)`**

Texte affiché dans la zone de signature. 

**`<X1> : (Réel)`**

Coordonnée horizontale (colonne ou abscisse) du coin haut gauche de la zone de la signature (en millimètres). 
Valeur comprise entre 0 et la largeur de la page (donnée par [iLargeurPage](../WDLang5/3046036.md)).

**`<Y1> : (Réel)`**

Coordonnée verticale (ligne ou ordonnée) du coin haut gauche de la zone de la signature (en millimètres). 
Valeur comprise entre 0 et la hauteur de la page (donnée par [iHauteurPage](../WDLang5/3046052.md)).

**`<X2> : (Réel)`**

Coordonnée horizontale (colonne ou abscisse) du coin bas droit de la zone de la signature (en millimètres). 
Valeur comprise entre 0 et la largeur de la page (donnée par [iLargeurPage](../WDLang5/3046036.md)).

**`<Y2> : (Réel)`**

Coordonnée verticale (ligne ou ordonnée) du coin bas droit de la zone de la signature (en millimètres). 
Valeur comprise entre 0 et la hauteur de la page (donnée par [iHauteurPage](../WDLang5/3046052.md)).


<a name="SYNTAXE2"></a>

### Imprimer une signature définie par une variable pdfSignature

`<Résultat> = iImprimeSignature([<Type de signature>, ] <Signature>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'impression de la signature a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'échec.




**`<Type de signature> : (Constante optionnelle de type Entier)`**

Type et format de la signature à effectuer : 

- Type de signature : 
	


|   |   |
| --- | --- |
| *iSignatureApprobation* | Signature d'approbation. Une signature d'approbation correspond à une marque appliquée par une tierce personne pour indiquer qu'elle approuve le contenu du document. |
| *iSignatureCertification* | Signature de certification. Une signature de certification correspond à un sceau appliqué sur le document pour garantir son intégrité. |



- Format de signature (combinable avec un des types de signature) : 
	

	- Format de signature PAdES:
			


|   |   |
| --- | --- |
| *iSignature_CAdES_B* | Format de signature CAdES Basic (CMS Advanced Electronic Signature). |
| *iSignature_CAdES_C* | Format de signature CAdES C (CMS Advanced Electronic Signature). |
| *iSignature_CAdES_T* | Format de signature CAdES Trust token (CMS Advanced Electronic Signature). |
| *iSignature_CAdES_X* | Format de signature CAdES X Type 2 (CMS Advanced Electronic Signature).  |
| *iSignature_CAdES_XL* | Format de signature CAdES XL Type 2 (CMS Advanced Electronic Signature). |




**`<Signature> : (Variable de type pdfSignature)`**

Nom de la variable de type [pdfSignature](../WDLang6/1000022255.md) contenant la signature à utiliser.









<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Pour imprimer une image dans la zone de signature, utilisez la fonction [iImprimeImage](../WDLang5/3046017.md) : 
	
	```wl
	iImprimeSignature(iSignatureApprobation, MaSignature, "", 150, 200, 250, 250)
	iImprimeImage("signature test.jpg", 150, 200, 250, 250)
	```


- Dans un état créé avec l'éditeur d'états, utilisez un champ Signature pour signer les fichiers PDF. Pour plus de détails, consultez [Le champ Signature](../WDChamp/1410087013.md). 




- **Attention** : Pour qu'un fichier PDF signé soit reconnu par Acrobat, l'organisme émetteur du certificat de signature doit être membre de la liste AATL ([Adobe Authorized Trust List](https://helpx.adobe.com/acrobat/kb/trust-services.html)) ou du programme CDS (Certified Document Services). 
	Si le certificat n'est pas reconnu, Acrobat affichera un bandeau "Une signature au moins présente un problème...".








<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280prn.dll
