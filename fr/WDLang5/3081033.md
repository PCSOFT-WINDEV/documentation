


## XMLSauvePosition (Fonction)

***En anglais : XMLSavePosition***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Mémorise la position en cours dans le document XML. Il est ainsi possible de suspendre momentanément le traitement en cours, d'utiliser le document XML par ailleurs (pour effectuer des vérifications par exemple). Le contexte sauvegardé pourra être restitué grâce à la fonction [XMLRetourPosition](../WDLang5/3081032.md). Le traitement principal pourra alors continuer.

**Remarque** : La fonction **XMLSauvePosition** sauvegarde le filtre en cours (le filtre est mis en place avec la fonction [XMLRecherche](../WDLang5/3081025.md)).








<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003081033&name=xmlsauveposition_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
SI XMLDocument("MonDocXML", CodeXML) = Vrai ALORS
	// Recherche des liens
	XMLRecherche("MonDocXML", "a", XMLBalise)
	TANTQUE XMLTrouve("MonDocXML") = Vrai
		SI XMLFilsExiste("MonDocXML", XMLAttribut) = Vrai ALORS
			LaPositionXML est un entier = XMLSauvePosition("MonDocXML")
			XMLFils("MonDocXML")
			Trace(XMLDonnée("MonDocXML")) 
			// Traitement
			XMLRetourPosition("MonDocXML", LaPositionXML, XMLRPFiltre) 
		FIN
		// Elément suivant dans la recherche
		XMLSuivant("MonDocXML")
	 FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = XMLSauvePosition(<Document XML>)`
---

**`<Résultat> : (Entier)`**



- Numéro de la position sauvegardée, 

- -1 en cas d'erreur.




**`<Document XML> : (Chaîne de caractères)`**

Nom du document XML manipulé. Ce document contient le code XML à analyser et a été créé avec la fonction [XMLDocument](../WDLang5/3081008.md).  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Sauvegarde de plusieurs positions
<a name="sauvegarde_plusieurs_positions_ELTPARAGRAPHE000091"></a>La fonction **XMLSauvePosition** peut être utilisée plusieurs fois pour sauvegarder plusieurs positions dans le fichier XML. Il suffit d'affecter la position à différentes variables de type entier. Ces différentes positions pourront être restaurées ensuite avec la fonction [XMLRetourPosition](../WDLang5/3081032.md).  
<a name="NOTE0_2"></a>


### Fonctions XML et threads
<a name="fonctions_xml_threads_ELTPARAGRAPHE000231"></a>Si votre application utilise des threads, le document XML est partagé entre tous ces threads. Pour plus de détails sur la gestion des threads, consultez [Gestion des threads](../WDLang1/3077026.md).

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280xml.dll
