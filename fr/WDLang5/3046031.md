
## iImprime (Fonction)

***En anglais : iPrint***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Envoie au "buffer" d'impression la chaîne de caractères passée en paramètre.

Un saut de ligne est automatiquement inséré à la fin de la chaîne : le curseur est ainsi positionné sur la ligne suivante. Le passage à la ligne suivante tient compte de la hauteur de la ligne en cours (en fonction de la police utilisée). L'impression n'est pas lancée (seule la fonction [iFinImprime](../WDLang5/3046053.md) permet de lancer l'impression).

**Remarques** :

- Pour imprimer une chaîne de caractères sans passer à la ligne suivante, utilisez la fonction [iImprimeMot](../WDLang5/3046034.md).

- La fonction **iImprime** ne doit pas être utilisée dans le code d'ouverture d'un état.







<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
iImprime(iPolice(2) + "Texte en police 2")
iSautePage()
// Nom du client sur la première ligne à 50 mm du bord
iImprime(iPosX(50) + Cl.NomCli)
iFinImprime()
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = iImprime(<Texte à imprimer> [, <Chaîne sur page suivante>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'impression a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> si l'impression a été abandonnée.




**`<Texte à imprimer> : (Chaîne de caractères)`**

Chaîne de caractères à imprimer avec ses caractéristiques. Ce paramètre est de la forme : 

```txt
[<Identifiant police> +] [<Position verticale> +] [<Position horizontale> +] <Texte1> 
...
[<Identifiant police> +] [<Position verticale> +] [<Position horizontale> +] <TexteN>
```
où : 

- &lt;Identifiant police&gt; : entier optionnel.
	Identifiant de la police utilisée pour imprimer le texte. Cet identifiant est renvoyé par la fonction [iPolice](../WDLang5/3046014.md). Si ce paramètre n'est pas spécifié, la dernière police utilisée sera sélectionnée.

- &lt;Position verticale&gt; : entier optionnel.
	Ordonnée du point où l'impression doit être effectuée. Cette position est donnée en nombre de lignes depuis le bord haut de la feuille (avec la fonction [iPosY](../WDLang5/3046075.md)). Si ce paramètre n'est pas précisé, le texte sera imprimé à la position courante.

- &lt;Position horizontale&gt; : entier optionnel. 
	Abscisse du point où l'impression doit être effectuée. Cette position est donnée en nombre de colonnes depuis le bord haut gauche de la feuille (avec la fonction [iPosX](../WDLang5/3046015.md)). Si ce paramètre n'est pas précisé, le texte sera imprimé à la position courante.

- &lt;Texte&gt; : Chaîne de caractères. 
	Chaîne de caractères à imprimer.


Exemple : 

```wl
Texte_a_imprimer = "Première partie" + iPolice(1) + "Seconde partie"
```


**`<Chaîne sur page suivante> : (Booléen optionnel)`**

Détermine si le texte imprimé à la fin de la page doit être tronqué ou doit continuer sur la page suivante :

- <u><u><u><u>Vrai</u></u></u></u> (valeur par défaut) : la chaîne sera imprimée sur la page suivante si elle ne rentre pas sur une seule page. 

- <u><u><u><u>Faux</u></u></u></u> : la chaîne de caractères est tronquée : la suite de la chaîne n'est pas imprimée sur la page suivante.








<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Caractéristiques de l'impression
<a name="caracteristiques_impression_ELTPARAGRAPHE000125"></a>

- L'origine (0,0) est située dans le coin supérieur gauche de la feuille. Elle tient compte des marges physiques de l'imprimante.

- La position verticale en cours lors de l'impression d'une chaîne de caractères pointe sur le haut de la chaîne. La position basse dépend de la hauteur des polices utilisées dans la ligne à imprimer.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=iImprime.gif)


- Il est possible de spécifier plusieurs polices et plusieurs positions en paramètre d'une seule fonction **iImprime**. Par exemple :
	
	```wl
	iImprime(iPosX(50) + CL.NOM + iPosX(150) + CL.PRENOM)
	```


- Le caractère correspondant à un saut de ligne (Caract(10)) est interprété comme un saut à la ligne suivante.





<a name="NOTE0_2"></a>




### Combinaison de polices
<a name="combinaison_polices_ELTPARAGRAPHE000143"></a>Lors de la combinaison de polices, des effets inattendus peuvent être observés. Par exemple, le code :


```wl
iPolice(2)
iImprime("Première partie" + iPolice(1) + "Seconde partie")
```


n'est pas équivalent à :


```wl
iImprime(iPolice(2) + "Première partie" + iPolice(1) + "Seconde partie")
```


Dans le premier cas, toute la chaîne de caractères est imprimée en police 1. En effet, dans ce cas, la fonction **iPolice(1)** est exécutée lors de la construction de la chaîne à imprimer et donc avant l'impression de la chaîne "Première Partie".

Pour obtenir un résultat identique, il suffit d'utiliser la fonction [iPolice](../WDLang5/3046014.md) avec le paramètre <u><u><u><u>Faux</u></u></u></u> : la fonction iPolice(1, Faux) ne sera alors réellement exécutée que lors de l'impression.


<a name="NOTE0_3"></a>




### Combinaison de positions
<a name="combinaison_positions_ELTPARAGRAPHE000169"></a>Lors de la combinaison de positions, des effets inattendus peuvent être observés. Par exemple, le code :


```wl
iPosX(50)
iImprime("Première partie" + iPosX(30) + "Seconde partie")
```


n'est pas équivalent à :


```wl
iImprime(iPosX(50) + "Première partie" + iPosX(30) + "Seconde partie")
```


Dans le premier cas, toute la chaîne de caractères est imprimée en position horizontale 30. En effet, dans ce cas, la fonction **iPosX(30)** est exécutée lors de la construction de la chaîne à imprimer et donc avant l'impression de la chaîne "Première Partie".

Pour obtenir un résultat identique, il suffit d'utiliser la fonction [iPosX](../WDLang5/3046015.md) avec le paramètre <u><u><u><u>Faux</u></u></u></u> : la fonction iPosX(30, Faux) ne sera alors réellement exécutée que lors de l'impression.

La même manipulation peut être réalisée avec la fonction [iPosY](../WDLang5/3046075.md).


<a name="NOTE0_4"></a>
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Impression en Java et Android
<a name="impression_java_android_ELTPARAGRAPHE000201"></a>Les impressions peuvent être moins précises car la résolution des impressions est de 72 point par pouce (ppp) même si l'imprimante supporte des résolutions plus importantes.

**Conséquence** : Les calculs des points des images et des dessins (traits par exemple) sont arrondis durant les calculs de position en impression, en particulier lorsque l'on manipule des valeurs petites. Lors de l'impression, les calculs se font en point (en fonction de la résolution d'impression) et non en mm (ou cm).

**Exemple : Impressions de traits** : si les traits sont espacés de 0.5 mm, combien y a-t-il  de points entre chaque trait en Java (résolution 72 ppp) ?

Le premier trait est à 0.5 mm soit (0.5/25.4) pouces et avec une résolution de 72 points par pouce (ppp) : (0.5/25.4)  x 72 = 1,42 point. Mais le point est l'unité de base, il est donc indivisible : le résultat est automatiquement arrondi au 1 point inférieur ou supérieur selon le cas.

Voici donc une succession de traits imprimés avec un espace de à 0.5 mm :

- 0.5 mm --&gt; (1.42)  1 point

- 1.0 mm --&gt; (2.84)  3 points

- 1.5 mm --&gt; (4.25)  4 points. Attention : le trait à 1.5 mm est collé avec le trait qui est à 1 mm (sans espace entre ces deux traits)

- 2.0 mm --&gt; (5.67)  6 points

- 2.5 mm --&gt; (7.09)  7  points. Attention : le trait à 2.5 mm est collé avec le trait qui est à 2 mm (sans espace entre ces deux traits)

- 3.0 mm --&gt; (8.50)  9 points

- 3.5 mm --&gt; (9.92) 10 points. Attention : le trait à 3.5 mm est collé avec le trait qui est à 3 mm (sans espace entre ces deux traits)

- 4.0 mm --&gt; (11.33) 11 points. Attention : le trait à 4 mm est collé avec le trait qui est à 3.5 mm (sans espace entre ces deux traits)

- etc.




**Pour avoir une représentation fidèle (sans arrondis)**, la taille et / ou la position en mm pour une résolution de 72 ppp doit être un multiple de 127/360.

1 point --&gt; (1/72) pouces --&gt; (1/72) x 25.4 mm = 127/360 = 0.3527778 mm

<a name="XComposante"></a>

## Composante :
wd280prn.dll
