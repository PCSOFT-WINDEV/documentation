
## iCréePolice (Fonction)

***En anglais : iCreateFont***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Crée une nouvelle police d'impression. Cette police pourra être utilisée dans les différents traitements. Cette police est référencée par un numéro de police, choisi lors du développement. Pour choisir cette police et l'utiliser dans les diverses fonctions d'impression, il suffira ensuite de la sélectionner avec la fonction [iPolice](../WDLang5/3046014.md).

**Remarque** : Cette fonction doit IMPÉRATIVEMENT être appelée APRÈS la fonction [iAperçu](../WDLang5/3046069.md). Dans le cas contraire, les aperçus seront ignorés.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003046045&name=icreepolice_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Crée une police de 48 points Pica
iCréePolice(1, 48, iGras + iItalique, iRoman)
// Imprime un texte avec cette police
iImprime(iPolice(1) + "Texte de taille 48")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Créer une nouvelle police

`iCréePolice(<Identifiant> , <Taille> , <Style> , <Nom> [, <Couleur> [, <Angle>]])`
---

**`<Identifiant> : (Entier)`**

Identifiant de la police. Cet identifiant sera utilisé dans les différentes fonctions d'impression pour spécifier la police utilisée.

**`<Taille> : (Entier)`**

Hauteur de la police en points Pica (1 point Pica = 0.353 mm).

**`<Style> : (Constante ou combinaison de constantes de type entier)`**

Attributs de la police.


|   |   |
| --- | --- |
| *iBarre* | Police barrée |
| *iCondense* | Caractères condensés<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette option est ignorée. |
| *iEtendu* | Caractères étendus<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette option est ignorée. |
| *iGras* | Police en gras |
| *iItalique* | Police italique |
| *iLarge* | Caractères larges<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette option est ignorée. |
| *iNormal*<br>(valeur par défaut) | Police normale, sans attributs |
| *iSouligné* | Police soulignée |







**`<Nom> : (Chaîne de caractères)`**

Nom de la police (parmi les polices installées sur le poste en cours).

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) **Impressions en PDF** : seules les polices suivantes sont supportées : Courier, Helvetica, Times, Symbol et ZapfDingbats. Si le nom de la police spécifié ne correspond pas à une police supportée, la police Helvetica sera utilisée en substitution.

**`<Couleur> : (Entier optionnel)`**

Couleur utilisée pour la police. Si ce paramètre n'est pas précisé, la couleur utilisée est le noir. 
Cette couleur peut correspondre à :

- une couleur RVB (obtenue avec la fonction [RVB](../WDLang1/3029012.md)),

- une couleur TSL (obtenue avec la fonction [TSL](../WDLang1/3029057.md)),

- [une couleur prédéfinie du WLangage](../WDLang5/3010002.md).




**`<Angle> : (Entier optionnel)`**

Angle (en degrés) selon lequel le texte sera imprimé. L'angle est calculé à partir d'une ligne horizontale, dans le sens inverse des aiguilles d'une montre (sens trigonométrique).




<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Créer une famille de polices

`iCréePolice(<Identifiant> , <Taille> , <Style> , <Famille> [, <Couleur> [, <Angle>]])`
---

**`<Identifiant> : (Entier)`**

Identifiant de la police. Cet identifiant sera utilisé dans les différentes fonctions d'impression pour spécifier la police utilisée.

**`<Taille> : (Entier)`**

Hauteur de la police en points Pica (1 point Pica = 0.353 mm).

**`<Style> : (Constante ou combinaison de constantes de type entier)`**

Attributs de la police.


|   |   |
| --- | --- |
| *iBarre* | Police barrée |
| *iCondense* | Caractères condensés |
| *iEtendu* | Caractères étendus |
| *iGras* | Police en gras |
| *iItalique* | Police italique |
| *iLarge* | Caractères larges |
| *iNormal*<br>(valeur par défaut) | Police normale, sans attributs |
| *iSouligné* | Police soulignée |



**`<Famille> : (Constante de type entier)`**

Famille de la police.


|   |   |
| --- | --- |
| *iCourier* | Fonte de style Courrier (largeur de caractère fixe) |
| *iDéfaut* | Fonte quelconque ("Don't care") |
| *iRoman* | Fonte Roman (police souvent exotique) |
| *iSwiss* | Fonte Swiss (police de qualité) |



**`<Couleur> : (Entier optionnel)`**

Couleur utilisée pour la police. Si ce paramètre n'est pas précisé, la couleur utilisée est le noir. 
Cette couleur peut correspondre à :

- une couleur RVB (obtenue avec la fonction [RVB](../WDLang1/3029012.md)),

- une couleur TSL (obtenue avec la fonction [TSL](../WDLang1/3029057.md)),

- [une couleur prédéfinie du WLangage](../WDLang5/3010002.md).




**`<Angle> : (Entier optionnel)`**

Angle (en degrés) selon lequel le texte sera imprimé. L'angle est calculé à partir d'une ligne horizontale, dans le sens inverse des aiguilles d'une montre (sens trigonométrique).  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Police par défaut
<a name="police_par_defaut_ELTPARAGRAPHE000240"></a>Si la fonction **iCréePolice** n'est pas utilisée, la police par défaut a les caractéristiques suivantes : 

- Police numéro 0, 

- taille : 12, 

- style normal.





<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Police et famille
<a name="police_famille_ELTPARAGRAPHE000257"></a>Avec certaines configurations, la fonction [iImprime](../WDLang5/3046031.md) peut produire des défauts de polices si un nom de famille de polices a été indiqué dans la fonction **iCréePolice**. Il est conseillé d'indiquer le nom d'une police dans la fonction **iCréePolice**.
<a name="NOTE0_3"></a>




### Obtenir la liste des polices installées sur un poste
<a name="obtenir_liste_des_polices_installees_sur_poste_ELTPARAGRAPHE000274"></a>Pour obtenir la liste des polices installées sur une machine :

1. Dans le gestionnaire des programmes de Windows, sélectionnez le groupe principal.

2. Cliquez sur l'icône "Panneau de configuration", puis sélectionnez "Polices".

3. Dans la liste des polices installées, notez les noms sans tenir compte des attributs ni des types de police.


Remarques :

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) La fonction [PoliceListe](../WDLang1/3060003.md) permet d'obtenir la liste des polices installées sur un poste.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) La fonction [iSelectPolice](../WDLang5/3046055.md) permet de créer une police d'impression à partir de la fenêtre standard de sélection de polices de Windows



<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Différences entre PoliceCrée et iCréePolice
<a name="differences_entre_policecree_icreepolice_ELTPARAGRAPHE000302"></a>La fonction [PoliceCrée](../WDLang1/3060002.md) permet de créer une définition de police utilisable dans tous les éléments d'une application WINDEV ou WEBDEV. Cette police est mémorisée grâce au type de variable [Police](../Motscles/1514045.md) et pourra être utilisée :

- pour écrire du texte dans des dessins (fonction [dPolice](../WDLang1/3029020.md)).

- pour sélectionner une police d'impression (fonction [iPolice](../WDLang5/3046014.md)).

- pour définir la police utilisée dans les champs d'une fenêtre (propriété [Police des champs de fenêtre](../Motscles/1514045.md)).

- pour définir la police utilisée dans les champs d'un état (propriété [Police des champs d'un état](../Motscles/1514045.md)).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) pour sélectionner la police utilisée dans les graphes (fonctions [grPoliceEtiquette](../WDLang3/3042012.md), [grPoliceLégende](../WDLang3/3042037.md), [grPoliceTitre](../WDLang3/3042048.md), [grPoliceTitreAxe](../WDLang3/3042059.md)).




La fonction **iCréePolice** permet uniquement de créer une police utilisable par les fonctions d'impression.
<a name="NOTE0_5"></a>




### Divers
<a name="divers_ELTPARAGRAPHE000353"></a>

- La fonction **iCréePolice** permet de créer simultanément autant de polices que possible (limite de la mémoire).

- Il est nécessaire de créer autant de polices que le texte comporte de couleurs.

- Lors d'une impression dans un fichier HTML ou RTF (fonctions [iAperçu](../WDLang5/3046069.md) ou [iDestination](../WDLang5/3046074.md)), les polices orientées à 90° sont remplacées par une police à 0° : le texte est imprimé horizontalement.





<a name="NOTE0_7"></a>


### Libérer les polices créées avec la fonction iCréePolice
<a name="liberer_les_polices_creees_avec_fonction_icreepolice_ELTPARAGRAPHE000372"></a>Les polices créées avec la fonction **iCréePolice** peuvent être libérées par la fonction [iRAZ](../WDLang5/3046067.md) lorsqu'elles ne sont plus utilisées afin de libérer les ressources qu'elles occupent. Si la fonction [iRAZ](../WDLang5/3046067.md) n'est pas utilisée, les polices seront automatiquement libérées à la fermeture de l'application.

<a name="XComposante"></a>

## Composante :
wd280prn.dll
