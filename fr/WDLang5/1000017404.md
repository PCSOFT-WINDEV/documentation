
## GglRécupèreCarte (Fonction)

***En anglais : GglGetStaticMap***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère la carte d'un lieu précis par le service de cartographie Google Maps.  


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000017572&name=gglrecuperecarte_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
MaCléGoogle est une chaîne
MaCléGoogle = "Exemple de clé Google"

MonImage est une Image
MonImage = GglRécupèreCarte(MaCléGoogle, 40.714728, 73.998672, 14, 400, 400)
```


<a name="Exemple2"></a>



```wl
// Code permettant d'afficher un trajet
MaCléGoogle est une chaîne
MaCléGoogle = "Exemple de clé Google"

MonImage est une Image 
Point est un gglParamètreCarte
Coord est un gglCoordonnée
Marq est un gglMarqueur

Point.Chemin.Couleur = JauneClair
Point.Chemin.Epaisseur = 6
Point.Chemin.Opacité = 100

POUR TOUTE LIGNE i DE TABLE_Table1
	Coord.Latitude = COL_Latitude
	Coord.Longitude = COL_Longitude
	TableauAjoute(Point.Chemin.Point, Coord)
FIN
Point..Format = gglPNG32

MonImage = GglRécupèreCarte(MaCléGoogle, 40.6423, -73.7959, 12, 600, 600, gglHybride, Point)

IMG_Image2 = MonImage
```



<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE3"></a>

### Récupérer une carte avec paramétrage du centrage

`<Résultat> = GglRécupèreCarte(<Clé Google> , <Latitude> , <Longitude> , <Zoom> , <Largeur de l'image> , <Hauteur de l'image> [, <Type de carte> [, <Paramètres avancés>]])`
---

**`<Résultat> : (Variable de type Image)`**

Nom de la variable de type [Image](../WDLang1/1000019650.md) contenant la carte. La carte est renvoyée aux dimensions spécifiées.

**`<Clé Google> : (Chaîne de caractères)`**

Clé d'authentification au service de cartographie Google Maps. Cette clé est fournie par Google.

**Remarque** : La clé Google est nécessaire uniquement pour une utilisation avancée (utilisation payante pour plus de 25000 requêtes par jour).

**`<Latitude> : (Réel)`**

Latitude du point central de la carte.

**`<Longitude> : (Réel)`**

Longitude du point central de la carte.

**`<Zoom> : (Entier)`**

Niveau de zoom. Ce paramètre peut correspondre :

- à un entier compris entre 0 (zoom le plus éloigné) à 19 (zoom le plus rapproché, par exemple à l'échelle d'un immeuble).

- à la constante *gglZoomAuto*. Dans ce cas, le zoom est automatiquement choisi par rapport aux marqueurs ou à la zone définis dans le paramètre &lt;Paramètres avancés&gt;. Si cette constante est utilisée sans le paramètre &lt;Paramètres avancés&gt;, une erreur WLangage est affichée.




**`<Largeur de l'image> : (Entier)`**

Largeur (en pixels) de l'image de la carte à récupérer. La largeur maximale est de 640 pixels. Cette limite est définie par le service de cartographie Google Maps à la date de la rédaction de cette page.

**`<Hauteur de l'image> : (Entier)`**

Hauteur (en pixels) de l'image de la carte à récupérer. La hauteur maximale est de 640 pixels. Cette limite est définie par le service de cartographie Google Maps à la date de la rédaction de cette page.

**`<Type de carte> : (Constante optionnelle de type chaîne de caractères)`**

Type de carte à récupérer. Ce paramètre peut correspondre à une des constantes suivantes :



|   |   |
| --- | --- |
| *gglHybride* | Carte mélangeant le mode plan et satellite. |
| *gglPériphériqueMobile* | Plan optimisé pour les contraintes spécifiques à l'affichage sur un Mobile |
| *gglPlan*<br>(Valeur par défaut) | Carte en mode Plan. |
| *gglSatellite* | Vue satellite. |
| *gglTerrain* | Vue du relief, affichant le terrain et la végétation. |



**`<Paramètres avancés> : (Variable optionnelle de type gglParamètreCarte)`**

Nom de la variable de type [gglParamètreCarte](../WDLang5/1000017505.md) contenant le paramétrage avancé de la carte. Si ce paramètre n'est pas spécifié, la carte sera au format Gif et ne contiendra ni marqueurs, ni chemin, ni zone.  


<a name="SYNTAXE4"></a>

### Récupérer une carte avec centrage automatique

`<Résultat> = GglRécupèreCarte(<Clé Google> , <Largeur de l'image> , <Hauteur de l'image> , <Type de carte> , <Paramètres avancés>)`
---

**`<Résultat> : (Variable de type Image)`**

Nom de la variable de type [Image](../WDLang1/1000019650.md) contenant la carte. La carte est renvoyée aux dimensions spécifiées. 

**`<Clé Google> : (Chaîne de caractères)`**

Clé d'authentification au service de cartographie Google Maps. Cette clé est fournie par Google.

**Remarque** : La clé Google est nécessaire uniquement pour une utilisation avancée (utilisation payante pour plus de 25000 requêtes par jour).

**`<Largeur de l'image> : (Entier)`**

Largeur (en pixels) de l'image de la carte à récupérer. La largeur maximale est de 640 pixels. Cette limite est définie par le service de cartographie Google Maps à la date de la rédaction de cette page.

**`<Hauteur de l'image> : (Entier)`**

Hauteur (en pixels) de l'image de la carte à récupérer. La hauteur maximale est de 640 pixels. Cette limite est définie par le service de cartographie Google Maps à la date de la rédaction de cette page.

**`<Type de carte> : (Constante de type chaîne de caractères)`**

Type de carte à récupérer. Ce paramètre peut correspondre à une des constantes suivantes :



|   |   |
| --- | --- |
| *gglHybride* | Carte mélangeant le mode plan et satellite. |
| *gglPériphériqueMobile* | Plan optimisé pour les contraintes spécifiques à l'affichage sur un Mobile |
| *gglPlan* | Carte en mode Plan. |
| *gglSatellite* | Vue satellite. |
| *gglTerrain* | Vue du relief, affichant le terrain et la végétation. |





**`<Paramètres avancés> : (Variable de type gglParamètreCarte)`**

Nom de la variable de type [gglParamètreCarte](../WDLang5/1000017505.md) contenant le paramétrage avancé de la carte.  






<a name="SYNTAXE1"></a>



|   |
| --- |
| Cette syntaxe est obsolète à partir du 11 Juin 2018. Désormais, la licence Google ayant évolué, seule la syntaxe utilisant la clé Google doit être utilisée. |


### Récupérer une carte avec paramétrage du centrage

`<Résultat> = GglRécupèreCarte(<Latitude> , <Longitude> , <Zoom> , <Largeur de l'image> , <Hauteur de l'image> [, <Type de carte> [, <Paramètres avancés>]])`
---

**`<Résultat> : (Variable de type Image)`**

Nom de la variable de type [Image](../WDLang1/1000019650.md) contenant la carte. La carte est renvoyée aux dimensions spécifiées. 

**`<Latitude> : (Réel)`**

Latitude du point central de la carte.

**`<Longitude> : (Réel)`**

Longitude du point central de la carte.

**`<Zoom> : (Entier)`**

Niveau de zoom. Ce paramètre peut correspondre :

- à un entier compris entre 0 (zoom le plus éloigné) à 19 (zoom le plus rapproché, par exemple à l'échelle d'un immeuble).

- à la constante *gglZoomAuto*. Dans ce cas, le zoom est automatiquement choisi par rapport aux marqueurs ou à la zone définis dans le paramètre &lt;Paramètres avancés&gt;. Si cette constante est utilisée sans le paramètre &lt;Paramètres avancés&gt;, une erreur WLangage est affichée.




**`<Largeur de l'image> : (Entier)`**

Largeur (en pixels) de l'image de la carte à récupérer. La largeur maximale est de 640 pixels. Cette limite est définie par le service de cartographie Google Maps à la date de la rédaction de cette page.

**`<Hauteur de l'image> : (Entier)`**

Hauteur (en pixels) de l'image de la carte à récupérer. La hauteur maximale est de 640 pixels. Cette limite est définie par le service de cartographie Google Maps à la date de la rédaction de cette page.

**`<Type de carte> : (Constante optionnelle de type chaîne de caractères)`**

Type de carte à récupérer. Ce paramètre peut correspondre à une des constantes suivantes :



|   |   |
| --- | --- |
| *gglHybride* | Carte mélangeant le mode plan et satellite. |
| *gglPériphériqueMobile* | Plan optimisé pour les contraintes spécifiques à l'affichage sur un Mobile |
| *gglPlan*<br>(Valeur par défaut) | Carte en mode Plan. |
| *gglSatellite* | Vue satellite. |
| *gglTerrain* | Vue du relief, affichant le terrain et la végétation. |



**`<Paramètres avancés> : (Variable optionnelle de type gglParamètreCarte)`**

Nom de la variable de type [gglParamètreCarte](../WDLang5/1000017505.md) contenant le paramétrage avancé de la carte. Si ce paramètre n'est pas spécifié, la carte sera au format Gif et ne contiendra ni marqueurs, ni chemin, ni zone.  


<a name="SYNTAXE2"></a>



|   |
| --- |
| Cette syntaxe est obsolète à partir du 11 Juin 2018. Désormais, la licence Google ayant évolué, seule la syntaxe utilisant la clé Google doit être utilisée. |


### Récupérer une carte avec centrage automatique

`<Résultat> = GglRécupèreCarte(<Largeur de l'image> , <Hauteur de l'image> , <Type de carte> , <Paramètres avancés>)`
---

**`<Résultat> : (Variable de type Image)`**

Nom de la variable de type [Image](../WDLang1/1000019650.md) contenant la carte. La carte est renvoyée aux dimensions spécifiées. 

**`<Largeur de l'image> : (Entier)`**

Largeur (en pixels) de l'image de la carte à récupérer. La largeur maximale est de 640 pixels. Cette limite est définie par le service de cartographie Google Maps à la date de la rédaction de cette page.

**`<Hauteur de l'image> : (Entier)`**

Hauteur (en pixels) de l'image de la carte à récupérer. La hauteur maximale est de 640 pixels. Cette limite est définie par le service de cartographie Google Maps à la date de la rédaction de cette page.

**`<Type de carte> : (Constante de type chaîne de caractères)`**

Type de carte à récupérer. Ce paramètre peut correspondre à une des constantes suivantes :



|   |   |
| --- | --- |
| *gglHybride* | Carte mélangeant le mode plan et satellite. |
| *gglPériphériqueMobile* | Plan optimisé pour les contraintes spécifiques à l'affichage sur un Mobile |
| *gglPlan* | Carte en mode Plan. |
| *gglSatellite* | Vue satellite. |
| *gglTerrain* | Vue du relief, affichant le terrain et la végétation. |



**`<Paramètres avancés> : (Variable de type gglParamètreCarte)`**

Nom de la variable de type [gglParamètreCarte](../WDLang5/1000017505.md) contenant le paramétrage avancé de la carte.  







<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Enregistrement de la carte Google
<a name="enregistrement_carte_google_ELTPARAGRAPHE000235"></a>Pour enregistrer la carte Google dans un fichier, il est possible de :

- utiliser les fonctions [dSauveImageBMP](../WDLang1/3029026.md), [dSauveImageGIF](../WDLang1/3029040.md), [dSauveImageJPEG](../WDLang1/3029038.md) et [dSauveImagePNG](../WDLang1/3029027.md) : l'image présente dans le champ Image est sauvegardée au format voulu.

- utiliser directement la fonction [fSauveTexte](../WDLang1/3036046.md). Par exemple :
	
	```wl
	fSauveTexte("MonFichier.gif", GglRécupèreCarte(40.714728, 73.998672, 14, 400, 400))
	```




<a name="NOTE0_2"></a>


### Clé pour Google Static Map
<a name="cle_pour_google_static_map_ELTPARAGRAPHE000262"></a>

Pour obtenir la clé nécessaire à l'utilisation du service Google de cartographie Google Maps, utilisez l'adresse suivante : 

[http://code.google.com/apis/maps/signup.html](http://code.google.com/apis/maps/signup.html). 

Attention : l'adresse de cette page peut être modifiée depuis la date de rédaction de cette page.**A partir du 11 Juin 2018, les conditions d'utilisation des services de cartographie de Google ont évolué**. La clé Google pour utiliser ce service est désormais nécessaire et payante. 
<a name="NOTE0_3"></a>


### Cas d'erreurs possibles
<a name="cas_erreurs_possibles_ELTPARAGRAPHE000281"></a>Il est possible que le service de cartographie Google Maps ne puisse renvoyer une image valide selon la localisation ou le zoom demandé.

Si les limitations définies par le service Google Maps sont dépassées (par exemple taille de l'image trop importante, nombre de points d'un chemin trop important, ...), aucune donnée n'est renvoyée. Une erreur de type "HttpBadRequest" est renvoyée.

Pour plus de détails sur les limites possibles, consultez la documentation des variables de type [gglParamètreCarte](../WDLang5/1000017505.md).




- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LafonctiongglRecupereCarte.gif) ***Exemples unitaires (WINDEV)*** : **La fonction gglRécupèreCarte** <br>Utilisation de la fonction gglRécupèreCarte pour afficher une carte Google dans un champ Image.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LafonctiongglRecupereCarte.gif) ***Exemples unitaires (WEBDEV)*** : **La fonction gglRécupèreCarte** <br>Utilisation de la fonction gglRécupèreCarte pour afficher une carte Google dans un champ Image.



<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280ggl.dll
