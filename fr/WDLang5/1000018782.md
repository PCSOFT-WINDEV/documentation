


## xmlDocument (Type de variable)

***En anglais : xmlDocument (Type of variable)***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **xmlDocument** permet de manipuler simplement un fichier XML. Les caractéristiques de ce fichier peuvent être définies et modifiées à l'aide de différentes propriétés WLangage.

**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).


<a name="XExemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Exemple utilisant le fichier XML suivant : piece_theatre.xml
// <?xml version="1.0"?>
// <PLAY>
// 	<TITLE>Titre de la piece</TITLE>
// 	
// 	<PERSONAE>
// 		<PERSONA>Un personnage</PERSONA>
// 	</PERSONAE>
// 	
// 	<ACT>
// 		<SCENE>
// 			<SPEAKER></SPEAKER>
// 			<LINE></LINE>
// 		</SCENE>
// 	</ACT>
// </PLAY>

// Déclaration d'une variable xmlDocument utilisant un modèle de document
RomeoEtJuliette est un xmlDocument, description = "piece_theatre.xml"

// Chargement d'un document XML depuis un fichier
RomeoEtJuliette = XMLOuvre("romeo_et_juliette.xml", depuisFichier)

// Affichage du numéro de version du XML
Trace(RomeoEtJuliette..Version)

// Affichage du titre de la pièce en accédant directement aux noeuds
Trace(RomeoEtJuliette.PLAY.TITLE)
```


## Remarques
<a name="NOTE0_1"></a>


### Déclaration d'une variable de type xmlDocument
<a name="declaration_une_variable_type_xmldocument_ELTPARAGRAPHE000050"></a>Les variables de type **xmlDocument** peuvent être déclarées en indiquant un document exemple (un fichier XML) ou un document modèle (un fichier XSD). La structure de ce document sera lue par WINDEV, WEBDEV et WINDEV Mobile. Il sera ainsi possible de disposer de la complétion automatique sur les noms des noeuds directement dans l'éditeur de code.

Pour déclarer une variable de type xmlDocument avec un document exemple :

1. Ajoutez le document XML dans le projet grâce à une des méthodes suivantes : 

	- sous le volet "Projet", dans le groupe "Projet", déroulez "![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_listeprojet.gif) Liste des éléments" et cliquez sur "Liste des éléments du projet". La liste des éléments du projet s'affiche. Cliquez sur le bouton "Ajouter" et sélectionnez le document XML.

	- réalisez un "Drag and Drop" du fichier vers le dossier "Descriptions externes" du volet "Explorateur de projet".

	- dans le volet "Explorateur de projet", sélectionnez le dossier "Descriptions externes", puis sélectionnez : 

		- soit l'option "Importer un XML ou un JSON dans ce projet" du menu contextuel.

		- soit l'option "Importer un XSD dans ce projet" du menu contextuel.




2. Le document XML apparaît sous le dossier "Descriptions externes" de l'explorateur de projet. Il est possible de visualiser sa structure.

3. Déclarez la variable de la façon suivante :
	
	```txt
	<Nom de la variable> est un xmlDocument , description =  <Nom du document>
	```

	&lt;Nom du document&gt; peut correspondre au nom du document exemple (avec ou sans son extension) ou au nom du document modèle (avec ou sans son extension). 
	**Remarques** : 

	- Cette déclaration peut être obtenue automatiquement en "droppant" le nom du document XML directement depuis le volet "Explorateur de projet". 

	- Dans le cas de l'utilisation d'un document exemple, il est également possible d'utiliser la syntaxe suivante : 
			
		```txt
		<Nom de la variable> est un xmlDocument
		<Nom de la variable> = XMLOuvre(<Nom du document>)
		```





4. Vous pouvez maintenant accéder directement aux noeuds de la variable par leurs noms. Ces noms sont proposés automatiquement par le mécanisme de complétion automatique de l'éditeur de code.




Remarque : La fonction [XMLSauve](../WDLang5/1000019026.md) permet de sauvegarder le document XML. Si un fichier XSD a été utilisé, il sera automatiquement pris en compte. 
<a name="NOTE0_2"></a>


### Propriétés spécifiques à la description des variables de type xmlDocument
<a name="proprietes_specifiques_description_des_variables_type_xmldocument_ELTPARAGRAPHE000099"></a>Les propriétés suivantes peuvent être utilisées pour manipuler une variable de type **xmlDocument** :

| Nom | Type manipulé | Effet |
| --- | --- | --- |
| Encodage | Chaîne de caractères | Encodage utilisé pour les chaînes de caractères du document XML. Si cette propriété n'est pas spécifiée ou vaut "" (chaîne vide), l'encodage UTF-8 est utilisé. C'est notamment le cas par exemple lors d'une conversion en chaîne avec la fonction [XMLConstruitChaîne](../WDLang5/3081016.md). |
| NoeudRacine | Tableau de [xmlNoeud](../WDLang5/1000018786.md) | Tableau des noeuds racines du document XML.<br>Un document XML valide doit avoir un noeud racine unique. Toutefois, il est possible pendant la construction du document d'avoir plusieurs noeuds à la racine. |
| Version | Chaîne de caractères | Version du format XML. Cette propriété vaut généralement "1.0". |




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Attention : L'ordre d'itération n'est pas nécessairement l'ordre de déclaration des attributs dans le document (généralement les attributs sont listés dans l'ordre alphabétique). 
<a name="NOTE0_3"></a>


### Utiliser l'indirection sur les chemins dans un document XML
<a name="utiliser_indirection_sur_les_chemins_dans_document_xml_ELTPARAGRAPHE000144"></a>Il est possible d'utiliser les opérateurs d'indirection pour construire le chemin d'un élément dans un document XML. 

Exemple : 

```wl
sDocXML est une chaîne = [
	<?xml version="1.0" encoding="UTF-8"?>
	<Document>
	<InfoVersion>
	<Version>21</Version>
	<Millesime>2016</Millesime>
	</InfoVersion>
	</Document>
]

xmlExemple est un xmlDocument = XMLOuvre(sDocXML, depuisChaîne)

sParam est une chaîne = "WinDev_Param"

// Lecture directe d'une information ...
Trace(xmlExemple.Document.InfoVersion.Version) 

// Lecture avec une partie du chemin XML contenu dans une variable
// (idem si rubrique d'un fichier, paramètre d'une fenêtre, méthode, ...)
sParamètre est une chaîne = "InfoVersion"
Trace ({"xmlExemple.Document." + sParamètre + ".Version"})
```

<a name="NOTE0_4"></a>


### Fonctions utilisant les variables de type xmlDocument
<a name="fonctions_utilisant_les_variables_type_xmldocument_ELTPARAGRAPHE000156"></a>


|   |   |
| --- | --- |
| [XMLConstruitChaîne](../WDLang5/3081016.md) | Récupère et met en forme le contenu d'un document XML (créé avec la fonction [XMLDocument](../WDLang5/3081008.md) et modifié grâce aux fonctions XML). |
| [XMLDocumentValide](../WDLang5/1000019272.md) | Valide un document XML à partir d'un schéma XSD. |
| [XMLOuvre](../WDLang5/1000018792.md) | Charge un document XML à partir d'un fichier, d'une URL ou d'une chaîne dans une variable de type [xmlDocument](../WDLang5/1000018782.md). |
| [XMLSauve](../WDLang5/1000019026.md) | Sauvegarde un document XML dans un fichier. |





Note : Le parcours d'une variable **XMLDocument** doit être effectué en utilisant la syntaxe POUR TOUT. La fonction [XMLLit](../WDLang5/1000017030.md) ne doit pas être utilisée.


