


## &lt;Variable gglConnexion&gt;.RemplitAgenda (Fonction)

***En anglais : &lt;gglConnection variable&gt;.FillCalendar***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Remplit un agenda précédemment récupéré : les événements correspondant à l'agenda sont récupérés (éventuellement en utilisant certains critères). Cette fonction doit être utilisée après l'appel de la fonction [&lt;Variable gglConnexion&gt;.ListeAgenda](../WDLang5/1000017747.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Connexion
Cnx est un gglConnexion
...
SI Cnx.Connecte() = Faux ALORS
	Erreur(ErreurInfo())
	RETOUR
FIN
tabAgendas est un tableau de 0 gglAgenda 
tabAgendas = Cnx.ListeAgenda() 
// Premier agenda
Agenda est un gglAgenda = tabAgendas[1]
// Exemple de différents appels possibles de GglRemplitAgenda
// Récupère tous les événements futurs :
Cnx.RemplitAgenda(Agenda)
// Récupère tous les événements futurs contenant les mots "PC Soft"
Cnx.RemplitAgenda(Agenda, "", "", "PC Soft")
// Récupère tous les événements futurs ne contenant pas le mot "travail"
Cnx.RemplitAgenda(Agenda, "", "", "-travail")
// Récupère tous les événements futurs 
Cnx.RemplitAgenda(Agenda, HeureSys())
// Récupère tous les événements passés
Cnx.RemplitAgenda(Agenda, "", HeureSys())
// Récupère les événements entre le 01/01/2008 et le 01/01/2009 inclus
Cnx.RemplitAgenda(Agenda, "20080101", "20090102")
// Autre possibilité :
Cnx.RemplitAgenda(Agenda, "20080101", "20090101235959")
// Récupère les événements entre le 01/11/2008 et le 01/12/2008 exclu
Cnx.RemplitAgenda(Agenda, "20081101", "20081201")
// Parcours des événements d'un agenda
Evt est un gglEvénement
POUR TOUT Evt DE Agenda 
	Trace(Evt.Titre)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Connexion Google>.RemplitAgenda(<Agenda> [, <Début des événements> [, <Fin des événements> [, <Chaîne à rechercher>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si les événements ont été récupérés, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Connexion Google> : (Variable de type gglConnexion)`**

Nom de la variable de type [gglConnexion](../WDLang5/1000018009.md) à utiliser. Cette connexion a été validée avec la fonction [&lt;Variable gglConnexion&gt;.Connecte](../WDLang5/1000021455.md).

**`<Agenda> : (Variable de type gglAgenda)`**

Nom de la variable de type [gglAgenda](../WDLang5/1000017418.md) à remplir.

**`<Début des événements> : (DateHeure optionnelle)`**

Date et heure de début des événements à récupérer. 
Si &lt;Début des événements&gt; et &lt;Fin des événements&gt; ne sont pas renseignés, seuls les événements futurs sont récupérés (événements à partir de la date du jour). 
Si seul &lt;Début des événements&gt; est renseigné, tous les événements postérieurs à cette date sont récupérés (la date limite par défaut définie par Google est le 01/01/2031).

**`<Fin des événements> : (DateHeure optionnelle)`**

Date et heure de fin des événements à récupérer. 
Si &lt;Début des événements&gt; et &lt;Fin des événements&gt; ne sont pas renseignés, seuls les événements futurs sont récupérés (événements à partir de la date du jour). 
Si seul &lt;Fin des événements&gt; est renseigné (dans ce cas &lt;Début des événements&gt; vaut chaîne vide), tous les événements antérieurs à cette date sont récupérés (la date limite par défaut définie par Google est le 01/01/1970).

**`<Chaîne à rechercher> : (Chaîne de caractères optionnelle)`**

Texte à rechercher dans les événements de l'agenda. 

Si ce paramètre est spécifié, seuls les événements contenant le texte indiqué seront listés. La recherche est effectuée sur le nom et la description de l'agenda. Cette recherche n'est pas sensible à la casse. 

Par défaut, ce paramètre correspond à une chaîne vide ("").



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Gestion des dates et des heures
<a name="gestion_des_dates_des_heures_ELTPARAGRAPHE000225"></a>

- Les dates sont automatiquement converties au format UTC.

- Si seule la date est indiquée (sans préciser les heures, minutes et secondes) :

	- dans le paramètre &lt;Début des événements&gt;, tous les événements à partir de la date indiquée à 0 heure 0 minute 0 seconde seront pris en compte.

	- dans le paramètre &lt;Fin des événements&gt;, tous les événements jusqu'à la date indiquée à 0 heure 0 minute 0 seconde seront pris en compte (les événements de la journée ne seront donc pas pris en compte).




- Pensez à paramétrer correctement le fuseau horaire et l'heure du poste qui effectue la recherche.



<a name="NOTE0_2"></a>


### Cas d'erreurs possibles : 
<a name="cas_erreurs_possibles_ELTPARAGRAPHE000240"></a>

- La connexion Internet n'est pas valide.

- L'authentification n'a pas pu être réalisée correctement.

- La réponse XML du serveur n'est pas lisible.

- L'agenda n'a pas pu être trouvé.




<a name="XComposante"></a>

## Composante :
wd280ggl.dll
