
## JSONXMLConvertisseur (Type de variable)

***En anglais : JSONXMLConverter***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **JSONXMLConvertisseur** permet de définir toutes les caractéristiques avancées de la conversion d'un objet XML ou JSON (ou inversement) réalisée via les fonctions [XMLVersJSON](../WDLang5/1410087331.md) et [JSONVersXML](../WDLang5/1410087330.md)). Les caractéristiques de cette conversion peuvent être définies et modifiées à l'aide de différentes propriétés WLangage. 

**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
soit json = ChaîneVersJSON("
{ "nom" : "TestName"
  ,"id" : 2
  ,"vrai" : true
  ,"liste" : [5,5,6,2,47]
}
")

soit convertisseur est un JSONXMLConvertisseur
convertisseur.ConversionTableauAvecRacine = Faux
convertisseur.ConversionComplète = Vrai
soit xml = JSONVersXML(json, convertisseur)
Trace(xml..SourceXML)

// Le résultat affiché sera 
// <document>
//   <nom>TestName</nom>
//   <id>2</id>
//   <vrai>true</vrai>
//   <liste>5</liste>
//   <liste>5</liste>
//   <liste>6</liste>
//   <liste>2</liste>
//   <liste>47</liste>
// </document>

Trace(XMLVersJSON(xml, convertisseur))

// le résultat affiché sera: 
// { "nom":"TestName", "id":2, "vrai":true, "liste":[ 5, 5, 6, 2, 47 ] }
```





<a name="NOTE0"></a>

## Remarques
<a name="NOTE0_1"></a>


### Propriétés spécifiques à la description des variables de type JSONXMLConvertisseur
<a name="proprietes_specifiques_description_des_variables_type_jsonxmlconvertisseur_ELTPARAGRAPHE000035"></a>Les propriétés suivantes peuvent être utilisées pour manipuler un convertisseur :

| Nom de la propriété | Type manipulé | Effet |
| --- | --- | --- |
| ConversionComplète  | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> (valeur par défaut) si la conversion doit prendre en compte les attributs et les namespace, <br><br>- <u><u><u><u>Faux</u></u></u></u> pour effectuer une conversion simple (sans prendre en compte les attributs et les namespace). <br><br><br> |
| ConversionTableauAvecRacine  | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> (valeur par défaut) pour convertir les tableaux JSON en tableaux XML en utilisant le nom de l'élément JSON comme nom de racine, <br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. <br><br><br> |
| NomElément  | Chaîne de caractères | Nom des éléments pour les tableaux avec racine. |
| NomRacineXML  | Chaîne de caractères | Nom de la racine XML. Par défaut, cette propriété correspond à "root". |
| PréfixeAttribut  | Chaîne de caractères | Préfixe des attributs XML en JSON. Par défaut, cette propriété correspond à "@". |
| PréfixeCDATA  | Chaîne de caractères | Clé des sections d'échappements XML. Par défaut, cette propriété correspond à "CDATA". |
| PréfixeNamespaceDéclaré  | Chaîne de caractères | Préfixe pour les namespaces déclarés. Par défaut, cette propriété correspond à "%". |
| PréfixeNamespaceNoeud  | Chaîne de caractères | Préfixe pour le namespace du noeud. Par défaut, cette propriété correspond à "$". |
| PréfixeTexte  | Chaîne de caractères | Préfixe des textes des noeuds texte XML en JSON. Par défaut, cette propriété correspond à "#texte". <br> |
| ReprésentationBaliseVide  | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> (valeur par défaut) si la balise vide est représentée par NULL, <br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. <br><br><br> |
| TypageJSON  | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> (valeur par défaut) si les types sont déduits lors de la conversion vers JSON, <br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. <br><br><br> |













<a name="NOTE1"></a>

## Remarques
<a name="NOTE1_1"></a>


### Norme de conversion JSON vers XML et XML vers JSON
<a name="norme_conversion_json_vers_xml_xml_vers_json_ELTPARAGRAPHE000150"></a>Il n'existe pas de normes précises de conversion dans un sens ou dans l'autre. Cependant, afin de définir au mieux les opérations de conversion, deux méthodes sont disponibles :

- Imposer une norme lors de la conversion (en utilisant les valeurs par défaut de la variable **JSONXMLConvertisseur**).

- Utiliser une norme de conversion personnalisée en utilisant une variable de type **JSONXMLConvertisseur** afin de décrire les règles de conversion.



<a name="NOTE1_2"></a>


### Norme de conversion par défaut
<a name="norme_conversion_par_defaut_ELTPARAGRAPHE000166"></a>

<u><u><u><u>Conversion XML Vers JSON</u></u></u></u>

- Balise XML : "" + nom de la balise suivi d'un objet JSON.

- Balise vide : valeur null JSON.

- Attribut XML : "@" + nom de l'attribut en membre JSON de l'objet représentant la balise.

- Nœud texte : simple paire clé / valeur s'il n'y a pas d'attributs, "#texte" si le nœud est un objet JSON.

- Sections d'échappement : "CDATA" avec la chaîne en valeur JSON.




<u><u><u><u>Conversion JSON Vers XML</u></u></u></u>

- Objet vide : balise vide si l'objet est nommé.

- Liste vide : balise vide si le tableau est nommé.

- Valeur : noeud texte.



<a name="NOTE1_3"></a>


### Cas particuliers de conversion
<a name="cas_particuliers_conversion_ELTPARAGRAPHE000189"></a>La conversion JSON - XML n'est pas une conversion triviale et sans perte puisque les deux langages présentent des syntaxes et des données différentes. Toute conversion de l'un vers l'autre devra forcément faire des concessions pour permettre de retrouver les données en limitant les pertes depuis le document d'origine.

Voici une liste des différents points de conflit et ambiguïtés qui peuvent se produire durant une conversion, ainsi que des propositions de résolution permettant une translation inverse si possible sans compromettre les données des objets.

<u><u><u><u>Conversion XML Vers JSON</u></u></u></u>

- **Attribut XML** : La syntaxe JSON ne possède pas d'attributs pour les couples clés-valeurs. Pour conserver la notion d'attributs, une solution est de préfixer ceux-ci dans le contenu JSON et de les placer en tant que membres de l'objet.

- **Namespace** : La syntaxe JSON ne possède pas de namespace pour les clés. Une solution simple est de les considérer en tant que noms et attributs classiques.

- **Balise vide** : La syntaxe JSON n'offre pas la possibilité d'avoir des clés sans aucune valeur. Deux possibilités sont disponibles : les représenter par la valeur null ou par un objet vide (dans le cas d'une balise vide avec attributs, la seule représentation possible est l'objet pseudo-vide, ne contenant que les attributs de la balise).

- **Noeud texte** : Les noeuds texte sont représentables sous formes de couple clé-valeur mais la présence des attributs peut amener à la création d'un objet en tant que valeur de la clé représentant le noeud. Afin de garder une référence sur la valeur textuelle du noeud, une solution est de créer un couple interne contenant le texte du noeud.

- **Liste de noeuds** : Les listes XML sont transposables en JSON facilement mais puisqu'il n'est pas possible de dupliquer des clés JSON, il risque d'y avoir une perte de l'ordonnancement des noeuds fils dans certains cas.

- **Sections d'échappement** : Le JSON ne possède pas la notion de sections d'échappement mais il est possible de les stocker sous forme de champs spéciaux dans le contenu JSON cible, à la manière des noeuds texte.

- **Commentaires** : Le JSON n'a pas la notion de commentaires. La solution est de ne simplement pas les copier dans le contenu JSON cible puisqu'ils sont optionnels.




<u><u><u><u>Conversion JSON Vers XML</u></u></u></u>

- **Type des valeurs** : Les documents XML ne possèdent pas de notions de type. Il faut considérer qu'ils seront perdus, ou alors leurs types d'origine doivent être stockés dans le XML généré.

- **Liste vide** : Le XML n'a techniquement pas de listes vides. Les considérer comme des balises vides présente un risque de conflit avec les objets vides et / ou null.

- **Objet vide / null** : La balise vide XML permet de représenter ces notions JSON mais pour permettre la conversion inverse, il est nécessaire de choisir une des deux représentations.





<a name="NOTE1_4"></a>


### Fonctions WLangage manipulant le type JSONXMLConvertisseur
<a name="fonctions_wlangage_manipulant_type_docparampagetitleshort_ELTPARAGRAPHE000219"></a>


|   |   |
| --- | --- |
| [JSONVersXML](../WDLang5/1410087330.md) | Convertit une chaîne de caractères au format JSON en une chaîne de caractères au format XML. |
| [XMLVersJSON](../WDLang5/1410087331.md) | Convertit une chaîne de caractères au format XML en une chaîne de caractères au format JSON. |












