
## Imprimer des codes-barres
			

<a name="NOTE1"></a>
<a name="NOTE2_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000280"></a>
WINDEV, WEBDEV et WINDEV Mobile permettent d'imprimer des codes-barres. Il est possible d'utiliser :

- soit un champ de type "Code-barres" dans un état.

- soit la fonction [iImprimeCodeBarre](../WDLang5/3046020.md) dans une impression réalisée en WLangage.








<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Imprimer un code-barres depuis un état
<a name="imprimer_codebarres_depuis_etat_ELTTEXTE000304"></a>
L'éditeur d'états propose un champ de type "Code-barres". Le champ Code-barres peut être directement lié à une rubrique de la source de données de l'état.

Le paramétrage d'un champ "Code-barres" s'effectue dans sa fenêtre de description (option "Description" du menu contextuel).

Selon le type de code-barres sélectionné, il est possible de gérer différentes caractéristiques du code-barres :

- code-barres avec vérification : le dernier caractère du code-barres correspond à un caractère de vérification.

- code-barres étendu : la valeur du code-barres peut contenir les 128 caractères du code ASCII.

- affichage ou non de la valeur du code-barres.

- gestion du formatage.

- gestion des caractères de contrôle et du jeu de caractères utilisé.




**Quel que soit le type de code-barres**, il est également possible de :

- paramétrer la taille du code-barres.

- paramétrer les caractéristiques du cadre.

- gérer l'orientation du code-barres.




Pour imprimer le code-barres, il suffit d'affecter le champ Code-barres avec la valeur du code-barres. 


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Cas particulier : Code-barres de type QR Code : les types proposés par défaut**
Dans un état, il est possible d'imprimer un code-barres de type QR Code. Ce QR Code sera ensuite décodé par une application qui selon le type du QR Code pourra proposer une action spécifique. 

Le mode d'affectation du champ Code-barres varie selon son type. 

Par défaut, la fenêtre de description du champ sous l'éditeur d'états propose 4 types simples : 

- un **QR Code de type Texte** : Ce type de QR Code permet d'associer un texte au code-barres. Pour initialiser ce type de QR Code, il suffit de lui affecter une chaîne de caractères. Par exemple : 
	
	```wl
	CBA_QRCode = "je suis un simple texte"
	```


- un **QR Code de type Lien Web** : Ce type de QR Code permet d'ouvrir par exemple directement un site. Pour initialiser ce type de QR Code, il suffit de lui affecter une adresse de site. Par exemple : 
	
	```wl
	CBA_QRCode = "http://www.pcsoft.fr"
	```


- un **QR Code de type Numéro de téléphone** : Ce type de QR Code permet par exemple d'appeler directement un numéro de téléphone. Pour initialiser ce type de QR Code, il suffit de lui affecter un numéro de téléphone. Par exemple : 
	
	```wl
	CBA_QRCode = "010203040506"
	```


- un **QR Code de type Adresse Email** : Ce type de QR Code permet par exemple d'obtenir l'adresse email d'un contact. Pour initialiser ce type de QR Code, il suffit de lui affecter une adresse email. Par exemple : 
	
	```wl
	CBA_QRCode = "doc@pcsoft.fr"
	```




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Cas particulier : Code-barres de type QR Code : les types spécifiques**
Il est également possible d'imprimer des codes-barres QR Code spécifiques (SMS, contact, position géographique, ...). Dans ce cas, l'affectation du champ Code-barres doit être effectuée à l'aide du type [CodeBarres](../WDLang5/1000019451.md). 

Il est nécessaire de : 

1. Définir une variable de type [CodeBarres](../WDLang5/1000019451.md) : 
	
	```wl
	MonCodeBarres est un CodeBarres
	```


2. Dans la variable de type [CodeBarres](../WDLang5/1000019451.md), spécifier le type du contenu du code-barres QR Code (par exemple, pour un code-barres de type SMS) : 
	
	```wl
	MonCodeBarres.TypeCodeBarres = CB_QRCode
	MonCodeBarres.TypeContenu = cbTypeSMS
	```


3. Selon le type du code-barres, remplir l'élément correspondant (voir tableau ci-dessous) : 
	

| Type de contenu | Type de la valeur (Propriété Contenu) | Remarque |
| --- | --- | --- |
| *cbTypeTexte* | Chaîne de caractères | Exemple : "WINDEV c'est bien !" |
| *cbTypeTéléphone* | Chaîne de caractères | Exemple : "0612345678" |
| *cbTypeSMS* | Chaîne de caractères de la forme : <br>&lt;Numéro&gt; + RC + &lt;Message&gt;<br><br><br>S'ils sont renseignés, les membres de la [structure SMS](../WDLang3/3068003.md) (SMS.Message et SMS.Numéro) seront automatiquement pris en compte. | Exemple : "0612345678&lt;RC&gt;Texte à envoyer" |
| *cbTypeURL* | Chaîne de caractères | Exemple : "http://www.google.fr" |
| *cbTypeEmail* | Chaîne de caractères | Exemple : "nom@mail.com" |
| *cbTypeContact* | Vide. Les membres de la [structure mContact](../WDLang3/1000006111.md) seront automatiquement pris en compte. |   |
| *cbTypePosition* | Variable de type [géoPosition](../WDLang3/1000019191.md).<br><br>Les propriétés **Latitude** et **Longitude** de la variable seront automatiquement prises en compte. |   |








<a name="NOTE3_3"></a>


## Imprimer un code-barres en WLangage
<a name="imprimer_codebarres_wlangage_ELTTEXTE000340"></a>
Pour imprimer un code-barres en WLangage, il est nécessaire d'utiliser la fonction [iImprimeCodeBarre](../WDLang5/3046020.md). 
La fonction [iImprimeCodeBarre](../WDLang5/3046020.md) propose deux syntaxes : 

- syntaxe permettant d'imprimer directement un code-barres (cette syntaxe ne gère pas les codes-barres de type QR Code) :
	
	```txt
	iImprimeCodeBarre(<Valeur>, <Type>, <Coordonnées du rectangle>, <Caractéristiques>)
	```

	Les paramètres sont les suivants :

	- la valeur du code-barres. Cette valeur pourra être imprimée sous le code-barres.

	- le type de code-barres à imprimer.

	- les coordonnées (en pixels) du rectangle dans lequel le code-barres va être imprimé. 

	- les caractéristiques du code-barres (si nécessaire).







- syntaxe permettant d'imprimer un code-barres présent dans une variable de type [CodeBarres](../WDLang5/1000019451.md) (cette syntaxe gère les codes-barres de type QR Code) :
	
	```txt
	iImprimeCodeBarre(<Variable CodeBarres>, <Coordonnées du rectangle>)
	```

	Tous les paramètres du code-barres à imprimer sont spécifiés dans la variable de type [CodeBarres](../WDLang5/1000019451.md). 




Quelque soit la syntaxe utilisée : 

- Le code-barres est imprimé dans un rectangle invisible. Il permet simplement de spécifier la position et la taille du code-barres à imprimer.

- Pour les codes-barres de type "EAN" et "UPC", la hauteur du code-barres est proportionnelle à sa largeur. Pour augmenter la taille de ces codes-barres, il est donc nécessaire d'augmenter à la fois la hauteur et la largeur.

- La fonction [iFinImprime](../WDLang5/3046053.md) doit être utilisée pour lancer l'impression effective. Cette fonction doit être la dernière fonction d'impression utilisée.




L'exemple suivant présente le code de clic d'un bouton permettant d'imprimer un code-barres de type EAN 13. La valeur du code-barres est récupérée dans le champ de saisie "SAI_saisieCB".


```wl
iImprimeMot("Code-barres de type EAN 13 :") 
iImprimeCodeBarre(SAI_SaisieCB, CB_EAN13, 10, 10, 50, 100) 
iFinImprime()
```


L'exemple suivant permet d'imprimer un code-barres de type QR Code : 


```wl
MonQRCode est un CodeBarres
MonQRCode.Contenu = "http://www.pcsoft.fr"
MonQRCode.TypeContenu = cbTypeTexte
MonQRCode.TypeCodeBarres = CB_QRCODE
iImprimeCodeBarre(MonQRCode, 10, 20, 50, 60)
iFinImprime()
```









- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampCode-barres.gif) ***Exemples unitaires (WINDEV)*** : **Le champ Code-barres** <br>Utilisation d'un champ Code-barres
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDEtats.gif) ***Exemples didactiques (WINDEV)*** : **WD Etats** <br>Cet exemple montre les différentes méthodes pour réaliser un état :<br> <br>- impressions basées sur différentes sources de données (requêtes, variables, ...)<br>- impressions basées sur des champs (Table, Tableur, TCD, ...)<br>- impression d'états composés<br>- impressions spécifiques (portrait / paysage, état avec filigrane, état avec code-barres, ...)




