
## iParamètreAperçu (Fonction)

***En anglais : iParameterPreview***

<DIV class="specObsolete">
	<IMG style="float:left;margin-right:10px;" src="https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=warning_big.png"><B>Avertissement</B><BR>
	A partir de la version <B>25</B>,  l'aperçu avant impression a été renommé en "Visualisateur de rapports". Il est désormais conseillé d'utiliser la fonction [iParamètreVisualisateur](../WDLang5/1000024634.md). 
</DIV><a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Paramètre l'aperçu avant impression :

- l'affichage d'un message concernant les ressources du poste en cours.

- l'affichage ou non des volets (et des boutons présents) du ruban. Pour plus de détails, consultez [Aperçu avant impression](../WDChamp/1011085.md).<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Apercu_Volet_Apercu.gif)


- les paramètres d'export présents dans la [mini-fenêtre d'aperçu](../WDChamp/1011094.md).




**Remarques** :

- Lors de l'impression d'un état programmé, tous les boutons d'impression sont disponibles dans l'aperçu avant impression.

- Par défaut, tous les boutons d'impression d'un état créé avec l'éditeur d'états sont disponibles. La fonction **iParamètreAperçu** permet uniquement de paramétrer les boutons définis comme visibles dans l'éditeur d'états. 

- Si l'application autorise le lancement du logiciel "Etats & Requêtes" livré avec WINDEV, 2 boutons supplémentaires peuvent apparaître dans l'aperçu avant impression. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=icone_Apercu_EtatRequete.gif)
Ces boutons permettent respectivement de modifier l'état en cours et de créer un nouvel état avec le logiciel "Etats & Requêtes". Ces boutons sont affichés uniquement :

	- Si le projet autorise le lancement du logiciel "Etats et requêtes" (onglet "Avancé" de la description du projet).

	- Si l'état peut être modifié avec le logiciel "Etats & Requêtes" (onglet "Détail" de la description de l'état).






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Aucun bouton dans l'aperçu avant impression
iParamètreAperçu(iBoutonAucun)
iAperçu()
iImprimeEtat(ETAT_MonEtat)
```


<a name="Exemple2"></a>



```wl
// Affichage uniquement des boutons imprimantes
iParamètreAperçu(iBoutonImprimante)
iAperçu()
iImprimeEtat(ETAT_MonEtat)
```


<a name="Exemple3"></a>



```wl
// Affichage des boutons Imprimante, PDF et WORD dans l'aperçu avant impression
iParamètreAperçu(iBoutonImprimante + iBoutonPdf + iBoutonWord)
iAperçu()
iImprimeEtat(ETAT_MonEtat)
```


<a name="Exemple4"></a>



```wl
// Suppression des boutons Email de l'aperçu avant impression 
iParamètreAperçu(iBoutonTous  - iBoutonEmail - iBoutonEmailPdf)
iAperçu()
iImprimeEtat(ETAT_MonEtat)
```


<a name="Exemple5"></a>



```wl
// Affichage du message d'avertissement toutes les 2000 pages
iParamètreAperçu(iBoutonTous, 2000)
// Impression d'un état dans l'aperçu avant impression
iImprimeEtat(ETAT_MonEtat)
```


<a name="Exemple6"></a>



```wl
// Affichage du volet des miniatures dans l'aperçu avant impression
iParamètreAperçu(iVoletMiniatures, Vrai)
// Impression d'un état dans l'aperçu avant impression
iImprimeEtat(ETAT_MonEtat)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Afficher ou non les différentes options dans la barre d'outils de l'aperçu avant impression

`iParamètreAperçu(<Options> [, <Avertissement>])`
---

**`<Options> : (Constante ou combinaison de constante de type Entier)`**

Boutons à afficher dans l'aperçu avant impression :


|   |   |
| --- | --- |
| *iBoutonAnnotation* | <br><br>- Jusqu'à la version 19 : La barre d'outils permettant de réaliser des annotations dans l'état est visible.<br><br>- A partir de la version 20 : Le bouton "Annotations" est disponible dans le volet "Aperçu". Le volet "Annoter" permettant de réaliser des annotations dans l'état est visible. Pour plus de détails sur ce volet, consultez [Volet "Annoter"](../WDChamp/1011086.md).<br><br><br><br><br>Cette constante n'est pas prise en compte dans le mini-aperçu. |
| *iBoutonAucun* | <br><br>- Jusqu'à la version 19 : Aucun bouton ou barre d'outils n'est affiché.<br><br>- A partir de la version 20 : Seul le volet "Aperçu" de l'aperçu avant impression est affiché. Pour plus de détails sur ce volet, consultez [Volet "Aperçu"](../WDChamp/1011089.md). <br><br><br> |
| *iBoutonCréationEtat* | <br><br>- Jusqu'à la version 19 : Le bouton permettant de créer un état avec le logiciel "Etats et requêtes" est visible.<br><br><br> |
| *iBoutonDuplicata* | <br><br>- Jusqu'à la version 19 : Le bouton permettant d'enregistrer un duplicata de l'état en cours est visible.<br><br>- A partir de la version 20 : Le volet "Exporter" est visible. Le bouton permettant d'enregistrer un duplicata de l'état en cours est affiché dans le volet "Exporter". Pour plus de détails sur ce volet, consultez [Volet "Exporter"](../WDChamp/1011088.md).<br><br><br><br><br>Cette constante n'est pas prise en compte dans le mini-aperçu. |
| *iBoutonEmail* | <br><br>- Jusqu'à la version 19 : Le bouton permettant d'imprimer l'état dans un nouvel email est visible.<br><br>- A partir de la version 20 : Le volet "Exporter" est visible. Le bouton permettant de créer un email avec le contenu de l'état intégré est affiché dans le volet "Exporter". Pour plus de détails sur ce volet, consultez [Volet "Exporter"](../WDChamp/1011088.md).<br><br><br> |
| *iBoutonEmailPdf* | <br><br>- Jusqu'à la version 19 : Le bouton permettant d'imprimer l'état dans un fichier lié à un nouvel email est visible.<br><br>- A partir de la version 20 : Le volet "Exporter" est visible. Le bouton permettant de créer un email avec un PDF attaché est affiché dans le volet "Exporter". Pour plus de détails sur ce volet, consultez [Volet "Exporter"](../WDChamp/1011088.md).<br><br><br> |
| *iBoutonExcel* | <br><br>- Jusqu'à la version 19 : Le bouton permettant d'imprimer l'état dans un fichier Excel est visible.<br><br>- A partir de la version 20 : Le volet "Exporter" est visible. Le bouton permettant de créer un fichier Excel à partir de l'impression en cours est affiché dans le volet "Exporter". Pour plus de détails sur ce volet, consultez [Volet "Exporter"](../WDChamp/1011088.md).<br><br><br> |
| *iBoutonFiligrane* | Le bouton permettant d'ajouter et de paramétrer un texte en filigrane est visible.<br><br>Cette constante n'est pas prise en compte dans le mini-aperçu. |
| *iBoutonHtml* | Le bouton permettant d'imprimer l'état dans un fichier HTML est visible. |
| *iBoutonImprimante* | Les deux boutons permettant de lancer l'impression sont visibles.<br><br>Cette constante n'est pas prise en compte dans le mini-aperçu. |
| *iBoutonInstantané* | Le bouton permettant de prendre une image instantanée de l'état (ou d'une portion de l'état) est visible.<br><br>Cette constante n'est pas prise en compte dans le mini-aperçu. |
| *iBoutonModificationEtat* | Le bouton permettant de modifier l'état en cours avec le logiciel "Etats et requêtes" est visible.<br><br>Cette constante n'est pas prise en compte dans le mini-aperçu. |
| *iBoutonNoirEtBlanc* | Le bouton permettant d'imprimer le document en noir et blanc est visible.<br><br>Cette constante n'est pas prise en compte dans le mini-aperçu. |
| *iBoutonPdf* | Le bouton permettant d'imprimer l'état dans un fichier PDF est visible. |
| *iBoutonRecherche* | La barre d'outils permettant de réaliser une recherche dans l'état est visible.<br><br>Cette constante n'est pas prise en compte dans le mini-aperçu. |
| *iBoutonRectoVerso* | Le bouton permettant d'imprimer le document en recto-verso est visible.<br><br>Cette constante n'est pas prise en compte dans le mini-aperçu. |
| *iBoutonSélectionTexte* | Le bouton permettant de sélectionner un texte est visible.<br><br>Cette constante n'est pas prise en compte dans le mini-aperçu. |
| *iBoutonTous* | Tous les boutons et barres d'outils sont visibles. |
| *iBoutonWord* | Le bouton permettant d'imprimer l'état dans un fichier RTF est visible. |
| *iBoutonXml* | Le bouton permettant d'imprimer l'état dans un fichier XML est visible. |



**`<Avertissement> : (Entier optionnel)`**

Nombre de pages à partir duquel un message d'avertissement est affiché. Ce message permet de prévenir l'utilisateur que les ressources mémoire du poste en cours risquent de devenir insuffisantes si les pages restantes sont affichées. 
Par défaut, ce paramètre vaut 1000. 
Si ce paramètre vaut 0, le message ne sera jamais affiché.


<a name="SYNTAXE2"></a>

### Paramétrer les options de l'aperçu avant impression

`iParamètreAperçu(<Options> , <Affichage>)`
---

**`<Options> : (Constante de type Entier)`**

Elément à configurer : 


|   |   |
| --- | --- |
| *iMémoriserVoletRuban* | Permet de mémoriser le volet du ruban affiché par l'aperçu avant impression. <br><br>Par défaut, le volet du ruban n'est pas mémorisé et l'aperçu est ouvert sur le volet "Impression". |
| *iVoletMiniatures* | Configuration de l'affichage du volet permettant d'afficher les miniatures. |



**`<Affichage> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le volet des miniatures doit être affiché dans l'aperçu avant impression, 

- <u><u><u><u>Faux</u></u></u></u> si le volet des miniatures ne doit pas être affiché. 


Par défaut, le volet des miniatures est affiché dans l'aperçu avant impression. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Paramétrage de l'aperçu avant impression
<a name="parametrage_apercu_avant_impression_ELTPARAGRAPHE000282"></a>

- Le paramétrage réalisé avec la fonction **iParamètreAperçu** est actif jusqu'à :

	- la prochaine utilisation de la fonction [iRAZ](../WDLang5/3046067.md)

	- la prochaine utilisation de la fonction **iParamètreAperçu**.




- Pour paramétrer l'aperçu avant impression de tous les états d'une application, il suffit d'utiliser la fonction **iParamètreAperçu** dans le code d'initialisation du projet.

- Le paramétrage des boutons présents dans l'aperçu peut également être effectué sous l'éditeur d'états (onglet "IHM" de la description de l'état). Dans ce cas, la fonction **iParamètreAperçu** appelée avant l'impression de l'état permet de cacher des boutons supplémentaires. Les boutons qui sont définis comme invisibles dans l'état restent invisibles quoi qu'il arrive.




**Remarques** : 

- Si l'aperçu avant impression donne la possibilité d'envoyer un email, il est possible de paramétrer les caractéristiques de l'email grâce à la fonction [iParamètreExport](../WDLang5/1000017026.md).

- La présence ou non du volet des miniatures est configurable uniquement par programmation. 





<a name="NOTE0_2"></a>


### Etats non réalisés avec l'éditeur d'états
<a name="etats_non_realises_avec_editeur_etats_ELTPARAGRAPHE000319"></a>Lors de l'impression d'états programmés (non réalisés avec l'éditeur d'états), tous les boutons de la barre de boutons sont visibles.


<a name="NOTE0_3"></a>




### Message d'avertissement (syntaxe 1)
<a name="message_avertissement_syntaxe_1_ELTPARAGRAPHE000328"></a>Le message d'avertissement apparaît uniquement lors de l'impression d'un état.

Si l'utilisateur clique sur "Non" pour ne pas afficher les pages suivantes, l'aperçu reste ouvert sur les pages déjà affichées. Dans ce cas, l'impression du document (ou l'export) depuis l'aperçu avant impression imprime la totalité du document (et non pas uniquement les pages affichées dans l'aperçu).


<a name="NOTE0_4"></a>




### Paramétrage des différents modes d'impression
<a name="parametrage_des_differents_modes_impression_ELTPARAGRAPHE000339"></a>Il est possible de paramétrer les options des différents modes d'impression :

- paramétrage de l'impression dans un fichier PDF : [iParamètrePDF](../WDLang5/3046007.md).

- paramétrage de l'envoi d'emails : [iParamètreExport](../WDLang5/1000017026.md).

- paramétrage de l'impression dans un fichier XLS : [iParamètreXLS](../WDLang5/1000017224.md).

- paramétrage de l'impression de duplicata : [iParamètreDuplicata](../WDLang5/1000018845.md). 

- paramétrage de l'impression d'un texte en filigrane : [iParamètreFiligrane](../WDLang5/1000019939.md).






<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280prn.dll
