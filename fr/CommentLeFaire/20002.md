
## Comment choisir la source de données d'un champ ? 
			



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>
Une source de données associée à un champ permet de remplir facilement le contenu du champ sans ou avec très peu de programmation.
Il existe différents types de source de données : 

- Source de données de type [Fichier de données](#NOTE1_1).

- Source de données de type [Requête](#NOTE2_1).

- Source de données de type [Tableau](#NOTE3_1).

- [Aucune source de données](#NOTE4_1) : dans ce cas le champ est rempli par programmation.







<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Source de type Fichier de données
<a name="source_type_fichier_donnees_ELTTEXTE000195"></a>
Si un champ a pour source de données un ficher de données, le champ est lié à un fichier de données faisant partie de l'analyse.

Par exemple, les colonnes du champ Table, du champ Liste, du champ Combo ou les attributs du champ Zone répétée sont liés à une rubrique du fichier.

**Ce type de remplissage ne nécessite aucun code** : le fichier de données est parcouru automatiquement dans le sens correspondant à la clé de parcours qui a  été choisie.

**Deux types d'accès sont disponibles** : 

- Accès direct au fichier de données : pas de limite sur le volume de données (nombre d'enregistrements). L'affichage se fait par pagination, seuls les enregistrements correspondant aux lignes affichées dans le champ sont lus.

- Chargement en mémoire : il est nécessaire de préciser le nombre de lignes maximum afin de limiter la place mémoire occupée. Le temps de chargement en mémoire peut être assez long au-delà de 100 000 lignes.




**Particularités du champ Table** :

- Seules les colonnes liées à des rubriques de type clé dans le fichier de données peuvent être triées et possèdent un filtre,

- Pas de programmation.




Pour plus de détails, consultez : 

- [Le champ Table fichier](../WDChamp/1013177.md)

- [Le champ Zone répétée fichier](../WDChamp/1013085.md)




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Source de type Requête
<a name="source_type_requete_ELTTEXTE000219"></a>
Il existe deux façons pour associer une requête en tant que source de données :

- Requête décrite dans l'éditeur de requêtes puis association de la requête (comme pour un fichier de données),

- Requête intégrée, la requête est créée au moment de la création du champ. Dans ce cas, la requête ne peut être utilisée dans un autre champ.




Les colonnes du champ Table, du champ Liste, du champ Combo ou les Attributs du champ Zone répétée peuvent être liés à une rubrique de la requête.

Ce type de remplissage ne nécessite aucun code, la requête est parcourue automatiquement. Il est conseillé de conserver le tri en automatique car les données ont déjà été triées dans la requête (plus rapide). Il est possible de choisir un autre critère de tri : dans ce cas, le traitement le plus long sera le chargement de la requête. 

Si la requête est paramétrée, il faut utiliser le code d'initialisation du champ pour initialiser les valeurs des différents paramètres.

Méthode de remplissage : 

- **Si vous choisissez un accès direct au fichier de données**, il n'y a pas de limite sur le volume de données qui peut être chargé (nombre d'enregistrements). L'affichage  se fait par pagination, seuls les enregistrements correspondant aux lignes affichées dans le champ sont lus.




- **Si vous choisissez un chargement en mémoire**, vous devez préciser le nombre de lignes maximum afin de limiter la place mémoire occupée. Le temps de chargement en mémoire peut être assez long si vous dépassez 100 000 lignes. Il est conseillé dans ce cas de mettre des conditions de sélection dans la requête pour éviter un chargement trop important.




A savoir sur le champ Table :

- Toutes les colonnes peuvent être triées et possèdent un filtre,

- Pas de programmation.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Source de type Tableau
<a name="source_type_tableau_ELTTEXTE000243"></a>
Un Tableau désigne une variable de type Tableau. Le Tableau peut être :

- simple : chaîne, date, numérique, etc. 

- basé sur une structure. Dans ce cas, la structure ressemble à la structure de l'enregistrement d'un fichier de données.
	Le Tableau doit être rempli au préalable par programmation.
	Les données peuvent provenir :

	- d'un fichier de données,

	- de plusieurs fichiers  de données,

	- d'une requête.





La variable Tableau doit être globale soit au projet, à la fenêtre ou à la page pour pouvoir être associée au champ.

Comme pour un fichier de données ou une requête, les colonnes du champ Table, du champ Liste, du champ Combo ou les Attributs du champ Zone répétée seront liés à des membres de la structure du Tableau.
Ce type de remplissage ne nécessite aucun code, le Tableau est parcouru automatiquement du premier élément au dernier (tout dépend de la façon dont le Tableau a été trié). 

A savoir pour le champ Table :

- Toutes les colonnes peuvent être triées et possèdent un filtre,

- Peu de programmation.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Aucune source de données

<a name="aucune_source_donnees_ELTTEXTE000267"></a>
Dans ce mode, le champ n'est pas lié à une source de données. Vous devez programmer le remplissage en parcourant le fichier de données, la requête ou la variable de type Tableau avec les fonctions du WLangage :

- HLit, ... POUR TOUT ...   pour les fichiers de données ou les requêtes,

- POUR ... , POUR TOUT ELEMENT DE... pour les Tableaux.




Il faut utiliser les fonctions du WLangage qui permettent d'écrire dans le champ correspondant : 

- Champ Table : TableAjoute, TableAjouteLigne, ...

- Champ Liste : ListeAjoute, ...

- Champ Combo : ListeAjoute, ...

- Champ Zone répétée : ZoneRépétéeAjoute, ZoneRépétéeAjouteLigne, ... 




Ce type de remplissage par programmation permet au développeur de tout maîtriser. Il est donc nécessaire de bien connaître les fonctions du WLangage de gestion des fichiers de données, requêtes, tableaux, structures.




