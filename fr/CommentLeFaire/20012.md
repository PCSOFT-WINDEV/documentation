
## Comment gérer une multisélection dans un champ Liste ?
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000130"></a>
Par défaut, un champ **Liste** permet de sélectionner et récupérer un seul élément parmi les éléments proposés. La liste est en monosélection. 

Il est cependant possible de paramétrer le champ Liste afin qu'il permettent de réaliser une multisélection. Dans ce cas, l'utilisateur peut sélectionner plusieurs éléments et il est possible de récupérer les éléments sélectionnés par programmation.

L'option "Multisélection" du champ Liste est disponible dans l'onglet "UI" de la fenêtre de description du champ.

L'utilisateur peut réaliser une multisélection à l'aide des touches standards du clavier Maj, Ctrl, les flèches de déplacement et/ou la souris.

Il existe 2 méthodes pour récupérer les éléments sélectionnés : 

- [Parcours des éléments sélectionnés via la fonction ListeSélect](#NOTE2_1). 

- [Parcours des éléments sélectionnés via l'instruction POUR TOUT](#NOTE3_1).




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Méthode 1 : Utilisation de la fonction ListeSelect
<a name="methode_1_utilisation_fonction_listeselect_ELTTEXTE000154"></a>
Cette méthode consiste à faire une boucle de parcours des éléments à l'aide de la fonction [ListeSelect](../WDLang1/3049011.md). 

Une variable représentant le rang de l'élément sélectionné va être incrémentée à partir de la valeur 1. 

- Si la fonction [ListeSelect](../WDLang1/3049011.md) renvoie la valeur -1 : il n'y a pas ou plus d'élément sélectionné.

- Si la fonction [ListeSelect](../WDLang1/3049011.md) renvoie une valeur supérieure à 0 : cette valeur représente la position de l'élément sélectionné dans le champ Liste.




Pour récupérer la valeur de l'élément sélectionné, utilisez la syntaxe suivante : 

```txt
NomChampListe[Indice]
```


Note : Il est possible de connaître le nombre d'éléments sélectionnés à l'aide de la fonction [ListeSelectOccurrence](../WDLang1/3049010.md). Il est ainsi possible de faire une boucle avec un [POUR](../Motscles/1510001.md) et non pas un [TANTQUE](../Motscles/1510010.md).


### Exemple
<a name="exemple_ELTPARAGRAPHE000066"></a>
```wl
Rang est un entier
PositionElement est un entier
ValeurElement est une chaîne

Rang = 1
PositionElement = ListeSelect(NomListe, Rang)
TANTQUE PositionElement<>-1
	ValeurElement = NomListe[PositionElement]
	Rang++
	PositionElement = ListeSelect(NomListe, Rang)
FIN
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Méthode 2 : Utilisation de l'instruction POUR TOUT
<a name="methode_2_utilisation_instruction_pour_tout_ELTTEXTE000184"></a>
Cette méthode permet de parcourir directement la liste des éléments sélectionnés avec une instruction [POUR TOUT](../Motscles/1510017.md) spécifique. 


### Exemple
<a name="exemple_ELTPARAGRAPHE000081"></a>
```wl
ValeurElement est une chaîne
POUR TOUT LIGNE SELECTIONNEE DE NomListe
	ValeurElement = NomListe..ValeurAffichée
FIN
```



