
## Comment remplir un champ Table par programmation ?
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>
Il existe plusieurs méthodes pour remplir un champ Table par programmation : 

- [Utilisation de la fonction TableAjoute](#NOTE2_1)

- [Utilisation de la fonction TableAjouteLigne](#NOTE3_1)

- [Utilisation de la fonction FichierVersTableMémoire](#NOTE3_1)




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Utilisation de la fonction TableAjoute
<a name="utilisation_fonction_tableajoute_ELTTEXTE000168"></a>


### Principe
<a name="principe_ELTPARAGRAPHE000023"></a>La fonction [TableAjoute](../WDLang1/3074017.md) permet d'ajouter une ligne dans un champ de type Table géré par programmation. Pour ajouter la ligne, il faut :

1. Déclarer une variable pour préparer la ligne à ajouter. 

2. Concaténer chaque valeur de colonne dans cette variable. Chaque valeur est séparée par un caractère TAB. La ligne à ajouter doit être sous la forme : 
	
	```txt
	Ligne = <Valeur Colonne 1> + TAB + <Valeur Colonne 2> + TAB + ... + TAB + <Valeur Colonne N>
	```


3. Ajouter la ligne à l'aide de la fonction [TableAjoute](../WDLang1/3074017.md).





### Exemples de code
<a name="exemples_code_ELTPARAGRAPHE000040"></a>

- Ajout d'une ligne simple : 
	
	```wl
	sLigne est une chaîne
	sLigne = DateDuJour() + TAB + HeureSys() + TAB + "mon message..."
	TableAjoute(TABLE_messages, sLigne)
	```


- Ajout des enregistrements d'un fichier Produit dans un champ Table : 
	
	```wl
	sLigne est une chaîne
	
	// On vide le contenu du champ Table
	TableSupprimeTout(TABLE_Produits)
	
	POUR TOUT PRODUIT
		sLigne = Produit.Référence + TAB + Produit.LibProd + TAB + Produit.Prix
		TableAjoute(TABLE_Produits, sLigne)
	FIN
	Info("Il y a " + TableOccurrence(TABLE_Produits) + " produits ajoutés.")
	```





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Utilisation de la fonction TableAjouteLigne
<a name="utilisation_fonction_tableajouteligne_ELTTEXTE000198"></a>


### Principe
<a name="principe_ELTPARAGRAPHE000054"></a>La fonction [TableAjouteLigne](../WDLang1/3074006.md) permet d'ajouter une ligne dans un champ de type Table géré par programmation. La différence avec la méthode précédente (utilisation de la fonction [TableAjoute](../WDLang1/3074017.md)) est seulement une différence de syntaxe.


### Exemples de code
<a name="exemples_code_ELTPARAGRAPHE000065"></a>

- Ajout d'une ligne simple : 
	
	```wl
	// Ajout d'une ligne simple
	TableAjouteLigne(TABLE_messages, DateDuJour(), HeureSys(), "mon message...")
	```


- Ajout des enregistrements d'un fichier Produit dans un champ Table : 
	
	```wl
	// Ajout d'un fichier PRODUIT dans un champ Table
	sLigne est une chaîne
	
	// On vide le contenu du champ Table
	TableSupprimeTout(TABLE_Produits)
	
	POUR TOUT PRODUIT
		TableAjouteLigne(TABLE_Produits, Produit.Référence, Produit.LibProd, Produit.Prix)
	FIN
	
	Info("Il y a " + TableOccurrence(TABLE_Produits) + " produits ajoutés.")
	```


- Ajout des enregistrements d'un fichier Produit dans un champ Table (colonne par colonne) : 
	
	```wl
	<code WL>
	sLigne est une chaîne
	nNumLigneAjoutée est un entier
	
	// On vide le contenu du champ Table
	TableSupprimeTout(TABLE_Produits)
	
	POUR TOUT PRODUIT
		// On ajoute une ligne vide
		nNumLigneAjoutée = TableAjouteLigne(TABLE_Produits)
		
		// On modifie les colonnes séparément
		TABLE_Produits.Col_Ref[nNumLigneAjoutée] = Produit.Référence
	 	TABLE_Produits.Col_Lib[nNumLigneAjoutée] = Produit.LibProd
		TABLE_Produits.Col_Prix[nNumLigneAjoutée] = Produit.Prix
	
	FIN
	
	Info("Il y a " + TableOccurrence(TABLE_Produits) + " produits ajoutés.")
	```











<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Utilisation de la fonction FichierVersTableMémoire
<a name="utilisation_fonction_fichierverstablememoire_ELTTEXTE000228"></a>


### Principe
<a name="principe_ELTPARAGRAPHE000084"></a>La fonction [FichierVerstableMémoire](../WDLang1/3074005.md) permet de remplir à partir d'un fichier de données (ou d'une requête SQL) un champ Table géré par programmation en une seule opération (sans faire de boucle de remplissage). 

Par contre, il est important que la structure du champ Table (format des colonnes et ordre des colonnes) corresponde exactement au format du fichier ou de la requête SQL : la rubrique 1 du fichier ou de la requête SQL va être associée à la colonne 1, puis la rubrique 2 du fichier ou de la requête SQL va être associée à la colonne 2, etc.


### Exemple de code
<a name="exemple_code_ELTPARAGRAPHE000094"></a>
```wl
FichierVersTableMémoire(TABLE_PRODUIT, Produit)
```









