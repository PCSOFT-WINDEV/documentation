
## Comment enregistrer et récupérer une image dans un mémo binaire
			

<a name="NOTE0"></a>
<a name="NOTE0_1"></a>
Les images (ou tout autre type de fichier) peuvent être stockées dans une base de données par l'intermédiaire des rubriques de type mémo. Pour lire ou écrire dans une rubrique mémo d'un fichier de données, il faut utiliser : 

- la fonction [HAttacheMemo](../WDLang4/3044173.md) pour écrire des données dans la rubrique Mémo. 

- la fonction [HExtraitMemo](../WDLang4/3044072.md) pour lire les données de la rubrique Mémo. 








<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Enregistrement d'une image (ou autre type de document) dans une rubrique mémo
<a name="enregistrement_une_image_autre_type_document_dans_une_rubrique_memo_ELTTEXTE000133"></a>
La fonction [HAttacheMemo](../WDLang4/3044173.md) permet d'enregistrer une image ou un fichier quelconque dans une rubrique de type Mémo de la base de données. La syntaxe complète de cette fonction est détaillée dans la page d'aide de la fonction [HAttacheMemo](../WDLang4/3044173.md).

Quelques exemples :

- Enregistrer la photo d'un produit : 
	
	```wl
	HLitRecherche(Produit, RefProduit, "Prd001")
	SI HTrouve()
		HAttacheMemo(Produit, RubPHOTO, "C:\PHOTOS\MonImage.JPG", HMémoImg)
		HModifie(Produit) 
	FIN
	```


- Enregistrer un document PDF dans un fichier : 
	
	```wl
	HLitRecherche(Documents, IdDoc, "Doc3241")
	SI HTrouve()
		HAttacheMémo(Documents, ContenuDocument, "C:\Mes documents\Facture client 152.PDF", HMémoBin)
		Documents.NomDoc = "Facture client 152.PDF"
		Documents.TypeDoc = "PDF"
		Documents.DateEnregistrement = DateDuJour()
		HModifie(Documents) 
	FIN
	```





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Récupération d'une image (ou autre type de document) depuis une rubrique Mémo
<a name="recuperation_une_image_autre_type_document_depuis_une_rubrique_memo_ELTTEXTE000157"></a>
La fonction [HExtraitMemo](../WDLang4/3044072.md) permet de récupérer une image ou un fichier quelconque présent dans une rubrique de type Mémo de la base de données. La syntaxe complète de cette fonction est détaillée dans la page d'aide de la fonction [HExtraitMemo](../WDLang4/3044072.md).

Quelques exemples :

- Récupération de la photo d'un produit : 
	
	```wl
	HLitRecherche(Produit, RefProduit, "Prd001")
	SI HTrouve()
		// Extrait le document sur le disque
		// RubPHOTO est une rubrique mémo du fichier Produit
		HExtraitMémo(Produit, RubPHOTO, "C:\PHOTOS\MonImage.JPG")
		
		// Affichage de l'image
		MonChampImage = "C:\PHOTOS\MonImage.JPG"
	FIN
	```


- Récupération d'un document PDF : 
	
	```wl
	sNomDoc est une chaîne
	
	HLitRecherche(Documents, IdDoc, "Doc3241")
	SI HTrouve()
		sNomDoc = fRepEncours() + ["\"] + Documents.NomDoc 
		// On suppose que le nom d'origine du document a été enregistré dans la base de données
	
		// On extrait le document sur le disque
		// ContenuDocument est une rubrique mémo du fichier Documents
		HExtraitMémo(Documents, ContenuDocument, sNomDoc)
	
		// On affiche le document
		LanceAppliAssociée(sNomDoc)
	FIN
	```






