
## Comment gérer une multisélection dans un champ Table ?
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000147"></a>
Par défaut, il est possible de sélectionner une seule ligne dans un champ Table. Il est cependant possible de paramétrer le champ Table afin qu'il soit en multisélection. Dans ce cas, l'utilisateur peut sélectionner plusieurs lignes et il est possible de récupérer ces lignes par programmation.

Dans l'onglet "UI" de la fenêtre de description du champ, il est possible de sélectionner le mode de sélection "Multiple" pour les lignes du champ.

La multisélection s'effectue à l'aide des touches standard du clavier Maj, Ctrl, les flèches de déplacement et/ou la souris.

Il existe ensuite 3 méthodes pour récupérer les lignes sélectionnées : 

- [Parcours des lignes et utilisation de la fonction TableSelect](#NOTE2_1). 

- [Parcours des lignes sélectionnées via l'instruction POUR TOUT](#NOTE3_1). 

- [Utilisation d'une colonne de type Interrupteur](#NOTE4_1). 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Méthode 1 : Utilisation de la fonction TableSelect
<a name="methode_1_utilisation_fonction_tableselect_ELTTEXTE000171"></a>
Cette méthode consiste à faire un boucle de parcours et parcourir les lignes à l'aide de la fonction [TableSelect](../WDLang1/3074020.md). 

Une variable représentant le rang de la liste sélectionnée va être incrémentée à partir de la valeur 1. 

- Si la fonction [TableSelect](../WDLang1/3074020.md) renvoie la valeur -1 : il n'y a pas ou plus de lignes sélectionnées.

- Si la fonction [TableSelect](../WDLang1/3074020.md) renvoie une valeur supérieure à 0 : cette valeur représente la position de la ligne sélectionnée dans le champ Table.




Pour récupérer la valeur de l'élément sélectionné, utilisez la syntaxe suivante : 

```txt
NomChampTable.NomColonne[Indice]
```


Note : Il est possible de connaître le nombre de lignes sélectionnées à l'aide de la fonction [TableSelectOccurrence](../WDLang1/3074030.md). Il est ainsi possible de faire une boucle avec un [POUR](../Motscles/1510001.md) et non pas un [TANTQUE](../Motscles/1510010.md).


### Exemple
<a name="exemple_ELTPARAGRAPHE000063"></a>


```wl
Rang est un entier
PositionLigne est un entier
ValeurColonne est une chaîne

Rang = 1
PositionLigne = TableSelect(NomChampTable, Rang)
TANTQUE PositionLigne <>-1
	ValeurElement = NomChampTable.NomColonne[PositionLigne]
	Rang++
	PositionLigne = TableSelect(NomChampTable, Rang)
FIN
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Méthode 2 : Utilisation de l'instruction POUR TOUT
<a name="methode_2_utilisation_instruction_pour_tout_ELTTEXTE000201"></a>
Cette méthode consiste à faire une boucle de parcours des lignes sélectionnées avec une instruction [POUR TOUT](../Motscles/1510017.md) spécifique. 


### Exemple
<a name="exemple_ELTPARAGRAPHE000078"></a>
```wl
POUR TOUT LIGNE SELECTIONNEE DE NomChampTable
	// Traitement de la ligne sélectionnée
FIN
```


<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Méthode 3 : Utilisation d'une colonne de type Interrupteur
<a name="methode_3_utilisation_une_colonne_type_interrupteur_ELTTEXTE000231"></a>
Au lieu d'utiliser le mécanisme de multisélection du champ Table, il est possible d'utiliser une colonne de type Interrupteur (case à cocher) pour gérer la sélection. Cette colonne doit être en saisie dans le champ Table. 

Dans ce cas :

- si la case de l'interrupteur est cochée, la ligne est sélectionnée. 

- si la case n'est pas cochée, la ligne n'est pas sélectionnée.




Il suffit de parcourir toutes les lignes du champ Table et vérifier pour chaque ligne si la case est cochée.


### Exemple de code
<a name="exemple_code_ELTPARAGRAPHE000097"></a>


```wl
Ind est un entier

POUR Ind = 1 A TableOccurrence(NomChampTable)
	SI NomChampTable.Col_Interrupteur[Ind] = Vrai alors
		// On traite la ligne sélectionnée
	FIN

FIN
```





