
## Comment récupérer par programmation la structure d'une analyse ? 
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000090"></a>
L'analyse représente la structure des fichiers de données manipulés par le programme. 

Il est possible par programmation de récupérer la structure de l'analyse afin de faire des contrôles ou de proposer une interface utilisateur pour interroger de manière générique une base de données.

Les fonctions nécessaires pour récupérer la structure d'une analyse sont : 

- [HOuvreAnalyse](../WDLang4/3044106.md) pour ouvrir une analyse.

- [HListeFichier](../WDLang4/3044045.md) pour récupérer la liste des fichiers d'un analyse.

- [HListeRubrique](../WDLang4/3044230.md) pour récupérer la liste des rubriques d'un fichier.

- [HListeClé](../WDLang4/3044060.md) pour récupérer la liste des clés d'un fichier.

- [HListeLiaison](../WDLang4/3044138.md) pour récupérer les liaison entre les fichiers.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Exemple de récupération
<a name="exemple_recuperation_ELTTEXTE000114"></a>
Cet exemple permet de récupérer la liste de tous les fichiers de l'analyse en cours. Pour chaque fichier listé, l'exemple récupère : 

- la liste des rubriques,

- la liste des clés,

- la liste des liaisons.




Code de l'exemple : 

```wl
// Déclaration des variables
sListeFichier est une chaîne
sListeRubrique est une chaîne
sListeClé est une chaîne
sListeLiaison est une chaîne

// Chargement de la liste des fichiers de l'analyse
sListeFichier = HListeFichier()

// Parcours de la liste des fichiers de l'analyse
POUR TOUTE CHAÎNE sNomFichier DE sListeFichier SEPAREE PAR RC
	
	// Chargement des rubriques du fichier
	sListeRubrique = HListeRubrique(sNomFichier, hLstDétail)
	// Chargement des clés du fichier
	sListeClé = HListeClé(sNomFichier, hLstDétail)
	// Chargement des liaisons du fichier
	sListeLiaison = HListeLiaison(sNomFichier)
	
	
	Trace("================ FICHIER ================")
	Trace("Fichier : ", sNomFichier)
	Trace("--- Liste des rubriques ---")
	POUR TOUTE CHAÎNE sRubrique DE sListeRubrique SEPAREE PAR RC
		Trace(sRubrique)
	FIN
	Trace("--- Liste des clés ---")
	POUR TOUTE CHAÎNE sClé DE sListeClé SEPAREE PAR RC
		Trace(sClé)
	FIN
	Trace("--- Liste des liaisons ---")
	POUR TOUTE CHAÎNE sLiaison DE sListeLiaison SEPAREE PAR RC
		Trace(sLiaison)
	FIN
FIN
```



