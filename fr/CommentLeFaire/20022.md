


## Comment créer deux tables reliées en cascade ?
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>
On nomme **Tables en cascade** deux champs Table dont le contenu est lié. Par exemple : 

- Afficher dans un champ Table des familles de produits. 

- Pour chaque famille sélectionnée dans le champ Table, afficher dans un second champ Table les produits lui appartenant.




Cette page d'aide présente comment créer des **Tables en cascade** : 

- [Méthode 1 : Champs Table liés par la propriété Filtre](#NOTE2_1).

- [Méthode 2 : Utilisation de requêtes](#NOTE3_1). 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Méthode 1 : Champs Table liés par la propriété Filtre
<a name="methode_1_champs_table_lies_par_propriete_filtre_ELTTEXTE000331"></a>
La propriété [Filtre](../WDChamp/1013204.md) sur un champ Table permet de filtrer le contenu du champ Table par rapport à une valeur. Cette valeur est testée par rapport à la rubrique de parcours définie au niveau du champ Table. Le filtre va être appliqué sur le second champ Table. Le code de sélection de ligne sera utilisé pour déclencher ce filtre.

Dans cet exemple, nous afficherons dans le champ Table principal les clients du fichier de données CLIENT. Le second champ Table contiendra les commandes du client sélectionné dans le premier champ Table.

Les différentes étapes pour créer ces 2 champs Table en cascade sont les suivantes : 

1. Création du premier champ Table. 

2. Création du second champ Table. 

3. Liaison entre les deux champs Table. 





### Création du premier champ Table
<a name="creation_premier_champ_table_ELTPARAGRAPHE000046"></a>

1. Créez si nécessaire une fenêtre. 

2. Dans le ruban, sous le volet "Création", dans le groupe "Données", déroulez "Table et Liste" et sélectionnez "Table (verticale)". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_base%20-%20HC%20N%B0001.gif&type=thumb)
Cliquez dans la fenêtre à la position où le champ Table doit être créé. 

3. L'assistant de création d'un champ Table se lance. 

4. Sélectionnez l'option "Afficher des données d'un fichier ou d'une requête existante". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_base%20-%20HC%20N%B0002.gif&type=thumb)
Passez à l'étape suivante de l'assistant.

5. Sélectionnez le fichier associé au champ Table. Dans notre exemple, le fichier CLIENT. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_base%20-%20HC%20N%B0003.gif&type=thumb)

	 Passez à l'étape suivante de l'assistant.

6. Sélectionnez les rubriques à afficher dans le champ Table. Dans notre exemple, les rubriques NomClient, Société, CodePostal et Ville. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_base%20-%20HC%20N%B0004.gif&type=thumb)

	 Passez à l'étape suivante de l'assistant.

7. Sélectionnez la clé de parcours. Dans notre exemple, la rubrique NumClient. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_base%20-%20HC%20N%B0005.gif&type=thumb)

	 Passez à l'étape suivante de l'assistant.

8. Les autres étapes de l'assistant n'étant pas importantes pour notre exemple, terminez l'assistant. 

9. Validez. Le champ Table est automatiquement créé dans la fenêtre. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_base%20-%20HC%20N%B0006.gif&type=thumb)


10. Modifiez la hauteur du champ à l'aide des poignées de redimensionnement. 





### Création du second champ Table
<a name="creation_second_champ_table_ELTPARAGRAPHE000086"></a>Le second champ Table va être créé de la même façon. 

1. Dans le ruban, sous le volet "Création", dans le groupe "Données", déroulez "Table et Liste" et sélectionnez "Table (verticale)". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_base%20-%20HC%20N%B0001.gif&type=thumb)
Cliquez dans la fenêtre à la position où le second champ Table doit être créé (sous le premier). 

2. L'assistant de création d'un champ Table se lance. 

3. Sélectionnez l'option "Afficher des données d'un fichier ou d'une requête existante". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_filtre%20-%20HC%20N%B0001.gif&type=thumb)
Passez à l'étape suivante de l'assistant.

4. Sélectionnez le fichier associé au champ Table. Dans notre exemple, le fichier de données COMMANDE. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_filtre%20-%20HC%20N%B0002.gif&type=thumb)

	 Passez à l'étape suivante de l'assistant.

5. Sélectionnez les rubriques à afficher dans le champ Table. Dans notre exemple, nous sélectionnons les rubriques NumCommande, DateCommande, TotalHT et TotalTTC. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_filtre%20-%20HC%20N%B0003.gif&type=thumb)

	 Passez à l'étape suivante de l'assistant.

6. Sélectionnez la clé de parcours. Attention, la clé de parcours doit être la rubrique qui fait le lien avec le premier champ Table. Dans notre exemple, cette rubrique est la rubrique NumClient. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_filtre%20-%20HC%20N%B0004.gif&type=thumb)

	 Passez à l'étape suivante de l'assistant.

7. Les autres étapes de l'assistant n'étant pas importantes pour notre exemple, terminez l'assistant. 

8. Validez. Le champ Table est automatiquement créé dans la fenêtre. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_filtre%20-%20HC%20N%B0005.gif&type=thumb)






### Mise en place de la liaison entre les champs Table
<a name="mise_place_liaison_entre_les_champs_table_ELTPARAGRAPHE000126"></a>Pour mettre en place la liaison entre les champs Table, il faut : 

1. S'assurer que le premier champ Table retourne la valeur qui permettra de filtrer le second champ Table. Cette configuration est réalisée dans la description du champ Table (onglet "Contenu", option "Rubrique mémorisée"). Dans notre exemple, la rubrique mémorisée sera NumClient.

	- Affichez la description du premier champ Table (option "Description de la table" du menu contextuel du champ). 

	- Dans l'onglet "Contenu", sélectionnez la rubrique à mémoriser (combo "Rubrique mémorisée"). Dans notre exemple, cette option correspond à la rubrique NumClient : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_filtre%20-%20HC%20N%B0007.gif&type=thumb)


	- Validez la fenêtre.

2. Activer le filtre du second champ Table à l'aide de la propriété [Filtre](../Proprietes/2510042.md). 

	- Sélectionnez le premier champ Table et affichez les événements du champ (touche F2). 

	- Positionnez-vous dans l'événement "Sélection d'une ligne" du champ Table pour saisir le code suivant :
			
		```txt
		NomSecondeTable.Filtre = NomPremièreTable
		```
Dans notre exemple, le code correspondant est : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_filtre%20-%20HC%20N%B0008.gif)








Les deux champs Table sont liés. Il suffit de tester la fenêtre (GO parmi les boutons d'accès rapide). Sélectionnez un client dans le premier champ Table. Le résultat est immédiat. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_filtre%20-%20HC%20N%B0009.gif&type=thumb)


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Utilisation de requêtes
<a name="utilisation_requetes_ELTTEXTE000373"></a>
Cette méthode utilise une requête pour créer et filtrer les enregistrements du second champ Table. 

Dans cet exemple, nous afficherons dans le champ Table principal les clients du fichier CLIENT. Le second champ Table contiendra les commandes du client sélectionné dans le premier champ Table.

Les différentes étapes pour créer ces 2 tables en cascade sont les suivantes : 

1. Création du premier champ Table (cette étape est identique à celle de la première méthode). 

2. Création d'une requête avec un filtre permettant de sélectionner uniquement les enregistrements correspondant à la ligne sélectionnée dans le premier champ Table. Cette requête va être utilisée comme source du second champ Table.

3. Création du second champ Table.  

4. Liaison entre les deux champs Table.  





### Création du premier champ Table
<a name="creation_premier_champ_table_ELTPARAGRAPHE000046"></a>

1. Créez si nécessaire une fenêtre. 

2. Dans le ruban, sous le volet "Création", dans le groupe "Données", déroulez "Table et Liste" et sélectionnez "Table (verticale)". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_base%20-%20HC%20N%B0001.gif&type=thumb)
Cliquez dans la fenêtre à la position où le champ Table doit être créé. 

3. L'assistant de création d'un champ Table se lance. 

4. Sélectionnez l'option "Afficher des données d'un fichier ou d'une requête existante". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_base%20-%20HC%20N%B0002.gif&type=thumb)
Passez à l'étape suivante de l'assistant.

5. Sélectionnez le fichier associé au champ Table. Dans notre exemple, le fichier CLIENT. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_base%20-%20HC%20N%B0003.gif&type=thumb)

	 Passez à l'étape suivante de l'assistant.

6. Sélectionnez les rubriques à afficher dans le champ Table. Dans notre exemple, les rubriques NomClient, Société, CodePostal et Ville. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_base%20-%20HC%20N%B0004.gif&type=thumb)

	 Passez à l'étape suivante de l'assistant.

7. Sélectionnez la clé de parcours. Dans notre exemple, la rubrique NumClient. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_base%20-%20HC%20N%B0005.gif&type=thumb)

	 Passez à l'étape suivante de l'assistant.

8. Les autres étapes de l'assistant n'étant pas importantes pour notre exemple, terminez l'assistant. 

9. Validez. Le champ Table est automatiquement créé dans la fenêtre. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_base%20-%20HC%20N%B0006.gif&type=thumb)


10. Modifiez la hauteur du champ à l'aide des poignées de redimensionnement. 





### Création de la requête
<a name="creation_requete_ELTPARAGRAPHE000170"></a>Les différentes étapes pour créer cette requête SQL avec un filtre sont les suivantes : 

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif)
 parmi les boutons d'accès rapide. 

	- Dans la fenêtre qui s'affiche, cliquez sur "Requêtes". 

	- L'assistant de création d'une requête se lance.




2. Choisissez de créer une requête de sélection (option "Sélection (SELECT)"). 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Table_cascade_requ%EAte%20-%20HC%20N%B0001.gif&type=thumb)

	Passez à l'étape suivante de l'assistant.

3. La fenêtre de description de la requête s'affiche.

4. Donnez un nom et un libellé à la requête : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Table_cascade_requ%EAte%20-%20HC%20N%B0002.gif&type=thumb)


5. Dans la zone de gauche de la fenêtre de description, choisissez les rubriques du fichier de données à manipuler (dans notre exemple, le fichier COMMANDE et les rubriques NumClient, NumCommande, DateCommande, TotalHT et TotalTTC). 

6. Double-cliquez sur les noms des rubriques pour les ajouter dans la liste des rubriques de la requête : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Table_cascade_requ%EAte%20-%20HC%20N%B0003.gif&type=thumb)


7. Pour effectuer le filtre (sélection), sélectionnez dans la partie centrale la rubrique NumClient, puis dans la partie droite de l'éditeur, cliquez sur le bouton "Condition de sélection".
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Table_cascade_requ%EAte%20-%20HC%20N%B0004.gif)


8. Dans le menu qui s'affiche, sélectionnez "Nouvelle condition...". 

9. Dans la fenêtre qui s'affiche : 

	- Sélectionnez l'opération ("est égal à" dans notre exemple).

	- Sélectionnez "Paramètre" pour pouvoir passer à la requête une valeur sélectionnée dans le premier champ Table.
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Table_cascade_requ%EAte%20-%20HC%20N%B0005.gif)





10. Validez. La fenêtre de description de la requête est mise à jour : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Table_cascade_requ%EAte%20-%20HC%20N%B0006.gif&type=thumb)


11. Validez la fenêtre de description de la requête. La requête apparaît sous l'éditeur : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Table_cascade_requ%EAte%20-%20HC%20N%B0007.gif)


12. Enregistrez la requête (Ctrl + S). 





### Création du second champ Table
<a name="creation_second_champ_table_ELTPARAGRAPHE000205"></a>Pour créer le second champ Table :

1. Créez si nécessaire une fenêtre. 

2. Dans le ruban, sous le volet "Création", dans le groupe "Données", déroulez "Table et Liste" et sélectionnez "Table (verticale)". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_table_cascade_base%20-%20HC%20N%B0001.gif&type=thumb)
Cliquez dans la fenêtre à la position où le champ Table doit être créé. 

3. L'assistant de création d'un champ Table se lance. 

4. Sélectionnez l'option "Afficher des données d'un fichier ou d'une requête existante". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Table_cascade_requ%EAte%20-%20HC%20N%B0008.gif&type=thumb)
Passez à l'étape suivante de l'assistant. 

5. Sélectionnez la requête créée auparavant pour l'associer au champ Table. Dans notre exemple, la requête REQ_CommandeClient. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Table_cascade_requ%EAte%20-%20HC%20N%B0009.gif&type=thumb)

	 Passez à l'étape suivante de l'assistant.

6. Sélectionnez les rubriques à afficher dans la table. Dans notre exemple, les rubriques NumCommande, DateCommande, TotalHT et TotalTTC sont sélectionnées. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Table_cascade_requ%EAte%20-%20HC%20N%B0010.gif&type=thumb)

	 Passez à l'étape suivante de l'assistant.

7. Les autres étapes de l'assistant n'étant pas importantes pour notre exemple, terminez l'assistant.

8. Validez. Le second champ Table est automatiquement créé. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Table_cascade_requ%EAte%20-%20HC%20N%B0012.gif&type=thumb)






### Mise en place de la liaison entre les champs Table
<a name="mise_place_liaison_entre_les_champs_table_ELTPARAGRAPHE000242"></a>Pour mettre en place la liaison entre les champs Table, il faut : 

1. S'assurer que le premier champ Table retourne la valeur qui permettra de filtrer le contenu de la requête. Cette configuration est réalisée dans la description du champ Table (onglet "Contenu", option "Rubrique mémorisée"). Dans notre exemple, la rubrique mémorisée sera NumClient.

	- Affichez la description du premier champ Table (option "Description de la table" du menu contextuel du champ). 

	- Dans l'onglet "Contenu", sélectionnez la rubrique à mémoriser (combo "Rubrique mémorisée"). Dans notre exemple, cette option correspond à la rubrique NumClient : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Table_cascade_requ%EAte%20-%20HC%20N%B0013.gif&type=thumb)


	- Validez la fenêtre.

2. Initialiser le paramètre de la requête utilisée par le second champ Table. 

	- Sélectionnez le premier champ Table et affichez les événements du champ (touche F2). 

	- Positionnez-vous dans l'événement "Sélection d'une ligne de la table..." pour saisir le code suivant :
			
		```txt
		NomRequête.NomParamètre = NomPremièreTable
		HExécuteRequete(NomRequête)
		TableAffiche(NomSecondeTable)
		```
Dans notre exemple, le code correspondant est : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Table_cascade_requ%EAte%20-%20HC%20N%B0014.gif)








Les deux champs Tables sont liés. Il suffit de tester la fenêtre (GO parmi les boutons d'accès rapide). Sélectionnez un client dans la première table. Le résultat est immédiat. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Table_cascade_requ%EAte%20-%20HC%20N%B0015.gif&type=thumb)



