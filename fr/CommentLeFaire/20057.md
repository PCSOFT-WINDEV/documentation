
## Comment parcourir les fichiers d'un répertoire ? 
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000106"></a>
Pour parcourir les fichiers contenus dans un répertoire, il faut utiliser la fonction [fListeFichier](../WDLang1/3036058.md). Cette fonction permet de :

- lister tous les fichiers d'un répertoire et de ses sous-répertoires.

- lister les fichiers d'un répertoire sans descendre dans les sous-répertoires.

- lister les fichiers avec un filtre (extension et/ou nom).




Deux méthodes sont disponibles : 

- [Méthode 1 : Récupération directe de la liste des fichiers](#NOTE2_1).

- [Méthode 2 : Utilisation d'une procédure pour traiter chaque fichier séparément](#NOTE3_1).




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Méthode 1 : Récupération directe de la liste des fichiers
<a name="methode_1_recuperation_directe_liste_des_fichiers_ELTTEXTE000130"></a>
Pour récupérer directement la liste des fichiers : 

1. Récupérez dans une chaîne de caractères la liste de tous les fichiers en utilisant la fonction [fListeFichier](../WDLang1/3036058.md). 

2. Parcourez la chaîne récupérée dans une boucle. Chaque fichier est séparé par un caractère RC. 

3. Traitez chaque fichier trouvé. 




Exemple de code : 

```wl
sListeFichier est une chaîne
sFic est une chaîne

sListeFichier = fListeFichier("C:\TEMP\*.DOC")

POUR TOUTE CHAINE sFic DE sListeFichier SEPAREE PAR RC
	// Traitement du fichier sFic
	// la variable sFic contient le nom du fichier à traiter

FIN
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Méthode 2 : Utilisation d'une procédure "Callback" pour traiter chaque fichier séparément
<a name="methode_2_utilisation_une_procedure_callback_pour_traiter_chaque_fichier_separement_ELTTEXTE000154"></a>
Pour traiter chaque fichier listé séparément à l'aide d'une procédure WLangage : 

1. Créez une procédure locale ou interne pour traiter chaque fichier trouvé. 

2. Parcourez la liste de tous les fichiers en utilisant la fonction [fListeFichier](../WDLang1/3036058.md) associée à la procédure créée précédemment.




Exemple de code : 

```wl
PROCEDURE INTERNE pTraiteFichier(sRep, sFic)
	// Traitement du fichier trouvé
	// La variable sRep contient le répertoire du fichier
	// La variable sFic contient le nom du fichier
	TRACE(sRep, sFic)
FIN

fListeFichier("C:\TEMP\*.DOC", pTraiteFic)
```





