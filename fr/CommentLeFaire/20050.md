
## Comment remplir un champ Arbre ? 
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>
Un champ Arbre permet de représenter de manière hiérarchique (sur plusieurs niveaux) des données. Par exemple, un champ Arbre peut représenter des produits classés par Famille puis Sous-famille.

Pour remplir un champ Arbre par programmation, il faut utiliser :

- [la fonction ArbreAjoute pour ajouter un élément à n'importe quelle position](#NOTE2_1). 

- [la fonction ArbreInsère pour insérer un élément à une position précise](#NOTE3_1). 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Fonction ArbreAjoute : Ajouter un élément à n'importe quelle position
<a name="fonction_arbreajoute_ajouter_element_nimporte_quelle_position_ELTTEXTE000153"></a>
La fonction [ArbreAjoute](../WDLang1/3018012.md) permet d'ajouter un élément dans un champ Arbre. Un élément est composé de  :

- Racine : représente le premier niveau de l'élément

- Branche(s) :  représente le (ou les) niveaux intermédiaires 

- Feuille : représente la donnée à classer




Un élément est représenté sous la forme : 

```txt
Racine + TAB + Branche 1 + TAB + Branche 2 + TAB + ... + TAB + Feuille
```


La syntaxe de la fonction [ArbreAjoute](../WDLang1/3018012.md) est la suivante : 

```txt
ArbreAjoute(<Nom Arbre>, <élément>, <image enroulée>, <image déroulée>, <identifiant>)
```


Pour plus de détails, consultez la page d'aide de la fonction [ArbreAjoute](../WDLang1/3018012.md).


### Exemples de code
<a name="exemples_code_ELTPARAGRAPHE000049"></a>

- Remplissage par programmation : 
	
	```wl
	ArbreAjoute(ARBRE_Ville, "France")
	ArbreAjoute(ARBRE_Ville, "Italie")
	ArbreAjoute(ARBRE_Ville, "France" + TAB + "Paris")
	ArbreAjoute(ARBRE_Ville, "France" + TAB + "Marseille")
	ArbreAjoute(ARBRE_Ville, "France" + TAB + "Lyon")
	ArbreAjoute(ARBRE_Ville, "France" + TAB + "Montpellier")
	ArbreAjoute(ARBRE_Ville, "Italie" + TAB + "Rome")
	ArbreAjoute(ARBRE_Ville, "Italie" + TAB + "Pise")
	ArbreAjoute(ARBRE_Ville, "Italie" + TAB + "Milan")
	ArbreAjoute(ARBRE_Ville, "Espagne" + TAB + "Barcelone")
	ArbreAjoute(ARBRE_Ville, "Espagne" + TAB + "Madrid")
	ArbreAjoute(ARBRE_Ville, "Espagne" + TAB + "Valence")
	```


- Remplissage à partir d'un fichier de données : 
	
	```wl
	// Lecture familles
	POUR TOUT Famille
		// Ajout de la famille dans l'arbre (niveau 1: racine) 
		ArbreAjoute(ARBRE_Produits, Famille.libellé)
		
		// Lecture des sous-familles
		POUR TOUT SousFam avec IDFamille = Famille.IdFamille
			// Ajout de la sous-famille (niveau 2: branche 1) 
			ArbreAjoute(ARBRE_Produits, Famille.libellé + TAB + SousFam.libellé)
		
			// Lecture des produits
			POUR TOUT PRODUIT avec IdSousFam = SousFam.IdSousFam
				// Ajout du produit : (feuille)
				ArbreAjoute(ARBRE_Produits, 
					Famille.libellé + TAB + SousFam.libellé + TAB + PRODUIT.LibProd)
			FIN
		FIN
	FIN
	```







<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Fonction ArbreInsère : Insérer un élément à une position précise
<a name="fonction_arbreinsere_inserer_element_une_position_precise_ELTTEXTE000183"></a>
La fonction [ArbreInsère](../WDLang1/3018023.md) permet d'insérer une feuille par rapport à une autre feuille (feuille frère).

La syntaxe de la fonction [ArbreInsère](../WDLang1/3018023.md) est la suivante : 

```txt
ArbreInsère(<Nom Arbre>, <Feuille frère>, <Nouvelle feuille>, 
	<Image enroulée>, <Image déroulée>, <Identifiant>)
```
Pour plus de détails, consultez la page d'aide de la fonction [ArbreInsère](../WDLang1/3018023.md).


### Exemple de code
<a name="exemple_code_ELTPARAGRAPHE000080"></a>


```wl
ArbreAjoute(ARBRE_Ville, "France")
ArbreAjoute(ARBRE_Ville, "Italie")
ArbreAjoute(ARBRE_Ville, "France" + TAB + "Paris")
ArbreAjoute(ARBRE_Ville, "France" + TAB + "Marseille")
ArbreAjoute(ARBRE_Ville, "France" + TAB + "Lyon")

// Insère les villes de Montpellier et Bordeaux au même niveau que Lyon
ArbreInsère(ARBRE_Ville, "France" + TAB + "Lyon", "Montpellier")
ArbreInsère(ARBRE_Ville, "France" + TAB + "Lyon", "Bordeaux")
```







