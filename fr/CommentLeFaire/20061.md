
## Comment trier le résultat d'une requête ? 
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>
Pour effectuer un tri (ou un classement) des enregistrements provenant d'un fichier de données, il est possible d'effectuer une boucle de parcours sur le fichier en utilisant une rubrique clé. Mais dans ce cas, seul un classement sur les rubriques clé sera possible. 

Un moyen plus efficace pour effectuer ce tri (ou classement) consiste à utiliser une requête SQL.

Nous allons voir comment effectuer un tri en utilisant : 

- [Méthode 1 : une requête SQL réalisée à l'aide de l'éditeur de requêtes](#NOTE2_1).

- [Méthode 2 : une requête réalisée par programmation](#NOTE3_1). 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Requête SQL avec un tri réalisé sous l'éditeur de requêtes
<a name="requete_sql_avec_tri_realise_sous_editeur_requetes_ELTTEXTE000158"></a>
La requête permet de trier (classer) les enregistrements d'un fichier de données en fonction d'une rubrique. 

Dans cet exemple, nous allons réaliser une requête SQL permettant de trier les enregistrements du fichier CLIENT selon le nom du client.

Les différentes étapes pour créer cette requête SQL avec un tri sont les suivantes : 

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_nouveau.gif) parmi les boutons d'accès rapide. 

	- Dans la fenêtre qui s'affiche, cliquez sur "Requêtes". 

	- L'assistant de création d'une requête se lance.




2. Choisissez de créer une requête de sélection (option "Sélection (SELECT)"). <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Requ%EAte_tri-%20HC%20N%B0001.gif&type=thumb)

	Passez à l'étape suivante de l'assistant.

3. La fenêtre de description de la requête s'affiche.

4. Donnez un nom et un libellé à la requête : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Requ%EAte_Tri%20-%20HC%20N%B0002.gif&type=thumb)


5. Dans la zone de gauche de la fenêtre de description, choisissez les rubriques du fichier de données à manipuler. Dans notre exemple, nous sélectionnons les rubriques NomClient, Société, CodePostal et Ville du fichier CLIENT. 

6. Double-cliquez sur les noms des rubriques pour les ajouter dans la liste des rubriques de la requête : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Requ%EAte_Tri%20-%20HC%20N%B0003.gif)


7. Pour effectuer un tri (classement), sélectionnez dans la partie centrale la rubrique à trier. Dans notre exemple, cette rubrique correspond à "NomClient". 

8. Dans la partie droite de l'éditeur, cliquez sur le bouton "Trier". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Requ%EAte_Tri%20-%20HC%20N%B0004.gif)


9. Dans le menu qui s'affiche, sélectionnez "Trier sur la rubrique sélectionnée". La fenêtre suivante s'affiche : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Requ%EAte_Tri%20-%20HC%20N%B0005.gif)


10. Sélectionnez l'ordre du tri (croissant dans notre exemple).

11. Validez. La fenêtre de description de la requête est mise à jour : une flèche avec le numéro du tri est affichée. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Requ%EAte_Tri%20-%20HC%20N%B0006.gif)


12. Validez la fenêtre de description de la requête. La requête apparaît sous l'éditeur : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Requ%EAte_Tri%20-%20HC%20N%B0007.gif)


13. Enregistrez la requête (Ctrl + S). 

14. Visualisez le code SQL en appuyant sur la touche F2 : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CLF_Requ%EAte_Tri%20-%20HC%20N%B0008.gif)


15. Testez la requête (GO dans les boutons d'accès rapide). 

16. La requête peut être exécutée dans le programme à l'aide de la fonction [HExécuteRequête](../WDLang4/3044080.md).








<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Requête SQL avec un tri en programmation
<a name="requete_sql_avec_tri_programmation_ELTTEXTE000182"></a>
Les requêtes SQL peuvent être écrites directement par programmation dans le code WLangage. Pour cela, il faut : 

1. Créer une variable de type [Source de données](../WDLang4/1514053.md) pour représenter la requête en exécution. 

2. Créer une variable de type chaîne de caractères pour contenir le code SQL de la requête et écrire le code SQL dans cette variable. 

3. Exécuter la requête SQL à l'aide de la fonction [HExécuteRequêteSQL](../WDLang4/3044084.md).

4. Parcourir le résultat à l'aide des fonctions HLitXXX.




**Exemple de code** : 

```wl
Src1 est une Source de Données
sCodeSQL est une chaîne

// Liste des commandes triées par Date et Heure décroissantes ...
sCodeSQL = [
SELECT COMMANDE.NumCommande,	
	COMMANDE.DATECDE,	
	COMMANDE.HeureCDE
FROM COMMANDE
ORDER BY DATECDE DESC, HeureCDE DESC
]

HExécuteRequêteSQL(Src1, hRequêteDéfaut, sCodeSQL)
POUR TOUT Src1
	TRACE(Src1.NumCommande, Src1.DATECDE, Src1.HeureCDE)

FIN
```





