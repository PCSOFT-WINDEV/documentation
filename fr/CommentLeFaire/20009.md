
## Comment créer et exécuter une requête SQL par programmation ?
			

<a name="NOTE0"></a>
<a name="NOTE0_1"></a>
Une requête SQL peut être créée directement via l'éditeur de requêtes (voir [Création d'une requête en code SQL](../Editeurs/2032060.md)). Toutefois, il peut être pratique de créer directement par programmation une requête SQL. 

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Méthode
<a name="methode_ELTTEXTE000128"></a>
Pour créer directement par programmation une requête SQL : 

1. Déclarez une variable de type chaîne dans laquelle sera mémorisée le code SQL de la requête. 

2. Déclarez une variable de type [source de données](../WDLang4/1514053.md). Cette variable représentera la requête en exécution. 

3. Utilisez la fonction [HExécuteRequêteSQL](../WDLang4/3044084.md) pour exécuter la requête. 

4. Pour lire et récupérer le résultat de la requête, utilisez les fonctions standard de lecture : HLitXXX, POUR TOUT, ...

5. Ne pas oublier de libérer la requête à la fin de son utilisation (fonction [HLibèreRequête](../WDLang4/1000019374.md)). 




**Astuce**
Si la requête utilise des paramètres provenant de variables, utilisez la fonction [ChaîneConstruit](../WDLang1/3024006.md) pour construire la chaîne représentant le code SQL. Cette astuce est utilisée dans l'exemple ci-dessous. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Exemple
<a name="exemple_ELTTEXTE000152"></a>

```wl
CodeSQL est une chaîne
SD est une Source de Données

CodeSQL = [
SELECT NomClient, Ville FROM CLIENTS
WHERE Pays='%1'
]

// Liste des clients de France
CodeSQL = ChaineConstruit(CodeSQL, "FRANCE")

SI HExécuteRequêteSQL(SD, cnxBase, HRequêteSansCorrection, CodeSQL) ALORS
	// Parcours du résultat
	POUR TOUT SD
		// Traitement de l'enregistrement lu
		TRACE(SD.NomClient, SD.Ville)
	FIN

	HLibèreRequête(SD)
SINON
	Info("Erreur lors de l'exécution de la requête.")
FIN
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Notes
<a name="notes_ELTTEXTE000176"></a>
Ce mode de création d'une requête peut présenter certains inconvénients :

- pas de complétion (assistance) sur les noms des rubriques.

- il est nécessaire de connaître, voire de maîtriser le langage SQL. 

- pas d'assistance à la saisie du code SQL. 





