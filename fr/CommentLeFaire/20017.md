
## Comment ajouter une nouvelle ligne dans un champ Table ? 
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>
Un champ Table géré par programmation peut être soit : 

- en affichage

- en saisie




Si le champ Table est en saisie, il est souvent nécessaire de gérer l'ajout d'une nouvelle ligne dans le champ Table. Pour cela, il faut utiliser les fonctions [TableAjouteLigne](../WDLang1/3074006.md) et [DonneFocusEtRetourUtilisateur](../WDLang1/1410088107.md). 



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Principe
<a name="principe_ELTTEXTE000129"></a>
Pour gérer par programmation l'ajout d'une nouvelle ligne dans un champ Table : 

1. Créez un bouton dans la fenêtre contenant le champ Table. Ce bouton va gérer l'ajout de la ligne dans le champ Table. 

2. Dans le code de clic de ce bouton : 

	- utilisez la fonction [TableAjouteLigne](../WDLang1/3074006.md) pour ajouter une nouvelle ligne. 

	- récupérez et mémorisez dans une variable le numéro de la ligne ajoutée (retournée par la fonction [TableAjouteLigne](../WDLang1/3074006.md)).

	- positionnez-vous sur la nouvelle ligne ajoutée. 

	- donnez le focus à la colonne dans laquelle la saisie doit être effectuée grâce à la fonction [DonneFocusEtRetourUtilisateur](../WDLang1/1410088107.md). 







**Note** :  Si vous utilisez la fonction [TableAjoute](../WDLang1/3074017.md) pour ajouter une nouvelle ligne dans le champ Table, il est nécessaire d'utiliser la fonction [TableOccurrence](../WDLang1/3074021.md) pour récupérer le numéro de la nouvelle ligne ajoutée.


### Exemple de code
<a name="exemple_code_ELTPARAGRAPHE000056"></a>
```wl
nNumLigne est un entier

// Ajout d'une ligne
nNumLigne = TableAjouteLigne(TABLE_LigneCde)
// La ligne ajoutée devient la ligne en cours
TABLE_LigneCde = nNumLigne
// Sélection de la colonne où la saisie doit être effectuée
DonneFocusEtRetourUtilisateur(TABLE_LigneCde.COL_RefProduit)
```







