
## Comment faire un parcours de fichier avec un filtre ?
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000198"></a>
Il existe plusieurs méthodes pour parcourir un fichier de données selon un filtre : 

- [Utilisation des fonctions de parcours](#NOTE2_1). 

- [Instruction POUR TOUT](#NOTE3_1).

- [Fonction HFiltre](#NOTE4_1).

- [Utilisation d'une requête SQL](#NOTE5_1).








<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Méthode 1 : Fonctions de parcours
<a name="methode_1_fonctions_parcours_ELTTEXTE000222"></a>
Cette méthode utilise les fonctions de base du WLangage pour parcourir les fichiers de données :

- [HLitRecherche](../WDLang4/3044050.md)

- [HLitSuivant](../WDLang4/3044037.md)




La fonction [HLitRecherche](../WDLang4/3044050.md) permet d'accéder au premier enregistrement correspondant à la valeur de la borne minimale de la clé de recherche. 

La fonction [HLitSuivant](../WDLang4/3044037.md) permet d'accéder à l'enregistrement suivant correspondant à la recherche.

La fonction [HTrouve](../WDLang4/3044104.md) permet de savoir s'il existe toujours un enregistrement correspondant à la valeur de la recherche.


### Exemple de code
<a name="exemple_code_ELTPARAGRAPHE000053"></a>


```wl
// Parcours des enregistrements du fichier Client dont la ville est MONTPELLIER. 

HLitRecherche(CLIENT, Ville, "MONTPELLIER")
TANTQUE HTrouve(CLIENT)
	// Traitement de l'enregistrement CLIENT
	
	HLitSuivant(CLIENT, Ville)
FIN
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Méthode 2 : Instruction POUR TOUT
<a name="methode_2_instruction_pour_tout_ELTTEXTE000252"></a>
L'instruction [POUR TOUT](../Motscles/1510013.md) permet de parcourir les enregistrements d'un fichier de données. Dans notre cas, cette instruction va permettre de lire les enregistrements d'un fichier de données avec un filtre.

L'instruction [POUR TOUT](../Motscles/1510013.md) attend les paramètres suivants : 

- le nom du fichier de données à parcourir. 

- le nom de l'index (ou clé) utilisé pour trier les enregistrements. 

- la valeur de filtrage. 




Les lectures du premier enregistrement et de l'enregistrement suivant sont effectuées par l'instruction [POUR TOUT](../Motscles/1510013.md). Il n'est pas nécessaire d'utiliser les fonctions HLitXXX.


### Exemple de code
<a name="exemple_code_ELTPARAGRAPHE000082"></a>


```wl
// Parcours des enregistrements du fichier Client dont la ville est MONTPELLIER. 
POUR TOUT CLIENT AVEC VILLE = "MONTPELLIER"
	// Traitement de l'enregistrement CLIENT
FIN
```


<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Méthode 3 : Fonction HFiltre
<a name="methode_3_fonction_hfiltre_ELTTEXTE000282"></a>


1. Utilisez la fonction [HFiltre](../WDLang4/3044100.md) pour appliquer un filtre d'enregistrements sur le fichier de données.

2. Parcourez le fichier de données filtré, avec les fonctions de parcours classiques. 

3. A la fin du parcours, désactivez le filtre par la fonction [HDésactiveFiltre](../WDLang4/3044085.md).





### Exemple
<a name="exemple_ELTPARAGRAPHE000102"></a>Recherche des commandes dont la date est comprise entre le 01/02/2017 et le 28/02/2017.


```wl
// On applique le filtre
HFiltre(COMMANDE, DATECOMMANDE, "20170201", "20170228")

// On parcourt le fichier
POUR TOUT COMMANDE
	// On traite la commande lue
FIN


// On désactive le filtre
HDesactiveFiltre(COMMANDE)
```


Note : La fonction [HFiltre](../WDLang4/3044100.md) permet plus de souplesse que les méthodes précédentes. Elle permet également de gérer des possibilités de filtre plus nombreuses. Consultez l'aide en ligne sur la fonction [HFiltre](../WDLang4/3044100.md) pour connaître les différentes possibilités.





<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Méthode 4 : Utilisation d'une requête SQL
<a name="methode_4_utilisation_une_requete_sql_ELTTEXTE000312"></a>
Pour parcourir le fichier de données avec un filtre via une requête : 

1. Créer la requête. La requête permet de filtrer les enregistrement voulus. 
	Rappel : Une requête SQL peut être réalisée : 

	- dans l'éditeur de requêtes. 

	- par programmation. 


 Pour plus de détails sur la création d'une requête, consultez [Création d'une requête](../Editeurs/2032059.md). 

2. Exécuter la requête (fonction [HExécuteRequête](../WDLang4/3044080.md) ou [HExécuteRequêteSQL](../WDLang4/3044084.md)). 

3. Lire le résultat de la requête en réalisant un parcours de fichier de données standard. 

4. Libérer la requête (fonction [HLibèreRequête](../WDLang4/1000019374.md)). 





### Exemple
<a name="exemple_ELTPARAGRAPHE000148"></a>


```wl
HExécuteRequête(REQ_ListeClient)
POUR TOUT REQ_ListeClient
	// Traitement du client lu dans la requête
FIN
HLibèreRequête(REQ_ListeClient)
```





