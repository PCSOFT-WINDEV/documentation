
## Mise à jour automatique du serveur
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000100"></a>
Le Centre de Contrôle HFSQL permet de mettre en place la mise à jour automatique du serveur. 

Si cette option est activée, le serveur HFSQL peut être mis à jour automatiquement dès qu'une nouvelle version est disponible : 

- sur le serveur PC SOFT. 

- sur un serveur personnalisé. 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Mise en place
<a name="mise_place_ELTTEXTE000124"></a>


### Comment le faire ?
<a name="comment_faire_ELTPARAGRAPHE000021"></a>Pour mettre en place la mise à jour automatique du serveur : 

- Depuis le tableau de bord du Centre de Contrôle HFSQL, dans le Widget "Version", cliquez sur "Configurer les mises à jour". La fenêtre de configuration du serveur s'affiche, cliquez sur l'option "Version". 

- Depuis le ruban des caractéristiques du serveur, dans le groupe "Paramètres", cliquez sur "Configuration du serveur" et affichez les options de version. 





![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CC_HF_Gestion_Serveur%20-%20HC%20N%B0013.gif)


Le Centre de Contrôle indique si le serveur est à jour ou si une mise à jour est disponible. Dans ce cas, il est possible de réaliser immédiatement la mise à jour du serveur HFSQL via le bouton "Mettre à jour le serveur".

Il est également possible de paramétrer une mise à jour automatique. Dans ce cas, la mise à jour sera automatiquement réalisée dès qu'une une mise à jour du serveur disponible sera détectée. 

En cochant l'option "Activer la mise à jour automatique" : 

- un assistant se lance. Ce assistant propose d'utiliser : 

	- le serveur de mise à jour PC SOFT : Ce serveur contient les dernières mises à jour du serveur HFSQL validées par le service Qualité PC SOFT. 

	- un serveur personnalisé. Dans ce cas, il est nécessaire de spécifier l'URL du serveur de mise à jour personnalisé (voir paragraphe suivant). 




- l'assistant propose de planifier la vérification du serveur de mise à jour (par exemple 1 fois par mois). 
	Remarque : Si une nouvelle version est disponible lors de la vérification, le serveur HFSQL sera arrêté et les utilisateurs seront déconnectés pendant la durée de la mise à jour. 





### Serveur de mises à jour personnalisé
<a name="serveur_mises_jour_personnalise_ELTPARAGRAPHE000153"></a>Il est possible d'utiliser un serveur de mises à jour personnalisé du serveur HFSQL. Vous maîtrisez ainsi la mise à jour des serveurs HFSQL de vos clients. Vous pouvez par exemple valider l'utilisation d'une nouvelle version avant de la mettre à disposition. 

Pour réaliser un serveur de mises à jour personnalisé pour les serveurs HFSQL, vous devez : 

1. Installer un serveur Web (IIS ou Apache) sur la machine de votre choix. 

2. Créer les types MIME suivants sur le serveur Web s'ils n'existent pas :

	- .json -> application/json

	- .sign -> application/octet-stream

	- .zip  -> application/x-compress




3. Créer un répertoire à la racine du serveur Web. Ce répertoire va contenir les packs de mise à jour. Exemple : C:\\inetpub\\wwwroot\\packs_hfsql
	Ce répertoire doit contenir : 

	- Un fichier json contenant les noms des packs à utiliser selon les versions (voir ci-après). Ce fichier doit s'appeler "hfsql_updateinfo.json".

	- Les packs correspondant aux mises à jour (packs au format zip avec l'extension ".zip").

	- Les fichiers de signature correspondant aux packs (extension ".sign").


 Ces packs et leurs signatures sont disponibles à l'adresse suivante : [http://package.windev.com/hfsql/](http://package.windev.com/hfsql/). 




Par exemple : 

- Serveur Web des mises à jour : srvmaj

- Répertoire UNC contenant les mises à jour : \\\\srvmaj\\packs_hfsql\\

- URL des mises à jour : http://srvmaj/packs_hfsql/




Exemple de fichier Json : 

```txt
{
	"pack" : [
		{
			"major_version" : 22,
			"language"      : "F",
			"version"       : "220099",
			"min_version"   : "220036",

			"pack" : [
				{
					"plateform" : "win32",
					"data"      : "srv_hfsql_win32_90F220099z"
				},
				{
					"plateform" : "win64",
					"data"      : "srv_hfsql_win64_90F220099z"
				},
				{
					"plateform" : "linux32",
					"data"      : "srv_hfsql_linux32_90F220099z"
				},
				{
					"plateform" : "linux64",
					"data"      : "srv_hfsql_linux64_90F220099z"
				}
			]
		}
	]
}
```
où : 

- **major_version** : correspond à la version majeure du pack (22, 23, ...). Seuls les serveurs HFSQL correspondant à cette version seront mis à jour. 

- **language** : correspond à la langue du serveur (F pour Français, A pour Anglais, ...). 

- **version** : correspond à la version du serveur HFSQL présente dans le pack. 

- **min_version** : correspond à la version minimale à partir de laquelle le pack peut être appliqué. 

- **pack** : permet de donner les caractéristiques des packs. 

- **plateform** : plateforme correspondant au pack : 

	- win32 : Windows 32 bits

	- win64 : Windows 64 bits

	- linux32 : Linux 32 bits

	- linux64 : Linux 64 bits




- **data** : correspond au nom du pack (sans l'extension). 




Remarque : Un seul pack peut être référencé selon la plateforme utilisée par les serveurs HFSQL.


