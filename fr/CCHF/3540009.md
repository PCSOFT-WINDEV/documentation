


## Centre de Contrôle HFSQL : Gestion des éléments planifiés
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000229"></a>
Il est possible de définir des éléments planifiés au niveau du serveur HFSQL. Ces éléments planifiés peuvent correspondre à :

- une sauvegarde (du serveur, d'une ou plusieurs bases, de fichiers de données, etc.). 

- une tâche planifiée (appel d'une procédure stockée). L'appel d'une procédure stockée permet d'exécuter le code de votre choix, par exemple maintenance personnalisée, édition de statistiques, etc.

- une optimisation (d'une ou plusieurs bases, d'un ou plusieurs fichiers, etc.). 

- un rafraîchissement d'une ou plusieurs vues matérialisées. 




Les éléments planifiés peuvent être gérés :

- soit dans le Centre de Contrôle HFSQL. Les éléments planifiés peuvent être définis au niveau du serveur.

- soit par programmation.




Remarque : la gestion des éléments planifiés est disponible au niveau du serveur, des bases de données et des fichiers. L'onglet "Eléments planifiés" est disponible quelque soit l'élément affiché (serveur, base de données ou fichier).



<a name="NOTE2B"></a>
<a name="NOTE2B_1"></a>


## Eléments planifiés dans le Centre de Contrôle HFSQL
<a name="elements_planifies_dans_centre_controle_hfsql_ELTTEXTE000259"></a>


### Créer un élément planifié
<a name="creer_element_planifie_ELTPARAGRAPHE000034"></a>Pour créer un élément planifié : 

1. Connectez-vous si nécessaire à un serveur HFSQL. 

2. Double-cliquez sur le nom du serveur HFSQL dans l'arborescence. 

3. La partie droite du Centre de Contrôle affiche un onglet au nom du serveur. 

4. Cliquez sur l'onglet "Eléments planifiés". 

5. Dans le ruban, dans le groupe "Eléments planifiés", déroulez "Nouvelle planification". Vous pouvez choisir le type de planification à créer : 

	- [Sauvegarde](#NOTE2_Sauvegarde). 

	- [Tâche](#NOTE2_Tache). 

	- [Optimisation](#NOTE2_Optimisation). 

	- [Rafraîchissement de vue matérialisée](#NOTE2_Vue). 




6. Quelque soit l'option choisie, un assistant permet de créer la planification choisie. 



<a name="NOTE2_Sauvegarde"></a>


### Création d'une sauvegarde
<a name="creation_une_sauvegarde_ELTPARAGRAPHE000061"></a>

1. Indiquez : 

	- les éléments à sauvegarder : le contenu du serveur, une base spécifique ou une sélection de bases.

	- si le résultat de la sauvegarde doit être compressé au format zip. 

	- si les index doivent être sauvegardés (fichiers d'index NDX et fichiers d'index full-text FTX). Si les fichiers d'index ne sont pas sauvegardés, la taille de la sauvegarde sera réduite, mais le temps de restauration sera plus long. Remarque : si les fichiers d'index ne sont pas sauvegardés, il sera nécessaire de fournir les mots de passe des fichiers au moment de la restauration pour permettre leur réindexation.




2. Indiquez le scénario de sauvegarde voulu : 

	- Sauvegarde mensuelle complète avec ou sans sauvegarde hebdomadaire différentielle, 

	- Sauvegarde mensuelle complète avec ou sans sauvegarde quotidienne différentielle. 

	- Sauvegarde hebdomadaire complète avec ou sans sauvegarde quotidienne différentielle. 

	- Sauvegarde quotidienne complète. 

	- Définir manuellement la fréquence des sauvegardes. Si cette option est choisie, l'assistant permet de choisir le type de sauvegarde à effectuer et sa fréquence. 




3. Indiquez le répertoire de sauvegarde. 
	Si ce nom correspond à un chemin relatif, la sauvegarde sera réalisée dans le sous-répertoire "Backup" du serveur HFSQL. L'assistant permet de définir un sous-répertoire de "backup" ("Sauvegardes" par défaut). Il est également possible d'ajouter la date et l'heure (sous la forme "Année\\Mois\\Jour\\Heure-Minute") au nom du répertoire pour identifier facilement la sauvegarde.
	Remarque : Les sauvegardes sont réalisées dans un sous-répertoire numéroté (par exemple "backup\\Sauvegardes\\1"). Ainsi, si plusieurs sauvegardes sont réalisées, les fichiers correspondants ne seront pas écrasés par une nouvelle sauvegarde.

4. Indiquez les procédures stockées à exécuter avant et / ou après la sauvegarde.

5. Indiquez si nécessaire le nombre maximum de sauvegardes à conserver sur le serveur. Les sauvegardes les plus anciennes seront automatiquement effacées.
	**Remarque** : Si le serveur est éteint, la sauvegarde ne sera pas réalisée. La sauvegarde sera réalisée à la prochaine date disponible lorsque le serveur sera allumé.

6. Donnez une description à votre sauvegarde et validez.

7. La sauvegarde planifiée apparaît dans le Centre de Contrôle HFSQL.  



<a name="NOTE2_Tache"></a>


### Création d'une tâche
<a name="creation_une_tache_ELTPARAGRAPHE000090"></a>

1. Sélectionnez le mode d'exécution de la tâche : la tâche peut être exécutée : 

	- Périodiquement. L'assistant vous permet ensuite de définir la fréquence d'exécution de la tâche. 

	- et/ou à chaque démarrage du serveur HFSQL. Si cette option est sélectionnée, il est nécessaire d'indiquer si : 

		- la tâche est bloquante : dans ce cas, le serveur HFSQL sera inaccessible pendant l'exécution de la tâche. 

		- si la tâche doit être exécutée en tâche de fond. Dans ce cas, le serveur HFSQL pourra être utilisé dès sont démarrage. 




2. Sélectionnez : 

	- la base de données contenant la procédure stockée à exécuter. 

	- la collection contenant la procédure stockée à exécuter. 

	- la procédure stockée à exécuter. 
			**Attention** : Pour qu'une procédure stockée lancée depuis une tâche planifiée accède aux données, il faut utiliser la fonction [HDéclareExterne](../WDLang4/3044204.md). Cette fonction permet de déclarer des sources de données qui seront utilisées dans les traitements de la procédure stockée. En effet, lorsqu'une procédure stockée est lancée depuis le centre de contrôle HFSQL, il n'y a pas d'analyse en cours et les données HFSQL Client/Serveur ne sont pas immédiatement accessibles. 
			Si la fonction [HDéclareExterne](../WDLang4/3044204.md) n'est pas utilisée dans le code de la procédure stockée, la procédure provoquera une erreur fatale, notée dans le journal des événements du système. 
			**Remarque** : lorsqu'une procédure stockée est lancée depuis une application WINDEV, WEBDEV ou WINDEV Mobile avec la fonction [HExécuteProcédure](../WDLang4/3044358.md), elle utilise l'analyse de l'application et peut donc utiliser directement des données HFSQL Client/Serveur.




3. Définissez la fréquence de la tâche : mois, jour, heure.

4. Donnez une description à votre tâche planifiée et validez.

5. La tâche planifiée apparaît dans le Centre de Contrôle HFSQL.  



<a name="NOTE2_Optimisation"></a>


### Création d'une optimisation
<a name="creation_une_optimisation_ELTPARAGRAPHE000128"></a>

1. Sélectionnez les fichiers à optimiser : le contenu du serveur, une base spécifique ou une sélection de bases.

2. Définissez la fréquence de l'optimisation : mois, jour, heure.

3. Définissez l'action à réaliser : 

	- Réindexer les fichiers.

	- Recalculer les statistiques sur les clés des fichiers. 




4. Spécifiez si nécessaire les mots de passe des fichiers à réindexer. 

5. Donnez une description à votre tâche d'optimisation et validez.

6. La tâche planifiée apparaît dans le Centre de Contrôle HFSQL.  



<a name="NOTE2_Vue"></a>


### Création d'un rafraîchissement d'une vue matérialisée
<a name="creation_rafraichissement_une_vue_materialisee_ELTPARAGRAPHE000143"></a>

1. Sélectionnez les vues à traiter : toutes les vues d'une base de données, une sélection de bases de données et de vues.

2. Définissez la fréquence du rafraîchissement : mois, jour, heure.

3. Donnez une description à votre tâche de rafraîchissement et validez.

4. La tâche de rafraîchissement apparaît dans le Centre de Contrôle HFSQL. 



<a name="NOTE2b_2"></a>


### Supprimer un élément planifié
<a name="supprimer_element_planifie_ELTPARAGRAPHE000153"></a>Pour supprimer un élément planifié : 

1. Connectez-vous si nécessaire à un serveur HFSQL. 

2. Double-cliquez sur le nom du serveur HFSQL dans l'arborescence. 

3. La partie droite du Centre de Contrôle affiche un onglet au nom du serveur. 

4. Cliquez sur l'onglet "Eléments planifiés". 

5. Sélectionnez la tâche planifiée à supprimer.

6. Dans le ruban, dans le groupe "Eléments planifiés", cliquez sur "Supprimer". 
	Vous pouvez également utiliser le menu contextuel de l'élément planifié (option "Supprimer"). 



<a name="NOTE2b_3"></a>


### Modifier un élément planifié
<a name="modifier_element_planifie_ELTPARAGRAPHE000169"></a>Pour modifier un élément planifié : 

1. Connectez-vous si nécessaire à un serveur HFSQL. 

2. Double-cliquez sur le nom du serveur HFSQL dans l'arborescence. 

3. La partie droite du Centre de Contrôle affiche un onglet au nom du serveur. 

4. Cliquez sur l'onglet "Eléments planifiés". 

5. Sélectionnez la tâche planifiée à modifier.

6. Dans le ruban, dans le groupe "Eléments planifiés", cliquez sur "Editer". 
	Vous pouvez également utiliser le menu contextuel de l'élément planifié (option "Editer"). 

7. Une fenêtre de description de l'élément planifié apparaît. Toutes les caractéristiques saisies dans l'assistant sont regroupées sur plusieurs onglets. 

8. Modifiez les informations voulues et validez. 





