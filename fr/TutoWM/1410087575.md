
## Leçon 4.5. Fenêtre avec défilement


<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Ce que vous allez apprendre dans cette leçon
<a name="que_vous_allez_apprendre_dans_cette_lecon_ELTTEXTE000253"></a>


- Créer une fenêtre interne par refactoring. 

- Changement du contenu d'une fenêtre par balayage.





|   |   |
| --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=dur%E9e.png)<br> | <br>Durée estimée : 20 mn |



| [Leçon précédente](../TutoWM/1410087574.md) | [Sommaire](../TutoWM/1410087586.md) | [Leçon suivante](../TutoWM/1410087581.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000300"></a>
Dans les applications Windows, toutes les manipulations sont réalisées grâce à la souris ou au clavier. 

En mobile, les interfaces doivent être pensées différemment. Avec les écrans tactiles, toutes les manipulations se font directement avec les doigts.

Dans les applications pour les appareils mobiles, WINDEV Mobile propose de nombreuses fonctionnalités pour gérer les mouvements spécifiques des doigts (pull to refresh, double touch, sliding, ...). 

Dans cette leçon, nous allons créer une nouvelle fenêtre fiche, permettant de visualiser les produits. 

Dans cette fenêtre, il sera possible de passer d'une fiche produit à une autre par un simple balayage.|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=exemple-WM.png)<br> | Corrigé | Si vous n'avez pas créé l'application "WM Gestion Produits" dans la partie précédente, un projet corrigé est disponible. Ce projet contient toutes les fenêtres créées dans cette partie et vous permet de vérifier vos manipulations. <br><br>Pour ouvrir le projet corrigé, dans la page d'accueil, cliquez sur "Tutoriel" puis dans la zone "Partie 4 - Développement d'une application Android/iOS", double-cliquez sur "Gestion de produits Android/iOS - Corrigé". |





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Création de la fenêtre Fiche avec balayage
<a name="creation_fenetre_fiche_avec_balayage_ELTTEXTE000342"></a>


### Création de la fenêtre Fiche
<a name="creation_fenetre_fiche_ELTPARAGRAPHE000045"></a>

- Pour créer la fenêtre fiche :

	1. Créez une nouvelle fenêtre vierge.

		- Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_Nv_WM_GAF.jpg)
 parmi les boutons d'accès rapide.

		- La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Fenêtre" puis sur "Fenêtre".

		- Dans l'assistant, sélectionnez l'onglet "Standard", choisissez "Vierge" et validez.




2. Dans la fenêtre de sauvegarde de l'élément, indiquez :

	- le titre de la fenêtre : "Fiche du produit".

	- le nom de la fenêtre : "FEN_Avancé_FICHE_Produit".


Nous allons maintenant créer un champ Fenêtre Interne dans la fenêtre Fiche "FEN_Avancé_FICHE_Produit". Ce champ va accueillir une fenêtre interne qui affichera les données à faire défiler.



- Pour créer le champ Fenêtre Interne :

	1. Sous le volet "Création", dans le groupe "Conteneurs", déroulez "Fenêtre interne" et sélectionnez "Zone de balayage (Fenêtre interne)".

	2. Cliquez dans la fenêtre à la position où le champ doit être créé (en haut à gauche).

	3. Redimensionnez le champ Fenêtre Interne pour qu'il occupe tout l'espace disponible de la fenêtre.

	4. Modifiez l'ancrage du champ Fenêtre Interne (option "Ancrage" dans le menu contextuel) : ancrez le champ en hauteur et en largeur (![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_MP%20-%20Ancrage%20fiche%20-%20HC%20N%B0002%202.jpg)
).

	5. Validez. 








### Création de la fenêtre interne
<a name="creation_fenetre_interne_ELTPARAGRAPHE000089"></a>

- Pour simplifier la création de la fenêtre interne, nous allons la créer directement à partir de la fenêtre "FEN_Fiche_du_produit" présente dans notre projet :

	1. Ouvrez si nécessaire la fenêtre "FEN_Fiche_du_produit" sous l'éditeur (double-cliquez sur son nom dans le volet "Explorateur de projet" par exemple).

	2. Sélectionnez tous les champs de l'agencement portrait (Ctrl + A).

	3. Affichez le menu contextuel et sélectionnez l'option "Refactoring .. Créer une fenêtre interne avec la sélection". 

	4. La fenêtre interne est automatiquement créée et la fenêtre de sauvegarde apparaît. Donnez le nom "FI_Produit" et validez. 

	5. Affichez sous l'éditeur la fenêtre interne qui a été créée : cliquez sur le bouton "FI_Produit" dans la barre des éléments ouverts. 

	6. Affichez la fenêtre de description de la fenêtre interne. Dans l'onglet "UI", modifiez la largeur de la fenêtre : 360. Cette largeur correspond à la largeur du champ Fenêtre interne que nous avons créé dans la fenêtre "FEN_Avancé_FICHE_Produit". 

	7. Validez. 








### Gestion du balayage dans la fenêtre Fiche
<a name="gestion_balayage_dans_fenetre_fiche_ELTPARAGRAPHE000102"></a>

- Pour associer la fenêtre interne à la fenêtre Fiche : 

	1. Affichez la fenêtre "FEN_Avancé_FICHE_Produit" sous l'éditeur (cliquez sur son nom dans la barre des éléments ouverts).

	2. Sélectionnez le champ Fenêtre Interne et affichez sa description (option "Description" du menu contextuel). 

	3. Dans l'onglet "Général", sélectionnez la fenêtre interne que nous venons de créer "FI_Produit".
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_MP%20-%20Fiche%20avec%20balayage%20-%20HC%20N%B0001.jpg&type=thumb)


	4. Dans l'onglet "UI", dans la zone "Changement de contenu par balayage" :

	- L'option "Autoriser le changement de contenu par balayage" est déjà cochée car nous avons choisi le champ Fenêtre Interne pour balayage.

	- Cochez l'option "Se positionner sur l'enregistrement courant lors de l'ouverture de la Fenêtre interne.". 

	- Par défaut, l'orientation du balayage est "Horizontal". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_MP%20-%20Fiche%20avec%20balayage%20-%20HC%20N%B0002.jpg&type=thumb)




Le balayage est mis en place.

- Pour ne pas être gêné par l'apparition du clavier lors du balayage, nous allons utiliser la fonction [ClavierVisible](../WDLang3/3071013.md) :

	1. Dans la fenêtre "FEN_Avancé_FICHE_Produit", affichez les événements WLangage du champ Fenêtre Interne. 

	2. Dans l'événement "Sélection par balayage ...", saisissez le code WLangage suivant : 
			
		```wl
		ClavierVisible(Faux)
		```


	3. Fermez l'éditeur de code. 







- Pour finir cette fenêtre, nous allons ajouter l'option de validation dans l'Action Bar de la fenêtre. Nous avons déjà réalisé cette opération dans la [leçon 4.2 (paragraphe "Gestion de la création et de la modification d'un produit")](../TutoWM/1410087572.md), nous présentons ici uniquement les points importants :

	1. Sélectionnez l'Action Bar (en haut de la fenêtre). 

	2. Affichez la fenêtre de description de l'Action Bar. 

	3. Cliquez sur le numéro 2. L'interface de saisie d'une option de l'Action Bar apparaît. 

	4. Cliquez sur le bouton "+" pour ajouter une option. Une nouvelle option par défaut est créée en haut à droite. 

	5. Modifiez les caractéristiques de cette option : 

		- Dans la zone "Libellé", saisissez "Valider". 

		- Dans la zone "Image prédéfinie", déroulez la liste et sélectionnez "Valider". 

		- Validez la fenêtre de description. 




6. Pour saisir le code permettant d'enregistrer les modifications effectuées dans la fenêtre "FEN_Avancé_FICHE_Produit" :

	- Sélectionnez si nécessaire le champ Action Bar de la fenêtre. 

	- Cliquez sur le bouton "OK". 

	- Un menu déroulant avec l'option "Valider" apparaît. 

	- Faites un clic droit sur l'option.

	- Dans le menu contextuel qui s'affiche, sélectionnez l'option "Code".

	- Dans l'événement "Sélection du menu", saisissez le code WLangage suivant :
						
			```wl
			Produit.DepuisFenêtre()
			Produit.Enregistre()
			Ferme()
			```





<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Test de la fenêtre
<a name="test_fenetre_ELTTEXTE000378"></a>
Avant de tester la fenêtre, nous allons modifier la fenêtre "FEN_Avancé_LISTE_Produits" pour ouvrir directement la fenêtre fiche que nous venons de créer.



- Pour ouvrir la fenêtre fiche avec balayage depuis la liste des produits :

	1. Affichez la fenêtre "FEN_Avancé_LISTE_Produits" sous l'éditeur (cliquez sur son nom dans la barre des documents ouverts).

	2. Affichez les événements WLangage liés au champ Zone répétée. 

	3. Dans l'événement "Sélection d'une ligne ... ", remplacez le code WLangage :
			
		```wl
		Produit.LitRecherche(IDProduit,REQ_Produits.IDProduit)
		FEN_Fiche_du_produit.OuvreFenêtreMobile()
		```
par
			
		```wl
		Produit.LitRecherche(IDProduit,REQ_Produits.IDProduit)
		FEN_Avancé_FICHE_Produit.OuvreFenêtreMobile()
		```








- Nous allons maintenant tester le fonctionnement du projet sous le simulateur :

	1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_GO_simu_PRJ_WM_GAF.jpg)
 parmi les boutons d'accès rapide.

	2. Dans le champ Zone répétée qui s'affiche, cliquez sur un produit pour afficher sa fiche.

	3. Cliquez dans la fiche du produit et déplacez la souris vers la droite ou la gauche. La fiche du produit change automatiquement. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_MP%20-%20Fiche%20avec%20balayage%20-%20HC%20N%B0005.jpg&type=thumb)








<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Conclusion
<a name="conclusion_ELTTEXTE000402"></a>
Cette partie vous a présenté les bases pour le développement d'applications Android ou iOS.

Beaucoup de thèmes n'ont pas pu être abordés dans cette partie :

- gestion des emails,

- gestion des notifications, 

- utilisation du panel de visualisation, 

- utilisation du débogueur, 

- ...


N'hésitez pas à consulter l'aide en ligne pour chercher, découvrir, tester de nouvelles fonctionnalités. 



| [Leçon précédente](../TutoWM/1410087574.md) | [Sommaire](../TutoWM/1410087586.md) | [Leçon suivante](../TutoWM/1410087581.md) |
| --- | --- | --- |




