


## URIVersBuffer (Fonction)

***En anglais : URIToBuffer***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Charge en arrière-plan le contenu d'une ressource (image, texte, etc.) identifiée par son URI dans une variable de type buffer.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`URIVersBuffer(<URI> , <Procédure WLangage> [, <Type MIME>])`
---

**`<URI> : (Variable de type URI ou chaîne de caractères)`**

Ressource à charger. Cette ressource peut correspondre : 

- au nom d'une variable de type [URI](../WDLang3/1000024027.md). 
	Rappel : la fonction [URISélecteur](../WDLang3/1000024026.md) permet de sélectionner une ressource et d'obtenir son URI.

- à une chaîne de caractères.




**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure WLangage (également nommée "callback") appelée à la fin du chargement du buffer. Cette procédure est de la forme : 

```txt
PROCEDURE <Nom de la procédure>(<Résultat>, <Buffer>, <Format)
```
 où : 

- &lt;Résultat&gt; est un booléen : 

	- <u><u><u><u>Vrai</u></u></u></u> si le chargement du buffer a été effectué,

	- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour récupérer le détail de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avant tout autre appel à une fonction WLangage (ce qui réinitialiserait l'erreur).




- &lt;Buffer&gt; est une variable de type Buffer initialisée avec le contenu de la ressource.

- &lt;Format&gt; est une chaîne de caractères représentant le type MIME et l'extension de fichier correspondant au format dans lequel la ressource a été chargée (peut être différent du format d'origine si une conversion a été effectuée). Cette chaîne est de la forme : 
	
	```txt
	<Type MIME> + TAB + <Extension>
	```
Exemple : "application/pdf + TAB + .pdf"




**`<Type MIME> : (Chaîne de caractères optionnelle)`**

Type MIME correspondant au format dans lequel la ressource doit être chargée (voir Notes). 

Si ce paramètre n'est pas précisé ou vaut chaîne vide (""), la ressource sera chargée dans son format d'origine si possible ou bien elle sera préalablement convertie dans un format par défaut. 

Rappel : Le format utilisé pour le chargement de la ressource est passé en paramètre de la procédure appelée en fin de chargement.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Gestion du type MIME
<a name="gestion_type_mime_ELTPARAGRAPHE000085"></a>Lorsque la ressource à charger ne provient pas du système de fichier de l'appareil, le fournisseur de contenu (Content Provider) qui gère la ressource peut avoir besoin de convertir cette ressource. 

C'est en général le cas si aucune application de l'appareil ne sait gérer le format d'origine de la ressource. 

Il est possible de préciser le format de conversion de la ressource en renseignant le paramètre &lt;Type MIME&gt;. 

Pour connaître le type MIME dans lequel une ressource peut être convertie, utilisez la fonction [URIRécupèreInfo](../WDLang3/1000024037.md) avec la constante *uriInfoTypeConversion*. Si cette fonction renvoie une chaîne vide (""), la ressource ne peut pas être enregistrée. Dans ce cas, il ne faut pas appeler la fonction **URIVersBuffer** sur cette ressource car elle échouera.

Exemple : un fichier Microsoft Word (.doc ou .docx) est sélectionné avec la fonction [URISélecteur](../WDLang3/1000024026.md). Ce fichier se trouve sur Google Drive et aucune application sur l'appareil ne sait gérer ce type de document. Lors de l'enregistrement de cette ressource le fournisseur de contenu convertira automatiquement cette ressource au format PDF. Dans ce cas, la fonction [URIRécupèreInfo](../WDLang3/1000024037.md) utilisée avec la constante *uriInfoTypeConversion* renverra la chaîne "application/pdf + TAB + .pdf".

<a name="XComposante"></a>

## Composante :
wd280android.aar
