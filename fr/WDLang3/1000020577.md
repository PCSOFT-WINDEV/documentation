
## wsRequête (Type de variable)

***En anglais : wsRequest***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **wsRequête** permet de définir toutes les caractéristiques avancées d'un Webservice. Ce type de variable permet notamment de définir les entêtes HTTP utilisées par un Webservice. Les Webservices EBay et SharePoint nécessitent ce type d'entêtes HTTP. 

**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
C est un wsRequête
C.EntêteHTTP["cle"] = "Valeur"
// Appel de la procédure du Webservice 
// en lui passant l'entête puis les paramètres attendus
ProcWebService(C, param1_WS, param2_WS)
// Affiche la requête envoyée
Trace(C.SourceXML)
```

<a name="NOTE0"></a>

## Remarques
<a name="NOTE0_1"></a>


### Propriétés spécifiques à la description des variables de type wsRequête
<a name="proprietes_specifiques_description_des_variables_type_wsrequete_ELTPARAGRAPHE000037"></a>Les propriétés suivantes peuvent être utilisées pour manipuler une variable de type **wsRequête** :

| **Nom de la propriété** | **Type manipulé** | **Effet** |
| --- | --- | --- |
| CertificatClient | Chaîne de caractères ou buffer | Correspond : <br><br>- à une chaîne de caractères contenant un chemin d'accès au fichier .p12 contenant le certificat à joindre à la requête. Le chargement du certificat se fera automatiquement en prenant :<br><br>	- le certificat présent dans la bibliothèque de l'exécutable (si il a été intégré à l'application),<br><br>	- le certificat présent à l'emplacement spécifié sur disque (si le certificat n'a pas été intégré dans la bibliothèque de l'exécutable).<br><br><br><br><br>- à un buffer contenant le certificat (utilisation de la fonction [fChargeBuffer](../WDLang1/1000019410.md)).<br><br><br><br><br>Si cette propriété correspond à une chaîne vide (""), le certificat par défaut est réinitialisée à "&lt;Aucun&gt;". |
| DuréeNonRéponse | Entier ou Durée | Temps maximum d'attente de la réponse (exprimé en millisecondes). Cette propriété peut correspondre à : <br><br>- un entier correspondant au nombre de millisecondes, <br><br>- une variable de type Durée, <br><br>- l'indication directe de la durée (par exemple 20 s ou 20000 ms). <br><br><br><br><br>Par défaut, cette propriété vaut 20 secondes. |
| EntêteHTTP | Tableau associatif de chaînes Unicode | Entêtes HTTP. |
| MotDePasseCertificatClient | Chaîne de caractères | Mot de passe associé au certificat client (chaîne vide par défaut). |
| SourceXML | Binaire / Buffer | Source XML envoyée au serveur.<br><br>**Cette propriété est disponible en lecture seulement**. |


<a name="NOTE0_2"></a>


### Fonctions utilisant les variables de type wsRequête
<a name="fonctions_utilisant_les_variables_type_wsrequete_ELTPARAGRAPHE000108"></a>


|   |   |
| --- | --- |
| [SOAPAjouteAssertionSAML](../WDLang3/1000020762.md) | Ajoute une assertion SAML à une requête de Webservice. |
| [SOAPAjouteSignatureXML](../WDLang3/1000020754.md) | Ajoute une signature XML à une requête de Webservice. |








