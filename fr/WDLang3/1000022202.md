


## &lt;Variable btlePériphérique&gt;.EtatConnexion (Fonction)

***En anglais : &lt;btleDevice variable&gt;.ConnectionStatus***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie l'état actuel de la connexion avec un périphérique Bluetooth Low Energy ou demande à être prévenu en cas de changement de l'état de la connexion. 

**Remarque** : Les fonctions Bluetooth ne sont pas disponibles dans l'émulateur Android.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
monPériph est un btlePériphérique
monPériph.Connecte()
...
SELON monPériph.EtatConnexion()
	CAS btleEtatConnecté
	// Traitement
	AUTRES CAS
	...
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Connaître l'état actuel de la connexion

`<Résultat> = <Périphérique>.EtatConnexion()`
---

**`<Résultat> : (Constante de type Entier)`**

Etat de la connexion : 


|   |   |
| --- | --- |
| *btleEtatConnecté* | L'appareil est connecté au périphérique Bluetooth spécifié. |
| *btleEtatDéconnecté* | L'appareil n'est pas connecté au périphérique Bluetooth spécifié. |



**`<Périphérique> : (Variable de type btlePériphérique)`**

Nom de la variable de type [btlePériphérique](../WDLang3/1000022054.md) correspondant au périphérique à manipuler.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


**Versions nécessaires**


- ![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) **Applications WINDEV** : 

	- Les fonctions WLangage Bluetooth Low Energy sont disponibles uniquement sur :  

		- les PC gérant le Bluetooth Low Energy version 5 minimum. 

		- les PC utilisant une clé Bluetooth gérant le Bluetooth Low Energy version 5 minimum. 




- Le gestionnaire de périphériques de Windows permet en cas de doute de contrôler la version du Bluetooth d'un poste de travail : [https://support.microsoft.com/en-us/windows/what-bluetooth-version-is-on-my-pc-f5d4cff7-c00d-337b-a642-d2d23b082793](https://support.microsoft.com/en-us/windows/what-bluetooth-version-is-on-my-pc-f5d4cff7-c00d-337b-a642-d2d23b082793)

- L'appairage doit être fait au niveau de Windows. Ainsi, la fonction [BTLEListePériphérique](../WDLang3/1000021882.md) ne permettra d'énumérer que les périphériques qui sont visibles et associés dans les réglages Bluetooth de Windows.




<a name="XComposante"></a>

## Composante :
wd280com.dll
