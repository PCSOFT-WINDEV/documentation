


## Gestion du thème sombre mobile
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000188"></a>
Les dernières versions des OS mobiles permettent de passer les applications en thème sombre pour réduire la consommation de batterie ou pour faciliter l'utilisation de l'appareil dans un environnement peu éclairé.

WINDEV Mobile permet de gérer ce thème sombre dans vos applications mobiles. Il est possible de : 

- s'adapter automatiquement au paramétrage du thème du mobile. Le thème sombre sera alors automatiquement utilisé.  

- forcer le thème sombre ou le thème clair par programmation. 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Mise en place
<a name="mise_place_ELTTEXTE000212"></a>


### Gestion du thème sombre
<a name="gestion_theme_sombre_ELTPARAGRAPHE000023"></a>**Pour gérer le thème sombre dans une de vos applications mobiles** : 

1. Affichez la fenêtre de description du projet : sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description".

2. Dans l'onglet "Style", cochez l'option "Autoriser le passage en thème sombre (automatique ou manuellement via la fonction ChangeThème)". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Theme_sombre%20-%20HC%20N%B0001.gif&type=thumb)


3. Validez. 


Attention : Après l'utilisation de cette option, il est nécessaire de tester l'application afin de vérifier le bon fonctionnement de l'application pour vérifier que l'UI soit correcte. 

**Remarques** : 

- Le projet est associé à un seul gabarit. Ce gabarit correspond au thème clair. Les fenêtres sont toujours éditées en thème clair. Le gabarit utilisé pour le thème sombre est le gabarit **BlackStellar**. 

- Astuce : Utilisez si possible les styles des gabarits. Si des couleurs ou images sont fixées par programmation, utilisez les événements optionnels "Application du thème clair/sombre" pour utiliser une couleur spécifique en fonction du thème utilisé. 





### Tester une application gérant le thème sombre dans le simulateur
<a name="tester_une_application_gerant_theme_sombre_dans_simulateur_ELTPARAGRAPHE000056"></a>Lorsque le thème sombre est géré pour un projet WINDEV Mobile, le simulateur propose une option supplémentaire (![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Theme_sombre%20-%20HC%20N%B0002%201.gif)) permettant de basculer l'application d'un thème à l'autre. 

Exemple : 

1. Lancement du test de l'application : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Theme_sombre%20-%20HC%20N%B0002.gif)

	 Par défaut, le thème clair est utilisé. 

2. Clic sur l'icône de passage au thème sombre : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Theme_sombre%20-%20HC%20N%B0002%201.gif). 

3. Affichage de la fenêtre en test avec le thème sombre. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Theme_sombre%20-%20HC%20N%B0003.gif)






### Cas particulier : Ne pas utiliser le thème sombre sur une fenêtre
<a name="cas_particulier_pas_utiliser_theme_sombre_sur_une_fenetre_ELTPARAGRAPHE000075"></a>Pour ne pas appliquer le thème sombre sur une des fenêtres de l'application : 

1. Affichez la fenêtre de description de la fenêtre (option "Description" du menu contextuel par exemple). 

2. Dans l'onglet "Style", cochez l'option "Ne pas appliquer le thème sombre". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Theme_sombre%20-%20HC%20N%B0004.gif&type=thumb)


3. Validez la fenêtre de description.  




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Programmation en WLangage
<a name="programmation_wlangage_ELTTEXTE000248"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000093"></a>Après l'activation de la gestion du mode sombre, WINDEV Mobile propose : 

- un nouvel événement "Application du thème clair/sombre" pour personnaliser si nécessaire le passage au mode sombre. 

- des fonctions WLangage permettant de connaître, modifier et récupérer le thème utilisé. 





### Evénements spécifiques
<a name="evenements_specifiques_ELTPARAGRAPHE000101"></a>Lors de l'activation de la gestion du thème sombre, un nouvel événement "Application du thème clair/sombre" est disponible au niveau du projet, au niveau des fenêtres et des fenêtres internes. 

**L'événement "Application du thème clair/sombre" du projet** est exécuté dans les cas suivants : 

- Au lancement de l'application (après l'événement "Initialisation" du projet).

- Lors du changement de thème réalisé par programmation avec la fonction [ChangeThème](../WDLang3/1000025266.md) uniquement si la constante *avecExécutionDeCode* a été spécifiée.

- Lors du changement de thème automatiquement effectué par le système : modification des paramètres système, changement d'heure jour/nuit, activation/désactivation de l'économiseur de batterie, ...




**L'événement "Application du thème clair/sombre" des fenêtres** est un événement optionnel. Cet événement est exécuté dans les cas suivants : 

- A l'ouverture de la fenêtre, après l'événement "Déclarations globales" et avant les événements d'initialisation des champs de la fenêtre. 

- Si la fenêtre est ouverte lors du changement de thème réalisé par programmation avec la fonction [ChangeThème](../WDLang3/1000025266.md) uniquement si la constante *avecExécutionDeCode* a été spécifiée.

- Si la fenêtre est ouverte lors du changement de thème automatiquement effectué par le système : modification des paramètres système, changement d'heure jour/nuit, activation/désactivation de l'économiseur de batterie, ...




**L'événement "Application du thème clair/sombre" des fenêtres internes** est un événement optionnel. Cet événement est exécuté dans les cas suivants : 

- Au chargement de la fenêtre interne, après l'événement "Déclarations globales" et avant les événements d'initialisation des champs de la fenêtre interne. 

- Si la fenêtre interne est chargée lors du changement de thème réalisé par programmation avec la fonction [ChangeThème](../WDLang3/1000025266.md) uniquement si la constante *avecExécutionDeCode* a été spécifiée.

- Si la fenêtre interne est chargée lors du changement de thème automatiquement effectué par le système : modification des paramètres système, changement d'heure jour/nuit, activation/désactivation de l'économiseur de batterie, ...




Remarque : Ces événements ne sont pas exécutés : 

- si l'application ne gère pas le thème sombre. 

- si la fenêtre ignore le thème sombre. 





### Fonctions WLangage
<a name="fonctions_wlangage_ELTPARAGRAPHE000138"></a>Les fonctions WLangage permettant de gérer le thème sombre sont les suivantes : 



|   |   |
| --- | --- |
| [ChangeThème](../WDLang3/1000025266.md) | Permet de modifier par programmation le thème (sombre ou clair) utilisé par l'application mobile. |
| [RécupèreThème](../WDLang3/1000025320.md) | Permet de connaître le thème actuel d'une application mobile. |
| [SysThème](../WDLang1/1000019646.md) | Renvoie le thème visuel affiché actuellement sur le mobile. |






