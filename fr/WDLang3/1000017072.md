
## SNMPTrapActive (Fonction)

***En anglais : SNMPTrapEnable***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Active l'interception d'une "trap" SNMP envoyée par un agent.

**Remarque** : il est nécessaire que le service d'interruption SNMP soit installé sur le poste, et que ce service soit démarré. Si l'utilisateur est un administrateur ou un utilisateur avec pouvoir, le service démarre automatiquement (sauf si il a été explicitement désactivé).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000017235&name=snmptrapactive_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Interception de toutes les traps
nIDTrap est un entier
nIDTrap = SNMPTrapActive("ProcTrap", "", "", "")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = SNMPTrapActive(<Procédure WLangage> , <Adresse de l'agent> , <Communauté SNMP> , <OID concerné>)`
---

**`<Résultat> : (Entier)`**



- Identifiant de la trap,

- -1 en cas d'erreur. La fonction [ErreurInfo](../WDLang1/3013008.md) permet d'obtenir plus de renseignements sur le problème rencontré.




**`<Procédure WLangage> : (Nom de procédure)`**

Procédure WLangage qui sera appelée à chaque fois que l'agent SNMP enverra un message de trap (en fonction des filtrages demandés). Cette procédure est de la forme :

```txt
PROCEDURE <Nom de la procédure>(<Adresse>, <Communauté>, <OID>, <Type>, <Valeur>)
```


**`<Adresse de l'agent> : (Chaîne de caractères)`**

Adresse de l'agent dont les traps doivent être reçus. Cette adresse peut être donnée sous la forme :

- adresse IP au format XXX.XXX.XXX.XXX (par exemple 125.5.110.100).

- URL contenant le nom du serveur (par exemple www.pcsoft.fr). Cette syntaxe est conseillée.




Cet agent devra être configuré pour envoyer les traps à la machine exécutant l'application.

Si ce paramètre correspond à une chaîne vide (""), la fonction **SNMPTrapActive** sera appelée sur les traps de n'importe quel agent.

**`<Communauté SNMP> : (Chaîne de caractères)`**

Nom de la communauté SNMP des traps. Permet de filtrer les traps en fonction de leur communauté. 
Si ce paramètre correspond à une chaîne vide (""), la fonction **SNMPTrapActive** sera appelée sur les traps de n'importe quelle communauté.

**`<OID concerné> : (Chaîne de caractères)`**

OID concerné par les traps. Permet de filtrer les traps selon l'OID concerné. 
Si ce paramètre correspond à une chaîne vide (""), la fonction **SNMPTrapActive** sera appelée sur les traps de n'importe quel OID.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Procédure WLangage
<a name="procedure_wlangage_ELTPARAGRAPHE000068"></a>La procédure WLangage sera appelée à chaque fois que l'agent SNMP enverra un message de trap (en fonction des filtrages demandés). Cette procédure est de la forme :

```txt
PROCEDURE <Nom de la procédure>(<Adresse>, <Communauté>, <OID>, <Type>, <Valeur>)
```


Dans ce code :

- &lt;Adresse&gt; est une chaîne. Ce paramètre contient l'adresse IP de l'agent ayant généré la trap.

- &lt;Communauté&gt; est une chaîne. Ce paramètre contient la communauté de l'agent ayant généré la trap.

- &lt;OID&gt; est un tableau de chaînes. Ce paramètre contient l'OID de la trap (sous forme numérique).

- &lt;Type&gt; est un tableau d'entiers. Ce paramètre contient le type de l'OID retourné.

- &lt;Valeur&gt; est un tableau de chaînes. Ce paramètre contient la valeur de l'OID retourné.





<a name="NOTE0_2"></a>



<a name="XComposante"></a>

## Composante :
wd280com.dll
