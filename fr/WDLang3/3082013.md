


## zipCréeExe (Fonction)

***En anglais : zipCreateExe***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Crée une archive auto-extractible sous forme d'un exécutable en 32 bits (.EXE). Lors du lancement de cet exécutable, les fichiers de l'archive sont automatiquement décompressés sur le poste en cours.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003082013&name=zipcreeexe_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Déclaration des variables
MonArchive est un zipArchive
ResOuvreArchive est un entier
ResExeArchive est un entier

// Ouverture de l'archive "MonArchive"
ResOuvreArchive = zipOuvre(MonArchive, "D:\Sauvegardes\Sauvegarde.WDZ")
SI ResOuvreArchive = 0 ALORS
	// Création d'une archive auto-extractible
	ResExeArchive = zipCréeExe(MonArchive, "C:\Répertoires\Archive.EXE")
	...
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = zipCréeExe(<Archive> , <Chemin de l'exécutable> [, <Options d'extraction> [, <Icône de l'exécutable> [, <Répertoire d'extraction par défaut> [, <Traduction de l'auto-extraction>]]]])`
---

**`<Résultat> : (Entier)`**



- 0 si l'exécutable a été créé, 

- Un code d'erreur (valeur supérieure à 0) dans le cas contraire. Pour plus de détails sur ces codes d'erreur, consultez les [Remarques](#NOTE0_1).




**`<Archive> : (Chaîne de caractères ou variable de type zipArchive)`**

Nom de l'archive à manipuler.
Ce nom peut correspondre :

- soit au nom d'une archive défini avec la fonction [zipOuvre](../WDLang3/3082044.md) ou la fonction [zipCrée](../WDLang3/3082003.md).

- soit au nom d'une variable de type [zipArchive](../WDLang3/1000018679.md).




**`<Chemin de l'exécutable> : (Chaîne de caractères)`**

Chemin de l'exécutable à créer (260 caractères maximum). Ce chemin peut être un chemin relatif au répertoire en cours ou un chemin complet. 
L'extension .EXE est obligatoire.

**`<Options d'extraction> : (Constante optionnelle)`**

Options d'extraction à utiliser : 


|   |   |
| --- | --- |
| *zipAdministrateur* | Force l'exécutable créé à se lancer en tant qu'administrateur. Ce mode permet d'éviter la virtualisation des fichiers à partir de Windows Vista. |
| *zipArborescence* | Les fichiers de l'archive seront extraits en respectant l'arborescence des répertoires contenus dans l'archive. |
| *zipAvecUI* | L'auto-extraction affichera une boîte de dialogue permettant à l'utilisateur de choisir le répertoire de destination. |
| *zipChoixArborescence* | L'auto-extraction affichera la case à cocher "Respecter l'arborescence" dans la boîte de dialogue. |
| *zipRepCourant* | Tous les fichiers de l'archive seront extraits dans le répertoire en cours. |
| *zipRepDéfaut* | Utilise le répertoire spécifié par défaut (paramètre &lt;Répertoire d'extraction par défaut&gt;). |
| *zipRepTemporaire*<br>(Valeur par défaut) | Les fichiers de l'archive seront extraits dans le répertoire temporaire de la machine sur laquelle l'exécutable est lancé. Tous les fichiers sont extraits au même endroit. |



**`<Icône de l'exécutable> : (Chaîne de caractères optionnelle)`**

Chemin du fichier icône représentant l'exécutable créé. Ce chemin peut correspondre à un chemin relatif au chemin en cours ou à un chemin complet. 
Si ce paramètre n'est pas précisé, une icône par défaut sera attribuée à l'exécutable.

**`<Répertoire d'extraction par défaut> : (Chaîne de caractères optionnelle)`**

Répertoire proposé par défaut par la fenêtre de décompression (si la constante *zipAvecIHM* est proposée). Si l'interface de l'extraction n'est pas proposée, ce répertoire sera utilisé par défaut pour extraire les fichiers de l'archive.

**`<Traduction de l'auto-extraction> : (Chaîne de caractères optionnelle)`**

Chemin complet du fichier au format INI contenant la traduction des messages de l'auto-extracteur. Le format de ce fichier est détaillé dans les Notes.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Condition d'utilisation
<a name="condition_utilisation_ELTPARAGRAPHE000132"></a>La création d'une archive auto-extractible peut être réalisée uniquement si :

- L'archive existe (la création d'une archive s'effectue avec la fonction [zipCrée](../WDLang3/3082003.md)).

- L'archive est accessible en lecture et en écriture.

- L'archive est mono-partie.




**Attention** : 

- **Archives au format "CAB"** : Cette fonction n'est pas disponible.

- **Archives au format "RAR"** : Cette fonction n'est pas disponible.

- **Archives au format "7z"** : Cette fonction n'est pas disponible.

- **Archives au format "TAR" et "TARGZ"** : Cette fonction n'est pas disponible.



<a name="NOTE0_2"></a>


### Codes d'erreur
<a name="codes_erreur_ELTPARAGRAPHE000155"></a>Les codes d'erreur retournés sont les suivants :

- 10 : Pas assez de place pour créer l'exécutable ou l'utilisateur n'a pas les droits en écriture sur l'archive originale (.WDZ).

- 11 : Erreur pendant la conversion de l'archive en archive auto-extractible.

- 12 : Pas assez de place pour créer l'exécutable, ou l'utilisateur n'a pas les droits en lecture sur l'archive originale (.WDZ).




Le message correspondant au code d'erreur peut être connu grâce à la fonction [zipMsgErreur](../WDLang3/3082034.md).
<a name="NOTE0_3"></a>


### Chemin mémorisé des fichiers de l'archive
<a name="chemin_memorise_des_fichiers_archive_ELTPARAGRAPHE000173"></a>Lors de l'extraction des fichiers d'une archive auto-extractible, le chemin mémorisé des fichiers n'est pas conservé. Seuls le nom et l'extension des fichiers sont conservés.
<a name="NOTE0_4"></a>


### Archive auto-extractible
<a name="archive_autoextractible_ELTPARAGRAPHE000182"></a>Une archive auto-extractible provenant d'une archive WINDEV peut être ouverte avec la fonction [zipOuvre](../WDLang3/3082044.md) et manipulée comme toute autre archive.

Il n'est pas possible de reconstruire l'archive originale (.WDZ ou .ZIP) à partir d'une archive auto-extractible.

Il n'est pas possible de mettre de mot de passe sur une archive auto-extractible.

**Attention** : 

- Une archive auto-extractible au format standard ZIP ne peut pas être ouverte avec la fonction [zipOuvre](../WDLang3/3082044.md).

- Si l'archive auto-extractible contient des sous-répertoires vides et non vides, lors de la décompression de l'archive, seuls les répertoires qui contiennent un fichier sont recréés. 



<a name="NOTE0_5"></a>


### Fermeture de l'archive
<a name="fermeture_archive_ELTPARAGRAPHE000206"></a>Après utilisation de la fonction **zipCréeExe** sur une archive, cette archive ne se ferme pas. Il est nécessaire d'utiliser la fonction [zipFerme](../WDLang3/3082005.md) pour fermer l'archive originale.
<a name="NOTE0_6"></a>


### Traduction de l'interface de l'auto-extracteur (paramètre &lt;Traduction de l'auto-extraction&gt;)
<a name="_ELTPARAGRAPHE000221"></a>Par défaut, l'auto-extracteur est livré en trois langues : français, anglais et espagnol. La langue de l'auto-extracteur s'adapte en fonction de la langue de l'exécutable ou de la langue spécifiée par la fonction [Nation](../WDLang1/3054014.md).  

L'interface de l'auto-extracteur peut utiliser une langue différente de la langue par défaut (le français).
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=zipcreeExe%20-%20HC%20N%B0001.gif)
Pour cela, il suffit de créer un fichier .INI contenant les informations suivantes :

```txt
[GENERAL]
NATIONDEFAUT=1
[WDAUTOEX01]
R000=Archive Autoextractible PC SOFT
R001=Extraire le contenu de l'archive dans le répertoire :
R002=Conserver l'arborescence
R003=Extraire
R004=Fermer
```
Par exemple pour obtenir une interface en anglais :

```txt
[GENERAL]
NATIONDEFAUT=1
[WDAUTOEX01]
R000=Self-Extracting PC SOFT archive
R001=Extract the content of the archive in the directory:
R002=Keep the tree structure 
R003=Extract
R004=Close
```
**Attention** : Les trois premières lignes de ce fichier ne doivent pas être modifiées.

Dans les lignes suivantes, indiquez la traduction voulue.

Le paramètre &lt;Traduction de l'auto-extraction&gt; doit correspondre au chemin du fichier .INI contenant la traduction de l'interface.
<a name="NOTE0_7"></a>


### L'exécutable se situe sur un support duquel les fichiers archivés ne peuvent pas être extraits
<a name="executable_situe_sur_support_duquel_les_fichiers_archives_peuvent_pas_etre_extraits_ELTPARAGRAPHE000245"></a>Il est possible que l'exécutable se situe sur un support (un CD par exemple) duquel les fichiers archivés ne peuvent pas être extraits. Il est alors nécessaire de lancer l'exécutable en précisant dans la ligne de commande :

```txt
/REP=<Répertoire>
```
Le paramètre &lt;Répertoire&gt; indique l'endroit duquel les fichiers archivés doivent être extraits. Si le paramètre &lt;Répertoire&gt; contient des espaces, il est nécessaire d'encadrer la chaîne de caractères par des guillemets.

Ce paramètre est prioritaire sur le paramètre &lt;Répertoire de l'extraction&gt;.
<a name="NOTE0_8"></a>


### L'archive auto-extractible contient des fichiers exécutables
<a name="archive_autoextractible_contient_des_fichiers_executables_ELTPARAGRAPHE000258"></a>Si le dernier fichier archivé est un fichier exécutable (.EXE), ce fichier sera lancé automatiquement après l'extraction de tous les fichiers de l'archive.
<a name="NOTE0_9"></a>


### Paramètres de la ligne de commande d'une archive auto-extractible
<a name="parametres_ligne_commande_une_archive_autoextractible_ELTPARAGRAPHE000267"></a>Les paramètres suivants sont disponibles pour lancer une archive auto-extractible en ligne de commande : 


|   |   |
| --- | --- |
| /REP=&lt;Répertoire&gt; | Permet d'indiquer l'endroit duquel les fichiers archivés doivent être extraits. Si &lt;Répertoire&gt; contient des espaces, il est nécessaire d'encadrer la chaîne de caractères par des guillemets.<br><br>Attention : Ce paramètre est prioritaire sur le paramètre &lt;Répertoire de l'extraction&gt; spécifié avec la fonction **zipCréeExe**. |
| /TIT=&lt;Titre&gt; | &lt;Titre&gt; correspond au titre de la fenêtre d'auto-extraction. |
| /PID=&lt;Num PID&gt; | Permet d'attendre la fin du processus &lt;Num PID&gt; avant de lancer l'extraction. |
| /SILENT | Permet de lancer l'extraction sans jauge ni dialogue. |
| /WAIT | Si l'archive auto-extractible lance un exécutable, l'amorce restera lancée aussi jusqu'à la fin de l'exécutable. |
| /RELANCE | Extraction avec les droits d'administrateur. |



<a name="XComposante"></a>

## Composante :
wd280zip.dll
