
## ModbusLitRegistre (Fonction)

***En anglais : ModbusReadRegister***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Lit un ou plusieurs registres à partir d'une adresse précise dans un esclave Modbus.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Crée une session et connexion à un serveur Modbus
Session est un modbusSession
Session = ModbusConnecteTCP("192.168.1.7")

tabRéponse est un tableau de 5 entiers sur 2 octets

// Si la connexion échoue, affiche l'erreur
SI ErreurDétectée = Vrai ALORS
	Trace(ErreurInfo())
SINON
	// Lit une séquence de 5 registres en lecture-écriture à partir de l'adresse 0x42.
	tabRéponse = ModbusLitRegistre(Session, 0x42, 5, Faux)
	// Si il y a eu une erreur on l'affiche.
	SI ErreurDétectée = Vrai ALORS
		Trace(ErreurInfo())	
	FIN
FIN

// Déconnexion
ModbusDéconnecte(Session)
```



<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Lire 1 registre sur un esclave Modbus

`<Résultat> = ModbusLitRegistre(<Session> , <Adresse> , <Lecture seule>)`
---

**`<Résultat> : (Entier)`**

Valeur du registre lu (entier 16 bits).

**`<Session> : (Variable de type modbusSession)`**

Nom de la variable de type [modbusSession](../WDLang3/1000025924.md) correspondant à la session de communication vers l'esclave Modbus.

**`<Adresse> : (Entier)`**

Adresse de lecture du registre dans l'esclave (comprise entre 0 et 65 535).

**`<Lecture seule> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si les registres à lire font partie des données en lecture seule (correspond au code fonction Modbus 4 (Read Input Registers)). 

- <u><u><u><u>Faux</u></u></u></u> si les registres à lire font partie des données en lecture-écriture (correspond au code fonction Modbus 3 (Read Multiple Holding Registers)).





<a name="SYNTAXE2"></a>

### Lire plusieurs registres sur un esclave Modbus

`<Résultat> = ModbusLitRegistre(<Session> , <Adresse> , <Nombre de registres> , <Lecture seule>)`
---

**`<Résultat> : (Tableau)`**

Tableau d'entiers (16 bits) contenant les valeurs des registres lus.

**`<Session> : (Variable de type modbusSession)`**

Nom de la variable de type [modbusSession](../WDLang3/1000025924.md) correspondant à la session de communication vers l'esclave Modbus.

**`<Adresse> : (Entier)`**

Adresse du début de lecture des registres dans l'esclave (comprise entre 0 et 65 535).

**`<Nombre de registres> : (Entier)`**

Nombre de registres à lire. 

**`<Lecture seule> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si les registres à lire font partie des données en lecture seule (correspond au code fonction Modbus 4 (Read Input Registers)). 

- <u><u><u><u>Faux</u></u></u></u> si les registres à lire font partie des données en lecture-écriture (correspond au code fonction Modbus 3 (Read Multiple Holding Registers)).






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- L'exécution de cette fonction est bloquante tant que l'esclave n'a pas répondu au message ou tant que le délai d'attente de la session n'est pas dépassé. 

- Après l'appel de la fonction **ModbusLitRegistre**, il est conseillé de vérifier la variable [ErreurDétectée](../WDLang1/3087001.md) pour s'assurer qu'il n'y a pas d'erreur.








<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280com.dll


