
## SOAPExécute (Fonction)

***En anglais : SOAPRun***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Exécute une procédure sur un serveur SOAP.

**Remarques** : 

- Les paramètres de la procédure doivent être spécifiés avant l'utilisation de la fonction **SOAPExécute** grâce à la structure SOAP (voir Notes).

- Cette fonction ne gère pas les langues non latines. 





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003069013&name=soapexecute_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Définition des paramètres de la procédure "Température" qui
// retourne la température d'une ville identifiée par son code postal
SOAP.Valeur[1] = 94010
SOAP.Nom[1] = "CodePostal"
SOAP.Type[1] = SOAPTypeChaîne
// Exécution de la procédure "Température" sur un serveur non WINDEV
ResExécution = SOAPExécute("http://www.Temp.com/Degré", "Température", "urn:Temp-Degré")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe
<a name="SYNTAXE2"></a>

### Exécuter une procédure sur un serveur SOAP quelconque

`<Résultat> = SOAPExécute(<URL du serveur SOAP> , <Nom de la procédure> [, <Espace de nommage de la procédure> [, <Action de la procédure> [, <Style d'encodage>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la communication avec le serveur SOAP a été établie, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md). 




**`<URL du serveur SOAP> : (Chaîne de caractère)`**

URL du serveur SOAP à contacter. Ce paramètre est fourni dans la documentation du serveur SOAP et de ses procédures.
Pour soumettre une requête avec authentification, ce paramètre doit correspondre à :

```txt
http://utilisateur:motdepasse@URLServeur
```

Il est également possible de préciser le port en utilisant la syntaxe : http://utilisateur:motdepasse@URLServeur:port

**`<Nom de la procédure> : (Chaîne de caractères)`**

Nom de la procédure à exécuter sur le serveur SOAP spécifié. Ce paramètre est fourni dans la documentation du serveur SOAP et de ses procédures.

**`<Espace de nommage de la procédure> : (Chaîne de caractères optionnelle (obligatoire dans le cas d'un serveur SOAP WINDEV))`**

Espace de nommage (appelé aussi "NameSpace") de la procédure à exécuter. Ce paramètre est fourni dans la documentation du serveur SOAP et de ses procédures.

**`<Action de la procédure> : (Chaîne de caractères optionnelle)`**

Action de la procédure (appelé aussi "SOAPAction"). Ce paramètre est fourni dans la documentation du serveur SOAP et de ses procédures.

**`<Style d'encodage> : (Chaîne de caractères optionnelle)`**

Style d'encodage de la procédure (appelé aussi "EncodingStyle"). Ce paramètre est fourni dans la documentation du serveur SOAP et de ses procédures.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Paramètres de la procédure à exécuter
<a name="parametres_procedure_executer_ELTPARAGRAPHE000113"></a>Pour passer des paramètres à une procédure exécutée sur un serveur SOAP, WINDEV utilise la structure suivante :

| Variable | Type | Détail |
| --- | --- | --- |
| SOAP.NameSpace | Chaîne de caractères optionnelle | Espace de nommage (appelé "NameSpace") du paramètre. |
| SOAP.Nom | Chaîne de caractères | Nom du paramètre |
| SOAP.ParamXML | Chaîne de caractères optionnelle | Description complète du paramètre sous forme XML. Si ce paramètre est spécifié, les autres paramètres (Valeur, Nom, Type, NameSpace et StyleEncodage) sont ignorés. |
| SOAP.StyleEncodage | Chaîne de caractères optionnelle | Style d'encodage (appelé "EncodingStyle") du paramètre. |
| SOAP.Type | Constante | Type du paramètre |
| SOAP.Valeur | Tout type | Valeur du paramètre |

Cette structure doit être utilisée pour chaque paramètre. Par exemple :

```wl
SOAP.Valeur[1] = 94010
SOAP.Nom[1] = "CodePostal"
SOAP.Type[1] = SOAPTypeChaîne
```


Cette structure est équivalente à :


```wl
SOAP.ParamXML[1] = <CodePostal xsi:type="xsd:string">94010</CodePostal>
```



<a name="NOTE0_2"></a>




### Type du paramètre
<a name="type_parametre_ELTPARAGRAPHE000172"></a>Le type du paramètre peut être :

| Constante | Type |
| --- | --- |
| *SOAPTypeBinaireBase64* | Binaire |
| *SOAPTypeBinaireHexa* | Binaire hexadecimal |
| *SOAPTypeBooléen* | Booléen |
| *SOAPTypeChaîne* | Chaîne de caractères |
| *SOAPTypeChaîneNormalisée* | Chaîne de caractères sans retour chariot (RC) et sans tabulation (TAB) |
| *SOAPTypeDécimal* | Tout nombre sans limite |
| *SOAPTypeEntier* | Entier compris entre - 2 147 483 648 et + 2 147 483 647) |
| *SOAPTypeEntierCourt* | Entier court |
| *SOAPTypeEntierCourtNonSigné* | Entier court non signé |
| *SOAPTypeEntierIllimité* | Entier (sans limite) |
| *SOAPTypeEntierLong* | Entier long |
| *SOAPTypeEntierLongNonSigné* | Entier long non signé |
| *SOAPTypeEntierNégatif* | Entier négatif (sauf 0) |
| *SOAPTypeEntierNonNégatif* | Entier non négatif |
| *SOAPTypeEntierNonPositif* | Entier non positif |
| *SOAPTypeEntierNonSigné* | Entier non signé |
| *SOAPTypeEntierPositif* | Entier positif (sans 0) |
| *SOAPTypeOctet* | Octet |
| *SOAPTypeOctetNonSigné* | Octet non signé |
| *SOAPTypeRéel* | Réel |
| *SOAPTypeRéelDouble* | Réel double |
| *SOAPTypeURL* | Adresse URL |




<a name="NOTE0_3"></a>




### Appel de la fonction SOAPExécute
<a name="appel_fonction_soapexecute_ELTPARAGRAPHE000274"></a>Après l'appel de la fonction **SOAPExécute** :

- Les paramètres de la procédure sont effacés.

- La structure de l'entête spécifié avec la fonction [SOAPAjouteEntête](../WDLang3/3069001.md) est effacée.

- La fonction [SOAPDonneRésultat](../WDLang3/3069002.md) permet de récupérer le résultat de la procédure exécutée.

- La fonction [SOAPErreur](../WDLang3/3069005.md) permet de récupérer le message d'erreur de la procédure exécutée.





<a name="NOTE0_4"></a>




### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000300"></a>La fonction **SOAPExécute** retourne <u><u><u><u>Faux</u></u></u></u> si aucune communication avec le serveur SOAP n'a été établie. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.

Attention : La fonction **SOAPExécute** peut retourner <u><u><u><u>Faux</u></u></u></u> avec un résultat correct si celui-ci contient le texte ":fault". 

**Cas particulier : Erreur "405 Method not allowed"**
Cette erreur signifie qu'il manque la chaîne "/.soap" à la suite de l'URL du serveur SOAP réalisé avec WINDEV. Cette erreur peut également apparaître si le serveur Web n'est pas configuré pour utiliser le serveur SOAP WINDEV.

<a name="XComposante"></a>

## Composante :
wd280com.dll
