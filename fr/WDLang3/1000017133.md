
## BTInfoPériphérique (Fonction)

***En anglais : BTInfoDevice***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie des informations spécifiques sur un périphérique Bluetooth.  






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
sListePeriphériques est une chaîne
sUnPeripherique est une chaîne
sId est une chaîne
sNom est une chaîne
sAdresseMAC est une chaîne
// Vide la liste
TableSupprimeTout(TABLE_Periphériques)
// Liste les périphériques Bluetooth à proximité
sListePeriphériques = BTListePériphérique(btListeSimple)
// Parcours des périphériques connectés
POUR TOUTE CHAINE sUnPeripherique DE sListePeriphériques SEPAREE PAR RC
	// Mémorise les informations du périphérique
	sId = ExtraitChaîne(sUnPeripherique, 1)
	sNom = ExtraitChaîne(sUnPeripherique, 3)
	sAdresseMAC = ExtraitChaîne(sUnPeripherique, 2)
	// Si le nom n'est pas renseigné, demande le nom explicitement
	SI sNom ~= "" ALORS sNom = BTInfoPériphérique(sId, btNom) 
	// Remplit le champ Table avec les périphériques
	TableAjouteLigne(TABLE_Periphériques, Faux, sId, sNom, sAdresseMAC)
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = BTInfoPériphérique(<Identifiant du périphérique> , <Information demandée>)`
---

**`<Résultat> : (Chaîne de caractères)`**

Information demandée sur le périphérique spécifié.

**`<Identifiant du périphérique> : (Entier)`**

Identifiant du périphérique Bluetooth à manipuler. Cet identifiant est retourné par la fonction [BTListePériphérique](../WDLang3/1000017132.md) ou par la fonction [BTSélecteurPériphérique](../WDLang3/1000017135.md).

**`<Information demandée> : (Constante de type Entier)`**

Information sur le périphérique. Le tableau suivant liste les informations disponibles et les valeurs pouvant être renvoyées :



|   |   |
| --- | --- |
| *btAdresseMAC* | Adresse MAC du périphérique |
| *btClasseDePériphérique* | Classe du périphérique, pouvant correspondre à une des constantes suivantes :<br><br>- btCoD_AccèsRéseau<br><br>- btCoD_AudioVidéo<br><br>- btCoD_Divers<br><br>- btCoD_Image<br><br>- btCoD_Inconnu<br><br>- btCoD_Jouet<br><br>- btCoD_Ordinateur<br><br>- btCoD_Périphérique<br><br>- btCoD_Téléphone<br><br>- btCoD_Vêtement<br><br><br> |
| *btDernièreFoisUtilisé* | Date et heure à laquelle le périphérique a été utilisé pour la dernière fois par le poste en cours. Cette date est au format JJMMAAAAHHMMSS.<br><br> |
| *btDernièreFoisVu* | Date et heure à laquelle le périphérique a été vu pour la dernière fois par le poste en cours. Cette date est au format JJMMAAAAHHMMSS.<br><br> |
| *btEtatAuthentifié* | <br><br>- 1 si le périphérique est actuellement authentifié auprès du poste en cours,<br><br>- 0 dans le cas contraire.<br><br><br> |
| *btEtatConnecté* | <br><br>- 1 si le périphérique est actuellement "connecté" au poste en cours,<br><br>- 0 dans le cas contraire.<br><br><br><br><br> |
| *btEtatMémorisé* | <br><br>- 1 si le périphérique est actuellement "mémorisé" par le gestionnaire Bluetooth du poste en cours,<br><br>- 0 dans le cas contraire.<br><br><br><br><br> |
| *btNom* | Nom du périphérique |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Limitation
<a name="limitation_ELTPARAGRAPHE000129"></a>Seules les piles bluetooth Microsoft, Bluesoleil et Broadcom (Widcomm) sont supportées par cette fonction. Pour connaître la pile utilisée, utilisez la fonction [BTPile](../WDLang3/1000017229.md).  

Les piles Broadcom (Widcomm) ne sont pas disponibles en 64 bits.

Pour plus de détails sur les clés supportées, consultez [Quelles piles utiliser ?](../WDLang3/1000017231.md)



<a name="XComposante"></a>

## Composante :
wd280com.dll
