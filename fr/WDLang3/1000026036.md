


## &lt;modbusSession&gt;.EcritRegistre (Fonction)

***En anglais : &lt;modbusSession&gt;.WriteRegister***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ecrit un ou plusieurs registres (valeur 16 bits) à partir d'une adresse précise dans un esclave Modbus.

**Remarques** : 

- L'exécution de cette fonction est bloquante tant que l'esclave n'a pas accusé réception du message ou tant que le délai d'attente de la session n'est pas dépassé. 

- L'écriture sur 1 bit correspond au code fonction Modbus 6 (Write Single Holding Register). 

- L'écriture sur plusieurs bits correspond au code fonction Modbus 16 (Write Multiple Holding Registers).



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Crée une session et connexion à un serveur Modbus
Session est un modbusSession
Session = ModbusConnecteTCP("192.168.1.7")

// Si la connexion échoue, affiche l'erreur
SI ErreurDétectée = Vrai ALORS
	Trace(ErreurInfo())
SINON
	// Ecrit une séquence de 5 entiers 16 bits à partir de l'adresse 0x42
	SI PAS Session.EcritRegistre(0x42, [0xF8C5, 1637, -1542, 0, 0x00A8]) ALORS
		Trace(ErreurInfo())	
	FIN
FIN

// Déconnexion
Session.Déconnecte()
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Ecrire une valeur 16 bits dans un esclave Modbus

`<Résultat> = <Session>.EcritRegistre(<Adresse> , <Valeur>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> l'écriture a été réalisée,  

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Session> : (Variable de type modbusSession)`**

Nom de la variable de type [modbusSession](../WDLang3/1000025924.md) correspondant à la session de communication vers l'esclave Modbus.

**`<Adresse> : (Entier)`**

Valeur comprise entre 0 et 65 535 correspondant à l'adresse (dans l'esclave) à laquelle la valeur doit être écrite.

**`<Valeur> : (Entier)`**

Nombre en 16 bits qui doit être écrit dans le registre de l'esclave.


<a name="SYNTAXE2"></a>

### Ecrire plusieurs valeurs 16 bits dans un esclave Modbus

`<Résultat> = <Session>.EcritRegistre(<Adresse> , <Valeurs>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> l'écriture a été réalisée,  

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Session> : (Variable de type modbusSession)`**

Nom de la variable de type [modbusSession](../WDLang3/1000025924.md) correspondant à la session de communication vers l'esclave Modbus.

**`<Adresse> : (Entier)`**

Valeur comprise entre 0 et 65 535 correspondant à l'adresse (dans l'esclave) à laquelle les valeurs doivent être écrites.

**`<Valeurs> : (Tableau)`**

Tableau d'entiers 16 bits qui doivent être écrits dans les registres de l'esclave.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
ATTENTION : Les opérations d'écriture permettant de manipuler des automates, il est recommandé de tester les différentes commandes avant une mise en production afin de vérifier que les automates effectuent bien les opérations demandées.





<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280com.dll
