
## Gestion des ports (ports série, ports parallèles, ports USB, ...)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000183"></a>
Beaucoup de périphériques peuvent être gérés directement par une gestion des ports par lesquels ces périphériques communiquent avec l'ordinateur. Ainsi, la gestion d'un port série, parallèle ou infrarouge peut permettre de gérer directement la lecture d'un code-barres ou une impression au fil de l'eau.

WINDEV, WEBDEV et WINDEV Mobile permettent de gérer les actions effectuées sur ces différents ports.

**Remarques** : 

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La gestion des ports infrarouges n'est pas disponible.

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Seuls les ports série sont gérés.  










<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Port série / parallèle / infrarouge
<a name="port_serie_parallele_infrarouge_ELTTEXTE000207"></a>
Grâce à de nombreuses fonctions WLangage, la gestion des ports séries et parallèles est simplifiée. Toutes ces fonctions commencent par la lettre **s**.

Il est par exemple possible :

- d'ouvrir un port série ou parallèle (fonction [sOuvre](../WDLang3/3062013.md)) ou de le fermer (fonction [sFerme](../WDLang3/3062010.md)).

- d'écrire directement dans un port série (fonction [sEcrit](../WDLang3/3062009.md)) ou de lire son contenu (fonction [sLit](../WDLang3/3062012.md)).




Pour plus de détails sur les fonctionnalités proposées, consultez [Fonctions de gestion des ports série et parallèle](../WDLang3/3062003.md).




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Utilisation d'une librairie externe : RXTX
<a name="utilisation_une_librairie_externe_rxtx_ELTPARAGRAPHE000240"></a>En Java, l'utilisation des fonctions de manipulation des ports séries et parallèles (fonctions [sOuvre](../WDLang3/3062013.md), [sEcrit](../WDLang3/3062009.md), [sLit](../WDLang3/3062012.md), ...) nécessite la présence d'une librairie externe : RXTX. 

Cette librairie est composée d'une archive Jar et d'une ou plusieurs librairies natives dépendantes du système d'exploitation sur lequel s'exécute l'application.
 
Pour utiliser ces fonctions : 

- l'archive jar (RXTXComm.jar) doit : 

	- soit se trouver dans le même répertoire que l'application Java générée par WINDEV, 

	- soit se trouver dans le classpath d'exécution de l'application, 

	- soit être directement intégrée dans l'application générée (depuis l'assistant de génération Java). 




- la ou ou les librairies natives correspondant au système d'exploitation sur lequel s'exécute l'application doivent se trouver: 

	- soit  dans le même répertoire que l'application Java générée par WINDEV, 

	- soit dans le chemin des librairies de l'application (librarypath).







Il est possible de télécharger la librairie RXTX et sa documentation grâce au lien suivant : [http://users.frii.com/jarvi/rxtx/index.html](http://users.frii.com/jarvi/rxtx/index.html) (lien valide lors de l'écriture de cette documentation). 

**Attention** : La gestion des ports infrarouges n'est pas disponible en Java. 


![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) **Cas particulier sous Linux** : 

- Seuls les ports série peuvent être ouverts et initialisés. 

- Par défaut, l'utilisateur n'a pas accès aux ports série. Il est nécessaire de lui accorder des droits spécifiques pour manipuler les ports série. 




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Port USB
<a name="port_usb_ELTTEXTE000306"></a>
La gestion d'un port USB ne dépend pas du port lui-même mais du périphérique qui lui est rattaché. Ainsi la gestion d'un port USB auquel est connecté une imprimante est différente de celle d'un port USB auquel est connecté un scanner. Aucune norme de gestion ne peut être définie.

Le port USB n'est pas un port passif comme le port série ou parallèle. Il est toujours assujetti à l'utilisation d'un driver spécifique du périphérique à utiliser.

Ce n'est donc pas le port USB qui est géré par WINDEV ou WEBDEV, mais le périphérique qui est installé sur ce port. Si le périphérique installé est :

- une imprimante, il est possible d'utiliser les fonctions d'impression.

- un scanner, il est possible d'utiliser les fonctions TWAIN,

- ...




Dans la plupart des cas, les appareils connectés à un port USB sont livrés avec un driver. Il est conseillé de manipuler directement ce driver depuis WINDEV.

WINDEV propose des [fonctions USB](../WDLang1/3090005.md) pour manipuler les éléments accessibles depuis un port USB.








- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Impressiondirecte.gif) ***Exemples unitaires (WINDEV)*** : **Impression directe** <br>Impression en direct sur une imprimante matricielle avec les fonctions WLangage.<br><br>Dans cet exemple, nous abordons les principaux thèmes suivants :<br>1/ les fonctions de gestion des ports de communications<br>2/ l'envoi de séquences à une imprimante.<br><br>Résumé de l'exemple livré avec WINDEV :	<br>Ce programme réalisé avec WINDEV permet d'imprimer directement sur l'imprimante matricielle connectée au port parallèle de votre choix. <br>Cet exemple utilise l'ordre du WLangage "sEcrit".<br>Dans le domaine des applications exploitant des caisses enregistreuses, cette fonctionnalité est très utile.<br>Cet exemple n'est pas adapté à l'utilisation d'une imprimante laser ; on préférera dans ce cas utiliser l'éditeur d'états de WINDEV.




