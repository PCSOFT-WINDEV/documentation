


## sEvénement (Fonction)

***En anglais : sEvent***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Branche un événement sur un port série.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Détection de caractères sur le port COM1
sEvénement(1, sEveCaractèreReçu, "LectureCaractère")
```

```wl
// -- Procédure LectureCaractère
PROCEDURE LectureCaractère(NumPort, NumEvénement)
Trace(sLit(1, sDansFileEntrée(1)))
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = sEvénement(<Numéro de port> , <Événement géré> , <Procédure WLangage>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la fonction a été exécutée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Si le port n'a pas été préalablement ouvert en mode "Gestion des événements" (avec la fonction [sOuvre](../WDLang3/3062013.md)), la fonction **sEvénement** n'a aucun effet.




**`<Numéro de port> : (Entier)`**



- Numéro de port série concerné (1, 2, 3, ...32 pour COM1, COM2, COM3, ... COM32). 

- Numéro de port renvoyé par la fonction [sOuvre](../WDLang3/3062013.md) (si cette fonction a été appelée avec un nom de port).




**`<Événement géré> : (Constante ou combinaison de constantes de type Entier)`**

Evénement à repérer sur le port :


|   |   |
| --- | --- |
| *sEveBreak*<br>(valeur : 64) | Réception d'un événement "Break line" |
| *sEveCaractèreReçu*<br>(valeur : 1) | Réception d'un caractère |
| *sEveCTS*<br>(valeur : 8) | Changement d'état CTS |
| *sEveDSR*<br>(valeur : 16) | Changement d'état DSR |
| *sEveEnvoiTerminé*<br>(valeur : 4) | Le buffer de sortie est vide |
| *sEveErreur* <br>(valeur : 128) | Détection d'une erreur sur la ligne<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *sEveErreurImprimante*<br>(valeur : 512) | Erreur d'imprimante détectée<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *sEveFileEntrée80*<br>(valeur : 1024) | Le buffer d'entrée est plein à 80%<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *sEveRing*<br>(valeur : 256) | Détection du signal "Ring" (sonnerie) |
| *sEveRLSD*<br>(valeur : 32) | Changement d'état RLSD<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |



**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure WLangage appelée chaque fois que l'événement spécifié est détecté. Cette procédure est de la forme :

```txt
PROCEDURE <Nom de la procédure>(<Numéro de port>, <Numéro de l'événement>)
```
où &lt;Numéro de port&gt; correspond au port où l'événement est survenu

où &lt;Numéro de l'événement&gt; correspond à une des constantes événement.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Détection des événements et threads
<a name="detection_des_evenements_threads_ELTPARAGRAPHE000151"></a>La détection des événements est réalisée dans un thread spécifique du WLangage. L'appel de la procédure WLangage est réalisé dans ce thread. Cette procédure est donc soumise aux limitations sur les threads (notamment au niveau de l'affichage).

Pour plus de détails sur la gestion des threads, consultez [Gestion des threads](../WDLang1/3077026.md).
<a name="NOTE0_2"></a>


### Gestion d'événements très rapprochés
<a name="gestion_evenements_tres_rapproches_ELTPARAGRAPHE000163"></a>Si au cours de la procédure déclenchée par l'événement, un autre événement se déclenche, ce dernier événement ne sera pas détecté. 

Si des événements très proches sont susceptibles de se déclencher, il est conseillé : 

- de lire uniquement les données de l'événement (avec la fonction [sLit](../WDLang3/3062012.md)) dans la procédure déclenchée par la fonction **sEvénement**, 

- d'effectuer la suite du traitement dans un autre thread.



<a name="NOTE0_3"></a>


### Débranchement d'un ou de plusieurs événements
<a name="debranchement_plusieurs_evenements_ELTPARAGRAPHE000181"></a>Pour débrancher la gestion d'un ou de plusieurs événements, utilisez la fonction [sFinEvénement](../WDLang3/3062008.md).
<a name="NOTE0_4"></a>


### Fermeture du port
<a name="fermeture_port_ELTPARAGRAPHE000191"></a>Lors de la fermeture du port, tous les événements gérés sur ce port sont débranchés. Lors de la ré-ouverture du port, il est donc nécessaire de ré-exécuter la fonction **sEvénement** pour définir les événements gérés sur ce port.
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Utilisation d'une librairie externe : RXTX
<a name="utilisation_une_librairie_externe_rxtx_ELTPARAGRAPHE000348"></a>En Java, l'utilisation des fonctions de manipulation des ports séries et parallèles (fonctions [sOuvre](../WDLang3/3062013.md), [sEcrit](../WDLang3/3062009.md), [sLit](../WDLang3/3062012.md), ...) nécessite la présence d'une librairie externe : RXTX. 

Cette librairie est composée d'une archive Jar et d'une ou plusieurs librairies natives dépendantes du système d'exploitation sur lequel s'exécute l'application.
 
Pour utiliser ces fonctions : 

- l'archive jar (RXTXComm.jar) doit : 

	- soit se trouver dans le même répertoire que l'application Java générée par WINDEV, 

	- soit se trouver dans le classpath d'exécution de l'application, 

	- soit être directement intégrée dans l'application générée (depuis l'assistant de génération Java). 




- la ou ou les librairies natives correspondant au système d'exploitation sur lequel s'exécute l'application doivent se trouver: 

	- soit  dans le même répertoire que l'application Java générée par WINDEV, 

	- soit dans le chemin des librairies de l'application (librarypath).







Il est possible de télécharger la librairie RXTX et sa documentation grâce au lien suivant : [http://users.frii.com/jarvi/rxtx/index.html](http://users.frii.com/jarvi/rxtx/index.html) (lien valide lors de l'écriture de cette documentation). 

**Attention** : La gestion des ports infrarouges n'est pas disponible en Java. 

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280com.dll
