


## WINDEV et les flux de communication (audio, son)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000226"></a>
Pour manipuler des flux de communication, WINDEV met à votre disposition :

- Le [champ Conférence](../WDChamp/1013062.md).

- Les [fonctions WLangage de gestion des flux](../WDLang3/3039004.md).




Il est ainsi possible de faire communiquer deux utilisateurs entre eux. L'image et la voix des utilisateurs sont retransmises en temps réel sur chaque poste connecté.

Exemples d'applications utilisant des flux :

- vidéo-conférence,

- retransmission d'une conférence de presse en direct, ...




**Limitations** :

- Le poste en cours et le ou les postes connectés doivent être équipés d'une Web caméra et/ou d'un micro. Si un des postes n'est pas équipé de Web caméra ou de micro, l'image ou la voix correspondante ne sera pas retransmise.

- Seules les séquences vidéos actuellement retransmises par les Web caméras installées sur les postes connectés peuvent être visualisées. Il n'est pas possible de visualiser un fichier vidéo.

- Seuls les sons actuellement retransmis par les micros installés sur les postes connectés peuvent être écoutés. Il n'est pas possible d'écouter un fichier son.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Principe d'utilisation
<a name="principe_utilisation_ELTTEXTE000250"></a>
Pour manipuler des flux de communication :

1. Créez une fenêtre contenant un ou plusieurs champs Conférence. Sous le volet "Création", dans le groupe "Champs graphiques", déroulez "Vidéo et capture" et sélectionnez "Conférence".

2. Affichez la fenêtre de description des flux : 

	- sous le volet "Fenêtre", dans le groupe "Edition", déroulez "Autres actions" et sélectionnez "Editer les flux".

	- dans le menu contextuel du champ Conférence, sélectionnez l'option "Editer les flux de la fenêtre".




3. Dans cette fenêtre :

	- Paramétrez les caractéristiques de(s) champ(s) Conférence : type de données émises et reçues, affichage de la vidéo envoyée ou reçue, ...
			**Remarque** : Ces caractéristiques peuvent également être paramétrées par programmation (propriétés [Affichage](../Proprietes/2510010.md), [Émission](../Proprietes/2510037.md), [Identifiant](../Proprietes/2510036.md) et [Réception](../Proprietes/2510117.md)).

	- Associez si nécessaire les différents champs Conférence aux flux de communication correspondants.

	- Activez la détection des flux entrants (propriété [Détection](../Proprietes/2510031.md) ou option "Détection des flux entrants actif" dans la fenêtre de description des flux).




4. Par programmation :

	- Connectez le flux à une adresse spécifique (fonction [FluxConnecte](../WDLang3/3039008.md) ou propriété [Adresse](../Proprietes/2510017.md)).

	- Acceptez ou non le flux entrant (fonction [FluxAccepte](../WDLang3/3039003.md) ou fonction [FluxRefuse](../WDLang3/3039006.md)).

	- Terminez la réception ou l'émission du flux (fonction [FluxDéconnecte](../WDLang3/3039007.md)).






<a name="NOTE2_2"></a>


### Remarques
<a name="remarques_ELTPARAGRAPHE000117"></a>

- Il est également possible d'arrêter momentanément la réception ou l'émission d'un type de données (son ou vidéo) dans le flux de communication (fonction [FluxStop](../WDLang3/3039002.md)). Pour reprendre la réception ou l'émission de ce type de données dans le flux, utilisez la fonction [FluxJoue](../WDLang3/3039010.md).

- Chaque tentative de connexion d'un flux (fonction [FluxConnecte](../WDLang3/3039008.md) ou propriété [Adresse](../Proprietes/2510017.md)) utilise un délai maximum de connexion. Pour connaître et/ou modifier ce délai, utilisez la propriété [DuréeNonRéponse](../Proprietes/2510052.md).




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Utilisation en réseau via Internet
<a name="utilisation_reseau_via_internet_ELTTEXTE000280"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000143"></a>Les champs Conférence peuvent être utilisés entre deux postes : 

- dans un même réseau local : aucune configuration spécifique n'est nécessaire. 

- via Internet. Dans ce cas, un paramétrage spécifique doit être effectué avant d'utiliser les fonctions FluxXXX. 





### Pré-requis
<a name="prerequis_ELTPARAGRAPHE000151"></a>L'utilisation de champs Conférence dans un réseau privé différent via Internet utilise la technologie WebRTC. Cette technologie nécessite l'utilisation d'un serveur STUN et d'un serveur TURN.

Ces serveurs doivent être correctement configurés.  

Remarques : 

- Il est possible de trouver des serveurs STUN gratuits.

- Les serveurs TURN directement utilisables sont payants. 
	Il est possible d'obtenir les sources d'un serveur TURN gratuitement. Dans ce cas, il est nécessaire de les recompiler puis de déployer le serveur (des compétences avancées dans le langage de programmation du serveur TURN sont nécessaires pour effectuer ces opérations).





### Configuration
<a name="configuration_ELTPARAGRAPHE000165"></a>Pour utiliser des champs Conférence via Internet : 

1. Ouvrez les ports suivants dans le firewall : 

	- TCP 29172 : Ce port est spécifique à WINDEV et doit être ouvert en entrée et sortie. Ce port doit être "lié" à la machine effectuant la visioconférence.

	- Selon le paramétrage du firewall, il peut être également nécessaire d'ouvrir le port UDP 3478 : Ce port est utilisé par le serveur TURN pour le relais des frames audio et vidéo. 




2. Configurez les serveurs STUN et/ou TURN via la fonction [FluxConfigure](../WDLang3/1000021645.md) avant d'ouvrir la fenêtre contenant les champs Conférence. Par exemple : 
	
	```wl
	FluxConfigure("stun.l.google.com:19302", "monserveurturn.org", "user87", "Secret_87")
	Ouvre(FEN_VideoConférenceInternet)
	```






- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampConference.gif) ***Exemples unitaires (WINDEV)*** : **Le champ Conférence** <br>Utilisation du champ "Conférence" :<br>- Réaliser la connexion avec un autre utilisateur<br>- Communiquer (image et son) avec un autre utilisateur via réseau<br>- Fermer une connexion
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDVisioconference.gif) ***Exemples complets (WINDEV)*** : **WD Visioconférence** <br>Cet exemple utilise le champ Conférence et illustre aussi l'utilisation des sockets grâce à une messagerie instantanée.<br>WD VisioConférence permet d'entrer en conférence (son + vidéo) avec un utilisateur distant. De plus grâce à la messagerie instantanée, vous avez la possibilité d'envoyer un fichier à votre correspondant et de dialoguer simplement avec lui.


