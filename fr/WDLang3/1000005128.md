


## NotesVueCherchePremier (Fonction)

***En anglais : NotesViewSeekFirst***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Recherche le premier document présent dans la vue en cours dans Lotus Notes. Cette recherche s'effectue uniquement dans les colonnes triables de la vue en cours.

La recherche est effectuée en faisant correspondre chaque valeur spécifiée à la valeur présente dans la colonne triable correspondante. Le document trouvé correspond au document ayant toutes les valeurs spécifiées.

La vue en cours a été spécifiée à l'aide de la fonction [NotesActiveVue](../WDLang3/1000005118.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ouverture de la connexion
IDConnexion est un entier
IDConnexion = NotesOuvreConnexion("MotDePasse", "ServeurMars", ...
		"C:\Users\Julie\AppData\Local\Lotus\Notes\Data\user.id")
// Spécification de la base Lotus Notes à utiliser
IDBase est un entier
IDBase = NotesOuvreBase(IDConnexion, "julie.nsf")
...
// Activation de la vue
NotesActiveVue(IDBase, "MesClients")
// Cette vue contient les colonnes "Nom", "Prénom", "Age" et "Ville"
// Seules les colonnes "Nom", "Prénom" et "Ville" sont triables
// Recherche dans cette vue des personnes dont le nom commence par "Mar",
// le prénom par "Jean" et la ville par "Saint"
NotesVueCherchePremier(IDBase, notesCommencePar, "Mar", "Jean", "Saint")
// Parcours des personnes trouvées
TANTQUE NotesEnDehors(IDBase) = Faux
	...   
	// Traitements
	NotesDocumentSuivant(IDBase)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = NotesVueCherchePremier(<Identifiant de la session> , <Mode de recherche> , <Valeur recherchée 1> [, <Valeur recherchée 2> [... [, <Valeur recherchée N>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la recherche a bien été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Identifiant de la session> : (Entier)`**

Identifiant de la session à utiliser. Cet identifiant est renvoyé par la fonction [EmailOuvreSessionNotes](../WDLang3/3032121.md) ou [NotesOuvreBase](../WDLang3/1000005101.md).

**`<Mode de recherche> : (Constante de type entier)`**

Mode de recherche à effectuer :


|   |   |
| --- | --- |
| *notesCommencePar* | Recherche de type "Commence par".<br>Cette constante est disponible uniquement sur les colonnes de type chaîne. |
| *notesEgal* | Recherche de type "Identique". |
| *notesInférieur* | Recherche de type "Strictement inférieur à". |
| *notesInférieurOuEgal* | Recherche de type "Inférieur ou égal à". |
| *notesSupérieur* | Recherche de type "Strictement supérieur à". |
| *notesSupérieurOuEgal* | Recherche de type "Supérieur ou égal à". |


Pour les colonnes de type chaîne, la recherche ignore toujours la casse et l'accentuation.

**`<Valeur recherchée 1> : (Type de la colonne dans laquelle la recherche est effectuée)`**

Valeur recherchée dans la 1ère colonne triable rencontrée.
Cette valeur est automatiquement convertie dans le type de la colonne en cours (Texte, Nombre ou DateHeure).
Pour les colonnes de type DateHeure, si la valeur recherchée correspond à une chaîne de caractères, cette chaîne doit utiliser le format "AAAAMMJJ", "AAAAMMJJHHMMSS" ou "AAAAMMJJHHMMSSccc".

**`<Valeur recherchée 2> : (Type de la colonne dans laquelle la recherche est effectuée (optionnel))`**

Valeur recherchée dans la seconde colonne triable rencontrée.
Cette valeur est automatiquement convertie dans le type de la colonne en cours (Texte, Nombre ou DateHeure).
Pour les colonnes de type DateHeure, si la valeur recherchée correspond à une chaîne de caractères, cette chaîne doit utiliser le format "AAAAMMJJ", "AAAAMMJJHHMMSS" ou "AAAAMMJJHHMMSSccc".



**`<Valeur recherchée N> : (Type de la colonne dans laquelle la recherche est effectuée (optionnel))`**

Valeur recherchée dans la Nème colonne triable rencontrée.
Cette valeur est automatiquement convertie dans le type de la colonne en cours (Texte, Nombre ou DateHeure).
Pour les colonnes de type DateHeure, si la valeur recherchée correspond à une chaîne de caractères, cette chaîne doit utiliser le format "AAAAMMJJ", "AAAAMMJJHHMMSS" ou "AAAAMMJJHHMMSSccc".



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Recherche dans les colonnes d'une vue
<a name="recherche_dans_les_colonnes_une_vue_ELTPARAGRAPHE000112"></a>Une vue possède une ou plusieurs colonnes triables. La recherche réalisée grâce à la fonction **NotesVueCherchePremier** s'effectue uniquement dans les colonnes triables de la vue en cours. Il n'est pas possible d'effectuer de recherche sur une colonne non-triable. Il n'est pas non plus possible de sauter une colonne triable.

Par exemple :

- la vue "A" possède les colonnes 1, 2 et 3. Ces trois colonnes sont triables. Il est possible d'effectuer une recherche sur la colonne 1, sur les colonnes 1 et 2 ou 1, 2 et 3. Mais il n'est pas possible d'effectuer une recherche sur les colonnes 1 et 3 ou uniquement sur la colonne 2 ou sur la colonne 3.

- la vue "B" possède les colonnes 1, 2 et 3. Seules les colonnes 1 et 3 sont triables. Il est possible d'effectuer une recherche sur la colonne 1 ou sur les colonnes 1 et 3. Mais il n'est pas possible d'effectuer une recherche sur les colonnes 1 et 2 ou 1, 2 et 3 ou uniquement sur la colonne 2 ou sur la colonne 3.



<a name="NOTE0_2"></a>


### Colonnes de type DateHeure
<a name="colonnes_type_dateheure_ELTPARAGRAPHE000127"></a>Les recherches de type "Identique" (constante *notesEgal*) effectuées dans les colonnes de type DateHeure peuvent être erronées. En effet, la précision de la valeur stockée par la colonne peut être supérieure à la précision de la valeur recherchée.

<a name="XComposante"></a>

## Composante :
wd280mess.dll
