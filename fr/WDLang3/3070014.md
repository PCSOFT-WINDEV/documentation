
## SocketLit (Fonction)

***En anglais : SocketRead***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère un message envoyé par un autre socket. Cette fonction peut être utilisée sur un poste client ou un poste serveur.

Remarques :

- **Socket UDP** : Le protocole UDP étant un protocole "Non connecté", lors de la récupération du message, WINDEV enregistre l'adresse IP et le port de la machine qui a envoyé le message. Ces informations sont disponibles avec la fonction [SocketClientInfo](../WDLang3/3070009.md). 

- **Socket SSL** : La fonction **SocketLit** peut être utilisée avec les sockets SSL.




**Rappel** : Un socket est une ressource de communication utilisée par les applications pour communiquer d'une machine à une autre sans se soucier du type de réseau.






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003070014&name=socketlit_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Ajout des messages reçus dans un champ Table
TableAjoute(TABLE_Table1, "1" + TAB + SocketLit("Serveur", Faux) + ...
		TAB + SocketClientInfo("serveur", SocketAdresse) + ...
		TAB + SocketClientInfo("serveur", SocketPort))
```


<a name="Exemple3"></a>



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = SocketLit(<Nom du socket> [, <Attente indéfinie> [, <Attente maximale> [, <Nombre maximum d'octets>]]])`
---

**`<Résultat> : (Buffer ou chaîne de caractères)`**



- Message lu. 

- Buffer vide ou chaîne vide ("") si aucun message n'a été reçu.




**`<Nom du socket> : (Chaîne de caractères)`**

Nom du socket qui a reçu le message. 

Dans des applications WINDEV : 

- ce nom a été défini sur le serveur :

	- soit par la fonction [SocketCrée](../WDLang3/3070011.md) ou la fonction [SocketCréeInfraRouge](../WDLang3/3070012.md) (cas d'un serveur simplifié).

	- soit par la fonction [SocketAccepte](../WDLang3/3070004.md) (cas d'un serveur standard).




- ce nom a été défini sur le client par la fonction [SocketConnecte](../WDLang3/3070016.md) ou la fonction [SocketConnecteInfraRouge](../WDLang3/3070018.md).




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Attention : le nom du socket est "case-sensitive".

**`<Attente indéfinie> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> (valeur par défaut) : attente indéfinie d'un message de client.

- <u><u><u><u>Faux</u></u></u></u> : attente jusqu'à l'&lt;Attente maximale&gt;.




**`<Attente maximale> : (Entier optionnel ou Durée optionnelle)`**

Attente maximale (en millisecondes) d'un message de client si l'attente indéfinie est à <u><u><u><u>Faux</u></u></u></u>. Ce paramètre peut correspondre à : 

- un entier correspondant au nombre de millisecondes, 

- une variable de type Durée, 

- l'indication directe de la durée (par exemple 1 s ou 10 ms). 


Par défaut, cette attente est égale à 1000 millisecondes (1 seconde).

**`<Nombre maximum d'octets> : (Entier optionnel)`**

Nombre maximum de caractères pouvant être transmis. Le nombre de caractères reçus n'est pas garanti.

Ce paramètre est pris en compte uniquement si la constante *SocketSansMarqueurFin* est spécifiée dans la fonction [SocketChangeModeTransmission](../WDLang3/3070005.md). Dans le cas contraire, ce paramètre est ignoré.

Par défaut, ce paramètre correspond à 4096 octets.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Nombre d'octets transmis
<a name="nombre_octets_transmis_ELTPARAGRAPHE000149"></a>Le paramètre &lt;Nombre maximum d'octets&gt; correspond au nombre maximum de caractères pouvant être transmis. Le nombre de caractères reçus n'est pas garanti.

La fonction **SocketLit** lit une trame réseau et la retourne immédiatement, sans transformation. Or la taille d'une trame réseau dépend de nombreux facteurs (paramétrage du réseau, vitesse et encombrement du réseau, ...).

La fonction [SocketEcrit](../WDLang3/3070002.md) envoie si possible le buffer passé en paramètre en une seule trame. Mais si le réseau n'accepte pas cette trame, le buffer peut être découpé en plusieurs trames (ou à l'inverse, le réseau peut fusionner des messages en une seule trame pour optimiser la bande passante).

Pour s'assurer de l'intégrité des messages transmis, il est nécessaire d'utiliser un protocole natif WINDEV et WEBDEV (avec les constantes *SocketTailleDébut* et *SocketMarqueurFin* de la fonction [SocketChangeModeTransmission](../WDLang3/3070005.md)) ou d'implémenter un protocole spécifique.
<a name="NOTE0_2"></a>


### Communication avec des automates ou des applications non WINDEV
<a name="communication_avec_des_automates_des_applications_non_windev_ELTPARAGRAPHE000171"></a>Pour simplifier les échanges des données par socket, un mode de transmission est initialisé par défaut. 

Dans le cas d'une communication avec un module externe (application non WINDEV, automate, ...), ce mode de transmission peut empêcher le bon fonctionnement des communications. 

La fonction [SocketChangeModeTransmission](../WDLang3/3070005.md) permet de changer ce mode de transmission : la constante *SocketSansMarqueurFin* permet de ne pas modifier les trames lues et écrites.
<a name="NOTE0_3"></a>


### Transmission entre deux postes utilisant des formats de chaînes de caractères différents (UNICODE et ANSI)
<a name="transmission_entre_deux_postes_utilisant_des_formats_chaines_caracteres_differents_unicode_ansi_ELTPARAGRAPHE000185"></a>Lors de la transmission de messages entre deux postes utilisant un format de chaînes de caractères différent (par exemple ANSI et UNICODE), certaines conversions peuvent être nécessaires. Ces conversions peuvent être effectuées grâce aux fonctions [AnsiVersUnicode](../WDLang1/3024002.md) et [UnicodeVersAnsi](../WDLang1/3024025.md). 



<a name="XComposante"></a>

## Composante :
wd280com.dll
