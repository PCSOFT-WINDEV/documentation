
## DotNetDonneRésultat (Fonction)

***En anglais : DotNetGetResult***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie le résultat de la dernière procédure DotNet exécutée avec succès.

**Remarque** : Cette procédure a été exécutée par la fonction [DotNetExécute](../WDLang3/3031016.md) ou [DotNetExécuteXML](../WDLang3/3031012.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Cet exemple est basé sur la présence du module eightball sur le site "www.gotdotnet.com". 
// Si le module n'était plus disponible sur le site, l'exemple ne fonctionnerait plus
DotNet.Valeur[1] = "mettre ici une question, en anglais de préférence" + ...
	"pour le fun de l'exemple : que pourra-t-on nous répondre ?"
DotNet.Nom[1] = "psQuestion"
DotNet.Type[1] = DotNetTypeChaîne
SI DotNetExécute("www.gotdotnet.com/playground/services/EightBall/eightballws.asmx", ...
		"Ask", "http://tempuri.org/", "http://tempuri.org/Ask") = Vrai ALORS
	Info(DotNetDonneRésultat(DotNetRésultat))
SINON
	SI DotNetErreur(DotNetErrMessage) ~= "" ALORS
		Erreur(ErreurInfo()) 
	SINON
		Erreur("Erreur DotNet : " + DotNetErreur(DotNetErrMessage))
	FIN
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = DotNetDonneRésultat(<Type de résultat> [, <Numéro du résultat>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Résultat de la dernière procédure DotNet exécutée avec succès.

- Si plusieurs résultats sont retournés par le serveur et si la constante *DotNetRésultat* est utilisée :

	- résultat &lt;Numéro du résultat&gt;,

	- premier résultat retourné si le paramètre &lt;Numéro du résultat&gt; n'est pas spécifié.




- Une chaîne vide ("") si :

	- aucun résultat n'a été retourné par le serveur,

	- aucune liaison n'a été établie avec le serveur.







**`<Type de résultat> : (Constante)`**

Type de résultat à retourner :



|   |   |
| --- | --- |
| *DotNetRésultat* | Résultat de la dernière procédure DotNet exécutée. |
| *DotNetRésultatHTTP* | Résultat sous forme HTTP de la dernière procédure DotNet exécutée. |
| *DotNetRésultatXML* | Résultat sous forme XML de la dernière procédure DotNet exécutée. |



**`<Numéro du résultat> : (Entier optionnel)`**

Numéro du résultat à retourner. Ce paramètre est utilisé uniquement si plusieurs résultats sont retournés par le serveur et si la constante *DotNetRésultat* est spécifiée. Dans le cas contraire, ce paramètre est ignoré.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Les différents types de résultats
<a name="les_differents_types_resultats_ELTPARAGRAPHE000067"></a>Une même procédure exécutée sur un serveur peut renvoyer trois types de résultats.

Considérons l'exemple suivant :
La procédure "getTemp" (qui permet de connaître la température d'une ville) a été exécutée. Les types de résultats retournés par la fonction **DotNetDonneRésultat** sont les suivants :

- Avec la constante *DotNetRésultat* : 37

- Avec la constante *DotNetRésultatHTTP* :
	
	```txt
	HTTP/1.1 200 OK
	Date: Mon, 09 Jul 2001 09:34:49 GMT
	Status: 200
	Set-Cookie2: JSESSIONID=To16135mC022383577812008837At;Version=1;Discard;Path="/soap"
	Servlet-Engine: Tomcat Web Server/3.1 (JSP 1.1; Servlet 2.2; Java 1.3.0; 
	Linux 2.2.19-6.2.1.2RS x86; java.vendor=IBM Corporation)
	Set-Cookie: JSESSIONID=To16135mC022383577812008837At;Path=/soap
	Content-Type: text/xml; charset=utf-8
	Content-Length: 467
	Content-Language: en
	<?xml version='1.0' encoding='UTF-8'?>
	<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" 
	xmlns:xsi="http://www.w3.org/1999/XMLSchema-instance" 
	xmlns:xsd="http://www.w3.org/1999/XMLSchema">
	<SOAP-ENV:Body>
	<ns1:getTempResponse xmlns:ns1="urn:xmethods-Temperature" 
	SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
	<return xsi:type="xsd:float">'''37.0'''</return>
	</ns1:getTempResponse>
	</SOAP-ENV:Body>
	</SOAP-ENV:Envelope>
	```


- Avec la constante *DotNetRésultatXML* : 
	
	```txt
	<?xml version='1.0' encoding='UTF-8'?>
	<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" 
	xmlns:xsi="http://www.w3.org/1999/XMLSchema-instance" 
	xmlns:xsd="http://www.w3.org/1999/XMLSchema">
	<SOAP-ENV:Body>
	<ns1:getTempResponse xmlns:ns1="urn:xmethods-Temperature" 
	SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
	<return xsi:type="xsd:float">'''37.0'''</return>
	</ns1:getTempResponse>
	</SOAP-ENV:Body>
	</SOAP-ENV:Envelope>
	```





<a name="XComposante"></a>

## Composante :
wd280com.dll
