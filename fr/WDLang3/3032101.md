
## Structure LDAPSession
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000146"></a>
La structure **LDAPSession** est une structure prédéfinie du WLangage (aucune déclaration n'est nécessaire). Cette structure permet de définir les caractéristiques d'une session LDAP.

**Remarque** : Pour ré-initialiser toutes les variables de la structure **LDAPSession** avec les valeurs par défaut, utilisez la fonction [LDAPRAZ](../WDLang3/3032103.md).



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Les différents membres de la structure LDAPSession
<a name="les_differents_membres_structure_ldapsession_ELTTEXTE000170"></a>
La structure est composée des membres suivants :


|   |   |
| --- | --- |
| Hôte | Chaîne de caractères.<br>Adresse du serveur :<br><br>- Adresse IP du poste serveur au format xxx.xxx.xxx.xxx<br><br>- Nom du poste serveur<br><br><br> |
| MotDePasse | Chaîne de caractères.<br>Mot de passe associé à l'utilisateur. Par défaut, correspond à une chaîne vide (""). |
| Option | Constante de type Entier<br>Mode de gestion du SSL : <br><br>- *ldapOptionDéfaut* : LDAP classique, sans gestion du SSL.<br><br>- *optionSSL* : LDAP avec gestion d'une connexion sécurisée SSL. <br><br>- *optionSSL* + *auNegotiate* : LDAP avec gestion d'une connexion sécurisée SSL et authentification : <br><br>	- Si le login n'est pas précisé, le login de connexion de Windows est utilisé. <br><br>	- Si le login et le mot de passe sont précisés, la connexion est effectuée via "Generic Security Services" (GSS) (Snego). La méthode d'authentification choisie est la méthode la plus appropriée présente dans une liste des authentifications possibles.<br><br><br><br><br><br><br><br>Remarque : Le mode de connexion utilisé doit être supporté par le serveur LDAP. |
| Port | Entier.<br>Port du serveur (389 par défaut). |
| Utilisateur | Chaîne de caractères.<br>Authentification de l'utilisateur. Cette chaîne peut correspondre à tout mode d'identification reconnu par le serveur. Par défaut, correspond à une chaîne vide (""). |
| Version | Entier<br>Version du serveur LDAP contacté (2 ou 3). Par défaut, correspond à 3. |







## Remarques
<a name="remarques_ELTTEXTE000194"></a>
Pour effectuer des connexions LDAP sécurisées (LDAP over SSL), il est nécessaire de :

- Modifier le numéro de part de la structure LDAPSession : 636 par défaut

- Installer le certificat de l'autorité de confiance qui a signé le certificat du serveur sur le poste où est appelé la fonction [LDAPConnecte](../WDLang3/3032100.md).

- Utiliser le même nom d'hôte que celui du certificat SSL installé sur le serveur.












## Exemple
<a name="exemple_ELTTEXTE000218"></a>
Exemple de connexion au serveur : 


```wl
// Initialisation
LDAPRAZ()
LDAPSession.Hôte = "domaine.local"
LDAPSession.Port = 389
LDAPSession.Version = 3
LDAPSession.Utilisateur = "user@domaine.local"
LDAPSession.MotDePasse = "mdp"
LDAPSession.Option = ldapOptionDéfaut
// Interrupteur permettant de choisir la connexion sécurisée SSL
SI INT_Options[1] = Vrai ALORS
	LDAPSession.Option += optionSSL
FIN
// Interrupteur permettant de choisir le mode "Negotiate"
SI INT_Options[2] = Vrai
	LDAPSession.Option += auNegotiate
FIN

// Connexion
LDAPConnecte("MaSession")
```





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LesfonctionsLDAP.gif) ***Exemples unitaires (WINDEV)*** : **Les fonctions LDAP** <br>Utilisation des fonctions LDAP du WLangage.<br>Ces fonctions permettent d'interagir totalement avec les données LDAP, de visualiser le contenu de tout annuaire LDAP et également de modifier les données LDAP : LDAPConnecte, LDAPListeFils, LDAPAjouteAttribut, LDAPSupprimeValeurAttribut,...


