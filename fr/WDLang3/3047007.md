
## J2EEExécute (Fonction)

***En anglais : J2EERun***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Exécute une procédure sur un serveur de services Web XML J2EE.

**Remarque** : Les paramètres de la procédure doivent être spécifiés avant l'utilisation de la fonction **J2EEExécute** grâce à la structure J2EE (voir Notes).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Cet exemple est basé sur la présence du module Text2Image Webservice
// sur le site dwdemos.alphaworks.ibm.com. 
// Si le module n'était plus disponible sur le site, 
// l'exemple ne fonctionnerait plus
// Paramètres à passer au service
// Largeur de l'image
J2EE.Valeur[1] = SAI_LARGEUR
J2EE.Nom[1] = "ImageWidth"
J2EE.Type[1] = J2EETypeEntier
...
// Interrogation du Webservice sur le serveur Web
SI J2EEExécute(...
	"http://dwdemos.alphaworks.ibm.com:8085/soap/servlet/rpcrouter", ...
	"createImage", "urn:text2image", ...
	"http://alphaworks.ibm.com/alphabeans/text2image/createImage/") ALORS
	// Le résultat est une image, on en fait un fichier temporaire
	nIDFic est un entier
	nIDFic = fOuvre(fRepExe() + "\temp.gif", foCréation)
	fEcrit(nIDFic, J2EEDonneRésultat(J2EERésultat))
	fFerme(nIDFic)
	// Affichage
	IMG_GEN = ""
	IMG_GEN = fRepExe() + "\temp.gif"
	// Suppression du fichier temporaire
	fSupprime(IMG_GEN)
SINON
	// Si le service ne retourne pas d'erreur (ex : Serveur inaccessible)
	SI J2EEErreur(J2EEerrMessage) ~= "" ALORS
		Erreur(ErreurInfo()) 
		// Si le service a retourné une erreur (erreur du service)
	SINON
		Erreur("Erreur J2EE : " + J2EEErreur(J2EEerrMessage))
	FIN
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = J2EEExécute(<URL du serveur> , <Nom de la procédure> [, <Espace de nommage de la procédure> [, <Action de la procédure> [, <Style d'encodage>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la communication avec le serveur a été établie, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire (aucune communication n'a été établie). Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<URL du serveur> : (Chaîne de caractère)`**

URL du serveur à contacter. Ce paramètre est fourni dans la documentation du serveur de services Web XML J2EE et de ses procédures.

**`<Nom de la procédure> : (Chaîne de caractères)`**

Nom de la procédure à exécuter sur le serveur spécifié. Ce paramètre est fourni dans la documentation du serveur de services Web XML J2EE et de ses procédures.
Attention à respecter la casse (Majuscules / Minuscules) du nom de la procédure.

**`<Espace de nommage de la procédure> : (Chaîne de caractères optionnelle)`**

Espace de nommage (appelé aussi "NameSpace") de la procédure à exécuter. Ce paramètre est fourni dans la documentation du serveur de services Web XML J2EE et de ses procédures.

**`<Action de la procédure> : (Chaîne de caractères optionnelle)`**

Action de la procédure (appelé aussi "J2EEAction"). Ce paramètre est fourni dans la documentation du serveur de services Web XML J2EE et de ses procédures.

**`<Style d'encodage> : (Chaîne de caractères optionnelle)`**

Style d'encodage de la procédure (appelé aussi "EncodingStyle"). Ce paramètre est fourni dans la documentation du serveur de services Web XML J2EE et de ses procédures.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Paramètres de la procédure à exécuter
<a name="parametres_procedure_executer_ELTPARAGRAPHE000060"></a>Pour passer des paramètres à une procédure exécutée sur un serveur de services Web XML J2EE, WINDEV utilise la structure suivante :

| Variable | Type | Détail |
| --- | --- | --- |
| J2EE.NameSpace | Chaîne de caractères optionnelle | Espace de nommage (appelé "NameSpace") du paramètre. |
| J2EE.Nom | Chaîne de caractères | Nom du paramètre. |
| J2EE.ParamXML | Chaîne de caractères optionnelle | Description complète du paramètre sous forme XML. Si ce paramètre est spécifié, les autres paramètres (Valeur, Nom, Type, NameSpace et StyleEncodage) sont ignorés. |
| J2EE.StyleEncodage | Chaîne de caractères optionnelle | Style d'encodage (appelé "EncodingStyle") du paramètre. |
| J2EE.Type | Constante | Type du paramètre |
| J2EE.Valeur | Tout type | Valeur du paramètre. |


Cette structure doit être utilisée pour chaque paramètre. Par exemple :

```txt
J2EE.Valeur[1] = 94010
J2EE.Nom[1] = "CodePostal"
J2EE.Type[1] = J2EETypeChaîne
```


Cette structure est équivalente à :

```txt
J2EE.ParamXML[1] = <CodePostal xsi:type="xsd:string">94010</CodePostal>
```

<a name="NOTE0_2"></a>




### Type du paramètre
<a name="type_parametre_ELTPARAGRAPHE000119"></a>Le type du paramètre peut être :

| Constante | Type |
| --- | --- |
| *J2EETypeBinaireBase64* | Binaire |
| *J2EETypeBinaireHexa* | Binaire hexadecimal |
| J2EETypeBooléen | Booléen |
| *J2EETypeChaîne* | Chaîne de caractères |
| *J2EETypeChaîneNormalisée* | Chaîne de caractères sans retour chariot (RC) et sans tabulation (TAB) |
| *J2EETypeDécimal* | Tout nombre sans limite |
| *J2EETypeEntier* | Entier compris entre - 2 147 483 648 et + 2 147 483 647 |
| *J2EETypeEntierCourt* | Entier court |
| *J2EETypeEntierCourtNonSigné* | Entier court non signé |
| *J2EETypeEntierIllimité* | Entier (sans limite) |
| *J2EETypeEntierLong* | Entier long |
| *J2EETypeEntierLongNonSigné* | Entier long non signé |
| *J2EETypeEntierNégatif* | Entier négatif (sauf 0) |
| *J2EETypeEntierNonNégatif* | Entier non négatif |
| *J2EETypeEntierNonPositif* | Entier non positif |
| *J2EETypeEntierNonSigné* | Entier non signé |
| *J2EETypeEntierPositif* | Entier positif (sans 0) |
| *J2EETypeOctet* | Octet |
| *J2EETypeOctetNonSigné* | Octet non signé |
| *J2EETypeRéel* | Réel |
| *J2EETypeRéelDouble* | Réel double |
| *J2EETypeURL* | Adresse URL |




<a name="NOTE0_3"></a>




### Appel de la fonction J2EEExécute
<a name="appel_fonction_j2eeexecute_ELTPARAGRAPHE000221"></a>Après l'appel de la fonction **J2EEExécute** :

- Les paramètres de la procédure sont effacés.

- La structure de l'entête spécifié avec la fonction [J2EEAjouteEntête](../WDLang3/3047001.md) est effacée.

- La fonction [J2EEDonneRésultat](../WDLang3/3047003.md) permet de récupérer le résultat de la procédure exécutée.

- La fonction [J2EEErreur](../WDLang3/3047010.md) permet de récupérer le message d'erreur de la procédure exécutée.






<a name="XComposante"></a>

## Composante :
wd280com.dll
