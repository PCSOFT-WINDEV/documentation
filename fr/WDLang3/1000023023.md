


## mqttSession (Type de variable)

***En anglais : mqttSession***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **mqttSession** permet de définir tous les paramètres de connexion au Broker MQTT. Ces paramètres de connexion peuvent être définis et modifiés à l'aide de différentes propriétés WLangage. 

**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Déclaration de la connexion MQTT
gMqttSession est un mqttSession

// Récupère les données saisies dans la fenêtre de connexion
gMqttSession.Adresse = SAI_Adresse_Broker
gMqttSession.Port = SAI_Port
gMqttSession.Option = INT_SSL
gMqttSession.TimeoutConnexion = SAI_Timeout_Connexion
gMqttSession.Utilisateur = SAI_Login
gMqttSession.MotDePasseUtilisateur = SAI_PSW
gMqttSession.CléPrivée = SAI_Clé_Privée
gMqttSession.MotDePasseCléPrivée = SAI_PSW_Clé_Privée
gMqttSession.IDClient = SAI_IDClient
gMqttSession.SessionVide = INT_Session_Vierge
SI MQTTConnecte(gMqttSession) ALORS
	Message("Connexion OK")
SINON	
	Erreur("Problème de connexion. '" + ErreurInfo() + "')")
FIN
```

<a name="NOTE0"></a>

## Remarques
<a name="NOTE0_1"></a>


### Propriétés spécifiques à la description des variables de type mqttSession
<a name="proprietes_specifiques_description_des_variables_type_mqttsession_ELTPARAGRAPHE000047"></a>Les propriétés suivantes peuvent être utilisées pour manipuler une session MQTT :

| Nom de la propriété | Type manipulé | Effet |
| --- | --- | --- |
| Adresse | Chaîne de caractères | Adresse du serveur MQTT (également appelé "Broker MQTT"). Cette adresse peut être donnée sous la forme :<br><br>- Adresse IP au format XXX.XXX.XXX.XXX ( par exemple, 125.5.110.100).<br><br>- Adresse IP contenant le nom du serveur (par exemple, ServeurMQTT). Cette syntaxe est conseillée.<br><br><br> |
| CléPrivée | Chaîne de caractères ou variable de type [Certificat](../WDLang1/1000019287.md) | Nom de la variable de type [Certificat](../WDLang1/1000019287.md) ou chemin du fichier de clés pem (pour réaliser une connexion par clé privée). <br><br>Si cette propriété est renseignée, une authentification par clé est réalisée : seules les propriétés **Utilisateur**, **CléPrivée** et **MotDePasseCléPrivée** sont prises en compte. |
| IDClient | Chaîne de caractères | Identifiant du client. Cette propriété ne doit pas être vide. |
| MotDePasseCléPrivée | Chaîne de caractères | Mot de passe du fichier de clés (dans le cas d'une connexion par clé privée). La propriété **CléPrivée** correspond à la clé privée à utiliser. |
| MotDePasseUtilisateur | Chaîne de caractères | Mot de passe de l'utilisateur utilisé dans le cadre d'une authentification par mot de passe (la propriété **Utilisateur** correspond au nom de l'utilisateur). |
| Option | Constante de type Entier | Options de connexion. Cette propriété peut correspondre à la constante *optionSSL* pour une connexion de type SSL. |
| Port | Entier | Port du serveur MQTT. Par défaut, ce port correspond à 1883 (ou 8883 dans le cas d'une connexion SSL). |
| SessionVide | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> si il est nécessaire de vider les paramètres globaux génériques sur le serveur,<br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. <br><br><br> |
| TimeoutConnexion | Entier ou Durée | Délai de connexion en secondes. Cette propriété peut correspondre à : <br><br>- un entier correspondant au nombre de secondes, <br><br>- une variable de type Durée, <br><br>- l'indication directe de la durée (par exemple 10 s). <br><br><br> |
| Utilisateur | Chaîne de caractères | Nom de l'utilisateur. |




<a name="NOTE0_2"></a>


### Mode d'authentification
<a name="mode_authentification_ELTPARAGRAPHE000147"></a>L'authentification par clé est prioritaire sur l'authentification par mot de passe. 

L'authentification par clé est tentée si : 

- le serveur supporte ce mode d'authentification. 

- la propriété **CléPrivée** est renseignée. 




L'authentification par mot de passe est tentée si : 

- le serveur supporte ce mode d'authentification. 

- la propriété **MotDePasseUtilisateur** est renseignée. 



<a name="NOTE0_3"></a>


### Fonctions manipulant les variables de type mqttSession
<a name="fonctions_manipulant_les_variables_type_mqttsession_ELTPARAGRAPHE000166"></a>Les fonctions manipulant les variables de type **mqttSession** sont les suivantes : 



|   |   |
| --- | --- |
| [MQTTAbonne](../WDLang3/1000023073.md) | Permet de s'abonner à une notification MQTT. |
| [MQTTConnecte](../WDLang3/1000023021.md) | Permet de se connecter à un serveur MQTT (également appelé "Broker"). |
| [MQTTDéconnecte](../WDLang3/1000023022.md) | Permet de se déconnecter d'un serveur MQTT (également appelé "Broker"). |
| [MQTTDésabonne](../WDLang3/1000023074.md) | Permet de se désabonner d'une notification MQTT. |
| [MQTTDésabonneTout](../WDLang3/1000023080.md) | Permet de se désabonner de tous les abonnements préalablement souscrits. |
| [MQTTPublie](../WDLang3/1000023060.md) | Publie un message sur le broker MQTT. |






