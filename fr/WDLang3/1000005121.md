
## NotesExtraitFichierAttaché (Fonction)

***En anglais : NotesExtractAttachment***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Extrait un fichier attaché à un champ du document en cours dans Lotus Notes. Ce fichier est automatiquement copié à l'emplacement spécifié.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ouverture de la connexion
IDConnexion est un entier
IDConnexion = NotesOuvreConnexion("MotDePasse", "ServeurMars", ...
		"C:\Users\Julie\AppData\Local\Lotus\Notes\Data\user.id")
// Spécification de la base Lotus Notes à utiliser
IDBase est un entier
IDBase = NotesOuvreBase(IDConnexion, "julie.nsf")
...
// Lecture du premier document
NotesDocumentPremier(IDBase)
...
// Attachement d'un fichier au document en cours
NumFic est un entier
NumFic = NotesAjouteFichierAttaché(IDBase, "MonChampLotusNotes", ...
	"C:\MesDocuments\MonFichier.TXT")
...
// Extraction de ce fichier
NotesExtraitFichierAttaché(IDBase, "MonChampLotusNotes", NumFic, "D:\MesFichiers\FichierA.TXT")
```


<a name="Exemple2"></a>





```wl
// Ouverture de la connexion
IDConnexion est un entier
IDConnexion = NotesOuvreConnexion("MotDePasse", "ServeurMars", ...
		"C:\Users\Julie\AppData\Local\Lotus\Notes\Data\user.id")
// Spécification de la base Lotus Notes à utiliser
IDBase est un entier
IDBase = NotesOuvreBase(IDConnexion, "julie.nsf")
...
// Lecture du premier document
NotesDocumentPremier(IDBase)
...
// Liste des fichiers attachés au champ Lotus Notes "MonChampLotusNotes"
ListeFic est une chaîne
ListeFic = NotesListeFichierAttaché(IDConnexion, "MonChampLotusNotes")
...
// Pour chaque fichier attaché
UnFic est une chaîne
i est un entier = 1
POUR TOUTE CHAINE UnFic DE ListeFic SEPAREE PAR RC
	// Copie le fichier attaché dans le répertoire du projet
	NotesExtraitFichierAttaché(IDBase, "MonChampLotusNotes", i, fRepExe() + ["\"] + UnFic)
	i++
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = NotesExtraitFichierAttaché(<Identifiant de la session> , <Champ Lotus Notes> , <Indice du fichier> , <Emplacement du fichier copié>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le fichier a bien été extrait, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. 
	Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Identifiant de la session> : (Entier)`**

Identifiant de la session à utiliser. Cet identifiant est renvoyé par la fonction [EmailOuvreSessionNotes](../WDLang3/3032121.md) ou la fonction [NotesOuvreBase](../WDLang3/1000005101.md).

**`<Champ Lotus Notes> : (Chaîne de caractères)`**

Nom du champ Lotus Notes de type "Texte Riche" auquel le fichier est attaché. Le plus souvent, ce champ correspond au champ "BODY".

Pour connaître le nom et le type des champs du document Notes en cours, utilisez la fonction [NotesListeChamp](../WDLang3/1000005112.md).

**`<Indice du fichier> : (Entier)`**

Indice du fichier à extraire. Cet indice correspond au rang du fichier dans la liste des fichiers du champ Lotus Notes (par exemple, le 3° fichier attaché aura l'indice 3).

**Attention** : Les indices des fichiers sont modifiés lors de la suppression d'un fichier.

**`<Emplacement du fichier copié> : (Chaîne de caractères)`**

Nom et chemin complet du fichier à extraire.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
Chaque champ d'un document Notes peut avoir jusqu'à 256 fichiers attachés.



<a name="XComposante"></a>

## Composante :
wd280mess.dll
