


## Procédure WLangage de gestion des erreurs appelée par la fonction zipExtraitRépertoire



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Procédure WLangage (également appelée "Callback") appelée si une erreur est rencontrée lors de l'extraction des fichiers par la fonction [zipExtraitRépertoire](../WDLang3/1000025518.md).  
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
Archive est un zipArchive
// Ouverture d'une archive
SI zipOuvre(Archive, "C:\Archives\Archive.zip") = 0 ALORS
	// Extraction du répertoire "Temp" à la racine de l'arborescence des fichiers de l'archive
	zipExtraitRépertoire(Archive, "Temp", zipDisque, zipExtraitRépertoire_CallbackErreur)
FIN

PROCEDURE INTERNE zipExtraitRépertoire_CallbackErreur(CodeErreur est un entier, ...
	NomFichier est une chaîne)
	SI CodeErreur = 1 ALORS 
		RENVOYER zipAnnule
	FIN
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = zipExtraitRépertoire_CallbackErreur(<Code erreur> , <Nom du fichier>)`
---

**`<Résultat> : (Constante de type Entier)`**

La procédure peut renvoyer une des constantes suivantes : 


|   |   |
| --- | --- |
| *zipAnnule* | Annule l'extraction des fichiers présents dans l'archive. |
| *zipIgnore* | Ignore le fichier en erreur. |
| *zipRecommence* | Retente l'extraction du fichier. |



**`<Code erreur> : (Entier)`**

Code de l'erreur rencontrée lors de l'extraction du fichier.

**`<Nom du fichier> : (Chaîne de caractères)`**

Chemin du fichier qui va être traité par la fonction [zipExtraitRépertoire](../WDLang3/1000025518.md). 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Codes d'erreur
<a name="codes_erreur_ELTPARAGRAPHE000055"></a>Les codes d'erreur retournés sont les suivants :

- 1 : Le chemin passé en paramètre n'existe pas.

- 2 : Accès interdit : l'utilisateur n'a pas les droits nécessaires.

- 3 : L'archive est corrompue.

- 4 : Le chemin n'existe pas dans l'archive.

- 6 : Les fichiers des sous-archives ne sont pas dans l'ordre (cas d'une extraction dans une archive multi-parties).

- 21 : Le mot de passe spécifié n'est pas correct.




Le message correspondant au code d'erreur peut être connu grâce à la fonction [zipMsgErreur](../WDLang3/3082034.md).

Remarques : 

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Seules les archives au format ZIP, TAR et TGZ (TAR.GZ) sont disponibles.

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seules les archives au format ZIP sont disponibles.







