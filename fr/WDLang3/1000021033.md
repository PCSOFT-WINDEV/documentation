


## Configuration In-App Android
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000135"></a>
Pour gérer les achats In-App dans une application Android, une configuration spécifique est nécessaire. 

Cette page d'aide présente les différentes manipulations à effectuer. 

Les différentes étapes sont les suivantes : 

- [Enregistrement de l'application dans la console développeur Google Play Developer](#NOTE2_1). 

- [Création d'un produit "In-App"](#NOTE3_1). 

- [Test de l'utilisation d'un produit "In-App"](#NOTE4_1). 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Enregistrement de l'application dans la console développeur Google Play Developer
<a name="enregistrement_application_dans_console_developpeur_google_play_developer_ELTTEXTE000159"></a>
Pour enregistrer l'application : 

1. Connectez-vous à la [console développeur Google Play](http://play.google.com/apps/publish). 
	**Attention** : Un compte développeur Google est requis ainsi qu'un compte Google Wallet pour pouvoir vendre des produits. 

2. Ajoutez l'application et renseignez les informations demandées (titre, description, ...).

3. Affichez si nécessaire les caractéristiques de l'application et sélectionnez l'option "Services & API". 

4. Notez la clé de licence publique de l'application. Cette clé doit être copiée dans l'assistant de génération de l'application Android si votre application utilise les fonctions WLangage inAppXXX.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Création d'un produit "In-App"
<a name="creation_produit_inapp_ELTTEXTE000183"></a>
Pour créer un produit "In-App" : 

1. Générez l'application Android dans WINDEV Mobile. L'application générée doit être signée avec votre fichier de clé (ne pas utiliser de signature générique).

2. Dans la console développeur Google Play, sélectionnez l'application ajoutée précédemment et sélectionnez l'option "Fichier APK"

3. Cliquez sur "Importer un nouveau fichier APK" et sélectionnez le fichier APK généré par WINDEV Mobile (ce fichier est présent dans le répertoire Exe du projet).

4. Dans l'option "Produits intégrés à l'application", cliquez sur "Ajouter un nouveau produit". Choisissez le type de produit à ajouter : Produit géré ou abonnement.

5. Saisissez l'identifiant du produit : cet identifiant peut être quelconque. Cet identifiant sera utilisé, entre autre, dans le code WLangage de l'application pour pouvoir récupérer les informations sur le produit (fonction [inAppListeInfoProduit](../WDLang3/1000020872.md)).  

6. Renseignez les autres informations sur le produit : titre, description, tarif, récurrence de facturation pour les abonnements, ...

7. Enregistrez le produit créé et activez ce produit pour qu'il soit disponible à la vente.




Remarque : Il peut s'écouler un délai de quelques heures entre le moment où le fichier APK de l'application est importé et celui où le service Google Play prend en compte la nouvelle version de l'application.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Test de l'utilisation d'un produit "In-App"
<a name="test_utilisation_produit_inapp_ELTTEXTE000207"></a>
Il est possible de tester l'utilisation de produits "In-App" dans votre application sans qu'aucune transaction financière ne soit effectuée. Pour cela, l'application doit être publiée sur le Google Play Store en version alpha ou version bêta. 

Dans ce cas, il est nécessaire d'ajouter les comptes Gmail du ou des utilisateur(s) autorisé(s) à tester l'application. 
**Attention** : 

- Ce compte doit être enregistré sur l'appareil sur lequel l'application à tester sera installée. Si plusieurs comptes sont enregistrés sur l'appareil, le compte utilisé sera celui qui a téléchargé l'application. Si l'application n'a pas été téléchargée, le compte utilisé sera le premier de la liste.

- Le compte utilisé pour les tests ne doit PAS être celui utilisé pour la connexion à la console développeur Google Play.




**Pour tester l'application** : 

1. Installez l'application sur votre appareil (il n'est pas possible d'utiliser l'émulateur).
	**Important** : L'application installée doit avoir : 

	- une version identique à celle dont l'APK a été importé dans la console développeur (même numéro de version et même version code)

	- la même signature que l'APK importé dans la console développeur. 
			Importez la nouvelle version de l'application dans la console développeur si nécessaire.




2. Testez l'application.





