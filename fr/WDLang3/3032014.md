


## EmailLitPremier (Fonction)

***En anglais : EmailReadFirst***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Lit le premier email reçu :

- soit par le protocole POP3 ou IMAP : l'email est présent dans la boîte aux lettres sur le serveur de messagerie.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) soit par l'intermédiaire du client MS Exchange : l'email reçu est présent sur le poste local dans la boîte de réception de MS Exchange.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) soit par l'intermédiaire du logiciel de messagerie Lotus Notes ou Outlook : l'email reçu est présent sur le poste local dans la boîte de réception de Lotus Notes ou Outlook.


Si aucun email n'est trouvé, la variable Email.EnDehors est positionnée à <u><u><u>Vrai</u></u></u>.

**Rappel** : Avant de lire un email, il est nécessaire d'ouvrir une session avec la fonction [EmailOuvreSession](../WDLang3/3032028.md), [EmailOuvreSessionNotes](../WDLang3/3032121.md) ou [EmailOuvreSessionOutlook](../WDLang3/3032128.md).
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seule la lecture par le protocole POP3 est disponible. 

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003032014&name=emaillitpremier_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Lecture du premier email 
EmailLitPremier(IDEmail)
SI Email.EnDehors = Faux ALORS
	// Affiche l'email dans la fenêtre FEN_Email_RCV
	Ouvre(FEN_Email_RCV)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Lire le premier email reçu en utilisant le protocole POP3 ou IMAP

`<Résultat> = EmailLitPremier(<Session> [, <Email>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le message a été lu, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. 
	Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*. 


S'il n'y a pas d'emails, [ErreurDétectée](../WDLang1/3087001.md) reste à <u><u><u><u>Faux</u></u></u></u> et la variable Email.EnDehors est positionnée à <u><u><u><u>Vrai</u></u></u></u>.

**`<Session> : (Chaîne de caractères ou variable de type emailSessionPOP3 ou emailSessionIMAP)`**

Identifie la session d'un utilisateur. Correspond :

- au nom d'utilisateur utilisé pour ouvrir la session email (fonction [EmailOuvreSession](../WDLang3/3032028.md)).

- à une variable de type [emailSessionPOP3](../WDLang3/1000018759.md).

- à une variable de type [emailSessionIMAP](../WDLang3/1000018957.md).


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les variables de type [emailSessionPOP3](../WDLang3/1000018759.md) et [emailSessionIMAP](../WDLang3/1000018957.md) ne sont pas supportées.

**`<Email> : (Variable de type Email optionnelle)`**

Nom de la variable de type [Email](../WDLang3/1000018713.md) à initialiser avec le contenu du message.
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre n'est pas disponibleSi ce paramètre n'est pas spécifié, la structure [Email](../WDLang3/3032029.md) est utilisée.


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Lire le premier email reçu par l'intermédiaire de MS Exchange, Lotus Notes ou Outlook

`<Résultat> = EmailLitPremier(<Session> [, <Email> [, <Mode de lecture> [, <Type>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le message a été lu, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. 
	Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*. S'il n'y a pas d'emails, [ErreurDétectée](../WDLang1/3087001.md) reste à <u><u><u><u>Faux</u></u></u></u> et la variable Email.EnDehors est positionnée à <u><u><u><u>Vrai</u></u></u></u>.




**`<Session> : (Entier ou variable de type emailSessionOutlook ou emailSessionNotes)`**

Identifiant de la session email en cours. Cet identifiant peut être :

- un entier renvoyé par la fonction [EmailOuvreSessionOutlook](../WDLang3/3032128.md) ou [OutlookOuvreSession](../WDLang3/3032123.md).

- une variable de type [emailSessionOutlook](../WDLang3/1000018767.md).

- une variable de type [emailSessionNotes](../WDLang3/1000018768.md).

- une variable de type [emailSessionIMAP](../WDLang3/1000018957.md).




**`<Email> : (Variable de type Email optionnelle)`**

Nom de la variable de type [Email](../WDLang3/1000018713.md) à initialiser avec le contenu du message.
Si ce paramètre n'est pas spécifié, la structure [Email](../WDLang3/3032029.md) est utilisée.

**`<Mode de lecture> : (Constante ou chaîne de caractères optionnelle)`**

Précise les messages qui doivent être lus :


|   |   |
| --- | --- |
| *emailNonLus* ou "NON LUS" | Seuls les messages qui n'ont pas été consultés seront lus. |
| *emailTous* ou "TOUS"<br>(Valeur par défaut) | Tous les messages seront lus. |



**`<Type> : (Chaîne de caractères optionnelle)`**

Décrit le type de message à lire. Par défaut, &lt;Type&gt; = "IPM" (Inter Personal Message).




<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
<a name="NOTE0_2"></a>


### Les fichiers attachés
<a name="les_fichiers_attaches_ELTPARAGRAPHE000256"></a>Lors de la lecture d'un message, les fichiers attachés à ce message peuvent être copiés sur le disque local (ou sur le disque du serveur) grâce à la fonction [EmailSauveFichierAttaché](../WDLang3/3032020.md).

**Conseil** : 
Il est conseillé de sauvegarder les messages et leurs fichiers attachés sur le disque local (ou sur le disque du serveur) puis de les supprimer du serveur d'email. Cette opération permet :

- d'alléger la boîte aux lettres sur le serveur,

- d'améliorer et d'alléger les communications : seuls les nouveaux messages seront lus sur le serveur.



<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Utilisation de MS Exchange
<a name="utilisation_exchange_ELTPARAGRAPHE000274"></a>La fonction [EmailMiseAJour](../WDLang3/3032036.md) permet de recevoir les messages depuis le serveur Email Internet lors de l'utilisation de MS Exchange.

Lors de la lecture d'un message, les fichiers attachés à ce message sont copiés dans le répertoire temporaire de Windows. Le nom complet de ces fichiers est stocké dans le tableau Email.Attache. Il est possible de copier ces fichiers attachés grâce à la fonction [fCopieFichier](../WDLang1/3036004.md).
<a name="NOTE0_4"></a>
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Jauge de progression
<a name="jauge_progression_ELTPARAGRAPHE000292"></a>Pour suivre la progression de la réception de l'email, utilisez la fonction [EmailJauge](../WDLang3/3032017.md).
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Messagerie Outlook
<a name="messagerie_outlook_ELTPARAGRAPHE000442"></a>Les fonctions WLangage **EmailLitxxx** fonctionnent uniquement avec le fichier de données Outlook (.pst) par défaut. Les autres fichiers de données ne sont pas gérés.


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LesfonctionsEmailPOP3.gif) ***Exemples unitaires (WINDEV)*** : **Les fonctions Email POP3** <br>Utilisation des fonctions Email pour gérer le protocole POP3.<br>Ce protocole sert à récupérer des emails depuis un serveur.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDJavaMail.gif) ***Exemples didactiques (WINDEV)*** : **WD JavaMail** <br>Cet exemple est un exemple Java permettant de de lire et envoyer des emails.

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280com.dll
