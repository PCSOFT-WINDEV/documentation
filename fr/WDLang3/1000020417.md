
## NFCEcritTag (Fonction)

***En anglais : NFCWriteTag***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Déclenche l'écriture de données sur un tag (ou puce) NFC.

**Remarque** : Les fonctions NFC ne peuvent pas être utilisées dans le simulateur ou dans l'émulateur.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ecrit une url dans un tag NFC (mode bloquant)
tag est un nfcTag
url est une nfcDonnée
url.Type = nfcURI
url.Contenu = "http://www.pcsoft.com"
Ajoute(tag.Donnée, url)
NFCEcritTag(tag)
SI ErreurDétectée ALORS
	Erreur("Echec de l'écriture sur le tag NFC.", ErreurInfo())
FIN
```
<a name="Exemple2"></a>

```wl
// Ecrit une url dans un tag NFC (mode non bloquant)
tag est un nfcTag
url est une nfcDonnée
url.Type = nfcURI
url.Contenu = "http://www.pcsoft.com"
Ajoute(tag.Donnée, url)
SI PAS NFCEcritTag(tag, EcritureTagNFC) ALORS
	Erreur("Echec lors de l'écriture NFC.", ErreurInfo())
FIN


PROCEDURE INTERNE EcritureTagNFC(nRésultatNFC est un entier)
	SI nRésultatNFC <> nfcOK ALORS
		Trace("Un problème est survenu")
	FIN
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Ecrire un tag en mode bloquant

`<Résultat> = NFCEcritTag(<Tag>)`
---

**`<Résultat> : (Entier)`**



- 1 si l'écriture a réussi, 

- une des constantes suivantes dans le cas contraire : 
	


|   |   |
| --- | --- |
| *nfcErrDésactivé* | Le NFC n'est pas activé sur l'appareil. |
| *nfcErrDétection* | Le tag NFC est sorti du champ de détection pendant le processus d'écriture. |
| *nfcErrEmulateur* | Appel de la fonction depuis l'émulateur. |
| *nfcErrFormat* | Le format des données à écrire est invalide. |
| *nfcErrInconnue* | Erreur inconnue. |
| *nfcErrLectureSeule* | Le tag NFC est en protégé en écriture. |
| *nfcErrNDEF* | Le tag NFC ne peut pas être formaté au format NDEF (NFC Data Exchange Format). |
| *nfcErrProtection* | Le tag NFC ne peut pas être protégé en écriture  (mode non supporté par le tag). |
| *nfcErrTailleMax* | La taille des données à écrire est supérieure à la taille maximale des données pouvant être stockées sur le tag NFC. |


	En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Tag> : (Variable de type nfcTag)`**

Nom de la variable de type [nfcTag](../WDLang3/1000020411.md) décrivant les données à écrire.


<a name="SYNTAXE2"></a>

### Ecrire un tag en mode non bloquant

`<Résultat> = NFCEcritTag(<Tag> , <Procédure WLangage>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'écriture a été lancée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. 




**`<Tag> : (Variable de type nfcTag)`**

Nom de la variable de type [nfcTag](../WDLang3/1000020411.md) décrivant les données à écrire.

**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure WLangage (également nommée "callback") appelée lors de l'écriture du tag. Cette procédure permet de savoir si l'écriture du tag a été réalisée ou bien si elle a échoué. Cette procédure est de la forme : 

```txt
PROCEDURE <Nom de la procédure>(<Résultat>)
```
où &lt;Résultat&gt; correspond au résultat de l'écriture : 

- 1 si l'écriture du tag a réussi, 

- une des constantes suivantes dans le cas contraire : 
	


|   |   |
| --- | --- |
| *nfcErrAnnulation* | L'action a été annulée par l'utilisateur. |
| *nfcErrDésactivé* | Le NFC n'est pas activé sur l'appareil. |
| *nfcErrDétection* | Le tag NFC est sorti du champ de détection pendant le processus d'écriture. |
| *nfcErrEmulateur* | Appel de la fonction depuis l'émulateur. |
| *nfcErrFormat* | Le format des données à écrire est invalide. |
| *nfcErrInconnue* | Erreur inconnue. |
| *nfcErrIndisponible* | Le capteur NFC n'existe pas ou est indisponible. |
| *nfcErrLectureSeule* | Le tag NFC est en protégé en écriture. |
| *nfcErrNDEF* | Le tag NFC ne peut pas être formaté au format NDEF (NFC Data Exchange Format). |
| *nfcErrProtection* | Le tag NFC ne peut pas être protégé en écriture  (mode non supporté par le tag). |
| *nfcErrTailleMax* | La taille des données à écrire est supérieure à la taille maximale des données pouvant être stockées sur le tag NFC. |
| *nfcOK* | L'opération a été effectuée. |








<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Fonctionnement
<a name="fonctionnement_ELTPARAGRAPHE000186"></a>L'appel de la fonction **NFCEcritTag** déclenche automatiquement l'ouverture d'une fenêtre invitant l'utilisateur à approcher son appareil du tag NFC dans lequel il souhaite écrire. 

Cette fenêtre sera automatiquement fermée : 

- à la fin de l'opération d'écriture, 

- si l'utilisateur annule l'opération en appuyant sur la touche Back de l'appareil. 




Remarque : Pour personnaliser le message affiché dans cette fenêtre, utilisez la fonction [TitreSuivant](../WDLang1/3038043.md) avant l'appel à la fonction **NFCEcritTag**. 

Une vibration de l'appareil est déclenchée lorsque l'appareil détecte le tag NFC. Il est important de conserver l'appareil à proximité du tag NFC durant toute la durée d'affichage de la fenêtre de capture sous peine d'interrompre le processus d'écriture.
<a name="NOTE0_2"></a>


### Permissions requises 
<a name="permissions_requises_ELTPARAGRAPHE000211"></a>L'utilisation de cette fonction entraîne la modification des permissions requises par l'application. 

Permissions requises :  

- NFC : Permet aux applications d'effectuer des opérations d'entrée/sortie par la technologie NFC.

- VIBRATE : Permet d'accéder à la fonction vibreur.



<a name="NOTE0_5"></a>


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WMSysteme.gif) ***Exemples multiplateforme (WINDEV Mobile)*** : **WM Système** <br>Cette application est un exemple didactique montrant quelques unes des fonctionnalités de WINDEV Mobile pour Android/iOS.<br>Les fonctions système utilisées sont : <br>- NFC<br>- Champ Multimédia<br>- Luminosité<br>- Volume<br>- WIFI<br>- Bluetooth<br>- Toast<br>- Boussole<br>- Accéléromètre<br>- Champ caméra<br>- LED<br>- Vibrations<br>- Notifications<br>- Fonctions de dessin<br>- Internet



<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280android.aar
