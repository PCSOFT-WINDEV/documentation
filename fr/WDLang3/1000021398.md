
## Objets connectés : Android Wear
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000130"></a>
Android Wear est la version du système d'exploitation Android dédiée aux objets connectés : montres, bracelets, bagues, ...

Cette version est adaptée aux périphériques de petite taille (taille écran, puissance batterie) dénués de clavier.


![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WM-Android%20Wear-Notif.jpg)
![Affichage d'un message et Proposition de réponse](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WM-Android%20Wear-Action.jpg)


<table></table>
<table></table>

A partir de la version 20, les applications WINDEV Mobile peuvent déclencher l'affichage de messages, d'images, de questions et des propositions de réponse sur les périphériques Android Wear.

Ce dialogue se réalise par l'intermédiaire des notifications riches.

Quelques exemples : 

- l'utilisateur final peut recevoir une alerte sur sa montre et décider de l'action à entreprendre en cliquant sur les choix proposés sur sa montre.

- un utilisateur final peut recevoir un message sur sa montre et dicter (oralement !) sa réponse à la montre. Le téléphone recevra directement la réponse sous forme texte.




Remarques : 

- La gestion des objets connectés est possible uniquement à partir de Android 4.4.

- Si plusieurs objets sont connectés au même téléphone, les notifications seront affichés sur tous les objets connectés (sauf dans le cas de Google Glass). 





### Cas particulier : Google Glass
<a name="cas_particulier_google_glass_ELTPARAGRAPHE000040"></a>Les Google Glass sont également un objet connecté. Il est possible d'envoyer des notifications avec actions via le téléphone vers les lunettes.

Remarque : Si le téléphone possède une connexion à une montre ET à des Google Glass, la notification ne peut pas aller sur les deux. Les lunettes sont prioritaires. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Mettre en place un dialogue avec un objet connecté
<a name="mettre_place_dialogue_avec_objet_connecte_ELTTEXTE000160"></a>


### Principe
<a name="principe_ELTPARAGRAPHE000051"></a>Pour utiliser une application Android sur un objet connecté (le plus souvent une montre), l'objet doit être connecté au téléphone Android. L'objet devient alors un écran déporté pour l'application s'exécutant sur le téléphone. 

Ainsi, une notification envoyée au téléphone s'affiche également sur la montre. Lorsque la notification est lue sur le téléphone, elle disparaît de l'objet connecté, et inversement une notification lue sur l'objet connecté disparaît du téléphone. 

Si la notification entraîne une action, l'application va se déclencher si nécessaire sur le téléphone et la procédure associée à l'action va s'exécuter. 

Si la notification attend une réponse : 

- avec le système des réponses pré-définies, il suffit de sélectionner la réponse sur l'objet connecté. 

- avec le système des réponses libres, l'utilisateur dictera la réponse à l'objet connecté et la réponse sera saisie sur le téléphone. 







### Mise en place
<a name="mise_place_ELTPARAGRAPHE000066"></a>Pour mettre en place un dialogue avec un objet connecté, il suffit d'utiliser le système des notifications (notifications locales ou notifications Push). 

Pour mettre en place une notification locale : 

1. Créer une variable de type [Notification](../WDLang3/1000019441.md). 

2. Définissez les différentes propriétés de la notification. 

3. Utilisez la fonction [NotifAjoute](../WDLang3/1000019442.md) pour ajouter la notification. 




Exemple : Procédure envoyant une notification concernant l'état de santé d'un animal : 

```wl
PROCEDURE AjouteNotif(rTemp est un réel, rPoids est un réel)
// Définition de la notification
MaNotif est une Notification
MaNotif.Titre = "Mon animal"
rPoids = Arrondi(rPoids)
MaNotif.Message = ChaîneConstruit("Mon animal pèse %1kg (- 12 kg) " + ...
	" et sa température est de %2°c", rPoids, rTemp)

MaNotif.AffichageLED = Vrai
MaNotif.CouleurLED = RVB(255, 255, 255)
MaNotif.Son = notifSonDéfaut
MaNotif.Vibration = Vrai
MaNotif.ActiveApplication = Vrai

// Notification déroulée (Android 4.1)
MaNotif.Format.Type = notifFormatImage
MaNotif.Format.Contenu = "animal.jpg"

// Actions
MaNotif.ActionSupplémentaire[1].LibelléAction = "Soigner l'animal"
MaNotif.ActionSupplémentaire[1].Icone = "icon_notif.png"
MaNotif.ActionSupplémentaire[1].ActionClic = CallbackNotif
MaNotif.ActionSupplémentaire[1].LibelléQuestion = "Que souhaitez-vous lui donner ?"
MaNotif.ActionSupplémentaire[1].ChoixRéponse = "Sirop" + RC + "Comprimé" + RC + "Piqûre"

// Ajoute la notification
NotifAjoute(MaNotif)
```



