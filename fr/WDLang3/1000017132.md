
## BTListePériphérique (Fonction)

***En anglais : BTListDevice***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Liste les périphériques Bluetooth accessibles.








<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
sChaîneTmp est une chaîne
sListePériphs est une chaîne
// Liste les périphériques
Sablier(Vrai)
sListePériphs = BTListePériphérique()
Sablier(Faux)
// Vide le champ Table où sont listés les périphériques
TableSupprimeTout(TABLE_Appareils)
// Remplit le champ Table
SI sListePériphs <> "" ALORS
	POUR TOUTE CHAINE sChaîneTmp DE sListePériphs SEPAREE PAR RC
		TableAjoute(TABLE_Appareils, sChaîneTmp)
	FIN
SINON
	Info(ErreurInfo(errComplet)) 
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = BTListePériphérique([<Niveau de détail> [, <Type des éléments à lister> [, <Timeout> [, <Identifiant de la radio>]]]])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Liste des périphériques Bluetooth disponibles, 

- Chaîne vide ("") en cas d'erreur. La fonction [ErreurInfo](../WDLang1/3013008.md) permet d'obtenir plus de détails sur le problème rencontré. 




Cette liste est de la forme :

- en mode simple : 
	
	```txt
	<Identifiant Périphérique 1> + TAB + <Adresse MAC 1> + TAB + <Nom 1> + RC + ...
	 + RC + <Identifiant Périphérique N> + TAB + <Adresse MAC N> + TAB + <Nom N>
	```


- en mode détaillé : 
	
	```txt
	<Identifiant Périphérique 1> + TAB + <Adresse MAC 1> + TAB + <Nom 1> + TAB + 
	<Identifiant Classe 1> + TAB + <Connecté 1> + TAB + <Mémorisé 1> + TAB + 
	<Authentifié 1> + TAB + <Date Vue 1> + TAB + <Date utilisé 1> + RC + ... + RC + 
	<Identifiant Périphérique N> + TAB + <Adresse MAC N> + TAB + <Nom N> + TAB + 
	<Identifiant Classe N> + TAB + <Connecté N> + TAB + <Mémorisé N> + TAB + 
	<Authentifié N> + TAB + <Date vue N> + TAB + <Date utilisé N>
	```





Les différentes informations obtenues sont les suivantes :

- &lt;Identifiant Périphérique&gt; : Identifiant du périphérique, à utiliser dans les fonctions Bluetooth manipulant des périphériques. 

- &lt;Adresse Mac&gt; : Adresse physique du périphérique.

- &lt;Nom&gt; : Nom retourné par le périphérique (peut être une chaîne vide).

- &lt;Identifiant Classe&gt; : Classe du périphérique (entier sur 32 permettant d'obtenir des informations sur le type du périphérique). Cette classe peut correspondre à une des constantes suivantes :

	- btCoD_AccèsRéseau

	- btCoD_AudioVidéo

	- btCoD_pers

	- btCoD_Image

	- btCoD_Inconnu

	- btCoD_Jouet

	- btCoD_Ordinateur

	- btCoD_Périphérique

	- btCoD_Téléphone

	- btCoD_Vêtement




- &lt;Connecté&gt; : 1 si le périphérique est actuellement "connecté" au poste en cours, 0 dans le cas contraire. 
	

- &lt;Mémorisé&gt; : 1 si le périphérique est actuellement "mémorisé" par le gestionnaire Bluetooth du poste en cours, 0 dans le cas contraire. 
	

- &lt;Authentifié&gt; : 1 si le périphérique est actuellement authentifié auprès du poste en cours, 0 dans le cas contraire. 

- &lt;Date vue&gt; : Date et heure à laquelle le périphérique a été vu pour la dernière fois par le poste en cours. Cette date est au format JJMMAAAAHHMMSS. Cette information est fournie uniquement pour les périphériques mémorisés. 
	

- &lt;Date utilisé&gt; : Date et heure à laquelle le périphérique a été utilisé pour la dernière fois. Cette date est au format JJMMAAAAHHMMSS. Cette information est fournie uniquement pour les périphériques mémorisés.
	




**`<Niveau de détail> : (Constante optionnelle de type Entier)`**

Niveau de détail du résultat :



|   |   |
| --- | --- |
| *btListeDétaillée* | &lt;Résultat&gt; contient la liste des périphériques en mode détaillé. |
| *btListeSimple*<br>(Valeur par défaut) | &lt;Résultat&gt; contient la liste des périphériques en mode simple. |



**`<Type des éléments à lister> : (Constante ou combinaison de constantes de type entier optionnelle)`**

État des périphériques à sélectionner : 



|   |   |
| --- | --- |
| *btEtatAuthentifié* | Propose les périphériques authentifiés. |
| *btEtatConnecté* | Propose les périphériques connectés.<br><br> |
| *btEtatInconnu* | Propose les périphériques inconnus. |
| *btEtatMémorisé* | Propose les périphériques mémorisés.<br><br> |
| *btEtatTous*<br>(Valeur par défaut) | Propose tous les périphériques. |



**`<Timeout> : (Entier optionnel)`**

Timeout en secondes (compris entre 1 et 60) de la recherche des périphériques. 
Par défaut, ce paramètre a pour valeur 10.

**`<Identifiant de la radio> : (Entier optionnel)`**

Identifiant de la radio Bluetooth à manipuler. Cet identifiant est retourné par la fonction [BTListeRadio](../WDLang3/1000017125.md).





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Cas particuliers
<a name="cas_particuliers_ELTPARAGRAPHE000167"></a>

- Un périphérique authentifié est nécessairement mémorisé (l'inverse n'est pas vrai).

- Le listage des périphériques est effectué en interrogeant l'environnement jusqu'au &lt;Timeout&gt; de la fonction. Dans cet intervalle de temps, il est possible que les périphériques n'aient pas le temps nécessaire pour communiquer leur identité. Il suffit d'utiliser ensuite la fonction [BTInfoPériphérique](../WDLang3/1000017133.md) pour obtenir les informations manquantes.



<a name="NOTE0_2"></a>




### Limitations
<a name="limitations_ELTPARAGRAPHE000179"></a>

- ![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) Seules les piles bluetooth Microsoft, Bluesoleil et Broadcom (Widcomm) sont supportées par cette fonction. Les piles Broadcom (Widcomm) ne sont pas disponibles en 64 bits. 

- Pour connaître la pile utilisée, utilisez la fonction [BTPile](../WDLang3/1000017229.md).  

- Pour plus de détails sur les clés supportées, consultez [Quelles piles utiliser ?](../WDLang3/1000017231.md)



<a name="NOTE0_3"></a>
<a name="NOTE0_4"></a>

<a name="XComposante"></a>

## Composante :
wd280com.dll
