


## Envoyer des fax avec WINDEV et WEBDEV
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000283"></a>
Pour envoyer des fax directement depuis une application ou un site, WINDEV et WEBDEV mettent à votre disposition des fonctions permettant d'envoyer des fax, par l'intermédiaire du serveur de fax système disponible sous Windows XP et Windows 2000.

**Remarque** : Sous Windows Vista, la gestion des fax est disponible uniquement avec Windows Vista Professionnel et Windows Vista Edition Intégrale.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment envoyer des fax ?
<a name="comment_envoyer_des_fax_ELTTEXTE000307"></a>
Pour envoyer des fax depuis une application WINDEV ou un site WEBDEV, il faut :

- [configurer le poste à partir duquel les fax doivent être envoyés](../WDLang3/3037016.md).

- créer l'application WINDEV/WEBDEV d'envoi de fax.

- [configurer si nécessaire par programmation les options du serveur de fax](../WDLang3/3037016.md). 




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Programmer l'envoi de fax
<a name="programmer_envoi_fax_ELTTEXTE000331"></a>


### Envoyer un fax depuis une application WINDEV ou un site WEBDEV
<a name="envoyer_fax_depuis_une_application_windev_site_webdev_ELTPARAGRAPHE000035"></a>Pour envoyer un fax depuis une application WINDEV ou un site WEBDEV, il faut :

1. Préparer le fax, c'est-à-dire le fichier que va être envoyé. Il est possible également d'associer une première page spécifique au fax (appelée "Couverture"). Cette première page est un fichier de type ".Cov" et peut être créée à partir du serveur de fax.

2. Utiliser la fonction [FaxConnecte](../WDLang3/3037005.md). Cette fonction permet de connecter l'application WINDEV au serveur de fax installé sur le poste en cours.

3. Envoyer le fax :

	- soit avec la fonction [FaxEnvoie](../WDLang3/3037006.md). Lors de cet envoi, il est possible de préciser le nom d'une procédure WLangage. Cette procédure sera appelée à chaque modification de l'état du fax dans le serveur de fax. L'état du fax peut être connu par la fonction [FaxEtat](../WDLang3/3037001.md). Cette fonction permet de remplir la [structure FaxEtatComplet](../WDLang3/3037011.md) contenant toutes les caractéristiques du fax.

	- soit avec la fonction [iDestination](../WDLang5/3046074.md) et les fonctions d'impression. Cette solution permet d'imprimer directement un état réalisé avec l'éditeur d'états. Dans ce cas, il est possible de donner un nom au fax envoyé. L'état du fax pourra ensuite être connu avec la fonction [FaxEtat](../WDLang3/3037001.md). Cette fonction permet de remplir la [structure FaxEtatComplet](../WDLang3/3037011.md) contenant toutes les caractéristiques du fax.
			**Remarque** : Il n'est possible d'envoyer qu'un seul fax à la fois. Il est cependant possible d'exécuter plusieurs fonctions [FaxEnvoie](../WDLang3/3037006.md) à la suite : les différents fax seront mis dans la chaîne d'attente d'envoi des fax. La procédure WLangage combinée à la fonction [FaxEtat](../WDLang3/3037001.md) permettra de connaître le fax en cours de traitement. Cette fonction permet de remplir la [structure FaxEtatComplet](../WDLang3/3037011.md) contenant toutes les caractéristiques du fax.




4. Lorsque le ou les différents fax sont envoyés, il suffit de déconnecter l'application WINDEV du serveur de fax avec la fonction [FaxDéconnecte](../WDLang3/3037007.md). 



<a name="NOTE3_2"></a>


### Envoyer un fax créé avec l'éditeur d'états
<a name="envoyer_fax_cree_avec_editeur_etats_ELTPARAGRAPHE000085"></a>Pour envoyer un fax créé avec l'éditeur d'états, il est possible :

- soit d'utiliser uniquement la fonction [iDestination](../WDLang5/3046074.md). L'état imprimé par la fonction [iImprimeEtat](../WDLang5/3046032.md) sera directement envoyé au numéro de fax spécifié. Dans ce cas, aucune gestion de suivi du fax n'est possible.
	
	```wl
	// Envoie l'état "ETAT_FactureCli" par fax
	iDestination(iFax, "0006050402")
	iImprimeEtat(ETAT_FactureCli)
	```


- soit d'utiliser les fonctions Fax et la fonction [iDestination](../WDLang5/3046074.md). La fonction [iDestination](../WDLang5/3046074.md) effectue si nécessaire une connexion au serveur de fax et renvoie l'identifiant de cette connexion. Cet identifiant peut être utilisé avec les fonctions Fax pour suivre l'évolution de l'envoi du fax.
	
	```wl
	// Envoie l'état "ETAT_FactureCli" par fax
	IDConnect est un entier
	IDConnect = iDestination(iFax, "0006050402", "MonFax","\\monFax\ImprimanteFax")
	// "\\monFax\ImprimanteFax" est le nom de partage de l'imprimante fax
	iImprimeEtat(ETAT_FactureCli)
	```





<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Configurer le serveur de fax par programmation
<a name="configurer_serveur_fax_par_programmation_ELTTEXTE000361"></a>


### Options du serveur de fax
<a name="options_serveur_fax_ELTPARAGRAPHE000113"></a>Le serveur de fax standard de Windows propose plusieurs options, configurables directement depuis l'interface dus serveur de fax. Ces différentes options peuvent être configurées directement par programmation, en manipulant la base de registre. Il est possible de paramétrer et d'obtenir :

- des informations concernant l'envoi de fax (Windows 2000) : 
	La clé de registre correspondante est HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Fax :
	


|   |   |
| --- | --- |
| Archiver les télécopies sortantes | ArchiveOutgoingFax |
| Heure de début de la période de tarif réduit | StartCheapTime |
| Heure de FIN de la période de tarif réduit | StopCheapTime |
| Impression de la bannière du haut | Branding |
| Interdire les pages de garde personnel | ServerCoverPageOnly |
| Nombre de jours avant suppression des télécopies Non envoyées | Dirty Days |
| Nombre de minutes entre deux tentatives | Retry Delay |
| Nombre d'essais | Retries |
| Répertoire des télécopies sortantes | ArchiveDirectory |



- des informations concernant l'expéditeur du fax (Windows 2000) : 
	La clé de registre correspondante est HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Fax\\UserInfo :
	


|   |   |
| --- | --- |
| Adresse Messagerie | Mailbox |
| Adresse professionnelle | Office |
| Affiche le moniteur d'état en envoi ET réception | VisualNotification |
| Avertissement sonore | SoundNotification |
| Code de facturation | BillingCode |
| Moniteur d'état toujours Dessus | AlwaysOnTop |
| Nom complet | FullName |
| Numéro de fax expéditeur | FaxNumber |
| Service | Department |
| Société | Company |
| Téléphone personnel | HomePhone |
| Téléphone professionnel | OfficePhone |
| Titre | Title |





<a name="NOTE4_2"></a>


### Astuces 
<a name="astuces_ELTPARAGRAPHE000219"></a>Pour réaliser un serveur de fax et gérer les re-expéditions de fax, il est préférable d'indiquer au niveau du gestionnaire de fax les options suivantes:

- Pas de re-tentative d'expédition des fax : 
	RegistreEcrit("HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Fax","Retries",0)

- Delai de 0 mn entre deux tentatives : 
	RegistreEcrit("HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Fax","Retry Delay",0)

- 0 jour de conservation des fax non envoyés : 
	RegistreEcrit("HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Fax","Dirty Days",0)




Il est possible de considérer qu'un fax passé par l'état ***FaxEtatInit*** OU ***FaxEtatAppel*** et qui revient dans l'état ***FaxEtatInactif*** est un fax qui a tenté d'être expédié une fois. Ce fax va ensuite être ré-expédié (il ne sera pas ré-expédié automatiquement car l'option "Pas de re-tentative d'expédition des fax" est à vrai). 


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Envoid'unfax.gif) ***Exemples unitaires (WINDEV)*** : **Envoi d'un fax** <br>Envoi d'un fax avec WINDEV. Le fax peut être envoyé grâce à un serveur de fax mais aussi par un modem correctement installé et configuré sur le poste de l'utilisateur.


