
## LDAPConnecte (Fonction)

***En anglais : LDAPConnect***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet de se connecter à un serveur LDAP grâce aux caractéristiques définies dans la [structure LDAPSession](../WDLang3/3032101.md). La connexion est réellement ouverte au premier accès (fonction [LDAPRecherche](../WDLang3/3032108.md) par exemple).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Vérification du couple "Login / Mot de passe" utilisateur

// Initialisation
LDAPRAZ()
LDAPSession.Hôte = "domaine.local"
LDAPSession.Port = 389
LDAPSession.Version = 3
LDAPSession.Utilisateur = "user@domaine.local"
LDAPSession.MotDePasse = "mdp"

// Connexion
LDAPConnecte("MaSession")

// Recherche des informations de l'utilisateur.
sDn est une chaîne = LDAPRecherche("MaSession", ...
		"cn=users,dc=domain,dc=local","sAMAccountName=testeur")

// Autre possibilité
// sDn est une chaîne = LDAPRecherche("MaSession", ...
// "cn=users,dc=domain,dc=local","UserPrincipalName=testeur@domain.local")


SI sDn = "" ALORS
	// Impossible de lister le DN de connexion
	// Le login ne correspond pas au bon mot de passe 
	Erreur("Le mot de passe de l'utilisateur " + LDAPSession.Utilisateur + " est erroné.") 
FIN

// Déconnexion 
LDAPDéconnecte("MaSession")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = LDAPConnecte(<Session LDAP>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la connexion est établie, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [ErreurInfo](../WDLang1/3013008.md) permet d'obtenir plus de détails sur l'erreur. 


Si le nom de la session existe déjà, la connexion n'est pas établie.

**`<Session LDAP> : (Chaîne de caractères)`**

Nom de la session LDAP. Ce nom doit être unique. Ce nom permettra d'identifier la session dans toutes les fonctions LDAP.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Structure LDAPSession
<a name="structure_ldapsession_ELTPARAGRAPHE000053"></a>La structure [LDAPSession](../WDLang3/3032101.md) permet de renseigner toutes les caractéristiques de la session LDAP à manipuler (adresse du serveur, port, ...). Cette structure doit être initialisée avant d'utiliser la fonction **LDAPConnecte**.

Cette structure permet également de préciser différentes options comme le mode de gestion du SSL ou le mode de connexion. 

**Remarque** : Il est conseillé de ré-initialiser la [structure LDAPSession](../WDLang3/3032101.md) à l'aide de la fonction [LDAPRAZ](../WDLang3/3032103.md).






### LDAP et Groupware utilisateur
<a name="ldap_groupware_utilisateur_ELTPARAGRAPHE000076"></a>Il est possible de connecter automatiquement votre projet à un annuaire LDAP grâce au [Groupware Utilisateur](../Editeurs/2018001.md). 




- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LesfonctionsLDAP.gif) ***Exemples unitaires (WINDEV)*** : **Les fonctions LDAP** <br>Utilisation des fonctions LDAP du WLangage.<br>Ces fonctions permettent d'interagir totalement avec les données LDAP, de visualiser le contenu de tout annuaire LDAP et également de modifier les données LDAP : LDAPConnecte, LDAPListeFils, LDAPAjouteAttribut, LDAPSupprimeValeurAttribut,...



<a name="XComposante"></a>

## Composante :
wd280com.dll
