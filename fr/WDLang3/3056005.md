
## NetEnvoieFichier (Fonction)

***En anglais : NetSendFile***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Transmet un fichier à un serveur FTP (File Transfer Protocol) réalisé avec WINDEV. Ce fichier pourra être récupéré sur le serveur FTP par la fonction [NetRécupèreFichier](../WDLang3/3056025.md).

**Remarque** : Il est possible d'autoriser ou non l'utilisation de cette fonction sur un serveur FTP/RPC grâce à la fonction [NetOptionServeur](../WDLang3/3056022.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003056005&name=netenvoiefichier_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
SI NetEnvoieFichier(ConnectFTP, "C:\autoexec.bat", ...
	"C:\autoexec.cli", "EnvoieFichier", 10) = Faux ALORS
	Info("Echec du transfert")
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = NetEnvoieFichier(<Identifiant connexion> , <Fichier du poste client> , <Fichier du poste serveur> [, <Événement> [, <Fréquence événement>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le transfert a été effectué, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction renvoie immédiatement le compte-rendu et le transfert s'effectue en parallèle dans une autre tâche Windows.




**`<Identifiant connexion> : (Entier)`**

Identifiant de la connexion (obtenu par la fonction [NetConnecte](../WDLang3/3056004.md)).

**`<Fichier du poste client> : (Chaîne de caractères Ansi)`**

Nom complet (nom et chemin) du fichier à copier, présent sur le poste client.

**`<Fichier du poste serveur> : (Chaîne de caractères Ansi)`**

Nom complet (nom et chemin) du fichier copié sur le poste serveur.

**`<Événement> : (Chaîne de caractères ou entier (optionnel))`**

Événement personnalisé ou événement Windows envoyé au client pour suivre la progression du transfert (voir Notes).

**`<Fréquence événement> : (Entier optionnel)`**

Fréquence (en pourcentage de la taille du fichier) avec laquelle le message &lt;Événement&gt; est envoyé au client.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Progression du transfert de fichiers
<a name="progression_transfert_fichiers_ELTPARAGRAPHE000061"></a>La gestion de la progression du transfert de fichiers est uniquement réalisée sur le programme client FTP.

La fonction **NetEnvoieFichier** n'est jamais bloquante : le transfert de fichier se fait en tâche de fond. Cependant, il est possible de transférer uniquement un seul fichier à la fois.

**Pour transférer plusieurs fichiers**, il faut attendre que le transfert de chacun des fichiers soit terminé avant de commencer le suivant.
Dans ce cas, il est possible d'utiliser deux paramètres avec la fonction **NetEnvoieFichier** :

- un message de progression (Paramètre &lt;Événement&gt;),

- une fréquence (paramètre &lt;Fréquence événement&gt;).




La fonction **NetEnvoieFichier** envoie le message indiqué pour permettre de suivre la progression du transfert. Ce message doit être intercepté avec la fonction [Evénement](../WDLang1/3015011.md). Le message contient deux paramètres :

- _EVE.wParam indique la taille transférée (indicateur de progression),

- _EVE.lParam indique la taille totale du fichier.




Le traitement du message de progression est réalisé dans la procédure appelée par la fonction [Evénement](../WDLang1/3015011.md). Dans cette procédure, il est possible :

- d'afficher une jauge de progression en utilisant les paramètres du message (_EVE.lParam et _EVE.wParam),

- de savoir si le transfert du fichier est terminé (dans ce cas, _EVE.lParam = _EVE.wParam).





<a name="NOTE0_2"></a>




### Fréquence de l'événement
<a name="frequence_evenement_ELTPARAGRAPHE000103"></a>Le paramètre &lt;Fréquence événement&gt; permet de définir la fréquence minimum d'envoi de message. Par exemple, pour un fichier d'une taille de 1 Mo et une fréquence de 10%, on recevra un message à chaque fois que 100Ko sont transférés.

La fréquence détermine le nombre maximum de messages qui peuvent être reçus. Quand le transfert est rapide, le nombre de messages reçus diminue.

Par exemple, pour un fichier de 100Ko et une fréquence de 10%, environ 10 messages seront reçus : 1 message tous les 10Ko transférés. En réalité, le nombre de messages sera inférieur car le transfert est rapide.

Conseils sur le choix de la fréquence :

- Si aucune jauge de progression ne doit être affichée, le meilleur choix de fréquence est 100%. Un seul message sera reçu lorsque le transfert du fichier sera terminé.

- Si le taux de transfert est lent (transfert par modem), il est conseillé d'afficher une jauge de progression. Une fréquence de 10% convient dans la majorité des cas.

- Si le taux de transfert est rapide (réseau local), il est déconseillé d'utiliser une fréquence trop faible (1% par exemple) car le flux des messages sera élevé et pourra saturer le système. Là encore, une fréquence de 10% convient dans la majorité des cas.






<a name="XComposante"></a>

## Composante :
wd280com.dll
