
## NetDémarreServeur (Fonction)

***En anglais : NetStartServer***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Lance un serveur FTP (File Transfer Protocol) ou RPC (Remote Procedure Call) réalisé avec WINDEV.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
ConnectRPC est un entier
// Se connecte à un serveur RPC sur le port 5010
ConnectRPC = NetDémarreServeur(ServeurRPC, Faux, 5010)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = NetDémarreServeur(<Serveur> [, <Cryptage> [, <Numéro de port> [, <Clé> [, <Adresse IP du serveur>]]]])`
---

**`<Résultat> : (Entier)`**



- Identifiant du serveur,

- 0 si la connexion a échoué.




**`<Serveur> : (Constante)`**

Type du serveur : 


|   |   |
| --- | --- |
| *ServeurFTP* | Utilisation d'un serveur WINDEV FTP. Les fonctions de gestion de fichiers sont autorisées (par exemple fonctions [NetEnvoieFichier](../WDLang3/3056005.md) et [NetRécupèreFichier](../WDLang3/3056025.md)). |
| *ServeurRPC* | Utilisation d'un serveur WINDEV RPC. |



**`<Cryptage> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> pour crypter les données transmises, 

- <u><u><u><u>Faux</u></u></u></u> (valeur par défaut) pour aucun cryptage.




Si le serveur est lancé avec l'option de cryptage à <u><u><u><u>Vrai</u></u></u></u>, les postes client devront se connecter avec la fonction [NetConnecte](../WDLang3/3056004.md) en utilisant l'option &lt;Cryptage&gt; = Vrai.

Si le cryptage est demandé, la clé de connexion (paramètre &lt;Clé&gt; ) sera elle aussi cryptée.

**`<Numéro de port> : (Entier optionnel)`**

Numéro de port sur lequel le serveur doit être lancé. Par défaut, le client tente de se connecter au serveur :

- sur le port 2000 pour le RPC WINDEV.

- sur le port 2001 pour le FTP WINDEV.




**`<Clé> : (Chaîne de caractères optionnelle)`**

Permet de sécuriser l'accès au serveur. Chaque client essayant de se connecter au serveur doit utiliser la même clé que celle définie avec la fonction **NetDémarreServeur**. Si les clés sont différentes, la connexion est refusée.

Si le paramètre &lt;Cryptage&gt; est à <u><u><u><u>Vrai</u></u></u></u>, la clé est cryptée.

**`<Adresse IP du serveur> : (Chaîne de caractères optionnelle)`**

Adresse IP du poste serveur. Ce paramètre doit être spécifié si le serveur a plusieurs adresses IP (serveur utilisant plusieurs cartes réseau par exemple). Cette adresse IP peut être donnée sous la forme :

- Adresse IP au format XXX.XXX.XXX.XXX ( par exemple, 125.5.110.100).

- Adresse IP contenant le nom du serveur (par exemple, pop3.freesbee.fr). Cette syntaxe est conseillée.

- Adresse IP obtenue par la fonction [NetAdresseIP](../WDLang3/3056023.md).  






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Paramètres du serveur
<a name="parametres_serveur_ELTPARAGRAPHE000096"></a>Il est indispensable de connaître les paramètres du serveur pour se connecter :

- Si le numéro de port est précisé, le client devra utiliser le même numéro de port dans la fonction [NetConnecte](../WDLang3/3056004.md).

- Si le serveur est lancé avec le paramètre &lt;Cryptage&gt; à <u><u><u><u>Vrai</u></u></u></u>, les clients devront se connecter avec le paramètre &lt;Cryptage&gt; à <u><u><u><u>Vrai</u></u></u></u> dans la fonction [NetConnecte](../WDLang3/3056004.md).

- Si le serveur est lancé avec une &lt;Clé&gt; spécifique, les clients devront se connecter en précisant la même chaîne de caractères &lt;Clé&gt; dans la fonction [NetConnecte](../WDLang3/3056004.md).





<a name="NOTE0_2"></a>




### Nom de l'utilisateur et mot de passe
<a name="nom_utilisateur_mot_passe_ELTPARAGRAPHE000126"></a>Les paramètres &lt;NomUtilisateur&gt; et &lt;MotDePasse&gt; permettent au serveur de reconnaître s'il s'agit d'un utilisateur autorisé ou non. La liste des autorisations et des mots de passe des utilisateurs se trouve dans le fichier WDRPCSRV.INI dans le répertoire du projet serveur. Voici un exemple de contenu de ce fichier :

```txt
[Passwords]
NOMUTILIS1 = PASS1
NOMUTILIS2 = PASS2
NOMUTILIS3 = PASS3
```

<a name="NOTE0_4"></a>




### Réception des messages
<a name="reception_des_messages_ELTPARAGRAPHE000135"></a>La réception des messages se fait au travers d'événement dont le numéro est choisi par le développeur.



<a name="XComposante"></a>

## Composante :
wd280com.dll
