


## grSMNAjouteDonnée (Fonction)

***En anglais : grSunburstAddData***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute une donnée à un graphe de type Secteur multiniveau.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
grSMNAjouteDonnée(GRF_Graphe, "Europe" + TAB + "France" + TAB + "Montpellier", 320000)
grSMNAjouteDonnée(GRF_Graphe, "Europe" + TAB + "France" + TAB + "Paris", 789000)
grSMNAjouteDonnée(GRF_Graphe, "Europe" + TAB + "France", 1109000) 
grSMNAjouteDonnée(GRF_Graphe, "Europe" + TAB + "Belgique", 900000)
grSMNAjouteDonnée(GRF_Graphe, "Asie", 250000)
grDessine(GRF_Graphe)
```

![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=grSMNAjouteDonn%E9e.gif)
<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`grSMNAjouteDonnée(<Nom du graphe> , <Chemin de la portion> , <Valeur>)`
---

**`<Nom du graphe> : (Nom de champ ou chaîne de caractères)`**

Nom du graphe à manipuler. Ce nom correspond :

- soit au nom du graphe défini par programmation avec la fonction [grCrée](../WDLang3/3042005.md).

- soit au nom du champ Graphe présent dans l'éditeur de fenêtres, de pages ou d'états.




**`<Chemin de la portion> : (Chaîne de caractères)`**

Chemin complet de la portion à ajouter dans le graphe. Ce paramètre est de la forme :

```txt
"<Nom du niveau de base>" + TAB + ["<Nom du 1er niveau>" + TAB + ...
["<Nom du dernier niveau>" + TAB + [...]]]"<Nom de la portion>"
```
Ce chemin détermine la position de la donnée, en précisant les différents niveaux hiérarchiques de la donnée. 
Par exemple, si le chemin contient "Europe + TAB + France + TAB + Montpellier", la donnée sera ajoutée au troisième niveau du graphe sous les catégories "Europe\\France\\Montpellier".

**`<Valeur> : (Réel)`**

Valeur de la part ajoutée. Cette valeur ne doit pas être négative. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Graphe Secteur multiniveau
<a name="graphe_secteur_multiniveau_ELTPARAGRAPHE000102"></a>

- Si un niveau ne contient pas de valeur propre, sa valeur sera calculée en faisant la somme des valeurs des sous-niveaux.

- Si la somme des données des sous-niveaux d'un niveau spécifique dépasse la valeur de ce niveau, une erreur sera renvoyée au moment du dessin du graphe.

- La couleur des sous-niveaux est calculée automatiquement : cette couleur est dans la même teinte que la couleur du niveau principal mais plus pâle.



<a name="NOTE0_2"></a>


### Ajout de données dans un graphe
<a name="ajout_donnees_dans_graphe_ELTPARAGRAPHE000113"></a>La fonction [grAjouteDonnée](../WDLang3/3042023.md) permet d'ajouter des données dans un graphe (secteur, histogramme, ...)

Selon le type de graphe, des fonctions spécifiques permettent également d'ajouter des données : 

- Pour les graphes boursiers, il est conseillé d'utiliser la fonction [grBourseAjouteDonnée](../WDLang3/3042009.md).

- Pour les graphes Heatmap, il est conseillé d'utiliser la fonction [grHMAjouteDonnée](../WDLang3/1000021628.md).

- Pour les graphes de type Nuage de points, il est conseillé d'utiliser la fonction [grNuageAjouteDonnéeXY](../WDLang3/3042032.md).

- Pour les graphes de type Surface, il est conseillé d'utiliser la fonction [grSurfaceAjouteDonnée](../WDLang3/1000020425.md).




Rappel : Pour ajouter une valeur à une donnée d'un graphe, utilisez la fonction [grIncrémenteDonnée](../WDLang3/3042030.md).

<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280grf.dll
