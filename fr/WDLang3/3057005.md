
## OLECréeCopie (Fonction)

***En anglais : OLECreateCopy***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Associe un champ OLE à un objet OLE en précisant un fichier de base. La fonction **OLECréeCopie** lance le serveur OLE qui a créé le fichier. Une copie du fichier est éditée. Le serveur à lancer est déduit de l'extension du fichier de base (Paint Brush pour l'extension BMP, WinWord pour l'extension DOC, etc.). Lors de la sortie du serveur, l'objet est automatiquement dessiné dans le champ OLE de la fenêtre WINDEV. **Cette fonction permet de modifier un objet OLE.**

**Remarque** : Selon le serveur qui a créé l'objet OLE, l'objet peut s'afficher dans le champ sous forme de :

- sa représentation bitmap (exemple d'image créée avec Paint Brush),

- sa représentation vectorielle (exemple de feuille de calcul créée avec Excel),

- l'icône représentant le serveur (exemple d'icône WinWord),

- texte.



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// L'image Château.bmp a été créée avec Paint Brush.
// Lancement de Paint Brush avec l'image Château.bmp chargée.
OLECréeCopie(OLE_OLE1, "C:\Windows\Château.bmp")
// Traitement
// Sauvegarde
OLESauve(OLE_OLE1, "OBJET.OLE")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = OLECréeCopie(<Champ OLE> , <Nom du fichier> [, <Bloque>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la fonction a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Champ OLE> : (Nom de champ)`**

Nom du champ OLE qui va accueillir l'objet OLE. Si le champ contenait un objet, cet objet est remplacé par le nouvel objet. Si ce paramètre correspond à une chaîne vide (""), le champ considéré sera le champ auquel appartient l'événement en cours.

**`<Nom du fichier> : (Chaîne de caractères)`**

Nom et chemin (si nécessaire) du fichier de base (avec son extension). Ce fichier peut être un fichier quelconque créé avec un serveur OLE (image BMP de Paint Brush, feuille de calcul .XLS, document Word .DOC, etc.).

**`<Bloque> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> (valeur par défaut) : Serveur bloquant.
	Tant que l'utilisateur n'a pas quitté le serveur, la fenêtre contenant le champ OLE ne peut pas être en saisie.

- <u><u><u><u>Faux</u></u></u></u> : Serveur non bloquant.
	L'utilisateur peut saisir dans la fenêtre contenant le champ OLE alors que le serveur est toujours lancé. Permet de jouer un verbe avec la fonction [OLEJoue](../WDLang3/3057009.md).






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
Seul OLE version 1 est géré.



<a name="XComposante"></a>

## Composante :
wd280ole.dll
