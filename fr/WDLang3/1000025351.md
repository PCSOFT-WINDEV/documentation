
## Procédure WLangage appelée par la fonction FTPListeFichier



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Procédure (également appelée "Callback") appelée par la fonction [FTPListeFichier](../WDLang3/3040018.md) pour chaque fichier trouvé. Cette procédure peut être une procédure locale, globale ou interne.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Connexion à un site FTP
nConnexion est un entier
nConnexion = FTPConnecte("ftp.cdrom.com")

nFichier est un entier  // Nombre de fichiers présents dans le répertoire
nJPG est un entier		// Nombre de fichiers .JPG
nJPG = 0

// On liste les fichiers ".JPG" du répertoire en cours
nFichier = FTPListeFichier(nConnexion, "", FTPListeFichier_Callback, ftpFichier, nJPG)
Info("Il y a" + nJPG + "fichiers .JPG sur" + nFichier + "fichiers listés") 


// Procédure appelée par la fonction FTPListeFichier
// Pour chaque fichier trouvé, la procédure FTPListeFichier_Callback 
// permet de compter le nombre de fichiers d'extension ".JPG".
PROCEDURE INTERNE FTPListeFichier_Callback(Nom, nTaille, sAttribut, sDate, sHeure, nParam)
	SI Droite(Nom, 4) ~= ".JPG" ALORS
		nParam++
	FIN
	RENVOYER Vrai
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = FTPListeFichier_Callback(<Fichier> , <Taille> , <Attribut> , <Date> , <Heure> , <Paramètre de la procédure>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> pour continuer le parcours des fichiers,

- <u><u><u><u>Faux</u></u></u></u> pour forcer l'interruption du parcours des fichiers. 




**`<Fichier> : (Chaîne de caractères)`**

Nom du fichier ou du répertoire manipulé.

**`<Taille> : (Entier)`**

Taille du fichier trouvé en octets. Ce paramètre n'est pas à prendre en compte dans le cas d'un répertoire.

**`<Attribut> : (Chaîne de caractères)`**

Attributs du fichier ou du répertoire trouvé. Le format utilisé est identique à celui de la fonction [FTPAttribut](../WDLang3/3040006.md).

**`<Date> : (Chaîne de caractères)`**

Date de modification du fichier (ou du répertoire) trouvé. Le format utilisé est "AAAAMMJJ".

**`<Heure> : (Chaîne de caractères)`**

Heure de modification du fichier (ou du répertoire) trouvé. Le format utilisé est "HHMMSS".

**`<Paramètre de la procédure> : (Variant)`**

valeur passée au &lt;Paramètre&gt; de la fonction [FTPListeFichier](../WDLang3/3040018.md). Si &lt;Paramètre&gt; n'est pas précisé, &lt;Paramètre de la procédure&gt; vaut 0.






## Remarques


### Caractéristique de la procédure
<a name="caracteristique_procedure_ELTPARAGRAPHE000057"></a>**Attention** : Dans cette procédure :

- aucune fonction FTP utilisant la même connexion que celle de la fonction [FTPListeFichier](../WDLang3/3040018.md) ne doit être appelée.

- il est possible de récupérer les propriétés (nom, taille, attributs, dates et heures) du fichier listé à l'aide des fonctions [FTPNom](../WDLang3/3040019.md), [FTPTaille](../WDLang3/3040007.md), [FTPAttribut](../WDLang3/3040006.md), [FTPDate](../WDLang3/3040015.md) et [FTPHeure](../WDLang3/3040013.md). Cependant, cette solution est coûteuse en temps : elle provoque une requête supplémentaire sur le serveur FTP. Il est donc préférable de lire directement les paramètres optionnels passés à la procédure.





<a name="NOTE0_2"></a>


### Interruption de la fonction FTPListeFichier
<a name="interruption_fonction_ftplistefichier_ELTPARAGRAPHE000086"></a>La fonction [FTPListeFichier](../WDLang3/3040018.md) ne peut pas être interrompue tant qu'il reste des fichiers à parcourir. Pour forcer l'interruption du parcours, il faut utiliser la ligne suivante dans la procédure :


```wl
RENVOYER Faux
```


Dans ce cas, la fonction [FTPListeFichier](../WDLang3/3040018.md) retourne le nombre de fichiers parcourus jusqu'à l'appel de "RENVOYER Faux".
Dans les autres cas (pour poursuivre le parcours), la procédure DOIT renvoyer <u><u><u><u>Vrai</u></u></u></u>.

Si la procédure ne retourne aucune valeur (ni <u><u><u><u>Vrai</u></u></u></u>, ni <u><u><u><u>Faux</u></u></u></u>), une erreur est générée.







<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280com.dll
