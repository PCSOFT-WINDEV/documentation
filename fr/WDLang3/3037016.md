


## Configurer le poste "serveur de Fax"
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000287"></a>
WINDEV et WEBDEV permettent de gérer des fax par l'intermédiaire du serveur de fax système, disponible sous Windows (version 2000, XP et supérieures).

Il est possible de :

- [envoyer des fax](../WDLang3/3037002.md).

- [manipuler les fax reçus ou envoyés](../WDLang3/3037017.md). 




Cette page d'aide présente la configuration du serveur de fax nécessaire pour réaliser ces opérations.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Configurer le poste "serveur de fax"
<a name="configurer_poste_serveur_fax_ELTTEXTE000311"></a>


### Configuration du poste en cours
<a name="configuration_poste_cours_ELTPARAGRAPHE000029"></a>Les éléments nécessaires pour envoyer un fax :

- Windows XP, 2000 ou Vista (Vista Professionnel ou Vista Edition Intégrale)

- un modem configuré sur le poste (poste serveur en WEBDEV)

- le service de fax standard Windows doit être démarré (sur le serveur en WEBDEV)




**Remarque** : le serveur de fax peut être un poste différent du poste en cours. Dans ce cas, le serveur de fax doit être installé sur un poste "Serveur 2003" et partagé.

**1. Vérifier la configuration du modem**

Ouvrez le panneau de configuration de Windows (option "Démarrer .. Paramètres .. Panneau de configuration") et sélectionnez l'option "Options de Modem et téléphonie". Vérifiez qu'un modem est installé sur le poste.

**2. Installer un serveur de fax standard**

Windows version XP, 2000 et Vista sont livrés avec un serveur de fax.

Pour installer ce serveur de fax sous Windows XP ou 2000 :

- Utilisez l'option "Ajout / Suppression de programmes" du panneau de configuration de Windows (option "Démarrer .. Paramètres .. Panneau de configuration").

- Sélectionnez l'option "Ajouter des composants Windows".




Pour installer ce serveur de fax sous Windows Vista :

- Utilisez l'option "Programmes et fonctionnalités" du panneau de configuration de Windows (option "Démarrer .. Paramètres .. Panneau de configuration").

- Sélectionnez l'option "Activer ou désactiver des fonctionnalités Windows", puis la fonctionnalité "Télécopie et numérisation Windows".




**3. Vérifier que le service de fax standard de Windows est en mode réception**

Pour plus de détails, consultez les paragraphes ci-dessous. 
<a name="NOTE2_2"></a>


### Configuration du serveur de fax sous Windows 2000
<a name="configuration_serveur_fax_sous_windows_2000_ELTPARAGRAPHE000064"></a>Sous Windows 2000, le serveur de fax est appelé "Télécopieur".

Pour configurer le serveur de fax :

1. Ouvrez le panneau de configuration de Windows (option "Démarrer .. Paramètres .. Panneau de configuration").

2. Double-cliquez sur l'option "Télécopieur". Si cette option n'apparaît pas, installez le serveur de fax de Windows 2000 (voir ci-dessus).

3. Sélectionnez l'onglet "Options avancées" et cliquez sur le bouton "Ouvrir la console de gestion du service de télécopie".

4. L'option "Périphérique" liste les modem et fax installés sur le poste.

5. Double-cliquez sur votre modem/fax.

6. Dans l'onglet "Général", activez l'envoi de fax pour pouvoir envoyer des fax depuis une application WINDEV ou un site WEBDEV.

7. Validez.


Remarque : Pour créer un fichier de couverture (.Cov), utilisez l'onglet "Page de garde". 
<a name="NOTE2_3"></a>


### Configuration du serveur de fax sous Windows XP
<a name="configuration_serveur_fax_sous_windows_ELTPARAGRAPHE000083"></a>Pour configurer le serveur de fax : 

1. Sélectionnez l'option "Démarrer .. Impression et Fax".

2. Double-cliquez sur l'option "Fax". Le moniteur de fax s'ouvre.

3. Sélectionnez l'option "Outils .. Configuration".

4. Validez les paramètres par défaut, jusqu'au plan "Configuration de réception et d'envoi des fax".

5. Activez l'envoi de fax pour pouvoir envoyer des fax depuis une application WINDEV.

6. Validez. Le serveur de fax est démarré.


Remarque : Pour créer un fichier de couverture (.Cov), utilisez l'option "Outil .. Page de couverture personnelle".
<a name="NOTE2_4"></a>


### Configuration du serveur de fax sous Windows Vista
<a name="configuration_serveur_fax_sous_windows_vista_ELTPARAGRAPHE000099"></a>Pour configurer le serveur de fax : 

1. Sélectionnez l'option "Démarrer .. Tous les programmes .. Télécopie et numérisation Windows". Le moniteur de télécopies s'ouvre.  

2. Dans le bas du volet de gauche, sélectionnez "Télécopie".

3. Sélectionnez l'option "Outils .. Comptes de télécopie", puis cliquez sur le bouton "Ajouter".

4. Dans l'assistant, suivez les différentes étapes pour vous connecter à un modem de télécopie.

5. Pour activer l'envoi de fax, sélectionnez l'option "Outils .. Paramètres de télécopie" et cochez l'option "Autoriser ce périphérique à envoyer des télécopies".

6. Validez. Le serveur de fax est démarré.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Configurer le serveur de fax par programmation
<a name="configurer_serveur_fax_par_programmation_ELTTEXTE000353"></a>


### Options du serveur de fax
<a name="options_serveur_fax_ELTPARAGRAPHE000115"></a>Le serveur de fax standard de Windows propose plusieurs options, configurables directement depuis l'interface dus serveur de fax. Ces différentes options peuvent être configurées directement par programmation, en manipulant la base de registre. Il est possible de paramétrer et d'obtenir :

- des informations concernant l'envoi de fax (Windows 2000) : 
	La clé de registre correspondante est HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Fax :
	


|   |   |
| --- | --- |
| Nombre d'essais | Retries |
| Nombre de minutes entre deux tentatives | Retry Delay |
| Nombre de jours avant suppression des télécopies Non envoyées | Dirty Days |
| Archiver les télécopies sortantes | ArchiveOutgoingFax |
| Répertoire des télécopies sortantes | ArchiveDirectory |
| Impression de la bannière du haut | Branding |
| Interdire les pages de garde personnel | ServerCoverPageOnly |
| Heure de début de la période de tarif réduit | StartCheapTime |
| Heure de FIN de la période de tarif réduit | StopCheapTime |



- des informations concernant l'expéditeur du fax (Windows 2000) : 
	La clé de registre correspondante est HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Fax\\UserInfo :
	


|   |   |
| --- | --- |
| Numéro de fax expéditeur | FaxNumber |
| Adresse Messagerie | Mailbox |
| Société | Company |
| Titre | Title |
| Nom complet | FullName |
| Service | Department |
| Adresse professionnelle | Office |
| Téléphone personnel | HomePhone |
| Téléphone professionnel | OfficePhone |
| Affiche le moniteur d'état en envoi ET réception | VisualNotification |
| Moniteur d'état toujours Dessus | AlwaysOnTop |
| Avertissement sonore | SoundNotification |
| Code de facturation | BillingCode |





<a name="NOTE3_2"></a>


### Astuces
<a name="astuces_ELTPARAGRAPHE000221"></a>Pour réaliser un serveur de fax et gérer les ré-expéditions de fax, il est préférable d'indiquer au niveau du gestionnaire de fax les options suivantes :

- Pas de re-tentative d'expédition des fax : 
	
	```wl
	RegistreEcrit("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Fax","Retries",0)
	```


- Délai de 0 mn entre deux tentatives : 
	
	```wl
	RegistreEcrit("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Fax","Retry Delay",0)
	```


- 0 jour de conservation des fax non envoyés : 
	
	```wl
	RegistreEcrit("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Fax","Dirty Days",0)
	```





Il est possible de considérer qu'un fax passé par l'état ***FaxEtatInit*** OU ***FaxEtatAppel*** et qui revient dans l'état ***FaxEtatInactif*** est un fax qui a tenté d'être expédié une fois. Ce fax va ensuite être ré-expédié (il ne sera pas ré-expédié automatiquement car l'option "Pas de re-tentative d'expédition des fax" est à <u><u><u><u>Vrai</u></u></u></u>). 


