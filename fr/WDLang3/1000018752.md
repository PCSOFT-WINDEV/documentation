
## emailAttache (Type de variable)

***En anglais : emailAttach***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **emailAttache** permet de manipuler une pièce jointe à un email. Les caractéristiques de cette pièce jointe peuvent être définies et modifiées à l'aide de différentes propriétés WLangage.

Ce type de variable est utilisé par les variables de type [Email](../WDLang3/1000018713.md). 

**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Attachement d'une pièce jointe à un email

monEmail est un Email
...
monAttache est un emailAttache
sFichier est une chaîne

// Sélection du fichier à joindre
sFichier = fSélecteur("", "", "Sélectionnez le document PDF à joindre...", ...
		"Documents PDF (*.PDF)" + TAB + "*.pdf", "*.pdf")

// Construction de la variable emailAttache
monAttache.Nom = fExtraitChemin(sFichier, fFichier + fExtension)
monAttache.Contenu = fChargeBuffer(sFichier)
monAttache.ContentType = fContentType(sFichier)
monAttache.ContentDescription = "Un document"

// Ajout de la pièce jointe
Ajoute(monEmail.Attache, monAttache)
```



```wl
// Seconde méthode avec EmailChargeFichierAttaché

MonFichierEmailSourceTemp est une chaîne 
MonFichierEmailSourceTemp = ComplèteRep(fRepExe()) + "EmailSource.eml"
SI fFichierExiste(MonFichierEmailSourceTemp) ALORS 
	fSupprime(MonFichierEmailSourceTemp)
FIN
EmailRAZ(MonSourceEmail)

// Construction de l'email dans un fichier EML (source de l'email)
// LISTE_Attachement contient la liste de mes pièces jointes
Ajoute(MonSourceEmail.Destinataire, SAI_Destinataire)
POUR TOUTE LIGNE DE LISTE_Attachement	
	EmailChargeFichierAttaché(MonSourceEmail, ...
		LISTE_Attachement.ValeurAffichée)
FIN

MonSourceEmail.Expediteur = "mon_adresse@test.com"
MonSourceEmail.Sujet = "Mon sujet"
MonSourceEmail.Message = HTMLVersTexte(SAI_EMAIL_HTML)
EmailImporteHTML(MonSourceEmail, SAI_EMAIL, ComplèteRep(fRepExe()))	
EmailConstruitSource(MonSourceEmail)
```





<a name="NOTE0_2"></a>

## Remarques


### Propriétés spécifiques à la description des variables de type emailAttache
<a name="proprietes_specifiques_description_des_variables_type_emailattache_ELTPARAGRAPHE000061"></a>Les propriétés suivantes peuvent être utilisées pour manipuler une variable de type **emailAttache** :

| Nom de la propriété | Type manipulé | Effet |
| --- | --- | --- |
| ContentDescription | Chaîne de caractères | Texte descriptif du contenu de la pièce jointe. |
| ContentType | Chaîne de caractères | Type de fichier selon la norme MIME (Multipurpose Internet Mail Extensions). Le "Content Type" indique aux logiciels de messagerie comment ils doivent interpréter la pièce pointe. |
| Contenu | Buffer | Contenu de la pièce jointe.<br><br>Remarque : Si la pièce jointe est remplie manuellement, il ne faut pas oublier de préciser la propriété **Nom** sinon l'image ne sera pas transmise dans l'email. Exemple : <br><br><pre><code>oEmail.Attache[1].Contenu = ...<br>	fChargeBuffer(fRepDonnées() + ...<br>	 ["\"] + "Email\" + sLogoSociété)<br>oEmail.Attache[1].ContentType = "image/gif"<br>oEmail.Attache[1].Nom = "logo.gif"</code></pre><br> |
| Identifiant | Chaîne de caractères | Identifiant du fichier attaché inclus dans un message HTML. |
| Nom | Chaîne de caractères | Nom du fichier attaché. |


**Remarque** : Il est possible d'utiliser des caractères non latins dans les propriétés **Nom** et **ContentDescription**.
<a name="NOTE0_3"></a>


### Fonctions manipulant une variable emailAttache
<a name="fonctions_manipulant_une_variable_emailattache_ELTPARAGRAPHE000114"></a>Les fonctions suivantes peuvent être utilisées pour manipuler une variable de type **emailAttache** :



|   |   |
| --- | --- |
| [EmailChargeFichierAttaché](../WDLang3/1000019126.md) | Ajoute un fichier en attachement d'un email. |
| [EmailSauveFichierAttaché](../WDLang3/3032020.md) | Copie le fichier attaché de l'email en cours sur le poste de l'utilisateur (en local). |










- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDMail.gif) ***Exemples complets (WINDEV)*** : **WD Mail** <br>Cette application est un client mail complet développé en WINDEV. Il s'appuie sur les objets Email.<br>Ce client mail permet de récupérer et d'envoyer des emails en utilisant les protocoles POP, IMAP et SMTP.<br>Il est possible d'appliquer des filtres sur le courrier entrant.<br>L'écriture d'un email s'appuie sur le champ Editeur HTML.<br>L'affichage des emails utilise le champ Affichage HTML.<br>L'application permet de gérer plusieurs comptes emails différents.


