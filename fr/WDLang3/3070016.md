


## SocketConnecte (Fonction)

***En anglais : SocketConnect***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Connecte un poste client à un socket donné.

**Remarques** :

- **Sockets de type UDP** : Le protocole UDP n'est pas un protocole dit "connecté" donc la fonction **SocketConnecte** n'est pas utilisable avec le protocole UDP. Pour envoyer ou recevoir des données avec le protocole UDP, il est nécessaire de créer un socket UDP (fonction [SocketCréeUDP](../WDLang3/3070019.md) puis envoyer / recevoir des données avec les syntaxes "spéciales UDP" des fonctions [SocketEcrit](../WDLang3/3070002.md) et [SocketLit](../WDLang3/3070014.md). 

- **Sockets SSL** : Pour envoyer ou recevoir des données avec le protocole SSL, il est nécessaire de créer un socket SSL (fonction [SocketCréeSSL](../WDLang3/1000017041.md)) et de se connecter à ce socket par la fonction [SocketConnecteSSL](../WDLang3/1000017042.md).

- **Communication avec des automates ou des applications non WINDEV** : Pour simplifier les échanges des données par socket, un mode de transmission est initialisé par défaut. Dans le cas d'une communication avec un module externe (application non WINDEV, automate, ...), ce mode de transmission peut empêcher le bon fonctionnement des communications. La fonction [SocketChangeModeTransmission](../WDLang3/3070005.md) permet de changer ce mode de transmission (la constante *SocketSansMarqueurFin* permet de ne pas modifier les trames lues et écrites).




**Rappel** : Un socket est une ressource de communication utilisée par les applications pour communiquer d'une machine à une autre sans se soucier du type de réseau.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 
```wl
SI SocketConnecte("Serveur", 8000) = Faux ALORS
	Erreur("erreur de connexion " + ErreurInfo(errMessage))
FIN
```
<a name="Exemple2"></a>

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 
### Se connecter à une socket

`<Résultat> = SocketConnecte(<Nom du socket> , <Numéro de port> [, <Adresse> [, <Délai maximal>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la fonction a réussi, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. En cas d'erreur, il est possible de connaître le détail de l'erreur grâce à la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Nom du socket> : (Chaîne de caractères)`**

Nom à donner à la connexion ouverte sur le socket du serveur. Ce nom sera utilisé dans toutes les fonctions socket.
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Attention : Le nom du socket est "case-sensitive".

**`<Numéro de port> : (Entier)`**

Numéro de port du socket. Si vous utilisez un socket associé à un protocole prédéfini, utilisez le numéro de port associé au protocole.
Si le socket a été créé par une application WINDEV, ce numéro doit être compris entre 5 000 et 65 000. Dans ce cas, le numéro doit être identique au numéro de port indiqué dans la fonction [SocketCrée](../WDLang3/3070011.md).

**`<Adresse> : (Chaîne de caractères optionnelle)`**

Adresse du poste serveur. Si ce paramètre n'est pas spécifié, le serveur est recherché sur le poste en cours. Cette adresse peut être donnée sous la forme :

- adresse IP au format XXX.XXX.XXX.XXX (par exemple 125.5.110.100).

- URL contenant le nom du serveur (par exemple www.pcsoft.fr). Cette syntaxe est conseillée.


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) L'adresse peut également correspondre à l'adresse IP obtenue par la fonction [NetAdresseIP](../WDLang3/3056023.md).



**`<Délai maximal> : (Entier optionnel ou Durée optionnelle)`**

Délai maximal (en millisecondes) accordé pour la réalisation de la connexion. Ce délai sert uniquement dans le cas où le serveur refuse la connexion (fonction [SocketRefuse](../WDLang3/3070010.md)). La connexion ne sera alors pas bloquante. Ce paramètre peut correspondre à : 

- un entier correspondant au nombre de millisecondes, 

- une variable de type Durée, 

- l'indication directe de la durée (par exemple 1 s ou 10 ms). 


Par défaut, cette attente est égale à 5 000 millisecondes (5 secondes). Consultez [les remarques](#NOTE0_2) pour plus de détails. 





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Optimisation des connexions dans le cas d'une adresse IP
<a name="optimisation_des_connexions_dans_cas_une_adresse_ELTPARAGRAPHE000248"></a>Lorsqu'une adresse IP est passée à la fonction **SocketConnecte**, il est possible d'optimiser la connexion en utilisant le code suivant :  

```wl
Socket.Option = SocketOptimiseConnexionIP
```
Cette option n'est pas activée par défaut car la connexion peut échouer dans certaines configurations. Cependant, elle peut être intéressante pour certaines applications où les performances sont critiques.

**Remarque** : Pour retrouver le fonctionnement par défaut, il suffit d'utiliser la constante *SocketOptionDéfaut* :

```wl
Socket.Option = SocketOptionDéfaut
```

<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Délai d'attente
<a name="delai_attente_ELTPARAGRAPHE000265"></a>Le délai indiqué par le paramètre &lt;Délai maximal&gt; regroupe le délai de deux étapes :

- le délai de résolution de l'adresse : ce délai est non paramétrable et peut être optimisé (voir ci-dessous).

- le délai d'attente maximum d'acceptation de la connexion par le serveur. Plusieurs cas peuvent se présenter :

	- le serveur refuse la connexion.

	- le serveur accepte la connexion dans le délai imparti.

	- le serveur n'est pas disponible.

	- l'adresse indiquée n'est pas valide.







Afin d'optimiser le délai de résolution de l'adresse (le temps de recherche de l'adresse), il est recommandé :

- soit d'utiliser un DNS sur le réseau. Ainsi, la recherche de cette adresse sera faite auprès de ce serveur et non pour chaque poste (1 recherche au lieu de x recherches où x est le nombre de postes). Chaque poste doit être enregistré auprès de ce serveur.

- soit dans le cas d'une adresse IP, d'utiliser la variable **Socket.Option** de la manière suivante : 
	
	```wl
	Socket.Option = SocketOptimiseConnexionIP
	```




<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Connexion à un port infrarouge
<a name="connexion_port_infrarouge_ELTPARAGRAPHE000292"></a>Pour se connecter à un socket utilisant un port infrarouge :

1. Créez un socket utilisant le port infrarouge sur le poste serveur (fonction [SocketCréeInfraRouge](../WDLang3/3070012.md) dans une application WINDEV).

2. Dans l'application cliente (application WINDEV), utilisez la fonction [SocketConnecteInfraRouge](../WDLang3/3070018.md) pour se connecter à ce socket.



<a name="NOTE0_4"></a>
<a name="NOTE0_6"></a>
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 

### Fonctionnalité d'application requise
<a name="fonctionnalite_application_requise_ELTPARAGRAPHE000332"></a>L'utilisation de cette fonction entraîne la déclaration d'une fonctionnalité d'application dans l'assistant de génération de l'application.

Fonctionnalité requise : Réseaux domestiques et professionnels

Cette fonctionnalité permet aux applications d'utiliser des accès entrants et sortants vers des réseaux domestiques et professionnels. 

<a name="XComposante"></a>

## Composante :
wd280com.dll
