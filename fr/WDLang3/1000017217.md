
## SNMPLitTableau (Fonction)

***En anglais : SNMPGetTable***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Lit un tableau de valeurs SNMP.

Un tableau de valeurs SNMP est un tableau de chaînes à deux dimensions.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Lecture des périphériques de stockage du système local
IDSession est un entier = SNMPOuvreSession("127.0.0.1", "public")

// Constantes OID pour le tableau de périphériques
OIDHRSTORAGETABLE = "1.3.6.1.2.1.25.2.3"
// Numéro des colonnes intéressantes du tableau SNMP de périphériques
OIDHRSTORAGETYPE = 2
OIDHRSTORAGEDESCR = 3
OIDHRSTORAGESIZE = 5
OIDHRSTORAGEUSED = 6

sTablePeripheriques est un tableau de 0 par 0 chaînes
SNMPLitTableau(IDSession, OIDHRSTORAGETABLE, sTablePeripheriques)
// Pour ne lire que les valeurs StorageSize et StorageUsed
// SNMPLitTableau(IDSession, OIDHRSTORAGETABLE, ...
//				sTablePeripheriques, [OIDHRSTORAGESIZE, OIDHRSTORAGEUSED]) 

// Nombre de lignes
nNombreLignes est un entier = TableauInfo(sTablePeripheriques, tiNombreLignes)

POUR i = 1 A nNombreLignes
	Trace("Périphérique " + i)
	Trace("Type " = sTablePeripheriques[i, OIDHRSTORAGETYPE])
	Trace("Description " = sTablePeripheriques[i, OIDHRSTORAGEDESCR])
	Trace("Taille " = sTablePeripheriques[i, OIDHRSTORAGESIZE])
	Trace("Utilisé " = sTablePeripheriques[i, OIDHRSTORAGEUSED])
	Trace("	 ")
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = SNMPLitTableau(<Identifiant de la session> , <OID du tableau SNMP> , <Tableau WLangage>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la lecture a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> si une erreur est survenue. La fonction [ErreurInfo](../WDLang1/3013008.md) permet d'obtenir plus de renseignements sur le problème rencontré.




**`<Identifiant de la session> : (Entier)`**

Identifiant de la session SNMP renvoyé par la fonction [SNMPOuvreSession](../WDLang3/1000017067.md).

**`<OID du tableau SNMP> : (Chaîne de caractères)`**

Identifiant du tableau SNMP à lire. Cette chaîne peut correspondre à l'identifiant au format numérique ou au format texte (le fichier MIB qui décrit l'OID doit avoir été chargé avec la fonction [SNMPChargeMIB](../WDLang3/1000017074.md)).

**`<Tableau WLangage> : (Variable de type Tableau (tableau de chaînes à deux dimensions))`**

Lors de l'exécution de la fonction, ce tableau WLangage est affecté avec les valeurs du tableau SNMP. Les lignes sont les éléments du tableau (de 1 au nombre d'éléments total). Les colonnes sont les attributs (de 1 au nombre d'attributs du tableau). Par exemple : &lt;Tableau WLangage&gt; [2,3] est la valeur de l'attribut 3 du 2ème élément du tableau.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Les tableaux SNMP
<a name="les_tableaux_snmp_ELTPARAGRAPHE000063"></a>En SNMP, les tableaux sont de la forme :


|   |   |
| --- | --- |
| &lt;OID Tableau SNMP&gt;.1.&lt;OID Colonne 1&gt;.&lt;Indice Ligne 1&gt; | Valeur 1,1 |
| &lt;OID Tableau SNMP&gt;.1.&lt;OID Colonne 1&gt;.&lt;Indice Ligne 2&gt; | Valeur 2,1 |
| &lt;OID Tableau SNMP&gt;.1.&lt;OID Colonne 1&gt;.&lt;Indice Ligne n&gt; | Valeur n,1 |
| &lt;OID Tableau SNMP&gt;.1.&lt;OID Colonne 2&gt;.&lt;Indice Ligne 1&gt; | Valeur 1,2 |
| &lt;OID Tableau SNMP&gt;.1.&lt;OID Colonne 2&gt;.&lt;Indice Ligne 2&gt; | Valeur 2,2 |
| &lt;OID Tableau SNMP&gt;.1.&lt;OID Colonne 2&gt;.&lt;Indice Ligne n&gt; | Valeur n,2 |
| ... |   |
| &lt;OID Tableau SNMP&gt;.1.&lt;OID Colonne m&gt;.&lt;Indice Ligne 1&gt; | Valeur 1,m |
| &lt;OID Tableau SNMP&gt;.1.&lt;OID Colonne m&gt;.&lt;Indice Ligne 2&gt; | Valeur 2,m |
| &lt;OID Tableau SNMP&gt;.1.&lt;OID Colonne m&gt;.&lt;Indice Ligne n&gt; | Valeur n,m |

La fonction **SNMPLitTableau** permet de récupérer ce tableau sous la forme :


|   |   |   |   |   |
| --- | --- | --- | --- | --- |
|   | OID colonne 1 | OID colonne 2 | ... | OID colonne m |
| Indice ligne 1 | Valeur 1,1 | Valeur 1,2 |   | Valeur 1,m |
| Indice ligne  2 | Valeur   2,1 | Valeur   2,2 |   | Valeur   2,m |
| ... |   |   |   |   |
| Indice ligne n | Valeur   n,1 | Valeur   n,2 |   | Valeur   n,m |




<a name="NOTE0_2"></a>




### OID des colonnes
<a name="oid_des_colonnes_ELTPARAGRAPHE000151"></a>Pour plus de clarté, il est conseillé de définir des constantes pour les OID des colonnes (voir exemple).


<a name="NOTE0_3"></a>

<a name="XComposante"></a>

## Composante :
wd280com.dll
