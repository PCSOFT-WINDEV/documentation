


## Procédure WLangage appelée par la fonction zipAjouteRépertoire pour gérer la jauge



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Procédure WLangage (également appelée "Callback") utilisée par la fonction [zipAjouteRépertoire](../WDLang3/3082014.md) pour gérer la progression de l'ajout des fichiers dans l'archive.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// -- Déclarations globales de la fenêtre
GLOBAL
NomArchive est une chaîne = "MonArchive"
```

```wl
// -- Clic sur BTN_AjoutRépertoire
// Initialisation des variables
NomRépertoire est une chaîne
CodeErreurCréation est un entier
CodeErreurAjout est un entier

// Création d'une archive
CodeErreurCréation = zipCrée(NomArchive, "C:\MonRépertoire\MesArchives\ArchivePdf.wdz")

// Affichage du message d'erreur si l'archive n'a pas été créée
SI CodeErreurCréation = 0 ALORS
	// Sélection du répertoire
	NomRépertoire = fRepSélecteur("", "", "Répertoire à ajouter")
	// Ajoute la totalité des fichiers du répertoire sélectionné dans l'archive
	CodeErreurAjout = zipAjouteRépertoire(NomArchive, NomRépertoire, Faux, zipRépertoire, ...
			zipAjouteRépertoireJauge_Callback)
	// Affichage du message d'erreur si le fichier n'a pas été ajouté
	SI CodeErreurAjout <> 0 ALORS
		Erreur(zipMsgErreur(CodeErreurAjout))
	FIN
SINON
	Erreur(zipMsgErreur(CodeErreurCréation))
FIN
// Cette procédure permet de gérer la jauge.
PROCÉDURE INTERNE zipAjouteRépertoireJauge_Callback(FichierEnCours est une chaîne, 
	AvancementGlobal est un entier, AvancementFichier est un entier)
	SI AvancementGlobal < 100 ALORS
		Jauge(AvancementGlobal, 100, FichierEnCours)
		// Rafraîchissement de la fenêtre
		Multitâche(-1)

	SINON
		Jauge()
	FIN
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`zipAjouteRépertoire_CallbackJauge(<Fichier en cours> , <Pourcentage d'avancement global> , <Pourcentage d'avancement du fichier>)`
---

**`<Fichier en cours> : (Chaîne de caractères)`**

Nom du fichier en cours de traitement. 

**`<Pourcentage d'avancement global> : (Entier)`**

Pourcentage d'avancement de l'ajout des fichiers dans l'archive.

**`<Pourcentage d'avancement du fichier> : (Entier)`**

Pourcentage d'avancement de l'ajout du fichier en cours dans l'archive.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
**Si vous manipulez une archive au format 7z**, seul le paramètre &lt;Pourcentage d'avancement global&gt; est renseigné. Le paramètre &lt;Pourcentage d'avancement du fichier&gt; aura la même valeur. 

<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280java	zip.dll
