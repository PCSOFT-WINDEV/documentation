


## SOAPPrépare (Fonction)

***En anglais : SOAPPrepare***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Construit la requête SOAP d'appel à une fonction d'un Webservice.








<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Appel classique utilisant l'appel complet à une méthode de Webservice
stParam1 est un Param1
stParam1.Chaîne = "une chaîne"
stParam1.Entier = 2
stRet est un Result1
stRet = MaFonction(stParam1)

// Appel équivalent avec préparation du buffer 
// et utilisation de la fonction SOAPExécuteXML
stParam1 est un Param1
stParam1.Chaîne = "une chaîne"
stParam1.Entier = 2
byBuffer est un Buffer = SOAPPrépare(MaFonction, stParam1)
// L'action doit être de la forme "urn:<Nom du Webservice>/NomFonction"
// <Nom du Webservice> : souvent il s'agit du nom du fichier wsdl (sans l'extension)
SOAPExécuteXML("http://localhost/webService/", byBuffer, "urn:MonWebservice/MaFonction")
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = SOAPPrépare(<Nom de la fonction> [, <Paramètre 1> [... [, <Paramètre N>]]])`
---

**`<Résultat> : (Buffer)`**

Buffer XML contenant la requête SOAP générée.

**`<Nom de la fonction> : (Chaîne de caractères)`**

Fonction du Webservice pour laquelle il faut construire la requête SOAP.

**`<Paramètre 1> : (Variant)`**

Premier paramètre de la fonction du Webservice.



**`<Paramètre N> : (Variant)`**

Nième paramètre de la fonction du Webservice.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
La fonction **SOAPPrépare** construit la requête SOAP qui serait envoyée au Webservice lors d'un appel à l'une de ses fonctions sans effectuer la requête.

Le buffer généré peut ensuite être envoyé grâce à la fonction [SOAPExécuteXML](../WDLang3/3069014.md).

Le buffer renvoyé contient le flux XML encodé en UTF8. Le buffer ne contient pas l'entête HTTP (indiquant notamment le SOAP Action, le content-type, etc.). Les entêtes sont ajoutés automatiquement par la fonction [SOAPExécuteXML](../WDLang3/3069014.md).

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280xml.dll
