


## inAppConsommeProduit (Fonction)

***En anglais : inAppConsumeProduct***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet de consommer dans une application un produit précédemment acheté par l'utilisateur. Une fois consommé, le produit sera à nouveau disponible à l'achat pour l'utilisateur.

**Rappel** : Sous Android, il n'est pas possible d'acheter un produit que l'utilisateur a déjà acheté. Il est nécessaire de consommer le produit avant de pouvoir l'acheter à nouveau.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Demande l'achat d'un produit 
inAppAchèteProduit(MonProduit, AchatProduit)
```

```wl
PROCEDURE AchatProduit(bSuccès est un booléen, Produit est un inAppProduit, IDAchat)
SI PAS bSuccès ALORS
	ToastAffiche(ErreurInfo())
SINON
	// Consommation du produit
	inAppConsommeProduit(Produit, IDAchat, ConsommationProduit)
FIN
```

```wl
PROCEDURE ConsommationProduit(bSuccès est un booléen)
SI PAS bSuccès ALORS
	ToastAffiche(ErreurInfo())
SINON
	// Consommation du produit dans l'application
	...
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = inAppConsommeProduit(<Produit à consommer> , <Identifiant d'achat> , <Procédure WLangage>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la demande de consommation du produit a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Produit à consommer> : (Chaîne de caractères ou variable de type inAppProduit)`**



- Identifiant du produit à consommer, 

- Nom de la variable de type [inAppProduit](../WDLang3/1000020868.md) correspondant au produit à consommer.




**`<Identifiant d'achat> : (Chaîne de caractères)`**

Identifiant d'achat du produit à consommer. Cet identifiant est reçu lors de l'achat d'un produit avec la fonction [inAppAchèteProduit](../WDLang3/1000020873.md). Il peut également être récupéré avec la fonction [inAppListeAchat](../WDLang3/1000020888.md).

**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure WLangage (également nommée "callback") exécutée lors de la réception de la réponse à la demande de consommation du produit. Cette procédure est de la forme : 

```txt
PROCEDURE <Nom de la procédure>(<Succès> est un booléen)
```


où &lt;Succès&gt; est un booléen : 

- <u><u><u><u>Vrai</u></u></u></u> si le produit a été consommé,

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour récupérer le détail de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avant tout autre appel à une fonction WLangage (ce qui réinitialiserait l'erreur).






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- La fonction [inAppListeAchat](../WDLang3/1000020888.md) permet de récupérer les produits achetés par l'utilisateur et pas encore consommés.

- La fonction **inAppConsommeProduit** sera sans effet si elle est exécutée depuis le simulateur ou l'émulateur Android.

- Il n'est pas possible de consommer un abonnement.




<a name="XComposante"></a>

## Composante :
wd280android.jar
