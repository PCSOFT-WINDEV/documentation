


## SOAPAjouteEntête (Fonction)

***En anglais : SOAPAddHeader***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute un entête à la prochaine fonction SOAP d'un Webservice à exécuter. 

L'entête ajouté peut contenir des paramètres supplémentaires affectant la requête SOAP. Généralement, les informations ajoutées dans les entêtes ne sont pas directement des paramètres de la fonction du Webservice mais des meta informations telles que des informations d'authentification par exemple.

**Remarque** : La fonction SOAP sera exécutée par un appel à la fonction [SOAPExécute](../WDLang3/3069013.md) ou [SOAPExécuteXML](../WDLang3/3069014.md).






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ajout d'un entête à la prochaine procédure SOAP exécutée
// Cet entête permet de vérifier le niveau de sécurité utilisée par le serveur SOAP
// Si le niveau de sécurité maximum n'est pas utilisé, 
// la prochaine procédure SOAP ne sera pas exécutée
SOAPAjouteEntête("Sécurité", "SécuritéMax", "Sécurité-Niveau", Vrai)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Personnaliser l'entête du Webservice

`SOAPAjouteEntête(<Nom du webservice> , <Elément à ajouter dans l'entête>)`
---

**`<Nom du webservice> : (Webservice)`**

Nom du webservice à manipuler. Le nom du Webservice est affiché dans le volet "Explorateur de projet", dans le dossier "Webservices". 

**`<Elément à ajouter dans l'entête> : (Type simple ou complexe)`**

Variable du type de l'entête à insérer dans l'appel de la méthode du Webservice. Les différents types disponibles ont été récupérés lors de l'importation du fichier WSDL. 

Cet élément est ajouté dans l'entête à chaque appel d'une fonction SOAP du Webservice.


<a name="SYNTAXE2"></a>

### Ajouter un entête pour un Webservice spécifique

`SOAPAjouteEntête(<Nom du webservice> , <Nom du paramètre> , <Valeur du paramètre> , <Espace de nommage du paramètre>)`
---

**`<Nom du webservice> : (Webservice)`**

Nom du webservice à manipuler. Le nom du Webservice est affiché dans le volet "Explorateur de projet", dans le dossier "Webservices".

**`<Nom du paramètre> : (Chaîne de caractères)`**

Nom du paramètre supplémentaire. 

Ce paramètre supplémentaire est utilisé pour vérifier une information spécifique au serveur SOAP.

Ce paramètre est fourni dans la documentation du serveur SOAP et de ses fonctions.

**`<Valeur du paramètre> : (Tout type)`**

Valeur du paramètre supplémentaire. 

Les différentes valeurs possibles sont fournies dans la documentation du serveur SOAP et de ses fonctions.

**`<Espace de nommage du paramètre> : (Chaîne de caractères)`**

Espace de nommage (aussi appelé "NameSpace") du paramètre. 

Ce paramètre est fourni dans la documentation du serveur SOAP et de ses fonctions.


<a name="SYNTAXE3"></a>
<a name="SYNTAXE4"></a>

<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Exécution de la procédure (syntaxe 4, conservée par compatibilité)
<a name="execution_procedure_syntaxe_4_conservee_par_compatibilite_ELTPARAGRAPHE000151"></a>Il est possible d'exécuter ou non la prochaine procédure SOAP grâce à l'ajout d'un entête. Pour cela, le paramètre &lt;Exécution de la procédure&gt; doit être initialisé à <u><u><u><u>Vrai</u></u></u></u>.

Si le paramètre &lt;Exécution de la procédure&gt; est initialisé à <u><u><u><u>Vrai</u></u></u></u> :

- La fonction [SOAPExécute](../WDLang3/3069013.md) (ou [SOAPExécuteXML](../WDLang3/3069014.md)) retourne <u><u><u><u>Vrai</u></u></u></u> si la liaison avec le serveur SOAP a été établie, <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.

- Si la liaison avec le serveur SOAP a été établie et si le serveur SOAP répond aux conditions demandées par l'entête, la procédure s'exécute.

- Si la procédure a été exécutée, la fonction [SOAPDonneRésultat](../WDLang3/3069002.md) retourne :

	- le résultat de la procédure si la procédure a été exécutée avec succès,

	- une chaîne vide ("") si la procédure a échoué.




- Si la procédure a échoué ou n'a pas été exécutée, la fonction [SOAPErreur](../WDLang3/3069005.md) retourne :

	- le code d'erreur "MustUnderstand" si le serveur SOAP ne répond pas aux conditions demandées par l'entête,

	- une erreur dans les autres cas.







<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280com.dll
