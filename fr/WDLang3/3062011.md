
## sFixeParamètre (Fonction)

***En anglais : sParameter***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Fixe ou modifie les paramètres de configuration du port série, du port parallèle ou du port infrarouge spécifié. Ce paramétrage est facultatif.

Les valeurs par défaut sont les suivantes :

- Taux de transfert : 9600 Bauds

- Parité : Aucune

- 8 bits de données

- 1 bit stop




**Attention** : Le paramétrage de deux postes en liaison doit être identique.

**Remarques** : 

- Le port doit être ouvert (fonction [sOuvre](../WDLang3/3062013.md)) avant l'appel de la fonction **sFixeParamètre**. La fonction [sOuvre](../WDLang3/3062013.md) initialise automatiquement le port série. 

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La gestion des ports infrarouges n'est pas disponible.

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Seuls les ports séries sont gérés.  







<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
NumPort = sOuvre("COM1", 2000, 2000) // Ouverture de COM1
SI NumPort <> 0 ALORS
	// Paramétrage Com1 : Taux 9600, Parité paire, 
	// 8 bits de données, 1 bit de stop
	SI sFixeParamètre(NumPort, 9600, 1, 8, 0) ALORS // Paramétrage de COM1 
		// Suite traitement...
	SINON
		Erreur("Erreur de configuration de COM1", ErreurInfo(errComplet))
	FIN
	sFerme(NumPort) // Fermeture de COM1
SINON
	Erreur("Erreur d'ouverture de COM1", ErreurInfo(errComplet))
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = sFixeParamètre(<Numéro de port> , <Taux> , <Parité> , <Nb Bits Données> , <Nb Bits Stop> [, <DTR/DSR> [, <RTS/CTS> [, <XON/XOFF>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si les paramètres ont été correctement initialisés, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'obtenir plus de détails.


Remarque : Si le port n'a pas été ouvert préalablement (par la fonction [sOuvre](../WDLang3/3062013.md)), la fonction **sFixeParamètre** n'a aucun effet. 

**`<Numéro de port> : (Entier)`**

Identifiant du port manipulé : 

- Numéro de port : 

	- Numéro du port série : 1, 2, 3, ... 32 pour COM1, COM2, COM3, ... COM32.

	- Numéro du port parallèle : -1, -2, -3 ou -4 pour LPT1, LPT2, LPT3 ou LPT4.

	- Numéro du port infrarouge : 1, 2, 3, ... 32 pour IR1, IR2, IR3, ... IR32.




- Identifiant du port renvoyé par la fonction [sOuvre](../WDLang3/3062013.md) (si cette fonction a été appelée avec un nom de port). 
	![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Seul ce type de paramètre est disponible.




**`<Taux> : (Entier)`**

Taux de transfert des données (exprimé en Bauds ou Bits par seconde).

**`<Parité> : (Entier)`**

Parité du transfert :



|   |   |
| --- | --- |
| 0 | Aucune parité |
| 1 | Parité paire |
| 2 | Parité impaire |



**`<Nb Bits Données> : (Entier)`**

Nombre de bits par caractère : 4, 5, 6, 7 ou 8.

**`<Nb Bits Stop> : (Entier)`**

Nombre de bits stop :



|   |   |
| --- | --- |
| 0 | 1 bit stop |
| 1 | 1.5 bits stop |
| 2 | 2 bits stop |



**`<DTR/DSR> : (Entier optionnel)`**



- 0 (ou <u><u><u><u>Faux</u></u></u></u>, valeur par défaut) si le protocole DTR/DSR doit être ignoré et s'il doit être en mode "actif".

- 1 (ou <u><u><u><u>Vrai</u></u></u></u>) si le protocole DTR/DSR doit être en mode "Handshake", 

- 2 si le protocole DTR/DSR doit être ignoré et s'il doit être en mode "inactif". 
	Pour plus de détails sur les valeurs possibles, consultez la documentation de référence de gestion des ports de communication. 




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre est ignoré.

**`<RTS/CTS> : (Entier optionnel)`**



- 0 (ou <u><u><u><u>Faux</u></u></u></u>, valeur par défaut) si le protocole RTS/CTS doit être ignoré et s'il doit être en mode "actif".

- 1 (ou <u><u><u><u>Vrai</u></u></u></u>) si le protocole RTS/CTS doit être en mode "Handshake", 

- 2 si le protocole RTS/CTS doit être ignoré et s'il doit être en mode "inactif". 
	Pour plus de détails sur les valeurs possibles, consultez la documentation de référence de gestion des ports de communication. 




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre est ignoré.

**`<XON/XOFF> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> si le protocole XON/XOFF doit être pris en compte, 

- <u><u><u><u>Faux</u></u></u></u> (valeur par défaut) si ce protocole doit être ignoré. 




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre est ignoré.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) **Cas particulier sous Linux** : 

- Seuls les ports série peuvent être ouverts et initialisés. 

- Par défaut, l'utilisateur n'a pas accès aux ports série. Il est nécessaire de lui accorder des droits spécifiques pour manipuler les ports série. 



<a name="NOTE0_2"></a>
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Utilisation d'une librairie externe : RXTX
<a name="utilisation_une_librairie_externe_rxtx_ELTPARAGRAPHE000381"></a>En Java, l'utilisation des fonctions de manipulation des ports séries et parallèles (fonctions [sOuvre](../WDLang3/3062013.md), [sEcrit](../WDLang3/3062009.md), [sLit](../WDLang3/3062012.md), ...) nécessite la présence d'une librairie externe : RXTX. 

Cette librairie est composée d'une archive Jar et d'une ou plusieurs librairies natives dépendantes du système d'exploitation sur lequel s'exécute l'application.
 
Pour utiliser ces fonctions : 

- l'archive jar (RXTXComm.jar) doit : 

	- soit se trouver dans le même répertoire que l'application Java générée par WINDEV, 

	- soit se trouver dans le classpath d'exécution de l'application, 

	- soit être directement intégrée dans l'application générée (depuis l'assistant de génération Java). 




- la ou ou les librairies natives correspondant au système d'exploitation sur lequel s'exécute l'application doivent se trouver: 

	- soit  dans le même répertoire que l'application Java générée par WINDEV, 

	- soit dans le chemin des librairies de l'application (librarypath).







Il est possible de télécharger la librairie RXTX et sa documentation grâce au lien suivant : [http://users.frii.com/jarvi/rxtx/index.html](http://users.frii.com/jarvi/rxtx/index.html) (lien valide lors de l'écriture de cette documentation). 

**Attention** : La gestion des ports infrarouges n'est pas disponible en Java. 




<a name="NOTE0_3"></a>

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280com.dll
