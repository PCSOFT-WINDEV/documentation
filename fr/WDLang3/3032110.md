
## LDAPAjouteAttribut (Fonction)

***En anglais : LDAPAddAttribute***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute un attribut ou ajoute une nouvelle valeur à un attribut existant.

Cette fonction peut être utilisée aussi bien lors de la création d'un nouvel objet que lors de la modification d'un objet d'un serveur LDAP.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ajout d'un utilisateur Test dans un "Active Directory"
LDAPDébutAjout("MaSessionLDAP")
LDAPAjouteAttribut("MaSessionLDAP", "objectClass", "top")
LDAPAjouteAttribut("MaSessionLDAP", "objectClass", "person")
LDAPAjouteAttribut("MaSessionLDAP", "objectClass", "organizationalPerson")
LDAPAjouteAttribut("MaSessionLDAP", "objectClass", "user")
LDAPAjouteAttribut("MaSessionLDAP", "objectCategory", ...
	"CN=Person,CN=Schema,CN=Configuration,DC=societe,DC=fr")
LDAPAjouteAttribut("MaSessionLDAP", "instanceType", "4")
LDAPAjouteAttribut("MaSessionLDAP", "cn","Test")
LDAPAjouteAttribut("MaSessionLDAP", "sAMAccountName", "Test")
LDAPValideAjout("MaSessionLDAP", "cn=Test,cn=Users,dc=societe,dc=fr")
```


<a name="Exemple2"></a>



```wl
// Ajoute une valeur à un attribut. Si l'attribut n'existe pas, il est créé. 
// La valeur est ajoutée aux valeurs existantes pour cet attribut
// La nouvelle valeur est dans la chaîne sNouvelleValeur
LDAPDébutModification("NomSession")
LDAPAjouteAttribut("NomSession", "NomAttribut", sNouvelleValeur)
LDAPValideModification("NomSession", "DN")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = LDAPAjouteAttribut(<Session LDAP> , <Nom de l'attribut> , <Valeur de l'attribut>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'ajout a été effectué, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [ErreurInfo](../WDLang1/3013008.md) permet d'obtenir plus de détails sur l'erreur. 


L'ajout effectif ne sera réalisé que lors de l'appel de la fonction [LDAPValideAjout](../WDLang3/3032111.md) ou de la fonction [LDAPValideModification](../WDLang3/3032117.md).

**`<Session LDAP> : (Chaîne de caractères)`**

Nom de la session LDAP manipulée.

**`<Nom de l'attribut> : (Chaîne de caractères)`**

Nom de l'attribut à ajouter. Si cet attribut n'existe pas, il est automatiquement ajouté.

**`<Valeur de l'attribut> : (Chaîne de caractères Ansi)`**

Valeur de l'attribut ajouté ou nouvelle valeur de l'attribut.

**Remarque** : Pour certains attributs (définis par le schéma du serveur LDAP), il est possible d'avoir plusieurs valeurs pour un même attribut. Si une valeur existe déjà pour cet attribut, la nouvelle valeur sera ajoutée.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Ajout d'un nouvel objet dans un serveur LDAP
<a name="ajout_nouvel_objet_dans_serveur_ldap_ELTPARAGRAPHE000064"></a>Pour ajouter un nouvel objet dans un serveur LDAP, il est nécessaire de définir les différents attributs qui composent cet objet et leur valeur.

Pour optimiser la vitesse de création des objets, les attributs et leurs valeurs sont définis localement : une seule communication avec le serveur est établie lors de la validation de l'ajout. Les étapes sont les suivantes :

1. Initialisation de l'ajout (fonction [LDAPDébutAjout](../WDLang3/3032109.md))

2. Ajout des attributs et de leurs valeurs (fonction **LDAPAjouteAttribut**). Cet ajout peut être réalisé autant de fois que nécessaire.

3. Association des attributs et de leurs valeurs à un objet grâce à la fonction [LDAPValideAjout](../WDLang3/3032111.md).




**Attention** : 

- Les opérations de modification étant réalisées localement avant d'être effectuées sur le serveur, il est nécessaire de respecter l'ordre logique des modifications (par exemple, il ne sera pas possible de modifier un attribut supprimé par la ligne de code précédente).  

- Pour pouvoir ajouter un attribut sur un "user" de l'Active Directory, l'attribut doit avoir été déclaré préalablement dans les paramètres de l'Active Directory comme un attribut exploitable dans la base du LDAP.






<a name="XComposante"></a>

## Composante :
wd280com.dll
