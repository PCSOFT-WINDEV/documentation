


## &lt;Variable zipArchive&gt;.ChangeChemin (Fonction)

***En anglais : &lt;zipArchive variable&gt;.ChangePath***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie le chemin mémorisé d'un fichier d'une archive (au format ZIP, WDZ ou 7z). Permet de configurer le chemin d'extraction du fichier.






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
MonArchive est un zipArchive
// Ouverture d'une archive
ResOuvreArchive = MonArchive.Ouvre("C:\MesArchives\Archive.zip")
SI ResOuvreArchive = 0 ALORS
	...
	// Modification d'un chemin mémorisé de Fichier.doc
	ResChangeChemin = MonArchive.ChangeChemin("Fichier.doc", "Sauvegarde.doc")
	...
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe
<a name="SYNTAXE2"></a>

### Modifier le chemin mémorisé d'un fichier identifié par son chemin

`<Résultat> = <Archive>.ChangeChemin(<Chemin du fichier> , <Nouveau chemin du fichier>)`
---

**`<Résultat> : (Entier)`**



- 0 si la modification a été effectuée, 

- Un code d'erreur (valeur supérieure à 0) dans le cas contraire. Pour plus de détails sur ces codes d'erreur, consultez les Remarques.




**`<Archive> : (Variable de type zipArchive)`**

Nom d'une variable de type [zipArchive](../WDLang3/1000018679.md) correspondant à l'archive dans laquelle le chemin du fichier doit être modifié.

**`<Chemin du fichier> : (Chaîne de caractères)`**

Chemin mémorisé du fichier à modifier.

**`<Nouveau chemin du fichier> : (Chaîne de caractères)`**

Nouveau chemin du fichier à mémoriser (260 caractères maximum).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000272"></a>La modification du chemin d'un fichier d'une archive ne peut être réalisée que si :

- L'archive existe (la création d'une archive s'effectue avec la fonction [&lt;Variable zipArchive&gt;.Crée](../WDLang3/1000019160.md)).

- L'archive est accessible en lecture et en écriture.

- L'archive est mono-partie.




Attention : 

- **Archives au format CAB** : Cette fonction n'est pas disponible. Ce format ne permet pas de mémoriser le chemin d'un fichier.

- **Archives au format RAR** : Cette fonction n'est pas disponible. 

- **Archives au format TAR et TGZ (TAR.GZ)** : Cette fonction n'est pas disponible. 

- **Archives au format 7z** : L'archive est entièrement compressée à chaque appel de la fonction **&lt;Variable zipArchive&gt;.ChangeChemin**.

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Seules les archives au format ZIP, TAR et TGZ (TAR.GZ) sont disponibles.

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seules les archives au format ZIP sont disponibles.



<a name="NOTE0_2"></a>


### Codes d'erreur
<a name="codes_erreur_ELTPARAGRAPHE000307"></a>Les codes d'erreur retournés sont les suivants :

- 1 : Le chemin passé en paramètre n'existe pas.

- 3 : L'archive est corrompue.




Le message correspondant au code d'erreur peut être connu grâce à la fonction [zipMsgErreur](../WDLang3/3082034.md).
<a name="NOTE0_3"></a>


### Chemin mémorisé des fichiers de l'archive
<a name="chemin_memorise_des_fichiers_archive_ELTPARAGRAPHE000325"></a>Lors de l'ajout d'un fichier dans une archive (fonction [&lt;Variable zipArchive&gt;.AjouteFichier](../WDLang3/1000019050.md) et fonction [&lt;Variable zipArchive&gt;.AjouteRépertoire](../WDLang3/1000019078.md)), la portion de chemin du fichier à mémoriser dans l'archive est indiquée.

Il n'est pas nécessaire qu'un chemin modifié comporte les mêmes portions que le chemin original. Par exemple, si les chemins des fichiers comprennent les différents répertoires, le nom et l'extension du fichier, le nouveau chemin peut être composé uniquement du nom et de l'extension du fichier.
<a name="NOTE0_4"></a>


### Fichiers Zip de plus de 4 Gigas
<a name="fichiers_zip_plus_4_gigas_ELTPARAGRAPHE000347"></a>Pour utiliser la fonction **&lt;Variable zipArchive&gt;.ChangeChemin** sur des fichiers de plus de 4 Gigas, il est nécessaire d'avoir créé l'archive avec la fonction [&lt;Variable zipArchive&gt;.Crée](../WDLang3/1000019160.md) et la constante *zipEntête64*.
<a name="NOTE0_5"></a>

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280zip.dll
