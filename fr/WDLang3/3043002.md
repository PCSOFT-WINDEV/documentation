
## Proxy (Fonction)

***En anglais : Proxy***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Spécifie si les fonctions de communication utilisant le protocole HTTP ou HTTPS doivent ou non passer par un proxy pour exécuter leurs requêtes. Un proxy permet de partager l'accès à Internet entre différents postes d'un réseau.

Les fonctions de communication concernées sont les suivantes : 

- fonctions [HTTP](../WDLang3/3043004.md), 

- fonctions [DotNet](../WDLang3/3031013.md), 

- fonctions [J2EE](../WDLang3/3047002.md),

- fonctions [SOAP](../WDLang3/3069006.md), 

- fonctions Google ([Fonctions de gestion des agendas Google](../WDLang5/1000017564.md), [Fonctions de gestion des contacts Google](../WDLang5/1000017565.md), [Fonctions de gestion des cartes Google](../WDLang5/1000017566.md), [Fonctions de gestion des documents Google](../WDLang5/1000017380.md), ... ), 

- [Webservices SOAP importés](../WDLang3/3086001.md), 

- ...




Cette fonction est prise en compte uniquement au prochain appel d'une fonction utilisant le protocole HTTP.

**Remarques** : 

- La fonction **Proxy** paramètre l'accès à Internet via un proxy pour toute l'application.

- La fonction [FTPProxy](../WDLang3/1000019366.md) permet de paramétrer l'utilisation d'un proxy pour les fonctions FTP. 

- La fonction [SocketProxy](../WDLang3/1410088761.md) paramètre le passage des sockets TCP et des Websockets par un proxy SOCKS5.











<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Indique que les prochaines connexions passeront par un proxy
Proxy("192.168.0.1", 8080)

// Réalise une requête HTTP
sCodeHTML est une chaîne = HTTPRequête("http://www.pcsoft.fr")
Info("Le code HTML est : " + sCodeHTML)

// Annule la prise en compte du proxy
Proxy("")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Définir le proxy

`Proxy(<Adresse du proxy> [, <Port du proxy> [, <Login> [, <Mot de passe>]]])`
---

**`<Adresse du proxy> : (Chaîne de caractères)`**

Adresse du proxy, donnée sous la forme :

- adresse IP au format XXX.XXX.XXX.XXX (par exemple 125.5.110.100).

- URL contenant le nom du serveur (par exemple www.pcsoft.fr). Cette syntaxe est conseillée.

- adresse IP obtenue par la fonction [NetAdresseIP](../WDLang3/3056023.md).

- adresse du proxy SOCKS5 au format : 
	```txt
	socks5://<Adresse IP du proxy>
	```





**`<Port du proxy> : (Entier optionnel)`**

Numéro de port du proxy. 
Si ce paramètre n'est pas précisé, le paramètre vaut 80.

**`<Login> : (Chaîne de caractères optionnelle)`**

Authentification auprès du proxy. 
Si ce paramètre correspond à une chaîne vide ("", valeur par défaut), aucune authentification n'est effectuée.

**`<Mot de passe> : (Chaîne de caractères optionnelle)`**

Mot de passe pour authentification auprès du proxy. 
Si le &lt;Login&gt; correspond à une chaîne vide (""), ce paramètre est ignoré.  


<a name="SYNTAXE2"></a>

### Annuler l'utilisation du proxy

`Proxy("")`
---





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Utilisation d'un proxy 
<a name="utilisation_proxy_ELTPARAGRAPHE000149"></a>Grâce à la fonction **Proxy**, l'utilisateur pourra paramétrer l'application WINDEV ou WINDEV Mobile pour utiliser ou non un proxy pour le protocole HTTP. Il est conseillé de mettre en place une fenêtre de paramétrage dans l'application WINDEV pour saisir l'adresse du proxy si nécessaire.

Certains proxy nécessitent un paramétrage particulier fait au niveau du navigateur Internet Explorer. Dans ce cas, l'utilisation de la fonction **Proxy** n'est pas nécessaire : la fonction [HTTPParamètre](../WDLang3/1000018985.md) (constante *httpParamètreMode*) permettra de passer globalement par Internet Explorer pour l'envoi des requêtes HTTP.


### Comment vérifier si le proxy existe ? 
<a name="comment_verifier_proxy_existe_ELTPARAGRAPHE000165"></a>Le code suivant permet vérifier si le proxy existe grâce à la fonction [SocketConnecte](../WDLang3/3070016.md) : 


```wl
SI SocketConnecte(lsSocketNom, llSocketPort, lsSocketAdr) = Faux ALORS
	RENVOYER Faux
SINON	
	SocketFerme(lsSocketNom)
FIN
```





### Fonction Proxy et protocole SOCKS5 
<a name="fonction_docparampagetitleshort_protocole_socks5_ELTPARAGRAPHE000178"></a>Pour utiliser le protocole SOCKS5 avec la fonction [Proxy](../WDLang3/3043002.md), il suffit de préfixer le nom du serveur de proxy par "socks5://" et d'utiliser la fonction comme d'habitude (en passant le port et les identifiants).

ATTENTION : 

- Un proxy SOCKS5 ne peut pas être utilisé si le protocole HTTP est configuré pour utiliser Wininet (mode de gestion utilisant Internet Explorer). Ce mode de gestion est paramétré grâce à la constante *httpParamètreMode* de la fonction [HTTPParamètre](../WDLang3/1000018985.md).

- L’utilisation des fonctions [HTTPRequête](../WDLang3/3043007.md) et [HTTPEnvoieFormulaire](../WDLang3/1000017190.md) quand un proxy utilisant le protocole SOCKS5 est défini forcera l’utilisation de cURL. 
	Il est donc plutôt conseillé d’utiliser une variable de type [httpRequête](../WDLang3/1000021158.md) avec un proxy SOCKS5.




Exemple : 

```wl
// On ne doit pas utiliser wininet pour avoir accès au proxy SOCKS5
HTTPParamètre(httpParamètreMode, 1)
// Les fonctions suivantes utiliseront le proxy SOCKS5 
// à l'adresse 172.12.2.79:1080 avec les identifiants USER:PWD 
Proxy("socks5://172.12.2.79", 1080, "USER", "PWD")
req est un httpRequête
req.URL = "https://www.google.fr"
rep est un httpRéponse = req.Envoie()
SI ErreurDétectée ALORS
	Erreur(ErreurInfo(errComplet))
SINON
	Info("OK")
FIN
Proxy("")
```





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDProxyHTTP.gif) ***Exemples complets (WINDEV)*** : **WD Proxy HTTP** <br>Cet exemple WINDEV est un proxy HTTP simplifié.<br>Il est possible d'enregistrer les connexions et de connaître les pages consultées.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDProxyPOP3.gif) ***Exemples complets (WINDEV)*** : **WD ProxyPOP3** <br>Cet exemple présente un proxy POP3. Un proxy est un logiciel qui se connecte à un serveur à la place d'un autre.<br>On peut utiliser un proxy pour isoler un réseau local d'Internet dans un souci de sécurité par exemple.<br>Seule la machine abritant le proxy est reliée à Internet et les utilisateurs accèdent au serveur d'email à travers le proxy.<br>Dans l'exemple le proxy est utilisé pour archiver automatiquement dans une base HFSQL les emails récupérés.<br>De nombreuses extensions sont possibles pour cette application : filtrage automatique des spams, statistiques sur les emails...



<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280com.dll
