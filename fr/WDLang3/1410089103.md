


## SCPRécupèreFichier (Fonction)

***En anglais : SCPGetFile***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère un fichier via le protocole SCP. 

Rappel : Le "Secure Copy Protocol (SCP)" est un protocole assurant un transfert sécurisé des données entre un ordinateur local et un ordinateur distant ou encore entre deux ordinateurs distants. Ce protocole est basé sur une connexion SSH. 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Création de la session SSH
sessionSSH est une sshSession
sessionSSH.Adresse = "monserveur.com"
sessionSSH.Port = 22
sessionSSH.Utilisateur = "username"
sessionSSH.MotDePasseUtilisateur = "password"
sessionSSH.TimeoutConnexion = 2s

sNomFichier est une chaîne = "compta_janvier.docx"
//chemin du fichier sur le poste local
sCheminFichierLocal est une chaîne = fRepExe() + [fSep()] + sNomFichier
//chemin du fichier sur le poste distant (ici sous Linux)
sCheminFichierDistant est une chaîne = "~/compta/" + sNomFichier

//récupération du fichier via SCP
SI PAS SCPRécupèreFichier(sessionSSH, sCheminFichierDistant, ...
		sCheminFichierLocal, Progression) ALORS
	Erreur(ErreurInfo(errComplet))
SINON
	Info("Récupération terminée")
FIN


// Suivi de la progression (procédure optionnelle)
PROCÉDURE INTERNE Progression(nTailleTotale, nTailleEnCours)
	Trace(nTailleEnCours + "/" + nTailleTotale)
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = SCPRécupèreFichier(<Connexion SSH> , <Fichier distant> , <Fichier local> [, <Procédure WLangage>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le fichier a été récupéré, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Le compte-rendu d'erreur détaillé peut être obtenu avec la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Connexion SSH> : (Variable de type sshSession)`**

Nom de la variable de type [sshSession](../WDLang3/1000021157.md) utilisée pour la récupération du fichier.

**`<Fichier distant> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier à récupérer sur le poste distant. 

**`<Fichier local> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier à récupérer sur le poste via le protocole SCP. 

**`<Procédure WLangage> : (Nom de procédure optionnel)`**

Nom de la procédure WLangage (également nommée "callback") appelée lors de la récupération du fichier. Cette procédure permet de connaître la progression du transfert du fichier. 

Pour plus de détails sur cette procédure, consultez [Paramètres de la procédure utilisée par la fonction SCPRécupèreFichier](../WDLang3/1410089309.md).



<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280com.dll
