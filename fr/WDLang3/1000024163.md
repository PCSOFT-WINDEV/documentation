


## &lt;Graphe&gt;.Bulle (Fonction)

***En anglais : &lt;Chart&gt;.Tooltip***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Affiche et met en forme : 

- la bulle d'aide associée à chaque portion d'un graphe (secteur pour un graphe de type Secteur, barre pour un graphe de type Histogramme, ...). Permet également de connaître les caractéristiques de la bulle d'aide associée à chaque portion d'un graphe.

- une bulle d'aide personnalisée, associée à un point.




Par défaut, une bulle d'aide est automatiquement affichée (option *grBulleActive* à <u><u><u>Vrai</u></u></u>) lors du survol d'un graphe.






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Champ Graphe
// Affichage des pourcentages sur un histogramme
GRF_MonGraphe.Libellé(grAffichePourcentage, Vrai)
GRF_MonGraphe.Bulle(grFormatBulle, -%"[%SERIE%]" + RC + -%"[%CATEGORIE%]" + RC + -%"[%VALEUR%]")
GRF_MonGraphe.Bulle(grBulleActive, Vrai)
// Dessin du graphe
GRF_MonGraphe.Dessine()
```
<a name="Exemple2"></a>

```wl
// Champ Graphe
// Affichage d'une bulle spécifique pour un point
GRF_MonGraphe.Bulle(1, 2, "Le contenu de ma bulle d'aide")
// Dessin du graphe
GRF_MonGraphe.Dessine()
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Afficher et mettre en forme la bulle d'aide associée à un champ Graphe

`<Champ Graphe>.Bulle(<Option de la bulle à paramétrer> , <Valeur de l'option de la bulle>)`
---

**`<Champ Graphe> : (Nom de champ)`**

Nom du champ Graphe à manipuler (présent dans l'éditeur de fenêtres).


**`<Option de la bulle à paramétrer> : (Constante de type Entier)`**

Active ou non la bulle d'aide et configure ses caractéristiques.


|   |   |
| --- | --- |
| *grBulleActive* | Active ou non la bulle d'aide. |
| *grFormatBulle* | Décrit le format de la bulle d'aide. |
| *grFormatBulleBoursier* | Décrit le format de la bulle d'aide pour un graphe de type Boursier.<br> |
| *grFormatBulleEntêteMire* | Décrit le format de l'entête de la mire des graphes. |
| *grFormatBulleGrapheBulle* | Décrit le format de la bulle d'aide pour un graphe de type Graphe à bulles.<br> |
| *grFormatBulleHeatMap* | Décrit le format de la bulle d'aide pour un graphe de type Heatmap.<br> |
| *grFormatBulleNuage* | Décrit le format de la bulle d'aide pour un graphe de type Nuage de points.<br> |
| *grFormatBulleSecteur* | Décrit le format de la bulle d'aide pour un graphe de type Secteur. |
| *grFormatBulleZoneIntervalle* | Décrit le format de la bulle d'aide pour un graphe de type Zone d'intervalle. |



**`<Valeur de l'option de la bulle> : (Chaîne de caractères ou booléen)`**

Valeur de l'option de la bulle choisie. Cette valeur dépend de l'option choisie (voir tableau ci-dessus).


<a name="SYNTAXE2"></a>

### Connaître les caractéristiques de la bulle d'aide associée à un champ Graphe

`<Résultat> = <Champ Graphe>.Bulle(<Option de la bulle>)`
---

**`<Résultat> : (Type correspondant à l'option (booléen ou chaîne de caractères))`**

Valeur de l'option recherchée.

**`<Champ Graphe> : (Nom de champ)`**

Nom du champ Graphe à manipuler (présent dans l'éditeur de fenêtres).


**`<Option de la bulle> : (Constante de type Entier)`**

Option de la bulle d'aide dont la valeur est recherchée.


|   |   |
| --- | --- |
| *grBulleActive* | Active ou non la bulle d'aide. |
| *grFormatBulle* | Décrit le format de la bulle d'aide. |
| *grFormatBulleBoursier* | Décrit le format de la bulle d'aide pour un graphe de type Boursier. <br> |
| *grFormatBulleEntêteMire* | Décrit le format de l'entête de la mire des graphes. |
| *grFormatBulleGrapheBulle* | Décrit le format de la bulle d'aide pour un graphe de type Graphe à bulle.<br> |
| *grFormatBulleHeatMap* | Décrit le format de la bulle d'aide pour un graphe de type Heatmap.<br> |
| *grFormatBulleNuage* | Décrit le format de la bulle d'aide pour un graphe de type Nuage de points.<br> |
| *grFormatBulleSecteur* | Décrit le format de la bulle d'aide pour un graphe de type Secteur. |
| *grFormatBulleZoneIntervalle* | Décrit le format de la bulle d'aide pour un graphe de type Zone d'intervalle.<br> |








<a name="SYNTAXE3"></a>

### Afficher et personnaliser la bulle d'aide associée à un point

`<Champ Graphe>.grBulle(<Numéro de série> , <Numéro de catégorie> , <Valeur de la bulle>)`
---

**`<Champ Graphe> : (Nom de champ)`**

Nom du champ Graphe à manipuler (présent dans l'éditeur de fenêtres ou de pages).


**`<Numéro de série> : (Entier)`**

Numéro de la série à manipuler.

**`<Numéro de catégorie> : (Entier)`**

Numéro de la catégorie à manipuler.

**`<Valeur de la bulle> : (Chaîne de caractères)`**

Texte personnalisé de la bulle associée au point.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Options de la bulle à paramétrer
<a name="options_bulle_parametrer_ELTPARAGRAPHE000468"></a>

| Constante | Effet | Valeur de l'option |
| --- | --- | --- |
| *grBulleActive* | Active ou non la bulle d'aide. | Booléen<br><br>- <u><u><u><u>Vrai</u></u></u></u> (par défaut) pour activer la bulle d'aide,<br><br>- <u><u><u><u>Faux</u></u></u></u> pour ne pas l'afficher.<br><br><br>**Attention** : les paramètres définis pour la bulle d'aide ne sont pas ré-initialisés lors de l'affichage. |
| *grFormatBulle* | Décrit le format de la bulle d'aide. | Chaîne de caractères<br><br>- Chaîne vide pour utiliser le format par défaut.<br><br>- Combinaison des chaînes suivantes : <br>	[%SERIE%] : Affiche le libellé de la série (défini avec la fonction [&lt;Graphe&gt;.EtiquetteSérie](../WDLang3/1000024073.md)). <br>	[%CATEGORIE%] : Affiche le libellé de la catégorie (défini avec la fonction [&lt;Graphe&gt;.EtiquetteCatégorie](../WDLang3/1000024072.md)). <br>	[%VALEUR%] : Affiche la valeur <br>	Exemple : "[%VALEUR%]"+RC+"[%CATEGORIE%]"<br><br><br>Par défaut, le format est le suivant : "[%CATEGORIE%]"+RC+"[%SERIE%]"+"="+"[%VALEUR%]" |
| *grFormatBulleBoursier* | Décrit le format de la bulle d'aide pour un graphe de type Boursier. | Chaîne de caractères<br><br>- Chaîne vide pour utiliser le format par défaut.<br><br>- Combinaison des chaînes suivantes : <br>	[%SERIE%] : Affiche le libellé de la série (défini avec la fonction [&lt;Graphe&gt;.EtiquetteSérie](../WDLang3/1000024073.md)). <br>	[%CATEGORIE%] : Affiche le libellé de la catégorie (défini avec la fonction [&lt;Graphe&gt;.EtiquetteCatégorie](../WDLang3/1000024072.md)). <br>	[%MAX%] : Affiche la valeur maximale de la séance. <br>	[%MIN%] : Affiche la valeur minimale de la séance. <br>	[%DEBUT%] : Affiche la première valeur de la séance. <br>	[%FIN%] : Affiche la valeur de fin de la séance.<br><br><br>Par défaut, le format est le suivant : <br>"[%CATEGORIE%]"+RC+"Min.=[%MIN%]"+RC+"Max.=[%MAX%]"+RC+"Début=[%DEBUT%]"+RC+"Fin=[%FIN%]" |
| *grFormatBulleCirculaireDeProgrès* | Décrit le format de la bulle d'aide pour un graphe circulaire de progrès. | Chaîne de caractères <br><br><br>- Chaîne vide pour utiliser le format par défaut.<br><br>- Combinaison des chaînes suivantes : <br>	[%SERIE%] : Affiche le libellé de la série (défini avec la fonction [&lt;Graphe&gt;.EtiquetteSérie](../WDLang3/1000024073.md)). <br>	[%CATEGORIE%] : Affiche le libellé de la catégorie (défini avec la fonction [&lt;Graphe&gt;.EtiquetteCatégorie](../WDLang3/1000024072.md)). <br>	[%VALEUR%] : Affiche la valeur <br>	[%%%] : Affiche le pourcentage<br>	Exemple : "[%VALEUR%]"+RC+"[%CATEGORIE%]"+RC+"[%%%]"<br><br><br>Par défaut, le format est le suivant : "[%CATEGORIE%]"+RC+"[%VALEUR%]"+RC+"[%%%]" |
| *grFormatBulleEntêteMire* | Décrit le format de l'entête de la mire des graphes. | Chaîne de caractères<br><br>- Chaîne vide pour utiliser le format par défaut. <br><br>- Chaîne de caractères contenant la chaîne suivante : <br>	[%CATEGORIE%] : Affiche le libellé de la catégorie (défini avec la fonction [&lt;Graphe&gt;.EtiquetteCatégorie](../WDLang3/1000024072.md)). <br><br><br>Par défaut, le format est le suivant : "[%CATEGORIE%]"<br>Graphe de type Histogramme empilé : Il est possible d'ajouter le total de la pile dans la bulle d'aide d'un histogramme empilé en utilisant la syntaxe suivante : <br><br><pre><code>GRF_MonGraphe.grBulle(grFormatBulleEntêteMire, ...<br>"[%CATEGORIE%], Somme = [%VALEUR%]")</code></pre><br> |
| *grFormatBulleGrapheBulle* | Décrit le format de la bulle d'aide pour un graphe à bulles. | Chaîne de caractères<br><br>- Chaîne vide pour utiliser le format par défaut.<br><br>- Combinaison des chaînes suivantes : <br>	[%SERIE%] : Affiche le libellé de la série (défini avec la fonction [&lt;Graphe&gt;.EtiquetteSérie](../WDLang3/1000024073.md)). <br>	[%CATEGORIE%] : Affiche le libellé de la catégorie (défini avec la fonction [&lt;Graphe&gt;.EtiquetteCatégorie](../WDLang3/1000024072.md)). <br>	[%X%] : Affiche l'abscisse (première série)<br>	[%Y%] : Affiche l'ordonnée (seconde série)<br>	[%Z%] : Affiche la valeur de la troisième série. <br><br><br>Par défaut, le format est le suivant : "([%X%];[%Y%]): [%Z%]"+RC+"[%CATEGORIE%]" |
| *grFormatBulleNuage* | Décrit le format de la bulle d'aide pour un graphe de type Nuage de points. | Chaîne de caractères<br><br>- Chaîne vide pour utiliser le format par défaut.<br><br>- Combinaison des chaînes suivantes : <br>	[%SERIE%] : Affiche le libellé de la série (défini avec la fonction [&lt;Graphe&gt;.EtiquetteSérie](../WDLang3/1000024073.md)). <br>	[%CATEGORIE%] : Affiche le libellé de la catégorie (défini avec la fonction [&lt;Graphe&gt;.EtiquetteCatégorie](../WDLang3/1000024072.md)). <br>	[%X%] : Affiche l'abscisse.<br><br><br>Par défaut, le format est le suivant : "[%X%]"+RC+"[%Y%]"+RC+"[%SERIE%]"+RC+"[%CATEGORIE%]" |
| *grFormatBulleHeatMap* | Décrit le format de la bulle d'aide pour un graphe de type Heatmap. | Chaîne de caractères<br><br>- Chaîne vide pour utiliser le format par défaut.<br><br>- Combinaison des chaînes suivantes : <br>	[%SERIE%] : Affiche le libellé de la série (défini avec la fonction [&lt;Graphe&gt;.EtiquetteSérie](../WDLang3/1000024073.md)). <br>	[%CATEGORIE%] : Affiche le libellé de la catégorie (défini avec la fonction [&lt;Graphe&gt;.EtiquetteCatégorie](../WDLang3/1000024072.md)). <br>	[%X%] : Affiche l'abscisse (première série)<br>	[%Y%] : Affiche l'ordonnée (seconde série)<br>	[%Z%] : Affiche la valeur de la troisième série. <br><br><br>Par défaut, le format est le suivant : "([%X%];[%Y%]): [%Z%]"+RC+"[%CATEGORIE%]" |
| *grFormatBulleSecteur* | Décrit le format de la bulle d'aide pour un graphe de type Secteur. | Chaîne de caractères <br><br><br>- Chaîne vide pour utiliser le format par défaut.<br><br>- Combinaison des chaînes suivantes : <br>	[%SERIE%] : Affiche le libellé de la série (défini avec la fonction [&lt;Graphe&gt;.EtiquetteSérie](../WDLang3/1000024073.md)). <br>	[%CATEGORIE%] : Affiche le libellé de la catégorie (défini avec la fonction [&lt;Graphe&gt;.EtiquetteCatégorie](../WDLang3/1000024072.md)). <br>	[%VALEUR%] : Affiche la valeur <br>	[%%%] : Affiche le pourcentage<br>	Exemple : "[%VALEUR%]"+RC+"[%CATEGORIE%]"+RC+"[%%%]"<br><br><br>Par défaut, le format est le suivant : "[%CATEGORIE%]"+RC+"[%VALEUR%]"+RC+"[%%%]" |
| *grFormatBulleZoneIntervalle* | Décrit le format de la bulle d'aide pour un graphe de type Zone d'intervalle. | Chaîne de caractères <br><br><br>- Chaîne vide pour utiliser le format par défaut.<br><br>- Combinaison des chaînes suivantes : <br>	[%DEBUT%] : Affiche la valeur de début de l'intervalle. <br>	[%FIN%] : Affiche la valeur de fin de l'intervalle.  <br>	[%CATEGORIE%] : Affiche le libellé de la catégorie (défini avec la fonction [&lt;Graphe&gt;.EtiquetteCatégorie](../WDLang3/1000024072.md)).<br>	Exemple : "[%DEBUT%]"+RC+"[%FIN%]"+RC+"[%CATEGORIE%]"<br><br><br>Par défaut, le format est le suivant : "[%DEBUT%]"+RC+"[%FIN%] |


Si le format par défaut est utilisé :

- la chaîne "[%CATEGORIE%]" est ignorée si aucun libellé de catégorie n'a été spécifié avec la fonction [&lt;Graphe&gt;.EtiquetteCatégorie](../WDLang3/1000024072.md).

- la chaîne "[%SERIE%]" est ignorée si aucun libellé de série n'a été spécifié avec la fonction [&lt;Graphe&gt;.EtiquetteSérie](../WDLang3/1000024073.md).


Attention : Si vous utilisez la construction dynamique des chaînes (option "Autoriser "[% %]" dans les chaînes" dans l'onglet "Compilation" de la description du projet), une erreur de compilation apparaît (identificateur inconnu). Dans ce cas, il est nécessaire de faire précéder chaque chaîne par '-%'. Exemple : 

```wl
GRF_Echéance.Bulle(grFormatBulle, "[%CATEGORIE%]" + RC + RC+ "[%VALEUR%]" + " H")
```
devient

```wl
GRF_Echéance.Bulle(grFormatBulle, -%"[%CATEGORIE%]" + RC + RC + -%"[%VALEUR%]" + " H")
```


<a name="NOTE0_2"></a>


### Activation / Désactivation de la bulle d'aide
<a name="activation_desactivation_bulle_aide_ELTPARAGRAPHE001241"></a>L'activation / la désactivation de la bulle d'aide (constante *grBulleActive*) est prise en compte uniquement lors de l'exécution de la fonction [&lt;Graphe&gt;.Dessine](../WDLang3/1000024062.md).


<a name="NOTE0_3"></a>


### Mise en forme des éléments affichés dans la bulle d'aide
<a name="mise_forme_des_elements_affiches_dans_bulle_aide_ELTPARAGRAPHE001260"></a>Pour mettre en forme les valeurs affichées dans la bulle d'aide (valeur et pourcentage), utilisez la fonction [&lt;Graphe&gt;.Masque](../WDLang3/1000024093.md).
<a name="XComposante"></a>

## Composante :
wd280grf.dll
