


## SOAPDonneRésultat (Fonction)

***En anglais : SOAPGetResult***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie le résultat de la dernière procédure SOAP exécutée avec succès.

**Remarque** : Cette procédure a été exécutée par la fonction [SOAPExécute](../WDLang3/3069013.md) ou [SOAPExécuteXML](../WDLang3/3069014.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003069002&name=soapdonneresultat_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Renvoie le résultat de la dernière procédure SOAP exécutée
ResProcédure = SOAPDonneRésultat(SOAPRésultat)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = SOAPDonneRésultat(<Type de résultat> [, <Numéro du résultat>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Résultat de la dernière procédure SOAP exécutée avec succès.

- Si plusieurs résultats sont retournés par le serveur SOAP et si la constante *SOAPRésultat* est utilisée :

	- résultat &lt;Numéro du résultat&gt;,

	- premier résultat retourné si le paramètre &lt;Numéro du résultat&gt; n'est pas spécifié.




- Une chaîne vide ("") si :

	- aucun résultat n'a été retourné par le serveur SOAP,

	- aucune liaison n'a été établie avec le serveur SOAP.







**`<Type de résultat> : (Constante)`**

Type de résultat à retourner :


|   |   |
| --- | --- |
| *SOAPRésultat* | Résultat de la dernière procédure SOAP exécutée.<br>Ce résultat n'est utilisable que lorsque le type de retour est un type simple (entier, chaîne, ...) |
| *SOAPRésultatHTTP* | Résultat sous forme HTTP de la dernière procédure SOAP exécutée. |
| *SOAPRésultatXML* | Résultat sous forme XML de la dernière procédure SOAP exécutée .<br>Cette constante est conseillée. Le type de retour est un type composé. Les différentes valeurs pourront être extraites à l'aide des [fonctions XML](../WDLang5/3081005.md). |



**`<Numéro du résultat> : (Entier optionnel)`**

Numéro du résultat à retourner. Ce paramètre est utilisé uniquement si plusieurs résultats sont retournés par le serveur SOAP et si la constante *SOAPRésultat* est spécifiée. Dans le cas contraire, ce paramètre est ignoré.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Exemple : Les différents types de résultats
<a name="exemple_les_differents_types_resultats_ELTPARAGRAPHE000081"></a>

Une même procédure exécutée sur un serveur SOAP peut renvoyer trois types de résultats.

Considérons l'exemple suivant : 
La procédure "getTemp" (qui permet de connaître la température d'une ville) a été exécutée. Les types de résultats retournés par la fonction **SOAPDonneRésultat** sont les suivants :

- Avec la constante *SOAPRésultat* : 37

- Avec la constante *SOAPRésultatHTTP* :
	
	```txt
	HTTP/1.1 200 OK
	Date: Mon, 09 Jul 2001 09:34:49 GMT
	Status: 200
	Set-Cookie2: JSESSIONID=To16135mC022383577812008837At;Version=1;Discard;Path="/soap"
	Servlet-Engine: Tomcat Web Server/3.1 (JSP 1.1; Servlet 2.2; Java 1.3.0; 
	Linux 2.2.19-6.2.1.2RS x86; java.vendor=IBM Corporation)
	Set-Cookie: JSESSIONID=To16135mC022383577812008837At;Path=/soap
	Content-Type: text/xml; charset=utf-8
	Content-Length: 467
	Content-Language: en
	<?xml version='1.0' encoding='UTF-8'?>
	<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" 
	xmlns:xsi="http://www.w3.org/1999/XMLSchema-instance" 
	xmlns:xsd="http://www.w3.org/1999/XMLSchema">
	<SOAP-ENV:Body>
	<ns1:getTempResponse xmlns:ns1="urn:xmethods-Temperature" 
	SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
	<return xsi:type="xsd:float">37.0</return>
	</ns1:getTempResponse>
	</SOAP-ENV:Body>
	</SOAP-ENV:Envelope>
	```


- Avec la constante *SOAPRésultatXML* :
	
	```txt
	<?xml version='1.0' encoding='UTF-8'?>
	<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" 
	xmlns:xsi="http://www.w3.org/1999/XMLSchema-instance" 
	xmlns:xsd="http://www.w3.org/1999/XMLSchema">
	<SOAP-ENV:Body>
	<ns1:getTempResponse xmlns:ns1="urn:xmethods-Temperature" 
	SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
	<return xsi:type="xsd:float">37.0</return>
	</ns1:getTempResponse>
	</SOAP-ENV:Body>
	</SOAP-ENV:Envelope>
	```





<a name="XComposante"></a>

## Composante :
wd280com.dll
