
## sEcrit (Fonction)

***En anglais : sWrite***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Écrit une chaîne de caractères dans le buffer de sortie du port série, du port parallèle ou du port infrarouge spécifié. La fin de l'écriture de la chaîne peut être contrôlée grâce à la fonction [sDansFileSortie](../WDLang3/3062005.md).

**Remarques** : 

- Le port doit être préalablement ouvert (fonction [sOuvre](../WDLang3/3062013.md)).

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La gestion des ports infrarouges n'est pas disponible.

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Seuls les ports séries sont gérés.  





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Le port COM2 est ouvert
NumPort = sOuvre("COM2", 2000, 2000) // Ouverture de COM2
SI NumPort <> 0 ALORS
	sMessage est une chaîne 
	// Envoi d'un message au buffer de sortie de COM2
	sEcrit(NumPort, sMessage)
	// Attendre la fin de l'écriture
	BOUCLE
		SI sDansFileSortie(2) = 0 ALORS SORTIR
	FIN
	Info("Fin de l'écriture")
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe
<a name="SYNTAXE2"></a>

### Écrit un buffer dans le buffer de sortie d'un port

`<Résultat> = sEcrit(<Numéro de port> , <Buffer à écrire>)`
---

**`<Résultat> : (Entier)`**



- Nombre de caractères écrits, 

- 0 si le temps d'attente est terminé et si l'écriture n'a pas été effectuée.




**`<Numéro de port> : (Entier)`**

Identifiant du port manipulé :

- Numéro de port :

	- Numéro du port série : 1, 2, 3, ... 32 pour COM1, COM2, COM3, ... COM32.

	- Numéro du port parallèle : -1, -2, -3 ou -4 pour LPT1, LPT2, LPT3 ou LPT4.

	- Numéro du port infrarouge : 1, 2, 3, ... 32 pour IR1, IR2, IR3, ... IR32.
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La gestion des ports infrarouges n'est pas disponible.




- Identifiant du port renvoyé par la fonction [sOuvre](../WDLang3/3062013.md) (si cette fonction a été appelée avec un nom de port). 
	![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Seul ce type de paramètre est disponible.




**`<Buffer à écrire> : (Buffer)`**

Buffer à écrire dans le buffer de sortie.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Divers
<a name="divers_ELTPARAGRAPHE000147"></a>

- Si le port n'a pas été ouvert par la fonction [sOuvre](../WDLang3/3062013.md), la fonction **sEcrit** n'a aucune action.

- Une application 32 bits est bloquée pendant la durée du transfert. Pour éviter ce blocage, il faut préciser le temps d'attente entre deux écritures dans la fonction [sOuvre](../WDLang3/3062013.md). Lorsque le temps d'attente est terminé et si l'écriture n'a pas pu être réalisée, **sEcrit** renvoie 0.
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La fonction **sEcrit** est bloquante durant le transfert même si une durée d'attente a été spécifiée dans la fonction [sOuvre](../WDLang3/3062013.md).

- La durée de transfert effective de la chaîne dépend de la vitesse de transmission.

- La chaîne ou le buffer est transféré(e) automatiquement.

- Le WLangage ne permet pas de gérer les signaux de contrôle.

- La durée d'attente accordée pour la lecture ou l'écriture d'un caractère est spécifiée avec la fonction [sOuvre](../WDLang3/3062013.md). 

	- Si cette durée vaut 1s avec une lecture de 1024 octets, la durée d'attente effective sera de 1024s. 

	- Si cette durée vaut "-1s" avec une lecture de 1024 octets, la durée d'attente effective sera de 1s.


 Il est ainsi possible d'éviter un blocage lors d'un problème de lecture ou d'écriture sur le port d'impression.



<a name="NOTE0_2"></a>




### Transmission entre deux postes utilisant des formats de chaînes de caractères différents (UNICODE et ANSI)
<a name="transmission_entre_deux_postes_utilisant_des_formats_chaines_caracteres_differents_unicode_ansi_ELTPARAGRAPHE000193"></a>Lors de la transmission de messages entre deux postes utilisant un format de chaînes de caractères différent (par exemple Windows (ANSI) et Windows Mobile (UNICODE)), certaines conversions sont nécessaires  :


|   |   |   |   |
| --- | --- | --- | --- |
| **Format des chaînes de caractères sur le poste en cours** | **Ecriture**<br>(fonction **sEcrit**) | **Lecture**<br>(fonction [sLit](../WDLang3/3062012.md)) |
| **Chaîne au format ANSI** | **Chaîne au format UNICODE** |
| ANSI<br>(PC sous Windows par exemple) | La chaîne de caractères sera au format ANSI | Aucune conversion nécessaire | Conversion nécessaire (fonction [UnicodeVersAnsi](../WDLang1/3024025.md)) |
| UNICODE | La chaîne de caractères sera au format UNICODE | Conversion nécessaire (fonction [AnsiVersUnicode](../WDLang1/3024002.md)) | Aucune conversion nécessaire |




![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) **Cas particulier sous Linux** : 

- Seuls les ports série peuvent être ouverts et initialisés. 

- Par défaut, l'utilisateur n'a pas accès aux ports série. Il est nécessaire de lui accorder des droits spécifiques pour manipuler les ports série. 



![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Utilisation d'une librairie externe : RXTX
<a name="utilisation_une_librairie_externe_rxtx_ELTPARAGRAPHE000422"></a>En Java, l'utilisation des fonctions de manipulation des ports séries et parallèles (fonctions [sOuvre](../WDLang3/3062013.md), [sEcrit](../WDLang3/3062009.md), [sLit](../WDLang3/3062012.md), ...) nécessite la présence d'une librairie externe : RXTX. 

Cette librairie est composée d'une archive Jar et d'une ou plusieurs librairies natives dépendantes du système d'exploitation sur lequel s'exécute l'application.
 
Pour utiliser ces fonctions : 

- l'archive jar (RXTXComm.jar) doit : 

	- soit se trouver dans le même répertoire que l'application Java générée par WINDEV, 

	- soit se trouver dans le classpath d'exécution de l'application, 

	- soit être directement intégrée dans l'application générée (depuis l'assistant de génération Java). 




- la ou ou les librairies natives correspondant au système d'exploitation sur lequel s'exécute l'application doivent se trouver: 

	- soit  dans le même répertoire que l'application Java générée par WINDEV, 

	- soit dans le chemin des librairies de l'application (librarypath).







Il est possible de télécharger la librairie RXTX et sa documentation grâce au lien suivant : [http://users.frii.com/jarvi/rxtx/index.html](http://users.frii.com/jarvi/rxtx/index.html) (lien valide lors de l'écriture de cette documentation). 

**Attention** : La gestion des ports infrarouges n'est pas disponible en Java. 
<a name="NOTE0_3"></a>

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280com.dll
