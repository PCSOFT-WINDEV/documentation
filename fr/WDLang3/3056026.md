


## NetOuvreAccèsDistant (Fonction)

***En anglais : NetOpenRemoteAccess***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Établit une connexion distante. Cette fonction peut être utilisée pour manipuler des emails grâce au protocole POP3 sur serveur distant.

**Remarque** : La connexion distante pourra ensuite être fermée grâce à la fonction [NetFermeAccèsDistant](../WDLang3/3056021.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Lance la connexion Internet sur un PC
// Le nom de la connexion à utiliser est celui défini dans la liste des 
// connexions du PC (Panneau de configuration).
Rapport est un entier = NetOuvreAccèsDistant("Connexion_LiveBox")
SI Rapport = 0 ALORS
	...
	NetFermeAccèsDistant()
SINON
	Erreur("Erreur lors de la connexion", NetMsgErreur(Rapport))
FIN
```
<a name="Exemple2"></a>

```wl
// Ouverture de la connexion sur un Smartphone
sNomConnexion est une chaîne 
nRetourCnx est un entier
// Le nom de la connexion est fourni par l'opérateur
sNomConnexion = "Bouygues Internet "
// Ouverture de la connexion
nRetourCnx = NetOuvreAccèsDistant(sNomConnexion) 
SI nRetourCnx = 0 ALORS
	// Traitement souhaité
	// ...
	NetFermeAccèsDistant(sNomConnexion)
SINON
	Erreur("Erreur lors de la connexion :", NetMsgErreur(nRetourCnx))
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = NetOuvreAccèsDistant(<Nom de l'accès> [, <Mot de passe>] [, <Fermeture automatique>])`
---

**`<Résultat> : (Entier)`**



- 0 si la connexion a été établie, 

- un code d'erreur dans le cas contraire. Ce code d'erreur peut être utilisé avec la fonction [NetMsgErreur](../WDLang3/3056019.md) afin de connaître la cause exacte de l'erreur et le message correspondant.




**`<Nom de l'accès> : (Chaîne de caractères)`**

Nom de la connexion "Accès réseau à distance" défini dans Windows. La liste des accès distants installés sur un poste peut être obtenue avec la fonction [NetListeAccèsDistant](../WDLang3/3056027.md).
Si la connexion est déjà active (si elle a été ouverte manuellement ou par une autre application), elle est automatiquement récupérée.

**`<Mot de passe> : (Chaîne de caractères optionnelle)`**

Mot de passe associé à la connexion.

**`<Fermeture automatique> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> (valeur par défaut) : la fermeture de la connexion sera automatique à la fin de l'application ou lors de l'appel à la fonction [NetFermeAccèsDistant](../WDLang3/3056021.md) sans paramètres (valable uniquement pour la dernière connexion ouverte par la fonction **NetOuvreAccèsDistant**).

- <u><u><u><u>Faux</u></u></u></u> : la fermeture de l'application ne ferme pas la connexion. Permet par exemple de faire une application qui ouvre une connexion. De même, la fonction [NetFermeAccèsDistant](../WDLang3/3056021.md) sans paramètres ne fermera pas la connexion. Pour fermer cette connexion, il est nécessaire de préciser le nom de l'accès en paramètre.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Connexion pour l'accès réseau à distance
<a name="connexion_pour_acces_reseau_distance_ELTPARAGRAPHE000068"></a>La création d'une connexion pour l'accès réseau à distance est réalisée dans le panneau de configuration sous Windows. Les informations suivantes seront demandées lors de la création de la connexion :

- le libellé de la connexion (utilisé par la fonction **NetOuvreAccèsDistant**),

- le numéro de téléphone à composer,

- le nom de login ou d'utilisateur,

- le modem, le protocole, etc.




Ces données sont fournies par le fournisseur d'accès.

Lors de l'exécution de la connexion par un simple double clic sur l'icône correspondante, il est possible de spécifier un mot de passe pour cette connexion. Ce mot de passe peut être enregistré afin d'être utilisé à chaque lancement de cette connexion.
<a name="NOTE0_2"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000087"></a>

- Attention : La connexion à un réseau distant peut prendre un certain temps. L'exécution de l'application en cours est bloquée pendant toute la durée de la connexion.

- Une seule connexion peut être ouverte à un moment donné.

- Il est conseillé de vérifier le bon fonctionnement de la connexion sous Windows avant d'exécuter la fonction **NetOuvreAccèsDistant**.




<a name="XComposante"></a>

## Composante :
wd280com.dll
