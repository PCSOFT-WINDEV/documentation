


## CarteInfoXY (Fonction)

***En anglais : MapInfoXY***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie la position géographique (latitude et longitude) correspondant à un point d'un champ Carte.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ajout d'un marqueur à l'emplacement du clic dans un champ Carte 
// (code à placer dans le code de clic du champ)
MaPosition est une géoPosition
MaPosition = CarteInfoXY(CARTE_Position, SourisPosX(), SourisPosY())
SI ErreurDétectée = Faux ALORS
	MonMarqueur est un Marqueur
	MonMarqueur.Position = MaPosition
	CarteAjouteMarqueur(CARTE_Position, MonMarqueur)
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = CarteInfoXY(<Champ Carte> , <X> , <Y>)`
---

**`<Résultat> : (Variable de type géoPosition)`**

Variable de type [géoPosition](../WDLang3/1000019191.md) correspondant à la position géographique du point sur la carte. 
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u> et le détail de l'erreur peut être obtenu avec la fonction [ErreurInfo](../WDLang1/3013008.md).

**`<Champ Carte> : (Nom de champ)`**

Nom du champ Carte à manipuler. Si ce paramètre correspond à une chaîne vide (""), le champ Carte auquel appartient l'événement en cours sera utilisé.

**`<X> : (Entier)`**

Coordonnée X (abscisse) en pixels du point à analyser. Cette coordonnée est relative au coin haut gauche du champ. Si cette coordonnée est négative, la position sera recherchée pour un point non affiché sur la carte. 

**`<Y> : (Entier)`**

Coordonnée Y (ordonnée) en pixels du point à analyser. Cette coordonnée est relative au coin haut gauche du champ. Si cette coordonnée est négative, la position sera recherchée pour un point non affiché sur la carte. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Pour récupérer les coordonnées d'un point du champ Carte sur lequel est survenu un événement (clic par exemple) : 

	- utilisez les fonctions [SourisPosX](../WDLang1/3071007.md) et [SourisPosY](../WDLang1/3071008.md). 




- Le calcul de la position tient compte du niveau de zoom dans le champ Carte au moment de l'appel de la fonction. Plus le niveau de zoom est important, plus la position renvoyée est précise.




<a name="XComposante"></a>

## Composante :
wd280obj.dll
