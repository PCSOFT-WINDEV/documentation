


## Procédure WLangage appelée par la fonction zipAjouteRépertoire



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Procédure WLangage (également appelée "Callback) appelée lors de l'ajout de chaque fichier par la fonction [zipAjouteRépertoire](../WDLang3/3082014.md). Cette procédure permet d'archiver une arborescence en omettant un ou plusieurs fichiers. 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Déclaration et initialisation des variables
NomRépertoire est une chaîne
NomArchive est une chaîne = "MonArchive"
CodeErreurCréation est un entier
CodeErreurAjout est un entier

// Création d'une archive
CodeErreurCréation = zipCrée(NomArchive, "C:\MonRépertoire\MesArchives\ArchivePdf.wdz")

// Affichage du message d'erreur si l'archive n'a pas été créée
SI CodeErreurCréation = 0 ALORS
	// Sélection du répertoire
	NomRépertoire = fRepSélecteur("", "", "Répertoire à ajouter")

	// Ajoute les fichiers "BMP" du répertoire sélectionné
	// et de ses sous-répertoires dans l'archive
	CodeErreurAjout = zipAjouteRépertoire(NomArchive, NomRépertoire, Vrai, ...
		 zipDisque, zipAjouteRépertoire_Callback)

	// Affichage du message d'erreur si les fichiers n'ont pas été ajoutés
	SI CodeErreurAjout <> 0 ALORS
		 Erreur(zipMsgErreur(CodeErreurAjout))
	FIN
SINON
	Erreur(zipMsgErreur(CodeErreurCréation))
FIN

PROCEDURE INTERNE zipAjouteRépertoire_Callback(NomFichier est une chaîne)
	SI fExtraitChemin(NomFichier, fExtension) ~= ".bmp" ALORS
		RENVOYER VRAI
	SINON
		RENVOYER Faux
	FIN
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = zipAjouteRépertoire_Callback(<Nom du fichier>)`
---

**`<Résultat> : (Booléen)`**



- Si la procédure renvoie <u><u><u><u>Vrai</u></u></u></u>, le fichier doit être intégré à l'archive.

- Si la procédure renvoie <u><u><u><u>Faux</u></u></u></u>, le fichier ne doit pas être intégré à l'archive.




**`<Nom du fichier> : (Chaîne de caractères)`**

Chemin du fichier qui va être traité par la fonction [zipAjouteRépertoire](../WDLang3/3082014.md). 




