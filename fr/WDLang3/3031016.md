
## DotNetExécute (Fonction)

***En anglais : DotNetRun***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Exécute une procédure sur un serveur DotNet.

**Remarque** : Les paramètres de la procédure doivent être spécifiés avant l'utilisation de la fonction **DotNetExécute** grâce à la structure DotNet (voir Notes).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Cet exemple est basé sur la présence du module eightball sur le site "www.gotdotnet.com". 
// Si le module n'était plus disponible sur le site, l'exemple ne fonctionnerait plus
DotNet.Valeur[1] = "mettre ici une question, en anglais de préférence" + ...
	"pour le fun de l'exemple : que pourra-t-on nous répondre ?"
DotNet.Nom[1] = "psQuestion"
DotNet.Type[1] = DotNetTypeChaîne
SI DotNetExécute("www.gotdotnet.com/playground/services/EightBall/eightballws.asmx", ...
	"Ask", "http://tempuri.org/", "http://tempuri.org/Ask") ALORS
	Info(DotNetDonneRésultat(DotNetRésultat))
SINON
	SI DotNetErreur(DotNetErrMessage) ~= "" ALORS
		Erreur(ErreurInfo()) 
	SINON
		Erreur("Erreur DotNet : " + ...
			DotNetErreur(DotNetErrMessage))
	FIN
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = DotNetExécute(<URL du serveur> , <Nom de la procédure> [, <Espace de nommage de la procédure> [, <Action de la procédure> [, <Style d'encodage>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la communication avec le serveur a été établie, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<URL du serveur> : (Chaîne de caractère)`**

URL du serveur à contacter. Ce paramètre est fourni dans la documentation du serveur de services Web XML DotNet et de ses procédures.

**`<Nom de la procédure> : (Chaîne de caractères)`**

Nom de la procédure à exécuter sur le serveur spécifié. Ce paramètre est fourni dans la documentation du serveur de services Web XML DotNet et de ses procédures.
Attention à respecter la casse (majuscules / minuscules) dans le nom de la procédure.

**`<Espace de nommage de la procédure> : (Chaîne de caractères optionnelle)`**

Espace de nommage (appelé aussi "NameSpace") de la procédure à exécuter. Ce paramètre est fourni dans la documentation du serveur de services Web XML DotNet et de ses procédures.

**`<Action de la procédure> : (Chaîne de caractères optionnelle)`**

Action de la procédure (appelé aussi "DotNetAction"). Ce paramètre est fourni dans la documentation du serveur de services Web XML DotNet et de ses procédures.

**`<Style d'encodage> : (Chaîne de caractères optionnelle)`**

Style d'encodage de la procédure (appelé aussi "EncodingStyle"). Ce paramètre est fourni dans la documentation du serveur de services Web XML DotNet et de ses procédures.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Paramètres de la procédure à exécuter
<a name="parametres_procedure_executer_ELTPARAGRAPHE000060"></a>Pour passer des paramètres à une procédure exécutée sur un serveur de services Web XML DotNet, WINDEV ou WEBDEV utilise la structure suivante :

| Variable | Type | Détail |
| --- | --- | --- |
| DotNet.NameSpace | Chaîne de caractères optionnelle | Espace de nommage (appelé "NameSpace") du paramètre |
| DotNet.Nom | Chaîne de caractères | Nom du paramètre |
| DotNet.ParamXML | Chaîne de caractères optionnelle | Description complète du paramètre sous forme XML. Si ce paramètre est spécifié, les autres paramètres (Valeur, Nom, Type, NameSpace et StyleEncodage) sont ignorés. |
| DotNet.StyleEncodage | Chaîne de caractères optionnelle | Style d'encodage (appelé "EncodingStyle") du paramètre |
| DotNet.Type | Constante | Type du paramètre |
| DotNet.Valeur | Tout type | Valeur du paramètre |

Cette structure doit être utilisée pour chaque paramètre. Par exemple :

DotNet.Valeur[1] = 94010
DotNet.Nom[1] = "CodePostal"
DotNet.Type[1] = *DotNetTypeChaîne*

Cette structure est équivalente à :

DotNet.ParamXML[1] = &lt;CodePostal xsi:type="xsd:string"&gt;94010&lt;/CodePostal&gt;


<a name="NOTE0_2"></a>




### Type du paramètre
<a name="type_parametre_ELTPARAGRAPHE000148"></a>Le type du paramètre peut être :

| Constante | Type |
| --- | --- |
| DotNetTypeBinaireBase64 | Binaire |
| DotNetTypeBinaireHexa | Binaire hexadecimal |
| DotNetTypeBooléen | Booléen |
| DotNetTypeChaîne | Chaîne de caractères |
| DotNetTypeChaîneNormalisée | Chaîne de caractères sans retour chariot (RC) et sans tabulation (TAB) |
| DotNetTypeDécimal | Tout nombre sans limite |
| DotNetTypeEntier | Entier compris entre - 2 147 483 648 et + 2 147 483 647) |
| DotNetTypeEntierCourt | Entier court |
| DotNetTypeEntierCourtNonSigné | Entier court non signé |
| DotNetTypeEntierIllimité | Entier (sans limite) |
| DotNetTypeEntierLong | Entier long |
| DotNetTypeEntierLongNonSigné | Entier long non signé |
| DotNetTypeEntierNégatif | Entier négatif (sauf 0) |
| DotNetTypeEntierNonNégatif | Entier non négatif |
| DotNetTypeEntierNonPositif | Entier non positif |
| DotNetTypeEntierNonSigné | Entier non signé |
| DotNetTypeEntierPositif | Entier positif (sans 0) |
| DotNetTypeOctet | Octet |
| DotNetTypeOctetNonSigné | Octet non signé |
| DotNetTypeRéel | Réel |
| DotNetTypeRéelDouble | Réel double |
| DotNetTypeURL | Adresse URL |




<a name="NOTE0_3"></a>




### Appel de la fonction DotNetExécute
<a name="appel_fonction_dotnetexecute_ELTPARAGRAPHE000250"></a>Après l'appel de la fonction **DotNetExécute** :

- Les paramètres de la procédure sont effacés.

- La structure de l'entête spécifié avec la fonction [DotNetAjouteEntête](../WDLang3/3031009.md) est effacée.

- La fonction [DotNetDonneRésultat](../WDLang3/3031005.md) permet de récupérer le résultat de la procédure exécutée.

- La fonction [DotNetErreur](../WDLang3/3031004.md) permet de récupérer le message d'erreur de la procédure exécutée.






<a name="XComposante"></a>

## Composante :
wd280com.dll
