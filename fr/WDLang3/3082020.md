


## zipDécoupe (Fonction)

***En anglais : zipSplit***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Découpe une archive en plusieurs sous-archives d'une taille donnée.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003082020&name=zipdecoupe_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
ResOuvreArchive, ResDécoupe sont des entiers
Archive est un zipArchive

// Ouverture de l'archive "Archive"
ResOuvreArchive = zipOuvre(Archive, "D:\Sauvegardes\Sauvegarde.WDZ")

SI ResOuvreArchive = 0 ALORS
	// Découpage d'une archive en plusieurs sous-archives (1,4 Mo chacune)
	ResDécoupe = zipDécoupe(Archive, "A:\Archive.WDZ", 1400*1024)
	...
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = zipDécoupe(<Archive> , <Destination de l'archive> [, <Taille des sous-archives> [, <Suppression de l'archive originale> [, <Espace réservé> [, <Gestion de la jauge>]]]])`
---

**`<Résultat> : (Entier)`**



- 0 si l'archive a été découpée, 

- Un code d'erreur (valeur supérieure à 0) dans le cas contraire. Pour plus de détails sur ces codes d'erreur, consultez les [Remarques](#NOTE0_1).




**`<Archive> : (Chaîne de caractères ou variable de type zipArchive)`**

Nom de l'archive à manipuler.
Ce nom peut correspondre :

- soit au nom d'une archive défini avec la fonction [zipOuvre](../WDLang3/3082044.md) ou la fonction [zipCrée](../WDLang3/3082003.md).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) soit au nom d'une variable de type [zipArchive](../WDLang3/1000018679.md).




**`<Destination de l'archive> : (Chaîne de caractères)`**

Chemin complet de la nouvelle archive multi-parties (260 caractères maximum). Ce chemin doit contenir le nom de l'archive multi-parties à créer. Il est possible de spécifier le même chemin et nom que l'archive originale : l'archive originale sera écrasée par l'archive découpée.

**`<Taille des sous-archives> : (Entier optionnel)`**

Taille en octets des volumes à créer. La taille par défaut des sous-archives est égale à 1,4 Mo (1400\*1024 octets). La taille minimale est égale à 300 Ko par sous-archive (300\*1024 octets).

**`<Suppression de l'archive originale> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'archive originale doit être détruite pendant le découpage, 

- <u><u><u><u>Faux</u></u></u></u> (valeur par défaut) si l'archive originale ne doit pas être détruite pendant le découpage.




**`<Espace réservé> : (Entier optionnel)`**

Taille (en octets) d'un espace réservé à diminuer de la première sous-archive. La taille de la première sous-archive correspondra à : &lt;Taille des sous-archives&gt; - &lt;Espace réservé&gt;.

**`<Gestion de la jauge> : (Chaîne de caractères optionnelle)`**

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Nom d'un champ Jauge présent dans une fenêtre. Cette jauge affichera la progression du découpage.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000136"></a>Le découpage d'une archive ne peut être réalisé que si :

- L'archive existe (la création d'une archive s'effectue avec la fonction [zipCrée](../WDLang3/3082003.md)).

- L'archive est accessible en lecture et en écriture.

- L'archive est mono-partie.




**Attention** : 

- **Archives au format "CAB"** : Cette fonction n'est pas disponible.

- **Archives au format "RAR"** : Cette fonction n'est pas disponible.

- **Archives au format "7z"** : Cette fonction n'est pas disponible.

- **Archives au format "TAR" et "TARGZ"** : Cette fonction n'est pas disponible.




![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Rappel : Seules les archives au format ZIP, TAR et TGZ (TAR.GZ) sont disponibles.
<a name="NOTE0_2"></a>


### Codes d'erreur
<a name="codes_erreur_ELTPARAGRAPHE000163"></a>Les codes d'erreur retournés sont les suivants :

- 1 : Le chemin passé en paramètre n'existe pas.

- 2 : Accès interdit : l'utilisateur n'a pas les droits nécessaires.

- 3 : L'archive est corrompue.

- 6 : Les sous-archives ne sont pas dans l'ordre.

- 22 : Il est interdit de découper une archive au format zip en une seule partie.




Le message correspondant au code d'erreur peut être connu grâce à la fonction [zipMsgErreur](../WDLang3/3082034.md).
<a name="NOTE0_3"></a>


### Destination de l'archive
<a name="destination_archive_ELTPARAGRAPHE000183"></a>&lt;Destination&gt; doit correspondre à un support accessible en lecture et en écriture. Ce support peut être :

- Un disque dur.

- Un lecteur réseau auquel une lettre de lecteur a été attribué. Il est impossible d'effectuer un découpage vers un lecteur UNC.







|   |   |
| --- | --- |
| **Extension de l'archive multi-parties (format WDZ)** | **Extension de l'archive multi-parties (format ZIP)** |
| Si l'extension de l'archive n'est pas précisée, l'extension par défaut de la première sous-archive sera .WDZ.<br><br><br>L'extension des autres sous-archives seront automatiquement rajoutées (".001" à ".999").<br>Par exemple : si &lt;Destination&gt; = "C:\\MesArchives\\ArchiveDécoupée.WDZ", l'archive sera découpée dans le répertoire "C:\\MesArchives" de la manière suivante :<br><br>- ArchiveDécoupée.WDZ<br><br>- ArchiveDécoupée.001<br><br>- ArchiveDécoupée.002<br><br>- ArchiveDécoupée.003<br><br>- ...<br><br><br> | Si l'extension de l'archive n'est pas précisée, l'extension par défaut de la première sous-archive sera .ZIP.<br><br><br>L'extension des autres sous-archives seront automatiquement rajoutées (".Z01" à ".Z99").<br>Par exemple : si &lt;Destination&gt; = "C:\\MesArchives\\ArchiveDécoupée.ZIP", l'archive sera découpée dans le répertoire "C:\\MesArchives" de la manière suivante :<br><br>- ArchiveDécoupée.ZIP<br><br>- ArchiveDécoupée.Z01<br><br>- ArchiveDécoupée.Z02<br><br>- ArchiveDécoupée.Z03<br><br>- ...<br><br><br> |


<a name="NOTE0_4"></a>


### Suppression de l'archive originale
<a name="suppression_archive_originale_ELTPARAGRAPHE000239"></a>Lorsque le paramètre &lt;Suppression de l'archive originale&gt; a pour valeur <u><u><u><u>Vrai</u></u></u></u>, le découpage entraîne la fermeture de l'archive originale ainsi que sa destruction au fur et à mesure du découpage.

Remarques :

- Pour minimiser l'espace disque nécessaire pour effectuer le découpage, configurez le paramètre &lt;Suppression de l'archive originale&gt; à <u><u><u><u>Vrai</u></u></u></u>. En effet, pour découper une archive de taille importante, l'espace disque nécessaire correspond à deux fois la taille de l'archive : une fois pour l'archive originale et une fois pour l'archive découpée.

- Ce paramètre doit être utilisé avec **prudence**. En effet, en cas de problème pendant le découpage, l'archive originale et l'archive découpée seront toutes les deux détruites. Si l'espace disque est suffisant, il est préférable de découper l'archive originale et de supprimer cette même archive originale par la suite.



<a name="NOTE0_5"></a>


### Espace réservé
<a name="espace_reserve_ELTPARAGRAPHE000261"></a>La taille de la première sous-archive peut être plus petite que la taille des autres sous-archives. Il suffit d'indiquer la taille en octets à diminuer de la première sous-archive dans le paramètre &lt;Espace réservé&gt;.



La taille de la première sous-archive correspondra à : &lt;Taille des sous-archives&gt; - &lt;Espace réservé&gt;. 

Remarque : La taille de la première sous-archive doit respecter la formule suivante : 

```txt
<Taille des sous-archives> - <Espace réservé> > 300 Ko
```



<a name="NOTE0_6"></a>


### Ordre de découpage
<a name="ordre_decoupage_ELTPARAGRAPHE000284"></a>Lors du découpage d'une archive, l'ordre de découpage est le suivant :

- Création de la sous-archive N (extension ".NNN-1" ou ".ZNN-1").

- ...

- Création de la sous-archive 2 (extension ".001" ou "Z01").

- Création de la sous-archive 1 (extension ".WDZ" ou "ZIP").




Par exemple, si une archive est découpée en 4 parties, 4 sous-archives seront construites. La quatrième sous-archive (extension ".003" ou "Z03") sera créée en premier. La première sous-archive (extension ".WDZ" ou ".ZIP") sera créée en dernier.


<a name="NOTE0_7"></a>


### Nombre de parties
<a name="nombre_parties_ELTPARAGRAPHE000304"></a>La fonction [zipNbPartieNécessaire](../WDLang3/3082052.md) permet de connaître le nombre de parties nécessaires au découpage de l'archive.

La fonction [zipNbPartie](../WDLang3/3082029.md) permet de connaître le nombre de sous-archives d'une archive multi-parties.

**Remarque** : Le découpage d'une archive au format ZIP en une seule partie est interdit et provoque une erreur.
<a name="NOTE0_8"></a>


### Fermeture de l'archive
<a name="fermeture_archive_ELTPARAGRAPHE000323"></a>Après utilisation de la fonction **zipDécoupe** sur une archive, cette archive ne se ferme pas. Il est nécessaire d'utiliser les fonctions :

- [zipFerme](../WDLang3/3082005.md) pour fermer l'archive mono-partie.

- [zipOuvre](../WDLang3/3082044.md) pour ouvrir la nouvelle archive multi-parties.




**Remarque** : Si le paramètre &lt;Suppression de l'archive originale&gt; a pour valeur <u><u><u><u>Vrai</u></u></u></u>, l'archive originale est automatiquement fermée par le découpage.
<a name="NOTE0_9"></a>


### Actions réalisables sur une archive multi-parties
<a name="actions_realisables_sur_une_archive_multiparties_ELTPARAGRAPHE000348"></a>Certaines fonctions d'archivage sont utilisables uniquement sur des archives mono-partie (ajout et suppression de fichiers, création d'un exécutable auto-extractible, ...). Pour effectuer ces opérations, il suffit de regrouper les sous-archives (fonction [zipRegroupe](../WDLang3/3082046.md)) pour obtenir une archive mono-partie.

A partir d'une archive multi-parties, il est uniquement possible de :

- Regrouper les différentes parties (fonction [zipRegroupe](../WDLang3/3082046.md)).

- Obtenir diverses informations sur l'archive et sur les fichiers de l'archive (fonctions [zipExtraitChemin](../WDLang3/3082023.md), [zipInfoFichier](../WDLang3/3082040.md), [zipListeFichier](../WDLang3/3082031.md), etc.).

- Extraire les fichiers (fonctions [zipExtraitFichier](../WDLang3/3082019.md), [zipExtraitTout](../WDLang3/3082011.md)).




<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280zip.dll
