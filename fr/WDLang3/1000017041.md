


## SocketCréeSSL (Fonction)

***En anglais : SocketCreateSSL***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Créé un socket sécurisé selon le protocole SSL.  
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Création d'un serveur de Sockets SSL avec un certificat
sSocketSSL est une chaîne = "sSocketSSL"
// Ici utilisation du hash du certificat, 
// propriété "Empreinte numérique" dans le gestionnaire de certificats
// (certmgr.msc)
SI PAS SocketCréeSSL(sSocketSSL, 5043, "9d a4 84 fc f6 62 92 90 9a 62 d4 " + ...
		"ca 65 fb 08 7e 06 45 de 24", HashCertificat) ALORS
	Erreur(ErreurInfo())
	RETOUR
SINON	
	Info("Socket serveur SSL démarrée")

	// Suite du socket serveur ...

	// En fin de traitement il faudra fermer le socket
	SocketFerme(sSocketSSL)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = SocketCréeSSL(<Nom du socket> , <Numéro de port> , <Identifiant du certificat> [, <Options SSL> [, <Adresse>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le socket a été créé, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. En cas d'erreur, il est possible de connaître le détail de l'erreur grâce à la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Nom du socket> : (Chaîne de caractères)`**

Nom à donner au socket. Ce nom sera utilisé dans toutes les fonctions socket. Attention le nom du socket est "case-sensitive".

**`<Numéro de port> : (Entier)`**

Numéro de port à donner au socket. Ce numéro doit être compris entre 5000 et 65000. Ce numéro sera indiqué lors de la connexion des postes client au poste serveur. Cette connexion sera réalisée par la fonction [SocketConnecteSSL](../WDLang3/1000017042.md).

**`<Identifiant du certificat> : (Chaîne de caractères)`**

Nom ou hash du certificat à utiliser (en fonction des &lt;Options SSL&gt; indiquées) : 

- nom du certificat si la constante *NomCertificat* est utilisée, 

- hash du certificat si la constante *HashCertificat* est utilisée. Les espaces sont autorisés dans le Hash. Le hash du certificat peut être obtenu dans la propriété "Empreinte numérique" dans le gestionnaire de certificats (certmgr.msc) du poste, exemple :
	"9d a4 84 fc f6 62 92 90 9a 62 d4 ca 65 fb 08 7e 06 45 de 24"




Ce certificat doit être muni d'une clé privée, installée sur la machine serveur. Pour plus de détails, consultez [Comment créer un certificat SSL ?](../WDLang3/3070021.md)

**`<Options SSL> : (Combinaison de constantes de type entier optionnelle)`**

Protocole et le mode d'identification utilisés : 


|   |   |
| --- | --- |
| *ProtocoleSSL2* | Utilisation du protocole SSL2. |
| *ProtocoleSSL3* | Utilisation du protocole SSL3. |
| *ProtocoleTLS1* | Utilisation du protocole TLS1 |
| *ProtocoleTLS1_1* | Utilisation du protocole TLS 1.1 |
| *ProtocoleTLS1_2* | Utilisation du protocole TLS 1.2 |
| *ProtocoleTLS1_3* | Utilisation du protocole TLS 1.3 |






|   |   |
| --- | --- |
| *HashCertificat* | Le paramètre &lt;Identifiant du certificat&gt; correspond au hash du certificat. |
| *NomCertificat* | Le paramètre &lt;Identifiant du certificat&gt; correspond au nom du certificat. |


Par défaut, la combinaison utilisée est : *ProtocoleTLS1* + *ProtocoleTLS1_1* + *ProtocoleTLS1_2* + *NomCertificat*.

**`<Adresse> : (Chaîne de caractères optionnelle)`**

Adresse IP sur laquelle le socket doit être créé sur le poste en cours. Si le poste en cours est associé à plusieurs adresses IP (ou plusieurs cartes réseau), ce paramètre permet de choisir l'adresse IP à associer au socket.

Cette adresse IP peut être donnée sous la forme :

- adresse IP au format XXX.XXX.XXX.XXX ( par exemple 125.5.110.100).

- adresse IP contenant le nom du serveur (par exemple www.pcsoft.fr). Cette syntaxe est conseillée.




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) L'adresse IP peut également être obtenue par la fonction [NetAdresseIP](../WDLang3/3056023.md).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Re-création de socket
<a name="recreation_socket_ELTPARAGRAPHE000118"></a>Si un socket n'est pas fermé correctement par la fonction [SocketFerme](../WDLang3/3070015.md) (redémarrage du poste par exemple), la recréation du socket peut être relativement longue. Il est en effet nécessaire d'attendre que le système libère le socket.
<a name="NOTE0_2"></a>


### Réutilisation d'une adresse déjà utilisée
<a name="reutilisation_une_adresse_deja_utilisee_ELTPARAGRAPHE000128"></a>Par défaut, la fonction **SocketCréeSSL** permet de réutiliser une adresse déjà utilisée (par l'application elle-même ou par une autre application). Pour ne pas autoriser ce fonctionnement, il suffit de saisir le code suivant :


```wl
Socket.Option = SocketAdresseUnique
```


**Remarque** : Cette option permet également de savoir si une adresse ou un port est déjà utilisé. Dans ce cas, la fonction **SocketCréeSSL** renvoie une erreur.

<a name="XComposante"></a>

## Composante :
wd280com.dll
