
## sFinEvénement (Fonction)

***En anglais : sEndEvent***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Débranche la détection d'un événement sur un port série. L'événement a été géré grâce à la fonction [sEvénement](../WDLang3/3062014.md).




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Détection de caractères sur le port COM1
sEvénement(1, sEveCaractèreReçu, "Lecture")
sEvénement(1, sEveBreak, "Break")
...
sFinEvénement(1, sEveBreak)
...

// --Procédure Lecture(NumPort, Event)
Trace(sLit(1, sDansFileEntrée(1)))
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = sFinEvénement(<Numéro de port> [, <Événement à arrêter>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la fonction a été exécutée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Numéro de port> : (Entier)`**



- Numéro de port série concerné (1, 2, 3, ...32 pour COM1, COM2, COM3, ... COM32). 

- Numéro de port renvoyé par la fonction [sOuvre](../WDLang3/3062013.md) (si cette fonction a été appelée avec un nom de port).




**`<Événement à arrêter> : (Constante ou combinaison de constantes de type Entier optionnelle)`**

Événement dont la gestion doit être arrêtée. Si ce paramètre n'est pas spécifié, tous les événements gérés sur le port sont débranchés.


|   |   |
| --- | --- |
| *sEveBreak* | Réception d'un événement "Break line" |
| *sEveCaractèreReçu* | Réception d'un caractère |
| *sEveCTS* | Changement d'état CTS |
| *sEveDSR* | Changement d'état DSR |
| *sEveEnvoiTerminé* | Le buffer de sortie est vide |
| *sEveErreur* | Détection d'une erreur sur la ligne<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *sEveErreurImprimante* | Erreur d'imprimante détectée<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *sEveFileEntrée80* | Le buffer d'entrée est plein à 80%<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *sEveRing* | Détection du signal "Ring" (sonnerie) |
| *sEveRLSD* | Changement d'état RLSD<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Fermeture du port
<a name="fermeture_port_ELTPARAGRAPHE000128"></a>Lors de la fermeture du port, tous les événements gérés sur ce port sont débranchés. Lors de la ré-ouverture du port, il est donc nécessaire de ré-exécuter la fonction [sEvénement](../WDLang3/3062014.md) pour définir les événements gérés sur ce port.


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Utilisation d'une librairie externe : RXTX
<a name="utilisation_une_librairie_externe_rxtx_ELTPARAGRAPHE000268"></a>En Java, l'utilisation des fonctions de manipulation des ports séries et parallèles (fonctions [sOuvre](../WDLang3/3062013.md), [sEcrit](../WDLang3/3062009.md), [sLit](../WDLang3/3062012.md), ...) nécessite la présence d'une librairie externe : RXTX. 

Cette librairie est composée d'une archive Jar et d'une ou plusieurs librairies natives dépendantes du système d'exploitation sur lequel s'exécute l'application.
 
Pour utiliser ces fonctions : 

- l'archive jar (RXTXComm.jar) doit : 

	- soit se trouver dans le même répertoire que l'application Java générée par WINDEV, 

	- soit se trouver dans le classpath d'exécution de l'application, 

	- soit être directement intégrée dans l'application générée (depuis l'assistant de génération Java). 




- la ou ou les librairies natives correspondant au système d'exploitation sur lequel s'exécute l'application doivent se trouver: 

	- soit  dans le même répertoire que l'application Java générée par WINDEV, 

	- soit dans le chemin des librairies de l'application (librarypath).







Il est possible de télécharger la librairie RXTX et sa documentation grâce au lien suivant : [http://users.frii.com/jarvi/rxtx/index.html](http://users.frii.com/jarvi/rxtx/index.html) (lien valide lors de l'écriture de cette documentation). 

**Attention** : La gestion des ports infrarouges n'est pas disponible en Java. 

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280com.dll
