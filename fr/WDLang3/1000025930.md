


## ModbusConnecteTCP (Fonction)

***En anglais : ModbusConnectTCP***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Connecte un poste client à un serveur Modbus via le protocole TCP.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// On crée une session et on se connecte au serveur Modbus à l'adresse 192.168.1.18 sur le port 3275
Session est un modbusSession
Session = ModbusConnecteTCP("192.168.1.18",3275)

// Si la connexion échoue, affiche l'erreur
SI ErreurDétectée = Vrai ALORS
	Trace(ErreurInfo())
SINON
	// Ecrit une valeur dans le registre 0x42 du serveur.
	ModbusEcritRegistre(Session, 0x42,0xCAFE)
FIN

// Déconnection du serveur
ModbusDéconnecte(Session)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Session> = ModbusConnecteTCP(<Adresse> [, <Port> [, <Identifiant esclave> [, <Délai de connexion>]]])`
---

**`<Session> : (Variable de type modbusSession)`**

Variable de type [modbusSession](../WDLang3/1000025924.md) qui permet de communiquer avec le serveur Modbus.

**`<Adresse> : (Chaîne de caractères)`**

Adresse du serveur Modbus. Cette adresse peut correspondre à : 

- une adresse IPv4 ou IPv6, 

- un nom de domaine (par exemple, "modbusserver.com").




**`<Port> : (Entier optionnel)`**

Numéro du port à utiliser pour la connexion TCP. 
Par défaut, ce paramètre correspond à 502, le port standard pour le Modbus TCP.

**`<Identifiant esclave> : (Entier optionnel)`**

Nombre compris entre 0 et 255 indiquant à quel esclave se connecter quand il se situe derrière une passerelle (par exemple, une passerelle Modbus TCP vers Modbus RTU). 
Par défaut, ce paramètre a pour valeur 255, valeur de broadcast.

**`<Délai de connexion> : (Entier optionnel)`**

Délai d'attente maximal de connexion au serveur Modbus, exprimé en millisecondes. Ce paramètre peut correspondre à : 

- un entier correspondant au nombre de millisecondes, 

- une variable de type Durée, 

- l'indication directe de la durée (par exemple 20 s ou 10 ms). 






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Après l'appel de la fonction **ModbusConnecteTCP**, il est conseillé de vérifier la variable [ErreurDétectée](../WDLang1/3087001.md) pour s'assurer qu'il n'y a pas d'erreur.

- La fonction **ModbusConnecteTCP** est bloquante tant qu'une connexion n'est pas réussie ou que le délai de connexion n'est pas dépassé.

- L'identifiant de l'esclave est présent dans la variable [modbusSession](../WDLang3/1000025924.md). Si des opérations doivent être effectuées sur plusieurs esclaves différents, il est possible de changer l'identifiant de l'esclave dans la variable [modbusSession](../WDLang3/1000025924.md) pour éviter la réouverture de la session. 




<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280com.dll
