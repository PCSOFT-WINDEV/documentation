


## &lt;Variable zipArchive&gt;.ExtraitChemin (Fonction)

***En anglais : &lt;zipArchive variable&gt;.ExtractPath***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie le chemin d'un fichier de l'archive. Cette archive peut être au format ZIP, CAB, RAR, WDZ ou 7z.

Ce chemin correspond au chemin mémorisé lors de l'ajout du fichier dans l'archive (fonction [&lt;Variable zipArchive&gt;.AjouteFichier](../WDLang3/1000019050.md) ou [&lt;Variable zipArchive&gt;.AjouteRépertoire](../WDLang3/1000019078.md)).










<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
Archive est un zipArchive
// Ouverture de l'archive "Archive"
ResOuvreArchive = Archive.Ouvre("D:\Sauvegardes\Sauvegarde.zip")
SI ResOuvreArchive = 0 ALORS
	...
	// Recherche du fichier "Fichier.txt"
	ResFichierTrouvé = Archive.ChercheFichier("Fichier.txt")
	// Chemin du fichier trouvé
	CheminExtrait = Archive.ExtraitChemin(ResFichierTrouvé, zipRépertoire)
	...
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Archive>.ExtraitChemin(<Indice du fichier> [, <Portion du chemin à extraire>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Portion de chemin demandée.

**`<Archive> : (Variable de type zipArchive)`**

Nom d'une variable de type [zipArchive](../WDLang3/1000018679.md) correspondant à l'archive à manipuler.

**`<Indice du fichier> : (Entier)`**

Indice du fichier dans l'archive.  Cet indice peut être connu grâce à la fonction [&lt;Variable zipArchive&gt;.ChercheFichier](../WDLang3/1000026330.md).

**`<Portion du chemin à extraire> : (Constante optionnelle ou combinaison de constantes)`**

Portion de chemin du fichier à extraire :


|   |   |
| --- | --- |
| *zipDisque* | Renvoie uniquement le nom de l'unité (format WDZ uniquement). Pour les archives de type différent de WDZ, cette constante n'a pas d'effet. <br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas disponible. En effet, il n'y a pas de racine dans les chemins des répertoires.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée. |
| *zipExtension* | Renvoie uniquement l'extension du fichier (précédée du ".") |
| *zipFichier* | Renvoie uniquement le nom du fichier (sans son extension) |
| *zipRépertoire* | Renvoie les différents répertoires du fichier (le nom et l'extension du fichier ne sont pas renvoyés) |


Par défaut, le chemin extrait correspond au chemin mémorisé.  

![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Ce paramètre n'est pas disponible : seuls le nom du fichier et son extension sont mémorisés et donc peuvent être extraits.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Rappel
<a name="rappel_ELTPARAGRAPHE000330"></a>

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Seules les archives au format ZIP, TAR et TGZ (TAR.GZ) sont disponibles.

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seules les archives au format ZIP sont disponibles.



<a name="NOTE0_2"></a>


### Exemple de chemin extrait
<a name="exemple_chemin_extrait_ELTPARAGRAPHE000345"></a>Si le chemin mémorisé est "C:\\Temp\\Donnée\\Fichier.txt", la fonction **&lt;Variable zipArchive&gt;.ExtraitChemin** renvoie :

- *zipExtension* : .txt

- *zipFichier* : Fichier

- *zipRépertoire* : \\Temp\\Donnée\\

- *zipDisque* : C:

- *zipFichier*+*zipExtension* : Fichier.txt

- *zipRépertoire*+*zipFichier* : \\Temp\\Donnée\\Fichier

- ...


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La constante *zipDisque*est ignorée.![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Seuls le nom du fichier et son extension peuvent être extraits.**Archives au format 7z** : Le "\\" au début du chemin n'est pas renvoyé.
<a name="NOTE0_3"></a>


### Chemin mémorisé
<a name="chemin_memorise_ELTPARAGRAPHE000374"></a>Le tableau ci-dessous présente les chemins mémorisés dans l'archive en fonction :

- du chemin d'accès du fichier,

- de la portion mémorisée du chemin.




Le répertoire en cours est : "C:\\Temp".


|   |   |   |   |   |
| --- | --- | --- | --- | --- |
| **Fonction zipAjouteFichier** | **Localisation du fichier** | *zipAucun* | *zipRépertoire* | *zipDisque* |
| zipAjouteFichier("Archi",...<br>"Fichier.txt") | C:\\Temp\\Fichier.txt | Fichier.txt | Fichier.txt | Fichier.txt |
| zipAjouteFichier("Archi",...<br>"Donnée\\Fichier.txt") | C:\\Temp\\Donnée\\Fichier.txt | Fichier.txt | Donnée\\Fichier.txt | Donnée\\Fichier.txt |
| zipAjouteFichier("Archi",...<br>"D:\\Donnée\\Fichier.txt") | D:\\Donnée\\Fichier.txt | Fichier.txt | Donnée\\Fichier.txt | D:\\Donnée\\Fichier.txt |


**Remarque** : Si la constante *zipDisque* est utilisée : 

- le format WDZ mémorise le chemin complet du fichier (lettre du lecteur comprise). 

- le format ZIP ne mémorise pas la lettre du lecteur.

- le format 7z mémorise uniquement les répertoires. 


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La constante *zipDisque* est ignorée.![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Le répertoire et le disque ne sont pas mémorisés dans le chemin de l'archive. Seuls le nom du fichier et son extension sont mémorisés. 
<a name="NOTE0_4"></a>


### Indice des fichiers dans l'archive
<a name="indice_des_fichiers_dans_archive_ELTPARAGRAPHE000450"></a>Lors de l'ajout d'un fichier dans une archive, un indice est automatiquement attribué au fichier. Cet indice correspond à l'ordre d'intégration des fichiers dans l'archive. Pour sélectionner un fichier de l'archive, il est possible d'utiliser :

- soit l'indice de l'élément (l'indice d'un élément peut être connu grâce à la fonction [&lt;Variable zipArchive&gt;.ChercheFichier](../WDLang3/1000026330.md)).

- soit le chemin mémorisé de l'élément.




<a name="XComposante"></a>

## Composante :
wd280zip.dll
