
## Procédure WLangage appelée par la fonction SCPRécupèreFichier



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Procédure WLangage (également nommée "callback") appelée par la fonction [SCPRécupèreFichier](../WDLang3/1410089103.md) lors de la récupération du fichier via le protocole SCP sur un poste local. Cette procédure permet de connaître la progression du transfert du fichier sur le poste local.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Création de la session SSH
sessionSSH est une sshSession
sessionSSH.Adresse = "monserveur.com"
sessionSSH.Port = 22
sessionSSH.Utilisateur = "username"
sessionSSH.MotDePasseUtilisateur = "password"
sessionSSH.TimeoutConnexion = 2s

sNomFichier est une chaîne = "compta_janvier.docx"
//chemin du fichier sur le poste local
sCheminFichierLocal est une chaîne = fRepExe() + [fSep()] + sNomFichier
//chemin du fichier sur le poste distant (ici sous Linux)
sCheminFichierDistant est une chaîne = "~/compta/" + sNomFichier

//récupération du fichier via SCP
SI PAS SCPRécupèreFichier(sessionSSH, sCheminFichierDistant, ...
		sCheminFichierLocal, Progression) ALORS
	Erreur(ErreurInfo(errComplet))
SINON
	Info("Récupération terminée")
FIN


// Suivi de la progression (procédure optionnelle)
PROCÉDURE INTERNE Progression(nTailleTotale, nTailleEnCours)
	Trace(nTailleEnCours + "/" + nTailleTotale)
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`SCPRécupèreFichier_Callback(<Taille totale> , <Taille envoyée>)`
---

**`<Taille totale> : (Entier)`**

Taille totale (en octets) du fichier à récupérer. 

**`<Taille envoyée> : (Entier)`**

Taille (en octets) du fichier déjà récupérée.







<a name="XComposante"></a>

## Composante :
wd280com.dll
