


## zipInfoFichier (Fonction)

***En anglais : zipInfoFile***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie les caractéristiques d'un fichier de l'archive :

- Le nom du fichier et son chemin mémorisé.

- La taille originale du fichier.

- La taille compressée du fichier.

- La date et l'heure de création du fichier.

- La date et l'heure de modification du fichier.

- La date et l'heure d'accès du fichier.

- Les attributs du fichier.

- Le mode de cryptage du fichier.




Le fichier de l'archive peut être identifié par son numéro ou par son chemin dans l'archive.
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les caractéristiques suivantes ne sont pas disponibles : la date et l'heure de création du fichier, la date et l'heure d'accès du fichier et le mode de cryptage du fichier. 








<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003082040&name=zipinfofichier_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
Archive est un zipArchive

// Ouverture d'une archive
ResOuvreArchive = zipOuvre(Archive, "C:\MesArchives\Archive.zip")

SI ResOuvreArchive = 0 ALORS
	...
	// Informations sur un fichier d'une archive
	ResInfoFichier = zipInfoFichier(Archive, "C:\Répertoire\Fichier.doc")
	// Affichage des informations du fichier
	Info("Les informations du fichier sont : ", ResInfoFichier)
	...
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Obtenir des informations sur un fichier identifié par son indice

`<Résultat> = zipInfoFichier(<Archive> , <Indice d'un fichier dans l'archive>)`
---

**`<Résultat> : (Chaîne de caractères)`**



- Chaîne vide en cas d'échec de la fonction (fichier inexistant dans l'archive, etc.).

- Caractéristiques du fichier de l'archive spécifiée :
	
	```txt
	<Chemin et nom du fichier> + TAB + <Taille originale du fichier> + TAB + 
	<Taille compressée du fichier> + TAB +
	<Date et heure de création du fichier (AAAAMMJJHHmmSS)> + TAB + 
	<Date et heure de modification du fichier (AAAAMMJJHHmmSS)> + TAB + 
	<Date et heure d'accès du fichier (AAAAMMJJHHmmSS)> + TAB + 
	<Attributs du fichier> + TAB + <Mode de cryptage du fichier>
	```


	- Les attributs du fichier correspondent à une ou plusieurs lettres (ou "ERR" en cas d'erreur). Les lettres utilisées sont :

		- R : Fichier en lecture seule. Le fichier est uniquement accessible en lecture.

		- H : Fichier caché. Le nom du fichier est généralement grisé ou invisible dans l'explorateur.

		- S : Fichier système. Le fichier est un fichier système de Windows.

		- A : Fichier "archive". Cet attribut indique que le fichier peut être archivé. Certains programmes se servent de cet attribut pour savoir quels fichiers ont été sauvegardés.

		- D : Répertoire ou sous-répertoire. Le fichier est un répertoire ou un sous-répertoire.




- Le mode de cryptage du fichier correspond à "+" pour un fichier crypté (au format zip ou WDZ) et "N" pour un fichier normal.




**Archives au format Zip et format 7z** : Seule la date de dernière modification est renvoyée. 
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La chaîne renvoyée est de la forme : 

```txt
<Chemin et nom du fichier> + TAB + <Taille originale du fichier> + TAB + 
<Taille compressée du fichier> + TAB + 
<Date et heure de modification du fichier (AAAAMMJJHHmmSS)> + TAB + 
<Attributs du fichier>
```


**`<Archive> : (Chaîne de caractères ou variable de type zipArchive)`**

Nom de l'archive à manipuler.
Ce nom peut correspondre :

- soit au nom d'une archive défini avec la fonction [zipOuvre](../WDLang3/3082044.md) ou [zipCrée](../WDLang3/3082003.md).

- soit au nom d'une variable de type [zipArchive](../WDLang3/1000018679.md). 
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les variables de type [zipArchive](../WDLang3/1000018679.md) ne sont pas disponibles en JAVA.




**`<Indice d'un fichier dans l'archive> : (Entier)`**

Indice d'un fichier contenu dans l'archive. Les caractéristiques de ce fichier sont demandées. Cet indice peut être connu grâce à la fonction [zipChercheFichier](../WDLang3/3082002.md).  


<a name="SYNTAXE2"></a>

### Obtenir des informations sur un fichier identifié par son chemin

`<Résultat> = zipInfoFichier(<Archive> , <Chemin d'un fichier dans l'archive>)`
---

**`<Résultat> : (Chaîne de caractères)`**



- Chaîne vide en cas d'échec de la fonction (fichier inexistant dans l'archive, etc.).

- Caractéristiques du fichier de l'archive spécifiée : 
	
	```txt
	<Chemin et nom du fichier> + TAB + <Taille originale du fichier> + TAB + 
	<Taille compressée du fichier> + TAB + 
	<Date et heure de création du fichier (AAAAMMJJHHmmSS)> + TAB + 
	<Date et heure de modification du fichier (AAAAMMJJHHmmSS)> + TAB + 
	<Date et heure d'accès du fichier (AAAAMMJJHHmmSS)> + TAB + 
	<Attributs du fichier> + TAB + <Mode de cryptage du fichier>
	```


	- Les attributs du fichier correspondent à une ou plusieurs lettres (ou "ERR" en cas d'erreur). Les lettres utilisées sont :

		- R : Fichier en lecture seule. Le fichier est uniquement accessible en lecture.

		- H : Fichier caché. Le nom du fichier est généralement grisé ou invisible dans l'explorateur.

		- S : Fichier système. Le fichier est un fichier système de Windows.

		- A : Fichier "archive". Cet attribut indique que le fichier peut être archivé. Certains programmes se servent de cet attribut pour savoir quels fichiers ont été sauvegardés.

		- D : Répertoire ou sous-répertoire. Le fichier est un répertoire ou un sous-répertoire.




- Le mode de cryptage du fichier correspond à "+" pour un fichier crypté (au format Zip ou WDZ) et "N" pour un fichier normal.




**Archives au format Zip et format 7z** : Seule la date de dernière modification est renvoyée. 
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La chaîne renvoyée est de la forme : 

```txt
<Chemin et nom du fichier> + TAB + <Taille originale du fichier> + TAB + 
<Taille compressée du fichier> + TAB + 
<Date et heure de modification du fichier (AAAAMMJJHHmmSS)> + TAB + 
<Attributs du fichier>
```


**`<Archive> : (Chaîne de caractères ou variable de type zipArchive)`**

Nom de l'archive à manipuler.
Ce nom peut correspondre :

- soit au nom d'une archive défini avec la fonction [zipOuvre](../WDLang3/3082044.md) ou [zipCrée](../WDLang3/3082003.md).

- soit au nom d'une variable de type [zipArchive](../WDLang3/1000018679.md). 
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les variables de type [zipArchive](../WDLang3/1000018679.md) ne sont pas disponibles en JAVA.




**`<Chemin d'un fichier dans l'archive> : (Chaîne de caractères)`**

Chemin mémorisé d'un fichier contenu dans l'archive. Les caractéristiques de ce fichier sont demandées.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Rappel
<a name="rappel_ELTPARAGRAPHE000256"></a>

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Seules les archives au format ZIP, TAR et TGZ (TAR.GZ) sont disponibles.

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seules les archives au format ZIP sont disponibles.



<a name="NOTE0_2"></a>


### Indice des fichiers dans l'archive
<a name="indice_des_fichiers_dans_archive_ELTPARAGRAPHE000270"></a>Lors de l'ajout d'un fichier dans une archive, un indice est automatiquement attribué au fichier. Cet indice correspond à l'ordre d'intégration des fichiers dans l'archive. Pour sélectionner un fichier de l'archive, il est possible d'utiliser :

- soit l'indice de l'élément (l'indice d'un élément peut être connu grâce à la fonction [zipChercheFichier](../WDLang3/3082002.md)).

- soit le chemin mémorisé de l'élément.



<a name="NOTE0_3"></a>


### Chemin mémorisé
<a name="chemin_memorise_ELTPARAGRAPHE000285"></a>Le tableau ci-dessous présente les chemins mémorisés dans l'archive en fonction :

- du chemin d'accès du fichier,

- de la portion mémorisée du chemin.




Le répertoire en cours est : "C:\\Temp".


|   |   |   |   |   |
| --- | --- | --- | --- | --- |
| **Fonction zipAjouteFichier** | **Localisation du fichier** | *zipAucun* | *zipRépertoire* | *zipDisque* |
| zipAjouteFichier("Archi",<br>"Fichier.txt") | C:\\Temp\\Fichier.txt | Fichier.txt | Fichier.txt | Fichier.txt |
| zipAjouteFichier("Archi",<br>"Donnée\\Fichier.txt") | C:\\Temp\\Donnée\\Fichier.txt | Fichier.txt | Donnée\\Fichier.txt | Donnée\\Fichier.txt |
| zipAjouteFichier("Archi",<br>"D:\\Donnée\\Fichier.txt") | D:\\Donnée\\Fichier.txt | Fichier.txt | Donnée\\Fichier.txt | D:\\Donnée\\Fichier.txt |


**Remarque** : Si la constante *zipDisque* est utilisée, le format WDZ mémorise le chemin complet du fichier (lettre du lecteur comprise) alors que le format ZIP ne mémorise pas la lettre du lecteur.
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La constante *zipDisque* est ignorée.
<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Cryptage d'un fichier dans une archive
<a name="cryptage_fichier_dans_une_archive_ELTPARAGRAPHE000354"></a>Un fichier peut être crypté dans une archive grâce à la fonction [zipMotDePasse](../WDLang3/3082053.md).

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280zip.dll
