
## SNMPOuvreSession (Fonction)

***En anglais : SNMPStartSession***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ouvre une session SNMP.  
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
IDSession est un entier
// Ouverture de session
IDSession = SNMPOuvreSession("TestDoc", "public")
SI IDSession = -1 ALORS Erreur("Erreur d'ouverture de session " + ErreurInfo())
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = SNMPOuvreSession(<Adresse de l'agent> , <Communauté SNMP> [, <Timeout> [, <Numéro de port>]])`
---

**`<Résultat> : (Entier)`**



- Identifiant de la session SNMP, 

- -1 en cas d'erreur. La fonction [ErreurInfo](../WDLang1/3013008.md) permet d'obtenir plus de renseignements sur le problème rencontré.




**`<Adresse de l'agent> : (Chaîne de caractères)`**

Adresse de l'agent avec lequel la communication par SNMP doit être établie. Cette adresse peut être donnée sous la forme :

- adresse IP au format XXX.XXX.XXX.XXX (par exemple 125.5.110.100).

- URL contenant le nom du serveur (par exemple www.pcsoft.fr). Cette syntaxe est conseillée.




**`<Communauté SNMP> : (Chaîne de caractères)`**

Nom de la communauté SNMP utilisé par la connexion. Cette communauté indique les droits associés à la session SNMP. En général, tous les agents SNMP supportent la communauté "public" en mode lecture seule. Il peut exister d'autres communautés (private par exemple) pour l'accès en lecture / écriture.

**`<Timeout> : (Entier optionnel ou Durée optionnelle)`**

Timeout en millisecondes d'une requête SNMP. Cette valeur doit être comprise entre 1000 et 10000. Ce paramètre peut correspondre à : 

- un entier correspondant au nombre de millisecondes, 

- une variable de type Durée, 

- l'indication directe de la durée (par exemple 1 s ou 10 ms). 


Par défaut, ce paramètre a pour valeur 5000 (5 secondes).

**`<Numéro de port> : (Entier optionnel)`**

Numéro de port auquel se connecter. Par défaut, cette valeur est 161 (port SNMP standard).  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>



## Remarques
<a name="NOTE0_2"></a>
SNMP utilise le protocole UDP qui n'est pas un protocole connecté. La fonction **SNMPOuvreSession** ne permet donc pas de savoir si l'agent contacté est effectivement joignable. La fonction **SNMPOuvreSession** retourne une session du moment que la requête SNMP a été envoyée, même si l'agent n'est pas disponible. Pour tester si un agent est effectivement connecté, il est possible d'utiliser : 

- la fonction [NetNomMachine](../WDLang3/3056014.md), 

- la fonction [Ping](../WDLang1/3014013.md), 

- une communication via sockets, ...




<a name="XComposante"></a>

## Composante :
wd280com.dll
