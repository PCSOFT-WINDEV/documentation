


## &lt;Variable emailSessionIMAP&gt;.NbMessage (Fonction)

***En anglais : &lt;emailIMAPSession variable&gt;.NbMessage***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie le nombre de messages reçus actuellement présents sur le serveur d'emails (protocole IMAP).
Ce nombre de messages évolue en fonction des emails reçus ou réellement supprimés du serveur d'emails (via une commande "expunge", par exemple, vider la corbeille depuis un WebMail). Il est également possible de forcer la destruction de tous les emails supprimés grâce à la fonction [&lt;Variable emailSessionIMAP&gt;.Détruit](../WDLang3/1000022279.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MaSession est un EmailSessionIMAP

nbMSG est un entier = MaSession.NbMessage()
POUR I = 1 A nbMSG
	EmailLitMessage(MaSession, I)
	SI Email.EnDehors <> Vrai ALORS
		CL.NOM = Email.Expediteur
		CL.MESSAGE_TXT = Email.Message
		...
	SINON
		Info("Ce message a été supprimé")
	FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Session IMAP>.NbMessage()`
---

**`<Résultat> : (Entier)`**



- Nombre de messages reçus sur le serveur dans la session d'emails en cours, 

- -1 en cas d'erreur. Pour plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Session IMAP> : (Variable de type emailSessionIMAP)`**

Nom de la variable de type [emailSessionIMAP](../WDLang3/1000018957.md) correspondant à la session d'email à manipuler.




<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Messages supprimés (protocole IMAP)
<a name="messages_supprimes_protocole_imap_ELTPARAGRAPHE000290"></a>Si un message a été supprimé par la fonction [EmailSupprimeMessage](../WDLang3/3032027.md), ce message est réellement supprimé de la session : 

- lors de la prochaine commande "expunge" (par exemple, vider la corbeille depuis un WebMail).

- lors de l'utilisation de la fonction [&lt;Variable emailSessionIMAP&gt;.Détruit](../WDLang3/1000022279.md) pour forcer la destruction de tous les emails supprimés.




<a name="XComposante"></a>

## Composante :
wd280com.dll
