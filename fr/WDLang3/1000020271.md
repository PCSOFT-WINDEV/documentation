
## Gestion des contacts (appareils mobiles)
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000133"></a>
Dans vos applications mobiles, vous pouvez directement gérer les contacts de votre appareil mobile (Android, iPhone, iPad, Universal Windows). 

Pour cela, le WLangage met à votre disposition : 

- les fonctions Contact. 

- des variables avancées du WLangage : Contact, ...




**Remarque** : Par compatibilité, il est également possible d'utiliser la structure mContact du WLangage. Cette solution n'est pas conseillée et doit être utilisée uniquement pour les applications devant fonctionner avec une version inférieure à Android 2.0. 





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Gestion des contacts avec utilisation des variables de type Contact
<a name="gestion_des_contacts_avec_utilisation_des_variables_type_contact_ELTTEXTE000157"></a>
Pour gérer les contacts de l'appareil mobile : 

1. Déclarez une variable de type [Contact](../WDLang3/1000020254.md). Ce type de variable permet de décrire et de connaître toutes les caractéristiques du contact présent dans l'appareil mobile. 

2. Utilisez les fonctions du WLangage selon l'action voulue : 

	- Pour lire et afficher dans votre application les contacts présents dans l'appareil mobile, utilisez la fonction [ContactListe](../WDLang3/1000020266.md). Cette fonction remplie un tableau de variables Contact. Vous pouvez ainsi par exemple parcourir le tableau de variables pour ajouter les différents contacts dans une zone répétée. Par exemple : 
			
		```wl
		gContactEnCours est un Contact
		gtabContacts est un tableau de Contacts
		
		ZoneRépétéeSupprimeTout(ZR_CONTACTS)
		
		// Listing des contacts
		gtabContacts = ContactListe()
		
		SI gtabContacts.Occurrence > 0 ALORS
			// Trie des contacts
			TableauTrie(gtabContacts, ttMembre, "+Nom")
			
			// Ajout dans la zone répétée
			POUR TOUT tContact DE gtabContacts
				ZoneRépétéeAjouteLigne(ZR_CONTACTS, ...
					tContact.Nom, tContact.Prénom)
			FIN
			// Affichage du nombre de contacts
			LIB_NBContacts = ChaîneConstruit("%1 contacts", gtabContacts.Occurrence)
		FIN
		```


	- Pour manipuler directement les contacts avec l'application native du téléphone, utilisez les fonctions suivantes : 
			


|   |   |
| --- | --- |
| [ContactAffiche](../WDLang3/1000019506.md) | Ouvre la fiche d'un contact dans l'application native de gestion des contacts de l'appareil (Android, iPhone ou iPad, Universal Windows). |
| [ContactCrée](../WDLang3/1000019556.md) | Affiche la fenêtre de création de contact de l'application native de gestion des contacts de l'appareil  (Android, iPhone ou iPad, Universal Windows). |
| [ContactEdite](../WDLang3/1000019507.md) | Ouvre en édition la fiche d'un contact en cours dans l'application native de gestion des contacts de l'appareil  (Android, iPhone ou iPad, Universal Windows). |
| [ContactSélectionne](../WDLang3/1000019508.md) | Affiche la liste des contacts de l'appareil (Android, iPhone ou iPad, Universal Windows). |

- Diverses fonctions WLangage permettent de réaliser toutes les manipulations possibles : 
			







- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WMGestionContacts.gif) ***Exemples multiplateforme (WINDEV Mobile)*** : **WM Gestion Contacts** <br>Cet exemple illustre la gestion de contacts pour Android et iOS.<br>Il permet de :<br>- lister les contacts du téléphone<br>- appeler les contacts<br>- envoyer des sms aux contacts<br>- ...



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Gestion des contacts avec utilisation de la structure Contact (conservée par compatibilité)
<a name="gestion_des_contacts_avec_utilisation_structure_contact_conservee_par_compatibilite_ELTTEXTE000245"></a>

	<B><B><B><B>Avertissement</B></B></B></B>

	A partir de la version <B><B><B><B>17 (69)</B></B></B></B>,  cette méthode est indiquée par compatibilité. Cette méthode n'est pas conseillée et doit être conservée uniquement pour les applications utilisant une version antérieure à Android 2.0.



Pour gérer les contacts de l'appareil mobile, il est possible d'utiliser la structure mContact. Cette structure est une structure prédéfinie du WLangage permettant de manipuler un contact. 

Pour manipuler les contacts de l'appareil mobile : 

- Parcourez les différents contacts avec les fonctions suivantes : 
	


|   |   |
| --- | --- |
| [ContactDernier](../WDLang3/1000006103.md) | Lit le dernier contact présent dans le carnet d'adresses d'une messagerie Lotus Notes ou Outlook. |
| [ContactLit](../WDLang3/1000006112.md) | Lit un contact présent dans le carnet d'adresses d'une messagerie Lotus Notes ou Outlook. |
| [ContactPrécédent](../WDLang3/1000006105.md) | Lit le contact précédent du contact en cours dans le carnet d'adresses d'une messagerie Lotus Notes ou Outlook. |
| [ContactPremier](../WDLang3/1000006106.md) | Lit le premier contact présent dans le carnet d'adresses d'une messagerie Lotus Notes ou Outlook. |
| [ContactSuivant](../WDLang3/1000006108.md) | Lit le contact suivant du contact en cours dans le carnet d'adresses d'une messagerie Lotus Notes ou Outlook. |

- Manipulez le contact en cours avec les fonctions suivantes : 
	


|   |   |
| --- | --- |
| [ContactAffiche](../WDLang3/1000019506.md) | Ouvre la fiche d'un contact dans l'application native de gestion des contacts de l'appareil (Android, iPhone ou iPad, Universal Windows). |
| [ContactAjoute](../WDLang3/1000006101.md) | Ajoute un contact : <br><br>	- dans le carnet d'adresses d'une messagerie Lotus Notes ou Outlook.<br><br>	- dans la liste des contacts de l'appareil (Android, iPhone ou iPad, Universal Windows).<br><br><br> |
| [ContactCherche](../WDLang3/1000006102.md) | Recherche un contact dans le carnet d'adresses d'une messagerie Lotus Notes ou Outlook. |
| [ContactEdite](../WDLang3/1000019507.md) | Ouvre en édition la fiche d'un contact en cours dans l'application native de gestion des contacts de l'appareil  (Android, iPhone ou iPad, Universal Windows). |
| [ContactLit](../WDLang3/1000006112.md) | Lit un contact présent dans le carnet d'adresses d'une messagerie Lotus Notes ou Outlook. |
| [ContactModifie](../WDLang3/1000006104.md) | Modifie le contact en cours dans le carnet d'adresses d'une messagerie Lotus Notes ou Outlook. |
| [ContactRAZ](../WDLang3/1000006107.md) | Réinitialise : <br><br>	- la structure [Contact](../WDLang3/1000006111.md). <br><br>	- une variable de type [Contact](../WDLang3/1000020254.md). <br><br><br> |
| [ContactSélectionne](../WDLang3/1000019508.md) | Affiche la liste des contacts de l'appareil (Android, iPhone ou iPad, Universal Windows). |
| [ContactSupprime](../WDLang3/1000006109.md) | Supprime le contact en cours : <br><br>	- du carnet d'adresses d'une messagerie Lotus Notes ou Outlook. <br><br>	- dans la liste des contacts du téléphone (Android, iPhone ou iPad, Universal Windows).<br><br><br> |









