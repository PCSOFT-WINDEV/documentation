


## Procédure WLangage appelée par la fonction zipAjouteFichier



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Procédure WLangage (également appelée "Callback") utilisée par la fonction [zipAjouteFichier](../WDLang3/3082008.md) pour gérer la progression de l'ajout d'un fichier dans l'archive. 

**Si vous manipulez une archive au format TAR ou TGZ (TAR.GZ)**, l'avancement est mis à jour uniquement à la fin de l'ajout du fichier. 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// -- Code d'initialisation de la fenêtre
GLOBAL
NomArchive est une chaîne = "MonArchive"

// -- Code de clic sur BTN_AjoutFichier
// Code d'initialisation
Nomfichier est une chaîne
CodeErreurCréation est un entier
CodeErreurAjout est un entier
NumEvénement est un entier

// Création d'une archive
CodeErreurCréation = zipCrée(NomArchive, "C:\MonRépertoire\MesArchives\ArchivePdf.wdz")

// Affichage du message d'erreur si l'archive n'a pas été créée
SI CodeErreurCréation = 0 ALORS
	// Sélection du fichier à ajouter
	NomFichier = fSélecteur("", "", "Fichier à ajouter", ...
			   "Fichier à compacter" + TAB + "*.*", "*", fselOuvre + fselExiste)
	// Ajout du fichier sélectionné dans l'archive
	CodeErreurAjout = zipAjouteFichier(NomArchive, NomFichier, zipAucun, Aff_Jauge_Compression)
	// Affichage du message d'erreur si le fichier n'a pas été ajouté
	SI CodeErreurAjout <> 0 ALORS
		Erreur(zipMsgErreur(CodeErreurAjout))
	FIN
SINON
	Erreur(zipMsgErreur(CodeErreurCréation))
FIN


// Procédure interne utilisée pour gérer la jauge.
PROCÉDURE INTERNE Aff_Jauge_Compression(FichierEncours est une chaîne, Pourcentage est un entier)
	SI Pourcentage < 100 ALORS
		Jauge(Pourcentage, 100, FichierEnCours)
		// Rafraîchissement de la fenêtre
		Multitâche(-1)
	SINON
		// La compression est finie
		Jauge()
	FIN
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`zipAjouteFichier_Callback(<Fichier en cours> , <Pourcentage d'avancement>)`
---

**`<Fichier en cours> : (Chaîne de caractères)`**

Nom du fichier en cours de traitement. 

**`<Pourcentage d'avancement> : (Entier)`**

Pourcentage d'avancement de l'ajout du fichier en cours dans l'archive. 




## Composante :
wd280zip.dll
