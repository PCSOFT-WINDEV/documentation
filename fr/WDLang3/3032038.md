


## EmailImporteHTML (Fonction)

***En anglais : EmailImportHTML***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Importe dans la structure Email ou dans une variable de type Email le contenu d'un fichier HTML afin de l'envoyer par email. Les images présentes dans le fichier HTML sont automatiquement inclues dans la structure Email ou la variable Email. 

- Dans la structure [Email](../WDLang3/3032029.md) : La structure email manipulée par le thread en cours est remplie : la variable Email.HTML ainsi que les variables Email.Attache[...] et Email.NbAttache sont initialisées en fonction du contenu HTML.

- Dans la variable [Email](../WDLang3/1000018713.md) : La variable Email en cours est remplie : les propriétés **NbAttache**, **Attache**[...] et **HTML** sont initialisées en fonction du contenu HTML.
	Remarque : Les images intégrées par encodage dans le fichier HTML sont également traitées.




Remarque : Le contenu HTML est géré uniquement en POP3/SMTP : cette fonction doit être utilisée uniquement si l'envoi de l'email est ensuite effectué en SMTP. 


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MonTexteHTML est une chaîne ANSI 
MonTexteHTML = fChargeTexte("C:\Email\MonCourrier.htm")
EmailImporteHTML(MonTexteHTML, "C:\Email")
Email.Destinataire = "flop-fr@gmail.com"
Email.Sujet = "Test"
EmailEnvoieMessage("User")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`EmailImporteHTML([<Email>, ] <Contenu HTML à envoyer> , <Répertoire> [, <Options>])`
---

**`<Email> : (Variable optionnelle de type Email)`**

Nom de la variable de type [Email](../WDLang3/1000018713.md) correspondant à l'email dans lequel le document HTML doit être importé.

Si ce paramètre n'est pas spécifié, la variable [Email.HTML](../WDLang3/3032029.md) (variable de la structure Email) est remplie avec &lt;Contenu HTML à envoyer&gt;.

**`<Contenu HTML à envoyer> : (Chaîne de caractères ANSI)`**

Contenu de l'email au format HTML.

**`<Répertoire> : (Chaîne de caractères)`**

Répertoire de référence pour les images (cas des chemins relatifs dans le contenu HTML).

**`<Options> : (Constante optionnelle de type Entier)`**

Options d'importation (uniquement dans le cas de l'utilisation de la structure Email) : 


|   |   |
| --- | --- |
| *emailOptionDéfaut*<br>(Valeur par défaut) | Un identifiant unique est généré pour identifier chaque image contenue dans le fichier HTML. **Cet identifiant est unique quelque soit le fichier HTML importé**.<br><br>Fonctionnement par défaut. |
| *emailOptionSansCID* | Un identifiant est généré pour les images contenues dans le fichier HTML. **Cet identifiant n'est pas unique. Si plusieurs fichiers HTML sont importés, ils peuvent utiliser les mêmes identifiants d'images**. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Fonctionnement des images et des pièces jointes
<a name="fonctionnement_des_images_des_pieces_jointes_ELTPARAGRAPHE000153"></a>Si &lt;Contenu HTML à envoyer&gt; fait référence à des images :

- ces images sont automatiquement ajoutées en pièces jointes à l'email (dans la structure [Email](../WDLang3/3032029.md) ou dans la variable de type [Email](../WDLang3/1000018713.md)).

- le code HTML du message est modifié de manière à référencer les pièces jointes.




**Attention** : Les pièces jointes sont "ajoutées" à l'email. Par exemple, si la variable **Email.NbAttache** vaut 2 avant l'appel de la fonction **EmailImporteHTML** et si le contenu HTML référence une image, cette image sera mise dans la variable **Email.Attache[3]** et la variable **Email.NbAttache** aura pour valeur 3.

L'ajout de pièces jointes supplémentaires doit être fait avant d'utiliser la fonction **EmailImporteHTML**.

L'ordre des pièces jointes spécifié lors de l'envoi n'est pas obligatoirement respecté lors de la réception de l'email.
L'identifiant des images est un identifiant unique.Remarque : Si l'import est effectué dans une variable de type [Email](../WDLang3/1000018713.md), les images intégrées par encodage dans le fichier HTML source sont également traitées.


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Envoid'unemailauformatHTML.gif) ***Exemples unitaires (WINDEV)*** : **Envoi d'un email au format HTML** <br>Utilisation de la fonction WLangage "EmailImporteHTML".<br>Cette fonction permet d'importer un fichier HTML directement dans la structure email. Cela permet notamment d'ajouter des images simplement dans des emails.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDMail.gif) ***Exemples complets (WINDEV)*** : **WD Mail** <br>Cette application est un client mail complet développé en WINDEV. Il s'appuie sur les objets Email.<br>Ce client mail permet de récupérer et d'envoyer des emails en utilisant les protocoles POP, IMAP et SMTP.<br>Il est possible d'appliquer des filtres sur le courrier entrant.<br>L'écriture d'un email s'appuie sur le champ Editeur HTML.<br>L'affichage des emails utilise le champ Affichage HTML.<br>L'application permet de gérer plusieurs comptes emails différents.

<a name="XComposante"></a>

## Composante :
wd280com.dll
