


## URIRécupèreInfo (Fonction)

***En anglais : URIGetInfo***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère des informations sur une ressource de type URI.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

<a name="Exemple2"></a>

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = URIRécupèreInfo(<URI> , <Information>)`
---

**`<Résultat> : (Chaîne de caractères ou Entier)`**

Information demandée.  

En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).

**`<URI> : (Variable de type URI ou Chaîne de caractères)`**

Nom de la variable de type [URI](../WDLang3/1000024027.md) ou chaîne de caractères identifiant la ressource manipulée. 

**`<Information> : (Constante de type Entier)`**

Type d'information demandé : 



|   |   |
| --- | --- |
| *uriInfoNom* | Nom de la ressource (sans extension). |
| *uriInfoTaille* | Taille de la ressource. &lt;Résultat&gt; correspondra à un entier : <br><br>- Taille de la ressource (en octets). <br><br>- -1 si la taille n'est pas connue ou ne peut pas être récupérée.<br><br><br> |
| *uriInfoTypeConversion* | Types MIME (et extensions de fichier correspondantes) dans lesquels la ressource peut être convertie lors de son export. Dans ce cas, &lt;Résultat&gt; correspondra à une chaîne de caractères au format :<br><br><pre><code><Type MIME> + TAB + <Extension></code></pre><br><br>Exemple : "application/pdf + TAB + .pdf"<br><br>Si plusieurs types sont renvoyés par la fonction, ils seront séparés par RC.<br><br>Pour plus de détails, consultez les [Remarques](#NOTE0_2) de cette page. |
| *uriInfoTypeOrigine* | Type MIME d'origine de la ressource et extension de fichier correspondante. Dans ce cas, &lt;Résultat&gt; correspondra à une chaîne de caractères au format :<br><br><pre><code><Type MIME> + TAB + <Extension></code></pre><br><br>Exemple : "application/pdf + TAB + .pdf" |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Sélection d'une ressource
<a name="selection_une_ressource_ELTPARAGRAPHE000098"></a>Pour sélectionner une ressource et obtenir son URI, utilisez par exemple la fonction [URISélecteur](../WDLang3/1000024026.md).
<a name="NOTE0_2"></a>


### Gestion du type de conversion
<a name="gestion_type_conversion_ELTPARAGRAPHE000108"></a>La constante *uriInfoTypeConversion* permet de récupérer les types MIME dans lesquels la ressource peut être convertie. 

Cette information est particulièrement utile lors de l'utilisation des fonctions [URIVersFichier](../WDLang3/1000024035.md) et [URIVersBuffer](../WDLang3/1000024036.md) pour déterminer le format dans lequel la ressource va être récupérée. En effet, lors de la sélection d'une ressource qui ne provient pas du système de fichier de l'appareil, le fournisseur de contenu (Content Provider) qui gère la ressource peut avoir besoin de convertir cette ressource. 

C'est en général le cas si aucune application de l'appareil ne sait gérer le format d'origine de la ressource. Si la ressource peut être exportée sans conversion, la fonction **URIRécupèreInfo** retournera la même valeur qu'avec la constante *uriInfoTypeOrigine*.

Exemple : 
un fichier Microsoft Word (.doc ou .docx) est sélectionné avec la fonction [URISélecteur](../WDLang3/1000024026.md). Ce fichier se trouve sur Google Drive et aucune application sur l'appareil ne sait gérer ce type de document. Lors de la sauvegarde de cette ressource le fournisseur de contenu convertira automatiquement cette ressource au format PDF. Dans ce cas, la fonction **URIRécupèreInfo** utilisée avec la constante *uriInfoTypeConversion* renverra la chaîne "application/pdf + TAB + .pdf".

<a name="XComposante"></a>

## Composante :
wd280android.aar
