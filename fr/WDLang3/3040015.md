


## FTPDate (Fonction)

***En anglais : FTPDate***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie les différentes dates (date de création, de modification ou d'accès) d'un fichier présent sur un serveur FTP (File Transfer Protocol).
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Renvoie la date de modification d'un fichier présent sur un serveur FTP (File Transfer Protocol).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003040015&name=ftpdate_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Connaître la date de modification du fichier
// "/Documents/Fichier.txt" présent sur le serveur FTP
ResDate = FTPDate(NumConnexion, "/Documents/Fichier.txt")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Récupérer les différentes dates du dernier fichier consulté

`<Résultat> = FTPDate([<Type de date>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Date demandée (au format AAAAMMJJ) du dernier fichier consulté  au moyen de l'une des fonctions FTP suivantes : [FTPAttribut](../WDLang3/3040006.md), [FTPHeure](../WDLang3/3040013.md), [FTPTaille](../WDLang3/3040007.md), [FTPListeFichier](../WDLang3/3040018.md).

- Chaîne vide ("") en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.


![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Date de modification du dernier fichier consulté.**Contrairement à la syntaxe 2, aucune requête n'est envoyée au serveur. Cette syntaxe est donc à privilégier dès que possible.**

**`<Type de date> : (Constante optionnelle)`**

Indique la date à manipuler :


|   |   |
| --- | --- |
| *ftpAccès* | Date du dernier accès au fichier. |
| *ftpCréation* | Date de création du fichier. |
| *ftpModification*<br>(Valeur par défaut) | Date de dernière modification du fichier. |

![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre n'est pas disponible. Seule la date de dernière modification du fichier est renvoyée.


<a name="SYNTAXE2"></a>

### Récupérer les différentes dates du fichier spécifié

`<Résultat> = FTPDate(<Identifiant de la connexion> , <Nom du fichier> [, <Type de date>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Date demandée du fichier spécifié (au format AAAAMMJJ),

- Chaîne vide ("") en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Date de modification du dernier fichier consulté.

**`<Identifiant de la connexion> : (Entier)`**

Identifiant de la connexion, obtenu avec la fonction [FTPConnecte](../WDLang3/3040016.md).



**`<Nom du fichier> : (Chaîne de caractères)`**

Nom et chemin absolu (ou relatif) du fichier à manipuler. Les parties du chemin sont séparées par des "slash" (barre oblique normale, "/").

**`<Type de date> : (Constante optionnelle)`**

Indique la date à manipuler :


|   |   |
| --- | --- |
| *ftpAccès* | Date du dernier accès au fichier. |
| *ftpCréation* | Date de création du fichier. |
| *ftpModification*<br>(Valeur par défaut) | Date de dernière modification du fichier. |

![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre n'est pas disponible. Seule la date de dernière modification du fichier est renvoyée.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Date d'un fichier
<a name="date_fichier_ELTPARAGRAPHE000144"></a>Du fait d'un dysfonctionnement d'un composant Microsoft, l'année renvoyée par **FTPDate** peut être erronée avec certaines versions d'Internet Explorer 5.0. Si le fichier a été créé ou modifié le jour même, la date est susceptible d'être inférieure d'un an à la date correcte.
<a name="NOTE0_2"></a>


### Délai
<a name="delai_ELTPARAGRAPHE000154"></a>Par défaut, toutes les fonctions FTP échouent si aucune réponse du serveur FTP n'est reçue après 20 secondes. Ce délai peut être modifié lors de la connexion au serveur FTP avec la fonction [FTPConnecte](../WDLang3/3040016.md).
<a name="NOTE0_3"></a>
<a name="NOTE0_4"></a>


### Droits des utilisateurs
<a name="droits_des_utilisateurs_ELTPARAGRAPHE000183"></a>La demande d'information sur des fichiers ou sur des répertoires présents sur un serveur FTP n'est possible que pour un utilisateur ayant les droits en lecture sur le serveur FTP. En règle générale, les utilisateurs "anonymes" ont les droits en lecture.
<a name="NOTE0_5"></a>


### Chemin relatif et absolu
<a name="chemin_relatif_absolu_ELTPARAGRAPHE000190"></a>Les notions de chemin relatif et de chemin absolu sont très importantes dans une application FTP.

- Un chemin commençant par un slash est considéré comme un **chemin absolu** : il s'agit du chemin par rapport à la racine du serveur FTP (paramètre propre au serveur).
	ex: /pub/user/JULIE

- Si le chemin ne commence pas par un slash, il est considéré comme un **chemin relatif**, c'est-à-dire le chemin par rapport au répertoire en cours. Ce répertoire en cours peut être connu ou modifié avec la fonction [FTPRepEnCours](../WDLang3/3040003.md).


Lors de la connexion à un site FTP, le répertoire initial, le "home directory" de l'utilisateur n'est pas forcément la racine du serveur FTP. Il est donc conseillé d'utiliser des chemins relatifs.

<a name="XComposante"></a>

## Composante :
wd280com.dll
