
## NetConnecte (Fonction)

***En anglais : NetConnect***





<DIV class="specObsolete">
	<IMG style="float:left;margin-right:10px;" src="https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=warning_big.png"><B>Avertissement</B><BR>
	 Cette fonction est conservée par compatibilité. Il est conseillé d'utiliser un serveur FTP, SSH ou SCP standard. Pour plus de détails, consultez [Manipuler des fichiers sur un serveur FTP](../WDLang3/3040009.md) et [Fonctions FTP Standard](../WDLang3/3040004.md). 
</DIV><a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Connecte à un serveur FTP (File Transfer Protocol) ou RPC (Remote Procedure Call) réalisé avec WINDEV.

**Remarque** : il n'est pas possible de détecter automatiquement la connexion d'un nouveau client. Une programmation spécifique est nécessaire.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
ConnectRPC est un entier
// Se connecte à un serveur RPC sur le port 5010
ConnectRPC = NetConnecte("148.61.125.245", ServeurRPC, ...
		"NOMUTILIS1", "PASS1", Faux, INTERNET, 5010)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = NetConnecte(<Adresse du poste> , <Serveur> , <Nom utilisateur> , <Mot de passe> [, <Cryptage> [, <Type de réseau> [, <Numéro de port> [, <Clé>]]]])`
---

**`<Résultat> : (Entier)`**



- Identifiant de la connexion, 

- 0 si la connexion a échoué. En cas d'erreur, la fonction [ErreurInfo](../WDLang1/3013008.md) permet d'obtenir plus de détails sur l'erreur.




**`<Adresse du poste> : (Chaîne de caractères)`**



- Adresse IP du poste serveur au format xxx.xxx.xxx.xxx (obtenu par la fonction [NetAdresseIP](../WDLang3/3056023.md)),

- Nom du poste serveur (obtenu par la fonction [NetNomMachine](../WDLang3/3056014.md)).




**`<Serveur> : (Constante)`**

Type du serveur : 



|   |   |
| --- | --- |
| *ServeurFTP* | Utilisation d'un serveur WINDEV FTP. Toutes les fonctions NET sont utilisables. |
| *ServeurRPC* | Utilisation d'un serveur WINDEV RPC. Les fonctions de transfert de fichier ne sont pas disponibles. |



**`<Nom utilisateur> : (Chaîne de caractères Ansi)`**

Nom de l'utilisateur qui tente de se connecter. Combiné avec le &lt;Mot de passe&gt;, ce paramètre permet d'identifier l'utilisateur (voir Notes).

**`<Mot de passe> : (Chaîne de caractères Ansi)`**

Mot de passe associé à l'utilisateur qui tente de se connecter (voir Notes).

**`<Cryptage> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> pour crypter les données transmises, 

- <u><u><u><u>Faux</u></u></u></u> (valeur par défaut) pour aucun cryptage.




Si le serveur est lancé avec l'option de cryptage à <u><u><u><u>Vrai</u></u></u></u> (fonction [NetDémarreServeur](../WDLang3/3056013.md)), les postes client devront se connecter avec la fonction **NetConnecte** en utilisant l'option &lt;Cryptage&gt; = Vrai.

Si le cryptage est demandé, la clé de connexion (paramètre &lt;Clé&gt;) sera elle aussi cryptée.

**`<Type de réseau> : (Constante optionnelle de type entier)`**

Temps d'attente de réponse (TimeOut) utilisé pour la connexion. Ce paramètre peut correspondre :

- à la durée en millisecondes du temps d'attente de réponse,

- à une constante spécifique.
	


|   |   |
| --- | --- |
| *INTERNET*<br>(valeur par défaut) | Valeur adaptée à l'utilisation d'Internet (temps d'attente de réponse important) |
| *INTRANET* | Valeur adaptée à l'utilisation d'Intranet (temps d'attente de réponse faible) |






**`<Numéro de port> : (Entier optionnel)`**

Numéro de port sur lequel le serveur doit être lancé. Par défaut, le client tente de se connecter au serveur sur le port 2000 pour le RPC et 2001 pour le FTP.

**`<Clé> : (Chaîne de caractères optionnelle Ansi)`**

Permet de sécuriser l'accès au serveur. Chaque client essayant de se connecter au serveur doit utiliser la même clé que celle précisée avec la fonction [NetDémarreServeur](../WDLang3/3056013.md). Si les clés sont différentes, la connexion est refusée.

Si le paramètre &lt;Cryptage&gt; est à <u><u><u><u>Vrai</u></u></u></u>, la clé est cryptée.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Paramètres du serveur
<a name="parametres_serveur_ELTPARAGRAPHE000129"></a>Il est indispensable de connaître certains paramètres du serveur pour se connecter :

- Adresse IP du serveur

- Type du serveur : RPC ou FTP

- Cryptage du serveur

- Port du serveur

- Clé si celle-ci est précisée lors du démarrage du serveur





<a name="NOTE0_2"></a>




### Nom de l'utilisateur et mot de passe
<a name="nom_utilisateur_mot_passe_ELTPARAGRAPHE000144"></a>Les paramètres &lt;Nom utilisateur&gt; et &lt;Mot de passe&gt; permettent au serveur de reconnaître s'il s'agit d'un utilisateur autorisé ou non.

La liste des autorisations et des mots de passe des utilisateurs se trouve dans le fichier WDRPCSRV.INI dans le répertoire du projet serveur.

Voici un exemple de contenu de ce fichier :


```txt
[Passwords]
NOMUTILIS1 = PASS1
NOMUTILIS2 = PASS2
NOMUTILIS3 = PASS3
```



<a name="NOTE0_3"></a>




### FTP standard
<a name="ftp_standard_ELTPARAGRAPHE000159"></a>WINDEV permet d'utiliser un FTP standard avec la fonction [FTPConnecte](../WDLang3/3040016.md).



<a name="XComposante"></a>

## Composante :
wd280com.dll
