
## HTTPJauge (Fonction)

***En anglais : HTTPProgressBar***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Affiche une jauge de progression pendant : 

- la réception de la réponse à une requête HTTP.

- l'envoi d'un formulaire HTTP (fonction [HTTPEnvoieFormulaire](../WDLang3/1000017190.md)) ou d'une requête HTTP. 




**Conditions d'utilisation** : La progression de la jauge de réponse ne sera possible que si le serveur Web qui traite la requête HTTP indique la longueur des données à renvoyer dans sa réponse. 
Il est possible de le vérifier en consultant l'entête HTTP de la réponse avec la fonction [HTTPDonneRésultat](../WDLang3/3043001.md) avec la constante *httpEntête*. 
Si l'entête HTTP contient "Content-Length:" avec la longueur de la réponse, la fonction **HTTPJauge** permettra d'avoir un suivi de la progression.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Affichage de la jauge de réception dans le champ JAUGE_Jauge
HTTPJauge(JAUGE_Jauge)
...
// Annulation de cette jauge
HTTPJauge("")
```


<a name="Exemple2"></a>



```wl
// La jauge de réception est gérée par la procédure ProgressionRéception
HTTPJauge("ProgressionRéception")
```

```wl
PROCEDURE ProgressionRéception(TotalOctet, TotalTransmis)
Message("Transfert en cours : " + TotalTransmis + " / " + TotalOctet)
JAUGE_Jauge = TotalTransmis/TotalOctet
```


<a name="Exemple3"></a>



```wl
// La jauge de réception est gérée par l'événement ProgressionHTTP
HTTPJauge("ProgressionHTTP")
```

```wl
// -- Code d'initialisation de la fenêtre
Evénement(GestionBarre, "*.*", "ProgressionHTTP")
```

```wl
PROCEDURE GestionBarre(TotalOctet, TotalTransmis)
Trace("Transfert en cours : " + TotalTransmis + " / " + TotalOctet)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Afficher la jauge dans un champ Jauge

`HTTPJauge(<Jauge de réception> [, <Fréquence jauge de réception> [, <Jauge d'envoi> [, <Fréquence jauge d'envoi>]]])`
---

**`<Jauge de réception> : (Chaîne de caractères)`**

Nom du champ de type Jauge dans lequel la jauge de progression de réception sera affichée. Ce champ doit exister dans la fenêtre en cours.
Si ce paramètre correspond à une chaîne vide (""), la jauge en cours est annulée.

**`<Fréquence jauge de réception> : (Entier optionnel)`**

Fréquence de mise à jour de la jauge de réception (en octets). Par défaut, la fréquence est de 10.000 (la jauge est mise à jour environ tous les 10 Ko). Attention : cette fréquence n'est qu'indicative.

**`<Jauge d'envoi> : (Chaîne de caractères optionnelle)`**

Nom du champ de type Jauge dans lequel la jauge de progression d'envoi des données sera affichée. Ce champ doit exister dans la fenêtre en cours.
Si ce paramètre correspond à une chaîne vide (""), la jauge en cours est annulée.

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre n'est pas disponible.

**`<Fréquence jauge d'envoi> : (Entier optionnel)`**

Fréquence de mise à jour de la jauge d'envoi des données (en octets). Par défaut, la fréquence est de 10.000 (la jauge est mise à jour environ tous les 10 Ko). Attention : cette fréquence n'est qu'indicative. 

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre n'est pas disponible.


<a name="SYNTAXE2"></a>

### Gérer la jauge par une procédure

`HTTPJauge(<Nom de la procédure de réception> [, <Fréquence jauge de réception> [, <Nom de la procédure d'envoi> [, <Fréquence jauge d'envoi>]]])`
---

**`<Nom de la procédure de réception> : (Chaîne de caractères)`**

Nom de la procédure WLangage qui va gérer la jauge de progression de la réception des données. 
Cette procédure est de la forme :

```txt
PROCEDURE <Nom de la procédure>(<Total>, <Progression>)
```
où : 

- &lt;Total&gt; est la quantité d'octets à recevoir. 

- &lt;Progression&gt; est la quantité d'octets déjà reçus. 
	Remarque : Si le serveur ne renvoie pas la taille totale attendue, alors &lt;Total&gt; sera égal à &lt;Progression&gt;. 




A tout moment, ces paramètres peuvent être utilisés dans la procédure.

Si ce paramètre correspond à une chaîne vide (""), la jauge en cours est annulée.

**`<Fréquence jauge de réception> : (Entier optionnel)`**

Fréquence de mise à jour de la jauge de réception (en octets). Par défaut, la fréquence est de 10.000 (la procédure est appelée environ tous les 10 Ko). Attention : cette fréquence n'est qu'indicative. 

**`<Nom de la procédure d'envoi> : (Chaîne de caractères optionnelle)`**

Nom de la procédure WLangage qui va gérer la jauge de progression de l'envoi des données. 
Cette procédure est de la forme :

```txt
PROCEDURE <Nom de la procédure>(<Total>, <Progression>)
```
où : 

- &lt;Total&gt; est la quantité d'octets à envoyer. 

- &lt;Progression&gt; est la quantité d'octets déjà envoyés. 
	Remarque : Si le serveur ne renvoie pas la taille totale attendue, alors &lt;Total&gt; sera égal à &lt;Progression&gt;. 




A tout moment, ces paramètres peuvent être utilisés dans la procédure.

Si ce paramètre correspond à une chaîne vide (""), la jauge en cours est annulée.

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre n'est pas disponible.

**`<Fréquence jauge d'envoi> : (Entier optionnel)`**

Fréquence de mise à jour de la jauge d'envoi (en octets). Par défaut, la fréquence est de 10.000 (la procédure est appelée environ tous les 10 Ko). Attention : cette fréquence n'est qu'indicative. 

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre n'est pas disponible.


<a name="SYNTAXE3"></a>

### Gérer la jauge par un événement

`HTTPJauge(<Nom de l'événement pour la réception> [, <Fréquence jauge de réception> [, <Nom de l'événement pour l'envoi> [, <Fréquence jauge d'envoi>]]])`
---

**`<Nom de l'événement pour la réception> : (Chaîne de caractères)`**

Nom de l'événement qui sera exécuté durant la progression de la jauge de réception. Cet événement doit être traité avec la fonction [Evénement](../WDLang1/3015011.md). Dans ce cas, le paramètre wParam (1er paramètre de l'événement) correspondra à la quantité d'octets à transmettre et le paramètre lParam (second paramètre de l'événement) correspondra à la quantité d'octets déjà transmis. 
Si ce paramètre correspond à une chaîne vide (""), la jauge en cours est annulée.

**`<Fréquence jauge de réception> : (Entier optionnel)`**

Fréquence de mise à jour de la jauge de réception (en octets). Par défaut, la fréquence est de 10.000 (l'événement est déclenché environ tous les 10 Ko). Attention : cette fréquence n'est qu'indicative.

**`<Nom de l'événement pour l'envoi> : (Chaîne de caractères optionnelle)`**

Nom de l'événement qui sera exécuté durant la progression de la jauge d'envoi. Cet événement doit être traité avec la fonction [Evénement](../WDLang1/3015011.md). Dans ce cas, le paramètre wParam (1er paramètre de l'événement) correspondra à la quantité d'octets à transmettre et le paramètre lParam (second paramètre de l'événement) correspondra à la quantité d'octets déjà transmis. 
Si ce paramètre correspond à une chaîne vide (""), la jauge en cours est annulée.

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre n'est pas disponible.

**`<Fréquence jauge d'envoi> : (Entier optionnel)`**

Fréquence de mise à jour de la jauge (en octets). Par défaut, la fréquence est de 10.000 (l'événement est déclenché environ tous les 10 Ko). Attention : cette fréquence n'est qu'indicative.  
 
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre n'est pas disponible.



<a name="NOTE0"></a>


<a name="XComposante"></a>

## Composante :
wd280com.dll
