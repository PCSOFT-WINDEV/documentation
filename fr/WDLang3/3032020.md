


## EmailSauveFichierAttaché (Fonction)

***En anglais : EmailSaveAttachment***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Copie le fichier attaché de l'email en cours sur le poste de l'utilisateur (en local).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003032020&name=emailsauvefichierattache_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
POUR I = 1 A Email.NbAttache 
	FichierASauver = fSélecteur("", "", "Nom du fichier à sauvegarder", ...
		"Tous les fichiers(*.*)" + TAB + "*.*", "", fSelCrée)
	EmailSauveFichierAttaché(Email.Attache[I], FichierASauver)
FIN
```
<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
sRepertoirePJ est une chaîne = ...
	ComplèteRep(SysRep(srAppDataCommun)) + "MonProjet\Pieces Jointes\"
SI PAS fRépertoireExiste(sRepertoirePJ) ALORS fRepCrée(sRepertoirePJ) 

POUR I = 1 A Email.NbAttache  
	SI PAS EmailSauveFichierAttaché(Email.Attache[i], ...
		sRepertoirePJ + Email.Attache[i]) ALORS Erreur(ErreurInfo())
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) <a name="SYNTAXE1"></a>

### Sauver un fichier attaché d'une variable de type emailAttache

`<Résultat> = EmailSauveFichierAttaché(<Fichier attaché> , <Nom fichier copié>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le fichier attaché a été copié sur le poste local.

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Fichier attaché> : (Variable de type emailAttache)`**

Nom de la variable de type [emailAttache](../WDLang3/1000018752.md) contenant la description du fichier attaché. 

**`<Nom fichier copié> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier copié sur le poste local.


<a name="SYNTAXE2"></a>

### Sauver un fichier attaché de la structure Email

`<Résultat> = EmailSauveFichierAttaché(<Nom fichier attaché> , <Nom fichier copié>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le fichier attaché a été copié sur le poste local.

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Nom fichier attaché> : (Chaîne de caractères)`**

Nom logique du fichier attaché, obtenu dans la variable Email.Attache.

**`<Nom fichier copié> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier copié sur le poste local.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Manipulation des messages et de leurs fichiers attachés
<a name="manipulation_des_messages_leurs_fichiers_attaches_ELTPARAGRAPHE000126"></a>Il est conseillé de sauvegarder les messages et leurs fichiers attachés sur le disque local (ou sur le disque du serveur) puis de les supprimer du serveur. Cette opération permet :

- d'alléger la boîte aux lettres sur le serveur,

- d'améliorer et d'alléger les communications : seuls les nouveaux messages seront lus sur le serveur.



<a name="NOTE0_2"></a>


### Rappel
<a name="rappel_ELTPARAGRAPHE000138"></a>**Structure Email** : Les fichiers attachés au message en cours sont connus grâce aux variables :

- Email.NbAttache : nombre de fichiers attachés.

- Email.Attache : tableau contenant le nom des fichiers attachés au message en cours.




**Variable Email** : Les fichiers attachés au message en cours sont connus grâce à la propriété **Email..Attache** (tableau contenant le nom des fichiers attachés au message en cours).

<a name="XComposante"></a>

## Composante :
wd280com.dll
