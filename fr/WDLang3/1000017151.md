
## OBEXEnvoieFichier (Fonction)

***En anglais : OBEXSendFile***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Envoie un fichier sur un périphérique gérant le protocole OBEX.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Connexion Bluetooth
SI BTConnectePériphérique(COL_ID, "123") = Vrai ALORS
	// Connexion OBEX
	nIDCnxOBEX = OBEXConnecte(obexBluetooth, COL_MAC)
	// Transfert du fichier
	TABLE_PERIPHERIQUES[TABLE_PERIPHERIQUES].CouleurFond = ...
				  SELON (OBEXEnvoieFichier(nIDCnxOBEX, sFichier), ...
						Blanc, RougePastel)	
	// Fin du transfert
	OBEXDéconnecte(nIDCnxOBEX)
SINON
	 Erreur("Impossible de se connecter à " + COL_PERIPHERIQUE, ErreurInfo())
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = OBEXEnvoieFichier(<Identifiant de la connexion OBEX> , <Chemin fichier local> [, <Chemin fichier distant>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le transfert a réussi, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [ErreurInfo](../WDLang1/3013008.md) permet d'obtenir plus de renseignements sur le problème rencontré.




**Attention** : Si le fichier est refusé par la machine distante, l'émetteur n'est pas informé : la fonction [ErreurInfo](../WDLang1/3013008.md) ne contient pas d'erreur spécifique. La fonction [ErreurInfo](../WDLang1/3013008.md) contient uniquement les messages d'erreur concernant la transmission.

**`<Identifiant de la connexion OBEX> : (Entier)`**

Identifiant de la connexion OBEX à utiliser. Cet identifiant est retourné par la fonction [OBEXConnecte](../WDLang3/1000017153.md).

**`<Chemin fichier local> : (Chaîne de caractères)`**

Nom et chemin complet du fichier à envoyer.

**`<Chemin fichier distant> : (Chaîne de caractères optionnelle)`**

Nom et chemin du fichier sur le périphérique distant. Si ce paramètre n'est pas précisé, le fichier garde le même nom, et est copié dans le répertoire de transfert paramétré sur le périphérique OBEX.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Localisation du fichier copié
<a name="localisation_fichier_copie_ELTPARAGRAPHE000059"></a>Le fichier est copié dans le répertoire de transfert paramétré sur le périphérique OBEX utilisé. Si le paramètre &lt;Chemin fichier distant&gt; est spécifié, le chemin spécifié sera relatif au répertoire de transfert.


<a name="NOTE0_2"></a>




### Transfert de fichiers par infra-rouge
<a name="transfert_fichiers_par_infrarouge_ELTPARAGRAPHE000068"></a>Lors du transfert de fichiers par infra-rouge, le transfert est terminé après l'exécution de **OBEXEnvoieFichier**. Cependant, Windows laisse la fenêtre de transfert ouverte (pour gérer un nouveau transfert potentiel de fichier). Cette fenêtre est fermée uniquement à la déconnexion ([OBEXDéconnecte](../WDLang3/1000017154.md)).  


<a name="NOTE0_3"></a>




### Limitation
<a name="limitation_ELTPARAGRAPHE000083"></a>Seules les piles bluetooth Microsoft sont supportées par cette fonction. Pour connaître la pile utilisée, utilisez la fonction [BTPile](../WDLang3/1000017229.md).

Pour plus de détails sur les clés supportées, consultez [Quelles piles utiliser ?](../WDLang3/1000017231.md)



<a name="XComposante"></a>

## Composante :
wd280com.dll
