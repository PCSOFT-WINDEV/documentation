


## &lt;Variable emailSessionIMAP&gt;.ListeDossier (Fonction)

***En anglais : &lt;emailIMAPSession variable&gt;.ListFolder***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie la liste des dossiers d'une session IMAP.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MaSession est une emailSessionIMAP
...
// Liste des dossiers
ListeDossier = MaSession.ListeDossier(LstDossierTous + LstDossierType)
// ListeDossier contient par exemple :
// "Dossiers personnels" + TAB + dossierPersonnel + RC + ...
// "Dossiers personnels\Boîte de réception" + ...
// TAB + dossierRéception + RC + ...
// "Dossiers personnels\Boîte de réception\Travail" + ...
// TAB + dossierGénérique + RC + ...
// "Dossiers personnels\Boîte de réception\Personnel" + ...
// TAB + dossierGénérique + RC + ...
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Session>.ListeDossier([<Option>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Liste des dossiers. Les différents dossiers sont séparés par des RC (Retour Chariot). En fonction de la constante utilisée, le format du résultat diffère :


|   |   |
| --- | --- |
| *LstDossierNormal*<br>(Valeur par défaut) | &lt;Nom Dossier1&gt; + RC + &lt;Nom Dossier2&gt; + RC + ... |
| *LstDossierTous* | &lt;Nom Dossier1&gt; + RC + &lt;Nom Dossier2&gt; + RC + ... |
| *LstDossierTrié* | &lt;Nom Dossier1&gt; + RC + &lt;Nom Dossier2&gt; + RC + ... |
| *LstDossierType* | &lt;Nom Dossier1&gt; + TAB + &lt;Type Dossier1&gt; + RC + &lt;Nom Dossier2&gt; + TAB + &lt;Type Dossier2&gt; + RC + ... |

Où :

&lt;Nom DossierX&gt; : Nom complet du dossier. Par exemple : "Dossiers personnels\\Boîte de réception\\Travail".

&lt;Type DossierX&gt; : Type du dossier listé. Ce paramètre peut correspondre à :

- *dossierBrouillon* : Dossier des brouillons

- *dossierContact* : Dossier des contacts et des groupes de contacts

- *dossierCorbeille* : Dossier des éléments supprimés

- *dossierEnvoie* : Dossier des emails en attente d'envoi

- *dossierEnvoyé* : Dossier des emails envoyés

- *dossierGénérique* : Dossier générique (dossier créé par les utilisateurs)

- *dossierJournal* : Dossier des journaux

- *dossierNote* : Dossier des notes

- *dossierPersonnel* : Racine du dossier "Dossiers personnels"

- *dossierRéception* : Dossier des emails reçus

- *dossierRendezVous* : Dossier des rendez-vous

- *dossierTâche* : Dossier des tâches




En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.

**`<Session> : (Variable de type emailSessionIMAP)`**

Nom de la variable de type [emailSessionIMAP](../WDLang3/1000018957.md) correspondant à la session d'email à manipuler.

**`<Option> : (Constante ou combinaison de constantes optionnelle de type entier)`**

Indique :

- le type de liste à effectuer :
	


|   |   |
| --- | --- |
| *LstDossierNormal* | Liste des dossiers contenant uniquement des emails ("Boîte de réception", "Eléments envoyés", ...). |
| *LstDossierTous* | Liste de tous les dossiers. |



- le mode de tri de la liste :
	


|   |   |
| --- | --- |
| *LstDossierTrié* | Liste triée dans l'ordre alphabétique. |



- l'affichage du type du dossier :
	


|   |   |
| --- | --- |
| *LstDossierType* | Renvoie le type des dossiers en plus de leur nom (option non supportée avec le protocole IMAP) |




Par défaut, tous les dossiers contenant des emails sont listés. Cette liste n'est pas triée par ordre alphabétique et contient uniquement le nom de chaque dossier.



<a name="XComposante"></a>

## Composante :
wd280com.dll
