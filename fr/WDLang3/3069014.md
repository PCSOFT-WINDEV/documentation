


## SOAPExécuteXML (Fonction)

***En anglais : SOAPRunXML***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Exécute une procédure sur un serveur SOAP. L'ensemble des paramètres de la procédure doit être spécifié à l'aide d'un message XML.

Remarque : La fonction [SOAPPrépare](../WDLang3/1000019238.md) permet de créer l'ensemble du message XML (encodé en UTF8) pour une procédure d'un [Webservice importé](../WDLang3/3086001.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003069014&name=soapexecutexml_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Définition du message XML de la procédure "getTemp" qui
// retourne la température d'une ville identifiée par son code postal
MessageXML = ...
	"<SOAP-ENV:Envelope xmlns:SOAP-ENV="+...
	"http://schemas.xmlsoap.org/soap/envelope/"+...
	"xmlns:xsi=""http://www.w3.org/1999/XMLSchema-instance"""+...
	"xmlns:xsd=""http://www.w3.org/1999/XMLSchema"">"+...
	"<SOAP-ENV:Body> "+...
	"<ns1:getTemp xmlns:ns1=""urn:xmethods-Temperature"" SOAP-"+...
	"ENV:encodingStyle=""http://schemas.xmlsoap.org/soap/encoding/"">"+...
	"<zipcode xsi:type=""xsd:string"">94041</zipcode> "+...
	"</ns1:getTemp> "+...
	"</SOAP-ENV:Body> "+...
	"</SOAP-ENV:Envelope>"

// Exécution de la procédure "getTemp"
ResExécution = SOAPExécuteXML("http://services.xmethods.net:80"+...
						  "/soap/servlet/rpcrouter", MessageXML)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = SOAPExécuteXML(<URL du serveur SOAP> , <Message XML> [, <Action de la procédure>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la communication avec le serveur SOAP a été établie, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md). 




**`<URL du serveur SOAP> : (Chaîne de caractères)`**

URL du serveur SOAP à contacter. Ce paramètre est fourni dans la documentation du serveur SOAP et de ses procédures.

**`<Message XML> : (Chaîne de caractères)`**

Message XML contenant l'ensemble des données permettant l'exécution d'une procédure (nom, espace de nommage, style d'encodage et paramètres de la procédure). Ces paramètres sont fournis dans la documentation du serveur SOAP et de ses procédures.
Remarque : Si vous utilisez un serveur SOAP WINDEV, le nom de la bibliothèque (WDL) est précisé grâce au namespace ("&lt;Nom de l'application Serveur&gt;" devient sur le serveur "c:\\modulessoap\\&lt;Nom de l'application Serveur&gt;.wdl").

**`<Action de la procédure> : (Chaîne de caractères optionnelle)`**

Action de la procédure (appelée aussi "SOAPAction"). Ce paramètre est fourni dans la documentation du serveur SOAP et de ses procédures.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
Après l'appel de la fonction **SOAPExécuteXML** :

- L'ensemble des données de la procédure est effacé.

- La structure de l'entête spécifié avec la fonction [SOAPAjouteEntête](../WDLang3/3069001.md) est effacée.

- La fonction [SOAPDonneRésultat](../WDLang3/3069002.md) permet de récupérer le résultat de la procédure exécutée.

- La fonction [SOAPErreur](../WDLang3/3069005.md) permet de récupérer le message d'erreur de la procédure exécutée.




<a name="XComposante"></a>

## Composante :
wd280com.dll
