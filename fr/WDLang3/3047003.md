
## J2EEDonneRésultat (Fonction)

***En anglais : J2EEGetResult***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie le résultat de la dernière procédure J2EE exécutée avec succès.

**Remarque** : Cette procédure a été exécutée par la fonction [J2EEExécute](../WDLang3/3047007.md) ou [J2EEExécuteXML](../WDLang3/3047008.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Cet exemple est basé sur la présence du module Text2Image Webservice
// sur le site dwdemos.alphaworks.ibm.com. 
// Si le module n'était plus disponible sur le site, 
// l'exemple ne fonctionnerait plus
// Interrogation du Webservice sur le serveur Web
SI J2EEExécute(...
	"http://dwdemos.alphaworks.ibm.com:8085/soap/servlet/rpcrouter", ...
	"createImage", "urn:text2image", ...
	"http://alphaworks.ibm.com/alphabeans/text2image/createImage/") ALORS
	// Le résultat est une image, on en fait un fichier temporaire
	nIDFic est un entier
	nIDFic = fOuvre(fRepExe() + "\temp.gif", foCréation)
	fEcrit(nIDFic, J2EEDonneRésultat(J2EERésultat))
	fFerme(nIDFic)
	// Affichage
	IMG_GEN = ""
	IMG_GEN = fRepExe() + "\temp.gif"
	// Suppression du fichier temporaire
	fSupprime(IMG_GEN)
SINON
	// Si le service ne retourne pas d'erreur (ex : Serveur inaccessible)
	SI J2EEErreur(J2EEerrMessage) ~= "" ALORS
		Erreur(ErreurInfo()) 
		// Si le service a retourné une erreur (erreur du service)
	SINON
		Erreur("Erreur J2EE : " + J2EEErreur(J2EEerrMessage))
	FIN
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = J2EEDonneRésultat(<Type de résultat> [, <Numéro du résultat>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Résultat de la dernière procédure J2EE exécutée avec succès.

- Si plusieurs résultats sont retournés par le serveur et si la constante *J2EERésultat* est utilisée :

	- résultat &lt;Numéro du résultat&gt;,

	- premier résultat retourné si le paramètre &lt;Numéro du résultat&gt; n'est pas spécifié.




- Une chaîne vide ("") si :

	- aucun résultat n'a été retourné par le serveur,

	- aucune liaison n'a été établie avec le serveur.







**`<Type de résultat> : (Constante)`**

Type de résultat à retourner :



|   |   |
| --- | --- |
| *J2EERésultat* | Résultat de la dernière procédure J2EE exécutée. |
| *J2EERésultatHTTP* | Résultat sous forme HTTP de la dernière procédure J2EE exécutée. |
| *J2EERésultatXML* | Résultat sous forme XML de la dernière procédure J2EE exécutée. |



**`<Numéro du résultat> : (Entier optionnel)`**

Numéro du résultat à retourner. Ce paramètre est utilisé uniquement si plusieurs résultats sont retournés par le serveur et si la constante *J2EERésultat* est spécifiée. Dans le cas contraire, ce paramètre est ignoré.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Les différents types de résultats
<a name="les_differents_types_resultats_ELTPARAGRAPHE000067"></a>Une même procédure exécutée sur un serveur peut renvoyer trois types de résultats.

Considérons l'exemple suivant :
La procédure "getTemp" (qui permet de connaître la température d'une ville) a été exécutée. Les types de résultats retournés par la fonction **J2EEDonneRésultat** sont les suivants :

- Avec la constante *J2EERésultat* : 37

- Avec la constante *J2EERésultatHTTP* :
	
	```txt
	HTTP/1.1 200 OK
	Date: Mon, 09 Jul 2001 09:34:49 GMT
	Status: 200
	Set-Cookie2: JSESSIONID=To16135mC022383577812008837At;Version=1;Discard;Path="/soap"
	Servlet-Engine: Tomcat Web Server/3.1 (JSP 1.1; Servlet 2.2; Java 1.3.0; 
	Linux 2.2.19-6.2.1.2RS x86; java.vendor=IBM Corporation)
	Set-Cookie: JSESSIONID=To16135mC022383577812008837At;Path=/soap
	Content-Type: text/xml; charset=utf-8
	Content-Length: 467
	Content-Language: en
	<?xml version='1.0' encoding='UTF-8'?>
	<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" 
	xmlns:xsi="http://www.w3.org/1999/XMLSchema-instance" 
	xmlns:xsd="http://www.w3.org/1999/XMLSchema">
	<SOAP-ENV:Body>
	<ns1:getTempResponse xmlns:ns1="urn:xmethods-Temperature" 
	SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
	<return xsi:type="xsd:float">'''37.0'''</return>
	</ns1:getTempResponse>
	</SOAP-ENV:Body>
	</SOAP-ENV:Envelope>
	```





- Avec la constante *J2EERésultatXML* :
	
	```txt
	<?xml version='1.0' encoding='UTF-8'?>
	<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" 
	xmlns:xsi="http://www.w3.org/1999/XMLSchema-instance" 
	xmlns:xsd="http://www.w3.org/1999/XMLSchema">
	<SOAP-ENV:Body>
	<ns1:getTempResponse xmlns:ns1="urn:xmethods-Temperature" 
	SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
	<return xsi:type="xsd:float">'''37.0'''</return>
	</ns1:getTempResponse>
	</SOAP-ENV:Body>
	</SOAP-ENV:Envelope>
	```







<a name="XComposante"></a>

## Composante :
wd280com.dll
