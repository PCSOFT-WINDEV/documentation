
## telDémarreDétectionAppel (Fonction)

***En anglais : tapiListen***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Démarre la détection d'appel (appelé aussi service de détection d'appel).

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Remarque** : Par défaut, le périphérique utilisé est automatiquement le premier périphérique compatible TAPI 3.1 trouvé. Il est possible de sélectionner un périphérique spécifique avec la fonction [telPériphérique](../WDLang3/3076032.md). Dans ce cas, ce périphérique spécifique sera utilisé.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003076029&name=teldemarredetectionappel_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Démarre le service de détection des appels
SI telDémarreDétectionAppel("AppelEntrant", telOptionTypeFax, "DetectionAppel") = Vrai ALORS
	// Le service de détection des appels a démarré
	Message("Détection des appels activée")
SINON
	// Le service de détection des appels n'a pas démarré
	Erreur("Impossible de démarrer la détection des appels" + RC + ...
		"Détail de l'erreur :"+ RC + ErreurInfo(errMessage))
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = telDémarreDétectionAppel(<Identifiant du service> [, <Options>] , <Procédure WLangage> , <Paramètre personnalisé>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la détection d'appels est activée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Identifiant du service> : (Chaîne de caractères)`**

Nom permettant d'identifier le service de détection d'appel.

**`<Options> : (Constante optionnelle)`**

Caractéristiques de la détection d'appel :


|   |   |
| --- | --- |
| *telOptionDéfaut*<br>(option par défaut) | Détection d'appels sur un modem fax. Les fonctions de manipulation d'appel ne sont généralement pas supportées par les modems. <br>Cette option n'est pas combinable avec les autres options. |
| *telOptionMoniteur* | Détecte les appels (par exemple pour réaliser des statistiques), même si ils sont gérés par une application. Aucune manipulation de l'appel ne sera possible. |
| *telOptionTypeFax* | Détecte les appels provenant d'un fax. |
| *telOptionTypeInconnu* | Détecte les appels de type inconnu. |
| *telOptionTypeVoix* | Détecte les appels utilisant la voix.<br>Remarque : Les modems Fax autorisant la numérotation automatique peuvent renvoyer cette constante. Dans ce cas, une erreur du WLangage sera générée. |



**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure WLangage appelée lors d'une détection d'appel, et lors du changement d'état de l'appel. Cette procédure est du type :

```txt
PROCÉDURE <Nom de la procédure> (<Identifiant du service>, <Identifiant de l'appel>, 
<Statut de l'appel>, <Paramètre>)
```


- &lt;Identifiant du service&gt; : identifiant du service qui a détecté l'appel

- &lt;Identifiant de l'appel&gt; : entier identifiant l'appel. Peut être utilisé dans toutes les fonctions de manipulation de l'appel.

- &lt;Statut de l'appel&gt; : entier qui peut prendre les valeurs suivantes : 
	


|   |   |
| --- | --- |
| *telInformationAppel* | Les informations supplémentaires (présentation du numéro) sont disponibles. Ces informations ne sont généralement disponibles qu'après la première sonnerie. |
| *telLigneAttendRéponse* | L'appel est composé : recherche du correspondant. |
| *telLigneDécrochée* | La ligne est connectée. |
| *telLigneNumérote* | Numérotation en cours.<br><br>Remarque : Si la technologie TAPI 3.1 est utilisée, cette constante n'est plus renvoyée. |
| *telLigneOccupée* | La ligne est actuellement occupée. |
| *telLigneRaccrochée* | Le correspondant a raccroché. |
| *telLigneSonnerie* | Sonnerie en cours chez le correspondant. |
| *telLigneTonalité* | La ligne reçoit la tonalité. |
| *telNouvelAppel* | Nouvel appel détecté en attente de réponse ou de rejet. |
| *telToucheDétectée* | Une touche du clavier téléphonique a été utilisée. Pour connaître la liste des touches utilisées, utilisez la fonction [telToucheEnfoncée](../WDLang3/3076027.md). |



- &lt;Paramètre&gt; est le paramètre personnalisé passé à la fonction **telDémarreDétectionAppel**.




Attention : cette procédure ne doit pas contenir d'appel au débogueur (ni point d'arrêt, ni mot-clé STOP, ni expression auto-stop, ...).

**`<Paramètre personnalisé> : (Tout type)`**

Paramètre passé à la procédure WLangage.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Limitation
<a name="limitation_ELTPARAGRAPHE000138"></a>Il n'est pas possible d'appeler la fonction **telDémarreDétectionAppel** dans la procédure de détection d'appels.


<a name="NOTE0_2"></a>




### Procédure WLangage
<a name="procedure_wlangage_ELTPARAGRAPHE000150"></a>La procédure WLangage est exécutée dans un thread WLangage.

Attention : Il n'est pas possible d'exécuter dans les threads les traitements suivants :

- utiliser les fonctions [telCompose](../WDLang3/3076013.md), [telComposeLigne](../WDLang3/3076012.md), **telDémarreDétectionAppel**, [telFinDétectionAppel](../WDLang3/3076022.md), [telMetAppelEnAttente](../WDLang3/3076034.md), [telNumérote](../WDLang3/3076018.md), [telPériphérique](../WDLang3/3076032.md), [telRaccroche](../WDLang3/3076030.md), [telRépondAppel](../WDLang3/3076026.md), [telReprendAppelEnAttente](../WDLang3/3076035.md) et [telTransfertDirect](../WDLang3/3076011.md).

- ouverture de fenêtres avec les fonctions WLangage telles que [Ouvre](../WDLang1/3038035.md), [Utilise](../WDLang1/3038044.md), [Ferme](../WDLang1/3038018.md), ... Si des fenêtres doivent être manipulées dans des threads (cas rare), une gestion spécifique doit être mise en place. Pour plus de détails, consultez [Gérer l'ouverture d'une fenêtre dans un thread secondaire](../WDLang1/3077015.md)

- gestion d'événement.

- gestion de timer.




Pour plus de détails sur la gestion des threads, consultez [Gestion des threads](../WDLang1/3077026.md).


<a name="NOTE0_3"></a>


### Configuration nécessaire
<a name="configuration_necessaire_ELTPARAGRAPHE000355"></a>Les fonctions de téléphonie utilisent la technologie TAPI 2.0 et/ou la technologie TAPI 3.1. Ces technologies sont utilisables sur tous les systèmes.


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDTelephonie.gif) ***Exemples complets (WINDEV)*** : **WD Téléphonie** <br>Cet exemple illustre les fonctions téléphonie de WINDEV.<br>Dans cet exemple, nous abordons deux thèmes principaux :<br>1/ Comment composer un numéro de téléphone<br>2/ Détecter et identifier des appels entrants<br>Résumé de l'exemple livré avec WINDEV :	<br>Cet exemple présente les différentes fonctions de téléphonie fournies en standard avec WINDEV. Après avoir saisi quelques contacts dans la fenêtre principale (la table est en saisie), vous pourrez les appeler directement à partir de l'application (à condition que votre ordinateur soit équipé d'un modem correctement installé). Vous pourrez également avoir une notification des appels entrants et obtenir l'identité de l'appelant

<a name="XComposante"></a>

## Composante :
wd280com.dll
