


## EmailLitEntêteSuivant (Fonction)

***En anglais : EmailReadNextHeader***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Lit l'entête de l'email suivant l'email en cours :

- soit par le protocole POP3 ou IMAP : l'email est présent dans la boîte aux lettres sur le serveur de messagerie.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) soit par l'intermédiaire du logiciel de messagerie Lotus Notes ou Outlook : l'email reçu est présent sur le poste local dans la boîte de réception de Lotus Notes ou Outlook.


Les différentes variables de la structure email (ou de la variable de type Email) correspondant à l'entête du message sont remplies.

Cette fonction est utile lorsque la lecture de l'email est par exemple liée à la taille du message.

Si aucun email n'est trouvé, la variable Email.EnDehors est positionnée à <u><u><u>Vrai</u></u></u>.

**Rappel** : Avant de lire un email, il est nécessaire d'ouvrir une session avec la fonction [EmailOuvreSession](../WDLang3/3032028.md), [EmailOuvreSessionNotes](../WDLang3/3032121.md) ou [EmailOuvreSessionOutlook](../WDLang3/3032128.md).
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seule la lecture par le protocole POP3 est disponible.






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Lecture du premier email 
EmailLitEntêtePremier(IDEmail)
SI Email.EnDehors = Faux ALORS
	// Affiche l'expéditeur et le sujet dans un champ Table
	TableAjoute(TABLE_EmailRecus, Email.Expéditeur + TAB + Email.Sujet)
	// Lecture de l'email suivant
	EmailLitEntêteSuivant(IDEmail)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Lire l'entête de l'email suivant géré par le protocole POP3 ou IMAP 

`<Résultat> = EmailLitEntêteSuivant(<Session> [, <Email>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'entête du message a été lu, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Session> : (Chaîne de caractères ou variable de type emailSessionPOP3 ou emailSessionIMAP)`**

Identifie la session d'un utilisateur. Correspond :

- au nom d'utilisateur utilisé pour ouvrir la session email (fonction [EmailOuvreSession](../WDLang3/3032028.md)).

- à une variable de type [emailSessionPOP3](../WDLang3/1000018759.md).

- à une variable de type [emailSessionIMAP](../WDLang3/1000018957.md).


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les variables de type [emailSessionPOP3](../WDLang3/1000018759.md) et [emailSessionIMAP](../WDLang3/1000018957.md) ne sont pas supportées.

**`<Email> : (Variable de type Email optionnelle)`**

Nom de la variable de type [Email](../WDLang3/1000018713.md) à initialiser avec le contenu du message.
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre n'est pas disponibleSi ce paramètre n'est pas spécifié, la structure [Email](../WDLang3/3032029.md) est utilisée.


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Lire l'entête de l'email suivant géré par l'intermédiaire de Lotus Notes ou Outlook

`<Résultat> = EmailLitEntêteSuivant(<Session> [, <Email> [, <Mode de lecture>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'entête du message a été lu, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Session> : (Entier)`**

Identifiant de la session email en cours. Cet identifiant peut être :

- un entier renvoyé par la fonction [EmailOuvreSessionOutlook](../WDLang3/3032128.md) ou [OutlookOuvreSession](../WDLang3/3032123.md).

- une variable de type [emailSessionOutlook](../WDLang3/1000018767.md).

- une variable de type [emailSessionNotes](../WDLang3/1000018768.md).

- une variable de type [emailSessionIMAP](../WDLang3/1000018957.md).




**`<Email> : (Variable de type Email optionnelle)`**

Nom de la variable de type [Email](../WDLang3/1000018713.md) à initialiser avec le contenu du message.

Si ce paramètre n'est pas spécifié, la structure [Email](../WDLang3/3032029.md) est utilisée.

**`<Mode de lecture> : (Constante ou chaîne de caractères optionnelle)`**

Précise les messages qui doivent être lus :


|   |   |
| --- | --- |
| *emailNonLus* ou "NON LUS" | Seuls les messages qui n'ont pas été consultés seront lus. |
| *emailTous* ou "TOUS"<br>(Valeur par défaut) | Tous les messages seront lus. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
<a name="NOTE0_2"></a>


### Pas d'email suivant
<a name="pas_email_suivant_ELTPARAGRAPHE000214"></a>Si aucun email n'a été trouvé (pas de message suivant), la variable Email.EnDehors est positionnée à <u><u><u><u>Vrai</u></u></u></u>. Le prochain appel à la fonction **EmailLitEntêteSuivant** permettra de lire l'entête du premier message reçu (équivalent à la fonction [EmailLitEntêtePremier](../WDLang3/3032013.md)).
<a name="NOTE0_3"></a>


### Initialisation de la lecture des emails
<a name="initialisation_lecture_des_emails_ELTPARAGRAPHE000231"></a>Si la lecture n'a pas été initialisée par la fonction [EmailLitEntêtePremier](../WDLang3/3032013.md), la fonction **EmailLitEntêteSuivant** permet de lire l'entête du premier message.
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Messagerie Outlook
<a name="messagerie_outlook_ELTPARAGRAPHE000377"></a>Les fonctions WLangage **EmailLitxxx** fonctionnent uniquement avec le fichier de données Outlook (.pst) par défaut. Les autres fichiers de données ne sont pas gérés.

<a name="XComposante"></a>

## Composante :
wd280com.dll
