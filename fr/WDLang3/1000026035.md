
## &lt;modbusSession&gt;.EcritFlottant (Fonction)

***En anglais : &lt;modbusSession&gt;.WriteFloat***

<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ecrit une ou plusieurs flottants simple précision à partir d'une adresse précise dans un esclave Modbus.

Remarques : 

- Cette fonction permet d'écrire un ou plusieurs flottants de simples précisions dans des registres contiguës chez l'esclave. 

- L'exécution de cette fonction est bloquante tant que l'esclave n'a pas accusé réception du message ou tant que le délai d'attente de la session n'est pas dépassé. 

- L'écriture d'un ou de plusieurs flottants correspond au code fonction Modbus 16 (Write Multiple Holding Registers).



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Crée une session et connexion à un serveur Modbus
Session est un modbusSession
Session = ModbusConnecteTCP("192.168.1.7")

// Si la connexion échoue, affiche l'erreur
SI ErreurDétectée = Vrai ALORS
	Trace(ErreurInfo())
SINON
	// Écrit une séquence de 5 flottants à partir de l'adresse 0x42
	SI PAS Session.EcritFlottant(0x42, [1.5, 3.1415, 2.718, -15, 0.0], modbusABCD) ALORS
		Trace(ErreurInfo())	
	FIN
FIN

// Déconnexion
Session.Déconnecte()
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Ecrire 1 flottant simple précision sur un esclave Modbus

`<Résultat> = <Session>.EcritFlottant(<Adresse> , <Flottant> , <Boutisme>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> l'écriture a été réalisée,  

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Session> : (Variable de type modbusSession)`**

Nom de la variable de type [modbusSession](../WDLang3/1000025924.md) correspondant à la session de communication vers l'esclave Modbus.

**`<Adresse> : (Entier)`**

Valeur comprise entre 0 et 65 535 correspondant à l'adresse (dans l'esclave) à laquelle le flottant simple précision doit être écrit.

**`<Flottant> : (Réel)`**

Valeur du flottant simple précision qui doit être écrit dans le registre.

**`<Boutisme> : (Constante de type Entier)`**

Mode de stockage du flottant dans la mémoire de l'esclave. Les octets sont identifiés de A à D, avec A l'octet de poids fort et D l'octet de poids faible (norme flottant IEEE-754).


|   |   |
| --- | --- |
| *modbusABCD* | Les octets envoyés conservent le même ordre dans la mémoire de l'esclave. |
| *modbusBADC* | Les octets envoyés sont inversés 2 à 2 dans la mémoire de l'esclave. |
| *modbusCDAB* | Les octets envoyés sont inversés 2 à 2 dans la mémoire de l'esclave. |
| *modbusDCBA* | Les octets envoyés sont inversés dans la mémoire de l'esclave. |




<a name="SYNTAXE2"></a>

### Ecrire plusieurs flottants simple précision sur un esclave Modbus

`<Résultat> = <Session>.EcritFlottant(<Adresse> , <Flottants à envoyer> , <Boutisme>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> l'écriture a été réalisée,  

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Session> : (Variable de type modbusSession)`**

Nom de la variable de type [modbusSession](../WDLang3/1000025924.md) correspondant à la session de communication vers l'esclave Modbus.

**`<Adresse> : (Entier)`**

Valeur comprise entre 0 et 65 535 correspondant à l'adresse (dans l'esclave) à laquelle les flottants simple précision doivent être écrits.

**`<Flottants à envoyer> : (Tableau)`**

Nom du tableau de réels simple précision à envoyer.

**`<Boutisme> : (Constante de type Entier)`**

Mode de stockage du flottant dans la mémoire de l'esclave. Les octets sont identifiés de A à D, avec A l'octet de poids fort et D l'octet de poids faible (norme flottant IEEE-754).


|   |   |
| --- | --- |
| *modbusABCD* | Les octets envoyés conservent le même ordre dans la mémoire de l'esclave. |
| *modbusBADC* | Les octets envoyés sont inversés 2 à 2 dans la mémoire de l'esclave. |
| *modbusCDAB* | Les octets envoyés sont inversés 2 à 2 dans la mémoire de l'esclave. |
| *modbusDCBA* | Les octets envoyés sont inversés dans la mémoire de l'esclave. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
ATTENTION : Les opérations d'écriture permettant de manipuler des automates, il est recommandé de tester les différentes commandes avant une mise en production afin de vérifier que les automates effectuent bien les opérations demandées.





<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280com.dll
