
## ModbusConnecteRTU (Fonction)

***En anglais : ModbusConnectRTU***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Connecte un poste client à un esclave Modbus via le port série.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Crée une session et connexion à l'esclave Modbus sur le port série COM4
Session est un modbusSession
Session = ModbusConnecteRTU("COM4",1)

// Si la connexion échoue, affiche l'erreur.
SI ErreurDétectée = Vrai ALORS
	Trace(ErreurInfo())
SINON
	// Ecrit une valeur dans le registre 0x42 de l'esclave.
	ModbusEcritRegistre(Session, 0x42,0xCAFE)
FIN

// Libère le port série
ModbusDéconnecte(Session)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Session> = ModbusConnecteRTU(<Port série> [, <Identifiant de l'esclave> [, <Taux> [, <Parité> [, <Nb Bits données> [, <Nb Bits stop>]]]]])`
---

**`<Session> : (Variable de type modbusSession)`**

Variable de type [modbusSession](../WDLang3/1000025924.md) qui permet de communiquer avec l'esclave Modbus.

**`<Port série> : (Chaîne de caractères)`**

Nom du port série à utiliser : COM1, COM2, COM3, ... COM256.

**`<Identifiant de l'esclave> : (Entier optionnel)`**

Identifiant de l'esclave, compris entre 0 et 255. 
Par défaut, ce paramètre a pour valeur 0, valeur de broadcast. 
Remarque : La valeur 0 peut être également spécifiée si l'identifiant de l'esclave doit être précisé ultérieurement via la propriété **IDEsclave** de la variable de type [modbusSession](../WDLang3/1000025924.md).

**`<Taux> : (Entier optionnel)`**

Taux de transfert des données (exprimé en Bauds ou Bits par seconde)à utiliser pour la connexion série. Par défaut, ce paramètre a pour valeur 9600 bauds.

**`<Parité> : (Entier optionnel)`**

Parité du transfert sur le port :



|   |   |
| --- | --- |
| 0 | Aucune parité |
| 1 | Parité paire |
| 2 | Parité impaire |

Remarque : Il n'y a pas de parité par défaut. 

**`<Nb Bits données> : (Entier optionnel)`**

Nombre de bits de données sur le port série : 5, 6, 7 ou 8.

**`<Nb Bits stop> : (Entier optionnel)`**

Nombre de bits de stop sur le port série : 



|   |   |
| --- | --- |
| 0 <br>(Valeur par défaut) | 1 bit stop |
| 1 | 1.5 bits stop |
| 2 | 2 bits stop |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Après l'appel de la fonction **ModbusConnecteRTU**, il est conseillé de vérifier la variable [ErreurDétectée](../WDLang1/3087001.md) pour s'assurer qu'il n'y a pas d'erreur.

- L'identifiant de l'esclave est présent dans la variable [modbusSession](../WDLang3/1000025924.md). Si des opérations doivent être effectuées sur plusieurs esclaves différents, il est possible de changer l'identifiant de l'esclave dans la variable [modbusSession](../WDLang3/1000025924.md) pour éviter la réouverture de la session. 








<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280com.dll
