


## EmailOuvreSessionOutlook (Fonction)

***En anglais : EmailStartOutlookSession***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet d'accéder aux différentes données manipulées par le logiciel de messagerie Outlook (emails, contacts, groupes de contacts, tâches, rendez-vous et dossiers). Cette fonction est identique à [OutlookOuvreSession](../WDLang3/3032123.md).

**Attention** : Cette fonction ne permet pas d'accéder aux différentes données manipulées par le logiciel de messagerie Outlook Express.

**Remarque** : Lors de l'utilisation de la fonction **EmailOuvreSessionOutlook**, le répertoire en cours est automatiquement modifié par Outlook.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ouverture de la session 
SI EmailOuvreSessionOutlook("MonProfil") <> 0 ALORS
	Info("Session ouverte")
SINON
	ErreurInfo()
FIN
```

```wl
nIDSessionOutlook est un entier
// Ouvre la session Outlook avec le profile par défaut 
nIDSessionOutlook = EmailOuvreSessionOutlook("")
// Session ouverte ?
SI nIDSessionOutlook = 0 ALORS
	// Echec d'ouverture de la session
	Erreur("Echec d'ouverture de la session Outlook", ErreurInfo())
SINON
	// Traitement ici
	Info("Liste des dossiers des emails de Outlook :", ...
			EmailListeDossier(nIDSessionOutlook))
	// Referme la session
	EmailFermeSession(nIDSessionOutlook)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Ouvrir la session Outlook

`<Résultat> = EmailOuvreSessionOutlook(<Profil>)`
---

**`<Résultat> : (Entier)`**



- Identifiant de la session.

- 0 (ou <u><u><u><u>Faux</u></u></u></u>) en cas d'erreur. La variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Profil> : (Chaîne de caractères)`**

Identifie le profil de la connexion (voir Remarques).

Si ce paramètre correspond à une chaîne vide ("") :

- si plusieurs profils sont définis sur le poste en cours, la fonction **EmailOuvreSessionOutlook** affiche une fenêtre contenant tous les profils dans laquelle l'utilisateur peut choisir son profil.

- si un seul profil est défini sur le poste en cours, la fonction **EmailOuvreSessionOutlook** sélectionne automatiquement ce profil.





<a name="SYNTAXE2"></a>

### Ouvrir la session Outlook en spécifiant le mode de gestion des contacts / participants

`<Résultat> = EmailOuvreSessionOutlook(<Profil> , <Asynchrone> [, <Options d'ouverture>])`
---

**`<Résultat> : (Entier)`**



- Identifiant de la session.

- 0 (ou <u><u><u><u>Faux</u></u></u></u>) en cas d'erreur. La variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Profil> : (Chaîne de caractères)`**

Identifie le profil de la connexion (voir Remarques).

Si ce paramètre correspond à une chaîne vide ("") :

- si plusieurs profils sont définis sur le poste en cours, la fonction **EmailOuvreSessionOutlook** affiche une fenêtre contenant tous les profils dans laquelle l'utilisateur peut choisir son profil.

- si un seul profil est défini sur le poste en cours, la fonction **EmailOuvreSessionOutlook** sélectionne automatiquement ce profil.




**`<Asynchrone> : (Constante ou booléen)`**

Mode d'envoi des emails : 


|   |   |
| --- | --- |
| *emailAsynchrone* ou <u><u><u><u>Vrai</u></u></u></u> | Les emails envoyés doivent être transmis en mode asynchrone (voir les Remarques). |
| *emailSynchrone* ou <u><u><u><u>Faux</u></u></u></u><br>(Valeur par défaut) | Les emails envoyés doivent être transmis en mode synchrone (voir les Remarques). |

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Ce paramètre doit correspondre à *emailSynchrone* ou <u><u><u><u>Faux</u></u></u></u>. 

**`<Options d'ouverture> : (Constante de type entier optionnelle)`**

Mode d'ouverture de la session Outlook : 


|   |   |
| --- | --- |
| *outlookRDVAvecContact*<br>(Valeur par défaut) | Les fonctions RendezVousXXX listeront les contacts associés aux rendez-vous dans la variable mRendezVous.Participant (voir [Structure RendezVous](../WDLang3/1000011010.md)). |
| *outlookRDVAvecParticipant* | Les fonctions RendezVousXXX listeront les participants associés aux rendez-vous dans les variables :<br><br>- mRendezVous.Participant<br><br>- mRendezVous.ParticipantCc<br><br>- mRendezVous.ParticipantCci<br><br><br>Pour plus de détails, consultez [Structure RendezVous](../WDLang3/1000011010.md). |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Création d'un profil
<a name="creation_profil_ELTPARAGRAPHE000157"></a>Pour ouvrir une nouvelle session avec Outlook, il est nécessaire de définir un "profil". Ce "profil" est défini dans la configuration de la connexion Internet avec Outlook.

Pour créer un profil :

1. Exécutez Outlook.

2. Dans la fenêtre "Choix d'un profil", cliquez sur [Nouveau].

3. Sélectionnez le service "Microsoft Exchange Server".

4. Donnez un nom au profil.

5. Donnez le nom du serveur Microsoft Exchange.



<a name="NOTE0_2"></a>


### Délai de timeout
<a name="delai_timeout_ELTPARAGRAPHE000178"></a>Il est possible de paramétrer le délai de timeout avec la fonction [EmailChangeTimeOut](../WDLang3/3032001.md).
<a name="NOTE0_3"></a>

<a name="XComposante"></a>

## Composante :
wd280com.dll
