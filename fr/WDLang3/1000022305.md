


## &lt;Variable emailSessionPOP3&gt;.OuvreSession (Fonction)

***En anglais : &lt;emailPOP3Session variable&gt;.StartSession***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ouvre une session de gestion des emails via le protocole POP3. 

**Remarque** : Pour ouvrir une session de lecture des emails (via le protocole POP3 uniquement), utilisez la fonction [EmailOuvreSessionPOP3](../WDLang3/3032022.md).
<a name="sample_code"></a>

## Exemple

<a name="3032028_Exemple1"></a>

```wl
MaSessionPop3 est un emailSessionPOP3
...
// Ouvre une session pour l'envoi d'un email par le protocole POP3 
SI MaSessionPop3.OuvreSession() = Vrai ALORS
	NomUser = MaSessionPop3..Nom
SINON
	NomUser = ""
	Erreur("Impossible d'établir la connexion")
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Ouvrir une session d'emails POP3

`<Résultat> = <Session POP3>.OuvreSession()`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la session a été ouverte, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. 
	Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Session POP3> : (Variable de type emailSessionPOP3)`**

Nom de la variable de type [emailSessionPOP3](../WDLang3/1000018759.md) correspondant à la session d'emails à manipuler.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Protocoles POP3 et SMTP
<a name="protocoles_pop3_smtp_ELTPARAGRAPHE000397"></a>Les différents paramètres passés à la fonction **&lt;Variable emailSessionPOP3&gt;.OuvreSession** sont fournis par le fournisseur de services ou par l'administrateur réseau.

Avant de pouvoir gérer les emails, il est nécessaire d'ouvrir une connexion Internet. Plusieurs cas peuvent se présenter :

- L'utilisateur utilise une connexion à Internet directe (cable ou ADSL) : aucune opération spécifique ne doit être faite.

- L'utilisateur utilise un modem pour se connecter à Internet : la fonction [NetOuvreAccèsDistant](../WDLang3/3056026.md) permet d'ouvrir la connexion à Internet.


Par défaut, si seule l'adresse IP du serveur POP3 est précisée, cette adresse sera utilisée par le serveur d'emails utilisant le protocole SMTP. Il est nécessaire de préciser l'adresse IP du protocole SMTP uniquement si le compte POP3 et le compte SMTP ne passent pas par le même poste.
<a name="NOTE0_2"></a>


### SMTP authentifié
<a name="smtp_authentifie_ELTPARAGRAPHE000420"></a>L'authentification SMTP ne peut pas être effectuée avec la fonction **&lt;Variable emailSessionPOP3&gt;.OuvreSession**. Pour ouvrir à la fois une session POP3 et une session SMTP authentifiée il est nécessaire d'utiliser les deux fonctions [EmailOuvreSessionPOP3](../WDLang3/3032022.md) et [EmailOuvreSessionSMTP](../WDLang3/3032025.md).
<a name="NOTE0_3"></a>


### Délai de timeout
<a name="delai_timeout_ELTPARAGRAPHE000439"></a>Il est possible de paramétrer le délai de timeout avec la fonction [EmailChangeTimeOut](../WDLang3/3032001.md).
<a name="NOTE0_4"></a>
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 

### Fonctionnalité d'application requise
<a name="fonctionnalite_application_requise_ELTPARAGRAPHE000456"></a>L'utilisation de cette fonction entraîne la déclaration d'une fonctionnalité d'application dans l'assistant de génération de l'application.

Fonctionnalité requise : Réseaux domestiques et professionnels

Cette fonctionnalité permet aux applications d'utiliser des accès entrants et sortants vers des réseaux domestiques et professionnels. 
<a name="NOTE0_5"></a>


### Gmail : Que faire si une connexion à Gmail (SMTP, IMAP, POP3) échoue avec une erreur de certificat ?
<a name="gmail_que_faire_une_connexion_gmail_smtp_imap_pop3_echoue_avec_une_erreur_certificat_ELTPARAGRAPHE000471"></a>Depuis fin août 2017, Google a déployé un nouveau certificat : Google Internet Authority G3. Malheureusement, l'API Windows utilisée pour la vérification des certificats ne valide pas ce certificat.

L'ouverture d'une session POP3, IMAP ou SMTP peut donc échouer avec le retour "La chaîne de certificats a été fournie par une autorité qui n'est pas approuvée".

Afin de permettre la validation du certificat, il est possible de modifier le mode de gestion des emails. La fonction WLangage [EmailParamètre](../WDLang3/1000022269.md) permet de changer ce mode et ainsi de ne plus utiliser l'API Windows qui bloque ce certificat. Voici le code à ajouter avant l'ouverture de la session par la fonction **&lt;Variable emailSessionPOP3&gt;.OuvreSession** :

```wl
// Activation de l'implémentation multiplateforme
EmailParamètre(emailParamètreMode, 1)
```


Remarque : À partir de la version 23 Update 1, l'appel à la fonction [EmailParamètre](../WDLang3/1000022269.md) n'est plus nécessaire : le WLangage utilise automatiquement le mode de gestion des emails adapté à la session.










<a name="XComposante"></a>

## Composante :
wd280com.dll
