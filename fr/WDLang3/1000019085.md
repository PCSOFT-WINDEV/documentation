


## &lt;Variable zipArchive&gt;.ExtraitTout (Fonction)

***En anglais : &lt;zipArchive variable&gt;.ExtractAll***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Extrait et décompresse automatiquement la totalité des fichiers d'une archive à un emplacement physique.

L'archive manipulée peut être au format CAB, RAR, ZIP, WDZ, 7z, TAR ou TGZ (TAR.GZ).

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
Archive est un zipArchive

// Ouverture d'une archive
ResOuvreArchive = Archive.Ouvre("C:\Archives\Archive.zip")

SI ResOuvreArchive = 0 ALORS
	...
	// Extraction de tous les fichiers de l'archive
	ResExtraitTout = Archive.ExtraitTout(zipDisque)
	...
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Archive>.Extraittout([<Destination des fichiers> [, <Options> [, <Procédure WLangage> [, <Progression>]]]])`
---

**`<Résultat> : (Entier)`**



- 0 si les fichiers ont été extraits, 

- Un code d'erreur (valeur supérieure à 0) dans le cas contraire. Pour plus de détails sur ces codes d'erreur, consultez les Remarques.




**`<Archive> : (Variable de type zipArchive)`**

Nom d'une variable de type [zipArchive](../WDLang3/1000018679.md) correspondant à l'archive à manipuler.

**`<Destination des fichiers> : (Chaîne de caractères ou constante optionnelle)`**

Chemin de destination des fichiers extraits :

- Chaîne de caractères optionnelle : Les fichiers sont extraits dans le chemin spécifié auquel s'ajoute l'arborescence mémorisée de chaque fichier (le disque n'est pas conservé). Le chemin spécifié est créé s'il n'existe pas.
	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Le chemin destination du fichier extrait doit correspondre au répertoire de travail de l'application (connu avec la fonction [fRepDonnées](../WDLang1/3036001.md)) ou à un de ses sous-répertoires.

- Constante optionnelle :
	


|   |   |
| --- | --- |
| *zipDisque* | Extraction :<br><br>	- à l'emplacement d'origine du fichier s'il a été mémorisé et si le disque existe.<br><br>	- avec restauration de l'arborescence du fichier sur le disque en cours si le disque ou si le répertoire mémorisé n'existe pas.<br><br>	- dans le répertoire en cours si seuls le nom et l'extension du fichier ont été mémorisés.<br><br><br>**Remarque** : Si la constante *zipDisque* est utilisée, le format WDZ mémorise le chemin complet du fichier (lettre du lecteur comprise) alors que le format ZIP ne mémorise par la lettre du lecteur.<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas disponible. Les répertoires n'ont pas de racine.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante a le même effet que la constante *zipRépertoire*.<br><br>**Archives au format 7z** :  Cette constante aura le même effet que la constante *zipRépertoire*. |
| *zipEcrase* | Lors de l'extraction, les fichiers existants en lecture seulement sont automatiquement écrasés par les fichiers extraits. Cette constante peut être combinée avec les constantes *zipDisque* et *zipRépertoire*.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *zipRépertoire* | Extraction dans le répertoire en cours avec restauration de l'arborescence du fichier (si elle a été mémorisée). |





![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Il n'est pas possible d'utiliser ces constantes.

**`<Options> : (Constante optionnelle)`**

Paramétrage de l'extraction (si le paramètre &lt;Destination des fichiers&gt; correspond à une chaîne de caractères) :



|   |   |
| --- | --- |
| *zipEcrase* | Lors de l'extraction, les fichiers existants en lecture seulement sont automatiquement écrasés par les fichiers extraits.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |



**`<Procédure WLangage> : (Nom de procédure optionnel)`**

Nom de la procédure WLangage qui sera appelée si une erreur est rencontrée lors de l'extraction des fichiers. 
**ATTENTION** : Ce paramètre peut être utilisé uniquement si le paramètre &lt;Archive&gt; correspond à une variable de type [zipArchive](../WDLang3/1000018679.md).

Cette procédure est de la forme : 

```txt
PROCEDURE <Nom de la procédure>(<Code erreur>, <Nom du fichier>)
```


où : 

- &lt;Code erreur&gt; est un entier correspondant au code de l'erreur rencontrée lors de l'extraction du fichier.

- &lt;Nom du fichier&gt; est une chaîne de caractères contenant le chemin du fichier traité par la fonction **&lt;Variable zipArchive&gt;.ExtraitTout**.




La procédure peut renvoyer une des constantes suivantes : 


|   |   |
| --- | --- |
| *zipAnnule* | Annule l'extraction des fichiers présents dans l'archive.  |
| *zipIgnore* | Ignore le fichier en erreur. |
| *zipRecommence* | Retente l'extraction du fichier. |


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre est interdit.

**`<Progression> : (Nom de champ ou nom de procédure)`**

Mode de gestion de la jauge. Ce paramètre peut correspondre : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) au nom d'un champ Jauge présent dans une fenêtre. Cette jauge affichera la progression de l'extraction de la totalité des fichiers manipulés.  

- au nom d'une procédure WLangage. Cette procédure est de la forme : 
	
	```txt
	PROCEDURE <Nom de la procédure> (<Fichier en cours>, 
	<Pourcentage d'avancement global>, <Pourcentage d'avancement du fichier>)
	```

	où : 

	- &lt;Fichier en cours&gt; correspond au nom du fichier en cours de traitement. 

	- &lt;Pourcentage d'avancement global&gt; correspond au pourcentage d'avancement de l'extraction des fichiers de l'archive. 

	- &lt;Pourcentage d'avancement du fichier&gt; correspond au pourcentage d'avancement de l'extraction du fichier en cours de l'archive.







**Si vous manipulez une archive** : 

- **au format TAR ou TGZ (TAR.GZ)**, la jauge est mise à jour uniquement à la fin de l'extraction de chaque fichier. 

- **au format CAB et RAR**, la jauge est mise à jour uniquement à la fin de l'extraction de chaque fichier. 

- **au format 7z**, seul le paramètre &lt;Pourcentage d'avancement global&gt; est renseigné. Le paramètre &lt;Pourcentage d'avancement du fichier&gt; aura la même valeur.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Codes d'erreur
<a name="codes_erreur_ELTPARAGRAPHE000408"></a>Les codes d'erreur retournés sont les suivants :

- 1 : Le chemin passé en paramètre n'existe pas.

- 2 : Accès interdit : l'utilisateur n'a pas les droits nécessaires.

- 3 : L'archive est corrompue.

- 4 : Le chemin n'existe pas dans l'archive.

- 6 : Les fichiers des sous-archives ne sont pas dans l'ordre (cas d'une extraction dans une archive multi-parties).




Le message correspondant au code d'erreur peut être connu grâce à la fonction [zipMsgErreur](../WDLang3/3082034.md).

Rappel : 

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Seules les archives au format ZIP, TAR et TGZ (TAR.GZ) sont disponibles.

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seules les archives au format ZIP sont disponibles.

- Le format RAR est géré jusqu'à la version 4 incluse.



<a name="NOTE0_2"></a>


### Fichier extrait
<a name="fichier_extrait_ELTPARAGRAPHE000439"></a>Les fichiers extraits ne sont pas effacés de l'archive. Pour effacer un ou tous les fichiers de l'archive, utilisez la fonction [&lt;Variable zipArchive&gt;.SupprimeFichier](../WDLang3/1000019152.md) ou [&lt;Variable zipArchive&gt;.SupprimeTout](../WDLang3/1000019154.md).

<a name="XComposante"></a>

## Composante :
wd280zip.dll
