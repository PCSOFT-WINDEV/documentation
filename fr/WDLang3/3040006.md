
## FTPAttribut (Fonction)

***En anglais : FTPAttribute***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Identifie les attributs d'un fichier présent sur un serveur FTP (File Transfer Protocol).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003040006&name=ftpattribut_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Connaître les attributs du fichier
// "/Documents/Fichier.Doc" présent sur le serveur FTP
ResAttributs = FTPAttribut(NumConnexion, "/Documents/Fichier.Doc")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Identifier les attributs du dernier fichier consulté

`<Résultat> = FTPAttribut()`
---

**`<Résultat> : (Chaîne de caractères)`**



- "ERR" en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.

- Une ou plusieurs lettres correspondant aux attributs du fichier ("AH" par exemple). Les lettres utilisées sont :

	- R : Fichier en lecture seule. Le fichier est uniquement accessible en lecture.

	- H : Fichier caché. Le nom du fichier est généralement grisé ou invisible dans l'explorateur.
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette option n'est pas disponible.

	- S : Fichier système. Le fichier est un fichier système Windows.
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette option n'est pas disponible.

	- A : Fichier "archive". Cet attribut indique que le fichier peut être archivé. Certains programmes se servent de cet attribut pour savoir quels fichiers ont été sauvegardés.
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette option n'est pas disponible.

	- D : Répertoire ou sous-répertoire. Le fichier est un répertoire ou un sous-répertoire.

	- C : Fichier compressé (sur les partitions NTFS). Le fichier a été automatiquement compressé lors de sa copie sur une partition NTFS (Windows NT ou 2000).
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette option n'est pas disponible.







Cette syntaxe retourne les attributs du dernier fichier accédé au moyen de l'une des fonctions FTP suivantes : [FTPDate](../WDLang3/3040015.md), [FTPHeure](../WDLang3/3040013.md), [FTPTaille](../WDLang3/3040007.md), [FTPListeFichier](../WDLang3/3040018.md). Contrairement à la syntaxe 2, aucune requête n'est envoyée au serveur. Cette syntaxe est à privilégier dès que possible.  


<a name="SYNTAXE2"></a>

### Identifier les attributs du fichier spécifié

`<Résultat> = FTPAttribut(<Identifiant de la connexion> , <Nom du fichier>)`
---

**`<Résultat> : (Chaîne de caractères)`**



- "ERR" en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*

- Une ou plusieurs lettres correspondant aux attributs du fichier ("AH" par exemple). Les lettres utilisées sont :

	- R : Fichier en lecture seule. Le fichier est uniquement accessible en lecture.

	- H : Fichier caché. Le nom du fichier est généralement grisé ou invisible dans l'explorateur.
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette option n'est pas disponible.

	- S : Fichier système. Le fichier est un fichier système Windows.
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette option n'est pas disponible.

	- A : Fichier "archive". Cet attribut indique que le fichier peut être archivé. Certains programmes se servent de cet attribut pour savoir quels fichiers ont été sauvegardés.
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette option n'est pas disponible.

	- D : Répertoire ou sous-répertoire. Le fichier est un répertoire ou un sous-répertoire.

	- C : Fichier compressé (sur les partitions NTFS). Le fichier a été automatiquement compressé lors de sa copie sur une partition NTFS (Windows NT ou 2000). 
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette option n'est pas disponible.







**`<Identifiant de la connexion> : (Entier)`**

Identifiant de la connexion, obtenu avec la fonction [FTPConnecte](../WDLang3/3040016.md).



**`<Nom du fichier> : (Chaîne de caractères)`**

Nom et chemin absolu (ou relatif) du fichier à manipuler. Les parties du chemin sont séparées par des "slash" (barre oblique normale, "/").  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Identification des différents attributs d'un fichier
<a name="identification_des_differents_attributs_fichier_ELTPARAGRAPHE000142"></a>Pour connaître les différents attributs d'un fichier, il suffit de rechercher si une des lettres identifiant un attribut est présente dans &lt;Résultat&gt;. Cette recherche peut être effectuée avec la fonction [Position](../WDLang1/3024027.md) par exemple.


<a name="NOTE0_2"></a>




### Délai
<a name="delai_ELTPARAGRAPHE000154"></a>Par défaut, toutes les fonctions FTP échouent si aucune réponse du serveur FTP n'est reçue après 20 secondes. Ce délai peut être modifié lors de la connexion au serveur FTP avec la fonction [FTPConnecte](../WDLang3/3040016.md).


<a name="NOTE0_3"></a>
<a name="NOTE0_4"></a>




### Droits des utilisateurs
<a name="droits_des_utilisateurs_ELTPARAGRAPHE000185"></a>L'identification des attributs de fichiers ou de répertoires présents sur un serveur FTP n'est possible que pour un utilisateur ayant les droits en lecture sur le serveur FTP. En règle générale, les utilisateurs "anonymes" ont les droits en lecture et peuvent donc identifier les attributs d'un fichier ou d'un répertoire présent sur un serveur FTP.


<a name="NOTE0_5"></a>




### Chemin relatif et absolu
<a name="chemin_relatif_absolu_ELTPARAGRAPHE000194"></a>Les notions de chemin relatif et de chemin absolu sont très importantes dans une application FTP.

- Un chemin commençant par un slash est considéré comme un **chemin absolu** : il s'agit du chemin par rapport à la racine du serveur FTP (paramètre propre au serveur).
	ex: /pub/user/JULIE

- Si le chemin ne commence pas par un slash, il est considéré comme un **chemin relatif**, c'est-à-dire le chemin par rapport au répertoire en cours. Ce répertoire en cours peut-être connu ou modifié avec la fonction [FTPRepEnCours](../WDLang3/3040003.md).




Lors de la connexion à un site FTP, le répertoire initial, le "home directory" de l'utilisateur n'est pas forcément la racine du serveur FTP. Il est donc conseillé d'utiliser des chemins relatifs.


<a name="NOTE0_6"></a>

<a name="XComposante"></a>

## Composante :
wd280com.dll
