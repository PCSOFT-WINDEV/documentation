
## NotesAjouteFichierAttaché (Fonction)

***En anglais : NotesAddAttachment***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Attache un fichier à un champ du document en cours dans Lotus Notes.

Pour prendre en compte l'attachement de ce fichier, il est nécessaire d'enregistrer le document à l'aide de la fonction [NotesEnregistre](../WDLang3/1000005110.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ouverture de la connexion
IDConnexion est un entier
IDConnexion = NotesOuvreConnexion("MotDePasse", "ServeurMars", ...
		"C:\Users\Julie\AppData\Local\Lotus\Notes\Data\user.id")

// Spécification de la base Lotus Notes à utiliser
IDBase est un entier
IDBase = NotesOuvreBase(IDConnexion, "julie.nsf")
...
// Lecture du premier document
NotesDocumentPremier(IDBase)
...
// Attachement d'un fichier au document en cours 
NotesAjouteFichierAttaché(IDBase, "MonChampLotusNotes", "C:\MesDocuments\MonFichier.TXT")
// Prise en compte de cet attachement
NotesEnregistre(IDBase)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = NotesAjouteFichierAttaché(<Identifiant de la session> , <Champ Lotus Notes> , <Fichier à attacher>)`
---

**`<Résultat> : (Entier)`**



- Indice du fichier attaché. Ce numéro correspond au nombre de fichiers attachés au champ Lotus Notes spécifié après l'ajout.

- 0 en cas d'erreur. 




En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.

**`<Identifiant de la session> : (Entier)`**

Identifiant de la session à utiliser. Cet identifiant est renvoyé par la fonction [EmailOuvreSessionNotes](../WDLang3/3032121.md) ou [NotesOuvreBase](../WDLang3/1000005101.md).

**`<Champ Lotus Notes> : (Chaîne de caractères)`**

Nom du champ Lotus Notes de type Texte Riche auquel le fichier doit être attaché. Si ce champ Lotus Notes n'existe pas, il est automatiquement créé.

Pour connaître le nom et le type des champs du document Notes en cours, utilisez la fonction [NotesListeChamp](../WDLang3/1000005112.md).

**`<Fichier à attacher> : (Chaîne de caractères)`**

Nom et chemin complet ou relatif du fichier à attacher au champ spécifié dans le document Notes en cours. Ce fichier sera automatiquement copié dans la base Lotus Notes en cours.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Champ d'un document Notes
<a name="champ_document_notes_ELTPARAGRAPHE000068"></a>Chaque champ d'un document Notes peut avoir jusqu'à 256 fichiers attachés.



<a name="XComposante"></a>

## Composante :
wd280mess.dll
