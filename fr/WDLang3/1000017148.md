
## OBEXListeFichier (Fonction)

***En anglais : OBEXListFile***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Liste les fichiers partagés par un périphérique utilisant le protocole OBEX.

**Remarque** : Cette fonction ne peut pas être utilisée en cas de transfert par infrarouge.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
sAdresseMAC est une chaîne
// Récupération de l'adresse MAC du périphérique Bluetooth
// L'adresse est stockée dans une colonne de table
sAdresseMAC = TABLE_Appareils.COL_AdrMAC[TABLE_Appareils]
// Connexion OBEX
SAI_IDOBEX = OBEXConnecte(obexBluetooth, sAdresseMAC)
...
// Récupération de la liste simple des fichiers partagés
ListeFic est une chaîne = OBEXListeFichier(SAI_IDOBEX)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = OBEXListeFichier(<Identifiant de la connexion OBEX> [, <Répertoire de base> [, <Niveau de détail>]])`
---

**`<Résultat> : (Chaîne de caractères)`**

Liste des fichiers du répertoire :

- ***en mode simple*** : liste de la forme : 
	&lt;Nom du fichier 1&gt; + TAB + &lt;Type 1&gt; + RC + ... &lt;Nom du fichier N&gt; + TAB + &lt;Type N&gt; 
	où &lt;Type&gt; correspond à "F" si l'élément est un fichier et "D" si l'élément est un répertoire.

- ***en mode détaillé*** : liste de la forme : 
	&lt;Nom du fichier 1&gt; + TAB + &lt;Type 1&gt; + TAB + &lt;Taille en octets 1&gt; + TAB + &lt;Permissions 1&gt; + TAB + &lt;Date de modification 1&gt; + TAB + &lt;Date de création 1&gt; + TAB + &lt;Date d'accès 1&gt; + RC + ... 
	où &lt;Type&gt; correspond à "F" si l'élément est un fichier, et "D" si l'élément est un répertoire, 
	&lt;Permissions&gt; est une chaîne pouvant contenir les lettres "R" (droit de lire), "W" (droits d'écrire), et "D" (droit d'effacer). 
	Les dates sont de la forme "AAAAMMJJHHmmSS".




**Si la constante *obexListeRépertoire* est utilisée**, ces listes contiendront en plus les sous-répertoires. Cette liste peut éventuellement contenir un répertoire ".." si la racine de l'arborescence du serveur OBEX n'est pas listée.

**`<Identifiant de la connexion OBEX> : (Entier)`**

Identifiant de la connexion OBEX à utiliser. Cet identifiant est retourné par la fonction [OBEXConnecte](../WDLang3/1000017153.md).

**`<Répertoire de base> : (Chaîne de caractères optionnelle)`**

Nom du répertoire à lister. Si ce paramètre n'est pas précisé, le répertoire de transfert est utilisé.

**`<Niveau de détail> : (Constante ou combinaison de constantes optionnelle de type Entier)`**

Niveau de détail du résultat :


|   |   |
| --- | --- |
| *obexListeDétaillée* | &lt;Résultat&gt; contient la liste des fichiers en mode détaillé. |
| *obexListeRépertoire* | &lt;Résultat&gt; contient la liste des fichiers et des répertoires. Cette constante est combinable à *obexListeSimple* et *obexListeDétaillée*. Si elle est utilisée seule, elle est équivalente à *obexListeSimple* + *obexListeRépertoire*. |
| *obexListeSimple*<br>(Valeur par défaut) | &lt;Résultat&gt; contient la liste des fichiers en mode simple. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Fonctionnement
<a name="fonctionnement_ELTPARAGRAPHE000076"></a>Le nom du répertoire à lister n'est pas toujours connu. Un premier appel à la fonction **OBEXListeFichier** (sans nom de répertoire) permet de lister la racine de l'arborescence OBEX. Si le mobile supporte de créer des sous-répertoires, il sera possible d'appeler la fonction **OBEXListeFichier** en précisant le nom d'un sous-répertoire.  


<a name="NOTE0_2"></a>




### Limitation
<a name="limitation_ELTPARAGRAPHE000091"></a>Seules les piles bluetooth Microsoft sont supportées par cette fonction. Pour connaître la pile utilisée, utilisez la fonction [BTPile](../WDLang3/1000017229.md). 

Pour plus de détails sur les clés supportées, consultez [Quelles piles utiliser ?](../WDLang3/1000017231.md)



<a name="XComposante"></a>

## Composante :
wd280com.dll
