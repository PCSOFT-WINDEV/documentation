


## zipMotDePasse (Fonction)

***En anglais : zipPassword***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Définit le mot de passe utilisé pour les opérations d'ajout et d'extraction de fichiers dans l'archive spécifiée (format RAR, ZIP et WDZ). Le mot de passe est associé à chaque fichier de l'archive.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MonArchive est un zipArchive

ArchiveChemin est une chaîne = ComplèteRep(fRepEnCours()) + "Archive.ZIP"
SI fExtraitChemin(ArchiveChemin, fExtension) ~= ".zip" ALORS
	SI zipOuvre(MonArchive, ArchiveChemin) = 0 ALORS
		 // Crypte l'archive
		 zipMotDePasse(MonArchive, "MotDePasse")
		 zipAjouteFichier(MonArchive, "C:\MonFic.txt")
		 // Ajout du fichier. Le fichier est crypté par le mot de passe
	FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = zipMotDePasse(<Archive> , <Mot de passe>)`
---

**`<Résultat> : (Entier)`**



- 0 si le mot de passe a été correctement défini, 

- Un code d'erreur (valeur supérieure à 0) dans le cas contraire.




**`<Archive> : (Chaîne de caractères ou variable de type zipArchive)`**

Nom de l'archive à manipuler.
Ce nom peut correspondre :

- soit au nom d'une archive défini avec la fonction [zipOuvre](../WDLang3/3082044.md) ou [zipCrée](../WDLang3/3082003.md).

- soit au nom d'une variable de type [zipArchive](../WDLang3/1000018679.md). 
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les variables de type [zipArchive](../WDLang3/1000018679.md) ne sont pas disponibles en JAVA.




**`<Mot de passe> : (Chaîne de caractères)`**

Mot de passe utilisé pour crypter les fichiers ajoutés ou décrypter les fichiers extraits. Ce mot de passe doit utiliser des caractères dont le code ASCII est compris entre 1 et 127. La taille maximale de ce mot de passe est 255 caractères.

Pour ne plus crypter les fichiers ajoutés ou extraits, il est possible d'utiliser une chaîne vide ("").  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000108"></a>

- Les formats RAR, ZIP et WDZ ne proposent pas une protection de l'archive à son ouverture. Le mot de passe est nécessaire uniquement pour les opérations d'extraction et d'intégration de fichiers dans l'archive.

- **Archives au format 7z** : Cette fonction n'est pas disponible. 

- **Archives au format TAR et TGZ (TAR.GZ)** : Cette fonction n'est pas disponible. 




![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Rappel : Seules les archives au format ZIP, TAR et TGZ (TAR.GZ) sont disponibles.
<a name="NOTE0_2"></a>


### Utilisation d'une archive cryptée avec un mot de passe
<a name="utilisation_une_archive_cryptee_avec_mot_passe_ELTPARAGRAPHE000121"></a>Le mot de passe est défini par la fonction **zipMotDePasse**. Lorsque le mot de passe est défini, il est utilisé pour toutes les opérations d'archivage suivantes :  

- **Ajout de fichiers** : les fichiers ajoutés seront cryptés avec ce mot de passe

- **Extraction de fichiers** : le mot de passe sera utilisé pour décrypter tous les fichiers extraits.




Le mot de passe est actif sur l'archive sur laquelle il a été donné. Si l'archive est détruite (fonction [zipFerme](../WDLang3/3082005.md)), le mot de passe est perdu. Il devra être à nouveau indiqué après les fonctions [zipOuvre](../WDLang3/3082044.md) ou [zipCrée](../WDLang3/3082003.md).
<a name="NOTE0_3"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000145"></a>

- Le mot de passe peut être différent pour chaque fichier ajouté ou extrait d'une même archive. Il suffit d'utiliser à chaque ajout ou extraction la fonction **zipMotDePasse** en spécifiant le mot de passe attendu par le fichier à ajouter / extraire.

- Il n'est pas possible de modifier directement le mot de passe d'un fichier présent dans l'archive. Il faut extraire le fichier, le supprimer de l'archive, et le remettre dans l'archive avec le nouveau mot de passe.

- La fonction [zipInfoFichier](../WDLang3/3082040.md) permet de savoir si un fichier de l'archive est crypté (+) ou normal (N).



<a name="NOTE0_4"></a>


### Codes d'erreur
<a name="codes_erreur_ELTPARAGRAPHE000160"></a>Les codes d'erreur retournés sont les suivants :

- 23 : Fonctionnalité indisponible sur ce format d'archive.


Le message correspondant au code d'erreur peut être connu grâce à la fonction [zipMsgErreur](../WDLang3/3082034.md).

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280zip.dll
