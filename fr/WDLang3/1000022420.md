


## &lt;Carte&gt;.AjouteItinéraire (Fonction)

***En anglais : &lt;Map&gt;.AddItinerary***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute un itinéraire sur un champ Carte.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Affiche un itinéraire automobile entre les deux adresses spécifiées
CARTE_ChampCarte.AjouteItinéraire(["Place de la comédie, Montpellier", ...
		"Avenue des Champs Elysées, Paris"], itinéraireAutomobile)
```
<a name="Exemple2"></a>

```wl
// Affiche un itinéraire correspondant à la liste de positions géographiques spécifiées
posDépart est une géoPosition
posDépart.Latitude = XXX
posDépart.Longitude = XXX

posArrivée est une géoPosition
posArrivée.Latitude = XXX
posArrivée.Longitude = XXX

CARTE_ChampCarte.AjouteItinéraire([posDépart, posArrivée])

// Il est également possible d'utiliser le code suivant :  
// tabPositions est un tableau de géoPosition
// Ajoute(tabPositions, posDépart)
// Ajoute(tabPositions, posArrivée)
// CARTE_ChampCarte.AjouteItinéraire(tabPositions)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = <Champ Carte>.AjouteItinéraire(<Positions> [, <Mode> [, <Couleur> [, <Opacité> [, <Epaisseur>]]]])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Identifiant de l'itinéraire ajouté, 

- Chaîne vide ("") en cas d'erreur. Pour plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).


![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette fonction est asynchrone : il n'est pas possible de savoir si la fonction a renvoyé une erreur. 

**`<Champ Carte> : (Nom de champ)`**

Nom du champ Carte à manipuler.

**`<Positions> : (Tableau)`**

Nom de la variable de type tableau contenant les différentes positions : 

- Le premier élément correspond au point de départ de l'itinéraire. 

- Le dernier élément correspond au point d'arrivée. 

- Les éventuels autres éléments du tableau constituent les étapes intermédiaires de l'itinéraire. 


Ce tableau doit comporter deux éléments au minimum (position de départ et position d'arrivée). Si vous utilisez la licence Google Map par défaut, ce tableau peut contenir jusqu'à 8 positions intermédiaires (étapes). Si vous utilisez une clé de licence "Google Maps API", le nombre de positions intermédiaires est illimité.  


Ce tableau peut être : 

- un tableau de chaînes de caractères, décrivant l'adresse correspondant à chaque position de l'itinéraire. Par exemple : avenue des Champs Elysée, Paris, France. 
	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) L'usage d'une chaîne de caractères est déconseillé avec le service de cartographie de Bing Map. Les positions peuvent en effet être incohérentes. 

- un tableau de variables de type [Adresse](../WDLang3/1000019944.md), décrivant l'adresse correspondant à chaque position de l'itinéraire. 

- un tableau de variables de type [géoPosition](../WDLang3/1000019191.md) indiquant la position géographique correspondant à chaque position de l'itinéraire.

- un tableau de variables de type [Marqueur](../WDLang3/1000019940.md) représentant chacune des positions de l'itinéraire sur la carte (les marqueurs seront automatiquement ajoutés au champ Carte si ce n'est pas déjà le cas).




**`<Mode> : (Constante optionnelle de type Entier)`**

Mode de calcul de l'itinéraire. Ce paramètre peut prendre l'une des valeurs suivantes : 


|   |   |
| --- | --- |
| *itinéraireAutomobile*<br>(Valeur par défaut) | L'itinéraire sera tracé en respectant les voies accessibles aux automobiles.<br><br>Caractéristiques de ce mode :<br><br>- Ce mode utilise le mode de géolocalisation de Google. Un accès Internet est nécessaire.<br><br>- L'ordre des étapes peut être modifié afin d'obtenir le trajet le plus optimal.<br><br><br> |
| *itinéraireAutomobileNonOptimisé* | L'itinéraire sera tracé en respectant les voies accessibles aux automobiles.<br><br>Caractéristiques de ce mode :<br><br>- Ce mode utilise le mode de géolocalisation de Google. Un accès Internet est nécessaire.<br><br>- L'ordre des étapes ne sera pas modifié.<br><br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |
| *itinéraireCycliste* | L'itinéraire sera tracé en respectant les voies accessibles aux vélos. Les itinéraires cyclistes ne sont pas disponibles dans tous les pays. Pour plus d'informations, consultez la documentation du service de géolocalisation de Google.<br><br>Caractéristiques de ce mode :<br><br>- Ce mode utilise le mode de géolocalisation de Google. Un accès Internet est nécessaire.<br><br>- L'ordre des étapes peut être modifié afin d'obtenir le trajet le plus optimal.<br><br><br> |
| *itinéraireManuel* | L'itinéraire sera tracé de manière rectiligne entre chaque position spécifiée sans tenir compte des routes.<br><br>Ce mode permet de ne pas utiliser le mode de géolocalisation de Google. Dans ce cas, le paramètre &lt;Positions&gt; doit correspondre à un tableau de variables de type [géoPosition](../WDLang3/1000019191.md) ou de variables de type [Marqueur](../WDLang3/1000019940.md).<br><br>Dans ce mode, les étapes intermédiaires sont prises en compte selon l'ordre d'ajout dans le tableau.<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |
| *itinérairePiéton* | L'itinéraire sera tracé en respectant les voies accessibles aux piétons.<br><br>Caractéristiques de ce mode :<br><br>- Ce mode utilise le mode de géolocalisation de Google. Un accès Internet est nécessaire.<br><br>- L'ordre des étapes peut être modifié afin d'obtenir le trajet le plus optimal.<br><br><br> |



**`<Couleur> : (Entier optionnel)`**

Couleur du tracé de l'itinéraire. Cette couleur peut correspondre à :

- une couleur RVB (obtenue avec la fonction [RVB](../WDLang1/3029012.md)),

- une couleur TSL (obtenue avec la fonction [TSL](../WDLang1/3029057.md)),

- [une couleur prédéfinie du WLangage](../WDLang5/3010002.md).




**`<Opacité> : (Entier optionnel)`**

Pourcentage d'opacité du tracé de l'itinéraire. 

- 0 : tracé transparent, 

- 100 : aucune opacité. 


Par défaut, ce paramètre vaut 60.
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Ce paramètre n'est pas disponible.

**`<Epaisseur> : (Entier optionnel)`**

Epaisseur (en pixels) du tracé de l'itinéraire. Par défaut, l'épaisseur est de 8 pixels. 
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Ce paramètre n'est pas disponible.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Utilisation de Google maps : l'API "Directions" doit être activée dans votre clé Google Maps. 

- Attention : L'ordre des étapes intermédiaires peut être automatiquement modifié pour afficher un itinéraire optimisé.

- Pour personnaliser l'image des marqueurs de l'itinéraire, il suffit d'ajouter au préalable les marqueurs avec la fonction [&lt;Carte&gt;.AjouteMarqueur](../WDLang3/1000022422.md) sur les mêmes positions de l'itinéraire.

- Pour supprimer un itinéraire sur une carte, utilisez la fonction WLangage [&lt;Carte&gt;.SupprimeItinéraire](../WDLang3/1000022465.md).

- Pour supprimer tous les itinéraires ajoutés sur une carte, utilisez la fonction [&lt;Carte&gt;.SupprimeTout](../WDLang3/1000022472.md).

- **Attention** : La création d'itinéraires entre deux positions éloignées peut provoquer le stockage en mémoire d'un très grand nombre de points pour le dessin de l'itinéraire (en particulier pour les itinéraires cycliste et piéton).  Il est donc conseillé de limiter le nombre d'itinéraires affichés simultanément sur le champ Carte.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Pour gérer des fonctionnalités spécifiques concernant la gestion des itinéraires, utilisez la fonction [&lt;Carte&gt;.ExécuteJS](../WDLang3/1000022384.md). 

- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Le champ Carte utilise le service Bing Map.
	**Attention** : L'utilisation du champ Carte est soumis à des conditions d'utilisation spécifiques. Il est nécessaire d'utiliser une clé Bing (fonction [CarteLicenceBing](../WDLang3/1000022006.md)). Vérifiez la licence Bing avant de déployer vos applications.





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampCarte.gif) ***Exemples unitaires (WEBDEV)*** : **Le champ Carte** <br>Utilisation du champ Carte de WEBDEV.<br>Il permet d'afficher une carte comprenant des marqueurs et également d'afficher un itinéraire.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampCarte.gif) ***Exemples unitaires (WINDEV)*** : **Le champ Carte** <br>Utilisation du champ Carte de WINDEV.<br>Il permet d'afficher une carte comprenant des marqueurs et également d'afficher un itinéraire.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WMSports.gif) ***Exemples multiplateforme (WINDEV Mobile)*** : **WM Sports** <br>Cet exemple est une application de sport vous permettant d'enregistrer vos performances.<br>L'application calcule la distance parcourue, le temps, la vitesse moyenne et le nombre de calories dépensées en fonction du sport pratiqué. <br>Le parcours réalisé est affiché sur un champ carte grâce à des marqueurs et un tracé d'itinéraire. <br>Si vous disposez d'une montre Apple Watch, vous pourrez piloter WM Sports avec votre montre !<br><br>L'exemple dispose aussi d'une partie serveur qui sert à la synchronisation des données des utilisateurs.<br>Ce webservice est disponible dans l'exemple WEBDEV "WW_Sports".

<a name="XComposante"></a>

## Composante :
wd280obj.dll
