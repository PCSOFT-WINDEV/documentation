


## FaxEnvoie (Fonction)

***En anglais : FaxSend***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Envoie un fax selon la connexion ouverte précédemment (fonction [FaxConnecte](../WDLang3/3037005.md)).

**Remarque** : Cette fonction ne peut être utilisée que sous Windows 2000, XP ou version supérieure. Sous Windows Vista (et supérieur), la gestion des fax est disponible uniquement avec Windows Professionnel et Windows Edition Intégrale.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
IDConnect est un entier
IDConnect = FaxConnecte()
...
ResEnvoiFax est un booléen
ResEnvoiFax = FaxEnvoie(IDConnect, "MonFax", "Message.txt", "0102030405")
...
FaxDéconnecte(IDConnect)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = FaxEnvoie(<Identifiant connexion> , <Nom du fax> , <Fichier contenu du fax> , <Numéro du fax> [, <Nom du fichier couverture> [, <Procédure WLangage>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le fax a été envoyé, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur (le plus souvent cette erreur est due à un problème de configuration). Pour plus de détails sur cette erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Identifiant connexion> : (Entier)`**

Identifiant de la connexion obtenu avec la fonction [FaxConnecte](../WDLang3/3037005.md).

**`<Nom du fax> : (Chaîne de caractères)`**

Nom permettant d'identifier le fax envoyé. Il sera alors possible de connaître l'état du fax envoyé grâce à la fonction [FaxEtat](../WDLang3/3037001.md).

**`<Fichier contenu du fax> : (Chaîne de caractères)`**

Nom et chemin d'accès au fichier contenant le texte du fax (un chemin de type UNC peut être utilisé). Tous les types de fichier qui possèdent l'option "Imprimer" dans leur menu contextuel sous l'explorateur peuvent être faxés.

**Attention** : Selon le type du fichier à faxer, il est nécessaire que les drivers et les applications nécessaires à la gestion de ce type de fichier soient installés sur le poste. Par exemple, pour envoyer un fichier PDF, il est nécessaire que le poste possède les drivers nécessaires à la gestion des PDF. 

**`<Numéro du fax> : (Chaîne de caractères)`**

Numéro du fax destinataire. Attention : si un indicatif spécifique est nécessaire, il faut le préciser.

**`<Nom du fichier couverture> : (Chaîne de caractères optionnelle)`**

Nom et chemin d'accès au fichier contenant la couverture du fax. Ce fichier doit être au format des pages de garde (.cov). Il est possible de créer ce fichier avec le gestionnaire de fax de Windows. Pour plus de détails, consultez [Envoyer des fax](../WDLang3/3037002.md).

**`<Procédure WLangage> : (Nom de procédure optionnel)`**

Nom de la procédure WLangage ("callback") appelée à chaque changement d'état du fax envoyé. Cette procédure permet de manipuler le fax.
Cette procédure est de la forme : 

```txt
PROCEDURE <Nom de la procédure>(<Nom du fax>, <Etat du fax>)
```

Les paramètres de cette procédure sont optionnels.
Il n'est pas nécessaire de passer des paramètres à cette procédure. En effet, ces paramètres sont renseignés automatiquement à chaque fax envoyé.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Procédure WLangage
<a name="procedure_wlangage_ELTPARAGRAPHE000076"></a>A chaque changement d'état du fax envoyé, la fonction **FaxEnvoie** appelle automatiquement la procédure &lt;Procédure WLangage&gt;. Cette procédure est une procédure globale ou locale de WINDEV ou de WEBDEV.

Pour créer cette procédure :

1. Créez une procédure globale dans l'éditeur de code : sous le volet "Code", dans le groupe "Procédures", déroulez "Nouveau" et sélectionnez "Nouvelle procédure globale".

2. Complétez la déclaration de la procédure de la manière suivante : 
	
	```txt
	PROCEDURE <Nom de la procédure> (<Nom du fax>, <Etat du fax>)
	```


	- &lt;Nom du fax&gt; est le nom du fax manipulé. Ce nom a été donné avec la fonction **FaxEnvoie**.

	- &lt;Etat du fax&gt; est une des constantes d'état du fax (voir fonction [FaxEtat](../WDLang3/3037001.md)).







**Attention** : Cette procédure ne doit pas contenir d'appel au débogueur (ni point d'arrêt, ni mot-clé STOP, ni expression auto-stop, ...).

<a name="XComposante"></a>

## Composante :
wd280com.dll
