


## zipSupprimeFichier (Fonction)

***En anglais : zipDeleteFile***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Supprime un fichier contenu dans une archive.










<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003082041&name=zipsupprimefichier_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
MonArchive est un zipArchive
// Création de l'archive
ResOuverture = zipOuvre(MonArchive, "C:\Temp\Archive.zip")
SI ResOuverture = 0 ALORS
...
	// Suppression de "Fichier.doc"
	ResSuppression = zipSupprimeFichier(MonArchive, "Fichier.doc")
...
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Supprimer un fichier sélectionné selon son indice

`<Résultat> = zipSupprimeFichier(<Archive> , <Indice du fichier>)`
---

**`<Résultat> : (Entier)`**



- 0 si le fichier a été supprimé, 

- Un code d'erreur (valeur supérieure à 0) dans le cas contraire. Le message correspondant au code d'erreur peut être connu grâce à la fonction [zipMsgErreur](../WDLang3/3082034.md).




**`<Archive> : (Chaîne de caractères ou variable de type zipArchive)`**

Nom de l'archive à manipuler.
Ce nom peut correspondre :

- soit au nom d'une archive défini avec la fonction [zipOuvre](../WDLang3/3082044.md) ou [zipCrée](../WDLang3/3082003.md).

- soit au nom d'une variable de type [zipArchive](../WDLang3/1000018679.md). 
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les variables de type [zipArchive](../WDLang3/1000018679.md) ne sont pas disponibles en JAVA.




**`<Indice du fichier> : (Entier)`**

Indice du fichier à supprimer de l'archive. Cet indice peut être connu grâce à la fonction [zipChercheFichier](../WDLang3/3082002.md). 


<a name="SYNTAXE2"></a>

### Supprimer un fichier sélectionné selon son chemin

`<Résultat> = zipSupprimeFichier(<Archive> , <Chemin du fichier>)`
---

**`<Résultat> : (Entier)`**



- 0 si le fichier a été supprimé, 

- Un code d'erreur (valeur supérieure à 0) dans le cas contraire. Le message correspondant au code d'erreur peut être connu grâce à la fonction [zipMsgErreur](../WDLang3/3082034.md).




**`<Archive> : (Chaîne de caractères ou variable de type zipArchive)`**

Nom de l'archive à manipuler.
Ce nom peut correspondre :

- soit au nom d'une archive défini avec la fonction [zipOuvre](../WDLang3/3082044.md) ou [zipCrée](../WDLang3/3082003.md).

- soit au nom d'une variable de type [zipArchive](../WDLang3/1000018679.md). 
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les variables de type [zipArchive](../WDLang3/1000018679.md) ne sont pas disponibles en JAVA.




**`<Chemin du fichier> : (Chaîne de caractères)`**

Chemin mémorisé du fichier à supprimer de l'archive.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000217"></a>La suppression de fichiers dans une archive ne peut être réalisée que si :

- L'archive existe (la création d'une archive s'effectue avec la fonction [zipCrée](../WDLang3/3082003.md)).

- L'archive est accessible en lecture et en écriture.

- L'archive est mono-partie.




**Attention** : 

- **Archives au format RAR** : Cette fonction n'est pas disponible. 

- **Archives au format CAB** : Cette fonction n'est pas disponible. 

- **Archives au format TAR ou TGZ (TAR.GZ)** : Cette fonction n'est pas disponible.   

- **Archives au format 7z** : L'archive est entièrement compressée à chaque appel de la fonction **zipSupprimeFichier**. Cette fonction est conseillée lors de la suppression d'un seul fichier. Si plusieurs fichiers doivent être supprimés dans l'archive, utilisez la fonction [zipSupprimeListeFichier](../WDLang3/3082049.md). 




Rappel : 

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Seules les archives au format ZIP, TAR et TGZ (TAR.GZ) sont disponibles.

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seules les archives au format ZIP sont disponibles.



<a name="NOTE0_2"></a>


### Codes d'erreur
<a name="codes_erreur_ELTPARAGRAPHE000255"></a>Les codes d'erreur retournés sont les suivants :

- 2 : Accès interdit : l'utilisateur n'a pas les droits nécessaires.

- 3 : L'archive est corrompue.

- 4 : Le chemin n'existe pas dans l'archive.

- 5 : Impossible d'écrire dans l'archive.



<a name="NOTE0_3"></a>


### Indice des fichiers dans l'archive
<a name="indice_des_fichiers_dans_archive_ELTPARAGRAPHE000269"></a>Lors de l'ajout d'un fichier dans une archive, un indice est automatiquement attribué au fichier. Cet indice correspond à l'ordre d'intégration des fichiers dans l'archive.

Pour sélectionner un fichier de l'archive, il est possible d'utiliser :

- Soit l'indice de l'élément (l'indice d'un élément peut être connu grâce à la fonction [zipChercheFichier](../WDLang3/3082002.md)).

- Soit le chemin mémorisé de l'élément.




**Important** : Après une suppression de fichiers, les fichiers présents dans une archive sont ré-indicés. Les indices des fichiers suivant le fichier supprimé sont automatiquement décrémentés de 1.
<a name="NOTE0_4"></a>


### Chemin mémorisé
<a name="chemin_memorise_ELTPARAGRAPHE000288"></a>Le tableau ci-dessous présente les chemins mémorisés dans l'archive en fonction :

- du chemin d'accès du fichier,

- de la portion du chemin à mémoriser.




Le répertoire en cours est : "C:\\Temp".


|   |   |   |   |   |
| --- | --- | --- | --- | --- |
| **Fonction zipAjouteFichier** | **Localisation du fichier** | *zipAucun* | *zipRépertoire* | *zipDisque* |
| zipAjouteFichier("Archi",<br>"Fichier.txt") | C:\\Temp\\Fichier.txt | Fichier.txt | Fichier.txt | Fichier.txt |
| zipAjouteFichier("Archi",<br>"Donnée\\Fichier.txt") | C:\\Temp\\Donnée\\Fichier.txt | Fichier.txt | Donnée\\Fichier.txt | Donnée\\Fichier.txt |
| zipAjouteFichier("Archi",<br>"D:\\Donnée\\Fichier.txt") | D:\\Donnée\\Fichier.txt | Fichier.txt | Donnée\\Fichier.txt | D:\\Donnée\\Fichier.txt |


**Remarque** : Si la constante *zipDisque* est utilisée, le format WDZ mémorise le chemin complet du fichier (lettre du lecteur comprise) alors que le format ZIP ne mémorise pas la lettre du lecteur.

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La constante *zipDisque*est équivalente à la constante *zipRépertoire*.

![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Le répertoire et le disque ne sont pas mémorisés dans le chemin de l'archive. Seuls le nom du fichier et son extension sont mémorisés. 

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280zip.dll
