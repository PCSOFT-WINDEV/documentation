


## CarteAffichePosition (Fonction)

***En anglais : MapDisplayPosition***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Centre la carte affichée dans un champ Carte sur une position géographique ou un lieu donné. Une animation est automatiquement réalisée.

A la fin de l'animation, l'événement "A chaque changement de position" du champ Carte sera exécuté. Si le positionnement sur la carte est annulé par l'utilisateur avant la fin de l'animation, cet événement ne sera pas exécuté.




<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000022007&name=carteafficheposition_fonction&product=WD">Voir des exemples supplémentaires</a>
<a name="Exemple1"></a>

```wl
// Centre la carte affichée par le champ "CARTE_Position" sur une position géographique 
MaPosition est une géoPosition
CarteAffichePosition(CARTE_Position, MaPosition)

// Syntaxe équivalente (sans animation) : CARTE_Position = MaPosition
```


<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 
```wl
// Centre la carte affichée par le champ "CARTE_Position" sur une ville à partir de son nom
CarteAffichePosition(CARTE_Position, "Montpellier, France")

// Centre la carte affichée par le champ "CARTE_Position" sur un monument à partir de son nom 
CarteAffichePosition(CARTE_Position, "Tour Eiffel")
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 
### Afficher une position géographique

`<Résultat> = CarteAffichePosition(<Champ Carte> , <Position>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la carte a pu être positionnée sur la position spécifiée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).


![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) &lt;Résultat&gt; est toujours à <u><u><u><u>Vrai</u></u></u></u>, même en cas d'erreur. Il n'est pas possible de savoir si le positionnement a bien été effectué. 

**`<Champ Carte> : (Nom de champ)`**

Nom du champ Carte à manipuler. Si ce paramètre correspond à une chaîne vide (""), le champ Carte auquel appartient l'événement en cours sera utilisé.

**`<Position> : (Variable de type géoPosition ou chaîne de caractères)`**

Description du lieu sur lequel sera centrée la carte. Cette description peut correspondre : 

- au nom de la variable de type [géoPosition](../WDLang3/1000019191.md) décrivant la position géographique sur laquelle sera centrée la carte.

- à une chaîne de caractères contenant une adresse, une ville, le nom d'un monument, ...
	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) L'usage d'une chaîne de caractères peut entraîner une position incohérente via le service de cartographie de Bing Map. 

- à une variable de type [Adresse](../WDLang3/1000019944.md). 





<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 
### Afficher une position géographique avec procédure de vérification

`CarteAffichePosition(<Champ Carte> , <Position> [, <Procédure WLangage>])`
---

**`<Champ Carte> : (Nom de champ)`**

Nom du champ Carte à manipuler. Si ce paramètre correspond à une chaîne vide (""), le champ Carte auquel appartient l'événement en cours sera utilisé.

**`<Position> : (Variable de type géoPosition ou chaîne de caractères)`**

Description du lieu sur lequel sera centrée la carte. Cette description peut correspondre : 

- au nom de la variable de type [géoPosition](../WDLang3/1000019191.md) décrivant la position géographique sur laquelle sera centrée la carte.

- à une chaîne de caractères contenant une adresse, une ville, le nom d'un monument, ...
	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) L'usage d'une chaîne de caractères peut entraîner une position incohérente via le service de cartographie de Bing Map. 

- à une variable de type [Adresse](../WDLang3/1000019944.md).




**`<Procédure WLangage> : (Nom de procédure optionnel)`**

Nom de la procédure WLangage (également nommée "callback") appelée après l'affichage de la nouvelle position géographique. Cette procédure est de la forme : 

```txt
PROCEDURE <Nom de la procédure> (<Changement effectué>)
```

où &lt;Changement effectué&gt; est un booléen : 

- <u><u><u><u>Vrai</u></u></u></u> si la position a pu être modifiée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. 






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) La fonction **CarteAffichePosition** utilise le service de géolocalisation de Google (ou Bing Map pour Universal Windows 10 App). Les positions déterminées à partir de la description d'un lieu dépendent de la quantité et de la précision des informations fournies dans cette description. Si une même description correspond à plusieurs lieux, le service de géolocalisation retournera les correspondances qui lui semble les meilleures.

- Le niveau de zoom de la carte n'est pas modifié lors du changement de position.

- **Pour centrer la carte sur une position donnée sans effectuer d'animation**, il est possible d'affecter directement une variable de type [géoPosition](../WDLang3/1000019191.md) à la propriété [Valeur](../Proprietes/2510130.md) d'un champ Carte.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) **Pour connaître la position actuellement affichée au centre du champ Carte**, utilisez la fonction [CarteRécupèrePosition](../WDLang3/1000019790.md). 

- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Le champ Carte utilise le service Bing Map.
	 **Attention** : L'utilisation du champ Carte est soumise à des conditions d'utilisations spécifiques. Il est nécessaire d'utiliser une clé Bing (fonction [CarteLicenceBing](../WDLang3/1000022006.md)). Vérifiez la licence Bing avant de déployer vos applications.





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampCarte.gif) ***Exemples unitaires (WEBDEV)*** : **Le champ Carte** <br>Utilisation du champ Carte de WEBDEV.<br>Il permet d'afficher une carte comprenant des marqueurs et également d'afficher un itinéraire.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampCarte.gif) ***Exemples unitaires (WINDEV)*** : **Le champ Carte** <br>Utilisation du champ Carte de WINDEV.<br>Il permet d'afficher une carte comprenant des marqueurs et également d'afficher un itinéraire.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
