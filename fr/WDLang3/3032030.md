


## EmailTailleMessage (Fonction)

***En anglais : EmailMessageLength***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Calcule la taille du message spécifié (sans charger le message). La taille correspond à l'encombrement de l'email dans la boîte aux lettres (taille du message et des fichiers attachés).

**Cette fonction est utilisable avec les protocoles POP3 et IMAP uniquement.**

**Rappel** : Avant de manipuler un email (lecture d'un email par exemple), il est nécessaire d'ouvrir une session avec la fonction [EmailOuvreSession](../WDLang3/3032028.md).






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Lecture des emails dont la taille ne dépasse pas nTailleMax 
I est un entier
POUR I = 1 A EmailNbMessage(NomUser)
	SI EmailTailleMessage(NomUser, I) < nTailleMax ALORS
		// Lecture et traitement du message
		LireMessage()
	SINON
		Info("L'email dépasse la taille prévue et ne peut pas être lu")
	FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = EmailTailleMessage(<Session> [, <Numéro message>])`
---

**`<Résultat> : (Entier)`**

Taille totale (en octets) de l'email (message et fichiers attachés).

**`<Session> : (Chaîne de caractères ou variable de type emailSessionPOP3 ou emailSessionIMAP)`**

Identifie la session d'un utilisateur. Correspond à :

- une chaîne de caractères utilisée comme nom d'utilisateur pour ouvrir la session email (fonction [EmailOuvreSession](../WDLang3/3032028.md)).

- une variable de type [emailSessionPOP3](../WDLang3/1000018759.md).

- une variable de type [emailSessionIMAP](../WDLang3/1000018957.md).




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les variables de type [emailSessionPOP3](../WDLang3/1000018759.md) et [emailSessionIMAP](../WDLang3/1000018957.md) ne sont pas disponibles.

**`<Numéro message> : (Entier optionnel)`**

Identifie le message dont la taille doit être calculée. Si ce paramètre n'est pas précisé, &lt;Résultat&gt; renvoie la taille de l'email en cours.  



<a name="XComposante"></a>

## Composante :
wd280com.dll
