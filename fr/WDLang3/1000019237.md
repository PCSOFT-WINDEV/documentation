


## SOAPRécupèreEntête (Fonction)

***En anglais : SOAPGetHeader***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère un entête dans le message SOAP reçu suite à l'appel d'un Webservice.






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Appel de la fonction d'envoi de SMS du Webservice (fictif) WSSMS 
WebServiceEnvoiSMS("0601020304", "ALERTE", ...
	"Attention : le serveur de base de données ne répond plus.")

// Récupération du nombre de crédits restants
// Ce nombre est retourné par le Webservice WSSMS dans les entêtes des requêtes SOAP
CréditRestant est un entier 
CréditRestant = SOAPRécupèreEntête(WSSMS, "NombreCredit")
SI CréditRestant < 50 ALORS
	SignalerFinCredit()
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = SOAPRécupèreEntête(<Webservice> , <Entête>)`
---

**`<Résultat> : (Variable de type dépendant de l'entête)`**

Valeur de l'entête récupéré. Si l'entête demandé n'existe pas, la variable [ErreurDétectée](../WDLang1/3087001.md) est mise à <u><u><u><u>Vrai</u></u></u></u>.

Le type de la valeur renvoyée dépend de l'entête demandé. Ce type est précisé dans la documentation du Webservice.

**`<Webservice> : (Chaîne de caractères)`**

Nom du Webservice à manipuler.

**`<Entête> : (Chaîne de caractères)`**

Nom de l'entête à récupérer. 




## Remarques
La fonction **SOAPRécupèreEntête** doit être appelée : 

- après l'exécution d'une fonction du Webservice,

- avant tout autre appel à une fonction du Webservice ou aux fonctions [SOAPExécute](../WDLang3/3069013.md) ou [SOAPExécuteXML](../WDLang3/3069014.md).




Il est possible d'appeler plusieurs fois la fonction **SOAPRécupèreEntête** afin de récupérer plusieurs entêtes.

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280xml.dll
