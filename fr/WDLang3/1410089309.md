
## Procédure WLangage appelée par la fonction SCPEnvoieFichier



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Procédure WLangage (également nommée "callback") appelée par la fonction [SCPEnvoieFichier](../WDLang3/1410089102.md) lors de l'envoi du fichier via le protocole SCP sur un poste distant. Cette procédure permet de connaître la progression du transfert du fichier sur le poste distant.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Création de la session SSH
sessionSSH est une sshSession
sessionSSH.Adresse = "monserveur.com"
sessionSSH.Port = 22
sessionSSH.Utilisateur = "username"
sessionSSH.MotDePasseUtilisateur = "password"
sessionSSH.TimeoutConnexion = 2s

sNomFichier est une chaîne = "compta_janvier.docx"
// Chemin du fichier sur le poste local
sCheminFichierLocal est une chaîne = fRepExe() + [fSep()] + sNomFichier
// Chemin du fichier sur le poste distant (ici sous Linux)
sCheminFichierDistant est une chaîne = "~/compta/" + sNomFichier

// Envoi du fichier via SCP
SI PAS SCPEnvoieFichier(sessionSSH, sCheminFichierLocal, ...
			sCheminFichierDistant, Progression) ALORS
	Erreur(ErreurInfo(errComplet))
SINON
	Info("Envoie terminé")
FIN


// Suivi de la progression (procédure optionnelle)
PROCÉDURE INTERNE Progression(nTailleTotale, nTailleEnCours)
	Trace(nTailleEnCours + "/" + nTailleTotale)
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`SCPEnvoieFichier_Callback(<Taille totale> , <Taille envoyée>)`
---

**`<Taille totale> : (Entier)`**

Taille totale (en octets) du fichier à envoyer. 

**`<Taille envoyée> : (Entier)`**

Taille (en octets) du fichier déjà envoyée.







<a name="XComposante"></a>



