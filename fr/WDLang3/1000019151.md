


## &lt;Variable zipArchive&gt;.Regroupe (Fonction)

***En anglais : &lt;zipArchive variable&gt;.Merge***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Regroupe les différentes sous-archives d'une archive multi-parties pour en faire une archive mono-partie.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
MonArchive est un zipArchive
// Ouverture d'une archive multi-parties
ResOuvreArchive = MonArchive.Ouvre("C:\MesArchives\Archive.zip") 
SI ResOuvreArchive = 0 ALORS
	...
	// Regroupement des sous-archives d'une archive multi-parties
	ResRegroupe = MonArchive.Regroupe(...
			 "C:\MesArchives\ArchiveMono.WDZ")
	...
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Archive>.Regroupe(<Destination de l'archive> [, <Gestion de la jauge>])`
---

**`<Résultat> : (Entier)`**



- 0 si les sous-archives ont été regroupées, 

- un code d'erreur (valeur supérieure à 0) dans le cas contraire. Pour plus de détails sur ces codes d'erreur, consultez les Remarques.




**`<Archive> : (Variable de type zipArchive)`**

Nom d'une variable de type [zipArchive](../WDLang3/1000018679.md) correspondant à l'archive à manipuler.

**`<Destination de l'archive> : (Chaîne de caractères)`**

Chemin physique de la nouvelle archive mono-partie (260 caractères maximum). Ce chemin doit contenir le nom de l'archive mono-partie à créer. Si l'extension (.WDZ ou .ZIP) n'est pas précisée, l'extension correspond à l'extension originale. Il est possible de spécifier le même chemin et nom que l'archive découpée : l'archive découpée sera écrasée par l'archive regroupée.

**`<Gestion de la jauge> : (Chaîne de caractères optionnelle)`**

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Nom d'un champ Jauge présent dans une fenêtre. Cette jauge affichera la progression du regroupement.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000263"></a>**Remarque** : Le regroupement ne peut être réalisé que si :

- L'archive existe (la création d'une archive s'effectue avec la fonction [&lt;Variable zipArchive&gt;.Crée](../WDLang3/1000019160.md)).

- L'archive est multi-parties.

- L'archive n'est pas au format "CAB", au format "RAR" ou au format "TAR" ou TARGZ".




Rappel : 

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Seules les archives au format ZIP, TAR et TGZ (TAR.GZ) sont disponibles.

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seules les archives au format ZIP sont disponibles.



<a name="NOTE0_2"></a>


### Codes d'erreur
<a name="codes_erreur_ELTPARAGRAPHE000291"></a>Les codes d'erreur retournés sont les suivants :

- 1 : Le chemin passé en paramètre n'existe pas.

- 2 : Accès interdit : l'utilisateur n'a pas les droits nécessaires.

- 3 : L'archive est corrompue.

- 6 : Les sous-archives ne sont pas dans l'ordre.




Le message correspondant au code d'erreur peut être connu grâce à la fonction [zipMsgErreur](../WDLang3/3082034.md).
<a name="NOTE0_3"></a>


### Fermeture de l'archive
<a name="fermeture_archive_ELTPARAGRAPHE000311"></a>Après utilisation de la fonction **&lt;Variable zipArchive&gt;.Regroupe** sur une archive, cette archive ne se ferme pas. Il est nécessaire d'utiliser les fonctions :

- [&lt;Variable zipArchive&gt;.Ferme](../WDLang3/1000019086.md) pour fermer l'archive multi-parties.

- [&lt;Variable zipArchive&gt;.Ouvre](../WDLang3/1000019097.md) pour ouvrir la nouvelle archive mono-partie.



<a name="NOTE0_4"></a>


### Nombre de parties
<a name="nombre_parties_ELTPARAGRAPHE000335"></a>La fonction [zipNbPartie](../WDLang3/3082029.md) permet de connaître le nombre de sous-archives d'une archive multi-parties.
<a name="NOTE0_5"></a>


### Actions réalisables sur une archive multi-parties
<a name="actions_realisables_sur_une_archive_multiparties_ELTPARAGRAPHE000348"></a>Certaines fonctions d'archivage sont utilisables uniquement sur des archives mono-partie (ajout et suppression de fichiers, création d'un exécutable auto-extractible, etc.). Pour effectuer ces opérations, il suffit de regrouper les sous-archives (**&lt;Variable zipArchive&gt;.Regroupe**) pour obtenir une archive mono-partie.

A partir d'une archive multi-parties, il est uniquement possible de :

- Regrouper les différentes parties (fonction **&lt;Variable zipArchive&gt;.Regroupe**).

- Obtenir diverses informations sur l'archive et sur les fichiers de l'archive (fonctions [&lt;Variable zipArchive&gt;.ExtraitChemin](../WDLang3/1000019081.md), [&lt;Variable zipArchive&gt;.InfoFichier](../WDLang3/1000019092.md), [&lt;Variable zipArchive&gt;.ListeFichier](../WDLang3/1000019093.md), ...).

- Extraire les fichiers (fonctions [&lt;Variable zipArchive&gt;.ExtraitFichier](../WDLang3/1000019082.md), [&lt;Variable zipArchive&gt;.ExtraitTout](../WDLang3/1000019085.md)).



<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### L'archive multi-parties est présente sur des disquettes
<a name="archive_multiparties_est_presente_sur_des_disquettes_ELTPARAGRAPHE000397"></a>Si les différentes sous-archives sont présentes sur disquettes, la disquette suivante sera automatiquement demandée lors du regroupement par l'intermédiaire d'une boîte de dialogue. Si l'utilisateur annule le regroupement, une erreur sera générée (l'archive multi-parties est introuvable).

<a name="XComposante"></a>

## Composante :
wd280zip.dll
