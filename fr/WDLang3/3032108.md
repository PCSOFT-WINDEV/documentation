
## LDAPRecherche (Fonction)

***En anglais : LDAPFind***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Lance une recherche dans un serveur LDAP. La recherche effectuée est toujours récursive. Il est également possible d'utiliser [LDAPListeFils](../WDLang3/3032105.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Tous les noms commençant par s et w
sCritère1 est une chaîne = "(|(displayname=s*)(displayname=w*))"

// Tous les noms ressemblant à kurd
sCritère2 est une chaîne = "(displayname~=kurd)" 

// Tous ceux qui ont un givenname sauf Mark
sCritère3 est une chaîne = "(&(givenname=*)(!givenname=Mark))" 

sRésultatRecherche = LDAPRecherche("MaSession", FEN_FenPrem.SAI_DNBASE, sCritère1) 
gsListeRecherche += sRésultatRecherche + RC

sRésultatRecherche = LDAPRecherche("MaSession", FEN_FenPrem.SAI_DNBASE, sCritère2) 
gsListeRecherche += sRésultatRecherche + RC

sRésultatRecherche = LDAPRecherche("MaSession", FEN_FenPrem.SAI_DNBASE, sCritère3) 
gsListeRecherche += sRésultatRecherche + RC
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = LDAPRecherche(<Session LDAP> , <DN de l'objet de base> , <Critère de recherche>)`
---

**`<Résultat> : (Chaîne de caractères)`**



- Liste des noms absolus (DN) des objets trouvés. Les différents éléments sont séparés par le caractère "Retour chariot" (RC). 

- Chaîne vide ("") si aucun objet correspondant à la recherche n'a été trouvé. 
	En cas d'erreur, &lt;Résultat&gt; vaut chaîne vide ("") et la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. La fonction [ErreurInfo](../WDLang1/3013008.md) permet d'obtenir plus de détails sur l'erreur.




**`<Session LDAP> : (Chaîne de caractères)`**

Nom de la session LDAP manipulée.

**`<DN de l'objet de base> : (Chaîne de caractères)`**

Nom absolu de l'objet (Distinguished Name) à partir duquel la recherche est effectuée.

**`<Critère de recherche> : (Chaîne de caractères)`**

Filtre LDAP à appliquer sur la recherche. Pour plus de détails, consultez [les remarques](#NOTE0_1).  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Filtre LDAP
<a name="filtre_ldap_ELTPARAGRAPHE000058"></a>Le filtre de recherche utilise la syntaxe des filtres de recherche LDAP standard. Ces filtres peuvent utiliser une des syntaxes suivantes :

- (&lt;Attribut&gt;&lt;Opérateur&gt;&lt;Valeur&gt;)

- (&lt;Opérateur&gt;&lt;Filtre1&gt;&lt;Filtre2&gt;)




Dans ces syntaxes :

- ***&lt;Attribut&gt;*** correspond au nom d'un attribut LDAP.

- ***&lt;Opérateur&gt;*** peut correspondre aux valeurs suivantes :

	- **=** : Égalité

	- **~=** : Approximation

	- **&lt;=** : Inférieur ou égal

	- **&gt;=** : Supérieur ou égal

	- **&** : ET

	- **|** : OU

	- **!** : NON




- ***&lt;Valeur&gt;*** correspond à la valeur recherchée. Le caractère générique "\*" est autorisé.
	Si les caractères spéciaux suivants doivent apparaître dans le filtre de recherche, il est nécessaire de remplacer ces caractères par la séquence d'échappement correspondante :

	- Caractère \* : \\2a

	- Caractère ( : \\28

	- Caractère ) : \\29

	- Caractère \\ : \\5c

	- Caractère NUL :\\00

	- Caractère / : \\2f




- ***&lt;Filtre1&gt;*** correspond à un filtre de la forme (&lt;Attribut&gt;&lt;Opérateur&gt;&lt;Valeur&gt;)

- ***&lt;Filtre2&gt;*** correspond à un filtre de la forme (&lt;Attribut&gt;&lt;Opérateur&gt;&lt;Valeur&gt;)



<a name="NOTE0_2"></a>




### Exemples de filtres
<a name="exemples_filtres_ELTPARAGRAPHE000094"></a>


|   |   |
| --- | --- |
| "(objectClass=\*)" | Filtre tous les objets |
| "(&(objectCategory=person)(objectClass=user)(!cn=andy))" | Filtre tous les utilisateurs sauf "andy" |
| "(sn=sm\*)" | Filtre les objets dont le 'sn' commence par 'sm' |
| "(&(objectCategory=person)(objectClass=contact)(\(sn=Smith)(sn=Johnson)))" | Filtre tous les contacts dont le 'sn' est 'Smith' ou 'Johnson' |









<a name="XComposante"></a>

## Composante :
wd280com.dll
