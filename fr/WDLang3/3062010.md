
## sFerme (Fonction)

***En anglais : sClose***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ferme le port série, le port parallèle ou le port infrarouge spécifié.

**Remarques** : 

- Un port doit être fermé dès qu'il n'est plus utilisé.

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La gestion des ports infrarouges n'est pas disponible.

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Seuls les ports séries sont gérés.  









<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
NumPort est un entier
NumPort = sOuvre("COM1", 2000, 2000) // Ouverture de COM1
SI NumPort <> 0 ALORS
	// Paramétrage de COM1 : Taux 9600, parité paire, 
	// 8 bits de données, 1 bit de stop
	sFixeParamètre(NumPort, 9600, 1, 8, 0)
	// Suite traitement...
	sFerme(NumPort) // Fermeture de COM1
SINON
	Erreur("Erreur d'ouverture de COM1")
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`sFerme(<Numéro de port>)`
---

**`<Numéro de port> : (Entier)`**

Identifiant du port manipulé : 

- Numéro de port : 

	- Numéro du port série : 1, 2, 3, ... 32 pour COM1, COM2, COM3, ... COM32.

	- Numéro de port parallèle : -1, -2, -3 ou -4 pour LPT1, LPT2, LPT3 ou LPT4.

	- Numéro du port infrarouge : 1, 2, 3, ... 32 pour IR1, IR2, IR3, ... IR32.




- Identifiant du port renvoyé par la fonction [sOuvre](../WDLang3/3062013.md) (si cette fonction a été appelée avec un nom de port). 
	![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Seul ce type de paramètre est disponible.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Fermeture du port après une lecture ou une écriture
<a name="fermeture_port_apres_une_lecture_une_ecriture_ELTPARAGRAPHE000095"></a>Si la fonction **sFerme** est exécutée juste après [sEcrit](../WDLang3/3062009.md) ou [sLit](../WDLang3/3062012.md), certains caractères ne pourront pas être écrits ou lus. En effet, la fonction **sFerme** peut fermer le port avant que tous les caractères ne soient écrits ou lus. Il faut alors insérer une temporisation avec la fonction [Multitâche](../WDLang1/3015004.md).


```wl
Res = sOuvre("COM2", 2000, 2000)
SI Res <> 0 ALORS
	sFixeParamètre(Res, 9600, 0, 8, 0)
	sEcrit(Res, Ch)
	Multitâche()
	sFerme(Res)
FIN
```



![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Utilisation d'une librairie externe : RXTX
<a name="utilisation_une_librairie_externe_rxtx_ELTPARAGRAPHE000259"></a>En Java, l'utilisation des fonctions de manipulation des ports séries et parallèles (fonctions [sOuvre](../WDLang3/3062013.md), [sEcrit](../WDLang3/3062009.md), [sLit](../WDLang3/3062012.md), ...) nécessite la présence d'une librairie externe : RXTX. 

Cette librairie est composée d'une archive Jar et d'une ou plusieurs librairies natives dépendantes du système d'exploitation sur lequel s'exécute l'application.
 
Pour utiliser ces fonctions : 

- l'archive jar (RXTXComm.jar) doit : 

	- soit se trouver dans le même répertoire que l'application Java générée par WINDEV, 

	- soit se trouver dans le classpath d'exécution de l'application, 

	- soit être directement intégrée dans l'application générée (depuis l'assistant de génération Java). 




- la ou ou les librairies natives correspondant au système d'exploitation sur lequel s'exécute l'application doivent se trouver: 

	- soit  dans le même répertoire que l'application Java générée par WINDEV, 

	- soit dans le chemin des librairies de l'application (librarypath).







Il est possible de télécharger la librairie RXTX et sa documentation grâce au lien suivant : [http://users.frii.com/jarvi/rxtx/index.html](http://users.frii.com/jarvi/rxtx/index.html) (lien valide lors de l'écriture de cette documentation). 

**Attention** : La gestion des ports infrarouges n'est pas disponible en Java. 
<a name="NOTE0_3"></a>



<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280com.dll
