
## LDAPValideAjout (Fonction)

***En anglais : LDAPValidateAdd***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Valide l'ajout d'un nouvel objet dans un serveur LDAP.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ajout d'un utilisateur Test dans un "Active Directory"
LDAPDébutAjout("MaSessionLDAP")
LDAPAjouteAttribut("MaSessionLDAP", "objectClass", "top")
LDAPAjouteAttribut("MaSessionLDAP", "objectClass", "person")
LDAPAjouteAttribut("MaSessionLDAP", "objectClass", "organizationalPerson")
LDAPAjouteAttribut("MaSessionLDAP", "objectClass", "user")
LDAPAjouteAttribut("MaSessionLDAP", "objectCategory", ...
	"CN=Person, CN=Schema, CN=Configuration, DC=societe, DC=fr")
LDAPAjouteAttribut("MaSessionLDAP", "instanceType", "4")
LDAPAjouteAttribut("MaSessionLDAP", "cn", "Test")
LDAPAjouteAttribut("MaSessionLDAP", "sAMAccountName", "Test")
LDAPValideAjout("MaSessionLDAP", "cn=Test, cn=Users, dc=societe, dc=fr")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = LDAPValideAjout(<Session LDAP> , <DN de l'objet>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'ajout a été effectué, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [ErreurInfo](../WDLang1/3013008.md) permet d'obtenir plus de détails sur l'erreur.




**`<Session LDAP> : (Chaîne de caractères)`**

Nom de la session LDAP manipulée.

**`<DN de l'objet> : (Chaîne de caractères)`**

Nom absolu de l'objet (Distinguished Name) à ajouter.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Ajout d'un nouvel objet dans un serveur LDAP
<a name="ajout_nouvel_objet_dans_serveur_ldap_ELTPARAGRAPHE000047"></a>Pour ajouter un nouvel objet dans un serveur LDAP, il est nécessaire de définir les différents attributs qui composent cet objet et leur valeur.

Pour optimiser la vitesse de création des objets, les attributs et leurs valeurs sont définis localement : une seule communication avec le serveur est établie lors de la validation de l'ajout. Les étapes sont les suivantes :

1. Initialisation de l'ajout (fonction [LDAPDébutAjout](../WDLang3/3032109.md))

2. Ajout des attributs et de leurs valeurs (fonction [LDAPAjouteAttribut](../WDLang3/3032110.md)). Cet ajout peut être réalisé autant de fois que nécessaire.

3. Association des attributs et de leurs valeurs à un objet grâce à la fonction **LDAPValideAjout**.




**Attention** : Les opérations de modification étant réalisées localement avant d'être effectuées sur le serveur, il est nécessaire de respecter l'ordre logique des modifications (par exemple, il ne sera pas possible de modifier un attribut supprimé par la ligne de code précédente).  



<a name="XComposante"></a>

## Composante :
wd280com.dll
