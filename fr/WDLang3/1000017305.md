


## EmailVérifieAdresse (Fonction)

***En anglais : EmailCheckAddress***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Vérifie la validité d'une adresse email.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
SI EmailVérifieAdresse("Moulain@test.fr", emailValideSyntaxe) <> emailAdresseValide ALORS
	Erreur("Veuillez vérifier l'adresse email fournie") 
FIN
```
<a name="Exemple2"></a>

```wl
SELON EmailVérifieAdresse("azerty@orange.com")
	CAS emailAdresseValide
		Info("Adresse valide")
	CAS emailAdresseSyntaxeIncorrecte
		Info("L'adresse est syntaxiquement fausse.")
	CAS emailAdresseRefusée
		Info("L'adresse a été refusée par le serveur de mails." + ...
			"ErreurInfo permet d'obtenir la cause du refus.")
	CAS emailAdresseErreur
		Info("Une erreur s'est produite pendant la vérification. " + ...
			"ErreurInfo permet d'obtenir le détail de l'erreur.")	
	AUTRE CAS
		Info("Cas indéterminé") 
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = EmailVérifieAdresse(<Adresse> [, <Niveau de validation>])`
---

**`<Résultat> : (Constante de type Entier)`**

Constante permettant de savoir si l'adresse passée en paramètre est valide :


|   |   |
| --- | --- |
| *emailAdresseErreur* | Une erreur s'est produite pendant la vérification. La fonction [ErreurInfo](../WDLang1/3013008.md) permet d'obtenir le détail de l'erreur. |
| *emailAdresseRefusée* | L'adresse a été refusée par le serveur de mails. La fonction [ErreurInfo](../WDLang1/3013008.md) permet d'obtenir la cause du refus. |
| *emailAdresseSyntaxeIncorrecte* | L'adresse est syntaxiquement fausse. |
| *emailAdresseValide* | L'adresse est valide. Il sera possible d'utiliser la fonction [EmailEnvoieMessage](../WDLang3/3032005.md) avec cette adresse. |

Remarque : Un temps d'attente peut être nécessaire selon le temps de réponse du serveur contacté.

**`<Adresse> : (Chaîne de caractères)`**

Adresse email à vérifier.

**`<Niveau de validation> : (Constante de type entier optionnelle)`**

Type de validation souhaité. Il est possible d'utiliser une des constantes suivantes :


|   |   |
| --- | --- |
| *emailValideParServeur* | Vérifie que le serveur d'emails SMTP du domaine auquel appartient l'adresse accepte l'adresse en entrée. La vérification de la syntaxe de l'adresse email est automatiquement effectuée (constante *emailValideSyntaxe*).<br> |
| *emailValideSyntaxe*<br>(Valeur par défaut) | Vérifie la syntaxe de l'adresse email. Le TLD (Top Level Domain) n'est pas vérifié. |
| *emailValideSyntaxeStrict* | Vérifie la syntaxe de l'adresse email ainsi que le TLD (Top Level Domain) par rapport à la liste des TLD existants (voir Remarques).<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Adresse email à vérifier
<a name="adresse_email_verifier_ELTPARAGRAPHE000110"></a>

- Les adresses email de la forme "@[nom de domaine].tld" bien que valides syntaxiquement au regard de la norme RFC822 ne sont pas acceptées par la fonction **EmailVérifieAdresse**.

- Si le &lt;Niveau de validation&gt; correspond à la constante *emailValideSyntaxe*, l'adresse email peut contenir un TLD vide (par exemple "toto@domaine.").

- Si le &lt;Niveau de validation&gt; correspond à la constante *emailValideParServeur* ou *emailValideSyntaxeStrict*, l'adresse email ne peut pas contenir de TLD vide (par exemple "toto@domaine."). Dans ce cas, &lt;Résultat&gt; vaut *emailAdresseSyntaxeIncorrecte*.



<a name="NOTE0_2"></a>


### Validation par serveur : Conditions nécessaires
<a name="validation_par_serveur_conditions_necessaires_ELTPARAGRAPHE000128"></a>Pour utiliser la validation par serveur (constante *emailValideParServeur*), l'application doit pouvoir contacter :

- un serveur DNS (par UDP sur le port 53),

- le serveur d'emails du domaine auquel appartient l'adresse à valider (par TCP, port 25).




Il peut donc être nécessaire de paramétrer le ou les pare-feu d'une manière spécifique.  

**Attention** : Il est possible dans certains cas qu'un serveur d'emails accepte une adresse inexistante (par exemple, lorsque le serveur est un serveur de relais qui n'a pas accès à la liste des comptes du domaine pour lequel il collecte les mails). Dans ce cas, &lt;Résultat&gt; correspondra à la constante *emailAdresseValide* même si l'adresse est inexistante. De plus, le temps d'attente pourra être relativement long avant de récupérer la réponse du serveur.

**Remarque** : Le serveur d'emails SMTP interrogé est retrouvé par l'enregistrement MX (Mail Exchanger) du domaine de l'adresse email.
<a name="NOTE0_3"></a>


### Liste des TLD utilisés lors d'une validation syntaxique stricte
<a name="liste_des_tld_utilises_lors_une_validation_syntaxique_stricte_ELTPARAGRAPHE000144"></a>Lors d'une vérification syntaxique stricte (constante *emailValideSyntaxeStrict*), une liste de TLD internationaux et de TLD de pays est utilisée. 

La liste des TLD a été mise à jour avec la liste officielle IANA (Internet Assigned Numbers Authority) de mai 2021. 
Remarque : Depuis cette mise à jour, les TLD disponibles ont pu évoluer.


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDMail.gif) ***Exemples complets (WINDEV)*** : **WD Mail** <br>Cette application est un client mail complet développé en WINDEV. Il s'appuie sur les objets Email.<br>Ce client mail permet de récupérer et d'envoyer des emails en utilisant les protocoles POP, IMAP et SMTP.<br>Il est possible d'appliquer des filtres sur le courrier entrant.<br>L'écriture d'un email s'appuie sur le champ Editeur HTML.<br>L'affichage des emails utilise le champ Affichage HTML.<br>L'application permet de gérer plusieurs comptes emails différents.

<a name="XComposante"></a>

## Composante :
wd280com.dll
