


## EmailMiseAJour (Fonction)

***En anglais : EmailUpdate***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Met à jour les messages de MS Exchange par rapport au serveur d'emails. Les opérations suivantes sont réalisées :

- Les messages présents dans la boîte d'envoi de MS Exchange sont envoyés vers le serveur d'email Internet.

- Les messages en attente sur le serveur Internet sont transférés dans la boîte de réception du client MS Exchange.




La fonction **EmailMiseAJour** est utilisable uniquement avec le client MS Exchange.

**Rappel** : Pour manipuler des emails, il est nécessaire d'ouvrir une session d'email grâce à la fonction [EmailOuvreSession](../WDLang3/3032028.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003032036&name=emailmiseajour_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
IDEmail est un entier
// Ouverture de la session d'email
IDEmail = EmailOuvreSession("PROFIL_Exemple")
// Récupération des messages dans la boîte de réception de MS Exchange
SI EmailMiseAJour(IDEmail) = Vrai ALORS
	Info("Messages récupérés")
SINON
	Erreur()
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = EmailMiseAJour(<Session>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la mise à jour a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Session> : (Entier ou variable de type emailSessionOutlook)`**

Identifiant de la session email en cours. Cette valeur peut être :

- un entier renvoyé par la fonction [EmailOuvreSession](../WDLang3/3032028.md).  

- une variable de type [emailSessionOutlook](../WDLang3/1000018767.md).






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Erreur lors de la transmission de l'email
<a name="erreur_lors_transmission_email_ELTPARAGRAPHE000098"></a>Si un message n'a pas pu être transmis à cause d'une mauvaise connexion Internet ou d'une adresse incorrecte, le message est retourné au client MS Exchange : le message apparaît donc dans les messages non lus.

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280com.dll.
