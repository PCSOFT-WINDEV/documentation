
## LDAPValeur (Fonction)

***En anglais : LDAPValue***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie la valeur correspondant à l'indice passé en paramètre pour l'attribut spécifié.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Connaître la valeur de l'attribut "UserPassword", indice 2
ValeurAtt = LDAPValeur("MaSession", "CN=JP", "UserPassword", 2)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = LDAPValeur(<Session LDAP> , <DN de l'objet> , <Nom de l'attribut> [, <Indice>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Valeur de l'attribut pour l'indice spécifié.

- Chaîne vide si la valeur est vide ou en cas d'erreur. 




**`<Session LDAP> : (Chaîne de caractères)`**

Nom de la session LDAP manipulée.

**`<DN de l'objet> : (Chaîne de caractères)`**

Nom absolu de l'objet (Distinguished Name) dont la valeur de l'attribut est recherchée.

**`<Nom de l'attribut> : (Chaîne de caractères)`**

Nom de l'attribut pour lequel la valeur est recherchée. Les attributs d'un objet peuvent être connus grâce à la fonction [LDAPListeAttribut](../WDLang3/3032104.md).

**`<Indice> : (Entier optionnel)`**

Indice de la valeur de l'attribut qui doit être connu. Si ce paramètre n'est pas indiqué, la valeur de l'indice 1 de l'attribut spécifié est retournée.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Serveur LDAP et objet LDAP Local
<a name="serveur_ldap_objet_ldap_local_ELTPARAGRAPHE000045"></a>Le serveur LDAP contient des objets LDAP.

L'objet LDAP local est un objet LDAP rapatrié depuis le serveur.


<a name="NOTE0_2"></a>




### Mise à jour de l'objet LDAP local
<a name="mise_jour_objet_ldap_local_ELTPARAGRAPHE000056"></a>Lorsque une fonction LDAP de lecture est exécutée ([LDAPListeAttribut](../WDLang3/3032104.md), [LDAPNbValeur](../WDLang3/3032106.md), **LDAPValeur**), l'objet du serveur est complètement rapatrié localement afin de limiter les communications avec le serveur. Ainsi, si ces fonctions de lecture sont appelées plusieurs fois, avec le même DN, seul le premier appel implique une communication avec le serveur. Les appels suivants liront l'objet local.

La fonction **LDAPValeur** met à jour l'objet LDAP local uniquement si le DN de l'objet passé en paramètre est différent du dernier DN passé en paramètre pour l'une des fonctions suivantes : [LDAPListeAttribut](../WDLang3/3032104.md), [LDAPNbValeur](../WDLang3/3032106.md), **LDAPValeur**.

La fonction **LDAPValeur** ne met pas à jour l'objet LDAP local si le DN passé en paramètre est identique au dernier DN passé en paramètre pour l'une des fonctions suivantes : [LDAPListeAttribut](../WDLang3/3032104.md), [LDAPNbValeur](../WDLang3/3032106.md), **LDAPValeur**. Cependant, si les fonctions [LDAPValideAjout](../WDLang3/3032111.md) et [LDAPValideModification](../WDLang3/3032117.md) ont été utilisées avec ce même DN, l'objet local est automatiquement mis à jour.


<a name="NOTE0_3"></a>




### Caractères accentués
<a name="caracteres_accentues_ELTPARAGRAPHE000108"></a>Si le serveur utilise des caractères en UTF8, il peut être nécessaire de convertir la valeur de l'attribut afin d'obtenir le résultat voulu. Par exemple :

```wl
ValeurAtt = UTF8VersChaîne(LDAPValeur("MaSession", "CN=JP", "UserPassword", 2), alphabetAnsi)
```









- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LesfonctionsLDAP.gif) ***Exemples unitaires (WINDEV)*** : **Les fonctions LDAP** <br>Utilisation des fonctions LDAP du WLangage.<br>Ces fonctions permettent d'interagir totalement avec les données LDAP, de visualiser le contenu de tout annuaire LDAP et également de modifier les données LDAP : LDAPConnecte, LDAPListeFils, LDAPAjouteAttribut, LDAPSupprimeValeurAttribut,...



<a name="XComposante"></a>

## Composante :
wd280com.dll
