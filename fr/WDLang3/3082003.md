


## zipCrée (Fonction)

***En anglais : zipCreate***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Crée une archive. L'archive créée est automatiquement :

- ouverte en lecture et écriture. Si l'archive est au format CAB, l'archive créée est ouverte en écriture seulement.

- de type mono-partie.




L'archive créée peut être : 

- au format standard WinZip ou PKZip (extension .ZIP).

- au format "Cabinet files" (extension .CAB).

- au format WINDEV (extension .WDZ).

- au format 7z (extension .7z). 

- au format TAR (extension .TAR).

- au format TGZ (TAR.GZ) (extension .TGZ ou .TAR.GZ).


Il n'est pas possible de créer une archive au format "RAR".

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003082003&name=zipcree_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
MonArchive est un zipArchive
ResCréation est un entier
ResAjoutFichier est un entier
// Création de l'archive 
ResCréation = zipCrée(MonArchive, "C:\Temp\Archive.zip")
SI ResCréation = 0 ALORS
	// Ajout d'un fichier dans une archive
	ResAjoutFichier = zipAjouteFichier(MonArchive, ...
			"C:\MonRépertoire\MesFichiers\Fichier.pdf", zipDisque)
FIN
// Affichage du message d'erreur si le fichier n'a pas été ajouté
SI ResAjoutFichier <> 0 ALORS 
	Erreur(zipMsgErreur(ResAjoutFichier))
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = zipCrée(<Archive> , <Chemin de l'archive> [, <Options>])`
---

**`<Résultat> : (Entier)`**



- 0 si la création a été effectuée. Dans ce cas, l'archive est ouverte. Pour que cette archive soit manipulable par l'utilisateur avant la fermeture de l'application, pensez à fermer l'archive (fonction [zipFerme](../WDLang3/3082005.md)). 

- Un code d'erreur (valeur supérieure à 0) dans le cas contraire. Pour plus de détails sur ces codes d'erreur, consultez les [Remarques](#NOTE0_2).




**`<Archive> : (Chaîne de caractères ou variable de type zipArchive)`**

Nom de l'archive à manipuler.
Ce nom peut correspondre :

- soit au nom d'une archive défini avec la fonction [zipOuvre](../WDLang3/3082044.md) ou [zipCrée](../WDLang3/3082003.md).

- soit au nom d'une variable de type [zipArchive](../WDLang3/1000018679.md). 
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les variables de type [zipArchive](../WDLang3/1000018679.md) ne sont pas disponibles en JAVA.




**`<Chemin de l'archive> : (Chaîne de caractères)`**

Chemin et nom de l'archive (260 caractères maximum). L'extension de l'archive doit être précisée :

- ".WDZ" pour créer une archive WINDEV.

- ".ZIP" pour créer une archive au format standard WinZip ou PKZip.

- ".CAB" pour créer une archive au format "Cabinet Files".

- ".7z" pour créer une archive au format 7Z. 

- ".TAR" pour créer une archive au format TAR. 

- ".TAR.GZ" pour créer une archive au format TAR.GZ. 

- ".TGZ" pour créer une archive au format TGZ. 


Si aucune extension n'est précisée, une archive au format WDZ est créée. 

Attention : 

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Seules les archives au format ZIP, TAR et TGZ (TAR.GZ) sont disponibles.

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seules les archives au format ZIP sont disponibles.

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Si l'extension .WDZ est donnée, l'archive créée sera au format ZIP, mais avec l'extension .WDZ.

- Si la même archive existe déjà dans le répertoire spécifié, cette archive est détruite et remplacée par la nouvelle archive.




![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Le chemin de l'archive est un chemin complet ou relatif au répertoire de travail de l'application (connu avec la fonction [fRepDonnées](../WDLang1/3036001.md)). 

**`<Options> : (Constante optionnelle)`**

Options de gestion des archives :


|   |   |
| --- | --- |
| *zipAnsi* | Permet de forcer la sauvegarde des noms de fichiers au format Ansi dans le fichier Archive.<br><br>Cette constante est utilisée par défaut dans une application utilisant le mode Ansi.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *zipEntête64* | Permet de créer une archive de plus de 4 gigas sur laquelle la fonction [zipChangeChemin](../WDLang3/3082027.md) pourra être utilisée.<br><br>Par défaut, cette option n'est pas utilisée.<br>**Archive au format TAR ou TGZ (TAR.GZ)** : Cette constante n'est pas disponible. <br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *zipNonCompressé* | Le contenu de l'archive ne sera pas compressé.<br><br>Utilisée avec les archives de type CAB, cette constante permet d'utiliser uniquement la fonction d'archivage du format CAB.<br><br>Par défaut, cette option n'est pas utilisée.<br><br>**Archive au format TAR ou TGZ (TAR.GZ)** : Cette constante n'est pas disponible. |
| *zipUnicode* | Permet de forcer la sauvegarde des noms de fichiers au format Unicode dans le fichier Archive.<br><br>Cette constante est utilisée par défaut dans une application utilisant le mode Unicode.<br><br>**Archive au format TAR ou TGZ (TAR.GZ)** : Si cette constante est utilisée, les noms de fichiers au format Unicode ne sont pas sauvegardés en Unicode dans le fichier Archive. ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |


**Archive au format 7z** : Ce paramètre n'est pas disponible. 
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Ce paramètre n'est pas disponible.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Niveau de compression
<a name="niveau_compression_ELTPARAGRAPHE000259"></a>Par défaut, les fichiers ajoutés dans une archive au format Zip sont compressés. Il est possible de modifier le niveau de compression des fichiers ajoutés dans une archive grâce à la fonction [zipNiveauCompression](../WDLang3/3082054.md).
<a name="NOTE0_2"></a>


### Codes d'erreur
<a name="codes_erreur_ELTPARAGRAPHE000271"></a>Les codes d'erreur retournés sont les suivants :

- 1 : Le chemin passé en paramètre n'existe pas.

- 2 : Accès interdit : l'utilisateur n'a pas les droits nécessaires.




Le message correspondant au code d'erreur peut être connu grâce à la fonction [zipMsgErreur](../WDLang3/3082034.md).
<a name="NOTE0_3"></a>


### Condition d'utilisation
<a name="condition_utilisation_ELTPARAGRAPHE000288"></a>Le nombre maximum de fichiers pouvant être intégrés :

- dans un fichier WDZ : 232-1. 

- dans un fichier ZIP : 65535. 

- dans un fichier CAB : 65535. 


Formats disponibles : 

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Seules les archives au format ZIP, TAR et TGZ (TAR.GZ) sont disponibles.

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seules les archives au format ZIP sont disponibles.


Un fichier intégré dans une archive (quel que soit son format) doit avoir une taille inférieure à 4 Go.

Il n'est pas possible de créer une archive au format "RAR".

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280zip.dll
