
## Socket : Créer un serveur de socket simplifié
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000160"></a>
WINDEV offre la possibilité de créer un serveur de socket simplifié. **Ce serveur permet de communiquer avec un seul poste client simultanément**. Ce type d'application est très utile lorsque deux applications distantes ont besoin de communiquer.

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Remarque** : WINDEV offre également la possibilité de créer un serveur de sockets plus élaboré (serveur de sockets standard), gérant la connexion de plusieurs postes client simultanément. Pour plus de détails, consultez [Serveur de sockets standard](../WDLang3/3070003.md).



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Le serveur simplifié
<a name="serveur_simplifie_ELTTEXTE000184"></a>


### Etape 1 : Création du socket
<a name="etape_1_creation_socket_ELTPARAGRAPHE000026"></a>Pour créer le socket, le poste serveur utilise la fonction [SocketCrée](../WDLang3/3070011.md). Un socket est associé à un port spécifique. Pour simplifier la manipulation du socket par programmation sur le poste serveur, précisez le nom du socket.

Le poste client va venir se connecter sur ce socket pour échanger des données. La connexion entre les deux postes sera effectivement réalisée au premier échange de données entre les deux postes (c'est-à-dire à la première lecture d'informations par le poste serveur).

La connexion est établie au premier succès de la fonction [SocketLit](../WDLang3/3070014.md) sur le serveur.
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Serveur_simple_1.gif)



<a name="NOTE2_2"></a>


### Etape 2 : Échange de données
<a name="etape_2_echange_donnees_ELTPARAGRAPHE000046"></a>Lorsque deux postes utilisent le même socket, un flux de communication s'établit entre ces deux postes. Il est alors possible pour ces deux postes de lire et d'écrire des chaînes de caractères sur le socket.

Remarque : Pour ne pas bloquer les applications, la gestion de la réception des messages est souvent gérée par un thread spécifique (pour plus de détails sur les threads, consultez [Gestion des threads](../WDLang1/3077026.md)).

Pour lire et écrire sur le socket, l'application serveur WINDEV doit utiliser les fonctions [SocketLit](../WDLang3/3070014.md) et [SocketEcrit](../WDLang3/3070002.md).
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Serveur_simple_2.gif)


**Attention** : Pour réaliser une lecture, une écriture doit avoir été réalisée. Par exemple :

1. Le poste client écrit sur le socket : il envoie une requête au poste serveur.

2. Le poste serveur effectue une lecture sur le socket dans un thread. Dès qu'un message est reçu, le message est traité par le poste serveur.

3. Si une réponse au message est nécessaire, le poste serveur identifie le poste client (fonction [SocketClientInfo](../WDLang3/3070009.md)), et lui envoie une réponse.





<a name="NOTE2_3"></a>


### Etape 3 : Fermeture du socket
<a name="etape_3_fermeture_socket_ELTPARAGRAPHE000078"></a>Pour terminer la communication, le serveur peut fermer le socket avec la fonction [SocketFerme](../WDLang3/3070015.md).
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Serveur_simple_3.gif)


Remarque : le socket peut aussi être fermé par le poste client.



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Mode de transmission des informations
<a name="mode_transmission_des_informations_ELTTEXTE000220"></a>
Le mode de transmission du message définit le mode utilisé pour déterminer la longueur du message.

WINDEV propose différentes méthodes pour déterminer la longueur du message lors de la communication entre sockets.

**Méthode 1 : mode WINDEV** : Par défaut, le nombre de caractères du message est indiqué au début du message. Ce mode de transmission est conseillé lors d'une communication par sockets entre deux applications WINDEV.

Le message est de la forme : "11\\r\\nHelloWorld"

**Méthode 2 : mode standard** : La fin du message est signalée par un caractère spécifique, déterminé par avance. Ce mode de transmission est conseillé lors d'une communication par sockets entre une application WINDEV et une autre application. Dans ce cas, il sera nécessaire d'inclure un caractère spécifique dans le message afin d'indiquer que le message est terminé.

Le message est de la forme : "Hello World&lt;EOF&gt;"

**Méthode 3 : mode standard avec buffer :** Correspond au mode standard optimisé pour les protocoles les plus utilisés sur Internet.

La fonction [SocketChangeModeTransmission](../WDLang3/3070005.md) permet de modifier le mode de transmission utilisé.




