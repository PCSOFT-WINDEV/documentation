


## EmailImporteSource (Fonction)

***En anglais : EmailImportSource***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Remplit une variable de type [Email](../WDLang3/1000018713.md) à partir du contenu de sa propriété **Source** ou les différentes variables de la structure [Email](../WDLang3/3032029.md) à partir du contenu de la variable **Email.Source**.
Remarque : Cette fonction peut être utile par exemple pour lire un fichier .eml (généré par Outlook Express).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Lecture du fichier .eml 
Email.Source = fChargeTexte("c:\MesEmails\Test.eml") 
SI EmailImporteSource() = Vrai ALORS
	Info("Fichier test.eml importé")
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = EmailImporteSource([<Email>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la variable de type [Email](../WDLang3/1000018713.md) ou la structure [Email](../WDLang3/3032029.md) a été remplie, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. 
	Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*. 


Le code généré peut être relu dans la variable Email.Source du thread en cours ou dans la propriété **Source** de la variable de type [Email](../WDLang3/1000018713.md) utilisée.

**`<Email> : (Variable de type Email optionnelle)`**

Nom de la variable de type [Email](../WDLang3/1000018713.md) correspondant à l'email à initialiser. Si ce paramètre n'est pas précisé, la structure [Email](../WDLang3/3032029.md) sera manipulée. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Pour générer le code source de l'email à envoyer à partir la structure email (à partir du contenu de la variable Email.Source) ou de la propriété **Source** de la variable de type [Email](../WDLang3/1000018713.md), utilisez la fonction [EmailConstruitSource](../WDLang3/1000017225.md).

- Les fichiers au format MSG (générés par MS Outlook) ne sont pas automatiquement importés.

- Le source de l'email doit utiliser le séparateur RC pour marquer les fins de lignes, y compris sous Linux.

- Par défaut, lorsque la configuration du projet utilise des chaînes ANSI en exécution, quelque soit le "charset" indiqué dans la partie HTML de l'email, une conversion des caractères est faite en "latin1". Cette conversion n'est pas faite lorsque la configuration des chaînes en exécution est en UNICODE. Pour ne pas faire la conversion en ANSI et conserver l'encodage correspondant au "charset" mentionné dans la partie HTML de l'email, il faut utiliser la fonction [EmailParamètre](../WDLang3/1000022269.md) avec la constante *emailParamètreHTML* : 
	
	```wl
	EmailParamètre(emailParamètreHTML, Vrai)
	```





<a name="XComposante"></a>

## Composante :
wd280com.dll
