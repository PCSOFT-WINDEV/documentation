


## EmailOuvreSessionNotes (Fonction)

***En anglais : EmailStartNotesSession***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet d'accéder aux différentes données manipulées par le logiciel de messagerie Lotus Notes (emails, contacts, groupes de contacts, tâches, rendez-vous).

Cette fonction peut être :

- soit appelée directement pour ouvrir la connexion avec le serveur Domino et indiquer la base Lotus Notes à utiliser.

- soit appelée à la suite de la fonction [NotesOuvreConnexion](../WDLang3/1000005102.md). Dans ce cas, cette fonction est utilisée uniquement pour spécifier la base Lotus Notes à utiliser.



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ouverture de la connexion
// et spécification de la base Lotus Notes à utiliser 
SI EmailOuvreSessionNotes("MotDePasse", "ServeurMars", ...
		"mail/julie.nsf", "C:\Lotus Notes\julie.id") <> 0 ALORS
	Info("Session ouverte et base spécifiée")
SINON
	Erreur()
FIN
```
<a name="Exemple2"></a>

```wl
// Ouverture de la connexion
IDSession est un entier 
IDSession = NotesOuvreConnexion("MotDePasse", "ServeurMars", ...
		"C:\Lotus Notes\julie.id")
// Spécification de la base Lotus Notes à utiliser
SI EmailOuvreSessionNotes(IDSession, "mail/julie.nsf") <> 0 ALORS
	Info("Connexion ouverte et base spécifiée")
SINON
	Erreur()
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Ouvrir une connexion avec un serveur Domino et indiquer la base Lotus Notes à utiliser

`<Résultat> = EmailOuvreSessionNotes(<Mot de passe> , <Serveur Domino> [, <Base Lotus Notes> [, <Chemin du certificat>]])`
---

**`<Résultat> : (Entier)`**



- Identifiant de la session.

- 0 (ou <u><u><u><u>Faux</u></u></u></u>) en cas d'erreur. La variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Mot de passe> : (Chaîne de caractères)`**

Mot de passe de l'utilisateur. Ce mot de passe est fourni par le fournisseur de services ou par l'administrateur réseau.

**`<Serveur Domino> : (Chaîne de caractères)`**



- Nom du serveur Domino, 

- Chaîne vide ("") si la base est locale.




**`<Base Lotus Notes> : (Chaîne de caractères optionnelle)`**

Nom de la base Lotus Notes contenant les données de l'utilisateur. Ce nom correspond au chemin du fichier ".NSF".

Si la base Lotus Notes est située sur un serveur Domino, il est nécessaire d'utiliser un chemin relatif.

Si ce paramètre n'est pas spécifié, le nom de la base Lotus Notes sera lu dans le fichier de configuration du client Lotus Notes (fichier "Notes.INI"). La base utilisée correspondra alors à la base de l'utilisateur du client Lotus Notes du poste en cours.

**`<Chemin du certificat> : (Chaîne de caractères optionnelle)`**

Chemin du certificat permettant d'authentifier l'utilisateur (fichier "ID"). Ce fichier est délivré par l'administrateur du serveur Domino. Ce fichier est obligatoire pour se connecter au serveur.

Si ce paramètre n'est pas spécifié, le chemin du certificat sera lu dans le fichier de configuration du client Lotus Notes (fichier "Notes.INI"). Le certificat utilisé correspondra alors au certificat de l'utilisateur du client Lotus Notes du poste en cours.  


<a name="SYNTAXE2"></a>

### Spécifier la base Lotus Notes à utiliser

`<Résultat> = EmailOuvreSessionNotes(<Identifiant de la session> [, <Base Lotus Notes>])`
---

**`<Résultat> : (Entier)`**



- Identifiant de la session.

- 0 (ou <u><u><u><u>Faux</u></u></u></u>) en cas d'erreur. La variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Identifiant de la session> : (Chaîne de caractères)`**

Identifiant de la session à ouvrir. Cet identifiant est retourné par la fonction [NotesOuvreConnexion](../WDLang3/1000005102.md).

**`<Base Lotus Notes> : (Chaîne de caractères optionnelle)`**

Nom de la base Lotus Notes contenant les données de l'utilisateur. Ce nom correspond au chemin du fichier ".NSF".

Si la base Lotus Notes est située sur un serveur Domino, il est nécessaire d'utiliser un chemin relatif.

Si ce paramètre n'est pas spécifié, le nom de la base Lotus Notes sera lu dans le fichier de configuration du client Lotus Notes (fichier "Notes.INI"). La base utilisée correspondra alors à la base de l'utilisateur du client Lotus Notes du poste en cours.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Version de Lotus Notes
<a name="version_lotus_notes_ELTPARAGRAPHE000102"></a>L'accès à Lotus Notes est possible uniquement sous Lotus Notes version 6.5 ou supérieure.
<a name="NOTE0_2"></a>


### Délai de timeout
<a name="delai_timeout_ELTPARAGRAPHE000109"></a>Il est possible de paramétrer le délai de timeout avec la fonction [EmailChangeTimeOut](../WDLang3/3032001.md).

<a name="XComposante"></a>

## Composante :
wd280com.dll
