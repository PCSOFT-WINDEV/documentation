
## FTPCommande (Fonction)

***En anglais : FTPCommand***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Envoie une commande FTP spécifique à un serveur.

**Attention** : Cette fonction n'est pas disponible lors d'une connexion en mode : 

- FTPIS :  FTP sécurisé selon le protocole SSL avec chiffrement implicite. 

- FTPES : FTP sécurisé selon le protocole SSL avec chiffrement explicite. 

- SFTP : FTP sécurisé par un tunnel SSH. 









<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003040017&name=ftpcommande_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Connexion du poste en cours au serveur FTP
NumConnexion = FTPConnecte("192.54.12.8")
// Demande du système du serveur
SI FTPCommande(NumConnexion, "SYST", Réponse) = Vrai ALORS
	Info("Information sur le système du serveur : " + RC + Réponse)
SINON
	Info("Le serveur n'accepte pas la commande SYST." + ...
		"L'information sur le système du serveur n'est pas disponible")
FIN
// Demande de la liste des fichiers du répertoire courant
SI FTPCommande(NumConnexion, "LIST", Réponse, MaListe) = Vrai ALORS
	// Voici la liste des fichiers du répertoire en cours sur le serveur
	Info("Voici la liste des fichiers du répertoire en cours sur le serveur : " + RC + MaListe)
FIN
```


<a name="Exemple2"></a>



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Envoyer une commande FTP spécifique à un  serveur

`<Résultat> = FTPCommande(<Identifiant de la connexion> , <Commande FTP> [, <Réponse du serveur> [, <Résultat de la commande> [, <Mode de transfert> [, <Données à envoyer>]]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la commande a été exécutée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème.




**`<Identifiant de la connexion> : (Entier)`**

Identifiant de la connexion, obtenu avec la fonction [FTPConnecte](../WDLang3/3040016.md).

**`<Commande FTP> : (Chaîne de caractères)`**

Commande FTP envoyée au serveur.

**`<Réponse du serveur> : (Chaîne de caractères optionnelle)`**

Variable de type chaîne de caractères contenant la réponse du serveur pour la commande FTP spécifiée. Ce paramètre permet d'obtenir la réponse du serveur sur le canal de commande (le canal de commandes permet la réception des messages d'erreur ou de succès).



**`<Résultat de la commande> : (Chaîne de caractères ANSI optionnelle)`**

Variable de type chaîne de caractères ANSI contenant les données correspondant au résultat de la commande FTP spécifiée. Ce résultat est envoyé par le serveur sur le canal de données.

**Attention** : Si ce paramètre est précisé, la fonction **FTPCommande** est bloquante jusqu'à réception du résultat. En particulier si la commande ne doit pas recevoir de résultat par le canal de données, le client est bloqué indéfiniment. Pour plus de détails sur les commandes FTP, consultez la spécification RFC959.

**`<Mode de transfert> : (Constante optionnelle de type Entier)`**

Mode de transfert réalisé :


|   |   |
| --- | --- |
| *ftpModeASCII* | Transfert réalisé en mode ASCII. Ce mode est utilisé pour un transfert entre deux systèmes d'exploitation différents, par exemple UNIX vers Windows : le fichier transféré est livré dans le format ASCII du système destinataire. |
| *ftpModeBinaire* <br>(Valeur par défaut) | Transfert réalisé en mode binaire : Le fichier est strictement identique entre l'envoi et la réception. |



**`<Données à envoyer> : (Chaîne de caractères optionnelle)`**

Données associées à la commande FTP et devant être envoyées au serveur FTP. Ces données sont envoyées par le canal de données.  


<a name="SYNTAXE2"></a>

<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Rappel sur le protocole FTP
<a name="rappel_sur_protocole_ftp_ELTPARAGRAPHE000129"></a>Ce protocole utilise 2 canaux de communication :

- **Un canal de commandes** : permet l'envoi des commandes et la réception des messages d'erreur ou de succès,

- **Un canal de données** pour faire transiter les données associées à la commande.





<a name="NOTE0_2"></a>


### Commandes FTP
<a name="commandes_ftp_ELTPARAGRAPHE000140"></a>Toutes les commandes utilisables sur un serveur FTP sont regroupées dans la spécification RFC959. Ce document est disponible sur Internet (il suffit de réaliser une recherche sur un moteur de recherche Internet en utilisant la référence RFC959).

**Quelques exemples classiques : Récupération et envoi de fichiers avec FTPCommande**

1. Récupération de fichiers :


```txt
Réponse, ResData sont des chaînes 
FTPCommande(<Identifiant de la connexion>, ...
	"RETR " + <Nom Fichier serveur>, ...
	Réponse, ResData, <Mode de transfert>)
// ResData contient le fichier
```


2. Envoi de fichiers :


```txt
Réponse, ResData, DataRésultat sont des chaînes 
// ResData contient le fichier à envoyer
FTPCommande(<Identifiant de la connexion>,...
	"STOR " + <Nom Fichier serveur>, ...
	Réponse, DataRésultat, <Mode de transfert>, ResData)
```



<a name="NOTE0_3"></a>




### Exemple : Obtenir un fichier TEST situé dans la bibliothèque AAA d'un AS/400 : 
<a name="exemple_obtenir_fichier_test_situe_dans_bibliotheque_aaa_as400_ELTPARAGRAPHE000159"></a>


```wl
Réponse, ResData sont des chaînes 
IDFTP = FTPConnecte("as400", "login", "MDP")
FTPCommande(IDFTP,"RETR " + "AAA/TEST", Réponse, ResData)
// ResData contient le fichier
fSauveTexte("C:\Tmp\test", ResData)
```



<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000169"></a>La fonction **FTPCommande** est disponible uniquement si Internet Explorer 5 (ou version supérieure) est installé sur le poste du client FTP.

<a name="XComposante"></a>

## Composante :
wd280com.dll
