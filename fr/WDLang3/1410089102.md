


## SCPEnvoieFichier (Fonction)

***En anglais : SCPSendFile***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Envoie un fichier via le protocole SCP. 

Rappel : Le "Secure Copy Protocol (SCP)" est un protocole assurant un transfert sécurisé des données entre un ordinateur local et un ordinateur distant ou encore entre deux ordinateurs distants. Ce protocole est basé sur une connexion SSH. 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Création de la session SSH
sessionSSH est une sshSession
sessionSSH.Adresse = "monserveur.com"
sessionSSH.Port = 22
sessionSSH.Utilisateur = "username"
sessionSSH.MotDePasseUtilisateur = "password"
sessionSSH.TimeoutConnexion = 2s

sNomFichier est une chaîne = "compta_janvier.docx"
// Chemin du fichier sur le poste local
sCheminFichierLocal est une chaîne = fRepExe() + [fSep()] + sNomFichier
// Chemin du fichier sur le poste distant (ici sous Linux)
sCheminFichierDistant est une chaîne = "~/compta/" + sNomFichier

// Envoi du fichier via SCP
SI PAS SCPEnvoieFichier(sessionSSH, sCheminFichierLocal, ...
			sCheminFichierDistant, Progression) ALORS
	Erreur(ErreurInfo(errComplet))
SINON
	Info("Envoie terminé")
FIN


// Suivi de la progression (procédure optionnelle)
PROCÉDURE INTERNE Progression(nTailleTotale, nTailleEnCours)
	Trace(nTailleEnCours + "/" + nTailleTotale)
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = SCPEnvoieFichier(<Connexion SSH> , <Fichier local> , <Fichier distant> [, <Procédure WLangage>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'envoi de données a été effectué, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Le compte-rendu d'erreur détaillé peut être obtenu avec la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Connexion SSH> : (Variable de type sshSession)`**

Nom de la variable de type [sshSession](../WDLang3/1000021157.md) utilisée pour l'envoi du fichier. 

**`<Fichier local> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier à transférer via le protocole SCP. 

**`<Fichier distant> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier destination sur le poste distant. 

**`<Procédure WLangage> : (Nom de procédure optionnel)`**

Nom de la procédure WLangage (également nommée "callback") appelée lors de l'envoi du fichier. Cette procédure permet de connaître la progression du transfert du fichier. 

Pour plus de détails sur cette procédure, consultez [Paramètres de la procédure utilisée par la fonction SCPEnvoieFichier](../WDLang3/1410089310.md).



<a name="XComposante"></a>

## Composante :
wd280com.dll
