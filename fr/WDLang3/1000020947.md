
## FTPParamètre (Fonction)

***En anglais : FTPConfigure***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie le comportement des fonctions FTP standard. 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Activation de l'implémentation native du FTP
FTPParamètre(ftpParamètreMode, 1)
```


<a name="Exemple2"></a>

```wl
// Activation de l'implémentation Windows ("wininet") du FTP
FTPParamètre(ftpParamètreMode, 0)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`FTPParamètre(<Option> , <Valeur de l'option>)`
---

**`<Option> : (Constante de type Entier)`**

Option à fixer : 


|   |   |
| --- | --- |
| *ftpesParamètreModeSecurisé* | Permet de modifier le chiffrement en FTPES.<br><br>- **Si le paramètre &lt;Valeur de l'option&gt; vaut 0**, le chiffrement s'applique aux données et aux commandes FTP. Ce mode correspond au mode de fonctionnement par défaut des fonctions en FTPES.<br><br>- **Si le paramètre &lt;Valeur de l'option&gt; vaut 1**, le chiffrement SSL s'applique uniquement aux commandes FTP. Ce mode peut être requis pour certains serveurs FTPES.<br><br><br> |
| *ftpParamètreMode* | Permet de choisir le mode de fonctionnement du FTP.<br><br>- **Si le paramètre &lt;Valeur de l'option&gt; vaut 0**, les fonctions de gestion du FTP utilisent le module "wininet" de Windows sauf pour les protocoles sécurisés ([FTPIS, FTPES et SFTP](../WDLang3/3040016.md)). Ce mode correspond au mode de fonctionnement par défaut des fonctions FTP.<br><br>- **Si le paramètre &lt;Valeur de l'option&gt; vaut 1**, les fonctions de gestion du FTP utilisent une implémentation native du FTP et indépendante de Windows, avec le support d'UTF8. <br>	**Attention** :  Dans ce mode, la fonction [FTPCommande](../WDLang3/3040017.md) n'est pas supportée. Ce mode est systématiquement utilisé pour les protocoles sécurisés ([FTPIS, FTPES et SFTP](../WDLang3/3040016.md)).<br><br><br> |





**`<Valeur de l'option> : (Entier)`**

Nouvelle valeur de l'option. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
Les fonctions FTPxxx du WLangage utilisent par défaut les fonctions FTP de l'API de Windows (WININET.DLL). Actuellement sous Windows 8.1, ces API ne donnent plus les résultats attendus :

- transfert inachevé,

- retour "impossible de modifier le répertoire en.".




En attendant un rétablissement des fonctions FTP standard par Windows Update, il est possible de modifier le comportement des fonctions FTPxxx du WLangage, afin qu'elles ne reposent plus sur les fonctions FTP de l'API de Windows. Il suffit d'insérer l'appel suivant dans le traitement de transfert FTP, avant l'appel existant de la fonction [FTPConnecte](../WDLang3/3040016.md) : 


```wl
FTPParamètre(ftpParamètreMode, 1)
```


Remarque : La fonction **FTPParamètre** s'applique à toutes les fonctions FTPxxx du WLangage, à l'exception de la fonction [FTPCommande](../WDLang3/3040017.md). Si cette dernière était utilisée, elle peut être remplacée par les fonctions [FTPEnvoie](../WDLang3/3040014.md) ou [FTPRécupère](../WDLang3/3040002.md) suivant le cas.

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd28com.dll
