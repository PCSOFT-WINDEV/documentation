


## &lt;Variable zipArchive&gt;.Ouvre (Fonction)

***En anglais : &lt;zipArchive variable&gt;.Open***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ouvre une archive existante. 

Pour les archives au format "CAB" ou "RAR", si l'archive n'existe pas, elle est créée. 

L'archive peut être :

- au format standard Winzip ou PKZip (extension .ZIP).

- au format WINDEV (extension .WDZ).

- au format Cabinet file (extension .CAB).

- au format RAR (extension .RAR). 

- au format 7z (extension .7z). 

- au format TAR (extension .TAR). 

- au format TGZ (extension .TGZ). 

- au format TAR.GZ (extension .TAR.GZ). 

- un exécutable (.EXE) correspondant à un fichier .WDZ transformé en archive auto-extractible. 







<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
MonArchive est un zipArchive
// Ouverture d'une archive
ResOuvreArchive = MonArchive.Ouvre("C:\MesArchives\Archive.zip")

// Affichage du message d'erreur si l'archive n'a pas été ouverte
SI ResOuvreArchive <> 0 ALORS
	Erreur(zipMsgErreur(ResOuvreArchive))
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Archive>.Ouvre(<Chemin de l'archive> [, <Mode d'ouverture>])`
---

**`<Résultat> : (Entier)`**



- 0 si l'archive a été ouverte, 

- Un code d'erreur (valeur supérieure à 0) dans le cas contraire. Pour plus de détails sur ces codes d'erreur, consultez les Remarques.




**`<Archive> : (Variable de type zipArchive)`**

Nom d'une variable de type [zipArchive](../WDLang3/1000018679.md) correspondant à l'archive à manipuler.

Si l'archive n'existe pas, elle est créée (sauf pour les formats "CAB" ou "RAR").

**`<Chemin de l'archive> : (Chaîne de caractères)`**

Chemin et nom de l'archive (260 caractères maximum). L'extension de l'archive peut être précisée. Si l'extension de l'archive n'est pas précisée, l'extension par défaut sera .WDZ.
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Si l'extension n'est pas précisée, l'extension sera ".ZIP".![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Le chemin de l'archive est un chemin complet ou relatif au répertoire de travail de l'application (connu avec la fonction [fRepDonnées](../WDLang1/3036001.md)). 

**`<Mode d'ouverture> : (Constante optionnelle ou combinaison de constantes)`**

Mode d'ouverture de l'archive : 


|   |   |
| --- | --- |
| *zipCréationSiInexistant* | Création de l'archive si l'archive est inexistante<br>(non disponible pour les fichiers .CAB et les fichiers .RAR) |
| *zipEcriture* | Ouverture en lecture/écriture<br>(non disponible pour les fichiers .CAB et les fichiers .RAR) |
| *zipEntête64* | Permet de créer une archive de plus de 4 gigas sur laquelle la fonction [&lt;Variable zipArchive&gt;.ChangeChemin](../WDLang3/1000026329.md) pourra être utilisée.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible.<br><br>Archive au format TAR ou TGZ (TAR.GZ) : Cette constante n'est pas disponible. |
| *zipLecture* | Ouverture en lecture seule |


Le mode d'ouverture par défaut est : *zipCréationSiInexistant* + *zipEcriture*.  
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Ce paramètre n'est pas disponible : le mode d'ouverture utilisé correspond à *zipCréationSiInexistant* + *zipEcriture*.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Codes d'erreur
<a name="codes_erreur_ELTPARAGRAPHE000343"></a>Les codes d'erreur retournés sont les suivants :

- 1 : Le chemin passé en paramètre n'existe pas.

- 2 : Accès interdit : l'utilisateur n'a pas les droits nécessaires.

- 3 : L'archive est corrompue.

- 6 : Les fichiers des sous-archives ne sont pas dans l'ordre (cas de l'ouverture d'une archive multi-parties).


Le message correspondant au code d'erreur peut être connu grâce à la fonction [zipMsgErreur](../WDLang3/3082034.md).
Rappel : 

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Seules les archives au format ZIP, TAR et TGZ (TAR.GZ) sont disponibles.

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seules les archives au format ZIP sont disponibles.





### Cas particulier de l'extension .GZ
<a name="cas_particulier_extension_ELTPARAGRAPHE000371"></a>Ne pas confondre les fichiers '.tar.gz' générés par GitHub, et les fichiers '.gz' compressés au format gzip.
Un contenu compressé au format  gzip pourra être décompressé avec la fonction [Décompresse](../WDLang1/3024009.md).

<a name="XComposante"></a>

## Composante :
wd280zip.dll
