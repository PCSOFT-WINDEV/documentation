


## &lt;modbusSession&gt;.EcritBit (Fonction)

***En anglais : &lt;modbusSession&gt;.WriteBit***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Écrit un ou plusieurs bits à une adresse précise dans un esclave Modbus.

**Remarques** : 

- L'exécution de cette fonction est bloquante tant que l'esclave n'a pas accusé réception du message ou tant que le délai d'attente de la session n'est pas dépassé. 

- L'écriture sur 1 bit correspond au code fonction Modbus 5 (Write Single Coil). 

- L'écriture sur plusieurs bits correspond au code fonction Modbus 15 (Write Multiple Coils).



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Crée une session et connexion à un serveur Modbus
Session est un modbusSession
Session = ModbusConnecteTCP("192.168.1.7")

// Si la connexion échoue, affiche l'erreur
SI ErreurDétectée = Vrai ALORS
	Trace(ErreurInfo())
SINON
	// Ecrit une séquence de 5 bits à partir de l'adresse 0x42.
    SI PAS Session.EcritBit(0x42, [1,0,1,1,0]) ALORS
	 Trace(ErreurInfo())	
    FIN
FIN    

// Déconnexion
Session.Déconnecte()
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Ecrire 1 bit dans un esclave Mobdus

`<Résultat> = <Session>.EcritBit(<Adresse> , <Bit>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> l'écriture a été réalisée,  

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Session> : (Variable de type modbusSession)`**

Nom de la variable de type [modbusSession](../WDLang3/1000025924.md) correspondant à la session de communication vers l'esclave Modbus.

**`<Adresse> : (Entier)`**

Valeur comprise entre 0 et 65 535 correspondant à l'adresse (dans l'esclave) à laquelle le bit doit être écrit.

**`<Bit> : (Booléen)`**

Valeur du bit à écrire : <u><u><u><u>Vrai</u></u></u></u> ou <u><u><u><u>Faux</u></u></u></u>.


<a name="SYNTAXE2"></a>

### Ecrire plusieurs bits dans un esclave Modbus

`<Résultat> = <Session>.EcritBit(<Adresse> , <Bits à envoyer>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> l'écriture a été réalisée,  

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Session> : (Variable de type modbusSession)`**

Nom de la variable de type [modbusSession](../WDLang3/1000025924.md) correspondant à la session de communication vers l'esclave Modbus.

**`<Adresse> : (Entier)`**

Valeur comprise entre 0 et 65 535 correspondant à l'adresse (dans l'esclave) à laquelle les bits doivent être écrits.

**`<Bits à envoyer> : (Tableau de booléen)`**

Nom de la variable de type Tableau contenant les bits à envoyer.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
ATTENTION : Les opérations d'écriture permettant de manipuler des automates, il est recommandé de tester les différentes commandes avant une mise en production afin de vérifier que les automates effectuent bien les opérations demandées.





<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280com.dll
