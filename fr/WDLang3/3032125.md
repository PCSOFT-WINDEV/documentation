


## EmailCherchePremierNotes (Fonction)

***En anglais : EmailSeekFirstNotes***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Recherche un ou plusieurs emails selon des critères spécifiés, dans une base locale ou distante Lotus Notes ou Domino.

Cette recherche peut être effectuée :

- soit dans une ou plusieurs parties de l'email.

- soit à l'aide d'une formule de sélection de Lotus Notes.



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ouverture d'une session Lotus Notes
IDSession est un entier
IDSession = EmailOuvreSessionNotes("MotDePasse", "ServeurMars", ...
		"mail/julie.nsf", "C:\Lotus Notes\julie.id")
...
// Recherche des emails contenant la chaîne "PC Soft" 
// dans le sujet ou dans le corps du message
// Seuls les emails reçus sont pris en compte
SI EmailCherchePremierNotes(IDSession, emailSujet + emailCorps, ...
			"PC Soft", notesReçu) = Vrai ALORS
	// Enumération des emails trouvés
	TANTQUE Email.EnDehors = Faux
		// Affiche l'expéditeur et le sujet dans un champ Table
		TableAjoute(TABLE_EmailTrouve, Email.Expéditeur + ...
				TAB + Email.Sujet)
		// Email trouvé suivant
		EmailLitSuivant(IDSession)
	FIN
SINON
	Info("Aucun email n'a été trouvé")
FIN
```
<a name="Exemple2"></a>

```wl
// Ouverture d'une session Lotus Notes
IDSession est un entier
IDSession = EmailOuvreSessionNotes("MotDePasse", "ServeurMars", ...
			"mail/julie.nsf", "C:\Lotus Notes\julie.id")
...
// Recherche grâce à une formule de sélection de Lotus Notes
// Recherche des emails contenant la chaîne "pc soft" 
// dans le sujet ou dans le corps du message
// et contenant WinDev dans la catégorie
// Seuls les emails reçus et non lus sont pris en compte
SI EmailCherchePremierNotes(IDSession, emailSujet + emailCorps, ...
	"PC Soft", "@contains(@lowercase(categories);'WinDev')", ...
	notesReçu, emailNonLus) = Vrai ALORS
	// Enumération des emails trouvés
	TANTQUE Email.EnDehors = Faux
		// Affiche l'expéditeur et le sujet dans un champ Table
		TableAjoute(TABLE_EmailTrouve, Email.Expéditeur + ...
			TAB + Email.Sujet)
		// Email trouvé suivant
		EmailLitSuivant(IDSession)
	FIN
SINON
	Info("Aucun email n'a été trouvé")
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Recherche dans une ou plusieurs parties d'une variable de type Email

`<Résultat> = EmailCherchePremierNotes(<Session> , <Email> , <Partie de l'email> , <Valeur cherchée> [, <Type d'email> [, <Mode de lecture>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si un ou plusieurs emails ont été trouvés, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. 


En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*. 

Si aucun email n'a été trouvé, la variable [ErreurDétectée](../WDLang1/3087001.md) reste à <u><u><u><u>Faux</u></u></u></u> et la variable Email.EnDehors est positionnée à <u><u><u><u>Vrai</u></u></u></u>.

**`<Session> : (Entier ou Variable de type emailSessionNotes)`**

La session peut être :

- un entier renvoyé par une des fonctions suivantes : [EmailOuvreSession](../WDLang3/3032028.md), [EmailOuvreSessionNotes](../WDLang3/3032121.md) ou [NotesOuvreConnexion](../WDLang3/1000005102.md).

- une variable de type [emailSessionNotes](../WDLang3/1000018768.md).




**`<Email> : (Variable de type Email)`**

Nom de la variable de type [Email](../WDLang3/1000018713.md) correspondant à l'email dans lequel la recherche doit être effectuée.

**`<Partie de l'email> : (Constante ou combinaison de constante de type Entier)`**

Partie de l'email dans laquelle ou lesquelles la &lt;Valeur cherchée&gt; doit être recherchée :



|   |   |
| --- | --- |
| *emailCorps* | Corps des emails. |
| *emailDestinataire* | Destinataires des emails. |
| *emailExpéditeur* | Expéditeurs des emails. |
| *emailSujet* | Sujets des emails. |


Ces constantes peuvent être combinées.

**`<Valeur cherchée> : (Chaîne de caractères)`**

Valeur recherchée dans les emails.

**`<Type d'email> : (Constante ou combinaison de constantes optionnelle, de type Entier)`**

Type d'email dans lequel la recherche va être effectuée :



|   |   |
| --- | --- |
| *notesASuivre* | Emails marqués "A suivre". |
| *notesBrouillon* | Emails brouillon. |
| *notesEnvoyé* | Emails envoyés. |
| *notesReçu* | Emails reçus. |
| *notesTous*<br>(Valeur par défaut) | Tous les emails. |


Ces constantes peuvent être combinées.

**`<Mode de lecture> : (Constante ou chaîne de caractères optionnelle)`**

Précise les messages qui doivent être lus : 



|   |   |
| --- | --- |
| *emailNonLus* ou "NON LUS" | La recherche est effectuée uniquement dans les emails non lus. |
| *emailTous* ou "TOUS"<br>(Valeur par défaut) | La recherche est effectuée dans les emails lus et dans les emails non lus. |




<a name="SYNTAXE2"></a>

### Recherche à l'aide d'une formule de sélection de Lotus Notes dans une variable de type Email

`<Résultat> = EmailCherchePremierNotes(<Session> , <Email> , <Partie de l'email> , <Valeur cherchée> , <Formule Lotus Notes> [, <Type d'email> [, <Mode de lecture>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si un ou plusieurs emails ont été trouvés, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. 


En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*. 

Si aucun email n'a été trouvé, la variable [ErreurDétectée](../WDLang1/3087001.md) reste à <u><u><u><u>Faux</u></u></u></u> et la variable Email.EnDehors est positionnée à <u><u><u><u>Vrai</u></u></u></u>.

**`<Session> : (Entier ou Variable de type emailSessionNotes)`**

La session peut être :

- un entier renvoyé par la fonction [EmailOuvreSession](../WDLang3/3032028.md), [EmailOuvreSessionNotes](../WDLang3/3032121.md) ou [NotesOuvreConnexion](../WDLang3/1000005102.md).

- une variable de type [emailSessionNotes](../WDLang3/1000018768.md).




**`<Email> : (Variable de type Email)`**

Email dans lequel la recherche doit être effectuée.

**`<Partie de l'email> : (Constante ou combinaison de constante de type Entier)`**

Partie de l'email dans laquelle ou lesquelles la &lt;Valeur cherchée&gt; doit être recherchée :



|   |   |
| --- | --- |
| *emailAucun* | Recherche effectuée uniquement à l'aide d'une formule de sélection de Lotus Notes. Dans ce cas, le paramètre &lt;Valeur cherchée&gt; correspond à une chaîne vide ("").<br>Cette constante ne peut pas être combinée. |
| *emailCorps* | Corps des emails. |
| *emailDestinataire* | Destinataires des emails. |
| *emailExpéditeur* | Expéditeurs des emails. |
| *emailSujet* | Sujets des emails. |


Ces constantes peuvent être combinées.

**`<Valeur cherchée> : (Chaîne de caractères)`**



- Valeur recherchée dans les emails, 

- Chaîne vide ("") si le paramètre &lt;Partie de l'email&gt; correspond à la constante *emailAucun*.




**`<Formule Lotus Notes> : (Chaîne de caractères)`**

Formule de sélection des emails dans Lotus Notes. Pour plus de détails sur ces formules de sélection, consultez la documentation de Lotus Notes.

**`<Type d'email> : (Constante ou combinaison de constantes optionnelle, de type Entier)`**

Type d'email dans lequel la recherche va être effectuée :



|   |   |
| --- | --- |
| *notesASuivre* | Emails marqués "A suivre". |
| *notesBrouillon* | Emails brouillon. |
| *notesEnvoyé* | Emails envoyés. |
| *notesReçu* | Emails reçus. |
| *notesTous*<br>(par défaut) | Tous les emails. |


Ces constantes peuvent être combinées.

**`<Mode de lecture> : (Constante ou chaîne de caractères optionnelle)`**

Précise les messages qui doivent être lus :



|   |   |
| --- | --- |
| *emailNonLus* ou "NON LUS" | La recherche est effectuée uniquement dans les emails non lus. |
| *emailTous* ou "TOUS"<br>(Valeur par défaut) | La recherche est effectuée dans les emails lus et dans les emails non lus. |




<a name="SYNTAXE3"></a>

### Recherche dans une ou plusieurs parties de la structure email

`<Résultat> = EmailCherchePremierNotes(<Session> , <Partie de l'email> , <Valeur cherchée> [, <Type d'email> [, <Mode de lecture>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si un ou plusieurs emails ont été trouvés, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. 


En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*. 

Si aucun email n'a été trouvé, la variable [ErreurDétectée](../WDLang1/3087001.md) reste à <u><u><u><u>Faux</u></u></u></u> et la variable Email.EnDehors est positionnée à <u><u><u><u>Vrai</u></u></u></u>.

**`<Session> : (Entier ou Variable de type emailSessionNotes)`**

La session peut être :

- un entier renvoyé par une des fonctions suivantes : [EmailOuvreSession](../WDLang3/3032028.md), [EmailOuvreSessionNotes](../WDLang3/3032121.md) ou [NotesOuvreConnexion](../WDLang3/1000005102.md).

- une variable de type [emailSessionNotes](../WDLang3/1000018768.md).




**`<Partie de l'email> : (Constante ou combinaison de constante de type Entier)`**

Partie de l'email dans laquelle ou lesquelles la &lt;Valeur cherchée&gt; doit être recherchée :



|   |   |
| --- | --- |
| *emailCorps* | Corps des emails. |
| *emailDestinataire* | Destinataires des emails. |
| *emailExpéditeur* | Expéditeurs des emails. |
| *emailSujet* | Sujets des emails. |


Ces constantes peuvent être combinées.

**`<Valeur cherchée> : (Chaîne de caractères)`**

Valeur recherchée dans les emails.

**`<Type d'email> : (Constante ou combinaison de constantes optionnelle, de type Entier)`**

Type d'email dans lequel la recherche va être effectuée :



|   |   |
| --- | --- |
| *notesASuivre* | Emails marqués "A suivre". |
| *notesBrouillon* | Emails brouillon. |
| *notesEnvoyé* | Emails envoyés. |
| *notesReçu* | Emails reçus. |
| *notesTous*<br>(Valeur par défaut) | Tous les emails. |


Ces constantes peuvent être combinées.

**`<Mode de lecture> : (Constante ou chaîne de caractères optionnelle)`**

Précise les messages qui doivent être lus :



|   |   |
| --- | --- |
| *emailNonLus* ou "NON LUS" | La recherche est effectuée uniquement dans les emails non lus. |
| *emailTous* ou "TOUS"<br>(Valeur par défaut) | La recherche est effectuée dans les emails lus et dans les emails non lus. |




<a name="SYNTAXE4"></a>

### Recherche à l'aide d'une formule de sélection de Lotus Notes dans la structure Email

`<Résultat> = EmailCherchePremierNotes(<Session> , <Partie de l'email> , <Valeur cherchée> , <Formule Lotus Notes> [, <Type d'email> [, <Mode de lecture>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si un ou plusieurs emails ont été trouvés, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. 


En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*. 

Si aucun email n'a été trouvé, [ErreurDétectée](../WDLang1/3087001.md) reste à <u><u><u><u>Faux</u></u></u></u> et la variable Email.EnDehors est positionnée à <u><u><u><u>Vrai</u></u></u></u>.

**`<Session> : (Entier ou Variable de type emailSessionNotes)`**

La session peut être :

- un entier renvoyé par une des fonctions suivantes : [EmailOuvreSession](../WDLang3/3032028.md), [EmailOuvreSessionNotes](../WDLang3/3032121.md) ou [NotesOuvreConnexion](../WDLang3/1000005102.md).

- une variable de type [emailSessionNotes](../WDLang3/1000018768.md).




**`<Partie de l'email> : (Constante ou combinaison de constante de type Entier)`**

Partie de l'email dans laquelle ou lesquelles la &lt;Valeur cherchée&gt; doit être recherchée :



|   |   |
| --- | --- |
| *emailAucun* | Recherche effectuée uniquement à l'aide d'une formule de sélection de Lotus Notes. Dans ce cas, le paramètre &lt;Valeur cherchée&gt; correspond à une chaîne vide ("").<br>Cette constante ne peut pas être combinée. |
| *emailCorps* | Corps des emails. |
| *emailDestinataire* | Destinataires des emails. |
| *emailExpéditeur* | Expéditeurs des emails. |
| *emailSujet* | Sujets des emails. |


Ces constantes peuvent être combinées.

**`<Valeur cherchée> : (Chaîne de caractères)`**



- Valeur recherchée dans les emails, 

- Chaîne vide ("") si le paramètre &lt;Partie de l'email&gt; correspond à la constante *emailAucun*.




**`<Formule Lotus Notes> : (Chaîne de caractères)`**

Formule de sélection des emails dans Lotus Notes. Pour plus de détails sur ces formules de sélection, consultez la documentation de Lotus Notes.

**`<Type d'email> : (Constante ou combinaison de constantes optionnelle, de type Entier)`**

Type d'email dans lequel la recherche va être effectuée :



|   |   |
| --- | --- |
| *notesASuivre* | Emails marqués "A suivre". |
| *notesBrouillon* | Emails brouillon. |
| *notesEnvoyé* | Emails envoyés. |
| *notesReçu* | Emails reçus. |
| *notesTous*<br>(Valeur par défaut) | Tous les emails. |


Ces constantes peuvent être combinées.

**`<Mode de lecture> : (Constante ou chaîne de caractères optionnelle)`**

Précise les messages qui doivent être lus :



|   |   |
| --- | --- |
| *emailNonLus* ou "NON LUS" | La recherche est effectuée uniquement dans les emails non lus. |
| *emailTous* ou "TOUS"<br>(Valeur par défaut) | La recherche est effectuée dans les emails lus et dans les emails non lus. |





<a name="NOTE0"></a>
<a name="XComposante"></a>

## Composante :
wd280com.dll
