
## Constructeur et destructeur
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000358"></a>
Par défaut, lors de la création d'une classe sous l'éditeur de code les méthodes Constructeur et Destructeur sont automatiquement créées.

- **La méthode Constructeur**, si elle est définie par le développeur, est automatiquement appelée lors de l'instanciation d'un objet. Elle permet par exemple d'effectuer des initialisations sur l'objet ou relatives à l'objet (affectation des membres, vérifications...)

- **La méthode Destructeur**, si elle est définie par le développeur, est automatiquement appelée lors de la suppression de l'objet (sortie de procédure dans laquelle l'objet a été instancié). Elle permet par exemple d'effectuer les traitements de libération de ressources...




Les méthodes Constructeur et Destructeur ne peuvent pas contenir les fonctions [Evénement](../WDLang1/3015011.md), [Timer](../WDLang1/3015008.md), [Multitache](../WDLang1/3015004.md), [DnDEvénement](../WDLang1/3030006.md), [DDEEvénement](../WDLang1/3028009.md), [AppelDLL32](../WDLang1/3014003.md), etc.



Remarques :

- Les méthodes Constructeur peuvent être publiques, protégées ou privées.

- Il est possible de créer des Constructeurs multisyntaxes. Pour plus de détails, consultez [Surcharge de prototype](../Motscles/1514063.md).








<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Syntaxe du Constructeur de la classe
<a name="syntaxe_constructeur_classe_ELTTEXTE000382"></a>
**Déclaration du constructeur**

```txt
PROCEDURE [<Accès>] Constructeur([<Paramètres>])
```


**Détail de la syntaxe**

**&lt;Accès&gt;** : Optionnel
3 niveaux d'accès sont disponibles : 

- PUBLIC (par défaut) : Le constructeur est accessible en dehors de la classe.

- PROTEGE : Le constructeur est accessible dans la classe et dans les classes dérivées.

- PRIVE : Le constructeur est accessible uniquement dans la classe.


Pour plus détails, consultez le paragraphe [Notes sur les Constructeurs](#NOTE3_0).

Remarque : Pour modifier la portée du Constructeur, il est possible d'utiliser le menu contextuel sur la méthode dans l'explorateur de projet.

**&lt;Paramètres&gt;**
Paramètres optionnels du constructeur. Si ces paramètres sont précisés, il est nécessaire de passer ces paramètres lors de la [déclaration de l'objet](../POO/6010002.md) ou lors de [l'instanciation dynamique](../POO/6010003.md).


<a name="NOTE2_2"></a>
**Déclaration de l'objet : le constructeur est appelé automatiquement**

```txt
<NomObjet> est [un] [objet] <Nom Classe> ([<Paramètres>])
```


**Détail de la syntaxe**

**&lt;NomObjet&gt;**
Nom identifiant l'instance de la classe.**&lt;Nom classe&gt;**
Nom identifiant la classe, défini lors de la création de la classe sous l'éditeur de code.**&lt;Paramètres&gt;**
Paramètres optionnels du constructeur.<a name="NOTE2_3"></a>
**Instanciation dynamique : le constructeur est appelé automatiquement**

```txt
<NomObjet> est [un] [objet] <NomClasse> dynamique
<NomObjet> = allouer un <NomClasse> ([<Paramètres>])
```


**Détail de la syntaxe**

**&lt;NomObjet&gt;**
Nom identifiant l'instance de la classe.**&lt;Nom classe&gt;**
Nom identifiant la classe, défini lors de la création de la classe sous l'éditeur de code.**&lt;Paramètres&gt;**
Paramètres optionnels du constructeur.
<a name="NOTE3_0"></a>


## Note concernant les constructeurs
<a name="note_concernant_les_constructeurs_ELTTEXTE000418"></a>
**Portée et accès des Constructeurs**
Le Constructeur d'une classe peut être public, protégé ou privé.

Héritage :

- Une classe avec Constructeur public peut être héritée.

- Une classe avec Constructeur protégé peut être héritée.

- Une classe avec Constructeur privée ne peut pas être héritée.




Accessibilité dans le cas des Constructeurs privés ou protégés :

- Il est impossible d'instancier un objet de la classe dans un code du projet.

- Il est impossible de déclarer de tableau dont les éléments sont des instances de la classe dans un code du projet.

- Il est impossible de déclarer de membre du type de la classe dans une variable composée, une structure ou une autre classe dans un code de la classe ou du projet.




**Remarque importante :** Quelle que soit la portée du Constructeur, il est toujours possible de déclarer des objets dynamiques dans un code du projet. Si l'instanciation (l'allocation) des objets est impossible, la déclaration d'objets dynamiques est toujours possible.  Les codes suivants sont donc toujours valides :

```wl
// Dans ces deux cas, l'instanciation n'est pas faite à la déclaration.
Objet1 est un Classe1 dynamique
Objet2 est un Classe1 <- ...
```


**Pour instancier des objets dans le code du projet**, il est possible d'utiliser une méthode globale de la classe.
Exemple avec un Constructeur privé :

```wl
// Méthode globale de ClasseAvecConstructeurPrivée
PROCEDURE GLOBALE MéthodeGlobaleAllocation(...)

o est ClasseAvecConstructeurPrivé
RENVOYER o
// *****************************************

// Récupération d'un objet de la classe depuis un code du projet :

// Solution 1 :
o2 est ClasseAvecConstructeurPrivé dynamique
o2 = ClasseAvecConstructeurPrivé.MéthodeGlobaleAllocation(...)

// Solution 2 :
o3 est ClasseAvecConstructeurPrivé <- ClasseAvecConstructeurPrivé.MéthodeGlobaleAllocation(...)
```


**Attention** : L'opérateur d'affectation (=) n'a pas le même comportement avec des objets dynamiques ou non dynamiques. L'utilisation des objets o2 et o3 dans des affectations provoquera un comportement différent :

```wl
// Déclaration d'un nouvel objet dynamique.
o4 est un ClasseAvecConstructeurPrivé dynamique

// o2 est une référence à o4
o2 = o4

// Les membres de o4 sont copiés dans o3
o3 = o4
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Syntaxe des constructeurs des classes de base et des membres
<a name="syntaxe_des_constructeurs_des_classes_base_des_membres_ELTTEXTE000442"></a>
**Exécution du constructeur d'une classe de base ou d'un membre**
Si une classe de base ou un membre de type classe possède un constructeur, ce constructeur est automatiquement appelé sans paramètre. Il faut :

- soit attribuer des valeurs par défaut aux paramètres du constructeur (de la classe de base ou du membre)

- soit appeler explicitement le constructeur en lui passant les paramètres.





<a name="NOTE3_2"></a>
**Appel de la méthode constructeur pour construire une classe**

```txt
Constructeur <NomClasse>(<Paramètres>)
```


**Détail de la syntaxe**

**&lt;NomClasse&gt;**
Nom identifiant la classe.**&lt;Paramètres&gt;**
Paramètres du constructeur.<a name="NOTE3_3"></a>
**Appel du constructeur pour construire un membre**

```txt
Constructeur <Nom membre> (<Paramètres>)
```


**Détail de la syntaxe**

**&lt;Nom Membre&gt;**
Nom identifiant le membre de la classe.**&lt;Paramètres&gt;**
Paramètres du constructeur.<a name="NOTE3_4"></a>
**Exemple**
Les constructeurs explicites de la classe de base ou du membre doivent être appelés en première instruction du constructeur de la classe dérivée.


```wl
//----Déclaration de classe ClasseBase1
ClasseBase1 est une Classe
	MembreClasseBase1 est un entier
FIN
```

```wl
//---- Constructeur de ClasseBase1
PROCEDURE Constructeur(Param1)
Info("Constructeur de ClasseBase1 => " + Param1)
```



```wl
//----Déclaration de classe ClasseBase2
ClasseBase2 est une Classe
	MembreClasseBase2 est un entier
FIN
```

```wl
//---- Constructeur de ClasseBase2
PROCEDURE Constructeur(Param1)
Info("Constructeur de ClasseBase2 => " + Param1)
```



```wl
//---- Déclaration de classe ClasseDérivée
ClasseDérivée est une classe
	// Héritage de ClasseBase1 dont 
	// le Constructeur attend un paramètre
	Hérite de ClasseBase1
	// Membre de type ClasseBase2 dont 
	// le Constructeur attend un paramètre
	MembreClasseDérivée est un ClasseBase2
FIN
```

```wl
//----Constructeur de ClasseDérivée
PROCEDURE Constructeur()
// Appel explicite du Constructeur
Constructeur ClasseBase1(10) 
Constructeur MembreClasseDérivée(20)
```




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Notes
<a name="notes_ELTTEXTE000484"></a>
**Valeur par défaut des membres**
Chaque membre d'une classe est mis à zéro si aucun constructeur n'est associé à la classe.



<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Syntaxes de la méthode Destructeur
<a name="syntaxes_methode_destructeur_ELTTEXTE000508"></a>
**Déclaration de la méthode**

```txt
PROCEDURE Destructeur <NomClasse>()
```


**Détail de la syntaxe**

**&lt;NomClasse&gt;**
Nom identifiant la classe. Le destructeur n'accepte aucun paramètre.<a name="NOTE5_2"></a>


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) **Cas particulier en Java/Android**
La notion de destructeur n'existe pas en Java/Android. Le code situé dans le destructeur d'une classe ne sera par conséquent jamais exécuté. 
Un objet est libéré par le ramasse-miette (garbage collector) lorsqu'il n'est plus référencé dans l'application. Le moment où intervient cette libération n'est pas prévisible.
Pour forcer la libération d'un objet, il est possible de l'affecter à NULL ou d'utiliser l'instruction [Libérer](../Motscles/1511012.md).




- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDPOOSimple.gif) ***Exemples didactiques (WINDEV)*** : **WD POO Simple** <br>L'exemple "WD POO Simple" est un exemple didactique sur la POO avec WINDEV. Cet exemple permet de voir le fonctionnement :<br>- des classes, <br>- des héritages,<br>- des procédures virtuelles,<br>- des diagrammes UML,<br>- ...


