
## Objet .NET
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation d'un objet .NET
<a name="presentation_objet_net_ELTTEXTE000190"></a>
Pour accéder à une classe .NET, il faut déclarer **l'objet .NET** comme étant de la classe à manipuler, on parle d' **instanciation d'un objet .NET**.

Une instance est un objet .NET qui appartient à une classe .NET donnée.

**Pour manipuler un objet .NET**, il faut :

1. Importer l'assemblage .NET (pour plus de détails, consultez [Utiliser des assemblages .NET dans une application WINDEV](../Editeurs/2012002.md)).

2. Déclarer l'objet .NET comme étant un objet d'une des classes de l'assemblage. Un objet .NET peut être passé en paramètre à une fonction ou à une procédure.




Remarque : Il est possible d'instancier dynamiquement un objet .NET à une classe. Pour plus de détails, consultez [Instanciation dynamique d'un objet .NET](../POO/6010004.md).



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Syntaxe de déclaration d'un objet .NET
<a name="syntaxe_declaration_objet_net_ELTTEXTE000214"></a>


### Déclaration d'un objet .NET
<a name="declaration_objet_net_ELTPARAGRAPHE000034"></a>
```txt
<Nom Objet .NET> est [un] [objet] <Nom Classe .NET>([<Paramètres>])
```


où : 

- **&lt;Nom Objet .NET&gt;** : Nom identifiant l'instance de la classe.

- **&lt;Nom classe .NET&gt;** : Nom identifiant la classe. Si la classe .NET a le même nom qu'un mot-clé du WLangage, il faut encadrer le nom de la classe par des quotes (par exemple o est une "&lt;Classe&gt;"(&lt;Paramètres&gt;). 
	
	**Pour utiliser une classe en précisant le namespace,** il est nécessaire de mettre le nom complet de la classe entre guillemets. Par exemple : 
	
	```wl
	var3 est un "Microsoft.CRM.Proxy.CRMAccount"
	```

	**Pour utiliser un générique**, il faut mettre le nom du générique entre guillemets. Par exemple : 
	
	```wl
	MaListe est "List<CMonObjet>"
	```


- **&lt;Paramètres&gt;** : Paramètres optionnels du constructeur. Pour plus de détails, consultez [Méthode constructeur](../POO/6010001.md). 






<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Les membres d'un objet .NET
<a name="les_membres_objet_net_ELTTEXTE000238"></a>
Un membre d'un objet est une donnée associée à l'objet.

Pour accéder aux membres, utilisez les syntaxes suivantes :

1. **Appeler un membre appartenant à un objet différent de l'objet en cours** : 
	
	```txt
	<Nom Objet> : <Nom Membre>
	```

	Le membre est recherché parmi les membres de la classe de l'objet. Si le membre n'est pas trouvé, il est recherché parmi les membres des classes ancêtres de la classe de l'objet.

2. **Appeler un membre de l'objet en cours** : 
	
	```txt
	: <Nom Membre>
	```


3. **Appeler un membre d'une classe ancêtre qui a été redéfinie** : 
	
	```txt
	<Nom Objet> : <Nom Classe> :: <Nom Membre>
	```


4. **Appeler un membre de classe générale** : 
	
	```txt
	<Nom Classe> :: <Nom Membre>
	```




<a name="NOTE3_3"></a>


### Remarque : Problèmes de casse
<a name="remarque_problemes_casse_ELTPARAGRAPHE000086"></a>Il arrive que deux membres d'un objet .NET aient des noms identiques avec uniquement une différence de casse (Majuscules/Minuscules). Dans ce cas, WINDEV prend en priorité le membre utilisant la casse saisie sous l'éditeur de code.

**Rappel** : Pour ne pas utiliser ponctuellement la complétion automatique sous l'éditeur de code de WINDEV, il suffit de ne pas valider la proposition de WINDEV (ne pas utiliser la touche ENTRÉE).



<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Les méthodes d'un objet .NET
<a name="les_methodes_objet_net_ELTTEXTE000268"></a>
Les méthodes d'un objet sont les fonctionnalités associées à l'objet.

1. **Appeler une méthode appartenant à un objet différent de l'objet en cours** : 
	
	```txt
	<Nom Objet> : <Nom Méthode> ([<Paramètres>])
	```

	La méthode est recherchée parmi les méthodes de la classe de l'objet. Si la méthode n'est pas trouvée, elle est recherchée parmi les méthodes des classes ancêtres de la classe de l'objet.

2. **Appeler une méthode générique** : 
	
	```txt
	<Nom Objet> : "<Nom Méthode><<Type concret>>" ([<Paramètres>])
	```

	Exemple d'appel d'une méthode générique :

	```wl
	// Prototype de la méthode générique CloneListe de la classe CClone
	// CloneListe(List<T>)
	// ...
	MaListe est "List<int>"
	// ...
	clClone est CClone
	MaListeCopie est "List<int>" <- clClone."CloneListe<int>"(MaListe)
	```


3. **Appeler une méthode d'extension** : 
	
	```txt
	<Nom Objet> : <Nom Méthode> ([<Paramètres>])
	```

	Les méthodes d'extension peuvent être appelées de la même manière que les méthodes de l'objet.



<a name="NOTE4_5"></a>


### Remarque : Problèmes de casse
<a name="remarque_problemes_casse_ELTPARAGRAPHE000123"></a>Il arrive que deux méthodes d'un objet .NET aient des noms identiques avec uniquement une différence de casse (Majuscules/Minuscules). Dans ce cas, WINDEV prend en priorité la méthode utilisant la casse saisie sous l'éditeur de code.

Rappel : Pour ne pas utiliser ponctuellement la complétion automatique sous l'éditeur de code de WINDEV, il suffit de ne pas valider la proposition de WINDEV (ne pas utiliser la touche ENTRÉE).



<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Durée de vie d'un objet .NET
<a name="duree_vie_objet_net_ELTTEXTE000303"></a>
L'objet est créé lors de sa déclaration. Par défaut l'objet est local.

L'objet est automatiquement détruit à la fin du traitement contenant sa déclaration : 

- Un objet déclaré global dans le code d'initialisation d'une fenêtre sera détruit à la fin du traitement de fermeture de la fenêtre.

- Un objet déclaré global dans le code d'initialisation d'un projet sera détruit à la fin du traitement de fermeture de la première fenêtre du projet.







- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDActiveDirectoryDotNet.gif) ***Exemples didactiques (WINDEV)*** : **WD Active Directory DotNet** <br>Cet exemple permet la visualisation du contenu d'un Active Directory. <br>Cette visualisation est effectuée grâce à des objets .NET contenus dans l'assembly System.DirectoryServices. Vous avez la possibilité de visualiser les propriétés des utilisateurs et d'authentifier des utilisateurs grâce à leur mot de passe.<br>Vous pouvez toujours visualiser des informations (plus ou moins importantes selon vos droits) en entrant juste le nom de votre serveur Active Directory
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDGestionnairedetacheDOTNET.gif) ***Exemples complets (WINDEV)*** : **WD Gestionnaire de tache DOTNET** <br>Cet exemple permet de lister les applications et les processus grâce à des fonctions .NET. <br><br>De plus, il permet d'effectuer différents traitements sur les applications (Basculer vers une application, Maximiser, Minimiser ...) ainsi que sur les processus (changer la priorité ou encore terminer le processus).<br>Cet exemple reprend les principales fonctionnalités d'un gestionnaire de tâches.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDObservateurRepertoire.gif) ***Exemples didactiques (WINDEV)*** : **WD ObservateurRépertoire** <br>Cet exemple montre l'utilisation de la fonction WLangage fSurveilleRépertoire.<br>il permet de monitorer un répertoire,<br>c'est à dire d'être prévenu à chaque fois qu'une modification est faite dans ce répertoire.<br>Une modification peut être :<br>- Un ajout de fichier / répertoire<br>- Un renommage<br>- Une modification de fichier<br>- Une suppression de fichier


