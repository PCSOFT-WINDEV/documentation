
## Copie et clonage
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Les règles de copie
<a name="les_regles_copie_ELTTEXTE000204"></a>
La copie des variables est effectuée grâce à l'opérateur "=". 



| Type des variables | Effet |
| --- | --- |
| Types simples (entier, réel, chaîne, ...) | La valeur de la variable est copiée. |
| Tableaux | Le tableau destination est une référence sur le tableau source. |
| Tableaux associatifs | Le contenu du tableau est copié. |
| File | Le contenu de la file est copié. |
| Pile | Le contenu de la pile est copié. |
| Liste | Le contenu de la liste est copié. |
| Objet = Objet dynamique | Les membres de l'objet dynamique sont copiés dans ceux de l'objet. |
| Objet = Objet | Les membres de l'objet source sont copiés dans ceux de l'objet destination. |
| Objet dynamique = Objet dynamique | L'objet dynamique destination est une référence à l'objet dynamique source. |
| Objet dynamique = Objet | L'objet dynamique destination est une référence à l'objet source. |
| Structure = Structure dynamique | Une copie de la structure est réalisée. Les membres de même nom sont initialisés avec les valeurs existantes. Les membres inexistants sont ignorés. |
| Structure = Structure | Une copie de la structure est réalisée. Les membres de même nom sont initialisés avec les valeurs existantes. Les membres inexistants sont ignorés. |
| Structure dynamique = Structure dynamique | La structure dynamique destination est une référence à la structure dynamique source. |
| Structure dynamique = Structure | La structure dynamique destination est une référence à la structure source. |
| Type avancé = Type avancé | Une copie de la variable de type avancé est réalisée. Les propriétés de même nom sont initialisées avec les valeurs existantes. |
| Type avancé = Type avancé dynamique | Une copie de la variable de type avancé est réalisée. Les propriétés de même nom sont initialisées avec les valeurs existantes. |
| Type avancé dynamique = Type avancé | La variable de type avancé dynamique destination est une référence à la variable de type avancé source.<br> |
| Type avancé dynamique = Type avancé dynamique | La variable de type avancé dynamique destination est une référence à la variable de type avancé dynamique source. |




<a name="NOTE1_2"></a>


### Cas des tableaux lors de la copie d'instances de classes
<a name="cas_des_tableaux_lors_copie_instances_classes_ELTPARAGRAPHE000094"></a>Lors de copies d'instances de classes, tous les membres de la classe sont recopiés dans la nouvelle instance y compris les tableaux. Ainsi les tableaux sont indépendants dans toutes les instances de classes. 

**Pour ne pas obtenir des tableaux indépendants dans toutes les instances de classes** : 

1. Affichez la fenêtre de description du projet : sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description". 

2. Dans l'onglet "Compilation", décochez l'option "Tableaux : l'affectation copie le contenu". 


Pour plus de détails, consultez [Description projet, onglet compilation](../Editeurs/9500218.md).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Des attributs d'extension spécifiques
<a name="des_attributs_extension_specifiques_ELTTEXTE000234"></a>
Deux attributs d'extension spécifiques peuvent être utilisés pour indiquer les opérations à effectuer : 

- **&lt;Copie=Clone&gt;** : utilisé sur un objet dynamique, cet attribut d'extension permet de forcer le clonage de l'objet. 

- **&lt;Copie=Faux&gt;** : utilisé sur un membre, cet attribut d'extension permet d'empêcher la copie de la valeur du membre lors de la copie d'un objet dans un autre. 




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## La fonction Clone
<a name="fonction_clone_ELTTEXTE000258"></a>
La fonction [Clone](../WDLang1/1000024843.md) permet de construire une copie d'une instance de classe : 

- Un objet de la classe réelle de l'instance de la classe est alloué. 

- Une copie des membres de l'instance de la classe vers les membres du nouvel objet est effectuée. Les méthodes "Constructeur" et "Destructeur" sont également copiées. 




**Avantage** : Dans le cas du polymorphisme, il n'est plus nécessaire d'écrire le code nécessaire à ce clonage. Il est également inutile d'écrire les méthodes virtuelles dans toutes les classes dérivées ainsi que les constructeurs. 

**Remarque** : La copie tient compte de l'attribut &lt;Copie&gt; de chaque membre : 

- &lt;Copie=Faux&gt; pour ignorer un membre,

- &lt;Copie=Clone&gt; pour effectuer un clonage. 




Exemple : 


```wl
// Il existe un feu tricolore dans le XIIè arrondissement de Paris, au 1 Rue Taine
// Il est rouge
FeuCroisement est un FeuTricolore
FeuCroisement.Adresse = "1 Rue Taine, 75012 Paris"
FeuCroisement.Statut = RougeFoncé
	
// On doit mettre en place un deuxième feu, au numéro 25 de la même rue
	
// Si on copie simplement l'objet...
FeuCopie est un FeuTricolore dynamique = FeuCroisement
FeuCopie.Adresse = "25 Rue Taine, 75012 Paris"
// FeuCroisement a aussi changé d'adresse... !
	
// Si on clone l'objet...
FeuBis est un FeuTricolore dynamique = Clone(FeuCroisement)
// FeuBis contient les mêmes informations que FeuCroisement
// Mais si l'on modifie l'une de ses propriétés, cela n'impacte pas le feu d'origine
	
// Change l'adresse
FeuBis.Adresse = "25 Rue Taine, 75012 Paris"
// >> FeuCroisement.Adresse = "1 Rue Taine, 75012 Paris"

FeuBis.Statut = RougeFoncé
// >> FeuCroisement.Statut = VertFoncé
```





