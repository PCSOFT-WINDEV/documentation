
## Lancer WDOptimiseur en ligne de commande
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Syntaxe
<a name="syntaxe_ELTTEXTE000232"></a>


### Pour lancer WDOptimiseur en ligne de commande, utilisez la syntaxe suivante
<a name="pour_lancer_wdoptimiseur_ligne_commande_utilisez_syntaxe_suivante_ELTPARAGRAPHE000011"></a>


```txt
WDOptimiseur	/Fic=<Répertoire>
	/Mdp=<Mot de passe>
	/Option=<Type d'action réalisée>
	/Log=<Fichier Log>
	/Muet=<Oui/Non>
	/ExploreSousRep=<Oui/Non>
	/CompactageIndex=<Oui/Non>
	/SupprIndex=<Oui/Non>
	/RecupMemos=<Oui/Non>
	/ConserveRaye=<Oui/Non>
	/Alphabet=<Alphabet>
	/Densite=<Taux de densité>
	/Langue=<Langue d'affichage>
	/Sauve=<Oui/Non>
```


Le tableau ci-dessous liste les différents éléments pouvant être présents sur la ligne de commande :

| **Paramètre** | **Signification** |
| --- | --- |
| /Fic=&lt;Répertoire&gt; | Pour traiter un seul fichier de données : chemin complet du fichier de données à traiter.<br>Pour traiter un ensemble de fichiers de données :<br><br>- chemin d'un répertoire, <br><br>- Fichier INI au format d'export généré par WDOptimiseur. <br><br><br>Pour traiter des transactions : chemin complet du fichier de transaction.<br>**Exemple** : c:\\temp\\fichier.fic |
| /Mdp=&lt;Mot de passe&gt; | Mot de passe associé au fichier de données à traiter (traitement d'un seul fichier de données) |
| /Option=&lt;Type d'action à réaliser&gt; | Numéro correspondant à l'option de WDOptimiseur à lancer :<br>1 : Vérification de l'index.<br>2 : Optimiser la vitesse des index (Recalculer les statistiques sur les fichiers de données).<br>3 : Reconstruire les index.<br>4 : Reconstruire les index et les mémos.<br>5 : Réviser et compresser les index et les mémos. |
| /Log=&lt;Fichier Log&gt; | Chemin complet du fichier journal (.log) à créer. Ce fichier n'est créé que si une des options 1 à 5 est sélectionnée. |
| /Muet=&lt;Oui/Non&gt; | Oui permet de valider automatiquement la fenêtre de compte-rendu (Non par défaut). |
| /ExploreSousRep=&lt;Oui/Non&gt; | Oui permet d'explorer les sous-répertoires du répertoire spécifié dans le paramètre "/Fic" (Non par défaut). |
| /CompactageIndex=&lt;Oui/Non&gt; | Oui permet de supprimer les enregistrements inactifs lors d'une ré-indexation (options 3 et 4) (Non par défaut). |
| /SupprIndex=&lt;Oui/Non&gt; | Oui permet de supprimer les enregistrements endommagés (options 3 et 4) (Non par défaut). |
| /RecupMemos=&lt;Oui/Non&gt; | Oui permet d'essayer de récupérer les données du mémo s'il est endommagé (option 5) (Non par défaut). |
| /ConserveRaye=&lt;Oui/Non&gt; | Oui permet de conserver les enregistrements rayés (option 5) (Non par défaut). |
| /Alphabet=&lt;Alphabet&gt; | Permet de préciser l'alphabet utilisé pour la réindexation. Il est possible d'utiliser une des constantes correspondant à l'alphabet à utiliser.<br><br><br>\   \   \<br>\ --- \ --- \<br>\ *alphabetArabe* \ Caractères arabes \<br>\ *alphabetBalte* \ Caractères baltes \<br>\ *alphabetChinois* \ Caractères chinois (République Populaire de Chine) \<br>\ *alphabetChinoisTraditionnel* \ Caractères chinois traditionnel (République de Taïwan) \<br>\ *alphabetCoréen* \ Caractères coréens \<br>\ *alphabetDéfaut* \ Utilise l'alphabet par défaut du poste. Aucun alphabet n'est forcé. \<br>\ *alphabetEuropeEst* \ Caractères d'Europe de l'est (polonais, ...) \<br>\ *alphabetGrec* \ Caractères grecs \<br>\ *alphabetHébreu* \ Caractères hébreux \<br>\ *alphabetJaponais* \ Caractères japonais \<br>\ *alphabetOccidental* \ Caractères romains à la norme ANSI \<br>\ *alphabetRusse* \ Caractères russes \<br>\ *alphabetThaï* \ Caractères thaï \<br>\ *alphabetTurc* \ Caractères turques \<br>\ *alphabetUTF8* \ Permet de gérer les pays pouvant utiliser deux alphabets (Hong Kong) et les pays n'ayant pas d'alphabet défini dans Windows (Géorgien et Arménien). \<br>\ *alphabetVietnamien* \ Caractères vietnamiens \<br><br> |
| /Densite=&lt;Taux de densité&gt; | Taux de remplissage des index. Par défaut, ce taux a pour valeur 80. <br>**Plus ce taux est important**, plus l'index est dense et de petite taille. Dans ce cas, les parcours, recherches, filtres et requêtes seront plus rapides. Les ajouts d'enregistrements et les modifications d'enregistrements pourront être ralentis. <br>**Plus ce taux est faible**, moins l'index sera dense et plus sa taille sera importante. Dans ce cas, les parcours, recherches, filtres et requêtes seront ralentis. Les ajouts d'enregistrements et les modifications d'enregistrements seront plus rapides. |
| /Langue=&lt;Langue d'affichage&gt; | "US" permet de faire fonctionner WDOptimiseur en Anglais (Français par défaut). |
| /Sauve=&lt;Non&gt; | Par défaut, les fichiers à traiter sont sauvegardés (uniquement pris en compte si /option = 5). Non permet de ne pas faire cette sauvegarde. |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Exemples
<a name="exemples_ELTTEXTE000256"></a>
La ligne de commande suivante permet de lancer la ré-indexation des fichiers présent dans le répertoire "C:\\MonAppli\\Données".


```wl
LanceAppli("C:\MonRépertoire\WDOptimiseur.EXE /Fic=C:\MonAppli\Données")
```



<a name="NOTE2_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Exemple de procédure de re-indexation
<a name="exemple_procedure_reindexation_ELTPARAGRAPHE000182"></a>


```wl
// Variables globales du projet 
gsNomAppli est une chaîne = "MonAppli"
gsRepData est une chaîne = ComplèteRep(fRepExe()) + "Data\"
```

```wl
//Procédure globale au projet 
PROCEDURE gWdOptimiseAnalyse(_NumOption = 5,_bSauvegarde = Faux)
// Pilotage de WOPTIMISEUR pour tous les fichiers d'une appli 
// avec prise en compte de mot de passe, ExeActif et 
// WdOptimiseur bloquant quand il s'exécute. 
// Après chaque réindexation, WDOPTIMISEUR affiche le message
// "La réindexation du fichier 'C:\.....\MonFic.Fic' s'est déroulée correctement".
// L'utilisateur doit cliquer sur "Ok".
// Par défaut l'option 5 de WDOptimiseur est utilisée
// Par défaut les fichiers ne sont pas sauvegardés avant optimisation
// - Requis : 
//   - Les fichiers de données peuvent être délocalisés par rapport à l'exe 
// (Variables globales gsNomAppli et gsRepData)
//  - WDOptimiseur est toujours à côté de l'exécutable
//  - Les fichiers peuvent avoir un nom physique différent du nom logique 
// ainsi qu'une extension <> ".FIC"
 
// Variables locales au traitement
sListFichier, sNomFichier sont des chaînes
sSauvegarde est une chaîne = "Faux"
SI _bSauvegarde = Vrai ALORS sSauvegarde = "Vrai"
	i est un entier = 1
	sRep est une chaîne = ComplèteRep(fRepExe())
	 // Nom physique du fichier (nom + extension)
	sNomPhysFichier est une chaîne
	// Mot de passe du fichier 
	sMdp est une chaîne 
	sLigneCommande est une chaîne

	// Vérification de la présence de WDOPTIMISEUR
	SI fRep(sRep + "WDOptimiseur.EXE", frFichier) = "" _OU_ ...
				fRep(sRep + "WDOutil.WDK", frFichier) = "" ALORS 
			Erreur("L'outil 'WdOptimiseur n'a pas été correctement installé")
		RETOUR
	FIN

	// Liste des fichiers de l'analyse
	sListFichier = HListeFichier()
	sNomFichier  = ExtraitChaîne(sListFichier, i, RC)
	TANTQUE sNomFichier <> EOT 
		sNomPhysFichier = {sNomFichier}..NomPhysique + {sNomFichier}..Extension
		SI fRep(gsRepData + sNomPhysFichier, frFichier) <> "" ALORS 
			// Prise en compte des mots de passe de certains fichiers protégés  
		SELON Majuscule(sNomFichier)
			CAS "TOTO" : sMdp = "toto"
			AUTRE CAS : sMdp = ""  
		FIN
		SI sMdp <> "" ALORS 
			sLigneCommande = 
				sRep + "WDOptimiseur.EXE   /Fic=" + ...
				gsRepData + sNomPhysFichier + " /mdp=" + sMdp + " /" + ...
					_NumOption + " /" + sSauvegarde
		SINON
				sLigneCommande = sRep + "WDOptimiseur.EXE   /Fic=" + ...
					 gsRepData + sNomPhysFichier + " /5 /" + sSauvegarde
			FIN
		LanceAppli(sLigneCommande, exeActif, exeBloquant)
	FIN
	i++
	sNomFichier  = ExtraitChaîne(sListFichier, i, RC)
FIN
Info("Optimisation des fichiers de '" + gsNomAppli + "' terminée")
```



