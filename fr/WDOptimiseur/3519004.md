


## Optimiser les index
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000209"></a>


### WDOptimiseur propose plusieurs modes d'optimisation des index :
<a name="wdoptimiseur_propose_plusieurs_modes_optimisation_des_index_ELTPARAGRAPHE000011"></a>***1. Vérifier les index*** : Vérifie la cohérence entre l'index et les fichiers de données.

***2. Optimiser la vitesse des index (Recalcul des statistiques)*** : Optimise les index en calculant les statistiques sur les index. Ces statistiques permettent d'optimiser les filtres, les requêtes et les vues HFSQL. 
Remarque : Plus le fichier de données est modifié et moins les statistiques reflètent le contenu du fichier de données HFSQL. Plus le fichier de données contient d'enregistrements et moins la modification d'un enregistrement a d'impact sur les statistiques.

***3. Reconstruire les index*** : Optimise l'accès aux enregistrements du fichier de données et re-calcule les statistiques. Tous les enregistrements rayés sont automatiquement supprimés.

***4. Reconstruire les index et les mémos*** :  Optimise la totalité du fichier de données, de son index et ses mémos.

***5. Réviser et compresser les index et les mémos*** : Optimise la totalité du fichier de données, de son index et ses mémos. Les mémos seront compressés. Des options avancées sont disponibles ("Options de compression des mémos").
Remarques : 

- Le fichier de données est recréé : la date de dernière écriture du dernier enregistrement (obtenue par la fonction [HDateEnreg](../WDLang4/3044338.md)) est remise à la date du jour.

- Les rubriques de type Horodatage sont également modifiées et correspondent à la date du jour, au moment où l'optimisation est effectuée. 




**Remarques** :

- Mis à part l'option 2, toutes les modes d'optimisation entraînent le blocage des fichiers de données pendant l'optimisation. Les utilisateurs sont informés que le fichier de données est en cours de maintenance.

- Lorsque la réindexation est effectuée, le contexte HFSQL en cours est rétabli (sauf si l'option de compression des mémos a été choisie).




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000239"></a>


### Optimiser les index d'un fichier de données
<a name="optimiser_les_index_fichier_donnees_ELTPARAGRAPHE000045"></a>Pour optimiser les index d'un fichier de données :

1. Lancez WDOptimiseur :

	- Directement depuis WINDEV, WEBDEV ou WINDEV Mobile : sous le volet "Outils", dans le groupe "Base de données", cliquez sur "WDOptimiseur".

	- en lançant directement le programme "WDOptimiseur.EXE".




2. Sélectionnez les fichiers de données à traiter. Il est possible : 

	- soit de réaliser un "Drag and drop" des fichiers de données depuis l'explorateur vers WDOptimiseur. Les fichiers droppés apparaissent automatiquement dans la liste. 

	- soit d'ajouter un ou plusieurs fichiers grâce au bouton "Ajouter un fichier". 

	- soit d'ajouter les fichiers de données présents dans un répertoire grâce au bouton "Ajouter un dossier". 
			Il est possible de traiter les sous-répertoires grâce à l'option "Lors de l'ajout d'un répertoire, inclure les fichiers de tous les sous-répertoires". 




3. Sélectionnez les fichiers de données à traiter et indiquez si nécessaire le mot de passe de chaque fichier de données. 
	Remarque : Si le mot de passe est identique pour tous les fichiers de données, cochez l'option "Le mot de passe est identique pour tous les fichiers". 

4. Cliquez sur le bouton "Optimiser les index" ou "Optimiser les index des fichiers sélectionnés" et choisissez l'option voulue. 

<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDOptimiseur_Index%20-%20HC%20N%B0001%201.gif)
Un rapport est généré en cas de problème.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Options de ré-indexation
<a name="options_reindexation_ELTTEXTE000263"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000085"></a>Les options de ré-indexation apparaissent dans la partie basse de l'écran :<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDOptimiseur_Index%20-%20HC%20N%B0001.gif)

<a name="NOTE3_2"></a>


### Mode avancé réindexation
<a name="mode_avance_reindexation_ELTPARAGRAPHE000093"></a>Ces options sont prises en compte pour les ré-indexation de type 1 à 4 :

- **Supprimer les enregistrements inactifs (supprimés ou rayés)**
	Si cette option est sélectionnée, les enregistrements rayés sont définitivement supprimés.
	**Rappel** : Lorsqu'un enregistrement est rayé, il est supprimé logiquement et pourra éventuellement être récupéré par la suite. L'enregistrement est encore présent dans le fichier de données. La suppression des enregistrements rayés supprime définitivement ces enregistrements et permet ainsi d'optimiser la taille du fichier de données.

- **Supprimer les enregistrements endommagés**
	Si cette option est cochée, les enregistrements endommagés sont automatiquement supprimés.

- **Réindexer sans bloquer les postes clients**
	Si cette option est cochée, la ré-indexation est effectuée en tâche de fond et les applications clientes ne seront pas arrêtées. 
	**Attention** : Cette option est prise en compte uniquement pour des fichiers de données HFSQL Client/Serveur. 

- **Densité de l'index**
	Correspond au taux de remplissage des index. Par défaut, ce taux a pour valeur 80. 
	Plus ce taux est important, plus l'index est dense et de petite taille. Dans ce cas, les parcours, recherches, filtres et requêtes sont plus rapides. Les ajouts d'enregistrements et les modifications d'enregistrements pourront être ralentis. 
	Plus ce taux est faible, moins l'index sera dense et plus sa taille sera importante. Dans ce cas, les parcours, recherches, filtres et requêtes seront ralentis. Les ajouts d'enregistrements et les modifications d'enregistrements seront plus rapides. 
	Attention : ce paramètre est utilisable uniquement sur les fichiers de données au format HFSQL Classic ou Client/Serveur.

- **Alphabet**
	Par défaut, l'alphabet du fichier de données est conservé. Mais il est possible d'effectuer une ré-indexation en changeant l'alphabet du fichier de données. Dans ce cas, le nouvel alphabet sera pris en compte lors de la ré-indexation. Les tris, recherches, ... sur des clés de type chaîne (chaînes, caractères, date et heure) seront effectuées selon cet alphabet.



<a name="NOTE3_3"></a>


### Options de compression des mémos
<a name="options_compression_des_memos_ELTPARAGRAPHE000126"></a>Ces options sont prises en compte lors de la révision avec compression des index et des mémos (option 5) :

- **Conserver les enregistrements rayés**
	Si cette option est sélectionnée, les enregistrements rayés sont conservés. Dans le cas contraire, ils sont définitivement supprimés.

- **Essayer de récupérer les données du mémo s'il est endommagé**
	Si cette option est sélectionnée, WDOptimiseur tente de récupérer le mémo. Dans le cas contraire, les enregistrements endommagés sont récupérés sans le mémo associé. 
	**Attention** : La récupération du mémo peut être partielle. Vérifiez vos fichiers de données.



<a name="NOTE3_4"></a>


### Options
<a name="options_ELTPARAGRAPHE000142"></a>Ces options permettent de simplifier la gestion de la liste de fichiers à ré-indexer :

- **Le mot de passe est identique pour tous les fichiers**
	Si cette option est sélectionnée, le même mot de passe est utilisé pour tous les fichiers de données. Il suffit d'indiquer le mot de passe dans la colonne "Mot de passe" pour le premier fichier de données de la liste.
	Si cette option est décochée, il est nécessaire d'indiquer le mot de passe dans la colonne "Mot de passe" de la table pour chaque fichier de données.

- **Lors de l'ajout d'un répertoire, inclure les fichiers présents dans tous les sous-répertoires**
	Si cette option est sélectionnée, l'ajout des fichiers de données présents dans les sous-répertoires est automatique.



<a name="NOTE3_5"></a>


### Droits d'accès au fichier de données
<a name="droits_acces_fichier_donnees_ELTPARAGRAPHE000158"></a>L'optimisation provoque la recréation du fichier de données sur disque. 

Il convient de vérifier les droits du fichier optimisé. Ces droits peuvent être différents de ceux du fichier d'origine. Il est alors nécessaire de les redéfinir au niveau de Windows après l'optimisation.


