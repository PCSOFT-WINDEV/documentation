


## ValeurRenvoyée (Propriété)

***En anglais : ReturnedValue***
	



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
La propriété **ValeurRenvoyée** permet de :

- Connaître et modifier la valeur renvoyée par une fenêtre, une page ou un état.

- Connaître et modifier la valeur renvoyée par une option d'un champ Sélecteur. 




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Rappel** : Une fenêtre ouverte par la fonction [Ouvre](../WDLang1/3038035.md) peut renvoyer un résultat lors de sa fermeture. Cette valeur est renvoyée :

- soit par le mot-clé [Renvoyer](../Motscles/1510007.md) présent dans le code de fermeture de la fenêtre,

- soit par la fonction [Ferme](../WDLang1/3038018.md),
	**Remarque** : La fonction [Ferme](../WDLang1/3038018.md) permet de renvoyer plusieurs valeurs.

- soit par la propriété **ValeurRenvoyée** utilisée avant la fermeture de la fenêtre.


![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Utilisée sur le mot-clé [MaFenêtreFille](../Motscles/1511021.md), la propriété **ValeurRenvoyée** permet de récupérer la valeur renvoyée par une fenêtre fille dans une application mobile.

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) **Rappel** : Un état imprimé par la fonction [iImprimeEtat](../WDLang5/3046032.md) peut renvoyer un résultat à la fin de son impression. Cette valeur est renvoyée :

- soit par le mot-clé [Renvoyer](../Motscles/1510007.md) présent dans le code de fermeture de l'état,

- soit par la propriété **ValeurRenvoyée** utilisée avant la fermeture de l'état.







<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 
```wl
// Code permettant d'ouvrir la fenêtre "FEN_SaisieMotDePasse"
MonMotDePasse = Ouvre(FEN_SaisieMotDePasse)
SI MonMotDePasse <> "" ALORS
	Info("Mot de passe incorrect")
FIN

// --------------------------------------------------------------------------------
// -- Code de clic sur le champ Bouton "OK" de la fenêtre "FEN_SaisieMotDePasse"
// L'utilisateur saisit son mot de passe dans le champ "SAI_MotDePasse"
// et valide la fenêtre
Ferme()

// --------------------------------------------------------------------------------

// -- Code de fermeture de la fenêtre
FEN_SaisieMotDePasse.ValeurRenvoyée = SAI_MotDePasse
```
<a name="Exemple2"></a>
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 
```wl
// Evénement "Fermeture d'une fenêtre fille de FEN_Liste_Clients"
// -------------------------------------------------------------
// Actualise la liste des clients
ZoneRépétéeAffiche(ZR_Clients, taRéExécuteRequete)

// Pour tout retour (sauf la suppression)
SI MaFenêtreFille.ValeurRenvoyée <> -1 ALORS
	nIndice est un entier
	// Recherche la ligne du client
	nIndice = ZoneRépétéeCherche(ATT_NumClient, Client.NumClient)
	SI nIndice > 0 ALORS
		// Positionne sur la ligne du client
		ZoneRépétéePosition(ZR_Clients, nIndice)
	FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Connaître la valeur renvoyée

`<Résultat> = <Elément manipulé>.ValeurRenvoyée`
---

**`<Résultat> : (Tout type)`**

Valeur qui sera renvoyée :

- à la fermeture de la fenêtre, page ou état en cours.

- si l'option du sélecteur est sélectionnée.




**`<Elément manipulé> : (Nom de fenêtre, nom de page, nom d'état, nom d'option)`**

Nom de l'élément manipulé :

- Nom de la fenêtre, de la page, de l'état ou de l'état interne manipulé. Cette fenêtre/page/état doit être ouvert.

- Nom de l'option du sélecteur. Ce nom est de la forme : &lt;Champ Sélecteur&gt;[&lt;Numéro de l'option&gt;].  





<a name="SYNTAXE2"></a>

### Modifier la valeur renvoyée 

`<Elément manipulé>.ValeurRenvoyée = <Nouvelle valeur>`
---

**`<Elément manipulé> : (Nom de fenêtre, nom de page, nom d'état, nom d'option)`**

Nom de l'élément manipulé :

- Nom de la fenêtre, de la page ou de l'état manipulé. Cette fenêtre/page/état doit être ouvert.

- Nom de l'option du sélecteur. Ce nom est de la forme &lt;Champ Sélecteur&gt;[&lt;Numéro de l'option&gt;].




**`<Nouvelle valeur> : (Tout type)`**

Nouvelle valeur à renvoyer. Les types suivants peuvent être utilisés :

- structure 

- structure dynamique

- classe

- type avancé

- tableau

- tableau associatif

- file

- pile

- liste






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 

### Connaître la valeur renvoyée par une fenêtre fille
<a name="connaitre_valeur_renvoyee_par_une_fenetre_fille_ELTPARAGRAPHE000209"></a>Dans les applications mobiles, l'ouverture des fenêtres est effectuée par la fonction [OuvreFenêtreMobile](../WDLang1/1000021018.md) (ou la fonction [OuvreFille](../WDLang1/3038021.md)) et non la fonction [Ouvre](../WDLang1/3038035.md). 

Il est possible de connaître la valeur renvoyée par une fenêtre fille dans l'événement "Fermeture d'une fenêtre fille" de la fenêtre ouvrant la fenêtre fille (celle qui a utilisé la fonction [OuvreFenêtreMobile](../WDLang1/1000021018.md) ou la fonction [OuvreFille](../WDLang1/3038021.md)).

Par exemple :

- Dans le code de fermeture de la fenêtre fille, la fonction [Ferme](../WDLang1/3038018.md) est utilisée pour renvoyer un paramètre : 
	
	```wl
	Ferme("", MonParamètre)
	```


- Dans l'événement "Fermeture d'une fenêtre fille" de la fenêtre appelante, le nom de la fenêtre fille ainsi que la valeur renvoyée peuvent être récupérés en utilisant le mot-clé [MaFenêtreFille](../Motscles/1511021.md) : 
	
	```wl
	// Fermeture d'une fenêtre fille
	NomFenêtreFille = MaFenêtreFille.Nom
	ValeurFenêtreFille = MaFenêtreFille.ValeurRenvoyée
	```




<a name="NOTE0_2"></a>


### Limites
<a name="limites_ELTPARAGRAPHE000248"></a>La propriété **ValeurRenvoyée** s'applique :

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) aux fenêtres, 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) aux options des champs Sélecteur.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) aux fenêtres internes uniquement si elles sont ouvertes avec la fonction [Ouvre](../WDLang1/3038035.md).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) aux états.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) aux états internes (en lecture uniquement).





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CalendrierPopup.gif) ***Exemples unitaires (WINDEV)*** : **Calendrier Popup** <br>Utilisation d'un calendrier utilisable avec la fonction OuvrePopup. <br>La fenêtre PopCalendrier s'avère très utile dans des applications contenant des champs date. <br>En effet, la fenêtre PopCalendrier permet de choisir une date visuellement.<br><br>Le risque d'erreur est diminué puisque l'utilisateur voit le jour de la semaine correspondant à la date sélectionnée. <br>Le champ date est alors renseigné par la valeur retournée par la fenêtre PopCalendrier.


