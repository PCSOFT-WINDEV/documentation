


## RubriqueParcourue (Propriété)

***En anglais : BrowsedItem***
	



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Pour les champs, la propriété **RubriqueParcourue** permet de :

- Connaître la rubrique utilisée pour le parcours automatique des champs liés à un fichier de données. 

- Modifier la rubrique utilisée pour le parcours automatique des champs liés à un fichier de données. Le parcours est alors réinitialisé.




Pour un état sur fichier, la propriété **RubriqueParcourue** permet de modifier la rubrique utilisée pour le parcours du fichier de données. Dans ce cas, cette propriété est utilisable uniquement dans l'événement "Ouverture" de l'état.

**Remarque** : Cette rubrique est définie lors de la création du champ ou de l'état. Cette rubrique peut être modifiée dans l'onglet "Données" de la description de l'élément.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// -- Code d'ouverture de l'état
// Changement du fichier parcouru
ETAT_Etat1.NomSource = Client 
// Nouvelle rubrique de parcours du fichier "Client"
ETAT_Etat1.RubriqueParcourue = IDClient
```


<a name="Exemple2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Tri décroissant sur les noms des sociétés
TABLE_TableClient.RubriqueParcourue = "-Société"
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Connaître la rubrique utilisée pour le parcours automatique dans un champ fichier

`<Rubrique parcourue> = <Champ manipulé>.RubriqueParcourue`
---

**`<Rubrique parcourue> : (Chaîne de caractères)`**

Nom de la rubrique utilisée pour le parcours automatique du champ spécifié. Cette rubrique appartient au fichier de données parcouru par le champ (connu ou modifié grâce à la propriété [FichierParcouru](../Proprietes/2510040.md)). 
Si le signe "-" précède le nom de la rubrique, le parcours est effectué en sens décroissant.

**`<Champ manipulé> : (Nom de champ)`**

Nom du champ à manipuler.  


<a name="SYNTAXE2"></a>

### Modifier la rubrique utilisée pour le parcours automatique dans un champ fichier

`<Champ manipulé>.RubriqueParcourue = <Nouvelle rubrique>`
---

**`<Champ manipulé> : (Nom de champ)`**

Nom du champ à manipuler.

**`<Nouvelle rubrique> : (Chaîne de caractères)`**

Nom de la nouvelle rubrique à utiliser pour le parcours automatique du champ spécifié. Cette rubrique doit appartenir au fichier de données parcouru par le champ (connu ou modifié grâce à la propriété [FichierParcouru](../Proprietes/2510040.md)). 
Si le signe "-" précède le nom de la rubrique, le parcours sera effectué en sens décroissant.  


<a name="SYNTAXE3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Connaître la rubrique utilisée pour le parcours automatique d'un état fichier

`<Rubrique parcourue> = <Etat manipulé>.RubriqueParcourue`
---

**`<Rubrique parcourue> : (Chaîne de caractères)`**

Nom de la rubrique utilisée pour le parcours automatique de l'état spécifié. Cette rubrique appartient au fichier de données parcouru par l'état (connu ou modifié grâce à la propriété [NomSource](../Proprietes/2511035.md)).

**`<Etat manipulé> : (Nom de l'état)`**

Nom de l'état sur fichier à manipuler.  


<a name="SYNTAXE4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Modifier la rubrique utilisée pour le parcours automatique d'un état fichier

`<Etat manipulé>.RubriqueParcourue = <Nouvelle rubrique>`
---

**`<Etat manipulé> : (Nom de l'état)`**

Nom de l'état sur fichier à manipuler.

**`<Nouvelle rubrique> : (Chaîne de caractères)`**

Nom de la nouvelle rubrique utilisée pour le parcours automatique de l'état spécifié. Cette rubrique doit appartenir au fichier de données parcouru par l'état (connu ou modifié grâce à la propriété [NomSource](../Proprietes/2511035.md)).  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Type de parcours
<a name="type_parcours_ELTPARAGRAPHE000128"></a>

- ***Parcours automatique*** : Le parcours du fichier de données et l'affichage des données dans le champ sont automatiques. Le développeur n'a aucun code spécifique à saisir.
	Le tri est effectué sur la rubrique de parcours définie dans l'onglet "Contenu" de la description de l'objet. Si un filtre est spécifié ("Filtre sur la rubrique de parcours" dans l'onglet "Contenu" de la description de l'objet), ce filtre est utilisé. Aucun traitement de parcours de l'objet spécifié n'est exécuté.

- ***Parcours programmé*** : Le développeur doit programmer le parcours du fichier de données et l'affichage des données dans le champ Table.
	Les traitements "Lecture du premier enregistrement", "Lecture de l'enregistrement précédent", "Lecture de l'enregistrement suivant" et "Lecture du dernier enregistrement" sont exécutés. Un parcours programmé permet un contrôle total sur l'ordre et le filtrage des enregistrements. Cependant, un parcours programmé est plus complexe et plus lent qu'un parcours automatique.



<a name="NOTE0_2"></a>


### Manipuler des champs liés à un fichier de données grâce aux propriétés
<a name="manipuler_des_champs_lies_fichier_donnees_grace_aux_proprietes_ELTPARAGRAPHE000140"></a>

- Les enregistrements affichés dans un champ lié à un fichier proviennent du fichier de données ou de la requête spécifié avec la propriété [FichierParcouru](../Proprietes/2510040.md).

- Le sens de tri est fixé par la propriété **RubriqueParcourue**.

- Un filtrage des enregistrements peut être réalisé avec la propriété [Filtre](../Proprietes/2510042.md) ou la fonction [HFiltre](../WDLang4/3044100.md).



<a name="NOTE0_3"></a>


### Modifier les propriétés liées au parcours d'un champ fichier
<a name="modifier_les_proprietes_liees_parcours_champ_fichier_ELTPARAGRAPHE000161"></a>Pour modifier les propriétés **RubriqueParcourue**, [Filtre](../Proprietes/2510042.md) et [FichierParcouru](../Proprietes/2510040.md), il est conseillé de :

1. Stopper le parcours en affectant une chaîne vide ("") à la propriété [FichierParcouru](../Proprietes/2510040.md).

2. Modifier les propriétés nécessaires.

3. Relancer le parcours avec la propriété [FichierParcouru](../Proprietes/2510040.md).


Cette méthode permet d'optimiser les modifications réalisées. En effet, chacune des modifications effectuée individuellement relance le parcours. Ces opérations peuvent vite devenir lentes sur des fichiers de données de taille importante.
<a name="NOTE0_4"></a>


### Table par programmation
<a name="table_par_programmation_ELTPARAGRAPHE000189"></a>Si un champ Table par programmation doit afficher des données provenant d'un fichier de données, d'une requête ou d'une vue :

- Créez un champ Table par programmation sous l'éditeur.

- Dans le code de votre application, indiquez la rubrique à parcourir avec la propriété **RubriqueParcourue**. Cette rubrique doit appartenir au fichier de données, à la requête ou à la vue dont les données seront affichées dans le champ Table par programmation.

- Utilisez la fonction [FichierVersTableMémoire](../WDLang1/3074005.md) pour initialiser le champ Table avec les données voulues. Les données seront triées selon la rubrique parcourue spécifiée.

- La propriété [RubriqueAffichée](../Proprietes/2510123.md) sera automatiquement initialisée.



<a name="NOTE0_5"></a>


### Champ Liste et champ Combo par programmation
<a name="champ_liste_champ_combo_par_programmation_ELTPARAGRAPHE000210"></a>Si un champ Liste ou Combo par programmation doit afficher des données provenant d'un fichier de données, d'une requête ou d'une vue :

- Créez un champ Liste ou Combo par programmation sous l'éditeur.

- Utilisez la fonction [FichierVersListeMémoire](../WDLang1/3049007.md) pour initialiser le champ Liste ou Combo avec les données voulues.

- Les propriétés [FichierParcouru](../Proprietes/2510040.md), [RubriqueAffichée](../Proprietes/2510123.md), **RubriqueParcourue** et [RubriqueMémorisée](../Proprietes/2510110.md) seront automatiquement initialisées.



<a name="NOTE0_6"></a>


### Limites
<a name="limites_ELTPARAGRAPHE000236"></a>La propriété **RubriqueParcourue** s'applique uniquement : 

- aux états dont la source de données est un fichier de données. 

- sur les champs (Liste, Table et Combo) d'une fenêtre.




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Dans les fenêtres, la propriété **RubriqueParcourue** s'applique uniquement aux champs suivants :

- Champ Table.

- Champ Table hiérarchique.

- Champ Liste. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Champ Liste image.

- Champ Combo.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Champ Agenda.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Champ Planning.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Champ Arbre.

- Champ Fenêtre interne (cas où le balayage est activé).





