


## NomSource (Propriété)

***En anglais : SourceName***
	



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
La propriété **NomSource** permet de :

- Connaître le nom de la source de données de l'état.

- Changer la source de données de l'état.




**Rappel** : le nom de la source de données de l'état peut correspondre :

- à un nom de fichier de données (cas des états basés sur un fichier de données, une vue ou une zone mémoire).

- à un nom de fichier texte (cas des états basés sur un fichier texte avec lecture automatique des enregistrements).

- à un nom de requête.

- à un champ Table présent dans une fenêtre.


La source de données d'un état peut être une requête ou un fichier de données.






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Changement du fichier de données associé à l'état 
// Passage du fichier de données Client au fichier de données Prospect
ETAT_EtatClient.NomSource = Prospect
// Changement de la vue associée à l'état. 
// Cette vue est basée sur le fichier de données Prospect.
ETAT_EtatClient.NomVue = MaVueClient84
```


<a name="Exemple2"></a>

```wl
// Changer la source de données de l'état "ETAT_EtatTableClient" 
// (Etat sur Table)
ETAT_EtatTableClient.NomSource = "FEN_MaFenêtre.TABLE_TableProspect"
```


<a name="Exemple3"></a>

```wl
// Changer la source de données de l'état "ETAT_EtatClient" 
ETAT_EtatClient.NomSource = REQ_RequêteClientParis
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Connaître le nom de la source de données d'un état

`<Résultat> = <Etat manipulé>.NomSource`
---

**`<Résultat> : (Chaîne de caractères)`**

Nom de la source de données de l'état spécifié :

- Nom du fichier de données associé à l'état. Si l'état est associé à une vue HFSQL ou à une zone mémoire, nom du fichier de base de la vue ou de la zone mémoire.

- Nom d'une requête.

- Nom du fichier texte (cas des états basés sur un fichier texte avec lecture automatique des enregistrements).

- Nom du champ Table source de l'état (sous la forme : NomFenêtre.NomTable).




**`<Etat manipulé> : (Nom d'état)`**

Nom de l'état à manipuler.  


<a name="SYNTAXE2"></a>

### Changer la source de données d'un état

`<Etat manipulé>.NomSource = <Nouvelle source de données>`
---

**`<Etat manipulé> : (Nom d'état)`**

Nom de l'état à manipuler.

**`<Nouvelle source de données> : (Chaîne de caractères)`**

Nouvelle source de données de l'état spécifié :

- Nom du fichier de données associé à l'état. Si l'état est associé à une vue HFSQL ou à une zone mémoire, nom du fichier de base de la vue ou de la zone mémoire.

- Nom d'une requête.

- Nom du fichier texte (cas des états basés sur un fichier texte avec lecture automatique des enregistrements).

- Nom du champ Table source de l'état (sous la forme : NomFenêtre.NomTable).  






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Vue HFSQL associée à un état
<a name="vue_hfsql_associee_etat_ELTPARAGRAPHE000086"></a>Lorsque l'état est basé sur une vue HFSQL, lors de la description de l'état, seul le nom du fichier de données correspondant à la vue est spécifié. Le nom de la vue utilisée est précisé lors de l'impression de l'état.

- la propriété **NomSource** permet de connaître le nom du fichier de données associé à l'état.

- la propriété [NomVue](../Proprietes/2511030.md) permet de connaître le nom de la vue HFSQL associée à l'état.




Pour plus de détails sur les états basés sur des vues HFSQL, consultez [Etat sur une vue HFSQL](../WDChamp/1011064.md).
<a name="NOTE0_2"></a>


### Zone mémoire associée à un état
<a name="zone_memoire_associee_etat_ELTPARAGRAPHE000107"></a>Lorsque l'état est basé sur une zone mémoire, lors de la description de l'état, seul le nom du fichier de données correspondant à la zone mémoire est spécifié. Le nom de la zone mémoire utilisée est précisé lors de l'impression de l'état.

- la propriété **NomSource** permet de connaître le nom du fichier de données associé à l'état. 

- la propriété [NomZoneMem](../Proprietes/2511029.md) permet de connaître le nom de la zone mémoire associée à l'état.




Pour plus de détails sur les états basés sur une zone mémoire, consultez [Etat sur une zone mémoire](../WDChamp/1011061.md).
<a name="NOTE0_3"></a>


### Requête intégrée/Requête indépendante
<a name="requete_integreerequete_independante_ELTPARAGRAPHE000128"></a>Lors de la création d'un état, deux types de requêtes peuvent être utilisés :

- ***une requête intégrée*** créée directement dans l'éditeur d'états. Cette requête interne n'est pas visible dans le projet. Le nom de cette requête est au format : "&lt;Nom de l'état&gt;$Requete". Par exemple : "EtatClient$Requete".

- ***une requête indépendante*** déjà créée dans le projet, sous l'éditeur de requêtes.



<a name="NOTE0_4"></a>


### Limites
<a name="limites_ELTPARAGRAPHE000138"></a>

- Il n'est pas possible de :

	- changer le type de la source de données. Par exemple, si la source de données est une requête, la nouvelle source de données ne peut pas être une vue.

	- changer la source de données d'un état réalisé sur un fichier de données.




- La modification de la source de données peut être effectuée uniquement dans l'événement "Ouverture" de l'état.





