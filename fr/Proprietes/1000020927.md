


## AjouteFilsDifféré (Propriété)

***En anglais : AddChildDelayed***
	



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
La propriété **AjouteFilsDifféré** indique la procédure à appeler lors du clic de déroulement d'une ligne d'un champ Arbre ou d'un champ Table hiérarchique. Cette procédure permet de ne remplir que les branches dépliées.

La procédure de remplissage du champ peut ainsi être optimisée. 

**Remarque** : Pour optimiser le remplissage des champs Arbre et Table hiérarchique fichier, il suffit de cocher l'option "Remplissage différé des sous-niveaux (plus rapide)" dans l'onglet "Contenu" de la fenêtre de description du champ. 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
sDir est une chaîne = fListeRépertoire("C:", frNonRécursif)
POUR TOUTE CHAÎNE sUnRep DE sDir SEPAREE PAR RC
	nLigne est entier = TableAjouteLigne(TABLEH_Explorer, sUnRep)
	// Si ce répertoire a des fils
	sFils est une chaîne = fListeRépertoire(sUnRep, frNonRécursif)
	SI sFils <> "" ALORS
		// Appel de la procédure AjouteRépertoire 
		// lorsque l'utilisateur clique sur [+]
		TABLEH_Explorer[nLigne].AjouteFilsDifféré = AjouteRépertoire
	FIN
FIN
```

```wl
PROCEDURE AjouteRépertoire(sIDParent est une chaîne)
nIndice est un entier

sRepParent est une chaîne = TABLEH_Explorer.COL_SansNom1[sIDParent]
sRepParent = Remplace(srepParent, TAB, fSep())
sListeRep est chaîne = fListeRépertoire(sRepParent, frNonRécursif)
nIndice = Val(sIDParent) + 1
nIndice2 est un entier = nIndice
POUR TOUTE CHAÎNE sRep DE sListeRep SEPAREE PAR RC
	sID est une chaîne = Remplace(sRep, "\", TAB)
	TableAjouteFils(TABLEH_Explorer, nIndice-1, sRep)
	sListeSousRep est une chaîne = fListeRépertoire(sRep, frNonRécursif)
	SI sListeSousRep <> "" ALORS 
		TABLEH_Explorer[nIndice2].AjouteFilsDifféré = AjouteRépertoire
	FIN
	nIndice2 = nIndice2 + 1
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE2"></a>

### Modifier la procédure à exécuter

`<Elément>.AjouteFilsDifféré = <Procédure WLangage>`
---

**`<Elément> : (Chaîne de caractères)`**

Ligne du champ Arbre ou du champ Table hiérarchique à manipuler. 

**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure WLangage à exécuter lors du clic sur l'élément. 

**Pour les champs Arbre**, la procédure est de la forme : 

```txt
PROCEDURE <Nom de la procédure>(<CheminParent> est une chaîne)
```


avec &lt;CheminParent&gt; correspondant au chemin complet de la ligne à dérouler. 

**Pour les champs Table hiérarchique**, la procédure est de la forme : 

```txt
PROCEDURE <Nom de la procédure>(<IDParent> est un entier)
```


avec &lt;IDParent&gt; correspondant au numéro de la ligne à dérouler. 

Si ce paramètre vaut chaîne vide (""), aucune procédure ne sera associée à l'élément. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Fonctionnement
<a name="fonctionnement_ELTPARAGRAPHE000054"></a>Si la propriété **AjouteFilsDifféré** correspond au nom d'une procédure : 

- un signe "+" est affiché sur la ligne dans le champ.

- la première fois que l'utilisateur essaie de dérouler la ligne (par exemple en cliquant sur le "+"), la procédure est appelée, permettant ainsi l'ajout des éléments fils. La branche est ensuite déroulée.
	Si aucun fils n'est ajouté, le "+" est supprimé de l'élément.




Une fois que la procédure a été exécutée (la branche a été remplie), la propriété **AjouteFilsDifféré** est affectée avec une chaîne vide : elle ne sera plus exécutée. 


### Cas particuliers
<a name="cas_particuliers_ELTPARAGRAPHE000072"></a>

- La procédure spécifiée sera exécutée AVANT l'événement "Enroulé, déroulé d'un noeud" du champ. 

- Lors de l'appel à la fonction [TableDéroule](../WDLang1/1000010007.md) ou [ArbreDéroule](../WDLang1/3018007.md), si la branche spécifiée possède une procédure associée par la propriété **AjouteFilsDifféré**, cette procédure sera exécutée. 

- Lors de l'appel à la fonction [TableDérouleTout](../WDLang1/1000010001.md) ou [ArbreDérouleTout](../WDLang1/3018022.md), si la branche spécifiée et/ou ses fils possèdent une procédure associée par la propriété **AjouteFilsDifféré**, cette procédure sera exécutée. 





