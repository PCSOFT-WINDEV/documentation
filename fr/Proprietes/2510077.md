


## MenuContextuel (Propriété)

***En anglais : ContextMenu***
	



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
La propriété **MenuContextuel** permet de :

- Connaître le menu contextuel personnalisé associé à un champ, une fenêtre ou une page.

- Modifier le menu contextuel personnalisé associé à un champ, une fenêtre ou une page (associer un autre menu contextuel au champ, à la fenêtre ou à la page).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Personnaliser les menus système des champs en ajoutant des options.




**Rappel** : Un menu contextuel est un menu qui peut être ouvert par l'utilisateur grâce à un clic droit de la souris. La création d'un menu contextuel est réalisée directement sous l'éditeur de fenêtres ou de pages, lors de la description du champ (onglet "UI"). La flèche située à droite du champ "Menu contextuel" permet d'éditer ou de créer un menu contextuel sous l'éditeur. Pour plus de détails sur les menu contextuels, consultez : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) [Menus contextuels dans une fenêtre](../WDChamp/1010011.md).




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) **Remarque** : Certains types de champ (champs de saisie, tables, ...) ont un menu système par défaut (affiché si aucun menu contextuel personnalisé n'est associé au champ). Ce menu système peut également être désactivé.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
```wl
// Code permettant de modifier le menu contextuel associé au bouton
// Popup1 et Popup2 sont des menus contextuels existants
SI BTN_Bouton1.MenuContextuel = "Popup1" ALORS
	BTN_Bouton1.MenuContextuel = "Popup2"
SINON
	// Remet le menu contextuel par défaut des FAA
	BTN_Bouton1.MenuContextuel = ""
FIN
```
<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
```wl
// Code d'initialisation du champ de saisie
// Ajoute le menu Popup1 à la suite du menu contextuel système du champ
// Popup1 est un menu contextuel existant
MoiMême.MenuContextuel = "+Popup1"
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Connaître le menu contextuel associé à un champ, une fenêtre ou une page

`<Menu> = <Elément>.MenuContextuel`
---

**`<Menu> : (Chaîne de caractères)`**



- Nom du menu contextuel personnalisé associé à l'objet, 

- Chaîne vide ("") si aucun menu contextuel personnalisé n'est associé à l'objet.




**`<Elément> : (Nom de champ, nom de fenêtre ou nom de page)`**

Nom de l'élément dont on veut connaître le nom du menu contextuel personnalisé : 

- Nom de champ, 

- Nom de fenêtre, 

- Nom de page.





<a name="SYNTAXE2"></a>

### Modifier le menu contextuel associé à un champ, une fenêtre ou une page

`<Elément>.MenuContextuel = <Nouveau menu>`
---

**`<Elément> : (Nom de champ, nom de fenêtre ou nom de page)`**

Nom de l'élément dont on veut modifier le menu contextuel associé : 

- Nom de champ, 

- Nom de fenêtre, 

- Nom de page.




**`<Nouveau menu> : (Chaîne de caractères ou constante)`**

Nom du menu contextuel personnalisé associé à l'objet (chaîne vide pour retrouver le menu contextuel système). 

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Pour ajouter un menu contextuel au menu système, il suffit de :

- faire précéder le nom du menu par le signe "+" (pour afficher le nouveau menu après les options du menu système).

- faire suivre le nom du menu par le signe "+" (pour afficher le nouveau menu avant les options du menu système).

- indiquer une chaîne vide ("") pour mettre le menu contextuel par défaut des FAA.




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Il est également possible d'utiliser les constantes suivantes :


|   |   |
| --- | --- |
| *MenuContextuelDésactivé* | Permet de désactiver l'affichage de tous les menus contextuels (y compris les menus contextuels système ou les menus contextuels des champs de saisie monétaires + Euro).<br><br> |
| *MenuContextuelSystème* | Permet de désactiver l'affichage des options de menu spécifiques aux FAA (Fonctionnalités Automatiques de vos Applications). Seul le menu contextuel Windows est affiché. <br>Permet également d'avoir accès aux options Unicode disponibles sur certains Windows ("Lecture de droite à gauche, Afficher les caractères de contrôle Unicode, ..."). |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Ajout d'options de menu dans le menu contextuel
<a name="ajout_options_menu_dans_menu_contextuel_ELTPARAGRAPHE000142"></a>La propriété **MenuContextuel** ne permet pas de cumuler les menus contextuels personnalisés associés à un champ. Cependant, il est possible d'ajouter des options de menu dans un menu contextuel existant grâce aux fonctions [MenuAjouteMenu](../WDLang1/1000017266.md), [MenuAjouteOption](../WDLang1/1000017262.md), ... Pour plus de détails, consultez [Fonctions de gestion des menus](../WDLang1/3038016.md).
<a name="NOTE0_2"></a>


### Menu contextuel et groupe de champs
<a name="menu_contextuel_groupe_champs_ELTPARAGRAPHE000161"></a>Il est possible d'associer un menu contextuel à un groupe de champs : tous les champs du groupe auront alors le même menu contextuel. En lecture, &lt;Résultat&gt; correspond toujours à une chaîne vide ("").
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Champ Table horizontale
<a name="champ_table_horizontale_ELTPARAGRAPHE000170"></a>Le menu contextuel système des champs Table horizontale ne contient pas les options d'export.
<a name="NOTE0_4"></a>


### Changement du menu contextuel et mémorisation des informations sur les champs Table
<a name="changement_menu_contextuel_memorisation_des_informations_sur_les_champs_table_ELTPARAGRAPHE000177"></a>Lors du changement du menu contextuel, les informations persistantes précédemment sauvegardées pour le champ Table (taille des colonnes, ...) ne sont plus disponibles. Ces informations sont ré-initialisées.
<a name="NOTE0_5"></a>


### Limites
<a name="limites_ELTPARAGRAPHE000184"></a>La propriété **MenuContextuel** s'applique uniquement aux champs d'une fenêtre (y compris aux colonnes des champs Table). Cette propriété ne peut pas être utilisée avec des menus, etc.

La propriété **MenuContextuel** ne s'applique pas aux champs suivants :

- Libellé

- Image non cliquable

- Jauge

- Forme




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La propriété **MenuContextuel** s'applique uniquement aux éléments suivants :

- Bouton.

- Champ de saisie.

- Image.

- Interrupteur.

- Sélecteur.

- Liste.

- Combo.

- Arbre.

- Onglet.

- Fenêtre.

- Colonne de champ Table.

- Superchamp.





