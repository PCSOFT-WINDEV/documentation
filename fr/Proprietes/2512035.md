
## FormuleClé (Propriété)

***En anglais : KeyExpression***
	



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
La propriété **FormuleClé** permet de paramétrer les différentes composantes d'une clé composée. Il est ainsi possible de :

- Connaître la formule d'une clé composée (définie sous l'éditeur d'analyses ou définie par programmation).

- Définir la formule d'une clé composée (lors de la description du fichier de données par programmation uniquement).







<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000002512035&name=formulecle_propriete&product=WD">Voir des exemples supplémentaires</a>

```wl
MaRub1 est une Description de Rubrique
MaRub2 est une Description de Rubrique
CléComposée est une Description de Rubrique
...
// Déclaration de la rubrique 1
MaRub1.Nom = "Rub1"
MaRub1.Type = hRubTexte
MaRub1.Taille = 20
HDécritRubrique(MonFic1, MaRub1)
// Déclaration de la rubrique 2
MaRub2.Nom = "Rub2"
MaRub2.Type = hRubTexte
MaRub2.Taille = 20
HDécritRubrique(MonFic1, MaRub2)
// Déclaration de la clé composée
CléComposée.Nom = "RubCompo"
CléComposée.FormuleClé = "Rub1+Rub2"
HDécritRubrique(MonFic1, CléComposée)
HDécritFichier(MonFic1)
HCréation(Fic_temp)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Connaître la formule d'une clé composée

`<Formule de la clé> = <Fichier de données>.<Rubrique>.FormuleClé`
---

**`<Formule de la clé> : (Chaîne de caractères)`**

Noms des différentes rubriques composant la clé composée. Ces noms de rubriques sont séparés par le caractère "+". 
Si la clé n'est pas une clé composée, seul le nom de la rubrique clé est renvoyé.

**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données manipulé. Ce nom a été défini sous l'éditeur d'analyses ou grâce au type [Description de Fichier](../WDLang4/1514065.md).

**`<Rubrique> : (Chaîne de caractères)`**

Nom de la rubrique clé manipulée. Ce nom a été défini sous l'éditeur d'analyses ou grâce au type [Description de Rubrique](../WDLang4/1514071.md).  


<a name="SYNTAXE2"></a>

### Définir la formule d'une clé composée

`<Rubrique>.FormuleClé = <Nouvelle formule>`
---

**`<Rubrique> : (Chaîne de caractères)`**

Nom de la rubrique clé manipulée. Ce nom vient d'être défini grâce au type [Description de Rubrique](../WDLang4/1514071.md).

**`<Nouvelle formule> : (Chaîne de caractères)`**

Nom des différentes rubriques composant la clé composée. Ces noms de rubriques sont séparés par le caractère "+".  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Description par programmation d'une rubrique clé composée
<a name="description_par_programmation_une_rubrique_cle_composee_ELTPARAGRAPHE000080"></a>Lors de la description par programmation d'une rubrique de type clé composée, la propriété [Type](../Proprietes/2510131.md) n'est pas obligatoire (au contraire des rubriques simples définies par programmation). Cependant, il est nécessaire de décrire la composition de la clé avec la propriété **FormuleClé**.

Pour plus de détails sur la description par programmation des rubriques, consultez [Description de rubrique](../WDLang4/1514071.md).




