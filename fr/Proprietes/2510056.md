


## ImageFond (Propriété)

***En anglais : BackgroundImage***
	



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
La propriété **ImageFond** permet de connaître et de modifier l'image de fond d'un élément : fenêtre, page, champ ou état. 

**Remarques** : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) L'image de fond d'une fenêtre ou d'un champ est définie dans la fenêtre de description de l'élément (onglet "Général" ou "Image").

- L'image de fond d'un état est définie dans la fenêtre de description de l'état (onglet "Fond"). 





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
```wl
// Modification de l'image de fond de la fenêtre "FEN_SaisieClient"
FEN_SaisieClient.ImageFond = "C:\MesImages\Image.bmp"
```

```wl
// -- Avant impression du bloc Haut_de_page
// Modification de l'image de fond de l'état
// Utiliser une page différente d'un PDF
MonEtat.ImageFondImprimée = Vrai
MonEtat.ImageFond = PDFExtraitPage("Fiche.pdf", 2)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Connaître l'image de fond d'un champ, d'une fenêtre ou d'un état

`<Image actuelle> = <Elément manipulé>.ImageFond`
---

**`<Image actuelle> : (Chaîne de caractères)`**

Nom et chemin de l'image de fond. Cette image de fond peut correspondre à :

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) L'image de fond d'une fenêtre (sauf des fenêtres de type mère MDI).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) L'image de fond de la zone MDI d'une fenêtre de type mère MDI.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) L'image associée au cadre d'un bouton.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) L'image de fond d'une jauge ou d'un potentiomètre.

- L'image de fond d'un état. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) L'image de fond d'un champ Forme.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) L'image de fond d'un champ Note repositionnable.




**`<Elément manipulé> : (Nom de champ, nom de fenêtre, nom de page ou nom d'état)`**

Nom de l'élément manipulé.  


<a name="SYNTAXE2"></a>

### Modifier l'image de fond d'un champ, d'une fenêtre ou d'un état

`<Elément manipulé>.ImageFond = <Nouvelle image>`
---

**`<Elément manipulé> : (Nom de champ, nom de fenêtre, nom de page ou nom d'état)`**

Nom de l'élément manipulé.

**`<Nouvelle image> : (Chaîne de caractères)`**

Nom et chemin (complet, relatif ou de type UNC) de la nouvelle image de fond. Cette image peut correspondre à :

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) L'image de fond d'une fenêtre (sauf des fenêtres de type mère MDI).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) L'image de fond de la zone MDI d'une fenêtre de type mère MDI.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) L'image associée au cadre d'un bouton.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) L'image de fond d'une jauge ou d'un potentiomètre.

- L'image de fond d'un état.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) L'image de fond d'un champ Forme.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) L'image de fond d'un champ Note repositionnable.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Modification de l'image
<a name="modification_image_ELTPARAGRAPHE000166"></a>Lors du changement de l'image, l'image est recherchée en premier dans la bibliothèque de l'application (fichier WDL) puis sur le disque à l'emplacement spécifié.

Remarque : Si on tente de remplacer l'image présente dans la WDL par une image de même nom présente sur le disque, le changement de l'image n'est pas réalisé.
<a name="NOTE0_2"></a>


### Modification de l'image de fond dans un état
<a name="modification_image_fond_dans_etat_ELTPARAGRAPHE000177"></a>La propriété **ImageFond** est disponible dans tous les types d'états. La propriété **ImageFond** doit être appelée avant le début de l'impression de la page, par exemple dans l'événement "Avant impression du bloc haut de page".

**Dans le cas d'un état sur formulaire** : 

- la propriété **ImageFond** remplace l'image de fond choisie en édition. Tous les types d'images gérés dans les états sont disponibles (PDF, SVG, JPG, PNG, ...). 

- l'image est sauvegardée par page : il est ainsi possible de renseigner une image de fond différente pour chaque page imprimée.

- lorsque la propriété est affectée, la nouvelle image de fond sera imprimée **à partir du prochain saut de page**.




**Dans un état autre que formulaire** : 

- l'image est dessinée en "homothétique".

- cette propriété a un effet uniquement en impression réelle, dans le visualisateur de rapports et en export PDF. Elle est sans effet pour les autres types d'exports (RTF, XLS, HTML, XML).




**Remarques** : 

- La gestion des marges spécifiée dans l'onglet "Fond" de la description de l'état (option "Ignorer les marges physiques de l'imprimante") est ignorée : les marges physiques sont systématiquement ignorées. 

- La propriété [ImageFondImprimée](../Proprietes/1000021350.md) permet d'imprimer ou non l'image de fond de l'état. Si cette propriété vaut : 

	- <u><u><u><u>Faux</u></u></u></u> (valeur par défaut), l'impression peut être faite sur du papier pré-imprimé par exemple. L'image de fond apparaît uniquement dans le visualisateur de rapports. 

	- <u><u><u><u>Vrai</u></u></u></u>, lors de l'impression réelle, l'image de fond est également imprimée (ou exportée au format PDF). 


 Remarque : L'option "Comportement en impression réelle" présente dans l'onglet "Fond" de la fenêtre de description de l'état permet également d'effectuer ce paramétrage. 



<a name="NOTE0_3"></a>


### Limites
<a name="limites_ELTPARAGRAPHE000226"></a>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Dans une fenêtre, la propriété **ImageFond** s'applique uniquement aux :

- fenêtres,

- boutons,

- jauges,

- potentiomètres, 

- états.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) champs Forme dans une fenêtre.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) champs Note repositionnable dans une fenêtre.




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La propriété **ImageFond** s'applique uniquement aux éléments suivants :

- Bouton.

- Fenêtre.





