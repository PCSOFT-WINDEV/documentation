


## Etat (Propriété)

***En anglais : State***
	



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
La propriété **Etat** permet de connaître et de modifier l'état d'affichage : 

- d'un champ d'une fenêtre, d'une page ou d'un état. 

- d'un bloc d'un état, 

- d'une fenêtre. 




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Dans une fenêtre**, la propriété **Etat** permet de connaître et de modifier l'état d'affichage :

- d'une fenêtre,

- d'un champ ou d'un groupe de champs,

- d'un champ "conteneur" (champ Onglet, Fenêtre interne, Disposition, ...)

- d'une cellule ou d'une ligne d'un champ Table,

- d'une option de menu.






![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) **Dans un état**, la propriété **Etat** permet de connaître et de modifier la visibilité d'un champ ou d'un bloc. Cette propriété est conservée uniquement par compatibilité avec WINDEV 5.5 et WEBDEV 1.5. Pour gérer la visibilité d'un champ ou d'un bloc dans un état, il est conseillé d'utiliser la propriété [Visible](../Proprietes/2510138.md).




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Le champ LIB_Libellé1 devient actif
LIB_Libellé1.Etat = Actif
```


<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Le champ SAI_Saisie1 devient actif
SAI_Saisie1.Etat = Actif
// Modification du contenu de la combo si elle est active
SI COMBO_Combo1.Etat = Actif ALORS
	COMBO_Combo1 = "<Saisir ICI>"
	DonneFocusEtRetourUtilisateur(COMBO_Combo1)
FIN
```


<a name="Exemple3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
```wl
// Grise la 4ème ligne du champ Table
TABLE_Client[4].Etat = Grisé
// Grise la 1ère cellule de la colonne 2
COL_COL2[1].Etat = Grisé
// Rend la 5ème ligne ni cliquable ni saisissable
TABLE_Client[5].Etat = AffichageSansSélection
// Rend la 2ème cellule de la colonne 3 ni cliquable ni saisissable
COL_COL3[2].Etat = AffichageSansSélection
// Rend la cellule active
COL_COL3[2].Etat = Actif
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Connaître l'état d'un élément dans une fenêtre ou l'état d'une fenêtre

`<Etat en cours> = <Nom de l'élément>.Etat`
---

**`<Etat en cours> : (Constante de type entier)`**

Etat actuel de l'objet.


|   |   |
| --- | --- |
| **Champs d'une fenêtre** |
| *Actif* | Champ actif et en saisie. |
| *AffichageSansSélection* | Pour les champs Table uniquement : Champ affiché, sans aucune saisie possible.<br><br>Dans ce cas, l'utilisateur ne pourra pas sélectionner une ligne du champ Table à l'aide de la souris ou des flèches. Une ligne pourra être sélectionnée uniquement en programmation, grâce à la fonction [TableSelectPlus](../WDLang1/3074031.md). Cette ligne sera sélectionnée grâce au bandeau de sélection. |
| *AffichageSeulement* ou *Inactif* | Champ affiché, sans aucune saisie ou action possible.<br><br>Pour les champs Table, Table hiérarchique et Zone répétée, l'utilisateur pourra sélectionner une ligne. Il sera également possible de la sélectionner par programmation (par exemple grâce à la fonction [TableSelectPlus](../WDLang1/3074031.md) pour les champs Table). |
| *Grisé* | Champ grisé. |
| **Ligne ou cellule d'un champ Table, Table hiérarchique, Liste, Liste image, Combo, Zone répétée** |
| *Actif* | Champ actif et en saisie (si le champ Table est en saisie). |
| *AffichageSansSélection* | Champ affiché, sans aucune saisie ou action possible. L'utilisateur ne pourra pas sélectionner une ligne du champ à l'aide de la souris ou des flèches. Une ligne pourra être sélectionnée uniquement en programmation (par exemple, grâce à la fonction [TableSelectPlus](../WDLang1/3074031.md) pour les champs Table). <br><br>Cette ligne sera sélectionnée grâce au bandeau de sélection. |
| *Grisé* | Champ grisé |
| ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Fonctionnalité non gérée. |
| **Fenêtres** |
| *Actif* | Fenêtre manipulable par l'utilisateur. |
| *AffichageSeulement* | Les champs de la fenêtre ne sont plus accessibles en modification. L'utilisateur pourra cependant modifier la ligne sélectionnée dans les champs Table, Table hiérarchique ou Zone répétée. La fenêtre ne peut pas être déplacée. |
| *Grisé* | Grise tous les champs de la fenêtre. |
| *HorsEcran* | Fenêtre active mais placée à des coordonnées négatives |



**`<Nom de l'élément> : (Chaîne de caractères)`**

Nom du champ, de la ligne de table, de la cellule, du groupe de champs ou de la fenêtre.  


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Modifier l'état d'un élément dans une fenêtre ou l'état d'une fenêtre

`<Nom de l'élément>.Etat = <Nouvel état>`
---

**`<Nom de l'élément> : (Chaîne de caractères)`**

Nom du champ, de la ligne de table, de la cellule, du groupe de champs ou de la fenêtre.

**`<Nouvel état> : (Constante de type entier)`**

Nouvel état de l'élément.


|   |   |
| --- | --- |
| **Champs d'une fenêtre** |
| *Actif* | Champ actif et en saisie. |
| *AffichageSansSélection* | Pour les champs Table uniquement : Champ affiché, sans aucune saisie possible.<br><br>Dans ce cas, l'utilisateur ne pourra pas sélectionner une ligne du champ Table à l'aide de la souris ou des flèches. Une ligne pourra être sélectionnée uniquement en programmation, grâce à la fonction [TableSelectPlus](../WDLang1/3074031.md). Cette ligne sera sélectionnée grâce au bandeau de sélection. |
| *AffichageSeulement ou Inactif* | Champ affiché, sans aucune saisie ou action possible.<br><br>Pour les champs Table, Table hiérarchique et Zone répétée, l'utilisateur pourra sélectionner une ligne. Il sera également possible de la sélectionner par programmation (par exemple grâce à la fonction [TableSelectPlus](../WDLang1/3074031.md) pour les champs Table). |
| *Grisé* | Champ grisé |
| **Ligne ou cellule d'un champ Table, Table hiérarchique, Liste, Liste image, Combo, Zone répétée** |
| *Actif* | Champ actif et en saisie (si le champ Table est en saisie). |
| *AffichageSansSélection* | Champ affiché, sans aucune saisie ou action possible. L'utilisateur ne pourra pas sélectionner une ligne du champ Table à l'aide de la souris ou des flèches. Une ligne pourra être sélectionnée uniquement en programmation (par exemple, grâce à la fonction [TableSelectPlus](../WDLang1/3074031.md)). <br><br>Cette ligne sera sélectionnée grâce au bandeau de sélection. |
| *Grisé* | Champ grisé. |
| **Fenêtres** |
| *Actif* | Fenêtre manipulable par l'utilisateur. |
| *AffichageSeulement* | Les champs de la fenêtre ne sont plus accessibles en modification.  L'utilisateur pourra cependant modifier la ligne sélectionnée dans les champs Table, Table hiérarchique ou Zone répétée. La fenêtre ne peut pas être déplacée. |
| *Grisé* | Grise tous les champs de la fenêtre. |
| *HorsEcran* | Fenêtre active mais placée à des coordonnées négatives. |




<a name="SYNTAXE3"></a>
<a name="SYNTAXE4"></a>




<a name="SYNTAXE5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 
### Connaître l'état d'un élément dans un état

`<Etat en cours> = <Nom de l'élément>.Etat`
---

**`<Etat en cours> : (Constante de type entier)`**

Etat actuel de l'objet.


|   |   |
| --- | --- |
| *Actif* | Champ ou bloc visible. |
| *Invisible* | Champ ou bloc invisible (il est conseillé d'utiliser la propriété [Visible](../Proprietes/2510138.md)). |



**`<Nom de l'élément> : (Chaîne de caractères)`**

Nom du champ ou du bloc d'état.  


<a name="SYNTAXE6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 
### Modifier l'état d'un élément dans un état

`<Nom de l'élément>.Etat = <Nouvel état>`
---

**`<Nom de l'élément> : (Chaîne de caractères)`**

Nom du champ ou du bloc d'état.

**`<Nouvel état> : (Constante de type entier)`**

Nouvel état actuel de l'objet.


|   |   |
| --- | --- |
| *Actif* | Champ ou bloc visible. |
| *Invisible* | Champ ou bloc invisible (il est conseillé d'utiliser la propriété [Visible](../Proprietes/2510138.md)). |









<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Etat (Editeur d'états) : Champ/bloc visible ou invisible
<a name="etat_editeur_etats_champbloc_visible_invisible_ELTPARAGRAPHE000405"></a>Dans un état, l'état d'un champ ou d'un bloc se limite à être visible ou non. Pour gérer la visibilité d'un champ, il est conseillé d'utiliser la propriété [Visible](../Proprietes/2510138.md). Cette propriété optimise la gestion de la visibilité des champs.
<a name="NOTE0_2"></a>


### Etat d'un groupe de champs
<a name="etat_groupe_champs_ELTPARAGRAPHE000415"></a>

- Connaître l'état d'un groupe de champs : l'état renvoyé correspond à l'état du premier champ du groupe.

- Modifier l'état d'un groupe de champs : tous les champs du groupe sont modifiés et correspondent au nouvel état.



<a name="NOTE0_3"></a>


### Etat d'une colonne d'un champ Table
<a name="etat_une_colonne_champ_table_ELTPARAGRAPHE000423"></a>Si la propriété **Etat** est appliquée à une colonne d'un champ Table, c'est toute la colonne qui change d'état (et non pas une cellule de la colonne uniquement). 

Attention : la propriété **Etat** permet uniquement de restreindre l'état de la colonne défini dans la fenêtre de description. Par exemple, si la colonne est en affichage, il n'est pas possible de rendre une cellule de la colonne 'en saisie'.
<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Onglets et champs d'un volet d'onglet
<a name="onglets_champs_volet_onglet_ELTPARAGRAPHE000440"></a>L'état d'un champ présent dans un volet d'onglet dépend de l'état du volet d'onglet :

- Si le volet n'est pas sélectionné, le champ est invisible.

- Si le volet est sélectionné et invisible, le champ est invisible.

- Si le volet est sélectionné et grisé, le champ est grisé.

- Si le volet est sélectionné et inactif, le champ est inactif.

- Si le volet est sélectionné et actif, le champ peut être actif, inactif, grisé ou invisible.



<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Boîte à outils et champs d'un volet
<a name="boite_outils_champs_volet_ELTPARAGRAPHE000455"></a>L'état d'un champ présent dans un volet de la boîte à outils dépend de l'état du volet:

- Si le volet n'est pas sélectionné, le champ est invisible.

- Si le volet est sélectionné et invisible, le champ est invisible.

- Si le volet est sélectionné et grisé, le champ est grisé.

- Si le volet est sélectionné et inactif, le champ est inactif.

- Si le volet est sélectionné et actif, le champ peut être actif, inactif, grisé ou invisible.



<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Champs Sélecteur/Interrupteur et leurs options
<a name="champs_selecteurinterrupteur_leurs_options_ELTPARAGRAPHE000470"></a>Il est possible de modifier l'état du champ ou uniquement d'une option du champ Sélecteur/Interrupteur. Une option peut être active ou grisée.

- Pour modifier l'état d'un champ Sélecteur : 
	
	```txt
	SEL_Select1.Etat = Grisé
	```


- Pour modifier l'état d'une option d'un champ Sélecteur : 
	
	```txt
	SEL_Select1[2].Etat = Grisé
	```





**Attention** : L'état d'une option dépend de l'état du champ Sélecteur. Ainsi, si les opérations suivantes sont effectuées :

1. Une option est grisée.

2. Le champ Sélecteur/Interrupteur est grisé.

3. Le champ Sélecteur/Interrupteur redevient actif. L'option est toujours grisée.



<a name="NOTE0_7"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Champ actif rendu ou non invisible
<a name="champ_actif_rendu_non_invisible_ELTPARAGRAPHE000492"></a>Un champ (actif, grisé, en affichage) peut être rendu invisible avec la propriété [Visible](../Proprietes/2510138.md).

Lorsque le champ est invisible il perd toutes les caractéristiques de son état précédent : le champ est invisible et ne peut pas être utilisé. La seule manière d'exécuter son code est d'utiliser la fonction [ExécuteTraitement](../WDLang1/3013031.md). En particulier, il est impossible d'utiliser les lettres d'appel d'un champ invisible. Par exemple, un bouton actif rendu invisible ne fonctionne pas via l'utilisation des lettres d'appel.

Pour retrouver l'état précédent du champ, il suffit de ré-utiliser la propriété [Visible](../Proprietes/2510138.md).
<a name="NOTE0_8"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Options de menu
<a name="options_menu_ELTPARAGRAPHE000514"></a>La propriété **Etat** permet de définir si l'option de menu est Active ou grisée. Pour définir si l'option de menu est visible, utilisez la propriété [Visible](../Proprietes/2510138.md).


<a name="NOTE0_9"></a>


### Limites
<a name="limites_ELTPARAGRAPHE000536"></a>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) La propriété **Etat** n'a aucun effet sur les états créés avec l'éditeur d'états.![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La propriété **Etat** s'applique uniquement aux éléments suivants :

- Bouton.

- Libellé.

- Champ de saisie.

- Image.

- Interrupteur.

- Sélecteur.

- Liste.

- Combo.

- Arbre.

- Onglet.

- Fenêtre.

- Table.

- Colonne de table.

- Superchamp.


![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) La propriété **Etat** est sans effet sur les champs HTML. 


