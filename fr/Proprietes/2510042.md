


## Filtre (Propriété)

***En anglais : Filter***
	



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
La propriété **Filtre** permet de connaître et de modifier le filtre utilisé pour l'affichage des enregistrements dans : 

- les champs Table fichier,

- les champs Table hiérarchique fichier, 

- les champs Liste fichier, 

- les champs Combo fichier, 

- les champs Zone répétée fichier. 




Ce filtre (s'il existe) peut être défini lors de la description du champ (onglet "Contenu").
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Filtre.gif)
Ce filtre (propriété **Filtre** ou filtre saisi sous l'éditeur) a les caractéristiques suivantes :

- filtre du type "Commence par".

- s'applique uniquement à la rubrique de parcours.

- a une influence sur l'objet manipulé (champ Table, Combo, Liste ou Liste image)

- n'a pas d'influence sur le fichier de données sur lequel est basé l'objet (sauf pour les champs Table fichier, voir ci-dessous).




Remarques :

- Pour utiliser un filtre sur une clé composée, il est conseillé d'utiliser la fonction [HFiltre](../WDLang4/3044100.md).

- La propriété **Filtre** ne permet pas de connaître les filtres utilisateur définis (par exemple avec la fonction [TableActiveFiltre](../WDLang1/1000017149.md)).





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// -- Code à chaque modification d'un champ Combo
// Mise à jour des éléments du champ Combo en fonction
// des lettres saisies dans le champ de saisie du champ Combo
COMBO_Elément.Filtre = COMBO_Elément
```
<a name="Exemple2"></a>

```wl
// Identifie la condition de filtre sur la clé de parcours Ville
SI TABLE_Client.Filtre = "" ALORS
	TABLE_Client.Filtre = "PARIS"
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Connaître le filtre défini sur la rubrique de parcours

`<Valeur du filtre> = <Champ manipulé>.Filtre`
---

**`<Valeur du filtre> : (Type du filtre)`**

Valeur actuelle du filtre défini sur la rubrique de parcours. Ce filtre est du type "Commence par".

**`<Champ manipulé> : (Nom de champ)`**

Nom du champ dont on veut connaître le filtre en cours : ce filtre a été défini soit par la propriété **Filtre**, soit directement sous l'éditeur de fenêtres ou de pages (dans la description du champ). Ce champ doit être un champ de type : 

- Liste ou Liste image fichier, 

- Combo fichier, 

- Table ou Table hiérarchique fichier, 

- Zone répétée fichier.  





<a name="SYNTAXE2"></a>

### Modifier le filtre défini sur la rubrique de parcours

`<Champ manipulé>.Filtre = <Nouvelle valeur du filtre>`
---

**`<Champ manipulé> : (Nom de champ)`**

Nom du champ dont on veut modifier le filtre en cours. Ce champ doit être un champ de type : 

- Liste ou Liste image fichier, 

- Combo fichier, 

- Table ou Table hiérarchique fichier, 

- Zone répétée fichier.    




**`<Nouvelle valeur du filtre> : (Type du filtre)`**



- Nouvelle valeur du filtre défini sur la clé de parcours, 

- Chaîne vide ("") pour aucun filtre.  






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Propriété Filtre et champs Table fichier
<a name="propriete_filtre_champs_table_fichier_ELTPARAGRAPHE000100"></a>Pour les champs Table fichier, la case à cocher "Utiliser la fonction HFiltre pour parcourir le fichier" permet de conserver les options de recherche et de tri sur les colonnes filtrées (loupe, ...).

Si l'option "Utiliser la fonction HFiltre pour parcourir le fichier" est cochée :

- la propriété n'est plus appliquée uniquement au champ Table mais également au fichier de données sur lequel est basé le champ. Un parcours effectué ensuite sur le fichier de base du champ sera donc filtré.

- Un filtre (fonction [HFiltre](../WDLang4/3044100.md)) est automatiquement appliqué au fichier de données sur lequel est basé le champ Table.

- Si un filtre est défini sur le fichier de données (fonction [HFiltre](../WDLang4/3044100.md)) AVANT d'afficher le champ Table (fonction [TableAffiche](../WDLang1/3074003.md) par exemple), seul le filtre du champ Table sera pris en compte. Le parcours du fichier de données sera ensuite réalisé selon le filtre du champ Table.



<a name="NOTE0_2"></a>


### Manipulation des champs Table, Liste, Liste image, Combo et Zone répétée fichier grâce aux propriétés
<a name="manipulation_des_champs_table_liste_liste_image_combo_zone_repetee_fichier_grace_aux_proprietes_ELTPARAGRAPHE000130"></a>

- Les enregistrements affichés dans un champ Liste, Table, Combo ou Zone répétée fichier proviennent du fichier de données ou de la requête spécifié avec la propriété [FichierParcouru](../Proprietes/2510040.md).

- Le sens de tri est fixé par la propriété [RubriqueParcourue](../Proprietes/2510111.md).

- Un filtrage des enregistrements peut être réalisé grâce à la propriété **Filtre** ou à la fonction [HFiltre](../WDLang4/3044100.md). **Attention** : la propriété **Filtre** permet uniquement un filtrage du type "Commence par" sur la clé de parcours.



<a name="NOTE0_3"></a>


### Modification des propriétés liées au parcours d'un champ Table, Liste, Liste image, Combo ou Zone répétée fichier
<a name="modification_des_proprietes_liees_parcours_champ_table_liste_liste_image_combo_zone_repetee_fichier_ELTPARAGRAPHE000154"></a>Pour modifier plusieurs des propriétés [RubriqueParcourue](../Proprietes/2510111.md), **Filtre** et [FichierParcouru](../Proprietes/2510040.md), il est conseillé de :

1. Stopper le parcours en affectant une chaîne vide ("") à la propriété [FichierParcouru](../Proprietes/2510040.md).

2. Modifier les propriétés nécessaires.

3. Relancer le parcours avec la propriété [FichierParcouru](../Proprietes/2510040.md).


Cette méthode permet d'optimiser les modifications réalisées. En effet, chacune des modifications effectuée individuellement relance le parcours. Ces opérations peuvent vite devenir lentes sur des fichiers de taille importante.
<a name="NOTE0_4"></a>


### Limite
<a name="limite_ELTPARAGRAPHE000182"></a>La propriété **Filtre** s'applique uniquement aux champs d'une fenêtre ou d'une page. Cette propriété s'applique uniquement aux champs suivants :

- Champ Liste fichier,

- Champ Liste image fichier,

- Champ Combo fichier,

- Champ Table fichier, 

- Champ Zone répétée fichier, 

- Champ Table hiérarchique fichier.





## Composante :
wd280.dll
