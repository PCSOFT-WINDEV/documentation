


## OptionsCurseur (Propriété)

***En anglais : CursorOptions***
	



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
La propriété **OptionsCurseur** permet de gérer le type de curseur utilisé lors d'une connexion (Connecteurs Natifs, OLE DB, ...). Il est possible de :

- Connaître le type de curseur utilisé pour une connexion (Connecteurs Natifs, OLE DB, ...).

- Définir le type de curseur utilisé pour la connexion  (Connecteurs Natifs, OLE DB, ...). Dans ce cas, si la connexion est actuellement ouverte, elle sera fermée, puis ré-ouverte avec les nouveaux paramètres lors d'un premier accès à un fichier utilisant cette connexion.




**Remarques** :

- La connexion peut correspondre :

	- soit à une connexion décrite sous l'éditeur d'analyses,

	- soit à une connexion décrite avec les fonctions [HConnecte](../WDLang4/3044263.md), [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

	- soit à une connexion décrite avec une variable de type [Connexion](../WDLang4/1514073.md).




- En HFSQL Client/Serveur, les curseurs ne sont pas pris en compte.





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MaConnexion est une Connexion
// Description de la connexion
MaConnexion.Utilisateur = "USER"
MaConnexion.MotDePasse = "PASSWORD"
MaConnexion.Serveur = "MONSERVEUR" 
MaConnexion.BaseDeDonnées = "Base de données"
MaConnexion.Provider = hAccèsHFClientServeur
MaConnexion.Accès = hOLectureEcriture
MaConnexion.InfosEtendues = "Infos étendues"
MaConnexion.OptionsCurseur = hCurseurServeur

HOuvreConnexion(MaConnexion)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Connaître le type de curseur

`<Type de curseur> = <Connexion manipulée>.OptionsCurseur`
---

**`<Type de curseur> : (Constante de type Entier)`**

Renvoie le type de curseur utilisé. Ce paramètre peut correspondre à une ou plusieurs des constantes suivantes :


|   |   |
| --- | --- |
| **Emplacement des curseurs** |
| *hCurseurClient* | Curseur géré par le MDAC. Offre souvent plus de fonctionnalités qu'un curseur serveur. Un curseur client est obligatoirement un curseur statique. |
| *hCurseurServeur* | Curseur géré par la base de données. Ce curseur peut répercuter facilement les changements effectués par d'autres utilisateurs sur les données. |
| **Type de curseur** |
| *hCurseurDynamique* | Curseur offrant de nombreuses fonctionnalités, mais consommant beaucoup de mémoire. Ce curseur autorise tous les types de déplacement. Il permet d'accéder à toutes les modifications, ajouts et suppressions réalisées par les autres utilisateurs. |
| *hCurseurForwardOnly* | Curseur rapide et consommant peu de mémoire. Le déplacement se fait du premier enregistrement au dernier. Les données modifiées par les autres utilisateurs ne sont pas visibles. |
| *hCurseurOpenKeySet* | Curseur manipulant un jeu d'enregistrements figé. Seules des clés correspondant à l'enregistrement sont stockées et non les enregistrements (peu de ressources mémoire utilisées). Les enregistrements supprimés ne sont plus accessibles. Les modifications réalisées par les autres utilisateurs sont visibles (mais pas les ajouts). |
| *hCurseurStatique* | Récupère une copie de tous les enregistrements de la requête en mémoire (consommation mémoire importante). Tous les types de déplacement sont autorisés. |
| **Modes de blocage** |
| *hCurseurLectureSeule* | Le jeu d'enregistrements manipulé ne pourra pas être modifié. |
| *hCurseurOptimiste* | L'enregistrement n'est verrouillé que lors de sa mise à jour |
| *hCurseurPessimiste* | L'enregistrement est verrouillé dès son édition pour être modifié. |


**Remarque** : Si aucune constante n'a été spécifiée dans la fonction [HDécritConnexion](../WDLang4/3044205.md) ou dans la connexion, ce paramètre vaut 0.

**Attention** : Tous les providers OLE DB ou les Connecteurs Natifs ne gèrent pas tous les types de curseur.

**`<Connexion manipulée> : (Chaîne de caractères ou variable de type Connexion)`**

Nom de la connexion manipulée. Ce nom a été défini :

- soit sous l'éditeur d'analyses,

- soit avec les fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md),

- soit avec le type [Connexion](../WDLang4/1514073.md).  





<a name="SYNTAXE2"></a>

### Modifier le type de curseur

`<Connexion manipulée>.OptionsCurseur = <Type de curseur>`
---

**`<Connexion manipulée> : (Chaîne de caractères ou variable de type Connexion)`**

Nom de la connexion manipulée. Ce nom a été défini :

- soit sous l'éditeur d'analyses,

- soit avec les fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md),

- soit avec le type [Connexion](../WDLang4/1514073.md). 




**`<Type de curseur> : (Constante de type Entier)`**

Renvoie le type de curseur utilisé. Ce paramètre peut correspondre à une ou plusieurs des constantes suivantes :

   | --- |
| --- |
| **Emplacement des curseurs** |
| *hCurseurClient* | Curseur géré par le MDAC. Offre souvent plus de fonctionnalités qu'un curseur serveur. Un curseur client est obligatoirement un curseur statique. |
| *hCurseurServeur* | Curseur géré par la base de données. Ce curseur peut répercuter facilement les changements effectués par d'autres utilisateurs sur les données. |
| **Type de curseur** |
| *hCurseurDynamique* | Curseur offrant de nombreuses fonctionnalités, mais consommant beaucoup de mémoire. Ce curseur autorise tous les types de déplacement. Il permet d'accéder à toutes les modifications, ajouts et suppressions réalisées par les autres utilisateurs. |
| *hCurseurForwardOnly* | Curseur rapide et consommant peu de mémoire. Le déplacement se fait du premier enregistrement au dernier. Les données modifiées par les autres utilisateurs ne sont pas visibles. |
| *hCurseurOpenKeySet* | Curseur manipulant un jeu d'enregistrements figé. Seules des clés correspondant à l'enregistrement sont stockées et non les enregistrements (peu de ressources mémoire utilisées). Les enregistrements supprimés ne sont plus accessibles. Les modifications réalisées par les autres utilisateurs sont visibles (mais pas les ajouts). |
| *hCurseurStatique* | Récupère une copie de tous les enregistrements de la requête en mémoire (consommation mémoire importante). Tous les types de déplacement sont autorisés. |
| **Modes de blocage** |
| *hCurseurLectureSeule* | Le jeu d'enregistrements manipulé ne pourra pas être modifié. |
| *hCurseurOptimiste* | L'enregistrement n'est verrouillé que lors de sa mise à jour |
| *hCurseurPessimiste* | L'enregistrement est verrouillé dès son édition pour être modifié. |


**Attention** : Tous les providers OLE DB ou les Connecteurs Natifs ne gèrent pas tous les types de curseur.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
La propriété [CxOptionsCurseur](../Proprietes/2512042.md) permet de connaître le type de curseur utilisé lors d'une connexion. Cette propriété est conservée par compatibilité. Il est conseillé d'utiliser la propriété **OptionsCurseur**.


