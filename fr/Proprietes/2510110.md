


## RubriqueMémorisée (Propriété)

***En anglais : StoredItem***
	



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
La propriété **RubriqueMémorisée** permet de :

- Connaître la rubrique mémorisée ou la variable mémorisée d'un champ Table, Zone répétée, Liste ou Combo.

- Modifier la rubrique mémorisée ou la variable mémorisée d'un champ Table, Zone répétée, Liste ou Combo.




**Remarques** :

- La rubrique mémorisée est utilisée pour les champs associés à un fichier de données ou une requête. La variable mémorisée est utilisée pour les champs associés à une variable.

- La rubrique mémorisée ou la variable mémorisée est définie sous l'éditeur de fenêtres ou sous l'éditeur de pages dans l'onglet "Contenu" de la description du champ.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=RubriqueMemorisee.gif)










<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Modifier la rubrique mémorisée du champ "TABLE_TableClient"
TABLE_TableClient.RubriqueMémorisée = "NomClient"
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Connaître la rubrique/variable mémorisée d'un champ

`<Rubrique/variable mémorisée> = <Champ manipulé>.RubriqueMémorisée`
---

**`<Rubrique/variable mémorisée> : (Chaîne de caractères)`**



- Nom de la rubrique mémorisée du champ spécifié. Cette rubrique appartient au fichier de données parcouru par le champ (connu ou modifié grâce à la propriété [FichierParcouru](../Proprietes/2510040.md)).

- Nom de la variable mémorisée du champ spécifié. Ce nom est de la forme ":&lt;préfixe&gt;&lt;Nom de la variable&gt;" ou ":&lt;Nom de la variable&gt;" (le préfixe est présent uniquement si la charte de programmation est activée dans le projet).
	Cette variable appartient à la variable parcourue par le champ (connu ou modifié grâce à la propriété [FichierParcouru](../Proprietes/2510040.md)).

- Chaîne vide ("") si aucune rubrique/variable mémorisée n'est associée au champ.




**`<Champ manipulé> : (Nom de champ)`**

Nom du champ à manipuler : 

- Champ Table, 

- Champ Liste, 

- Champ Combo.   





<a name="SYNTAXE2"></a>

### Modifier la rubrique/variable mémorisée d'un champ

`<Champ manipulé>.RubriqueMémorisée = <Nouvelle rubrique/variable>`
---

**`<Champ manipulé> : (Nom de champ)`**

Nom du champ à manipuler : 

- Champ Table, 

- Champ Liste, 

- Champ Combo. 




**`<Nouvelle rubrique/variable> : (Chaîne de caractères)`**



- Nom de la nouvelle rubrique mémorisée du champ spécifié. Cette rubrique doit appartenir au fichier de données parcouru par le champ (connu ou modifié grâce à la propriété [FichierParcouru](../Proprietes/2510040.md)).

- Nom de la nouvelle variable mémorisée du champ spécifié. Ce nom est de la forme ":&lt;préfixe&gt;&lt;Nom de la variable&gt;" ou ":&lt;Nom de la variable&gt;". Le préfixe doit être précisé si la charte de programmation est activée dans le projet (que les préfixes soient affichés ou non).
	Cette variable appartient à la variable parcourue par le champ (connu ou modifié grâce à la propriété [FichierParcouru](../Proprietes/2510040.md)).

- Chaîne vide ("") si aucune rubrique/variable mémorisée ne doit être associée au champ.  






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Propriété Valeur
<a name="propriete_valeur_ELTPARAGRAPHE000115"></a>La propriété **RubriqueMémorisée** modifie la valeur retournée par la propriété [Valeur](../Proprietes/2510130.md).

Deux cas distincts se présentent : 

- Le champ Liste (ou champ Table) est un champ manipulé par programmation OU la propriété **RubriqueMémorisée** correspond à une chaîne vide (""). La propriété [Valeur](../Proprietes/2510130.md) permet de :

	- Connaître la ligne sélectionnée. Si aucune ligne n'est sélectionnée, la propriété [Valeur](../Proprietes/2510130.md) retourne -1. Si le champ Liste (ou le champ Table) est multisélection, le numéro de la dernière ligne sélectionnée est renvoyé.

	- Déplacer la sélection en indiquant le numéro de la nouvelle ligne à sélectionner. La ou les lignes précédemment sélectionnées sont dé-sélectionnées.
			**Pour connaître la ligne sélectionnée**, les syntaxes suivantes sont équivalentes : 
			
		```txt
		ResLigne = <Champ Liste ou champ Table>.Valeur
		ResLigne = <Champ Liste ou champ Table>
		```





- Le champ Liste (ou champ Table) est un champ lié à un fichier de données ET la propriété **RubriqueMémorisée** n'est pas une chaîne vide (""). La propriété [Valeur](../Proprietes/2510130.md) permet de connaître la rubrique mémorisée pour l'enregistrement associé à la ligne sélectionnée. Si aucune ligne n'est sélectionnée, la propriété [Valeur](../Proprietes/2510130.md) retourne une chaîne vide ("").
	**Pour connaître la rubrique mémorisée associée à la ligne sélectionnée**, les syntaxes suivantes sont équivalentes :
	
	```txt
	ResRubMem = <Champ Liste ou champ Table>.Valeur
	ResRubMem = <Champ Liste ou champ Table>.RubriqueMémorisée
	```




<a name="NOTE0_2"></a>


### Propriété LiaisonFichier
<a name="propriete_liaisonfichier_ELTPARAGRAPHE000162"></a>La propriété **RubriqueMémorisée** est souvent utilisée en association avec la propriété [LiaisonFichier](../Proprietes/2510060.md). Cette association permet de créer une liaison automatique entre deux fichiers de données lors de l'appel des fonctions [FichierVersEcran](../WDLang4/3044210.md) et [EcranVersFichier](../WDLang4/3044146.md).
<a name="NOTE0_3"></a>


### Champ Table par programmation
<a name="champ_table_par_programmation_ELTPARAGRAPHE000181"></a>Si un champ Table par programmation doit afficher des données provenant d'un fichier de données, d'une requête ou d'une vue :

- Créez un champ Table par programmation sous l'éditeur de fenêtres ou sous l'éditeur de pages.

- Dans le code, indiquez la rubrique à parcourir avec la propriété [RubriqueParcourue](../Proprietes/2510111.md). Cette rubrique doit appartenir au fichier de données, à la requête ou à la vue dont les données seront affichées dans le champ Table par programmation.

- Dans le code, indiquez la rubrique à mémoriser avec la propriété **RubriqueMémorisée**. Cette rubrique doit appartenir au fichier de données, à la requête ou à la vue dont les données seront affichées dans le champ Table par programmation.

- Utilisez la fonction [FichierVersTableMémoire](../WDLang1/3074005.md) pour initialiser le champ Table avec les données voulues. Les données seront triées selon la rubrique parcourue spécifiée.

- La propriété [RubriqueAffichée](../Proprietes/2510123.md) sera automatiquement initialisée.



<a name="NOTE0_4"></a>


### Champ Liste par programmation
<a name="champ_liste_par_programmation_ELTPARAGRAPHE000206"></a>Si un champ Liste par programmation ou un champ Combo par programmation doit afficher des données provenant d'un fichier de données, d'une requête ou d'une vue :

- Créez un champ Liste par programmation ou le champ Combo par programmation sous l'éditeur de fenêtres ou sous l'éditeur de pages.

- Utilisez la fonction [FichierVersListeMémoire](../WDLang1/3049007.md) pour initialiser le champ avec les données voulues.

- Les propriétés [FichierParcouru](../Proprietes/2510040.md), [RubriqueAffichée](../Proprietes/2510123.md), [RubriqueParcourue](../Proprietes/2510111.md) et **RubriqueMémorisée** seront automatiquement initialisées.



<a name="NOTE0_5"></a>


### Recherche et sélection d'un élément présent dans un champ Liste fichier ou dans un champ Combo fichier
<a name="recherche_selection_element_present_dans_champ_liste_fichier_dans_champ_combo_fichier_ELTPARAGRAPHE000232"></a>Pour rechercher et/ou sélectionner un élément présent dans un champ Liste fichier ou dans un champ Combo fichier, il est conseillé d'utiliser la syntaxe suivante :

```wl
LISTE_ListeCommande.RubriqueMémorisée = "IDClient"
// Recherche et sélection de l'élément dont le IDClient est "135"
LISTE_ListeCommande = 135
// Si l'élément recherché n'est pas trouvé, LISTE_ListeCommande vaudra -1
```

<a name="NOTE0_6"></a>


### Limites
<a name="limites_ELTPARAGRAPHE000242"></a>La propriété **RubriqueMémorisée** s'applique uniquement aux champs suivants :

- champ Table,

- champ Liste,

- champ Combo,

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) champ Liste image,





