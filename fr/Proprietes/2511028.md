


## ODBCCodeSQL (Propriété)

***En anglais : ODBCSQLCode***
	



<a name="XPresentation"></a>
<a name="Presentation"></a>


### Qu'est-ce qu'une requête réalisée sur une connexion ? 
<a name="questce_quune_requete_realisee_sur_une_connexion_ELTPARAGRAPHE000010"></a>Une [requête réalisée sur une connexion](../WDChamp/1011066.md) est une requête réalisée sur des fichiers de données manipulés via un driver ODBC spécifique ou via un Connecteur Natif.

Lors de la création de la connexion, il est possible de définir : 

- le nom de la connexion

- le nom de la source de données

- le nom de l'utilisateur et son mot de passe

- le nom de la base de données accédée (s'il en existe plusieurs). 


L'éditeur d'états permet d'imprimer des données provenant d'une requête réalisée sur une connexion. Tous les paramètres de la connexion à utiliser peuvent être définis directement dans l'éditeur d'états ou par programmation grâce aux propriétés du WLangage. 
<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
La propriété **ODBCCodeSQL** permet de :

- Connaître le code SQL de la "requête réalisée sur une connexion" source de l'état. Cette requête est réalisée sur un ou plusieurs fichiers de données accessibles via un driver ODBC spécifique ou via un Connecteur Natif. Cette requête a été définie lors de la création de l'état.

- Modifier le code SQL de la "requête réalisée sur une connexion" source de l'état.




**Remarque** : Cette propriété doit être utilisée dans le code d'ouverture de l'état.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// -- Code d'ouverture de l'état
ETAT_Etat1.ODBCNomConnexion = "MaConnexion"
ETAT_Etat1.ODBCCodeSQL = "Select * from Produits"
ETAT_Etat1.ODBCNomUtilisateur = "DUPUIS"
ETAT_Etat1.ODBCMotDePasse = "PSW"
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Connaître le code de la "Requête réalisée sur une connexion"

`<Résultat> = <Etat manipulé>.ODBCCodeSQL`
---

**`<Résultat> : (Chaîne de caractères)`**

Texte de la requête SQL à exécuter sur la base de données accédée via un driver ODBC spécifique ou via un Connecteur Natif. Cette requête doit être une requête de sélection (de type SELECT).

**`<Etat manipulé> : (Nom d'état)`**

Nom de l'état à manipuler.  


<a name="SYNTAXE2"></a>

### Modifier le code de la "Requête réalisée sur une connexion"

`<Etat manipulé>.ODBCCodeSQL = <Nouveau code SQL>`
---

**`<Etat manipulé> : (Nom d'état)`**

Nom de l'état à manipuler.

**`<Nouveau code SQL> : (Chaîne de caractères)`**

Code SQL de la requête à exécuter. Ce code doit être reconnu par la base de données manipulée. Cette requête doit être une requête de sélection (de type SELECT).  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Propriétés permettant de gérer les états sur des fichiers de données accédés via un driver ODBC ou via un Connecteur Natif
<a name="proprietes_permettant_gerer_les_etats_sur_des_fichiers_donnees_accedes_via_driver_odbc_via_connecteur_natif_ELTPARAGRAPHE000066"></a>Les différentes propriétés permettant de manipuler les états sur des fichiers de données accédés via un driver ODBC ou via un Connecteur Natif sont les suivantes :


|   |   |
| --- | --- |
| **ODBCCodeSQL** | Permet de connaître et de modifier le code SQL de la requête réalisée sur une base de données accédée via un driver ODBC ou via un Connecteur Natif. |
| [ODBCMotDePasse](../Proprietes/2511031.md) | Permet de connaître et de modifier le mot de passe associé à l'utilisateur autorisé à accéder à une base de données via un driver ODBC ou via un Connecteur Natif. |
| [ODBCNomBase](../Proprietes/2511034.md) | Permet de connaître et de modifier le nom de la base utilisée par la requête réalisée sur une base de données accédée via un driver ODBC ou via un Connecteur Natif. |
| [ODBCNomConnexion](../Proprietes/2511033.md) | Permet de connaître et de modifier le nom de la connexion utilisée pour manipuler une base de données accédée via un driver ODBC ou via un Connecteur Natif. |
| [ODBCNomUtilisateur](../Proprietes/2511019.md) | Permet de connaître et de modifier le nom de l'utilisateur autorisé à accéder à une base de données via un driver ODBC ou via un Connecteur Natif. |


<a name="NOTE0_2"></a>


### Limite
<a name="limite_ELTPARAGRAPHE000098"></a>La propriété **ODBCCodeSQL** s'applique uniquement aux états basés sur une "requête réalisée sur une connexion".


