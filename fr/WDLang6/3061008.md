
## GraveurInfoMédia (Fonction)

***En anglais : BurnerMediaInfo***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère les caractéristiques du CD/DVD présent dans le graveur en cours. Ce graveur peut être sélectionné grâce à la fonction [GraveurSélectionne](../WDLang6/3061012.md).

**Remarques** :

- Lors de l'appel de la fonction **GraveurInfoMédia**, le graveur doit être inactif. Pour connaître l'état actuel du graveur, utilisez la fonction [GraveurEtat](../WDLang6/3061007.md).

- Pour connaître l'ensemble des graveurs disponibles à partir du poste en cours, utilisez la fonction [GraveurListe](../WDLang6/3061009.md).



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Etat du graveur
SI GraveurEtat() = GraveurInactif ALORS
	// Caractéristiques du CD
	ResType est un entier
	ResTailleLibre est un entier
	ResNbreSession est un entier
	ResType = GraveurInfoMédia(médiaType)
	ResTailleLibre = GraveurInfoMédia(médiaTailleLibre)
	ResNbreSession = GraveurInfoMédia(médiaNombreSessions)
 
	Info("Le CD est de type : " + ResType, ...
			"Il reste " + ResTailleLibre + " blocs libres", ...
			"Le CD contient " + ResNbreSession + " sessions")
SINON
	// Le graveur est utilisé. Il n'est pas possible de
	// connaître les caractéristiques du CD
	Info("Le graveur est en cours d'utilisation")
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = GraveurInfoMédia(<Type de caractéristique>)`
---

**`<Résultat> : (Constante de type Entier)`**



- Caractéristique demandée, 

- -1 en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*. 




Cette fonction nécessite la présence d'un CD ou DVD dans le graveur.

Si le paramètre &lt;Type de caractéristique&gt; correspond à :

- *médiaFormat* : Format du CD ou du DVD : 
	


|   |   |
| --- | --- |
| *médiaFormat_BD_R* | Disque Blu-Ray enregistrable. |
| *médiaFormat_BD_RE* | Disque Blu-Ray réinscriptible. |
| *médiaFormat_BD_ROM* | Disque Blu-Ray en lecture seule. |
| *médiaFormat_DVD_R_HD* | DVD haute définition enregistrable. |
| *médiaFormat_DVD_RAM* | DVD RAM. |
| *médiaFormat_DVD_RAM_HD* | DVD RAM haute définition. |
| *médiaFormat_DVD_ROM* | DVD en lecture seule. |
| *médiaFormat_DVD_ROM_HD* | DVD haute définition en lecture seule. |
| *médiaFormat_DVDmoinsR* | Disque DVD -R enregistrable. |
| *médiaFormat_DVDmoinsR_DL* | Disque DVD -R enregistrable double couche. |
| *médiaFormat_DVDmoinsRW* | Disque DVD -R réinscriptible. |
| *médiaFormat_DVDplusR* | Disque DVD +R enregistrable. |
| *médiaFormat_DVDplusR_DL* | Disque DVD +R enregistrable double couche. |
| *médiaFormat_DVDplusRW* | Disque DVD +R réinscriptible. |
| *médiaFormat_DVDplusRW_DL* | Disque DVD +R réinscriptible double couche |
| *médiaFormat_Inutilisable* | CD dont le format est inutilisable. |
| *médiaFormat_R* | CD de format CD-R (CD non réinscriptible). |
| *médiaFormat_RW* | CD de format CD-RW (CD réinscriptible). |



- *médiaNombreSessions* : Nombre de sessions du CD.

- *médiaTailleLibre* : Espace libre (en blocs) sur le CD.
	Si le CD est un CD gravé de type audio, &lt;Résultat&gt; sera égal à 0.

- *médiaTailleTotale* : Espace total (en blocs) sur le CD.
	Si le CD est un CD gravé de type audio, &lt;Résultat&gt; sera égal à 0.

- *médiaTailleUtilisée* : Espace utilisé (en blocs) sur le CD.
	Si le CD est un CD gravé de type audio, &lt;Résultat&gt; sera égal à 0.

- *médiaType* : Type du CD :
	


|   |   |
| --- | --- |
| *médiaType_CD_EXTRA* | CD de type données et audio |
| *médiaType_CD_I* | CD de type données, audio et vidéo |
| *médiaType_CD_ROM_XA* | CD de type données |
| *médiaType_CDDA_CDROM* | CD de type audio |
| *médiaType_Inconnu* | Autre type de CD |



- *médiaVierge* : 

	- <u><u><u><u>Vrai</u></u></u></u> si le CD est vierge, 

	- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.







**`<Type de caractéristique> : (Constante de type Entier)`**

Type de caractéristique à récupérer :


|   |   |
| --- | --- |
| *médiaFormat* | Format du CD ou DVD |
| *médiaNombreSessions* | Nombre de sessions du CD ou DVD |
| *médiaTailleLibre* | Espace libre (en blocs) sur le CD ou DVD.<br>Si le CD est un CD gravé de type audio, &lt;Résultat&gt; sera égal à 0. |
| *médiaTailleTotale* | Espace total (en blocs) sur le CD ou DVD.<br>Si le CD est un CD gravé de type audio, &lt;Résultat&gt; sera égal à 0. |
| *médiaTailleUtilisée* | Espace utilisé (en blocs) sur le CD ou DVD.<br>Si le CD est un CD gravé de type audio, &lt;Résultat&gt; sera égal à 0. |
| *médiaType* | Type du CD ou DVD |
| *médiaVierge* | CD ou DVD vierge |







<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Bloc
<a name="bloc_ELTPARAGRAPHE000215"></a>

- La taille d'un CD ou DVD est donnée en bloc.

- Un bloc correspond à 2048 octets sur un CD ou DVD de type donnée, à 2352 octets sur un CD de type audio.

- Une seconde sur le CD ou DVD correspond à 75 blocs.





<a name="NOTE0_2"></a>




### CD gravé de type audio
<a name="grave_type_audio_ELTPARAGRAPHE000226"></a>Si le CD présent dans le graveur en cours correspond à un CD gravé de type audio, il n'est pas possible de connaître l'espace libre, l'espace total ou l'espace utilisé sur ce CD (constante *médiaTailleLibre*, *médiaTailleTotale*, *médiaTailleUtilisée*).

Les DVD de type audio ne sont pas gérés.


<a name="NOTE0_3"></a>




### Configuration nécessaire 
<a name="configuration_necessaire_ELTPARAGRAPHE000237"></a>

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) La gravure de CD est disponible uniquement sous Windows XP et supérieur. La gravure de DVD est disponible sous Windows Vista, et sous Windows XP en utilisant la mise à jour KB932716 pour Windows XP (cette mise à jour doit être téléchargée depuis le site de Microsoft et installée car elle n'est pas prise en compte par le mécanisme de Live Update). 



<a name="XComposante"></a>

## Composante :
wd280grv.dll
