


## GraveurEnregistre (Fonction)

***En anglais : BurnerSave***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Grave les fichiers présents dans la compilation sur le CD ou le DVD.

Lors de la gravure, la fonction **GraveurEnregistre** appelle régulièrement une procédure spécifique écrite en WLangage. Cette procédure permet de gérer les différents événements rencontrés lors de la gravure.

**Remarques** :

- Après l'appel de la fonction **GraveurEnregistre**, la compilation en cours est automatiquement supprimée.

- L'utilisation de cette fonction n'est pas bloquante. Pour savoir si la gravure est terminée, utilisez la procédure WLangage appelée régulièrement par la fonction **GraveurEnregistre**.



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003061006&name=graveurenregistre_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Gravure réelle du CD
// Le tiroir du graveur s'ouvrira automatiquement à la fin de la gravure
ResGravure est un booléen 
ResGravure = GraveurEnregistre(graveurEjecteAuto, ProcGravureCD)
// Pour visualiser cet exemple en totalité, cliquez sur le lien "Exemple"
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = GraveurEnregistre(<Options de gravure> [, <Procédure WLangage> [, <Pointeur>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la gravure des fichiers du CD ou DVD a été lancée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).
	Pour savoir si la gravure est terminée, testez l'événement rencontré dans la procédure &lt;Nom de la procédure&gt;.




Remarque : Il est nécessaire qu'un CD ou DVD soit présent dans le graveur. Ce CD/DVD doit contenir assez d'espace pour graver une nouvelle session.

**`<Options de gravure> : (Constante ou combinaison de constantes de type Entier)`**

Option de gravure des fichiers sur le CD ou le DVD :


|   |   |
| --- | --- |
| *graveurEjecteAuto* | Ouvre le tiroir du graveur à la fin de la gravure. |
| *graveurFinalise* | Finalise le média : toute écriture ultérieure sur le média sera interdite. <br>Remarque :  Les médias réinscriptibles peuvent tout de même être effacés puis réutilisés. |
| *graveurSansEjecter* | N'ouvre pas le tiroir du graveur à la fin de la gravure. |
| *graveurSimule* | Simule la gravure du CD ou du DVD. Toutes les étapes de la gravure sont réalisées sauf la gravure effective des fichiers sur le CD/DVD. |


Par défaut, les fichiers sont réellement gravés sur le CD/DVD (pas de simulation) et le tiroir du graveur ne s'ouvre pas à la fin de la gravure.

**`<Procédure WLangage> : (Nom de procédure optionnel)`**

Nom de la procédure WLangage ("callback") appelée régulièrement lors de la gravure. Cette procédure permet de gérer les différents événements rencontrés.
Cette procédure est de la forme :

```txt
PROCEDURE <Nom de la procédure>(<Événement rencontré>, <Message événement>, 
	<Pointeur de la procédure>, <Paramètre 1>, <Paramètre 2>)
```
Les paramètres de cette procédure sont optionnels.
Il n'est pas nécessaire de passer des paramètres à cette procédure. En effet, ces paramètres sont renseignés automatiquement à chaque fichier traité.

**`<Pointeur> : (Entier optionnel)`**

Pointeur passé à la procédure &lt;Nom de la procédure&gt;.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Procédure permettant de gérer les différents événements rencontrés
<a name="procedure_permettant_gerer_les_differents_evenements_rencontres_ELTPARAGRAPHE000096"></a>La fonction **GraveurEnregistre** appelle régulièrement la procédure &lt;Nom de la procédure&gt;. Cette procédure permet de gérer les différents événements rencontrés lors de la gravure. Cette procédure est une procédure locale ou globale.

Cette procédure doit être déclarée de la façon suivante :

```txt
PROCEDURE <Nom de la procédure>(<Événement rencontré>, <Message événement>, 
	<Pointeur de la procédure>, <Paramètre 1>, <Paramètre 2>)
```


- &lt;Événement rencontré&gt; est une constante qui indique le type d'événement rencontré.

- &lt;Message événement&gt; est une chaîne de caractères contenant le message correspondant à l'événement rencontré.

- &lt;Pointeur de la procédure&gt; est un entier qui vaut la valeur passé dans le paramètre &lt;Pointeur&gt; de la fonction **GraveurEnregistre**. Si le paramètre &lt;Pointeur&gt; n'est pas précisé, &lt;Pointeur&gt; vaut 0.

- &lt;Paramètre 1&gt;, &lt;Paramètre 2&gt; sont des entiers qui contiennent une valeur spécifique à l'événement rencontré.




Voici les différentes valeurs pouvant être prises :

| Événement | &lt;Événement rencontré&gt; | &lt;Message événement&gt; | &lt;Paramètre 1&gt; | &lt;Paramètre 2&gt; |
| --- | --- | --- | --- | --- |
| Annulation de la gravure | *graveurNotificationAbandon* | "" | 0 | 0 |
| Erreur détectée | *graveurNotificationErreur* | Message d'erreur | Code de l'erreur rencontrée | 0 |
| Fermeture du CD/DVD | *graveurNotificationFermetureCD* | "" | Durée (en secondes) de la fermeture du CD/DVD | 0 |
| Gravure terminée | *graveurNotificationFinGravure* | Message d'erreur si &lt;Paramètre 1&gt; différent de 0, chaîne vide ("") dans le cas contraire | Code de retour, 0 si aucune erreur | 0 |
| Gravure d'un bloc | *graveurNotificationGravureBloc* | "" | Rang du bloc en cours | Nombre total de blocs à graver |
| Gravure d'une piste | *graveurNotificationGravurePiste* | "" | Rang de la piste en cours | Nombre total de pistes à graver |
| Préparation de la gravure | *graveurNotificationPrépareGravure* | "" | Durée (en secondes) de la préparation de la gravure | 0 |
| Autre événement | ** | Message de l'événement | Rang de l'étape en cours | Nombre total d'étapes à réaliser |


Pour récupérer la valeur du &lt;Pointeur de la procédure&gt;, affectez la valeur du &lt;Pointeur de la procédure&gt; à la valeur du &lt;Pointeur&gt; dans la procédure avec la fonction [Transfert](../WDLang1/3014015.md).

**Remarque** : Les paramètres de cette procédure sont optionnels : il est possible par exemple de ne spécifier que l'événement et le message.
<a name="NOTE0_2"></a>


### Sessions et pistes
<a name="sessions_pistes_ELTPARAGRAPHE000219"></a>Les CD/DVD sont divisés en sessions et en pistes. Une session correspond à l'ensemble des fichiers gravés au cours de la même gravure. Une piste correspond à un fichier. Une session peut contenir une ou plusieurs pistes.

Chaque gravure sur le même CD/DVD génère une nouvelle session sur le CD/DVD.

**Remarque** : Dans le cas d'un CD/DVD de type audio, certains lecteurs de CD/DVD peuvent lire uniquement les pistes de la première session.
<a name="NOTE0_3"></a>


### Compilation
<a name="compilation_ELTPARAGRAPHE000230"></a>Une compilation correspond à l'ensemble des fichiers à graver sur un CD ou un DVD. Cette compilation sera prise en compte lors du prochain appel de la fonction **GraveurEnregistre**.

Une compilation est automatiquement créée lors du premier appel de la fonction [GraveurAjouteFichier](../WDLang6/3061001.md) ou de la fonction [GraveurAjouteRépertoire](../WDLang6/3061002.md). Une seule compilation à la fois peut être créée.

Une compilation est automatiquement supprimée :

- soit lors du changement du type du CD/DVD à graver (fonction [GraveurTypeMédia](../WDLang6/3061013.md)).

- soit lors de la sélection du graveur utilisé par défaut (fonction [GraveurSélectionne](../WDLang6/3061012.md)).

- soit après l'appel de la fonction **GraveurEnregistre** (uniquement si la gravure a été lancée, &lt;Résultat&gt; à <u><u><u><u>Vrai</u></u></u></u>).

- soit lors de l'annulation de la gravure (fonction [GraveurAnnuleGravure](../WDLang6/3061003.md)).

- soit lors de la fermeture de l'application WINDEV ou du site WEBDEV en cours.



<a name="NOTE0_4"></a>


### CD/DVD gravé de type audio
<a name="cddvd_grave_type_audio_ELTPARAGRAPHE000272"></a>Il n'est pas possible de graver une compilation sur un CD/DVD de type audio déjà gravé.
<a name="NOTE0_5"></a>


### Configuration nécessaire 
<a name="configuration_necessaire_ELTPARAGRAPHE000279"></a>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) La gravure de CD est disponible uniquement sous Windows XP et supérieur. La gravure de DVD est disponible sous Windows Vista, et sous Windows XP en utilisant la mise à jour KB932716 pour Windows XP (cette mise à jour doit être téléchargée depuis le site de Microsoft et installée car elle n'est pas prise en compte par le mécanisme de Live Update).   

<a name="XComposante"></a>

## Composante :
wd280grv.dll
