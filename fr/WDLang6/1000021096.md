
## gpwActiveUtilisateur (Fonction)

***En anglais : gpwActivateUser***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Valide la création d'un nouvel utilisateur dans la base de données du groupware utilisateur en activant l'utilisateur.

Selon le mode de validation des nouveaux utilisateurs paramétré dans la page d'administration, il est possible : 

- soit d'envoyer un email à l'utilisateur pour lui demander de cliquer sur un lien qui validera son inscription, 

- soit de valider l'utilisateur directement. 





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Valeurs du nouvel utilisateur
clUtilisateur est un gpwUtilisateur
clUtilisateur.Email = SAI_Email
clUtilisateur.Login = SAI_Login
clUtilisateur.MotDePasse = SAI_MotPasse
clUtilisateur.Nom = SAI_Nom
clUtilisateur.Prénom = SAI_Prenom
clUtilisateur.Téléphone = SAI_Telephone

// Ajout de l'utilisateur
SI gpwAjouteUtilisateur(clUtilisateur) = Faux ALORS
	Info("Impossible d'ajouter l'utilisateur.")
	RETOUR
FIN

// Activation de l'utilisateur
SELON gpwActiveUtilisateur(clUtilisateur.Login)
	// Pour une activation par email
	CAS gpwActivationParEmail
		PopupAffiche(POPUP_ValidationInscription)
		
	// Pour une activation immédiate
	CAS gpwActivationImmédiate
		// Connecte directement l'utilisateur
		gpwConnecteUtilisateur(clUtilisateur.Login, clUtilisateur.MotDePasse)
		// Affiche la popup de confirmation
		PopupAffiche(POPUP_ConfirmationInscription)
		
	AUTRE CAS
		Info("Impossible d'activer l'utilisateur.")
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = gpwActiveUtilisateur(<Identifiant>)`
---

**`<Résultat> : (Constante de type Entier)`**

Résultat de l'activation : 


|   |   |
| --- | --- |
| *gpwActivationImmédiate* | L'utilisateur est immédiatement activé. |
| *gpwActivationParEmail* | L'utilisateur est activé par email. Un email lui est automatiquement envoyé (les caractéristiques de l'email ont été définies dans la page d'administration). |
| *gpwErreur* | Erreur d'activation. |



**`<Identifiant> : (Chaîne de caractères)`**

Login ou email de l'utilisateur. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>.

<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280gpu.dll
