
## Récupérer des documents provenant de périphériques Twain
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000141"></a>
WINDEV met à votre disposition des fonctions permettant de récupérer des documents à partir d'un périphérique Twain. Twain est une norme de dialogue avec les périphériques d'acquisition d'images.

Exemples de périphériques supportant la norme Twain :

- scanneur,

- web caméra,

- appareil photographique numérique.




Lors de l'installation d'un périphérique Twain, des DLL spécifiques sont installées : les DLL gérant la couche Twain. Ces DLL sont nécessaires à l'utilisation des [fonctions Twain](../WDLang6/3078001.md) du WLangage.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Définition
<a name="definition_ELTTEXTE000165"></a>


### Quel document est récupéré ?
<a name="quel_document_est_recupere_ELTPARAGRAPHE000030"></a>Lors de l'utilisation des [fonctions Twain](../WDLang6/3078001.md), le document récupéré correspond par exemple :

- soit au document présent dans un scanneur.

- soit à l'image retransmise par une "web caméra".

- soit à la première photographie sauvegardée dans un appareil photographique numérique.
	**Remarque** : Si l'interface utilisateur est utilisée, le document récupéré correspondra à la photographie sélectionnée par l'utilisateur. Si plusieurs photographies sont sélectionnées, seule la première photographie sélectionnée sera récupérée.





<a name="NOTE2_2"></a>


### Interface utilisateur
<a name="interface_utilisateur_ELTPARAGRAPHE000047"></a>Les fonctions de récupération d'un document permettent :

- soit de programmer entièrement la récupération du document.

- soit de lancer directement l'interface utilisateur du périphérique Twain utilisé. L'interface utilisateur correspond à la fenêtre principale du logiciel associé au périphérique Twain. Cette interface permet par exemple d'enregistrer le document, de modifier les paramètres par défaut du périphérique, ... Les différentes actions proposées dépendent du périphérique utilisé.






<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Principe d'utilisation
<a name="principe_utilisation_ELTTEXTE000195"></a>


### Récupérer un document provenant d'un périphérique Twain
<a name="recuperer_document_provenant_peripherique_twain_ELTPARAGRAPHE000060"></a>Pour récupérer un document provenant d'un périphérique Twain :

1. Déterminez si nécessaire le périphérique Twain à utiliser :
	


|   |   |
| --- | --- |
| [TwainListeSource](../WDLang6/3078005.md) | Liste les drivers des périphériques Twain connectés au poste en cours. |
| [TwainSelectSource](../WDLang6/3078013.md) | Affiche une boîte de dialogue standard listant les différents périphériques Twain disponibles sur le poste en cours. |
| [TwainSourceEnCours](../WDLang6/3078015.md) | Permet de connaître et de changer le périphérique Twain utilisé par défaut. |

2. Si le périphérique Twain utilisé correspond à un scanneur, il est possible de définir la zone à scanner à l'aide de la fonction [TwainZoneScan](../WDLang6/3078014.md).

3. Récupérez la largeur et la hauteur du document à récupérer (par un périphérique Twain).
	


|   |   |
| --- | --- |
| [TwainHauteurSource](../WDLang6/3078003.md) | Renvoie la hauteur (en millimètres) du document récupéré par un périphérique Twain. |
| [TwainLargeurSource](../WDLang6/3078004.md) | Renvoie la largeur (en millimètres) du document récupéré par un périphérique Twain. |

4. Récupérez le document provenant d'un périphérique Twain.
	


|   |   |
| --- | --- |
| [TwainVersBMP](../WDLang6/3078010.md) | Permet d'effectuer une des actions suivantes :<br><br>	- enregistrer directement le document provenant du périphérique Twain dans un fichier Bitmap (extension ".BMP").<br><br>	- visualiser le document provenant du périphérique Twain dans l'interface utilisateur du périphérique. <br><br>	- enregistrer directement en mémoire au format Bitmap (dans un buffer) le document provenant du périphérique Twain.<br><br><br> |
| [TwainVersChamp](../WDLang6/3078008.md) | Permet : <br><br>	- soit de visualiser le document provenant du périphérique Twain dans un champ de type Image.<br><br>	- soit de visualiser le document provenant du périphérique Twain dans l'[interface utilisateur du périphérique](../WDLang6/3078007.md).<br><br><br> |
| [TwainVersGIF](../WDLang6/3078012.md) | Permet :<br><br>	- soit d'enregistrer directement le document provenant du périphérique Twain dans un fichier GIF.<br><br>	- soit de visualiser le document provenant du périphérique Twain dans l'[interface utilisateur du périphérique](../WDLang6/3078007.md).<br><br>	- soit d'enregistrer directement en mémoire au format GIF (dans un buffer) le document provenant du périphérique Twain.<br><br><br> |
| [TwainVersJPEG](../WDLang6/3078009.md) | Permet :<br><br>	- soit d'enregistrer directement le document provenant du périphérique Twain dans un fichier JPEG.<br><br>	- soit de visualiser le document provenant du périphérique Twain dans l'[interface utilisateur du périphérique](../WDLang6/3078007.md).<br><br>	- soit d'enregistrer directement en mémoire au format JPEG (dans un buffer) le document provenant du périphérique Twain.<br><br><br> |
| [TwainVersPDF](../WDLang6/1000020877.md) | Permet :<br><br>	- soit d'enregistrer directement le document provenant du périphérique Twain dans un fichier PDF.<br><br>	- soit de visualiser le document provenant du périphérique Twain dans l'[interface utilisateur du périphérique](../WDLang6/3078007.md). <br><br>	- soit d'enregistrer directement en mémoire au format PDF (dans un buffer) le document provenant du périphérique Twain.<br><br><br> |
| [TwainVersPressePapier](../WDLang6/3078011.md) | Permet :<br><br>	- soit de copier le document provenant du périphérique Twain dans le presse-papiers.<br><br>	- soit de visualiser le document provenant du périphérique Twain dans l'[interface utilisateur du périphérique](../WDLang6/3078007.md).<br><br><br> |
| [TwainVersTIFF](../WDLang6/1000020875.md) | Permet :<br><br>	- soit d'enregistrer directement le document provenant du périphérique Twain dans un fichier TIFF.<br><br>	- soit de visualiser le document provenant du périphérique Twain dans l'[interface utilisateur du périphérique](../WDLang6/3078007.md). <br><br>	- soit d'enregistrer directement en mémoire au format TIFF (dans un buffer) le document provenant du périphérique Twain.<br><br><br> |




Remarque : Ces fonctions permettent également de lancer directement l'interface utilisateur du périphérique Twain utilisé. Il est possible de préciser si le scanner doit utiliser le mode "recto-verso".


<a name="NOTE3_2"></a>


### Gestion des scanneurs recto-verso
<a name="gestion_des_scanneurs_rectoverso_ELTPARAGRAPHE000084"></a>Si le scanneur gère le recto-verso, il est possible de réaliser un scan recto-verso. Le document généré contient le recto et le verso du document scanné.

Remarque : Suivant le matériel utilisé, le driver Twain peut ne pas suffire pour pouvoir scanner en recto-verso. Il peut être nécessaire d'installer des drivers supplémentaires fournis par le constructeur.


### Fonctionnement dans des applications 64 bits
<a name="fonctionnement_dans_des_applications_64_bits_ELTPARAGRAPHE000359"></a>Dans une application 64 bits, cette fonction utilisera automatiquement le driver Twain 64 bits. Si ce driver n'est pas installé, le périphérique TWAIN ne pourra pas être manipulé. 






- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=TWAIN_lanumerisation.gif) ***Exemples unitaires (WINDEV)*** : **TWAIN : la numérisation** <br>Utilisation d'un périphérique Twain (scanner, appareil photo numérique, etc...) :<br>- Sélectionner le périphérique utilisé<br>- Numériser un document sous forme de fichier BMP, GIF ou JPEG<br>- Numériser un document et l'afficher dans un champ Image<br>- Numériser un document et le stocker dans le presse-papiers
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDPhotocopieur.gif) ***Composants (WINDEV)*** : **WD Photocopieur** <br>Le composant Photocopieur permet de réaliser des photocopies de documents à l'aide d'un scanner et d'une imprimante. Pour que le composant fonctionne, il faut que le scanner soit compatible Twain, ce qui est le cas pour la plupart d'entre eux.<br>L'utilisateur a la possibilité d'utiliser ce composant en deux modes :<br>- Avec affichage d'une interface permettant de régler quelques paramètres tels que la luminosité, le nombre de copie.<br>- Sans interface. Par défaut ce sont les paramètres du poste utilisé. Il est bien évidemment possible de passer des paramètres personnalisés




