


## TwainVersPressePapier (Fonction)

***En anglais : TwainToClipboard***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet :

- soit de copier le document provenant du périphérique Twain dans le presse-papiers.

- soit de visualiser le document provenant du périphérique Twain dans l'[interface utilisateur du périphérique](../WDLang6/3078007.md). L'utilisateur pourra effectuer une des actions proposées par cette interface (par exemple : enregistrement du document, modification des paramètres par défaut du périphérique). Les différentes actions proposées dépendent du périphérique utilisé.
	Lors de la validation de l'interface utilisateur, le document provenant du périphérique Twain sera copié dans le presse-papiers. Les paramètres spécifiés dans l'interface utilisateur seront pris en compte.



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Copie la 1ère photographie sauvegardée dans l'appareil photographique numérique
// dans le presse-papiers
// La photographie sera enregistrée en noir et blanc 
SI TwainVersPressePapier(Faux, TwainNoirBlanc) = Vrai ALORS
	Info("La photographie a été copiée vers le presse-papiers")
SINON
	Erreur("La photographie n'a pas pu être copiée")
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = TwainVersPressePapier([<Interface utilisateur> [, <Type d'image> [, <Nombre de bits par pixel> [, <Résolution de l'image> [, <Contraste de l'image> [, <Brillance de l'image> [, <Mode recto-verso>]]]]]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le document a été copié dans le presse-papiers, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Le message d'erreur correspondant peut être connu avec la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Interface utilisateur> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> (valeur par défaut), si l'interface utilisateur du périphérique Twain doit être affichée,

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Type d'image> : (Constante ou combinaison de constantes de type entier (optionnelle))`**

Type d'image utilisé pour enregistrer le document (classé par ordre de gestion des couleurs) :


| Ordre de gestion des couleurs |   |   |
| --- | --- | --- |
|   | 0 (Valeur par défaut) | Image par défaut du périphérique |
| 1 | *TwainPalette* | Image à couleurs issues d'une palette. |
| 2 | *TwainRVB* | Image RVB. |
| 3 | *TwainNiveauGris* | Image en niveau de gris. |
| 4 | *TwainNoirBlanc* | Image en noir et blanc. |
| - | *TwainToutType* | Image de n'importe quel type. |


Si ces constantes sont combinées, le meilleur type d'image supporté par le périphérique sera sélectionné (selon l'ordre de gestion des couleurs). Pour plus de détails, consultez [les remarques](#NOTE0_2).

Le type d'image par défaut du périphérique sera utilisé :


- si ce paramètre n'est pas précisé ou correspond à 0.

- si le type d'image spécifié n'est pas supporté par le périphérique.

- si le paramètre &lt;Interface utilisateur&gt; vaut <u><u><u><u>Vrai</u></u></u></u>.




**`<Nombre de bits par pixel> : (Entier optionnel)`**

Quantité d'informations sur les couleurs (pour afficher ou imprimer chaque pixel dans une image). Plus le nombre de bits (d'informations) par pixel est important, plus la représentation des couleurs sera précise. 
Les valeurs possibles de ce paramètre dépendent du type d'image utilisé :


| Type de l'image | Valeurs possibles |
| --- | --- |
| Image à couleurs issues d'une palette (constante *TwainPalette*) | 1, 4 ou 8 |
| Image RVB (constante *TwainRVB*) | 8, 10 ou 16 |
| Image en niveau de gris (constante *TwainNiveauGris*) | 8 ou 16 |
| Image en noir et blanc (constante *TwainNoirBlanc*) | 1 |


Si ce paramètre n'est pas précisé, le nombre de bits par pixel par défaut du périphérique sera utilisé.

**`<Résolution de l'image> : (Réel optionnel)`**

Nombre de pixels par pouce (valeurs possibles selon le périphérique utilisé). 
La résolution de l'image par défaut du périphérique sera utilisée :


- si ce paramètre n'est pas précisé ou correspond à 0.

- si la résolution spécifiée n'est pas supportée par le périphérique.

- si le paramètre &lt;Interface utilisateur&gt; vaut <u><u><u><u>Vrai</u></u></u></u>.




**`<Contraste de l'image> : (Réel optionnel)`**

Contraste de l'image (valeur comprise entre -1000 et 1000). 
Le contraste de l'image par défaut du périphérique sera utilisé :


- si ce paramètre n'est pas précisé ou correspond à 0.

- si le contraste spécifié n'est pas supporté par le périphérique.

- si le paramètre &lt;Interface utilisateur&gt; vaut <u><u><u><u>Vrai</u></u></u></u>.




**`<Brillance de l'image> : (Réel optionnel)`**

Brillance de l'image (valeur comprise entre -1000 et 1000). 
La brillance de l'image par défaut du périphérique sera utilisée :


- si ce paramètre n'est pas précisé ou correspond à 0.

- si la brillance spécifiée n'est pas supportée par le périphérique.

- si le paramètre &lt;Interface utilisateur&gt; vaut <u><u><u><u>Vrai</u></u></u></u>.




**`<Mode recto-verso> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> pour scanner un document en mode recto-verso, 

- <u><u><u><u>Faux</u></u></u></u> (par défaut) pour scanner le document d'un seul côté.  






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Document provenant du périphérique Twain
<a name="document_provenant_peripherique_twain_ELTPARAGRAPHE000191"></a>Le "document provenant du périphérique Twain" correspond par exemple :

- soit au document présent dans un scanneur au moment de l'appel de la fonction **TwainVersPressePapier**. Dans ce cas, les paramètres spécifiés grâce à la fonction [TwainZoneScan](../WDLang6/3078014.md) sont pris en compte.

- soit à l'image retransmise par une "web caméra" au moment de l'appel de la fonction **TwainVersPressePapier**.

- soit à la première photographie sauvegardée dans un appareil photographique numérique.
	**Remarque** : Si l'[interface utilisateur](../WDLang6/3078007.md) est utilisée, le document récupéré correspondra à la photographie sélectionnée par l'utilisateur. Si plusieurs photographies sont sélectionnées, seule la première photographie sélectionnée sera récupérée.



<a name="NOTE0_2"></a>


### Gestion du type d'image
<a name="gestion_type_image_ELTPARAGRAPHE000216"></a>Si plusieurs constantes sont combinées dans le paramètre &lt;Type d'image&gt;, le meilleur type d'image supporté par le périphérique sera sélectionné (selon l'ordre de gestion des couleurs).

Par exemple : Si ce paramètre correspond à *TwainNoirBlanc* + *TwainRVB*, le type de l'image sera :

- RVB, si ce type est supporté par le périphérique.

- noir et blanc, dans le cas contraire.



<a name="NOTE0_3"></a>


### Scanneur recto-verso
<a name="scanneur_rectoverso_ELTPARAGRAPHE000228"></a>Si le scanneur gère le recto-verso, il est possible de réaliser un scan recto-verso. Le document généré contient le recto et le verso du document scanné.

**Remarque** : Suivant le matériel utilisé, le driver Twain peut ne pas suffire pour pouvoir scanner en recto-verso. Il peut être nécessaire d'installer des drivers supplémentaires fournis par le constructeur.


### Scanneur multipages avec chargeur
<a name="scanneur_multipages_avec_chargeur_ELTPARAGRAPHE000369"></a>Si le scanneur dispose d'un chargeur et gère le multipages, il est possible de réaliser un scan de toutes les pages à la suite.

Pour avoir plus de détails sur la procédure à suivre et un exemple de scan multipages, consultez [TwainEtat](../WDLang6/3078002.md).


### Fonctionnement dans des applications 64 bits
<a name="fonctionnement_dans_des_applications_64_bits_ELTPARAGRAPHE000385"></a>Dans une application 64 bits, cette fonction utilisera automatiquement le driver Twain 64 bits. Si ce driver n'est pas installé, le périphérique TWAIN ne pourra pas être manipulé. 

<a name="XComposante"></a>

## Composante :
wd280std.dll
