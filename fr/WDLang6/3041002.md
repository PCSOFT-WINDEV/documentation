


## gpwOuvre (Fonction)

***En anglais : gpwOpen***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ouvre la fenêtre ou la page de login du groupware utilisateur.

**Remarque** : Cette fonction est nécessaire uniquement si le groupware utilisateur a été intégré avec l'option "Lancement manuel". Si l'option "Lancement automatique" a été choisie, cette fonction est ignorée.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ouvre la fenêtre de login du groupware utilisateur
nRes est un entier = gpwOuvre("c:\GpwUtilisateur")
// Si le login a échoué 
SI nRes <> gpwOk ALORS 
	SELON nRes 
		CAS gpwAnnulation : Info("Vous avez cliqué sur le bouton Annuler.")
		CAS gpwErreur : Erreur("Erreur à l'initialisation du groupware.")
		CAS gpwUtilisateurInconnu : Erreur("Utilisateur inconnu.")
		CAS gpwMotPasseInvalide : Erreur("Mot de passe invalide.")
	FIN 
	FinProgramme()
FIN 
// Récupération du prénom de l'utilisateur 
Prénom est une chaîne = gpwRecupInfoUtilisateur(gpwInfoPrénom)
Info("Bienvenue" + Prénom)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
### Syntaxe du nouveau groupware utilisateur

`<Résultat> = gpwOuvre([<Répertoire des fichiers du groupware>])`
---

**`<Résultat> : (Constante de type Entier)`**

Résultat de l'ouverture de la fenêtre/page de login.



|   |   |
| --- | --- |
| *gpwAnnulation* | L'utilisateur a cliqué sur le bouton "Annuler" de la fenêtre de login du Groupware. |
| *gpwErreur* | Une erreur est survenue. Pour obtenir le détail, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md). |
| *gpwMotDePasseInvalide* | Le mot de passe n'est pas valide. Il ne correspond pas au mot de passe de l'utilisateur décrit dans la base de données du groupware. |
| *gpwOk* | L'utilisateur est connecté . |
| *gpwUtilisateurInconnu* | L'utilisateur n'est pas référencé dans la base de données du groupware utilisateur. |



**`<Répertoire des fichiers du groupware> : (Chaîne de caractères optionnelle)`**

Ces fichiers de données permettent de gérer les utilisateurs et leurs droits. Par défaut, ces fichiers de données sont créés dans un sous-répertoire de votre projet (répertoire EXE\\GPW_&lt;Nom du projet&gt;).
![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)   Par défaut, ces fichiers de données sont créés sur le serveur dans un sous-répertoire de votre base de donnée (database) : répertoire .\\GPW_&lt;Nom du projet&gt;.
Si ce paramètre correspond à une chaîne vide ("") ou n'est pas spécifié, le répertoire utilisé sera le répertoire par défaut du groupware utilisateur.

![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Si ce paramètre correspond à un point ".", les fichiers de données du groupware utilisateur seront créés sur le serveur à la racine de la base de données (database).




<a name="SYNTAXE3"></a>




<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
### Syntaxe de l'ancien groupware utilisateur (conservée par compatibilité)

`<Résultat> = gpwOuvre([<Répertoire du fichier des droits> [, <Répertoire des fichiers des utilisateurs>]])`
---

**`<Résultat> : (Constante de type Entier)`**

Résultat de l'ouverture de la fenêtre/page de login.



|   |   |
| --- | --- |
| *gpwAnnulation* | L'utilisateur a cliqué sur le bouton "Annuler" de la fenêtre de login du Groupware. |
| *gpwErreur* | Une erreur est survenue. Pour obtenir le détail, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md). |
| *gpwMotDePasseInvalide* | Le mot de passe n'est pas valide. Il ne correspond pas au mot de passe de l'utilisateur décrit dans la base de données du groupware. |
| *gpwOk* | L'utilisateur est connecté . |
| *gpwUtilisateurInconnu* | L'utilisateur n'est pas référencé dans la base de données du groupware utilisateur. |



**`<Répertoire du fichier des droits> : (Chaîne de caractères optionnelle)`**

Ces fichiers de données permettent de gérer les droits des utilisateurs sur les différentes fenêtres de l'application. Ces fichiers sont propres à l'application. Par défaut, ces fichiers de données sont créés dans un sous-répertoire de votre projet (répertoire EXE\\GPW_&lt;Nom du projet&gt;).
![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)   Par défaut, ces fichiers de données sont créés sur le serveur dans un sous-répertoire de votre base de donnée (database) : répertoire .\\GPW_&lt;Nom du projet&gt;.
Si ce paramètre correspond à une chaîne vide ("") ou n'est pas spécifié, le répertoire utilisé sera le répertoire par défaut du groupware utilisateur.
![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Si ce paramètre correspond à un point ".", les fichiers de données du groupware utilisateur seront créés sur le serveur à la racine de la base de données (database).

**`<Répertoire des fichiers des utilisateurs> : (Chaîne de caractères optionnelle)`**

Ces fichiers de données peuvent être communs à plusieurs applications. Par défaut, ces fichiers de données sont créés dans un sous-répertoire de votre projet (répertoire EXE\\GPW_&lt;Nom du projet&gt;). Il est possible de définir l'emplacement des fichiers communs du groupware utilisateur à plusieurs applications. Dans ce cas, il est nécessaire de préciser le chemin des fichiers de données à utiliser.
![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)   Par défaut, ces fichiers de données sont créés sur le serveur dans un sous-répertoire de votre base de donnée (database) : répertoire .\\GPW_&lt;Nom du projet&gt;.
Si ce paramètre correspond à une chaîne vide ("") ou n'est pas spécifié, le répertoire utilisé sera le répertoire par défaut du groupware utilisateur.
![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Si ce paramètre correspond à un point ".", les fichiers de données du groupware utilisateur seront créés sur le serveur à la racine de la base de données (database).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Comment utiliser la fonction gpwOuvre ? 
<a name="comment_utiliser_fonction_docparampagetitleshort_ELTPARAGRAPHE000207"></a>La fonction **gpwOuvre** permet de personnaliser le lancement du groupware utilisateur. Il est ainsi possible d'effectuer plusieurs actions avant de lancer la fenêtre ou la page de connexion au groupware utilisateur : exécuter du code, lancer des fenêtres ou des pages, etc.

Un exemple d'utilisation de cette fonction : dans une application multilingue utilisant le groupware utilisateur, la première fenêtre/page de l'application permet de choisir la langue d'exécution. Il est donc nécessaire lors de la création de l'application :

- de ne pas choisir le lancement automatique du groupware utilisateur lors de son intégration

- d'ouvrir la fenêtre/page de choix des langues en première fenêtre de l'application, puis d'appeler la fenêtre/page de login grâce à la fonction **gpwOuvre**.





<a name="NOTE0_2"></a>


### Sessions prélancées
<a name="sessions_prelancees_ELTPARAGRAPHE000246"></a>Si votre projet utilise les sessions prélancées, cette fonction ne doit pas être utilisée dans l'événement "Initialisation" du projet. Cette fonction doit être utilisée dans l'événement "Initialisation du projet après connexion au site". 

<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280gpu.dll
