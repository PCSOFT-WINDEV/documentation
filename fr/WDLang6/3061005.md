


## GraveurEfface (Fonction)

***En anglais : BurnerErase***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Efface les fichiers présents sur un CD ou DVD réinscriptible. Ce CD (ou DVD) doit être présent dans le graveur en cours.

Lors de l'effacement, la fonction **GraveurEfface** appelle régulièrement une procédure spécifique écrite en WLangage. Cette procédure permet de gérer les différents événements rencontrés lors de l'effacement.

**Remarques** :

- Le graveur à utiliser peut être sélectionné grâce à la fonction [GraveurSélectionne](../WDLang6/3061012.md).

- L'utilisation de cette fonction n'est pas bloquante. Pour savoir si l'effacement est terminé, utilisez la procédure WLangage appelée régulièrement par la fonction **GraveurEfface**.



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003061005&name=graveurefface_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Effacer complètement les fichiers présents sur le CD
// Le tiroir du graveur s'ouvrira automatiquement à la fin de l'effacement
ResEfface est un booléen 
ResEfface = GraveurEfface(graveurEffacementComplet + graveurEjecteAuto, ProcEffacementCD)
// Pour visualiser cet exemple en totalité, cliquez sur le lien "Exemple"
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = GraveurEfface([<Option d'effacement> [, <Procédure WLangage> [, <Pointeur>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'effacement des fichiers du CD/DVD a été lancé, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).


Pour savoir si l'effacement est terminé, testez l'événement rencontré dans la procédure &lt;Nom de la procédure&gt;.

**`<Option d'effacement> : (Constante ou combinaison de constantes optionnelle de type Entier)`**

Option d'effacement des fichiers du CD ou DVD :


|   |   |
| --- | --- |
| *graveurEffacementComplet* | Effacement complet : les fichiers sont réellement supprimés du CD/DVD.<br><br>Cette méthode peut être longue mais les fichiers supprimés ne pourront pas être restaurés. |
| *graveurEffacementRapide* | Effacement rapide : les fichiers ne sont pas totalement supprimés du CD/DVD. Seules les références au contenu du CD sont supprimées.<br><br>Cette méthode est plus rapide, cependant il sera possible de restaurer les fichiers effacés grâce à un logiciel spécialisé. Cette méthode est donc déconseillée si les fichiers du CD/DVD contiennent des informations confidentielles. |
| *graveurEjecteAuto* | Ouverture du tiroir du graveur à la fin de l'effacement. |
| *graveurSansEjecter* | Le tiroir du graveur ne s'ouvre pas à la fin de l'effacement. |

Par défaut, l'effacement est rapide et le tiroir du graveur ne s'ouvre pas automatiquement à la fin de l'effacement.

**`<Procédure WLangage> : (Nom de procédure optionnelle)`**

Nom de la procédure WLangage ("callback") appelée régulièrement lors de l'effacement. Cette procédure permet de gérer les différents événements rencontrés.
Cette procédure est de la forme :

```txt
PROCEDURE <Nom de la procédure>(<Événement rencontré>, 
	<Message événement>, <Pointeur de la procédure>, <Paramètre>)
```
Les paramètres de cette procédure sont optionnels.
Il n'est pas nécessaire de passer des paramètres à cette procédure. En effet, ces paramètres sont renseignés automatiquement à chaque fichier traité.

**`<Pointeur> : (Entier optionnel)`**

Pointeur passé à la procédure &lt;Nom de la procédure&gt;.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Procédure permettant de gérer les différents événements rencontrés
<a name="procedure_permettant_gerer_les_differents_evenements_rencontres_ELTPARAGRAPHE000093"></a>La fonction **GraveurEfface** appelle régulièrement la procédure &lt;Nom de la procédure&gt;. Cette procédure permet de gérer les différents événements rencontrés lors de l'effacement. Cette procédure est une procédure locale ou globale.

Cette procédure doit être déclarée de la façon suivante :

```txt
PROCEDURE <Nom de la procédure>(<Événement rencontré>, <Message événement>, 
		<Pointeur de la procédure>, <Paramètre>)
```


- &lt;Événement rencontré&gt; est une constante qui indique le type d'événement rencontré.

- &lt;Message événement&gt; est une chaîne de caractères contenant le message correspondant à l'événement rencontré.

- &lt;Pointeur de la procédure&gt; est un entier qui vaut la valeur passée dans le paramètre &lt;Pointeur&gt; de la fonction **GraveurEfface**. Si le paramètre &lt;Pointeur&gt; n'est pas précisé, &lt;Pointeur&gt; vaut 0.

- &lt;Paramètre&gt; est un entier qui contient une valeur spécifique à l'événement rencontré.
	Voici les différentes valeurs pouvant être prises :
	

| Événement | &lt;Événement rencontré&gt; | &lt;Message événement&gt; | &lt;Paramètre&gt; |
| --- | --- | --- | --- |
| Annulation de l'effacement | *graveurNotificationAbandon* | "" | 0 |
| Effacement (disponible uniquement sous Vista ou Windows XP + KB032716) | *graveurNotificationEffacement* | "" | Dans ce cas, deux paramètres sont gérés : <br>***Paramètre 1*** : Nombre de secondes écoulées depuis le début de l'effacement. <br>***Paramètre 2*** : Estimation de la durée totale de l'opération (peut varier pendant l'effacement)<br>Attention : Ces informations sont renvoyées par le graveur et peuvent être erronées. |
| Erreur détectée | *graveurNotificationErreur* | Message d'erreur | Code de l'erreur rencontrée |
| Effacement terminé | *graveurNotificationFinEffacement* | Message d'erreur si &lt;Paramètre&gt; différent de 0, chaîne vide ("") dans le cas contraire | Code de retour, 0 si aucune erreur |
| Autre événement |   | Message de l'événement | 0 |


	Pour récupérer la valeur du &lt;Pointeur de la procédure&gt;, affectez la valeur du &lt;Pointeur de la procédure&gt; à la valeur du &lt;Pointeur&gt; dans la procédure avec la fonction [Transfert](../WDLang1/3014015.md).




Remarque : Les paramètres de cette procédure sont optionnels : il est possible par exemple de ne spécifier que l'événement et le message.
<a name="NOTE0_2"></a>


### Configuration nécessaire 
<a name="configuration_necessaire_ELTPARAGRAPHE000178"></a>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) La gravure de CD est disponible uniquement sous Windows XP et supérieur. La gravure de DVD est disponible sous Windows Vista, et sous Windows XP en utilisant la mise à jour KB932716 pour Windows XP (cette mise à jour doit être téléchargée depuis le site de Microsoft et installée car elle n'est pas prise en compte par le mécanisme de Live Update).   


<a name="XComposante"></a>

## Composante :
wd280grv.dll
