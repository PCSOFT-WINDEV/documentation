


## TwainEtat (Fonction)

***En anglais : TwainState***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie l'état de la source en cours.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003078002&name=twainetat_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
nDefaut est un entier = 0

// Acquisition tant qu'il y a des pages dans le chargeur
nNumPage est un entier = 0
BOUCLE
	// Numérisation dans un fichier BMP
	SI TwainVersBMP("Fichier" + NumériqueVersChaîne(nNumPage + 1) + ".BMP",
			Faux, // Pas d'interface utilisateur
			nDefaut, // Image par défaut du périphérique
			nDefaut, // Nombre de bits par pixel par défaut du périphérique
			nDefaut, // Résolution de l'image par défaut du périphérique
			nDefaut, // Contraste de l'image par défaut du périphérique
			nDefaut, // Brillance de l'image par défaut du périphérique
			Faux,  // Scanner le document d'un seul coté (pas de recto/verso)
			Vrai // Optimiser le chargement automatiquement dans le chargeur
			) = Faux ALORS
		SORTIR
	FIN
	nNumPage ++
	// Encore des pages ?
	SI TwainEtat() = teNonChargé ALORS SORTIR
FIN
// Au moins une page de numérisée ?
SI nNumPage = 0 ALORS
	Erreur("Échec de la numérisation", ErreurInfo())
SINON
	Info(nNumPage + "pages ont été scannées")
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = TwainEtat()`
---

**`<Résultat> : (Réel)`**

Etat de la source Twain correspondant à une des constantes suivantes :


|   |   |
| --- | --- |
| *teChargé* | Gestionnaire Twain chargé. |
| *teNonChargé* | Gestionnaire Twain non chargé. |
| *teOuvert* | Gestionnaire Twain ouvert. |
| *teSourceActif* | Source active. |
| *teSourceOuvert* | Source ouverte. |
| *teSourcePrêt* | Source prête à transférer les données. |
| *teSourceTransfert* | Source en cours de transfert des données. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Gestion des changements de pages
<a name="gestion_des_changements_pages_ELTPARAGRAPHE000059"></a>Pour réaliser une acquisition sur plusieurs pages en utilisant un périphérique TWAIN, il suffit de faire une boucle réalisant l'acquisition d'une page et se terminant lorsque la fonction **TwainEtat** retourne la constante *teNonChargé*. Cette valeur de la constante indique en effet que le chargeur de pages du périphérique TWAIN est vide.


### Fonctionnement dans des applications 64 bits
<a name="fonctionnement_dans_des_applications_64_bits_ELTPARAGRAPHE000069"></a>Dans une application 64 bits, cette fonction utilisera automatiquement le driver Twain 64 bits. Si ce driver n'est pas installé, le périphérique TWAIN ne pourra pas être manipulé. 

<a name="XComposante"></a>

## Composante :
wd280std.dll
