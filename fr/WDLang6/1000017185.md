


## Accès Natif à SAP
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000144"></a>
SAP est un ERP très utilisé. Nombreux sont les utilisateurs de SAP qui mettent en place des applications satellites à leurs logiciels.

Le support natif de SAP par WINDEV et WEBDEV permet de mettre en place rapidement et simplement ces applications.

Une "BAPI" (Business API) est une fonction qui permet d'interagir avec un système SAP. Des BAPI sont livrées avec SAP, d'autres sont écrites par d'autres développeurs et éditeurs.

Plusieurs fonctions WLangage sont disponibles, permettant d'établir une connexion avec authentification et d'appeler des BAPI en passant des paramètres.

Un assistant permet d'importer simplement les structures manipulées.

Il est inutile d'installer le module SAP GUI. Seuls sont nécessaires le client SAP ou bien la librairie librfc32.dll (librairie fournie par SAP, présente dans le répertoire de l'exécutable).

Il est ainsi possible de créer des fenêtres WINDEV et de les utiliser à la place de SAP GUI. De plus, le logiciel "Etats & Requêtes" peut être utilisé pour créer des états et des requêtes sur des données contenues dans la base SAP.

**Remarque** : Il n'est pas possible de se connecter à SAP Business Object à travers le protocole de SAP BO (UI API et DI API) via l'accès natif SAP. Dans ce cas, il est nécessaire d'utiliser une DLL (C# ou Visual Basic) appelée par un code WLangage. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Un assistant pour utiliser des fonctions SAP
<a name="assistant_pour_utiliser_des_fonctions_sap_ELTTEXTE000168"></a>
Pour utiliser des fonctions SAP, il est conseillé d'utiliser l'assistant d'importation de fonctions SAP. Cet assistant génère le code WLangage nécessaire dans une collection de procédures (pour une réutilisabilité optimale). Pour chaque fonction importée, une procédure globale est créée. Cette procédure contient en commentaire un exemple d'appel avec les paramètres à vide. Il suffit de copier cet exemple d'appel dans le code souhaité, et de saisir la valeur des différents paramètres pour utiliser la fonction.

**Pour utiliser l'assistant d'importation de module fonction/BAPI** : 

1. Sous le volet "Projet", dans le groupe "Projet", déroulez "Importer" et sélectionnez "Une fonction SAP".

2. L'assistant se lance. Passez à l'étape suivante.

3. Indiquez les paramètres de connexion au serveur d'application SAP :

	- le serveur d'application.

	- le numéro système.

	- le numéro de client.

	- l'utilisateur.

	- le mot de passe associé à l'utilisateur.




4. L'étape suivante permet de sélectionner le module fonction à importer. Vous pouvez :

	- soit récupérer toute la liste des fonctions disponibles pour sélectionner la fonction voulue. Cette opération peut prendre un certain temps.

	- soit filtrer les fonctions pour ne récupérer que celles correspondant au filtre (par exemple que les fonctions utilisateur commençant par "Z").
			Le bouton "Lancer la recherche" permet d'afficher les fonctions trouvées.




5. L'étape suivante permet de sélectionner la fonction voulue.

6. Vous pouvez ensuite sélectionner les paramètres à passer à la fonction. Pour chaque paramètre, l'assistant vous indique :

	- le nom du paramètre.

	- si le paramètre est un paramètre d'entrée ou de sortie.

	- si le paramètre est optionnel.

	- la valeur par défaut du paramètre. Cette valeur sera utilisée si le paramètre n'est pas passé à la fonction.




7. Il ne reste plus qu'à indiquer le nom de la collection de procédures qui accueillera la procédure SAP. Par défaut, cette collection de procédures a pour nom "SAP". Vous pouvez choisir un autre nom. Ce nom sera automatiquement proposé lors de la prochaine importation d'une fonction SAP.
	Remarque : Si la collection de procédures n'existe pas, elle est automatiquement créée.

8. Dans le code de la procédure globale créée, en commentaires, est disponible un exemple de code permettant d'appeler la procédure globale créée. Il suffit de :

	- copier ce code à l'endroit voulu.

	- enlever les commentaires.

	- donner une valeur aux différents paramètres attendus par la fonction.







Remarque : la gestion de la connexion et de la déconnexion de l'application au serveur d'application SAP doit être réalisée grâce aux fonctions [SAPConnecte](../WDLang6/1000017120.md) et [SAPDéconnecte](../WDLang6/1000017121.md).
<a name="NOTE2_2"></a>


### Assistant de la fonction SAPExécute
<a name="assistant_fonction_sapexecute_ELTPARAGRAPHE000090"></a>La méthode présentée dans le paragraphe précédent est la méthode conseillée pour manipuler des BAPI SAP. Mais il est également possible d'utiliser directement l'assistant de la fonction [SAPExécute](../WDLang6/1000017122.md), disponible sous l'éditeur de code. Cet assistant permet de générer le code d'appel de la fonction BAPI voulue.


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LesfonctionsSAP.gif) ***Exemples unitaires (WINDEV)*** : **Les fonctions SAP** <br>Utilisation des fonctions WLangage SAPXxx.<br>Ces fonctions permettent d'utiliser les BAPI SAP nativement dans WINDEV et dans WEBDEV.<br>Cela permet donc d'accéder à vos données SAP directement depuis vos applications WINDEV.


