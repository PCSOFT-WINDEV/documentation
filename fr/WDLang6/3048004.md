


## JavaExécuteFonction (Fonction)

***En anglais : JavaExecuteFunction***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Lance une fonction statique spécifique d'une classe Java donnée.

**Attention** :

- Le chemin de la classe à exécuter doit être spécifié avec la fonction [JavaCharge](../WDLang6/3048001.md).

- La classe Java lancée doit implémenter la méthode "static public &lt;Type de retour&gt; &lt;NomFonction&gt;".



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 
```wl
// Chemins dans lesquels les classes vont être recherchées
// Note : Indiquez les noms de dossiers/répertoires et les noms de .jar ou de .zip
// (et non seulement le nom des .class)
sCheminClassJava est une chaîne = fRepExe()
SI JavaCharge(sCheminClassJava) ALORS 
	// Classe Java à utiliser
	// Note : Si la classe est dans un sous-dossier du .Jar, 
	// il faut préciser le dossier. Par exemple : "singlejar/Application"
	sClasseJava est une chaîne = "Application"
	// Fonction de la classe
	sFonctionJava est une chaîne = "somme"
	Res est un réel 
	Res = JavaExécuteFonction(sClasseJava, sFonctionJava, javaRéelDouble, 1.55, 2.35)
	Info(Res)
SINON
	Erreur("Emplacements Java incorrects", ErreurInfo())
FIN
```
<a name="Exemple2"></a>

```txt
// Code JAVA
import java.awt.*;
import java.awt.event.*;

public class Application {
    public static double somme (double a, double b) {
        return a + b;
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`JavaExécuteFonction(<Nom de la classe> , <Nom de la fonction> , <Type de retour> [, <Paramètre 1> [... [, <Paramètre N>]]])`
---

**`<Nom de la classe> : (Chaîne de caractères)`**

Nom de la classe contenant la fonction à exécuter. Ce paramètre est sensible à la casse : il doit correspondre exactement au nom indiqué dans la classe.
Si la classe est contenue dans un ou des packages, il faut spécifier le chemin complet de cette classe avec le caractère "/" comme séparateur. Exemple : "MonPackage/MonSousPackage/MaClasse".

**`<Nom de la fonction> : (Chaîne de caractères)`**

Nom de la fonction Java à exécuter. Ce paramètre est sensible à la casse : il doit correspondre exactement au nom indiqué dans la classe.

**`<Type de retour> : (Constante de type Entier)`**

Type de retour de la fonction Java parmi les valeurs suivantes :


|   |   |
| --- | --- |
| *javaBooléen* | Valeur de retour de type Booléen. |
| *javaCaractère* | Valeur de retour de type Caractère. |
| *javaChaîne* | Valeur de retour de type Chaîne. |
| *javaChaîneUnicode* | Valeur de retour de type Chaîne Unicode. |
| *javaChaîneUTF8* | Valeur de retour de type Chaîne au format UTF8. |
| *javaEntier* | Valeur de retour de type Entier. |
| *javaEntierCourt* | Valeur de retour de type Entier court. |
| *javaEntierLong* | Valeur de retour de type Entier long. |
| *javaOctet* | Valeur de retour de type Octet. |
| *javaRéel* | Valeur de retour de type Réel. |
| *javaRéelDouble* | Valeur de retour de type Réel Double. |
| *javaVoid* | Valeur de retour de type Void. |



**`<Paramètre 1> : (Type correspondant à chaque paramètre)`**

Paramètres attendus par la fonction Java. Ces paramètres doivent être du même type que les paramètres attendus par la fonction Java. Seuls les types simples sont utilisables (voir Remarques).



**`<Paramètre N> : (Type correspondant à chaque paramètre)`**

Paramètres attendus par la fonction Java. Ces paramètres doivent être du même type que les paramètres attendus par la fonction Java. Seuls les types simples sont utilisables (voir Remarques).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Appel de la fonction JavaCharge
<a name="appel_fonction_javacharge_ELTPARAGRAPHE000100"></a>

- Un seul appel à la fonction [JavaCharge](../WDLang6/3048001.md) doit être effectué dans une application WINDEV ou un site WEBDEV.
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La fonction [JavaCharge](../WDLang6/3048001.md) peut être appelée autant de fois que nécessaire.

- Il est nécessaire d'utiliser une version 1.1, 1.2 (ou sous version), 1.3 (ou sous version), 1.4 ou 1.5 ou 6 de la machine virtuelle Java de SUN.



<a name="NOTE0_2"></a>


### Erreur
<a name="erreur_ELTPARAGRAPHE000118"></a>

- Si une erreur intervient lors de l'exécution de la classe spécifiée, le message d'erreur correspondant apparaît dans une boîte de message et l'application WINDEV (ou le site WEBDEV) est arrêtée.

- Causes possibles de problèmes (par exemple classe non trouvée) :

	- mauvaise syntaxe dans le nom de la classe (mauvaise casse utilisée, classe contenue dans un package et chemin complet non indiqué, ...)

	- classe compilée avec une certaine version de la machine virtuelle Java de SUN et exécutée avec un JRE de version inférieure, ...






<a name="NOTE0_3"></a>


### Paramètres à passer à la fonction Java
<a name="parametres_passer_fonction_java_ELTPARAGRAPHE000129"></a>Seuls les types "simples" sont utilisables : entier, réel, chaîne, booléen. L'utilisation d'un autre type WLangage provoque une erreur du WLangage.

Il est donc impossible d'appeler une fonction java ayant des paramètres de type "byte" ou "short". Pour appeler cette fonction Java à l'aide de la fonction **JavaExécuteFonction**, il est nécessaire de passer les paramètres de type "byte" ou "short" de la fonction Java en type "int".
<a name="NOTE0_4"></a>


### Note
<a name="note_ELTPARAGRAPHE000141"></a>Le fichier ".class" est le résultat de la compilation d'un ou plusieurs fichiers contenant du code Java. Il ne contient pas le code source de l'application mais un format intermédiaire (le "bytecode") destiné à être interprété par la machine virtuelle Java (la JVM).


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDAppelsJAVA.gif) ***Exemples didactiques (WINDEV)*** : **WD Appels JAVA** <br>WD Appels Java est un projet exemple contenant 2 configurations de projet :<br>- Une configuration "Application Windows" qui permet de créer l'exécutable de l'application<br>- Une configuration "Application Java" qui permet de créer l'archive Java (.JAR) de l'application<br>Cet exemple est livré avec une archive JAR "FonctionJava" externe à l'application.<br>Il illustre l'appel aux méthodes des classes de cette archive JAR grâce à la fonction WLangage JavaExécuteFonction.<br>Cet exemple montre également le remplissage d'une table mémoire (identique en mode Java et en mode Windows)

<a name="XComposante"></a>

## Composante :
wd280jav.dll
