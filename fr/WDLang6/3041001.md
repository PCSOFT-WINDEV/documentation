
## gpwLogin (Fonction)

***En anglais : gpwLogin***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Connecte directement un utilisateur à une application utilisant le groupware utilisateur. Cette fonction vérifie que l'utilisateur est bien enregistré dans la base de données du groupware utilisateur. Si l'utilisateur est identifié, l'application est automatiquement lancée en utilisant les droits définis pour cet utilisateur.

**Remarque** : Aucune fenêtre de login n'est ouverte automatiquement : le login et le mot de passe sont directement passés en paramètres à la fonction. Le login et le mot de passe peuvent avoir été saisis par exemple dans une fenêtre personnalisée de connexion (voir exemple).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Récupération du login dans une fenêtre perso
Login est une chaîne
MotPasse est une chaîne
Ouvre(FEN_MaFenetreLogin, Login, MotPasse)
// Vérification du login
nRes est un entier = gpwLogin(Login, MotPasse)
// Si le login a échoué
SI nRes <> gpwOk ALORS
	SELON nRes
		CAS gpwErreur : Erreur("Erreur à l'initialisation du groupware.")
		CAS gpwUtilisateurInconnu : Erreur("Utilisateur inconnu.")
		CAS gpwMotPasseInvalide : Erreur("Mot de passe invalide.")
	FIN
	FinProgramme()
FIN
// Récupération du prénom de l'utilisateur
Prenom est une chaîne = gpwRecupInfoUtilisateur(gpwInfoPrenom)
Info("Bienvenue" + Prenom)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Connecter directement un utilisateur à une application utilisant le groupware utilisateur

`<Résultat> = gpwLogin(<Nom> , <Mot de passe> [, <Répertoire des fichiers du groupware>])`
---

**`<Résultat> : (Constante de type Entier)`**

Résultat de la connexion :


|   |   |
| --- | --- |
| *gpwAdministration* | Le groupware est en mode administration. |
| *gpwAnnulation* | L'utilisateur a cliqué sur le bouton "Annuler". |
| *gpwErreur* | Une erreur est survenue. Pour obtenir le détail, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md). |
| *gpwMotPasseInvalide* | Le mot de passe n'est pas valide. Il ne correspond pas au mot de passe de l'utilisateur décrit dans la base de données du groupware. |
| *gpwOk* | L'utilisateur est connecté |
| *gpwUtilisateurInconnu* | L'utilisateur n'est pas référencé dans la base de données du groupware utilisateur. |



**`<Nom> : (Chaîne de caractères)`**

Login de l'utilisateur.

**`<Mot de passe> : (Chaîne de caractères)`**

Mot de passe associé au login de l'utilisateur, chaîne vide ("") si aucun mot de passe.

**`<Répertoire des fichiers du groupware> : (Chaîne de caractères optionnelle)`**

Ces fichiers de données permettent de gérer les utilisateurs et leurs droits. Par défaut, ces fichiers de données sont créés dans un sous-répertoire de votre projet (répertoire EXE\\GPW_&lt;Nom du projet&gt;).
Si ce paramètre correspond à une chaîne vide ("") ou n'est pas spécifié, le répertoire utilisé sera le répertoire par défaut du groupware utilisateur.


<a name="SYNTAXE2"></a>

### Syntaxe de l'ancien groupware utilisateur (conservée par compatibilité)

`<Résultat> = gpwLogin(<Nom> , <Mot de passe> [, <Répertoire du fichier des droits> [, <Répertoire des fichiers des utilisateurs>]])`
---

**`<Résultat> : (Constante de type Entier)`**

Résultat de la connexion :


|   |   |
| --- | --- |
| *gpwAnnulation* | L'utilisateur a cliqué sur le bouton "Annuler". |
| *gpwErreur* | Une erreur est survenue. Pour obtenir le détail, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md). |
| *gpwMotPasseInvalide* | Le mot de passe n'est pas valide. Il ne correspond pas au mot de passe de l'utilisateur décrit dans la base de données du groupware. |
| *gpwOk* | L'utilisateur est connecté |
| *gpwUtilisateurInconnu* | L'utilisateur n'est pas référencé dans la base de données du groupware utilisateur. |



**`<Nom> : (Chaîne de caractères)`**

Login de l'utilisateur.

**`<Mot de passe> : (Chaîne de caractères)`**

Mot de passe associé au login de l'utilisateur, chaîne vide ("") si aucun mot de passe.

**`<Répertoire du fichier des droits> : (Chaîne de caractères optionnelle)`**

Ces fichiers de données permettent de gérer les droits des utilisateurs sur les différentes fenêtres de l'application. Ces fichiers sont propres à l'application. Par défaut, ces fichiers de données sont créés dans un sous-répertoire de votre projet (répertoire EXE\\GPW_&lt;Nom du projet&gt;).

Si ce paramètre correspond à une chaîne vide ("") ou n'est pas spécifié, le répertoire utilisé sera le répertoire par défaut du groupware utilisateur.

**`<Répertoire des fichiers des utilisateurs> : (Chaîne de caractères optionnelle)`**

Ces fichiers de données peuvent être communs à plusieurs applications. Par défaut, ces fichiers de données sont créés dans un sous-répertoire de votre projet (répertoire EXE\\GPW_&lt;Nom du projet&gt;). Il est possible de définir l'emplacement des fichiers communs du groupware utilisateur à plusieurs applications. Dans ce cas, il est nécessaire de préciser le chemin des fichiers de données à utiliser.

Si ce paramètre correspond à une chaîne vide ("") ou n'est pas spécifié, le répertoire utilisé sera le répertoire par défaut du groupware utilisateur.









<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280gpu.dll
