
## Gestion des fichiers PDF
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000146"></a>
Le format PDF est l'un des formats les plus répandus pour la transmission et le stockage de documents électroniques. 

Plusieurs méthodes permettent de créer ou manipuler des fichiers PDF : 

- Impression dans des fichiers PDF : Les fichiers PDF peuvent être créés aussi bien lors d'une impression via l'éditeur d'états que lors d'une impression en WLangage. 
	Pour plus de détails, consultez [Imprimer au format PDF](../WDChamp/1011091.md). 

- Visualisation de fichiers PDF via le champ Lecteur PDF. 
	Pour plus de détails, consultez [Le champ Lecteur PDF](../WDChamp/1410087036.md). 

- [Manipulations simples de fichiers PDF en WLangage](#NOTE2_1) : Vérification de la protection, extraction d'une page, fusion de PDF, ...

- [Manipulations du contenu d'un fichier PDF en WLangage](#NOTE3_1) grâce à différents types de variables.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Manipulations simples des fichiers PDF en WLangage
<a name="manipulations_simples_des_fichiers_pdf_wlangage_ELTTEXTE000170"></a>
Différentes fonctions permettent de réaliser des manipulations simples sur les fichiers PDF. Ces fonctions manipulent directement le fichier PDF : 



|   |   |
| --- | --- |
| [PDFEstProtégé](../WDLang6/1000017491.md) | Vérifie si le fichier PDF nécessite un mot de passe pour être lu. |
| [PDFExtraitPage](../WDLang6/1000021279.md) | Extrait une page d'un fichier PDF dans une variable de type [Image](../WDLang1/1000019650.md). |
| [PDFFusionne](../WDLang6/1000019712.md) | Fusionne plusieurs fichiers PDF existant en un seul fichier PDF. Les fichiers sont fusionnés les uns après les autres. Les chemins des fichiers PDF peuvent être présents dans un tableau.  |
| [PDFFusionneAvecMotDePasse](../WDLang6/1000020126.md) | Fusionne plusieurs fichiers PDF existants et protégés par un mot de passe d'ouverture en un seul fichier PDF. |
| [PDFMotDePasse](../WDLang6/1000024229.md) | Protège un document PDF par un mot de passe. |
| [PDFNombreDePages](../WDLang6/1000017480.md) | Renvoie le nombre total de pages d'un fichier PDF. |
| [PDFSigne](../WDLang6/1000022241.md) | Applique une signature d'approbation sur un PDF existant. |
| [PDFVersTexte](../WDLang6/1000017479.md) | Extrait le texte contenu dans un fichier PDF. |





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

## Manipulations du contenu d'un fichier PDF en WLangage
<a name="manipulations_contenu_fichier_pdf_wlangage_ELTTEXTE000255"></a>
Pour manipuler plus simplement le contenu d'un fichier PDF, le WLangage propose différents types de variables : 



|   |   |
| --- | --- |
| [pdfDocument](../WDLang6/1000024909.md) | Le type **pdfDocument** permet de connaître toutes les caractéristiques d'un fichier PDF : auteur, date de création, contenu des pages, ... |
| [pdfElémentTexte](../WDLang6/1000024556.md) | Le type **pdfElémentTexte** permet de connaître toutes les caractéristiques d'un élément textuel dans une page PDF. |
| [pdfPage](../WDLang6/1000024904.md) | Le type **pdfPage** permet de définir toutes les caractéristiques avancées d'une page d'un document PDF chargé en mémoire. |
| [pdfParamètre](../WDLang6/1410087857.md) | Le type **pdfParamètre** permet de définir toutes les caractéristiques d'un fichier PDF à générer. |
| [pdfPièceJointe](../WDLang6/1000024899.md) | Le type **pdfPièceJointe** permet de définir toutes les caractéristiques avancées d'une pièce jointe dans un document PDF. |
| [pdfSignature](../WDLang6/1000022255.md) | Le type **pdfSignature** permet de définir toutes les caractéristiques avancées d'une signature à appliquer à un fichier PDF lors de la signature d'un PDF existant (via la fonction [PDFSigne](../WDLang6/1000022241.md)).  |





Une variable de type [pdfDocument](../WDLang6/1000024909.md) permet de charger en mémoire le contenu d'un fichier PDF. Par exemple : 

```wl
MonPDF est un pdfDocument = PDFOuvre("test.pdf")

MonSecondPDF est un pdfDocument = "C:\temp\exemplePDF.pdf"
```


Depuis cette variable, il est possible d'accéder aux pages du document PDF et pour chaque page, au texte du document PDF. Par exemple : 

```wl
MonPDF est un pdfDocument = "test.pdf"
 
POUR TOUTE PageDuDocument DE MonPDF.Page
	POUR TOUT ElémentPage DE PageDuDocument.ElémentTexte
		Trace(ElémentPage.Texte)
	FIN
FIN
```


Grâce à ces types de variables, il devient possible d'ajouter ou supprimer des pages à un document en utilisant les fonctions de manipulation de tableaux ([Ajoute](../WDLang1/1000017348.md), [Supprime](../WDLang1/1000017354.md), ... ) directement sur le tableau de variables de type [pdfPage](../WDLang6/1000024904.md) contenu dans la variable de type [pdfDocument](../WDLang6/1000024909.md).

Exemple : 

```wl
MonDocPDF est un pdfDocument = PDFOuvre("C:\temp\Monguide.pdf")
Trace(MonDocPDF.VersionPDF)
Trace(MonDocPDF.Auteur)
Trace(MonDocPDF.Page.Occurrence)
Trace(MonDocPDF.Page[1].Largeur)
Trace(MonDocPDF.Page[36].Hauteur)

POUR TOUT UnElémentTexte DE MonDocPDF.Page[2].ElémentTexte
	Trace(UnElémentTexte.Texte + " X = " + 
	UnElémentTexte.X + " Y = " + UnElémentTexte.Y + " L = " + 
	UnElémentTexte.Largeur + " H = " + UnElémentTexte.Hauteur)
FIN

MonDocPDF2 est un pdfDocument = "C:\temp\plan.pdf"
// Ajout de pages
Ajoute(MonDocPDF2.Page, MonDocPDF.Page[5])
// Insertion de pages
Insère(MonDocPDF2.Page, 1, MonDocPDF.Page[32])
// Enregistrement du PDF modifié
PDFSauve(MonDocPDF2, "MonDocPDF2.pdf")
LanceAppliAssociée("MonDocPDF2.pdf")
```

Des fonctions PDF spécifiques permettent de manipuler les variables de type [pdfDocument](../WDLang6/1000024909.md) : 



|   |   |
| --- | --- |
| [PDFAjouteFiligrane](../WDLang6/1410087843.md) | Ajoute un filigrane sur toutes les pages ou sur certaines pages d'un fichier PDF existant. |
| [PDFAjouteImage](../WDLang6/1410087847.md) | Ajoute une image dans une page d'un fichier PDF existant. |
| [PDFFerme](../WDLang6/1000025127.md) | Ferme le fichier PDF chargé en mémoire dans une variable de type [pdfDocument](../WDLang6/1000024909.md). |
| [PDFNbSignature](../WDLang6/1410088119.md) | Récupère le nombre de signatures dans un document PDF. |
| [PDFOuvre](../WDLang6/1000025032.md) | Ouvre un document PDF et charge ce document dans une variable de type [pdfDocument](../WDLang6/1000024909.md). |
| [PDFRécupèreDateSignature](../WDLang6/1410088121.md) | Récupère la date de l'une des signatures d'un document PDF. |
| [PDFRécupèreSignature](../WDLang6/1410088120.md) | Récupère la signature d'un document PDF sous forme d'un buffer. |
| [PDFSauve](../WDLang6/1000024864.md) | Sauve le contenu d'une variable de type [pdfDocument](../WDLang6/1000024909.md) dans un fichier ".PDF". |





**Remarque : Liaison avec le champ Lecteur PDF** : 

- Une variable de type [pdfDocument](../WDLang6/1000024909.md) peut être affectée à un champ Lecteur PDF. 

- Un document PDF présent dans un champ Lecteur PDF peut être récupéré dans une variable de type [pdfDocument](../WDLang6/1000024909.md). 
	Exemple : 
	
	```wl
	MonDocPDF est un pdfDocument
	MonDocPDF = PDF_LecteurPDF
	```






