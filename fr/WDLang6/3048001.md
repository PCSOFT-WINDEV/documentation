
## JavaCharge (Fonction)

***En anglais : JavaLoad***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Indique l'emplacement des classes de l'utilisateur nécessaires à l'exécution de l'application ou de l'applet Java.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Indique l'emplacement des fichiers .class de l'application Java à lancer
// Note : Indiquez les noms de dossiers/répertoires et les noms de .jar ou de .zip
// (et non seulement le nom des .class)

JavaCharge("D:\sources\Exemple\TestJava")
```


<a name="Exemple2"></a>





```wl
// Définit la variable java.library.path à la valeur c:\tmp
JavaCharge(".", "-Djava.library.path=c:\tmp")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = JavaCharge(<Emplacement> [, <Paramètres>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si les chemins spécifiés existent, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Emplacement> : (Chaîne de caractères)`**

Liste des emplacements séparés par : 

- des points-virgules (";") sous Windows, 

- des deux-points (":") sous Linux. 


Les emplacements peuvent correspondre : 

- Chemin complet (ou relatif) des fichiers .jar, 

- Chemin complet (ou relatif) des répertoires contenant les fichiers .class. 
	Attention : n'indiquez pas le chemin complet d'un fichier .class mais uniquement le chemin du répertoire qui le contient. 




**`<Paramètres> : (Chaîne de caractères optionnelle)`**

Options d'initialisation de la librairie Java. Ces chaînes doivent être au format : 

```txt
"-D<Nom>=<Valeur>"
```

Si plusieurs options doivent être indiquées, les différentes chaînes correspondantes doivent être séparées par une virgule.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Appel de la fonction JavaCharge
<a name="appel_fonction_docparampagetitleshort_ELTPARAGRAPHE000063"></a>Un seul appel à la fonction **JavaCharge** doit être effectué dans une application WINDEV ou dans un site WEBDEV.

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La fonction **JavaCharge** peut être appelée autant de fois que nécessaire.


<a name="NOTE0_2"></a>




### Java version 1.2 (ou sous version), 1.3 (ou sous version), 1.4 (ou sous version), Java 6
<a name="java_version_12_sous_version_13_sous_version_14_sous_version_java_6_ELTPARAGRAPHE000084"></a>

- Il est nécessaire d'avoir installé l'environnement d'exécution JAVA (J2SE JRE) ou l'environnement de développement (J2SE SDK) pour utiliser la fonction **JavaCharge**.

- Le message d'erreur "Echec lors du chargement de la DLL JVM.DLL" signifie que le fichier JVM.DLL n'a pas été trouvé sur le poste en cours. Il est nécessaire d'ajouter le répertoire contenant le fichier JVM.DLL dans le PATH du poste en cours.




**Remarque** : la recherche du fichier JVM.DLL en Windows et du fichier "libjvm.soc" en Linux est effectuée de la manière suivante : 

1. En Windows, recherche sur les clés de registres:

	- HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\JRE : valeur "CurrentVersion", puis valeur "RuntimeLib" dans la sous clé &lt;version&gt;.

	- HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Runtime Environment : valeur "CurrentVersion", puis valeur "RuntimeLib" dans la sous clé &lt;version&gt;.

	- HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\JDK : : valeur "CurrentVersion", puis valeur "RuntimeLib" dans la sous clé &lt;version&gt;.

	- HKEY_LOCAL_MACHINE\\SOFTWARE\\JavaSoft\\Java Development Kit : valeur "CurrentVersion", puis valeur "RuntimeLib" dans la sous clé &lt;version&gt;.




2. Pour toutes les plateformes (Windows et Linux), recherche depuis le répertoire donné par la variable d'environnement "JAVA_HOME".

3. Pour Linux, recherche dans le répertoire "/etc/alternative/jre". 

4. Pour toutes les plateformes (Windows et Linux), recherche dans le PATH de recherche de librairies du système d'exploitation. 





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDAppelsJAVA.gif) ***Exemples didactiques (WINDEV)*** : **WD Appels JAVA** <br>WD Appels Java est un projet exemple contenant 2 configurations de projet :<br>- Une configuration "Application Windows" qui permet de créer l'exécutable de l'application<br>- Une configuration "Application Java" qui permet de créer l'archive Java (.JAR) de l'application<br>Cet exemple est livré avec une archive JAR "FonctionJava" externe à l'application.<br>Il illustre l'appel aux méthodes des classes de cette archive JAR grâce à la fonction WLangage JavaExécuteFonction.<br>Cet exemple montre également le remplissage d'une table mémoire (identique en mode Java et en mode Windows)



<a name="XComposante"></a>

## Composante :
wd280jav.dll
