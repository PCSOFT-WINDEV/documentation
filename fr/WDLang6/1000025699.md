
## OCRExtraitTexte (Fonction)

***En anglais : OCRExtractText***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Lit le texte contenu dans une image. 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MonImage est une Image
soit MaChaîne = OCRExtraitTexte(MonImage)
```



```wl
MonImage est une Image
r est un Rectangle
r.X=346
r.Y=2258
r.Largeur = (2158-346)
r.Hauteur = (2323-2258)
soit sChaîne = OCRExtraitTexte(MonImage, r)
Trace(sChaîne)
```



```wl
p est un Polygone
p.Point[1].X = 346
p.Point[1].Y = 2258
p.Point[2].X = 2158
p.Point[2].Y = 2258
p.Point[3].X = 2158
p.Point[3].Y = 2323
p.Point[4].X = 346
p.Point[4].Y = 2323
soit sChaîne2 = OCRExtraitTexte(MonImage, p)
Trace(sChaîne2)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = OCRExtraitTexte(<Image à manipuler> [, <Zone à lire>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Texte extrait de l'image. 

**`<Image à manipuler> : (Nom de champ, variable de type Image, chaîne de caractères)`**

Image dans laquelle la lecture des zones de texte doit être effectuée. Cette image peut correspondre : 

- à un champ Image, 

- à une variable de type Image, 

- à une rubrique de type Mémo Image, 

- au chemin d'un fichier image

- au chemin d'un fichier PDF. 




**`<Zone à lire> : (Variable optionnelle de type Rectangle ou de type Polygone)`**



- Nom de la variable de type [Rectangle](../Motscles/1514079.md) représentant la zone contenant le texte à extraire. 

- Nom de la variable de type [Polygone](../WDLang1/1000025624.md) représentant la zone contenant le texte à extraire. Dans ce cas, la zone lue correspond au rectangle englobant le polygone. 


Par défaut, si ce paramètre n'est pas spécifié, tout le texte de l'image est extrait. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- ![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Pour les applications WINDEV (Windows et Linux), les moteurs Legacy et LSTM peuvent être utilisés. Par défaut, les modèles LSTM sont livrés.

- Pour les fichiers PDF : 

	- si le paramètre &lt;Zone à lire&gt; n'est pas précisé, la fonction **OCRExtraitTexte** extrait le texte de toutes les pages du fichier PDF spécifié. 

	- si le paramètre &lt;Zone à lire&gt; est précisé, il est nécessaire d'extraire la page souhaitée (même si le fichier PDF contient une seule page) dans une image avec la fonction [PDFExtraitPage](../WDLang6/1000021279.md). Cette image pourra ensuite être utilisée avec la fonction **OCRExtraitTexte**. 







- Afin d'améliorer la qualité du résultat obtenu, il est conseillé de : 

	- Avoir une image de bonne résolution.

	- Recadrer l'image autour du texte si possible (évitez les zones inutiles).

	- Limiter l'inclinaison du texte. Si l'image est légèrement en biais, l'OCR peut arriver à détecter le texte, mais la qualité sera détériorée. 
			

	- Limiter le nombre de modèles/langues utilisés.




- Si l'image manipulée correspond à un champ Image, il faut savoir que l'image source est directement manipulée. Par conséquent, les modifications réalisées dans le champ Image (taille de l'image par exemple) ne seront pas prises en compte. Pour prendre en compte ces modifications, il est nécessaire d'enregistrer l'image. 

- Si l'image manipulée correspond à un fichier PDF (via un champ Image ou non), la qualité du PDF est forcée à 300 DPI.

- L'OCR est disponible uniquement pour détecter un texte imprimé. Il n'est pas disponible pour une écriture manuscrite.




- Si l'image manipulée correspond à un champ Image, et si l'image source est plus petite que le champ, le paramètre &lt;Zone à lire&gt; doit être exprimé en coordonnées de l'image source et non en coordonnées du champ Image. Il est possible d'utiliser la fonction [CoordonnéeChampImageVersImage](../WDLang1/1000026037.md) pour convertir ces coordonnées. 




- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LesfonctionsOCR.gif) ***Exemples unitaires (WINDEV)*** : **Les fonctions OCR** <br>Cet exemple montre l'utilisation des fonctions OCR de WINDEV.<br>Ces fonctions permettent d'analyser une image afin d'en extraire le texte.<br>Il est possible de spécifier la langue du document analysé afin de détecter plus finement.<br>Il est également possible de récupérer les positions des blocs de texte trouvés.


<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280ocr.dll
