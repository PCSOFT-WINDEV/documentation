


## SAPExécute (Fonction)

***En anglais : SAPExecute***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Appelle une fonction ou BAPI synchrone sur un système SAP.

Remarque : il est conseillé d'utiliser les assistants pour exécuter une fonction (ou BAPI). Deux assistants sont disponibles et génère tout le code nécessaire :

- assistant de la fonction **SAPExécute** : saisissez "SAPExécute(" dans l'éditeur de code et renseignez les informations demandées.

- assistant d'utilisation d'une fonction SAP : cet assistant génère des procédures globales contenant tout le code nécessaire à l'utilisation des BAPI. Cette méthode est conseillée. 
	Pour lancer cet assistant, sous le volet "Projet", dans le groupe "Projet", déroulez "Importer" et sélectionnez "Une fonction SAP". 
	Pour plus de détails, consultez [Accès Natif SAP](../WDLang6/1000017185.md).



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Code généré par l'assistant de la fonction SAPExécute 
STRETURN est une Structure
	TYPE est une chaîne
	CODE est une chaîne
	_MESSAGE est une chaîne
	LOG_NO est une chaîne 
	LOG_MSG_NO est une chaîne
	MESSAGE_V1 est une chaîne
	MESSAGE_V2 est une chaîne
	MESSAGE_V3 est une chaîne
	MESSAGE_V4 est une chaîne
FIN

STBAPI1090_2 est une Structure
	_CURRENCY est une chaîne 
	CURRENCYISO est une chaîne
	ALT_CUR est une chaîne 
	VALID_TO  est une Date
	LONG_TEXT est une chaîne 
FIN

tCURRENCY_LIST est un tableau de 0 STBAPI1090_2 
st_RETURN est un STRETURN

st_sRETURN est un STRETURN
SI PAS SAPExécute(IDSAP, "BAPI_CURRENCY_GETLIST", "RETURN,CURRENCY_LIST",st_RETURN,tCURRENCY_LIST) ALORS
	Erreur("Echec de la récupération des devises",ErreurInfo())
    RETOUR
FIN
// Fin du code généré

Trace(st_RETURN:_MESSAGE)

nNbLigne est un entier = TableauInfo(tCURRENCY_LIST, tiNombreTotal)
Trace(nNbLigne)
stCurr est un STBAPI1090_2
POUR i = 1 A nNbLigne
	stCurr = tCURRENCY_LIST[i]
	Trace(stCurr:CURRENCYISO + " : " + stCurr:LONG_TEXT + " date= " + stCurr:VALID_TO.Année)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = SAPExécute(<Identifiant de la connexion> , <Nom de la fonction> , <Liste des paramètres> [, <Valeur du paramètre 1> [... [, <Valeur du paramètre N>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la fonction a été exécutée, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur. La fonction [ErreurInfo](../WDLang1/3013008.md) permet d'obtenir plus de renseignements sur le problème rencontré.




**`<Identifiant de la connexion> : (Entier)`**

Identifiant de la connexion renvoyé par la fonction [SAPConnecte](../WDLang6/1000017120.md).

**`<Nom de la fonction> : (Chaîne de caractères)`**

Nom de la fonction à appeler.

**`<Liste des paramètres> : (Chaîne de caractères)`**

Liste des noms ABAP des paramètres, séparés par des virgules.

**`<Valeur du paramètre 1> : (Type attendu)`**

Valeur des paramètres, dans l'ordre de la &lt;Liste des paramètres&gt;. Dans le cas de paramètres de sortie, il faut indiquer une variable. Lorsqu'un paramètre est passé sans valeur, SAP ne prend pas la valeur par défaut, mais la valeur "vide" correspondant au type.



**`<Valeur du paramètre N> : (Type attendu)`**

Valeur des paramètres, dans l'ordre de la &lt;Liste des paramètres&gt;. Dans le cas de paramètres de sortie, il faut indiquer une variable. Lorsqu'un paramètre est passé sans valeur, SAP ne prend pas la valeur par défaut, mais la valeur "vide" correspondant au type.



<a name="NOTE0"></a>
<a name="XComposante"></a>

## Composante :
wd280mess.dll
