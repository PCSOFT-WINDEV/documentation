


## gpwOuvreSessionLDAP (Fonction)

***En anglais : gpwOpenLDAPSession***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Indique au groupware utilisateur que l'authentification des utilisateurs sera réalisée via un annuaire LDAP. Le nom et le mot de passe des utilisateurs qui se connecteront au groupware utilisateur seront vérifiés directement dans l'annuaire LDAP.

**Remarque** : Cette fonction est inutile si le paramétrage de l'utilisation de l'annuaire LDAP a été réalisé dans la fenêtre de paramétrage du groupware utilisateur. Pour paramétrer le groupware utilisateur, sous le volet "Projet", dans le groupe "Projet", cliquez sur "Groupware Utilisateur".
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Groupware utilisateur utilisé en mode automatique 
// Lancement manuel. Pas de fichiers de données. 

// Code du projet
gpwOuvreSessionLDAP("gemini.monserveur.com", 389, 3, Faux)

// Identification d'un utilisateur sans fenêtre de login
SI gpwLogin("FP", "FP") <> gpwOK ALORS
	Erreur("Utilisateur ou mot de passe incorrect")
	FinProgramme()
FIN
```


<a name="Exemple2"></a>

```wl
// Utilisation d'un DN de base 
gpwOuvreSessionLDAP("monserveur", 389, 3, Faux, "DC=groupcom,DC=local")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`gpwOuvreSessionLDAP(<Adresse du serveur> [, <Numéro de port> [, <Version du serveur> [, <Avec fichiers> [, <DN de base> [, <Gestion du SSL>]]]]])`
---

**`<Adresse du serveur> : (Chaîne de caractères)`**

Adresse du serveur LDAP. Ce paramètre peut correspondre :

- Adresse IP du poste serveur au format xxx.xxx.xxx.xxx

- Nom du poste serveur




**`<Numéro de port> : (Entier optionnel)`**

Numéro de port du serveur LDAP (par défaut 389).

**`<Version du serveur> : (Entier optionnel)`**

Version du serveur LDAP contacté (2 ou 3). Par défaut, correspond à 3.

**`<Avec fichiers> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> (valeur par défaut) pour utiliser les fichiers de données du groupware, 

- <u><u><u><u>Faux</u></u></u></u> pour réaliser uniquement une authentification LDAP.




**`<DN de base> : (Chaîne de caractères optionnelle)`**

DN de base à utiliser. Ce paramètre est de la forme : "DC=xxx, DC=yyy, DC=zzz, ...".  
Si ce paramètre n'est pas précisé, il sera automatiquement recherché dans la base. 

**`<Gestion du SSL> : (Constante ou combinaison de constantes de type Entier)`**

Mode de gestion du SSL : 



|   |   |
| --- | --- |
| *ldapOptionDéfaut*<br>(Valeur par défaut) | LDAP classique, sans gestion du SSL. |
| *optionSSL* | LDAP avec gestion d'une connexion sécurisée SSL. |
| *optionSSL* + *auNegotiate* | LDAP avec gestion d'une connexion sécurisée SSL et authentification. La connexion est effectuée via "Generic Security Services" (GSS) (Snego). La méthode d'authentification choisie est la méthode la plus appropriée présente dans une liste des authentifications possibles. |


Remarque : Le mode de connexion utilisé doit être supporté par le serveur LDAP. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Vérifications
<a name="verifications_ELTPARAGRAPHE000092"></a>Les vérifications de la connexion au serveur LDAP, du nom et du mot de passe de l'utilisateur sont réalisées :

- soit lors de l'appel à la fonction [gpwLogin](../WDLang6/3041001.md).

- soit lors de la validation de la fenêtre de login du groupware.




<a name="XComposante"></a>

## Composante :
wd280gpu.dll
