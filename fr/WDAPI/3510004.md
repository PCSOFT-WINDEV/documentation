


## WDAPI : Utiliser les API dans une application WINDEV
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000123"></a>
Deux des fonctionnalités les plus intéressantes de WDAPI sont les suivantes :

- la possibilité de consulter la liste des fonctions, structures et constantes des API Windows.

- la possibilité pour les fonctions et les constantes d'obtenir la syntaxe WLangage correspondante.




Ces fonctionnalités sont disponibles dans les volets "Fonctions", "Structures" et "Constantes" de WDAPI.

**Rappel** : WDAPI peut être lancé depuis WDOutil : sous le volet "Outils", dans le groupe "Utilitaires", cliquez sur "WDOutil".

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Consulter la liste des fonctions, structures et constantes API Windows
<a name="consulter_liste_des_fonctions_structures_constantes_api_windows_ELTTEXTE000147"></a>
Pour rechercher une fonction, une constante ou une structure :

1. Positionnez-vous sur le volet souhaité ("Fonctions", "Structures" ou "Constantes").

2. Cliquez sur la loupe présente dans l'entête de la colonne "Nom de la fonction" (ou "Nom de la structure" ou "Nom de la constante").

3. Tapez les premières lettres du nom de la fonction, constante ou structure recherchée. La table est alors automatiquement positionnée sur l'élément dont le nom se rapproche le plus de celui saisi.




**Exemple** : Dans le volet "Fonctions", la saisie du mot "Move" positionnera la liste sur les fonctions dont le nom commence par "Move".<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDAPI%20-%20HC%20N%B0001.gif)


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Génération et utilisation du code WLangage nécessaire à l'utilisation d'une API Windows
<a name="generation_utilisation_code_wlangage_necessaire_utilisation_une_api_windows_ELTTEXTE000171"></a>
Pour générer et utiliser le code WLangage correspondant à l'API Windows :

1. Sélectionnez la fonction ou la structure de l'API Windows à utiliser en WLangage.

2. WDAPI génère automatiquement le code WLangage nécessaire à l'utilisation de la fonction ou de la structure API.
	Si la fonction API nécessite l'utilisation d'une ou de plusieurs structures, WDAPI génère automatiquement le code WLangage correspondant à la déclaration de la ou des structures utilisées.
	Si vous souhaitez gérer les erreurs, sélectionnez l'option "Ajouter le code WLangage pour afficher un message en cas d'erreur".

3. Cliquez sur le bouton "Copier" associé à la syntaxe WLangage.

4. Dans votre projet WINDEV, sélectionnez le traitement devant appeler la fonction API Windows.

5. Dans l'éditeur de code, sélectionnez l'option "Coller" du menu contextuel (ou appuyez sur les touches Ctrl + V).

6. Adaptez le code copié à votre application : initialisez les variables selon votre programme.

7. Si des structures sont nécessaires, vous devez copier le code de déclaration de ces structures dans votre code WLangage. Pour cela :

	- Cliquez sur le bouton "Copier" associé au code de déclaration des structures WLangage.

	- Dans votre projet WINDEV, sélectionnez le traitement voulu :

		- traitement d'initialisation du projet (conseillé).

		- traitement de déclaration des globales de la fenêtre.

		- traitement de déclaration des globales de la collection de procédures dans laquelle l'appel à la fonction API est réalisé.




- Dans l'éditeur de code, sélectionnez l'option "Coller" du menu contextuel (ou appuyez sur les touches Ctrl + V).




**Cas rare** : Il se peut que certaines particularités liées à une fonction API Windows ne soit pas interprétées correctement par WDAPI. Vous devrez donc effectuer la conversion par vous-même.

Exemple :<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDAPI%20-%20HC%20N%B0002.gif)



