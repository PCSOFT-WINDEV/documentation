
## WDConver : Utilisation en mode ligne de commande
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000245"></a>


### Mode ligne de commande
<a name="mode_ligne_commande_ELTPARAGRAPHE000011"></a>L'utilisation de WDConver en mode ligne de commande consiste à exécuter une description de conversion créée et sauvegardée avec WDConver (fichier ".WDV").

Pour lancer WDConver en ligne de commande, la syntaxe est la suivante :


```txt
WDConver.EXE [-report][-error][-wizard]/SCRIPT=<FichierWDV>
```


**Détails des paramètres** :

| Paramètres | Signification |
| --- | --- |
| [-report] | Si ce paramètre est précisé, un compte-rendu sera affiché à la fin de l'exécution du script.<br>Par défaut, si ce paramètre n'est pas précisé, aucun compte-rendu ne sera affiché à la fin de l'exécution du script. |
| [-error] | Si ce paramètre est précisé, en cas d'erreur, un message sera affiché à la fin de l'exécution du script.<br>Par défaut, si ce paramètre n'est pas précisé, aucun message d'erreur ne sera affiché à la fin de l'exécution du script. |
| [-wizard] | Si ce paramètre est précisé, l'assistant de conversion des données se lancera.<br>Par défaut, si ce paramètre n'est pas précisé, l'assistant de conversion des données ne se lancera pas. |
| /SCRIPT=&lt;FichierWDV&gt; | Chaîne de caractères contenant le nom et le chemin complet de la description de conversion à utiliser (fichier ".WDV").<br>Ce paramètre est **obligatoire** sauf si le paramètre "-wizard" est spécifié. |
| /WDD=&lt;Chemin analyse&gt; | Chaîne de caractères contenant le chemin de l'analyse WINDEV, WEBDEV ou WINDEV Mobile. Si ce chemin contient des espaces, il doit être mis entre guillemets. |
| /PWD=&lt;Mot de passe (non crypté) de l'analyse&gt; | Chaîne de caractères contenant le mot de passe de l'analyse WINDEV, WEBDEV ou WINDEV Mobile. Si ce mot de passe contient des espaces, il doit être mis entre guillemets. |
| /WDD55=&lt;Chemin analyse WINDEV 5.5&gt; | Chaîne de caractères contenant le chemin de l'analyse WINDEV 5.5. Si ce chemin contient des espaces, il doit être mis entre guillemets. |
| /PWD55=&lt;Mot de passe (non crypté) de l'analyse WINDEV 5.5&gt; | Chaîne de caractères contenant le mot de passe de l'analyse WINDEV 5.5. Si ce mot de passe contient des espaces, il doit être mis entre guillemets. |
| /SRCDIR=&lt;Répertoire des fichiers de données Hyper File 5.5 recherchés&gt; | Chaîne de caractères contenant le chemin des fichiers de données Hyper File 5.5 à convertir. |
| /DSTDIR=&lt;Répertoire des fichiers de données convertis&gt; | Chaîne de caractères contenant le répertoire où les fichiers de données converti au format HFSQL Classic seront créés. |
| /FILE=&lt;Fichier de données source&gt; | Chaîne de caractères contenant :<br><br>- soit le chemin du fichier de données Hyper File 5.5 à convertir<br><br>- soit le nom de la table à convertir sur le serveur.<br><br><br> |
| /NAME=&lt;Nom logique dans l'analyse WINDEV 5.5 du fichier à convertir&gt; | Chaîne de caractères correspondant au nom logique du fichier de données à convertir dans l'analyse WINDEV, WEBDEV ou WINDEV Mobile. |
| /FILEPWD55=&lt;Mot de passe non crypté du fichier source&gt; | Chaîne de caractères correspondant au mot de passe du fichier WINDEV 5.5 à convertir. |
| /FILEDST=&lt;Chemin destination du fichier converti&gt; | Chaîne de caractères correspondant au chemin du fichier converti |
| /NOREP | Permet d'ignorer le fichier .REP au format WINDEV 5.5. |
| /MODE=[HF5 \ EXTERN \ XML \ TEXT] Type des fichiers sources | Définit le format des fichiers à importer :<br><br>- HF5 : fichiers de données Hyper File 5.5<br><br>- EXTERN : fichiers/tables externes (exemple : base C/S)<br><br>- XML : fichiers XML<br><br>- TEXT : fichiers texte<br><br><br> |
| /PROVIDER=&lt;Provider OLEDB ou Connecteur Natif&gt; | Chaîne de caractères permettant de définir le provider ou le Connecteur Natif (également appelé Accès Natif) permettant d'accéder aux données à convertir.<br>Pour les Connecteurs Natifs, utilisez les chaînes de caractères suivantes : WinDevOracle, WinDevSQLServer, WinDevInformix, ... |
| /DATASOURCE=&lt;Nom de la source (fichier ou serveur)&gt; | Chaîne de caractères. Ce paramètre est utilisé lors de la conversion d'un fichier par Connecteur Natif, provider OLE DB, ...<br>Correspond au nom de la source de données. |
| /USER=&lt;Nom utilisateur&gt; | Chaîne de caractères. Correspond au nom de l'utilisateur de la source de données. |
| /USERPWD=&lt;Mot passe non crypté utilisateur&gt; | Chaîne de caractères. Correspond au mot de passe de l'utilisateur de la source de données. |
| /DATABASE=&lt;Nom base de données&gt; | Chaîne de caractères. Correspond à la base de données accédée (s'il en existe plusieurs sur le serveur). |

**Remarque** : Le tableau ci-dessus présente les différents paramètres pouvant être utilisés pour lancer WDConver en mode ligne de commande. Pour obtenir directement ces paramètres lors du lancement de WDConver, utilisez une des syntaxes suivantes :

- WDConver.EXE /help

- WDConver.EXE /?




**Remarque** : Les scripts créés avec une version antérieure de WINDEV 7 ne sont pas utilisables avec WDConver version 8 et supérieure. Les scripts créés avec WINDEV 7.5 sont utilisables avec WDConver version 8 et supérieure.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Exemples
<a name="exemples_ELTTEXTE000269"></a>


### Exemple d'utilisation d'un script :
<a name="exemple_utilisation_script_ELTPARAGRAPHE000161"></a>La ligne de commande suivante permet d'exécuter la description de conversion "C:\\MonRépertoire\\MaDescription.WDV". En cas d'erreur, un message sera affiché à la fin de la modification automatique des fichiers de données (paramètre "-error"). L'assistant de la modification automatique des fichiers de données ne se lancera pas.


```wl
LanceAppli("C:\MesOutils\WDConver.EXE " +...
	"-error/SCRIPT=C:\MonRépertoire\MaDescription.WDV")
```



<a name="NOTE2_2"></a>


### Exemple d'utilisation
<a name="exemple_utilisation_ELTPARAGRAPHE000171"></a>La ligne de commande suivante permet de :

- Sélectionner tous les fichiers Hyper File 5 accessibles par le fichier ".REP" et dans le répertoire "C:\\data".

- Convertir ces fichiers au format HFSQL Classic dans le répertoire "C:\\dataclassic".





```wl
LanceAppli("C:\MesOutils\WDConver.EXE " +...
	"/WDD55=C:\WDProjet\Projet5\Projet.WD5\Projet.WDD" +... 
	"/WDD=""C:\Mes Projets\Projet\Projet.wdd" +...
	"/SRCDIR=""C:\data"" /DSTDIR=c:\dataclassic")
```

<a name="NOTE2_3"></a>


### Exemple de conversion d'un seul fichier
<a name="exemple_conversion_seul_fichier_ELTPARAGRAPHE000183"></a>La ligne de commande suivante permet de convertir uniquement un fichier spécifique :


```wl
LanceAppli("C:\MesOutils\WDConver.EXE " +... 
	"/WDD55=C:\WDProjet\Projet5\Projet.WD5\Projet.WDD " +...
	"/WDD=C:\Mes Projets\Projet\Projet.wdd " +...
	"/FILE=C:\data\echange.fic /NAME=ECHANGE " +...
	"/DSTDIR=c:\dataclassic /NOREP")
```



<a name="NOTE2_4"></a>


### Exemple de conversion en utilisant un Connecteur Natif (ou Accès Natif)
<a name="exemple_conversion_utilisant_connecteur_natif_acces_natif_ELTPARAGRAPHE000193"></a>La ligne de commande suivante permet de convertir à l'aide du Connecteur Natif Oracle la table "DEMO.CUSTOMER". Cette table a pour nom logique "CUSTOMER" sur le serveur "MARS". Le fichier HFSQL Classic sera créé dans le répertoire "c:\\data".


```wl
LanceAppli("C:\MesOutils\WDConver.EXE " +...
	"/MODE=EXTERN /DATASOURCE=MARS "+...
	"/PROVIDER=WinDevOracle /USER=DEMO "+...
	"/USERPWD=DEMO "+...
	"/WDD=""C:\Mes Projets\test.ANA\test.wdd"""+...
	"/DSTDIR=c:\data /FILE=DEMO.CUSTOMER /NAME=CUSTOMER")
```





