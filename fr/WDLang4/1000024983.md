


## &lt;Source&gt;.FusionneVue (Fonction)

***En anglais : &lt;Source&gt;.MergeView***

<DIV class="specObsolete">
	<IMG style="float:left;margin-right:10px;" src="https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=warning_big.png"><B>Avertissement</B><BR>
	A partir de la version <B>20</B>,  les vues SQL et les vues matérialisées sont disponibles.<br>Les vues manipulées par cette fonction correspondent à l'ancien mécanisme des vues. Elles ne correspondent ni aux vues SQL ni aux vues matérialisées.
</DIV>

<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Crée une vue HFSQL à partir de deux vues précédemment créées (fonction [&lt;Source&gt;.CréeVue](../WDLang4/1000024209.md)). Un grand nombre d'opérations ensemblistes peut être réalisé lors de la fusion des vues.

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Union de deux vues
MaVue est une Source de Données
VueClient84 est une Source de Données
...
MaVue.FusionneVue(VueClient84, VueClient84, hVueUnion, "+NomCli")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Source>.FusionneVue(<Première vue> , <Seconde vue> , <Type d'opération> , <Rubrique de tri de la première vue> [, <Rubrique de tri de la seconde vue> [, <Mode de création> [, <Taille d'une page>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la vue a été créée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Source> : (Type de la Source)`**

Nom de la vue à créer, résultat de l'opération effectuée sur les deux vues spécifiées.

**`<Première vue> : (Chaîne de caractères)`**

Nom de la première vue participant à l'opération.

**`<Seconde vue> : (Chaîne de caractères)`**

Nom de la seconde vue participant à l'opération.

**`<Type d'opération> : (Constante de type Entier)`**

Opération à réaliser entre les deux vues spécifiées :


|   |   |
| --- | --- |
| *hVueIntersection* | Lignes communes à la &lt;Première vue&gt; et de la &lt;Seconde vue&gt;. |
| *hVueJointure* | Jointure de la première vue et de la seconde vue. |
| *hVueSoustraction* | Lignes de la &lt;Première vue&gt; sans les lignes communes avec la &lt;Seconde vue&gt;. |
| *hVueUnion* | Union de toutes les lignes de la &lt;Première vue&gt; et de la &lt;Seconde vue&gt;. <br>Les structures des vues doivent être identiques. |
| *hVueUnionEx* | Union de toutes les lignes non communes de la &lt;Première vue&gt; et de la &lt;Seconde vue&gt;. <br>Les structures des vues doivent être identiques. |

![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Vueensem.gif)


**`<Rubrique de tri de la première vue> : (Chaîne de caractères)`**

Nom de la rubrique à utiliser sur la première vue pour réaliser l'opération. Cette rubrique sera également utilisée pour trier la vue destination.

**`<Rubrique de tri de la seconde vue> : (Chaîne de caractères optionnelle)`**

Nom de la rubrique à utiliser sur la seconde vue pour réaliser l'opération. Si ce paramètre n'est pas précisé, il est égal à la valeur de &lt;Rubrique de tri de la première vue&gt;.

**`<Mode de création> : (Constante ou combinaison de constantes optionnelle de type Entier)`**

Paramètre le mode de création de la vue.


|   |   |
| --- | --- |
| *hVueAjoute* | Conserve le contenu de la vue lors du prochain appel à la fonction [&lt;Source&gt;.ExécuteVue](../WDLang4/1000024949.md). |
| *hVueBlocage* | Les enregistrements lus dans le fichier de données et intégrés à la vue sont bloqués.<br> |
| *hVueDéfaut* | Mode de création de vue par défaut. |
| *hVueDifférée* | La vue est créée, mais sera exécutée en différé avec la fonction [&lt;Source&gt;.ExécuteVue](../WDLang4/1000024949.md). |
| *hVueDistincte* | La vue est créée avec élimination des doublons par rapport à la clé de tri. |
| *hVueExclusive* | Optimise le temps de création de la vue en bloquant directement tout le fichier de données source. |
| *hVueInterruptible* | La création de la vue est interruptible au moyen de la touche ECHAP. |



**`<Taille d'une page> : (Entier optionnel)`**

Nombre d'enregistrements par page (pour une vue utilisée par accès distant).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Influence des rubriques de tri
<a name="influence_des_rubriques_tri_ELTPARAGRAPHE000325"></a>Les rubriques de tri permettent de définir les rubriques sur lesquelles sera réalisée l'opération demandée. Ainsi, une opération d'intersection retournera tous les enregistrements de la première vue pour lesquels la rubrique &lt;Rubrique de tri de la première vue&gt; est égale à &lt;Rubrique de tri de la seconde vue&gt; pour au moins un enregistrement de la seconde vue.
<a name="NOTE0_2"></a>


### Manipulation des rubriques de la vue après une jointure
<a name="manipulation_des_rubriques_vue_apres_une_jointure_ELTPARAGRAPHE000335"></a>Les rubriques issues d'une jointure sont nommées de la manière suivante :

- si le nom de la rubrique existe dans une seule des vues source, ce nom de rubrique est conservé dans la jointure.

- si le nom existe dans les 2 sources, la rubrique de la jointure correspondant à la rubrique de la seconde vue est renommée en "*NomVue2_NomRubrique*".




Dans tous les cas, il est également possible d'accéder aux rubriques de la jointure en utilisant la syntaxe suivante :

```txt
<Nom de la vue d'origine>_<Nom de la rubrique>
```
Exemples :

- La vue1 nommée "VueClient" contient les rubriques : IDClient, IDCommande, Nom.

- La vue2 nommée "VueCommande" contient les rubriques : IDCommande, Nom, Produit.

- La jointure nommée "ClientCommande" est créée à partir des vues "VueClient" et "VueCommande" sur la rubrique "IDCommande". La vue "ClientCommande" contient les rubriques suivantes : IDClient, IDCommande, Nom, VueCommande_Nom, Produit.
	

| Accès à la rubrique : | Syntaxe utilisée |
| --- | --- |
| IDClient | ClientCommande.IDClient <br>ou <br>ClientCommande.VueClient_IDClient |
| IDCommande | ClientCommande.IDCommande<br>ou <br>ClientCommande.VueClient_IDCommande<br>ou <br>ClientCommande.VueCommande_IDCommande |
| Nom | ClientCommande.Nom<br>ou<br>ClientCommande.VueClient_Nom |
| VueCommande_Nom | ClientCommande.VueCommande_Nom |
| Produit | ClientCommande.Produit<br>ou<br>ClientCommande.VueCommande_Produit |





<a name="NOTE0_3"></a>


### Jointures : différences de résultat dans les recherches selon l'ordre des vues utilisées dans la jointure
<a name="jointures_differences_resultat_dans_les_recherches_selon_ordre_des_vues_utilisees_dans_jointure_ELTPARAGRAPHE000402"></a>Lors d'une jointure entre deux vues, l'index de la seconde vue est utilisé pour effectuer des recherches sur le résultat de la jointure. Le résultat de la recherche peut être différent selon les caractéristiques de l'index utilisé dans la jointure.

Exemple :

- Caractéristiques de la rubrique clé *MaRubrique* dans la Vue1 : Recherches insensibles à la casse.

- Caractéristiques de la rubrique *MaRubrique* dans la Vue2 : Recherches sensibles à la casse.




Une fusion est réalisée entre ces deux vues. Selon l'ordre des vues fusionnées, le résultat de la recherche sera différent :

- HFusionneVue(Vue3, Vue1, Vue2) : la recherche est effectuée sur la vue2 : 15 enregistrements sont trouvés.

- HFusionneVue(Vue3, Vue2, Vue1) : la recherche est effectuée sur la vue1 : 63 enregistrements sont trouvés.



<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) 

### Hyper File 5.5
<a name="hyper_file_55_ELTPARAGRAPHE000424"></a>Pour manipuler une base de données au format Hyper File 5 avec la fonction **&lt;Source&gt;.FusionneVue**, vous devez réaliser la fusion avec la fonction **HCréeVue_55**.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
