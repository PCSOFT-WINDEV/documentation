


## HExtraitMémo (Fonction)

***En anglais : HExtractMemo***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Extrait le contenu d'une rubrique de type mémo binaire d'un fichier de données HFSQL, d'une requête ou d'une vue HFSQL dans un fichier physique (sur le disque).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003044072&name=hextraitmemo_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
HExtraitMémo(Client, Photo, "C:\temp\Photo.bmp")
```
<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Photo du produit
SI HExtraitMémo(SQLLitMémo("MaRequete", 2), "Produit.BMP") = Faux ALORS
	RENVOYER Faux
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Extraire un mémo

`<Résultat> = HExtraitMémo(<Fichier de données> , <Rubrique Mémo> [, <Fichier destination>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données (de la requête ou de la vue) manipulé. Si ce nom n'est pas spécifié, la fonction **HExtraitMémo** va manipuler le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Rubrique Mémo> : (Chaîne de caractères)`**

Nom de la rubrique contenant le mémo binaire à extraire.

**`<Fichier destination> : (Chaîne de caractères optionnelle)`**

Chemin et nom complet du fichier dans lequel le contenu de la rubrique doit être sauvegardé. Si ce paramètre n'est pas précisé, le mémo binaire est sauvegardé dans son chemin et fichier d'origine. Les dates de création et de dernière modification de ce fichier sont restaurées.
![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Ce paramètre est obligatoire car le nom du fichier d'origine n'est pas enregistré dans les mémos OLE DB.


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Extraire un mémo (syntaxe pour SQLLitMémo)

`<Résultat> = HExtraitMémo(<Mémo binaire> , <Fichier destination>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Mémo binaire> : (Chaîne de caractères)`**

Mémo binaire retourné par la fonction [SQLLitMémo](../WDLang4/3072020.md).

**`<Fichier destination> : (Chaîne de caractères)`**

Chemin et nom complet du fichier dans lequel le contenu de la rubrique doit être sauvegardé.
![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Ce paramètre est obligatoire car le nom du fichier d'origine n'est pas enregistré dans les mémos OLE DB.


<a name="SYNTAXE3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
### Extraire un mémo à partir d'une variable de type Enregistrement

`<Résultat> = HExtraitMémo(<Rubrique Mémo> [, <Fichier destination>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Rubrique Mémo> : (Variable de type Enregistrement)`**

Nom de la rubrique contenant le mémo binaire à extraire. Utilisez la notation &lt;Nom variable Enregistrement&gt;.&lt;Nom rubrique mémo&gt;.

**`<Fichier destination> : (Chaîne de caractères optionnelle)`**

Chemin et nom complet du fichier dans lequel le contenu de la rubrique doit être sauvegardé. Si ce paramètre n'est pas précisé, le mémo binaire est sauvegardé dans son chemin et fichier d'origine. Les dates de création et de dernière modification de ce fichier sont restaurées.
![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Ce paramètre est obligatoire car le nom du fichier d'origine n'est pas enregistré dans les mémos OLE DB.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png) 

### Rubrique mémo binaire utilisant des vignettes HFSQL
<a name="rubrique_memo_binaire_utilisant_des_vignettes_hfsql_ELTPARAGRAPHE000189"></a>Pour extraire le contenu d'une vignette HFSQL d'une rubrique HFSQL, utilisez la propriété [Vignette](../Proprietes/2512115.md).

Pour plus de détails sur les vignettes HFSQL, consultez [Vignettes HFSQL](../WDLang4/3044348.md).
<a name="NOTE0_2"></a>
![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Gestion des mémos sous SQLite
<a name="gestion_des_memos_sous_sqlite_ELTPARAGRAPHE000208"></a>Le stockage d'informations sous forme de mémos est conseillé uniquement pour des données de taille peu volumineuse (inférieures à 1 Mo). Il est recommandé d'enregistrer directement les données sous forme de fichier externe sur la mémoire du téléphone (interne ou externe) et de mémoriser dans la base uniquement le chemin d'accès à ces données.  
<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Versions précédentes
<a name="versions_precedentes_ELTPARAGRAPHE000217"></a>Cette fonction remplace la fonction **BinaireSauve**, conservée par compatibilité avec WINDEV 5.5.



<a name="XComposante"></a>

## Composante :
wd280hf.dll
