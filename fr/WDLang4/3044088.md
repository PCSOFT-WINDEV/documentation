
## HErreur (Fonction)

***En anglais : HError***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie le numéro de la dernière erreur déclenchée par le moteur HFSQL.

**Remarque** : Cette fonction doit être appelée immédiatement après l'appel de la fonction qui échoue. En effet, l'appel à une fonction (différente d'une fonction d'erreur) peut ré-initialiser et modifier le compte-rendu de la fonction **HErreur**.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003044088&name=herreur_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Gestion d'une erreur lors de la création d'un fichier
SI HCréation(Client) = Faux ALORS
	Erreur("Erreur HFSQL : " + HErreur())
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HErreur([<Type d'erreur>])`
---

**`<Résultat> : (Entier)`**



- Numéro de la dernière erreur rencontrée.

- Constante *hSuccès* (vaut 0) dans les cas suivants :

	- Aucune erreur n'est survenue.

	- Le type d'erreur demandé correspondait à une sous-erreur mais aucune sous-erreur n'est survenue.







**`<Type d'erreur> : (Constante optionnelle de type entier.)`**

Permet de récupérer les numéros des sous-erreurs.


|   |   |
| --- | --- |
| *hErrEnCours*<br>(valeur par défaut) | Numéro de l'erreur en cours. |
| *hErrPrincipal* | Numéro de l'erreur principale. |
| *hSousErrDernier* | Numéro de la dernière sous-erreur. |
| *hSousErrPrécédent* | Numéro de la sous-erreur précédente. |
| *hSousErrPremier* | Numéro de la première sous-erreur. |
| *hSousErrSuivant* | Numéro de la sous-erreur suivante. |





![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre est ignoré.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Numéros d'erreur HFSQL
<a name="numeros_erreur_hfsql_ELTPARAGRAPHE000110"></a>Pour connaître les principaux numéros des erreurs HFSQL, consultez : les [erreurs HFSQL](../WDLang4/3044177.md).


<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Gestion des sous-erreurs
<a name="gestion_des_souserreurs_ELTPARAGRAPHE000123"></a>Diverses fonctions génèrent deux niveaux d'erreur. Ces deux niveaux d'erreur permettent d'affiner la cause de l'erreur, en effectuant par exemple un simple parcours entre les différentes sous-erreurs (voir exemple).

Les principales fonctions générant des sous-erreurs sont : [HCréeVue](../WDLang4/3044159.md), [HExécuteVue](../WDLang4/3044079.md), [HVueVersFichier](../WDLang4/3044021.md), ...

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
