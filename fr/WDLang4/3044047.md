


## HLit (Fonction)

***En anglais : HRead***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Lit un enregistrement dans un fichier de données en fonction d'un numéro d'enregistrement donné. Ce mode de lecture est appelé "Accès direct". L'enregistrement lu est chargé en mémoire. La fonction [HEtat](../WDLang4/3044081.md) permet de connaître l'état de l'enregistrement (actif, rayé ou supprimé).

En général, la fonction **HLit** permet de se positionner dans le fichier de données pour effectuer une boucle de lecture en précisant le numéro d'enregistrement.

Après l'exécution de la fonction **HLit**, plusieurs cas peuvent se présenter :

- le numéro d'enregistrement spécifié n'existe pas (supérieur au nombre total d'enregistrements ou négatif) : aucune lecture n'est effectuée et la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u>Vrai</u></u></u>.

- le numéro d'enregistrement spécifié n'existe plus (enregistrement rayé, supprimé, ...) : aucune lecture n'est effectuée et la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u>Faux</u></u></u>.
	Utilisez la fonction [HEtat](../WDLang4/3044081.md) pour connaître l'état de l'enregistrement.

- le fichier de données est vide : la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u>Vrai</u></u></u>.

- la fonction tente de bloquer un enregistrement déjà bloqué en lecture : la fonction [HErreurBlocage](../WDLang4/3044099.md) renvoie <u><u><u>Vrai</u></u></u> et la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u>Vrai</u></u></u>.
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : La gestion des blocages n'est pas disponible sur les bases de données accédées par JDBC.




Cette fonction peut être utilisée indifféremment avec les fichiers de données (indexés ou non) ou les vues HFSQL.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Parcours séquentiel pour afficher le nom de tous les clients
i est un entier
POUR i = 1 _A_ HNbEnr(Client, hEtatTous)
	HLit(Client, i)
	SI HEtat() = hEtatActif ALORS 
		Info("Nom du client : " + Client.Nom)
	FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HLit([<Fichier de données> [, <Numéro d'enregistrement> [, <Options>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'enregistrement a été lu, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur (blocage, fin du fichier de données, ...) : l'enregistrement n'est pas lu. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données HFSQL, de la vue ou de la requête manipulé.

Si ce paramètre correspond à une chaîne vide (""), la fonction **HLit** manipule le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Numéro d'enregistrement> : (Entier optionnel)`**

Numéro de l'enregistrement à lire.

Si ce paramètre n'est pas spécifié (ou est égal à 0 ou à la constante *hNumEnrEnCours*), la fonction **HLit** va manipuler l'enregistrement en cours.
![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) La fonction **HLit** lit uniquement l'enregistrement en cours. Il est impossible de spécifier un numéro d'enregistrement différent de celui en cours. Pour désigner l'enregistrement en cours, utilisez la constante *hNumEnrEnCours*.![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : La fonction **HLit** lit uniquement l'enregistrement en cours. Il est impossible de spécifier un numéro d'enregistrement différent de celui en cours. Pour désigner l'enregistrement en cours, utilisez la constante *hNumEnrEnCours*. 

**`<Options> : (Constante optionnelle)`**

Paramètre le blocage réalisé sur l'enregistrement lu par la fonction **HLit** :


|   |   |
| --- | --- |
| *hBlocageEcriture* | Blocage en écriture : l'enregistrement en cours de lecture pourra être lu par une autre application mais ne pourra pas être modifié par une autre application. |
| *hBlocageLectureEcriture* | Blocage en lecture/écriture : l'enregistrement en cours de lecture ne pourra ni être lu ni être modifié par une autre application. |
| *hBlocageNon* | Aucun blocage : l'enregistrement pourra être lu ou modifié par une autre application pendant la lecture. |

![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Les options de blocage ne sont pas prises en compte. Utilisez des fonctions de blocage ([HBloqueNumEnr](../WDLang4/3044152.md)) conservées par compatibilité.![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Si le provider OLE DB ou le Connecteur Natif utilisé ne gère pas les blocages, les options de blocage seront sans effet.![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Ce paramètre est ignoré.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Langage Externe](https://doc.pcsoft.fr/ext/images/fr/LE.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) 

### Enregistrements lus
<a name="enregistrements_lus_ELTPARAGRAPHE000217"></a>La fonction **HLit** est la seule fonction permettant d'accéder à un enregistrement rayé ou supprimé. Si l'enregistrement est supprimé, le contenu de l'enregistrement n'est plus valide.
<a name="NOTE0_2"></a>


### Parcours d'un fichier de données
<a name="parcours_fichier_donnees_ELTPARAGRAPHE000229"></a>La fonction **HLit** ne permet pas de poursuivre un parcours effectué avec les fonctions [HLitPremier](../WDLang4/3044051.md), [HLitSuivant](../WDLang4/3044037.md).
<a name="NOTE0_3"></a>


### Mémos
<a name="memos_ELTPARAGRAPHE000247"></a>Les mémos associés à l'enregistrement peuvent être automatiquement lus ou non lors de la lecture de l'enregistrement. La fonction [HGèreMemo](../WDLang4/3044139.md) permet de personnaliser cette lecture automatique.

Si les mémos sont gérés, lorsque l'enregistrement est lu, les mémos texte associés sont également lus. Les mémos binaires ne sont lus que lorsqu'ils sont utilisés explicitement (fonction [HExtraitMémo](../WDLang4/3044072.md)).
<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Langage Externe](https://doc.pcsoft.fr/ext/images/fr/LE.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Blocages
<a name="blocages_ELTPARAGRAPHE000266"></a>Par défaut (paramètre &lt;Option&gt; non spécifié), aucun blocage de l'enregistrement n'est réalisé.

Si un blocage est demandé (paramètres *hBlocageEcriture* ou *hBlocageLectureEcriture*), la lecture de l'enregistrement sera réalisée uniquement si cet enregistrement n'est pas déjà bloqué.

![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Si le provider OLE DB ou le Connecteur Natif utilisé ne gère pas les blocages, les options de blocage seront sans effet.
<a name="NOTE0_5"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000281"></a>

- Le résultat de la fonction [HTrouve](../WDLang4/3044104.md) doit être ignoré (la fonction [HTrouve](../WDLang4/3044104.md) doit être utilisée pour les recherches réalisées avec les fonctions [HLitRecherchePremier](../WDLang4/3044036.md) et [HLitRechercheDernier](../WDLang4/3044034.md)).

- Le numéro de l'enregistrement en cours est connu avec la fonction [HNumEnr](../WDLang4/3044063.md). Le numéro du premier enregistrement du fichier de données est 1.

- Cette fonction remplace les fonctions **HLitBloque** et **HLitSansBloquer**, conservées par compatibilité avec WINDEV 5.5.




<a name="XComposante"></a>

## Composante :
wd280hf.dll
