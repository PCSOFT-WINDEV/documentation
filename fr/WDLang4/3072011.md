
## SQLAvance (Fonction)

***En anglais : SQLFetch***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Passe à la ligne suivante (c'est-à-dire à l'enregistrement suivant) du résultat de la requête.

Lors du premier appel de la fonction **SQLAvance** (également nommée **SQLFetch**), l'enregistrement en cours sera le premier des enregistrements sélectionnés par la requête.

Cette fonction permet de parcourir le résultat de la requête "ligne à ligne". Pour plus de détails sur les différents types de parcours du résultat d'une requête, consultez [Types de parcours SQL](../WDLang4/3072025.md).

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Pour optimiser les performances, il est conseillé d'utiliser [un parcours de type SQLPremier/SQLSuivant](../WDLang4/3072025.md).






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![ODBC](https://doc.pcsoft.fr/ext/images/fr/ODBC.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 
```wl
i est un entier = 0
SQLExec("SELECT NOM, PRENOM, POSTE, PHOTO FROM CLIENT", "REQ1")
// Récupérer la requête ligne à ligne
TANTQUE SQLAvance("REQ1") = 0
	// Il y a encore une ligne à lire
	i++
	// Récupérer les données
	NOM[i] = SQLLitCol("REQ1", 1)
	PRENOM[i] = SQLLitCol("REQ1", 2)
	POSTE[i] = SQLLitCol("REQ1", 3)
	{"IMAGE"+i} = SQLLitMémo("REQ1", 4)
FIN
SQLFerme("REQ1")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = SQLAvance(<Nom de la requête>)`
---

**`<Résultat> : (Entier)`**

0 si la lecture de l'enregistrement s'est bien passée. Les données peuvent être récupérées avec les fonctions [SQLLitCol](../WDLang4/3072019.md) et [SQLLitMémo](../WDLang4/3072020.md).

**`<Nom de la requête> : (Chaîne de caractères)`**



- Nom de la requête créée et exécutée avec la fonction [SQLExec](../WDLang4/3072007.md),

- Nom de la requête exécutée avec la fonction [SQLExecWDR](../WDLang4/3072010.md).




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les requêtes créées avec l'éditeur de requêtes doivent être spécifiées sous forme d'une chaîne de caractères avec guillemets. 





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### SQLAvance/SQLFetch : Récupération partiel du résultat de la requête
<a name="sqlavancesqlfetch_recuperation_partiel_resultat_requete_ELTPARAGRAPHE000126"></a>La fonction **SQLAvance** ne lance pas la récupération de toutes les lignes du résultat de la requête : seul l'enregistrement en cours est récupéré par la fonction **SQLAvance**.

Par conséquent, la récupération du nombre total de lignes du résultat (*SQL.NbLig*) avec la fonction [SQLInfoGene](../WDLang4/3072028.md) n'est pas possible si la fonction **SQLAvance** est utilisée pour parcourir le résultat.


<a name="NOTE0_2"></a>
![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) 

### Durée de vie d'un parcours 
<a name="duree_vie_parcours_ELTPARAGRAPHE000150"></a>La durée de vie d'un parcours réalisé avec la fonction **SQLAvance** est limitée à la durée du script PHP. Il n'est pas possible de continuer un parcours avec la fonction **SQLAvance** après avoir renvoyé la page (même en mode session).

<a name="XComposante"></a>

## Composante :
wd280hf.dll
