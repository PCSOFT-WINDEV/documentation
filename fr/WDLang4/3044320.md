


## HInfoDroitBaseDeDonnées (Fonction)

***En anglais : HInfoDatabaseRights***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet de connaître les droits sur une base de données définis pour un utilisateur ou un groupe.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003044320&name=hinfodroitbasededonnees_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
LesDroits est une chaîne
UnDroit est une chaîne
// Récupère les droits de lecture et d'ajout de l'utilisateur Dupont 
// sur la base de données MaBase
LesDroits = HInfoDroitBaseDeDonnées("CNX", "Dupont", ...
		hDroitLecture + hDroitAjout, "MaBase")
UnDroit = ExtraitChaîne(LesDroits, rangPremier, TAB)
TANTQUE UnDroit <> EOT
	SELON UnDroit
		CAS hAutorisé
		...
		CAS hInterdit
		...
		CAS hHérité
		... 
	FIN    
	UnDroit = ExtraitChaîne(LesDroits, rangSuivant, TAB)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HInfoDroitBaseDeDonnées(<Connexion> , <Utilisateur/Groupe> , <Droits> , <Base de données> [, <Mode d'affichage>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Informations demandées, 

- Chaîne vide ("") en cas d'erreur. 

- "Utilisateur inconnu" ou "Groupe inconnu" si l'utilisateur en cours n'a pas le droit de visualisation des utilisateurs (constante *hDroitVisualisationUtilisateur*) et s'il demande des informations concernant un autre utilisateur ou groupe.




Les informations demandées varient selon le paramètre &lt;Mode d'affichage du résultat&gt; : 

- **En mode hDéfaut**, &lt;Résultat&gt; est une liste de valeurs séparée par des tabulations (TAB). 
	
	```txt
	<Valeur du droit 1> + TAB + ... + TAB + <Valeur du droit N>
	```

	où &lt;Valeur du droit&gt; correspond à la valeur du droit demandé par le paramètre &lt;Droits&gt;. Chaque valeur de cette liste peut correspondre à l'une des constantes suivantes :
	


|   |   |
| --- | --- |
| *hAutorisé* | L'utilisateur ou le groupe a le droit considéré. |
| *hHérité* | L'utilisateur appartient à au moins un groupe pour lequel le droit considéré a été autorisé.<br>Cette constante est renvoyée uniquement si le mode d'affichage n'est pas *hEffectif*. |
| *hInterdit* | L'utilisateur ou le groupe n'a pas le droit considéré. |



- **En mode hDétail**, &lt;Résultat&gt; est une liste de valeurs de la forme : 
	
	```txt
	<Droit considéré 1> + TAB + <Valeur du droit 1> + RC + ...
	<Droit considéré N> + TAB + <Valeur du droit N> + RC
	```

	où : 

	- &lt;Droit considéré&gt; correspond à une des constantes utilisées dans le paramètre &lt;Droit&gt;. 

	- &lt;Valeur du droit&gt; correspond à une des constantes : 
			


|   |   |
| --- | --- |
| *hAutorisé* | L'utilisateur ou le groupe a le droit considéré. |
| *hHérité* | L'utilisateur appartient à au moins un groupe pour lequel le droit considéré a été autorisé.<br>Cette constante est renvoyée uniquement si le mode d'affichage n'est pas *hEffectif*. |
| *hInterdit* | L'utilisateur ou le groupe n'a pas le droit considéré. |




**`<Connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion pour laquelle les droits d'un utilisateur ou d'un groupe d'utilisateurs doivent être connus. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).




**`<Utilisateur/Groupe> : (Chaîne de caractères)`**

Nom de l'utilisateur ou du groupe dont on veut connaître les droits.

**`<Droits> : (Constante ou combinaison de constantes de type Entier)`**

Liste des droits à rechercher :


|   |   |
| --- | --- |
| *hDroitAjout* | Droit d'ajouter de nouveaux enregistrements dans un fichier de données. |
| *hDroitBlocage* | Droit de bloquer les fichiers de données ou les enregistrements d'un fichier de données. |
| *hDroitChangeDroit* | Droits de changer les droits. |
| *hDroitChangeLiaison* | Droit de modifier les règles d'intégrité sur un fichier de données. |
| *hDroitChangePropriétaire* | Droit de modifier le propriétaire d'un élément. |
| *hDroitConnexion* | Droit de se connecter à un serveur (connexion cryptée et non cryptée). |
| *hDroitConnexionCryptée* | Droit de se connecter à un serveur (connexion cryptée uniquement). |
| *hDroitCréationFichier* | Droit de créer un fichier de données (avec la fonction [HCréation](../WDLang4/3044255.md)). |
| *hDroitCréationVue* | Droit de créer une vue. |
| *hDroitDéboguer* | Droit de déboguer les procédures stockées. |
| *hDroitExécutionProcédure* | Droit d'exécuter une procédure stockée. |
| *hDroitGèreDoublon* | Droit de brancher et de débrancher la gestion des doublons. |
| *hDroitGèreIntégrité* | Droit de brancher et de débrancher la gestion de l'intégrité. |
| *hDroitGestionProcédure* | Droit d'ajouter, modifier, supprimer des collections de procédures. |
| *hDroitGestionTrigger* | Droit d'ajouter, activer, supprimer des triggers serveur. |
| *hDroitInterditAccèsBaseDeDonnées* | Droit d'interdire l'accès à une base de données (fonctions [HInterditAccèsBaseDeDonnées](../WDLang4/3044286.md) et [HFinInterditAccèsBaseDeDonnées](../WDLang4/3044287.md)). |
| *hDroitLecture* | Droit de lire les enregistrements d'un fichier de données. |
| *hDroitMaintenance* | Droit de lancer une ré-indexation ou un calcul de statistiques sur un fichier de données. |
| *hDroitModifAuto* | Droit de lancer une modification automatique sur un fichier de données. |
| *hDroitModification* | Droit de modifier les enregistrements d'un fichier de données. |
| *hDroitSauvegarde* | Droit de réaliser une sauvegarde. |
| *hDroitSuppression* | Droit de supprimer les enregistrements d'un fichier de données. |
| *hDroitSuppressionBDD* | Droit de supprimer une base de données. |
| *hDroitSuppressionFichier* | Droit de supprimer un fichier de données (fonction [HSupprimeFichier](../WDLang4/3044294.md)). |
| *hDroitSuppressionVue* | Droit de supprimer une vue. |
| *hDroitTous* | Liste de tous les droits<br>Il est conseillé d'utiliser cette constante en mode d'affichage *hDétail* ou *hEffectif* + *hDétail*. |



**`<Base de données> : (Chaîne de caractères)`**

Nom de la base de données pour laquelle les droits sont recherchés.

**`<Mode d'affichage> : (Constante optionnelle de type Entier)`**

Mode d'affichage du résultat :



|   |   |
| --- | --- |
| *hDéfaut*<br>(Valeur par défaut) | Le droit renvoyé ne tient pas compte des droits qui seront éventuellement hérités (par exemple, les droits définis pour les groupes auxquels l'utilisateur appartient).<br>Si le droit n'a pas été défini, la valeur de ce droit sera *hHérité*.<br>&lt;Résultat&gt; contient uniquement les valeurs des droits demandés (dans le même ordre). |
| *hDétail* | Idem *HDéfaut*. <br>&lt;Résultat&gt; contient le droit et sa valeur. |
| *hEffectif* | Le droit renvoyé correspond au droit qui sera effectivement appliqué pour l'utilisateur ou le groupe sur la base de données. Les droits éventuellement hérités sont pris en compte (par exemple, les droits définis pour les groupes auxquels l'utilisateur appartient). |
| *hEffectif* + *hDétail* | Idem *hEffectif*. <br>&lt;Résultat&gt; contient le droit et sa valeur. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
Pour modifier les droits sur une base de données pour un utilisateur ou un groupe d'utilisateurs, utilisez la fonction [HModifieDroitBaseDeDonnées](../WDLang4/3044326.md).

<a name="XComposante"></a>

## Composante :
wd280hf.dll
