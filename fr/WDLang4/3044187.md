


## Gestion du NULL dans HFSQL
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000190"></a>
WINDEV, WEBDEV et WINDEV Mobile permettent de gérer la valeur NULL dans les rubriques des fichiers de données HFSQL et pour tous les autres types d'accès (Natif, OLE DB, ...).

Ainsi, lors de calculs sur les enregistrements de vos fichiers de données, les enregistrements contenant une rubrique Nulle ne seront pas pris en compte. Par exemple, si une requête calcule la note moyenne des élèves pendant le trimestre, seules les notes des élèves présents seront prises en compte. Si l'élève est absent, sa note correspondra à la valeur nulle.





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment gérer la valeur NULL dans une de vos rubriques ?
<a name="comment_gerer_valeur_null_dans_une_vos_rubriques_ELTTEXTE000220"></a>


### Gérer la valeur NULL
<a name="gerer_valeur_null_ELTPARAGRAPHE000030"></a>Pour gérer la valeur nulle dans vos fichiers de données, vous disposez :

- Sous l'éditeur d'analyses :

	- d'une option "NULL supporté" dans la description du fichier de données (onglet "Info"). Cette option permet de définir si la gestion du NULL est supportée pour ce fichier de données. Dans ce cas, il sera possible de gérer la valeur NULL pour les différentes rubriques du fichier de données.

	- d'une option "Valeur NULL par défaut" pour chaque rubrique de vos fichiers (onglet "Général" de la description de la rubrique). Cette option permet de définir la valeur nulle comme valeur par défaut de la rubrique.

	- d'une option "NULL autorisé" pour chaque rubrique de vos fichiers (onglet "Général" de la description de la rubrique). Cette option permet d'autoriser ou non l'utilisation de la valeur NULL pour cette rubrique. Par défaut, si le fichier de données supporte le NULL, toutes les rubriques du fichier de données ont l'option "NULL Autorisé" cochée.  




- En programmation, de plusieurs propriétés :
	


|   |   |
| --- | --- |
| [Null](../Proprietes/2512064.md) | La propriété **Null** permet de :<br><br>	- Affecter NULL à la rubrique pour l'enregistrement en cours.<br><br>	- Savoir si la rubrique est associée à la valeur NULL pour l'enregistrement en cours.<br><br>	- Définir la valeur par défaut d'une rubrique lors de la description d'un fichier de données par programmation.<br><br><br> |
| [NullAutorisé](../Proprietes/1000019492.md) | La propriété **NullAutorisé** permet de gérer la valeur NULL dans les rubriques des fichiers de données HFSQL. |
| [NullSupporté](../Proprietes/2512061.md) | La propriété **NullSupporté** permet de gérer la valeur NULL dans des fichiers de données HFSQL. |



<a name="NOTE2_2"></a>


### Limites
<a name="limites_ELTPARAGRAPHE000048"></a>Il n'est pas possible d'utiliser la valeur NULL :

- sur les rubriques tableau. 

- sur les identifiants automatiques. 

- sur les clés composées.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Comment utiliser la valeur NULL dans vos applications ?
<a name="comment_utiliser_valeur_null_dans_vos_applications_ELTTEXTE000277"></a>


### Comment enregistrer une valeur NULL dans une rubrique ?
<a name="comment_enregistrer_une_valeur_null_dans_une_rubrique_ELTPARAGRAPHE000061"></a>

1. Cochez la case "NULL supporté" lors de la description du fichier de données sous l'éditeur d'analyses (option "Description du fichier de données" du menu contextuel, onglet "Info"). 
	Par défaut, l'option "NULL Autorisé" est cochée pour toutes les rubriques du fichier de données. 

2. Générez l'analyse.

3. Cochez l'option "NULL si vide" du champ de saisie lié à la rubrique. Si l'utilisateur n'a saisi aucune valeur dans ce champ, la valeur NULL sera automatiquement affectée à la rubrique, lors de l'utilisation : 

	- de la fonction [EcranVersFichier](../WDLang4/3044146.md). 

	- de la fonction [PageVersFichier](../WDLang4/3044022.md).







Remarques : 

- L'option "NULL si vide" des champs de saisie permet également de gérer les paramètres optionnels d'une requête paramétrée. Pour plus de détails, consultez [Utilisation d'une requête paramétrée](../Editeurs/2032032.md).

- **Si la valeur par défaut de la rubrique est NULL** (case cochée sous l'éditeur), la fonction [HRAZ](../WDLang4/3044118.md) remet la propriété [Null](../Proprietes/2512064.md) à <u><u><u><u>Vrai</u></u></u></u>.

- Le NULL au niveau de l'index est considéré comme une chaîne vide ("") pour les rubriques de type chaîne ou comme la valeur 0 pour les rubriques numériques. 



<a name="NOTE3_2"></a>


### Personnaliser l'affichage des rubriques dont la valeur est NULL
<a name="personnaliser_affichage_des_rubriques_dont_valeur_est_null_ELTPARAGRAPHE000102"></a>Par défaut, si un champ de saisie est lié à une rubrique dont la valeur est NULL, la valeur affichée dans le champ est "". Pour personnaliser ce mode d'affichage, utilisez la fonction [ChampErreur](../WDLang1/3025036.md) avec la constante *ceNull*.
<a name="NOTE3_3"></a>


### Requête : Condition de sélection
<a name="requete_condition_selection_ELTPARAGRAPHE000112"></a>Il est possible sous l'éditeur de requête de prendre en compte ou non les enregistrements ayant une rubrique nulle. Il suffit de créer une condition de sélection, et de choisir l'option "Est nulle" ou "N'est pas Nulle".

Dans une requête de sélection effectuant un calcul, tous les enregistrements ayant une valeur nulle (pour la rubrique de calcul) ne seront pas pris en compte.
<a name="NOTE3_4"></a>


### Exemple
<a name="exemple_ELTPARAGRAPHE000121"></a>L'exemple suivant est une requête qui permet de calculer la moyenne des notes des élèves pour le cours de Français pour l'année 2003. Si une des notes correspond à la valeur NULL, cette note n'est pas prise en compte.

```sql
SELECT Notes.Cours AS Cours,
Notes.DateNote AS DateNote,
LEFT(Notes.DateNote,4) AS Année,
AVG(Notes.Note) AS la_moyenne_Note
FROM Notes
WHERE Notes.Cours = 'Français'
AND Notes.Note IS NOT NULL 
AND LEFT(Notes.DateNote,4) = '2003'
GROUP BY Notes.Cours, Notes.DateNote, LEFT(Notes.DateNote,4)
```


<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Limitations
<a name="limitations_ELTTEXTE000319"></a>


- Lors de la gestion de l'intégrité, la valeur NULL n'est pas prise en compte

- Un enregistrement relié sur 0 ou chaîne vide ("") équivaut à un enregistrement relié sur NULL.

- Par compatibilité, le transfert de la propriété [Null](../Proprietes/2512064.md) par affectation n'est pas possible.

	- Ne pas faire :
			
		```wl
		Fic1.Rub1 = Fic2.Rub2
		```


	- Faire :
			
		```wl
		Fic1.Rub1..Null = Fic2.Rub2..Null
		```









