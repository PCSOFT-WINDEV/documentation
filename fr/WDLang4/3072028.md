
## SQLInfoGene (Fonction)

***En anglais : SQLInfo***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Initialise les différentes variables SQL avec les informations relatives à la dernière requête exécutée. Cette fonction peut être utilisée quel que soit le type de parcours réalisé (pour plus de détails, consultez [Types de parcours SQL](../WDLang4/3072025.md)).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
ResSQL = SQLExec("SELECT * FROM FACT", "REQ1")
SI ResSQL = Faux ALORS
	SQLInfoGene("REQ1")
	Info("Erreur SQL : " + SQL.MesErreur)
SINON
	SQLTable("REQ1", TABLE_Table1)
FIN
SQLFerme("REQ1")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`SQLInfoGene([<Nom de la requête>])`
---

**`<Nom de la requête> : (Chaîne de caractères optionnelle)`**

Nom de la requête : 

- créée et exécutée avec la fonction [SQLExec](../WDLang4/3072007.md),

- exécutée avec la fonction [SQLExecWDR](../WDLang4/3072010.md). 


Si ce paramètre correspond à une requête qui n'existe pas, une erreur est générée. Pour tester l'existence d'une requête, utilisez la fonction [SQLReqExiste](../WDLang4/3072026.md).

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les requêtes créées avec l'éditeur de requêtes doivent être spécifiées sous forme d'une chaîne de caractères avec guillemets. 





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Informations mises à jour si le paramètre &lt;Nom de la requête&gt; n'est pas précisé
<a name="informations_mises_jour_parametre_nest_pas_precise_ELTPARAGRAPHE000106"></a>

| Variable | Type | Description |
| --- | --- | --- |
| *SQL.Base* | Chaîne de caractères | Nom de la base à laquelle le projet est connecté. |
| *SQL.Connexion* | Entier | Identifiant de la connexion en cours (fournit par [SQLConnecte](../WDLang4/3072005.md)). |
| *SQL.Erreur* | Chaîne de caractères | <br><br>- Code de l'erreur ("00000" si aucune erreur). Consultez la documentation du driver utilisé pour connaître sa signification. <br><br>- Code d'erreur inexistant pour les connexions avec les drivers ORACLE ou SQL SERVER Natifs de PC SOFT.<br><br><br> |
| *SQL.MesErreur* | Chaîne de caractères | Libellé de l'erreur. |
| *SQL.NbCol* | Entier | Nombre de colonnes du résultat. |

Si le paramètre &lt;Nom de la requête&gt; n'est pas précisé, la fonction **SQLInfoGene** doit être appelée après la connexion (fonction [SQLConnecte](../WDLang4/3072005.md)).


<a name="NOTE0_2"></a>




### Informations mises à jour si le paramètre &lt;Nom de la requête&gt; est précisé et le parcours est réalisé avec SQLPremier/SQLCol
<a name="informations_mises_jour_parametre_est_precise_parcours_est_realise_avec_sqlpremiersqlcol_ELTPARAGRAPHE000162"></a>

| Variable | Type | Description |
| --- | --- | --- |
| *SQL.Base* | Chaîne de caractères | Nom de la base à laquelle le projet est connecté. |
| *SQL.Connexion* | Entier | Identifiant de la connexion en cours (fourni par [SQLConnecte](../WDLang4/3072005.md)). |
| *SQL.EnDehors* | Booléen | Permet de savoir si il reste des enregistrements à lire. |
| *SQL.EnCours* | Entier | Numéro de la ligne en cours dans le résultat de la requête. |
| *SQL.Erreur* | Chaîne de caractères | <br><br>- Code de l'erreur ("00000" si aucune erreur). Consultez la documentation du driver utilisé pour connaître sa signification. <br><br>- Code d'erreur inexistant pour les connexions avec les drivers ORACLE ou SQL SERVER Natifs de PC SOFT.<br><br><br> |
| *SQL.MesErreur* | Chaîne de caractères | Libellé de l'erreur. Consultez la documentation du driver utilisé pour connaître sa signification. |
| *SQL.NbCol* | Entier | Nombre de colonnes du résultat. |
| *SQL.NbLig* | Entier | Nombre de lignes du résultat. |
| *SQL.RecupEnCours* | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> si la récupération du résultat est en cours (cas du Fetch partiel), <br><br>- <u><u><u><u>Faux</u></u></u></u> si tout le résultat est récupéré.<br><br><br> |
| *SQL.Requete* | Entier | Numéro de la requête en cours. |
| *SQL.TitreCol [n]* | Chaîne de caractères | Titre par défaut de la colonne spécifiée. |

Si le paramètre &lt;Nom de la requête&gt; est précisé :

- La fonction **SQLInfoGene** doit être appelée après l'exécution de la requête (fonction [SQLExec](../WDLang4/3072007.md)).

- En Java et en PHP, la variable **SQL.NbLig** sera renseignée uniquement si la fonction [SQLPremier](../WDLang4/3072017.md) a été appelée avant la fonction **SQLInfoGene**.





<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Informations mises à jour si le paramètre &lt;Nom de la requête&gt; est précisé et le parcours est réalisé avec SQLFetch/SQLLitCol
<a name="informations_mises_jour_parametre_est_precise_parcours_est_realise_avec_sqlfetchsqllitcol_ELTPARAGRAPHE000277"></a>

| Variable | Type | Description |
| --- | --- | --- |
| *SQL.Base* | Chaîne de caractères | Nom de la base à laquelle le projet est connecté. |
| *SQL.Connexion* | Entier | Identifiant de la connexion en cours (fourni par [SQLConnecte](../WDLang4/3072005.md)). |
| *SQL.Erreur* | Chaîne de caractères | <br><br>- Code de l'erreur ("00000" si aucune erreur). Consultez la documentation du driver utilisé pour connaître sa signification. <br><br>- Code d'erreur inexistant pour les connexions avec les drivers ORACLE ou SQL SERVER Natifs de PC SOFT. Pour les bases de données locales navigateur, consultez la documentation des bases de données de type "Web SQL database".<br><br><br> |
| *SQL.MesErreur* | Chaîne de caractères | Libellé de l'erreur. Consultez la documentation du driver utilisé pour connaître sa signification. |
| *SQL.NbCol* | Entier | Nombre de colonnes du résultat.<br><br> |
| *SQL.Requete* | Entier | Numéro de la requête en cours. |
| *SQL.TitreCol [n]* | Chaîne de caractères | Titre par défaut de la colonne spécifiée. |

Si le paramètre &lt;Nom de la requête&gt; est précisé, la fonction **SQLInfoGene** doit être appelée après l'exécution de la requête (fonction [SQLExec](../WDLang4/3072007.md)).

<a name="XComposante"></a>

## Composante :
wd280hf.dll
