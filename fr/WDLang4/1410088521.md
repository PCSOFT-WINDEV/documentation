


## HRSRenommeNomServeur (Fonction)

***En anglais : HRSRenameServer***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renomme le nom DNS du serveur de la réplication si celui-ci a changé de nom. 

Attention : Cette manipulation doit être effectuée uniquement si seul le nom du serveur a été modifié (le serveur est resté à l'identique : la configuration, l'architecture des bases de données, les fichiers systèmes doivent être les mêmes). En particulier, la configuration de la réplication qui se trouve dans le fichier HFConf.ini ne doit pas avoir été modifiée. Exemple : 

```txt
[REPLICATION]
PRIORITY=2
PASSWORD=XXXXX
PORT=9792
ROLE=3
SERVER_ID=2
```

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
listeRS est un tableau de hRSConfigs

// Liste des réplications
listeRS = HRSListeConfig(MaConnexion1)
POUR TOUT ConfigRéplication DE listeRS	
	// Si la configuration doit être modifiée
	ConfigRéplication.Serveur = "MonNouveauNomDeServeur:4997"
	SI PAS HRSRenommeNomServeur(MaConnexion1, ConfigRéplication) ALORS
		Trace(HErreurInfo())
	FIN
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = HRSRenommeNomServeur(<Connexion> , <Réplication à renommer>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la réplication a été modifiée,

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur.




**`<Connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion vers le serveur HFSQL maître sur lequel la configuration de la réplication doit être modifiée. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).




**`<Réplication à renommer> : (Variable de type hRSConfig)`**

Nom de la variable de type [hRSConfig](../WDLang4/1000020484.md) décrivant la réplication modifiée à mettre à jour.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Cette manipulation doit être faite uniquement si le serveur est identique, sauf pour son nom DNS (la configuration, l'architecture des BDD, les fichiers systèmes doivent être les mêmes).

- La fonction **HRSRenommeNomServeur** ne permet pas de "dupliquer" ou "déplacer" une réplication vers un autre serveur.

- Dans le cas d'une réplication bidirectionnelle, la fonction **HRSRenommeNomServeur** doit être appelée sur la connexion qui correspond au serveur qui n'a pas changé de nom. 

- Dans le cas d'une réplication monodirectionnelle, la fonction **HRSRenommeNomServeur** doit être appelée sur la connexion qui correspond au serveur maître. 

- En réplication monodirectionnelle, si c'est le serveur maître qui a changé de nom, il n'y a rien à faire, la modification se fera toute seule.




<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
