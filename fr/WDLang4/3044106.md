
## HOuvreAnalyse (Fonction)

***En anglais : HOpenAnalysis***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ouvre une analyse au format HFSQL Classic. Il est ainsi possible d'accéder aux fichiers de données décrits dans cette analyse, et à la structure de ces fichiers de données.

**Rappel** : Une seule analyse peut être ouverte à un moment donné. Si une analyse était déjà ouverte avant l'appel de la fonction, cette analyse est automatiquement fermée ainsi que les fichiers de données associés.

**Attention** : Lors de l'utilisation de la fonction **HOuvreAnalyse**, le contexte HFSQL en cours est automatiquement ré-initialisé. Les opérations suivantes sont automatiquement effectuées :

- Tous les fichiers de données précédemment ouverts sont fermés.

- Toutes les vues HFSQL existantes sont supprimées.

- Toutes les requêtes existantes sont supprimées.

- Toutes les déclarations réalisées avec les fonctions [HDéclareExterne](../WDLang4/3044204.md) et [HDécritFichier](../WDLang4/3044206.md) sont supprimées.









<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ouverture de l'analyse GESTCOM
HOuvreAnalyse("C:\GESTCOM\GESTCOM.WDD", "Mot de passe")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Ouverture d'une analyse HFSQL localement

`<Résultat> = HOuvreAnalyse(<Chemin du .WDD> [, <Mot de passe>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'analyse a été ouverte, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [HErreur](../WDLang4/3044088.md) permet d'obtenir plus d'informations sur le problème rencontré.




**`<Chemin du .WDD> : (Chaîne de caractères)`**

Chemin complet du fichier ".WDD" de l'analyse. Ce fichier contient la description de l'analyse à ouvrir.

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Si seuls le lecteur et le nom de l'analyse sont spécifiés, l'analyse est recherchée dans le répertoire en cours du lecteur spécifié. 
Si ni le lecteur, ni le chemin de l'analyse ne sont spécifiés, l'analyse est recherchée dans le répertoire en cours du disque en cours.
La syntaxe &lt;Unité&gt;:&lt;Nom d'analyse&gt; permet de rechercher l'analyse dans le répertoire courant du lecteur spécifié. 

**`<Mot de passe> : (Chaîne de caractères optionnelle)`**



- Mot de passe de l'analyse, défini dans l'éditeur d'analyses. 

- Chaîne vide ("") si aucun mot de passe n'est associé à l'analyse.  






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Lancement d'une application associée à une analyse
<a name="lancement_une_application_associee_une_analyse_ELTPARAGRAPHE000098"></a>

- Au lancement d'une application, l'analyse associée à cette application est automatiquement ouverte. L'analyse est recherchée dans la bibliothèque principale de l'application, puis dans le répertoire de l'application. 
	Pour éviter que l'analyse ne soit pas trouvée, il est conseillé d'inclure l'analyse dans la bibliothèque principale de l'application.

- Si la fonction **HOuvreAnalyse** est appelée par une application associée à une analyse, cette fonction :

	- n'a aucun effet si le chemin de l'analyse spécifié correspond au chemin de l'analyse associée à l'application.

	- retourne <u><u><u><u>Faux</u></u></u></u> si le chemin de l'analyse spécifié n'existe pas. Dans ce cas, l'application continue de travailler avec l'analyse en cours.

	- ouvre l'analyse et retourne <u><u><u><u>Vrai</u></u></u></u> si l'analyse spécifiée existe et est valide.








<a name="NOTE0_2"></a>




### Lancement d'une application non associée à une analyse
<a name="lancement_une_application_non_associee_une_analyse_ELTPARAGRAPHE000125"></a>Au lancement d'une application non associée à une analyse, aucune analyse n'est automatiquement ouverte. Il est donc nécessaire d'utiliser la fonction **HOuvreAnalyse**.

L'analyse ouverte avec la fonction **HOuvreAnalyse** est recherchée :

- tout d'abord, dans la bibliothèque principale de l'application selon son nom physique complet.

- puis, sur le disque en cours.





<a name="NOTE0_3"></a>




### Ouverture d'une analyse déjà ouverte
<a name="ouverture_une_analyse_deja_ouverte_ELTPARAGRAPHE000145"></a>Si l'analyse ouverte par la fonction **HOuvreAnalyse** est déjà ouverte, la fonction **HOuvreAnalyse** n'a aucun effet.


<a name="NOTE0_5"></a>




### Version des analyses ouvertes avec la fonction HOuvreAnalyse
<a name="version_des_analyses_ouvertes_avec_fonction_docparampagetitleshort_ELTPARAGRAPHE000160"></a>**La fonction HOuvreAnalyse ne permet pas d'ouvrir les analyses au format Hyper File 5.5 et inférieur. Seules les analyses HFSQL Classic peuvent être ouvertes.**

Pour utiliser la fonction **HOuvreAnalyse** sur des fichiers Hyper File 5.5, il est nécessaire d'utiliser le fichier ".WDD" d'une analyse HFSQL Classic contenant des fichiers au format Hyper File 5.5. Dans ce cas, le fichier ".WDD" de l'analyse WINDEV 5.5 d'origine devra impérativement être présent dans le répertoire de l'exécutable.

**Il est également possible d'utiliser la fonction [HDéclare](../WDLang4/3044203.md) pour manipuler directement un fichier Hyper File 5.5.**



<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
