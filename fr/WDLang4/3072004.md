
## SQLAssocie (Fonction)

***En anglais : SQLAssociate***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Associe automatiquement chaque colonne du résultat de la requête à un champ ou à une variable de l'application. Après l'exécution de la fonction **SQLAssocie**, il est nécessaire de parcourir le résultat de la requête : l'affectation des champs ou des variables sera alors effectuée pour chaque enregistrement lu.

**Remarque** : Cette fonction doit être utilisée lors d'un parcours de type "SQLPremier/SQLCol". Pour plus de détails sur les différents types de parcours du résultat d'une requête, consultez [Types de parcours SQL](../WDLang4/3072025.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
ResExec est un booléen 
ResExec = SQLExec("SELECT NOMCLI,ADR1,ADR2,VILLE,CP FROM FACT", "REQ2")
SI ResExec = Vrai ALORS
	SQLAssocie("REQ2", NomCli, Adr[1], Adr[2], Ville, CodePostal)
	SQLPremier("REQ2")
SINON
	// Traite erreur
FIN
SQLFerme("REQ2")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`SQLAssocie(<Nom de la requête> , <Liste des opérateurs>)`
---

**`<Nom de la requête> : (Chaîne de caractères)`**

Nom de la requête créée et exécutée avec la fonction [SQLExec](../WDLang4/3072007.md) (le nom de la requête doit être entouré de guillemets) ou exécutée avec la fonction [SQLExecWDR](../WDLang4/3072010.md) (avec ou sans guillemets).

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seules les requêtes créées et exécutées avec la fonction  [SQLExec](../WDLang4/3072007.md) sont utilisables dans cette version.

**`<Liste des opérateurs> : (Chaînes de caractères séparées par des virgules)`**

Liste des noms de champs ou de variables qui seront automatiquement associés aux colonnes correspondantes de la requête (250 maximum). Ces opérateurs sont séparés par des virgules. L'ordre de ces opérateurs doit correspondre à l'ordre des colonnes de la requête.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Récupérer la valeur d'une colonne
<a name="recuperer_valeur_une_colonne_ELTPARAGRAPHE000086"></a>La valeur d'une colonne peut être récupérée individuellement grâce à la fonction [SQLCol](../WDLang4/3072018.md).


<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![ODBC](https://doc.pcsoft.fr/ext/images/fr/ODBC.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Transférer le contenu de la requête dans une table
<a name="transferer_contenu_requete_dans_une_table_ELTPARAGRAPHE000099"></a>Pour transférer tout le contenu de la requête dans une table, utilisez la fonction [SQLTable](../WDLang4/3072031.md).
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![ODBC](https://doc.pcsoft.fr/ext/images/fr/ODBC.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Récupération de rubriques de type Float sur Oracle (via ODBC)
<a name="recuperation_rubriques_type_float_sur_oracle_via_odbc_ELTPARAGRAPHE000111"></a>Par défaut, le séparateur décimal utilisé pour les rubriques de type Float sur Oracle est le point. Or le driver ODBC renvoie la valeur avec en utilisant la virgule comme séparateur décimal. Lors de l'affectation de la valeur dans un champ de type numérique, les décimales sont perdues.

Pour éviter ce problème, il suffit de configurer le séparateur décimal pour la connexion en cours :


```wl
// Connexion à la base de données Oracle 
SQLConnecte("MaBaseOracle", "User", "Passe", "", "ODBC") 
// Requête pour changer le séparateur décimal 
SQLExec("ALTER SESSION SET NLS_NUMERIC_CHARACTERS ='. '", "ReqTemp")
```

<a name="NOTE0_4"></a>




### Utilisation de tabulations dans les rubriques
<a name="utilisation_tabulations_dans_les_rubriques_ELTPARAGRAPHE000123"></a>Les fonctions SQL permettent d'insérer des tabulations dans les rubriques des fichiers de données. La gestion des tabulations dépend du mode d'accès utilisé.

**1er cas : Exécution d'une requête en ODBC :**
Lors de l'exécution d'une requête en ODBC, les tabulations ne sont pas récupérées par la fonction **SQLAssocie**. Pour récupérer les valeurs des rubriques (avec les caractères TAB), il est conseillé d'utiliser [un parcours du type SQLAvance/SQLLitCol](../WDLang4/3072025.md).

Exemple : SQLAssocie et les tabulations dans les rubriques
Les rubriques des enregistrements à récupérer sont les suivantes :


|   |   |   |
| --- | --- | --- |
|   | Rubrique 1 | Rubrique 2 |
| Enregistrement 1 | John | Smith |
| Enregistrement 2 | John + tab + Mac | Doughnut |

Pour le premier enregistrement :

- SQLAssocie(Req1, var1, Var2) : récupère John et Smith


Pour le second enregistrement :

- SQLAssocie(Req1, var1, Var2) : récupère John et Mac, mais Mac ne correspond pas à la valeur de la seconde rubrique

- SQLAssocie(Req1, Var1, Var2, Var3) : récupère John, Mac, Doughnut




**2ème cas : Exécution d'une requête par OLEDB, HFSQL ou Accès Natif**
Les tabulations présentes dans les rubriques résultat sont automatiquement récupérées par la fonction **SQLAssocie**.



<a name="XComposante"></a>

## Composante :
wd280hf.dll
