


## HListeFichier (Fonction)

***En anglais : HListFile***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie la liste des fichiers de données :

- de l'analyse en cours ou d'une analyse spécifique reconnue par le moteur HFSQL. Les fichiers de données définis par les fonctions [HDéclare](../WDLang4/3044203.md), [HDéclareExterne](../WDLang4/3044204.md) et [HDécritFichier](../WDLang4/3044206.md) sont pris en compte.

- disponibles sur une connexion par un accès natif ou par un driver OLE DB.

- d'un groupe défini dans l'éditeur d'analyses.
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les groupes définis dans l'éditeur d'analyses ne sont pas gérés.





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003044045&name=hlistefichier_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Récupère les fichiers de données décrits dans l'analyse et par programmation
ListeFichier est une chaîne
ListeFichier = HListeFichier(hLstDétail + hLstTout)
// Ajoute la liste des fichiers de données dans COMBO_COMBO1
ListeAjoute(COMBO_COMBO1, ListeFichier)
// Affiche dans une trace
Trace(ListeFichier)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Lister les fichiers de données d'une analyse

`<Résultat> = HListeFichier([<Chemin du WDD> [, <Mot de passe du WDD>]] [, <Options>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Liste des fichiers de données présents dans l'analyse en cours ou dans l'analyse spécifiée. Les différentes descriptions de chaque analyse sont séparées par RC (Retour chariot). En fonction de la constante utilisée, le résultat est plus ou moins détaillé :


|   |   |
| --- | --- |
| *hLstDétail* non précisé | &lt;Nom du fichier de données 1&gt; + RC + &lt;Nom du fichier de données 2&gt; + RC + ... |
| *hLstDétail* précisé | &lt;Nom du fichier de données 1&gt; + TAB + &lt;Abréviation&gt; + TAB + &lt;Libellé&gt; + TAB + &lt;Nom physique&gt; + RC + ... |


Où :


- &lt;Nom du fichier de données X&gt; : Nom logique du fichier de données (utilisé en programmation).

- &lt;Abréviation&gt; : Abréviation du fichier de données.

- &lt;Libellé&gt; : Libellé du fichier de données.

- &lt;Nom physique&gt; : Nom physique du fichier de données (sur le disque).




**`<Chemin du WDD> : (Chaîne de caractères optionnelle)`**

Chemin complet de l'analyse (c'est-à-dire du ficher .WDD) dans laquelle le fichier de données est décrit. 
Si ce paramètre n'est pas précisé ou est égal à une chaîne vide (""), le fichier de données est recherché dans l'analyse en cours.

**`<Mot de passe du WDD> : (Chaîne de caractères optionnelle)`**

Mot de passe défini pour l'analyse. 
Si aucun mot de passe n'est défini, ce paramètre doit être égal à une chaîne vide ("").

**`<Options> : (Constante ou combinaison de constantes de type entier (optionnel))`**

Paramètre le type de liste à effectuer :


|   |   |
| --- | --- |
| *hLstNormal*<br>(valeur par défaut) | Liste non triée, non détaillée, sans les fichiers de données décrits par programmation. |
| *hLstDétail* | Liste les informations détaillées (comme pour WINDEV 5.5). |
| *hLstTout* | Liste tous les fichiers de données (y compris ceux décrits avec les fonctions [HDéclare](../WDLang4/3044203.md), [HDéclareExterne](../WDLang4/3044204.md) et [HDécritFichier](../WDLang4/3044206.md)).<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Ce paramètre n'est pas pris en compte. |
| *hLstTriée* | Trie la liste des fichiers de données par ordre croissant.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Ce paramètre n'est pas pris en compte. |




<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 
### Lister les fichiers de données d'un groupe

`<Résultat> = HListeFichier(<Nom du groupe> [, <Options>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Liste des fichiers de données appartenant au groupe. Les différentes descriptions de chaque fichier de données sont séparées par RC (Retour chariot).

**`<Nom du groupe> : (Chaîne de caractères)`**

Nom du groupe de fichiers de données. Ce groupe de fichiers de données a été défini dans l'éditeur d'analyses.

**`<Options> : (Constante ou combinaison de constantes de type entier (optionnel))`**

Paramètre le type des fichiers de données à lister :


|   |   |
| --- | --- |
| *hLstProcédureStockée* | Liste des procédures stockées. |
| *hLstRequête* | Liste les requêtes qui ont été exécutées. |
| *hLstTable*<br>(valeur par défaut) | Liste des tables utilisateur.<br>![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Les noms des tables correspondent aux noms physiques des fichiers des données. |
| *hLstTableSystème* | Liste des tables système.<br>![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Cette option n'est pas disponible. |
| *hLstVue* | Liste des vues.<br>![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) **Accès Natif Oracle** : La constante *hLstVue* permet de lister les vues et les synonymes.<br>![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Liste les vues SQL. |
| *hLstVueMatérialisée* | ![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Liste des vues matérialisées. |




<a name="SYNTAXE3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 
### Lister les fichiers de données d'une connexion par Connecteur Natif, OLE DB ou HFSQL Client/Serveur (1)

`<Résultat> = HListeFichier(<NConnexion> [, <Options>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Liste des fichiers de données accessibles par la connexion. Les différentes descriptions de chaque fichier de données sont séparées par RC (Retour chariot).

**`<NConnexion> : (Chaîne de caractères)`**

Nom de la connexion à une base de données. Cette connexion a été définie dans l'éditeur d'analyses ou par la fonction [HOuvreConnexion](../WDLang4/3044107.md).

**`<Options> : (Constante ou combinaison de constantes de type entier (optionnel))`**

Paramètre le type des fichiers de données à lister :


|   |   |
| --- | --- |
| *hLstProcédureStockée* | Liste des procédures stockées. |
| *hLstRequête* | Liste les requêtes qui ont été exécutées. |
| *hLstTable*<br>(valeur par défaut) | Liste des tables utilisateur.<br>![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Les noms des tables correspondent aux noms physiques des fichiers de données. |
| *hLstTableSystème* | Liste des tables système.<br>![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Cette option n'est pas disponible. |
| *hLstVue* | Liste des vues.<br>![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) **Connecteur Natif Oracle** : La constante *hLstVue* permet de lister les vues et les synonymes.<br>![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Liste les vues SQL. |
| *hLstVueMatérialisée* | ![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Liste des vues matérialisées. |




<a name="SYNTAXE4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 
### Lister les fichiers de données d'une connexion par Connecteur Natif ou par OLE DB (2)

`<Résultat> = HListeFichier(<Nom utilisateur> , <Mot de passe> , <Source de données> , <Provider OLE DB ou Connecteur Natif> [, <Accès> [, <Options>]])`
---

**`<Résultat> : (Chaîne de caractères)`**

Liste des fichiers de données accessibles par la connexion. Les différentes descriptions de chaque fichier de données sont séparées par RC (Retour chariot).

**`<Nom utilisateur> : (Chaîne de caractères)`**

Nom de l'utilisateur de la source de données.

**`<Mot de passe> : (Chaîne de caractères)`**

Mot de passe défini pour l'accès à la source de données (s'il existe), chaîne vide ("") si aucun mot de passe n'est défini.

**`<Source de données> : (Chaîne de caractères)`**

Chemin complet de la source de données utilisée.

**`<Provider OLE DB ou Connecteur Natif> : (Chaîne de caractères ou constante)`**

Nom du provider OLE DB à utiliser ou une des constantes suivantes :


|   |   |
| --- | --- |
| *hAccèsHF7* | Pseudo-connexion à une base HFSQL Classic. |
| *hAccèsHFClientServeur* | Connecteur Natif à une base HFSQL Client/Serveur. |
| *hAccèsNatifAS400* | Connecteur Natif AS/400 (module optionnel de WINDEV/WEBDEV). |
| *hAccèsNatifDB2* | Connecteur Natif DB2 (module optionnel de WINDEV/WEBDEV). |
| *hAccèsNatifInformix* | Connecteur Natif Informix (module optionnel de WINDEV/WEBDEV). |
| *hAccèsNatifMariaDB* | Connecteur Natif MariaDB (module optionnel de WINDEV/WEBDEV). |
| *hAccèsNatifMySQL* | Connecteur Natif MySQL (module optionnel de WINDEV/WEBDEV). |
| *hAccèsNatifOracle* | Connecteur Natif Oracle (module optionnel de WINDEV/WEBDEV). |
| *hAccèsNatifOracleLite* | Connecteur Natif Oracle (module optionnel de WINDEV Mobile). |
| *hAccèsNatifPostgreSQL* | Connecteur Natif PostgreSQL (module optionnel de WINDEV/WEBDEV). |
| *hAccèsNatifProgress* | Connecteur Natif Progress (module optionnel de WINDEV/WEBDEV). |
| *hAccèsNatifSQLAzure* | Connecteur Natif SQL Azure (module optionnel de WINDEV/WEBDEV, fourni avec le Connecteur Natif SQL Server). |
| *hAccèsNatifSQLite* | Connecteur Natif SQLite. |
| *hAccèsNatifSQLServer* | Connecteur Natif SQL Server (module optionnel de WINDEV/WEBDEV). |
| *hAccèsNatifSQLServerMobile* | Connecteur Natif SQL Server (module optionnel de WINDEV Mobile). |
| *hAccèsNatifSybase* | Connecteur Natif Sybase (module optionnel de WINDEV/WEBDEV). |
| *hAccèsNatifXBase* | Connecteur Natif xBase (fourni en standard avec WINDEV/WEBDEV). |
| *hAccèsNatifXML* | Connecteur Natif XML (fourni en standard avec WINDEV/WEBDEV). |
| *hODBC* | Provider OLE DB pour ODBC (permet d'accéder à une source de données ODBC déclarée dans les sources de données ODBC de Windows). |
| *hOledbAccess97* | Provider OLE DB pour Access 97. |
| *hOledbAccess2000* | Provider OLE DB pour Access 2000. |
| *hOledbAccess2007* | Provider OLE DB pour Access 2007. |
| *hOledbAccess2010* | Provider OLE DB pour Access 2010. |
| *hOledbDBase5* | Provider OLE DB pour DBase 5. |
| *hOledbExcel2000* | Provider OLE DB pour Excel 2000. |
| *hOledbExcel2007* | Provider OLE DB pour Excel 2007. |
| *hOledbExcel97* | Provider OLE DB pour Excel 97. |
| *hOledbLotus4* | Provider OLE DB pour Lotus 4. |
| *hOledbOracle* | Provider OLE DB pour Oracle. |
| *hOledbSQLServer* | Provider OLE DB pour SQL Server. |


Attention : Pour utiliser une connexion OLE DB il est nécessaire : 

- d'installer le MDAC version 2.6 minimum (installation réalisée avec WINDEV/WEBDEV et lors de la création de la version Client)

- d'installer le provider OLE DB correspondant à la base de données manipulée.






**`<Accès> : (Constante de type entier (optionnel))`**

Type d'accès à la base de données :


|   |   |
| --- | --- |
| *hOLectureEcriture*<br>(valeur par défaut) | Ouverture en Lecture/Ecriture. |
| *hOLecture* | Ouverture en lecture seule. |



**`<Options> : (Constante ou combinaison de constantes de type entier (optionnelle))`**

Paramètre le type des fichiers de données à lister : 



|   |   |
| --- | --- |
| *hLstProcédureStockée* | Liste des procédures stockées.<br>![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Cette option n'est pas disponible. |
| *hLstRequête* | Liste les requêtes qui ont été exécutées. |
| *hLstTable*<br>(valeur par défaut) | Liste des tables utilisateur.<br>![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Les noms des tables correspondent aux noms physiques des fichiers de données. |
| *hLstTableSystème* | Liste des tables système.<br>![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Cette option n'est pas disponible. |
| *hLstVue* | Liste des vues.<br><br>![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) **Connecteur Natif Oracle** : La constante *hLstVue* permet de lister les vues et les synonymes.<br>![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Liste les vues SQL. |
| *hLstVueMatérialisée* | ![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Liste des vues matérialisées. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Affichage du résultat dans un champ Liste ou Combo
<a name="affichage_resultat_dans_champ_liste_combo_ELTPARAGRAPHE000532"></a>&lt;Résultat&gt; peut être directement affecté à un champ Liste ou Combo grâce à la fonction [ListeAjoute](../WDLang1/3049004.md). Chaque ligne contiendra le nom complet d'une des analyses trouvées.
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Fonction HListeFichier et le Connecteur Natif MySQL ou MariaDB
<a name="fonction_hlistefichier_connecteur_natif_mysql_mariadb_ELTPARAGRAPHE000544"></a>

- Pour le Connecteur Natif MySQL, la fonction **HListeFichier** a évolué selon les versions : 

	- En version 15, la fonction **HListeFichier** permet d'obtenir la liste des fichiers de la base de données en cours. 

	- En version 16, pour permettre l'utilisation des nouveautés MySQL 5, si le Connecteur Natif est connecté à un serveur MySQL 5 ou supérieur, la fonction **HListeFichier** renvoie la liste des fichiers de toutes les bases de données accessibles. Dans ce cas, le nom du fichier est de la forme "&lt;Nom de la base de données&gt;.&lt;Nom du fichier&gt;. 

	- A partir de la version 170069, la fonction **HListeFichier** renvoie désormais uniquement la liste des fichiers de la base de données en cours. La fonction [HListeBaseDeDonnées](../WDLang4/3044288.md) permet de lister les bases de données accessibles et leurs fichiers. 




- Pour le Connecteur Natif MariaDB, la fonction **HListeFichier** renvoie uniquement la liste des fichiers de la base de données en cours. La fonction [HListeBaseDeDonnées](../WDLang4/3044288.md) permet de lister les bases de données accessibles et leurs fichiers. 




<a name="XComposante"></a>

## Composante :
wd280hf.dll
