


## HInfoDroitServeur (Fonction)

***En anglais : HInfoServerRights***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet de connaître les droits accordés sur un serveur à un utilisateur ou à un groupe d'utilisateurs. Le serveur utilisé a été défini dans la connexion manipulée.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003044322&name=hinfodroitserveur_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
UnDroit est une chaîne
// Récupère le droit de création de base de données de 
// l'utilisateur Dupont sur le serveur de la connexion CNX
UnDroit = HInfoDroitServeur("CNX", "Dupont", hDroitCréationBDD)
SELON UnDroit
	CAS hAutorisé
	...
	CAS hInterdit
	... 
	CAS hHérité
	... 
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HInfoDroitServeur(<Connexion> , <Utilisateur/Groupe> , <Droits> [, <Mode d'affichage>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Informations demandées, 

- Chaîne vide ("") en cas d'erreur, 

- "Utilisateur inconnu" ou "Groupe inconnu" si l'utilisateur en cours n'a pas le droit de visualisation des utilisateurs (constante *hDroitVisualisationUtilisateur*) et s'il demande des informations concernant un autre utilisateur ou groupe.




**En mode hDéfaut**, &lt;Résultat&gt; est une liste de valeurs séparée par des tabulations (TAB). Chaque valeur de cette liste correspond au droit demandé par le paramètre &lt;Droits&gt;. Chaque valeur de cette liste peut correspondre à l'une des constantes suivantes :


|   |   |
| --- | --- |
| *hAutorisé* | L'utilisateur ou le groupe a le droit considéré. |
| *hHérité* | L'utilisateur appartient à au moins un groupe pour lequel le droit considéré a été autorisé.<br>Cette constante est renvoyée uniquement si le mode d'affichage n'est pas *hEffectif*. |
| *hInterdit* | L'utilisateur ou le groupe n'a pas le droit considéré. |


**En mode hDétail**, &lt;Résultat&gt; est une liste de valeurs de la forme :

```txt
<Droit considéré 1> + TAB + <Valeur du droit 1> + RC + ... 
<Droit considéré N> + TAB + <Valeur du droit N> + RC
```

Les droits correspondent aux constantes utilisées dans le paramètre &lt;Droits&gt; et les valeurs du droit correspondent aux constantes *hAutorisé*, *hInterdit* ou *hHérité* (voir tableau ci-dessus).

**`<Connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion pour laquelle les droits d'un utilisateur ou d'un groupe d'utilisateurs doivent être connus. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).




**`<Utilisateur/Groupe> : (Chaîne de caractères)`**

Nom de l'utilisateur ou du groupe dont on veut connaître les droits.

**`<Droits> : (Constante ou combinaison de constantes de type Entier)`**

Liste des droits à rechercher :


|   |   |
| --- | --- |
| *hDroitArrêtServeur* | Droit d'arrêter un serveur (fonction [HArrêteServeur](../WDLang4/3044317.md)). |
| *hDroitChangeDroit* | Droit de changer les droits. |
| *hDroitChangeMotDePasse* | Droit de changer le mot de passe d'un utilisateur sur le serveur (Pour un utilisateur, peut changer son mot de passe, pour l'administrateur peut changer le mot de passe de chaque utilisateur). |
| *hDroitCréationBDD* | Droit de créer une base de données. |
| *hDroitDéconnecteClient* | Droit de déconnecter les postes client. |
| *hDroitEnvoieMessageVersClient* | Droit d'envoyer des messages aux postes client. |
| *hDroitGèreTâche* | Droit de gérer les tâches planifiées. |
| *hDroitGestionServeur* | Droit d'utiliser la fonction [HGèreServeur](../WDLang4/3044359.md). |
| *hDroitGestionUtilisateur* | Droit de supprimer ou d'ajouter des utilisateurs ou des groupes. |
| *hDroitLectureLogStat* | Droit de consulter les statistiques d'activité et les logs du serveur. |
| *hDroitPriorité* | Droit de modifier la priorité de l'application en cours (fonction [HPriorité](../WDLang4/3044352.md)) ou d'une autre application cliente (fonction [HPrioritéClient](../WDLang4/3044353.md)). |
| *hDroitRéplicationServeur* | Droit de définir et de réaliser une réplication entre 2 serveurs HFSQL. |
| *hDroitSauvegarde* | Droit de réaliser une sauvegarde. Cette information n'est pas renvoyée par la constante *hDroitTous* utilisée avec la fonction **HInfoDroitServeur**. Cette information est renvoyée par la constante *hDroitTous* utilisée avec la fonction [HInfoDroitBaseDeDonnées](../WDLang4/3044320.md). |
| *hDroitTous* | Liste de tous les droits.<br>Il est conseillé d'utiliser cette constante en mode d'affichage *hDétail*ou *hEffectif*+ *hDétail*. |
| *hDroitVisualisationUtilisateur* | Droit de visualiser les différents utilisateurs et groupes. |



**`<Mode d'affichage> : (Constante optionnelle de type Entier)`**

Mode d'affichage du résultat :


|   |   |
| --- | --- |
| *hDéfaut*<br>(Valeur par défaut) | Le droit renvoyé ne tient pas compte des droits qui seront éventuellement hérités (par exemple, les droits définis pour les groupes auxquels l'utilisateur appartient).<br>Si le droit n'a pas été défini, la valeur de ce droit sera *hHérité*.<br>&lt;Résultat&gt; contient uniquement les valeurs des droits demandés (dans le même ordre). |
| *hDétail* | Idem *hDéfaut*.<br>&lt;Résultat&gt; contient le droit et sa valeur. |
| *hEffectif* | Le droit renvoyé correspond au droit qui sera effectivement appliqué pour l'utilisateur ou le groupe sur le serveur. Les droits éventuellement hérités sont pris en compte (par exemple, les droits définis pour les groupes auxquels l'utilisateur appartient). |
| *hEffectif + hDétail* | Idem *hEffectif*. <br>&lt;Résultat&gt; contient le droit et sa valeur. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
Pour modifier les droits sur un serveur pour un utilisateur ou un groupe, utilisez la fonction [HModifieDroitServeur](../WDLang4/3044328.md).

<a name="XComposante"></a>

## Composante :
wd280hf.dll
