
## HConstruitValCléANSI (Fonction)

***En anglais : HBuildKeyValueANSI***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
**Quelle que soit la plateforme utilisée, les données enregistrées dans les fichiers de données HFSQL sont au format ANSI.**

Sous une plateforme UNICODE, la fonction **HConstruitValCléANSI** permet de construire la valeur d'une clé composée pour enregistrer cette clé composée dans un fichier de données HFSQL.

Sous une plateforme ANSI, cette fonction est équivalente à [HConstruitValClé](../WDLang4/3044258.md).

**La fonction HConstruitValCléANSI ne doit pas être utilisée** pour :

- réaliser un filtre (fonction [HFiltre](../WDLang4/3044100.md)) sur une clé composée.

- effectuer une recherche (fonctions [HLitRecherchePremier](../WDLang4/3044036.md), [HLitRechercheDernier](../WDLang4/3044034.md), etc.) sur une clé composée.




Pour les filtres ou les recherches, utilisez la fonction [HConstruitValClé](../WDLang4/3044258.md).

**Rappel** : Les clés composées sont des chaînes binaires dont le contenu ne peut pas être affiché directement. Pour plus de détails sur la gestion des clés composées, consultez [Clés composées](../WDLang4/3044178.md).




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Affectation d'une rubrique dans un fichier de données lié
Facture.NomClientPrénom = HConstruitValCléANSI(Client, ...
	NomClientPrénom, Client.Nom, Client.Prénom)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HConstruitValCléANSI(<Fichier de données> , <Clé composée> , <Valeur des composantes>)`
---

**`<Résultat> : (Chaîne de caractères)`**

Valeur de la clé composée à enregistrer dans le fichier de données.

**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données HFSQL utilisé.

**`<Clé composée> : (Chaîne de caractères)`**

Nom de la rubrique correspondant à la clé composée. 

**`<Valeur des composantes> : (Chaîne de caractères)`**

Valeur à affecter à chaque composante de la clé composée. 
Ce paramètre est de la forme &lt;Composante 1&gt; , &lt;Composante 2&gt;, ...,&lt;Composante N&gt;. 
Par exemple : "MOULIN", "Françoise".  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png) 

### Quand utiliser la fonction HConstruitValCléANSI ? 
<a name="quand_utiliser_fonction_docparampagetitleshort_ELTPARAGRAPHE000090"></a>La fonction **HConstruitValCléANSI** peut et doit être utilisée pour enregistrer la valeur d'une clé composée utilisée comme clé de liaison dans un fichier de données.

Exemple :
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=HconstruitValcleANSI.gif)


Pour enregistrer une nouvelle facture sur une plateforme UNICODE, utilisez le code suivant :


```wl
Facture.NumFacture = ... 
...
Facture.NomClientPrénom = HConstruitValCléANSI(Client, ...
	NomClientPrénom, Client.Nom, Client.Prénom)
...
HAjoute(Facture)
```


<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
