


## &lt;Source&gt;.Mode (Fonction)

***En anglais : &lt;Source&gt;.Mode***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Change le mode et la méthode de blocage des fichiers de données.

![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) **Attention** : Si le provider OLE DB ou le Connecteur Natif utilisé ne gère pas les blocages, les options de blocage seront sans effet.

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette fonction est sans effet et retourne toujours la constante *hModeMulti*.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Change le mode de tous les fichiers
HMode("*", hModeMulti)

// Rend le fichier "Client" inaccessible aux autres applications
Client.Mode(hModeMono)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Modification du mode de blocage

`<Résultat> = <Source>.Mode(<Mode>)`
---

**`<Résultat> : (Constante de type entier)`**

Mode de blocage effectué sur le fichier de données avant modification.


|   |   |
| --- | --- |
| *hModeMono* | Mode mono utilisateur : les fichiers de données sont totalement bloqués en lecture et en écriture dès leur ouverture. Ce mode empêche tout autre application à accéder aux fichiers de données déjà ouverts par l'application en cours. |
| *hModeMulti* | Mode multi-utilisateurs : les fichiers de données ne sont pas bloqués à leur ouverture. Les autres applications peuvent accéder aux fichiers de données. |


![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Le résultat correspond toujours à *hModeMulti*.![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Le résultat correspond toujours à *hModeMulti*.

**`<Source> : (Type correspondant à la source spécifiée)`**

Nom du fichier de données manipulé. 

**`<Mode> : (Constante de type entier)`**

Mode de blocage à effectuer sur le fichier de données. 



|   |   |
| --- | --- |
| *hModeMono*<br>(valeur par défaut) | **Mode mono utilisateur** : les fichiers de données sont totalement bloqués en lecture et en écriture dès leur ouverture. Ce mode empêche tout autre application à accéder aux fichiers de données déjà ouverts par l'application en cours. |
| *hModeMulti* | **Mode multi-utilisateurs** : les fichiers de données ne sont pas bloqués à leur ouverture. Les autres applications peuvent accéder aux fichiers de données. |


![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Le mode utilisé est toujours *hModeMulti*.


<a name="SYNTAXE2"></a>

### Modification du mode de blocage et de la méthode de blocage (utilisation avancée)

`<Résultat> = <Source>.Mode(<Mode> [, <Méthode>])`
---

**`<Résultat> : (Constante de type entier)`**

Mode de blocage effectué sur le fichier de données avant modification.


|   |   |
| --- | --- |
| *hModeMono* | **Mode mono utilisateur** : les fichiers de données sont totalement bloqués en lecture et en écriture dès leur ouverture. Ce mode empêche tout autre application à accéder aux fichiers de données déjà ouverts par l'application en cours. |
| *hModeMulti* | **Mode multi-utilisateurs** : les fichiers de données ne sont pas bloqués à leur ouverture. Les autres applications peuvent accéder aux fichiers de données. |


![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Le résultat correspond toujours à *hModeMulti*.![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Le résultat correspond toujours à *hModeMulti*.

**`<Source> : (Type correspondant à la source spécifiée)`**

Nom du fichier de données manipulé. 

**`<Mode> : (Constante de type entier)`**

Mode de blocage à effectuer sur le fichier de données. 



|   |   |
| --- | --- |
| *hModeMono*<br>(valeur par défaut) | **Mode mono utilisateur** : les fichiers de données sont totalement bloqués en lecture et en écriture dès leur ouverture. Ce mode empêche tout autre application à accéder aux fichiers de données déjà ouverts par l'application en cours. |
| *hModeMulti* | **Mode multi-utilisateurs** : les fichiers de données ne sont pas bloqués à leur ouverture. Les autres applications peuvent accéder aux fichiers de données. |


![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Le mode utilisé est toujours *hModeMulti*.

**`<Méthode> : (Constante de type entier optionnelle)`**

Méthode de mise en place des blocages :


|   |   |
| --- | --- |
| *hModeDirect*<br>(valeur par défaut) | Mise en place des blocages prioritaire (sur la modification par exemple). <br>Ainsi, la modification d'un enregistrement sur lequel de nombreuses lectures sont réalisées a peu de chances d'être effectuée, mais les blocages sont plus rapides. |
| *hModeRéservation* | Mise en place des blocages non prioritaire (utilisation avancée)<br>Cette méthode permet de modifier immédiatement un enregistrement sur lequel de nombreuses lectures sont effectuées. Cette méthode est plus lente que la méthode *hModeDirect*.<br>Cette constante est utile uniquement si un grand nombre de lectures bloquantes sont effectuées successivement sur un même enregistrement. |


![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Ce paramètre n'est pas pris en compte. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Mode de blocage
<a name="mode_blocage_ELTPARAGRAPHE000355"></a>Par défaut, si le projet en cours :

- est associé à une analyse, le mode de blocage effectué sur les fichiers de données est multi-utilisateurs (les fichiers de données ne sont pas bloqués à leur ouverture, les autres applications peuvent accéder aux fichiers de données).

- n'est pas associé à une analyse, le mode de blocage effectué sur les fichiers de données est mono-utilisateurs : les fichiers de données sont totalement bloqués en lecture et en écriture dès leur ouverture. Ce mode empêche tout autre application à accéder aux fichiers de données déjà ouverts par l'application en cours.




Pour modifier le mode de blocage utilisé :

1. Affichez la fenêtre de description du projet : sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description". 

2. Affichez l'onglet "Fichiers".

3. Spécifiez le mode de blocage à utiliser (option "Mode de gestion des fichiers").



<a name="NOTE0_2"></a>


### Changement de mode
<a name="changement_mode_ELTPARAGRAPHE000386"></a>Le changement de mode entraîne la suppression de tous les blocages en cours sur le fichier de données. 
Il n'est pas nécessaire de fermer le fichier de données pour changer de mode.
<a name="NOTE0_3"></a>


### Changement de méthode
<a name="changement_methode_ELTPARAGRAPHE000398"></a>Le changement de méthode n'a aucune influence sur les blocages en cours sur le fichier de données. 
Il n'est pas nécessaire de fermer le fichier de données pour changer de méthode.
<a name="NOTE0_4"></a>


### Changement de mode et de méthode
<a name="changement_mode_methode_ELTPARAGRAPHE000410"></a>Le changement de mode et de méthode est réalisé directement sur le fichier de données physique. Ce changement est donc répercuté sur le fichier de données et sur tous ses alias.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
