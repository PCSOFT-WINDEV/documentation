


## HDécritFichier (Fonction)

***En anglais : HDescribeFile***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Décrit un fichier de données par programmation.

Après l'appel à la fonction **HDécritFichier** :

- le fichier de données peut être manipulé comme n'importe quel fichier décrit dans l'analyse.

- la description du fichier de données ne peut plus être modifiée.

- la variable de description du fichier de données est ré-initialisée. Une nouvelle description de fichier de données peut être effectuée.




Pour annuler la description de fichier de données par programmation, utilisez la fonction [HAnnuleDéclaration](../WDLang4/3044174.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Exemple utilisant la syntaxe 1
UnFichier est une Description de Fichier
UneRubrique est une Description de Rubrique
Client est une Source de Données

// Description du fichier de données "Client"
UnFichier.Nom = "Client"
UnFichier.Type = hFichierNormal
UnFichier.CryptageFic = hCryptageStandard

// Description de la rubrique "Nom"
UneRubrique.Nom = "NOM"
UneRubrique.Type = hRubTexte
UneRubrique.Taille = 40
UneRubrique.TypeClé = hCléUnique
HDécritRubrique(UnFichier, UneRubrique)

// Description de la rubrique "Prénom"
UneRubrique.Nom = "PRENOM"
UneRubrique.Type = hRubTexte
UneRubrique.Taille = 40
HDécritRubrique(UnFichier, UneRubrique)

// Valide la description du fichier de données 
HDécritFichier(UnFichier)
...

// Création du fichier de données Client (reconnu car déclaré comme source de données)
HCréation(Client)

// Création d'un enregistrement
Client.Nom = "Dupont"
Client.Prénom = "André"
HAjoute(CLIENT)
```
<a name="Exemple2"></a>

```wl
// Exemple utilisant la syntaxe 2
UneDescriptionFichier est une Description de Fichier
UneRubrique est une Description de Rubrique
sdSource est une Source de Données 
 
// Description du fichier de données "CLIENT"
UneDescriptionFichier.Nom = "CLIENT"
UneDescriptionFichier.Type = hFichierNormal
UneDescriptionFichier.CryptageFic = hCryptageStandard
 
// Description de la rubrique "NOM"
UneRubrique.Nom = "NOM"
UneRubrique.Type = hRubTexte
UneRubrique.Taille = 40
UneRubrique.TypeClé = hCléUnique
HDécritRubrique(UneDescriptionFichier, UneRubrique)
 
// Description de la rubrique "PRENOM"
UneRubrique.Nom = "PRENOM"
UneRubrique.Type = hRubTexte
UneRubrique.Taille = 40
HDécritRubrique(UneDescriptionFichier, UneRubrique)
 
// Valide la description du fichier de données
HDécritFichier(sdSource, UneDescriptionFichier)

HCréation(sdSource)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Décrire un fichier de données par programmation

`<Résultat> = HDécritFichier(<Fichier de données>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la description du fichier de données est valide et peut être utilisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur.




**`<Fichier de données> : (Variable de type Description de fichier)`**

Nom de la variable de type [Description de Fichier](../WDLang4/1514065.md) (voir paragraphe Notes) permettant de décrire le fichier de données. Le nom du fichier de données sera défini grâce à la propriété [Nom](../Proprietes/2510082.md).  


<a name="SYNTAXE3"></a>

### Décrire un fichier de données par programmation via une source de données

`<Résultat> = HDécritFichier(<Source de données> , <Fichier de données>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la description du fichier de données est valide et peut être utilisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur.




**`<Source de données> : (Variable de type Source de données)`**

Nom de la variable de type [Source de données](../WDLang4/1514053.md) associée au fichier de données. 

**`<Fichier de données> : (Variable de type Description de fichier)`**

Nom de la variable de type [Description de Fichier](../WDLang4/1514065.md) (voir paragraphe Notes) permettant de décrire le fichier de données. Le nom du fichier de données sera défini grâce à la propriété [Nom](../Proprietes/2510082.md).  


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) 
### Décrire un fichier de données au format Hyper File 5.5 par programmation (compatibilité uniquement)

`<Résultat> = HDécritFichier(<Fichier de données> , <Abréviation> [, <Chemin d'accès>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur.




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données temporaire à créer. **Ce fichier de données temporaire est au format Hyper File 5.5.**

**`<Abréviation> : (Chaîne de 2 caractères)`**

Préfixe du fichier de données.

**`<Chemin d'accès> : (Chaîne de caractères optionnelle)`**

Nom du répertoire ou du lecteur dans lequel sera créé le fichier de données physique. Si ce paramètre n'est pas précisé, le fichier de données sera créé (fonction [HCréation](../WDLang4/3044255.md)) dans le répertoire courant des programmes.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Comment décrire un fichier de données par programmation ? 
<a name="comment_decrire_fichier_donnees_par_programmation_ELTPARAGRAPHE000156"></a>Pour décrire un fichier de données par programmation, il faut :

- **Solution 1 (syntaxe 1) : Description directe**

	1. Utiliser des variables de type [Description de Fichier](../WDLang4/1514065.md), [Description de Rubrique](../WDLang4/1514071.md), [Description de Liaison](../WDLang4/1514039.md) et [Description d'IndexFullText](../WDLang4/1000017461.md) (si nécessaire).

	2. Décrire les caractéristiques du fichier de données, de ses rubriques, de ses liaisons et de ses index full-text (si nécessaire) grâce aux propriétés HFSQL.

	3. Fixer la description des rubriques avec la fonction [HDécritRubrique](../WDLang4/3044233.md).

	4. Fixer la description des index full-text avec la fonction [HDécritIndexFullText](../WDLang4/1000017407.md).

	5. Fixer la description du fichier de données (fonction **HDécritFichier**, syntaxe 1) et des liaisons si nécessaire (fonction [HDécritLiaison](../WDLang4/3044191.md)).




- **Solution 2 (syntaxe 2) : Description à l'aide d'une source de données**
	Cette solution permet d'associer le fichier de données décrit à une source de données. Dans ce cas, lorsque cette variable sera supprimée, le fichier de données sera également supprimé.  
	Attention : Pour utiliser cette syntaxe, il est nécessaire d'utiliser une source de données "automatique". Pour plus de détails, consultez [Description du projet : Onglet Compilation](../Editeurs/9500218.md).  

	1. Déclarer une variable de type [Source de données](../WDLang4/1514053.md). 

	2. Utiliser des variables de type [Description de Fichier](../WDLang4/1514065.md), [Description de Rubrique](../WDLang4/1514071.md), [Description de Liaison](../WDLang4/1514039.md) et [Description d'IndexFullText](../WDLang4/1000017461.md) (si nécessaire).

	3. Décrire les caractéristiques du fichier de données, de ses rubriques, de ses liaisons et de ses index full-text (si nécessaire) grâce aux propriétés HFSQL.

	4. Fixer la description des rubriques avec la fonction [HDécritRubrique](../WDLang4/3044233.md).

	5. Fixer la description des index full-text avec la fonction [HDécritIndexFullText](../WDLang4/1000017407.md).

	6. Associer la description du fichier de données à la source de données (fonction **HDécritFichier**, syntaxe 2) et des liaisons si nécessaire (fonction [HDécritLiaison](../WDLang4/3044191.md)).






<a name="NOTE0_2"></a>


### Liste des propriétés HFSQL utilisables pour décrire un fichier de données par programmation
<a name="liste_des_proprietes_hfsql_utilisables_pour_decrire_fichier_donnees_par_programmation_ELTPARAGRAPHE000287"></a>Les propriétés suivantes sont disponibles en lecture et écriture.



|   |   |
| --- | --- |
| [CompressionMmo](../Proprietes/2512028.md) | La propriété **CompressionMmo** permet de paramétrer le mode de compression du fichier MMO (contenant les mémo binaires et texte) associé au fichier de données. |
| [CryptageFic](../Proprietes/2512046.md) | La propriété **CryptageFic** permet de paramétrer le mode de cryptage du fichier de données. |
| [CryptageMmo](../Proprietes/2512014.md) | La propriété **CryptageMmo** permet de paramétrer le mode de cryptage du fichier mémo (d'extension .MMO) associé au fichier de données. |
| [CryptageNdx](../Proprietes/2512010.md) | La propriété **CryptageNdx** permet de paramétrer le mode de cryptage du fichier d'index (d'extension .NDX) associé au fichier de données. |
| [CxAccès](../Proprietes/2512015.md) | La propriété **CxAccès** permet de gérer le type d'accès au fichier de données lors de la connexion OLE DB à une table spécifique. |
| [CxAccèsDécrit](../Proprietes/2512048.md) | La propriété **CxAccèsDécrit** permet de gérer le type d'accès au fichier de données lors de la connexion OLE DB à une table spécifique. |
| [CxBaseDeDonnées](../Proprietes/2512047.md) | La propriété **CxBaseDeDonnées** permet de gérer la source de données OLE DB lors de la connexion OLE DB à une table spécifique. |
| [CxBaseDeDonnéesDécrite](../Proprietes/2512016.md) | La propriété **CxBaseDeDonnéesDécrite** permet de gérer la source de données OLE DB lors de la connexion OLE DB à une table spécifique. |
| [CxLibelléDécrit](../Proprietes/2512021.md) | La propriété **CxLibelléDécrit** permet de gérer le libellé de la connexion à la source de données OLE DB. |
| [CxMotDePasseDécrit](../Proprietes/2512012.md) | La propriété **CxMotDePasseDécrit** permet de définir le mot de passe utilisé pour ouvrir le fichier lors d'une connexion OLE DB (fichier défini par programmation uniquement). |
| [CxProviderOLEDB](../Proprietes/2512033.md) | La propriété **CxProviderOLEDB** permet de gérer le nom du provider OLE DB (appelé aussi serveur OLE DB). |
| [CxProviderOLEDBDécrit](../Proprietes/2512025.md) | La propriété **CxProviderOLEDBDécrit** permet de gérer le nom du provider OLE DB (appelé aussi serveur OLE DB). |
| [CxUtilisateur](../Proprietes/2512026.md) | La propriété **CxUtilisateur** permet de paramétrer le nom de l'utilisateur utilisé lors de la connexion OLE DB à une table spécifique. |
| [CxUtilisateurDécrit](../Proprietes/2512022.md) | La propriété **CxUtilisateurDécrit** permet de paramétrer le nom de l'utilisateur utilisé lors de la connexion OLE DB à une table spécifique. |
| [Format](../Proprietes/2512045.md) | La propriété **Format** permet de paramétrer le format des données du fichier de données. |
| [GrosFichier](../Proprietes/2512037.md) | La propriété **GrosFichier** permet de paramétrer la taille maximale d'un fichier de données. |
| [Journalisation](../Proprietes/2512044.md) | La propriété **Journalisation** permet de :<br><br>- connaître le mode de journalisation utilisé pour un fichier de données (fichier défini sous l'éditeur d'analyses ou défini par programmation).<br><br>- définir le mode de journalisation utilisé pour un fichier de données (lors de la description du fichier par programmation uniquement).<br><br><br> |
| [MotDePasseWDD55](../Proprietes/2512049.md) | La propriété **MotDePasseWDD55** permet de spécifier le mot de passe de l'analyse au format 5.5 lors de la description par programmation d'un fichier de données au format Hyper File 5.5 dans une analyse au format HFSQL Classic. |
| [Nom](../Proprietes/2510082.md) | La propriété **Nom** permet de connaître :<br><br>- le nom de la police associée à une variable de type Police.<br><br>- le nom d'un champ, d'un état ou d'un bloc d'un état.<br><br>- le nom d'un champ, d'un groupe de champs ou d'une fenêtre.<br><br>- le nom d'un champ, d'un groupe de champs ou d'une page.<br><br><br> |
| [Nom55](../Proprietes/2512054.md) | La propriété **Nom55** permet de gérer le nom logique d'un fichier de données au format Hyper File 5.5 non migré et présent dans une analyse au format WINDEV 19. |
| [NomDécrit](../Proprietes/2512066.md) | La propriété **NomDécrit** permet de gérer le nom logique des fichiers de données HFSQL (sans tenir compte des éventuelles modifications effectuées par la fonction [HAlias](../WDLang4/3044176.md)). |
| [NomPhysique](../Proprietes/2512059.md) | La propriété **NomPhysique** permet de gérer le nom physique des fichiers de données HFSQL. |
| [NomPhysiqueDécrit](../Proprietes/2512063.md) | La propriété **NomPhysiqueDécrit** permet de gérer le nom physique des fichiers de données HFSQL. |
| [Répertoire](../Proprietes/2512078.md) | La propriété **Répertoire** permet de gérer le répertoire physique des fichiers de données HFSQL. |
| [RépertoireDécrit](../Proprietes/2512074.md) | La propriété **RépertoireDécrit** permet de gérer le répertoire physique des fichiers de données HFSQL. |
| [RépertoireJournal](../Proprietes/2512075.md) | La propriété **RépertoireJournal** permet de gérer le répertoire du fichier journal décrit dans l'analyse. |
| [RubriqueTexteComplétée](../Proprietes/2512080.md) | La propriété **RubriqueTexteComplétée** permet de paramétrer la gestion des rubriques texte dans un fichier de données HFSQL. |
| [Sécurisé](../Proprietes/2512082.md) | La propriété **Sécurisé** permet de paramétrer le niveau de sécurité du cryptage des fichiers de données. |
| [Type](../Proprietes/2510131.md) | La propriété **Type** permet de connaître :<br><br>- le type d'un élément décrit par programmation (description de rubrique ou de fichier) ou non (fichier ou rubrique défini sous l'éditeur d'analyses, vue ou requête).<br><br>- le type d'un objet.<br><br>- le type de la valeur stockée dans un variant.<br><br><br> |
| [WDD55](../Proprietes/2512094.md) | La propriété **WDD55** permet de :<br><br>- Connaître le nom et le chemin complet du fichier WDD au format Hyper File 5.5. <br><br>- Définir le nom et le chemin complet du fichier WDD au format Hyper File 5.5. <br><br><br> |




<a name="NOTE0_3"></a>


### Les types de fichiers de données pouvant être décrits avec la fonction HDécritFichier
<a name="les_types_fichiers_donnees_pouvant_etre_decrits_avec_fonction_docparampagetitleshort_ELTPARAGRAPHE000297"></a>La propriété [Type](../Proprietes/2510131.md) permet de spécifier le type du fichier de données à créer.

Les types suivants peuvent être créés avec la fonction **HDécritFichier** :


|   |   |
| --- | --- |
| *hFichierAS400* | Fichier AS 400 |
| *hFichierNormal* | Fichier normal |
| *hFichierOLEDB* | Fichier OLE DB |
| *hFichierOracle* | Fichier Oracle |
| *hFichierSQLAzure* | Fichier SQL Azure |
| *hFichierSQLServer* | Fichier SQL Server |
| *hFichierSybase* | Fichier Sybase |
| *hFichierXBase* | Fichier xBase |


<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) 

### Syntaxe 2 : Description de fichier de données (compatibilité 5.5)
<a name="syntaxe_2_description_fichier_donnees_compatibilite_55_ELTPARAGRAPHE000351"></a>Cette syntaxe permet de créer des fichiers de données temporaires au format Hyper File 5.5. Cette syntaxe n'est utilisable que dans une application réalisée avec WINDEV 5.5 ou WEBDEV 1.5 et migrée vers WINDEV 7 ou supérieure. Pour utiliser cette fonction, il est nécessaire que :

- l'analyse au format Hyper File 5.5 soit accessible sur le poste de développement et chargée.

- le chemin de l'analyse Hyper File 5.5 soit spécifié dans les caractéristiques de l'analyse (onglet "Détail").




<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
