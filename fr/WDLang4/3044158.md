


## HActiveFiltre (Fonction)

***En anglais : HActivateFilter***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Active le filtre précédemment créé pour le fichier de données (la vue ou la requête) spécifié. Ce filtre a été créé avec la fonction [HFiltre](../WDLang4/3044100.md) et désactivé avec la fonction [HDésactiveFiltre](../WDLang4/3044085.md). Si aucun filtre n'a été déclaré, la fonction **HActiveFiltre** est sans effet.

Cette fonction peut être utilisée indifféremment avec les fichiers de données, les vues HFSQL ou les requêtes.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Déclaration du filtre : sélection des clients
// qui ont entre 20 et 60 ans
HFiltre(Client, Age_Client, 20, 60)
...
HDésactiveFiltre(Client) // Filtre désactivé
...
// Parcours du fichier de données avec filtre sur l'âge
// Traitement des clients qui ont entre 20 et 60 ans
// (procédure TraiteClient2060)
HActiveFiltre(Client)
HLitPremier(Client, Age_Client)
TANTQUE HTrouve(Client) = Vrai
	TraiteClient2060()
	HLitSuivant(Client, Age_Client)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HActiveFiltre([<Fichier de données>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le filtre est activé, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur (fichier ou rubrique inexistant).




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données, de la vue HFSQL ou de la requête manipulé.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Activation et désactivation d'un filtre
<a name="activation_desactivation_filtre_ELTPARAGRAPHE000098"></a>Après la déclaration d'un filtre (fonction [HFiltre](../WDLang4/3044100.md)), le filtre est actif. Le filtre peut être désactivé grâce à la fonction [HDésactiveFiltre](../WDLang4/3044085.md).
<a name="NOTE0_2"></a>


### Nombre de filtres actifs possibles
<a name="nombre_filtres_actifs_possibles_ELTPARAGRAPHE000113"></a>Pour un fichier de données spécifique, un seul filtre peut être actif à la fois.
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png) 

### Fonctionnement en OLE DB
<a name="fonctionnement_ole_ELTPARAGRAPHE000124"></a>Si la fonction **HActiveFiltre** est utilisée lors du parcours d'un fichier de données, le parcours est arrêté. Pour prendre en compte le filtre, il faut ré-initialiser le parcours avec les fonctions [HLitPremier](../WDLang4/3044051.md)/[HPremier](../WDLang4/3044113.md) ou [HLitDernier](../WDLang4/3044140.md)/[HDernier](../WDLang4/3044101.md).

La position en cours et toutes les positions sauvegardées sont perdues. La restauration de la position sera effectuée à partir de la valeur de la meilleure rubrique.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
