


## HEnregistre (Fonction)

***En anglais : HSave***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie l'enregistrement courant s'il existe, sinon ajoute un nouvel enregistrement.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
EcranVersFichier(Client)
HEnregistre(Client)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = HEnregistre([<Fichier de données> [, <Options>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'ajout ou la modification a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur.




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données, de la vue ou de la requête manipulé. Si ce nom n'est pas spécifié, la fonction **HEnregistre** va manipuler le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Options> : (Constante optionnelle de type entier)`**

Permet de paramétrer :

- l'influence de l'ajout ou de la modification sur le parcours en cours.

- le mode de calcul de l'identifiant automatique. Pour plus de détails, consultez [Gestion de l'identifiant automatique lors d'un ajout](../WDLang4/3044183.md).

- le mode de blocage de l'enregistrement ajouté ou modifié.

- la gestion des doublons.

- la gestion de l'intégrité.


![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Ce paramètre n'est pas pris en compte.


|   |   |
| --- | --- |
| *hAffecteParcours* | **Influence de l'ajout/modification sur le parcours** : L'ajout ou la modification affecte le parcours. <br>Par exemple, la fonction [HLitSuivant](../WDLang4/3044037.md) utilisée après la fonction **HEnregistre** positionne sur l'enregistrement suivant l'enregistrement ajouté/modifié.<br>La constante *hAffecteParcours* est prioritaire sur la constante *hEcritureDéfaut*. |
| *hBlocageEcriture* | **Mode de blocage de l'enregistrement ajouté ou modifié** : Blocage en écriture : l'enregistrement ajouté ou modifié sera bloqué en écriture. Cet enregistrement pourra être lu par une autre application mais ne pourra pas être modifié par une autre application. Seule l'application en cours pourra le modifier ou le débloquer.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hBlocageLectureEcriture* | **Mode de blocage de l'enregistrement ajouté ou modifié** : Blocage en lecture/écriture : l'enregistrement ajouté ou modifié sera bloqué en lecture et en écriture. Cet enregistrement ne pourra ni être lu ni être modifié par une autre application. Seule l'application en cours pourra le modifier, le lire ou le débloquer.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hBlocageNon* <br>(valeur par défaut) | **Mode de blocage de l'enregistrement ajouté ou modifié** : Aucun blocage : l'enregistrement ajouté ou modifié ne sera pas bloqué.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hEcritureDéfaut*<br>(valeur par défaut) | **Influence de l'ajout ou de la modification sur le parcours** : L'ajout ou la modification n'affecte pas le parcours en cours. <br>Par exemple, la fonction [HLitSuivant](../WDLang4/3044037.md) utilisée après la fonction **HEnregistre** positionne sur l'enregistrement suivant l'enregistrement en cours avant l'ajout ou la modification.<br>La constante *hAffecteParcours* est prioritaire sur la constante *hEcritureDéfaut*. |
| *hFixeIDAuto* | **Mode de calcul de l'identifiant automatique** : L'identifiant automatique n'est pas calculé lors de l'ajout : la valeur de l'identifiant sera celle mémorisée au moment de l'ajout. <br><u><u><u><u>La prochaine valeur de l'identifiant calculée par le moteur HFSQL correspondra à la plus grande valeur de l'identifiant dans le fichier +1. </u></u></u></u><br>Si les constantes *hFixeIDAuto* et *hForceIDAuto* sont utilisées en même temps, une erreur WLangage est générée. |
| *hForceIDAuto* | **Mode de calcul de l'identifiant automatique** : L'identifiant automatique n'est pas calculé lors de l'ajout. L'identifiant correspond :<br><br>- soit à la valeur affectée à la rubrique par programmation (par exemple CLCLEUNIK = 7)<br><br>- soit à la valeur par défaut de l'identifiant spécifiée dans l'éditeur d'analyses (si le fichier de données vient d'être ouvert, sans lecture d'enregistrement)<br><br>- soit à la valeur de l'identifiant présent en mémoire (valeur de l'identifiant pour le dernier enregistrement lu dans le fichier de données).<br><br><br>Après l'ajout de l'enregistrement, le prochain identifiant automatique calculé par défaut par le moteur HFSQL sera calculé sans tenir compte de la valeur ajoutée par *hForceIDAuto*.<br>Si les constantes *hFixeIDAuto* et *hForceIDAuto* sont utilisées en même temps, une erreur WLangage est générée. |
| *hIgnoreDoublon* | **Mode de gestion des doublons** : Ignore le contrôle des doublons pour cette opération, même si le contrôle automatique des doublons est branché (fonction [HGèreDoublon](../WDLang4/3044057.md)).<br>Si les constantes *hIgnoreDoublon* et *hVérifieDoublon* sont utilisées en même temps, une erreur WLangage est générée.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hIgnoreIntégrité* | **Mode de gestion de l'intégrité** : Ignore le contrôle d'intégrité sur cette opération d'ajout, même si le contrôle de l'intégrité automatique est branché (fonction [HGèreIntégrité](../WDLang4/3044058.md)).<br>Si les constantes *hIgnoreIntégrité* et *hVérifieIntégrité* sont utilisées en même temps, une erreur WLangage est générée.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hRecalculeIDAuto* | **Mode de calcul de l'identifiant automatique** : L'identifiant automatique de l'enregistrement sera recalculé lors de l'écriture. Cette constante est prioritaire sur les constantes *hForceIDAuto* et *hFixeIDAuto*.<br> |
| *hVérifieDoublon* | **Mode de gestion des doublons** : Contrôle les doublons pour cette opération, même si le contrôle des doublons est débranché (fonction [HGèreDoublon](../WDLang4/3044057.md)).<br>Si les constantes *hIgnoreDoublon* et *hVérifieDoublon* sont utilisées en même temps, une erreur WLangage est générée.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hVérifieIntégrité* | **Mode de gestion de l'intégrité** : Contrôle l'intégrité de l'opération même si le contrôle de l'intégrité automatique est débranché (fonction [HGèreIntégrité](../WDLang4/3044058.md)).<br>Si les constantes *hIgnoreIntégrité* et *hVérifieIntégrité* sont utilisées en même temps, une erreur WLangage est générée.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Si la propriété [NouvelEnregistrement](../Proprietes/1000017090.md) est à <u><u><u><u>Vrai</u></u></u></u>, la fonction **HEnregistre** ajoute l'enregistrement dans le fichier de données (fonction [HAjoute](../WDLang4/3044147.md)). Pour plus de détails, consultez la documentation de la fonction [HAjoute](../WDLang4/3044147.md). 

- Si la propriété [NouvelEnregistrement](../Proprietes/1000017090.md) est à <u><u><u><u>Faux</u></u></u></u>, la fonction **HEnregistre** modifie l'enregistrement dans le fichier de données (fonction [HModifie](../WDLang4/3044042.md)). Pour plus de détails, consultez la documentation de la fonction [HModifie](../WDLang4/3044042.md). 





## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
