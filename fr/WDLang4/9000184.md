
## Keep-alive sur connexion
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000081"></a>
Une connexion à la base de données peut être coupée à tout instant au niveau "matériel" : câble arraché, mise en veille de l'appareil, connexion Wifi interrompue, ...

Lors d'une perte de connexion de ce type, la norme TCP/IP ne prévoit rien. Le serveur reste en attente de communication éventuelle du client.

HFSQL Client/Serveur permet de définir un timeout ou plus précisément un time-to-live (TTL). 

Il est possible de définir une fréquence à laquelle le serveur vérifiera la présence du client. Sans réponse du client, la connexion est fermée, ce qui libère les transactions en cours : finies les connexions "fantômes" à cause des mobiles !

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000105"></a>
Pour configurer le keep-alive sur connexion sur un serveur HFSQL : 

- Par programmation : utilisez la fonction [HGèreServeur](../WDLang4/3044359.md) et les constantes *hkaIntervalle* et *hkaTimeout* : 

	- la constante **hkaIntervalle** permet de définir le temps maximum (en secondes) au bout duquel, si aucune communication n'est effectuée entre le serveur et le client, le serveur vérifie la présence du client. Par défaut, ce temps correspond à 30 minutes. 

	- la constante **hkaTimeout** permet de définir la durée d'attente du serveur lors de la vérification de la présence du client. Si le client n'est pas présent à la fin de cette durée, le client est automatiquement déconnecté (côté serveur). Par défaut, cette durée vaut 2 minutes. 




- Via le fichier HFConf.INI :

	- le mot-clé **KeepAliveInterval** de la section INIT permet de définir le temps maximum (en secondes) au bout duquel, si aucune communication n'est effectuée entre le serveur et le client, le serveur vérifie la présence du client. Par défaut, ce temps correspond à 30 minutes. 

	- le mot-clé **KeepAliveTimeout** de la section INIT permet de définir la durée d'attente du serveur lors de la vérification de la présence du client. Si le client n'est pas présent à la fin de cette durée, le client est automatiquement déconnecté (côté serveur). Par défaut, cette durée vaut 2 minutes. 








