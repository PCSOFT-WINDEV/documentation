


## AS/400 : Méthode de développement
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000274"></a>
Le Connecteur Natif AS/400 simplifie l'accès aux données AS/400 depuis vos applications WINDEV et WEBDEV.

En phase de développement, la même méthode est utilisée quelque soit le produit utilisé.

En phase de déploiement, seule la plateforme d'exécution change : Windows avec WINDEV ou un navigateur avec WEBDEV.

Cette page présente la méthode de développement en plusieurs étapes :

1. Création du projet et de l'analyse : importation de la structure des fichiers de données.

2. Création de l'application (RAD) et programmation.

3. Création de l'exécutable (WINDEV).

4. Déploiement de l'application.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Projet et analyse
<a name="projet_analyse_ELTTEXTE000298"></a>


### Import des DDS (Reverse engineering)
<a name="import_des_dds_reverse_engineering_ELTPARAGRAPHE000029"></a>Si vous disposez d'un existant (base de données) sur votre AS/400 ou celui de votre client, il suffit d'importer les DDS définis sur l'AS/400 dans votre produit pour exploiter ces données. Les données restent sur l'AS/400. Il est possible d'accéder aux fichiers physiques, aux fichiers logiques, comme le ferait une application écrite en RPG (GAP) ou en Cobol.

WINDEV récupère automatiquement la structure des fichiers de données et crée le référentiel des données utiles au développement. Les champs AS/400 sont convertis dans le format Windows. Les données restent bien entendu au format AS/400.

Chacun des fichiers logiques devient une clé pour WINDEV (clé unique ou clé multiple). WINDEV déduit les relations entre les fichiers de données à partir de la définition des clés. Les contraintes d'intégrité définies sur l'AS/400 sont récupérées.

Pour importer les DDS : 

1. Sous le volet "Analyse", dans le groupe "Création", déroulez "Importer" et sélectionnez "Importer des descriptions de fichiers/tables". L'assistant se lance. Une connexion AS/400 est automatiquement créée et associée aux fichiers importés dans l'analyse. Cette connexion devra être utilisée pour manipuler le fichier de données AS/400 par programmation.

2. Dans les différents écrans de l'assistant, sélectionnez :

	- Source de données : base externe.

	- L'application utilisera les données dans le format actuel.

	- Lors de la sélection de la base source, indiquez le mode "Connecteur Natif pour AS/400", l'adresse IP ou le nom de l'AS/400, le nom du profil et le mot de passe associé.




3. Sélectionnez les objets AS/400 à importer et validez.




Pour plus de détails, consultez le fichier d'aide spécifique livré avec le Connecteur Natif AS/400.

**Remarque** : Lors de l'importation des fichiers AS/400 dans l'analyse, des informations étendues sont automatiquement récupérées.
<a name="NOTE2_2"></a>


### Export des DDS
<a name="export_des_dds_ELTPARAGRAPHE000066"></a>Si vous souhaitez créer de nouveaux fichiers de données sur l'AS/400 :

1. Définissez les nouveaux fichiers de données sous l'éditeur d'analyses.

2. Exportez les DDS sur l'AS/400 : sous le volet "Analyse", dans le groupe "Analyse", déroulez "Synchronisation" et sélectionnez "Synchroniser un AS400 - iSeries (DDS et données)".

3. Dans l'assistant qui se lance, sélectionnez les structures de fichiers de données à exporter. Pour chacun des fichiers de données sélectionnés, les DDS sont créés et compilés sur l'AS/400 dans la bibliothèque de votre choix (\*LIBL). Les champs PC sont convertis dans le format AS/400.




Pour plus de détails, consultez le fichier d'aide spécifique livré avec le Connecteur Natif AS/400.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Création de l'application
<a name="creation_application_ELTTEXTE000328"></a>
Après l'import des fichiers de données dans l'analyse, l'application WINDEV ou WEBDEV peut être réalisée. Le RAD (Rapid Application Development) peut également être utilisé pour créer en quelques minutes une application complète, directement utilisable.

Cette application peut être testée immédiatement.

**Que se passe-t-il sur l'AS/400 quand un programme WINDEV ou WEBDEV s'exécute ?**
A chaque application WINDEV en cours correspond une connexion physique à un job sur l'AS/400. Ce job dépend du profil défini.

**Remarque** : Le RAD permet de créer rapidement une application, mais il est également possible de créer des applications complètes directement sous l'éditeur. Tout ce qui est généré par le RAD est entièrement modifiable. Toutes les fonctions WLangage peuvent être utilisées dans une application pour l'AS/400.
<a name="NOTE3_2"></a>


### Programmation de l'accès aux données
<a name="programmation_acces_aux_donnees_ELTPARAGRAPHE000106"></a>**1. Ouverture de la connexion**

- Pour ouvrir la connexion à la base de données AS/400, utilisez la fonction [HOuvreConnexion](../WDLang4/3044107.md), en précisant le nom de la connexion à ouvrir. Ce nom a été défini lors de l'importation de la structure des fichiers de données dans l'analyse.

- Pour modifier certains paramètres de cette connexion (par exemple le nom d'utilisateur ou le mot de passe), utilisez une variable de type [Connexion](../WDLang4/1514073.md).


**Remarque** : Si vous tentez de lire directement le fichier de données (fonction [HLitPremier](../WDLang4/3044051.md), ...), la connexion associée à la description du fichier dans l'analyse sera automatiquement ouverte.

**2. Exécution de requêtes**
Les fonctions [HExécuteRequête](../WDLang4/3044080.md) et [HExécuteRequêteSQL](../WDLang4/3044084.md) permettent d'exécuter des requêtes sur la base de données en cours.

- ****[HExécuteRequête](../WDLang4/3044080.md) : permet d'exécuter une requête prédéfinie avec l'éditeur de requêtes.

- [HExécuteRequêteSQL](../WDLang4/3044084.md) : permet d'exécuter une requête en précisant directement le code SQL de la requête, et le nom qui sera attribué à ce code SQL.




**3. Récupération du résultat**
Le parcours du résultat est réalisé avec toutes les fonctions de lecture classiques : [HLitPremier](../WDLang4/3044051.md), [HLitSuivant](../WDLang4/3044037.md), [HLitRecherche](../WDLang4/3044050.md), ...

**4. Fermeture de la connexion**
La fonction [HFermeConnexion](../WDLang4/3044095.md) permet de fermer la connexion à la base de données lorsque toutes les requêtes nécessaires ont été réalisées.
<a name="NOTE3_3"></a>


### Programmation spécifique
<a name="programmation_specifique_ELTPARAGRAPHE000165"></a>Le Connecteur Natif AS/400 permet de développer des applications en mode Client/Serveur de données et également en mode Client/Serveur de traitements. Il est possible par exemple de faire :

- appels de batch ou de CL avec passage de paramètres,

- gestion des DataQueues ou des DataAreas,

- lancement de commandes AS/400, ...




Quelques exemples de fonctions spécifiques disponibles (commençant par les lettres AS) :


|   |   |
| --- | --- |
| ASLanceRPC | Lance l'exécution d'un programme AS/400 avec retour de paramètres (valeurs renvoyées par le programme, variables OutPut, comme sur l'AS/400). |
| ASAppelRtv | Lance l'exécution d'une commande AS/400 renvoyant des variables (type RTVJOBA). |
| ASResultatRtv | Récupère le résultat de la dernière commande ASAppelRtv. |
| ASExec | Appelle en direct toutes les commandes AS/400 en ligne de commande, dans le contexte de la session en cours, avec le profil utilisateur AS/400 authentifié, comme sur un terminal en mode 5250. |
| ASUtilisateur | Change le profil utilisateur AS/400 sous lequel vous êtes connecté afin d'ouvrir une session avec des privilèges différents. |


Pour plus de détails, consultez le fichier d'aide spécifique livré avec le Connecteur Natif AS/400.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Création de l'exécutable et déploiement
<a name="creation_executable_deploiement_ELTTEXTE000364"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Création de l'exécutable
<a name="creation_executable_ELTPARAGRAPHE000206"></a>La création de l'exécutable se fait comme pour toute application WINDEV via l'assistant de création d'exécutable : sous le volet "Projet", dans le groupe "Génération", cliquez sur "Générer". 
<a name="NOTE4_2"></a>


### Déploiement de l'application
<a name="deploiement_application_ELTPARAGRAPHE000225"></a>Le déploiement de l'application ou du site est réalisé via le générateur d'installation du produit utilisé.


