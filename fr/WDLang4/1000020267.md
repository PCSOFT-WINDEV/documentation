


## HFiltreContient (Fonction)

***En anglais : HFilterContains***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Définit et active un filtre de type "Contient" sur un fichier de données, une vue ou une requête. Le filtre de type "Contient" permet de sélectionner tous les enregistrements contenant une suite de caractères définie.

Ce filtre est insensible à la case.

Ce filtre n'utilise pas d'index, il parcourt tout le fichier de données.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
CléParcours est une chaîne = HFiltreContient(Client, Commentaire, "VIP")	
HLitPremier(Client, CléParcours)
TANTQUE PAS HEnDehors()
	Trace(Client.NomClient, Client.Ville)
	HLitSuivant(Client, CléParcours)
FIN
// Désactive le filtre
HDésactiveFiltre(Client)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = HFiltreContient(<Fichier de données> , <Rubrique> , <Valeur>)`
---

**`<Résultat> : (Chaîne de caractères)`**

Rubrique de parcours. Correspond : 

- soit au nom de la rubrique de parcours du fichier de données si le filtre est activé, 

- soit à une chaîne vide ("") si le filtre ne peut être mis en place. 




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données HFSQL, de la vue ou de la requête manipulé.

**`<Rubrique> : (Chaîne de caractères)`**

Nom de la rubrique sur laquelle le filtre doit être réalisé. Cette rubrique peut être une rubrique clé ou non clé. 

**`<Valeur> : (Chaîne de caractères)`**

Valeur qui doit être contenue dans la rubrique de l'enregistrement. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Filtre
<a name="filtre_ELTPARAGRAPHE000085"></a>

- Le filtre est actif dès l'appel à la fonction **HFiltreContient**.

- Syntaxes équivalentes : 
	
	```wl
	HFiltreContient(NomFichier, NomRubrique, "Valeur")
	```

	est équivalent à : 
	
	```wl
	HFiltre(NomFichier, "NomRubrique ~]'Valeur'")
	```




<a name="NOTE0_2"></a>


### Parcours filtré
<a name="parcours_filtre_ELTPARAGRAPHE000114"></a>Lorsqu'un filtre est défini et activé sur un fichier de données, tout enregistrement lu correspond au filtre. Si il n'y a plus d'enregistrement correspondant au filtre lors du parcours :

- la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u><u>Vrai</u></u></u></u>. 

- l'enregistrement en cours correspond au dernier enregistrement lu avec le filtre.




Par exemple :

| Sur un fichier de données filtré, après la fonction : | l'enregistrement en cours est : |
| --- | --- |
| **[HLitPremier](../WDLang4/3044051.md)** | le premier enregistrement du fichier de données correspondant au filtre. |
| **[HLitDernier](../WDLang4/3044140.md)** | le dernier enregistrement du fichier de données correspondant au filtre. |
| **[HLitSuivant](../WDLang4/3044037.md)** (ou **[HAvance](../WDLang4/3044154.md)**) | l'enregistrement suivant (ou le nième suivant) correspondant au filtre. |
| **[HLitPrécédent](../WDLang4/3044048.md)** (ou **[HRecule](../WDLang4/3044126.md)**) | l'enregistrement précédent (ou le nième précédent) correspondant au filtre. |


<a name="NOTE0_3"></a>


### Activation/Désactivation d'un filtre
<a name="activationdesactivation_filtre_ELTPARAGRAPHE000174"></a>

- La fonction [HDésactiveFiltre](../WDLang4/3044085.md) permet de désactiver un filtre.

- La fonction [HActiveFiltre](../WDLang4/3044158.md) permet ré-activer un filtre.

- Lorsque le fichier de données (la requête ou la vue) est fermé (fonctions [HFerme](../WDLang4/3044073.md) ou [HOuvreAnalyse](../WDLang4/3044106.md) par exemple), le filtre est supprimé.

- A un même instant, il ne peut exister qu'un seul filtre sur un fichier de données (une requête ou une vue). Si la fonction **HFiltreContient** est utilisée plusieurs fois, seul le dernier filtre sera pris en compte : le(s) filtre(s) précédent(s) seront supprimés. De même si plusieurs filtres sont utilisés (fonctions HFiltre\*), seul le dernier filtre sera pris en compte.




<a name="XComposante"></a>

## Composante :
wd280hf.dll
