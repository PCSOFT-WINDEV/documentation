


## HCopieEnreg (Fonction)

***En anglais : HCopyRecord***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Copie : 

- le contenu de l'enregistrement en cours (chargé en mémoire) dans l'enregistrement en cours d'un fichier de données.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) le contenu d'une variable de type [Enregistrement](../WDLang4/1000020962.md) dans l'enregistrement en cours d'un fichier de données.


Le fichier de données d'origine et le fichier de données destination n'ont pas obligatoirement la même structure. Seules les données mémorisées du fichier de données destination sont modifiées. Le fichier de données destination ne sera modifié qu'à la sauvegarde de l'enregistrement en cours.



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003044261&name=hcopieenreg_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
HLitPremier(Client, Nom)
TANTQUE HEnDehors(Client) = Faux
	// Ajoute l'enregistrement dans le fichier de données Client2
	HCopieEnreg(Client2, Client, hValDéfaut)
	HAjoute(Client2)
	// Passe à l'enregistrement suivant
	HLitSuivant(Client, Nom)
FIN
```
<a name="Exemple2"></a>

```wl
// Copie des enregistrements du fichier de données Commande dans un fichier d'archive
Commande_2019 est une Source de Données

// Création du fichier d'archive
HAlias(Commande, Commande_2019)
HChangeNom(Commande_2019, "Commande_2019")
HCréation(Commande_2019)

// Archivage des commandes
POUR TOUT Commande AVEC DateCommande = "20190101" A "20191231"
	// Ajoute l'enregistrement dans le fichier d'archive
	HCopieEnreg(Commande_2019, Commande, hValDéfaut)
	HAjoute(Commande_2019)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Copier l'enregistrement en cours

`<Résultat> = HCopieEnreg(<Fichier de données destination> , <Fichier de données source> [, <Rubrique destination> [, <Rubrique source>]] [, <Options>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la copie a été effectuée,

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Fichier de données destination> : (Chaîne de caractères)`**

Nom du fichier de données destination à manipuler. Les données seront copiées vers l'enregistrement en cours de ce fichier de données.

**`<Fichier de données source> : (Chaîne de caractères)`**

Nom du fichier de données d'origine à manipuler. L'enregistrement en cours de ce fichier de données contient les informations à copier.

**`<Rubrique destination> : (Chaîne de caractères optionnelle)`**

Liste des rubriques du fichier de données destination à affecter avec les valeurs lues dans l'enregistrement en cours du fichier de données source. Les rubriques doivent être séparées soit par une virgule, soit par un retour chariot (RC). 
**Remarque** : Les clés composées ne peuvent pas être des rubriques destination. Elles seront automatiquement affectées.
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Ce paramètre n'est pas pris en compte.

**`<Rubrique source> : (Chaîne de caractères optionnelle)`**

Liste des rubriques du fichier de données source devant être copiées dans l'enregistrement en cours du fichier de données destination. Les rubriques doivent être séparées soit par une virgule, soit par un retour chariot (RC). Ces rubriques doivent être classées selon l'ordre de leur affectation dans les rubriques destination.
Les clés composées doivent être exclues de cette liste. 
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Ce paramètre n'est pas pris en compte.

**`<Options> : (Constante ou combinaison de constantes (optionnel))`**

Paramètre la copie des informations :


|   |   |
| --- | --- |
| *hCopieIDAuto* | Copie l'identifiant automatique en conservant sa valeur.<br>**Remarque** : L'utilisation de cette constante implique l'utilisation de la constante *hFixeIDAuto* dans la fonction [HAjoute](../WDLang4/3044147.md) suivante. |
| *hValDéfaut* | Les rubriques de l'enregistrement destination non affectées par la copie sont initialisées avec leur valeur par défaut (définie sous l'éditeur d'analyses). |


Si aucun paramètre n'est spécifié, l'identifiant automatique n'est pas copié et les rubriques de l'enregistrement destination non modifiées ne sont pas initialisées.
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Ce paramètre n'est pas pris en compte.


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 
### Copier l'enregistrement présent dans une variable de type Enregistrement

`<Résultat> = HCopieEnreg(<Fichier de données destination> , <Enregistrement source> [, <Rubrique destination> [, <Rubrique source>]] [, <Options>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la copie a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Fichier de données destination> : (Chaîne de caractères)`**

Nom du fichier de données destination à manipuler. Les données seront copiées vers l'enregistrement en cours de ce fichier de données.

**`<Enregistrement source> : (Variable de type Enregistrement)`**

Nom de la variable de type [Enregistrement](../WDLang4/1000020962.md) contenant les informations à copier.

**`<Rubrique destination> : (Chaîne de caractères optionnelle)`**

Liste des rubriques du fichier de données destination à affecter avec les valeurs lues dans l'enregistrement en cours du fichier de données source. Les rubriques doivent être séparées soit par une virgule, soit par un retour chariot (RC). 
**Remarque** : Les clés composées ne peuvent pas être des rubriques destination. Elles seront automatiquement affectées. 
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Ce paramètre n'est pas pris en compte.

**`<Rubrique source> : (Chaîne de caractères optionnelle)`**

Liste des rubriques du fichier de données source devant être copiées dans l'enregistrement en cours du fichier de données destination. Les rubriques doivent être séparées soit par une virgule, soit par un retour chariot (RC). Ces rubriques doivent être classées selon l'ordre de leur affectation dans les rubriques destination.
Les clés composées doivent être exclues de cette liste. 
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Ce paramètre n'est pas pris en compte.

**`<Options> : (Constante ou combinaison de constantes (optionnel))`**

Paramètre la copie des informations :


|   |   |
| --- | --- |
| *hCopieIDAuto* | Copie l'identifiant automatique en conservant sa valeur.<br>**Remarque** : L'utilisation de cette constante implique l'utilisation de la constante *hFixeIDAuto* dans la fonction [HAjoute](../WDLang4/3044147.md) suivante. |
| *hValDéfaut* | Les rubriques de l'enregistrement destination non affectées par la copie sont initialisées avec leur valeur par défaut (définie sous l'éditeur d'analyses). |


Si aucun paramètre n'est spécifié, l'identifiant automatique n'est pas copié et les rubriques de l'enregistrement destination non modifiées ne sont pas initialisées.
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Ce paramètre n'est pas pris en compte.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Les valeurs copiées
<a name="les_valeurs_copiees_ELTPARAGRAPHE000232"></a>Les rubriques dont le nom est commun aux deux enregistrements sont copiées (et converties si nécessaire).

Les rubriques de l'enregistrement source n'existant pas dans l'enregistrement destination ne sont pas copiées.

Les rubriques de l'enregistrement destination n'existant pas dans l'enregistrement source ne sont pas modifiées (sauf si la constante *hValDéfaut* est spécifié).

Lors de la copie d'une rubrique ayant pour valeur NULL, si le fichier de données destination ne supporte pas la valeur NULL, la rubrique copiée est simplement initialisée à vide (chaîne vide ("") pour les chaînes, et 0 pour les numériques).


**Remarque** : Lorsque les affectations se font entre rubriques de types différents, les conversions de type sont conformes à celles du WLangage.
<a name="NOTE0_2"></a>


### Utilisation des listes de rubriques
<a name="utilisation_des_listes_rubriques_ELTPARAGRAPHE000249"></a>La spécification de deux listes de rubriques permet d'affecter des rubriques de noms différents. Les affectations sont effectuées dans l'ordre d'apparition des rubriques dans les listes.

Si aucune des deux listes de rubriques n'est fournie, seules les rubriques dont le nom est commun aux deux enregistrements sont copiées.

Si seule la liste de rubriques cible (&lt;Rubrique destination&gt;) est fournie, seules les rubriques spécifiées seront copiées.
<a name="NOTE0_3"></a>




### Rubriques Tableau
<a name="rubriques_tableau_ELTPARAGRAPHE000263"></a>Lors de la manipulation de rubriques tableaux, la fonction **HCopieEnreg** copie le maximum d'éléments en commençant par le premier élément.

Si le tableau de l'enregistrement "source" contient plus d'éléments que le tableau de l'enregistrement "cible", les éléments supplémentaires de l'enregistrement "source" ne sont pas copiés.

Si le tableau de l'enregistrement "source" contient moins d'éléments que le tableau de l'enregistrement "cible", les éléments supplémentaires de l'enregistrement "cible" ne sont pas modifiés, sauf si la constante *hValDefaut* est spécifiée.


<a name="NOTE0_4"></a>


### Erreurs n'entraînant pas de modification de l'enregistrement destination
<a name="erreurs_nentrainant_pas_modification_enregistrement_destination_ELTPARAGRAPHE000283"></a>Les erreurs n'entraînant pas de modification de l'enregistrement destination sont les suivantes :

- aucune liste n'est fournie et aucun nom de rubrique n'est commun aux deux fichiers de données.

- la liste des rubriques d'un fichier de données contient un nom de rubrique inexistant dans ce fichier de données.

- la liste des rubriques cible contient un nom de rubrique de type "clé composée".

- la liste des rubriques cible contient un nom de rubrique de type "identifiant automatique" alors que la constante *hCopieIDAuto* n'est pas précisée.

- deux listes de tailles différentes sont fournies.



<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Versions précédentes
<a name="versions_precedentes_ELTPARAGRAPHE000298"></a>Cette fonction remplace la fonction **HCopieEnreg_55**, conservée par compatibilité avec WINDEV 5.5.



<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
