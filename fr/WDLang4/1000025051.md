


## &lt;Source&gt;.Raye (Fonction)

***En anglais : &lt;Source&gt;.Cross***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Raye un enregistrement d'un fichier de données. L'enregistrement est supprimé logiquement et pourra éventuellement être récupéré.

Les opérations effectuées sont les suivantes :

- l'enregistrement est rendu inactif. Les données sont conservées (ce qui n'est pas le cas lors de la suppression d'un enregistrement avec la fonction [&lt;Source&gt;.Supprime](../WDLang4/1000025071.md)).

- les index (correspondant aux clés de l'enregistrement) sont supprimés du fichier d'index.

- les mémos associés à l'enregistrement sont conservés.




Cette fonction peut être utilisée indifféremment avec les fichiers de données, les vues HFSQL Mobile ou les requêtes.


<a name="sample_code"></a>

## Exemple

<a name="Exemple1"></a>

```wl
// Raye l'enregistrement numéro 123
Client.Raye(123)
```
<a name="Exemple2"></a>

```wl
// Suppression (rayure) des commandes d'un client
Commande.LitRecherchePremier(NUMCLI, ValNumCli)
TANTQUE Commande.Trouve() = Vrai
	Commande.Raye()
	Commande.LitSuivant()
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Source>.Raye([<Numéro d'enregistrement> [, <Options>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'enregistrement a été rayé, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur (enregistrement bloqué, problème d'intégrité, ...). La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'obtenir plus de détails.




**`<Source> : (Type correspondant à la source spécifiée)`**

Nom du fichier de données HFSQL, de la requête ou de la vue manipulé. 

**`<Numéro d'enregistrement> : (Entier optionnel)`**

Numéro de l'enregistrement à rayer. 
Si ce paramètre n'est pas précisé (est égal à 0 ou à la constante *hNumEnrEnCours*), l'enregistrement en cours sera rayé.

**`<Options> : (Constante optionnelle)`**

Paramètre :

- le blocage de l'enregistrement rayé. Si aucune constante de blocage n'est spécifiée, l'enregistrement rayé n'est pas bloqué.
	


|   |   |
| --- | --- |
| *hBlocageEcriture* | Blocage en écriture : l'enregistrement rayé en cours pourra être lu et consulté (fonction [&lt;Source&gt;.Lit](../WDLang4/1000025019.md)) par une autre application mais ne pourra pas être ré-activé par une autre application. Seule l'application en cours pourra le ré-activer. |
| *hBlocageLectureEcriture* | Blocage en lecture/écriture : l'enregistrement rayé en cours ne pourra ni être consulté ni être ré-activé par une autre application. |
| *hBlocageNon*<br>(valeur par défaut) | Aucun blocage : l'enregistrement rayé ne sera pas bloqué. |



- la gestion de l'intégrité sur l'enregistrement rayé.
	


|   |   |
| --- | --- |
| *hIgnoreIntégrité* | Ignore le contrôle d'intégrité sur cette opération, même si le contrôle de l'intégrité automatique est branché (fonction [&lt;Variable Connexion&gt;.GèreIntégrité](../WDLang4/1000023960.md)). |
| *hVérifieIntégrité* | Contrôle l'intégrité de l'opération, même si le contrôle de l'intégrité automatique est débranché (fonction [&lt;Variable Connexion&gt;.GèreIntégrité](../WDLang4/1000023960.md)). |


	Si les deux constantes sont utilisées en même temps, une erreur WLangage est générée. Ces constantes n'ont pas d'effet sur la suppression en cascade.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Manipulations d'un enregistrement rayé
<a name="manipulations_enregistrement_raye_ELTPARAGRAPHE000331"></a>

- Un enregistrement rayé ne sera lu :

	- ni par les fonctions de parcours : [&lt;Source&gt;.Premier](../WDLang4/1000025048.md), [&lt;Source&gt;.Dernier](../WDLang4/1000024217.md), [&lt;Source&gt;.Suivant](../WDLang4/1000025070.md), [&lt;Source&gt;.Précédent](../WDLang4/1000025047.md), [&lt;Source&gt;.LitPremier](../WDLang4/1000025022.md), [&lt;Source&gt;.LitDernier](../WDLang4/1000025020.md), [&lt;Source&gt;.LitSuivant](../WDLang4/1000025035.md), [&lt;Source&gt;.LitPrécédent](../WDLang4/1000025021.md), [&lt;Source&gt;.Avance](../WDLang4/1000024195.md), [&lt;Source&gt;.Recule](../WDLang4/1000025056.md)

	- ni par les fonctions de recherche : [&lt;Source&gt;.RecherchePremier](../WDLang4/1000025055.md), [&lt;Source&gt;.LitRecherchePremier](../WDLang4/1000025034.md), [&lt;Source&gt;.RechercheDernier](../WDLang4/1000025054.md), [&lt;Source&gt;.LitRechercheDernier](../WDLang4/1000025024.md).




- Un enregistrement rayé pourra être consulté grâce à la fonction [&lt;Source&gt;.Lit](../WDLang4/1000025019.md).

- Un enregistrement rayé pourra être réactivé grâce aux fonctions [&lt;Source&gt;.Modifie](../WDLang4/1000025038.md) ou [&lt;Source&gt;.Ecrit](../WDLang4/1000024331.md).

- La fonction [&lt;Source&gt;.Etat](../WDLang4/1000024943.md) permet de connaître l'état d'un enregistrement (actif, rayé, supprimé, ...).

- L'emplacement physique d'un enregistrement rayé ne sera réutilisable (par la fonction [&lt;Source&gt;.Ajoute](../WDLang4/1000024187.md) par exemple) qu'après :

	- soit l'exécution de la fonction [&lt;Source&gt;.SupprimeToutRayé](../WDLang4/1000025010.md),

	- soit une réindexation (avec compactage).






<a name="NOTE0_2"></a>


### Nombre d'enregistrements rayés
<a name="nombre_enregistrements_rayes_ELTPARAGRAPHE000450"></a>La fonction [&lt;Source&gt;.NbEnr](../WDLang4/1000025040.md) permet de connaître le nombre d'enregistrements rayés dans le fichier de données.

Remarque : Par compatibilité avec WEBDEV 1.5/WINDEV 5.5, il est aussi possible de connaître le nombre d'enregistrements rayés grâce à la variable *h.NbSup*.
<a name="NOTE0_3"></a>


### Version du fichier de données
<a name="version_fichier_donnees_ELTPARAGRAPHE000467"></a>En cas de succès de la fonction **&lt;Source&gt;.Raye**, le numéro de version du fichier de données est modifié. Ce numéro de version est donné par la fonction [&lt;Source&gt;.Version](../WDLang4/1000025082.md).
<a name="NOTE0_4"></a>


### Rayer un enregistrement à partir d'une requête
<a name="rayer_enregistrement_partir_une_requete_ELTPARAGRAPHE000485"></a>Il est possible de rayer un enregistrement :

- soit uniquement dans le résultat de la requête.

- soit directement dans les fichiers manipulés par la requête (constante *HModifieFichier*utilisée dans les fonctions [&lt;Source&gt;.ExécuteRequête](../WDLang4/1000024944.md) ou [&lt;Source&gt;.ExécuteRequêteSQL](../WDLang4/1000024948.md)). Dans ce cas, la constante *hAvecFiltre*est automatiquement sélectionnée.




Quel que soit le mode d'exécution de la requête (avec ou sans la constante *hAvecFiltre*), la fonction **&lt;Source&gt;.Raye** n'est utilisable que sur les requêtes mono-fichier.

Attention : 

- Il est impossible de rayer un enregistrement dans une requête utilisant les groupes ou les agrégats.

- La gestion de l'intégrité et des doublons n'est pas réalisée lors d'opérations sur les requêtes multi-fichiers : il est conseillé d'utiliser les transactions pour éviter tout problème.



<a name="NOTE0_5"></a>


### Cas particuliers
<a name="cas_particuliers_ELTPARAGRAPHE000518"></a>

- **Gestion des blocages** : 
	Si un problème de blocage apparaît lors de la "rayure" d'un enregistrement (tentative de rayure d'un enregistrement bloqué en écriture par exemple), l'enregistrement n'est pas modifié et la fonction [HErreurBlocage](../WDLang4/3044099.md) renvoie <u><u><u><u>Vrai</u></u></u></u>.

- **Gestion de l'intégrité référentielle**
	Si la gestion de l'intégrité référentielle est active (fonction [&lt;Variable Connexion&gt;.GèreIntégrité](../WDLang4/1000023960.md)), et si l'intégrité n'est pas vérifiée lors de la suppression, la fonction **&lt;Source&gt;.Raye** n'est pas exécutée. Il est nécessaire de tester la fonction [HErreurIntégrité](../WDLang4/3044086.md) après la fonction **&lt;Source&gt;.Raye**.

- **Enregistrements supprimés**
	La fonction **&lt;Source&gt;.Raye** ne doit pas être appelée sur un enregistrement précédemment supprimé.



<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Fichiers xBase
<a name="fichiers_xbase_ELTPARAGRAPHE000562"></a>La fonction [&lt;Source&gt;.Supprime](../WDLang4/1000025071.md) a le même effet que la fonction **&lt;Source&gt;.Raye** : l'enregistrement est rayé et non supprimé. L'enregistrement peut donc être réactivé par la fonction [&lt;Source&gt;.Modifie](../WDLang4/1000025038.md). Dans ce cas, la fonction [&lt;Source&gt;.Etat](../WDLang4/1000024943.md) renvoie la constante *hEtatRaye* sur un enregistrement supprimé (et non la constante *hEtatSup*).

<a name="XComposante"></a>

## Composante :
wd280hf.dll
