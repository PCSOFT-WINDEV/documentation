 



## Structure HTâchePlanifiée

***En anglais : HScheduledTask structure***
	



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
|  | **La structure *HTâchePlanifiée* est conservée uniquement pour compatibilité** (cette structure sera encore supportée dans la prochaine version).<br><br>A partir la version 14, la **structure HTâchePlanifiée** a été remplacée par le **type hTâchePlanifiée**. Il suffit de déclarer une variable de [type hTâchePlanifiée](../WDLang4/1000017448.md) pour manipuler les tâches planifiée.<br><br>Pour plus de détails, consultez la page d'aide concernant [le type hTâchePlanifiée](../WDLang4/1000017448.md).  <br><br>**Voici la documentation de la structure HTâchePlanifiée disponible avec WINDEV, WEBDEV et WINDEV Mobile 14.** |
| --- | --- |

|  
 | PrésentationLa structure **HTâchePlanifiée** permet de gérer la planification des tâches sur le serveur. Cette structure permet de décrire les caractéristiques de répétition de la tâche.<br><br>Lorsque la tâche planifiée est décrite à l'aide de la structure, la fonction [HAjouteTâche](../WDLang4/1000017091.md) permet d'ajouter la tâche sur le serveur HFSQL en liant la structure **HTâchePlanifiée** et la procédure à exécuter.Détail de la structure HTâchePlanifiéeLes variables suivantes permettent de gérer les tâches planifiées sur le serveur :<br><br><br>\   \   \<br>\ --- \ --- \<br>\ HTâchePlanifiée.Description \ Chaîne de caractères.<br><br>Description de la tâche \<br>\ HTâchePlanifiée.Heure \ Chaîne de caractères.<br>Heure à laquelle la tâche planifiée doit être exécutée (par exemple "13"). Ce nombre est compris entre 0 et 23. <br>Ce paramètre peut également correspondre à :<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs heures.<br><br>- un intervalle. Par exemple "9-13" (la tâche est planifiée pour 9 heures, 10, 11, 12, et 13 heures).<br><br>- une étoile "*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "*/2" pour lancer la tâche à toutes les heures paires.<br><br><br> \<br>\ HTâchePlanifiée.JourDeLaSemaine \ Chaîne de caractères.<br>Numéro du jour de la semaine pour lequel la tâche planifiée doit être exécutée (par exemple "2"). Ce nombre est compris entre 1 et 7 (1 = Lundi, 2 = Mardi, ...).<br><br>Ce paramètre peut également correspondre à :<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs jours.<br><br>- un intervalle. Par exemple "1-3" (la tâche est planifiée pour Lundi, Mardi et Mercredi).<br><br>- une étoile "*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "*/2" pour lancer la tâche à tous les jours de la semaine pairs.<br><br>- le jour de la semaine en toutes lettres ("lundi", "mardi", "mercredi", "jeudi", "vendredi").<br><br><br> \<br>\ HTâchePlanifiée.JourDuMois \ Chaîne de caractères.<br>Numéro du jour du mois pour lequel la tâche planifiée doit être exécutée (par exemple "31"). Ce nombre est compris entre 0 et 31.<br><br>Ce paramètre peut également correspondre à :<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs jours.<br><br>- un intervalle. Par exemple "9-13" (la tâche est planifiée du 9 au 13 du mois).<br><br>- une étoile "*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "*/2" pour lancer la tâche à tous les jours du mois pairs.<br><br><br> \<br>\ HTâchePlanifiée.JourDuMoisOuDeLaSemaine \ Booléen<br><br>Permet de gérer les cas suivants : exécution tous les lundis 1er jour du mois. <br><br><br>- Vrai permet l'exécution tous les lundis ET le premier jour du mois (conditions cumulées).<br><br>- Faux permet l'exécution uniquement les lundis 1er (conditions exclusives).<br><br><br> \<br>\ HTâchePlanifiée.Minute \ Chaîne de caractères.<br>Minutes de l'heure à laquelle la tâche planifiée doit être exécutée (par exemple "13"). Ce nombre est compris entre 0 et 59.<br><br>Ce paramètre peut également correspondre à :<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs minutes.<br><br>- un intervalle.<br><br>- une étoile "*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "*/2" pour lancer la tâche à toutes les minutes paires.<br><br><br> \<br>\ HTâchePlanifiée.Mois \ Chaîne de caractères.<br>Numéro du mois pour lequel la tâche planifiée doit être exécutée (par exemple "11"). Ce nombre est compris entre 1 et 12.<br><br>Ce paramètre peut également correspondre à :<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs mois.<br><br>- un intervalle. Par exemple "9-12" (la tâche est planifiée pour tous les mois du dernier trimestre).<br><br>- une étoile "*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "*/2" pour lancer la tâche  tous les mois pairs.<br><br><br> \<br>\ HTâchePlanifiée.NombreExécution \ Chaîne de caractères.<br>Nombre de fois où la tâche doit être exécutée. <br>Ce paramètre peut également correspondre à :<br><br>- La constante *Infini*.<br><br><br> \<br><br>La tâche sera déclenchée si le numéro du mois, les heures et les minutes correspondent aux informations définies dans la structure et qu'au moins l'un des JourDuMois et JourDeLaSemaine correspondent avec le jour en cours.Exemples
```wl
// Tous les lundis à 13h45
HTâchePlanifiée.JourDuMois = "*"
HTâchePlanifiée.JourDeLaSemaine = "1"
HTâchePlanifiée.Mois = "*"
HTâchePlanifiée.Heure = "13"
HTâchePlanifiée.Minute = "45"
HTâchePlanifiée.NombreExécution = Infini
```
<br><br>
```wl
// Toutes les heures, 10 minutes après l'heure
HTâchePlanifiée.JourDuMois = "*"
HTâchePlanifiée.JourDeLaSemaine = "*"
HTâchePlanifiée.Mois = "*"
HTâchePlanifiée.Heure = "*"
HTâchePlanifiée.Minute = "10"
HTâchePlanifiée.NombreExécution = Infini
```
<br><br>
```wl
// Tous les 31 décembre à 23h50
HTâchePlanifiée.JourDuMois = "31"
HTâchePlanifiée.JourDeLaSemaine = "0"
HTâchePlanifiée.Mois = "12"
HTâchePlanifiée.Heure = "23"
HTâchePlanifiée.Minute = "50"
HTâchePlanifiée.NombreExécution = Infini
```
 |
| --- | --- |


