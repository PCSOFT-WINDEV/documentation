
## Description de Fichier (Type de variable)

***En anglais : File Description (Type of variable)***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Une variable de type **Description de Fichier** permet de décrire par programmation un ou plusieurs fichiers de données. La description de chaque fichier de données est validée par la fonction [HDécritFichier](../WDLang4/3044206.md).

Après cette validation :

- Ce fichier de données pourra être manipulé comme n'importe quel fichier de données décrit dans l'analyse.

- La variable de type "Description de Fichier" est réinitialisée et pourra être utilisée pour décrire par programmation un autre fichier de données.









<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
UnFichier est une Description de Fichier
MonFichier1, MonFichier2 sont des Descriptions de Fichier
```


<a name="Exemple2"></a>



```wl
// Description du fichier de données "CLIENT"
UnFichier est une Description de Fichier

UnFichier.Nom = "CLIENT"
UnFichier.Type = hFichierNormal
UnFichier.CryptageFic = hCryptageStandard

// Description des rubriques du fichier de données
...

// Validation de la description du fichier de données "CLIENT"
HDécritFichier(UnFichier)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Déclarer une ou plusieurs descriptions de fichier de données

`<Nom de la variable> est une Description de Fichier
<Nom de la variable 1>, <Nom de la variable 2> sont des Descriptions de Fichier
`
---

**`<Nom de la variable> : ()`**

Nom de la variable de type "Description de Fichier" à déclarer.

Remarque : Les mots-clés <u><u><u><u>une</u></u></u></u> et <u><u><u><u>des</u></u></u></u> ne sont pas obligatoires : ce sont des mots d'agrément.  


<a name="SYNTAXE2"></a>

### Décrire une variable de type "Description de Fichier"

``
---

**Pour décrire une variable de type "Description de Fichier"** : 

Utilisez les propriétés du WLangage spécifiques aux descriptions de fichiers de données. Pour plus de détails, consultez [les remarques](#NOTE0_1).

**Pour valider la description d'une variable de type "Description de Fichier"** : 

Utilisez la fonction [HDécritFichier](../WDLang4/3044206.md).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Propriétés spécifiques à la description de fichiers de données
<a name="proprietes_specifiques_description_fichiers_donnees_ELTPARAGRAPHE000098"></a>Les propriétés spécifiques à la description de fichiers de données sont détaillées dans le tableau suivant :

Remarque : Les propriétés en gras suivies d'un astérisque ( \* ) doivent obligatoirement être initialisées lors de la description d'un fichier de données par programmation.

| Nom de la propriété | Effet |
| --- | --- |
| [CompressionMmo](../Proprietes/2512028.md) | Mode de compression du fichier MMO (contenant les mémo binaires et texte) associé au fichier de données |
| [CryptageFic](../Proprietes/2512046.md) | Mode de cryptage du fichier de données |
| [CryptageMmo](../Proprietes/2512014.md) | Mode de cryptage du fichier mémo (d'extension .MMO) associé au fichier de données |
| [CryptageNdx](../Proprietes/2512010.md) | Mode de cryptage du fichier d'index associé au fichier de données |
| [CxAccès](../Proprietes/2512015.md) | Type d'accès au fichier lors de la connexion OLE DB à une table spécifique (en tenant compte des modifications effectuées par la fonction [HConnecte](../WDLang4/3044263.md)) |
| [CxAccèsDécrit](../Proprietes/2512048.md) | Type d'accès au fichier lors de la connexion OLE DB à une table spécifique (sans tenir compte des modifications effectuées par la fonction [HConnecte](../WDLang4/3044263.md)) |
| [CxBaseDeDonnées](../Proprietes/2512047.md) | Source de données OLE DB lors de la connexion OLE DB à une table spécifique (en tenant compte des modifications effectuées par la fonction [HConnecte](../WDLang4/3044263.md)) |
| [CxBaseDeDonnéesDécrite](../Proprietes/2512016.md) | Source de données OLE DB lors de la connexion OLE DB à une table spécifique (sans tenir compte des modifications effectuées par la fonction [HConnecte](../WDLang4/3044263.md)) |
| [CxLibelléDécrit](../Proprietes/2512021.md) | Libellé de la connexion à la source de données OLE DB |
| [CxMotDePasseDécrit](../Proprietes/2512012.md) | Mot de passe utilisé pour ouvrir le fichier lors d'une connexion OLE DB |
| [CxProviderOLEDB](../Proprietes/2512033.md) | Nom du serveur OLE DB utilisé (en tenant compte des modifications effectuées par la fonction [HConnecte](../WDLang4/3044263.md)). |
| [CxProviderOLEDBDécrit](../Proprietes/2512025.md) | Nom du serveur OLE DB (sans tenir compte des modifications effectuées par la fonction [HConnecte](../WDLang4/3044263.md)). |
| [CxUtilisateur](../Proprietes/2512026.md) | Nom de l'utilisateur lors d'une connexion OLE DB (en tenant compte des modifications effectuées par la fonction [HConnecte](../WDLang4/3044263.md)). |
| [CxUtilisateurDécrit](../Proprietes/2512022.md) | Nom de l'utilisateur lors d'une connexion OLE DB (sans tenir compte des modifications effectuées par la fonction [HConnecte](../WDLang4/3044263.md)). |
| [Format](../Proprietes/2512045.md) | Format des données du fichier de données (ANSI ou Unicode). |
| [GrosFichier](../Proprietes/2512037.md) | Taille maximale d'un fichier de données. |
| [Inaltérable](../Proprietes/1000023376.md) | Mode de gestion de l'inaltérabilité du fichier de données. |
| [Journalisation](../Proprietes/2512044.md) | Mode de journalisation d'un fichier de données. |
| [MotDePasseWDD55](../Proprietes/2512049.md) | Mot de passe à utiliser pour manipuler un fichier définit par programmation au format Hyper File 5.5 dans une analyse au format WINDEV. |
| [Nom](../Proprietes/2510082.md) ( \* ) | Nom du fichier HFSQL. |
| [Nom55](../Proprietes/2512054.md) | Nom logique du fichier au format Hyper File 5.5 présent dans une analyse au format WINDEV. |
| [NomDécrit](../Proprietes/2512066.md) | Nom logique d'un fichier de données. |
| [NomPhysique](../Proprietes/2512059.md) | Nom physique des fichiers de données. |
| [NomPhysiqueDécrit](../Proprietes/2512063.md) | Nom physique des fichiers HFSQL (sans tenir compte des changements de nom réalisés grâce à la fonction [HChangeNom](../WDLang4/3044141.md)). |
| [NullIndexé](../Proprietes/1410088758.md) | Mode de gestion de la valeur "Null" pour une rubrique clé. |
| [NullSupporté](../Proprietes/2512061.md) | Mode de gestion de la valeur NULL. |
| [RepeatableReadSupporté](../Proprietes/1000020959.md) | Utilisation du fichier dans une transaction HFSQL Client/Serveur ayant un mode d'isolation "Repeatable Read". |
| [Répertoire](../Proprietes/2512078.md) | Répertoire physique des fichiers HFSQL (cette propriété tient compte des changements de répertoires réalisés grâce aux fonctions [HChangeRep](../WDLang4/3044168.md) ou [HSubstRep](../WDLang4/3044028.md)). |
| [RépertoireDécrit](../Proprietes/2512074.md) | Répertoire physique des fichiers HFSQL (cette propriété ne tient pas compte des changements de répertoires réalisés grâce aux fonctions [HChangeRep](../WDLang4/3044168.md) ou [HSubstRep](../WDLang4/3044028.md)). |
| [RépertoireJournal](../Proprietes/2512075.md) | Répertoire du fichier journal décrit dans l'analyse. |
| [RubriqueTexteComplétée](../Proprietes/2512080.md) | Complète ou non les rubriques texte par des espaces. |
| [Sécurisé](../Proprietes/2512082.md) | Niveau de sécurité du cryptage des fichiers de données. |
| [Type](../Proprietes/2510131.md) | Type d'un fichier de données. |
| [WDD55](../Proprietes/2512094.md) | Chemin du fichier WDD au format 5.5 utilisé pour manipuler des fichiers de données au format 5.5 dans une application WINDEV. |




<a name="NOTE0_2"></a>




### Comment décrire des fichiers de données par programmation ? 
<a name="comment_decrire_des_fichiers_donnees_par_programmation_ELTPARAGRAPHE000330"></a>Pour décrire des fichiers de données par programmation, il faut :

1. Déclarer des variables de type "**Description de Fichier**", "[Description de Rubrique](../WDLang4/1514071.md)", "[Description d'IndexFullText](../WDLang4/1000017461.md)" et "[Description de Liaison](../WDLang4/1514039.md)" (si nécessaire).

2. Pour chaque fichier de données :

	- Décrire les caractéristiques du fichier de données grâce aux [propriétés HFSQL](../Proprietes/2512070.md).

	- Décrire les caractéristiques des rubriques grâce aux [propriétés HFSQL](../Proprietes/2512070.md).

	- Valider la description de chaque rubrique (fonction [HDécritRubrique](../WDLang4/3044233.md)).

	- Décrire si nécessaire les caractéristiques des index full-text grâce aux [propriétés HFSQL](../Proprietes/2512070.md).

	- Valider la description de chaque index full-text (fonction [HDécritIndexFullText](../WDLang4/1000017407.md)).

	- Valider la description du fichier de données (fonction [HDécritFichier](../WDLang4/3044206.md)).




3. Décrire si nécessaire les caractéristiques des liaisons grâce aux [propriétés HFSQL](../Proprietes/2512070.md).

4. Valider si nécessaire la description de chaque liaison (fonction [HDécritLiaison](../WDLang4/3044191.md)).





<a name="NOTE0_3"></a>




### Manipulation des rubriques d'un fichier de données décrit par programmation
<a name="manipulation_des_rubriques_fichier_donnees_decrit_par_programmation_ELTPARAGRAPHE000384"></a>Lors de la création d'un fichier de données sous l'éditeur d'analyses, les noms du fichier de données et de ses rubriques sont automatiquement reconnus par le compilateur.

Lors de la création d'un fichier de données à l'aide d'une variable de type "Description de Fichier", les noms du fichier de données et de ses rubriques sont définis grâce à la propriété [Nom](../Proprietes/2510082.md). Ces noms ne sont pas automatiquement reconnus par le compilateur. L'utilisation de ces noms pour désigner le fichier de données ou ses rubriques provoque une erreur de compilation.

Pour que le nom du fichier de données décrit par programmation soit reconnu par le compilateur, il est nécessaire de déclarer ce nom de fichier comme une source de données grâce au mot-clé [source de données](../WDLang4/1514053.md). Ce fichier de données pourra alors être manipulé par son nom sous l'éditeur de code.

Par exemple :


```wl
UnFichier est une Description de Fichier
...
UnFichier.Nom = "CLIENT"
...
HDécritFichier("CLIENT")
...
CLIENT est une Source de Données
...
HLitPremier(CLIENT, "NOMCLI")
```


**Remarque** : Il est également possible de déclarer le nom du fichier de données avec le mot-clé [Externe](../Motscles/1511013.md). Cependant, la vitesse d'exécution du traitement sera ralentie.


<a name="NOTE0_4"></a>




### Journalisation
<a name="journalisation_ELTPARAGRAPHE000412"></a>Lors de la description du fichier de données par programmation :

- si le fichier de données est journalé et si aucune rubrique n'est journalée, toutes les rubriques (sauf les clés composées) sont automatiquement passées en journalées.

- si le fichier de données est journalé et si au moins une rubrique est journalée, les autres rubriques ne sont pas modifiées.







