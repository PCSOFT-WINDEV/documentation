


## HCréeVue (Fonction)

***En anglais : HCreateView***




	<B><B>Avertissement</B></B>

	A partir de la version <B><B>20</B></B>,  les vues SQL et les vues matérialisées sont disponibles.
Les vues manipulées par cette fonction correspondent à l'ancien mécanisme des vues. Elles ne correspondent ni aux vues SQL ni aux vues matérialisées. 

<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Crée une vue HFSQL.

**Remarque** : Pour fusionner plusieurs vues, utilisez la fonction [HFusionneVue](../WDLang4/3044124.md).

**Rappel** : Une vue HFSQL correspond à une "image mémoire" de tout ou partie d'un fichier de données. Une vue est stockée en mémoire, ce qui la rend insensible aux modifications effectuées sur le fichier de données associé. Une fois créée, une vue se manipule comme un fichier de données HFSQL.

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003044159&name=hcreevue_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Création d'une vue
MaVue est une Source de Données
HCréeVue(MaVue, CLIENT, "*", "NOM,VILLE","NOM]='A'", hVueDéfaut)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Créer une vue sur un fichier de données (fichier de données décrit dans l'analyse ou créé par programmation)

`<Résultat> = HCréeVue(<Vue à créer> , <Fichier de données> [, <Rubriques> [, <Rubriques de tri> [, <Condition de sélection>]]] [, <Mode de création> [, <Taille d'une page>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la vue a été créée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Vue à créer> : (Source de données (ou chaîne de caractères))`**

Vue à créer. L'utilisation d'une variable de type source de données permet d'optimiser les temps d'accès aux rubriques de la vue.

**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données manipulé. Ce fichier de données peut correspondre à un fichier de données décrit dans l'analyse ou décrit par programmation (fonction [HDécritFichier](../WDLang4/3044206.md)). Il est également possible d'utiliser une [source de données](../WDLang4/1514053.md).

**`<Rubriques> : (Chaîne de caractères optionnelle)`**

Liste des rubriques prises en compte dans la vue. Dans cette liste, les différentes rubriques sont séparées soit par des virgules, soit par des retour chariot (RC). 
Si ce paramètre n'est pas précisé ou correspond à la valeur "\*", toutes les rubriques du fichier de données seront intégrées dans la vue.

**`<Rubriques de tri> : (Chaîne de caractères optionnelle)`**

Liste des rubriques de tri initial de la vue. Dans cette liste, les différentes rubriques de tri sont séparées soit par des virgules, soit par des retour chariot (RC). Le tri est appliqué selon l'ordre des rubriques dans la liste. 
Le sens de tri peut être indiqué pour chaque rubrique : 

- un signe "+" devant le nom de la rubrique indique un sens de tri croissant. 

- un signe "-" devant le nom de la rubrique indique un sens de tri décroissant. 




Si ce paramètre n'est pas spécifié ou correspond à une chaîne vide (""), aucun tri particulier n'est réalisé dans la vue.
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Une seule rubrique de tri doit être spécifiée dans le paramètre &lt;Rubriques de tri&gt;.

**`<Condition de sélection> : (Chaîne de caractères optionnelle)`**

Condition de sélection des enregistrements. Toutes les rubriques du fichier de données peuvent faire partie de la condition (rubriques clé ou non clé). 
Si ce paramètre n'est pas précisé ou correspond à une chaîne vide, aucune condition de sélection n'est appliquée. Cette condition de sélection peut être une chaîne de caractères au format Ansi ou Unicode.

**`<Mode de création> : (Constante optionnelle ou combinaison de constantes de type Entier (optionnel))`**

Paramètre le mode de création de la vue.


|   |   |
| --- | --- |
| *hVueAjoute* | Conserve le contenu de la vue lors du prochain appel à la fonction [HExécuteVue](../WDLang4/3044079.md). |
| *hVueBlocage* | Les enregistrements lus dans le fichier de données et intégrés à la vue sont bloqués.<br> |
| *hVueDéfaut* | Mode de création de vue par défaut |
| *hVueDifférée* | La vue est créée, mais sera exécutée en différé avec la fonction [HExécuteVue](../WDLang4/3044079.md). Les données de la vue seront celles correspondant au moment de l'exécution de la vue. |
| *hVueDistincte* | La vue est créée avec élimination des doublons par rapport à la clé de tri (la ou les rubriques de tri doivent alors **obligatoirement** être précisées).<br>Si plusieurs rubriques sont spécifiées, l'élimination des doublons est faite selon la composition des rubriques de tri spécifiées.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Si la constante *hVueDistincte* est précisée, il n'est pas nécessaire de spécifier une rubrique de tri dans le paramètre &lt;Rubriques de tri&gt;. Dans ce cas, la constante *hVueDistincte* est ignorée. |
| *hVueExclusive* | Optimise le temps de création de la vue en bloquant directement tout le fichier source. |
| *hVueInterruptible* | La création de la vue est interruptible au moyen de la touche ECHAP.<br>![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Cette constante n'est pas disponible. |



**`<Taille d'une page> : (Entier optionnel)`**

Nombre d'enregistrements par page (pour une vue utilisée par accès distant).
![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Ce paramètre n'est pas pris en compte.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Condition de sélection
<a name="condition_selection_ELTPARAGRAPHE000186"></a>La syntaxe générale d'une condition a la forme suivante :

"NomCli&gt;'Dupont' et CodePos=34 ou CodePos=32"

Les opérateurs acceptés sont variables en fonction du type des rubriques utilisées dans la condition :


|   |   |   |
| --- | --- | --- |
| &lt;&gt; | Différent | Valable pour tous les types |
| &gt; | Plus grand | Valable pour tous les types |
| &gt;= | Plus grand ou égal | Valable pour tous les types |
| &lt; | Plus petit | Valable pour tous les types |
| &lt;= | Plus petit ou égal | Valable pour tous les types |
| = | Strictement égal | Valable pour tous les types |
| ~= | Environ égal : ne tient pas compte des espaces à droite, ni des accents, ni de la casse des caractères | Valable pour les types chaîne uniquement |
| ~~ | Egalité très souple : ne différencie pas les caractères majuscules des caractères minuscules, ne tient pas compte des espaces situés avant et après la chaîne à tester, ne tient pas compte des caractères accentués minuscules, ne tient pas compte des espaces et des ponctuations à l'intérieur des chaînes. | Valable pour les types chaîne uniquement |
| ] | Contient : prend en compte de la casse des caractères | Valable pour les types chaîne uniquement |
| ~] | Contient : ne prend pas en compte de la casse des caractères | Valable pour les types chaîne uniquement |
| ]= | Commence par : prend en compte de la casse des caractères | Valable pour les types chaîne uniquement |


**Remarques sur la condition de sélection :**

- Les chaînes constantes doivent être encadrées de simples quotes.

- Le nom de la rubrique ne doit comporter que des lettres, des chiffres et des caractères soulignés ("_"). Si le nom de la rubrique contient d'autres caractères (apostrophe, ...), le nom de la rubrique doit être entouré de doubles quotes. 
	Par exemple : "e_mail@"]'fr'

- Les comparaisons entre chaînes se font en fonction de la valeur ASCII des caractères et non pas d'une façon lexicographique ('a' &gt; 'Z').

- Les mémos binaires et les clés composées ne peuvent pas faire partie d'une condition de sélection.

- Si une &lt;*constante chaîne&gt;* contient une simple quote (ou une double quote), il faut faire précéder cette simple quote (ou double quote) par un anti-slash ( \\ ).

- Pour optimiser le parcours de la vue, utilisez la fonction [HStatCalcule](../WDLang4/3044134.md) sur le fichier de données avant de créer la vue. En effet, le moteur HFSQL analyse la condition de sélection et s'appuie ensuite sur ces statistiques pour déterminer les rubriques les plus discriminantes qui permettront d'optimiser les parcours des fichiers de données.

- Cette condition de sélection peut être une chaîne de caractères au format Ansi ou Unicode.



<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) 

### Créer une vue sur un fichier de données filtré
<a name="creer_une_vue_sur_fichier_donnees_filtre_ELTPARAGRAPHE000292"></a>La fonction **HCréeVue** tient compte du filtre posé sur le fichier de données source de la vue.

Cette caractéristique est supportée pour les vues créées à partir de fichiers de données HFSQL Classic ou Client/Serveur, Hyper File 5.5 et xBase.
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Versions précédentes
<a name="versions_precedentes_ELTPARAGRAPHE000306"></a>Cette fonction remplace la fonction **HCréeVue_55**, conservée par compatibilité avec WINDEV 5.5.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
