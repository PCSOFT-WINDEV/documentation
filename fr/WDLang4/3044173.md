


## HAttacheMémo (Fonction)

***En anglais : HLinkMemo***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet d'associer un fichier à une rubrique de type mémo binaire ou d'annuler l'attachement existant entre un fichier et une rubrique binaire.

Le fichier sera lu et ajouté au mémo uniquement lors de l'ajout ou de la modification de l'enregistrement (fonction [HAjoute](../WDLang4/3044147.md), [HModifie](../WDLang4/3044042.md) ou [HEcrit](../WDLang4/3044092.md)). Si le fichier est ouvert en écriture et si la constante *hAccepteFichierOuvert* n'a pas été utilisée, la fonction renverra une erreur.

La fonction [HExtraitMémo](../WDLang4/3044072.md) permettra d'extraire le fichier contenu dans le mémo sur le disque dur.

**Remarque** : Il est également possible d'utiliser l'affectation directe : 

- Pour associer directement une image (contenue dans un champ Image) à un mémo image : 
	
	```txt
	<NomFichier>.<NomRubriqueMémo> = <NomChampImage>
	```

	Par exemple : 
	
	```wl
	UnFichier.UneRubriqueMémo = IMG_UnChampImage
	```

	Cette syntaxe peut être utilisée aussi bien avec le moteur HFSQL qu'avec les Connecteurs Natifs.
	
	```txt
	<NomFichier>.<NomRubriqueMémo> = <NomBuffer>
	```

	Par exemple : 
	
	```wl
	bufFichier est un Buffer = fChargeBuffer("MonFichier")
	MonFichier.MonMémo = bufFichier
	```






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003044173&name=hattachememo_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Attache une image à l'enregistrement
HAttacheMémo(Produit, Image_Produit, "C:\Images\Produit1.bmp", hMémoImg)
// Transfère le contenu des champs dans le buffer du fichier
EcranVersFichier()
// Ajoute l'enregistrement
HAjoute(Produit)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Associer un fichier à une rubrique de type mémo binaire

`<Résultat> = HAttacheMémo(<Fichier de données> , <Rubrique> [, <Fichier à attacher> [, <Type> [, <Informations>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur. Si le fichier à associer est ouvert en écriture et si la constante *hAccepteFichierOuvert* n'a pas été utilisée, la fonction renverra une erreur.




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données (ou de la requête) contenant une rubrique mémo. 
Si seuls les paramètres &lt;Fichier de données&gt; et &lt;Rubrique&gt; sont précisés, la fonction **HAttacheMémo** annule l'attachement existant entre le fichier binaire et la rubrique.

**`<Rubrique> : (Chaîne de caractères)`**

Nom de la rubrique mémo du fichier de données dans laquelle le fichier binaire doit être ajouté. 
Si seuls les paramètres &lt;Fichier de données&gt; et &lt;Rubrique&gt; sont précisés, la fonction **HAttacheMémo** annule l'attachement existant entre le fichier binaire et la rubrique.

**`<Fichier à attacher> : (Chaîne de caractères optionnelle)`**

Nom du fichier à associer à la rubrique de type mémo binaire. Ce nom peut correspondre : 

- soit au chemin complet du fichier à attacher,

- soit au chemin relatif (par rapport au répertoire en cours) du fichier à attacher. 




Si ce paramètre n'est pas précisé ou correspond à une chaîne vide (""), l'attachement en cours est supprimé.
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Si un chemin est spécifié, ce chemin doit correspondre à un fichier existant. Dans le cas contraire, une erreur fatale est affichée.

**`<Type> : (Combinaison de constantes de type Entier, optionnelle)`**

Indique le type du fichier à attacher et le mode de lecture du fichier.


|   |   |
| --- | --- |
| *hAccepteFichierOuvert* | Autorise la lecture du fichier source à ajouter dans le mémo si ce fichier source est ouvert en écriture par ailleurs.<br>Cette constante peut être combinée avec les constantes de type du fichier. |
| *hMémoBin*<br>(valeur par défaut) | Le fichier est un fichier binaire quelconque. |
| *hMémoImg* | Le fichier est de type image. |
| *hMémoOle* | Le fichier est de type OLE. |
| *hMémoWav* | Le fichier est de type son. |


![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Ce paramètre n'est pas pris en compte.![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre est disponible uniquement pour les fichiers de données au format HFSQL. 

**`<Informations> : (Chaîne de caractères optionnelle)`**

Message d'information (65535 caractères maximum) stocké avec le fichier. Ce message peut être relu grâce à la fonction [HInfoMémo](../WDLang4/3044008.md).

![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Ce paramètre n'est pas pris en compte.![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre est disponible uniquement pour les fichiers de données au format HFSQL. 


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
### Associer un fichier à une rubrique de type mémo binaire via une variable de type Enregistrement

`<Résultat> = HAttacheMémo(<Rubrique mémo> [, <Fichier à attacher> [, <Type> [, <Informations>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur. Si le fichier à associer est ouvert en écriture et si la constante *hAccepteFichierOuvert* n'a pas été utilisée, la fonction renverra une erreur.




**`<Rubrique mémo> : (Variable de type Enregistrement)`**

Rubrique mémo dans laquelle le fichier binaire doit être ajouté. Utilisez la notation &lt;Nom variable Enregistrement&gt;.&lt;Nom rubrique mémo&gt;. 
Si seul le paramètre &lt;Rubrique mémo&gt; est précisé, la fonction **HAttacheMémo** annule l'attachement existant entre le fichier binaire et la rubrique.

**`<Fichier à attacher> : (Chaîne de caractères optionnelle)`**

Nom du fichier à associer à la rubrique de type mémo binaire. Ce nom peut correspondre : 


- soit au chemin complet du fichier à attacher,

- soit au chemin relatif (par rapport au répertoire en cours) du fichier à attacher.  




Si ce paramètre n'est pas précisé ou correspond à une chaîne vide (""), l'attachement en cours est supprimé.

**`<Type> : (Combinaison de constantes de type Entier, optionnelle)`**

Indique le type du fichier à attacher et le mode de lecture du fichier.


|   |   |
| --- | --- |
| *hAccepteFichierOuvert* | Autorise la lecture du fichier source à ajouter dans le mémo si ce fichier source est ouvert en écriture par ailleurs.<br>Cette constante peut être combinée avec les constantes de type du fichier. |
| *hMémoBin*<br>(valeur par défaut) | Le fichier est un fichier binaire quelconque. |
| *hMémoImg* | Le fichier est de type image. |
| *hMémoOle* | Le fichier est de type OLE. |
| *hMémoWav* | Le fichier est de type son. |



**`<Informations> : (Chaîne de caractères optionnelle)`**

Message d'information (65535 caractères maximum) stocké avec le fichier. Ce message peut être relu grâce à la fonction [HInfoMémo](../WDLang4/3044008.md).
![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Ce paramètre n'est pas pris en compte.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Annuler l'attachement existant
<a name="annuler_attachement_existant_ELTPARAGRAPHE000301"></a>Si seuls les paramètres &lt;Fichier de données&gt; et &lt;Rubrique&gt; sont précisés, la fonction **HAttacheMémo** annule l'attachement existant entre le fichier binaire et la rubrique.
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Différence entre les fonctions BinaireCharge et HAttacheMémo
<a name="difference_entre_les_fonctions_binairecharge_docparampagetitleshort_ELTPARAGRAPHE000315"></a>A la différence de la fonction **BinaireCharge** (conservée par compatibilité avec WINDEV 5.5), la fonction **HAttacheMémo** ne charge pas le fichier binaire en mémoire. Il n'y a donc aucun risque de saturation de la mémoire lors de l'association d'un fichier de taille importante à une rubrique de type mémo.
<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Langage Externe](https://doc.pcsoft.fr/ext/images/fr/LE.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png) 

### Vignettes HFSQL
<a name="vignettes_hfsql_ELTPARAGRAPHE000331"></a>Si la rubrique manipulée utilise des vignettes HFSQL, les vignettes seront automatiquement générées avec le nouveau fichier lors de l'ajout ou de la modification de l'enregistrement (fonctions [HAjoute](../WDLang4/3044147.md), [HModifie](../WDLang4/3044042.md) ou [HEcrit](../WDLang4/3044092.md)).
<a name="NOTE0_5"></a>
![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Gestion des mémos sous SQLite
<a name="gestion_des_memos_sous_sqlite_ELTPARAGRAPHE000351"></a>Le stockage d'informations sous forme de mémos est conseillé uniquement pour des données de taille peu volumineuse (inférieures à 1 Mo). Il est recommandé d'enregistrer directement les données sous forme de fichier externe sur la mémoire du téléphone (interne ou externe) et de mémoriser dans la base uniquement le chemin d'accès à ces données.  

<a name="XComposante"></a>

## Composante :
wd280hf.dll
