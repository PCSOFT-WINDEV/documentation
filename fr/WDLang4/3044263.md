
## HConnecte (Fonction)

***En anglais : HConnect***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Redéfinit un ou plusieurs paramètres d'une connexion par un Connecteur Natif (Access, SQL Server, Oracle ou MySQL) ou par accès OLE DB sur une table spécifique ou sur un ensemble de tables. La ou les tables sont ensuite ouvertes (ou créées si elles n'existent pas). L'opération de test spécifiée est alors exécutée.

**Remarques** :

- La nouvelle redéfinition de la connexion sera utilisée jusqu'à ce qu'elle soit annulée avec la fonction **HConnecte**. Elle sera automatiquement annulée à la fin de l'application.

- Par défaut, les caractéristiques de la connexion sont définies sous l'éditeur d'analyses, pour une ou plusieurs tables.





|   |
| --- |
| **Important**<br><br>La fonction **HConnecte** permet de définir simplement une connexion sur une base de données. Il est conseillé d'utiliser la fonction [HDécritConnexion](../WDLang4/3044205.md) puis la fonction [HChangeConnexion](../WDLang4/3044150.md) pour :<br><br>- gérer des paramètres avancés disponibles avec certaines bases de données (curseurs, transactions, ...),<br><br>- manipuler une connexion nommée.<br><br><br> |


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003044263&name=hconnecte_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 
```wl
HConnecte("Salaires", "", "", ...
	"C:\Mes Documents\MaBase.mdb", "Microsoft.JET.OLEDB.4.0", hOLectureEcriture)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HConnecte(<Nom de la table> [, <Utilisateur> [, <Mot de passe> [, <Base de données> [, <Serveur OLE DB ou Connecteur Natif> [, <Accès> [, <Opération de test> [, <Informations optionnelles>]]]]]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur.




**`<Nom de la table> : (Chaîne de caractères)`**

Nom de la table (fichier de données) à ouvrir, et pour laquelle la connexion doit être redéfinie. Si aucun autre paramètre n'est précisé, le fichier de données est ré-initialisé avec les paramètres par défaut définis dans l'analyse.

- Si ce paramètre est égal à "\*", le changement s'appliquera à toutes les tables manipulées par le Connecteur Natif (également appelé Accès Natif). Dans ce cas, tous les paramètres de la connexion doivent être précisés. 

- Si ce paramètre est égal à "\*" et que aucun autre paramètre n'est spécifié, tous les fichiers de données de tous les Connecteurs Natifs définis dans l'analyse sont ré-initialisés avec les paramètres par défaut définis dans l'analyse.




**`<Utilisateur> : (Chaîne de caractères optionnelle)`**

Nom de l'utilisateur utilisé pour l'ouverture du fichier de données.

**`<Mot de passe> : (Chaîne de caractères optionnelle)`**

Mot de passe de la connexion (si ce mot de passe existe).

**`<Base de données> : (Chaîne de caractères optionnelle)`**

Chemin complet de la source de données.



**`<Serveur OLE DB ou Connecteur Natif> : (Chaîne de caractères ou constante optionnelle)`**

Nom du provider OLE DB utilisé ou une des constantes suivantes :


|   |   |
| --- | --- |
| *hAccèsHF7* | Pseudo-connexion à une base HFSQL Classic |
| *hAccèsHFClientServeur* | Connecteur Natif à une base HFSQL Client/Serveur |
| *hAccèsNatifAS400* | Connecteur Natif AS/400 (module optionnel de WINDEV/WEBDEV) |
| *hAccèsNatifDB2* | Connecteur Natif DB2 (module optionnel de WINDEV/WEBDEV) |
| *hAccèsNatifInformix* | Connecteur Natif Informix (module optionnel de WINDEV/WEBDEV) |
| *hAccèsNatifMariaDB* | Connecteur Natif MariaDB (module optionnel de WINDEV/WEBDEV) |
| *hAccèsNatifMySQL* | Connecteur Natif MySQL (module optionnel de WINDEV/WEBDEV) |
| *hAccèsNatifOracle* | Connecteur Natif Oracle (module optionnel de WINDEV/WEBDEV) |
| *hAccèsNatifOracleLite* | Connecteur Natif Oracle (module optionnel de WINDEV Mobile) |
| *hAccèsNatifPostgreSQL* | Connecteur Natif PostgreSQL (module optionnel de WINDEV/WEBDEV) |
| *hAccèsNatifProgress* | Connecteur Natif Progress (module optionnel de WINDEV/WEBDEV) |
| *hAccèsNatifSQLAzure* | Connecteur Natif SQL Azure (module optionnel de WINDEV/WEBDEV, fourni avec le Connecteur Natif SQL Server) |
| *hAccèsNatifSQLite* | Connecteur Natif à une base SQLite (fourni en standard avec WINDEV/WEBDEV) |
| *hAccèsNatifSQLServer* | Connecteur Natif SQL Server (module optionnel de WINDEV/WEBDEV) |
| *hAccèsNatifSQLServerMobile* | Connecteur Natif SQL Server (module optionnel de WINDEV Mobile) |
| *hAccèsNatifSybase* | Connecteur Natif Sybase (module optionnel de WINDEV/WEBDEV) |
| *hAccèsNatifXBase* | Connecteur Natif xBase (fourni en standard avec WINDEV/WEBDEV) |
| *hAccèsNatifXML* | Connecteur Natif XML (fourni en standard avec WINDEV/WEBDEV) |
| *hODBC* | Provider OLE DB pour ODBC (permet d'accéder à une source de données ODBC déclarée dans les sources de données ODBC de Windows) |
| *hOledbAccess97* | Provider OLE DB pour Access 97 |
| *hOledbAccess2000* | Provider OLE DB pour Access 2000 |
| *hOledbAccess2007* | Provider OLE DB pour Access 2007 |
| *hOledbAccess2010* | Provider OLE DB pour Access 2010 |
| *hOledbDBase5* | Provider OLE DB pour DBase 5 |
| *hOledbExcel97* | Provider OLE DB pour Excel 97 |
| *hOledbExcel2000* | Provider OLE DB pour Excel 2000 |
| *hOledbExcel2007* | Provider OLE DB pour Excel 2007 |
| *hOledbLotus4* | Provider OLE DB pour Lotus 4 |
| *hOledbOracle* | Provider OLE DB pour Oracle |
| *hOledbSQLServer* | Provider OLE DB pour SQL Server |





![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png) Attention : Pour utiliser une connexion OLE DB, il est nécessaire : 


- d'installer le MDAC version 2.6 minimum (installation réalisée avec WINDEV/WEBDEV et lors de la création du programme d'installation) 

- d'installer le provider OLE DB correspondant à la base de données manipulée. 
	Ce paramètre peut être récupéré grâce à la propriété [CxProviderOLEDB](../Proprietes/2512033.md).




**`<Accès> : (Constante optionnelle)`**

Paramètre le type d'accès au fichier de données.


|   |   |
| --- | --- |
| *hOLecture* | Le fichier de données est accessible uniquement en lecture. Seule la lecture des enregistrements est possible. Il n'est pas possible d'en ajouter ou d'en supprimer. |
| *hOLectureEcriture*<br>(valeur par défaut) | Le fichier de données est accessible en lecture et en écriture. Il est possible aussi bien de lire des enregistrements que d'écrire de nouveaux enregistrements. |



**`<Opération de test> : (Constante optionnelle)`**

Paramètre le type de l'opération à effectuer sur la base de données pour vérifier la connexion.


|   |   |
| --- | --- |
| *hHCréationSiInexistant*<br>(Valeur par défaut) | Vérifie la connexion grâce à l'ouverture ou la création d'un fichier de données (si le fichier de données n'existe pas). Cette opération est possible uniquement en accès de type *hOLectureEcriture*. |
| *hHOuvre* | Vérifie la connexion grâce à une ouverture de fichier de données. Cette valeur est utilisée par défaut lors d'un accès à une base de type *hOLecture*. |



**`<Informations optionnelles> : (Chaîne de caractères optionnelle)`**

Information insérée dans la chaîne de connexion à la base de données. 

Par exemple, il est possible sur certaines sources de données de spécifier quelle base de données utiliser. Sur SQL Server, la base "Master" est la base par défaut, mais il est possible d'en utiliser d'autres, par exemple "dbo". Cette information est spécifiée dans le paramètre &lt;Information optionnelle&gt;, grâce à la syntaxe suivante :
![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png) "initial catalog = dbo"![ODBC](https://doc.pcsoft.fr/ext/images/fr/ODBC.png) "database = dbo"![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) MySQL : "initial catalog = dbo"

![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Les mots-clés reconnus par OLE DB et par les Connecteurs Natifs sont présentés dans la page [Informations optionnelles de connexion](../WDLang4/9000124.md).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Paramétrage de la connexion 
<a name="parametrage_connexion_ELTPARAGRAPHE000272"></a>

- La description de la table doit être connue au moment de l'appel de la fonction **HConnecte** (la table doit avoir été décrite dans l'analyse, ou bien avec les fonctions [HDéclare](../WDLang4/3044203.md) ou [HDécritFichier](../WDLang4/3044206.md)).

- La fonction **HConnecte** ouvre la connexion et la table. La table est créée si elle n'existe pas. La fonction **HConnecte** équivaut pour cela à la fonction [HCréationSiInexistant](../WDLang4/3044254.md).

- Lors de la redéfinition de la connexion, seuls les paramètres spécifiés sont pris en compte. La valeur des paramètres non spécifiés avec la fonction **HConnecte** correspond à la valeur définie sous l'éditeur d'analyses.

- Si seul le &lt;Nom de la table&gt; est spécifié, la fonction **HConnecte** annule la redéfinition de la connexion pour la ou les tables spécifiées. Les paramètres définis dans l'éditeur d'analyses seront pris en compte.

- Lorsque le paramètre &lt;Nom de la table&gt; est égal à "\*", le changement s'applique à toutes les tables des Connecteurs Natifs définies dans l'analyse. Dans ce cas, seuls les paramètres &lt;Utilisateur&gt;, &lt;Mot de passe&gt;, &lt;Base de données&gt; et &lt;Accès&gt; sont pris en compte.

- Pour annuler un changement de connexion effectué sur toutes les tables, &lt;Nom de la table&gt; doit être égal à "\*" et aucun autre paramètre ne doit être précisé.

- Si la source de données est précisée, la fonction **HConnecte** ignore les éventuels [HSubstRep](../WDLang4/3044028.md)/[HChangeRep](../WDLang4/3044168.md).

- Si une table est ouverte lors de l'appel de la fonction **HConnecte**, la table est fermée puis ré-ouverte avec les nouveaux paramètres de connexion.






<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
