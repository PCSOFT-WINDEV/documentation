
## Les différents types de parcours disponibles en SQL
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000196"></a>
Pour parcourir le résultat d'une requête exécutée avec la fonction [SQLExec](../WDLang4/3072007.md), deux types de parcours sont disponibles :

- Parcours de type : [SQLPremier](../WDLang4/3072017.md)/[SQLCol](../WDLang4/3072018.md)

- Parcours de type : [SQLAvance](../WDLang4/3072011.md)/[SQLLitCol](../WDLang4/3072019.md).




Les paragraphes suivants présentent les avantages et les inconvénients de chacune de ces deux méthodes.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comparaison des deux méthodes
<a name="comparaison_des_deux_methodes_ELTTEXTE000220"></a>
Le tableau suivant présente les caractéristiques des deux méthodes de parcours :


|   |   |   |
| --- | --- | --- |
|   | **Parcours de type SQLPremier/SQLCol** | **Parcours de type SQLAvance/SQLLitCol** |
| **Résultat de la requête** | Tous les enregistrements résultat de la requête sont chargés en mémoire lors de l'exécution de la fonction [SQLPremier](../WDLang4/3072017.md).<br>Le premier appel à la fonction [SQLPremier](../WDLang4/3072017.md) peut être relativement long. | Aucun enregistrement n'est chargé en mémoire. La base de données gère le résultat de la requête. |
| **Nombre d'enregistrements** | Le nombre d'enregistrements correspondant au résultat de la requête est automatiquement calculé lors de la lecture du premier enregistrement (fonction [SQLPremier](../WDLang4/3072017.md)). La variable SQL.NbLig est mise à jour | Le nombre d'enregistrements correspondant au résultat de la requête n'est pas calculé. |
| **SQLInfoGene** | La fonction [SQLInfoGene](../WDLang4/3072028.md) permet d'obtenir des renseignements sur la requête et sur le parcours en cours. | La fonction [SQLInfoGene](../WDLang4/3072028.md) permet uniquement d'obtenir des informations générales sur la requête ou sur la connexion. |
| **Parcours des enregistrements** | Retour possible sur un élément précédent du résultat | Pas de retour possible sur un élément précédent du résultat |
|   | Lecture du résultat de la requête grâce aux fonctions [SQLCol](../WDLang4/3072018.md), [SQLAssocie](../WDLang4/3072004.md). | Lecture du résultat de la requête grâce à la fonction [SQLLitCol](../WDLang4/3072019.md) et [SQLLitMémo](../WDLang4/3072020.md). |
| **Affichage dans une table** | La fonction [SQLTable](../WDLang4/3072031.md) ne doit pas être utilisée (erreur fatale). | La fonction [SQLTable](../WDLang4/3072031.md) permet de récupérer uniquement les enregistrements résultat à partir de l'enregistrement en cours. |
| **Gestion des tabulations** | Ce type de parcours ne permet pas de récupérer les tabulations présentes dans les valeurs des enregistrements. Une tabulation sépare deux rubriques. Seule la partie précédant la tabulation sera récupérée avec les fonctions de lecture. <br>Pour plus de détails, consultez l'aide de [SQLCol](../WDLang4/3072018.md) et [SQLAssocie](../WDLang4/3072004.md). | Ce type de parcours permet de récupérer les tabulations présentes dans les valeurs des enregistrements.<br>Pour plus de détails, consultez l'aide de [SQLLitCol](../WDLang4/3072019.md). |

 


**Exemple de parcours de type SQLPremier/SQLCol**


```wl
ResExec = SQLExec("SELECT NOMCLI FROM FACT","REQ1")
SI ResExec ALORS 
	SQLPremier("REQ1") 
	// Transfert du nom dans LISTE_LISTENOM
	TANTQUE PAS SQL.EnDehors
		ListeAjoute(LISTE_LISTENOM, SQLCol("REQ1",1))
		SQLSuivant("REQ1")
	FIN
SINON
	// TraiteErreur
FIN
SQLFerme("REQ1")
```


**Exemple de parcours de type SQLAvance/SQLLitCol**


```wl
i est un entier = 0
SQLExec("SELECT NOM, PRENOM, POSTE,PHOTO FROM CLIENT","REQ1")
// Récupérer la requête ligne à ligne
TANTQUE SQLFetch("REQ1") = 0 
	// Il y a encore une ligne
	i++
	// Récupérer les données
	NOM[i] = SQLLitCol("REQ1",1)
	PRENOM[i] = SQLLitCol("REQ1", 2)
	POSTE[i] = SQLLitCol("REQ1",3)
	{"IMAGE"+i} = SQLLitMémo("REQ1", 4)
FIN
SQLFerme("REQ1")
```





