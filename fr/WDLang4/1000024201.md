


## &lt;Source&gt;.ChangeNom (Fonction)

***En anglais : &lt;Source&gt;.ChangeName***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie le nom physique d'un fichier de données. 

**Rappel** : Par défaut, le fichier physique est créé avec le nom qui lui a été donné dans l'analyse.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Création du fichier de statistiques de janvier
Stat.ChangeNom("StatistiquesJanvier")
Stat.Création()
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Source>.ChangeNom(<Nom physique>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Source> : (Type correspondant à la source spécifiée)`**

Nom du fichier de données (défini dans l'analyse). Ce nom est utilisé dans toutes les fonctions de manipulation des fichiers de données HFSQL.

**`<Nom physique> : (Chaîne de caractères)`**

Nouveau nom physique du fichier de données.

- Si ce paramètre est une chaîne vide (""), le nom physique utilisé correspondra au nom physique défini dans l'analyse.

- Ce paramètre ne doit contenir ni nom de lecteur, ni nom de répertoires. 

- Ce nom sera conservé à la fermeture du fichier de données. 

- La propriété [NomPhysique](../Proprietes/2512059.md) permet de connaître le nom physique donné au fichier de données par la fonction **&lt;Source&gt;.ChangeNom**.


![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Selon la base de données utilisée, le nom physique du fichier de données peut être préfixé par le nom de la base de données ou le nom de l'utilisateur, ou le nom du schéma. Dans ce cas : 

- le nom physique complet est indiqué dans la description du fichier de données sous l'éditeur d'analyses (option "Nom de la table dans la base de données externe"). 

- la fonction **&lt;Source&gt;.ChangeNom** permet également de changer le nom physique du fichier de données. Consultez également le paragraphe Utilisation avec les Connecteurs Natifs et/ou le provider OLE DB.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000267"></a>

- Le fichier de données doit être fermé pour que cette modification soit prise en compte (utilisez la fonction [&lt;Source&gt;.Ferme](../WDLang4/1000024958.md) si nécessaire), sinon la modification sera prise en compte lors de la prochaine ouverture.

- ![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) **XML** : La fonction **&lt;Source&gt;.ChangeNom** modifie le nom du TAG XML associé au fichier de données décrit dans l'analyse (ne change donc pas le nom physique du fichier). Pour changer le nom du fichier, il est nécessaire d'utiliser une connexion (fonction [HDécritConnexion](../WDLang4/3044205.md) en spécifiant le nom du fichier XML comme source de données), puis d'associer cette connexion au fichier avec la fonction [&lt;Source&gt;.ChangeConnexion](../WDLang4/1000024199.md).





### Changements de nom multiples
<a name="changements_nom_multiples_ELTPARAGRAPHE000296"></a>La fonction **&lt;Source&gt;.ChangeNom** peut être appelée plusieurs fois avec des paramètres différents. Lorsque le nom physique est redéfini plusieurs fois pour un même nom logique de fichier de données, le dernier nom physique donné remplace tous les autres.
<a name="NOTE0_2"></a>


### Changement de répertoire ou de lecteur
<a name="changement_repertoire_lecteur_ELTPARAGRAPHE000309"></a>La fonction **&lt;Source&gt;.ChangeNom** permet uniquement de changer le nom du fichier physique. Pour modifier son emplacement, utilisez les fonctions [&lt;Source&gt;.ChangeRep](../WDLang4/1000024202.md) et [HSubstRep](../WDLang4/3044028.md).
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Fonction &lt;Source&gt;.ChangeNom : Utilisation avec les Connecteurs Natifs et/ou le provider OLE DB
<a name="fonction_docparampagetitleshort_utilisation_avec_les_connecteurs_natifs_etou_provider_ole_ELTPARAGRAPHE000332"></a>Par défaut, le nom logique fourni à la fonction **&lt;Source&gt;.ChangeNom** est considéré comme étant le seul nom de la table. Il est encapsulé en utilisant les caractères d'encapsulation correspondant à la base ou spécifiés par le provider OLE DB avant d'être envoyé à la base (ce qui permet de gérer des noms de table contenant des caractères spéciaux).

Pour fournir un nom de fichier composé de &lt;nom du user&gt;.&lt;nom de la table&gt; (ou suivant la base de données &lt;nom du schéma&gt;.&lt;nom de la table&gt;) dans la fonction **&lt;Source&gt;.ChangeNom**, il est nécessaire de fournir ces noms déjà formatés (en utilisant les caractères d'encapsulation correspondant à la base de données ou spécifiés par le provider OLE DB).

Exemple pour SQLServer :
Les caractères d'encapsulation sont " ".
Pour changer le nom CLIENT en DBO.CLIENT avec la fonction **&lt;Source&gt;.ChangeNom**, il est nécessaire de passer la chaîne "DBO"."CLIENT".
Il faut donc utiliser le code suivant :

```wl
Client.ChangeNom("""DBO"".""CLIENT""")
```

<a name="NOTE0_4"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000370"></a>

- Si la gestion du ".REP" est branchée (fonction [HGèreREP](../WDLang4/3044061.md)), la modification de nom est enregistrée dans le fichier ".REP" (voir [gestion du .REP](../WDLang4/3044186.md)). 

- La fonction **&lt;Source&gt;.ChangeNom** est équivalente à la fonction **HSubstNom** disponible dans WINDEV 5.5/WEBDEV 1.5.




<a name="XComposante"></a>

## Composante :
wd280hf.dll
