
## ODBC sur HFSQL via Visual .NET (en C#)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000100"></a>
Le driver ODBC sur HFSQL Classic (monoposte et réseau) permet d'accéder à une base de données HFSQL Classic depuis un logiciel de base de données externe, gérant les accès par ODBC. Il est ainsi possible d'utiliser le driver ODBC sur HFSQL Classic via Visual .NET (en C#).




### Installation
<a name="installation_ELTPARAGRAPHE000016"></a>Lors de l'installation de WINDEV ou WEBDEV sur le poste de développement, il est possible d'installer le driver ODBC sur HFSQL Classic. 
De même, lors de la configuration du programme d'installation de vos applications WINDEV, vous pouvez inclure l'installation du driver ODBC sur HFSQL. 



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Configuration
<a name="configuration_ELTTEXTE000136"></a>
Pour utiliser le driver ODBC sur HFSQL, configurez le driver ODBC : 

1. Lancez l'administrateur de données ODBC (ODBCAD32.EXE) sur votre poste. Utilisez par exemple l'option "Démarrer .. Exécuter" de Windows et saisissez "ODBCAD32.EXE".

2. Sélectionnez l'onglet "Base de données Utilisateur".

3. Cliquez sur le bouton "Ajouter".

4. Sélectionnez le driver "HyperFileSQL Classic".

5. Cliquez sur le bouton "Terminer".

6. Saisissez le nom de la source de données HFSQL. Ce nom permettra d'identifier la base de données HFSQL dans les programmes externes.

7. Cliquez sur le bouton "Détail".

8. Sélectionnez le fichier WDD correspondant à l'analyse grâce au bouton "Parcourir".

9. Dans la liste des analyses, sélectionnez l'analyse voulue puis sélectionnez le répertoire des fichiers de données correspondant (bouton "Parcourir"). Tous les fichiers de données HFSQL correspondant à l'analyse sélectionnée sont regroupés dans ce répertoire.
	Attention : il est nécessaire de sélectionner un répertoire de fichier par analyse.

10. Validez (bouton "OK").




La base de données est utilisable en lecture/écriture depuis des programmes externes via le driver ODBC sur HFSQL Classic.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Utilisation
<a name="utilisation_ELTTEXTE000160"></a>
Voici un exemple de code permettant de manipuler le driver ODBC sur HFSQL depuis votre programme Visual .NET : 



```txt
--------------------------------------------------------------------
// Code d'exemple d'utilisation d'une base de données HFSQL par ODBC
namespace ConsoleApplicationTestODBC
{
class Sample
{
public static void Main() 
{
try
{
// Connexion en utilisant un DSN
// MaBaseODBC est une source de données ODBC définie avec odbcad32
// OdbcConnection nwindConn = new OdbcConnection("DSN=MaBaseODBC");
// Connexion en passant directement les paramètres de connexion
// ANA=<Chemin complet de l'analyse>
// REP=<Répertoire des fichiers>
OdbcConnection MaConnexion = 
	new OdbcConnection("Driver={HyperFileSQL};ANA=c:\test\\MonAnalyse.wdd;REP=c:\test\\;");
// Ouverture de la connexion
MaConnexion.Open();
// Requête à exécuter sur la base de données
OdbcCommand MaRequete = new OdbcCommand("SELECT * FROM MonFichier", MaConnexion);
 
// Exécution de la requête
OdbcDataReader MesDonnees = MaRequete.ExecuteReader();
// Parcours du résultat de la requête
while (MesDonnees.Read())
{
Console.WriteLine("\t{0}\t{1}", MesDonnees.GetInt32(0), MesDonnees.GetString(1));
}
MesDonnees.Close();
MaConnexion.Close();
}
catch(OdbcException eExcpt)
{
// Affichage des erreurs
Console.WriteLine("Source = " + eExcpt.Source);
Console.WriteLine("Message = " + eExcpt.Message);
}
// pause avant de sortir
Console.ReadLine();
}
}
}
 
--------------------------------------------------------------------
```





