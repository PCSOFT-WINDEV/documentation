


## HPositionCourante (Fonction)

***En anglais : HGetCurrentPosition***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie la position approximative de l'enregistrement en cours dans le fichier de données. Cette position est donnée par rapport à une rubrique spécifique.

**Remarque** : La position donnée est approximative pour des raisons de performances. La position est calculée par rapport à la position dans l'index.

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
HRecherche(Client, Nom, "Dupont")
SI HTrouve(Client) = Vrai ALORS
	Pourcentage est un entier = HPositionCourante(Client, Nom)/10
	Info("Le premier Dupont est à " + Pourcentage + "% de Client sur la clé Nom")
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HPositionCourante([<Fichier de données> [, <Rubrique>] [, <Précision>]])`
---

**`<Résultat> : (Entier)`**



- Position approximative courante, rapportée à l'intervalle [1;1000]. 

- -1 en cas d'erreur (fichier de données vide, filtre ne donnant aucun résultat, ...). La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'obtenir plus d'informations sur le problème rencontré.




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données manipulé. Si ce nom n'est pas spécifié, la fonction **HPositionCourante** va manipuler le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Rubrique> : (Chaîne de caractères optionnelle)`**

Nom de la rubrique utilisée. Si ce nom n'est pas spécifié, la fonction **HPositionCourante** va manipuler la dernière rubrique utilisée par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Précision> : (Entier optionnel)`**

Fixe la précision avec laquelle la position est évaluée. Attention : Plus la précision est élevée, et plus le temps d'évaluation de la position est important.


|   |   |
| --- | --- |
| *hPrécisionElevée* | Précision élevée. |
| *hPrécisionFaible* | Précision faible. |
| *hPrécisionMoyenne*<br>(valeur par défaut) | Précision moyenne. |


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre est ignoré. La précision de calcul est toujours élevée.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Position par rapport à une rubrique clé ou non clé
<a name="position_par_rapport_une_rubrique_cle_non_cle_ELTPARAGRAPHE000135"></a>Pour une rubrique clé, la position retournée est relative à l'ordre de l'enregistrement dans l'index de cette rubrique.

Pour une rubrique non clé, la position retournée est relative au numéro de l'enregistrement dans le fichier de données (voir la fonction [HNumEnr](../WDLang4/3044063.md)).
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Position dans un parcours filtré
<a name="position_dans_parcours_filtre_ELTPARAGRAPHE000151"></a>Si un filtre avec bornes est défini (fonction [HFiltre](../WDLang4/3044100.md) sans chaîne de condition mais avec les bornes minimales et maximales), la position retournée est relative aux enregistrements sélectionnés par le filtre.

Si une chaîne de condition est donnée à la fonction [HFiltre](../WDLang4/3044100.md), la position retournée ne tient pas compte du filtre.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
