
## HEtatServeur (Fonction)

***En anglais : HServerStatus***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet de connaître l'état d'un serveur HFSQL (cette fonction utilise le service MantaManager).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Etat d'un serveur identifié par le nom du poste
SELON HEtatServeur("MonServeur:4905")
	CAS hArrêté : Info("Serveur arrêté")
	CAS hDémarré : Info("Serveur démarré")
	CAS hInaccessible : Info("Serveur inaccessible")
FIN
```


<a name="Exemple2"></a>





```wl
// Etat d'un serveur identifié par une variable de type Connexion
Cnx_HFSQL est une Connexion
Cnx_HFSQL.Provider = hAccèsHFClientServeur
Cnx_HFSQL.Utilisateur = "admin"
Cnx_HFSQL.MotDePasse = ""
Cnx_HFSQL.Serveur = "GB:4916"
Cnx_HFSQL.BaseDeDonnées = "CRM"

SELON HEtatServeur(Cnx_HFSQL.Serveur)
	CAS hArrêté : Info("Serveur arrêté")
	CAS hDémarré : Info("Serveur démarré")
	CAS hInaccessible : Info("Serveur inaccessible")
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### État d'un serveur (avec possibilité de préciser le port du serveur HFSQL)

`<Résultat> = HEtatServeur(<Nom du poste>)`
---

**`<Résultat> : (Constante de type Entier)`**

État du serveur HFSQL : 


|   |   |
| --- | --- |
| *hArrêté* | Serveur arrêté |
| *hDémarré* | Serveur démarré |
| *hInaccessible* | État du serveur indéterminé |



**`<Nom du poste> : (Chaîne de caractères)`**

Nom de la machine serveur. Il est possible de préciser le numéro de port utilisé par le serveur HFSQL. Par défaut, le numéro de port utilisé est 4900. Si le numéro de port du serveur HFSQL est différent, utilisez la notation suivante :

&lt;Nom du poste&gt;:&lt;Numéro de port&gt;

Exemple : "NomPoste:4901"

Le numéro de port correspond au numéro de port utilisé dans la fonction [HOuvreConnexion](../WDLang4/3044107.md).  


<a name="SYNTAXE2"></a>

### État d'un serveur en précisant le nom du serveur HFSQL

`<Résultat> = HEtatServeur(<Nom du poste> , <Nom du serveur HFSQL>)`
---

**`<Résultat> : (Constante de type Entier)`**

État du serveur HFSQL : 


|   |   |
| --- | --- |
| *hArrêté* | Serveur arrêté |
| *hDémarré* | Serveur démarré |
| *hInaccessible* | État du serveur indéterminé |



**`<Nom du poste> : (Chaîne de caractères)`**

Nom de la machine serveur.

**`<Nom du serveur HFSQL> : (Chaîne de caractères)`**

Nom du serveur HFSQL à redémarrer (ce nom apparaît dans le Centre de Contrôle HFSQL). 


<a name="SYNTAXE3"></a>

### État d'un serveur en indiquant une connexion

`<Résultat> = HEtatServeur(<Nom de la connexion>)`
---

**`<Résultat> : (Constante de type Entier)`**

Etat du serveur HFSQL : 


|   |   |
| --- | --- |
| *hArrêté* | Serveur arrêté |
| *hDémarré* | Serveur démarré |
| *hInaccessible* | État du serveur indéterminé |



**`<Nom de la connexion> : (Chaîne de caractères)`**

Nom de la connexion pour laquelle l'état du serveur doit être testé. Cette connexion a été définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### État indéterminé
<a name="etat_indetermine_ELTPARAGRAPHE000113"></a>L'état du serveur est indéterminé lorsqu'il est impossible de se connecter au service MantaManager. Cette impossibilité de connexion peut être due aux problèmes suivants :

- Le service MantaManager n'est pas lancé,

- Le service MantaManager ne répond pas,

- Un firewall rend impossible l'accès au service MantaManager,

- ...




Il est nécessaire de re-démarrer le service MantaManager depuis le gestionnaire de services de Windows, et de s'assurer que les ports 5002 ou 4999 sont ouverts (aucun blocage de firewall ou anti-virus).



<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
