


## HModifieDroitBaseDeDonnées (Fonction)

***En anglais : HModifyDatabaseRights***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie les droits donnés à un utilisateur ou à un groupe pour une base de données HFSQL Client/Serveur.

**Remarque** : il est possible de connaître les droits d'un groupe ou d'un utilisateur sur une base de données HFSQL Client/Serveur grâce à la fonction [HInfoDroitBaseDeDonnées](../WDLang4/3044320.md). 


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Copie des droits d'un utilisateur à un autre
sDroits est une chaîne
sDroits = HInfoDroitBaseDeDonnées(MaConnexion, "Dupont", hDroitLecture + hDroitAjout, "MaBase")
HModifieDroitBaseDeDonnées(MaConnexion, "Durand", hDroitLecture + hDroitAjout, sDroits, "MaBase")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HModifieDroitBaseDeDonnées(<Connexion> , <Utilisateur ou groupe> , <Droits à modifier> , <Nouvelles valeurs> , <Base de données>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si les droits ont été modifiés, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur. 


Si le droit spécifié a déjà la nouvelle valeur, aucune modification n'est effectuée.

**Remarque** : Une erreur "Utilisateur inconnu" ou "Groupe inconnu" sera renvoyée par la fonction [HErreurInfo](../WDLang4/3044071.md) si l'utilisateur en cours n'a pas le droit de visualisation des utilisateurs (constante *hDroitVisualisationUtilisateur*) et s'il demande des informations concernant un autre utilisateur ou groupe.

**`<Connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion pour laquelle les droits d'un utilisateur ou d'un groupe d'utilisateurs doivent être modifiés. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md). 




**`<Utilisateur ou groupe> : (Chaîne de caractères)`**

Nom de l'utilisateur ou du groupe dont on veut modifier les droits.

**`<Droits à modifier> : (Constante ou combinaison de constantes de type Entier)`**

Liste des droits à modifier :


|   |   |
| --- | --- |
| *hDroitAjout* | Droit d'ajouter de nouveaux enregistrements dans un fichier de données. |
| *hDroitBlocage* | Droit de bloquer les fichiers de données ou les enregistrements d'un fichier de données. |
| *hDroitChangeDroit* | Droits de changer les droits. |
| *hDroitChangeLiaison* | Droit de modifier les règles d'intégrité sur un fichier de données. |
| *hDroitChangePropriétaire* | Droit de modifier le propriétaire d'un élément. |
| *hDroitConnexion* | Droit de se connecter à un serveur (connexion cryptée et non cryptée). |
| *hDroitConnexionCryptée* | Droit de se connecter à un serveur (connexion cryptée uniquement). |
| *hDroitCréationFichier* | Droit de créer un fichier de données (avec la fonction [HCréation](../WDLang4/3044255.md)). |
| *hDroitCréationVue* | Droit de créer une vue SQL ou une vue matérialisée. |
| *hDroitDéboguer* | Droit de déboguer les procédures stockées. |
| *hDroitExécutionProcédure* | Droit d'exécuter une procédure stockée. |
| *hDroitGèreDoublon* | Droit de brancher et de débrancher la gestion des doublons. |
| *hDroitGèreIntégrité* | Droit de brancher et de débrancher la gestion de l'intégrité. |
| *hDroitGestionProcédure* | Droit d'ajouter, modifier, supprimer des collections de procédures. |
| *hDroitGestionTrigger* | Droit d'ajouter, activer, supprimer des triggers serveur. |
| *hDroitInterditAccèsBaseDeDonnées* | Droit d'interdire ou non l'accès à une base de données (fonctions [HInterditAccèsBaseDeDonnées](../WDLang4/3044286.md) et [HFinInterditAccèsBaseDeDonnées](../WDLang4/3044287.md)). |
| *hDroitLecture* | Droit de lire les enregistrements d'un fichier de données. |
| *hDroitMaintenance* | Droit de lancer une ré-indexation ou un calcul de statistiques sur un fichier de données. |
| *hDroitModifAuto* | Droit de lancer une modification automatique des fichiers de données sur un fichier de données. |
| *hDroitModification* | Droit de modifier les enregistrements d'un fichier de données. |
| *hDroitSauvegarde* | Droit de réaliser une sauvegarde. |
| *hDroitSuppression* | Droit de supprimer les enregistrements d'un fichier de données. |
| *hDroitSuppressionBDD* | Droit de supprimer une base de données. |
| *hDroitSuppressionFichier* | Droit de supprimer un fichier de données (fonction [HSupprimeFichier](../WDLang4/3044294.md)). |
| *hDroitSuppressionVue* | Droit de supprimer une vue. |



**`<Nouvelles valeurs> : (Constantes de type entier)`**

Liste les nouvelles valeurs des droits modifiés. Pour chaque droit précisé dans le paramètre &lt;Droits à modifier&gt;, il est nécessaire de préciser la nouvelle valeur du droit (en respectant le même ordre).

Si une seule valeur est précisée dans ce paramètre, elle sera utilisée pour tous les droits indiqués dans le paramètre &lt;Droits à modifier&gt;.

Les valeurs possibles sont les suivantes :


|   |   |
| --- | --- |
| *hAutorisé* | L'utilisateur ou le groupe a le droit considéré. |
| *hHérité* | L'utilisateur héritera de la valeur du droit donnée au groupe d'utilisateurs auquel il appartient. |
| *hInterdit* | L'utilisateur ou le groupe n'a pas le droit considéré. |



**`<Base de données> : (Chaîne de caractères)`**

Nom de la base de données pour laquelle les droits doivent être modifiés.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Quand est-ce que la modification du droit est réalisée ? 
<a name="quand_estce_que_modification_droit_est_realisee_ELTPARAGRAPHE000275"></a>La modification du droit est effective dès que la fonction **HModifieDroitBaseDeDonnées** est exécutée pour les utilisateurs connectés et concernés par la modification. Il n'est pas nécessaire de redémarrer le serveur pour prendre en compte les nouveaux droits.

**Gestion des doublons et de l'intégrité** : L'erreur de droit apparaît non pas lorsque le mode de gestion est modifié, mais lors d'une tentative de violation de la contrainte d'intégrité (ou de doublons).

<a name="XComposante"></a>

## Composante :
wd280hf.dll
