


## HChangeRep (Fonction)

***En anglais : HChangeDir***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>


- Modifie le chemin d'accès à un fichier de données (c'est-à-dire le répertoire dans lequel le fichier de données sera manipulé). Si le fichier de données est ouvert lors de l'utilisation de **HChangeRep**, le fichier de données est automatiquement fermé.
	**Rappel** : Par défaut, le fichier physique correspondant au fichier de données décrit sous l'analyse est manipulé dans le répertoire spécifié dans l'analyse.

- Substitue le nom de la base de données associée à une table. Dans ce cas, le nom de la base de données spécifié dans les propriétés de la connexion de la table (sous l'éditeur d'analyses) est alors ignoré.
	Pour modifier les paramètres de connexion d'un fichier de données non HFSQL, il est conseillé d'utiliser les fonctions [HDécritConnexion](../WDLang4/3044205.md) et [HChangeConnexion](../WDLang4/3044150.md).


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette fonction fonctionne uniquement pour les connexions à une base de données HFSQL.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) 
```wl
// Création du fichier de données HFSQL Classic Stat dans le répertoire
// "C:\Statistiques\Janvier"
HChangeRep(Stat, "C:\Statistiques\Janvier")
HCréation(Stat)
```
<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) 
```wl
// Création du fichier de données HFSQL Client/Serveur Stat dans le répertoire "\Janvier\"
// Ce répertoire est situé à la racine du dossier 
// de la base de données (connexion HFSQL Client/Serveur)
HChangeRep(Stat, ".\Janvier\")
```
<a name="Exemple3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 
```wl
// Fichier de données associé à une connexion par OLE DB. 
// Remplacement de la base de données à utiliser pour la table "Clients"
HChangeRep(Clients, "C:\Temp\MaDBTest.mdb")
HCréation(Clients)
// La table "Clients" a été créée dans la base de données "c:\temp\madbtest.mdb"
// La table "Clients" de la base ("c:\temp\madborigine.mdb") n'a pas été modifiée
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Utilisation avec des fichiers de données HFSQL 

`<Résultat> = HChangeRep(<Fichier de données> , <Nouveau chemin du fichier de données>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Fichier de données> : (Chaîne de caractères)`**

Nom logique du fichier de données HFSQL (défini dans l'analyse). 
Si ce paramètre est égal à "\*", le changement de répertoire sera appliqué pour tous les fichiers de données connus (décrits dans l'analyse). 
Ce paramètre peut également correspondre au nom d'un [groupe de fichiers (ou perso-dossier) défini dans l'analyse](../Editeurs/2011003.md) (non disponible en Android et Android Widget).

**`<Nouveau chemin du fichier de données> : (Chaîne de caractères)`**

Nouveau chemin d'accès au fichier de données (260 caractères maximum). Ce chemin peut contenir le nom du lecteur et des répertoires, ou être un chemin relatif.
Si le chemin est relatif, le caractère "." (ou "?") permet de désigner le répertoire en cours et le caractère ".." permet de désigner le répertoire parent. 
Si ce paramètre correspond à une chaîne vide (""), le fichier de données sera manipulé dans le répertoire spécifié dans l'analyse.

![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Le chemin d'accès au fichier de données doit être relatif à la base de données présente sur le serveur. Il n'est pas possible d'indiquer un chemin en dehors de la base de données. Si l'on tente d'accéder à des fichiers de données en dehors de la base, une erreur WLangage est affichée. Par exemple: 
Chemin valide : 

```wl
HChangeRep(NomFichier, "SOUSREP")

ou 

HChangeRep(NomFichier, ".\SOUSREP")
```

Chemin non valide : 

```wl
HChangeRep(NomFichier, "C:\BDD\SOUSREP")
```

Si le nouveau chemin est valide et n'existe pas, il est automatiquement créé. 


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 
### Utilisation avec un accès OLE DB ou un Connecteur Natif (également appelé Accès Natif)

`<Résultat> = HChangeRep(<Fichier de données> , <Nouvelle base de données>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Fichier de données> : (Chaîne de caractères)`**

Nom logique de la table (défini dans l'analyse). 
Si ce paramètre est égal à "\*", la fonction **HChangeRep** est ignorée. 
**Attention** : Si ce paramètre est égal à "\*" et si un des fichiers de données de l'analyse a été associé à une connexion (fonction [HChangeConnexion](../WDLang4/3044150.md)) avant l'utilisation de la fonction **HChangeRep**, la modification du répertoire sera prise en compte pour ce fichier de données uniquement à la fermeture de la connexion.

**`<Nouvelle base de données> : (Chaîne de caractères)`**

Chemin d'accès à la base de données à utiliser (260 caractères maximum). Dans ce cas, le nom de la base de données spécifié dans les propriétés de la connexion de la table dans l'analyse est alors ignoré.
Ce chemin peut contenir le nom du lecteur et des répertoires, ou être un chemin relatif.
Si le chemin est relatif, le caractère "." (ou "?") permet de désigner le répertoire en cours, et le caractère ".." permet de désigner le répertoire parent.




<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Changements de répertoire multiples
<a name="changements_repertoire_multiples_ELTPARAGRAPHE000233"></a>La fonction **HChangeRep** peut être appelée plusieurs fois avec des paramètres différents. Lorsque le chemin est redéfini plusieurs fois pour un même fichier de données, le dernier chemin spécifié remplace tous les autres.
<a name="NOTE0_2"></a>


### Changement de nom du fichier de données
<a name="changement_nom_fichier_donnees_ELTPARAGRAPHE000245"></a>La fonction **HChangeRep** permet uniquement de changer le chemin d'accès au fichier de données physique. Pour modifier le nom physique du fichier de données, utilisez la fonction [HChangeNom](../WDLang4/3044141.md).
<a name="NOTE0_3"></a>


### Substitution de répertoire
<a name="substitution_repertoire_ELTPARAGRAPHE000260"></a>La fonction **HChangeRep** permet d'associer un répertoire à un fichier de données. Pour substituer un répertoire par un autre, utilisez la fonction [HSubstRep](../WDLang4/3044028.md).

**Attention** : La substitution de répertoire effectuée par [HSubstRep](../WDLang4/3044028.md) s'applique sur le répertoire défini par la fonction **HChangeRep**. Par exemple :

```wl
HSubstRep("C:\Statistiques\Janvier", "C:\Nouveau\StatJanv")
HChangeRep(Stat, "C:\Statistiques\Janvier") 
HCréation(Stat) // Fichier de données créé dans le répertoire C:\Nouveau\StatJanv
```

<a name="NOTE0_4"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000304"></a>

- Si la gestion du ".REP" est branchée (fonction [HGèreREP](../WDLang4/3044061.md)), la modification de chemin est enregistrée dans le fichier ".REP" (voir [gestion du .REP](../WDLang4/3044186.md)). 

- La fermeture du fichier de données conserve le nouveau chemin, mais ne conserve pas un éventuel mot de passe donné à l'ouverture du fichier de données.

- La fonction **HChangeRep** est équivalente à la fonction **HAssigne** présente dans les versions précédentes.

- Cette fonction peut être utilisée lors de l'ouverture d'une connexion à un serveur HFSQL.  **Attention** : L'ordre d'utilisation des fonctions permettant de se connecter à une base de données HFSQL Client/Serveur est important. Consultez [Optimiser les temps de connexion aux bases HFSQL Client/Serveur](../WDLang4/9000176.md) pour plus de détails.

- ![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) La fonction **HChangeRep** peut être utilisée avec le Connecteur Natif XML.








<a name="XComposante"></a>

## Composante :
wd280hf.dll
