


## HAjouteSauvegardePlanifiée (Fonction)

***En anglais : HAddScheduledBackup***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute une planification de sauvegarde complète (avec ou sans sauvegarde différentielle) sur le serveur défini par la connexion. Cette planification de sauvegarde a été définie par une variable de type [hDescriptionSauvegarde](../WDLang4/1000017455.md).




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
ConnexionBase est une Connexion

// Création d'une sauvegarde planifiée toutes les 5 minutes 
// avec une sauvegarde différentielle toutes les minutes
hSvg est une hDescriptionSauvegarde
hSvg.Activé = Vrai
hSvg.AvecIndex = Vrai
hSvg.Description = "Sauvegarde planifiée toutes les N minutes avec " + ...
	"une sauvegarde différentielle toutes les minutes sur la base " + ...
	ConnexionBase.BaseDeDonnées + " créée le "+ ...
	DateVersChaîne(DateSys(), maskDateSystème) + " à " + ...
	HeureVersChaîne(HeureSys(), "HH:MM:SS:CC")
hSvg.Destination = "Sauvegarde_" + ConnexionBase.BaseDeDonnées
hSvg.LimiteNombreSauvegarde = 2
hSvg.Source = ConnexionBase.BaseDeDonnées
hSvg.PlanificationComplète.Mois = "*"
hSvg.PlanificationComplète.JourDuMois = "*"
// Définition de la planification
dhDateHeureServeur est une DateHeure = HInfoServeur(ConnexionBase, hInfoDate)
dhDateHeureServeur.Minute++
hSvg.PlanificationComplète.Heure = dhDateHeureServeur.Heure
hSvg.PlanificationComplète.Minute = dhDateHeureServeur.Minute
hSvg.PlanificationComplète.JourDeLaSemaine = "*"
hSvg.PlanificationComplète.JourDuMoisOuDeLaSemaine = Faux
hSvg.PlanificationDifférentielle.Mois = "*"
hSvg.PlanificationDifférentielle.JourDuMois = "*"
hSvg.PlanificationDifférentielle.Heure = "*"
hSvg.PlanificationDifférentielle.Minute = "*"
hSvg.PlanificationDifférentielle.JourDeLaSemaine = "*"
hSvg.PlanificationDifférentielle.JourDuMoisOuDeLaSemaine = Faux

// Ajout de la sauvegarde planifiée
SI HAjouteSauvegardePlanifiée(ConnexionBase, hSvg) = Faux ALORS
	Erreur("Echec de la création de la sauvegarde planifiée", ...
		HErreurInfo(hErrComplet))
	RETOUR
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HAjouteSauvegardePlanifiée(<Connexion> , <Sauvegarde planifiée>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la sauvegarde planifiée a été ajoutée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. 




**`<Connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion pour laquelle une sauvegarde planifiée doit être ajoutée. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).




**`<Sauvegarde planifiée> : (Variable de type hDescriptionSauvegarde)`**

Nom de la variable de type [hDescriptionSauvegarde](../WDLang4/1000017455.md) manipulée. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Caractéristiques de la sauvegarde :
<a name="caracteristiques_sauvegarde_ELTPARAGRAPHE000097"></a>

- Sauvegarde du contenu d'un serveur HFSQL : toutes les bases de données du serveur, plusieurs ou une seule base de données, un ou plusieurs fichiers de données. Cette sauvegarde peut être réalisée même si une ou plusieurs bases de données sont en cours d'utilisation.

- **La sauvegarde effectuée correspondra à l'état de la base de données au début de la sauvegarde : la base de données sauvegardée est cohérente.**Certaines opérations sont interdites pendant la sauvegarde : suppression de fichiers et de bases de données, mise à jour de procédures stockées.

- La description de la sauvegarde est réalisée grâce à la variable de type [hDescriptionSauvegarde](../WDLang4/1000017455.md). Il est possible de définir :

	- une procédure stockée à exécuter AVANT la sauvegarde. Cette procédure peut si nécessaire annuler la sauvegarde.

	- une procédure stockée à exécuter APRES la sauvegarde.  






<a name="NOTE0_2"></a>


### Droits nécessaires pour ajouter une sauvegarde planifiée
<a name="droits_necessaires_pour_ajouter_une_sauvegarde_planifiee_ELTPARAGRAPHE000114"></a>Pour ajouter une sauvegarde planifiée, l'utilisateur ou le groupe d'utilisateurs doit posséder : 

- le droit de faire des sauvegardes (constante *hDroitSauvegarde*). Ce droit s'applique aux serveurs et aux bases de données. Par exemple, pour faire une sauvegarde du serveur complet, il faut posséder le droit de faire des sauvegardes au niveau du serveur. 

- le droit de gérer des tâches (constante *hDroitGèreTâche*).




Pour savoir si un utilisateur ou un groupe d'utilisateurs possède ces droits, utilisez la fonction [HInfoDroitServeur](../WDLang4/3044322.md) ou [HInfoDroitDaseDeDonnées](../WDLang4/3044320.md).

Pour modifier les droits d'un utilisateur ou d'un groupe d'utilisateurs, utilisez la fonction [HModifieDroitServeur](../WDLang4/3044328.md) ou [HModifieDroitBaseDeDonnées](../WDLang4/3044326.md).
<a name="NOTE0_3"></a>


### Manipulations d'une sauvegarde planifiée
<a name="manipulations_une_sauvegarde_planifiee_ELTPARAGRAPHE000144"></a>Plusieurs fonctions permettent de manipuler une sauvegarde planifiée : 

- [HExécuteSauvegardePlanifiée](../WDLang4/1000018937.md) : Permet d'exécuter une sauvegarde planifiée. 

- [HListeSauvegardePlanifiée](../WDLang4/1000018868.md) : Permet de lister les sauvegardes planifiées. 

- [HModifieSauvegardePlanifiée](../WDLang4/1000018932.md) : Permet de modifier les caractéristiques d'une sauvegarde planifiée. 

- [HSupprimeSauvegardePlanifiée](../WDLang4/1000018870.md) : Permet de supprimer une sauvegarde planifiée. 




Il est également possible de : 

- restaurer une sauvegarde grâce à la fonction [HRestaureSauvegarde](../WDLang4/1000017230.md).

- supprimer physiquement une sauvegarde grâce à la fonction [HSupprimeSauvegarde](../WDLang4/1000017373.md).




<a name="XComposante"></a>

## Composante :
wd280hf.dll
