


## hPlanificationVueMatérialisée (Type de variable)

***En anglais : hScheduleMaterializedView***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **hPlanificationVueMatérialisée** permet de gérer une tâche de recalcul des données d'une vue matérialisée planifiée sur un serveur HFSQL par programmation. 
Les caractéristiques de cette tâche peuvent être définies et modifiées à l'aide de différentes propriétés WLangage.

**Remarques** : 

- Pour plus de détails sur les vues matérialisées, consultez [Vue matérialisée](../WDLang4/9000159.md). 

- Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Rafraîchir les vues matérialisées tous les samedi à 23H00
refreshView est une hPlanificationVueMatérialisée
refreshView.Description = "Recalcul des données des vues"

// Caractéristiques de la planification
refreshView.Planification.Mois = "*"
refreshView.Planification.JourDeLaSemaine = "samedi"
refreshView.Planification.Heure = "23"
refreshView.Planification.Minute = "0"

// Ajout des vues matérialisées à rafraîchir

// Syntaxe 1 : 
// Rafraîchit toutes les vues matérialisées de la base de données "MaBase"
refreshView.Vue[1] = "MaBase" 

// Syntaxe 2 : 
// Rafraîchit la vue "MaVue" de la base de données "MaBase"
refreshView.Vue[1] = "MaBase/MaVue" 

HAjoutePlanification(cnx, refreshView)
```

<a name="NOTE0"></a>

## Remarques
<a name="NOTE0_1"></a>


### Propriétés spécifiques à la description des variables de type hPlanificationVueMatérialisée
<a name="proprietes_specifiques_description_des_variables_type_hplanificationvuematerialisee_ELTPARAGRAPHE000036"></a>Les propriétés suivantes peuvent être utilisées pour manipuler une tâche de recalcul des données d'une vue matérialisée :

| Nom de la propriété | Type manipulé | Effet |
| --- | --- | --- |
| Activé | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> si la planification du recalcul des données est active,<br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.<br><br><br> |
| Description | Chaîne de caractères | Description associée à la tâche de recalcul des données d'une vue matérialisée. |
| Identifiant | Entier | Identifiant de la tâche de recalcul des données des vues matérialisées. <br><br>**Cette propriété est disponible en lecture seulement**. |
| Planification | Variable de type [hPlanification](../WDLang4/1000018853.md) | Caractéristiques de la planification à effectuer pour le recalcul du contenu des vues matérialisées. |
| Utilisateur | Chaîne de caractères | Utilisateur ayant créé la tâche de planification de recalcul des vues matérialisées.<br><br>Cette propriété est en lecture uniquement. |
| Vue | Tableau de chaînes | Liste des vues matérialisées dont la tâche recalculera le contenu. Ces vues ont été créés : <br><br>- sous l'éditeur d'analyses,<br><br>- grâce à l'instruction SQL ["CREATE MATERIALIZED VIEW"](../Editeurs/2034001.md). <br><br><br>Pour rafraîchir toutes les vues matérialisées de la base de données "MaBase", la syntaxe est la suivante : <br><br><pre><code>refreshView.Vue[1] = "MaBase"</code></pre><br><br><br>Pour rafraîchir la vue "MaVue" de la base de données "MaBase", la syntaxe est la suivante : <br><br><pre><code>refreshView.Vue[1] = "MaBase/MaVue"</code></pre><br> |




<a name="NOTE0_2"></a>


### Fonctions utilisant les variables de type hPlanificationVueMatérialisée : 
<a name="fonctions_utilisant_les_variables_type_hplanificationvuematerialisee_ELTPARAGRAPHE000114"></a>


|   |   |
| --- | --- |
| [HAjoutePlanification](../WDLang4/1000021447.md) | Crée une tâche planifiée sur un serveur HFSQL : <br><br>- procédure stockée, <br><br>- sauvegarde, <br><br>- optimisation, <br><br>- rafraîchissement d'une vue matérialisée.<br><br><br> |
| [HExécutePlanification](../WDLang4/1000021453.md) | Exécute immédiatement une tâche planifiée sans tenir compte de sa planification : <br><br>- procédure stockée, <br><br>- sauvegarde, <br><br>- optimisation, <br><br>- rafraîchissement d'une vue matérialisée.<br><br><br> |
| [HModifiePlanification](../WDLang4/1000021450.md) | Modifie une tâche planifiée sur un serveur HFSQL : <br><br>- procédure stockée, <br><br>- sauvegarde, <br><br>- optimisation, <br><br>- rafraîchissement d'une vue matérialisée.<br><br><br> |
| [HSupprimePlanification](../WDLang4/1000021448.md) | Supprime une tâche planifiée sur un serveur HFSQL : <br><br>- procédure stockée, <br><br>- sauvegarde, <br><br>- optimisation, <br><br>- rafraîchissement d'une vue matérialisée.<br><br><br> |






