


## HChangeLocalisation (Fonction)

***En anglais : HChangeLocation***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie le mode de recherche des fichiers de données physiques (.FIC, .NDX, ...). Par défaut, les fichiers de données physiques sont recherchés dans la bibliothèque de l'application puis sur le disque. 

Rappel : Les fichiers de données physiques peuvent se trouver :

- sur le disque (cas le plus courant).

- dans des bibliothèques WINDEV (fichiers WDL).

- dans l'exécutable.

- dans un composant.





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Recherche des fichiers de données dans les bibliothèques 4, 6 et 9
HChangeLocalisation(FichierClient, hWDL, 4, 6, 9)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HChangeLocalisation(<Fichier de données> , <Mode de recherche> [, <Paramètres>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.


![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Si la fonction **HChangeLocalisation** est utilisée, &lt;Résultat&gt; = <u><u><u><u>Vrai</u></u></u></u>, mais la fonction n'a aucun effet : les fichiers de données manipulés sont toujours sur le serveur.

**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données (défini dans l'analyse). 
Si ce paramètre est égal à "\*", le changement de mode de recherche sera appliqué pour tous les fichiers de données connus (décrits dans l'analyse). 
**Attention** : les fichiers de données concernés sont automatiquement fermés. 
Ce paramètre peut également correspondre au nom d'un [groupe de fichiers (ou perso-dossier) défini dans l'analyse](../Editeurs/2011003.md).

**`<Mode de recherche> : (Constante)`**

Paramètre le mode de recherche des fichiers de données :


|   |   |
| --- | --- |
| *hDisque* | Les fichiers de données sont recherchés uniquement sur le disque. C'est le cas le plus courant. |
| *hWDL*<br>(Valeur par défaut) | Les fichiers de données sont recherchés :<br><br>1. Dans la WDL principale; <br><br>2. Si &lt;Paramètres&gt; n'est pas précisé : Recherche les fichiers de données dans les WDL suivant leur ordre de chargement, puis sur le disque. <br>	Si &lt;Paramètres&gt; est spécifié : Recherche les fichiers de données dans la ou les WDL spécifiées, puis sur le disque. <br><br>3. Dans la WDL principale du composant. <br><br>4. Dans les WDL secondaires du composant selon leur ordre de chargement.<br><br><br> |



**`<Paramètres> : (Chaîne de caractères optionnelle)`**

Identifiant de la ou des WDL où la recherche doit être effectuée. Ces WDL doivent être chargées grâce à la fonction [ChargeWDL](../WDLang1/3013020.md) qui renvoie l'identifiant de la WDL.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Pourquoi mettre les fichiers de données dans une bibliothèque ?
<a name="pourquoi_mettre_les_fichiers_donnees_dans_une_bibliotheque_ELTPARAGRAPHE000136"></a>Placer les fichiers de données dans une bibliothèque présente les avantages suivants : 

- protection des données : les fichiers de données sont accessibles en lecture uniquement. 

- regroupement des données : tous les fichiers nécessaires à l'exécution sont regroupés dans un seul fichier. 




<a name="XComposante"></a>

## Composante :
wd280hf.dll
