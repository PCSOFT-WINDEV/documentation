
## Type Alias

***En anglais : Alias***
				

<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **Alias** permet de déclarer et de manipuler un alias logique sur un fichier de données ou une requête. 

**Rappel** : Un alias permet de : 

- travailler sur différents fichiers de données physiques ayant une même description logique. 

- avoir plusieurs "pointeurs" sur le même fichier pour faire des parcours imbriqués. 


Par exemple, pour un fichier de données : 

- la description du fichier de données est effectuée dans l'analyse. 

- une variable de type **Alias** permet de créer l'alias du fichier de données.




**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Création d'un alias du fichier de données "Commande"
CommandeVérification est un Alias de Commande
// "CommandeVerification" peut maintenant être utilisé dans les traitements.
// Il se comporte comme le fichier de données "Commande" décrit dans l'analyse.
// -------------------
// Par défaut, le nom du fichier physique associé à l'alias correspond au
// nom du fichier physique associé au fichier source 
// ---------------------------
// Pour utiliser un fichier sur une autre base de données ou dans un autre répertoire,
// il faut ensuite utiliser la fonction HChangeConnexion ou la fonction HChangeRep
```

<a name="XSYNTAXE"></a>


<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Suppression de l'alias
<a name="suppression_alias_ELTPARAGRAPHE000038"></a>L'alias est automatiquement détruit à la fin du traitement contenant sa déclaration.
<a name="NOTE0_2"></a>


### Fichier de données physique associé à un alias
<a name="fichier_donnees_physique_associe_alias_ELTPARAGRAPHE000045"></a>Par défaut, l'alias et le fichier source ont : 

- le même nom de fichier physique.

- la même connexion.

- le même mot de passe. 

- le même emplacement physique.  


Pour associer l'alias à un fichier de données physique de nom différent, il suffit d'utiliser la fonction [HChangeNom](../WDLang4/3044141.md). Si nécessaire : 

- la fonction [HChangeConnexion](../WDLang4/3044150.md) permet de redéfinir la connexion liée au fichier de données. 

- la fonction [HChangeRep](../WDLang4/3044168.md) permet de redéfinir le répertoire du fichier de données.







<a name="NOTE0_3"></a>


### Avantages par rapport à la fonction [HAlias](../WDLang4/3044176.md)
<a name="avantages_par_rapport_fonction_haliaswdlang43044176md_ELTPARAGRAPHE000072"></a>Les changements de répertoire, de connexion ou la spécification du mot de passe effectués avant la création de l'alias sont automatiquement pris en compte lors de la définition de l'alias. 
Par exemple : 

- Code utilisé avec la fonction [HAlias](../WDLang4/3044176.md) : 
	
	```wl
	HChangeRep(Mon_Fichier, "Nouveau chemin")
	HChangeConnexion(Mon_Fichier, MaConnexion)
	HPasse(Mon_Fichier, "mdp")
	
	HAlias(MonAlias, Mon_Fichier)
	HChangeNom(MonAlias, Mon_Fichier..NomPhysique)
	HChangeRep(MonAlias, "Nouveau chemin")
	HChangeConnexion(MonAlias, MaConnexion)
	HPasse(MonAlias, "mdp")
	```


- Code utilisé avec une variable de type **Alias** : 
	
	```wl
	HChangeRep(Mon_Fichier, "Nouveau chemin")
	HChangeConnexion(Mon_Fichier, MaConnexion)
	HPasse(Mon_Fichier, "mdp")
	MonAlias est un Alias de Mon_Fichier
	```










### Alias et requêtes
<a name="alias_requetes_ELTPARAGRAPHE000091"></a>Pour créer un alias sur une requête créée avec l'éditeur de requêtes, il suffit de :

- exécuter la requête initiale. 

- déclarer une variable de type **Alias** en spécifiant le nom de la requête et le nom de l'alias. 

- utiliser la fonction [HExécuteRequête](../WDLang4/3044080.md) avec la requête alias. L'alias est initialisé.




**Remarque** : Lors de la création de l'alias, la requête initiale doit avoir été exécutée.

Exemple :

```wl
SI HExécuteRequête(REQ_Requête1) = Faux ALORS
	Erreur(HErreur(hErrEnCours)) 
SINON
	HLitPremier(REQ_Requête1)
	Trace(REQ_Requête1.Ville)
	AliasRequête est un Alias de REQ_Requête1
	SI HExécuteRequête(AliasRequête) = Faux ALORS
		Erreur(HErreur(hErrEnCours)) 
	SINON
		POUR TOUT AliasRequête
			Trace(AliasRequête.Ville)
		FIN
	FIN
FIN
```

<a name="NOTE0_4"></a>


### Manipuler le fichier alias et ses rubriques
<a name="manipuler_fichier_alias_ses_rubriques_ELTPARAGRAPHE000110"></a>

- Sous l'éditeur de fenêtres ou de pages, les champs ne peuvent pas être directement associés à des rubriques des fichiers alias. Il est nécessaire :

	- soit d'affecter les champs un par un par programmation.

	- soit d'utiliser la fonction [ChampAlias](../WDLang1/3025016.md) ou la propriété [LiaisonFichier](../Proprietes/2510060.md) avant d'utiliser : 

		- la fonction [FichierVersEcran](../WDLang4/3044210.md).

		- la fonction [FichierVersPage](../WDLang4/3044148.md).




- Les fichiers alias peuvent être manipulés par les fonctions [HListeRubrique](../WDLang4/3044230.md) et [HListeClé](../WDLang4/3044060.md). Les fichiers alias peuvent être ré-indexés.

- Par défaut, le **mot de passe d'un fichier alias** est identique au mot de passe du fichier de données d'origine. Il est possible de modifier ce mot de passe grâce à la fonction [HPasse](../WDLang4/3044108.md). Le nom du fichier de données utilisé dans cette fonction correspond alors au nom de l'alias.

- La modification automatique des fichiers de données peut être appliquée aux fichiers alias.

- Les blocages des fichiers de données ou des enregistrements sont effectifs entre les alias d'une même instance d'une application.




