


## HLitPremier (Fonction)

***En anglais : HReadFirst***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Positionne sur le premier enregistrement d'un fichier de données en fonction d'une rubrique de parcours. L'enregistrement est lu et les variables HFSQL (par exemple Client.Nom, c'est-à-dire la rubrique *Nom* du fichier *Client*) sont mises à jour.

La lecture se fait de la plus petite à la plus grande valeur de la rubrique de parcours (consultez [les remarques](#NOTE0_1) pour plus de détails).

En général, la fonction **HLitPremier** permet de se positionner dans le fichier de données pour effectuer une boucle de lecture avec la fonction [HLitSuivant](../WDLang4/3044037.md).

Après l'exécution de la fonction **HLitPremier**, plusieurs cas peuvent se présenter :

- le fichier de données est vide ou il n'existe pas d'enregistrement correspondant au filtre (défini par [HFiltre](../WDLang4/3044100.md)) : aucune lecture n'est effectuée et la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u>Vrai</u></u></u>.

- la fonction tente de lire un enregistrement déjà bloqué en lecture : aucune lecture n'est effectuée, la fonction [HErreurBlocage](../WDLang4/3044099.md) renvoie <u><u><u>Vrai</u></u></u> et la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u>Vrai</u></u></u>.
	
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : La gestion des blocages n'est pas disponible sur les bases de données accédées par JDBC.




Cette fonction peut être utilisée indifféremment avec les fichiers de données, les vues HFSQL ou les requêtes.

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
HLitPremier(Client, Nom)
TANTQUE HEnDehors(Client) = Faux
	// Traitement de l'enregistrement
	HLitSuivant(Client, Nom)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HLitPremier([<Fichier de données> [, <Rubrique de parcours>] [, <Options>]])`
---

**`<Résultat> : (Booléen)`**

Correspond à : 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur. Dans ce cas, la fonction [HErreur](../WDLang4/3044088.md) renvoie un entier différent de 0. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'obtenir plus de détails sur l'erreur. L'enregistrement n'est pas lu. 

- la valeur de la fonction [HTrouve](../WDLang4/3044104.md) dans les autres cas (l'enregistrement peut être lu, même si &lt;Résultat&gt; renvoie <u><u><u><u>Faux</u></u></u></u>). 




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données, de la vue HFSQL ou de la requête manipulé. Si ce paramètre correspond à une chaîne vide (""), la fonction **HLitPremier** manipule le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Rubrique de parcours> : (Chaîne de caractères optionnelle)`**

Nom de la rubrique utilisée pour parcourir le fichier de données ou la vue (ce paramètre n'est pas pris en compte pour les requêtes). Si ce nom n'est pas spécifié, la fonction **HLitPremier** va utiliser :

- ***Dans le cas d'un fichier de données*** : la dernière rubrique de parcours utilisée sur ce fichier par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H). Si cette rubrique n'existe pas, la meilleure rubrique de parcours est automatiquement utilisée. 

- ***Dans le cas d'une requête*** : le ORDER BY de la requête si il existe, sinon selon la dernière rubrique utilisée. 

- ***Dans le cas d'une vue*** : la rubrique de tri de la vue (si elle existe), sinon sur la dernière rubrique utilisée.




**`<Options> : (Constante optionnelle)`**

Permet de paramétrer :

- le blocage réalisé sur l'enregistrement lu par la fonction **HLitPremier**

- la prise en compte ou non du filtre précédemment défini.





|   |   |
| --- | --- |
| *hBlocageEcriture* | Blocage en écriture : l'enregistrement en cours de lecture pourra être lu par une autre application mais ne pourra pas être modifié par une autre application.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hBlocageLectureEcriture* | Blocage en lecture/écriture : l'enregistrement en cours de lecture ne pourra ni être lu ni être modifié par une autre application.<br>![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png) Blocage en écriture seulement. Fonctionnement équivalent à la constante *hBlocageEcriture*.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hBlocageNon* | Aucun blocage : l'enregistrement pourra être lu ou modifié par une autre application pendant la lecture.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hForwardOnly* | ![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Constante utilisable uniquement avec les Connecteurs Natifs.<br><br>Permet d'accélérer le parcours des données lors d'un parcours simple qui n'utilise pas les fonctionnalités suivantes :<br><br>- Lecture de l'enregistrement précédent.<br><br>- Modification d'un enregistrement.<br><br>- Sauvegarde de position.<br><br><br>Si une de ces fonctionnalités est utilisée, le résultat peut être différent de celui attendu.<br><br>Cette constante peut par exemple être utilisée lors d'un parcours permettant de remplir un champ Table par programmation. |
| *hRespecteFiltre* | Le parcours prendra en compte le filtre mis en place avec la fonction [HFiltre](../WDLang4/3044100.md), même si la clé de parcours utilisée n'est pas optimisée pour le filtre. **Rappel** : la fonction [HFiltre](../WDLang4/3044100.md) renvoie la clé de parcours optimisée pour le filtre.<br>**Attention** : dans ce cas, sur des fichiers de données de taille importante, des problèmes de performances peuvent survenir.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante ne peut pas être utilisée. |
| *hSansRafraîchir* | ![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) La fonction **HLitPremier** ne rafraîchit pas le contenu de la table ou de la requête. Dans la mesure du possible, la requête n'est pas ré-exécutée. Toutes les positions sauvegardées sont conservées. |





![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Si le provider OLE DB ou le Connecteur Natif utilisé ne gère pas les blocages, les options de blocage seront sans effet.![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png) Le mode de blocage spécifié avec la fonction **HLitPremier** restera effectif lors des appels aux fonctions [HLitPrécédent](../WDLang4/3044048.md) et [HLitSuivant](../WDLang4/3044037.md).

Pour modifier le mode de blocage, il est nécessaire d'utiliser :

- soit les fonctions [HLitRecherchePremier](../WDLang4/3044036.md) ou [HLitRechercheDernier](../WDLang4/3044034.md),

- soit les fonctions [HLitDernier](../WDLang4/3044140.md) ou **HLitPremier**.

- soit les fonctions [HBloqueNumEnr](../WDLang4/3044152.md) ou [HDébloqueNumEnr](../WDLang4/3044194.md).


![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Pour le Connecteur Natif Oracle, il est possible de spécifier un mode de blocage différent pour chaque enregistrement. Cependant, si une transaction a été démarrée à l'aide de la fonction [SQLTransaction](../WDLang4/3072029.md) avant de procéder au blocage, le blocage ne sera relâché qu'à la fin de la transaction (fonction [SQLTransaction](../WDLang4/3072029.md) avec la constante *sqlFin* ou *sqlAnnule*).![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Les options de blocage ne sont pas prises en compte. Utilisez des fonctions de lecture bloquantes (fonction **HLitPremierBloque**) conservées par compatibilité.![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : La gestion des blocages n'est pas disponible sur les bases de données accédées par JDBC.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Rubrique de parcours
<a name="rubrique_parcours_ELTPARAGRAPHE000325"></a>Si la rubrique de parcours utilisée est une clé, la fonction **HLitPremier** lit l'enregistrement pour lequel la valeur de la clé est la plus petite. L'ordre de tri pris en compte est l'ordre de tri spécifié dans l'analyse pour cette clé. En cas de doublons, **HLitPremier** lit le premier enregistrement "doublon" selon l'ordre des numéros d'enregistrement.

Si la rubrique de parcours n'est pas une clé, la fonction **HLitPremier** lit le premier enregistrement actif. En cas de parcours du fichier, les enregistrements seront triés selon leur numéro d'enregistrement. 
Dans ce cas, la rubrique de parcours sélectionnée apparaîtra en rouge sous l'éditeur de code et un warning sera affiché dans le [volet "Code"](../Editeurs/2027009.md).

**Remarque** : La [complétion automatique](../Editeurs/2013001.md) propose uniquement les rubriques clés.
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Parcours des requêtes
<a name="parcours_des_requetes_ELTPARAGRAPHE000357"></a>Par défaut, la fonction **HLitPremier** ré-exécute la requête pour rafraîchir le résultat de la requête. Il est conseillé d'utiliser la constante *hSansRafraîchir* pour éviter la ré-exécution de la requête.

**Parcours d'une requête exécutée avec la constante hRequêteSansCorrection** :

Pour parcourir les enregistrements dans l'ordre renvoyé par la base de données, il n'est pas nécessaire de préciser de rubrique de parcours. Exemple :

```wl
HExécuteRequête(MaRequête, hRequêteSansCorrection)
...
HLitPremier(MaRequête, hSansRafraîchir)
```
Si une rubrique de parcours est spécifiée, le résultat de la requête est intégralement récupéré et indexé. Le parcours est alors réalisé sur la rubrique spécifiée. Le tri initial de la requête (spécifié par ORDER BY) est ignoré. L'index créé (au format HFSQL) est sensible à la casse, sensible à la ponctuation, sensible aux accents et ascendant.

Exemple :

```wl
HExécuteRequête(MaRequête, hRequêteSansCorrection)
...
HLitPremier(MaRequête, MaRubrique, hSansRafraîchir)
```
Les recherches utilisent l'index créé sur le résultat de la requête.
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Langage Externe](https://doc.pcsoft.fr/ext/images/fr/LE.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Blocages
<a name="blocages_ELTPARAGRAPHE000391"></a>Par défaut (paramètre &lt;Option&gt; non spécifié), aucun blocage de l'enregistrement n'est réalisé.

Si un blocage est demandé (constantes *hBlocageEcriture* ou *hBlocageLectureEcriture*), la lecture de l'enregistrement sera réalisée uniquement si cet enregistrement n'est pas déjà bloqué.

![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Si le provider OLE DB ou le Connecteur Natif utilisé ne gère pas les blocages, les options de blocage seront sans effet.
<a name="NOTE0_4"></a>


### Mémos
<a name="memos_ELTPARAGRAPHE000406"></a>Les mémos associés à l'enregistrement peuvent être automatiquement lus ou non lors de la lecture de l'enregistrement. La fonction [HGèreMemo](../WDLang4/3044139.md) permet de personnaliser cette lecture automatique.

Si les mémos sont gérés, lorsque l'enregistrement est lu, les mémos texte associés sont également lus. Les mémos binaires ne sont lus que lorsqu'ils sont utilisés explicitement (fonction [HExtraitMémo](../WDLang4/3044072.md)).
<a name="NOTE0_5"></a>


### Mot de passe
<a name="mot_passe_ELTPARAGRAPHE000423"></a>Si la fonction **HLitPremier** est la première fonction manipulant le fichier de données spécifié, la vérification du mot de passe est effectuée lors de l'ouverture du fichier de données. Si le mot de passe est incorrect, la fonction [HErreurMotDePasse](../WDLang4/3044082.md) renvoie <u><u><u><u>Vrai</u></u></u></u> et la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u><u>Vrai</u></u></u></u>.
<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Connecteur Natif XML
<a name="connecteur_natif_xml_ELTPARAGRAPHE000451"></a>Le comportement de la fonction **HLitPremier** est lié aux fonctions [HActiveFiltreAuto](../WDLang4/3044297.md)/[HDésactiveFiltreAuto](../WDLang4/3044298.md).

Par défaut, la fonction [HActiveFiltreAuto](../WDLang4/3044297.md) est activée.

Ainsi, pour lire le contenu d'un document XML, il suffit de lire le contenu du fichier principal (le parent) puis des fichiers liés (les fils).

Par défaut, lors de la lecture dans un fichier de données, un filtre est automatiquement réalisé sur les fichiers de données reliés pour lire uniquement les enregistrements correspondant au fichier principal.

Par exemple :<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=XML_2.GIF)
Lors du parcours du fichier Person, il est possible de connaître l'email de cette personne.

Pour cela, il suffit de se positionner sur le fichier "Person", puis d'utiliser la fonction **HLitPremier** sur le fichier "email".

Dans ce cas, l'enregistrement lu dans le fichier "email" correspondra au premier email associé à l'enregistrement en cours dans le fichier "Person".

Si ce mécanisme est désactivé (fonction [HDésactiveFiltreAuto](../WDLang4/3044298.md)), l'enregistrement lu dans le fichier "email" correspondra au premier enregistrement du fichier email (et non au fils de l'enregistrement lu dans le fichier "Person").
<a name="NOTE0_7"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000494"></a>

- Le numéro de l'enregistrement en cours est connu avec la fonction [HNumEnr](../WDLang4/3044063.md).

- La fonction [HChangeClé](../WDLang4/3044151.md) permet de modifier la clé de parcours, tout en restant positionné sur l'enregistrement en cours.

- Pour optimiser le temps des premiers parcours d'un fichier, utilisez la fonction [HOptimise](../WDLang4/3044005.md) sur ce fichier de données.

- Cette fonction remplace les fonctions **HLitPremierBloque** et **HLitPremierSansBloquer**, conservées par compatibilité avec WINDEV 5.5.




<a name="XComposante"></a>

## Composante :
wd280hf.dll
