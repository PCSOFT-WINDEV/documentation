
## HSurAppelServeur (Fonction)

***En anglais : HOnServerCall***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Personnalise la gestion de l'affichage d'un message sur le poste Client, et la gestion de la déconnexion d'un poste Client.

**Rappel** : L'envoi d'un message au poste client est réalisé avec la fonction [HEnvoieMessageVersClient](../WDLang4/3044346.md). La déconnexion d'un poste Client est effectuée par la fonction [HDéconnecteClient](../WDLang4/3044339.md).






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Personnalisation des messages Client
// La procédure MessageClient est appelée
// en cas d'utilisation de la fonction HEnvoieMessageVersClient
HSurAppelServeur(hMessage, "MessageClient")
```

```wl
// Procédure MessageClient
PROCEDURE MessageClient(Type, MessageAAfficher, DuréeAffichageMessage)
SI Type = hMessage ALORS
	Ouvre(FEN_MaFen, MessageAAfficher)
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HSurAppelServeur(<Type de message> [, <Procédure WLangage> [, <Options>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été effectuée sans problème, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [HErreur](../WDLang4/3044088.md) permet d'obtenir plus d'informations sur le problème rencontré.




**`<Type de message> : (Constante de type Entier)`**

Type de message à paramétrer.


|   |   |
| --- | --- |
| *hDéconnexion* | Paramétrage du message de déconnexion. |
| *hMessage* | Paramétrage du message d'information |



**`<Procédure WLangage> : (Nom de procédure)`**

Procédure à appeler lorsque un message de type &lt;Type de message&gt; apparaît.

Cette procédure est du type : 

```txt
PROCEDURE <Nom de la procédure>(<Type message>, <Message>, <Durée affichage>)
```


Si ce paramètre n'est pas spécifié, le message est affiché dans la fenêtre par défaut. 
Si ce paramètre est égal à une chaîne vide (""), la gestion automatique sera désactivée. Dans le cas d'une déconnexion, la connexion est fermée par le serveur. Une erreur sera alors affichée lors du prochain accès à un fichier de données.

**`<Options> : (Constante de type Entier)`**

Options d'exécution de la procédure : 


|   |   |
| --- | --- |
| *hThreadSecondaire* | La procédure est exécutée dans un thread secondaire. |


Si cette option n'est pas spécifiée, la procédure est exécutée dans le thread principal. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Personnalisation de l'affichage des messages
<a name="personnalisation_affichage_des_messages_ELTPARAGRAPHE000130"></a>Dans la procédure WLangage, toutes les actions sont possibles.

Si le message est de type déconnexion, la déconnexion sera effectuée au bout de la durée indiquée dans la fonction [HDéconnecteClient](../WDLang4/3044339.md) (quelles que soient les actions effectuées dans la procédure).


<a name="NOTE0_2"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000143"></a>

- La fonction **HSurAppelServeur** doit être utilisée dans le thread principal.

- La fonction **HSurAppelServeur** est globale à toute l'application, y compris les composants exécutés. Si la fonction **HSurAppelServeur** est utilisée dans un composant, elle sera active pour l'application hôte (c'est le dernier appel à la fonction **HSurAppelServeur** qui est pris en compte).

- La fonction **HSurAppelServeur** peut être utilisée dans un service Windows.






<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
