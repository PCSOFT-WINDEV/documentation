


## &lt;Source&gt;.ImporteHF55 (Fonction)

***En anglais : &lt;Source&gt;.ImportHF55***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Importe un fichier de données Hyper File 5.5 dans un fichier de données au format HFSQL Classic.

- Le fichier de données au format Hyper File 5.5 doit être décrit sous l'éditeur d'analyses.

- Le fichier de données au format HFSQL Classic doit être décrit sous l'éditeur d'analyses ou être déclaré par les fonctions [&lt;Source&gt;.Déclare](../WDLang4/1000024213.md), [&lt;Source&gt;.DéclareExterne](../WDLang4/1000024214.md) ou [&lt;Source&gt;.DécritFichier](../WDLang4/1000024215.md).




**Remarques** : 

- Les deux fichiers de données peuvent avoir des structures différentes.

- Cette fonction n'est pas disponible lors de l'utilisation d'un exécutable autonome. 



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Importe le nom et l'adresse des clients,
// on ignore les autres rubriques
SI PAS Client.ImporteHF55("Client", "C:\UnExemple\CLIENT.FIC", ...
			"", "C:\UnExemple\UnExemple.wdd", "", "NomComplet,Adresse", ...
			"Nom,Adr", hValDéfaut + hImpConversion) ALORS
		  Erreur("Importation impossible")
SINON
	// Traitement
	...
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Importation dans un fichier de données de même structure

`<Résultat> = <Source>.ImporteHF55(<Fichier HF55> , <Chemin complet du fichier HF55> , <Mot de passe du fichier HF55> , <Chemin complet du fichier WDD 55> , <Mot de passe du fichier WDD 55> [, <Options> [, <Jauge>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier le problème rencontré.




**`<Source> : (Type correspondant à la source spécifiée)`**

Nom logique du fichier de données au format HFSQL Classic dans lequel l'importation doit être réalisée.

**`<Fichier HF55> : (Chaîne de caractères)`**

Nom logique du fichier de données au format Hyper File 5.5, décrit dans l'analyse WINDEV 5.5 (fichier .WDD) et contenant les données à importer.

**`<Chemin complet du fichier HF55> : (Chaîne de caractères)`**

Chemin d'accès complet au fichier de données Hyper File 5.5 à importer.

**`<Mot de passe du fichier HF55> : (Chaîne de caractères)`**

Mot de passe associé au fichier de données à importer. Ce mot de passe sera utilisé pour décrypter les données du fichier de données. Si aucun mot de passe n'a été défini, utilisez une chaîne vide ("").

**`<Chemin complet du fichier WDD 55> : (Chaîne de caractères)`**

Chemin d'accès au fichier .WDD de l'analyse au format Hyper File 5.5. Cette analyse contient la description (ou structure) du fichier de données à importer. Tous les formats d'analyse reconnus par Hyper File 5.5 peuvent être utilisés (WINDEV 5.5B, 5.5, 5.0 et 4.1).

**`<Mot de passe du fichier WDD 55> : (Chaîne de caractères)`**

Mot de passe associé à l'analyse contenant le fichier de données à importer. Si aucun mot de passe n'a été défini, utilisez une chaîne vide ("").

**`<Options> : (Constante ou combinaison de constantes de type Entier (optionnel))`**

Type d'importation à effectuer : 



|   |   |
| --- | --- |
| *hCopieIDAuto* | L'identifiant automatique est recopié. Il n'est pas recalculé.<br>Si le fichier de données HFSQL Classic contient un identifiant automatique alors que le fichier de données Hyper File 5.5 n'en contient pas, l'identifiant automatique est mis à 0 dans le fichier de données HFSQL Classic. |
| *hImpConversion* | Les rubriques associées n'ont pas le même type ou la même taille : les données extraites du fichier de données importé sont automatiquement converties ou tronquées. |
| *hImpCréation* | Si le fichier de données d'importation (HFSQL Classic) existe, il est écrasé. |
| *hImpIgnoreRubrique* | Les rubriques du fichier de données d'importation (HFSQL Classic) n'ayant pas de rubriques associées dans le fichier de données importé (Hyper File 5.5) sont remplies avec leur valeur par défaut.<br>Les rubriques du fichier de données importé (Hyper File 5.5) n'ayant pas de correspondance dans le fichier de données d'importation sont ignorées. |
| *hImpInterruptible* | L'importation peut être interrompue avec la touche Echap du clavier. Si l'importation est interrompue, les enregistrements importés sont conservés dans le fichier de données. Une ré-indexation (non interruptible) est automatiquement réalisée si nécessaire. |
| *hImpNormal*<br>(valeur par défaut) | Ce mode d'importation évite tout risque de perte de données. L'importation n'est pas effectuée et une erreur est générée dans les cas suivants :<br><br>- rubriques présentes dans le fichier de données Hyper File 5.5 sans correspondance dans le fichier de données HFSQL Classic.<br><br>- rubriques associées dans les deux fichiers de données avec une taille et/ou un format différent.<br><br><br>Si le fichier de données d'importation (HFSQL Classic) existe déjà, il est complété avec les données importées, sinon le fichier de données est créé. <br>Pas de gestion d'intégrité ni de gestion de doublons.<br>Les rubriques non importées prennent la valeur de l'enregistrement en cours.<br>Les identifiants automatiques sont recalculés. |
| *hImpSansEspace* | Les espaces en fin de chaîne sont automatiquement supprimés pendant l'importation. |
| *hImpTestDoublon* | Teste les doublons lors de l'importation |
| *hImpTestIntégrité* | Teste l'intégrité lors de l'importation |
| *hValDéfaut* | Pour les rubriques non importées, les valeurs de l'enregistrement en cours (HFSQL Classic) sont réinitialisées avec leur valeur par défaut. |



**`<Jauge> : (Nom de champ ou nom de fenêtre optionnel)`**



- Nom de la fenêtre dans laquelle la progression de l'importation doit être affichée. 

- Nom du champ de type Jauge dans lequel la progression de l'importation doit être affichée.





<a name="SYNTAXE2"></a>

### Importation dans un fichier de structure différente

`<Résultat> = <Source>.ImporteHF55(<Fichier HF55> , <Chemin complet du fichier HF55> , <Mot de passe du fichier HF55> , <Chemin complet du fichier WDD 55> , <Mot de passe du fichier WDD 55> , <Liste des rubriques destination> , <Liste des rubriques source> [, <Options> [, <Jauge>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier le problème rencontré.




**`<Source> : (Type correspondant à la source spécifiée)`**

Nom logique du fichier de données au format HFSQL Classic dans lequel l'importation doit être réalisée.

**`<Fichier HF55> : (Chaîne de caractères)`**

Nom logique du fichier de données au format Hyper File 5.5, décrit dans l'analyse WINDEV 5.5 (fichier .WDD) et contenant les données à importer.

**`<Chemin complet du fichier HF55> : (Chaîne de caractères)`**

Chemin d'accès complet au fichier de données Hyper File 5.5 à importer.

**`<Mot de passe du fichier HF55> : (Chaîne de caractères)`**

Mot de passe associé au fichier de données à importer. Ce mot de passe sera utilisé pour décrypter les données du fichier de données. Si aucun mot de passe n'a été défini, utilisez une chaîne vide ("").

**`<Chemin complet du fichier WDD 55> : (Chaîne de caractères)`**

Chemin d'accès au fichier .WDD de l'analyse au format Hyper File 5.5. Cette analyse contient la description (ou structure) du fichier de données à importer. Tous les formats d'analyse reconnus par Hyper File 5.5 peuvent être utilisés (WINDEV 5.5B, 5.5, 5.0 et 4.1).

**`<Mot de passe du fichier WDD 55> : (Chaîne de caractères)`**

Mot de passe associé à l'analyse contenant le fichier de données à importer. Si aucun mot de passe n'a été défini, utilisez une chaîne vide ("").

**`<Liste des rubriques destination> : (Chaîne de caractères)`**

Liste des noms des rubriques du fichier de données HFSQL Classic. Les noms peuvent être délimités par des simples quotes et sont séparés par des virgules ou RC. 
Remarque : les noms correspondant à des clés composées sont interdits : les valeurs des clés composées seront re-calculées automatiquement lors de l'ajout de l'enregistrement dans le fichier de données.

**`<Liste des rubriques source> : (Chaîne de caractères)`**

Liste des noms des rubriques du fichier de données Hyper File 5.5. Les noms peuvent être délimités par des simples quotes et sont séparés par des virgules ou RC. 
Remarque : les noms correspondant à des clés composées sont autorisés. Le nombre de rubriques doit correspondre au nombre de rubriques spécifié dans le paramètre &lt;Liste des rubriques Destination&gt;.

**`<Options> : (Constante ou combinaison de constantes de type Entier (optionnel))`**

Type d'importation à effectuer :


|   |   |
| --- | --- |
| *hCopieIDAuto* | L'identifiant automatique est recopié. Il n'est pas recalculé.<br>Si le fichier de données HFSQL Classic contient un identifiant automatique alors que le fichier de données Hyper File 5.5 n'en contient pas, l'identifiant automatique est mis à 0 dans le fichier de données HFSQL Classic. |
| *hImpConversion* | Les rubriques associées n'ont pas le même type ou la même taille : les données extraites du fichier de données importé sont automatiquement converties ou tronquées. |
| *hImpCréation* | Si le fichier de données d'importation (HFSQL Classic) existe, il est écrasé. |
| *hImpIgnoreRubrique* | Les rubriques du fichier de données d'importation (HFSQL Classic) n'ayant pas de rubriques associées dans le fichier de données importé (Hyper File 5.5) sont remplies avec leur valeur par défaut.<br>Les rubriques du fichier de données importé (Hyper File 5.5) n'ayant pas de correspondance dans le fichier de données d'importation sont ignorées. |
| *hImpInterruptible* | L'importation peut être interrompue avec la touche ESC/ECHAP. Si l'importation est interrompue, les enregistrements importés sont conservés dans le fichier de données. Une ré-indexation (non interruptible) est automatiquement réalisée si nécessaire. |
| *hImpNormal*<br>(valeur par défaut) | Ce mode d'importation évite tout risque de perte de données. L'importation n'est pas effectuée et une erreur est générée dans les cas suivants :<br><br>- rubriques présentes dans le fichier de données Hyper File 5.5 sans correspondance dans le fichier de données HFSQL Classic.<br><br>- rubriques associées dans les deux fichiers de données avec une taille et/ou un format différent.<br><br><br>Si le fichier de données d'importation (HFSQL Classic) existe déjà, il est complété avec les données importées, sinon le fichier de données est créé.<br>Pas de gestion d'intégrité ni de gestion de doublons.<br>Les rubriques non importées prennent la valeur de l'enregistrement en cours.<br>Les identifiants automatiques sont recalculés. |
| *hImpSansEspace* | Les espaces en fin de chaîne sont automatiquement supprimés pendant l'importation. |
| *hImpTestDoublon* | Teste les doublons lors de l'importation. |
| *hImpTestIntégrité* | Teste l'intégrité lors de l'importation. |
| *hValDéfaut* | Pour les rubriques non importées, les valeurs de l'enregistrement en cours (HFSQL Classic) sont réinitialisées avec leur valeur par défaut. |



**`<Jauge> : (Nom de champ ou nom de fenêtre optionnel)`**



- Nom de la fenêtre dans laquelle la progression de l'importation doit être affichée. 

- Nom du champ de type Jauge dans lequel la progression de l'importation doit être affichée.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Fichier de données crypté
<a name="fichier_donnees_crypte_ELTPARAGRAPHE000427"></a>Si le fichier de données au format HFSQL Classic dans lequel l'importation doit être effectuée est crypté, il est nécessaire de préciser le mot de passe avant l'utilisation de la fonction **&lt;Source&gt;.ImporteHF55** : utilisez la fonction [&lt;Source&gt;.MotDePasse](../WDLang4/1000025044.md).
<a name="NOTE0_2"></a>


### HFSQL Client/Serveur
<a name="hfsql_clientserveur_ELTPARAGRAPHE000445"></a>Si l'importation doit être effectuée dans un fichier de données HFSQL Client/Serveur, il est nécessaire de préciser la connexion avant d'utiliser la fonction **&lt;Source&gt;.ImporteHF55**. Par exemple : 

```txt
cnxHFCS est une Connexion
MonFichierCS.ChangeConnexion(cnxHFCS)
MonFichierCS.ImporteHF55(MonFichier55, ...)
```


<a name="XComposante"></a>

## Composante :
wd280hf.dll
