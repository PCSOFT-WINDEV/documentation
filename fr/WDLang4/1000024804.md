
## Procédure WLangage appelée par la fonction HSurveille



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Procédure WLangage (également appelée "callback") appelée par la fonction [HSurveille](../WDLang4/1000022407.md) lors d'un changement sur le fichier de données spécifié.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Lance la surveillance du fichier de données Commande
// La procédure TraiteCommande est appelée pour tout ajout d'enregistrement dans le fichier de données
HSurveille(Commande, TraiteCommande, hNumEnrTous, hsAjout)

PROCEDURE TraiteCommande(NomFic, NumEnreg, Action)
SI ETBinaire(nAction, hsAjout) = hsAjout ALORS
	Trace("Un ajout a été effectué dans le fichier de données : " + NomFic)
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`HSurveille_Callback(<Fichier de données modifié> , <Numéro de l'enregistrement> , <Action>)`
---

**`<Fichier de données modifié> : (Chaîne de caractères)`**

Nom du fichier de données HFSQL modifié. 

**`<Numéro de l'enregistrement> : (Entier)`**

Numéro de l'enregistrement modifié (équivalent du numéro renvoyé par la fonction [HNumEnr](../WDLang4/3044063.md)). 

**`<Action> : (Constante de type Entier)`**

Action qui a déclenché la procédure. Les valeurs possibles sont : 



|   |   |
| --- | --- |
| *hsAjout* | Procédure lancée suite à l'ajout d'un enregistrement dans le fichier de données. |
| *hsModification* | Procédure lancée suite à la modification d'un enregistrement dans le fichier de données. |
| *hsRaye* | Procédure lancée suite au rayage d'un enregistrement dans le fichier de données. |
| *hsSuppression* | Procédure lancée suite à la suppression d'un enregistrement dans le fichier de données. |


**Attention** : Si un traitement effectue l'ajout d'un enregistrement suivi immédiatement d'une modification de cet enregistrement, un seul appel est fait à la fonction [HSurveille](../WDLang4/1000022407.md) avec une combinaison des constantes *hsAjout* et *hsModification*.
Pour identifier ces actions dans la procédure WLangage, il est nécessaire d'utiliser la fonction ETBinaire. Par exemple : 

```wl
SI ETBinaire(nAction, hsAjout) = hsAjout ALORS ...
```




<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Procédure WLangage exécutée dans le thread principal
<a name="procedure_wlangage_executee_dans_thread_principal_ELTPARAGRAPHE000074"></a>Cette procédure WLangage est appelée par défaut dans le thread principal de l'application, avec le contexte HFSQL correspondant à la procédure :

- Si la procédure est une procédure locale d'une fenêtre utilisant un contexte indépendant, le contexte utilisé sera celui de la fenêtre. 

- Si la procédure appartient à un composant utilisant un contexte indépendant, le contexte utilisé sera celui du composant.





|   |
| --- |
| **Attention** :<br>La procédure associée à la fonction [HSurveille](../WDLang4/1000022407.md) peut être appelée à n'importe quel moment dans l'application.<br>Si la procédure effectue des parcours HFSQL ou des déplacements dans des fichiers de données, cela impactera l'application (comme les timers).<br>Il peut donc être nécessaire d'utiliser les fonctions [HSauvePosition](../WDLang4/3044136.md) et [HRetourPosition](../WDLang4/3044137.md) pour sauvegarder les contextes des fichiers manipulés.<br><br>Il ne faut pas utiliser la fonction [Multitâche](../WDLang1/3015004.md) dans le code de la procédure. |




### Procédure WLangage exécutée dans un thread secondaire
<a name="procedure_wlangage_executee_dans_thread_secondaire_ELTPARAGRAPHE000235"></a>Si la procédure WLangage est appelée dans un thread secondaire : 

- une copie "légère" du contexte HFSQL est effectuée au moment du premier appel à la fonction **Procédure WLangage appelée par la fonction HSurveille**. Seuls les répertoires où se trouvent les fichiers de données en HFSQL Classic et/ou les connexions en HFSQL Client/Serveur sont mémorisés.

- il est interdit de manipuler l'UI (fenêtres, champs, ...) dans le thread secondaire. Lorsqu'un thread secondaire doit interagir avec l'utilisateur ou mettre à jour l'UI, il doit utiliser un traitement lancé depuis le thread principal. Ce traitement peut correspondre à :

	- une procédure globale du projet ou une procédure locale (d'une fenêtre, ...) appelée par la fonction [ExécuteThreadPrincipal](../WDLang1/1000019862.md),

	- l'événement "Demande de mise à jour de l'affichage" d'une fenêtre exécuté grâce à la fonction [DemandeMiseAJourUI](../WDLang1/1000023899.md).







Pour plus de détails sur cette procédure, consultez [Paramètres de la procédure utilisée par la fonction Procédure WLangage appelée par la fonction HSurveille](../WDLang4/1000024804.md).





<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280hf.dll
