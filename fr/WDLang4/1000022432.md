


## MongoAjoute (Fonction)

***En anglais : MongoAdd***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute un ou plusieurs documents dans une collection d'une base MongoDB.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
cnxMDB est une mongoConnexion

MongoAjoute(cnxMDB.BaseDeDonnées["CRM"].Collection["MaCollection"], ...
	 "{ ""nom"" :""paul"", ""taille"" : 182 }")
```


<a name="Exemple2"></a>

```wl
gclCollection est un mongoCollection

// Variable contenant les documents à ajouter dans la base
tabDocument est un tableau de chaînes

// Variables temporaires
stContact est un STInfoContact
sBufferJSON est une chaîne

// Construction du tableau des documents
stContact = [ "MOITOU", "Elodie", "+33.467032032", "e.moitou@windev.com" ]
Sérialise(stContact, sBufferJSON, psdJSON)
Ajoute(tabDocument, sBufferJSON)

stContact = [ "SMITH", "Robert", "+33.467032032", "r.smith@windev.com" ]
Sérialise(stContact, sBufferJSON, psdJSON)
Ajoute(tabDocument, sBufferJSON)

stContact = [ "HUDSON", "Jade", "+33.467032032", "j.hudson@windev.com" ]
Sérialise(stContact, sBufferJSON, psdJSON)
Ajoute(tabDocument, sBufferJSON)

// Ajout des trois contacts en un seul appel
MongoAjoute(gclCollection, tabDocument)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Ajouter un document dans une collection

`<Résultat> = MongoAjoute(<Collection> , <Document> [, <Option>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée,

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [ErreurInfo](../WDLang1/3013008.md) permet d'identifier l'erreur.




**`<Collection> : (Variable de type mongoCollection)`**

Nom de la variable de type [mongoCollection](../WDLang4/1000022411.md) représentant la collection dans laquelle le document doit être ajouté. 

**`<Document> : (Type correspondant au document)`**

Document à ajouter à la collection. Ce document peut correspondre : 

- à un document au format JSON. Dans ce cas, ce paramètre correspond à une chaîne de caractères. 

- à un document au format BSON. Dans ce cas, ce paramètre correspond à un buffer. 

- à un variant. 




**`<Option> : (Constante optionnelle de type Entier)`**

Option d'ajout du document : 


|   |   |
| --- | --- |
| *mongoSansValidation* | Permet d'ajouter le document sans effectuer de vérification de la structure du document. |




<a name="SYNTAXE2"></a>

### Ajouter une liste de documents dans une collection

`<Résultat> = MongoAjoute(<Collection> , <Liste de documents> [, <Options>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée,

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [ErreurInfo](../WDLang1/3013008.md) permet d'identifier l'erreur.




**`<Collection> : (Variable de type mongoCollection)`**

Nom de la variable de type [mongoCollection](../WDLang4/1000022411.md) représentant la collection dans laquelle les documents doivent être ajoutés. 

**`<Liste de documents> : (Tableau)`**

Tableau des documents à ajouter à la collection. Ces documents peuvent correspondre : 

- à un document au format JSON. Dans ce cas, ce paramètre correspond à une chaîne de caractères. 

- à un document au format BSON. Dans ce cas, ce paramètre correspond à un buffer. 

- à un variant.




**`<Options> : (Constante optionnelle de type Entier)`**

Options d'ajout des documents : 


|   |   |
| --- | --- |
| *mongoContinueSiErreur* | Permet d'ajouter le document suivant même si le document précédent a provoqué une erreur. |
| *mongoSansValidation* | Permet d'ajouter le document sans effectuer de vérification de la structure du document. |






- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=AccesnatifaMongoDB.gif) ***Exemples unitaires (WINDEV)*** : **Accès natif à MongoDB** <br>Cet exemple présente l'utilisation des principales fonctions de l'accès natif aux bases MongoDB : ajout de données, lecture (recherche), modification et suppression de données dans la base. L'exemple présente également les fonctions permettant d'enregistrer des fichiers dans le système de données de MongoDB GridFS.



<a name="XComposante"></a>

## Composante :
wd280big.dll
