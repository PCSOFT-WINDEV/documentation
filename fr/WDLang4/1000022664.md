


## &lt;Variable Connexion&gt;.GèreServeur (Fonction)

***En anglais : &lt;Connection variable&gt;.SetServer***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet de connaître et de modifier certains paramétrages du serveur HFSQL Client/Serveur.

**Remarque** : Le droit de gestion du serveur est nécessaire pour utiliser cette fonction. Ce droit correspond à la constante *hDroitGestionServeur*utilisée dans les fonctions [&lt;Variable Connexion&gt;.InfoDroitServeur](../WDLang4/1000022668.md) et [&lt;Variable Connexion&gt;.ModifieDroitServeur](../WDLang4/1000022710.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Description de la connexion
MaConnexion est une Connexion

// Désactivation de la gestion des logs d'audit du serveur
MaConnexion.GèreServeur(hNiveauLog, "")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Connaître la valeur d'un paramètre

`<Résultat> = <Connexion>.GèreServeur(<Option>)`
---

**`<Résultat> : (Chaîne de caractères)`**



- Valeur de l'option spécifiée. 

- Chaîne vide ("") si l'option n'est pas définie.




**`<Connexion> : (Variable de type Connexion)`**

Nom de la variable de type [Connexion](../WDLang4/1514073.md) décrivant la connexion au serveur pour lequel la valeur du paramètre &lt;Option&gt; doit être connue.

**`<Option> : (Constante de type entier)`**

Indique l'option à connaître. Ces options sont stockées dans le fichier [HFConf.Ini](../WDLang4/3044345.md), présent à la racine du serveur.

Liste des options disponibles :


|   |   |
| --- | --- |
| *hActiveDirectory* | Paramètre &lt;Enable&gt; de la section ACTIVEDIRECTORY du fichier HFConf.Ini.<br>Activation de l'authentification par Active Directory. <br>Valeur :<br><br>- 0, l'authentification par Active Directory n'est pas activée,<br><br>- 1, l'authentification par Active Directory est activée.<br><br><br> |
| *hCacheNbFichierInutilisé* | Paramètre &lt;CacheMaxUnusedFiles&gt; du fichier HFConf.Ini.<br>Nombre maximum de tables HFSQL non utilisées par des clients qui sont gardées en cache (c'est-à-dire ouvertes) sur le serveur. Lorsque ce nombre est atteint, la table la plus ancienne non utilisée est supprimée du cache. |
| *hCalculStatistiqueAuto* | Paramètre &lt;Enable&gt; de la section AUTOANALYSE du fichier HFConf.Ini.<br>Activation du calcul automatique des statistiques des fichiers de données (optimisation des index). <br>Valeur :<br><br>- 0, le calcul automatique des statistiques n'est pas activé,<br><br>- 1, le calcul automatique des statistiques est activé.<br><br><br> |
| *hCheminBaseDeDonnées* | Paramètre &lt;DBRootPath&gt; du fichier HFConf.Ini.<br>Chemin du répertoire contenant l'ensemble des bases de données (c'est-à-dire les fichiers de données des différentes applications HFSQL Client/Serveur). |
| *hCheminJNL* | Paramètre &lt;JNLRootPath&gt; du fichier HFConf.Ini.<br>Chemin du répertoire contenant l'ensemble des journaux des différentes applications HFSQL Client/Serveur (historique des écritures dans les fichiers de données HFSQL). |
| *hCheminJNLBackup* | Paramètre &lt;JNLBackupRootPath&gt; du fichier HFConf.Ini.<br>Chemin du répertoire contenant la sauvegarde des journaux. |
| *hCheminLog* | Paramètre &lt;ServerLogPath&gt; du fichier HFConf.Ini.<br>Chemin du répertoire contenant les fichiers de log d'audit du serveur (ensemble des opérations demandées par les postes client au serveur). |
| *hCheminStatistiquesActivité* | Paramètre &lt;StatisticPath&gt; du fichier HFConf.Ini.<br>Chemin du répertoire contenant les fichiers de statistiques d'activité. |
| *hDaemonUser* | Paramètre &lt;DaemonUser&gt; du fichier HFConf.Ini.<br>Nom d'utilisateur sous lequel le serveur va fonctionner. |
| *hecAccèsDisque* | Paramètre &lt;LoadCoeffDiskAccess&gt; du fichier HFConf.Ini.<br>Coefficient global pour le nombre d'accès au disque. |
| *hecActif* | Paramètre &lt;LoadEnable&gt; du fichier HFConf.Ini.<br>Indique si l'équilibrage de charge est activé ou non. |
| *hecAppelsClient* | Paramètre &lt;LoadCoeffCall&gt; du fichier HFConf.Ini.<br>Coefficient global pour le nombre d'appels du client. |
| *hecAttenteMax* | Paramètre &lt;LoadMaxWait&gt; du fichier HFConf.Ini.<br>Temps maximum (en ms) pour lequel une demande au serveur pourra être mise en attente par le système d'équilibrage de charge avant d'être traitée. |
| *hecDisque* | Paramètre &lt;LoadCoeffDisk&gt; du fichier HFConf.Ini.<br>Coefficient global pour le nombre d'octets lus ou écrits sur disque. |
| *hecEnvoyé* | Paramètre &lt;LoadCoeffSend&gt; du fichier HFConf.Ini.<br>Coefficient global pour le nombre d'octets envoyés sur le réseau. |
| *hecReçu* | Paramètre &lt;LoadCoeffRecv&gt; du fichier HFConf.Ini.<br>Coefficient global pour le nombre d'octets reçus sur le réseau. |
| *hkaIntervalle* | Paramètre &lt;KeepAliveInterval&gt; du fichier HFConf.Ini.<br>Temps maximum (en secondes) au bout duquel si aucune communication n'est effectuée entre le serveur et le client, le serveur vérifie la présence du client.<br>Par défaut, ce paramètre vaut 30 minutes. |
| *hkaTimeout* | Paramètre &lt;KeepAliveTimeout&gt; du fichier HFConf.Ini.<br>Temps maximum (en secondes) d'attente du serveur lors de la vérification de la présence du client. Si le client n'est pas présent à la fin de cette durée, le client est automatiquement déconnecté.<br>Par défaut, ce paramètre vaut 2 minutes. |
| *hMode2Go* | Paramètre &lt;MoreThan2Go&gt; du fichier HFConf.Ini.<br>Indique si les tables systèmes peuvent avoir une taille supérieure à 2 Go. <br>Remarque : le système doit gérer les fichiers de plus de 2 Go. |
| *hNiveauLog* | Paramètre &lt;ServerLogLevels&gt; du fichier HFConf.Ini.<br>Définit ce qui doit être présent dans le fichier de log. |
| *hNombreMaxConnexion* | Paramètre &lt;MaximumConnectionsNumber&gt; du fichier HFConf.ini<br>Nombre maximum de connexions autorisées par application. Le nombre de connexions est déterminé par le nombre d'applications (process) ayant au moins une connexion non super-utilisateur sur le serveur. Par exemple : <br><br>- une application ayant ouvert une seule connexion en mode super-utilisateur compte pour zéro.<br><br>- une application ayant ouvert une seule connexion avec un utilisateur normal compte pour 1. <br><br>- une application ayant ouvert deux connexions d'un utilisateur normal compte pour 1.<br><br>- une application ayant ouvert des connexion en super-utilisateur et en utilisateur normal compte pour 1. <br><br><br> |
| *hPériodeStatistiquesActivité* | Paramètre &lt;StatisticPeriod&gt; du fichier HFConf.Ini.<br>Indique la période en seconde entre chaque sauvegarde des valeurs des différents compteurs d'activité. Il est possible d'indiquer 0 pour arrêter la collecte des statistiques. |
| *hPortDébogage* | Paramètre &lt;WLDebugPort&gt; du fichier HFConf.Ini.<br>Port utilisé pour le débogage des procédures stockées et des triggers Client/Serveur. |
| *hPortServeur* | Paramètre &lt;AccessPort&gt; du fichier HFConf.Ini.<br>Port réseau utilisé. |
| *hRechercheClé* | Paramètre &lt;KeySearch&gt; du fichier HFConf.Ini.<br>Activation de la recherche des clés. <br>Valeur : <br><br>- 0, la recherche automatique des clés n'est pas activée,<br><br>- 1, la recherche automatique des clés est activée.<br><br><br> |
| *hRépertoireTemp* | Paramètre &lt;TmpPath&gt; du fichier HFConf.Ini.<br>Chemin du répertoire temporaire. Ce répertoire est utilisé pour créer les fichiers temporaires si nécessaire (par exemple, fichiers temporaires créés lors de la réindexation de gros fichiers de données). |
| *hTailleCacheDisqueWindows* | Paramètre &lt;WindowsFileCacheSize&gt; du fichier HFConf.ini<br>Configuration de la gestion de la taille du cache disque de Windows. <br>Valeur :<br><br>- -1, pour une taille calculée automatiquement,<br><br>- 0, pour une taille du cache sans limite,<br><br>- une valeur positive correspond à une taille de cache personnalisée.<br><br><br>Remarque : La gestion standard des caches disques de Windows en mode 64 bits (indépendamment de HFSQL) peut amener à des saturations mémoire. Cette constante permet de personnaliser la gestion des caches mémoire. |
| *hTailleCacheNdx* | Paramètre &lt;NdxCacheSize&gt; du fichier HFConf.Ini.<br>Taille du cache des index (en Mo). La valeur par défaut est 10 Mo. |
| *hTailleMaxLog* | Paramètre &lt;ServerLogMaxSize&gt; du fichier HFConf.Ini.<br>Taille maximale d'un fichier de log (en Mo). |
| *hTailleMaxStatistiquesActivité* | Paramètre &lt;ActivityStatisticMaxFileSize&gt; du fichier HFConf.Ini.<br>Taille maximale d'un fichier de statistiques d'activité (en Mo). |
| *hTélémétrieActive* | Paramètre &lt;Active&gt; de la section TELEMETRY du fichier HFConf.ini<br>Configuration de la transmission des données en vue de l'amélioration du serveur HFSQL. <br>Valeur :<br><br>- 1, si lors de l'installation du serveur HFSQL, la transmission des données (télémétrie) a été activée,<br><br>- 0, si lors de l'installation du serveur HFSQL, la transmission des données (télémétrie) a été refusée,<br><br>- une autre valeur signifie qu'aucun choix n'a été fait lors de l'installation concernant l'usage de la télémétrie. La question sera reposée lors de la prochaine installation du serveur HFSQL.<br><br><br>Remarque : Si la section "TELEMETRY" n'existe pas dans le fichier HFConf.ini, la transmission des données relatives à l'utilisation du produit n'est pas activée pour le serveur HFSQL. |




<a name="SYNTAXE2"></a>

### Modifier la valeur d'un paramètre

`<Résultat> = <Connexion>.GèreServeur(<Option> , <Valeur>)`
---

**`<Résultat> : (Chaîne de caractères)`**



- Ancienne valeur de l'option, 

- Chaîne vide ("") si une erreur a été rencontrée.




**`<Connexion> : (Variable de type Connexion)`**

Nom de la variable de type [Connexion](../WDLang4/1514073.md) décrivant la connexion au serveur pour lequel la valeur du paramètre &lt;Option&gt; doit être modifiée.

**`<Option> : (Constante de type entier)`**

Indique l'option à connaître. Ces options sont stockées dans le fichier [HFConf.Ini](../WDLang4/3044345.md), présent à la racine du serveur.

**Remarque** : Une description plus détaillée de chaque paramètre est disponible sur la page [HFConf.Ini](../WDLang4/3044345.md)

- Liste des options pour une utilisation simple : 
	**Remarque** : La modification de ces options effectuée avec la fonction **&lt;Variable Connexion&gt;.GèreServeur** est prise en compte sans devoir redémarrer le serveur.
	


|   |   |
| --- | --- |
| *hActiveDirectory* | Paramètre &lt;Enable&gt; de la section ACTIVEDIRECTORY du fichier HFConf.Ini.<br>Activation de l'authentification par Active Directory. <br>Valeur :<br><br>	- 0, l'authentification par Active Directory n'est pas activée,<br><br>	- 1, l'authentification par Active Directory est activée.<br><br><br> |
| *hCalculStatistiqueAuto* | Paramètre &lt;Enable&gt; de la section AUTOANALYSE du fichier HFConf.Ini.<br>Activation du calcul automatique des statistiques des fichiers de données (optimisation des index). <br>Valeur :<br><br>	- 0, le calcul automatique des statistiques n'est pas activé,<br><br>	- 1, le calcul automatique des statistiques est activé.<br><br><br> |
| *hCheminLog* | Paramètre &lt;ServerLogPath&gt; du fichier HFConf.Ini.<br>Chemin des fichiers de log. Le chemin est créé sur le serveur si il n'existe pas. |
| *hCheminStatistiquesActivité* | Paramètre &lt;StatisticPath&gt; du fichier HFConf.Ini.<br>Chemin des fichiers de statistiques d'activité. Le chemin est créé sur le serveur si il n'existe pas.<br>Les statistiques sont sauvegardées et réinitialisées. |
| *hkaIntervalle* | Paramètre &lt;KeepAliveInterval&gt; du fichier HFConf.Ini.<br>Temps maximum (en secondes) au bout duquel si aucune communication n'est effectuée entre le serveur et le client, le serveur vérifie la présence du client.<br>Par défaut, ce paramètre vaut 30 minutes. |
| *hkaTimeout* | Paramètre &lt;KeepAliveTimeout&gt; du fichier HFConf.Ini.<br>Temps maximum (en secondes) d'attente du serveur lors de la vérification de la présence du client. Si le client n'est pas présent à la fin de cette durée, le client est automatiquement déconnecté.<br>Par défaut, ce paramètre vaut 2 minutes. |
| *hNiveauLog* | Paramètre &lt;ServerLogLevels&gt; du fichier HFConf.Ini.<br>Définit ce qui doit être présent dans le fichier de log. |
| *hNombreMaxConnexion* | Paramètre &lt;MaximumConnectionsNumber&gt; du fichier HFConf.ini<br>Nombre maximum de connexions autorisées par application. Le nombre de connexions est déterminé par le nombre d'applications (process) ayant au moins une connexion non super-utilisateur sur le serveur. Par exemple : <br><br>	- une application ayant ouvert une seule connexion en mode super-utilisateur compte pour zéro.<br><br>	- une application ayant ouvert une seule connexion avec un utilisateur normal compte pour 1. <br><br>	- une application ayant ouvert deux connexions d'un utilisateur normal compte pour 1.<br><br>	- une application ayant ouvert des connexion en super-utilisateur et en utilisateur normal compte pour 1. <br><br><br><br><br>Par défaut, ce paramètre vaut 0 (pas de limite). |
| *hPériodeStatistiquesActivité* | Paramètre &lt;StatisticPeriod&gt; du fichier HFConf.Ini.<br>Indique la période (en secondes) entre chaque sauvegarde des valeurs des différents compteurs d'activité.<br>Cette valeur doit être supérieure ou égale à 1 sinon aucune modification n'est effectuée.<br>Les statistiques sont sauvegardées et réinitialisées.<br>Il est possible d'indiquer 0 pour arrêter la collecte des statistiques. |
| *hRechercheClé* | Paramètre &lt;KeySearch&gt; du fichier HFConf.Ini.<br>Activation de la recherche des clés. <br>Valeur : <br><br>	- 0, la recherche automatique des clés n'est pas activée,<br><br>	- 1, la recherche automatique des clés est activée.<br><br><br> |
| *hRépertoireTemp* | Paramètre &lt;TmpPath&gt; du fichier HFConf.Ini.<br>Chemin du répertoire temporaire. Ce répertoire est utilisé pour créer les fichiers temporaires si nécessaire (par exemple, fichiers temporaires créés lors de la réindexation de gros fichiers de données).<br>Le chemin est créé sur le serveur si il n'existe pas. |
| *hTailleCacheNdx* | Paramètre &lt;NdxCacheSize&gt; du fichier HFConf.Ini.<br>Taille du cache des index (en Mo).<br>Cette valeur doit être supérieure ou égale à 1 sinon aucune modification n'est effectuée. |
| *hTailleMaxLog* | Paramètre &lt;ServerLogMaxSize&gt; du fichier HFConf.Ini.<br>Taille maximale d'un fichier de log (en Mo).<br>Cette valeur doit être supérieure ou égale à 1 sinon aucune modification n'est effectuée. |
| *hTailleMaxStatistiquesActivité* | Paramètre &lt;StatisticMaxFileSize&gt; du fichier HFConf.Ini<br>Taille maximale d'un fichier de statistiques d'activité (en Mo).<br>Cette valeur doit être supérieure ou égale à 1 sinon aucune modification n'est effectuée.<br>Les statistiques sont sauvegardées et réinitialisées. |
| *hTélémétrieActive* | Paramètre &lt;Active&gt; de la section TELEMETRY du fichier HFConf.ini<br>Configuration de l'utilisation de la transmission des données relatives à l'utilisation du serveur HFSQL pour une amélioration du produit. <br>Valeur :<br><br>	- 1, si lors de l'installation du serveur HFSQL, la transmission des données (télémétrie) a été activée,<br><br>	- 0, si lors de l'installation du serveur HFSQL, la transmission des données (télémétrie) a été refusée,<br><br>	- une autre valeur signifie qu'aucun choix n'a été fait lors de l'installation concernant l'usage de la télémétrie. La question sera reposée lors de la prochaine installation du serveur HFSQL.<br><br><br>Remarque : Si la section "TELEMETRY" n'existe pas dans le fichier HFConf.ini, la transmission des données relative à l'utilisation du produit n'est pas activée pour le serveur HFSQL. |



- Liste des options pour une utilisation avancée :
	**Remarque** : La modification de ces options via la fonction **&lt;Variable Connexion&gt;.GèreServeur** sera prise en compte au prochain redémarrage du serveur.
	


|   |   |
| --- | --- |
| *hCheminBaseDeDonnées* | Paramètre &lt;DBRootPath&gt; du fichier HFConf.Ini.<br>Chemin du répertoire contenant l'ensemble des bases de données (c'est-à-dire les fichiers de données des différentes applications HFSQL Client/Serveur). <br>Le chemin est créé sur le serveur si il n'existe pas au redémarrage du serveur. |
| *hCheminJNL* | Paramètre &lt;JNLRootPath&gt; du fichier HFConf.Ini<br>Chemin du répertoire contenant l'ensemble des journaux des différentes applications HFSQL Client/Serveur.<br>Le chemin est créé sur le serveur si il n'existe pas au redémarrage du serveur. |
| *hCheminJNLBackup* | Paramètre &lt;JNLBackupRootPath&gt; du fichier HFConf.Ini.<br>Chemin du répertoire contenant la sauvegarde des journaux.<br>Le chemin est créé sur le serveur si il n'existe pas au redémarrage du serveur. |
| *hDaemonUser* | Paramètre &lt;DaemonUser&gt; du fichier HFConf.Ini.<br>Nom d'utilisateur sous lequel le serveur va tourner. |
| *hMode2Go* | Paramètre &lt;MoreThan2Go&gt; du fichier HFConf.Ini.<br>Indique si les tables systèmes peuvent avoir une taille supérieure à 2 Go. <br>Remarque : le système doit gérer les fichiers de plus de 2 Go. |
| *hPortServeur* | Paramètre &lt;AccessPort&gt; du fichier HFConf.Ini.<br>Port réseau utilisé. |
| *hTailleCacheDisqueWindows* | Paramètre &lt;WindowsFileCacheSize&gt; du fichier HFConf.ini<br>Mode de gestion de la taille du cache disque de Windows. <br>Valeur :<br><br>	- -1, pour une taille calculée automatiquement,<br><br>	- 0, pour une taille du cache sans limite,<br><br>	- une valeur positive indique la taille du cache personnalisée.<br><br><br>Remarque : La gestion standard des caches disques de Windows en mode 64 bits (indépendamment de HFSQL) peut amener à des saturations mémoire. Cette constante permet de personnaliser la gestion des caches mémoire. |



- Liste des options pour l'équilibrage dynamique de charge :
	
	**Remarque** : La modification de ces options effectuée avec la fonction **&lt;Variable Connexion&gt;.GèreServeur** est prise en compte sans devoir redémarrer le serveur.
	


|   |   |
| --- | --- |
| *hecAccèsDisque* | Paramètre &lt;LoadCoeffDiskAccess&gt; du fichier HFConf.Ini.<br>Coefficient global pour le nombre d'accès au disque.<br>Cette valeur, comprise entre -100 et 100, augmente ou diminue le coefficient appliqué au compteur du nombre d'accès au disque. |
| *hecActif* | Paramètre &lt;LoadEnable&gt; du fichier HFConf.Ini.<br>Indique si l'équilibrage de charge est activé ou non.<br><br>	- <u><u><u><u>Vrai</u></u></u></u> si l'équilibrage de charge doit être activé,<br><br>	- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.<br><br><br> |
| *hecAppelsClient* | Paramètre &lt;LoadCoeffCall&gt; du fichier HFConf.Ini.<br>Coefficient global pour le nombre d'appels du client.<br>Cette valeur, comprise entre -100 et 100, augmente ou diminue le coefficient appliqué au compteur des appels clients au serveur. |
| *hecAttenteMax* | Paramètre &lt;LoadMaxWait&gt; du fichier HFConf.Ini.<br>Temps maximum (en ms) pour lequel une demande au serveur pourra être mise en attente par le système d'équilibrage de charge avant d'être traitée. |
| *hecDisque* | Paramètre &lt;LoadCoeffDisk&gt; du fichier HFConf.Ini.<br>Coefficient global pour le nombre d'octets lus ou écrits sur disque.<br>Cette valeur, comprise entre -100 et 100, augmente ou diminue le coefficient appliqué au compteur des octets lus ou écrits sur disque par le serveur. |
| *hecEnvoyé* | Paramètre &lt;LoadCoeffSend&gt; du fichier HFConf.Ini.<br>Coefficient global pour le nombre d'octets envoyés sur le réseau.<br>Cette valeur, comprise entre -100 et 100, augmente ou diminue le coefficient appliqué au compteur des octets envoyés par le serveur. |
| *hecReçu* | Paramètre &lt;LoadCoeffRecv&gt; du fichier HFConf.Ini.<br>Coefficient global pour le nombre d'octets reçus sur le réseau.<br>Cette valeur, comprise entre -100 et 100, augmente ou diminue le coefficient appliqué au compteur des octets reçus par le serveur. |






**`<Valeur> : (Variant)`**

Nouvelle valeur de l'option spécifiée.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Équilibrage dynamique de charge
<a name="equilibrage_dynamique_charge_ELTPARAGRAPHE000863"></a>Les coefficients servent à  faire varier l'importance de chaque compteur dans la formule de calcul de la charge engendrée par un utilisateur sur le serveur.

- Une valeur de 1, 0 ou -1 ne modifie pas le coefficient.

- Une valeur supérieure à 100 est équivalente à 100.

- Une valeur inférieure à -100 est équivalente à -100.



<a name="NOTE0_2"></a>


### Gestion des logs
<a name="gestion_des_logs_ELTPARAGRAPHE000877"></a>Les informations concernant les logs peuvent être modifiées sans redémarrage du serveur. Il est conseillé de modifier le chemin des logs avant de les activer. Dans le cas contraire, les logs seront écrits dans le répertoire par défaut entre l'activation et le changement de chemin.

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
