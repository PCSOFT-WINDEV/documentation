


## HSupprimeLiaison (Fonction)

***En anglais : HDeleteLink***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Supprime une règle d'intégrité entre deux fichiers de données sur le serveur. La règle d'intégrité à supprimer est définie grâce à une variable de type [Description de Liaison](../WDLang4/1514039.md).

La suppression sera effective pour l'application qui a effectué la suppression lorsque la connexion aura été fermée puis ré-ouverte.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MaConnexion est une Connexion
MaLiaison est une Description de Liaison
// Description de la liaison "HABITE"
MaLiaison.FichierSource = ".\ville.fic"
MaLiaison.FichierRelié = ".\client.fic"
MaLiaison.CléSource = "NOMVILLE"
MaLiaison.CléReliée = "VILLECLI"

// Liaison par défaut (0-1, 0-1)
HSupprimeLiaison(MaConnexion, MaLiaison)
```

```wl
// Supprimer toutes les liaisons d'une base de données 
// d'un serveur HFSQL Client/Serveur 
// indépendamment de l'analyse en cours
CnxHFSQL est une Connexion
CnxHFSQL.Provider = hAccèsHFClientServeur
CnxHFSQL.Utilisateur = "admin"
CnxHFSQL.MotDePasse = ""
CnxHFSQL.Serveur = "HFSQLServeur:4900"
CnxHFSQL.BaseDeDonnées = "CRM"
HOuvreConnexion(CnxHFSQL)

sListeLiaisons est chaîne = HListeLiaison("*", CnxHFSQL)
sInfoUneLiaison est une chaîne
UneLiaison est une Description de Liaison

POUR CHAQUE CHAÎNE sInfoUneLiaison DE sListeLiaisons SEPAREE PAR RC
	SI sInfoUneLiaison <> "" ALORS
		UneLiaison.Nom = ExtraitChaîne(sInfoUneLiaison, 1, TAB)
		UneLiaison.FichierSource = Remplace(ExtraitChaîne(sInfoUneLiaison, 2, TAB), ...
			CnxHFSQL.BaseDeDonnées, ".", SansCasse)
		UneLiaison.CléSource = ExtraitChaîne(sInfoUneLiaison, 3, TAB)
		UneLiaison.FichierRelié = Remplace(ExtraitChaîne(sInfoUneLiaison, 5, TAB), ...
			CnxHFSQL.BaseDeDonnées, ".", SansCasse)
		UneLiaison.CléReliée = ExtraitChaîne(sInfoUneLiaison, 6, TAB)
		// Suppression de la liaison du serveur HFSQL Client/Serveur
		Trace("Suppression >> " + UneLiaison.Nom + " >> " + ...
			HSupprimeLiaison(CnxHFSQL, UneLiaison))		
	FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HSupprimeLiaison(<Connexion source> [, <Connexion reliée>] , <Description de la liaison>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur.




**`<Connexion source> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion à laquelle appartient le fichier source de la liaison. Cette connexion correspond :

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).




**`<Connexion reliée> : (Chaîne de caractères optionnelle ou variable de type Connexion)`**

Connexion à laquelle appartient le fichier relié de la liaison. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).


Si ce paramètre n'est pas précisé, les deux fichiers de données appartiennent alors à la même connexion (paramètre &lt;Connexion source&gt;).

**`<Description de la liaison> : (Variable de type Description de liaison)`**

Nom de la variable de type [Description de liaison](../WDLang4/1514039.md) contenant les caractéristiques de la liaison à supprimer. La liaison à supprimer est définie par le fichier de données source, la rubrique source, ainsi que la rubrique reliée.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Description de liaison
<a name="description_liaison_ELTPARAGRAPHE000134"></a>

- Lors de la description de la liaison, les noms des fichiers de données participant à la liaison (propriétés [FichierSource](../Proprietes/2512034.md) et [FichierRelié](../Proprietes/2512031.md)) doivent correspondre aux noms physiques des fichiers de données, relatifs à la base de données considérée. La base de données associée à chaque fichier de données est connue grâce aux paramètres &lt;Connexion source&gt; et &lt;Connexion reliée&gt;.

- Pour supprimer une liaison, il n'est pas nécessaire de décrire toutes les caractéristiques de la liaison. Seules les propriétés suivantes sont nécessaires :
	


|   |   |
| --- | --- |
| [CléReliée](../Proprietes/2512007.md) | Rubrique du fichier de données relié utilisée dans la liaison. |
| [CléSource](../Proprietes/2512003.md) | Rubrique du fichier de données source utilisée dans la liaison. |
| [FichierRelié](../Proprietes/2512031.md) | Nom du fichier de données relié utilisé dans la liaison. |
| [FichierSource](../Proprietes/2512034.md) | Nom du fichier de données source utilisé dans la liaison. |
| [Nom](../Proprietes/2510082.md) | Nom de la liaison. |






<a name="XComposante"></a>

## Composante :
wd280hf.dll
