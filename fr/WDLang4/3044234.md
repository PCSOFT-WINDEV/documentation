
## Modifier le contenu d'une requête 
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000211"></a>
Les requêtes constituent un moyen simple et rapide pour sélectionner des enregistrements provenant d'un ou plusieurs fichiers de données, répondant à un ou plusieurs critères de sélection, ...

Que votre requête soit réalisée à l'aide de l'éditeur de requêtes ou par programmation, les enregistrements sélectionnés par la requête peuvent être modifiés directement lors du parcours du résultat de la requête.

Cette modification peut être effectuée :

- soit uniquement dans le résultat de la requête (fichier de données HFSQL).

- soit dans le résultat de la requête et dans les fichiers de base de la requête :

	- Fichiers manipulés par OLE DB ou par un Accès Natif : cette modification est réalisée automatiquement.

	- Fichiers HFSQL :

		- Requête exécutée avec la constante *hAvecFiltre* : la modification du fichier est automatiquement réalisée.

		- Requête exécutée sans la constante *hAvecFiltre* : Il est nécessaire d'utiliser la constante *hModifieFichier*lors de l'exécution de la requête avec les fonctions [HExécuteRequête](../WDLang4/3044080.md) et [HExécuteRequêteSQL](../WDLang4/3044084.md).





Le report des modifications effectuées dans la requête sur le fichier de base n'est effectué que pour les rubriques modifiées dans la requête.





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Modifier le contenu d'une requête exécutée AVEC la constante hAvecFiltre
<a name="modifier_contenu_une_requete_executee_avec_constante_havecfiltre_ELTTEXTE000241"></a>
Plusieurs fonctions permettent de modifier le résultat de la requête. Dans tous les cas, la modification est directement réalisée sur le fichier de données de base de la requête.

| Fonction | Fonctionnalité | Limites/Possibilités |
| --- | --- | --- |
| [HAjoute](../WDLang4/3044147.md) | Ajoute l'enregistrement présent en mémoire dans le fichier de données. | <br><br>- Utilisable uniquement sur les requêtes mono-fichier.<br><br>- Les rubriques calculées précisées lors de l'ajout sont ignorées. Elles sont automatiquement calculées.<br><br><br> |
| [HEcrit](../WDLang4/3044092.md) | Écrit un enregistrement dans le fichier de données sans mettre à jour les index correspondants à toutes les clés utilisées dans le fichier. | <br><br>- La fonction [HEcrit](../WDLang4/3044092.md) peut être utilisée.<br><br><br> |
| [HModifie](../WDLang4/3044042.md) | Modifie l'enregistrement spécifié ou l'enregistrement présent en mémoire dans le fichier de données. | <br><br>- Seule la modification de l'enregistrement courant est possible.<br><br>- Si la fonction est exécutée pour modifier une requête basée sur plusieurs fichiers, la modification est répercutée sur les fichiers liés.<br><br>- La modification du contenu d'une rubrique calculée provoque une erreur WLangage. Le contenu de ces rubriques est automatiquement calculé lors de la modification de l'enregistrement.<br><br><br> |
| [HRaye](../WDLang4/3044121.md) | Raye un enregistrement d'un fichier. L'enregistrement est supprimé logiquement et pourra éventuellement récupéré. | <br><br>- Utilisable uniquement sur les requêtes mono-fichier.<br><br><br> |
| [HSupprime](../WDLang4/3044018.md) | Supprime un enregistrement d'un fichier. L'enregistrement est supprimé logiquement et physiquement. Il ne pourra pas être restauré (contrairement aux enregistrements rayés avec la fonction HRaye). | <br><br>- Utilisable uniquement sur les requêtes mono-fichier.<br><br><br> |

Attention :

- Toute modification d'une requête utilisant les groupes ou les agrégats est interdite.

- La gestion de l'intégrité et des doublons n'est pas réalisée lors d'opérations sur les requêtes multi-fichiers : il est conseillé d'utiliser les transactions pour éviter tout problème.






<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Modifier le contenu d'une requête exécutée SANS la constante hAvecFiltre
<a name="modifier_contenu_une_requete_executee_sans_constante_havecfiltre_ELTTEXTE000265"></a>
Plusieurs fonctions permettent de modifier le résultat de la requête. Il est possible de modifier soit le résultat de la requête, soit les fichiers de données intervenant dans la requête (constante ***hModifieFichier*** précisée dans les fonctions [HExécuteRequête](../WDLang4/3044080.md) et [HExécuteRequêteSQL](../WDLang4/3044084.md)).

| Fonction | Fonctionnalité | Limites/Possibilités |
| --- | --- | --- |
| [HAjoute](../WDLang4/3044147.md) | Ajoute l'enregistrement présent en mémoire dans le fichier de données. | <br><br>- Utilisable uniquement sur les requêtes mono-fichier.<br><br>- Les rubriques calculées précisées lors de l'ajout sont ignorées. Elles sont automatiquement calculées.<br><br><br> |
| [HEcrit](../WDLang4/3044092.md) | Écrit un enregistrement dans le fichier de données sans mettre à jour les index correspondants à toutes les clés utilisées dans le fichier. | <br><br>- Inutilisable.<br><br><br> |
| [HModifie](../WDLang4/3044042.md) | Modifie l'enregistrement spécifié ou l'enregistrement présent en mémoire dans le fichier de données. | <br><br>- Si la fonction est exécutée pour modifier une requête basée sur plusieurs fichiers, la modification est répercutée sur les fichiers liés.<br><br>- Si l'enregistrement modifié ne correspond plus à la sélection de la requête, l'enregistrement sera toujours présent dans le résultat de la requête<br><br>- La modification du contenu d'une rubrique calculée provoque une erreur WLangage. Le contenu de ces rubriques est automatiquement calculé lors de la modification de l'enregistrement.<br><br><br> |
| [HRaye](../WDLang4/3044121.md) | Raye un enregistrement d'un fichier. L'enregistrement est supprimé logiquement et pourra éventuellement récupéré. | <br><br>- Utilisable uniquement sur les requêtes mono-fichier.<br><br><br> |
| [HSupprime](../WDLang4/3044018.md) | Supprime un enregistrement d'un fichier. L'enregistrement est supprimé logiquement et physiquement. Il ne pourra pas être restauré (contrairement aux enregistrements rayés avec la fonction HRaye). | <br><br>- Utilisable uniquement sur les requêtes mono-fichier.<br><br><br> |





**Attention** : 

- Toute modification d'une requête utilisant les groupes ou les agrégats est interdite.

- La gestion de l'intégrité et des doublons n'est pas réalisée lors d'opérations sur les requêtes multi-fichiers : il est conseillé d'utiliser les transactions pour éviter tout problème.

- Sur des fichiers non HFSQL, la constante ***hModifieFichier*** est inutile : lors de la modification du résultat de la requête, les fichiers intervenant dans la requête sont automatiquement modifiés.







