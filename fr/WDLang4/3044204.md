


## HDéclareExterne (Fonction)

***En anglais : HDeclareExternal***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Importe temporairement dans l'analyse en cours la description d'un fichier de données à partir d'un fichier de données HFSQL existant. Ce fichier de données est ouvert. Pour ne plus utiliser cette description de fichier de données, utilisez la fonction [HAnnuleDéclaration](../WDLang4/3044174.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003044204&name=hdeclareexterne_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Déclaration d'un fichier de données FournisseurWD à partir du chemin complet 
// du fichier HFSQL Classic (extension .FIC comprise)
HDéclareExterne("C:\GestCom\Fournisseur.fic", "FournisseurWD")
SI ErreurDétectée = Vrai ALORS
	// Erreur de déclaration du fichier, on affiche l'erreur
	Erreur(HErreurInfo())
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png) 
### Utilisation avec des fichiers HFSQL Classic (monoposte ou réseau)

`<Résultat> = HDéclareExterne(<Chemin complet du fichier HFSQL> , <Alias> [, <Mot de passe>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur.




**`<Chemin complet du fichier HFSQL> : (Chaîne de caractères)`**

Chemin complet d'accès au fichier de données HFSQL dont la description doit être importée (260 caractères maximum). Ce nom doit contenir le chemin et l'extension du fichier de données. 
Si la fonction **HDéclareExterne** est utilisée dans une procédure stockée, le chemin du fichier de données doit être relatif à la base de données en cours.

**`<Alias> : (Chaîne de caractères)`**

Nom logique du fichier de données. Ce nom permettra de manipuler le fichier de données. Ce nom peut également correspondre à une variable de type Source de données. 

**`<Mot de passe> : (Chaîne de caractères optionnelle)`**



- Mot de passe associé au fichier de données. 

- Chaîne vide ("") si aucun mot de passe n'est utilisé. 


Si le mot de passe est précisé, il est conservé : il n'est pas nécessaire d'indiquer à nouveau ce mot de passe dans les prochaines fonctions de manipulation du fichier de données.  


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 
### Utilisation avec un accès OLE DB, un Connecteur Natif, HFSQL Client/Serveur et une connexion existante

`<Résultat> = HDéclareExterne(<Fichier de données> , <Alias> , <Connexion>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur.




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données dans la base externe.
![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Ce paramètre correspond au nom physique du fichier de données, relatif à la base de données (extension comprise). Exemple : "monfichier.fic" (ou si la base a des sous-répertoires : ".\\repertoire\\monfichier.fic"). 
Si le fichier de données possède un mot de passe, il est nécessaire de préciser ce mot de passe avec la fonction [hPasse](../WDLang4/3044108.md) avant d'utiliser la fonction **HDéclareExterne**.

**`<Alias> : (Chaîne de caractères)`**

Nom logique du fichier de données. Ce nom permettra de manipuler le fichier de données dans l'application en cours. Ce nom peut également correspondre à une variable de type Source de données. 

**`<Connexion> : (Chaîne de caractères)`**

Connexion à une base de données. Cette connexion a été définie dans l'éditeur d'analyses ou décrite par programmation grâce à la fonction [HDécritConnexion](../WDLang4/3044205.md).




<a name="SYNTAXE3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 
### Utilisation avec un accès OLE DB ou un Connecteur Natif

`<Résultat> = HDéclareExterne(<Fichier de données> , <Alias> , <Utilisateur> [, <Mot de passe> [, <Source de données> [, <Provider OLE DB ou Connecteur Natif> [, <Accès>]]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur.




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données dans la base externe.

**`<Alias> : (Chaîne de caractères)`**

Nom logique du fichier de données. Ce nom permettra de manipuler le fichier de données dans l'application en cours.

**`<Utilisateur> : (Chaîne de caractères)`**

Nom de l'utilisateur de la source de données.

**`<Mot de passe> : (Chaîne de caractères optionnelle)`**

Mot de passe du fichier de données à ouvrir (si ce mot de passe existe).

**`<Source de données> : (Chaîne de caractères optionnelle)`**

Chemin complet de la source de données.

**`<Provider OLE DB ou Connecteur Natif> : (Chaîne de caractères optionnelle)`**

Nom du provider OLE DB à utiliser ou une des constantes suivantes :


|   |   |
| --- | --- |
| *hAccèsNatifAS400* | Connecteur Natif AS/400 (module optionnel) |
| *hAccèsNatifDB2* | Connecteur Natif DB2 (module optionnel) |
| *hAccèsNatifInformix* | Connecteur Natif informix (module optionnel) |
| *hAccèsNatifMariaDB* | Connecteur Natif MariaDB (module optionnel de WINDEV/WEBDEV) |
| *hAccèsNatifMySQL* | Connecteur Natif MySQL (module optionnel) |
| *hAccèsNatifOracle* | Connecteur Natif Oracle (module optionnel) |
| *hAccèsNatifPostgreSQL* | Connecteur Natif PostgreSQL (module optionnel de WINDEV/WEBDEV) |
| *hAccèsNatifProgress* | Connecteur Natif Progress (module optionnel) |
| *hAccèsNatifSQLAzure* | Connecteur Natif SQL Azure (module optionnel, fourni avec le Connecteur Natif SQL Server) |
| *hAccèsNatifSQLite* | Connecteur Natif SQLite |
| *hAccèsNatifSQLServer* | Connecteur Natif SQL Server (module optionnel) |
| *hAccèsNatifSybase* | Connecteur Natif Sybase (module optionnel) |
| *hAccèsNatifXBase* | Connecteur Natif xBase |
| *hAccèsNatifXML* | Connecteur Natif XML |
| *hODBC* | Provider OLE DB pour ODBC. Permet d'accéder à une source de données ODBC déclarée dans les sources de données ODBC de Windows |
| *hOledbAccess97* | Provider OLE DB pour Access 97 |
| *hOledbAccess2000* | Provider OLE DB pour Access 2000 |
| *hOledbAccess2007* | Provider OLE DB pour Access 2007 |
| *hOledbAccess2010* | Provider OLE DB pour Access 2010 |
| *hOledbDBase5* | Provider OLE DB pour DBase 5 |
| *hOledbExcel2000* | Provider OLE DB pour Excel 2000 |
| *hOledbExcel2007* | Provider OLE DB pour Excel 2007 |
| *hOledbExcel97* | Provider OLE DB pour Excel 97 |
| *hOledbLotus4* | Provider OLE DB pour Lotus 4 |
| *hOledbOracle* | Provider OLE DB pour Oracle |
| *hOledbSQLServer* | Provider OLE DB pour SQL Server |

Attention : Pour utiliser une connexion OLE DB il est nécessaire : 


- d'installer le MDAC version 2.6 minimum (installation réalisée avec WINDEV/WEBDEV et lors de la création de la version Client)

- d'installer le provider OLE DB correspondant à la base de données manipulée.




**`<Accès> : (Constante optionnelle)`**

Paramètre le type d'accès au fichier de données.


|   |   |
| --- | --- |
| *hOLecture* | Le fichier de données est accessible uniquement en lecture. Seule la lecture des enregistrements est possible. Il n'est pas possible d'en ajouter ou d'en supprimer. |
| *hOLectureEcriture*<br>(valeur par défaut) | Le fichier de données est accessible en lecture et en écriture. Il est possible aussi bien de lire des enregistrements que d'écrire de nouveaux enregistrements. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Toutes les fonctions HFSQL peuvent être utilisées sur le fichier de données importé, à l'exception de la gestion de l'intégrité.

- Le nombre d'importations de descriptions est illimité.

- Cette fonction peut être utilisée avec des fichiers de données au format XML.

- La seconde syntaxe de cette fonction ne peut pas être utilisée lors d'un accès à une base de données via .

- Pour utiliser la fonction **HDéclareExterne** dans une procédure stockée :

	- il faut donner le chemin relatif du fichier de données par rapport au répertoire de la base contenant la procédure stockée. Le chemin devra indiquer le nom et l'extension du fichier de données.

	- il ne faut pas utiliser de connexion : c'est la base en cours sur laquelle se trouve la procédure stockée qui sera utilisée.




- Par défaut, si le projet en cours :

	- est associé à une analyse, le mode de blocage effectué sur les fichiers de données est multi-utilisateurs (les fichiers ne sont pas bloqués à leur ouverture, les autres applications peuvent accéder aux fichiers).

	- n'est pas associé à une analyse, le mode de blocage effectué sur les fichiers de données est mono-utilisateurs : les fichiers sont totalement bloqués en lecture et en écriture dès leur ouverture. Ce mode empêche tout autre application d'accéder aux fichiers déjà ouverts par l'application en cours.











<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Fonction HDéclareExterne : Utilisation avec les Connecteurs Natifs et/ou le provider OLE DB
<a name="fonction_docparampagetitleshort_utilisation_avec_les_connecteurs_natifs_etou_provider_ole_ELTPARAGRAPHE000380"></a>Par défaut, le nom logique fourni à la fonction **HDéclareExterne** est considéré comme étant le seul nom de la table. Il est encapsulé en utilisant les caractères d'encapsulation correspondant à la base ou spécifiés par le provider OLE DB avant d'être envoyé à la base (ce qui permet de gérer des noms de table contenant des caractères spéciaux).

Pour fournir un nom de fichier composé de &lt;nom du user&gt;.&lt;nom de la table&gt; (ou suivant la base de données &lt;nom du schéma&gt;.&lt;nom de la table&gt;) dans la fonction **HDéclareExterne**, il est nécessaire de fournir ces noms déjà formatés (en utilisant les caractères d'encapsulation correspondant à la base de données ou spécifiés par le provider OLE DB).

**Exemple pour SQLServer :**
Les caractères d'encapsulation sont " ".
Pour changer le nom CLIENT en DBO.CLIENT avec la fonction **HDéclareExterne**, il est nécessaire de passer la chaîne "DBO"."CLIENT".
Il faut donc utiliser le code suivant :

```wl
HDéclareExterne("""DBO"".""CLIENT""", sdClient, "MaConnexion")
```

<a name="XComposante"></a>

## Composante :
wd280hf.dll
