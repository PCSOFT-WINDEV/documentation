


## HPremier (Fonction)

***En anglais : HFirst***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Positionne sur le premier enregistrement d'un fichier de données en fonction de la rubrique de parcours spécifiée. **L'enregistrement n'est pas lu**.
Le numéro de l'enregistrement en cours est modifié uniquement lorsqu'il est renvoyé par la fonction [HNumEnr](../WDLang4/3044063.md). Pour les fonctions manipulant par défaut le numéro de l'enregistrement en cours (fonctions [HSupprime](../WDLang4/3044018.md), [HLit](../WDLang4/3044047.md), [HModifie](../WDLang4/3044042.md), ...), la valeur de ce numéro n'est pas mise à jour : il faut utiliser la fonction [HNumEnr](../WDLang4/3044063.md)(). Par exemple : ne pas faire : 

```wl
HSupprime(Client)
```
mais 

```wl
HSupprime(Client, HNumEnr())
```
La lecture se fait de la plus petite à la plus grande valeur de la rubrique de parcours (consultez les remarques pour plus de détails).

**Attention** : ***L'enregistrement chargé en mémoire n'est pas modifié***. Les variables HFSQL (par exemple Client.Nom, c'est-à-dire la rubrique *Nom* du fichier *Client*) ne sont pas mises à jour.

En général, la fonction **HPremier** permet de se positionner dans le fichier de données pour effectuer une boucle de parcours parmi les enregistrements correspondant à une condition. La fonction [HSuivant](../WDLang4/3044027.md) permet de se positionner sur l'enregistrement suivant correspondant à la condition.

Après l'exécution de la fonction **HPremier**, plusieurs cas peuvent se présenter :

- un enregistrement correspondant à la condition a été trouvé : la fonction [HTrouve](../WDLang4/3044104.md) renvoie <u><u><u>Vrai</u></u></u>

- le fichier de données est vide ou il n'existe pas d'enregistrement correspondant à la condition : la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u>Vrai</u></u></u>




**Remarques** : 

- Par défaut, les fonctions [HRecherchePremier](../WDLang4/3044125.md) et [HRechercheDernier](../WDLang4/3044129.md) permettent de réaliser une recherche à l'identique.

- Par défaut, la fonction **HPremier** effectue une recherche générique.





La lecture se fait de la plus petite à la plus grande valeur de la rubrique de parcours (consultez [les remarques](#NOTE0_1) pour plus de détails).

Attention : **L'enregistrement chargé en mémoire n'est pas modifié.** Les variables HFSQL (par exemple Client.Nom, c'est-à-dire la rubrique *Nom* du fichier *Client*) ne sont pas mises à jour.

En général, la fonction **HPremier** permet de se positionner dans le fichier de données pour effectuer une boucle de lecture avec la fonction [HSuivant](../WDLang4/3044027.md).

Après l'exécution de la fonction **HPremier**, plusieurs cas peuvent se présenter :

- le fichier de données est vide ou il n'existe pas d'enregistrement correspondant au filtre (défini par la fonction [HFiltre](../WDLang4/3044100.md)) : la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u>Vrai</u></u></u>.

- la fonction tente de bloquer un enregistrement déjà bloqué en lecture : la fonction [HErreurBlocage](../WDLang4/3044099.md) renvoie <u><u><u>Vrai</u></u></u> et la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u>Vrai</u></u></u>.
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : La gestion des blocages n'est pas disponible sur les bases de données accédées par JDBC. 





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
HPremier(Client, Nom)
TANTQUE HEnDehors() = Faux
	// Traitement de l'enregistrement
	HSuivant(Client, Nom)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HPremier([<Fichier de données> [, <Rubrique clé de parcours>] [, <Options>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le positionnement sur l'enregistrement a été effectué, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur. Ce problème peut être dû :

	- soit à un problème de positionnement (fichier de données vide, ...) : la fonction [HTrouve](../WDLang4/3044104.md) renvoie <u><u><u><u>Faux</u></u></u></u> et la fonction [HErreur](../WDLang4/3044088.md) renvoie 0.

	- soit à une erreur : la fonction [HErreur](../WDLang4/3044088.md) renvoie un entier différent de 0. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'obtenir plus de détails.







**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données manipulé. Si ce paramètre correspond à une chaîne vide (""), la fonction **HPremier** manipule le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Rubrique clé de parcours> : (Chaîne de caractères optionnelle)`**

Nom de la rubrique clé utilisée pour parcourir le fichier de données. Si ce nom n'est pas spécifié, la fonction **HPremier** va manipuler la dernière rubrique de parcours utilisée sur ce fichier de données par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H). Si cette rubrique n'existe pas, la meilleure rubrique de parcours est automatiquement utilisée.

**`<Options> : (Constante optionnelle)`**

Paramètre le blocage réalisé sur l'enregistrement sélectionné par la fonction **HPremier** :


|   |   |
| --- | --- |
| *hBlocageEcriture* | Blocage en écriture : l'enregistrement sélectionné pourra être lu par une autre application mais ne pourra pas être modifié par une autre application.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hBlocageLectureEcriture* | Blocage en lecture/écriture : l'enregistrement sélectionné ne pourra ni être lu ni être modifié par une autre application.<br>![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png) Blocage en écriture : l'enregistrement sélectionné pourra être lu par une autre application mais ne pourra pas être modifié par une autre application. Équivalent à la constante *hBlocageEcriture*.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hBlocageNon* | Aucun blocage : l'enregistrement pourra être lu ou modifié par une autre application.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hRespecteFiltre* | Le parcours prendra en compte le filtre mis en place avec la fonction [HFiltre](../WDLang4/3044100.md), même si la clé de parcours utilisée n'est pas optimisée pour le filtre. Rappel : la fonction [HFiltre](../WDLang4/3044100.md) renvoie la clé de parcours optimisée pour le filtre. <br>**Attention** : Dans ce cas, sur des fichiers de données de taille importante, des problèmes de performances peuvent survenir.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette variable ne peut pas être utilisée. |
| *hSansRafraîchir* | ![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png) Le contenu de la table ou de la requête ne sera pas rafraîchi. Toutes les positions sauvegardées sont conservées.  Si ce paramètre n'est pas précisé, la fonction **HPremier** réinitialise le parcours pour la rubrique spécifiée : le contenu de la table ou de la requête est rafraîchi avec les données de la base de données OLE DB. Toutes les positions sauvegardées sont perdues. La restauration de la position sera effectuée à partir de la valeur de la meilleure rubrique. <br>Remarque : Les parcours et les positions sauvegardées sur les autres rubriques ne sont jamais affectés. |

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : La gestion des blocages n'est pas disponible sur les bases de données accédées par JDBC.![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Si le provider OLE DB ou le Connecteur Natif utilisé ne gère pas les blocages, les options de blocage seront sans effet.![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png) Le mode de blocage spécifié avec la fonction **HPremier** restera effectif lors des appels aux fonctions [HPrécédent](../WDLang4/3044112.md) et [HSuivant](../WDLang4/3044027.md).

Pour modifier le mode de blocage, il est nécessaire d'utiliser :

- soit les fonctions [HRecherchePremier](../WDLang4/3044125.md) ou [HRechercheDernier](../WDLang4/3044129.md),

- soit les fonctions **HPremier** ou [HDernier](../WDLang4/3044101.md).

- soit les fonctions [HBloqueNumEnr](../WDLang4/3044152.md) ou [HDébloqueNumEnr](../WDLang4/3044194.md).


![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Oracle : il est possible de spécifier un mode de blocage différent pour chaque enregistrement. Cependant, si une transaction a été démarrée à l'aide de la fonction [SQLTransaction](../WDLang4/3072029.md) avant de procéder au blocage, le blocage ne sera relâché qu'à la fin de la transaction (fonction [SQLTransaction](../WDLang4/3072029.md) avec la constante *<u><u><u><u>sqlFin</u></u></u></u>* ou *<u><u><u><u>sqlAnnule</u></u></u></u>*).![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Les options de blocage ne sont pas prises en compte. Utilisez des fonctions de blocage (fonction [HBloqueNumEnr](../WDLang4/3044152.md)) conservées par compatibilité.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Lecture selon une clé
<a name="lecture_selon_une_cle_ELTPARAGRAPHE000303"></a>La fonction **HPremier** positionne sur l'enregistrement pour lequel la valeur de la clé est la plus petite.

L'ordre de tri pris en compte est l'ordre de tri spécifié dans l'analyse pour cette clé.

En cas de doublons, la fonction **HPremier** positionne sur le premier enregistrement "doublon" selon l'ordre des numéros d'enregistrement.
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) 

### Vérification du mot de passe
<a name="verification_mot_passe_ELTPARAGRAPHE000324"></a>Si la fonction **HPremier** est la première fonction manipulant le fichier de données spécifié, la vérification du mot de passe est effectuée lors de l'ouverture du fichier de données.

Si le mot de passe est incorrect, la fonction [HErreurMotDePasse](../WDLang4/3044082.md) renvoie <u><u><u><u>Vrai</u></u></u></u> et la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u><u>Vrai</u></u></u></u>.
<a name="NOTE0_3"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000352"></a>

- Le numéro de l'enregistrement en cours est connu avec la fonction [HNumEnr](../WDLang4/3044063.md).

- La fonction [HChangeClé](../WDLang4/3044151.md) permet de modifier la clé de parcours, tout en restant positionné sur l'enregistrement en cours.



<a name="NOTE0_4"></a>


### Comparaison des fonctions [HLitPremier](../WDLang4/3044051.md) et HPremier
<a name="comparaison_des_fonctions_hlitpremierwdlang43044051md_docparampagetitleshort_ELTPARAGRAPHE000368"></a>La fonction **HPremier** ne lit pas l'enregistrement : la fonction **HPremier** est donc plus rapide que la fonction [HLitPremier](../WDLang4/3044051.md).
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Blocages
<a name="blocages_ELTPARAGRAPHE000393"></a>Par défaut (paramètre &lt;Option&gt; non spécifié), aucun blocage de l'enregistrement n'est réalisé.

Si un blocage est demandé (constantes *hBlocageEcriture* ou *hBlocageLectureEcriture*), le positionnement sur l'enregistrement sera réalisé uniquement si cet enregistrement n'est pas déjà bloqué.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
