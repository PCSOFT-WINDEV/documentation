
## Le fichier .REP
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000291"></a>
Le fichier .REP permet de conserver la liste des fichiers de données manipulés par l'application. 

Ce fichier .REP peut être manipulé par programmation grâce aux fonctions du WLangage. 





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## .REP ou liste des fichiers ?
<a name="rep_liste_des_fichiers_ELTTEXTE000321"></a>
Le fichier &lt;MonProjet&gt;.REP est un fichier contenant la liste des fichiers manipulés par l'application (identifiant, nom logique et chemin complet du fichier physique).

Le GUID de l'analyse est l'identifiant unique de l'analyse liée au projet, contenant la description des fichiers. Cet identifiant peut être connu sous l'éditeur d'analyses, dans la description de l'analyse (onglet "Options").

Le GUID du fichier correspond à l'identifiant du fichier logique. Cet identifiant peut être connu sous l'éditeur d'analyses, dans la description du fichier (onglet "Notes").
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=fichier_Rep.gif)


Ce fichier est automatiquement créé dans le répertoire de l'application et renseigné par le moteur HFSQL.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## A quoi sert le fichier .REP ?
<a name="quoi_sert_fichier_rep_ELTTEXTE000345"></a>
Le fichier ".REP" permet de localiser facilement les fichiers de données qui ont été utilisés par l'application WINDEV ou WINDEV Mobile.

L'application WINDEV met à jour automatiquement le fichier ".REP", mais ne se sert pas (ou rarement) du fichier ".REP".

Ce fichier est utilisé par tous les outils devant manipuler les fichiers de données de l'application, et principalement par la mise à jour automatique des fichiers de données, etc.


<a name="NOTE3_2"></a>


### Exemple : Mise à jour d'une application avec modification de l'analyse
<a name="exemple_mise_jour_une_application_avec_modification_analyse_ELTPARAGRAPHE000047"></a>Lors de la mise à jour d'une application WINDEV, la modification automatique des fichiers de données est automatiquement lancée en cas de modifications sur la structure de la base de données.

Cette procédure utilise le fichier ".REP" pour retrouver les fichiers physiques utilisés par l'application afin de les modifier.

Pour plus de détails, consultez : [La modification automatique des fichiers de données](../WDLang4/3044195.md)



<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Manipuler le fichier .REP par programmation
<a name="manipuler_fichier_rep_par_programmation_ELTTEXTE000375"></a>


### Gestion du fichier .REP ou de la liste des fichiers de données
<a name="gestion_fichier_rep_liste_des_fichiers_donnees_ELTPARAGRAPHE000063"></a>


|   |   |
| --- | --- |
| [HGèreREP](../WDLang4/3044061.md) | Active ou désactive la gestion du fichier .REP<br><br>Lors de l'activation de la gestion du .REP, il est possible de donner le nom et le chemin du fichier .REP. Un fichier HFREP.INI sera alors créé dans le répertoire des données communes de l'application (répertoire \\Application Data\\PC SOFT).   Par défaut, la gestion du fichier ".REP" est activée. |




<a name="NOTE4_2"></a>


### Création et modification du fichier .REP (ou de la liste des fichiers de données)
<a name="creation_modification_fichier_rep_liste_des_fichiers_donnees_ELTPARAGRAPHE000078"></a>


|   |   |
| --- | --- |
| [HCréation](../WDLang4/3044255.md) | Crée un fichier de données physique. Cette fonction renseigne le fichier .REP si la gestion du .REP est activée. |
| [HCréationSiInexistant](../WDLang4/3044254.md) | Crée un fichier de données physique s'il n'existe pas déjà.<br><br>Cette fonction renseigne le fichier .REP si la gestion du .REP est activée et si la constante *hOuvertureDifférée* n'est pas utilisée. Si la constante *hOuvertureDifférée* est utilisée, le .REP sera mis à jour lors de l'ouverture automatique du fichier lors du premier accès au fichier. |
| [HOuvre](../WDLang4/3044120.md) | Ouvre un fichier de données physique et renseigne le fichier .REP si nécessaire |


**Remarque** : Les informations données par les fonctions [HChangeRep](../WDLang4/3044168.md), [HSubstRep](../WDLang4/3044028.md) et [HChangeNom](../WDLang4/3044141.md) sont prises en compte lors de la création et de la mise à jour du fichier ".REP".


<a name="NOTE4_3"></a>


### Lecture du fichier .REP
<a name="lecture_fichier_rep_ELTPARAGRAPHE000115"></a>


|   |   |
| --- | --- |
| [HListeREP](../WDLang4/3044229.md) | Liste les différents fichiers et leur chemin physique associé présents dans le fichier .REP |




<a name="NOTE4_4"></a>


### Écriture dans le fichier
<a name="ecriture_dans_fichier_ELTPARAGRAPHE000127"></a>Pour écrire dans le fichier .REP, il suffit d'utiliser les fonctions de gestion de fichiers externes :

- [fOuvre](../WDLang1/3036036.md) : pour ouvrir le fichier

- [fEcritLigne](../WDLang1/3036025.md) : pour écrire une nouvelle ligne dans le fichier

- [fFerme](../WDLang1/3036027.md) : pour fermer le fichier




La structure de la ligne ajoutée doit suivre la norme suivante :


|   |   |   |   |   |   |
| --- | --- | --- | --- | --- | --- |
| **LOCALIZATION=** | GUID Fichier | *Tabulation* | Nom logique fichier | *Tabulation* | Chemin du fichier physique |






|   |   |   |   |   |   |   |
| --- | --- | --- | --- | --- | --- | --- |
| **LOCALISATION_CS=** | GUID Fichier | *Tabulation* | Nom logique du fichier | *Tabulation* | Localisation physique du fichier dans le serveur HFSQL | *Tabulation* |
|   | NomServeur:Port | *Tabulation* | IPServeur:Port | *Tabulation* | Base de données |   |

**Dans une application en Unicode**, LOCALISATION_CS est remplacé par LOCALISATION_CS_UTF8 : les différentes chaînes sont encodées en UTF8.

Le GUID du fichier correspond à l'identifiant du fichier de données logique. Cet identifiant peut être connu sous l'éditeur d'analyses, dans la description du fichier de données (onglet "Notes").

Deux propriétés du WLangage permettent de connaître le GUID d'un fichier de données et de l'analyse qui l'a créé :


|   |   |
| --- | --- |
| [GUIDAnalyse](../Proprietes/2512098.md) | Renvoie le GUID de l'analyse qui a permis de créer le fichier de données. |
| [GUIDFichier](../Proprietes/2512099.md) | Renvoie le GUID du fichier défini dans l'analyse qui a permis de créer le fichier de données. |





<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Structure du fichier .REP
<a name="structure_fichier_rep_ELTTEXTE000417"></a>


### Structure du fichier .REP
<a name="structure_fichier_rep_ELTPARAGRAPHE000207"></a>La structure du fichier .REP est la suivante :

- La première ligne comprend les informations concernant l'analyse dans laquelle les fichiers de données ont été décrits. Cette analyse correspond à l'analyse du projet en cours.
	La structure de cette ligne est la suivante :
	


|   |   |
| --- | --- |
| **ANALYSISGUID=** | GUID Analyse |


	Le GUID de l'analyse est l'identifiant unique de l'analyse liée au projet, contenant la description des fichiers de données. Cet identifiant peut être connu sous l'éditeur d'analyses, dans la description de l'analyse (onglet "Options").

- Les lignes suivantes décrivent les différents fichiers de données manipulés par l'application. Une ligne est créée par fichier de données physique manipulé. Cette ligne comprend les informations suivantes :
	


|   |   |   |   |   |   |
| --- | --- | --- | --- | --- | --- |
| **LOCALIZATION=** | GUID Fichier | Tabulation | Nom logique fichier de données | Tabulation | Chemin du fichier de données physique |


	Le GUID du fichier correspond à l'identifiant du fichier logique. Cet identifiant peut être connu sous l'éditeur d'analyses, dans la description du fichier de données (onglet "Notes"). 




Exemple de fichier .REP : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Rep_structure.gif)





