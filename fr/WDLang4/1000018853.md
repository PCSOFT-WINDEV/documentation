


## hPlanification (Type de variable)

***En anglais : hScheduling***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **hPlanification** permet de définir et de connaître les caractéristiques de la planification à effectuer : 

- pour une tâche d'optimisation de fichiers HFSQL Client/Serveur planifiée. 

- pour une tâche de sauvegarde de fichiers HFSQL Client/Serveur planifiée.

- pour une réplication de serveurs HFSQL planifiée.


Les caractéristiques de cette planification peuvent être définies et modifiées à l'aide de différentes propriétés WLangage. 

Ce type de variable est utilisé : 

- par le type [hOptimisationPlanifiée](../WDLang4/1000018854.md). 

- par le type [hDescriptionSauvegarde](../WDLang4/1000017455.md). 

- par le type [hRSConfig](../WDLang4/1000020484.md).




**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Recalculer les statistiques des fichiers de la base de données "MaBase", 
// tous les samedis à 23H00
Optim est une hOptimisationPlanifiée
Optim.Description = "Recalcul des statistiques des fichiers" + ...  
	"de la base de données MaBase"

// Définition de la planification
MaPlanification est une hPlanification
MaPlanification.Mois = "*"
MaPlanification.JourDeLaSemaine = "samedi"
MaPlanification.Heure = "23"
MaPlanification.Minute = "0"

Optim.Planification = MaPlanification

// Définition des fichiers à traiter
Optim.Fichier[1].Nom = "MaBase"
Optim.Fichier[1].Option = hOptStat

// Ajout de l'optimisation planifiée
HAjouteOptimisationPlanifiée(MaConnexion, Optim)
```

<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Propriétés spécifiques à la description des variables de type hPlanification
<a name="proprietes_specifiques_description_des_variables_type_hplanification_ELTPARAGRAPHE000060"></a>Les propriétés suivantes peuvent être utilisées pour manipuler une planification :

| **Nom de la propriété** | **Type manipulé** | **Effet** |
| --- | --- | --- |
| Heure | Chaîne de caractères | Heure d'exécution de la tâche planifiée. Si la propriété **HeureUTC** est à <u><u><u><u>Vrai</u></u></u></u>, cette heure est au format UTC (temps universel).<br><br>Les valeurs possibles sont :<br><br>- un chiffre compris entre 0 et 23.<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs heures.<br><br>- un intervalle. Par exemple "9-13".<br><br>- une étoile "\*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "\*/2" pour lancer la tâche à toutes les heures paires.<br><br><br> |
| HeureUTC | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> (valeur par défaut) si l'heure est exprimée en heure UTC, c'est-à-dire en temps universel (propriétés **Heure** et **Minute**),<br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.<br><br><br> |
| JourDeLaSemaine | Chaîne de caractères | Numéro du jour de la semaine pour lequel la tâche planifiée doit être exécutée (par exemple "2"). Ce nombre est compris entre 1 et 7 (1 = Lundi, 2 = Mardi, ...). <br>Cette propriété peut également correspondre à :<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs jours.<br><br>- un intervalle. Par exemple "1-3" (la tâche est planifiée pour Lundi, Mardi et Mercredi).<br><br>- une étoile "\*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "\*/2" pour lancer la tâche à tous les jours de la semaine pairs.<br><br>- le jour de la semaine en toutes lettres ("lundi", "mardi", "mercredi", "jeudi", "vendredi").<br><br><br> |
| JourDuMois | Chaîne de caractères | Numéro du jour du mois pour lequel la tâche planifiée doit être exécutée (par exemple "31"). Ce nombre est compris entre 0 et 31.<br><br>Cette propriété peut également correspondre à :<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs mois.<br><br>- un intervalle. Par exemple "9-13" (la tâche est planifiée du 9 au 13 du mois).<br><br>- une étoile "\*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "\*/2" pour lancer la tâche à tous les jours impairs du mois.<br><br><br> |
| JourDuMoisOuDeLaSemaine | Booléen | Permet de gérer l'exécution d'une tâche planifiée sur le serveur HFSQL Client/Serveur en précisant le numéro de jour de la semaine ou le numéro de jour du mois. Exemple : exécution tous les lundis 1er jour du mois.<br>Cette propriété peut correspondre à : <br><br>- <u><u><u><u>Vrai</u></u></u></u> pour exécuter la tâche planifiée tous les lundis ET le premier jour du mois (conditions cumulées).<br><br>- <u><u><u><u>Faux</u></u></u></u> pour exécuter la tâche uniquement les lundis 1er (conditions exclusives).<br><br><br> |
| Minute | Chaîne de caractères | Minutes de l'heure d'exécution de la tâche planifiée. Si la propriété **HeureUTC** est à <u><u><u><u>Vrai</u></u></u></u>, cette heure est au format UTC (temps universel).<br><br>Les valeurs possibles sont :<br><br>- un chiffre compris entre 0 et 59.<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs minutes.<br><br>- un intervalle. Par exemple "9-13".<br><br>- une étoile "\*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "\*/2" pour lancer la tâche à toutes les minutes paires.<br><br><br> |
| Mois | Chaîne de caractères | Numéro du mois d'exécution de la tâche planifiée. Les valeurs possibles sont :<br><br>- un chiffre compris entre 1 et 12<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs mois.<br><br>- un intervalle. Par exemple, "9-11".<br><br>- une étoile "\*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "\*/2" pour lancer la tâche tous les mois impairs.<br><br><br> |






