


## HExporteJSON (Fonction)

***En anglais : HExportJSON***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Exporte les enregistrements d'un fichier de données (HFSQL ou OLE DB), d'une vue ou d'une requête dans un fichier JSON.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Exporte tous les clients 
HExporteJSON(CLIENT, "C:\TEMP\Client.json", hExpCréation)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HExporteJSON(<Fichier de données> [, <Fichier JSON> [, <Rubriques à exporter>]] [, <Options> [, <Jauge>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données, de la vue ou de la requête manipulé. Si ce nom n'est pas spécifié, la fonction **HExporteJSON** va manipuler le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Fichier JSON> : (Chaîne de caractères optionnelle)`**

Chemin complet du fichier JSON à générer.

**`<Rubriques à exporter> : (Chaîne de caractères optionnelle)`**

Liste des noms des rubriques à exporter. Les noms sont délimités par de simples quotes, et séparées par des virgules ou des RC. Les noms des rubriques de type clé composée, binaire, mémo binaire sont ignorées.
Si ce paramètre correspond à une chaîne vide (""), toutes les rubriques du fichier de données (sauf rubriques de type clé composée, binaire, mémo binaire et mot de passe) sont exportées.

**`<Options> : (Constante optionnelle)`**

Indique le mode de création du fichier JSON :


|   |   |
| --- | --- |
| *hExpCréation* | Si le fichier d'exportation JSON existe, il est écrasé. Si cette option n'est pas précisée et que le fichier JSON existe, une erreur est générée. |
| *hExpInterruptible* | L'exportation peut être interrompue par la touche Echap du clavier. <br>Si l'exportation est interrompue, le fichier JSON est valide et contient uniquement les enregistrements exportés avant interruption. |
| *hExpNormal*<br>(valeur par défaut) | Fonctionnement normal. |



**`<Jauge> : (Nom de champ ou nom de fenêtre optionnel)`**

Nom du champ de type Jauge ou nom de la fenêtre permettant de visualiser la progression de la création du fichier JSON.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Exporter le contenu d'une requête
<a name="exporter_contenu_une_requete_ELTPARAGRAPHE000125"></a>Pour exporter le contenu d'une requête, il est nécessaire d'initialiser la requête (fonction [HExécuteRequête](../WDLang4/3044080.md)) avant d'utiliser la fonction **HExporteJSON**.
<a name="NOTE0_2"></a>


### Exporter un seul enregistrement
<a name="exporter_seul_enregistrement_ELTPARAGRAPHE000140"></a>Pour exporter un seul enregistrement vers une chaîne JSON, utilisez la fonction [HEnregistrementVersJSON](../WDLang4/1000021909.md).
<a name="NOTE0_3"></a>


### Rubriques tableau
<a name="rubriques_tableau_ELTPARAGRAPHE000152"></a>Si une des rubriques exportées est une rubrique de type Tableau, chaque élément de la rubrique tableau est exportée dans un nouveau niveau :

```txt
{"Fichier":
	{
	"Rubrique1":Donnée de la rubrique 1,
	"Rubrique2":Donnée de la rubrique 2,
	"RubriqueTab":
		[Donnée élément 1, Donnée élément 2, ...]
	...
	}
}
```

**Rappel** : Les rubriques de type clé composée, mémo binaire, binaire ou mot de passe sont ignorées.

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
