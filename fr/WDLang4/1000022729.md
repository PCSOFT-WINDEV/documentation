


## &lt;Variable Connexion&gt;.NotifListeDestinataireEmail (Fonction)

***En anglais : &lt;Connection variable&gt;.NotifListEmailRecipient***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie la liste des destinataires d'une notification par email. Cette notification est envoyée par le serveur HFSQL lorsqu'il rencontre un problème. 

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
cnxConnexionCS est une Connexion
cnxConnexionCS.Provider = hAccèsHFClientServeur
cnxConnexionCS.Utilisateur = "admin"
cnxConnexionCS.MotDePasse = ""
cnxConnexionCS.Serveur = "test:4900"
cnxConnexionCS.OuvreConnexion()

ListeDestEmail est une chaîne
ListeDestEmail = cnxConnexionCS.NotifListeDestinataireEmail()

POUR TOUT CHAÎNE UnDestinataire DE ListeDestEmail SEPAREE PAR RC
	sDestinataire est une chaîne = ExtraitChaîne(UnDestinataire, 1, TAB)
	Notif est un entier = ExtraitChaîne(UnDestinataire, 2, TAB)
	NiveauNotif est une chaîne
	SELON Notif
		CAS hNotifErreur : NiveauNotif = "Niveau minimal : Erreurs"
		CAS hNotifAvertissement : NiveauNotif = "Niveau minimal : Avertissement"
		CAS hNotifCritique : NiveauNotif = "Niveau minimal : Critique"			
	FIN
	Trace(sDestinataire + TAB + NiveauNotif)
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = <Connexion>.NotifListeDestinataireEmail()`
---

**`<Résultat> : (Chaîne de caractères)`**

Liste des destinataires de la notification par email. La liste est de la forme : 

```txt
<Adresse email du destinataire> + TAB + <Niveau de notification> + RC + ...
```

où : 

- &lt;Adresse email du destinataire&gt; : chaîne de caractères correspondant à l'adresse email du destinataire. 

- &lt;Niveau de notification&gt; : constante de type entier correspondant au niveau minimum de gravité du problème à partir duquel une notification est envoyée. Les valeurs disponibles sont les suivantes : 
	


|   |   |
| --- | --- |
| *hNotifAvertissement* | Les notifications seront envoyées dès le niveau avertissement (pour les problèmes de type avertissement, critique et erreur). |
| *hNotifCritique* | Les notifications seront envoyées dès le niveau critique (pour les problèmes de type critique et erreur). |
| *hNotifErreur* | Les notifications seront envoyées seulement pour les problèmes de type erreur. |






**`<Connexion> : (Variable de type Connexion)`**

Nom de la variable de type [Connexion](../WDLang4/1514073.md) décrivant la connexion à manipuler.



<a name="XComposante"></a>

## Composante :
wd280hf.dll
