


## &lt;Variable Connexion&gt;.RécupèreSauvegarde (Fonction)

***En anglais : &lt;Connection variable&gt;.RetrieveBackup***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère en local le contenu d'une sauvegarde compressée (au format ZIP) réalisée sur un serveur HFSQL.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Description de la connexion
MaConnexion est une Connexion

MaConnexion.RécupèreSauvegarde(idSauvegarde, "C:\temp\MonFichier.zip", JAUGE_Progress)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = <Connexion>.RécupèreSauvegarde(<Sauvegarde> , <Fichier destination> [, <Jauge>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la sauvegarde a été récupérée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur.




**`<Connexion> : (Variable de type Connexion)`**

Nom de la variable de type [Connexion](../WDLang4/1514073.md) décrivant la connexion vers le serveur contenant la sauvegarde à récupérer.

**`<Sauvegarde> : (Entier ou chaîne de caractères)`**

Sauvegarde à récupérer. Peut correspondre à :

- **Identifiant de la sauvegarde**. Cet identifiant peut correspondre à l'identifiant d'une sauvegarde complète ou d'une sauvegarde différentielle. 
	Lors d'une sauvegarde immédiate, cet identifiant est renvoyé par la fonction [&lt;Variable Connexion&gt;.Sauvegarde](../WDLang4/1000022752.md). Cet identifiant peut également être obtenu grâce à la fonction [&lt;Variable Connexion&gt;.InfoSauvegarde](../WDLang4/1000022679.md).
	Lors d'une sauvegarde planifiée, cet identifiant correspond à la propriété **Identifiant** de la variable [hDescriptionSauvegarde](../WDLang4/1000017455.md). 

- **Chemin et nom de la sauvegarde**. Ce nom a été spécifié lors de la sauvegarde. Ce nom peut également être obtenu grâce à la fonction [&lt;Variable Connexion&gt;.InfoSauvegarde](../WDLang4/1000022679.md). Si ce nom correspond à un chemin relatif, la sauvegarde sera recherchée dans le sous-répertoire "Backup" du serveur HFSQL. Pour spécifier le répertoire du service Manta, il suffit d'utiliser la chaîne de caractères "%%EXE%%".




**`<Fichier destination> : (Chaîne de caractères)`**

Chemin et nom du fichier local dans lequel la sauvegarde va être récupérée.

Dans le cas d'une sauvegarde complète, le fichier destination est un fichier au format zip (l'extension ".zip" doit être précisée dans le nom du fichier.

**`<Jauge> : (Nom de champ optionnel, nom de fenêtre optionnel ou entier optionnel)`**



- Nom de la fenêtre dans laquelle la jauge doit être affichée ou nom du champ de type Jauge.

- Identifiant (Handle) de la fenêtre qui affiche la jauge.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Droits nécessaires pour récupérer une sauvegarde
<a name="droits_necessaires_pour_recuperer_une_sauvegarde_ELTPARAGRAPHE000243"></a>Pour récupérer une sauvegarde, l'utilisateur ou le groupe doit posséder le droit de faire des sauvegardes (constante *hDroitSauvegarde*). Ce droit s'applique aux serveurs et aux bases de données. Par exemple, pour faire une sauvegarde du serveur complet, il faut posséder le droit de faire des sauvegardes au niveau du serveur. 

Pour savoir si un utilisateur ou un groupe possède ces droits, utilisez la fonction [&lt;Variable Connexion&gt;.InfoDroitServeur](../WDLang4/1000022668.md) ou [HInfoDroitDaseDeDonnées](../WDLang4/1000022666.md).

Pour modifier les droits d'un utilisateur ou d'un groupe d'utilisateurs, utilisez la fonction [&lt;Variable Connexion&gt;.ModifieDroitServeur](../WDLang4/1000022710.md) ou [&lt;Variable Connexion&gt;.ModifieDroitBaseDeDonnées](../WDLang4/1000022707.md).

<a name="XComposante"></a>

## Composante :
wd280hf.dll
