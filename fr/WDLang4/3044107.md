


## HOuvreConnexion (Fonction)

***En anglais : HOpenConnection***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ouvre une connexion à une base de données spécifique. La connexion reste ouverte jusqu'à l'appel de la fonction [HFermeConnexion](../WDLang4/3044095.md). La fonction **HOuvreConnexion** permet de :

- ouvrir une connexion prédéfinie.

- définir et ouvrir une connexion. Il est ensuite nécessaire d'affecter cette connexion à un fichier de données avec la fonction [HChangeConnexion](../WDLang4/3044150.md).

- définir et ouvrir une connexion en utilisant une chaîne de connexion. Cette syntaxe peut être utilisée avec certains providers OLE DB ayant des chaînes de connexion ADO spécifique.
	
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette option n'est pas disponible.

- ouvrir une connexion définie avec une variable de type [Connexion](../WDLang4/1514073.md).


**Attention** : L'ordre d'utilisation des fonctions permettant de se connecter à une base de données HFSQL Client/Serveur est important. Consultez [Optimiser les temps de connexion aux bases HFSQL Client/Serveur](../WDLang4/9000176.md) pour plus de détails.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003044107&name=houvreconnexion_fonction&product=WD">Voir des exemples supplémentaires</a>
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 
```wl
MaConnexion est une Connexion
// Description de la connexion 
MaConnexion.Utilisateur = "USER" 
MaConnexion.MotDePasse = "PASSWORD" 
MaConnexion.Serveur = "MONSERVEUR" 
MaConnexion.BaseDeDonnées = "Base de données" 
MaConnexion.Provider = hAccèsHFClientServeur 
MaConnexion.Accès = hOLectureEcriture 
MaConnexion.InfosEtendues = "Infos étendues" 
MaConnexion.OptionsCurseur = hCurseurClient 

HOuvreConnexion(MaConnexion)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Ouvrir une connexion prédéfinie

`<Résultat> = HOuvreConnexion(<Connexion>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème (par exemple, lors d'une connexion décrite par programmation, certains paramètres utilisés dans la fonction [HDécritConnexion](../WDLang4/3044205.md) peuvent être inexacts).




La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur.

**`<Connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion à une base de données. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses, 

- soit au nom de la connexion définie par la fonction [HDécritConnexion](../WDLang4/3044205.md). La description de la connexion doit être connue au moment de l'exécution de la fonction.

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md). 





<a name="SYNTAXE2"></a>

### Définir et ouvrir une connexion

`<Résultat> = HOuvreConnexion(<Nouvelle connexion> , <Utilisateur> [, <Mot de passe>] , <Source de données> [, <Base de données>] , <Provider OLE DB ou Connecteur Natif> [, <Accès> [, <Informations étendues> [, <Options supplémentaires>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur. Pour affecter cette connexion à un fichier, utilisez la fonction [HChangeConnexion](../WDLang4/3044150.md). La description de la connexion sera détruite lors de la fermeture de la connexion.




**`<Nouvelle connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Nom de la nouvelle connexion à définir et à ouvrir. Ce nom ne doit pas être déjà utilisé par une autre connexion (connexion définie dans l'analyse, ou définie avec la fonction **HOuvreConnexion** ou [HDécritConnexion](../WDLang4/3044205.md)).

Ce paramètre correspond à la propriété [Nom](../Proprietes/2510082.md) utilisée sur une variable de type [Connexion](../WDLang4/1514073.md).

**`<Utilisateur> : (Chaîne de caractères)`**

Nom de l'utilisateur utilisé pour la base de données. Ce paramètre peut être modifié et récupéré grâce à la propriété [Utilisateur](../Proprietes/2512107.md) utilisée sur une variable de type [Connexion](../WDLang4/1514073.md).

**`<Mot de passe> : (Chaîne de caractères optionnelle)`**

Mot de passe de la connexion (si ce mot de passe existe). Si aucun mot de passe n'est nécessaire, utilisez une chaîne vide ("") ou le mot-clé NULL. Ce paramètre peut être modifié grâce à la propriété [MotDePasse](../Proprietes/2510086.md) utilisée sur une variable de type [Connexion](../WDLang4/1514073.md).

**`<Source de données> : (Chaîne de caractères)`**

Chemin complet de la source de données. La connexion sera créée et ouverte pour cette source de données.

Ce paramètre peut être connu et modifié grâce à la propriété [Source](../Proprietes/2510147.md) (ou [Serveur](../Proprietes/2512105.md)) utilisée sur une variable de type [Connexion](../WDLang4/1514073.md).
![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Ce paramètre correspond au nom du serveur. Il est possible de préciser le numéro de port utilisé par le serveur HFSQL. Par défaut, le numéro de port utilisé est 4900. Si le numéro de port du serveur HFSQL est différent, utilisez la notation suivante : 
&lt;Nom du poste&gt; : &lt;Numéro de port&gt; 
Exemple : "NomPoste:4901". 
Pour une utilisation via Internet, une gestion des ports avec Firewall est nécessaire. Pour plus de détails, consultez [Gestion des ports](../WDLang4/3044334.md). 
Il est possible d'indiquer une adresse IPv6 en écrivant l'adresse IPv6 entre des crochets. Dans ce cas, le numéro de port doit être indiqué après le crochet fermant. Par exemple : [0154:2145:2155::5554]:4900. ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : 

- Ce paramètre doit correspondre à l'URL de connexion à la base de données. Cet URL est spécifique à chaque driver.

- Selon le driver JDBC utilisé, il est nécessaire de spécifier le nom de la base de données dans l'URL de connexion.




**`<Base de données> : (Chaîne de caractères optionnelle)`**

Nom de la base de données à utiliser sur la source de données. Si ce paramètre n'est pas nécessaire, utilisez une chaîne vide ("").

Ce paramètre peut être connu et modifié grâce à la propriété [BaseDeDonnées](../Proprietes/2512101.md) utilisée sur une variable de type [Connexion](../WDLang4/1514073.md).

Dans le cas d'une base de données découpée en schémas, le nom du schéma dans la base de données sera précisé par la fonction [HChangeNom](../WDLang4/3044141.md).

Si cette base de données n'existe pas, cette base sera automatiquement créée.

![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) DB2 : Ce paramètre n'est pas nécessaire.

**`<Provider OLE DB ou Connecteur Natif> : (Chaîne de caractères ou Constante)`**



- Nom du provider OLE DB utilisé. Pour retrouver facilement la chaîne à utiliser, utilisez l'option "Connexion" de l'éditeur d'analyses (voir Notes).
	ou

- une des constantes suivantes :
	


|   |   |
| --- | --- |
| *hAccèsHF7* | Pseudo-connexion à une base de données HFSQL Classic. |
| *hAccèsHFClientServeur* | Connecteur Natif à une base de données HFSQL Client/Serveur. |
| *hAccèsNatifAS400* | Connecteur Natif AS/400 (module optionnel de WINDEV/WEBDEV). |
| *hAccèsNatifDB2* | Connecteur Natif DB2 (module optionnel de WINDEV/WEBDEV). |
| *hAccèsNatifInformix* | Connecteur Natif Informix (module optionnel de WINDEV/WEBDEV). |
| *hAccèsNatifMariaDB* | Connecteur Natif MariaDB (module optionnel de WINDEV/WEBDEV). |
| *hAccèsNatifMySQL* | Connecteur Natif MySQL (module optionnel de WINDEV/WEBDEV). |
| *hAccèsNatifOracle* | Connecteur Natif Oracle (module optionnel de WINDEV/WEBDEV). |
| *hAccèsNatifOracleLite* | Connecteur Natif Oracle (module optionnel de WINDEV Mobile). |
| *hAccèsNatifPostgreSQL* | Connecteur Natif PostgreSQL (module optionnel de WINDEV/WEBDEV). |
| *hAccèsNatifProgress* | Connecteur Natif Progress (module optionnel de WINDEV/WEBDEV). |
| *hAccèsNatifSQLAzure* | Connecteur Natif SQL Azure (module optionnel de WINDEV/WEBDEV, fourni avec le Connecteur Natif SQL Server). |
| *hAccèsNatifSQLite* | Connecteur Natif SQLite (fourni en standard avec WINDEV/WEBDEV). |
| *hAccèsNatifSQLServer* | Connecteur Natif SQL Server (module optionnel de WINDEV/WEBDEV)<br>Par défaut, l'ancien Connecteur Natif est utilisé. Pour forcer l'utilisation du nouveau Connecteur Natif SQL Server, utilisez la variable [H.ModeSQLServer](../WDLang4/3044276.md). |
| *hAccèsNatifSQLServerMobile* | Connecteur Natif SQL Server Mobile (module optionnel de WINDEV Mobile). |
| *hAccèsNatifSybase* | Connecteur Natif Sybase (module optionnel de WINDEV/WEBDEV). |
| *hAccèsNatifXBase* | Connecteur Natif xBase (fourni en standard avec WINDEV/WEBDEV). |
| *hAccèsNatifXML* | Connecteur Natif XML (fourni en standard avec WINDEV/WEBDEV). |
| *hODBC* | Provider OLE DB pour ODBC (permet d'accéder à une source de données ODBC déclarée dans les sources de données ODBC de Windows). |
| *hOledbAccess97* | Provider OLE DB pour Access 97. |
| *hOledbAccess2000* | Provider OLE DB pour Access 2000. |
| *hOledbAccess2007* | Provider OLE DB pour Access 2007. |
| *hOledbAccess2010* | Provider OLE DB pour Access 2010. |
| *hOledbDBase5* | Provider OLE DB pour DBase 5. |
| *hOledbExcel97* | Provider OLE DB pour Excel 97. |
| *hOledbExcel2000* | Provider OLE DB pour Excel 2000. |
| *hOledbExcel2007* | Provider OLE DB pour Excel 2007. |
| *hOledbLotus4* | Provider OLE DB pour Lotus 4. |
| *hOledbOracle* | Provider OLE DB pour Oracle. |
| *hOledbSQLServer* | Provider OLE DB pour SQL Server |


	
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les constantes disponibles sont les suivantes :


![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png) Attention : Pour utiliser une connexion OLE DB il est nécessaire : 

- d'installer le MDAC version 2.6 minimum (installation réalisée avec WINDEV/WEBDEV et lors de la création de la version Client).

- d'installer le provider OLE DB correspondant à la base de données manipulée. 
	Ce paramètre peut être récupéré grâce à la propriété [CxProviderOLEDB](../Proprietes/2512033.md).


Ce paramètre peut être connu et modifié grâce à la propriété [Provider](../Proprietes/2512104.md) utilisée sur une variable de type [Connexion](../WDLang4/1514073.md).

**`<Accès> : (Constante optionnelle)`**

Paramètre le type d'accès à la base.


|   |   |
| --- | --- |
| *hOLecture* | La base de données est accessible uniquement en lecture. Seule la lecture des enregistrements est possible. Il n'est pas possible d'en ajouter ou d'en supprimer.<br><br>![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Cette constante est ignorée. |
| *hOLectureEcriture*<br>(valeur par défaut) | La base de données est accessible en lecture et en écriture. Il est possible aussi bien de lire des enregistrements que d'écrire de nouveaux enregistrements. |

Ce paramètre peut être connu et modifié grâce à la propriété [Accès](../Proprietes/2512100.md) utilisée sur une variable de type [Connexion](../WDLang4/1514073.md).

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Ce paramètre est ignoré.



**`<Informations étendues> : (Chaîne de caractères optionnelle)`**

Informations optionnelles insérées dans la chaîne de connexion à la base de données. Si des mots-clés spécifiques sont reconnus, les informations correspondantes sont extraites de la chaîne de connexion. Le reste de la chaîne de connexion est envoyé à la base de données. Les paramètres extraits sont ensuite traités spécifiquement par le Connecteur Natif ou OLE DB utilisé. 
Ces mots-clés doivent être indiqués de la manière suivante : "&lt;Mot-clé&gt; = &lt;Valeur&gt;;".

Il est par exemple possible de préciser le paramètre "Trusted_Connection=YES" pour utiliser une **connexion avec authentification** par le login NT.
![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Les mots-clés reconnus par OLE DB et les Connecteurs Natifs sont présentés dans la page [Informations optionnelles de connexion](../WDLang4/9000124.md). 

Exemple de chaîne à utiliser :

```wl
"WD Cache Size = 10000; Server Port=3306;"
```
![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Les mots-clés reconnus pour l'accès par HFSQL Client/Serveur :


|   |   |
| --- | --- |
| BDD_EXISTE | Teste l'existence de la base de données. Si la base de données spécifiée n'existe pas, cette base de données n'est pas créée et la fonction **HOuvreConnexion** retourne <u><u><u><u>Faux</u></u></u></u>. |
| COMPRESSION | Active ou non la compression des données transmises entre le Client et le Serveur. Ce mot-clé peut correspondre à :<br><br>- VRAI pour activer la compression des données.<br><br>- FAUX pour ne pas compresser les données.<br><br><br> |
| CRYPTAGE | Active le cryptage des informations transmises entre le Client et le Serveur. Ce mot-clé peut prendre deux valeurs :<br><br>- RAPIDE<br><br>- RC5_16 pour utiliser un cryptage RC5 à 16 boucles.<br><br>- AES128 pour utiliser un cryptage AES 128 bits avec un mode d'opération OFB.<br><br>- AES192 pour utiliser un cryptage AES 192 bits avec un mode d'opération OFB.<br><br>- AES256 pour utiliser un cryptage AES 256 bits avec un mode d'opération OFB.<br><br><br> |


Ce paramètre peut être récupéré et modifié grâce à la propriété [InfosEtendues](../Proprietes/2512041.md).![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Base de données HFSQL accédée à l'aide d'un serveur RMI : Ce paramètre correspond à l'adresse du serveur RMI et au port utilisé. Le format à utiliser est le suivant : "RMI=&lt;Adresse du serveur&gt;:&lt;Numéro du port&gt;". Par exemple : "RMI=192.168.52.148:1099".![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Ce paramètre est obligatoire. Il doit correspondre au nom complet du driver JDBC à utiliser. Ce nom est sensible à la casse.

**`<Options supplémentaires> : (Constante optionnelle)`**

Si ce paramètre n'est pas spécifié, le moteur HFSQL détermine automatiquement les meilleurs paramètres à utiliser en fonction de la base accédée et du provider OLE DB utilisé. 

Par défaut, ce paramètre correspond à la combinaison de constantes suivante : 

*hCurseurServeur* + *hCurseurOpenKeySet* + *hCurseurOptimiste* 

Toutefois, ces paramètres peuvent varier en fonction des informations retournées par la base.

Pour forcer certains paramètres, il est possible de combiner les constantes suivantes :

- **Emplacement des curseurs**
	


|   |   |
| --- | --- |
| *hCurseurClient* | Curseur géré par le MDAC. Offre souvent plus de fonctionnalités qu'un curseur serveur. Un curseur client est obligatoirement un curseur statique. |
| *hCurseurServeur* | Curseur géré par la base de données. Ce curseur peut répercuter facilement les changements effectués par d'autres utilisateurs sur les données. |



- **Type de curseur**
	


|   |   |
| --- | --- |
| *hCurseurDynamique* | Curseur offrant de nombreuses fonctionnalités, mais consommant beaucoup de mémoire. Ce curseur autorise tous les types de déplacement. Il permet d'accéder à toutes les modifications, ajouts et suppressions réalisées par les autres utilisateurs. |
| *hCurseurForwardOnly* | Curseur rapide et consommant peu de mémoire. Le déplacement se fait du premier enregistrement au dernier. Les données modifiées par les autres utilisateurs ne sont pas visibles. |
| *hCurseurOpenKeySet* | Curseur manipulant un jeu d'enregistrements figé. Seules des clés correspondant à l'enregistrement sont stockées et non les enregistrements (peu de ressources mémoire utilisées). Les enregistrements supprimés ne sont plus accessibles. Les modifications réalisées par les autres utilisateurs sont visibles (mais pas les ajouts). |
| *hCurseurStatique* | Récupère une copie de tous les enregistrements de la requête en mémoire (consommation mémoire importante). Tous les types de déplacement sont autorisés. |



- **Mode de blocage**
	


|   |   |
| --- | --- |
| *hCurseurLectureSeule* | Le jeu d'enregistrements manipulé ne pourra pas être modifié. |
| *hCurseurOptimiste* | L'enregistrement n'est verrouillé que lors de sa mise à jour |
| *hCurseurPessimiste* | L'enregistrement est verrouillé dès son édition pour être modifié. |




Attention : tous les providers OLE DB ne gèrent pas tous les types de curseur.

Ce paramètre peut être récupéré et modifié grâce à la propriété [OptionsCurseur](../Proprietes/2512103.md).




<a name="SYNTAXE3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Définir et ouvrir une connexion en définissant la chaîne de connexion

`<Résultat> = HOuvreConnexion(<Connexion> , <Chaîne de connexion ADO> [, <Accès>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur. La description de la connexion sera détruite lors de la fermeture de la connexion.




**`<Connexion> : (Chaîne de caractères)`**

Nom de la nouvelle connexion à définir et à ouvrir. Ce nom ne doit pas être déjà utilisé par une connexion (connexion définie dans l'analyse, ou définie avec la fonction **HOuvreConnexion** ou [HDécritConnexion](../WDLang4/3044205.md)).

**`<Chaîne de connexion ADO> : (Chaîne de caractères)`**

Chaîne de connexion ADO à utiliser. Pour plus de détails sur la syntaxe de cette chaîne de connexion, consultez la documentation du provider OLE DB utilisé.

**`<Accès> : (Constante optionnelle)`**

Paramètre le type d'accès à la base.


|   |   |
| --- | --- |
| *hOLecture* | La base de données est accessible uniquement en lecture. Seule la lecture des enregistrements est possible. Il n'est pas possible d'en ajouter ou d'en supprimer. |
| *hOLectureEcriture*<br>(valeur par défaut) | La base de données est accessible en lecture et en écriture. Il est possible aussi bien de lire des enregistrements que d'écrire de nouveaux enregistrements. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Syntaxe 1 : Ouvrir une connexion prédéfinie : gestion automatique des connexions
<a name="syntaxe_1_ouvrir_une_connexion_predefinie_gestion_automatique_des_connexions_ELTPARAGRAPHE000747"></a>

- La connexion associée à un fichier de données est automatiquement ouverte lors de l'ouverture du fichier de données. La connexion est fermée lorsque le dernier fichier de données utilisant cette connexion est fermé.

- Si une connexion est ouverte avec la fonction **HOuvreConnexion**, cette connexion reste ouverte même si aucun fichier de données ne l'utilise.

- Si l'application effectue de nombreuses ouvertures et fermetures de fichiers de données successives, la gestion automatique des connexions va provoquer de nombreuses ouvertures/fermetures des connexions, entraînant d'importants ralentissements. Il est dans ce cas conseillé d'utiliser la fonction **HOuvreConnexion** pour forcer la conservation de la connexion ouverte.



<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Syntaxe 2 : Utiliser une chaîne de caractères pour le provider OLE DB
<a name="syntaxe_2_utiliser_une_chaine_caracteres_pour_provider_ole_ELTPARAGRAPHE000766"></a>Pour trouver facilement la chaîne de caractères à utiliser pour définir le provider OLE DB, il est conseillé de procéder de la manière suivante :

1. Dans l'éditeur d'analyses, créez une connexion par exemple sur HFSQL Client/Serveur. 

2. Dans l'écran de description de connexion, sélectionnez le provider à utiliser (combo "Connexion par").

3. La chaîne de caractères correspondant au provider s'affiche. Cette chaîne de caractères peut être utilisée dans la syntaxe 2 à la place des constantes.

<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=HOuvreConnexion.gif)

<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Syntaxe 2 et 3 : En cas d'échec, la description de la connexion n'est pas conservée
<a name="syntaxe_2_3_cas_echec_description_connexion_nest_pas_conservee_ELTPARAGRAPHE000783"></a>Si l'ouverture de la connexion échoue, la description de cette connexion n'est pas validée. Il est ainsi possible de redéfinir une connexion du même nom.

Par exemple, si la tentative de connexion échoue avec le mot de passe par défaut, il est possible de réaliser une nouvelle tentative avec un autre mot de passe.
<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png) 

### Pseudo-connexion à une base de données HFSQL Classic
<a name="pseudoconnexion_une_base_donnees_hfsql_classic_ELTPARAGRAPHE000796"></a>Des fichiers de données OLE DB ou natifs sont décrits sous l'éditeur d'analyses. Pour manipuler ces descriptions avec une base de données HFSQL Classic, il suffit de spécifier la constante ***hAccèsHF7*** comme nom de provider.

Les fichiers de données au format HFSQL Classic correspondant à la description des fichiers OLE DB ou natifs seront créés si nécessaire dans le répertoire défini par le paramètre &lt;Source des données&gt;.
<a name="NOTE0_5"></a>


### Différences entre les fonctions HOuvreConnexion et HDécritConnexion
<a name="differences_entre_les_fonctions_docparampagetitleshort_hdecritconnexion_ELTPARAGRAPHE000805"></a>**Méthode 1** : Pour ouvrir une connexion au début de l'application et la refermer à la fin, il est nécessaire d'utiliser la fonction [HOuvreConnexion](../WDLang4/3044107.md). Pour utiliser cette connexion lors de la manipulation des fichiers de données ou des tables, il suffira de changer cette connexion avec la fonction [HChangeConnexion](../WDLang4/3044150.md).

```wl
HOuvreConnexion(MaConnexion, params) // Ouverture de la connexion 
HChangeConnexion(UnFichier, MaConnexion)
```
**Méthode 2** : Pour décrire par programmation une connexion et l'ouvrir automatiquement lors de l'ouverture du fichier, il suffit :

- de décrire la connexion avec la fonction [HDécritConnexion](../WDLang4/3044205.md)

- d'associer cette connexion à la description de fichier de données voulue avec la fonction [HChangeConnexion](../WDLang4/3044150.md). L'ouverture de la connexion ne sera réalisée qu'au premier accès au fichier de données.




Cette solution peut être très utile lorsqu'une application manipule à la fois des fichiers de données HFSQL et des fichiers de données Oracle. Par exemple, si l'application utilise un seul fichier de données Oracle, dans un traitement bien spécifique, la connexion à la base de données Oracle ne sera faite qu'en cas de besoin.

Si pour ce même type d'application la première solution est retenue, la connexion (qui peut être relativement longue) sera effectuée à chaque lancement de l'application.

Exemple :

```wl
HDécritConnexion(MaConnexion, params) 
HChangeConnexion(UnFichier, MaConnexion) 
... 
HLitPremier(unFichier) // Ouverture de la connexion 
... 
HFerme(UnFichier) // Fermeture de la connexion
```

<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png) 

### Fichier UDL (fichier de description de connexion OLE DB)
<a name="fichier_udl_fichier_description_connexion_ole_ELTPARAGRAPHE000842"></a>Pour créer un fichier UDL :

1. Créez un fichier texte portant l'extension "UDL".

2. Double-cliquez sur ce fichier. La fenêtre des propriétés des liaisons de données s'ouvre.

3. Paramétrez la connexion.

4. Testez la connexion.

5. Validez (bouton "OK"). Le fichier UDL est utilisable.



<a name="NOTE0_7"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Connecteur Natif Oracle : gestion de l'authentification externe
<a name="connecteur_natif_oracle_gestion_authentification_externe_ELTPARAGRAPHE000861"></a>Pour se connecter via une authentification externe, il est nécessaire d'utiliser les paramètres de connexion suivants : 

- &lt;Nom de l'utilisateur&gt; = / (slash)

- &lt;Mot de passe&gt; = "" (chaîne vide)




Remarque : L'authentification externe consiste à se baser sur le nom de l'utilisateur Windows et son mot de passe pour se connecter à la base de données. L'authentification externe nécessite un paramétrage du serveur. Reportez-vous à la documentation de Oracle pour savoir comment autoriser les authentifications externes sur le serveur. 
<a name="NOTE0_8"></a>


### Limitations
<a name="limitations_ELTPARAGRAPHE000875"></a>




<a name="XComposante"></a>

## Composante :
wd280hf.dll
