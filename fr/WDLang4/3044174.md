


## HAnnuleDéclaration (Fonction)

***En anglais : HCancelDeclaration***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet de : 

- Supprimer une déclaration précédemment faite avec les fonctions [HDéclare](../WDLang4/3044203.md), [HDéclareExterne](../WDLang4/3044204.md), [HDécritFichier](../WDLang4/3044206.md). Après cette opération, le fichier de données n'est plus connu par le moteur HFSQL.

- Libérer les ressources d'une requête (suite à l'utilisation des fonctions [HExécuteRequête](../WDLang4/3044080.md) ou [HExécuteRequêteSQL](../WDLang4/3044084.md)).





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Le fichier de données Client a été précédemment déclaré dans l'analyse 
// par la fonction HDéclareExterne
HFerme(Client)
HAnnuleDéclaration(Client)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HAnnuleDéclaration([<Fichier de données>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Correspond : 

- au nom du fichier de données (défini dans l'analyse). Si ce nom n'est pas spécifié, la fonction **HAnnuleDéclaration** se réfère au dernier fichier de données utilisé.

- au nom d'une requête ou d'une source de données associée à une requête (cas d'une libération de ressources suite à l'utilisation des fonctions [HExécuteRequête](../WDLang4/3044080.md) ou [HExécuteRequêteSQL](../WDLang4/3044084.md)).






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation de HAnnuleDéclaration
<a name="conditions_utilisation_docparampagetitleshort_ELTPARAGRAPHE000120"></a>Cette fonction ne doit être utilisée QUE lorsque vous n'avez plus besoin du fichier de données (ou de la requête) concerné!

**Dans l'exemple suivant, la fonction HAnnuleDéclaration est utilisée trop tôt : le contenu du champ Table sera complètement faussé**. En effet, le remplissage du champ Table par la fonction [ConstruitTableFichier](../WDLang1/3074002.md) se produit dans un processus parallèle en arrière-plan. Donc la fonction **HAnnuleDéclaration** va intervenir bien avant la fin du remplissage du champ Table, ce qui rend ce champ Table inutilisable.

```wl
HExécuteRequêteSQL("test", "select * from client")
ConstruitTableFichier(TABLE_Table1, "test")
HAnnuleDéclaration("test")
```
**Remarque** : Le problème peut aussi se produire avec une variable de type "source de données". Une variable "source de données" déclarée localement dans un traitement ou un événement (clic de bouton, procédure, méthode ...) n'existe QUE durant l'exécution de ce code. Pour cette raison un "warning" est affiché si vous utilisez ce type de source de données : "la source de données sera détruite à la fin de ce code".
<a name="NOTE0_2"></a>


### Fonction HAnnuleDéclaration et fermeture du fichier de données
<a name="fonction_docparampagetitleshort_fermeture_fichier_donnees_ELTPARAGRAPHE000144"></a>Pour utiliser la fonction **HAnnuleDéclaration** sur un fichier de données, ce fichier de données doit être fermé.

Si une requête, une sous-requête ou une vue utilise le fichier de données, la fonction **HAnnuleDéclaration** ne pourra pas être exécutée même après un appel à la fonction [HFerme](../WDLang4/3044073.md). Il faudra auparavant libérer les requêtes ou vues qui utilisent le fichier de données.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
