


## HTransactionLibère (Fonction)

***En anglais : HTransactionFree***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Transforme tous les enregistrements "en transaction" en enregistrements "Normaux" si ces enregistrements n'appartiennent pas à une transaction actuellement en cours. Si un enregistrement du fichier de données spécifié est considéré comme étant en transaction, mais n'appartient à aucune transaction en cours, il est automatiquement libéré.

**Attention** : cette fonction est une fonction avancée. Cette fonction doit être utilisée lorsqu'il est impossible d'annuler les transactions qui ont échoué (fichiers de transaction supprimés par exemple).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Libère tous les enregistrements en transaction susceptibles d'être utilisés
HTransactionLibère(Client)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Libération d'un fichier de données

`<Résultat> = HTransactionLibère([<Fichier de données>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération est effectuée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'obtenir plus de renseignements sur l'erreur.




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données HFSQL Classic ou Client/Serveur pour lequel les enregistrements en cours de transaction doivent être libérés. 
Si ce paramètre n'est pas spécifié, la fonction **HTransactionLibère** manipule le dernier fichier de données utilisé.
 



<a name="SYNTAXE2"></a>

### Libération d'un enregistrement d'un fichier de données

`<Résultat> = HTransactionLibère([<Fichier de données>, ] <Numéro de l'enregistrement>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération est effectuée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'obtenir plus de renseignements sur l'erreur.




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données HFSQL Classic ou Client/Serveur pour lequel l'enregistrement en cours de transaction doit être libéré. 
Si ce paramètre n'est pas spécifié, la fonction **HTransactionLibère** manipule le dernier fichier de données utilisé.


**`<Numéro de l'enregistrement> : (Entier)`**

Numéro de l'enregistrement à libérer. 
Si ce paramètre est égal à 0 ou à la constante *hNumEnrEnCours*, la fonction **HTransactionLibère** va manipuler l'enregistrement en cours.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Cas particuliers
<a name="cas_particuliers_ELTPARAGRAPHE000160"></a>

- Cette fonction peut être utilisée uniquement pour des fichiers de données au format HFSQL. Pour tous les autres types de fichier de données, cette fonction est sans effet et renvoie <u><u><u><u>Vrai</u></u></u></u>.

- Les enregistrements ne pouvant pas être lus (enregistrements bloqués par exemple) sont ignorés.

- Cette fonction peut être utilisée pour libérer les transactions effectuées sur des fichiers de données présents dans un cluster HFSQL.



<a name="NOTE0_2"></a>


### Manipulations d'enregistrements pendant une transaction
<a name="manipulations_enregistrements_pendant_une_transaction_ELTPARAGRAPHE000180"></a>Pendant une transaction, il est nécessaire de suivre certaines règles lors de la manipulation des enregistrements. Pour plus de détails, consultez [Transactions : Manipuler les enregistrements lors d'une transaction](../WDLang4/3044336.md).
<a name="NOTE0_3"></a>


### Transactions et contexte HFSQL indépendant
<a name="transactions_contexte_hfsql_independant_ELTPARAGRAPHE000192"></a>Lors de la copie de contexte, si une transaction est en cours sur le premier contexte, le nouveau contexte n'est pas en transaction. Il faut rappeler la fonction [HTransactionDébut](../WDLang4/3044002.md) (ou la fonction [HTransaction](../WDLang4/1000023384.md)) pour démarrer une transaction dans le nouveau contexte.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
