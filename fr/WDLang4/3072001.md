
## SQLColonne (Fonction)

***En anglais : SQLColumn***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie les caractéristiques de toutes les colonnes (ou rubriques) :

- soit d'une table donnée.

- soit d'une requête donnée.







<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Connexion à une base de données
Numéro_Connexion est un entier 
Numéro_Connexion = SQLConnecte(NomSource, "", "", "", "ODBC")
i est un entier
// LISTE_ListeTab est une liste contenant la liste des tables
i = LISTE_ListeTab
SI i <> -1 ALORS
	ListeAjoute(LISTE_Liste1, SQLColonne(Numéro_Connexion, LISTE_ListeTab[i]))
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![ODBC](https://doc.pcsoft.fr/ext/images/fr/ODBC.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 
### Colonnes d'une table donnée

`<Résultat> = SQLColonne(<Numéro de la connexion> , <Nom de la table> [, <Détails>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Nom des colonnes de la table.

- Si &lt;Détails&gt; vaut <u><u><u><u>Faux</u></u></u></u>, la chaîne de caractères contient le nom de chaque colonne de la table séparé par des RC : 
	
	```txt
	Colonne1 + RC + Colonne2 + RC + ... + ColonneN
	```


- Si &lt;Détails&gt; vaut <u><u><u><u>Vrai</u></u></u></u>, la chaîne de caractères contient les noms de chaque colonne de la table avec diverses informations sur la colonne (nom, type, taille) : 
	
	```txt
	NomColonne + TAB + Type1 (N/T) + TAB + Type2 (numéro) + TAB + Taille + RC
	```

	Ce format est détaillé dans les Remarques.




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les résultats concernant les types et les tailles des colonnes peuvent être différents des résultats obtenus en WINDEV.

**`<Numéro de la connexion> : (Entier)`**

Numéro de la connexion à utiliser, renvoyé par la fonction [SQLConnecte](../WDLang4/3072005.md).

**`<Nom de la table> : (Chaîne de caractères)`**

Nom de la table dont on veut connaître les colonnes.

**`<Détails> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> (option par défaut) pour un résultat détaillé, 

- <u><u><u><u>Faux</u></u></u></u> pour un résultat simplifié.  





<a name="SYNTAXE2"></a>

### Colonnes d'une requête donnée

`<Résultat> = SQLColonne(<Nom de la requête> [, <Détails>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Si &lt;Détails&gt; vaut <u><u><u><u>Faux</u></u></u></u>, la chaîne de caractères contient le nom de chaque colonne de la table séparé par des RC (Retours Chariot) : 
	
	```txt
	Colonne1 + RC + Colonne2 + RC + ... + ColonneN
	```


- Si &lt;Détails&gt; vaut <u><u><u><u>Vrai</u></u></u></u>, la chaîne de caractères contient les noms de chaque colonne de la table avec diverses informations sur la colonne (nom, type, taille) : 
	
	```txt
	NomColonne + TAB + Type1 (N/T) + TAB + Type2 (numéro) + TAB + Taille + RC
	```

	Ce format est détaillé dans les Remarques.




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les résultats concernant les types et les tailles des colonnes peuvent être différents des résultats obtenus en WINDEV.



**`<Nom de la requête> : (Chaîne de caractères)`**

Nom de la requête (exécutée avec la fonction [SQLExec](../WDLang4/3072007.md) ou [SQLExecWDR](../WDLang4/3072010.md)) dont on veut connaître les colonnes.



**`<Détails> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> pour un résultat détaillé, 

- <u><u><u><u>Faux</u></u></u></u> (option par défaut) pour un résultat simple.  






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Détail des informations sur les colonnes 
<a name="detail_des_informations_sur_les_colonnes_ELTPARAGRAPHE000180"></a>Si le paramètre &lt;Détails&gt; est à <u><u><u><u>Vrai</u></u></u></u>, la chaîne de caractères contient les noms de toutes les colonnes d'une table avec diverses informations sur ces colonnes (nom, type, taille) sous la forme : 


```txt
Nom_colonne + TAB + Type 1 (N/T) + TAB + Type 2 (numéro) + TAB + Taille
```


- Type 1 (N/T) : "N" colonne de type numérique, "T" colonne de type texte

- Type 2 : numéro interne indiquant le type exacte de la colonne (voir tableau)
	

| Type 1 | Type 2 | Type ODBC |
| --- | --- | --- |
| N | 1 | SQL_BIT : Bit |
| N | 2 | SQL_TINYINT : Entier |
| N | 3 | SQL_BIGINT : Entier long |
| N | 4 | SQL_LONGVARBINARY : Mémo de type binaire |
| N | 5 | SQL_VARBINARY : Chaîne binaire de taille variable |
| N | 6 | SQL_BINARY : Binaire |
| T | 7 | SQL_LONGVARCHAR : Mémo de type chaîne ASCII |
| T | 9 | SQL_CHAR : Chaîne de taille fixe |
| N | 10 | SQL_NUMERIC : Numérique |
| N | 11 | SQL_DECIMAL : Nombre décimal |
| N | 12 | SQL_INTEGER : Entier |
| N | 13 | SQL_SMALLINT : Entier |
| N | 14 | SQL_FLOAT : Réel double |
| N | 15 | SQL_REAL : Réel simple |
| N | 16 | SQL_DOUBLE : Réel double |
| T | 17 | SQL_DATE : Date |
| T | 18 | SQL_TIME : Heure |
| T | 19 | SQL_TIMESTAMP : Date heure |
| T | 20 | SQL_VARCHAR : Chaîne de taille variable |
| T | 0 | SQL_WCHAR : Chaîne Unicode de taille variable |
| T | -2 | SQL_WLONGVARCHAR : Mémo Unicode |






- Taille : Taille affichable de la colonne : pour les chaîne de caractères, taille de la chaîne, et pour les numériques, taille du numérique en octets.







<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Astuce : Comment accélérer le temps d'exécution de la fonction SQLColonne ? 
<a name="astuce_comment_accelerer_temps_execution_fonction_sqlcolonne_ELTPARAGRAPHE000366"></a>Il suffit de préfixer le nom de la table par le propriétaire : le résultat sera quasi immédiat : 


```wl
SQLColonne(NumConnexion, PROPRIETAIRE.CLIENT)
```


<a name="XComposante"></a>

## Composante :
wd280hf.dll
