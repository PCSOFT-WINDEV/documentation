
## SQLPremier (Fonction)

***En anglais : SQLFirst***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Positionne sur la première ligne du résultat de la requête. Cette ligne devient la ligne en cours.

Si des champs ou des variables sont associés aux colonnes du résultat de la requête (fonction [SQLAssocie](../WDLang4/3072004.md)), ces éléments sont automatiquement affectés avec les valeurs de la ligne en cours.

En règle générale, la fonction **SQLPremier** est utilisée pour une boucle de lecture avec la fonction [SQLSuivant](../WDLang4/3072030.md).

**Attention** : Cette fonction doit être utilisée lors d'un parcours du résultat de la requête de type SQLPremier/SQLCol. Pour plus de détails sur les différents types de parcours du résultat d'une requête SQL, consultez [Types de parcours SQL](../WDLang4/3072025.md).

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Le fetch partiel est automatiquement réalisé par le framework JAVA.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003072017&name=sqlpremier_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Initialisation des paramètres de l'ascenseur en fin de requête
ResSQL = SQLExec("SELECT NOMCLI, PRENOM, ADR1, ADR2, VILLE, CP FROM CLIENT", ...
		"REQ1")
SI ResSQL = Vrai ALORS
	// Affiche la première ligne
	SQLPremier("REQ1") 
	// Initialise la borne maximale de l'ascenseur
	ASC_ASCENS1..BorneMax = SQL.NbLig 
	// Place l'ascenseur au début
	ASC_ASCENS1 = 1
SINON
	// Traite l'erreur
FIN
SQLFerme("REQ1")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`SQLPremier([<Nombre de lignes>, ] <Nom de la requête>)`
---

**`<Nombre de lignes> : (Entier optionnel)`**

Nombre de lignes à charger en mémoire toutes les secondes. Ce nombre de lignes constituera un bloc pour le Fetch partiel.
**Paramètre nécessaire pour réaliser une lecture par Fetch partiel.** 

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)  Ce paramètre est ignoré. En effet, le Fetch partiel est réalisé automatiquement par le framework Java. 

**`<Nom de la requête> : (Chaîne de caractères)`**

Nom de la requête : 

- créée et exécutée avec la fonction [SQLExec](../WDLang4/3072007.md), 

- exécutée avec la fonction [SQLExecWDR](../WDLang4/3072010.md).




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les requêtes créées avec l'éditeur de requête doivent être spécifiées sous forme d'une chaîne de caractères avec guillemets. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Chargement de la requête en mémoire
<a name="chargement_requete_memoire_ELTPARAGRAPHE000106"></a>Si la fonction **SQLPremier** est appelée immédiatement après la fonction [SQLExec](../WDLang4/3072007.md), le résultat de la requête est chargé en mémoire. Deux méthodes sont possibles :

- **Chargement complet de la requête en mémoire** si le paramètre &lt;Nombre de lignes&gt; n'est pas précisé. Le nombre d'enregistrements correspondant au résultat de la requête est automatiquement calculé. La variable SQL.NbLig est mise à jour.

- **Chargement partiel de la requête en mémoire** (appelé aussi Fetch Partiel) si le paramètre &lt;Nombre de lignes&gt; est précisé. 
	Seul le premier bloc de lignes est chargé en mémoire. Les blocs suivants sont automatiquement chargés en tâche de fond (mécanisme du Fetch partiel). La variable *SQL.RecupEnCours* (mise à jour par la fonction [SQLInfoGene](../WDLang4/3072028.md)) permet de savoir si la récupération du résultat est terminée. 
	Remarque : Suivant le traitement effectué, le fetch partiel permet de libérer de la bande passante sur le réseau. 
	




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Le Fetch partiel est automatiquement réalisé par le framework Java. La variable **SQL.RecupEnCours** n'est jamais initialisée et renvoie toujours <u><u><u><u>Faux</u></u></u></u>.


<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![ODBC](https://doc.pcsoft.fr/ext/images/fr/ODBC.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Fetch Partiel
<a name="fetch_partiel_ELTPARAGRAPHE000141"></a>Si la méthode de récupération du résultat de la requête par Fetch Partiel est utilisée (consultez l'exemple de cette fonction) :

- Si la fonction [SQLFerme](../WDLang4/3072015.md) est appelée alors que la récupération n'est pas terminée, la récupération est arrêtée et la requête est fermée.

- Cette méthode peut être utilisée sur plusieurs requêtes en même temps.

- La variable *SQL.RecupEnCours* (mise à jour par la fonction [SQLInfoGene](../WDLang4/3072028.md)) permet de savoir si la récupération du résultat est terminée.



<a name="NOTE0_3"></a>




### Divers
<a name="divers_ELTPARAGRAPHE000159"></a>

- Si le pointeur est en dehors du résultat de la requête, la variable **SQL.EnDehors** est à <u><u><u><u>Vrai</u></u></u></u>.

- La variable *SQL.EnCours* contient le numéro de la ligne en cours.

- La fonction [SQLTable](../WDLang4/3072031.md) ne doit pas être utilisée après la fonction **SQLPremier**. Une erreur fatale est générée.






<a name="XComposante"></a>

## Composante :
wd280hf.dll
