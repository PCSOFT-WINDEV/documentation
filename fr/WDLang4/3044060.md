


## HListeClé (Fonction)

***En anglais : HListKey***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie la liste des clés d'un fichier de données (d'une requête ou d'une vue) reconnu par le moteur HFSQL. Il est possible de savoir :

- le type de la clé,

- sa taille,

- si la clé est unique ou avec doublons, ...


Les fichiers définis par les fonctions [HDéclare](../WDLang4/3044203.md), [HDéclareExterne](../WDLang4/3044204.md) et [HDécritFichier](../WDLang4/3044206.md) sont pris en compte.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003044060&name=hlistecle_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Récupérer les clés d'un fichier de données présent dans l'analyse en cours
ListeCle est une chaîne
ListeCle = HListeClé(Client, hLstDétail)
// Ajoute la liste des clés dans COMBO_COMBO1
ListeAjoute(COMBO_COMBO1, ListeCle)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HListeClé(<Fichier de données> [, <Chemin du WDD> [, <Mot de passe du WDD> [, <Options>]]])`
---

**`<Résultat> : (Chaîne de caractères)`**

Liste des clés présentes dans le fichier de données spécifié. Les différentes descriptions de chaque clé sont séparées par RC (Retour chariot). Les clés listées sont triées en fonction de l'ordre physique des clés dans le fichier de données (sauf si la constante *hLstTriée* est utilisée).

En fonction de la constante utilisée, le résultat est plus ou moins détaillé :



|   |   |
| --- | --- |
| *hLstDétail* non précisé | &lt;Nom de la clé 1&gt; + RC + &lt;Nom de la clé 2 + RC + ...<br>Le résultat avec les constantes *hLstClé* et/ou *hLstCléComposée* et/ou *hLstTriée* est identique. |
| *hLstDétail* précisé | &lt;Nom de la clé 1&gt; + TAB + &lt;Type&gt; + TAB+ &lt;Taille&gt; + TAB + &lt;Formule&gt; + TAB + &lt;Unique&gt; + TAB + &lt;Libellé&gt; + RC + ... |
| *hLstDétailPlus* | &lt;Nom de la clé 1&gt; + TAB + &lt;Type&gt; + TAB + &lt;Taille&gt; + TAB + &lt;Formule&gt; + TAB + &lt;Unique&gt; + TAB + &lt;Libellé&gt; + TAB + &lt;Partie entière des clés numériques&gt; + TAB + &lt;Partie décimale des clés numériques&gt; + RC + ... |

Où :

- &lt;Nom de clé X&gt; : nom de la clé.

- &lt;Type&gt; : type de la clé : "T" pour texte (et monétaire) ou "N" pour numérique.

- &lt;Taille&gt; : taille de la rubrique.

- &lt;Formule&gt; : formule de la clé si la clé est composée (si la clé est simple, seul le nom de la clé est retourné).

- &lt;Unique&gt; :

	- "2" pour les clés primaires.

	- "1" pour une clé unique, 

	- "0" pour une clé avec doublons.




- &lt;Libellé&gt; : libellé de la clé.

- &lt;Partie entière des clés numériques&gt; : nombre de chiffres de la partie entière des clés numériques.

- &lt;Partie décimale des clés numériques&gt; : nombre de chiffres de la partie décimale des clés numériques.




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données (de la requête ou de la vue) dont les clés doivent être listées.

Si un nom de requête est spécifié, cette requête doit être en cours d'exécution (fonctions [HExécuteRequête](../WDLang4/3044080.md) ou [HExécuteRequêteSQL](../WDLang4/3044084.md)) pour que la fonction **HListeClé** fonctionne. Dans le cas contraire, une erreur du WLangage est générée.

**`<Chemin du WDD> : (Chaîne de caractères optionnelle)`**

Chemin complet de l'analyse (c'est-à-dire du fichier .WDD) dans laquelle le fichier de données est décrit. 
Si ce paramètre n'est pas précisé ou est égal à une chaîne vide (""), le fichier de données est recherché dans l'analyse en cours.

**`<Mot de passe du WDD> : (Chaîne de caractères optionnelle)`**

Mot de passe défini pour l'analyse. 
Si aucun mot de passe n'est défini, ce paramètre doit être égal à une chaîne vide ("").

**`<Options> : (Constante ou combinaison de constantes de type entier (optionnel))`**

Type de liste à effectuer :



|   |   |
| --- | --- |
| *hLstClé* | Liste les rubriques clés (clés non composées uniquement).<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |
| *hLstCléComposée* | Liste les rubriques clés composées uniquement.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |
| *hLstDétail* | Informations détaillées (idem WINDEV 5.5). |
| *hLstDétailPlus* | Pour les clés numériques, ajoute le nombre de chiffres de la partie entière et de la partie décimale.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |
| *hLstNormal*<br>(valeur par défaut) | Correspond à *hLstTout*. Valeur utilisée par défaut si les constantes *hLstClé*, *hLstCléComposée* et *hLstTout* ne sont pas utilisées. |
| *hLstOrdreLogique* | Trie la liste dans l'ordre logique des rubriques (ignorée si la constante *hLstTriée* est précisée).<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |
| *hLstRubriqueOrigine* | Utilisée sur un fichier journal (xxxJNL.fic), liste les clés du fichier de données original (qui a été journalé). Par exemple, sur le fichier ClientJNL.Fic, liste les rubriques clés du fichier CLIENT.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |
| *hLstTout* | Liste toutes les clés (*hLstClé* + *hLstCléComposée*).<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |
| *hLstTriée* | Trie la liste par ordre croissant.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Affichage du résultat dans un champ Liste ou Combo
<a name="affichage_resultat_dans_champ_liste_combo_ELTPARAGRAPHE000228"></a>&lt;Résultat&gt; peut être directement affecté à un champ Liste ou Combo grâce à la fonction [ListeAjoute](../WDLang1/3049004.md). Chaque ligne contiendra le nom d'une des clés trouvées.
<a name="NOTE0_2"></a>


### Extraire une information du résultat
<a name="extraire_une_information_resultat_ELTPARAGRAPHE000240"></a>Pour extraire une information du résultat détaillé, il est conseillé d'utiliser la fonction [ExtraitChaîne](../WDLang1/3024017.md).

<a name="XComposante"></a>

## Composante :
wd280hf.dll
