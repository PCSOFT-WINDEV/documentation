


## HOptimiseRequête (Fonction)

***En anglais : HOptimizeQuery***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Optimise les requêtes de sélection en utilisant les temps morts lors de la manipulation d'une application (période sans traitements). Optimise l'accès aux index des fichiers de données HFSQL Classic.

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
HOptimiseRequête(REQ_Client, 34)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HOptimiseRequête(<Nom ou code SQL de la requête> [, <Paramètre 1> [... [, <Paramètre N>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le fichier de données a été optimisé, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'obtenir plus de renseignements.




**`<Nom ou code SQL de la requête> : (Chaîne de caractères)`**



- Nom logique de la requête manipulée (requête de sélection uniquement).

- Code SQL de la requête manipulée (requête de sélection uniquement).




**`<Paramètre 1> : (Paramètres optionnels (le type correspond au type du paramètre))`**

Valeur du ou des paramètres attendus par la requête dans leur ordre d'initialisation (visible sous l'éditeur de requêtes). Chaque paramètre doit correspondre au type attendu. Les différents paramètres sont séparés par une virgule. 
Il est également possible de passer les paramètres de la requête avant la fonction **HOptimiseRequête** grâce à la notation &lt;NomRequête&gt;.&lt;NomParamètre&gt; = &lt;Valeur&gt;. 
Les paramètres sont ignorés si le paramètre "&lt;Nom ou code SQL de la requête&gt;" correspond au code SQL de la requête manipulée.



**`<Paramètre N> : (Paramètres optionnels (le type correspond au type du paramètre))`**

Valeur du ou des paramètres attendus par la requête dans leur ordre d'initialisation (visible sous l'éditeur de requêtes). Chaque paramètre doit correspondre au type attendu. Les différents paramètres sont séparés par une virgule. 
Il est également possible de passer les paramètres de la requête avant la fonction **HOptimiseRequête** grâce à la notation &lt;NomRequête&gt;.&lt;NomParamètre&gt; = &lt;Valeur&gt;. 
Les paramètres sont ignorés si le paramètre "&lt;Nom ou code SQL de la requête&gt;" correspond au code SQL de la requête manipulée.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Différence entre les fonction HOptimise et HOptimiseRequête
<a name="difference_entre_les_fonction_hoptimise_hoptimiserequete_ELTPARAGRAPHE000062"></a>

- La fonction [HOptimise](../WDLang4/3044005.md) charge les caches du système avec tout l'index du fichier. Si le fichier de données a une taille importante ou si l'application utilise plusieurs fichiers de données de taille importante, il y a risque de saturation des caches du système. 
	Pour éviter les risques de saturation, évitez d'appeler la fonction [HOptimise](../WDLang4/3044005.md) sur un trop grand nombre de fichiers de données ou de rubriques clé.

- La fonction **HOptimiseRequête** charge les caches du système avec uniquement les parties d'index nécessaires à la requête spécifiée, pour tous les fichiers de données utilisés par la requête. Cette fonction permet d'optimiser les requêtes.



<a name="NOTE0_2"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000081"></a>

- La fonction **HOptimiseRequête** rend la main immédiatement au programme et est exécutée en tâche de fond.

- Pour éviter les risques de saturation, évitez d'appeler la fonction **HOptimiseRequête** sur un trop grand nombre de requêtes.

- Si une optimisation est en cours lors de l'appel à la fonction **HOptimiseRequête**, l'optimisation en cours est automatiquement arrêtée.




<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
