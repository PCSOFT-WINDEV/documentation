
## HJSONVersEnregistrement (Fonction)

***En anglais : HJSONToRecord***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Importe des données JSON vers l'enregistrement courant.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
soit sChaîne1 = "{ ""Nom"":""Tintin"", ""Prenom"":[""Milou"", ""IDEFIX""] }"
soit b1 = HJSONVersEnregistrement(Client, sChaîne1)
SI ErreurDétectée = Vrai ALORS
	// Message complet de l'erreur principale
	Trace(HErreurInfo())
	// Parcours des sous-erreurs (s'il y en a)
	POUR i = 1 _À_ ErreurInfo(errNombreSousErreur)
		// Message complet de chaque sous-erreur
		Trace("Sous-erreur " + i + " : " + ErreurInfo(errMessage, i))
	FIN
FIN
HAjoute(Client)
```



<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = HJSONVersEnregistrement(<Fichier de données> , <Données JSON> [, <Liste des rubriques à importer> [, <Liste des "items" à importer>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si aucun problème n'a été rencontré pendant l'importation, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'obtenir plus d'informations sur le problème rencontré.




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données HFSQL manipulé. Les données JSON sont importées dans l'enregistrement courant. 

**`<Données JSON> : (Chaîne de caractères ou variable de type JSON)`**

Données JSON à convertir vers l'enregistrement. Ces données peuvent correspondre à une chaîne de caractères au format JSON ou à une variable de type [JSON](../Motscles/1000023611.md).  

**`<Liste des rubriques à importer> : (Chaîne de caractères optionnelle)`**

Liste des noms des rubriques du fichier de données dans lequel l'importation est effectuée. Les noms peuvent être délimités par des simples quotes et sont séparés par des virgules ou RC (Retour-Chariot). Les noms des rubriques de type clé composée, mémo binaire et de type binaire sont ignorés. 
Les rubriques non importées seront initialisées avec leur valeur par défaut décrite dans l'analyse. 
Si ce paramètre n'est pas précisé ou correspond à une chaîne vide (""), toutes les rubriques sont importées (sauf les clés composées, les rubriques binaire et mémos binaire) dans l'ordre physique de description.

**`<Liste des "items" à importer> : (Chaîne de caractères optionnelle)`**

Liste des noms des items JSON à importer. Si ce paramètre n'est pas précisé ou correspond à une chaîne vide (""), tous les items JSON sont importés.
Si une rubrique est manquante, une erreur non fatale est renvoyée.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Mode d'importation
<a name="mode_importation_ELTPARAGRAPHE000081"></a>Si la liste des items est précisée : l'importation recherchera des "items JSON" ayant le même nom que les rubriques.

Exemple : Le fichier de données décrit dans l'analyse contient les rubriques suivantes RUB1, RUB2, ... Le fichier JSON devra donc avoir une structure du type ci-dessous :

```txt
{"Fichier":
	{
		"Rubrique1":Donnée de la rubrique 1,
		"Rubrique2":Donnée de la rubrique 2,
		...
		}
}
```
Les noms des items du fichier JSON qui n'existent pas dans l'analyse ou ne sont pas donnés dans la liste des rubriques seront ignorés lors de l'importation.

Si la liste des items JSON n'est pas précisée, la valeur des items JSON est mise dans la rubrique du fichier de données HFSQL qui porte le même nom que l'item JSON.
<a name="NOTE0_2"></a>


### Encodage
<a name="encodage_ELTPARAGRAPHE000096"></a>L'encodage utilisé correspond au standard JSON : 

- utilisation d'un encodage en ASCII 7 bits, soit les 128 premiers caractères, les caractères non accentués, 

- utilisation d'un encodage JSON des autres caractères : "\\u" suivit du code du caractère en hexadécimal sur 4. 




Exemple : pour "é" (code ASCII 233, code hexadécimal E9), l'encodage correspond à "\\u00E9".



<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
