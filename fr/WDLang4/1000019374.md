


## HLibèreRequête (Fonction)

***En anglais : HFreeQuery***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Libère les ressources d'une requête (suite à l'utilisation des fonctions [HExécuteRequête](../WDLang4/3044080.md) ou [HExécuteRequêteSQL](../WDLang4/3044084.md)).

**Remarque** : Cette fonction est basée sur la fonction [HAnnuleDéclaration](../WDLang4/3044174.md). 

**Quand utiliser la fonction HLibèreRequête ?** 
Cette fonction peut être utilisée lorsqu'aucun traitement n'a plus à utiliser de résultat en provenance d'une requête. Il est conseillé d'utiliser cette fonction sur les requêtes qui renvoient un grand nombre de lignes (à partir de plusieurs dizaines de milliers) afin de libérer de l'espace mémoire. 


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Initialise la requête
SI HExécuteRequête(MaRequête) = Faux ALORS
	Erreur("Erreur d'initialisation de la requête" + RC + HErreurInfo())
	RETOUR
FIN

// Lecture du premier enregistrement de la requête
HLitPremier(MaRequête)
TANTQUE PAS HEnDehors()
	// Traitement sur l'enregistrement de la requête
	...
	// Lecture de l'enregistrement suivant
	HLitSuivant()
FIN
HLibèreRequête(MaRequête)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HLibèreRequête([<Requête>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Requête> : (Chaîne de caractères optionnelle)`**

Nom de la requête ou d'une source de données associée à une requête (cas d'une libération de ressources suite à l'utilisation des fonctions [HExécuteRequête](../WDLang4/3044080.md) ou [HExécuteRequêteSQL](../WDLang4/3044084.md)). 
Si ce paramètre n'est pas spécifié, correspond au dernier fichier de données manipulé. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation de la fonction HLibèreRequête
<a name="conditions_utilisation_fonction_docparampagetitleshort_ELTPARAGRAPHE000127"></a>Cette fonction ne doit être utilisée QUE lorsque vous n'avez plus besoin de la requête concernée !

**Dans l'exemple suivant, la fonction HLibèreRequête est utilisée trop tôt : la table sera complètement faussée**. En effet, le remplissage du champ Table par la fonction [ConstruitTableFichier](../WDLang1/3074002.md) se produit dans un processus parallèle en arrière-plan. Donc, la fonction **HLibèreRequête** va intervenir bien avant la fin du remplissage du champ Table, ce qui rend ce champ inutilisable.

```wl
HExécuteRequêteSQL("test", "select * from client")
ConstruitTableFichier(TABLE_Table1, "test")
HLibèreRequête("test")
```

**Remarque** : Le problème peut aussi se produire avec une variable de type "source de données". Une variable "source de données" déclarée localement dans un traitement (clic de bouton, procédure, méthode ...) n'existe QUE durant l'exécution de ce code. Pour cette raison un "warning" est affiché si vous utilisez ce type de source de données : "la source de données sera détruite à la fin de ce code".

<a name="XComposante"></a>

## Composante :
wd280hf.dll


