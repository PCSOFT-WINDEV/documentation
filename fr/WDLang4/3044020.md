


## HVersion (Fonction)

***En anglais : HVersion***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet de savoir :

- si le contenu d'un fichier de données a été modifié.

- si le contenu d'un fichier de données utilisé par une requête a été modifié.




Cette fonction permet par exemple de détecter des modifications effectuées sur un fichier de données partagé entre plusieurs programmes. Si une modification est détectée, il est par exemple possible de rafraîchir les données affichées dans la fenêtre ou dans la page.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
NumVer = HVersion(Client)
```
<a name="Exemple2"></a>

```wl
// Première évaluation de la version du fichier de données
NumVer est un entier
NumVer = HVersion(Client)
// Traitements
// Deuxième évaluation de la version du fichier de données
SI NumVer <> HVersion(Client) ALORS
	Info("Le fichier de données Client a été modifié.")
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HVersion([<Fichier de données ou requête>])`
---

**`<Résultat> : (Entier)`**

Numéro de version du fichier de données.
![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Le numéro de version est toujours égal à 0.

**`<Fichier de données ou requête> : (Chaîne de caractères optionnelle)`**



- Nom du fichier de données manipulé.

- Nom de la requête manipulée.

- Si ce paramètre n'est pas spécifié, la fonction **HVersion** va manipuler le dernier fichier de données (dernière requête) manipulé.


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Le fichier de données manipulé doit être un fichier de données HFSQL. Dans le cas contraire, le numéro de version est toujours égal à 0.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Incrémentation du numéro de version du fichier de données
<a name="incrementation_numero_version_fichier_donnees_ELTPARAGRAPHE000114"></a>A la création du fichier de données, le numéro de version est initialisé à 1. Ce numéro est incrémenté à chaque modification du contenu du fichier ([HAjoute](../WDLang4/3044147.md), [HEcrit](../WDLang4/3044092.md), [HModifie](../WDLang4/3044042.md), [TableEnregistre](../WDLang1/3074008.md), [TableSupprime](../WDLang1/3074032.md), [HLibère](../WDLang4/3044064.md), [HSupprime](../WDLang4/3044018.md), [HRaye](../WDLang4/3044121.md)). Le numéro est incrémenté uniquement en cas de succès de la fonction.

**Remarque** : La fonction **HVersion** peut être utilisée sur les fichiers de données indexés ou non indexés.
<a name="NOTE0_2"></a>


### Requêtes multifichiers
<a name="requetes_multifichiers_ELTPARAGRAPHE000152"></a>Dans le cas d'une requête multifichier, la fonction **HVersion** retourne la somme des **HVersion** de tous les fichiers de données concernés par la requête.  

<a name="XComposante"></a>

## Composante :
wd280hf.dll
