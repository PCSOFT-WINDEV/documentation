


## HChangeConnexion (Fonction)

***En anglais : HChangeConnection***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Change dynamiquement la connexion associée à un fichier de données. La nouvelle connexion doit être connue et définie lors de ce changement. Cette nouvelle connexion sera utilisée lors de la prochaine ouverture du fichier de données.

Il est ainsi possible d'importer une description de tables Oracle dans l'analyse et d'utiliser cette description pour travailler sur des fichiers de données au format HFSQL. Pour voir de nombreux exemples de changements de connexion, consultez les exemples détaillés.

**Conseils** : 

- Pour manipuler les connexions, il est conseillé d'utiliser une variable de type [Connexion](../WDLang4/1514073.md).

- **Attention** : L'ordre d'utilisation des fonctions permettant de se connecter à une base de données HFSQL Client/Serveur est important. Consultez [Optimiser les temps de connexion aux bases HFSQL Client/Serveur](../WDLang4/9000176.md) pour plus de détails.





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Décrire la nouvelle connexion
HDécritConnexion ("MaConnexion", "", "", ...
	"Serveur_SQLServer", "dbo", hOledbSQLServer, HOLectureEcriture, "")

// Ouvrir la nouvelle connexion
HOuvreConnexion("MaConnexion")

// Indiquer que "Salaires" utilise la nouvelle connexion
HChangeConnexion("Salaires", "MaConnexion")

// Commencer le parcours de la table "Salaires" sur SQLServer
HLitPremier("Salaires")
...
// Fermer la connexion
HFermeConnexion("MaConnexion")

// Rétablir l'utilisation de la connexion sur Oracle
HChangeConnexion("Salaires", "")

// Ouvrir la table "Salaires" sur Oracle
HOuvre("Salaires")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HChangeConnexion(<Fichier de données> , <Nouvelle connexion>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur. 




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données (défini dans l'analyse) pour lequel la connexion doit être changée. Ce fichier de données sera automatiquement fermé pour modifier sa connexion. 
Si ce paramètre vaut "\*", le traitement est appliqué à tous les fichiers de données connus, quelle que soit leur origine (HFSQL, OLE DB, Connecteur Natif, ...). 
Il est ainsi possible de transformer un fichier de données HFSQL en un fichier de données OLE DB par exemple. 
Ce paramètre peut également correspondre au nom d'un [groupe de fichiers (ou perso-dossier) défini dans l'analyse](../Editeurs/2011003.md) (non disponible en Android et Android Widget).

**`<Nouvelle connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Nouvelle connexion à utiliser. Ce paramètre peut correspondre : 

- au nom de la connexion à une base de données. Cette connexion a été définie dans l'éditeur d'analyses ou décrite dynamiquement par la fonction [HDécritConnexion](../WDLang4/3044205.md). Si ce paramètre correspond à une chaîne vide (""), la connexion initiale est automatiquement utilisée.

- au nom de la variable de type [Connexion](../WDLang4/1514073.md) correspondant à la nouvelle connexion à utiliser. 






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- La connexion doit être connue au moment de l'exécution de la fonction **HChangeConnexion**. Si le fichier de données n'est pas connu lors de l'utilisation de la fonction **HChangeConnexion**, la connexion sera changée au moment de la déclaration du fichier de données.

- La fonction **HChangeConnexion** réalise automatiquement la fermeture du fichier de données (fonction [HFerme](../WDLang4/3044073.md)) dont la connexion doit être modifiée.

- La fonction **HChangeConnexion** n'ouvre ni le fichier de données ni la connexion. La connexion définie par la fonction **HChangeConnexion** sera utilisée lors de la prochaine ouverture du fichier de données.





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDOLEDB.gif) ***Exemples didactiques (WINDEV)*** : **WD OLEDB** <br>Cet exemple illustre l'accès à une base de données via OLE DB avec les fonctions WLangage.<br>Dans cet exemple, nous abordons les deux thèmes suivants :<br>1/ l'indépendance de vos applications et de la base de données<br>2/ la connexion via OLE DB<br>Résumé de l'exemple livré avec WINDEV :	<br>Cet exemple montre comment réaliser une application indépendante de la base de données utilisée.<br>La même application avec le même code source accède indifféremment à un fichier HFSQL ou à une base Access via OLE DB. <br>Sur le même principe, vos applications pourront accéder à toutes les bases de données du marché.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
