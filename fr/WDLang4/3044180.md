
## Alias sur les fichiers de données : fonction HAlias
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000230"></a>
Les alias permettent de manipuler :

- Plusieurs fichiers de données physiques ayant la même description dans l'analyse

- Plusieurs fichiers de données logiques décrits dans l'analyse manipulant le même fichier de données physique.




Attention : Cette page d'aide décrit la création d'un alias avec la fonction [HAlias](../WDLang4/3044176.md). A partir de la version 27, il est possible d'utiliser une variable de type [Alias](../WDLang4/1000021446.md). Ce type de variable simplifie la création et la manipulation des alias. 






### Plusieurs fichiers de données physiques avec une description logique identique
<a name="plusieurs_fichiers_donnees_physiques_avec_une_description_logique_identique_ELTPARAGRAPHE000037"></a>Par exemple : Il est ainsi possible de manipuler en même temps :

- Le fichier Client2000.fic qui contient la sauvegarde des clients pour l'année 2000

- Le fichier Client.fic qui contient les références des clients pour l'année en cours




Ces deux fichiers de données ont la même description logique dans l'analyse : le fichier CLIENT. Par défaut, la description du fichier CLIENT présente dans l'analyse est liée au fichier Client.fic.
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Alias1.gif)


Pour utiliser le fichier de données Client2000.Fic, il est nécessaire de "copier" la description du fichier de données CLIENT de l'analyse : il suffit de créer un alias avec la fonction [HAlias](../WDLang4/3044176.md). La ligne de code correspondante est la suivante : 

```wl
HAlias(Client, Client2000)
```
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Alias2.gif)


La manipulation des deux fichiers de données se fera de la même façon avec les fonctions HFSQL.


### Plusieurs fichiers de données logiques reliées à un seul fichier de données physique
<a name="plusieurs_fichiers_donnees_logiques_reliees_seul_fichier_donnees_physique_ELTPARAGRAPHE000059"></a>Il est possible de réaliser plusieurs recherches en parallèle sur un même fichier de données physique, ou une recherche et un filtre en parallèle sur le fichier de données.

**Exemple** : Le fichier de données Client.Fic est associé au fichier logique Client dans l'analyse. Pour filtrer les enregistrements du fichier de données Client.fic et pour parcourir en même temps la totalité des enregistrements de ce fichier de données, il est nécessaire :

- De "copier" la description du fichier de données CLIENT dans l'analyse : il suffit de créer un alias avec la fonction [HAlias](../WDLang4/3044176.md).

- D'associer la description de l'alias au fichier de données physique Client.Fic (fonction [HChangeNom](../WDLang4/3044141.md)).




Remarque : Cette méthode permet de gérer plusieurs contextes HFSQL pour un même fichier de données physique.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Manipuler les alias par programmation
<a name="manipuler_les_alias_par_programmation_ELTTEXTE000272"></a>


### Les fonctions du WLangage
<a name="les_fonctions_wlangage_ELTPARAGRAPHE000082"></a>Plusieurs fonctions permettent de manipuler les alias :



|   |   |
| --- | --- |
| [HAlias](../WDLang4/3044176.md) | Crée un alias logique d'un fichier de données (ou d'une requête) ou annule tous les alias existants. |
| [HAnnuleAlias](../WDLang4/3044149.md) | Annule un alias précédemment déclaré avec la fonction [HAlias](../WDLang4/3044176.md). |





D'autres fonctions peuvent intervenir dans la définition et la manipulation des alias :



|   |   |
| --- | --- |
| [HChangeNom](../WDLang4/3044141.md) | Modifie le nom physique d'un fichier de données. |
| [HChangeRep](../WDLang4/3044168.md) | Modifie le chemin d'accès à un fichier de données (c'est-à-dire le répertoire dans lequel le fichier sera manipulé). |





Remarque : Les variables de type [Alias](../WDLang4/1000021446.md) permettent de simplifier la création et la manipulation des alias.
<a name="NOTE2_2"></a>


### Créer un alias sur quoi ?
<a name="creer_alias_sur_quoi_ELTPARAGRAPHE000100"></a>Il est possible de créer et de manipuler des alias sur les éléments suivants :

- Fichier de données décrit dans l'analyse,

- Fichier de données décrit dynamiquement,

- Requête créée avec l'éditeur de requêtes,

- Vue HFSQL Classic,

- Alias.





<a name="NOTE2_3"></a>


### Caractéristiques d'un alias
<a name="caracteristiques_alias_ELTPARAGRAPHE000114"></a>

- **Fichier de données physique associé à un alias** : 
	Par défaut, le nom spécifié pour l'alias est attribué au fichier de données physique correspondant à l'alias. Pour associer l'alias à un fichier de données physique de nom différent, il suffit d'utiliser les fonctions [HChangeNom](../WDLang4/3044141.md) et [HChangeRep](../WDLang4/3044168.md).

- **Mot de passe d'un alias** : 
	Par défaut, le mot de passe d'un fichier alias est identique au mot de passe du fichier de données d'origine. Il est possible de modifier ce mot de passe grâce à la fonction [HPasse](../WDLang4/3044108.md). Le nom du fichier de données utilisé dans cette fonction correspond alors au nom de l'alias.

- **Ré-indexation** : 
	Les fichiers alias peuvent être ré-indexés.

- **Modification automatique des fichiers de données** : 
	Cette opération peut être appliquée aux fichiers alias.





<a name="NOTE2_4"></a>


### Manipuler le fichier alias et ses rubriques
<a name="manipuler_fichier_alias_ses_rubriques_ELTPARAGRAPHE000142"></a>

- **Editeur de code** : Pour éviter l'erreur "Identificateur inconnu" lors de l'utilisation d'un fichier alias et de ses rubriques, il est nécessaire de définir une [source de données](../WDLang4/1514053.md) pour déclarer le nom de l'alias avant l'utilisation de la fonction [HAlias](../WDLang4/3044176.md).
	Par exemple :
	
	```wl
	Commande2000 est une Source de Données
	HAlias(Commande, Commande2000)
	```

	Attention : l'utilisation du mot-clé Externe est possible mais entraîne un ralentissement non négligeable à l'exécution.

- **Editeur de fenêtres ou de pages** : les champs et les tables ne peuvent pas être directement associés à des rubriques des fichiers alias. Il est nécessaire d'affecter les champs un par un par programmation. 
	Remarque : pour redéfinir par programmation les liaisons des champs, il est possible d'utiliser soit la fonction [ChampAlias](../WDLang1/3025016.md), soit la propriété [LiaisonFichier](../Proprietes/2510060.md).





<a name="NOTE2_5"></a>


### Triggers et alias
<a name="triggers_alias_ELTPARAGRAPHE000171"></a>Les triggers peuvent être définis sur des alias de fichiers de données. 

- L'alias doit avoir été décrit avant d'appeler la fonction [HDécritTrigger](../WDLang4/3044074.md).

- Le nom de l'alias doit être donné explicitement dans la fonction [HDécritTrigger](../WDLang4/3044074.md). 







