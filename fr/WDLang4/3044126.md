


## HRecule (Fonction)

***En anglais : HBackward***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Recule de plusieurs enregistrements dans le fichier de données, à partir de la position en cours, selon une rubrique spécifiée.

L'enregistrement destination est lu et chargé en mémoire : les variables HFSQL sont mises à jour (par exemple Client.Nom, c'est-à-dire la rubrique *Nom* du fichier *Client*).

Après l'exécution de la fonction **HRecule**, plusieurs cas peuvent se présenter :

- il n'existe plus d'enregistrements dans le fichier de données : la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u>Vrai</u></u></u>. Aucune lecture n'est effectuée.

- la fonction tente de bloquer un enregistrement déjà bloqué en lecture : la fonction [HErreurBlocage](../WDLang4/3044099.md) renvoie <u><u><u>Vrai</u></u></u> et la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u>Vrai</u></u></u>.
	
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : La gestion des blocages n'est pas disponible pour les bases de données accédées par JDBC.




Cette fonction peut être utilisée indifféremment avec les fichiers de données, les vues HFSQL ou les requêtes.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Recule jusqu'au 200ème enregistrement du fichier de données Client
// selon la clé NomCli
HLitDernier(Client, NomCli)
HRecule(Client, NomCli, 199)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HRecule([<Fichier de données> [, <Rubrique>] [, <Pas> [, <Options>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le recul dans le fichier de données a été effectué, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur (blocage, fin du fichier de données, etc.) : l'enregistrement n'est pas lu. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données, de la vue ou de la requête manipulé. Si ce nom n'est pas spécifié, la fonction **HRecule** va manipuler le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Rubrique> : (Chaîne de caractères optionnelle)`**

Nom de la rubrique selon laquelle le parcours est effectué. Si ce nom n'est pas spécifié, la fonction **HRecule** va manipuler la dernière rubrique du fichier de données utilisée par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).
![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Toutes les rubriques utilisées pour reculer dans le fichier sont considérées comme des rubriques clé.

**`<Pas> : (Entier optionnel)`**

Nombre de pas en arrière (c'est-à-dire nombre d'enregistrements à parcourir). Par défaut, &lt;Pas&gt; = 1.

**`<Options> : (Constante ou combinaison de constantes optionnelle de type entier)`**

Paramètre :

- le blocage de l'enregistrement lu. Par défaut, le blocage réalisé correspond au blocage en cours.
	


|   |   |
| --- | --- |
| *hBlocageEcriture* | Blocage en écriture : l'enregistrement en cours de lecture pourra être lu par une autre application mais ne pourra pas être modifié par une autre application. |
| *hBlocageLectureEcriture* | Blocage en lecture/écriture : l'enregistrement en cours de lecture ne pourra ni être lu ni être modifié par une autre application. |
| *hBlocageNon* | Aucun blocage : l'enregistrement pourra être lu ou modifié par une autre application pendant la lecture. |


	![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Si le provider OLE DB ou le Connecteur Natif utilisé ne gère pas les blocages, les options de blocage seront sans effet.

- la gestion des doublons lors du parcours. Par défaut, tous les doublons sont parcourus.
	


|   |   |
| --- | --- |
| *hDistinct* | Lors d'un parcours sur une rubrique clé, s'il y a des doublons, un seul enregistrement est parcouru. |




![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Le paramètre &lt;Options&gt; n'est pas pris en compte.![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Le paramètre &lt;Options&gt; n'est pas pris en compte.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Lecture selon une rubrique clé ou non
<a name="lecture_selon_une_rubrique_cle_non_ELTPARAGRAPHE000198"></a>Dans tous les cas, le parcours doit avoir été initialisé avec une des fonctions suivantes : [HLitPremier](../WDLang4/3044051.md), [HPremier](../WDLang4/3044113.md), [HLitRecherchePremier](../WDLang4/3044036.md), [HRecherchePremier](../WDLang4/3044125.md), [HChangeClé](../WDLang4/3044151.md), [HRetourPosition](../WDLang4/3044137.md).

Si la rubrique utilisée est une clé :

- si la constante *hDistinct* n'est pas active, la fonction **HRecule** permet de reculer de &lt;Pas&gt; valeurs de la clé à partir de la position en cours.

- si la constante *hDistinct* est active, la fonction **HRecule** permet de reculer de &lt;Pas&gt; valeurs de la clé distinctes à partir de la position en cours. Si des doublons sont rencontrés, un seul doublon est lu.




Si la rubrique utilisée n'est pas une clé :

- la constante *hDistinct* n'est pas disponible,

- La fonction **HRecule** permet de reculer de &lt;Pas&gt; enregistrements actifs à partir de la position en cours.



<a name="NOTE0_2"></a>


### Mémos
<a name="memos_ELTPARAGRAPHE000244"></a>Les mémos associés à l'enregistrement peuvent être automatiquement lus ou non lors de la lecture de l'enregistrement. La fonction [HGèreMemo](../WDLang4/3044139.md) permet de personnaliser cette lecture automatique.

Si les mémos sont gérés, lorsque l'enregistrement est lu, les mémos texte associés sont également lus. Les mémos binaires ne sont lus que lorsqu'ils sont utilisés explicitement (fonction [HExtraitMémo](../WDLang4/3044072.md)).
<a name="NOTE0_3"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000261"></a>

- Le résultat de la fonction [HTrouve](../WDLang4/3044104.md) doit être ignoré (la fonction [HTrouve](../WDLang4/3044104.md) doit être utilisée pour les recherches réalisées avec les fonctions [HLitRecherche](../WDLang4/3044050.md), [HLitRecherchePremier](../WDLang4/3044036.md), [HLitRechercheDernier](../WDLang4/3044034.md)).

- Le numéro de l'enregistrement en cours est connu avec la fonction [HNumEnr](../WDLang4/3044063.md).

- La fonction **HRecule** respecte le filtre actif en cours (décrit avec la fonction [HFiltre](../WDLang4/3044100.md)).

- La fonction [HChangeClé](../WDLang4/3044151.md) permet de modifier la clé de parcours tout en restant positionné sur l'enregistrement en cours.

- La fonction **HRecule**(Client,Nom) est équivalent à [HLitPrécédent](../WDLang4/3044048.md)(Client,Nom)



<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Langage Externe](https://doc.pcsoft.fr/ext/images/fr/LE.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Blocage
<a name="blocage_ELTPARAGRAPHE000309"></a>Par défaut (aucune constante de blocage spécifiée), le blocage réalisé correspond au mode de blocage en cours.

Si un blocage est demandé (constantes *hBlocageEcriture* ou *HBlocageLectureEcriture*), la lecture de l'enregistrement et le blocage seront réalisés uniquement si cet enregistrement n'est pas déjà bloqué par une autre application.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
