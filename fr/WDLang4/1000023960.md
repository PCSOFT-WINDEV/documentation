


## &lt;Variable Connexion&gt;.GèreIntégrité (Fonction)

***En anglais : &lt;Connection variable&gt;.SetIntegrity***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Active ou désactive la gestion d'une contrainte d'intégrité sur une liaison d'un fichier de données.

**Remarque** : Par défaut, toutes les règles d'intégrité définies dans la description de l'analyse sont actives.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Désactiver les règles d'intégrité sur la liaison entre une commande et un client
// avec utilisation d'une connexion
CxFichierSource est une Connexion
CxFichierRelié est une Connexion

CxFichierSource.GèreIntégrité(CxFichierRelié, ClientCommande, ... 
	hCardinalité + hEnModification + hEnSuppression, Faux)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

### Activer ou désactiver la gestion d'une contrainte d'intégrité en spécifiant la connexion du fichier de données

`<Résultat> = <Connexion fichier de données source>.GèreIntégrité([<Connexion fichier de données relié>, ] <Description de la liaison> [, <Contrainte d'intégrité>] , <Mode de gestion>)`
---

**`<Résultat> : (Booléen)`**

Ancienne gestion de l'intégrité (avant utilisation de la fonction **&lt;Variable Connexion&gt;.GèreIntégrité**) : 

- <u><u><u>Vrai</u></u></u> si la gestion de l'intégrité était active, 

- <u><u><u>Faux</u></u></u> si la gestion de l'intégrité était inactive.




**`<Connexion fichier de données source> : (Variable de type Connexion)`**

Nom de la variable de type [Connexion](../WDLang4/1514073.md) décrivant la connexion à laquelle appartient le fichier de données source de la liaison.

**`<Connexion fichier de données relié> : (Variable de type Connexion)`**

Nom de la variable de type [Connexion](../WDLang4/1514073.md) décrivant la connexion à laquelle appartient le fichier de données relié de la liaison.

**`<Description de la liaison> : (Variable de type Description de liaison)`**

Nom de la variable de type [Description de liaison](../WDLang4/1514039.md) contenant les caractéristiques de la liaison.

**`<Contrainte d'intégrité> : (Constante ou combinaison de constantes optionnelle de type Entier)`**

Contraintes d'intégrité à gérer. Si ce paramètre n'est pas spécifié, la nouvelle gestion s'applique à toutes les contraintes de la liaison.


|   |   |
| --- | --- |
| *hCardinalité* | Test des cardinalités de la liaison. |
| *hEnModification* | Règle d'intégrité appliquée pendant une modification. |
| *hEnSuppression* | Règle d'intégrité appliquée pendant une suppression. |



**`<Mode de gestion> : (Booléen)`**



- <u><u><u>Vrai</u></u></u> si la contrainte d'intégrité est activée, 

- <u><u><u>Faux</u></u></u> si cette gestion doit être désactivée. Si seul ce paramètre est précisé, le mode de gestion spécifié s'applique à tous les fichiers de données.





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Gestion de l'intégrité activée
<a name="gestion_integrite_activee_ELTPARAGRAPHE000300"></a>Si une opération sur un fichier de données entraîne la violation d'une contrainte d'intégrité sur une règle active, l'opération n'est pas effectuée et provoque l'erreur de la fonction. La fonction [HErreurIntégrité](../WDLang4/3044086.md) renvoie alors <u><u><u><u>Vrai</u></u></u></u>.

**Remarque** : Seules les fonctions [&lt;Source&gt;.Ajoute](../WDLang4/1000024187.md), [&lt;Source&gt;.Modifie](../WDLang4/1000025038.md), [&lt;Source&gt;.Supprime](../WDLang4/1000025071.md), [&lt;Source&gt;.Raye](../WDLang4/1000025051.md) et [&lt;Source&gt;.Ecrit](../WDLang4/1000024331.md) peuvent générer une erreur d'intégrité.
<a name="NOTE0_2"></a>


### Désactiver les règles d'intégrité
<a name="desactiver_les_regles_integrite_ELTPARAGRAPHE000344"></a>Désactiver une règle d'intégrité implique la possibilité de violer les contraintes énoncées lors de la description des fichiers de données dans l'éditeur d'analyses. Désactiver une règle d'intégrité n'est donc pas une opération insignifiante : elle doit être utilisée à bon escient.
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) 

### En mode HFSQL Client/Serveur
<a name="mode_hfsql_clientserveur_ELTPARAGRAPHE000356"></a>L'utilisation de la syntaxe **&lt;Variable Connexion&gt;.GèreIntégrité**(&lt;Gestion&gt;) influe sur le comportement de tous les serveurs HFSQL (que l'ouverture de la connexion soit antérieure ou postérieure à l'appel de la fonction **&lt;Variable Connexion&gt;.GèreIntégrité**).

L'utilisation de la fonction **&lt;Variable Connexion&gt;.GèreIntégrité** en précisant le nom de la liaison n'est possible que si :

- La liaison est décrite dans l'analyse du client (ou par la fonction [HDécritLiaison](../WDLang4/3044191.md)).

- Les deux fichiers de données reliés par cette liaison sont situés sur le même serveur HFSQL.




Si l'appel à la fonction **&lt;Variable Connexion&gt;.GèreIntégrité** est effectuée avant que les fichiers de données soient en mode Client/Serveur (par exemple, si la fonction [&lt;Source&gt;.ChangeConnexion](../WDLang4/1000024199.md) est utilisée), le serveur active la règle d'intégrité.

Un droit est associé à la gestion de l'intégrité sur la base de données : *hDroitGèreIntégrité*. Une erreur de droit apparaît lorsque l'utilisateur tente de violer la contrainte d'intégrité (par exemple lors de l'utilisation des fonctions [&lt;Source&gt;.Ajoute](../WDLang4/1000024187.md), [&lt;Source&gt;.Modifie](../WDLang4/1000025038.md), ...). 

<a name="XComposante"></a>

## Composante :
wd280hf.dll
