


## HVérifieIndex (Fonction)

***En anglais : HCheckIndex***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Vérifie que les données contenues dans le fichier d'index (fichier .NDX) référencent correctement les données contenues dans le fichier de données (fichier .FIC). Cette fonction concerne uniquement les fichiers de données HFSQL (Classic ou Client/Serveur).
![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Le fichier de données HFSQL Client/Serveur vérifié est automatiquement bloqué en écriture pendant la vérification.

**Rappel** : Un index est corrompu lorsque l'un des enregistrements qu'il référence n'est pas celui attendu. Dans ce cas, il est nécessaire de réindexer le fichier de données.

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Vérification de l'index
soit RésultatIndex = HVérifieIndex(Client)
// Gère le résultat
SELON RésultatIndex
	CAS 0
		Info("Index correct")
	CAS 1
		Info("Le fichier nécessite une optimisation.")
	CAS 2
		Info("Erreur HFSQL " + HErreur() + " pendant le test")
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HVérifieIndex([<Fichier de données> [, <Rubrique clé>] [, <Jauge>]])`
---

**`<Résultat> : (Entier)`**

Peut correspondre à : 

- 0 si la vérification est correcte.

- 1 si l'index est corrompu : une réindexation est nécessaire (fonction [HRéindexe](../WDLang4/3044133.md))

- 2 lors d'une erreur HFSQL : le fichier de données est inaccessible, etc.

- 3 si la fonction est non supportée par ce type de fichier de données (fichier xBase, AS400, ...)




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données manipulé. Si ce nom n'est pas spécifié, la fonction **HVérifieIndex** va manipuler le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Rubrique clé> : (Chaîne de caractères optionnelle)`**

Nom de la rubrique clé à vérifier. Si ce paramètre n'est pas spécifié, toutes les clés du fichier de données sont vérifiées.

**`<Jauge> : (Nom de champ ou nom de fenêtre optionnel)`**



- Nom de la fenêtre dans laquelle la jauge doit être affichée,

- Nom du champ de type Jauge à utiliser. 






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Index corrompu
<a name="index_corrompu_ELTPARAGRAPHE000118"></a>Lorsque la fonction détecte un problème dans le fichier d'index, la variable **H.Commentaire** contient :

```txt
<Nom de la clé concernée> + TAB + <Numéro de l'enregistrement posant problème> + RC + 
<Nom de la clé concernée 2> + TAB + <Numéro de l'enregistrement posant problème 2> ...
```

&lt;Numéro de l'enregistrement posant problème&gt; est égal à -1 si l'enregistrement n'a pas pu être déterminé.

**Remarque** : Si le fichier d'index est entièrement corrompu, la variable **H.Commentaire** n'est pas renseignée.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
