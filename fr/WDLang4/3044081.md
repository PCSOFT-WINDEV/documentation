


## HEtat (Fonction)

***En anglais : HState***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet de connaître l'état d'un enregistrement. Un enregistrement peut être actif, rayé ou supprimé.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003044081&name=hetat_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
SI HEtat(Client) = hEtatActif ALORS
	// Traitements
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HEtat([<Fichier de données> [, <Numéro d'enregistrement>]])`
---

**`<Résultat> : (Constante de type Entier)`**

Etat de l'enregistrement : 


|   |   |
| --- | --- |
| *hEtatActif* | L'enregistrement est actif. |
| *hEtatInvalide* | État de l'enregistrement non trouvé (erreur). |
| *hEtatRaye* | L'enregistrement est rayé. |
| *hEtatSup* | L'enregistrement est supprimé. |



**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données utilisé. Si ce nom n'est pas spécifié, la fonction **HEtat** va manipuler le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Numéro d'enregistrement> : (Entier optionnel)`**

Numéro de l'enregistrement recherché. Si ce numéro n'est pas spécifié (ou est égal à 0), la fonction **HEtat** va manipuler l'enregistrement en cours. L'enregistrement en cours n'est pas relu.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Numéro d'enregistrement non précisé
<a name="numero_enregistrement_non_precise_ELTPARAGRAPHE000115"></a>Si le paramètre &lt;Numéro d'enregistrement&gt; n'est pas précisé, la fonction **HEtat** ne réalise pas de lecture de l'enregistrement.

Dans une application réseau, il est conseillé de relire l'enregistrement avant l'appel de la fonction **HEtat** afin de vérifier que l'enregistrement n'a pas été supprimé. Par exemple avec la fonction [HLit](../WDLang4/3044047.md) :

```wl
HLit(NomFichier, hNumEnrEnCours)
```

<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) 

### Fichiers de données au format 5.5
<a name="fichiers_donnees_format_55_ELTPARAGRAPHE000143"></a>En utilisant le moteur Hyper File 5, il faut relire l'enregistrement pour avoir un état à jour. En effet, si l'enregistrement n'est pas relu après par exemple les fonctions [HSupprime](../WDLang4/3044018.md) ou [HRaye](../WDLang4/3044121.md), la fonction **HEtat** renvoie toujours *hEtatActif*.

Ce fonctionnement n'est pas préservé dans le moteur HFSQL Classic. Après l'utilisation des fonctions [HSupprime](../WDLang4/3044018.md) ou [HRaye](../WDLang4/3044121.md) sur l'enregistrement en cours, la fonction **HEtat** renvoie l'état en cours de l'enregistrement.
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Fichiers xBase
<a name="fichiers_xbase_ELTPARAGRAPHE000174"></a>La fonction [HSupprime](../WDLang4/3044018.md) a le même effet que la fonction [HRaye](../WDLang4/3044121.md) : l'enregistrement est rayé et non supprimé. L'enregistrement peut donc être réactivé par la fonction [HModifie](../WDLang4/3044042.md). 

Dans ce cas, la fonction **HEtat** renvoie la constante *hEtatRaye* sur un enregistrement supprimé (et non la constante *hEtatSup*).

<a name="XComposante"></a>

## Composante :
wd280hf.dll
