
## HInfoRéplica (Fonction)

***En anglais : HInfoReplica***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie des informations sur le réplica spécifié. En particulier, cette fonction permet de savoir si la base de données contient des données à répliquer.

**Attention** : Cette fonction n'est pas utilisable avec la réplication universelle. **Cette fonction est utilisable uniquement avec la "réplication journalée".**


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Si aucune donnée à synchroniser, on grise le bouton
SI HInfoRéplica("", rplMaîtreEstAJour) = Vrai ALORS
	BTN_SYNCHRO..Etat = Grisé
FIN
```




<a name="Exemple2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) 
```wl
// Si pas de synchronisation du maître depuis plus de 7 jours
SI HInfoRéplica("", rplAbonnéEstAJour, "PARIS") = Faux ALORS
	nbJour est un entier
	nbJour = HInfoRéplica("", rplDateSynchroVersMaître, "PARIS")/(24*60*60)
	SI nbJour > 7 ALORS
		 Info("Vous n'avez pas mis à jour PARIS depuis " + ...
			nbJour + " jours.")
	FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HInfoRéplica(<Chemin complet du fichier Réplica> , <Information à connaître> [, <Identifiant du réplica abonné>])`
---

**`<Résultat> : (Type dépendant du type d'information)`**

Information demandée.

**`<Chemin complet du fichier Réplica> : (Chaîne de caractères)`**

Chemin complet du fichier Réplica (fichier ".RPL" ou ".RPM") correspondant au réplica à analyser. Dans le cas d'un réplica transportable, correspond au chemin du fichier "\*.WDZ". 
Si ce paramètre correspond à une chaîne vide (""), le réplica est recherché dans le répertoire en cours.

**`<Information à connaître> : (Constante)`**

Selon le type de réplica analysé, les informations sont différentes :

- Réplica maître :
	


|   |   |
| --- | --- |
| *rplAbonnéEstAJour* | &lt;Résultat&gt; est un booléen.<br><br>	- <u><u><u><u>Vrai</u></u></u></u> si aucune donnée ne doit être envoyée,<br><br>	- <u><u><u><u>Faux</u></u></u></u> si des données doivent être envoyées à un poste abonné.<br><br><br> |
| *rplDateSynchroDepuisAbonné* | &lt;Résultat&gt; est une chaîne de caractères au format "AAAAMMJJ".<br><br>Date de la dernière synchronisation vers la base maître. |
| *rplDateSynchroVersAbonné* | &lt;Résultat&gt; est une chaîne de caractères au format "AAAAMMJJ".<br><br>Date de la dernière synchronisation vers la base abonnée. |
| *rplNumRéplicaTransportable* | Numéro de génération du dernier réplica transportable généré pour le réplica abonné d'identifiant &lt;Identifiant du réplica abonné&gt;. |



- Réplica abonné :
	


|   |   |
| --- | --- |
| *rplDateSynchroDepuisMaître* | &lt;Résultat&gt; est une chaîne de caractères au format "AAAAMMJJ".<br><br>Date de la dernière synchronisation depuis la base maître. |
| *rplDateSynchroVersMaître* | &lt;Résultat&gt; est une chaîne de caractères au format "AAAAMMJJ".<br><br>Date de la dernière synchronisation vers la base maître. |
| *rplMaîtreEstAJour* | &lt;Résultat&gt; est un booléen.<br><br>	- <u><u><u><u>Vrai</u></u></u></u> si aucune donnée ne doit être envoyée,<br><br>	- <u><u><u><u>Faux</u></u></u></u> si des données doivent être envoyées à un poste maître.<br><br><br> |
| *rplNumRéplicaTransportable* | Numéro de génération du dernier réplica transportable généré. Ce numéro est incrémenté à chaque appel de la fonction [HCréeRéplicaTransportable](../WDLang4/3044209.md). |



- Réplica transportable :
	


|   |   |
| --- | --- |
| *rplNumRéplicaTransportable* | Numéro de génération du dernier réplica transportable généré. Ce numéro est incrémenté à chaque appel de la fonction [HCréeRéplicaTransportable](../WDLang4/3044209.md). |






**`<Identifiant du réplica abonné> : (Chaîne de caractères optionnelle ou entier optionnel)`**

Identifie un réplica abonné. Ce paramètre est pris en compte si &lt;Chemin complet du fichier Réplica&gt; correspond à un réplica maître. Ce paramètre peut être : 

- soit la valeur passée à la fonction [HCréeRéplicaAbonné](../WDLang4/3044253.md) pour identifier le réplica abonné

- soit la valeur renvoyée par la fonction [HCréeRéplicaAbonné](../WDLang4/3044253.md).






<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
