
## Accès aux bases de données : résumé
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000608"></a>
WINDEV, WEBDEV et WINDEV Mobile proposent différents modes d'exécution des requêtes SQL en fonction du type d'accès effectué à la base de données.

- **Accès à une base de données HFSQL** (diffusion libre et gratuite avec vos applications WINDEV) : 
	Aucune contrainte d'installation. 
	Les fonctions SQL et HFSQL (HLitxxx, ...) peuvent être utilisées avec ce type d'accès.

- **Accès par un Connecteur Natif (accès natif)** : Connecteur Natif Oracle, SQL Server, AS/400, ou autres.
	Pour chaque type de Connecteur natif, il est nécessaire de posséder un module complémentaire à WINDEV et/ou WEBDEV. Contactez le service commercial pour les délais de disponibilité sur votre base de données. 
	Pour les accès de type Oracle ou SQL Server, il est nécessaire d'installer la couche client sur le poste de l'utilisateur.
	Les fonctions SQL et HFSQL (HLitxxx, ...) peuvent être utilisées avec ce type d'accès. Ce type d'accès est plus rapide que les accès par ODBC ou par un provider OLE DB.

- **Accès par un driver ODBC direct** : 
	Les caractéristiques de la connexion à la base de données doivent être définies dans l'administrateur ODBC de Windows. Seules les fonctions de type SQL sont utilisables pour ce type d'accès. Les fonctions HFSQL (HLitxxx, ...) ne sont pas utilisables.

- **Accès ODBC via le provider OLE DB** : 
	Ce type d'accès utilise un provider OLE DB spécifique. **Ce type d'accès est déconseillé car plus lent qu'un accès par un driver ODBC**. En effet, les performances sont moins bonnes que par un driver ODBC direct car l'accès se fait à la fois par le driver ODBC et par le provider OLE DB. 
	Les fonctions HFSQL (HLitxxx, ...) et SQL peuvent être utilisées avec ce type d'accès. 
	Il est nécessaire de définir les caractéristiques de la connexion à la base de données dans l'administrateur ODBC de Windows. Le provider ainsi que le MDAC 2.6 (ou supérieur) doivent être installés sur le poste.

- **Accès par un provider OLE DB** : 
	Ce type d'accès utilise un provider OLE DB. Le provider ainsi que le MDAC 2.6 (ou supérieur) doivent être installés sur le poste. 
	Les fonctions SQL et HFSQL (HLitxxx, ...) peuvent être utilisées avec ce type d'accès.






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Particularités
<a name="particularites_ELTTEXTE000632"></a>
**Accès à xBase possible via HFSQL**
Des fonctions spécifiques à xBase sont utilisables en plus des fonctions classiques HFSQL ([HDBOuvre](../WDLang4/3044163.md), etc.).

**Fichiers ASCII**
Utilisez les fonctions du WLangage spécifiques aux fichiers externes ([fOuvre](../WDLang1/3036036.md), [fLit](../WDLang1/3036048.md), [fEcrit](../WDLang1/3036014.md), etc.).

**Fichiers INI**
Utilisez les fonctions du WLangage spécifiques aux fichiers INI ([INILit](../WDLang1/3013043.md), [INIEcrit](../WDLang1/3013039.md), etc.).

**Gestion de la base de registre**
Utilisez les fonctions du WLangage spécifiques à la base de registre ([RegistreLit](../WDLang1/3065012.md), [RegistreEcrit](../WDLang1/3065006.md), etc.).



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Quelles fonctions utiliser ?
<a name="quelles_fonctions_utiliser_ELTTEXTE000656"></a>


### Accès HFSQL
<a name="acces_hfsql_ELTPARAGRAPHE000100"></a>

   | --- |
| --- | --- |
|   | HFSQL |
|   | **Accès intégré** |
|   | Fonctions SQL | Fonctions HFSQL (HLitxxx, ...) |
| Connexion à la base de données | [SQLConnecte](../WDLang4/3072005.md)<br>Paramètre &lt;Type de la base&gt; : "HFSQL" | Si l'analyse est liée au projet, connexion automatique, sinon, utilisez une des fonctions suivantes :<br><br>- [HOuvreAnalyse](../WDLang4/3044106.md)<br><br>- [HDéclareExterne](../WDLang4/3044204.md)<br><br>- [HDéclare](../WDLang4/3044203.md)<br><br><br> |
| Description dynamique de la connexion | Inutile | Inutile |
| Exécution de la requête | [SQLExec](../WDLang4/3072007.md) | [HExécuteRequête](../WDLang4/3044080.md), [HExécuteRequêteSQL](../WDLang4/3044084.md) |
| Lecture du résultat | - [parcours de type SQLPremier/SQLCol](../WDLang4/3072025.md)<br>- [parcours de type SQLAvance/SQLLitCol, SQLLitMémo](../WDLang4/3072025.md)<br>- [SQLTable](../WDLang4/3072031.md) | Toutes les fonctions de lecture classiques :<br><br>- [HLitPremier](../WDLang4/3044051.md), [HLitSuivant](../WDLang4/3044037.md), [HLitRecherche](../WDLang4/3044050.md), ...<br><br>- Les filtres<br><br>- Les vues<br><br><br> |
| Blocage des enregistrements | Impossible | [HBloqueFichier](../WDLang4/3044153.md)<br>[HBloqueNumEnr](../WDLang4/3044152.md)<br>Fonctions de lecture bloquante ([HLitPremier](../WDLang4/3044051.md), [HLitRecherche](../WDLang4/3044050.md), ...) |
| Changement de la connexion (passe à une autre connexion ouverte) | [SQLChangeConnexion](../WDLang4/3072016.md) | Inutile |
| Fermeture de la connexion | [SQLDéconnecte](../WDLang4/3072008.md) | Si l'analyse est liée au projet, fermeture automatique, sinon utilisez une des fonctions suivantes :<br><br>- [HFermeAnalyse](../WDLang4/3044054.md),<br><br>- [HAnnuleDéclaration](../WDLang4/3044174.md)<br><br><br> |
| Vitesse (\*\*)<br>Cas général | \*\*(\*) | \*\*\* |






|   |   |   |   |
| --- | --- | --- | --- |
|   | **ORACLE, SQL Server, Access, ...** |
|   | **Connecteur/Accès natif (\*)** | **Driver ODBC (Direct)** |
|   | Fonctions SQL | Fonctions HFSQL (HLitxxx, ...) | Fonctions SQL |
| Connexion à la base de données | [SQLConnecte](../WDLang4/3072005.md)<br>Paramètre &lt;Type de la base&gt; : "ORACLE" ou "SQL SERVER" ou "AS400" | [HOuvreConnexion](../WDLang4/3044107.md) avec le nom de la connexion à ouvrir. La connexion doit être définie dans l'analyse ou dynamiquement (voir ci-dessous) | [SQLConnecte](../WDLang4/3072005.md)<br>Paramètre &lt;Type de la base&gt; : "ODBC" |
| Description dynamique de la connexion | [HDécritConnexion](../WDLang4/3044205.md) |
| Exécution de la requête | [SQLExec](../WDLang4/3072007.md) | [HExécuteRequête](../WDLang4/3044080.md), [HExécuteRequêteSQL](../WDLang4/3044084.md) | [SQLExec](../WDLang4/3072007.md) |
| Lecture du résultat | - [parcours de type SQLPremier/SQLCol](../WDLang4/3072025.md)<br>- [parcours de type SQLAvance/SQLLitCol, SQLLitMémo](../WDLang4/3072025.md)<br>- [SQLTable](../WDLang4/3072031.md) | Toutes les fonctions de lecture classiques :<br>[HLitPremier](../WDLang4/3044051.md), [HLitSuivant](../WDLang4/3044037.md), [HLitRecherche](../WDLang4/3044050.md), ...<br>Les filtres | - [parcours de type SQLPremier/SQLCol](../WDLang4/3072025.md)<br>- [parcours de type SQLAvance/SQLLitCol, SQLLitMémo](../WDLang4/3072025.md)<br>- [SQLTable](../WDLang4/3072031.md) |
| Blocage des enregistrements | [SQLBloque](../WDLang4/3072003.md) | Chaque base a ses particularités. Pour l'accès natif SQL Server ou Oracle, il est possible d'utiliser la fonction [HBloqueFichier](../WDLang4/3044153.md). | Le driver ODBC ne supporte pas les blocages. |
| Changement de la connexion (passe à une autre connexion ouverte) | [SQLChangeConnexion](../WDLang4/3072016.md) | La connexion utilisée est précisée dans la fonction [HExécuteRequêteSQL](../WDLang4/3044084.md) ou dans la fonction [HExécuteRequête](../WDLang4/3044080.md). | [SQLChangeConnexion](../WDLang4/3072016.md) |
| Fermeture de la connexion | [SQLDéconnecte](../WDLang4/3072008.md) | [HFermeConnexion](../WDLang4/3044095.md) | [SQLDéconnecte](../WDLang4/3072008.md) |
| Vitesse (\*\*)<br>Cas général | \*\*\* | \*\*(\*) | \*\* |






|   |   |   |   |   |
| --- | --- | --- | --- | --- |
|   | **ORACLE, SQL Server, Access, ...** |
|   | **ODBC via le provider OLE DB** | **Provider OLE DB** |
|   | Fonctions SQL | Fonctions HFSQL (HLitxxx, ...) | Fonctions SQL | Fonctions HFSQL (HLitxxx, ...) |
| Connexion à la base de données | [SQLConnecte](../WDLang4/3072005.md)<br>Paramètre &lt;Type de la base&gt; : "ODBC"<br>Paramètre &lt;Provider OLEDB&gt; : "MSSASQL" ou la constante hODBC. | [HOuvreConnexion](../WDLang4/3044107.md) avec le nom de la connexion à ouvrir. La connexion doit être définie dans l'analyse ou dynamiquement (voir ci dessous) | [SQLConnecte](../WDLang4/3072005.md)<br>Paramètre &lt;Type de la base&gt; : "OLEDB"<br>Paramètre &lt;Provider OLEDB&gt; : correspondant à celui voulu (chaîne de caractères ou constante) | [HOuvreConnexion](../WDLang4/3044107.md) avec le nom de la connexion à ouvrir. La connexion doit être définie dans l'analyse ou dynamiquement (voir ci dessous). |
| Description dynamique de la connexion | [HDécritConnexion](../WDLang4/3044205.md) | [HDécritConnexion](../WDLang4/3044205.md) |
| Exécution de la requête |   | [SQLExec](../WDLang4/3072007.md) | [HExécuteRequête](../WDLang4/3044080.md), [HExécuteRequêteSQL](../WDLang4/3044084.md) | [HExécuteRequête](../WDLang4/3044080.md), [HExécuteRequêteSQL](../WDLang4/3044084.md) |
| Lecture du résultat | - [parcours de type SQLPremier/SQLCol](../WDLang4/3072025.md)<br>- [parcours de type SQLAvance/SQLLitCol, SQLLitMémo](../WDLang4/3072025.md)<br>- [SQLTable](../WDLang4/3072031.md) | Toutes les fonctions de lecture classiques :<br>[HLitPremier](../WDLang4/3044051.md), [HLitSuivant](../WDLang4/3044037.md), [HLitRecherche](../WDLang4/3044050.md), ...<br>Les filtres | - [parcours de type SQLPremier/SQLCol](../WDLang4/3072025.md)<br>- [parcours de type SQLAvance/SQLLitCol, SQLLitMémo](../WDLang4/3072025.md)<br>-  [SQLTable](../WDLang4/3072031.md) | Toutes les fonctions de lecture classiques :<br>[HLitPremier](../WDLang4/3044051.md), [HLitSuivant](../WDLang4/3044037.md), [HLitRecherche](../WDLang4/3044050.md), ...<br>Les filtres |
| Blocage des enregistrements | Le provider ne supporte pas les blocages. | Le provider ne supporte pas les blocages. | Le provider ne supporte pas les blocages. | Le provider ne supporte pas les blocages. |
| Changement de la connexion (passe à une autre connexion ouverte) | [SQLChangeConnexion](../WDLang4/3072016.md) | La connexion utilisée est précisée dans la fonction [HExécuteRequêteSQL](../WDLang4/3044084.md) ou dans la fonction [HExécuteRequête](../WDLang4/3044080.md). | [SQLChangeConnexion](../WDLang4/3072016.md) | La connexion utilisée est précisée dans la fonction [HExécuteRequêteSQL](../WDLang4/3044084.md) ou dans la fonction [HExécuteRequête](../WDLang4/3044080.md). |
| Fermeture de la connexion | [SQLDéconnecte](../WDLang4/3072008.md) | [HFermeConnexion](../WDLang4/3044095.md) | [SQLDéconnecte](../WDLang4/3072008.md) | [HFermeConnexion](../WDLang4/3044095.md) |
| Vitesse (\*\*)<br>Cas général | \* | \* | \*\* | \* (\*) |





(\*) : Contactez le service commercial pour les délais de disponibilité sur votre base de données.

(\*\*) : Les indications de vitesse sont des indications générales; la vitesse réelle dépend de l'application, de la configuration, du contenu de la Base de Données...




