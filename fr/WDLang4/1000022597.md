
## mongoOptionEcriture (Type de variable)

***En anglais : mongoWriteConcern***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **mongoOptionEcriture** permet de définir le niveau d'accusé de réception demandé pour les opérations d'écriture dans un mongod autonome, dans un ensemble de réplicas ou dans des clusters fragmentés. Les caractéristiques de ces options peuvent être définies et modifiées à l'aide de différentes propriétés WLangage. 

**Remarques** : 

- Ce type de variable est utilisé par les variables de type [mongoCollection](../WDLang4/1000022411.md). 

- Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MaCollection.OptionEcriture.Mode = moeMajorité
```





<a name="NOTE0"></a>

## Remarques
<a name="NOTE0_1"></a>


### Propriétés spécifiques à la description des variables de type mongoOptionEcriture
<a name="proprietes_specifiques_description_des_variables_type_mongooptionecriture_ELTPARAGRAPHE000046"></a>Les propriétés suivantes peuvent être utilisées pour manipuler les options d'écriture dans une collection Mongo :

| Nom de la propriété | Type manipulé | Effet |
| --- | --- | --- |
| Journal | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> pour écrire  une trace de l'opération d'écriture dans le journal.<br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.<br><br><br> |
| Mode | Constante de type Entier | Nombre de noeuds minimum devant avoir acquittés le traitement pour considérer l'écriture effectuée. Les valeurs suivantes sont disponibles : <br><br>- *moeDéfaut* : Un seul noeud doit avoir acquitté le traitement pour que l'écriture soit considérée comme effectuée. <br><br>- *moeMajorité* : La majorité des noeuds doit avoir acquitté le traitement pour que l'écriture soit considérée comme effectuée. <br><br>- *moeTag* : Le nombre de noeuds est celui défini dans une pré-configuration définie sure le serveur. Dans ce cas, la propriété **.Tag** doit être spécifiée. <br><br>- *moeSansAcquittement* : Aucun noeud ne doit avoir acquitté le traitement pour que l'écriture soit considérée comme effectuée. Attention, dans ce cas, aucune erreur n'est renvoyée. <br><br>- Nombre de noeuds minimum devant avoir acquittés le traitement (entier strictement positif).<br><br><br> |
| Tag | Chaîne de caractères | Nom d'une pré-configuration du serveur. |
| Timeout | Entier ou Durée | <br><br>- Temps maximum d'attente pour effectuer une écriture. Les écritures sont considérées comme échouées après ce délai. <br><br>- 0 pour ne pas avoir de timeout d'écriture.<br><br><br><br><br>Cette propriété peut correspondre à : <br><br>- un entier correspondant au nombre de secondes, <br><br>- une variable de type Durée, <br><br>- l'indication directe de la durée (par exemple 1 s ou 10 ms). <br><br><br> |








