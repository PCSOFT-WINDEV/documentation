
## SQLTable (Fonction)

***En anglais : SQLTable***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Transfère directement le résultat d'une requête dans un champ Table par programmation (un champ Liste ou un champ Combo), avec possibilité de Fetch Partiel (récupération du résultat par blocs de lignes). Dans un parcours du type "SQLAvance/SQLLitCol", le transfert des informations dans le champ Table se fera à partir de l'enregistrement en cours.

**Remarque** : Cette fonction doit être utilisée lors d'un parcours du résultat de la requête de type SQLAvance/ SQLLitCol. Si cette fonction est utilisée dans un parcours de type SQLPremier/SQLCol, une erreur fatale est générée. Pour plus de détails sur les différents types de parcours du résultat d'une requête SQL, consultez [Types de parcours SQL](../WDLang4/3072025.md).


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Le fetch partiel est automatiquement réalisé par le framework JAVA.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Transfert dans un champ Table : récupération sans fetch
ResSQL = SQLExec("SELECT NOMCLI,PRENOMCLI FROM FACT", "REQ1")
SI ResSQL ALORS
	SQLTable("REQ1", TABLE_TabReq, "Nom du client" + TAB + "Prénom", "30 20")
	// Calcule le nombre d'enregistrements résultat
	NbEnr est un entier = TableOccurrence(TABLE_TabReq)
SINON
	// Erreur SQL
FIN
SQLFerme("REQ1")
```




<a name="Exemple2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![ODBC](https://doc.pcsoft.fr/ext/images/fr/ODBC.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 
```wl
// Transfert dans un champ Table : récupération uniquement des 25 premiers
ResSQL = SQLExec("SELECT NOMCLI,PRENOMCLI,VILLE FROM FACT", "REQ1")
SI ResSQL ALORS
	// Avoir uniquement les 25 premières lignes
	SQLTable("REQ1", TABLE_TabReq, 25)
SINON
	// Erreur SQL
FIN
SQLFerme("REQ1")
```


<a name="Exemple3"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![ODBC](https://doc.pcsoft.fr/ext/images/fr/ODBC.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 
```wl
// Transfert dans un champ Table : récupération par Fetch
ResSQL = SQLExec("SELECT NOMCLI,PRENOMCLI,VILLE FROM FACT", "REQ1")
SI ResSQL ALORS
	// Récupération par groupe de 28 lignes
	TANTQUE SQLTable(28,"REQ1", TABLE_MATABLE, "ColTitre", "90")
		// Traitement  
SINON
	// Erreur SQL
FIN
SQLFerme("REQ1")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Transfert dans un champ Table par programmation sans Fetch Partiel

`SQLTable(<Nom de la requête> , <Champ Table> , <Nombre de lignes maximum> [, <Titre des colonnes>] , <Largeur des colonnes>)`
---

**`<Nom de la requête> : (Chaîne de caractères)`**

Nom de la requête créée et exécutée avec la fonction [SQLExec](../WDLang4/3072007.md), ou exécutée avec la fonction [SQLExecWDR](../WDLang4/3072010.md).

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Le nom de la requête doit obligatoirement être entre guillemets.

**`<Champ Table> : (Nom de champ)`**

Nom du champ Table par programmation dans lequel le résultat de la requête doit être affiché.

**`<Nombre de lignes maximum> : (Entier)`**

Nombre de lignes maximum affichées dans le champ Table. Si ce paramètre est précisé, le champ Table contiendra au maximum &lt;Nombre de lignes maximum&gt; lignes affichées, même si le résultat de la requête contient un nombre supérieur de lignes.

**`<Titre des colonnes> : (Chaîne de caractères optionnelle)`**

Liste de tous les titres des colonnes du champ Table par programmation. Les différents titres sont séparés par TAB. Pour préciser uniquement la largeur des colonnes, ce paramètre peut correspondre à une chaîne vide ("").

**`<Largeur des colonnes> : (Chaîne de caractères)`**

Liste de toutes les largeurs des colonnes, séparées par un caractère espace. Pour préciser uniquement le titre des colonnes, ce paramètre peut correspondre à une chaîne vide ("").  


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Transfert dans un champ Table par programmation avec Fetch Partiel

`SQLTable(<Nombre de lignes dans un bloc> , <Nom de la requête> , <Champ Table> [, <Titre des colonnes>] , <Largeur des colonnes>)`
---

**`<Nombre de lignes dans un bloc> : (Entier)`**

Nombre de lignes constituant un bloc pour le Fetch Partiel. Seul ce bloc de lignes est chargé en mémoire, les blocs suivants sont automatiquement chargés en mémoire en tâche de fond.

**`<Nom de la requête> : (Chaîne de caractères)`**

Nom de la requête créée et exécutée avec la fonction [SQLExec](../WDLang4/3072007.md), ou exécutée avec la fonction [SQLExecWDR](../WDLang4/3072010.md).

**`<Champ Table> : (Nom de champ)`**

Nom du champ Table par programmation dans lequel le résultat de la requête doit être affiché.

**`<Titre des colonnes> : (Chaîne de caractères optionnelle)`**

Liste de tous les titres des colonnes du champ Table par programmation. Les différents titres sont séparés par TAB. Pour préciser uniquement la largeur des colonnes, ce paramètre peut correspondre à une chaîne vide ("").

**`<Largeur des colonnes> : (Chaîne de caractères)`**

Liste de toutes les largeurs des colonnes, séparées par un caractère espace. Pour préciser uniquement le titre des colonnes, ce paramètre peut correspondre à une chaîne vide ("").  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Caractéristiques du champ Table par programmation
<a name="caracteristiques_champ_table_par_programmation_ELTPARAGRAPHE000120"></a>Le nombre de colonnes du champ Table par programmation doit être suffisant pour accueillir toutes les colonnes du résultat de la requête.


<a name="NOTE0_2"></a>




### Fermeture d'une requête
<a name="fermeture_une_requete_ELTPARAGRAPHE000129"></a>Une requête est fermée automatiquement :

- après l'exécution de la fonction **SQLTable** si le Fetch partiel n'est pas utilisé.

- dès que le résultat de la requête est récupéré en totalité si le Fetch partiel est utilisé.





<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![ODBC](https://doc.pcsoft.fr/ext/images/fr/ODBC.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Utilisation du Fetch Partiel
<a name="utilisation_fetch_partiel_ELTPARAGRAPHE000145"></a>La récupération en cours s'arrête dès que la fonction [SQLFerme](../WDLang4/3072015.md) est appelée ou dès que la fenêtre contenant le champ Table est fermée.

Il est possible d'utiliser le Fetch Partiel sur plusieurs requêtes en même temps.
<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![ODBC](https://doc.pcsoft.fr/ext/images/fr/ODBC.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Les différents types de requêtes
<a name="les_differents_types_requetes_ELTPARAGRAPHE000159"></a>La fonction **SQLTable** permet d'associer à un champ Table par programmation les requêtes créées avec la fonction [SQLExec](../WDLang4/3072007.md).

Pour associer à un champ Table par programmation les requêtes créées sous l'éditeur de requêtes (ou crées avec la fonction [HExécuteRequêteSQL](../WDLang4/3044084.md)), utilisez la fonction [FichierVersTableMémoire](../WDLang1/3074005.md).
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![ODBC](https://doc.pcsoft.fr/ext/images/fr/ODBC.png) 

### Récupération de rubriques de type Float sur Oracle (via ODBC)
<a name="recuperation_rubriques_type_float_sur_oracle_via_odbc_ELTPARAGRAPHE000182"></a>Par défaut, le séparateur décimal utilisé pour les rubriques de type Float sur Oracle est le point. Or le driver ODBC renvoie la valeur avec en utilisant la virgule comme séparateur décimal. Lors de l'affectation de la valeur dans un champ de type numérique, les décimales sont perdues.

Pour éviter ce problème, il suffit de configurer le séparateur décimal pour la connexion en cours :


```wl
// Connexion à la base de données Oracle 
SQLConnecte("MaBaseOracle", "User", "Passe", "", "ODBC") 
// Requête pour changer le séparateur décimal 
SQLExec("ALTER SESSION SET NLS_NUMERIC_CHARACTERS ='. '", "ReqTemp")
```





<a name="NOTE0_6"></a>


### Gestion de l'Unicode
<a name="gestion_unicode_ELTPARAGRAPHE000198"></a>La gestion de l'Unicode peut être définie au niveau de la configuration de projet (onglet "Unicode" de la fenêtre de description de la configuration) : 

- Si l'option "Utiliser des chaînes ANSI en exécution" est sélectionnée : les données sont converties en utilisant l'alphabet courant. 
	Rappel : La fonction [ChangeAlphabet](../WDLang1/3054001.md) permet de modifier l'alphabet courant.

- Si l'option "Utiliser des chaînes UNICODE en exécution" est sélectionnée, les données sont insérées sans transformation.






<a name="XComposante"></a>

## Composante :
wd280obj.dll
