


## &lt;Variable Connexion&gt;.InfoDroitFichier (Fonction)

***En anglais : &lt;Connection variable&gt;.InfoFileRights***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet de connaître les droits accordés sur un fichier de données HFSQL Client/Serveur pour un utilisateur ou un groupe.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Description de la connexion
MaConnexion est une Connexion

sDroits est une chaîne
sUnDroit est une chaîne
// Récupère les droits de lecture et d'ajout de l'utilisateur Dupont 
// sur le fichier MonFichier.fic de la base de données MaBase
sDroits = MaConnexion.InfoDroitFichier("Dupont", hDroitLecture + hDroitAjout, ...
									 "MaBase", "MonFichier.fic")
sUnDroit = ExtraitChaîne(sDroits, rangPremier, TAB)
TANTQUE sUnDroit <> EOT
	SELON sUnDroit
		CAS hAutorisé
		...
		CAS hInterdit
		...
		CAS hHérité
		... 
	FIN
	sUnDroit = ExtraitChaîne(sDroits, rangSuivant, TAB)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Connexion>.InfoDroitFichier(<Utilisateur/Groupe> , <Droits> , <Base de données> , <Fichier de données> [, <Mode d'affichage>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Informations demandées, 

- Chaîne vide ("") en cas d'erreur. 

- "Utilisateur inconnu" ou "Groupe inconnu" si l'utilisateur en cours n'a pas le droit de visualisation des utilisateurs (constante *hDroitVisualisationUtilisateur*) et s'il demande des informations concernant un autre utilisateur ou groupe.




**En mode hDéfaut**, &lt;Résultat&gt; est une liste de valeurs séparées par des tabulations (TAB). Chaque valeur de cette liste correspond au droit demandé par le paramètre &lt;Droits&gt;. Chaque valeur de cette liste peut correspondre à l'une des constantes suivantes :


|   |   |
| --- | --- |
| *hAutorisé* | L'utilisateur ou le groupe a le droit considéré. |
| *hHérité* | L'utilisateur appartient à au moins un groupe pour lequel le droit considéré a été autorisé.<br>Cette constante est renvoyée uniquement si le mode d'affichage n'est pas *hEffectif*. |
| *hInterdit* | L'utilisateur ou le groupe n'a pas le droit considéré. |


**En mode hDétail**, &lt;Résultat&gt; est une liste de valeurs de la forme : 

```txt
<Droit considéré 1> + TAB + <Valeur du droit 1> + RC + ... 
<Droit considéré N> + TAB + <Valeur du droit N> + RC
```

Les droits correspondent aux constantes utilisées dans le paramètre &lt;Droit&gt; et les valeurs du droit correspondent aux constantes *hAutorisé*, *hInterdit* ou *hHérité*(voir tableau ci-dessus).

**`<Connexion> : (Variable de type Connexion)`**

Nom de la variable de type [Connexion](../WDLang4/1514073.md) décrivant la connexion pour laquelle les droits d'un utilisateur ou d'un groupe d'utilisateurs doivent être connus.

**`<Utilisateur/Groupe> : (Chaîne de caractères)`**

Nom de l'utilisateur ou du groupe dont on veut connaître les droits.

**`<Droits> : (Constante ou combinaison de constantes de type Entier)`**

Liste des droits à rechercher :


|   |   |
| --- | --- |
| *hDroitAjout* | Droit d'ajouter de nouveaux enregistrements dans un fichier de données. |
| *hDroitBlocage* | Droit de bloquer les fichiers ou les enregistrements d'un fichier de données. |
| *hDroitChangeDroit* | Droits de changer les droits. |
| *hDroitChangeLiaison* | Droit de modifier les règles d'intégrité sur un fichier de données. |
| *hDroitChangePropriétaire* | Droit de modifier le propriétaire d'un élément. |
| *hDroitGèreDoublon* | Droit de brancher et de débrancher la gestion des doublons. |
| *hDroitLecture* | Droit de lire les enregistrements d'un fichier de données. |
| *hDroitMaintenance* | Droit de lancer une ré-indexation ou un calcul de statistiques sur un fichier de données. |
| *hDroitModifAuto* | Droit de lancer une modification automatique sur un fichier de données. |
| *hDroitModification* | Droit de modifier les enregistrements d'un fichier de données. |
| *hDroitSuppression* | Droit de supprimer les enregistrements d'un fichier de données. |
| *hDroitSuppressionFichier* | Droit de supprimer un fichier de données (fonction [&lt;Variable Connexion&gt;.SupprimeFichier](../WDLang4/1000022757.md)) |
| *hDroitTous* | Liste de tous les droits.<br>Il est conseillé d'utiliser cette constante en mode d'affichage *hDétail* ou *hEffectif* + *hDétail*. |



**`<Base de données> : (Chaîne de caractères)`**

Nom de la base de données contenant le fichier de données pour lequel les droits sont recherchés. 
Si la base de données correspond à la base de données définie dans la connexion, ce paramètre peut correspondre à une chaîne vide (""). 
Si aucune base de données n'est définie dans la connexion et si ce paramètre correspond à une chaîne vide, une erreur WLangage est affichée.

**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données HFSQL présent sur le serveur pour lequel les droits sont recherchés. L'extension du fichier de données doit être précisée.

**`<Mode d'affichage> : (Constante optionnelle de type Entier)`**

Mode d'affichage du résultat :


|   |   |
| --- | --- |
| *hDéfaut*<br>(Valeur par défaut) | Le droit renvoyé ne tient pas compte des droits qui seront éventuellement hérités (par exemple, les droits définis pour les groupes auxquels l'utilisateur appartient).<br>Si le droit n'a pas été défini, la valeur de ce droit sera *hHérité*.<br>&lt;Résultat&gt; contient uniquement les valeurs des droits demandés (dans le même ordre). |
| *hDétail* | Idem *hDéfaut*. <br>&lt;Résultat&gt; contient le droit et sa valeur. |
| *hEffectif* | Le droit renvoyé correspond au droit qui sera effectivement appliqué pour l'utilisateur ou le groupe sur le fichier de données. Les droits éventuellement hérités sont pris en compte (par exemple, les droits définis pour les groupes auxquels l'utilisateur appartient). |
| *hEffectif + hDétail* | Idem *hEffectif*. <br>&lt;Résultat&gt; contient le droit et sa valeur. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
Pour modifier les droits sur un fichier de données pour un utilisateur ou un groupe, utilisez la fonction [&lt;Variable Connexion&gt;.ModifieDroitFichier](../WDLang4/1000022709.md).

<a name="XComposante"></a>

## Composante :
wd280hf.dll
