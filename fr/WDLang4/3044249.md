
## Accès Natif xBase/FoxPro : Spécificités et remarques
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000258"></a>
Cette page d'aide présente les spécificités concernant la programmation de l'accès Natif xBase/FoxPro. 

Les formats des fichiers de données gérés sont : 

- dBase3+

- dBase4

- FoxPro/FoxBase (jusqu'à la version 9)

- Clipper5

- Clipper87






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Remarques générales
<a name="remarques_generales_ELTTEXTE000288"></a>


### Gestion de l'intégrité et des doublons
<a name="gestion_integrite_des_doublons_ELTPARAGRAPHE000028"></a>Les doublons et l'intégrité ne sont pas gérés. 


<a name="NOTE2_2"></a>


### Fichiers mémos
<a name="fichiers_memos_ELTPARAGRAPHE000036"></a>Les fichiers mémos sont automatiquement ouverts et gérés avec les fichiers de données.
<a name="NOTE2_3"></a>


### Modification automatique des données
<a name="modification_automatique_des_donnees_ELTPARAGRAPHE000043"></a>La procédure de modification automatique des fichiers de données HFSQL ne peut pas être utilisée avec les fichiers xBase/FoxPro.


<a name="NOTE2_4"></a>


### Blocages des fichiers de données
<a name="blocages_des_fichiers_donnees_ELTPARAGRAPHE000051"></a>Il est possible de bloquer un fichier de données en écriture et/ou en lecture dans sa totalité uniquement. En effet, le blocage d'une partie des enregistrements d'un fichier de données n'est pas possible avec l'Accès Natif xBase/FoxPro.


<a name="NOTE2_5"></a>


### Suppression d'enregistrements
<a name="suppression_enregistrements_ELTPARAGRAPHE000059"></a>Un enregistrement peut être supprimé avec la fonction [HSupprime](../WDLang4/3044018.md) ou avec la fonction [HRaye](../WDLang4/3044121.md). Sur des fichiers xBase/FoxPro, les fonctions [HSupprime](../WDLang4/3044018.md) et [HRaye](../WDLang4/3044121.md) ont la même action : l'enregistrement est "rayé".


<a name="NOTE2_6"></a>


### Nombre d'enregistrements
<a name="nombre_enregistrements_ELTPARAGRAPHE000079"></a>La fonction [HNbEnr](../WDLang4/3044006.md) utilisée avec la constante *hEtatActif* ou *hEtatTous* renvoie également le nombre d'enregistrements rayés (ou supprimés), par compatibilité avec WINDEV 5.5. 

Par contre, il est possible de connaître le nombre d'enregistrements rayés ou supprimés grâce à la fonction [HNbEnr](../WDLang4/3044006.md) utilisée avec la constante *hEtatSup* ou *hEtatRayé*. 


<a name="NOTE2_7"></a>


### Recherche d'enregistrements
<a name="recherche_enregistrements_ELTPARAGRAPHE000095"></a>Lors d'une recherche, si le nombre de caractères de la valeur recherchée est supérieur au nombre maximal de caractères de la rubrique clé sur laquelle s'effectue la recherche, la recherche est effectuée uniquement avec les *N* caractères de la valeur recherchée (où *N* est le nombre maximal de caractères de la rubrique clé).

**Exemple** : Le nombre maximal de caractères de la rubrique clé RUB du fichier FICH est de 3. La rubrique clé RUB contient "abc" et "abd".

Si la valeur recherchée est supérieure à 3 caractères, seuls les 3 premiers caractères de cette valeur seront pris en compte.

- Si la valeur recherchée est *"abcd"*, la recherche s'effectuera avec la valeur *"abc"* (un enregistrement sera trouvé).

- Si la valeur recherchée est *"abhd"*, la recherche s'effectuera avec la valeur *"abh"* (aucun enregistrement ne sera trouvé).






Remarque : Dans les recherches et les filtres, les dates vides (chaîne vide) sont supérieures à toutes les autres valeurs de date. 


<a name="NOTE2_8"></a>


### Description dynamique de fichiers de données
<a name="description_dynamique_fichiers_donnees_ELTPARAGRAPHE000113"></a>La description d'un fichier xBase peut être réalisée en WLangage (un projet associé à une analyse HFSQL ou xBase doit être en cours), il faut alors utiliser les fonctions :

- [HDBDécritFichier](../WDLang4/3044172.md).

- [HDBDécritRubrique](../WDLang4/3044170.md).

- [HDBDécritIndex](../WDLang4/3044166.md).

- [HDBCréation](../WDLang4/3044171.md) ou [HDBOuvre](../WDLang4/3044163.md).




Le fichier créé est au **format dBase 3**.

Le fichier décrit en WLangage peut contenir des rubriques mémo et des clés.

Ces commandes permettent notamment de créer des fichiers temporaires.


<a name="NOTE2_9"></a>


### Fichiers HFSQL et fichiers xBase/FoxPro
<a name="fichiers_hfsql_fichiers_xbasefoxpro_ELTPARAGRAPHE000143"></a>Un même projet peut manipuler à la fois des fichiers de données HFSQL et des fichiers de données xBase/FoxPro.

**Attention** : Dans un même projet, un fichier de données HFSQL et un fichier de données xBase/FoxPro ne peuvent pas avoir le même nom logique, sinon une erreur sera générée.



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Spécificités
<a name="specificites_ELTTEXTE000360"></a>


### Options de l'analyse
<a name="options_analyse_ELTPARAGRAPHE000155"></a>Que les options "Sensible à la casse", "Sensible à l'accentuation", "Sensible à la ponctuation" soient cochées ou non dans l'éditeur d'analyses, la recherche sera toujours sensible à la casse, à l'accentuation et à la ponctuation. 


<a name="NOTE3_2"></a>


### Rubriques de type Tableau
<a name="rubriques_type_tableau_ELTPARAGRAPHE000163"></a>Les rubriques de type tableau ne sont pas gérées par l'Accès Natif. Si vous utilisez une rubrique Tableau, seule la valeur de l'indice 1 du tableau sera manipulable avec les fonctions HFSQL (en écriture et en lecture). 


<a name="NOTE3_3"></a>


### Contexte HFSQL indépendant
<a name="contexte_hfsql_independant_ELTPARAGRAPHE000171"></a>La gestion des contextes HFSQL indépendants (case à cocher disponible dans la description des fenêtres et des états) n'est pas disponible dans cette version. 


<a name="NOTE3_4"></a>


### Transactions
<a name="transactions_ELTPARAGRAPHE000179"></a>Il n'est pas possible d'effectuer des transactions (fonction [HTransactionDébut](../WDLang4/3044002.md) ...) sur l'Accès Natif xBase/FoxPro.


<a name="NOTE3_5"></a>


### Limites des fichiers de données xBase
<a name="limites_des_fichiers_donnees_xbase_ELTPARAGRAPHE000190"></a>Consultez [Fichiers au format xBase : Limites](../WDLang4/3044247.md) pour obtenir la liste des limites connues sur les fichiers de données xBase/FoxPro.


<a name="NOTE3_6"></a>


### Index multiples dBase4 (MDX) et FoxPro (CDX)
<a name="index_multiples_dbase4_mdx_foxpro_cdx_ELTPARAGRAPHE000201"></a>L'Accès natif xBase/FoxPro ne supporte pas les deux conditions suivantes réunies : 

- Index basé sur une formule autre que la seule valeur de la rubrique (par exemple UPPER(RUB1) ou RUB1 + RUB2). 

- Nom de l'index logique identique à une des rubriques du fichier xBase/FoxPro.


Le fichier d'index ne sera pas reconnu.

**Solution** : Renommer l'index logique.




