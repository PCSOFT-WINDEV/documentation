


## HRécupèreLog (Fonction)

***En anglais : HRetrieveLog***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Crée un fichier texte contenant les logs du serveur entre deux dates données.

**Remarque** : Cette fonction est une fonction avancée.

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Récupération des logs du serveur pour 2018
SI HRécupèreLog("MaConnexion", "20180101", "20183112", "C:\Mes Documents\MesLogs.txt") = Faux ALORS
	Erreur("Les logs n'ont pas pu être récupérés : " + HErreur())
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HRécupèreLog(<Connexion> , <Date de début> , <Date de fin> , <Fichier Log destination> [, <Jauge>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si les logs ont été récupérés,

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion vers le serveur depuis lequel les logs doivent être récupérés. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).




**`<Date de début> : (Chaînes de caractères)`**

Date à partir de laquelle les logs du serveur doivent être récupérés. Cette date est au format "AAAAMMJJHHmmSSCCC". Si seule la date est précisée ("AAAAMMJJ"), elle sera arrondie automatiquement. Par exemple, "20061121" sera arrondi à "20061121000000000".

**`<Date de fin> : (Chaîne de caractères)`**

Date jusqu'à laquelle les logs du serveur doivent être récupérés. Cette date est au format "AAAAMMJJHHmmSSCCC". Si seule la date est précisée ("AAAAMMJJ"), elle sera arrondie automatiquement. Par exemple, "20061121" sera arrondi à "20061121235959999".

**`<Fichier Log destination> : (Chaîne de caractères)`**

Fichier texte dans lequel sera écrit le contenu du log du serveur entre les deux dates. Si ce fichier existe déjà, il sera écrasé.

**`<Jauge> : (Nom de champ optionnel, nom de fenêtre optionnel ou entier optionnel)`**

Jauge de progression : 

- Nom de la fenêtre dans laquelle la jauge doit être affichée ou nom du champ de type Jauge.

- Identifiant (Handle) de la fenêtre qui affiche la jauge.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Format des lignes du fichier texte
<a name="format_des_lignes_fichier_texte_ELTPARAGRAPHE000105"></a>Le format des lignes du fichier texte est le suivant :

- **Pour un appel** :
	
	```txt
	<Taille de la ligne> + TAB + <Type> + TAB + <Identifiant de l'appel> + TAB + <Date> + TAB + 
	<Identifiant du thread> + TAB + <Identifiant de contexte> + TAB + <Login> + TAB + 
	<Ordinateur client> + TAB + <Application cliente> + TAB + <Version de l'application> + TAB + 
	<Numéro de fonction> + TAB + <Paramètres>
	```


- **Pour la fin d'un appel** :
	
	```txt
	<Taille de la ligne> + TAB + <Type> + TAB + <Identifiant de l'appel> + TAB + 
	<Date>  + TAB +  <Identifiant de contexte> + TAB + <Paramètres>
	```



Où :

- &lt;Taille de la ligne&gt; est un nombre hexadécimal sur 8 caractères définissant la taille de la ligne de logs en cours, les 8 caractères n'étant pas pris en compte dans la taille indiquée.

- &lt;Type&gt; peut prendre les valeurs :

	- 1 : Début de fonction

	- 2 : Fin de fonction

	- 3 : Erreur




- &lt;Date&gt; est au format  AAAAMMJJHHmmSSCCC

- &lt;Paramètres&gt; est de la forme :

	- &lt;Identifiant du paramètre 1&gt; + "=" + &lt;Valeur du paramètre 1&gt; + Caract(0) + Caract(255) +

	- &lt;Identifiant du paramètre 2&gt; + "=" + &lt;Valeur du paramètre 2&gt; + Caract(0) + Caract(255) + ... +

	- &lt;Identifiant du paramètre N&gt; + "=" + &lt;Valeur du paramètre N&gt; + Caract(0)







<a name="XComposante"></a>

## Composante :
wd280hf.dll
