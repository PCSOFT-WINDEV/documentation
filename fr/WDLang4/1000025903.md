
## HSuggèreClé (Fonction)

***En anglais : HSuggestKey***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie une liste de clés à ajouter aux fichiers de données afin d'améliorer les performances des requêtes. 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
sMaChaîne est une chaîne
sMaChaîne = HSuggèreClé(MaConnexion, ((MaRequête1, MaRequete2, MaRequete3))
Trace(sMaChaîne)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = HSuggèreClé(<Connexion> , <Requêtes> [, <Options>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Message correspondant au format demandé. 

**`<Connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion vers le serveur HFSQL contenant les requêtes à analyser. Cette connexion correspond :

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).




**`<Requêtes> : (Liste de valeurs entre parenthèses et séparées par des virgules)`**

Liste des requêtes à analyser (10 requêtes maximum). Cette liste de requêtes est de la forme : 

```txt
(<Requête 1>, ..., <Requête N>)
```
où : 

- &lt;Requête 1&gt; : Première requête à analyser.

- ...

- &lt;Requête N&gt; : Nième requête à analyser.




Remarque : Il est possible d'analyser les requêtes créées avec l'éditeur de requêtes, les requêtes en WLangage ou les requêtes SQL. Les différents types de requêtes peuvent être mélangés dans la liste. 

**`<Options> : (Constante de type Entier)`**

Permet de configurer le résultat renvoyé : 



|   |   |
| --- | --- |
| *hSCSimplifié* non précisé<br>(Valeur par défaut) | &lt;Résultat&gt; correspond à un message lisible, à l'attention du développeur, contenant la liste des clés à ajouter aux fichiers de données pour optimiser les requêtes. Ce texte est au format RTF. |
| *hSCSimplifié* précisé | &lt;Résultat&gt; correspond à la liste des clés manquantes, et si aucune clé n'est nécessaire, &lt;Résultat&gt; correspond à une chaîne vide. La liste des clés manquantes est de la forme : <br><br><pre><code><Fichier 1> + TAB + <Clé 1> + <EOT> + <Clé 2> + ...<br> + <Clé N> + RC + ... + RC + <Fichier N> + TAB + <Clé 1> + <br><EOT> + <Clé 2> + ... + <Clé N></code></pre><br> où : <br><br>- &lt;Fichier N&gt; correspond au fichier de données concerné par l'optimisation. <br><br>- &lt;Clé N&gt; correspond au nom de la clé à ajouter. <br><br><br> |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- La fonction prend au maximum 10 requêtes en paramètre. Pour prendre en compte plus de requêtes, il est conseillé d'utiliser les fonctions [HSuggèreCléDébut](../WDLang4/1000025905.md) et [HSuggèreCléFin](../WDLang4/1000025906.md).

- Pour analyser une requête paramétrée, il est nécessaire de fournir la valeur du paramètre avant d'exécuter la fonction **HSuggèreClé**. Par exemple : 
	
	```wl
	MareqSELECT_PRODUIT est une Requête SQL = 
	[	
	SELECT * FROM PRODUIT
	WHERE PRODUIT.Reference = {pReference}
	]
	MareqSELECT_PRODUIT.pReference = 123
	soit sListeclé = HSuggèreClé(MaConnexion, (MareqSELECT_PRODUIT))
	```

	Si aucune valeur n'est donnée pour le ou les paramètres de la requête, la condition de la requête ne sera pas prise en compte. Dans ce cas-là, aucune clé n'est suggérée.

- Les clés sont suggérées en fonction des données contenues dans le fichier de données. Si un fichier de données ne contient aucune donnée, aucune clé ne sera suggérée.






<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
