


## HSupprimeTout (Fonction)

***En anglais : HDeleteAll***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Supprime tous les enregistrements d'un fichier de données, d'une vue HFSQL ou d'une requête. Les enregistrements sont supprimés logiquement et physiquement. Ils ne pourront pas être restaurés.

Les opérations effectuées sont les suivantes :

- les enregistrements sont supprimés : les enregistrements ne sont plus référencés dans l'index. Les données ne sont pas conservées.

- les index (correspondant aux clés des enregistrement) sont supprimés du fichier d'index.

- les mémos associés aux enregistrements sont supprimés du fichier de mémo.

- les identifiants automatiques sont ré-initialisés.


Attention : l'intégrité n'est pas contrôlée.

WINDEV, WINDEV Mobile et WEBDEV proposent une gestion automatique des erreurs pour les 5 types d'erreur suivants : Erreur de doublons, Erreur d'intégrité, Erreur de mot de passe, Erreur de conflit de modification et d'état lors du conflit de modification, Erreur de blocage. Pour plus de détails, consultez [Gestion assistée des erreurs HFSQL](../WDLang4/3044188.md).

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette fonction est disponible uniquement pour les fichiers de données ou les requêtes liées à une connexion HFSQL (Classic ou Client/Serveur). 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Vide le fichier de données sans le recréer
HSupprimeTout(Client)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HSupprimeTout(<Fichier de données>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si les enregistrements ont été supprimés, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème (enregistrement bloqué, enregistrement en transaction, ...). La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur.




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données HFSQL, de la vue HFSQL ou de la requête manipulé.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Suppression des enregistrements d'une requête
<a name="suppression_des_enregistrements_une_requete_ELTPARAGRAPHE000106"></a>Si la requête a été créée en utilisant la constante *hModifieFichier*, la fonction **HSupprimeTout** supprime les enregistrements dans la source de la requête.
<a name="NOTE0_2"></a>


### Suppression des enregistrements d'une vue HFSQL
<a name="suppression_des_enregistrements_une_vue_hfsql_ELTPARAGRAPHE000118"></a>La fonction **HSupprimeTout** supprime les enregistrements de la vue mais pas les enregistrements du fichier de données utilisé pour la vue.
<a name="NOTE0_3"></a>


### Suppression des enregistrements dans une transaction
<a name="suppression_des_enregistrements_dans_une_transaction_ELTPARAGRAPHE000130"></a>La fonction **HSupprimeTout** ne supprime pas les enregistrements présents dans une transaction (annulée ou validée).
<a name="NOTE0_4"></a>


### Avantage par rapport à un parcours de suppression des enregistrements
<a name="avantage_par_rapport_parcours_suppression_des_enregistrements_ELTPARAGRAPHE000142"></a>Pour supprimer les enregistrements d'un fichier de données, il est également possible de réaliser une boucle de suppression des enregistrements (fonction [HSupprime](../WDLang4/3044018.md)). Par exemple :

```wl
POUR TOUT NumCli DE Commande
	HSupprime()
FIN
```
L'utilisation de la fonction **HSupprimeTout** présente les avantages suivants :

- le traitement est plus rapide,

- la taille du fichier de données vide est plus petite.



<a name="NOTE0_5"></a>


### Avantage par rapport à l'utilisation de la fonction [HCréation](../WDLang4/3044255.md)
<a name="avantage_par_rapport_utilisation_fonction_hcreationwdlang43044255md_ELTPARAGRAPHE000167"></a>Pour supprimer les enregistrements d'un fichier de données, il est également possible d'utiliser la fonction [HCréation](../WDLang4/3044255.md). 

L'utilisation de la fonction **HSupprimeTout** présente les avantages suivants :

- Suppression possible même si des utilisateurs sont connectés au fichier de données.

- Gestion automatique des erreurs HFSQL.  




<a name="XComposante"></a>

## Composante :
wd280hf.dll
