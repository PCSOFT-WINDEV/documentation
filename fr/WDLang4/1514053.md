
## Source de données (Type de variable)

***En anglais : Data Source***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Une variable de type **Source de données** permet de décrire une source de données temporaire (requête, vue, alias, ... ). 
Toutes les opérations possibles sur une vue (respectivement une requête) pourront être effectuées sur une variable de type **Source de données** associée à une vue (respectivement une requête).

**Pour décrire une source de données**, il est nécessaire de :

1. Déclarer une variable de type "Source de données".

2. Initialiser la source de données (fonctions [HExécuteRequêteSQL](../WDLang4/3044084.md) ou [HCréeVue](../WDLang4/3044159.md)).
	La source de données sera automatiquement libérée à la fin du traitement dans lequel cette source de données est déclarée. 
	**Remarque** : La source de données peut également être initialisée avec la fonction [HDéclareExterne](../WDLang4/3044204.md). Dans ce cas, la source de données permet de manipuler un fichier de données en utilisant la description de ce fichier, indépendamment de l'analyse. 




**Remarques** :

- A la fermeture de l'application (ou du traitement où la source de données a été déclarée), la source de données sera automatiquement détruite.

- Une source de données est toujours globale au contexte HFSQL dans lequel elle a été déclarée.

- Une source de données peut posséder un nom interne différent du nom de la variable, par exemple pour permettre son utilisation dans un tableau. Dans la fenêtre de description du projet (onglet "Compilation", il est possible de définir les options de ["Nommage des sources de données"](../Editeurs/9500218.md).
	







<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Déclaration d'une source de données
MaSourceDonnée est une Source de Données
MaSourceDonnée1, MaSourceDonnée2 sont des Sources de données
```


<a name="Exemple2"></a>



```wl
// Initialiser une variable de type Source de données
MaRequête est une Source de Données
// MaRequête est associée à une requête
// Initialisation de la variable MaRequête 
HExécuteRequêteSQL(MaRequête, "SELECT NOM FROM CLIENT")
```


<a name="Exemple3"></a>



```wl
// Initialiser une variable de type Source de données
MaVue est une Source de Données
// MaVue est associée à une vue
// Initialisation de la variable MaVue 
HCréeVue(MaVue, CLIENT, "*", "NOM,VILLE", "NOM]='A'", hVueDéfaut)
```


<a name="Exemple4"></a>





```wl
// Supprimer une source de données
MaRequête est une Source de Données
HExécuteRequêteSQL(MaRequête, "SELECT NOM FROM CLIENT")
// Destruction de la source de données associée à la variable MaRequête
HAnnuleDéclaration(MaRequête)
HExécuteRequêteSQL(MaRequête, "SELECT NOM FROM FOURNISSEUR")
```


<a name="Exemple5"></a>



```wl
// Suppression d'une source de données
MaVue est une Source de Données
// MaVue est associée à une vue
// Initialisation de la variable MaVue 
HCréeVue(MaVue, CLIENT, "*", "NOM,VILLE", "NOM]='A'", hVueDéfaut)
// Destruction de la source de données associée à la variable MaVue
HDétruitVue(MaVue)
HCréeVue(MaVue, CLIENT, "*", "NOM,PRENOM", "NOM]='C'", hVueDéfaut)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Déclarer une ou plusieurs sources de données

`<Nom de la variable> est une Source de Données
<Nom de la variable 1>, <Nom de la variable 2> sont des Sources de données
`
---

**`<Nom de la variable> : ()`**

Nom de la variable de type "Source de données" à déclarer.

**Remarque** : Les mots-clés <u><u><u><u>une</u></u></u></u> et <u><u><u><u>des</u></u></u></u> ne sont pas obligatoires : ce sont des mots d'agrément. 


<a name="SYNTAXE2"></a>

### Déclarer une source de données en l'associant à un fichier de données ou une requête

`<Nom de la variable> est une Source de Données <description=Nom Fichier ou Requête>`
---

**`<Nom de la variable> : ()`**

Nom de la variable de type "Source de données" à déclarer.

**`<Nom Fichier ou Requête> : ()`**

Nom du fichier de données ou de la requête dont la description doit être associée à la source de données. Si ce paramètre est précisé, la complétion proposera les différentes rubriques de la source de données associée. ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=SourceDeDonnees_Description.gif)





<a name="SYNTAXE3"></a>

### Initialiser une variable de type "Source de données" (requête ou vue)

``
---

**Pour initialiser une variable de type "Source de données"**, utilisez la fonction :


- [HExécuteRequêteSQL](../WDLang4/3044084.md) si la variable est associée à une requête.

- [HCréeVue](../WDLang4/3044159.md) si la variable est associée à une vue.

- [HDéclareExterne](../WDLang4/3044204.md) si la variable doit être associée à un fichier physique en important la description de ce fichier.





<a name="SYNTAXE4"></a>

### Supprimer la source de données (requête ou vue)

``
---

Lorsque la même variable de type Source de données est utilisée plusieurs fois, avec des sources de données différentes, il est nécessaire de libérer la première source de données.

**Pour libérer l'espace mémoire occupé par la source de données (requête ou vue)**, utilisez la fonction :


- [HAnnuleDéclaration](../WDLang4/3044174.md) si la variable est associée à une requête.

- [HDétruitVue](../WDLang4/3044091.md) si la variable est associée à une vue.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Manipuler une requête ou une vue par programmation
<a name="manipuler_une_requete_une_vue_par_programmation_ELTPARAGRAPHE000162"></a>Pour manipuler une requête ou une vue par programmation, il est conseillé d'utiliser une variable de type "Source de données".

Vous pouvez cependant donner un nom logique lors de l'initialisation de la requête ou de la vue. Il sera alors nécessaire d'utiliser le mot-clé [Externe](../Motscles/1511013.md) pour manipuler directement la vue ou la requête dans l'éditeur de code. Cette méthode peut ralentir la vitesse d'exécution de vos traitements.

**Remarque** : Lors de l'utilisation d'un nom logique, la requête ou la vue n'est pas détruite automatiquement : il est nécessaire d'utiliser les fonctions [HAnnuleDéclaration](../WDLang4/3044174.md) et [HDétruitVue](../WDLang4/3044091.md).

Par exemple :

- **Initialiser une requête :**

	1. Initialiser une requête avec un nom logique :
			
		```wl
		Externe MaRequête
		HExécuteRequêteSQL(MaRequête, "SELECT NOM FROM CLIENT")
		// Autre syntaxe possible :
		// HExécuteRequêteSQL("MaRequête", "SELECT NOM FROM CLIENT")
		 
		// Utilisation de la requête
		HLitPremier(MaRequête, Nom)
		SI PAS HEnDehors() ALORS
			Info("Le 1er client est : " + MaRequête.Nom)
		FIN
		...
		HAnnuleDéclaration(MaRequête)
		```


	2. Initialiser une requête avec une variable "Source de données" :
			
		```wl
		MaRequête est une Source de Données
		HExécuteRequêteSQL(MaRequête, "SELECT NOM FROM CLIENT")
		// Utilisation de la requête
		HLitPremier(MaRequête, Nom)
		SI PAS HEnDehors() ALORS
			Info("Le 1er client est : " + MaRequête.Nom)
		FIN
		```








- **Initialiser une vue :**

	1. Initialiser une vue avec un nom logique :
			
		```wl
		Externe MaVue
		HCréeVue(MaVue, CLIENT, "*", "NOM,VILLE", "NOM]='A'", hVueDéfaut)
		// Autre syntaxe possible :
		// HCréeVue("MaVue", CLIENT, "*", "NOM,VILLE", "NOM]='A'", hVueDéfaut)
		
		// Utilisation de la vue
		HLitPremier(MaVue, Nom)
		SI PAS HEnDehors() ALORS
			Info("Le 1er client est : " + MaVue.Nom)
		FIN
		...
		HDétruitVue(MaVue)
		```


	2. Initialiser une vue avec une variable "Source de données" :
			
		```wl
		MaVue est une Source de Données
		HCréeVue(MaVue, CLIENT, "*", "NOM,VILLE", "NOM]='A'", hVueDéfaut)
		// Utilisation de la vue
		HLitPremier(MaVue, Nom)
		SI PAS HEnDehors() ALORS
			Info("Le 1er client est : " + MaVue.Nom)
		FIN
		```









### Utiliser une source de données dans une requête SQL
<a name="utiliser_une_source_donnees_dans_une_requete_sql_ELTPARAGRAPHE000200"></a>Pour utiliser une source de données dans le code SQL d'une requête, le code SQL de la requête doit utiliser le nom logique attribué à la source de données.

Par exemple, le code suivant est utilisable quel que soit le mode de nommage de la source de données : 

```wl
TicketArchive est une Source de Données
HDéclareExterne("Ticket_Bak.FIC", TicketArchive)
     
REQ est une Source de Données 
sMaReq est une chaîne = [
	SELECT *
	FROM [%TicketArchive%]
	WHERE CODEPOSTAL='26110'
]

SI HExécuteRequêteSQL(REQ, hRequêteDéfaut, sMaReq) ALORS
	Info(HNbEnr(REQ) + " tickets correspondent.")
FIN
```




Exemple de code à utiliser dans le cas où la description du fichier externe est celle d'un des fichiers de l'analyse : 

```wl
TicketArchive est une Source de Données <description=Ticket>
HDéclareExterne("Ticket.FIC", TicketArchive)
REQ est une Requête SQL = [
		SELECT *
		FROM [%TicketArchive%]
	]
HExécuteRequête(REQ)
POUR TOUT REQ 
	Trace(REQ.IDTicket)
FIN
```

<a name="NOTE0_2"></a>




### Propriétés associées aux variables de type Source de données
<a name="proprietes_associees_aux_variables_type_source_donnees_ELTPARAGRAPHE000217"></a>Les propriétés associées aux variables de type Source de données sont les suivantes. Ces propriétés sont identiques à celles s'appliquant à un fichier de données :


|   |   |
| --- | --- |
| [Abréviation](../Proprietes/2512009.md) | Renvoie l'abréviation de la source de données. |
| [Alphabet](../Proprietes/2512008.md) | Permet de connaître l'alphabet utilisé par la source de données. |
| [BaseDeDonnées](../Proprietes/2512101.md) | Permet de connaître et de modifier la base de données associée à une connexion (HFSQL Client/Serveur, OLE DB, ...). |
| [BorneMax](../Proprietes/2510009.md) | Récupère la borne maximale du filtre en cours (défini par la fonction HFiltre) sur une source de données. |
| [BorneMin](../Proprietes/2510008.md) | Récupère la borne minimale du filtre en cours (défini par la fonction HFiltre) sur une source de données. |
| [CompressionMMO](../Proprietes/2512028.md) | Paramètre le mode de compression du fichier MMO (contenant les mémos binaire et texte) associé à la source de données. |
| [ConditionFiltre](../Proprietes/2512096.md) | Renvoie la condition de sélection mise en place par la fonction [HFiltre](../WDLang4/3044100.md) sur une source de données. |
| [Connexion](../Proprietes/2512019.md) | Permet de connaître la connexion actuellement associée à une source de données. |
| [CryptageFic](../Proprietes/2512046.md) | Paramètre le mode de cryptage de la source de données. |
| [CryptageMMO](../Proprietes/2512014.md) | Paramètre le mode de cryptage du fichier mémo (d'extension .MMO) associé à la source de données. |
| [CryptageNdx](../Proprietes/2512010.md) | Paramètre le mode de cryptage du fichier d'index associé à la source de données. |
| [CxAccès](../Proprietes/2512015.md) | Gère le type d'accès au fichier lors de la connexion OLE DB à une table spécifique (en tenant compte des modifications effectuées par la fonction [HConnecte](../WDLang4/3044263.md)). |
| [CxAccèsDécrit](../Proprietes/2512048.md) | Gère le type d'accès au fichier lors de la connexion OLE DB à une table spécifique (sans tenir compte des modifications effectuées par la fonction [HConnecte](../WDLang4/3044263.md)). |
| [CxBaseDeDonnées](../Proprietes/2512047.md) | Gère la source de données OLE DB lors de la connexion OLE DB à une table spécifique (en tenant compte des modifications effectuées par la fonction [HConnecte](../WDLang4/3044263.md)). |
| [CxBaseDeDonnéesDécrite](../Proprietes/2512016.md) | Gère la source de données OLE DB lors de la connexion OLE DB à une table spécifique (sans tenir compte des modifications effectuées par la fonction [HConnecte](../WDLang4/3044263.md)). |
| [CxInfosEtendues](../Proprietes/2512017.md) | Permet de connaître les informations supplémentaires insérées dans la chaîne de connexion à la base de données. |
| [CxInitialCatalog](../Proprietes/2512018.md) | Permet de connaître la base de données par défaut définie pour l'accès. |
| [CxLibelléDécrit](../Proprietes/2512021.md) | Paramètre le libellé de la connexion à la source de données OLE DB. |
| [CxOptionsCurseur](../Proprietes/2512042.md) | Permet de connaître le type curseur utilisé lors d'une connexion à une base de données externe. |
| [CxProviderOLEDB](../Proprietes/2512033.md) | Gère le nom du provider OLE DB utilisé (en tenant compte des modifications effectuées par la fonction [HConnecte](../WDLang4/3044263.md)). |
| [CxProviderOLEDBDécrit](../Proprietes/2512025.md) | Gère le nom du provider OLE DB (sans tenir compte des modifications effectuées par la fonction [HConnecte](../WDLang4/3044263.md)). |
| [CxUtilisateur](../Proprietes/2512026.md) | Gère le nom de l'utilisateur lors d'une connexion OLE DB (en tenant compte des modifications effectuées par la fonction [HConnecte](../WDLang4/3044263.md)). |
| [CxUtilisateurDécrit](../Proprietes/2512022.md) | Gère le nom de l'utilisateur lors d'une connexion OLE DB (sans tenir compte des modifications effectuées par la fonction [HConnecte](../WDLang4/3044263.md)). |
| [ExécutionTerminée](../Proprietes/2512117.md) | Permet de savoir si une requête ou une vue HFSQL Classic ou Client/Serveur a fini de s'exécuter. |
| [Extension](../Proprietes/2512030.md) | Permet de connaître ou de modifier l'extension d'un fichier de données. |
| [FichierJournal](../Proprietes/2512032.md) | Permet de savoir si un fichier de données est un fichier journal. |
| [FichierTransaction](../Proprietes/2512036.md) | Permet de savoir si un fichier de données est un fichier de transaction. |
| [FiltreAvecBornes](../Proprietes/2512097.md) | Permet de savoir si des bornes ont été précisées sur le filtre mis en place par la fonction [HFiltre](../WDLang4/3044100.md) sur une source de données. |
| [Format](../Proprietes/2512045.md) | Paramètre le format des données du fichier de données (ANSI ou Unicode). |
| [GrosFichier](../Proprietes/2512037.md) | Paramètre la taille maximale de la source de données. |
| [GUIDAnalyse](../Proprietes/2512098.md) | Renvoie le GUID de l'analyse qui a permis de créer le fichier de données. |
| [GUIDFichier](../Proprietes/2512099.md) | Renvoie le GUID du fichier défini dans l'analyse qui a permis de créer le fichier de données. |
| [IDAutoMax](../Proprietes/2512023.md) | Permet de connaître l'identifiant automatique maximum sur un fichier répliqué. |
| [IDAutoMin](../Proprietes/2512039.md) | Permet de connaître l'identifiant automatique minimum sur un fichier répliqué. |
| [InfosEtendues](../Proprietes/2512041.md) | Renvoie et modifie les informations supplémentaires d'un fichier de données ou d'une rubrique accédé via un Connecteur Natif. |
| [Journalisation](../Proprietes/2512044.md) | Renvoie le mode de journalisation d'un fichier de données. |
| [NbRubrique](../Proprietes/2512055.md) | Renvoie le nombre total de rubriques (y compris les clés composées) présentes dans un enregistrement d'un fichier décrit sous l'éditeur d'analyses, un fichier décrit par programmation, une vue HFSQL ou une requête. |
| [NbRubriqueClé](../Proprietes/2512056.md) | Renvoie le nombre total de rubriques clé (y compris les clés composées) présentes dans un enregistrement d'un fichier décrit sous l'éditeur d'analyses, un fichier décrit par programmation, une vue HFSQL ou une requête. |
| [NbRubriqueMémo](../Proprietes/2512057.md) | Renvoie le nombre total de rubriques mémo présentes dans un enregistrement d'un fichier décrit sous l'éditeur d'analyses, un fichier décrit par programmation, une vue HFSQL ou une requête. |
| [Nom](../Proprietes/2510082.md) | Gère le nom des différents objets HFSQL. |
| [Nom55](../Proprietes/2512054.md) | Gère le nom logique d'un fichier au format Hyper File 5.5 présent dans une analyse au format HFSQL Classic. |
| [NomDécrit](../Proprietes/2512066.md) | Gère le nom logique d'un fichier de données. |
| [NomPhysique](../Proprietes/2512059.md) | Gère le nom physique des fichiers de données. |
| [NomPhysiqueDécrit](../Proprietes/2512063.md) | Gère le nom physique des fichiers HFSQL (sans tenir compte des changements de noms réalisés grâce à la fonction [HChangeNom](../WDLang4/3044141.md)). |
| [NullSupporté](../Proprietes/2512061.md) | Permet de gérer la valeur NULL dans un fichier HFSQL. |
| [NuméroGénération](../Proprietes/2512068.md) | Permet de connaître le numéro de génération du fichier physique associé au fichier logique spécifié. |
| [ProtégéParMotDePasse](../Proprietes/2512071.md) | Permet de savoir si un fichier est protégé ou non par mot de passe. |
| [Répertoire](../Proprietes/2512078.md) | Gère le répertoire physique des fichiers HFSQL. Cette propriété tient compte des changements de répertoires réalisés grâce aux fonctions [HChangeRep](../WDLang4/3044168.md) ou [HSubstRep](../WDLang4/3044028.md). |
| [RépertoireDécrit](../Proprietes/2512074.md) | Gère le répertoire physique des fichiers HFSQL. Cette propriété ne tient pas compte des changements de répertoires réalisés grâce aux fonctions [HChangeRep](../WDLang4/3044168.md) ou [HSubstRep](../WDLang4/3044028.md). |
| [RépertoireJournal](../Proprietes/2512075.md) | Gère le répertoire du fichier journal décrit dans l'analyse. |
| [RépertoireJournalOpération](../Proprietes/2512076.md) | Permet de gérer le répertoire du fichier des opérations du journal associé à un fichier Journalé. |
| [RépertoireRéplication](../Proprietes/2512084.md) | Permet de gérer le répertoire du réplica (fichier ".RPL" ou ".RPM"). |
| [RépertoireSauvegardeJournal](../Proprietes/2512116.md) | Permet de connaître et de modifier le répertoire de sauvegarde des fichiers Journal. |
| [Réplication](../Proprietes/2512073.md) | Permet de connaître le mode de réplication utilisé pour un fichier de données (fichier défini sous l'éditeur d'analyses ou défini par programmation). Pour les fichiers définis par programmation, il est possible d'indiquer si ce fichier est en mode réplication journalée ou non. |
| [RubriqueFiltrée](../Proprietes/2512086.md) | Permet de connaître la rubrique sur laquelle un filtre a été mis en place par la fonction [HFiltre](../WDLang4/3044100.md) sur un fichier de données, une vue HFSQL ou une requête. |
| [RubriqueTexteComplétée](../Proprietes/2512080.md) | Paramètre la gestion des rubriques texte dans un fichier HFSQL. Les rubriques texte peuvent être complétées automatiquement par des espaces (fonctionnement identique à celui de WINDEV 5.5) ou non. |
| [Sécurisé](../Proprietes/2512082.md) | Paramètre le niveau de sécurité du cryptage des fichiers. |
| [TailleEnregistrement](../Proprietes/2512090.md) | Renvoie la taille d'un enregistrement (en octets), sans tenir compte des clés composées. |
| [Type](../Proprietes/2510131.md) | Identifie et modifie le type d'une rubrique. |
| [WDD55](../Proprietes/2512094.md) | Chemin du fichier WDD au format 5.5 utilisé pour manipuler des fichiers au format 5.5 dans une application WINDEV, WEBDEV ou WINDEV Mobile. |








