


## HNotifConfigure (Fonction)

***En anglais : HNotifConfigure***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Spécifie et configure le serveur utilisé pour l'envoi des notifications par le serveur HFSQL. Cet envoi peut être réalisé : 

- Par email : le serveur à configurer est alors un serveur SMTP.

- Via les Centres de Contrôle (outil de messagerie WDBal). Les Centres de Contrôle peuvent utiliser aussi bien une base de données HFSQL Classic que HFSQL Client/Serveur. 





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
cnxConnexionCS est une Connexion
cnxConnexionCS.Provider = hAccèsHFClientServeur
cnxConnexionCS.Utilisateur = "admin"
cnxConnexionCS.MotDePasse = ""
cnxConnexionCS.Serveur = "test:4900"
HOuvreConnexion(cnxConnexionCS)

HNotifConfigure(cnxConnexionCS, hNotifCCCS, "DOC:4988", "CC_DOC", "DOC", "")
```
<a name="Exemple2"></a>

```wl
cnxConnexionCS est une Connexion
cnxConnexionCS.Provider = hAccèsHFClientServeur
cnxConnexionCS.Utilisateur = "admin"
cnxConnexionCS.MotDePasse = ""
cnxConnexionCS.Serveur = "test:4900"
HOuvreConnexion(cnxConnexionCS)

HNotifConfigure(cnxConnexionCS, hNotifEmail, "FLEUR:25", "test.doc", "doc", "doc@pcsoft.com", Faux)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Configurer l'envoi de mails via un serveur SMTP

`<Résultat> = HNotifConfigure(<Connexion> , <Type de notifications> , <Serveur SMTP> , <Login> [, <Mot de passe>] , <Expéditeur> , <Session sécurisée>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la configuration a été effectuée. 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur.




**`<Connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion à manipuler. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).




**`<Type de notifications> : (Constante de type Entier)`**

Type d'envoi des notifications : 


|   |   |
| --- | --- |
| *hNotifEmail* | Envoi des notifications par email. |



**`<Serveur SMTP> : (Chaîne de caractères)`**

Nom DNS ou adresse IP du serveur d'emails (protocole sortant). Cette adresse IP est fournie par le fournisseur de services ou par l'administrateur réseau.
Attention : Il est nécessaire d'utiliser le serveur SMTP du fournisseur de la connexion Internet.

**`<Login> : (Chaîne de caractères)`**

Login permettant de se connecter au serveur SMTP. 

**`<Mot de passe> : (Chaîne de caractères optionnelle)`**

Mot de passe associé au login de connexion sur le serveur SMTP. Ce mot de passe est donné par le fournisseur de services ou par l'administrateur réseau. 

Si ce paramètre n'est pas précisé, l'ancienne valeur fournie est automatiquement utilisée. 

**`<Expéditeur> : (Chaîne de caractères)`**

Adresse email utilisée comme expéditeur dans les emails de notification. 

**`<Session sécurisée> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> pour ouvrir une session sécurisée par le protocole TLS. 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. 





<a name="SYNTAXE2"></a>

### Configurer l'envoi de messages dans WDBal (Centres de Contrôle en Client/Serveur)

`<Résultat> = HNotifConfigure(<Connexion> , <Type de notifications> , <Serveur Centre de Contrôle> , <Base de données Centre de Contrôle> , <Login> [, <Mot de passe>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la configuration a été effectuée. 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur.




**`<Connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion à manipuler. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).




**`<Type de notifications> : (Constante de type Entier)`**

Type d'envoi des notifications : 


|   |   |
| --- | --- |
| *hNotifCCCS* | Envoi des notifications par les Centres de Contrôle en mode Client/Serveur. |



**`<Serveur Centre de Contrôle> : (Chaîne de caractères)`**

Nom DNS ou adresse IP du serveur HFSQL hébergeant les Centres de Contrôle. 

**`<Base de données Centre de Contrôle> : (Chaîne de caractères)`**

Nom de la base de données utilisée pour les Centres de Contrôle. 

**`<Login> : (Chaîne de caractères)`**

Login permettant de se connecter au serveur HFSQL et à la base des Centres de Contrôle. 

**`<Mot de passe> : (Chaîne de caractères)`**

Mot de passe associé au login de connexion. 
Si ce paramètre n'est pas précisé, l'ancienne valeur fournie est automatiquement utilisée.


<a name="SYNTAXE3"></a>

### Configurer l'envoi de messages dans WDBal (Centres de Contrôle en HFSQL Classic)

`<Résultat> = HNotifConfigure(<Connexion> , <Type de notifications> , <Chemin Centre de Contrôle> , <Login> [, <Mot de passe>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la configuration a été effectuée. 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur.




**`<Connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion à manipuler. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).




**`<Type de notifications> : (Constante de type Entier)`**

Type d'envoi des notifications : 


|   |   |
| --- | --- |
| *hNotifCCClassic* | Envoi des notifications par les Centres de Contrôle en mode HFSQL Classic. |



**`<Chemin Centre de Contrôle> : (Chaîne de caractères)`**

Chemin d'accès aux fichiers de données HFSQL Classic des Centres de Contrôle. 

**`<Login> : (Chaîne de caractères)`**

Login permettant de se connecter à la base des Centres de Contrôle. 

**`<Mot de passe> : (Chaîne de caractères)`**

Mot de passe associé au login de connexion. 
Si ce paramètre n'est pas précisé, l'ancienne valeur fournie est automatiquement utilisée.


<a name="SYNTAXE4"></a>

### Récupérer les paramètres de la configuration actuelle

`<Résultat> = HNotifConfigure(<Connexion> , <Type de notifications>)`
---

**`<Résultat> : (Chaîne de caractères)`**

Liste des paramètres correspondant à la configuration recherchée (attention les mots de passe ne sont pas fournis). 

Le résultat est de la forme : 


|   |   |
| --- | --- |
| avec la constante *hNotifCCClassic* : | &lt;Chemin Centre de Contrôle&gt; + RC + &lt;Login&gt; |
| avec la constante *hNotifCCCS* : | &lt;Serveur Centre de Contrôle&gt; + RC + &lt;Base de données Centre de Contrôle&gt; + RC + &lt;Login&gt; |
| avec la constante *hNotifEmail* : | &lt;Serveur SMTP&gt; + RC + &lt;Login&gt; + RC + &lt;Expéditeur&gt; + RC + &lt;Session sécurisée&gt; |



**`<Connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion à manipuler. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md). 




**`<Type de notifications> : (Constante de type Entier)`**

Type d'envoi des notifications pour lequel la configuration est recherchée : 


|   |   |
| --- | --- |
| *hNotifCCClassic* | Envoi des notifications par les Centres de Contrôle en mode HFSQL Classic. |
| *hNotifCCCS* | Envoi des notifications par les Centres de Contrôle en mode HFSQL Client/Serveur. |
| *hNotifEmail* | Envoi des notifications par email. |





<a name="XComposante"></a>

## Composante :
wd280hf.dll
