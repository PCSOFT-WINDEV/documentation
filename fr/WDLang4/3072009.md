
## SQLDernier (Fonction)

***En anglais : SQLLast***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Positionne sur la dernière ligne du résultat de la requête. Cette ligne devient la ligne en cours.

Si des champs ou des variables sont associés aux colonnes du résultat de la requête (fonction [SQLAssocie](../WDLang4/3072004.md)), ces éléments sont automatiquement affectés avec les valeurs de la ligne en cours.

En règle générale, la fonction **SQLDernier** est utilisée pour une boucle de lecture avec la fonction [SQLPrécédent](../WDLang4/3072022.md).

**Attention** : Cette fonction doit être utilisée lors d'un parcours du résultat de la requête de type SQLPremier/SQLCol. Pour plus de détails sur les différents types de parcours du résultat d'une requête SQL, consultez [Types de parcours SQL](../WDLang4/3072025.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
ResExec est un entier
// Exécution d'une requête
ResExec = SQLExec("SELECT NOMCLI FROM FACT", "REQ1")
SI ResExec = Vrai ALORS
	// Transfert du nom dans LISTE_LISTENOM
	SQLDernier("REQ1")
	TANTQUE PAS SQL.EnDehors
		// Ajout du résultat dans une liste
		ListeAjoute(LISTE_LISTENOM, SQLCol("REQ1", 1))
		SQLPrécédent("REQ1")
	FIN
SINON
	// Traite erreur
FIN
SQLFerme("REQ1")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`SQLDernier(<Nom de la requête>)`
---

**`<Nom de la requête> : (Chaîne de caractères)`**

Nom de la requête : 

- créée et exécutée avec la fonction [SQLExec](../WDLang4/3072007.md), 

- exécutée avec la fonction [SQLExecWDR](../WDLang4/3072010.md).




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les requêtes créées avec l'éditeur de requête doivent être spécifiées sous forme d'une chaîne de caractères avec guillemets.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Si le pointeur est en dehors du fichier de la requête, la variable SQL.EnDehors est à <u><u><u><u>Vrai</u></u></u></u>.

- La variable SQL.EnCours contient le numéro de la ligne en cours.






<a name="XComposante"></a>

## Composante :
wd280hf.dll
