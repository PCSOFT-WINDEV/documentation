


## HModifieDroitFichier (Fonction)

***En anglais : HModifyFileRights***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie les droits accordés sur un fichier de données HFSQL Client/Serveur pour un utilisateur ou un groupe.

**Remarque** : Il est possible de connaître les droits d'un groupe ou d'un utilisateur sur un fichier de données HFSQL Client/Serveur grâce à la fonction [HInfoDroitFichier](../WDLang4/3044321.md). 


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Copie des droits d'un utilisateur à un autre 
sDroits est une chaîne
sDroits = HInfoDroitFichier("MaConnexion", "Dupont", ...
		hDroitLecture + hDroitAjout, "MaBase", "MonFichier.fic")
HModifieDroitFichier("MaConnexion", "Durand", hDroitLecture + hDroitAjout, ...
		sDroits, "MaBase", "MonFichier.fic")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HModifieDroitFichier(<Connexion> , <Utilisateur/Groupe> , <Droits à modifier> , <Nouvelles valeurs> , <Base de données> , <Fichier de données>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si les droits ont été modifiés, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur. 


Si le droit spécifié a déjà la nouvelle valeur, aucune modification n'est effectuée.

**Remarque** : Une erreur "Utilisateur inconnu" ou "Groupe inconnu" sera renvoyée par la fonction [HErreurInfo](../WDLang4/3044071.md) si l'utilisateur en cours n'a pas le droit de visualisation des utilisateurs (constante *hDroitVisualisationUtilisateur*) et s'il demande des informations concernant un autre utilisateur ou groupe.

**`<Connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion pour laquelle les droits d'un utilisateur ou d'un groupe d'utilisateurs doivent être modifiés. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md). 




**`<Utilisateur/Groupe> : (Chaîne de caractères)`**

Nom de l'utilisateur ou du groupe dont on veut modifier les droits.

**`<Droits à modifier> : (Constante ou combinaison de constantes de type Entier)`**

Liste des droits à modifier :


|   |   |
| --- | --- |
| *hDroitAjout* | Droit d'ajouter de nouveaux enregistrements dans un fichier de données. |
| *hDroitBlocage* | Droit de bloquer les fichiers de données ou les enregistrements d'un fichier de données. |
| *hDroitChangeDroit* | Droits de changer les droits. |
| *hDroitChangeLiaison* | Droit de modifier les règles d'intégrité sur un fichier de données. |
| *hDroitChangePropriétaire* | Droit de modifier le propriétaire d'un élément. |
| *hDroitGèreDoublon* | Droit de brancher et de débrancher la gestion des doublons. |
| *hDroitLecture* | Droit de lire les enregistrements d'un fichier de données. |
| *hDroitMaintenance* | Droit de lancer une ré-indexation ou un calcul de statistiques sur un fichier de données. |
| *hDroitModifAuto* | Droit de lancer une modification automatique des fichiers de données sur un fichier de données. |
| *hDroitModification* | Droit de modifier les enregistrements d'un fichier de données. |
| *hDroitSuppression* | Droit de supprimer les enregistrements d'un fichier de données. |
| *hDroitSuppressionFichier* | Droit de supprimer un fichier de données (fonction [HSupprimeFichier](../WDLang4/3044294.md)). |



**`<Nouvelles valeurs> : (Constantes de type entier)`**

Liste des nouvelles valeurs des droits modifiés. Pour chaque droit précisé dans le paramètre &lt;Droits à modifier&gt;, il est nécessaire de préciser la nouvelle valeur du droit (en respectant le même ordre).

Si une seule valeur est précisée dans ce paramètre, elle sera utilisée pour tous les droits indiqués dans le paramètre &lt;Droits à modifier&gt;.

Les valeurs possibles sont les suivantes :


|   |   |
| --- | --- |
| *hAutorisé* | L'utilisateur ou le groupe a le droit considéré. |
| *hHérité* | L'utilisateur héritera de la valeur du droit donnée au groupe d'utilisateurs auquel il appartient. |
| *hInterdit* | L'utilisateur ou le groupe n'a pas le droit considéré. |



**`<Base de données> : (Chaîne de caractères)`**

Nom de la base de données contenant le fichier de données pour lequel les droits doivent être modifiés. 

- Si la base de données correspond à la base de données définie dans la connexion, ce paramètre peut correspondre à une chaîne vide (""). 

- Si aucune base de données n'est définie dans la connexion et si ce paramètre correspond à une chaîne vide, une erreur WLangage est affichée.




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données pour lequel les droits doivent être modifiés.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Quand est-ce que la modification du droit est réalisée ? 
<a name="quand_estce_que_modification_droit_est_realisee_ELTPARAGRAPHE000217"></a>La modification du droit est effective dès que la fonction **HModifieDroitFichier** est exécutée pour les utilisateurs connectés et concernés par la modification. Il n'est pas nécessaire de redémarrer le serveur pour prendre en compte les nouveaux droits.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
