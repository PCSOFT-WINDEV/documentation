
## Enregistrement (Type de variable)

***En anglais : Record***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **Enregistrement** permet de manipuler (modifier, sauvegarder, ...) les valeurs d'un enregistrement. Cet enregistrement peut être un enregistrement d'un fichier de données, d'une requête ou d'une vue. La variable associée au type **Enregistrement** sera structurée comme un enregistrement de la base de données. 

Exemples d'utilisation : Il est ainsi possible de mémoriser dans différentes variables le contenu de différents enregistrements pour les comparer ou comparer certaines rubriques. 


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// CLIENT est un fichier de données décrit dans l'analyse
EnregClient est un Enregistrement de CLIENT

HLitPremier(CLIENT, NUMCLI)
SI PAS HEndehors() ALORS
	EnregClient = CLIENT
	// Affichage du nom et prénom du client 
	Info(EnregClient.NOM, EnregClient.PRENOM)
FIN
```


<a name="Exemple2"></a>

```wl
// CLIENT est un fichier de données décrit dans l'analyse
EnregClient est un Enregistrement de CLIENT

EnregClient.Nom = "DUPONT"
EnregClient.Prénom = "Paul"
EnregClient.Ville = "MONTPELLIER"

// Affecte le contenu de la variable EnregClient dans le buffer du fichier de données Client
CLIENT = EnregClient  

HAjoute(CLIENT)

// Il est également possible de faire : HAjoute(CLIENT, EnregClient)
```

<a name="NOTE0"></a>

## Remarques
<a name="NOTE0_1"></a>


### Déclaration d'une variable de type Enregistrement
<a name="declaration_une_variable_type_enregistrement_ELTPARAGRAPHE000042"></a>La syntaxe de déclaration d'une variable de type **Enregistrement** est la suivante : 


```txt
<Nom de la variable> est un Enregistrement [de <Nom du fichier de données dans l'analyse>]
```


- Si le paramètre &lt;Nom du fichier de données dans l'analyse&gt; est indiqué, l'enregistrement est associé à une description d'un des fichiers de données présents dans l'analyse. Dans ce cas, il est possible de manipuler les différentes rubriques de l'enregistrement. 

- Si le paramètre &lt;Nom du fichier de données dans l'analyse&gt; n'est pas indiqué, la structure de l'enregistrement sera construite dynamiquement en fonction du buffer du fichier qui lui sera alloué. 



<a name="NOTE0_2"></a>


### Accès aux rubriques
<a name="acces_aux_rubriques_ELTPARAGRAPHE000054"></a>Pour accéder aux rubriques d'une variable de type **Enregistrement**, la syntaxe est la suivante : 

- Pour affecter une rubrique de la variable : 
	
	```txt
	<Nom Variable>.<Nom rubrique> = <Valeur à affecter>
	```


- Pour récupérer la valeur des rubriques : 
	
	```txt
	<Valeur> = <Nom Variable>.<Nom rubrique>
	```





**Remarque** : Lors de l'utilisation d'une variable de type **Enregistrement** associée à un fichier de données de l'analyse, l'éditeur de code propose automatiquement les différentes rubriques de l'enregistrement : 
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Enregistrement_Completion.gif)



<a name="NOTE0_3"></a>


### Lecture et affectation d'une variable de type Enregistrement
<a name="lecture_affectation_une_variable_type_enregistrement_ELTPARAGRAPHE000073"></a>Une variable de type **Enregistrement** peut être lue ou affectée. La syntaxe est la suivante : 

- Pour mémoriser le buffer d'un fichier de données dans une variable de type **Enregistrement** : 
	
	```txt
	<Nom de la variable Enregistrement> = <Nom du fichier de données>
	```


- Pour affecter le buffer d'un fichier de données depuis une variable de type **Enregistrement** : 
	
	```txt
	<Nom du fichier de données> = <Nom de la variable Enregistrement>
	```





Remarque : L'affectation d'une variable de type **Enregistrement** à un fichier de données modifie la propriété [NouvelEnregistrement](../Proprietes/1000017090.md). 
<a name="NOTE0_4"></a>


### Cas particuliers
<a name="cas_particuliers_ELTPARAGRAPHE000092"></a>

- La fonction [HEnregistrementVersChaîne](../WDLang4/1000025983.md) utilisée sur une variable de type **Enregistrement** retourne une chaîne de caractères contenant la valeur de chaque rubrique séparée par un caractère TAB.

- Si une variable de type **Enregistrement** typée sur un fichier de données est affectée avec le buffer d'un autre fichier de données, il n'y a pas d'erreur de compilation. Une copie homonymique des buffers est effectuée : seules les rubriques de même nom de chaque buffer seront affectées. Les autres rubriques ne seront pas affectées.

- Seule la sérialisation de type JSON est disponible pour ce type de variable (fonction [Sérialise](../WDLang1/3013065.md)). Aucune désérialisation n'est disponible.  



<a name="NOTE0_5"></a>


### Fonctions manipulant le type Enregistrement
<a name="fonctions_manipulant_type_enregistrement_ELTPARAGRAPHE000107"></a>Les fonctions suivantes utilisent le type **Enregistrement** : 



|   |   |
| --- | --- |
| [HAjoute](../WDLang4/3044147.md) | Ajoute : <br><br>- l'enregistrement présent en mémoire dans le fichier de données (la requête ou la vue). <br><br>- l'enregistrement présent dans une variable de type [Enregistrement](../WDLang4/1000020962.md) dans le fichier de données (la requête ou la vue).<br><br><br> |
| [HAttacheMémo](../WDLang4/3044173.md) | Permet d'associer un fichier à une rubrique de type mémo binaire ou d'annuler l'attachement existant entre un fichier et une rubrique binaire. |
| [HCopieEnreg](../WDLang4/3044261.md) | Copie : <br><br>- le contenu de l'enregistrement en cours (chargé en mémoire) dans l'enregistrement en cours d'un fichier de données.<br><br>- le contenu d'une variable de type [Enregistrement](../WDLang4/1000020962.md) dans l'enregistrement en cours d'un fichier de données.<br><br><br> |
| [HEnregistrementVersChaîne](../WDLang4/1000025983.md) | Convertit sous forme de chaîne le contenu de l'enregistrement en cours (dans un fichier de données, une vue HFSQL, une requête, ...). |
| [HExtraitMémo](../WDLang4/3044072.md) | Extrait le contenu d'une rubrique de type mémo binaire d'un fichier HFSQL, d'une requête ou d'une vue HFSQL dans un fichier physique (sur le disque). |
| [HInfoMémo](../WDLang4/3044008.md) | Renvoie les caractéristiques des mémo binaire et texte. |
| [HListeRubrique](../WDLang4/3044230.md) | Renvoie la liste des rubriques :<br><br>- présentes dans un fichier de données (d'une requête ou d'une vue) reconnu par le moteur HFSQL. Les fichiers de données définis par les fonctions [HDéclare](../WDLang4/3044203.md), [HDéclareExterne](../WDLang4/3044204.md) et [HDécritFichier](../WDLang4/3044206.md) sont pris en compte.<br><br>- présentes dans une variable de type Enregistrement. <br><br><br> |
| [HRAZ](../WDLang4/3044118.md) | Initialise : <br><br>- une ou toutes les variables des rubriques d'un fichier de données avec leurs valeurs par défaut. <br><br>- une ou toutes les rubriques d'une variable de type [Enregistrement](../WDLang4/1000020962.md) avec leurs valeurs par défaut. <br><br><br> |





Remarque : Pour réinitialiser le contenu d'une variable de type **Enregistrement**, il est également possible d'utiliser la fonction [VariableRAZ](../WDLang1/3013069.md).






<a name="NOTE0_6"></a>


### Propriétés spécifiques à la description des variables de type Enregistrement
<a name="proprietes_specifiques_description_des_variables_type_enregistrement_ELTPARAGRAPHE000122"></a>Les propriétés suivantes peuvent être utilisées pour connaître les caractéristiques d'une variable de type **Enregistrement** :

| **Nom de la propriété** | **Type manipulé** | **Effet** |
| --- | --- | --- |
| Contenu | Chaîne de caractères | Contenu de l'enregistrement en cours (identique au résultat renvoyé par la fonction [HEnregistrementVersChaîne](../WDLang4/1000025983.md)). <br><br>**Cette propriété est disponible en lecture seulement**. |
| FichierAssocié | Chaîne de caractères | Nom du fichier de données HFSQL sur lequel la variable est basée. <br><br>**Cette propriété est disponible en lecture seulement**. |




