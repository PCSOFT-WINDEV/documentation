


## PageVersSource (Fonction)

***En anglais : PageToSource***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Initialise automatiquement :

- la valeur mémoire des rubriques d'un fichier de données avec la valeur des champs de la page. Les rubriques du fichier de données de base reliées aux champs de la page sont automatiquement affectées avec les valeurs des champs correspondants.

- la valeur des variables WLangage avec la valeur des champs de la page. Les variables WLangage reliées aux champs de la page sont automatiquement affectées avec les valeurs des champs correspondants.




Cette opération est effectuée quel que soit l'état des champs (grisés, inactifs, ou invisibles).

Remarques : 

- La fonction **PageVersSource** ne permet pas d'écrire dans le fichier de données : seules les variables des rubriques de fichier de données sont affectées (c'est-à-dire les variables de l'enregistrement chargé en mémoire). Pour modifier les enregistrements, il faut utiliser les fonctions [HAjoute](../WDLang4/3044147.md), [HModifie](../WDLang4/3044042.md), [HEcrit](../WDLang4/3044092.md), ... 



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Clic sur BTN_AJOUTER
PageVersSource()
HAjoute("Client")
SI HErreurDoublon() = Vrai ALORS
	Erreur("Ce numéro existe déjà")
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`PageVersSource([<Page> [, <Source>]])`
---

**`<Page> : (Nom de page)`**

Nom de la page où les champs sont présents.
Si ce paramètre n'est pas spécifié ou correspond à une chaîne vide (""), la page à laquelle appartient le code en cours est utilisée.


**`<Source> : (Chaîne de caractères optionnelle)`**

Nom de la source à laquelle appartiennent les données à mettre à jour. Cette source peut être :

- Le nom d'un fichier de données : seuls les champs ayant un lien avec ce fichier de données sont pris en compte.

- Le nom d'une variable WLangage : seuls les champs ayant un lien avec cette variable WLangage sont pris en compte.
	Remarques : 

	- Si le nom de la variable est indiqué entre guillemets, la liaison sera effectuée avec la variable spécifiée. 

	- Si le nom de la variable n'est pas indiqué entre guillemets, la liaison sera effectuée avec le contenu de la variable (cas par exemple d'une variable contenant le nom d'une autre variable).





Si ce nom n'est pas spécifié, tous les champs de la fenêtre/page ayant un lien avec un fichier de données décrit sous l'éditeur d'analyses ou une variable WLangage sont pris en compte.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Lien d'un champ avec une variable WLangage ou avec une rubrique d'un fichier de données
<a name="lien_champ_avec_une_variable_wlangage_avec_une_rubrique_fichier_donnees_ELTPARAGRAPHE000093"></a>La liaison d'un champ avec une variable WLangage ou avec une rubrique d'un fichier de données peut être connue :

- Sous l'éditeur, dans la fenêtre de description du champ (onglet "Liaison")

- Par programmation, grâce à la propriété [Liaisonfichier](../Proprietes/2510060.md).



<a name="NOTE0_2"></a>


### Mise à jour des rubriques : Cas particuliers
<a name="mise_jour_des_rubriques_cas_particuliers_ELTPARAGRAPHE000108"></a>

- Pour affecter automatiquement la valeur NULL à une rubrique avec la fonction **PageVersSource** :

	1. Cochez l'option "NULL supporté" pour la rubrique dans l'éditeur d'analyses.

	2. Cochez l'option "NULL si vide" dans le champ de saisie associé à la rubrique.




- Les rubriques du fichier de données non reliées à un champ ne sont pas mises à jour par la fonction **PageVersSource**.

- Si plusieurs champs de la page sont reliés à une même rubrique du fichier de données, la rubrique reliée peut ne pas être mise à jour correctement par la fonction **PageVersSource**. ***Il est déconseillé de relier plusieurs champs d'une page à une même rubrique d'un fichier de données***.

- La fonction **PageVersSource** n'affecte pas les rubriques pour les champs de type image. Utilisez la fonction [HAttacheMémo](../WDLang4/3044173.md).

- La fonction **PageVersSource** ne fonctionne pas avec les vues.

- **Liaison avec des rubriques de type "Mot de passe sécurisé"** : La valeur de la rubrique "Mot de passe sécurisé" n'est pas modifiée tant que l'utilisateur n'a pas modifié la valeur dans le champ lié à la rubrique.



<a name="NOTE0_3"></a>


### Mise à jour données contenues dans les champs Table (ou dans les champs Zone répétée)
<a name="mise_jour_donnees_contenues_dans_les_champs_table_dans_les_champs_zone_repetee_ELTPARAGRAPHE000145"></a>La fonction **PageVersSource** est sans effet sur le contenu d'un champ Table. 

Le transfert effectif des données d'un champ Table vers sa source de données (fichier de données ou variable) se fait lors de l'enregistrement. Cet enregistrement est effectué : 

- en sortie de saisie, si l'option "Enregistrer en sortie de ligne (Modif.)" est sélectionnée (onglet "Détail" de la fenêtre de description du champ Table),

- avec la fonction [TableEnregistre](../WDLang1/3074008.md).




Le même principe s'applique aux champs Zone répétée liés à une source de données.

<a name="XComposante"></a>

## Composante :
wd280page.dll
