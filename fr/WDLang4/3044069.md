


## HExporteXML (Fonction)

***En anglais : HExportXML***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Exporte les enregistrements d'un fichier de données (HFSQL ou OLE DB), d'une vue ou d'une requête dans un fichier XML.

**Remarque** : Une feuille de styles (fichier ".XSL") est automatiquement générée lors de la création du fichier XML.

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Exporte tous les clients
HExporteXML(CLIENT, "C:\TEMP\Client.xml", hExpCréation)
```



```wl
sdr est une Requête SQL = 
[
	SELECT * FROM FicTest
]

SI PAS HExécuteRequête(sdr) ALORS
	Trace(HErreurInfo())
SINON
	SI PAS HExporteXML(sdr, "FicTest.xml", hExpCréation) ALORS
		Trace(HErreurInfo())	
	FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HExporteXML(<Fichier de données> [, <Chemin du fichier XML> [, <Rubriques à exporter>]] [, <Options> [, <Jauge>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données, de la vue ou de la requête manipulé. Si ce nom n'est pas spécifié, la fonction **HExporteXML** va manipuler le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Chemin du fichier XML> : (Chaîne de caractères optionnelle)`**

Chemin complet du fichier XML à générer. 
Si ce paramètre n'est pas spécifié, un fichier &lt;Fichier de données&gt;.XML sera généré dans le répertoire courant.

**`<Rubriques à exporter> : (Chaîne de caractères optionnelle)`**

Liste des noms des rubriques à exporter. Les noms sont délimités par de simples quotes et séparés par des virgules ou des RC. Les noms des rubriques de type clé composée, binaire, mémo binaire sont ignorés.
Si ce paramètre correspond à une chaîne vide (""), toutes les rubriques du fichier de données (sauf celles de type clé composée, binaire et mémo binaire) sont exportées.

**`<Options> : (Constante optionnelle de type Entier)`**

Mode de création du fichier XML :



|   |   |
| --- | --- |
| *hExpCréation* | Si le fichier d'exportation XML existe, il est écrasé. Si cette option n'est pas précisée et que le fichier XML existe, une erreur est générée. |
| *hExpInterruptible* | L'exportation peut être interrompue par la touche Echap du clavier. <br>Si l'exportation est interrompue, le fichier XML est valide et contient uniquement les enregistrements exportés avant interruption. |
| *hExpNormal*<br>(valeur par défaut) | Fonctionnement normal. |
| *hExpSansXSL* | La feuille de styles (fichier ".XSL") n'est pas créée. |



**`<Jauge> : (Nom de champ ou nom de fenêtre optionnel)`**

Nom du champ de type Jauge ou nom de la fenêtre permettant de visualiser la progression de la création du fichier XML.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Exporter le contenu d'une requête
<a name="exporter_contenu_une_requete_ELTPARAGRAPHE000140"></a>Pour exporter le contenu d'une requête, il est nécessaire d'initialiser la requête (fonction [HExécuteRequête](../WDLang4/3044080.md)) avant d'utiliser la fonction **HExporteXML**.
<a name="NOTE0_2"></a>


### Exporter un seul enregistrement
<a name="exporter_seul_enregistrement_ELTPARAGRAPHE000155"></a>Pour exporter un seul enregistrement vers une chaîne XML, utilisez la fonction [HEnregistrementVersXML](../WDLang4/3044093.md).
<a name="NOTE0_3"></a>


### Rubriques tableau
<a name="rubriques_tableau_ELTPARAGRAPHE000167"></a>Si une des rubriques exportées est une rubrique de type tableau, chaque élément de la rubrique tableau est exporté dans un nouveau niveau :

```xml
<FICHIER>
	<RUB1>donnée de la rubrique 1</RUB1>
	<RUB2>donnée de la rubrique 2</RUB2>
	<RUBTAB>
		<RUBTAB_1>donnée de l'élément 1</RUBTAB_1>
		<RUBTAB_2>donnée de l'élément 2</RUBTAB_2>
		<RUBTAB_3>donnée de l'élément 3</RUBTAB_3>
	</RUBTAB>
...
</FICHIER>
```

**Rappel** : Les rubriques de type clé composée, mémo binaire ou binaire sont ignorées.
<a name="NOTE0_4"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000179"></a>L'entité document du fichier XML généré se nomme HF_DOCUMENT.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
