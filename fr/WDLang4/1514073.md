
## Connexion (Type de variable)

***En anglais : Connection***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **Connexion** permet de décrire par programmation une ou plusieurs connexions à des bases de données externes (HFSQL Client/Serveur, Connecteur Natif, ...). Cette connexion pourra être ouverte grâce à la fonction [HOuvreConnexion](../WDLang4/3044107.md). Les caractéristiques de cette connexion peuvent être modifiées à l'aide de [différentes propriétés WLangage](#NOTE0_1).



La variable de type **Connexion** permet aussi bien de :

- décrire une nouvelle connexion (équivalent à la fonction [HDécritConnexion](../WDLang4/3044205.md)).

- créer une connexion (qui sera ouverte grâce à la fonction [HOuvreConnexion](../WDLang4/3044107.md)).

- modifier une connexion existante.




**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MaConnexion est une Connexion

// Description de la connexion
MaConnexion.Utilisateur = "USER"
MaConnexion.MotDePasse = "PASSWORD"
MaConnexion.Serveur = "MONSERVEUR" 
MaConnexion.BaseDeDonnées = "Base de données"
MaConnexion.Provider = hAccèsHFClientServeur
MaConnexion.Accès = hOLectureEcriture
MaConnexion.InfosEtendues = "Infos étendues"
MaConnexion.OptionsCurseur = hCurseurClient

// Ouverture de la connexion
HOuvreConnexion(MaConnexion)

// Affectation de la connexion à tous les fichiers de données
HChangeConnexion("*", MaConnexion)
```



<a name="XSYNTAXE"></a>


<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Propriétés WLangage utilisables sur une connexion décrite par programmation
<a name="proprietes_wlangage_utilisables_sur_une_connexion_decrite_par_programmation_ELTPARAGRAPHE000067"></a>Les propriétés spécifiques aux connexions sont détaillées dans le tableau suivant :

Remarque : Les propriétés **Provider** et **Serveur**, ou **Provider** et **Source** doivent obligatoirement être initialisées lors de la description d'une connexion.

| Nom de la propriété | Effet |
| --- | --- |
| [Accès](../Proprietes/2512100.md) | Permet de gérer le type d'accès d'une connexion (HFSQL Client/Serveur, OLE DB, ...) : Lecture, Lecture/Ecriture |
| [ActiveDirectory](../Proprietes/1000023438.md) | Permet de gérer la connexion via Active Directory. |
| [BaseDeDonnées](../Proprietes/2512101.md) | Permet de gérer le nom de la base de données associée à une connexion (HFSQL Client/Serveur, OLE DB, ...).<br><br>Dans le cas d'une base de données découpée en schémas, le nom du schéma dans la base de données sera précisé par la fonction [HChangeNom](../WDLang4/3044141.md). |
| [Compression](../Proprietes/1000017276.md) | Permet de gérer la compression des données transmises par la connexion. |
| [Cryptage](../Proprietes/2512102.md) | Permet de gérer le type de cryptage de la communication entre les postes Client et le poste Serveur HFSQL. |
| [InfosEtendues](../Proprietes/2512041.md) | Permet de gérer les informations supplémentaires d'une connexion. |
| [Libellé](../Proprietes/2510053.md) | Permet de connaître et de modifier le libellé d'une connexion. |
| [MotDePasse](../Proprietes/2510086.md) | Permet de modifier le mot de passe associé à un utilisateur d'une connexion. |
| [Nom](../Proprietes/2510082.md) | Permet de connaître le nom de la connexion |
| [OptionsCurseur](../Proprietes/2512103.md) | Permet de gérer les différents types de curseurs utilisés par la connexion. |
| [Provider](../Proprietes/2512104.md) | Permet de gérer le type de données manipulées par la connexion. |
| [Serveur](../Proprietes/2512105.md) | Permet de gérer le nom du serveur utilisé dans la connexion. Cette propriété est identique à la propriété [Source](../Proprietes/2510147.md). Cette propriété est plutôt utilisée pour les connexions HFSQL Client/Serveur ou les Accès Natifs sur les serveurs. <br><br>![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Il est possible d'indiquer une adresse IPv6 en écrivant l'adresse IPv6 entre des crochets. Dans ce cas, le numéro de port doit être indiqué après le crochet fermant. Par exemple : [0154:2145:2155::5554]:4900. |
| [Source](../Proprietes/2510147.md) | Permet de gérer le nom de la source de données utilisée dans la connexion. Cette propriété est identique à la propriété [Serveur](../Proprietes/2512105.md). Cette propriété est plutôt utilisée pour une connexion sur MS Access ou sur un fichier xBase. |
| [TailleCache](../Proprietes/2512106.md) | Permet de gérer la taille du cache |
| [Utilisateur](../Proprietes/2512107.md) | Permet de gérer l'utilisateur de la connexion |




<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Connecteur Natif Oracle : gestion de l'authentification externe
<a name="connecteur_natif_oracle_gestion_authentification_externe_ELTPARAGRAPHE000178"></a>Pour se connecter via une authentification externe : 

- la propriété **Utilisateur** doit correspondre à "/" (slash)

- la propriété **MotDePasse** doit correspondre à "" (chaîne vide)




Remarque : L'authentification externe consiste à se baser sur le nom de l'utilisateur Windows et son mot de passe pour se connecter à la base de données. L'authentification externe nécessite un paramétrage du serveur. Reportez-vous à la documentation de Oracle pour savoir comment autoriser les authentifications externes sur le serveur. 
<a name="NOTE0_3"></a>


### Équivalences de code : Description d'une connexion
<a name="equivalences_code_description_une_connexion_ELTPARAGRAPHE000190"></a>Code utilisant la fonction [HDécritConnexion](../WDLang4/3044205.md) :


```wl
HDécritConnexion("MaConnexion", "USER", "PASSWORD", "SERVEURTEST", ...
	"Base de données", hAccèsHFClientServeur, hOLectureEcriture, ...
	"Infos étendues", hCurseurClient)
```


Code utilisant la connexion :


```wl
MaConnexion est une Connexion
// Description de la connexion
MaConnexion.Utilisateur = "USER"
MaConnexion.MotDePasse = "PASSWORD"
MaConnexion.Serveur = "SERVEURTEST"
MaConnexion.BaseDeDonnées = "Base de données"
MaConnexion.Provider = hAccèsHFClientServeur
MaConnexion.Accès = hOLectureEcriture
MaConnexion.InfosEtendues = "Infos étendues"
MaConnexion.OptionsCurseur = hCurseurClient
```



<a name="NOTE0_4"></a>


### Équivalences de code : Ouverture d'une connexion 
<a name="equivalences_code_ouverture_une_connexion_ELTPARAGRAPHE000207"></a>Code utilisant la fonction [HOuvreConnexion](../WDLang4/3044107.md) :


```wl
HOuvreConnexion("MaConnexion", "USER", "PASSWORD", "SERVEURTEST", ...
	"Base de données", hAccèsHFClientServeur, hOLectureEcriture, ...
	"Infos étendues", hCurseurClient)
```


Code utilisant la connexion :


```wl
MaConnexion est une Connexion
// Description de la connexion
MaConnexion.Utilisateur = "USER"
MaConnexion.MotDePasse = "PASSWORD"
MaConnexion.Serveur = "SERVEURTEST"
MaConnexion.BaseDeDonnées = "Base de données"
MaConnexion.Provider = hAccèsHFClientServeur
MaConnexion.Accès = hOLectureEcriture
MaConnexion.InfosEtendues = "Infos étendues"
MaConnexion.OptionsCurseur = hCurseurClient
HOuvreConnexion(MaConnexion)
```



<a name="NOTE0_5"></a>




### Équivalence de code : Affecter une connexion
<a name="equivalence_code_affecter_une_connexion_ELTPARAGRAPHE000225"></a>Code utilisant la fonction [HChangeConnexion](../WDLang4/3044150.md) :


```wl
HChangeConnexion(CLIENT, MaConnexion)
```


Code utilisant la connexion :


```wl
CLIENT.Connexion = MaConnexion
```



<a name="NOTE0_6"></a>




### Équivalence de code : Modifier une connexion existante
<a name="equivalence_code_modifier_une_connexion_existante_ELTPARAGRAPHE000243"></a>

Code utilisant la fonction [HDécritConnexion](../WDLang4/3044205.md) :


```wl
HDécritConnexion(MaConnexion, "USER2", "PASSWORD2", MaConnexion.CxBaseDeDonnées, ...
	MaConnexion.CxInitialCatalog, ...	
	MaConnexion.CxProviderOLEDB, MaConnexion.CxAccès, ...
	MaConnexion.CxInfosEtendues, MaConnexion.CxOptionsCurseur)
```


Code utilisant la connexion :


```wl
// Modifie le login et le mot de passe pour la connexion
MaConnexion.Utilisateur = "USER2"
MaConnexion.MotDePasse = "PASSWORD2"
```



