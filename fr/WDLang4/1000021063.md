
## Accès à une base de données via un Webservice
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000207"></a>
L'accès à une base de données peut être réalisé via un Webservice. 

Ce mode de fonctionnement peut être utilisé dans plusieurs cas : 

- Accès aux bases de données limité aux fonctions de type HTTP. 

- Accès à une base tierce (Oracle, SQL Server, ...) depuis un mobile iOS ou Android. 

- ...






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Mise en place et conditions d'utilisation
<a name="mise_place_conditions_utilisation_ELTTEXTE000231"></a>
Pour accéder à une base de données via un Webservice, il faut : 

1. [Installer le Webservice fourni par PC SOFT sur un serveur](#NOTE2_2). 

2. [Installer les fichiers nécessaires à l'accès aux bases de données : Accès Natifs, couche cliente, source ODBC, ...](#NOTE2_3)

3. [Utiliser la fonction SQLConnecteWS pour se connecter à la base de données](#NOTE2_4). 

4. [Utiliser les fonctions SQL pour manipuler la base de données](#NOTE2_5). 



<a name="NOTE2_2"></a>


### Installer le Webservice fourni par PC SOFT sur un serveur
<a name="installer_webservice_fourni_par_soft_sur_serveur_ELTPARAGRAPHE000040"></a>Le programme d'installation du Webservice d'accès aux bases de données est fourni avec WINDEV, WEBDEV et WINDEV Mobile. Ce programme est disponible dans le sous-répertoire "INSTALL" du répertoire d'installation du produit. 

Pour installer le Webservice : 

1. Sur le serveur, lancez le programme WX280PACKRSRV.EXE situé dans le sous-répertoire "Install\\WDServeurR" du produit voulu. 

2. Dans l'assistant : 

	- Acceptez la licence. 

	- Dans l'écran "Choix des modules", sélectionnez l'option "Installer le Webservice d'accès aux bases tierces". 

	- Indiquez le répertoire d'installation des éléments du serveur réservé. 

	- Indiquez l'URL d'accès au poste serveur où sera installé le Webservice. Il est possible d'utiliser une adresse sécurisée. Cette adresse sera utilisée lors de la connexion via le Webservice grâce à la fonction [SQLConnecteWS](../WDLang4/1000021031.md). 




3. Validez l'installation. 




Remarques : 

- Ce Webservice doit être installé sur le poste serveur auquel les applications utilisant des bases de données tierces se connecteront. 

- Le poste serveur doit pouvoir accéder aux bases de données tierces. 

- L'installation du Webservice installe une version spécifique du serveur d'application WEBDEV. Cette version est nécessaire au fonctionnement du Webservice. 



<a name="NOTE2_3"></a>


### Installer les fichiers nécessaires à l'accès aux bases de données
<a name="installer_les_fichiers_necessaires_acces_aux_bases_donnees_ELTPARAGRAPHE000069"></a>La base de données accédée via le Webservice peut être située sur n'importe quel poste. Seule condition : ce poste doit être accessible depuis le poste serveur où le Webservice a été installé. 

Selon le type de la base de données, différents éléments doivent également être installés. 

**Accès à la base de données tierce via un Accès Natif** 
Si l'accès à la base de données tierce doit être effectuée via un Accès Natif, il est nécessaire d'installer sur le même poste que le Webservice : 

- la couche cliente correspondante si nécessaire. 

- les librairies de l'Accès Natif WINDEV ou WEBDEV permettant d'accéder à la base de données. 




**Accès à la base de données via un driver OLE DB**
Si l'accès à la base de données tierce doit être effectuée via OLE DB, il est nécessaire d'installer sur le même poste que le Webservice : 

- le MDAC version 2.6 minimum. 

- le provider OLE DB correspondant à la base de données manipulée. 




**Accès à la base de données via ODBC**
Si l'accès à la base de données tierce doit être effectuée via ODBC, il est nécessaire  de configurer la source de données ODBC dans ODBC Administrateur sur le poste d'installation du Webservice. Cette source de données doit être une "source de données système".


<a name="NOTE2_4"></a>


### Utiliser la fonction SQLConnecteWS pour se connecter à la base de données
<a name="utiliser_fonction_sqlconnectews_pour_connecter_base_donnees_ELTPARAGRAPHE000097"></a>Pour se connecter à la base de données via le Webservice, il suffit d'utiliser la fonction [SQLConnecteWS](../WDLang4/1000021031.md). Cette fonction correspond à la fonction [SQLConnecte](../WDLang4/3072005.md). Un paramètre supplémentaire apparaît : l'URL d'accès au serveur où le Webservice a été installé. Cette URL correspond à l'URL spécifiée dans l'assistant d'installation du Webservice. 

**Remarque** : La fonction [SQLConnecteWS](../WDLang4/1000021031.md) n'effectue pas la connexion à la base. Cette fonction contrôle uniquement que le Webservice répond bien à l'adresse indiquée. La connexion effective à la base est effectuée à chaque appel de la fonction [SQLExec](../WDLang4/3072007.md). En effet, dans ce mode, chaque exécution d'une requête va provoquer une connexion, puis l'exécution de la requête et enfin la déconnexion.

**Astuce** : Comment savoir si les paramètres de connexion sont corrects : 
Vous pouvez créer un petit programme de test utilisant la fonction [SQLConnecte](../WDLang4/3072005.md) pour se connecter à la base de données. Il suffit d'exécuter ce programme directement sur le serveur où le Webservice est installé. Si l'accès à la base de données est correct, il suffit de reprendre les paramètres de la fonction [SQLConnecte](../WDLang4/3072005.md) pour les utiliser avec la fonction [SQLConnecteWS](../WDLang4/1000021031.md), en ajoutant l'adresse du serveur. 
<a name="NOTE2_5"></a>


### Utiliser les fonctions SQL pour manipuler la base de données
<a name="utiliser_les_fonctions_sql_pour_manipuler_base_donnees_ELTPARAGRAPHE000131"></a>Une fois connecté à la base de données, l'application peut manipuler les données via [les fonctions SQL](../WDLang4/3072002.md) du WLangage. 

**Remarques** : 

- Les fonctions Hxxxx (fonction [HExécuteRequête](../WDLang4/3044080.md) ou fonction [HExécuteRequêteSQL](../WDLang4/3044084.md) par exemple) ne sont pas disponibles. 

- Les fonctions [SQLBloque](../WDLang4/3072003.md) et [SQLTransaction](../WDLang4/3072029.md) ne sont pas disponibles actuellement. 

- Chaque appel de la fonction [SQLExec](../WDLang4/3072007.md) provoque la connexion puis la déconnexion de la base de données. Deux appels successifs de la fonction [SQLExec](../WDLang4/3072007.md) n'utilisent pas la même connexion à la base de données. 





