


## HListeRubrique (Fonction)

***En anglais : HListItem***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie la liste des rubriques :

- présentes dans un fichier de données (d'une requête ou d'une vue) reconnu par le moteur HFSQL. Les fichiers de données définis par les fonctions [HDéclare](../WDLang4/3044203.md), [HDéclareExterne](../WDLang4/3044204.md) et [HDécritFichier](../WDLang4/3044206.md) sont pris en compte.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) présentes dans une variable de type Enregistrement. 





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003044230&name=hlisterubrique_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Récupérer les rubriques d'un fichier de données de l'analyse en cours
ListeDesRubriques est une chaîne
ListeDesRubriques = HListeRubrique(Client, hLstDétail)

// Ajoute la liste des rubriques dans COMBO_COMBO1
ListeAjoute(COMBO_COMBO1, ListeRubrique)
```
<a name="Exemple2"></a>

```wl
// Exécution d'une requête "SELECT *" et interrogation des rubriques
sdListeVILLE est une Source de Données
sListeRub est une chaîne
sContenuEnreg est une chaîne
sReq est une chaîne = "SELECT * FROM CODEPOSTAUX WHERE CODEPOSTAL ='34000'"

// Exécution de la requête
HExécuteRequêteSQL(sdListeVILLE, hRequêteDéfaut, sReq)
// Liste des rubriques de la requête.
sListeRub = HListeRubrique(sdListeVILLE)

// Parcours de la requête
POUR TOUT sdListeVILLE 
	sContenuEnreg = ""
	// Pour chaque enregistrement, il faut parcourir les rubriques
	POUR TOUTE CHAINE sUneRubrique DE sListeRub SEPAREE PAR RC
		sContenuEnreg += {"sdListeVILLE." + sUneRubrique, indRubrique}
	FIN
	Info("Contenu de l'enregistrement : " + sContenuEnreg)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Lister les rubriques d'un fichier de données

`<Résultat> = HListeRubrique(<Fichier de données> [, <Chemin du WDD> [, <Mot de passe du WDD> [, <Options>]]])`
---

**`<Résultat> : (Chaîne de caractères)`**

Liste des rubriques présentes dans le fichier de données spécifié. Les différentes descriptions de chaque rubrique sont séparées par RC (Retour Chariot). En fonction de la constante utilisée, le résultat est plus ou moins détaillé :


|   |   |
| --- | --- |
| *hLstDétail* non précisé | &lt;Nom de la rubrique 1&gt; + RC + &lt;Nom de la rubrique 2&gt; + RC + ... |
| *hLstDétail* précisé | &lt;Nom de la rubrique 1&gt; + TAB + &lt;Type&gt; + TAB + &lt;Type HFSQL&gt; + TAB + &lt;Taille&gt; + TAB + &lt;Nombre d'indices&gt; + TAB + &lt;Libellé&gt; + RC + ... |
| *hLstDétailPlus* | &lt;Nom de la rubrique 1&gt; + TAB + &lt;Type&gt; + TAB + &lt;Type HFSQL&gt; + TAB + &lt;Taille&gt; + TAB + &lt;Nombre d'indices&gt; + TAB + &lt;Libellé&gt; + TAB + &lt;Partie entière des rubriques numériques&gt; + TAB + &lt;Partie décimale des rubriques numériques&gt; + RC + ... |

Où :

- &lt;Nom de rubrique X&gt; : Nom de la rubrique

- &lt;Type&gt; : Type de la rubrique : "T" pour texte (et monétaire) ou "N" pour numérique

- &lt;Type HFSQL&gt; : Type HFSQL de la rubrique. Pour plus de détails, voir les Notes.

- &lt;Taille&gt; : Taille de la rubrique

- &lt;Nombre d'indices&gt; : Nombre d'éléments du tableau

- &lt;Libellé&gt; : Libellé de la rubrique.

- &lt;Partie entière des rubriques numériques&gt; : Nombre de chiffres de la partie entière des rubriques numériques

- &lt;Partie décimale des rubriques numériques&gt; : Nombre de chiffres de la partie décimale des rubriques numériques


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) En Java, &lt;Libellé&gt; correspond au nom de la rubrique.

**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données (de la requête ou de la vue) dont les rubriques doivent être listées.

Si un nom de requête est spécifié, cette requête doit être en cours d'exécution (fonctions [HExécuteRequête](../WDLang4/3044080.md) ou [HExécuteRequêteSQL](../WDLang4/3044084.md)) pour que la fonction **HListeRubrique** fonctionne. Dans le cas contraire, une erreur du WLangage est générée.

**`<Chemin du WDD> : (Chaîne de caractères optionnelle)`**

Chemin complet de l'analyse (c'est-à-dire du ficher .WDD) dans laquelle le fichier de données est décrit. Si ce paramètre n'est pas précisé ou est égal à une chaîne vide (""), le fichier de données est recherché dans l'analyse en cours.
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre est ignoré. Le fichier de données est recherché dans l'analyse en cours. 

**`<Mot de passe du WDD> : (: Chaîne de caractères optionnelle)`**

Mot de passe défini pour l'analyse. Si aucun mot de passe n'est défini, ce paramètre doit être égal à une chaîne vide ("").
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre est ignoré.

**`<Options> : (Constante ou combinaison de constantes optionnelle de type entier)`**

Type de liste à effectuer :


|   |   |
| --- | --- |
| *hLstClé* | Liste les rubriques clés (clés non composées uniquement)<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |
| *hLstCléComposée* | Liste les rubriques clés composées uniquement<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |
| *hLstDétail* | Informations détaillées (idem versions antérieures). |
| *hLstDétailPlus* | Pour les numériques, ajoute le nombre de chiffres de la partie entière et de la partie décimale.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |
| *hLstMémo* | Liste les rubriques mémo<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |
| *hLstNormal*<br>(valeur par défaut) | Correspond à *hLstRubrique* + *hLstMémo* + *hLstClé* |
| *hLstOrdreLogique* | Trie la liste dans l'ordre logique des rubriques (ignorée si *hLstTriée* est précisée)<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |
| *hLstRubrique* | Liste les rubriques non clé et non mémo |
| *hLstRubriqueOrigine* | Utilisée sur un fichier journal (xxxJNL.fic), liste les rubriques du fichier original (qui a été journalé). Par exemple, sur le fichier ClientJNL.Fic, liste les rubriques du fichier CLIENT.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *hLstTout* | Liste tous les types de rubrique (*hLstRubrique* + *hLstMémo* + *hLstClé* + *hLstClécomposée*)<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |
| *hLstTriée* | Trie la liste par ordre alphabétique<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |




<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 
### Lister les rubriques d'une variable de type Enregistrement

`<Résultat> = HListeRubrique(<Enregistrement> [, <Options>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Liste des rubriques présentes dans la variable de type [Enregistrement](../WDLang4/1000020962.md) spécifiée. Les différentes descriptions de chaque rubrique sont séparées par RC (Retour Chariot). En fonction de la constante utilisée, le résultat est plus ou moins détaillé :


|   |   |
| --- | --- |
| *hLstDétail* non précisé | &lt;Nom de la rubrique 1&gt; + RC + &lt;Nom de la rubrique 2&gt; + RC + ... |
| *hLstDétail* précisé | &lt;Nom de la rubrique 1&gt; + TAB + &lt;Type&gt; + TAB + &lt;Type HFSQL&gt; + TAB + &lt;Taille&gt; + TAB + &lt;Nombre d'indices&gt; + TAB + &lt;Libellé&gt; + RC + ... |
| *hLstDétailPlus* | &lt;Nom de la rubrique 1&gt; + TAB + &lt;Type&gt; + TAB + &lt;Type HFSQL&gt; + TAB + &lt;Taille&gt; + TAB + &lt;Nombre d'indices&gt; + TAB + &lt;Libellé&gt; + TAB + &lt;Partie entière des rubriques numériques&gt; + TAB + &lt;Partie décimale des rubriques numériques&gt; + RC + ... |

Où :

- &lt;Nom de rubrique X&gt; : Nom de la rubrique

- &lt;Type&gt; : Type de la rubrique : "T" pour texte (et monétaire) ou "N" pour numérique

- &lt;Type HFSQL&gt; : Type HFSQL de la rubrique. Pour plus de détails, voir les Notes.

- &lt;Taille&gt; : Taille de la rubrique

- &lt;Nombre d'indices&gt; : Nombre d'éléments du tableau

- &lt;Libellé&gt; : Libellé de la rubrique.

- &lt;Partie entière des rubriques numériques&gt; : Nombre de chiffres de la partie entière des rubriques numériques

- &lt;Partie décimale des rubriques numériques&gt; : Nombre de chiffres de la partie décimale des rubriques numériques




**`<Enregistrement> : (Variable de type Enregistrement)`**

Nom de la variable de type [Enregistrement](../WDLang4/1000020962.md) correspondant à l'enregistrement à partir duquel la liste des rubriques doit être retrouvée. 

**`<Options> : (Constante ou combinaison de constantes optionnelle de type entier)`**

Paramètre le type de liste à effectuer :


|   |   |
| --- | --- |
| *hLstClé* | Liste les rubriques clés (clés non composées uniquement).<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |
| *hLstCléComposée* | Liste les rubriques clés composées uniquement.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |
| *hLstDétail* | Informations détaillées (idem versions antérieures). |
| *hLstDétailPlus* | Pour les numériques, ajoute le nombre de chiffres de la partie entière et de la partie décimale.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |
| *hLstMémo* | Liste les rubriques mémo<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |
| *hLstNormal*<br>(valeur par défaut) | Correspond à *hLstRubrique* + *hLstMémo* + *hLstClé* |
| *hLstOrdreLogique* | Trie la liste dans l'ordre logique des rubriques (ignorée si *hLstTriée* est précisée).<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |
| *hLstRubrique* | Liste les rubriques non clé et non mémo |
| *hLstRubriqueOrigine* | Utilisée sur un fichier journal (xxxJNL.fic), liste les rubriques du fichier original (qui a été journalé). Par exemple, sur le fichier ClientJNL.Fic, liste les rubriques du fichier CLIENT.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |
| *hLstTout* | Liste tous les types de rubrique (*hLstRubrique* + *hLstMémo* + *hLstClé* + *hLstClécomposée*).<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |
| *hLstTriée* | Trie la liste par ordre alphabétique.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette constante n'est pas prise en compte. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Ordre des rubriques
<a name="ordre_des_rubriques_ELTPARAGRAPHE000400"></a>Les rubriques listées dans &lt;Résultat&gt; sont triées en fonction de l'ordre physique des rubriques dans le fichier de données (sauf si la constante *hLstTriée* est utilisée).
<a name="NOTE0_2"></a>


### Affichage du résultat dans un champ Liste ou Combo
<a name="affichage_resultat_dans_champ_liste_combo_ELTPARAGRAPHE000409"></a>&lt;Résultat&gt; peut être directement affecté à un champ Liste ou Combo grâce à la fonction [ListeAjoute](../WDLang1/3049004.md). Chaque ligne contiendra la description d'une rubrique.
<a name="NOTE0_3"></a>


### Type HFSQL
<a name="type_hfsql_ELTPARAGRAPHE000421"></a>Les types HFSQL possibles sont les suivants :


|   |   |   |   |
| --- | --- | --- | --- |
| 0 | type inconnu | 1 | identifiant automatique sur 8 octets |
| 2 | rubrique texte | 3 | rubrique de type entier signé sur 2 octets |
| 4 | rubrique de type entier signé sur 1 octet | 5 | rubrique de type entier signé sur 4 octets |
| 6 | rubrique de type réel simple (sur 4 octets) | 7 | rubrique de type réel double (sur 8 octets) |
| 8 | rubrique de type numéro d'enregistrement (entier non signé) | 9 | rubrique de type entier non signé sur 2 octets |
| 10 | rubrique de type date sur 6 | 11 | rubrique de type heure |
| 12 | rubrique de type entier non signé sur 1 octet | 13 | rubrique de type réel turbo |
| 14 | rubrique de type date sur 8 | 15 | rubrique de type mémo texte |
| 16 | rubrique de type mémo binaire 4.0 | 17 | rubrique de type monétaire |
| 18 | rubrique de type mémo binaire, mémo Image,<br> mémo Son, mémo OLE ou mémo binaire autre | 19 | rubrique de type entier signé sur 8 octets |
| 20 | rubrique de type entier non signé sur 8 octets | 21 | rubrique de type image |
| 22 | rubrique de type entier non signé sur 4 octets | 23 | rubrique de type chaîne binaire |
| 24 | rubrique de type date+heure | 25 | rubrique de type durée |
| 26 | rubrique de type caractère | 27 | rubrique de type booléen |
| 28 | rubrique de type identifiant automatique (sur 4 octets) | 29 | rubrique de type texte Unicode |
| 30 | rubrique de type mémo texte Unicode | 31 | rubrique de type numérique haute précision |
| 32 | rubrique de type Enumération | 33 | rubrique de type Combinaison |
| 34 | rubrique de type UUID sur 128 bits | 35 | rubrique de type UUID automatique sur 128 bits |
| 36 | rubrique de type UUID sur 256 bits | 37 | rubrique de type UUID automatique sur 256 bits |
| 38 | rubrique de type JSON | 39 | rubrique de type Mot de passe (sécurisé) |



<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
