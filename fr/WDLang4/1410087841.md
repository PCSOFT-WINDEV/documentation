


## HTransactionPointDeSauvegarde (Fonction)

***En anglais : HTransactionSavepoint***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Déclare un point de sauvegarde pour une transaction. Il sera ensuite possible d'annuler la transaction jusqu'à ce point de sauvegarde (fonction [HTransactionRetourneAuPointDeSauvegarde](../WDLang4/1410087842.md)).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MaConnexion est une Connexion

// Début des transactions
HTransactionDébut(MaConnexion)

// Réalisation d'actions A

// Déclaration d'un point de sauvegarde
HTransactionPointDeSauvegarde(MaConnexion, "MonPointDeSauvegarde")

// Réalisation d'actions B

// Annulation de toutes les actions depuis la déclaration de MonPointDeSauvegarde
HTransactionRetourneAuPointDeSauvegarde(MaConnexion, "MonPointDeSauvegarde")

// Réalisation d'actions C

// Déclaration d'un point de sauvegarde
HTransactionPointDeSauvegarde(MaConnexion, "MonPointDeSauvegarde2")

// Réalisation d'actions D

// Validation (commit) des transactions
// Toutes les actions A, C et D sont prises en compte, 
// mais pas les actions B car elles sont situées entre HTransactionPointDeSauvegarde() 
// et HTransactionRetourneAuPointDeSauvegarde

HTransactionFin(MaConnexion)

// MonPointDeSauvegarde2 est désactivé
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = HTransactionPointDeSauvegarde([<Connexion>, ] <Nom du point de sauvegarde>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le point de sauvegarde a été créé, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'obtenir plus de renseignements sur l'erreur.




**`<Connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion vers un serveur HFSQL. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).


Si ce paramètre n'est pas spécifié, la connexion en cours est manipulée. 

**`<Nom du point de sauvegarde> : (Chaîne de caractères)`**

Nom du point de sauvegarde. 
Remarque :  Le nom du point de sauvegarde ne peut pas commencer par "#". 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Cette fonction doit impérativement être utilisée dans une transaction. 

- L'ordre SQL correspondant est également disponible : "SAVEPOINT identifiant".

- Cette fonction n'est pas disponible : 

	- sur des fichiers HFSQL en cluster, 

	- avec des fichiers manipulés via un Connecteur Natif. 







<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
