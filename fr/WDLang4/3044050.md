


## HLitRecherche (Fonction)

***En anglais : HReadSeek***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Positionne sur le premier enregistrement du fichier de données dont la valeur d'une rubrique spécifique est supérieure ou égale à une valeur recherchée (recherche générique). L'enregistrement est lu et les variables HFSQL correspondantes sont mises à jour.

En général, la fonction **HLitRecherche** permet de se positionner dans le fichier de données pour effectuer une boucle de parcours parmi les enregistrements correspondant à une condition. La fonction [HLitSuivant](../WDLang4/3044037.md) permet de lire l'enregistrement suivant correspondant à la condition.Après l'exécution de la fonction **HLitRecherche**, plusieurs cas peuvent se présenter :

- un enregistrement correspondant à la condition a été trouvé, bloqué (si nécessaire) et chargé en mémoire : la fonction [HTrouve](../WDLang4/3044104.md) renvoie <u><u><u>Vrai</u></u></u>.
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : La gestion des blocages n'est pas disponible sur les bases de données accédées par JDBC.

- le fichier de données est vide ou il n'existe pas d'enregistrement correspondant à la condition : aucune lecture n'est effectuée et la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u>Vrai</u></u></u>.




Cette fonction peut être utilisée indifféremment avec les fichiers de données, les vues HFSQL ou les requêtes.

**Remarques** :

- Par défaut, les fonctions [HLitRecherchePremier](../WDLang4/3044036.md) et [HLitRechercheDernier](../WDLang4/3044034.md) permettent d'effectuer des recherches à l'identique.

- Par défaut, la fonction **HLitRecherche** permet de faire une recherche générique sur les chaînes de caractères. Cette recherche n'est pas générique sur les entiers, les réels, les dates, les monétaires, ...





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003044050&name=hlitrecherche_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Recherche du premier enregistrement 
// pour lequel le nom du CLIENT est DUPOND
HLitRecherche(CLIENT, NOM, "DUPOND")
SI HTrouve() ALORS
	Trace("Client DUPOND trouvé")
SINON
	Trace("Client DUPOND non trouvé")
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HLitRecherche(<Fichier de données> , <Rubrique> , <Valeur recherchée> [, <Options>])`
---

**`<Résultat> : (Booléen (optionnel))`**

Correspond à : 

- <u><u><u><u>Vrai</u></u></u></u> si l'enregistrement recherché a été trouvé et lu. Le buffer de fichier est chargé avec les données de l'enregistrement trouvé. Dans ce cas, la fonction [HErreur](../WDLang4/3044088.md) vaut 0 et la fonction [HTrouve](../WDLang4/3044104.md) vaut <u><u><u><u>Vrai</u></u></u></u>. 

- <u><u><u><u>Faux</u></u></u></u> dans les cas suivants : 

	- erreur d'accès au fichier (par exemple impossibilité de lire). La fonction [HErreur](../WDLang4/3044088.md) renvoie un code d'erreur d'accès au fichier. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'obtenir plus de détails sur l'erreur. Dans ce cas, la fonction [HTrouve](../WDLang4/3044104.md) n'est pas utilisable. 

	- l'accès au ficher a été effectué mais aucun enregistrement n'a été trouvé. Dans ce cas, la fonction [HErreur](../WDLang4/3044088.md) vaut 0 et la fonction [HTrouve](../WDLang4/3044104.md) vaut <u><u><u><u>Faux</u></u></u></u>. 


 Attention : Dans ce cas, le buffer de fichier n'est pas utilisable. 




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données, de la vue HFSQL ou de la requête manipulé.

**`<Rubrique> : (Chaîne de caractères)`**

Nom de la rubrique sur laquelle la recherche doit être effectuée. 
Dans le cas d'une recherche à l'identique, ce paramètre peut correspondre à une rubrique non clé.
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Les recherches génériques sur clés composées fonctionnement uniquement si toutes les composantes de la clé composée sont de type texte. Dans le cas contraire, une recherche à l'identique est effectuée.

**`<Valeur recherchée> : (Type correspondant à la valeur)`**

Valeur de la rubrique recherchée.

**`<Options> : (Constante ou combinaison de constantes optionnelle)`**

Permet de paramétrer :

- le mode de blocage de l'enregistrement recherché.

- le type de recherche effectué.





|   |   |
| --- | --- |
| *hBlocageEcriture* | Blocage en écriture : l'enregistrement en cours de lecture pourra être lu par une autre application mais ne pourra pas être modifié par une autre application.<br>Si une requête est manipulée, le mode de blocage est ignoré.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hBlocageLectureEcriture* | Blocage en lecture/écriture : l'enregistrement en cours de lecture ne pourra ni être lu ni être modifié par une autre application.<br>Si une requête est manipulée, le mode de blocage est ignoré.<br>![ODBC](https://doc.pcsoft.fr/ext/images/fr/ODBC.png) Blocage en écriture seulement. Fonctionnement équivalent à la constante *hBlocageEcriture*.![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hBlocageNon* | Aucun blocage : l'enregistrement pourra être lu ou modifié par une autre application pendant la lecture.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hIdentique* | Recherche à l'identique (voir Notes)<br>Par défaut (constante non spécifiée), la recherche effectuée est une recherche générique.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hLimiteParcours* | ![ODBC](https://doc.pcsoft.fr/ext/images/fr/ODBC.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Le parcours s'arrêtera dès que la dernière valeur recherchée sera trouvée. L'enregistrement en cours correspondra à ce dernier enregistrement trouvé.<br>La fonction [HTrouve](../WDLang4/3044104.md) vaudra <u><u><u><u>Faux</u></u></u></u> et la fonction [HEnDehors](../WDLang4/3044094.md) vaudra <u><u><u><u>Vrai</u></u></u></u>.<br>Cette constante permet d'optimiser la vitesse de recherche en mode Client/Serveur.<br>Cette constante est conseillée dans le cas d'une recherche simple (sans parcours des éléments trouvés).<br>![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Cette constante n'est pas disponible. |
| *hRespecteFiltre* | Le parcours prendra en compte le filtre mis en place avec la fonction [HFiltre](../WDLang4/3044100.md), même si la clé de parcours utilisée n'est pas optimisée pour le filtre. Rappel : la fonction [HFiltre](../WDLang4/3044100.md) renvoie la clé de parcours optimisée pour le filtre.<br>**Attention** : dans ce cas, sur des fichiers de données de taille importante, des problèmes de performances peuvent survenir.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette variable ne peut pas être utilisée. |
| *hSansRafraîchir* | ![ODBC](https://doc.pcsoft.fr/ext/images/fr/ODBC.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) La fonction **HLitRecherche** ne rafraîchit pas le contenu de la table ou de la requête. Dans la mesure du possible, la requête n'est pas ré-exécutée. Toutes les positions sauvegardées sont conservées. |

![ODBC](https://doc.pcsoft.fr/ext/images/fr/ODBC.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Si le provider OLE DB ou le Connecteur Natif utilisé ne gère pas les blocages, les options de blocage seront sans effet.![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : La gestion des blocages n'est pas disponible sur les bases de données accédées par JDBC. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Recherche générique/Recherche à l'identique
<a name="recherche_generiquerecherche_identique_ELTPARAGRAPHE000303"></a>Selon le paramètre &lt;Valeur Recherchée&gt;, la recherche peut être générique ou à l'identique.

- **Recherche générique** : recherche de tous les enregistrements commençant par la valeur indiquée
	Pour effectuer une recherche générique, il suffit de préciser la valeur voulue dans le paramètre &lt;Valeur recherchée&gt;. 
	Remarque : Pour compatibilité avec WINDEV 5.5, la recherche générique d'une chaîne vide ("") est équivalente à l'utilisation de la fonction [HLitPremier](../WDLang4/3044051.md).  

- **Recherche à l'identique** : recherche de tous les enregistrements correspondant exactement à la valeur indiquée.
	Pour effectuer une recherche à l'identique, il faut que la taille de l'argument de recherche soit exactement égale à la taille de la clé. Pour faire une recherche à l'identique, il est également possible d'utiliser la constante *hIdentique*. 
	Pour faire une recherche à l'identique, il est aussi possible d'utiliser la fonction [HLitRecherchePremier](../WDLang4/3044036.md).




**Attention** : Si vous utilisez des fichiers Hyper File 5.5 ou des fichiers au format Hyper File 5.5 migré en HFSQL Classic, la mise en place des recherches génériques et à l'identique peut varier. Pour plus de détails, consultez le tableau récapitulatif [Hyper File 5.5 et HFSQL Classic : Comment sont gérés les espaces dans les recherches ?](../WDLang4/3044190.md)
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Recherche à l'identique sous Access
<a name="recherche_identique_sous_access_ELTPARAGRAPHE000335"></a>Pour effectuer une recherche à l'identique sur une base de données ACCESS, il est conseillé d'utiliser la fonction [SansEspace](../WDLang1/3024034.md) si des espaces sont présents à la fin de la valeur recherchée.
<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Recherche sur une clé composée
<a name="recherche_sur_une_cle_composee_ELTPARAGRAPHE000349"></a>Plusieurs méthodes permettent de faire une recherche sur une clé composée :

- Utilisation d'une liste de valeurs,

- Utilisation de la fonction [HConstruitValClé](../WDLang4/3044258.md),




**1. Utilisation d'une liste de valeurs**

Pour faire une recherche sur une clé composée, il est possible d'utiliser la syntaxe suivante :

```txt
HLitRecherche(<Nom du fichier>, <Nom de la clé composée>,
	[<Valeur de recherche du premier élément de la clé composée>, 
		<Valeur de recherche du deuxième élément de la clé>, ...])
```
Exemple :

```wl
// Recherche de l'enregistrement
HLitRecherche(CLIENT, NOM_PRENOM, ["MOULIN","Françoise"])

TANTQUE HTrouve(CLIENT)
	// Traitement
	HLitSuivant(CLIENT, NOM_PRENOM)
FIN
```

**2. Utilisation de la fonction [HConstruitValClé](../WDLang4/3044258.md)**

Si la rubrique recherchée est une clé composée, il est possible de construire la valeur à chercher avec la fonction [HConstruitValClé](../WDLang4/3044258.md).

![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Les recherches génériques sur clés composées fonctionnement uniquement si toutes les composantes de la clé composée sont de type texte. Dans le cas contraire, une recherche à l'identique est effectuée.
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Recherche sur une rubrique tableau
<a name="recherche_sur_une_rubrique_tableau_ELTPARAGRAPHE000392"></a>La recherche se fait uniquement sur le premier élément du tableau (élément d'indice 1). Pour effectuer une recherche sur les autres éléments du tableau, utilisez des filtres ou des requêtes.
<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Recherche et filtre
<a name="recherche_filtre_ELTPARAGRAPHE000403"></a>Si un filtre est actif (fonction [HFiltre](../WDLang4/3044100.md)), la recherche tient compte du filtre uniquement si la clé utilisée est identique.
<a name="NOTE0_7"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Parcours des enregistrements correspondant à une condition
<a name="parcours_des_enregistrements_correspondant_une_condition_ELTPARAGRAPHE000417"></a>En général, la fonction **HLitRecherche** permet de se positionner dans le fichier de données pour effectuer une boucle de parcours parmi les enregistrements correspondant à une condition. Les fonctions [HLitSuivant](../WDLang4/3044037.md) et [HLitPrécédent](../WDLang4/3044048.md) permettent de lire l'enregistrement suivant et précédent correspondant à la condition.

Pour ne plus tenir compte de la recherche lors du passage à l'enregistrement suivant ou précédent, il suffit d'utiliser une des fonctions suivantes :

- [HAnnuleRecherche](../WDLang4/3044157.md)

- [HLitDernier](../WDLang4/3044140.md)

- [HLitPremier](../WDLang4/3044051.md)



<a name="NOTE0_9"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Optimisation du temps de parcours
<a name="optimisation_temps_parcours_ELTPARAGRAPHE000446"></a>Pour optimiser le temps des premiers parcours d'un fichier de données, utilisez la fonction [HOptimise](../WDLang4/3044005.md) sur ce fichier de données.
<a name="NOTE0_10"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Versions précédentes
<a name="versions_precedentes_ELTPARAGRAPHE000458"></a>Cette fonction remplace les fonctions **HLitRechercheBloque** et **HLitRechercheSansBloquer**, conservées par compatibilité avec WINDEV 5.5.



<a name="XComposante"></a>

## Composante :
wd280hf.dll
