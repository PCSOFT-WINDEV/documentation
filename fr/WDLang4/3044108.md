


## HPasse (Fonction)

***En anglais : HPass***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Fixe le mot de passe utilisé pour créer ou pour ouvrir un fichier de données. Le mot de passe est stocké et sera utilisé lors de l'ouverture ou de la création du fichier de données, si aucun mot de passe n'est spécifié.

Remarques : 

- **Attention** : Il est nécessaire de définir un mot de passe pour réaliser un cryptage des données. Le cryptage des données doit être configuré lors de la description du fichier de données dans l'éditeur d'analyses (Onglet "Détail").

- Ce mot de passe peut aussi être spécifié directement dans les fonctions de création ([HCréation](../WDLang4/3044255.md), [HCréationSiInexistant](../WDLang4/3044254.md)) et d'ouverture du fichier de données ([HOuvre](../WDLang4/3044120.md)).

- **Fichiers cryptés dans une connexion HFSQL** :  **Attention** : L'ordre d'utilisation des fonctions permettant de se connecter à une base de données HFSQL Client/Serveur est important. Consultez [Optimiser les temps de connexion aux bases HFSQL Client/Serveur](../WDLang4/9000176.md) pour plus de détails.


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette fonction n'est pas disponible pour les bases de données accédées par JDBC.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ouverture d'un fichier de données avec mot de passe et contrôle d'erreur
HPasse(CLIENT, "MotDePasse")
SI HCréationSiInexistant(CLIENT) = Faux ALORS
	Erreur("Erreur HFSQL : " + HErreurInfo())
	RETOUR
FIN
// HErreurMotDePasse permet de savoir si l'erreur rencontrée est une erreur de mot de passe
SI HCréationSiInexistant() = Faux ALORS
	// Détail de l'erreur
	SI HErreurMotDePasse() = Vrai ALORS
		Erreur("Mot de passe invalide")
		// Code pour réessayer
	FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HPasse(<Fichier de données> [, <Mot de passe>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le mot de passe est enregistré, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur (mémoire insuffisante par exemple). Les fonctions [HErreur](../WDLang4/3044088.md) et [HErreurInfo](../WDLang4/3044071.md) permettent d'obtenir plus d'informations sur le problème rencontré.




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données utilisant un mot de passe. 
Si ce paramètre correspond à "\*", le mot de passe sera utilisé pour tous les fichiers de données décrits dans l'analyse. 
Ce paramètre peut également correspondre au nom d'un [groupe de fichiers (ou perso-dossier) défini dans l'analyse](../Editeurs/2011003.md) (non disponible en Android et Android Widget). Dans ce cas, le mot de passe sera utilisé pour tous les fichiers du groupe. 
Si le fichier de données est déclaré avec la fonction [HDéclareExterne](../WDLang4/3044204.md), &lt;Nom du fichier&gt; correspond au nom de l'alias du fichier de données.

**`<Mot de passe> : (Chaîne de caractères optionnelle)`**

Mot de passe associé au fichier de données. 
Si ce paramètre n'est pas précisé ou correspond à une chaîne vide (""), aucun mot de passe n'est défini pour le fichier de données. La taille du mot de passe n'est pas limitée.
![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Le mot de passe des fichiers HFSQL est insensible à la casse. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Quand utiliser la fonction HPasse ? 
<a name="quand_utiliser_fonction_docparampagetitleshort_ELTPARAGRAPHE000143"></a>La fonction **HPasse** doit être appelée :

- avant les fonctions d'ouverture ou de création explicites : [HOuvre](../WDLang4/3044120.md), [HCréation](../WDLang4/3044255.md), [HCréationSiInexistant](../WDLang4/3044254.md).

- avant les fonctions HFSQL accédant aux fichiers de données et qui ouvrent automatiquement les fichiers de données si ce n'est pas déjà fait (lecture, recherche, ajout, ...).




Remarques : 

- Si un mot de passe est précisé dans les fonctions d'ouverture ou de création explicites (fonctions [HOuvre](../WDLang4/3044120.md), [HCréation](../WDLang4/3044255.md), [HCréationSiInexistant](../WDLang4/3044254.md)), le mot de passe précisé dans la fonction **HPasse** n'est pas pris en compte.

- Le mot de passe des fichiers HFSQL est insensible à la casse.

- Pour changer un mot de passe sur un fichier de données existant ou ajouter un mot de passe sur un fichier de données créé sans mot de passe, il faut utiliser la fonction [HChangeMotDePasse](../WDLang4/1000018781.md).



<a name="NOTE0_2"></a>


### Définir un mot de passe sur un fichier de données
<a name="definir_mot_passe_sur_fichier_donnees_ELTPARAGRAPHE000191"></a>Un fichier de données sera protégé par mot de passe uniquement si :

- soit la fonction **HPasse** a été utilisée avant la fonction de création du fichier de données (fonctions [HCréation](../WDLang4/3044255.md) et  [HCréationSiInexistant](../WDLang4/3044254.md)),

- soit le mot de passe a été précisé directement dans la fonction de création du fichier de données.




**Remarque** : Un fichier de données peut être protégé par mot de passe sans être crypté et inversement. Le mot de passe est indépendant du cryptage des données. Le cryptage des données doit être configuré lors de la description du fichier de données dans l'éditeur d'analyses (Onglet "Détail").
<a name="NOTE0_3"></a>


### Supprimer un mot de passe sur un fichier de données
<a name="supprimer_mot_passe_sur_fichier_donnees_ELTPARAGRAPHE000214"></a>Pour supprimer un mot de passe sur un fichier de données, il est nécessaire de faire une modification automatique des fichiers de données.

Pour cela, il suffit de faire une modification dans l'analyse (par exemple modifier la taille d'une rubrique). Dans ce cas, lors de la génération de l'analyse, une modification automatique des fichiers de données sera proposée. Vous pourrez alors modifier ou supprimer le mot de passe associé à un ou plusieurs fichiers de données.

Si vos fichiers de données sont en exploitation, il suffira lors de la création du programme d'installation de préciser qu'une modification automatique des fichiers de données doit être effectuée. Le mot de passe sera ainsi supprimé ou modifié.

**Attention** : si vous supprimez le mot de passe de vos fichiers de données, n'oubliez pas d'adapter votre code.
<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Gestion du mot de passe (OLE DB et Connecteurs Natifs)
<a name="gestion_mot_passe_ole_connecteurs_natifs_ELTPARAGRAPHE000231"></a>Le mot de passe doit être précisé dans les paramètres de la connexion.

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
