
## HCréeRéplicaMaître (Fonction)

***En anglais : HCreateMasterReplica***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Crée le fichier de description d'un Réplica Maître (**réplication journalée ou réplication universelle**). Le fichier correspondant a pour extension ".RPM".

Le fichier de description d'un Réplica Maître contient la liste des Réplicas Abonnés avec pour chacun leur date de dernière synchronisation. A sa création, ce fichier est vide. Il est nécessaire d'utiliser la fonction [HCréeRéplicaAbonné](../WDLang4/3044253.md) pour initialiser ce fichier.

**Remarque** : Cette fonction est automatiquement appelée pendant la phase d'installation de l'application gérant la réplication.

![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Seule la réplication universelle est disponible. 

Note : La réplication n'est pas disponible lors de l'accès à une base de données via .






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) 
```wl
// Exemple 1 : Crée le fichier de réplica maître dans le répertoire C:\RPL\Paris
// en spécifiant un nom de fichier
HCréeRéplicaMaître("C:\RPL\Paris\ReplicaParis.RPM")
```

```wl
// Exemple 2 : Crée le fichier de réplica maître dans le répertoire C:\TEMP
// sans spécifier de nom de fichier
HCréeRéplicaMaître("C:\TEMP")
```

```wl
// Exemple 3 : Crée le fichier de réplica maître dans le répertoire en cours
HCréeRéplicaMaître()
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HCréeRéplicaMaître([<Répertoire du Réplica Maître>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le réplica maître a été créé, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire (par exemple, le fichier existe déjà dans le répertoire spécifié).




**`<Répertoire du Réplica Maître> : (Chaîne de caractères optionnelle)`**

Répertoire où le fichier de description du Réplica Maître doit être créé. Ce répertoire doit être accessible lors de l'utilisation de la fonction **HCréeRéplicaMaître**. 
Si ce paramètre :

- n'est pas précisé ou correspond à une chaîne vide : le fichier **ReplicaMaître.RPM** est créé dans le répertoire défini dans l'analyse (sous-répertoire RPL des fichiers de données par défaut). Dans le cas de la réplication universelle, si ce paramètre n'est pas précisé ou correspond à une chaîne vide (""), le fichier est créé dans le répertoire en cours.

- correspond à un nom de répertoire (répertoire réseau ou UNC) : le fichier ReplicaMaître.RPM est créé dans le répertoire spécifié. 
	**Exemple** : HCréeRéplicaMaître("C:\\Temp") crée le fichier ReplicaMaître.RPM dans le répertoire C:\\Temp.

- est de la forme &lt;Répertoire&gt;\\&lt;NomFichier&gt;.RPM : le fichier &lt;NomFichier&gt;.RPM est créé dans le répertoire indiqué. 
	**Exemple** : HCréeRéplicaMaître("C:\\Temp\\Paris.RPM") crée le fichier Paris.RPM dans le répertoire C:\\Temp.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) 

### Réplication jounalée et journalisation : Répertoires de création des fichiers
<a name="replication_jounalee_journalisation_repertoires_creation_des_fichiers_ELTPARAGRAPHE000108"></a>La réplication journalée est étroitement liée à la journalisation. Lors de la mise en place de la réplication journalée dans une application, la journalisation est automatiquement activée.

Pour tous les fichiers manipulés (fichiers de données, fichiers journal ou fichiers de la réplication), il est possible de définir les différents chemins des fichiers physiques correspondant aussi bien sous l'éditeur d'analyses que par programmation.

Par défaut, l'arborescence des fichiers est la suivante (exemple pour l'application GesCom) :

![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Replic_repertoire.gif)


Le tableau ci-dessous présente la valeur par défaut de ces différents répertoires et leur mode de configuration aussi bien sous l'éditeur d'analyses que par programmation.

|   | Valeur par défaut | Où le configurer sous l'éditeur d'analyses ? | Comment changer la valeur par défaut par programmation ? |
| --- | --- | --- | --- |
| **Répertoire des fichiers de données** | Répertoire de l'exécutable. | <br><br>- Pour tous les fichiers de données de l'application : onglet "Détail" de la description de l'analyse<br><br>- Pour chaque fichier de données : onglet "Info" de la description du fichier de données.<br><br><br> | Pour modifier le répertoire par défaut des fichiers de données de l'application, utilisez la fonction [HSubstRep](../WDLang4/3044028.md).<br>Lors de la création des fichiers de la journalisation et de la réplication, les répertoires créés seront relatifs à ce nouveau répertoire. <br>**Remarque** : Pour modifier uniquement le répertoire d'un des fichiers, utilisez la fonction [HChangeRep](../WDLang4/3044168.md). |
| **Répertoire des fichiers de la réplication** | Sous-répertoire RPL du répertoire par défaut des fichiers de données. | Onglet "Journal\\Réplica" de la description de l'analyse. | Précisez le répertoire voulu dans les fonctions [HCréeRéplicaMaître](../WDLang4/3044175.md) et [HCréeRéplicaAbonné](../WDLang4/3044253.md). |
| **Répertoire des fichiers de la journalisation** | Sous-répertoire JNL du répertoire par défaut des fichiers de données. | <br><br>- Pour tous les fichiers de données de l'application : onglet "Journal\\Réplica" de la description de l'analyse.<br><br>- Pour chaque fichier de données : onglet "Divers" de la description du fichier de données.<br><br><br> | Pour modifier le répertoire des fichiers journaux, utilisez la fonction [HChangeRepJNL](../WDLang4/3044164.md). <br>Cette fonction permet :<br><br>- soit de changer le répertoire du fichier Journal (Fichier JNL)<br><br>- soit de changer le répertoire du fichier JNL et des fichiers de journalisation (fichiers JournalIdentification et JournalOpération).<br><br><br> |

**Attention** : Pour gérer la réplication journalée dans une application, la table des opérations du journal (fichier JournalOpération.fic) doit être identique pour tous les fichiers de données en réplication dans une même analyse.

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280rpl.dll
