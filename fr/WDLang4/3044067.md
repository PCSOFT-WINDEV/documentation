
## HGèreRéplication (Fonction)

***En anglais : HSetReplication***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Débranche (ou re-branche) temporairement la réplication. La réplication peut être une réplication journalée ou une réplication universelle.

Par défaut, la réplication entre des fichiers de données HFSQL est automatiquement gérée.

Lorsque la réplication est "débranchée", il est possible d'accéder à des fichiers de données HFSQL Classic sans mémoriser les informations nécessaires à la réplication. Il est ensuite nécessaire de rétablir la gestion de la réplication.

**Attention : L'usage de cette fonction est réservée aux programmeurs expérimentés. Il est déconseillé de débrancher temporairement la gestion de la réplication et d'effectuer des modifications sur les fichiers de données. En effet, des problèmes peuvent intervenir ensuite lors de la synchronisation.**

Remarque : La réplication n'est pas disponible lors de l'accès à une base de données via .

![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Seule la réplication universelle est disponible. 




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) 
```wl
// Désactive la réplication journalée
HGèreRéplication(Faux)
// Ajout d'une valeur qui ne sera pas répliquée
HAjoute(Client)
// Réactive la réplication journalée
HGèreRéplication(Vrai)
```
<a name="Exemple2"></a>



```wl
// Branche la réplication universelle
HGèreRéplication(rplRéplicationUniverselle)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) 
### Gestion de la réplication journalée entre des bases HFSQL

`<Résultat> = HGèreRéplication(<Mode de gestion>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la réplication était gérée avant l'utilisation de la fonction **HGèreRéplication**, 

- <u><u><u><u>Faux</u></u></u></u> si la réplication n'était pas gérée avant l'utilisation de la fonction **HGèreRéplication**.




**`<Mode de gestion> : (Booléen)`**



- <u><u><u><u>Faux</u></u></u></u> pour débrancher temporairement la gestion de la réplication, 

- <u><u><u><u>Vrai</u></u></u></u> pour re-brancher la gestion de la réplication.  





<a name="SYNTAXE2"></a>

### Gestion de la réplication journalée (entre des bases de données HFSQL) ou de la réplication universelle

`<Résultat> = HGèreRéplication(<Mode de gestion>)`
---

**`<Résultat> : (Constante de type entier)`**

Ancien mode de gestion de la réplication (avant la modification) :


|   |   |
| --- | --- |
| *rplRéplicationDésactivé* | La réplication n'était pas gérée avant l'utilisation de la fonction **HGèreRéplication**. |
| *rplRéplicationJournalisé* | La réplication journalée entre des fichiers de données HFSQL était gérée avant l'utilisation de la fonction **HGèreRéplication**. |
| *rplRéplicationUniverselle* | La réplication réalisée avant l'utilisation de la fonction **HGèreRéplication** était une réplication universelle (par exemple entre des fichiers de données HFSQL et des fichiers de données manipulés par un Connecteur Natif).<br>**Remarque** : par compatibilité avec les versions précédentes, la constante *rplRéplicationHétérogène* peut être utilisée. |



**`<Mode de gestion> : (Constante de type Entier)`**

Nouveau mode de gestion à utiliser :


|   |   |
| --- | --- |
| *rplRéplicationDésactivé* | Permet de désactiver temporairement la gestion de la réplication. |
| *rplRéplicationJournalisé* | Permet de réaliser une réplication journalée entre des fichiers de données HFSQL (utilise les fichiers de données HFSQL journalés). |
| *rplRéplicationUniverselle* | Permet de réaliser une réplication universelle (par exemple entre une base de données HFSQL et une base de données Oracle).<br>**Remarque** : par compatibilité avec les versions précédentes, la constante *rplRéplicationHétérogène* peut être utilisée. |







<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
La désactivation de la réplication provoque la désactivation de la journalisation. Il est possible de réactiver la journalisation grâce à la fonction [HGèreJournal](../WDLang4/3044052.md).



<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280rpl.dll
