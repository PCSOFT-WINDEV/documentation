


## &lt;Source&gt;.ChangeConnexion (Fonction)

***En anglais : &lt;Source&gt;.ChangeConnection***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Change dynamiquement la connexion associée à un fichier de données. La nouvelle connexion doit être connue et définie lors de ce changement. Cette nouvelle connexion sera utilisée lors de la prochaine ouverture du fichier de données.

Il est ainsi possible d'importer une description de tables Oracle dans l'analyse et d'utiliser cette description pour travailler sur des fichiers de données au format HFSQL. Pour voir de nombreux exemples de changements de connexion, consultez les exemples détaillés.

**Conseils** : 

- Pour manipuler les connexions, il est conseillé d'utiliser une variable de type [Connexion](../WDLang4/1514073.md).

- **Attention** : L'ordre d'utilisation des fonctions permettant de se connecter à une base de données HFSQL Client/Serveur est important. Consultez [Optimiser les temps de connexion aux bases HFSQL Client/Serveur](../WDLang4/9000176.md) pour plus de détails.





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MaConnexion est une Connexion

// Description de la connexion
MaConnexion.Utilisateur = "USER"
MaConnexion.MotDePasse = "PASSWORD"
MaConnexion.Serveur = "MONSERVEUR" 
MaConnexion.BaseDeDonnées = "Base de données"
MaConnexion.Provider = hAccèsNatifSQLServer
MaConnexion.Accès = hOLectureEcriture

// Ouverture de la connexion
MaConnexion.OuvreConnexion()

// Indiquer que "Salaires" utilise la nouvelle connexion
Salaires.ChangeConnexion(MaConnexion)

// Commencer le parcours de la table "Salaires" sur SQLServer
Salaires.LitPremier()
...
// Fermer la connexion
MaConnexion.FermeConnexion()

// Rétablir l'utilisation de la connexion sur Oracle
Salaires.ChangeConnexion("")

// Ouvrir la table "Salaires" sur Oracle
Salaires.Ouvre()
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Source>.ChangeConnexion(<Nouvelle connexion>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur.




**`<Source> : (Type correspondant à la source spécifiée)`**

Nom du fichier de données (défini dans l'analyse) pour lequel la connexion doit être changée. Ce fichier de données sera automatiquement fermé pour modifier sa connexion. 

**`<Nouvelle connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Nouvelle connexion à utiliser. Ce paramètre peut correspondre : 

- au nom de la connexion à une base de données. Cette connexion a été définie dans l'éditeur d'analyses ou décrite dynamiquement par la fonction [HDécritConnexion](../WDLang4/3044205.md). Si ce paramètre correspond à une chaîne vide (""), la connexion initiale est automatiquement utilisée.

- au nom de la variable de type [Connexion](../WDLang4/1514073.md) correspondant à la nouvelle connexion à utiliser.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- La connexion doit être connue au moment de l'exécution de la fonction **&lt;Source&gt;.ChangeConnexion**. Si le fichier de données n'est pas connu lors de l'utilisation de la fonction **&lt;Source&gt;.ChangeConnexion**, la connexion sera changée au moment de la déclaration du fichier de données.

- La fonction **&lt;Source&gt;.ChangeConnexion** réalise automatiquement la fermeture du fichier de données (fonction [&lt;Source&gt;.Ferme](../WDLang4/1000024958.md)) dont la connexion doit être modifiée.

- La fonction **&lt;Source&gt;.ChangeConnexion** n'ouvre ni le fichier de données ni la connexion. La connexion définie par la fonction **&lt;Source&gt;.ChangeConnexion** sera utilisée lors de la prochaine ouverture du fichier de données.




<a name="XComposante"></a>

## Composante :
wd280hf.dll
