


## &lt;Source&gt;.ListeLiaison (Fonction)

***En anglais : &lt;Source&gt;.ListLink***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie la liste des liaisons d'un fichier de données (de type Merise) présentes dans l'analyse en cours ou dans une analyse spécifique.

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Récupérer les liaisons du fichier de données Client de l'analyse en cours
ListeLiaison est une chaîne
ListeLiaison = Client.ListeLiaison(HLstDétail)
// Ajoute la liste des liaisons dans le champ COMBO_COMBO1
COMBO_COMBO1.Ajoute(ListeLiaison)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Lister les liaisons d'un fichier de données présent dans une analyse

`<Résultat> = <Source>.ListeLiaison([<Chemin du WDD> [, <Mot de passe du WDD>]] [, <Options>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Liste des liaisons. Les différentes descriptions de chaque liaison sont séparées par RC (Retour chariot). En fonction de la constante utilisée, le résultat est plus ou moins détaillé :


|   |   |
| --- | --- |
| *hLstDétail* non précisé | &lt;Nom Liaison1&gt; + TAB + &lt;Nom Fichier1.1&gt; + TAB + &lt;Nom Rubrique1.1&gt; + TAB + &lt;Cardinalité 1.1&gt; + TAB + &lt;Nom Fichier1.2&gt; + TAB + &lt;Nom Rubrique1.2&gt; + TAB + &lt;Cardinalité 1.2&gt; + RC + ... |
| *hLstDétail* précisé | &lt;Nom Liaison1&gt; + TAB + &lt;Nom Fichier1.1&gt; + TAB + &lt;Nom Rubrique1.1&gt; + TAB + &lt;Cardinalité 1.1&gt; + TAB + &lt;Nom Fichier1.2&gt; + TAB + &lt;Nom Rubrique1.2&gt; + TAB + &lt;Cardinalité 1.2&gt; + TAB + &lt;Règle de modification&gt; + TAB + &lt;Règle de suppression&gt; + RC + ... |


Où :

- &lt;Nom Liaison X&gt; : nom de la liaison.

- &lt;Nom Fichier x.1&gt; : Nom du fichier de données côté clé primaire.

- &lt;Nom Rubrique x.1&gt; : Nom de la rubrique côté clé primaire ou nom du fichier de données spécifié.

- &lt;Cardinalité x.1&gt; : Cardinalité de la liaison côté clé primaire, de la forme "&lt;Cardinalité min&gt;,&lt;Cardinalité max&gt;" (par exemple "0,N" ou "1,N").

- &lt;Nom Fichier x.2&gt; : Nom du fichier de données côté clé étrangère.

- &lt;Nom Rubrique x.2&gt; : Nom de la rubrique côté clé étrangère.

- &lt;Cardinalité x.2&gt; : Cardinalité de la liaison côté clé étrangère, de la forme "&lt;Cardinalité min&gt;,&lt;Cardinalité max&gt;" (par exemple "0,N" ou "1,N").

- &lt;Règle de modification&gt; : Règle à appliquer en cas de modification de la clé primaire.

- &lt;Règle de suppression&gt; : Règle à appliquer en cas de suppression de la clé primaire.


![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Le nom des fichiers de données correspond au nom de la base + '\\' + le nom physique relatif de ces fichiers de données.![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Si une des liaisons listées est réalisée sur une clé composée, le paramètre &lt;Nom Rubrique 1.2&gt; renvoyé correspondra au nom des différentes composantes de la clé. Les noms seront séparés par une virgule.

**`<Source> : (Type correspondant à la source spécifiée)`**

Nom du fichier de données dont les liaisons doivent être listées. Les liaisons partant ou arrivant à ce fichier de données sont indiquées. 

**`<Chemin du WDD> : (Chaîne de caractères optionnelle)`**

Chemin complet de l'analyse (c'est-à-dire du ficher .WDD). Si ce paramètre n'est pas précisé ou est égal à une chaîne vide (""), les liaisons sont recherchées dans l'analyse en cours.

**`<Mot de passe du WDD> : (Chaîne de caractères optionnelle)`**

Mot de passe défini pour l'analyse. Si aucun mot de passe n'est défini, ce paramètre doit être égal à une chaîne vide ("").

**`<Options> : (Constante optionnelle de type entier)`**

Type de liste à effectuer :


|   |   |
| --- | --- |
| *hLstDétail* | Liste les informations détaillées sur les liaisons. |
| *hLstNormal*<br>(valeur par défaut) | Liste les liaisons. |

![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Ce paramètre n'est pas pris en compte.


<a name="SYNTAXE2"></a>

### Lister les liaisons d'un fichier de données accessible via une connexion par Connecteur natif ou par OLE DB ou via une connexion HFSQL Client/Serveur

`<Résultat> = <Source>.ListeLiaison([<Connexion>] [, <Options>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Liste des liaisons. Les différentes descriptions de chaque liaison sont séparées par RC (Retour chariot). En fonction de la constante utilisée, le résultat est plus ou moins détaillé :


|   |   |
| --- | --- |
| *hLstDétail* non précisé | &lt;Nom Liaison1&gt; + TAB + &lt;Nom Fichier1.1&gt; + TAB + &lt;Nom Rubrique1.1&gt; + TAB + &lt;Cardinalité 1.1&gt; + TAB + &lt;Nom Fichier1.2&gt; + TAB + &lt;Nom Rubrique1.2&gt; + TAB + &lt;Cardinalité 1.2&gt; + RC + ... |
| *hLstDétail* précisé | &lt;Nom Liaison1&gt; + TAB + &lt;Nom Fichier1.1&gt; + TAB + &lt;Nom Rubrique1.1&gt; + TAB + &lt;Cardinalité 1.1&gt; + TAB + &lt;Nom Fichier1.2&gt; + TAB + &lt;Nom Rubrique1.2&gt; + TAB + &lt;Cardinalité 1.2&gt; + TAB + &lt;Règle de modification&gt; + TAB + &lt;Règle de suppression&gt; + RC + ... |


Où :

- &lt;Nom Liaison X&gt; : nom de la liaison.

- &lt;Nom fichier x.1&gt; : Nom du fichier de données côté clé primaire.

- &lt;Nom Rubrique x.1&gt; : Nom de la rubrique côté clé primaire ou nom du fichier de données spécifié.

- &lt;Cardinalité x.1&gt; : Cardinalité de la liaison côté clé primaire, de la forme "&lt;Cardinalité min&gt;,&lt;Cardinalité max&gt;" (par exemple "0,N" ou "1,N").

- &lt;Nom fichier x.2&gt; : Nom du fichier de données côté clé étrangère.

- &lt;Nom Rubrique x.2&gt; : Nom de la rubrique côté clé étrangère.

- &lt;Cardinalité x.2&gt; : Cardinalité de la liaison côté clé étrangère, de la forme "&lt;Cardinalité min&gt;,&lt;Cardinalité max&gt;" (par exemple "0,N" ou "1,N").

- &lt;Règle de modification&gt; : Règle à appliquer en cas de modification de la clé primaire (voir Remarques).

- &lt;Règle de suppression&gt; : Règle à appliquer en cas de suppression de la clé primaire (voir Remarques).


![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Le nom des fichiers de données correspond au nom de la base + '\\' + le nom physique relatif de ces fichiers de données.![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Si une des liaisons listées est réalisée sur une clé composée, le paramètre &lt;Nom Rubrique 1.2&gt; renvoyé correspondra au nom des différentes composantes de la clé. Les noms seront séparés par une virgule.

**`<Source> : (Type correspondant à la source spécifiée)`**

Nom du fichier de données dont les liaisons doivent être listées. Les liaisons partant ou arrivant à ce fichier de données sont indiquées. 

**`<Connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion à manipuler. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [&lt;Variable Connexion&gt;.OuvreConnexion](../WDLang4/1000023962.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).




**`<Options> : (Constante optionnelle de type entier)`**

Type de liste à effectuer :


|   |   |
| --- | --- |
| *hLstDétail* | Liste les informations détaillées sur les liaisons. |
| *hLstNormal*<br>(valeur par défaut) | Liste les liaisons. |

![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Ce paramètre n'est pas pris en compte.





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Affichage du résultat dans un champ Liste ou un champ Combo
<a name="affichage_resultat_dans_champ_liste_champ_combo_ELTPARAGRAPHE000373"></a>&lt;Résultat&gt; peut être directement affecté à un champ Liste ou un champ Combo grâce à la fonction [&lt;Liste&gt;.Ajoute](../WDLang1/1000017319.md). Chaque ligne contiendra le nom complet d'une des liaisons trouvées.
<a name="NOTE0_2"></a>


### Règle de suppression et de modification
<a name="regle_suppression_modification_ELTPARAGRAPHE000388"></a>Les règles de modification et de suppression renvoyées par la fonction **&lt;Source&gt;.ListeLiaison** peuvent correspondre aux constantes suivantes :


|   |   |
| --- | --- |
| *hIntégritéAucune* | Aucune contrainte d'intégrité. |
| *hIntégritéCascade* | Gestion de la modification et de la suppression en cascade. |
| *hIntégritéInterdite* | Respect strict de l'intégrité. |
| *hIntégritéValeurDéfaut* | Lors de la suppression, rattachement des enregistrements liés à une valeur par défaut. |



<a name="XComposante"></a>

## Composante :
wd280hf.dll
