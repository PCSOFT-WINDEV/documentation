
## Les vues HFSQL 
			

<DIV class="specObsolete">
	<IMG style="float:left;margin-right:10px;" src="https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=warning_big.png"><B>Avertissement</B><BR>
	A partir de la version <B>20</B>,  les [vues SQL](../WDLang4/9000157.md) et les [vues matérialisées](../WDLang4/9000159.md) sont disponibles. Cette page d'aide est conservée par compatibilité.
</DIV><a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Qu'est-ce qu'une vue ?
<a name="questce_quune_vue_ELTTEXTE000150"></a>
Une vue HFSQL correspond à une "image mémoire" de tout ou partie d'un fichier de données HFSQL.

Une vue est stockée en mémoire, ce qui la rend insensible aux modifications effectuées sur le fichier de données associé.

Une fois créée, une vue se manipule comme un fichier de données HFSQL.







<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Fonctions de gestion des vues
<a name="fonctions_gestion_des_vues_ELTTEXTE000180"></a>


### Les fonctions du WLangage
<a name="les_fonctions_wlangage_ELTPARAGRAPHE000042"></a>Les fonctions suivantes permettent de manipuler les vues HFSQL :



|   |   |
| --- | --- |
| [HCréeVue](../WDLang4/3044159.md) | Crée une vue HFSQL. <br>Cette fonction utilise l'ancien mécanisme des vues. |
| [HDétruitVue](../WDLang4/3044091.md) | Détruit une vue précédemment créée. Cette fonction utilise l'ancien mécanisme des vues. |
| [HExécuteVue](../WDLang4/3044079.md) | Exécute une vue créée auparavant (permet par exemple de réactualiser les données de la vue). Cette fonction utilise l'ancien mécanisme des vues. |
| [HFusionneVue](../WDLang4/3044124.md) | Crée une vue HFSQL à partir de deux vues précédemment créées (fonction [HCréeVue](../WDLang4/3044159.md)). Cette fonction utilise l'ancien mécanisme des vues. |
| [HTrieVue](../WDLang4/3044114.md) | Trie une vue HFSQL en créant un index sur une rubrique de la vue. Cette fonction utilise l'ancien mécanisme des vues. |
| [HVueVersFichier](../WDLang4/3044021.md) | Enregistre les modifications réalisées dans une vue HFSQL (grâce aux fonctions [HModifie](../WDLang4/3044042.md), [HSupprime](../WDLang4/3044018.md) ou [HRaye](../WDLang4/3044121.md)) dans le fichier de données correspondant. Cette fonction utilise l'ancien mécanisme des vues. |





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Utilisation
<a name="utilisation_ELTTEXTE000262"></a>


### Manipuler une vue
<a name="manipuler_une_vue_ELTPARAGRAPHE000052"></a>Pour manipuler une vue sur un fichier de données HFSQL, les opérations à effectuer sont les suivantes :

1. Création de la vue avec la fonction [HCréeVue](../WDLang4/3044159.md) (en spécifiant si nécessaire des conditions de sélection).

2. La vue est automatiquement exécutée. Les enregistrements de la vue peuvent être manipulés, parcourus, ... avec les fonctions de gestion HFSQL. Le nom du fichier spécifié dans les fonctions correspondra au nom de la vue.

3. Opérations spécifiques aux vues possibles :

	- Si les enregistrements du fichier de base de la vue ont été modifiés, il est possible de **ré-actualiser la vue** en la ré-exécutant (fonction [HExécuteVue](../WDLang4/3044079.md)). Il sera alors possible de préciser de nouveaux critères de sélection.

	- **Modifier l'ordre de tri des enregistrements de la vue**. Par défaut, les enregistrements d'une vue sont triés dans le même ordre que celui utilisé dans le fichier HFSQL correspondant. Cependant, il est possible de modifier cet ordre grâce à la fonction [HTrieVue](../WDLang4/3044114.md). Si le tri est appliqué sur plusieurs rubriques de la vue, le tri est appliqué d'abord selon la première rubrique de tri, puis selon la seconde, etc.

	- **Reporter les manipulations effectuées sur les enregistrements de la vue** (ajouts, modifications, suppression, ...) sur le fichier de base de la vue (fonction [HVueVersFichier](../WDLang4/3044021.md)). Attention : cette opération ne pourra être effectuée que si les enregistrements ont été bloqués dans le fichier lors de la création de la vue.

	- **Fusionner plusieurs vues** (fonction [HFusionneVue](../WDLang4/3044124.md)). La fusion de deux vues permet de créer une nouvelle vue avec les données contenues dans les vues "sources". Cette vue sera ensuite manipulable comme une vue standard. La fonction [HFusionneVue](../WDLang4/3044124.md) propose plusieurs modes de fusion :

		- Union de toutes les lignes de la première vue et de la seconde vue.
						**Attention** : Les structures des vues doivent être identiques.

		- Union de toutes les lignes non communes de la première vue et de la seconde vue.
						**Attention** : Les structures des vues doivent être identiques.

		- Sélection des lignes communes à la première vue et à la seconde vue.

		- Sélection des lignes de la première vue sans les lignes communes de la seconde vue.

		- Fusion des deux vues avec interruption. La création de la vue est interruptible au moyen de la touche [ECHAP].

		- Jointure de la première vue et de la seconde vue. Les rubriques de la seconde vue qui n'existent pas dans la première vue et inversement sont ajoutées dans la vue destination




4. Destruction de la vue (fonction [HDétruitVue](../WDLang4/3044091.md)). La destruction d'une vue consiste à détruire tout ce qui concerne la vue, y compris sa description. Lors de cette destruction, les enregistrements bloqués par la vue (s'ils existent) sont débloqués.







