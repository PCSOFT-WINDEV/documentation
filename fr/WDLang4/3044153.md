


## HBloqueFichier (Fonction)

***En anglais : HLockFile***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Bloque un fichier de données et restreint l'accès à ce fichier de données pour tous les autres sites ou applications. Le fichier de données pourra ensuite être débloqué grâce à la fonction [HDébloqueFichier](../WDLang4/3044160.md).

Après l'exécution de la fonction **HBloqueFichier**, plusieurs cas peuvent se présenter :

- Un enregistrement du fichier de données est déjà bloqué par une autre application : le blocage ne peut pas être effectué.

- Le fichier de données est déjà bloqué par une autre application : le blocage ne peut pas être effectué.




Lors d'un problème de blocage, la fonction [HErreurBlocage](../WDLang4/3044099.md) renvoie <u><u><u>Vrai</u></u></u>.

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette fonction peut être utilisée avec des fichiers de données HFSQL Client/Serveur.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Blocage du fichier de données CLIENT
SI HBloqueFichier(CLIENT, HBlocageLectureEcriture) = Faux ALORS
	SI HErreurBlocage() = Vrai ALORS
		Erreur("Opération impossible")
	FIN
FIN
// Traitement sur le fichier de données ...
...
// Redonner l'accès au fichier de données
HDébloqueFichier()
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HBloqueFichier([<Fichier de données> [, <Blocage>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le blocage a été réalisé, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème (par exemple le fichier est déjà bloqué, ...). La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données manipulé. 
Si ce nom n'est pas spécifié, la fonction **HBloqueFichier** va manipuler le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Blocage> : (Constante optionnelle de type entier)`**

Permet de déterminer le type de blocage effectué sur le fichier de données :



|   |   |
| --- | --- |
| *hBlocageEcriture*<br>(valeur par défaut) | Blocage en écriture : les enregistrements du fichier de données pourront être lus par une autre application mais ne pourront pas être modifiés par une autre application. Aucun blocage sur le fichier de données ne pourra être défini par une autre application. |
| *hBlocageLectureEcriture* | Blocage en lecture/écriture : les enregistrements du fichier de données ne pourront ni être lus ni être modifiés par une autre application. Aucun blocage sur le fichier de données ne pourra être défini par une autre application. |
| *hBlocageNon* | Aucun effet |


![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Le paramètre &lt;Blocage&gt; n'est pas pris en compte.![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La gestion des blocages est réalisée uniquement sur les fichiers de données HFSQL Client/Serveur.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Modification du type de blocage sur un fichier de données
<a name="modification_type_blocage_sur_fichier_donnees_ELTPARAGRAPHE000155"></a>Pour modifier le type de blocage d'un fichier de données, appelez la fonction **HBloqueFichier** avec le type de blocage souhaité. Il n'est pas nécessaire de débloquer le fichier de données au préalable.
<a name="NOTE0_2"></a>


### Influence du mode de blocage
<a name="influence_mode_blocage_ELTPARAGRAPHE000167"></a>Si le fichier de données est en mode de blocage *hModeMono* (voir la fonction [HMode](../WDLang4/3044039.md)), la fonction **HBloqueFichier** n'a aucun effet.
<a name="NOTE0_3"></a>


### Échec du blocage
<a name="echec_blocage_ELTPARAGRAPHE000182"></a>Si le fichier de données (ou un de ses enregistrements) est déjà bloqué, la demande de blocage est répétée [H.NbEssais](../WDLang4/3044075.md) fois (50 par défaut).

Si au bout des ***H.NbEssais*** tentatives le fichier de données ne peut être bloqué, la fonction [HErreurBlocage](../WDLang4/3044099.md) renvoie <u><u><u><u>Vrai</u></u></u></u>.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
