


## &lt;Source&gt;.Etat (Fonction)

***En anglais : &lt;Source&gt;.State***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet de connaître l'état d'un enregistrement. Un enregistrement peut être actif, rayé ou supprimé.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
SI Client.Etat() = hEtatActif ALORS
	// Traitements
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Source>.Etat([<Numéro d'enregistrement>])`
---

**`<Résultat> : (Constante de type Entier)`**

Etat de l'enregistrement : 


|   |   |
| --- | --- |
| *hEtatActif* | L'enregistrement est actif. |
| *hEtatInvalide* | État de l'enregistrement non trouvé (erreur). |
| *hEtatRaye* | L'enregistrement est rayé. |
| *hEtatSup* | L'enregistrement est supprimé. |



**`<Source> : (Type correspondant à la source spécifiée)`**

Nom du fichier de données utilisé. 

**`<Numéro d'enregistrement> : (Entier optionnel)`**

Numéro de l'enregistrement recherché. Si ce numéro n'est pas spécifié (ou est égal à 0), la fonction **&lt;Source&gt;.Etat** va manipuler l'enregistrement en cours. L'enregistrement en cours n'est pas relu.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Numéro d'enregistrement non précisé
<a name="numero_enregistrement_non_precise_ELTPARAGRAPHE000250"></a>Si le paramètre &lt;Numéro d'enregistrement&gt; n'est pas précisé, la fonction **&lt;Source&gt;.Etat** ne réalise pas de lecture de l'enregistrement.

Dans une application réseau, il est conseillé de relire l'enregistrement avant l'appel de la fonction **&lt;Source&gt;.Etat** afin de vérifier que l'enregistrement n'a pas été supprimé. Par exemple avec la fonction [&lt;Source&gt;.Lit](../WDLang4/1000025019.md) :

```wl
NomFichier.Lit(hNumEnrEnCours)
```

<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) 

### Fichiers de données au format 5.5
<a name="fichiers_donnees_format_55_ELTPARAGRAPHE000281"></a>En utilisant le moteur Hyper File 5, il faut relire l'enregistrement pour avoir un état à jour. En effet, si l'enregistrement n'est pas relu après par exemple les fonctions [&lt;Source&gt;.Supprime](../WDLang4/1000025071.md) ou [&lt;Source&gt;.Raye](../WDLang4/1000025051.md), la fonction **&lt;Source&gt;.Etat** renvoie toujours *hEtatActif*.

Ce fonctionnement n'est pas préservé dans le moteur HFSQL Classic. Après l'utilisation des fonctions [&lt;Source&gt;.Supprime](../WDLang4/1000025071.md) ou [&lt;Source&gt;.Raye](../WDLang4/1000025051.md) sur l'enregistrement en cours, la fonction **&lt;Source&gt;.Etat** renvoie l'état en cours de l'enregistrement.
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Fichiers xBase
<a name="fichiers_xbase_ELTPARAGRAPHE000321"></a>La fonction [&lt;Source&gt;.Supprime](../WDLang4/1000025071.md) a le même effet que la fonction [&lt;Source&gt;.Raye](../WDLang4/1000025051.md) : l'enregistrement est rayé et non supprimé. L'enregistrement peut donc être réactivé par la fonction [&lt;Source&gt;.Modifie](../WDLang4/1000025038.md). 

Dans ce cas, la fonction **&lt;Source&gt;.Etat** renvoie la constante *hEtatRaye* sur un enregistrement supprimé (et non la constante *hEtatSup*).

<a name="XComposante"></a>

## Composante :
wd280hf.dll
