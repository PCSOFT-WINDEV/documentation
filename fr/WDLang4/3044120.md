


## HOuvre (Fonction)

***En anglais : HOpen***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ouvre un fichier de données.

**Remarque** : L'ouverture des fichiers de données est automatiquement gérée. Cependant, dans certains cas, il est nécessaire d'ouvrir explicitement un fichier de données (par exemple pour tester l'existence du fichier de données ou la validité du mot de passe).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ouvre le fichier de données Client
HOuvre(Client)
```
<a name="Exemple2"></a>

```wl
// Ouvre tous les fichiers de données avec le mot de passe "PSW"
HOuvre("*", "PSW")
```
<a name="Exemple3"></a>

```wl
// Test du compte-rendu de la fonction HOuvre
SI HOuvre(Client, "ABCD", hOLecture) = Faux ALORS
	Erreur("Impossible d'ouvrir le fichier de données Client" + HErreurInfo())
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HOuvre([<Fichier de données> [, <Mot de passe>] [, <Mode d'accès>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le fichier de données a été ouvert.

- <u><u><u><u>Faux</u></u></u></u> en cas de problème (mot de passe incorrect, ...). La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'obtenir plus de détails.




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données manipulé (nom logique, défini dans l'analyse). 
Si ce nom n'est pas spécifié, la fonction **HOuvre** va manipuler le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).
Si ce paramètre correspond à "\*", tous les fichiers de données décrits dans l'analyse sont ouverts. Si le mot de passe est précisé, ce mot de passe sera utilisé pour ouvrir tous les fichiers de données. 
Ce paramètre peut également correspondre au nom d'un [groupe de fichiers (ou perso-dossier) défini dans l'analyse](../Editeurs/2011003.md) (non disponible en Android et Android Widget). Si le mot de passe est précisé, ce mot de passe sera utilisé pour ouvrir tous les fichiers de données du groupe. 
Attention : ce paramètre ne peut pas correspondre à une variable de type [Description de fichier](../WDLang4/1514065.md).

**`<Mot de passe> : (Chaîne de caractères optionnelle)`**

Mot de passe du fichier de données. 
Si aucun mot de passe n'est associé au fichier de données, il est possible d'utiliser une chaîne vide ("").

**`<Mode d'accès> : (Constante de type entier optionnelle)`**

Paramètre le mode d'accès au fichier de données. 
Si ce paramètre n'est pas spécifié, le fichier de données sera ouvert selon ses caractéristiques (si le fichier de données est en lecture seule, il sera ouvert en lecture; si le fichier de données est en lecture/écriture, il sera ouvert en mode lecture/écriture).


|   |   |
| --- | --- |
| *HOLecture* | Le fichier de données est accessible uniquement en lecture. Seule la lecture des enregistrements est possible. Il n'est pas possible d'en ajouter ou d'en supprimer. |
| *HOLectureEcriture* | Le fichier de données est accessible en lecture et en écriture. Il est possible aussi bien de lire des enregistrements que d'écrire de nouveaux enregistrements. |


![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Ce paramètre n'est pas pris en compte.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Gestion du mot de passe
<a name="gestion_mot_passe_ELTPARAGRAPHE000159"></a>Le mot de passe peut être précisé :

- soit directement à l'ouverture du fichier de données avec la fonction **HOuvre**,

- soit avant l'ouverture du fichier de données grâce à la fonction [HPasse](../WDLang4/3044108.md).



<a name="NOTE0_2"></a>


### Création ou ouverture d'un fichier de données
<a name="creation_ouverture_fichier_donnees_ELTPARAGRAPHE000177"></a>La fonction [HCréationSiInexistant](../WDLang4/3044254.md) peut remplacer la fonction **HOuvre**. En effet, si le fichier de données existe, il est automatiquement ouvert.
<a name="NOTE0_3"></a>


### Ouverture d'un fichier de données déjà ouvert
<a name="ouverture_fichier_donnees_deja_ouvert_ELTPARAGRAPHE000192"></a>Si la fonction **HOuvre** est utilisée sur un fichier de données déjà ouvert avec un &lt;Mode d'accès&gt; différent, les filtres, les blocages et les caractéristiques du parcours en cours sont perdus.
<a name="NOTE0_4"></a>


### Gestion de la liste des fichiers de données manipulées (.REP)
<a name="gestion_liste_des_fichiers_donnees_manipulees_rep_ELTPARAGRAPHE000204"></a>WINDEV Mobile permet de mettre à jour une liste des fichiers de données manipulés par l'application (équivalent au fichier .REP sous WINDEV standard).

La fonction **HOuvre** renseigne la liste des fichiers de données manipulés par l'application (.REP pour WINDEV et WEBDEV) si la mise à jour de cette liste est activée.

Pour plus de détails, consultez [Liste des fichiers de données manipulés par une application](../WDLang4/3044045.md).
<a name="NOTE0_5"></a>


### Gestion des erreurs fatales
<a name="gestion_des_erreurs_fatales_ELTPARAGRAPHE000223"></a>En cas d'erreur fatale lors de l'ouverture d'un fichier de données, il peut être intéressant de continuer le programme en traitant l'erreur rencontrée. Pour cela, il est conseillé de faire le traitement d'exception suivant :

```wl
QUAND EXCEPTION DANS
	HOuvre(PERE)
FAIRE
	Erreur("Erreur HFSQL : " + HErreur())
SINON
	Trace("Fichier ouvert")
FIN
```

<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Langage Externe](https://doc.pcsoft.fr/ext/images/fr/LE.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Ouverture d'une connexion et de la table spécifiée
<a name="ouverture_une_connexion_table_specifiee_ELTPARAGRAPHE000243"></a>La fonction **HOuvre** ouvre si nécessaire la connexion sur la base de données avant d'ouvrir la table spécifiée. Si la connexion est déjà ouverte (avec les mêmes paramètres), cette connexion est automatiquement utilisée.

Remarque : La connexion utilisée par défaut correspond à la connexion associée à la table sous l'éditeur d'analyses.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
