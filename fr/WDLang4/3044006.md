


## HNbEnr (Fonction)

***En anglais : HNbRec***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie le nombre d'enregistrements d'un fichier de données, d'une requête ou d'une vue HFSQL : enregistrements actifs, rayés, supprimés, etc.

**Attention** : La fonction **HNbEnr** ne tient pas compte du filtre en cours.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003044006&name=hnbenr_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Enregistrements actifs du fichier de données "Client"
NbEnrClient = HNbEnr(Client)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HNbEnr([<Fichier de données> [, <Options>]])`
---

**`<Résultat> : (Entier)`**



- Nombre d'enregistrements recherchés, 

- -1 en cas d'erreur. La fonction [HErreur](../WDLang4/3044088.md) permet d'obtenir plus d'informations sur le problème rencontré.


![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) **Connecteur Natif XML** : le nombre d'enregistrements dépend de l'utilisation des fonctions [HActiveFiltreAuto](../WDLang4/3044297.md)/[HDésactiveFiltreAuto](../WDLang4/3044298.md) :

- Si le filtrage est actif, seuls les enregistrements appartenant au père courant sont pris en compte.

- Si le filtrage est non actif, les enregistrements présents dans le fichier XML sont pris en compte.




Par défaut, le filtrage est actif.

**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données, de la vue HFSQL ou de la requête manipulé. Si ce paramètre n'est pas spécifié, la fonction **HNbEnr** va manipuler le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Options> : (Constante ou combinaison de constantes optionnelle)`**

Paramètre le type d'enregistrement à compter.


|   |   |
| --- | --- |
| *hEtatActif*<br>(valeur par défaut) | Nombre d'enregistrements actifs (non rayés, non supprimés). |
| *hEtatRayé* | Nombre d'enregistrements rayés.<br><br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette option n'est pas disponible. |
| *hEtatSup* | Nombre d'enregistrements supprimés (n'inclut pas les enregistrements rayés). |
| *hEtatTous* | Nombre total des enregistrements du fichier de données (*hEtatActif*+ *hEtatRaye*+ *hEtatSup*). |
| *hNonBloquant* | Nombre d'enregistrements récupérés de la vue ou de la requête sans attendre la fin du remplissage de la vue ou de la requête. Il est possible de savoir si l'exécution de la vue ou de la requête est terminée grâce à la propriété [ExécutionTerminée](../Proprietes/2512117.md).<br>Cette constante est disponible uniquement pour les vues et les requêtes HFSQL Classic ou Client/Serveur.<br>Cette constante est sans effet sur les fichiers de données ou pour les Connecteurs Natifs. |
| *hParcourableNonBloquant* | Nombre d'enregistrements de la vue ou de la requête actuellement parcourables (pas de blocage des enregistrements). <br>Cette constante est disponible uniquement pour les vues et les requêtes HFSQL Classic ou Client/Serveur.<br>Cette constante est sans effet sur les fichiers de données ou pour les Connecteurs Natifs.<br><br> |


![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Ce paramètre est ignoré. Le nombre d'enregistrements calculé par la fonction **HNbEnr** correspond toujours au nombre total d'enregistrements dans la table, sur la base de données.

Ce nombre peut être différent du nombre d'enregistrements affichés si un autre utilisateur a ajouté ou supprimé des enregistrements. Pour visualiser ces nouveaux enregistrements, réinitialisez un parcours en utilisant une des fonctions suivantes : [HLitPremier](../WDLang4/3044051.md), [HLitDernier](../WDLang4/3044140.md), [HPremier](../WDLang4/3044113.md), [HDernier](../WDLang4/3044101.md).![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) **Accès par JDBC**
 
Ce paramètre est ignoré. Le nombre d'enregistrements calculé par la fonction **HNbEnr** correspond toujours au nombre total d'enregistrements dans la table, sur la base de données.
Ce nombre peut être différent du nombre d'enregistrements affichés si un autre utilisateur a ajouté ou supprimé des enregistrements. Pour visualiser ces nouveaux enregistrements, réinitialisez un parcours en utilisant une des fonctions suivantes : [HLitPremier](../WDLang4/3044051.md), [HLitDernier](../WDLang4/3044140.md), [HPremier](../WDLang4/3044113.md), [HDernier](../WDLang4/3044101.md).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Limitations
<a name="limitations_ELTPARAGRAPHE000206"></a>

- La fonction **HNbEnr** ne retourne pas le nombre d'enregistrements modifiés suite à l'exécution d'une requête en modification (UPDATE).

- La fonction **HNbEnr** ne fonctionne pas avec les requêtes utilisant la constante *hAvecFiltre*.



<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Langage Externe](https://doc.pcsoft.fr/ext/images/fr/LE.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### xBase
<a name="xbase_ELTPARAGRAPHE000224"></a>La fonction **HNbEnr** utilisée avec la constante *hEtatActif* ou *hEtatTous* renvoie également le nombre d'enregistrements rayés (ou supprimés) (compatibilité avec les versions antérieures).

Par contre, il est possible de connaître le nombre d'enregistrements rayés ou supprimés par grâce à la fonction **HNbEnr** utilisée avec la constante *hEtatSup* ou *hEtatRayé*.
<a name="NOTE0_3"></a>


### Nombre d'enregistrements traités par les mises à jour de type INSERT/UPDATE/DELETE
<a name="nombre_enregistrements_traites_par_les_mises_jour_type_insertupdatedelete_ELTPARAGRAPHE000243"></a>

**Lors de l'exécution d'une requête de type INSERT/UPDATE/DELETE sur des fichiers de données HFSQL**, il est possible de connaître  le nombre d'enregistrements ayant été ajoutés, modifiés ou supprimés grâce à la variable [H.NbEnregRequêteModification](../WDLang4/3087002.md).

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
