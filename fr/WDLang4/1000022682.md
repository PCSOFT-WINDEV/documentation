


## &lt;Variable Connexion&gt;.InfoServeur (Fonction)

***En anglais : &lt;Connection variable&gt;.InfoServer***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie l'information spécifiée à propos du poste serveur. Le poste serveur correspond au poste sur lequel la connexion est effectuée.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Description de la connexion
MaConnexion est une Connexion

Trace(MaConnexion.InfoServeur(hInfoMatériel))
// Renvoie "Intel Pentium" + TAB + "639Mo" + RC
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Connexion>.InfoServeur([<Type d'information>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Information demandée.  Si plusieurs types d'informations sont demandés, chaque type d'information est séparé par un Retour Chariot (RC).

L'ordre dans lequel sont renvoyées les informations (si elles sont demandées) est le suivant :

*hInfoVI* + *hInfoVersion* + *hInfoPlateforme*+ *hInfoMatériel* + *hInfoNom* + *hInfoNomLogique* + *hInfoDate*

**`<Connexion> : (Variable de type Connexion)`**

Nom de la variable de type [Connexion](../WDLang4/1514073.md) décrivant la connexion pour laquelle les renseignements concernant le poste serveur doivent être récupérés.

**`<Type d'information> : (Constante ou combinaison de constantes optionnelle)`**

Type d'information demandé. Le résultat renvoyé varie en fonction du type d'information demandée.


|   |   |
| --- | --- |
| *hInfoCluster* | Informations sur le cluster HFSQL Client/Serveur sous la forme : <br> &lt;Nom du Cluster Manager&gt; + RC + &lt;Liste des noeuds du cluster&gt;. <br><br>La liste des noeuds du cluster est de la forme : <br>&lt;Nom du Cluster &gt; + TAB + &lt;Etat du noeud&gt; + TAB + &lt;Version&gt;. <br>Les états du noeud peuvent être :<br><br>- 0 : Noeud ne faisant pas partie du cluster.<br><br>- 1 : Noeud arrêté.<br><br>- 2 : Noeud en attente de démarrage.<br><br>- 3 : Noeud en cours de démarrage<br><br>- 4 : Noeud en attente de source de synchronisation.<br><br>- 5 : Noeud en cours de synchronisation.<br><br>- 6 : Noeud actif.<br><br>- 7 : Noeud en cours d'arrêt.<br><br>- 8 : Etat inconnu.<br><br><br> |
| *hInfoDate* | Date et heure du serveur sur 8 octets au format UTC (temps universel). Cette information est une chaîne de caractères du type "AAAAMMJJHHmmSS". |
| *hInfoEspaceLibreDisque* | Espace libre sur le disque du serveur, exprimé en octet. |
| *hInfoEspaceTotalDisque* | Capacité totale du disque du serveur, exprimée en octet. |
| *hInfoMatériel* | Informations sur le matériel utilisé :<br><br>- Type de processeur (exemple : Intel Pentium).<br><br>- Taille de la RAM du serveur (exemple : 630Mo)<br><br><br>Cette information est renvoyée sous la forme :<br>&lt;Type de CPU&gt; + TAB + &lt;Taille de la RAM du serveur&gt; |
| *hInfoNom* | Nom du serveur (DNS) |
| *hInfoNomLogique* | Nom du serveur donné dans le fichier HFConf.ini ou spécifié lors de l'installation. Ce nom apparaît dans le Centre de Contrôle HFSQL. |
| *hInfoPlateforme* | Informations sur la plateforme du serveur :<br><br>- Nom du système d'exploitation : <br><br>	- Windows Windows Vista, Windows Vista (64 bits), Windows 7, Windows 8, Windows 8.1, Windows 10, Windows 2008, Windows 2008 R2, Windows 2012, Windows 2012 R2.<br><br>	- LINUX suivi du nom de la distribution. Par exemple : "LINUX Ubuntu 14"<br><br><br><br><br>- Version du système : correspond au Service Pack sous Windows ou chaîne vide si aucun Service Pack n'est installé. Sous Linux, il s'agit de la version du noyau de Linux (par exemple 2.4.20-8).<br><br><br>Cette information est renvoyée sous la forme :<br>&lt;Nom du système&gt; + TAB + &lt;Version&gt; |
| *hInfoTailleCacheNdxUtilisée* | Taille du cache des index réellement utilisée sur le serveur, exprimée en Mo. |
| *hInfoTout*<br>(Valeur par défaut) | Informations complètes sur le serveur (correspond à la combinaison *hInfoVI* + *hInfoVersion* + *hInfoPlateforme* + *hInfoMatériel* + *hInfoNom* + *hInfoNomLogique* + *hInfoDate*).<br>Les différentes valeurs renvoyées sont séparées par des RC (Retour Chariot). |
| *hInfoVersion* | Informations sur la version des programmes nécessaires au fonctionnement du serveur :<br><br>- Version de Manta.exe ou Manta sous Linux<br><br>- Version du moteur HFSQL (WDHFsrv.dll ou WDHFsrv.so sous Linux)<br><br>- Version du moteur SQL (WDSQLsrv.dll ou WDSQLsrv.so sous Linux)<br><br>- Version du gestionnaire de log (HFLogger.exe)<br><br>- Version du Framework<br><br>- 32/64<br><br><br>Cette information est renvoyée sous la forme :<br>&lt;Version Manta&gt; + TAB + &lt;Version HFSQL&gt; + TAB + &lt;Version SQL&gt; + TAB + &lt;Version Log&gt; + TAB + &lt;Version Framework&gt; + TAB + &lt;32/64&gt; |
| *hInfoVersionDétail* | Informations détaillées sur la version des programmes nécessaires au fonctionnement du serveur :<br>&lt;Nom du programme&gt; + TAB + &lt;Numéro de version&gt; + TAB + &lt;Numéro de version interne&gt; + TAB + &lt;Date du fichier&gt;<br>Les éléments listés sont les suivants :<br><br>- Manta.exe ou Manta sous Linux<br><br>- Moteur HFSQL (WDHFsrv.dll ou WDHFsrv.so sous Linux)<br><br>- Moteur SQL (WDSQLsrv.dll ou WDSQLsrv.so sous Linux)<br><br>- Gestion des log (HFLogger.exe)<br><br>- MantaManager<br><br>- le framework nécessaire au fonctionnement du serveur.<br><br><br>Cette information est renvoyée sous la forme :<br>&lt;Nom du programme&gt; + TAB + &lt;Numéro de version&gt; + TAB + &lt;Numéro de version interne&gt; + TAB + &lt;Date du fichier&gt; + TAB + &lt;Heure du fichier&gt; |
| *hInfoVI* | Numéro de version du fichier Manta.exe ou Manta sous Linux. |





<a name="NOTE0"></a>
<a name="XComposante"></a>

## Composante :
wd280hf.dll
