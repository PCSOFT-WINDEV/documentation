


## HEnregistrementVersXML (Fonction)

***En anglais : HRecordToXML***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère la structure et la valeur de l'enregistrement en cours et les exporte dans une chaîne de caractères au format XML.

**Remarque** : Cette fonction est utilisable aussi bien sur les fichiers de données que sur les requêtes.



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Exporte l'enregistrement en cours du dernier fichier de données utilisé
sXML est une chaîne = HEnregistrementVersXML()
```
<a name="Exemple2"></a>

```wl
// Exporte l'enregistrement en cours du fichier de données "Client"
sXML est une chaîne 
sXML = HEnregistrementVersXML(Client)
```
<a name="Exemple3"></a>

```wl
// Exporte l'enregistrement en cours du fichier de données "Client"
// Remarque : seules les rubriques NOM et NUMERO sont prises en compte
sXML est une chaîne 
sXML = HEnregistrementVersXML(Client, "NOM,NUMERO")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HEnregistrementVersXML([<Fichier de données> [, <Liste des rubriques> [, <Alphabet>]]])`
---

**`<Résultat> : (Chaîne de caractères Ansi)`**

Structure et valeur de l'enregistrement en cours au format XML. Cette structure est représentée sous la forme :

```xml
<FICHIER>
	<RUBRIQUE1> donnée de la rubrique 1 </RUBRIQUE1>
	<RUBRIQUE2> donnée de la rubrique 2 </RUBRIQUE2>
	<RUBRIQUE3> donnée de la rubrique 3 </RUBRIQUE3>
...
</FICHIER>
```


**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données HFSQL manipulé ou de la requête manipulée. Si ce paramètre n'est pas précisé, le dernier fichier de données HFSQL utilisé sera pris en compte.

**`<Liste des rubriques> : (Chaîne de caractères optionnelle)`**

Nom des rubriques à exporter. 
Si plusieurs rubriques sont spécifiées, le nom des rubriques doit être séparé par une virgule. 
Les rubriques de type clé composée, mémo binaire ou binaire sont ignorées. 
Si ce paramètre n'est pas précisé ou correspond à une chaîne vide (""), toutes les rubriques sont exportées (sauf les rubriques de type clé composée, mémo binaire ou binaire) dans l'ordre physique de description.

**`<Alphabet> : (Constante de type Entier)`**

Alphabet à utiliser pour la génération du fichier XML :


|   |   |
| --- | --- |
| *alphabetAnsi* | Caractères romains à la norme ANSI |
| *alphabetArabe* | Caractères arabes |
| *alphabetBalte* | Caractères baltes |
| *alphabetChinois* | Caractères chinois (République Populaire de Chine) |
| *alphabetChinoisTraditionnel* | Caractères chinois traditionnel (République de Taïwan) |
| *alphabetCoréen* | Caractères coréens |
| *alphabetDéfaut* | Utilise l'alphabet par défaut du poste. Aucun alphabet n'est forcé. |
| *alphabetEuropeEst* | Caractères d'europe de l'est (polonais, ...) |
| *alphabetGrec* | Caractères grecs |
| *alphabetHébreu* | Caractères hébreux |
| *alphabetJaponais* | Caractères japonais |
| *alphabetOccidental* | Caractères romains à la norme ANSI |
| *alphabetRusse* | Caractères russes |
| *alphabetThaï* | Caractères thaï |
| *alphabetTurc* | Caractères turques |
| *alphabetUTF8* | Permet de gérer les pays pouvant utiliser deux alphabets (Hong Kong) et les pays n'ayant pas d'alphabet défini dans Windows (Géorgien et Arménien). |
| *alphabetVietnamien* | Caractères vietnamiens |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Rubriques tableau
<a name="rubriques_tableau_ELTPARAGRAPHE000174"></a>Si une des rubriques exportées est une rubrique de type tableau, chaque élément de la rubrique tableau est exporté dans un nouveau niveau :

```xml
<FICHIER>
	<RUB1> donnée de la rubrique 1 </RUB1>
	<RUB2> donnée de la rubrique 2 </RUB2>
	<RUBTAB>
		<RUBTAB_1> donnée de l'élément 1 </RUBTAB_1>
		<RUBTAB_2> donnée de l'élément 2 </RUBTAB_2>
		<RUBTAB_3> donnée de l'élément 3 </RUBTAB_3>
	</RUBTAB>
...
</FICHIER>
```

**Rappel** : Les rubriques de type clé composée, mémo binaire ou binaire sont ignorées.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
