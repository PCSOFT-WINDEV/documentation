


## HFerme (Fonction)

***En anglais : HClose***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ferme soit un fichier de données, soit tous les fichiers de données ouverts par l'utilisateur en cours : tous les fichiers de données physiques correspondant sont fermés pour l'utilisateur en cours. Pour des fichiers de données HFSQL, les fichiers fermés sont :

- le fichier de données (.FIC),

- le fichier d'index (.NDX) s'il existe,

- le fichier Mémo (.MMO) s'il existe.

- le fichier d'index full-text (.FTX) s'il existe.




**A la fermeture du fichier de données** : 

- Les blocages (sur le fichier de données et/ou sur certains de ses enregistrements) sont débloqués.

- Les filtres définis sur le fichier de données avec la fonction [HFiltre](../WDLang4/3044100.md) sont automatiquement supprimés. 

- Les parcours en cours sur le fichier de données sont annulés. 

- Les recherches en cours sur le fichier de données sont annulées. 




Après la fermeture du fichier de données, les réassignations effectuées par les fonctions [HChangeNom](../WDLang4/3044141.md), [HChangeRep](../WDLang4/3044168.md) et [HSubstRep](../WDLang4/3044028.md) sont conservées.

Si une requête a été exécutée sur le fichier de données, il est nécessaire d'appeler la fonction [HAnnuleDéclaration](../WDLang4/3044174.md) sur la requête pour que la fermeture soit effective.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Fermeture du fichier de données "Fournisseur"
HFerme(Fournisseur)
```
<a name="Exemple2"></a>

```wl
SI PAS HFerme("") ALORS
	Erreur("Problème lors de la fermeture des fichiers de données")
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HFerme([<Fichier de données>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le fichier de données a été fermé, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [HErreur](../WDLang4/3044088.md) permet d'obtenir plus d'informations sur le problème rencontré.




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données à fermer. 
Si ce nom n'est pas spécifié, la fonction **HFerme** va fermer le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).
Si ce paramètre est égal à "\*" ou à une chaîne vide (""), tous les fichiers de données ouverts sont fermés. 
Ce paramètre peut également correspondre au nom d'un [groupe de fichiers (ou perso-dossier) défini dans l'analyse](../Editeurs/2011003.md) (non disponible en Android et Android Widget).  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Fermeture des tables et de la connexion
<a name="fermeture_des_tables_connexion_ELTPARAGRAPHE000142"></a>Lorsque toutes les tables utilisant la même connexion (tables ouvertes sur la même base de données avec les mêmes paramètres de connexion) sont fermées, la connexion est fermée elle aussi automatiquement.

Pour fermer une connexion, utilisez la fonction [HFermeConnexion](../WDLang4/3044095.md).

<a name="XComposante"></a>

## Composante :
wd280hf.dll
