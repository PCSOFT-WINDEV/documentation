


## HSupprimeFichier (Fonction)

***En anglais : HDeleteFile***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Supprime les fichiers de données HFSQL (fichiers .fic, .ndx, .ftx et .mmo s'ils existent) sur le serveur.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MaConnexion est une Connexion

// Supprime des fichiers de données du serveur 
HSupprimeFichier(MaConnexion, ".\sauvegarde\fichierclient_sov.fic")
```


<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) 
```wl
Cx_test est une Connexion

SI HSupprimeFichier(Cx_test, ".\Client.FIC") = Faux ALORS
	Erreur(HErreurInfo())
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HSupprimeFichier(<Connexion> , <Chemin du fichier de données> [, <Options>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le fichier de données a été supprimé, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur (par exemple si le fichier de données n'existe pas sur le serveur). La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion dans laquelle le fichier de données doit être supprimé. Cette connexion correspond :

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).




**`<Chemin du fichier de données> : (Chaîne de caractères)`**

Nom et chemin physique du fichier de données à supprimer. Le chemin est relatif à la base de données : le nom de la base de données ne doit pas être précisé dans le chemin. Il est nécessaire de préciser l'extension ".fic" du fichier de données.

**`<Options> : (Constante ou combinaison de constantes de type entier optionnel)`**

Par défaut, lors de la suppression d'un fichier de données : 

- les fichiers correspondant aux journaux ne sont pas supprimés,

- les fichiers correspondant aux transactions sont supprimés. 




Ce paramètre permet de modifier ce comportement :



|   |   |
| --- | --- |
| *hConserveTRS* | Conserve le fichier de transaction associé au fichier de données supprimé. |
| *hDétruitLiaison* | Supprime toutes les liaisons concernant le fichier de données supprimé. |
| *hSupprimeJournal* | Supprime le fichier Journal et toutes les opérations journalées associés au fichier de données supprimé. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Suppression d'un fichier de données
<a name="suppression_fichier_donnees_ELTPARAGRAPHE000152"></a>Le fichier de données peut être supprimé uniquement si il n'est pas en cours d'utilisation (c'est-à-dire s'il n'est pas utilisé par une requête, une vue, une autre fenêtre, un thread ou un composant à contexte HFSQL indépendant).

Le fichier de données est automatiquement fermé dans le contexte HFSQL qui appelle la fonction **HSupprimeFichier**. Si le fichier de données est utilisé dans un contexte ou par une application, une erreur WLangage est affichée.
<a name="NOTE0_2"></a>


### Noms de fichiers et de répertoires sur le serveur LINUX
<a name="noms_fichiers_repertoires_sur_serveur_linux_ELTPARAGRAPHE000166"></a>Sur un serveur LINUX, le nom des fichiers de données (fichiers .fic, .ftx, .ndx et .mmo s'ils existent) doit être en minuscules et ne pas comporter d'accents.

<a name="XComposante"></a>

## Composante :
wd280hf.dll


