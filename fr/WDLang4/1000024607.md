


## &lt;Source&gt;.EnregistrementVersJSON (Fonction)

***En anglais : &lt;Source&gt;.RecordToJSON***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère la structure et la valeur de l'enregistrement en cours et les exporte dans une chaîne de caractères au format JSON.

**Remarque** : Cette fonction est utilisable aussi bien sur les fichiers de données que sur les requêtes.





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

<a name="1000021909_Exemple2"></a>

```wl
// Exporte l'enregistrement en cours du fichier de données "Client"
sJSON est une chaîne 
sJSON = Client.EnregistrementVersJSON()
```
<a name="1000021909_Exemple3"></a>

```wl
// Exporte l'enregistrement en cours du fichier de données "Client"
// Remarque : seules les rubriques NOM et NUMERO sont prises en compte
sJSON est une chaîne 
sJSON = Client.EnregistrementVersJSON("NOM,NUMERO")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Source>.EnregistrementVersJSON([<Liste des rubriques>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Structure et valeur de l'enregistrement en cours au format JSON. Cette structure est représentée sous la forme :


```txt
{"Fichier":
	{
		"Rubrique1":Donnée de la rubrique 1,
		"Rubrique2":Donnée de la rubrique 2,
		...
		}
}
```


**`<Source> : (Type correspondant à la source spécifiée)`**

Nom du fichier de données HFSQL manipulé ou de la requête manipulée. 

**`<Liste des rubriques> : (Chaîne de caractères optionnelle)`**

Rubriques à exporter. 
Si plusieurs rubriques sont spécifiées, le nom des rubriques doit être séparé par une virgule. 
Les rubriques de type clé composée, mémo binaire ou binaire sont ignorées. 
Si ce paramètre n'est pas précisé ou correspond à une chaîne vide (""), toutes les rubriques sont exportées (sauf les rubriques de type clé composée, mémo binaire ou binaire) dans l'ordre physique de description.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Rubriques tableau
<a name="rubriques_tableau_ELTPARAGRAPHE000225"></a>Si une des rubriques exportées est une rubrique de type tableau, chaque élément de la rubrique tableau est exporté dans un nouveau niveau :

```txt
{"Fichier":
	{
	"Rubrique1":Donnée de la rubrique 1,
	"Rubrique2":Donnée de la rubrique 2,
	"RubriqueTab":
		[Donnée élément 1, Donnée élément 2, ...]
	...
	}
}
```

**Rappel** : Les rubriques de type clé composée, mémo binaire ou binaire sont ignorées.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
