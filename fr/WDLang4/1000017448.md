


## hTâchePlanifiée (Type de variable)

***En anglais : hScheduledTask ***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **hTâchePlanifiée** permet de gérer une tâche planifiée HFSQL Client/Serveur par programmation. Les caractéristiques de cette tâche planifiée peuvent être définies et modifiées à l'aide de différentes [propriétés WLangage](#NOTE0_1).

**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MaTâche est une hTâchePlanifiée
MaTâche.Description = "Sauvegarde planifiée"
MaTâche.Mois = "*"
MaTâche.JourDeLaSemaine = "*"
MaTâche.JourDuMois = "*"
MonHeure est une Heure
MonHeure = SAI_Heure
MaTâche.Heure = MonHeure.Heure
MaTâche.Minute = MonHeure.Minute
MaTâche.NombreExécution = 1
MaTâche.Procédure = "HBackup"
Ajoute(MaTâche.Paramètre, NomBaseCS + "/LOG_TACHES.FIC")
Ajoute(MaTâche.Paramètre, NomBaseCS + ".SauvegardePlanifiée")
Ajoute(MaTâche.Paramètre, Vrai)
Ajoute(MaTâche.Paramètre, MaTâche.Description)
nID est un entier = HAjouteTâche(ConnexionCS, MaTâche)
```

<a name="XSYNTAXE"></a>
<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Propriétés spécifiques à la description des variables de type hTâchePlanifiée
<a name="proprietes_specifiques_description_des_variables_type_htacheplanifiee_ELTPARAGRAPHE000039"></a>Les propriétés suivantes peuvent être utilisées pour manipuler une variable de type **hTâchePlanifiée** :

| Nom de la propriété | Type manipulé | Effet |
| --- | --- | --- |
| Activé | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> si la planification de la tâche est activée, <br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.<br><br><br> |
| AuDémarrage | Constante de type Entier | Indique si la tâche doit être effectuée au démarrage du serveur HFSQL et son mode d'exécution : <br><br>- *hBloquant* : La tâche est bloquante. Le serveur HFSQL sera inaccessible pendant l'exécution de la tâche. <br><br>- *hTâcheDeFond* : La tâche n'est pas bloquante. Le serveur HFSQL sera accessible pendant l'exécution de la tâche. La tâche est exécutée en tâche de fond. <br><br>- *Non* : La tâche ne doit pas être exécutée au démarrage du serveur (valeur par défaut). <br><br><br> |
| Description (\*) | Chaîne de caractères | Description associée à la tâche planifiée. Par défaut, la description de la tâche planifiée correspond à une chaîne vide.<br>Cette propriété est optionnelle. |
| Heure | Chaîne de caractères | <br><br>Heure d'exécution de la tâche planifiée. Si la propriété **HeureUTC** est à <u><u><u><u>Vrai</u></u></u></u>, cette heure est au format UTC (temps universel).Les valeurs possibles sont :<br><br>- un chiffre compris entre 0 et 23.<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs heures.<br><br>- un intervalle. Par exemple "9-13".<br><br>- une étoile "\*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "\*/2" pour lancer la tâche à toutes les heures paires.<br><br><br> |
| HeureUTC | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> (valeur par défaut) si l'heure est exprimée en heure UTC, c'est-à-dire en temps universel (propriétés **Heure** et **Minute**),<br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.<br><br><br> |
| JourDeLaSemaine | Chaîne de caractères | Numéro du jour de la semaine pour lequel la tâche planifiée doit être exécutée (par exemple "2"). Ce nombre est compris entre 1 et 7 (1 = Lundi, 2 = Mardi, ...). <br>Ce paramètre peut également correspondre à :<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs jours.<br><br>- un intervalle. Par exemple "1-3" (la tâche est planifiée pour Lundi, Mardi et Mercredi).<br><br>- une étoile "\*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "\*/2" pour lancer la tâche à tous les jours de la semaine pairs.<br><br>- le jour de la semaine en toutes lettres ("lundi", "mardi", "mercredi", "jeudi", "vendredi").<br><br><br> |
| JourDuMois | Chaîne de caractères | Numéro du jour du mois pour lequel la tâche planifiée doit être exécutée (par exemple "31"). Ce nombre est compris entre 0 et 31.<br>Ce paramètre peut également correspondre à :<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs mois.<br><br>- un intervalle. Par exemple "9-13" (la tâche est planifiée du 9 au 13 du mois).<br><br>- une étoile "\*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "\*/2" pour lancer la tâche à tous les jours du mois pairs.<br><br><br> |
| JourDuMoisOuDeLaSemaine | Booléen | Permet de gérer l'exécution d'une tâche planifiée en précisant le numéro de jour de la semaine ou le numéro de jour du mois. Exemple : exécution tous les lundis 1er jour du mois.<br>Cette propriété peut correspondre à :<br><br>- <u><u><u><u>Vrai</u></u></u></u> pour exécuter la tâche planifiée tous les lundis ET le premier jour du mois (conditions cumulées).<br><br>- <u><u><u><u>Faux</u></u></u></u> pour exécuter la tâche uniquement les lundis 1er (conditions exclusives).<br><br><br> |
| Minute | Chaîne de caractères | <br><br>Minutes de l'heure d'exécution de la tâche planifiée. Si la propriété **HeureUTC** est à <u><u><u><u>Vrai</u></u></u></u>, cette heure est au format UTC (temps universel).<br><br>Les valeurs possibles sont :<br><br>- un chiffre compris entre 0 et 59.<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs minutes.<br><br>- un intervalle. Par exemple "9-13".<br><br>- une étoile "\*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "\*/2" pour lancer la tâche à toutes les minutes paires.<br><br><br> |
| Mois | Chaîne de caractères | Numéro du mois d'exécution de la tâche planifiée (par exemple "11"). Les valeurs possibles sont :<br><br>- un chiffre compris entre 1 et 12.<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs mois.<br><br>- un intervalle. Par exemple, "9-11".<br><br>- une étoile "\*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "\*/2" pour lancer la tâche tous les mois pairs.<br><br><br> |
| NombreExécution | Entier | Nombre de fois où la tâche doit être exécutée. Cette propriété peut également correspondre à la constante *Infini*. |
| Paramètre | Tableau | Paramètres de la procédure stockée à exécuter par la tâche planifiée. Pour plus de détails, consultez le paragraphe ["Comment manipuler les paramètres passés à la procédure stockée ?"](#NOTE0_2). |
| Procédure | Chaîne de caractères | Nom de la procédure stockée à exécuter par la tâche planifiée. <br>Cette propriété est de la forme : &lt;Nom de la base&gt;:&lt;Nom de la collection de procédures&gt;.&lt;Nom de la procédure stockée&gt;. <br>Pour exécuter une sauvegarde, cette propriété doit correspondre à "HSauvegarde" ou "HBackup". |
| Utilisateur | Chaîne de caractères | Utilisateur ayant créé la tâche planifiée.<br>Cette propriété est en lecture uniquement. |

Les propriétés suivies du caractère (\*) sont optionnelles.
<a name="NOTE0_2"></a>


### Comment manipuler les paramètres passés à la procédure stockée 
<a name="comment_manipuler_les_parametres_passes_procedure_stockee_ELTPARAGRAPHE000243"></a>La propriété **Paramètre** de la variable **hTâchePlanifiée** est un tableau de chaînes.

Pour définir les paramètres d'une procédure stockée exécutée lors du déclenchement d'une tâche planifiée, utilisez la fonction [Ajoute](../WDLang1/1000017348.md) ou la fonction [TableauAjoute](../WDLang1/3075003.md). Exemple :

```wl
Ajoute(MaTâche.Paramètre, gsNomBaseCS + ".SauvegardePlanifiée")
```
Pour manipuler les paramètres, il est possible d'utiliser la syntaxe POUR TOUT permettant le parcours d'un tableau.

Pour connaître le nombre d'éléments du tableau, il est possible d'utiliser :

- La fonction [TableauOccurrence](../WDLang1/3075012.md)

- La propriété [Occurrence](../WDLang1/3025009.md)



<a name="NOTE0_3"></a>


### Fonctions utilisant les variables de type hTâchePlanifiée
<a name="fonctions_utilisant_les_variables_type_htacheplanifiee_ELTPARAGRAPHE000269"></a>

| Nom de la fonction | Effet |
| --- | --- |
| [HAjouteTâche](../WDLang4/1000017091.md) | Ajoute une tâche planifiée sur le serveur défini par la connexion. Cette tâche a été définie par une variable avancée de type **hTâchePlanifiée**. |
| [HInfoTâche](../WDLang4/1000017409.md) | Renvoie les caractéristiques d'une tâche planifiée dans une variable avancée de type **hTâchePlanifiée**. |
| [HModifieTâche](../WDLang4/1000017374.md) | Modifie une tâche planifiée sur le serveur défini par la connexion. Cette tâche est présente dans une variable avancée de type **hTâchePlanifiée**. |


<a name="NOTE0_4"></a>


### Compatibilité
<a name="compatibilite_ELTPARAGRAPHE000294"></a>Le type **hTâchePlanifiée** remplace la [structure globale hTâchePlanifiée](../WDLang4/1000017180.md) disponible en version 12. Cette structure est conservée par compatibilité.


