


## HStatCalcule (Fonction)

***En anglais : HStatCalculate***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Réalise diverses statistiques sur les clés d'un fichier de données.
Cette fonction est équivalente à la fonction [HAccélèreVitesse](../WDLang4/1000019375.md).Ces statistiques sont utilisées lors de la pose d'un filtre, la création d'une requête ou encore la création d'une vue sur le fichier de données. Le moteur HFSQL analyse la condition de sélection et s'appuie ensuite sur ces statistiques pour déterminer les rubriques les plus discriminantes qui permettront d'optimiser les parcours des fichiers de données.

Les statistiques permettent d'avoir des informations sur le contenu du fichier de données au moment de leur calcul. Aussi, plus il y a de modifications du fichier après ce calcul et moins ces statistiques sont fidèles au contenu du fichier de données. Plus le fichier de données contient d'enregistrements et moins la modification d'un enregistrement a d'impact sur le reflet du fichier de données que les statistiques renvoient.

**Attention** : la fonction **HStatCalcule** bloque le fichier de données en écriture pendant le calcul des statistiques (un parcours du fichier de données est effectué pour chaque clé du fichier de données).
![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Il est possible de réaliser le calcul des statistiques en tâche de fond, sans bloquer le fichier de données en écriture. 

**Remarque** : Pour un calcul de statistiques efficace, il est nécessaire de réaliser ce calcul sur tous les fichiers de données (par exemple dans le cas d'une requête multi-fichiers).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Statistiques sur la clé NomCli du fichier de données Client
HStatCalcule(Client, NomCli)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HStatCalcule([<Fichier de données> [, <Rubrique clé> [, <Option>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le calcul a été effectué, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème (fichier de données bloqué par une  application par exemple). La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données manipulé. Si ce nom n'est pas spécifié, la fonction **HStatCalcule** va manipuler le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).
Si ce paramètre est égal à "\*" (sans préciser de rubrique), le calcul sera réalisé sur tous les fichiers de données décrits dans l'analyse en cours (y compris les fichiers de données décrits avec les fonctions [HDéclare](../WDLang4/3044203.md), [HDéclareExterne](../WDLang4/3044204.md), [HDécritFichier](../WDLang4/3044206.md)).
Attention : Ce fichier de données ne doit pas être bloqué par une application.

**`<Rubrique clé> : (Chaîne de caractères optionnelle)`**

Nom de la rubrique clé permettant de réaliser les statistiques. Si ce nom n'est pas spécifié ou est égal à "\*", le calcul des statistiques sera réalisé sur toutes les rubriques clé du fichier de données.

**`<Option> : (Constante de type Entier)`**

Option de calcul des statistiques. 

- Si ce paramètre n'est pas précisé, le calcul des statistiques bloque le fichier de données en écriture. 

- Si ce paramètre correspond à la constante *hTâcheDeFond*, le calcul des statistiques est effectué en tâche de fond, sans bloquer le fichier de données. 


**Important** : Ce paramètre est pris en compte uniquement pour des fichiers HFSQL Client/Serveur. Dans tous les autres cas, le fichier de données est automatiquement bloqué pendant le calcul des statistiques. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- La fonction **HStatCalcule** ne ferme pas le fichier de données.

- La mise à jour des statistiques peut également être réalisée par la fonction [HRéindexe](../WDLang4/3044133.md). Les fonctions [HRéindexe](../WDLang4/3044133.md) et **HStatCalcule** sont les deux seules fonctions à mettre à jour les statistiques du fichier de données.

- Dans les fichiers de données HFSQL Classic ou Client/Serveur, seules les rubriques clés peuvent faire l'objet d'un calcul de statistiques.

- La syntaxe **HStatCalcule**(&lt;Fichier de données&gt;) est équivalente à **HStatCalcule**(&lt;Fichier de données&gt;, "\*")

- Pour utiliser la fonction **HStatCalcule** avec les fichiers de données d'un cluster HFSQL, le paramètre &lt;Option&gt; doit correspondre à la constante *hTâcheDeFond* pour ne pas bloquer le cluster. 




<a name="XComposante"></a>

## Composante :
wd280hf.dll
