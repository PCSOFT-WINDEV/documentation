


## HRécupèreSauvegarde (Fonction)

***En anglais : HRetrieveBackup***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère en local le contenu d'une sauvegarde compressée (au format ZIP) réalisée sur un serveur HFSQL.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Description de la connexion
MaConnexion est une Connexion

HRécupèreSauvegarde(MaConnexion, idSauvegarde, "C:\temp\Monfichier.zip", JAUGE_Progress)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = HRécupèreSauvegarde(<Connexion> , <Sauvegarde> , <Fichier destination> [, <Jauge>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la sauvegarde a été récupérée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur.




**`<Connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion vers le serveur contenant la sauvegarde à récupérer. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).




**`<Sauvegarde> : (Entier ou chaîne de caractères)`**

Sauvegarde à récupérer. Peut correspondre à :

- **Identifiant de la sauvegarde**. Cet identifiant peut correspondre à l'identifiant d'une sauvegarde complète ou d'une sauvegarde différentielle. 
	Lors d'une sauvegarde immédiate, cet identifiant est renvoyé par la fonction [HSauvegarde](../WDLang4/1000017081.md). Cet identifiant peut également être obtenu grâce à la fonction [HInfoSauvegarde](../WDLang4/1000017083.md).
	Lors d'une sauvegarde planifiée, cet identifiant correspond à la propriété **Identifiant** de la variable [hDescriptionSauvegarde](../WDLang4/1000017455.md). 

- **Chemin et nom de la sauvegarde**. Ce nom a été spécifié lors de la sauvegarde. Ce nom peut également être obtenu grâce à la fonction [HInfoSauvegarde](../WDLang4/1000017083.md). Si ce nom correspond à un chemin relatif, la sauvegarde sera recherchée dans le sous-répertoire "Backup" du serveur HFSQL. Pour spécifier le répertoire du service Manta, il suffit d'utiliser la chaîne de caractères "%%EXE%%".




**`<Fichier destination> : (Chaîne de caractères)`**

Chemin et nom du fichier local dans lequel la sauvegarde va être récupérée.

Dans le cas d'une sauvegarde complète, le fichier destination est un fichier au format zip (l'extension ".zip" doit être précisée dans le nom du fichier. 

**`<Jauge> : (Nom de champ optionnel, nom de fenêtre optionnel ou entier optionnel)`**



- Nom de la fenêtre dans laquelle la jauge doit être affichée ou nom du champ de type Jauge.

- Identifiant (Handle) de la fenêtre qui affiche la jauge.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Droits nécessaires pour récupérer une sauvegarde
<a name="droits_necessaires_pour_recuperer_une_sauvegarde_ELTPARAGRAPHE000118"></a>Pour récupérer une sauvegarde, l'utilisateur ou le groupe doit posséder le droit de faire des sauvegardes (constante *hDroitSauvegarde*). Ce droit s'applique aux serveurs et aux bases de données. Par exemple, pour faire une sauvegarde du serveur complet, il faut posséder le droit de faire des sauvegardes au niveau du serveur. 

Pour savoir si un utilisateur ou un groupe possède ces droits, utilisez la fonction [HInfoDroitServeur](../WDLang4/3044322.md) ou [HInfoDroitDaseDeDonnées](../WDLang4/3044320.md).

Pour modifier les droits d'un utilisateur ou d'un groupe d'utilisateurs, utilisez la fonction [HModifieDroitServeur](../WDLang4/3044328.md) ou [HModifieDroitBaseDeDonnées](../WDLang4/3044326.md).

<a name="XComposante"></a>

## Composante :
wd280hf.dll
