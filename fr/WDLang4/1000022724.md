


## &lt;Variable Connexion&gt;.NotifAjouteDestinataireCC (Fonction)

***En anglais : &lt;Connection variable&gt;.NotifAddCCRecipient***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute des destinataires pour les notifications envoyées via les Centres de Contrôle (outil de messagerie WDBal). Ces notifications sont envoyées par le serveur HFSQL lorsqu'il rencontre un problème ou détecte une optimisation possible. 

**Remarque** : L'envoi via les Centres de Contrôle utilise les paramètres spécifiés avec la fonction [&lt;Variable Connexion&gt;.NotifConfigure](../WDLang4/1000022726.md) (base des Centres de Contrôle, ...). 

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Description de la connexion
cnxConnexionCS est une Connexion

cnxConnexionCS est une Connexion
cnxConnexionCS.Provider = hAccèsHFClientServeur
cnxConnexionCS.Utilisateur = "admin"
cnxConnexionCS.MotDePasse = ""
cnxConnexionCS.Serveur = "test:4900"
cnxConnexionCS.OuvreConnexion()

cnxConnexionCS.NotifConfigure(hNotifCCCS, "DOC:4988", "CC_DOC", "DOC", "")
cnxConnexionCS.NotifAjouteDestinataireCC("Florence", hNotifAvertissement)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = <Connexion>.NotifAjouteDestinataireCC(<Destinataire> , <Niveau minimum>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'ajout du destinataire a été effectué. 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur.




**`<Connexion> : (Variable de type Connexion)`**

Nom de la variable de type [Connexion](../WDLang4/1514073.md) décrivant la connexion à manipuler.

**`<Destinataire> : (Chaîne de caractères)`**

Nom du destinataire. Ce nom doit correspondre à un utilisateur défini dans la base des Centres de Contrôle.

**`<Niveau minimum> : (Constante de type Entier)`**

Niveau minimum de gravité du problème à partir duquel une notification est envoyée : 


|   |   |
| --- | --- |
| *hNotifAvertissement* | Les notifications seront envoyées dès le niveau avertissement (pour les problèmes de type avertissement, critique et erreur).<br><br>Exemple d'avertissement : "Le serveur XX et le serveur YY n'ont pas la même heure. La résolution des conflits lors de la réplication peut être faussée." |
| *hNotifCritique* | Les notifications seront envoyées dès le niveau critique (pour les problèmes de type critique et erreur).<br><br>Exemple d'erreur critique : "Erreur pendant la préparation du réplica sur le maître." |
| *hNotifErreur* | Les notifications seront envoyées seulement pour les problèmes de type erreur.<br><br>Exemple d'erreur : "Le fichier des statistiques d'activité du serveur est endommagé. Il va être réinitialisé." |
| *hNotifInformation* | Les notifications seront envoyées dès le niveau information (pour les problèmes de type information, avertissement, critique et erreur).<br><br>Exemples d'information : <br><br>- Lors de la mise à jour automatique du serveur : <br><br>	- "Le serveur va être arrêté pour mise à jour. Une autre notification sera ajoutée après la mise à jour."<br><br>	- "Le serveur a été mis a jour en version XXX."<br><br><br><br><br>- Lors de la recherche de clés nécessaires sur une base en exploitation. <br><br><br> |


L'ordre de gravité des problèmes est : 

- Information.

- Avertissement.

- Erreur.

- Critique.






<a name="XComposante"></a>

## Composante :
wd280hf.dll
