


## HListeUtilisateurConnecté (Fonction)

***En anglais : HListConnectedUser***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Liste les utilisateurs actuellement connectés à un ou plusieurs fichiers manipulés par une connexion Client/Serveur.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Description de la connexion
HDécritConnexion("MaConnexion", "Julie", "MotDePasse", "MonServeurHF", "MaBaseDeDonnées", ...
	hAccèsHFClientServeur, HOLecture)
// Ouverture de la connexion
HOuvreConnexion("MaConnexion")
Résultat1 est une chaîne
Résultat1 = HListeUtilisateurConnecté("MaConnexion")
// Ajout des utilisateurs dans un champ Liste
ListeAjoute(LISTE_Maliste, Résultat1)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HListeUtilisateurConnecté(<Nom de la connexion> [, <Base de données> [, <Nom physique du fichier>]])`
---

**`<Résultat> : (Chaîne de caractères)`**

Nom des différents utilisateurs utilisant :

- soit le fichier spécifié.

- soit la base de données spécifiée.




Si seul le nom de la connexion est spécifié, liste tous les utilisateurs connectés au serveur.

Les informations renvoyées sont de la forme :

```txt
<Nom de l'utilisateur> + TAB + <Nom de la machine cliente> + TAB + 
<Nom de l'application cliente> + TAB + <Version interne librairie HFSQL cliente> + 
TAB + <Version de la librairie HFSQL cliente> + TAB + 
<Priorité de l'application cliente> + TAB + 
<Nom du noeud serveur (si cluster HFSQL)> + <Adresse IP du poste client> + RC + ...
```

**Remarque** : Si l'utilisateur en cours ne possède pas le droit de visualisation des utilisateurs (constante *hDroitVisualisationUtilisateur*) sur le serveur (fonction [HModifieDroitServeur](../WDLang4/3044328.md) ou [HInfoDroitServeur](../WDLang4/3044322.md)), la fonction **HListeUtilisateurConnecté** ne renvoie que les connexions de l'utilisateur en cours.

**`<Nom de la connexion> : (Chaîne de caractères)`**

Nom de la connexion utilisée. Cette connexion a été définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

**`<Base de données> : (Chaîne de caractères optionnelle)`**

Nom de la base de données pour laquelle on veut connaître les utilisateurs actuellement connectés. 
Si ce paramètre ainsi que le paramètre &lt;Nom physique du fichier&gt; ne sont pas précisés, la fonction **HListeUtilisateurConnecté** listera les utilisateurs connectés au serveur.

**`<Nom physique du fichier> : (Chaîne de caractères optionnelle)`**

Nom du fichier pour lequel on veut connaître les utilisateurs actuellement connectés. 
Si ce paramètre n'est pas précisé, la fonction **HListeUtilisateurConnecté** listera les utilisateurs connectés à la base de données.
Si ce paramètre ainsi que le paramètre &lt;Base de données&gt; ne sont pas précisés, la fonction **HListeUtilisateurConnecté** listera les utilisateurs connectés au serveur.



<a name="NOTE0"></a>
<a name="XComposante"></a>

## Composante :
wd280hf.dll
