


## HAvance (Fonction)

***En anglais : HForward***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Avance de plusieurs enregistrements dans le fichier de données, à partir de la position en cours, selon une rubrique spécifiée.

L'enregistrement destination est lu et chargé en mémoire : les variables HFSQL sont mises à jour (par exemple Client.Nom, c'est-à-dire la rubrique *Nom* du fichier de données *Client*).

Après l'exécution de la fonction **HAvance**, plusieurs cas peuvent se présenter :

- il n'existe plus d'enregistrements dans le fichier de données: la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u>Vrai</u></u></u>. Aucune lecture n'est effectuée.

- la fonction tente de bloquer un enregistrement déjà bloqué en lecture : la fonction [HErreurBlocage](../WDLang4/3044099.md) renvoie <u><u><u>Vrai</u></u></u> et la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u>Vrai</u></u></u>.
	
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : La gestion des blocages n'est pas disponible sur les bases de données accédées par JDBC. 
	




Cette fonction peut être utilisée indifféremment avec les fichiers, les vues HFSQL ou les requêtes.

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Avance jusqu'au 2000ième enregistrement
// du fichier Client selon la clé NomClient
HLitPremier(Client, NomClient)
HAvance(Client, NomClient, 1999)
```
<a name="Exemple2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 
```wl
// Test du compte-rendu de la fonction HAvance
// Avance jusqu'au 2000ième enregistrement
// du fichier Client selon la clé NomClient
HLitPremier(Client, NomClient)
SI HAvance(Client, NomClient, 1999, hBlocageEcriture) = Faux ALORS 
	SI HErreurBlocage() = Vrai ALORS
		Info("Cet enregistrement est en cours d'utilisation")
	SINON
		Erreur(HErreurInfo())
	FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HAvance([<Fichier de données>] [, <Rubrique> [, <Pas> [, <Options>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'avancement dans le fichier a été effectué, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur (blocage, fin du fichier, etc.) : l'enregistrement n'est pas lu. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données, de la vue ou de la requête manipulé. 
Si ce nom n'est pas spécifié, la fonction **HAvance** va manipuler le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).



**`<Rubrique> : (Chaîne de caractères optionnelle)`**

Nom de la rubrique selon laquelle le parcours est effectué. 
Si ce nom n'est pas spécifié, la fonction **HAvance** va manipuler la dernière rubrique du fichier de données utilisée par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Pas> : (Entier optionnel)`**

Nombre de pas en avant (c'est-à-dire nombre d'enregistrements à parcourir). Par défaut, &lt;Pas&gt; = 1.


**`<Options> : (Constante ou combinaison de constantes optionnelle de type entier)`**

Paramètre :

- le blocage de l'enregistrement lu. Par défaut, le blocage réalisé correspond au blocage en cours.
	


|   |   |
| --- | --- |
| *hBlocageEcriture* | Blocage en écriture : l'enregistrement en cours de lecture pourra être lu par une autre application mais ne pourra pas être modifié par une autre application. |
| *hBlocageLectureEcriture* | Blocage en lecture/écriture : l'enregistrement en cours de lecture ne pourra ni être lu ni être modifié par une autre application. |
| *hBlocageNon* | Aucun blocage : l'enregistrement pourra être lu ou modifié par une autre application pendant la lecture. |


	![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Si le provider OLE DB ou le Connecteur Natif utilisé ne gère pas les blocages, les options de blocage seront sans effet.
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : La gestion des blocages n'est pas disponible sur les bases de données accédées par JDBC. 
	

- la gestion des doublons lors du parcours. Par défaut, tous les doublons sont parcourus.
	


|   |   |
| --- | --- |
| *hDistinct* | Lors d'un parcours sur une rubrique clé, s'il y a des doublons, un seul enregistrement est parcouru. |




![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Le paramètre &lt;Options&gt; n'est pas pris en compte.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Lecture selon une rubrique clé ou non
<a name="lecture_selon_une_rubrique_cle_non_ELTPARAGRAPHE000221"></a>Dans tous les cas, le parcours doit avoir été initialisé avec une des fonctions suivantes : [HLitPremier](../WDLang4/3044051.md), [HPremier](../WDLang4/3044113.md), [HLitRecherchePremier](../WDLang4/3044036.md), [HRecherchePremier](../WDLang4/3044125.md), [HChangeClé](../WDLang4/3044151.md), [HRetourPosition](../WDLang4/3044137.md).

Si la rubrique utilisée est une clé :

- si la constante *hDistinct* n'est pas précisée, la fonction **HAvance** permet d'avancer de &lt;Pas&gt; valeurs de la clé à partir de la position en cours.

- si la constante *hDistinct* est précisée, la fonction **HAvance** permet d'avancer de &lt;Pas&gt; valeurs de la clé distinctes à partir de la position en cours. Si des doublons sont rencontrés, un seul doublon est lu.




Si la rubrique utilisée n'est pas une clé :

- la constante *hDistinct* n'est pas disponible.

- la fonction **HAvance** permet d'avancer de &lt;Pas&gt; enregistrements actifs à partir de la position en cours.



<a name="NOTE0_2"></a>


### Mémos
<a name="memos_ELTPARAGRAPHE000267"></a>Les mémos associés à l'enregistrement peuvent être automatiquement lus ou non lors de la lecture de l'enregistrement. La fonction [HGèreMemo](../WDLang4/3044139.md) permet de personnaliser cette lecture automatique.

Si les mémos sont gérés, lorsque l'enregistrement est lu, les mémos texte associés sont également lus. Les mémos binaires ne sont lus que lorsqu'ils sont utilisés explicitement (fonction [HExtraitMémo](../WDLang4/3044072.md)).
<a name="NOTE0_3"></a>


### Blocage
<a name="blocage_ELTPARAGRAPHE000284"></a>Par défaut (aucune constante de blocage spécifiée), le blocage réalisé correspond au mode de blocage en cours.

Si un blocage est spécifié (constantes *hBlocageEcriture* ou *hBlocageLectureEcriture*), la lecture de l'enregistrement et le blocage seront réalisés uniquement si cet enregistrement n'est pas déjà bloqué par une autre application.

![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Si le provider OLE DB ou le Connecteur Natif utilisé ne gère pas les blocages, les options de blocage seront sans effet.


<a name="NOTE0_4"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000303"></a>

- Le résultat de la fonction [HTrouve](../WDLang4/3044104.md) doit être ignoré (la fonction [HTrouve](../WDLang4/3044104.md) doit être utilisée pour les recherches réalisées avec la fonction [HLitRecherche](../WDLang4/3044050.md)).

- Le numéro de l'enregistrement en cours est connu avec la fonction [HNumEnr](../WDLang4/3044063.md).

- La fonction **HAvance** respecte le filtre actif en cours (décrit avec la fonction [HFiltre](../WDLang4/3044100.md)).

- La fonction [HChangeClé](../WDLang4/3044151.md) permet de modifier la clé de parcours, tout en restant positionné sur l'enregistrement en cours.

- **HAvance**(Client,Nom) est équivalent à [HLitSuivant](../WDLang4/3044037.md)(Client,Nom)




<a name="XComposante"></a>

## Composante :
wd280hf.dll
