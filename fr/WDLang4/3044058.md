


## HGèreIntégrité (Fonction)

***En anglais : HSetIntegrity***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Active ou désactive la gestion d'une contrainte d'intégrité sur une liaison d'un fichier de données.

**Remarque** : Par défaut, toutes les règles d'intégrité définies dans la description de l'analyse sont actives.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Désactiver le test des cardinalités sur la liaison entre une commande et un client
HGèreIntégrité(ClientCommande, hCardinalité, Faux)
```
<a name="Exemple2"></a>

```wl
// Désactiver les règles d'intégrité sur tous les fichiers de données de l'application
HGèreIntégrité("*", "*", hCardinalité + hEnModification + hEnSuppression, Faux)
// équivalent à : hGèreIntégrité(Faux)
```
<a name="Exemple3"></a>

```wl
// Désactiver les règles d'intégrité sur la liaison entre une commande et un client
// avec utilisation d'une connexion
CxFichierSource est une Connexion
CxFichierRelié est une Connexion

HGèreIntégrité(CxFichierSource, CxFichierRelié, ClientCommande, ... 
	hCardinalité + hEnModification + hEnSuppression, Faux)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Activer ou désactiver la gestion d'une contrainte d'intégrité en spécifiant le nom du fichier de données

`<Résultat> = HGèreIntégrité([<Liaison à manipuler>] [, <Fichier de données>] [, <Contrainte d'intégrité>] , <Mode de gestion>)`
---

**`<Résultat> : (Booléen)`**

Ancienne gestion de l'intégrité (avant utilisation de la fonction **HGèreIntégrité**) : 

- <u><u><u><u>Vrai</u></u></u></u> si la gestion de l'intégrité était active, 

- <u><u><u><u>Faux</u></u></u></u> si la gestion de l'intégrité était inactive. 


Si &lt;Liaison à manipuler&gt; = "\*" ou si &lt;Fichier de données&gt; = "\*" , &lt;Résultat&gt; est à <u><u><u><u>Vrai</u></u></u></u> si dans l'ancien mode de gestion de l'intégrité, l'intégrité était activée sur au moins une liaison ou au moins un fichier de données.

**`<Liaison à manipuler> : (Chaîne de caractères optionnelle)`**

Nom de la liaison concernée (nom composé des différents fichiers de données participant à la liaison). 
Si ce nom n'est pas spécifié ou est égal à "\*", la nouvelle gestion de l'intégrité s'applique à toutes les liaisons définies dans l'analyse.

**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données manipulé. 
Si ce nom n'est pas spécifié ou est égal à "\*", la nouvelle gestion spécifiée s'applique à tous les fichiers de données intervenant dans la liaison (y compris les alias).
Si le paramètre &lt;Liaison à manipuler&gt; correspond à "\*", ce paramètre doit également correspondre à "\*". En effet, il n'est pas possible d'activer ou de désactiver l'ensemble des contraintes d'intégrité de toutes les liaisons d'un fichier de données spécifique.

**`<Contrainte d'intégrité> : (Constante ou combinaison de constantes optionnelle de type Entier)`**

Permet de déterminer les contraintes d'intégrité à gérer. Si ce paramètre n'est pas spécifié, la nouvelle gestion s'applique à toutes les contraintes de la liaison.


|   |   |
| --- | --- |
| *hCardinalité* | Test des cardinalités de la liaison. |
| *hEnModification* | Règle d'intégrité appliquée pendant une modification. |
| *hEnSuppression* | Règle d'intégrité appliquée pendant une suppression. |



**`<Mode de gestion> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la contrainte d'intégrité est activée, 

- <u><u><u><u>Faux</u></u></u></u> si cette gestion doit être désactivée. Si seul ce paramètre est précisé, le mode de gestion spécifié s'applique à tous les fichiers de données.





<a name="SYNTAXE2"></a>

### Activer ou désactiver la gestion d'une contrainte d'intégrité en spécifiant la connexion du fichier de données

`<Résultat> = HGèreIntégrité(<Connexion fichier de données source> [, <Connexion fichier de données relié>] , <Description de la liaison> [, <Contrainte d'intégrité>] , <Mode de gestion>)`
---

**`<Résultat> : (Booléen)`**

Ancienne gestion de l'intégrité (avant utilisation de la fonction **HGèreIntégrité**) : 

- <u><u><u><u>Vrai</u></u></u></u> si la gestion de l'intégrité était active, 

- <u><u><u><u>Faux</u></u></u></u> si la gestion de l'intégrité était inactive.




**`<Connexion fichier de données source> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion à laquelle appartient le fichier de données source de la liaison. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).




**`<Connexion fichier de données relié> : (Chaîne de caractères optionnelle ou variable de type Connexion)`**

Connexion à laquelle appartient le fichier de données relié de la liaison. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).


Si ce paramètre n'est pas précisé, les deux fichiers de données appartiennent alors à la même connexion (paramètre &lt;Connexion fichier de données source&gt;).

**`<Description de la liaison> : (Variable de type Description de liaison)`**

Nom de la variable de type [Description de liaison](../WDLang4/1514039.md) contenant les caractéristiques de la liaison.

**`<Contrainte d'intégrité> : (Constante ou combinaison de constantes optionnelle de type Entier)`**

Contraintes d'intégrité à gérer. Si ce paramètre n'est pas spécifié, la nouvelle gestion s'applique à toutes les contraintes de la liaison.


|   |   |
| --- | --- |
| *hCardinalité* | Test des cardinalités de la liaison. |
| *hEnModification* | Règle d'intégrité appliquée pendant une modification. |
| *hEnSuppression* | Règle d'intégrité appliquée pendant une suppression. |



**`<Mode de gestion> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la contrainte d'intégrité est activée, 

- <u><u><u><u>Faux</u></u></u></u> si cette gestion doit être désactivée. Si seul ce paramètre est précisé, le mode de gestion spécifié s'applique à tous les fichiers de données.  






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Gestion de l'intégrité activée
<a name="gestion_integrite_activee_ELTPARAGRAPHE000251"></a>Si une opération sur un fichier de données entraîne la violation d'une contrainte d'intégrité sur une règle active, l'opération n'est pas effectuée et provoque l'erreur de la fonction. La fonction [HErreurIntégrité](../WDLang4/3044086.md) renvoie alors <u><u><u><u>Vrai</u></u></u></u>.

**Remarque** : Seules les fonctions [HAjoute](../WDLang4/3044147.md), [HModifie](../WDLang4/3044042.md), [HSupprime](../WDLang4/3044018.md), [HRaye](../WDLang4/3044121.md) et [HEcrit](../WDLang4/3044092.md) peuvent générer une erreur d'intégrité.
<a name="NOTE0_2"></a>


### Désactiver les règles d'intégrité
<a name="desactiver_les_regles_integrite_ELTPARAGRAPHE000284"></a>Désactiver une règle d'intégrité implique la possibilité de violer les contraintes énoncées lors de la description des fichiers de données dans l'éditeur d'analyses. Désactiver une règle d'intégrité n'est donc pas une opération insignifiante : elle doit être utilisée à bon escient.
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) 

### En mode HFSQL Client/Serveur
<a name="mode_hfsql_clientserveur_ELTPARAGRAPHE000295"></a>L'utilisation de la syntaxe **HGèreIntégrité**(&lt;Gestion&gt;) influe sur le comportement de tous les serveurs HFSQL (que l'ouverture de la connexion soit antérieure ou postérieure à l'appel de la fonction **HGèreIntégrité**).

L'utilisation de la fonction **HGèreIntégrité** en précisant le nom de la liaison n'est possible que si :

- La liaison est décrite dans l'analyse du client (ou par la fonction [HDécritLiaison](../WDLang4/3044191.md)).

- Les deux fichiers de données reliés par cette liaison sont situés sur le même serveur HFSQL.




Si l'appel à la fonction **HGèreIntégrité** est effectuée avant que les fichiers de données soient en mode Client/Serveur (par exemple, si la fonction [HChangeConnexion](../WDLang4/3044150.md) est utilisée), le serveur active la règle d'intégrité.

Un droit est associé à la gestion de l'intégrité sur la base de données : *hDroitGèreIntégrité*. Une erreur de droit apparaît lorsque l'utilisateur tente de violer la contrainte d'intégrité (par exemple lors de l'utilisation des fonctions [HAjoute](../WDLang4/3044147.md), [HModifie](../WDLang4/3044042.md), ...). 

<a name="XComposante"></a>

## Composante :
wd280hf.dll
