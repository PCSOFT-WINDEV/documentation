


## &lt;Variable Connexion&gt;.AjouteSauvegardePlanifiée (Fonction)

***En anglais : &lt;Connection variable&gt;.AddScheduledBackup***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute une planification de sauvegarde complète (avec ou sans sauvegarde différentielle) sur le serveur défini par la connexion. Cette planification de sauvegarde a été définie par une variable de type [hDescriptionSauvegarde](../WDLang4/1000017455.md).




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Description de la connexion
ConnexionBase est une Connexion
...
// Création d'une sauvegarde planifiée toutes les 5 minutes 
// avec une sauvegarde différentielle toutes les minutes
hSvg est une hDescriptionSauvegarde
hSvg.Activé = Vrai
hSvg.AvecIndex = Vrai
hSvg.Description = "Sauvegarde planifiée toutes les N minutes avec " + ...
	"une sauvegarde différentielle toutes les minutes sur la base " + ...
	ConnexionBase.BaseDeDonnées + " créée le "+ ...
	DateVersChaîne(DateSys(), maskDateSystème) + " à " + ...
	HeureVersChaîne(HeureSys(), "HH:MM:SS:CC")
hSvg.Destination = "Sauvegarde_" + ConnexionBase.BaseDeDonnées
hSvg.LimiteNombreSauvegarde = 2
hSvg.Source = ConnexionBase.BaseDeDonnées
hSvg.PlanificationComplète.Mois = "*"
hSvg.PlanificationComplète.JourDuMois = "*"
// Définition de la planification
dhDateHeureServeur est une DateHeure = ConnexionBase.InfoServeur(hInfoDate)
dhDateHeureServeur.Minute++
hSvg.PlanificationComplète.Heure = dhDateHeureServeur.Heure
hSvg.PlanificationComplète.Minute = dhDateHeureServeur.Minute
hSvg.PlanificationComplète.JourDeLaSemaine = "*"
hSvg.PlanificationComplète.JourDuMoisOuDeLaSemaine = Faux
hSvg.PlanificationDifférentielle.Mois = "*"
hSvg.PlanificationDifférentielle.JourDuMois = "*"
hSvg.PlanificationDifférentielle.Heure = "*"
hSvg.PlanificationDifférentielle.Minute = "*"
hSvg.PlanificationDifférentielle.JourDeLaSemaine = "*"
hSvg.PlanificationDifférentielle.JourDuMoisOuDeLaSemaine = Faux

// Ajout de la sauvegarde planifiée
SI ConnexionBase.AjouteSauvegardePlanifiée(hSvg) = Faux ALORS
	Erreur("Echec de la création de la sauvegarde planifiée", ...
		HErreurInfo(hErrComplet))
	RETOUR
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Connexion>.AjouteSauvegardePlanifiée(<Sauvegarde planifiée>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la sauvegarde planifiée a été ajoutée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Connexion> : (Variable de type Connexion)`**

Nom de la variable de type [Connexion](../WDLang4/1514073.md) décrivant la connexion pour laquelle une sauvegarde planifiée doit être ajoutée.

**`<Sauvegarde planifiée> : (Variable de type hDescriptionSauvegarde)`**

Nom de la variable de type [hDescriptionSauvegarde](../WDLang4/1000017455.md) manipulée.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Caractéristiques de la sauvegarde :
<a name="caracteristiques_sauvegarde_ELTPARAGRAPHE000232"></a>

- Sauvegarde du contenu d'un serveur HFSQL : toutes les bases de données du serveur, plusieurs ou une seule base de données, un ou plusieurs fichiers de données. Cette sauvegarde peut être réalisée même si une ou plusieurs bases de données sont en cours d'utilisation.

- **La sauvegarde effectuée correspondra à l'état de la base de données au début de la sauvegarde : la base de données sauvegardée est cohérente.**Certaines opérations sont interdites pendant la sauvegarde : suppression de fichiers et de bases de données, mise à jour de procédures stockées.

- La description de la sauvegarde est réalisée grâce à la variable de type [hDescriptionSauvegarde](../WDLang4/1000017455.md). Il est possible de définir :

	- une procédure stockée à exécuter AVANT la sauvegarde. Cette procédure peut si nécessaire annuler la sauvegarde.

	- une procédure stockée à exécuter APRES la sauvegarde.






<a name="NOTE0_2"></a>


### Droits nécessaires pour ajouter une sauvegarde planifiée
<a name="droits_necessaires_pour_ajouter_une_sauvegarde_planifiee_ELTPARAGRAPHE000250"></a>Pour ajouter une sauvegarde planifiée, l'utilisateur ou le groupe d'utilisateurs doit posséder : 

- le droit de faire des sauvegardes (constante *hDroitSauvegarde*). Ce droit s'applique aux serveurs et aux bases de données. Par exemple, pour faire une sauvegarde du serveur complet, il faut posséder le droit de faire des sauvegardes au niveau du serveur. 

- le droit de gérer des tâches (constante *hDroitGèreTâche*).




Pour savoir si un utilisateur ou un groupe d'utilisateurs possède ces droits, utilisez la fonction [&lt;Variable Connexion&gt;.InfoDroitServeur](../WDLang4/1000022668.md) ou [HInfoDroitDaseDeDonnées](../WDLang4/1000022666.md).

Pour modifier les droits d'un utilisateur ou d'un groupe d'utilisateurs, utilisez la fonction [&lt;Variable Connexion&gt;.ModifieDroitServeur](../WDLang4/1000022710.md) ou [&lt;Variable Connexion&gt;.ModifieDroitBaseDeDonnées](../WDLang4/1000022707.md).
<a name="NOTE0_3"></a>


### Manipulations d'une sauvegarde planifiée
<a name="manipulations_une_sauvegarde_planifiee_ELTPARAGRAPHE000287"></a>Plusieurs fonctions permettent de manipuler une sauvegarde planifiée : 

- [&lt;Variable Connexion&gt;.ExécuteSauvegardePlanifiée](../WDLang4/1000022660.md) : Permet d'exécuter une sauvegarde planifiée. 

- [&lt;Variable Connexion&gt;.ListeSauvegardePlanifiée](../WDLang4/1000022699.md) : Permet de lister les sauvegardes planifiées. 

- [&lt;Variable Connexion&gt;.ModifieSauvegardePlanifiée](../WDLang4/1000022721.md) : Permet de modifier les caractéristiques d'une sauvegarde planifiée. 

- [&lt;Variable Connexion&gt;.SupprimeSauvegardePlanifiée](../WDLang4/1000022766.md) : Permet de supprimer une sauvegarde planifiée. 




Il est également possible de : 

- restaurer une sauvegarde grâce à la fonction [&lt;Variable Connexion&gt;.RestaureSauvegarde](../WDLang4/1000022751.md).

- supprimer physiquement une sauvegarde grâce à la fonction [&lt;Variable Connexion&gt;.SupprimeSauvegarde](../WDLang4/1000022765.md).




<a name="XComposante"></a>

## Composante :
wd280hf.dll
