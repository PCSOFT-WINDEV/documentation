


## HLitSuivant (Fonction)

***En anglais : HReadNext***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Positionne sur l'enregistrement suivant d'un fichier de données en fonction d'une rubrique de parcours. L'enregistrement est lu et les variables HFSQL sont mises à jour (par exemple Client.Nom, c'est-à-dire la rubrique *Nom* du fichier *Client*).

La lecture se fait de la plus petite valeur à la plus grande valeur de la rubrique de parcours (consultez [les remarques](#NOTE0_1) pour plus de détails).

La fonction **HLitSuivant** permet de se positionner dans le fichier de données lors d'une boucle de parcours. Cette fonction peut être exécutée uniquement : 

- à la suite d'une fonction amorçant un parcours (par exemple [HLitPremier](../WDLang4/3044051.md) ou [HRecherchePremier](../WDLang4/3044125.md)),

- après un appel à la fonction [HChangeClé](../WDLang4/3044151.md).




Après l'exécution de la fonction **HLitSuivant**, plusieurs cas peuvent se présenter :


- le fichier est vide ou il n'existe pas d'enregistrement correspondant au filtre (défini par la fonction [HFiltre](../WDLang4/3044100.md)) : aucune lecture n'est effectuée et la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u>Vrai</u></u></u>.

- la fonction tente de bloquer un enregistrement déjà bloqué en lecture : aucune lecture n'est effectuée, la fonction [HErreurBlocage](../WDLang4/3044099.md) renvoie <u><u><u>Vrai</u></u></u> et la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u>Vrai</u></u></u>.
	
	
	
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : La gestion des blocages n'est pas disponible sur les bases de données accédées par JDBC.




Cette fonction peut être utilisée indifféremment avec les fichiers de données, les vues HFSQL ou les requêtes.

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
HLitPremier(Client, Nom)
TANTQUE HEnDehors() = Faux
	// Traitement de l'enregistrement
	HLitSuivant(Client, Nom)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HLitSuivant([<Fichier de données> [, <Rubrique de parcours>] [, <Options>]])`
---

**`<Résultat> : (Booléen)`**

Correspond à : 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur. Dans ce cas, la fonction [HErreur](../WDLang4/3044088.md) renvoie un entier différent de 0. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'obtenir plus de détails sur l'erreur. L'enregistrement n'est pas lu. 

- la valeur de la fonction [HTrouve](../WDLang4/3044104.md) dans les autres cas (l'enregistrement peut être lu, même si &lt;Résultat&gt; renvoie <u><u><u><u>Faux</u></u></u></u>). 




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données, de la vue ou de la requête manipulé. Si ce paramètre correspond à une chaîne vide (""), la fonction **HLitSuivant** manipule le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Rubrique de parcours> : (Chaîne de caractères optionnelle)`**

Nom de la rubrique utilisée pour parcourir le fichier de données, la vue ou la requête. Si ce nom n'est pas spécifié, la fonction **HLitSuivant** va utiliser :

- *Dans le cas d'un fichier de données* : la dernière rubrique de parcours utilisée sur ce fichier de données par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H). Si cette rubrique n'existe pas, la meilleure rubrique de parcours est automatiquement utilisée. 

- *Dans le cas d'une requête* : le ORDER BY de la requête si il existe, sinon selon la dernière rubrique utilisée. 

- *Dans le cas d'une vue* : la rubrique de tri de la vue (si elle existe), sinon sur la dernière rubrique utilisée.




**`<Options> : (Constante ou combinaison de constantes optionnelle)`**

Permet de paramétrer :

- le blocage réalisé sur l'enregistrement lu par la fonction **HLitSuivant**

- la gestion des doublons. Par défaut, tous les doublons sont parcourus.





|   |   |
| --- | --- |
| *hBlocageEcriture* | Blocage en écriture : l'enregistrement en cours de lecture pourra être lu par une autre application mais ne pourra pas être modifié par une autre application. |
| *hBlocageLectureEcriture* | Blocage en lecture/écriture : l'enregistrement en cours de lecture ne pourra ni être lu ni être modifié par une autre application. |
| *hBlocageNon* | Aucun blocage : l'enregistrement pourra être lu ou modifié par une autre application pendant la lecture. |
| *hDistinct* | Si des doublons sont présents, ce paramètre permet de lire un seul enregistrement parmi les doublons. Ce paramètre est pris en compte uniquement si le parcours est réalisé sur une rubrique clé.<br><br>![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Cette constante n'est pas prise en compte. |

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Ce paramètre est ignoré.![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Si le provider OLE DB ou le Connecteur Natif (également appelé Accès Natif) utilisé ne gère pas les blocages, les options de blocage seront sans effet.![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png) Les options de blocages spécifiées dans la fonction **HLitSuivant** ne sont pas prises en compte. Le mode de blocage spécifié avec la fonction [HLitPremier](../WDLang4/3044051.md) ou [HLitDernier](../WDLang4/3044140.md) restera effectif lors des appels aux fonctions **HLitSuivant** et [HLitPrécédent](../WDLang4/3044048.md).

Pour modifier le mode de blocage, il est nécessaire d'utiliser :

- soit les fonctions [HLitRecherchePremier](../WDLang4/3044036.md) ou [HlitRechercheDernier](../WDLang4/3044034.md),

- soit les fonctions [HLitPremier](../WDLang4/3044051.md) ou [HLitDernier](../WDLang4/3044140.md).

- soit les fonctions [HBloqueNumEnr](../WDLang4/3044152.md) ou [HDébloqueNumEnr](../WDLang4/3044194.md).
	![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Les options de blocage ne sont pas prises en compte. Utilisez des fonctions de lecture bloquantes (fonction **HLitSuivantBloque**) conservées par compatibilité.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Lecture selon une rubrique clé ou non
<a name="lecture_selon_une_rubrique_cle_non_ELTPARAGRAPHE000271"></a>Si la rubrique utilisée est une clé, la fonction **HLitSuivant** lit l'enregistrement pour lequel la valeur de la clé est la plus grande. L'ordre de tri pris en compte est l'ordre de tri spécifié dans l'analyse pour cette clé. 

**Remarque** : Dans le cas d'une boucle de recherche (fonction [HLitRecherchePremier](../WDLang4/3044036.md) par exemple), quand la fonction **HLitSuivant** lit l'enregistrement pour lequel la valeur de la clé est la plus grande, la fonction [HTrouve](../WDLang4/3044104.md) permet de savoir si l'enregistrement correspond au critère de la recherche ou non.

Si la rubrique n'est pas une clé, la fonction **HLitSuivant** lit l'enregistrement actif suivant. En cas de parcours du fichier de données, les enregistrements seront triés selon leur numéro d'enregistrement. 
Dans ce cas, la rubrique de parcours sélectionnée apparaîtra en rouge sous l'éditeur de code et un warning sera affiché dans le [volet "Code"](../Editeurs/2027009.md).

**Remarque** : La [complétion automatique](../Editeurs/2013001.md) propose uniquement les rubriques clés.
<a name="NOTE0_2"></a>


### Mémos
<a name="memos_ELTPARAGRAPHE000309"></a>Les mémos associés à l'enregistrement peuvent être automatiquement lus ou non lors de la lecture de l'enregistrement. La fonction [HGèreMemo](../WDLang4/3044139.md) permet de personnaliser cette lecture automatique.

Si les mémos sont gérés, lorsque l'enregistrement est lu, les mémos texte associés sont également lus. Les mémos binaires ne sont lus que lorsqu'ils sont utilisés explicitement (fonction [HExtraitMémo](../WDLang4/3044072.md)).
<a name="NOTE0_3"></a>


### Parcours des enregistrements correspondant à une condition
<a name="parcours_des_enregistrements_correspondant_une_condition_ELTPARAGRAPHE000326"></a>En général, les fonctions [HLitRecherche](../WDLang4/3044050.md), [HLitRecherchePremier](../WDLang4/3044036.md), [HLitRechercheDernier](../WDLang4/3044034.md) permettent de se positionner dans le fichier de données pour effectuer une boucle de parcours parmi les enregistrements correspondant à une condition. Les fonctions **HLitSuivant** et [HLitPrécédent](../WDLang4/3044048.md) permettent de lire l'enregistrement suivant ou précédent correspondant à la condition :

- si la rubrique utilisée est une clé, la fonction **HLitSuivant** lira les enregistrements suivants correspondant aux valeurs supérieures ou égales à la valeur recherchée.

- si la rubrique utilisée n'est pas une clé, la fonction **HLitSuivant** lira les enregistrements suivants correspondant aux valeurs égales à la valeur recherchée.




Pour ne plus tenir compte de la recherche lors du passage à l'enregistrement suivant ou précédent, il suffit d'utiliser une des fonctions suivantes :

- [HAnnuleRecherche](../WDLang4/3044157.md)

- [HLitDernier](../WDLang4/3044140.md)

- [HLitPremier](../WDLang4/3044051.md)




**Attention** : si un parcours doit être effectué avec la fonction **HLitSuivant**, la recherche initiale (fonctions [HLitRecherche](../WDLang4/3044050.md), [HLitRecherchePremier](../WDLang4/3044036.md), [HLitRechercheDernier](../WDLang4/3044034.md)) ne doit pas utiliser la constante *hLimiteParcours*.
<a name="NOTE0_4"></a>


### Modification de la valeur de la clé de parcours
<a name="modification_valeur_cle_parcours_ELTPARAGRAPHE000382"></a>Si la valeur de la rubrique de parcours est modifiée avant d'utiliser la fonction **HLitSuivant**, l'enregistrement en cours pourra être lu à nouveau dans la suite du parcours par la fonction **HLitSuivant**.

En effet, la modification de la rubrique de parcours met à jour la clé d'index du fichier. Lors de la lecture des enregistrements suivants, cette modification est prise en compte. 

Cette remarque est également valable lors de l'utilisation de la fonction **HLitSuivant** sans clé de parcours sur une requête triée (ORDER BY).
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Blocages
<a name="blocages_ELTPARAGRAPHE000406"></a>Par défaut (paramètre &lt;Option&gt; non spécifié), aucun blocage de l'enregistrement n'est réalisé.

Si un blocage est spécifié (paramètres *hBlocageEcriture* ou *hBlocageLectureEcriture*), la lecture de l'enregistrement sera réalisée uniquement si cet enregistrement n'est pas déjà bloqué.

![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Si le provider OLE DB ou le Connecteur Natif utilisé ne gère pas les blocages, les options de blocage seront sans effet.
<a name="NOTE0_6"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000421"></a>

- Le numéro de l'enregistrement en cours est connu avec la fonction [HNumEnr](../WDLang4/3044063.md).

- La fonction [HChangeClé](../WDLang4/3044151.md) permet de modifier la clé de parcours, tout en restant positionné sur l'enregistrement en cours.

- Pour optimiser le temps des premiers parcours d'un fichier de données, utilisez la fonction [HOptimise](../WDLang4/3044005.md) sur ce fichier de données.




<a name="XComposante"></a>

## Composante :
wd280hf.dll
