


## HGèreJournal (Fonction)

***En anglais : HSetLog***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Active ou désactive la gestion du journal d'un fichier de données journalé.

**Remarques** : 

- Par défaut, la gestion du journal est activée pour tous les fichiers de données décrits comme étant journalés dans la description de l'analyse.

- La journalisation n'est pas disponible lors de l'accès à une base de données via .



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Désactiver la gestion du journal sur le fichier de données Client
HGèreJournal(Client, Faux)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HGèreJournal([<Fichier de données>, ] <Activation>)`
---

**`<Résultat> : (Booléen)`**

Correspond à l'ancienne gestion du journal (avant utilisation de la fonction **HGèreJournal**) : 

- <u><u><u><u>Vrai</u></u></u></u> si la gestion du journal était active, 

- <u><u><u><u>Faux</u></u></u></u> si la gestion du journal n'était pas active.




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données manipulé. 
Si ce paramètre n'est pas spécifié ou est égal à "\*", la nouvelle gestion spécifiée s'applique à tous les fichiers de données décrits dans l'analyse comme étant journalés.

**`<Activation> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la gestion du journal est activée, 

- <u><u><u><u>Faux</u></u></u></u> si cette gestion doit être désactivée. 


Si seul ce paramètre est précisé, le mode de gestion spécifié s'applique à tous les fichiers de données.  




<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Gestion du journal
<a name="gestion_journal_ELTPARAGRAPHE000102"></a>Les opérations réalisées sur le fichier de données après un appel à la fonction **HGèreJournal** (faux) ne seront pas journalées : il ne sera pas possible d'effectuer un "UNDO" sur ces fonctions.

Conseils :

- **Si la gestion du journal doit être désactivée, il est conseillé de la désactiver définitivement.**
	En effet, lors de la réactivation de la journalisation d'un fichier de données, le journal considèrera que le fichier de données n'a pas changé depuis la dernière opération journalée. Si ce n'est pas le cas, le journal risque d'être déphasé par rapport au contenu réel du fichier de données, et donc de ne plus être exploitable.

- **Ne pas désactiver la gestion du journal si le fichier de données est journalé pour les opérations de lecture.**
	Lors de la journalisation d'une opération d'écriture, les enregistrements AVANT et APRES l'opération sont systématiquement sauvegardés. 
	Lors de la journalisation d'une opération de lecture, l'enregistrement déjà sauvegardé n'est pas comparée à l'enregistrement lu. La sauvegarde de l'enregistrement lu peut donc être différente de la valeur effectivement lue si l'enregistrement a été modifié pendant que la journalisation était désactivée.




**Attention** : Si le nom du fichier de données correspond à "JournalOperation" ou "JournalIdentification", la journalisation des opérations dans ces journaux est stoppée et les fichiers de données sont fermés. La journalisation continuera cependant dans les "fichiers de sauvegarde des enregistrements".
<a name="NOTE0_2"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000127"></a>

- Les fichiers xBase ne peuvent pas être journalés.

- L'appel de cette fonction sur un fichier de données non défini comme journalé dans l'analyse n'a aucun effet.

- **Intérêt** : si une analyse est décrite avec journalisation des fichiers de données, les programmes gèrent les journaux. En définissant dans un fichier de paramètres (géré dans le programme) un paramètre spécifiant l'utilisation ou non des journaux, il sera possible de choisir lors de l'installation chez un client si les fichiers de données seront journalés ou non, sans recompiler les programmes.

- Pour désactiver définitivement la journalisation, il est nécessaire de : 

	- supprimer la gestion des journaux dans l'analyse. 

	- générer l'analyse. 

	- effectuer une mise à jour automatique de l'application. 







<a name="XComposante"></a>

## Composante :
wd280hf.dll
