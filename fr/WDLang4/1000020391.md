


## HNotifListeDestinataireCC (Fonction)

***En anglais : HNotifListCCRecipient***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie la liste des destinataires d'une notification envoyée via les Centres de Contrôle (outil de messagerie WDBal). Cette notification est envoyée par le serveur HFSQL lorsqu'il rencontre un problème. 

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
cnxConnexionCS est une Connexion
cnxConnexionCS.Provider = hAccèsHFClientServeur
cnxConnexionCS.Utilisateur = "admin"
cnxConnexionCS.MotDePasse = ""
cnxConnexionCS.Serveur = "test:4900"
HOuvreConnexion(cnxConnexionCS)

ListeDestEmail est une chaîne
ListeDestEmail = HNotifListeDestinataireCC(cnxConnexionCS)

POUR TOUT CHAÎNE UnDestinataire DE ListeDestEmail SEPAREE PAR RC
	sDestinataire est une chaîne = ExtraitChaîne(UnDestinataire, 1, TAB)
	Notif est un entier = ExtraitChaîne(UnDestinataire, 2, TAB)
	NiveauNotif est une chaîne
	SELON Notif
		CAS hNotifErreur : NiveauNotif = "Niveau minimal : Erreurs"
		CAS hNotifAvertissement : NiveauNotif = "Niveau minimal : Avertissement"
		CAS hNotifCritique : NiveauNotif = "Niveau minimal : Critique"			
	FIN
	Trace(sDestinataire + TAB + NiveauNotif)
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = HNotifListeDestinataireCC(<Connexion>)`
---

**`<Résultat> : (Chaîne de caractères)`**

Liste des destinataires de la notification via les Centres de Contrôle. La liste est de la forme : 

```txt
<Nom du destinataire> + TAB + <Niveau de notification> + RC + ...
```
où : 

- &lt;Nom du destinataire&gt; : chaîne de caractères correspondant au nom du destinataire de la notification. 

- &lt;Niveau de notification&gt; : constante de type entier correspondant au niveau minimum de gravité du problème à partir duquel une notification est envoyée. Les valeurs disponibles sont les suivantes : 
	


|   |   |
| --- | --- |
| *hNotifAvertissement* | Les notifications seront envoyées dès le niveau avertissement (pour les problèmes de type avertissement, critique et erreur). |
| *hNotifCritique* | Les notifications seront envoyées dès le niveau critique (pour les problèmes de type critique et erreur). |
| *hNotifErreur* | Les notifications seront envoyées seulement pour les problèmes de type erreur. |






**`<Connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion à manipuler. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).






<a name="XComposante"></a>

## Composante :
wd280hf.dll
