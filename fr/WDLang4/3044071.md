
## HErreurInfo (Fonction)

***En anglais : HErrorInfo***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie une information détaillée sur la dernière erreur déclenchée par le moteur HFSQL.

**Remarques** :

- Cette fonction doit être appelée immédiatement après l'appel de la fonction qui échoue. En effet, l'appel à une fonction (différente d'une fonction d'erreur) peut ré-initialiser et modifier le compte-rendu de la fonction **HErreurInfo**.

- La fonction [ErreurInfo](../WDLang1/3013008.md) est équivalente à la fonction **HErreurInfo**.







<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003044071&name=herreurinfo_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Gestion d'une erreur lors de la création d'un fichier
SI HCréation(Client) = Faux ALORS
	Erreur("Erreur HFSQL : " + HErreurInfo())
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HErreurInfo([<Type d'information>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Libellé de l'information demandée, 

- Chaîne vide ("") si aucune erreur n'est survenue.




**`<Type d'information> : (Constante optionnelle de type entier.)`**

Permet de préciser le type d'information à afficher. Si ce paramètre n'est pas précisé, le message associé à l'erreur est renvoyé. 
**Remarque** : Toutes ces informations ne sont pas présentes pour toutes les erreurs. Une information est présente uniquement si elle a un lien avec l'erreur. Dans le cas contraire, &lt;Résultat&gt; est une chaîne vide.


|   |   |
| --- | --- |
| *hErrADO* | Code d'erreur renvoyé par ADO. Le message correspondant peut être connu avec la constante *hErrMessageADO*.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hErrBase* | ![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Code d'erreur renvoyé par la base de données. Le message correspondant peut être connu avec la constante *hErrMessageBase* |
| *hErrCode* | Numéro de la dernière erreur déclenchée par le moteur HFSQL.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible.<br><br><br><br> |
| *hErrCodeSystème* | Numéro de l'erreur système associée (si elle existe)<br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hErrComplet* | Toutes les informations de l'erreur (ligne de l'erreur, traitement en cours, ...).<br>**Remarque** : Renvoie les mêmes informations que celles récupérées lors d'un clic sur le bouton "Copier" dans la fenêtre d'erreur du WLangage. |
| *hErrFIC* | Nom complet du fichier de données (" .FIC") associé à l'erreur. <br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hErrFichier* | Nom logique du fichier de données associé à l'erreur |
| *hErrInfoBlocage* | ![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) Lors d'une erreur de blocage (la fonction [HErreurBlocage](../WDLang4/3044099.md) renvoie <u><u><u><u>Vrai</u></u></u></u> ou l'erreur 70100), cette constante permet de renvoyer les informations sur le blocage. Ces informations sont les mêmes que celles renvoyées par la fonction [HInfoBlocage](../WDLang4/3044307.md) (la durée de vie du blocage n'est pas indiquée). <br>Dans le cas où l'accès à la base de données a été bloqué par la fonction [HInterditAccèsBaseDeDonnées](../WDLang4/3044286.md) (erreur 74011), le résultat est de la forme : <br><br><pre><code><Nom de la base de données bloquée> + TAB +<br> <Login de l'utilisateur qui a bloqué la base> + TAB + <br><Machine à partir de laquelle la base a été bloquée></code></pre><br><br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hErrInfoClient* | Informations sur la couche client utilisée par le Connecteur Natif ayant renvoyé l'erreur. |
| *hErrInfoDebug* | Informations spécifiques au débogage du problème rencontré. Ces informations ne doivent être affichées et communiquées qu'en cas de demande expresse de PC SOFT.<br>Dans le cas de l'exécution d'une requête par OLE DB, cette option permet de récupérer le code de la requête SQL réellement exécutée sur la base de données.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible.<br><br> |
| *hErrInfoServeur* | Informations sur le serveur utilisé par le Connecteur Natif ayant renvoyé l'erreur.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |
| *hErrLiaison* | Nom de la liaison associée à l'erreur. <br><br> |
| *hErrListeFic* | Liste des fichiers HFSQL en erreur. <br><br>Exemple d'utilisation : Lors de la création d'une réplication, si des fichiers de données possèdent un mot de passe, permet d'obtenir la liste des fichiers de données en erreur. Cette liste contient les noms physiques des différents fichiers de données séparés par des Retour Chariot (RC). <br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible.<br><br><br><br><br><br> |
| *hErrMessage* <br>(valeur par défaut) | Message associé à l'erreur |
| *hErrMessageADO* | Message correspondant à l'erreur renvoyée par ADO (hErrADO). <br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hErrMessageBase* | ![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Message correspondant à l'erreur renvoyée par la base de données (*hErrBase*) |
| *hErrMessageNatif* | Message correspondant à l'erreur renvoyée par le provider d'accès natif (*hErrCodeSystèmeNatif*)<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |
| *hErrMessageOLEDB* | Message correspondant à l'erreur renvoyée par le système lors d'une connexion OLE DB (*hErrOLEDB*)<br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hErrMessageSystème* | Message de l'erreur système associée (si elle existe)<br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hErrMMO* | Nom complet du fichier mémo (".MMO") associé à l'erreur<br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hErrNatif* | Code d'erreur renvoyé par la DLL utilisée pour le Connecteur Natif. Pour plus de détails sur ce code d'erreur, consultez la documentation fournie avec le Connecteur Natif. <br>Le message correspondant peut être connu avec la constante *hErrMessageNatif*.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hErrNDX* | Nom complet du fichier d'index (" .NDX") associé à l'erreur.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible.<br><br> |
| *hErrNumEnr* | Numéro de l'enregistrement associé à l'erreur<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible.<br><br> |
| *hErrOLEDB* | Code d'erreur renvoyé par le système lors d'un accès par une connexion OLE DB.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hErrPositionErreurSQL* | Position de l'erreur SQL dans le code SQL de la requête exécutée par la fonction [HExécuteRequêteSQL](../WDLang4/3044084.md).<br><br>Cette position est donnée sous la forme : <br><br><pre><code><Ligne du début de l'erreur> + TAB + ...<br><Colonne du début de l'erreur> + TAB + ...<br><Ligne de la fin de l'erreur> + TAB + ...<br><Colonne de la fin de l'erreur></code></pre><br><br><br> |
| *hErrRubrique* | Nom de la rubrique associée à l'erreur. <br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible.<br><br> |
| *hErrServeur* | Nom du serveur HFSQL Client/Serveur qui provoque l'erreur.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |
| *hErrWDD* | Nom complet du fichier de l'analyse (fichier .WDD) associé à l'erreur |







<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
