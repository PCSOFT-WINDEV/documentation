
## SQLLitCol (Fonction)

***En anglais : SQLGetCol***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère le contenu de la colonne spécifiée dans le résultat de la requête, pour la ligne en cours.

**Attention** : Cette fonction doit être utilisée lors d'un parcours du résultat de la requête de type "SQLAvance/SQLLitCol". Pour plus de détails sur les différents types de parcours du résultat d'une requête SQL, consultez [Types de parcours SQL](../WDLang4/3072025.md).




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
i est un entier = 0
SQLExec("SELECT NOM, PRENOM, POSTE, PHOTO FROM CLIENT", "REQ1")
// Récupérer la requête ligne à ligne
TANTQUE SQLAvance("REQ1") = 0	// Il y a encore une ligne à lire
	i++
	// Récupérer les données
	NOM[i] = SQLLitCol("REQ1", 1)
	PRENOM[i] = SQLLitCol("REQ1", 2)
	POSTE[i] = SQLLitCol("REQ1", 3)
FIN
SQLFerme("REQ1")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = SQLLitCol(<Nom de la requête> , <Numéro de la colonne>)`
---

**`<Résultat> : (Chaîne de caractères)`**

Valeur de la colonne.

**`<Nom de la requête> : (Chaîne de caractères)`**

Nom de la requête créée et exécutée avec la fonction [SQLExec](../WDLang4/3072007.md) ou exécutée avec la fonction [SQLExecWDR](../WDLang4/3072010.md).

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les requêtes créées avec l'éditeur de requête doivent être spécifiées sous forme d'une chaîne de caractères avec guillemets. 



**`<Numéro de la colonne> : (Entier)`**

Numéro de la colonne à récupérer. Cette colonne correspond à une colonne de la requête (et non pas à une colonne de la table). Si plusieurs colonnes doivent être récupérées, l'indice des colonnes doit être donné dans l'ordre croissant. Par exemple, il faut faire SQLCol("REQ1", 1) puis SQLCol("REQ1", 2).  
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les colonnes peuvent être récupérées dans n'importe quel ordre.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Ligne en cours de la requête
<a name="ligne_cours_requete_ELTPARAGRAPHE000109"></a>La ligne en cours est positionnée par la fonction [SQLFetch](../WDLang4/3072011.md).


<a name="NOTE0_2"></a>




### Colonnes de la requête
<a name="colonnes_requete_ELTPARAGRAPHE000121"></a>

- Pour lire les colonnes de type mémo, utilisez la fonction [SQLLitMémo](../WDLang4/3072020.md). Pour lire les colonnes de type mémo texte, utilisez la fonction [SQLLitMémoTexte](../WDLang4/3072012.md). 
	
	

- Le nombre de colonnes du résultat de la requête est connu grâce à la variable *SQL.NbCol* (affectée par la fonction [SQLInfoGene](../WDLang4/3072028.md)).

- Si la colonne est de type numérique, la fonction **SQLLitCol** convertit le résultat en une chaîne de caractères. Il est toutefois possible en WLangage d'affecter le résultat retourné par la fonction **SQLLitCol** dans une variable de type numérique. Le WLangage effectue automatiquement la conversion.

- Les colonnes doivent impérativement être récupérées par ordre de numéro croissant. 
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les colonnes peuvent être récupérées dans n'importe quel ordre.

- La même colonne ne peut pas être récupérée plusieurs fois à la suite. En effet, la seconde fois, le résultat récupéré sera une chaîne vide.
	

- **SQLLitCol**ne permet pas de récupérer des chaînes binaires.





<a name="NOTE0_3"></a>




### Requête sans résultat
<a name="requete_sans_resultat_ELTPARAGRAPHE000176"></a>La fonction **SQLLitCol** ne doit pas être appelée si la requête n'a pas renvoyé de résultat : il faut tester la variable SQL.EnDehors après s'être positionné dans le résultat de la requête et avant d'appeler la fonction **SQLLitCol**.

Par exemple :


```wl
// Récupération de la valeur de la 1ère colonne du 1er enregistrement
 Valeur est une chaîne
 TexteRequête est une chaîne
 TexteRequête = "SELECT NOMCLI, ADR1, ADR2, VILLE, CP FROM FACT"
 SQLExec(TexteRequête, "REQ1")
 Valeur = SQLLitCol("REQ1", 1)
```



<a name="NOTE0_4"></a>


### Utilisation de tabulations dans les rubriques
<a name="utilisation_tabulations_dans_les_rubriques_ELTPARAGRAPHE000194"></a>Les fonctions SQL permettent d'insérer des tabulations dans les rubriques des fichiers.

Pour récupérer les valeurs des rubriques (avec les caractères TAB), il est conseillé d'utiliser [un parcours du type SQLFetch/SQLLitCol](../WDLang4/3072025.md).

Exemple : Fonction **SQLLitCol** et les tabulations dans les rubriques

Les rubriques des enregistrements à récupérer sont les suivantes :


|   |   |   |
| --- | --- | --- |
|   | Rubrique 1 | Rubrique 2 |
| Enregistrement 1 | John | Smith |
| Enregistrement 2 | John + tab + Mac | Doughnut |

Pour le premier enregistrement :

- SQLLitCol(REQ, 1) : récupère John

- SQLLitCol(REQ, 2) : récupère Smith




Pour le second enregistrement :

- SQLLitCol(REQ,1 ) : récupère John + tab + Mac

- SQLLitCol(REQ, 2) : récupère Doughnut





<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png) 

### Fonctions SQLCol et SQLLitCol
<a name="fonctions_sqlcol_docparampagetitleshort_ELTPARAGRAPHE000243"></a>Les fonctions [SQLCol](../WDLang4/3072018.md) et **SQLLitCol** sont équivalentes lors d'un accès à des données via OLE DB ou HFSQL. Il faut cependant respecter le type de parcours associé à chacune de ces fonctions :

- Fonction [SQLCol](../WDLang4/3072018.md) : parcours de type "SQLPremier/SQLCol".

- Fonction **SQLLitCol** : parcours de type "SQLAvance/SQLLitCol".




Pour plus de détails sur ces deux types de parcours, consultez [Types de parcours SQL](../WDLang4/3072025.md).


<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![ODBC](https://doc.pcsoft.fr/ext/images/fr/ODBC.png) 

### Récupération de rubriques de type Float sur Oracle (via ODBC)
<a name="recuperation_rubriques_type_float_sur_oracle_via_odbc_ELTPARAGRAPHE000276"></a>Par défaut, le séparateur décimal utilisé pour les rubriques de type Float sur Oracle est le point. Or le driver ODBC renvoie la valeur avec en utilisant la virgule comme séparateur décimal. Lors de l'affectation de la valeur dans un champ de type numérique, les décimales sont perdues.

Pour éviter ce problème, il suffit de configurer le séparateur décimal pour la connexion en cours :


```wl
// Connexion à la base de données Oracle 
SQLConnecte("MaBaseOracle", "User", "Passe", "", "ODBC") 
// Requête pour changer le séparateur décimal 
SQLExec("ALTER SESSION SET NLS_NUMERIC_CHARACTERS ='. '", "ReqTemp")
```




<a name="XComposante"></a>

## Composante :
wd280hf.dll
