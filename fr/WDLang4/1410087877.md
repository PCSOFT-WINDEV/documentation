


## &lt;Connexion HFSQL&gt;.TransactionRetourneAuPointDeSauvegarde (Fonction)

***En anglais : &lt;HFSQL connection&gt;.TransactionRollbackToSavepoint***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Annule la transaction jusqu'au point de sauvegarde.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MaConnexion est une Connexion

// Début des transactions
MaConnexion.TransactionDébut()

// Réalisation d'actions A

// Déclaration d'un point de sauvegarde
MaConnexion.TransactionPointDeSauvegarde("MonPointDeSauvegarde")

// Réalisation d'actions B

// Annulation de toutes les actions depuis la déclaration de MonPointDeSauvegarde
MaConnexion.TransactionRetourneAuPointDeSauvegarde("MonPointDeSauvegarde")

// Réalisation d'actions C

// Déclaration d'un point de sauvegarde
MaConnexion.TransactionPointDeSauvegarde("MonPointDeSauvegarde2")

// Réalisation d'actions D

// Validation (commit) des transactions
// Toutes les actions A, C et D sont prises en compte, 
// mais pas les actions B car elles sont situées entre TransactionPointDeSauvegarde() 
// et TransactionRetourneAuPointDeSauvegarde

MaConnexion.TransactionFin()

// MonPointDeSauvegarde2 est désactivé
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = <Connexion>.TransactionRetourneAuPointDeSauvegarde(<Nom du point de sauvegarde>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'annulation a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'obtenir plus de renseignements sur l'erreur.




**`<Connexion> : (Nom de champ)`**

Nom de la variable de type [Connexion](../WDLang4/1514073.md) décrivant la connexion vers un serveur HFSQL.

**`<Nom du point de sauvegarde> : (Chaîne de caractères)`**

Nom du point de sauvegarde jusqu'auquel la transaction doit être annulée. Si le point de sauvegarde n'existe pas, une erreur est renvoyée.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Cette fonction doit impérativement être utilisée dans une transaction. 

- L'ordre SQL correspondant est également disponible : "ROLLBACK TO SAVEPOINT identifiant".

- Cette fonction n'est pas disponible : 

	- sur des fichiers HFSQL en cluster, 

	- avec des fichiers manipulés via un Connecteur Natif.







<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
