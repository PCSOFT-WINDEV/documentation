
## Indexation partielle des mémos
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000172"></a>
Il est possible d'indexer le contenu d'une rubrique de type mémo texte. Les mémos texte étant de taille importante, le mécanisme de l'indexation partielle des mémos est utilisé.

L'indexation partielle des mémos texte permet de définir le nombre de caractères du mémo texte qui seront indexés. Ce mécanisme permet d'optimiser la taille des index et la vitesse de recherche.

Par exemple, si le contenu d'une facture (présent dans un mémo texte) est indexé, il ne sera pas forcément nécessaire d'indexer pour chaque facture les trois pages de conditions générales de ventes qui suivent les données utiles.





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment indexer partiellement les mémos texte ?
<a name="comment_indexer_partiellement_les_memos_texte_ELTTEXTE000196"></a>
L'indexation des mémos texte peut être réalisée :

- directement sous l'éditeur d'analyses (pour les fichiers de données décrits dans l'analyse)

- en WLangage pour les fichiers de données créés par programmation.





<a name="NOTE2_2"></a>


### Mise en place de l'indexation des mémos texte sous l'éditeur d'analyses
<a name="mise_place_indexation_des_memos_texte_sous_editeur_analyses_ELTPARAGRAPHE000047"></a>Pour mettre en place l'indexation des mémos texte :

1. Sous l'éditeur d'analyses, affichez la description des rubriques d'un fichier de données contenant un mémo texte.

2. Sélectionnez la rubrique associée à un mémo texte.

3. Dans la partie droite de l'écran, il est possible de spécifier si le mémo doit être une clé ou non : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Indexation%20des%20m%E9mos%20-%20HC%20N%B0001.gif)


4. Indiquez :

	- le type de clé partielle : non clé, clé unique ou avec doublons.

	- le sens de parcours : ascendant ou descendant.

	- la taille de la partie indexée du mémo. Cette taille doit être spécifiée en nombre de caractères.

	- si la recherche doit être sensible à la casse, à l'accentuation et aux espaces. 




5. Validez.  

6. Générez l'analyse. Si vous avez déjà utilisé des fichiers de données, une modification automatique des fichiers de données est réalisée.





<a name="NOTE2_3"></a>


### Mise en place de l'indexation des mémos texte par programmation
<a name="mise_place_indexation_des_memos_texte_par_programmation_ELTPARAGRAPHE000068"></a>Pour mettre en place l'indexation des mémos texte lors de la description d'un fichier de données par programmation, il suffit d'utiliser propriétés WLangage disponibles sur les rubriques pour indiquer les caractéristiques de la clé de type mémo texte.

| Nom de la propriété | Effet |
| --- | --- |
| [Nom](../Proprietes/2510082.md) | Nom de la rubrique |
| [SensibleAccentuation](../Proprietes/2512077.md) | Prise en compte de l'accentuation dans les différentes recherches effectuées sur la rubrique. |
| [SensibleCasse](../Proprietes/2512085.md) | Prise en compte de la casse (majuscules/minuscules) dans les différentes recherches effectuées sur la rubrique. |
| [SensiblePonctuation](../Proprietes/2512087.md) | Prise en compte de la ponctuation (virgule, point, ...) dans les différentes recherches effectuées sur la rubrique. |
| [Taille](../Proprietes/2510125.md) | Taille d'une rubrique de type texte (chaîne de caractères, mémo texte, caractère). |
| [TailleClé](../Proprietes/1000017277.md) | Taille de la partie à indexer du mémo texte. |
| [Type](../Proprietes/2510131.md) | Identifie et modifie le type d'une rubrique. |
| [TypeClé](../Proprietes/2512060.md) | Caractéristiques d'une rubrique de type clé. |
| [TypeTri](../Proprietes/2512091.md) | Caractéristiques de tri sur une rubrique. |

Exemple :


```wl
MonIndexMémo est une Description de Rubrique
MonIndexMémo.Nom = "Commentaires"
MonIndexMémo.Type = hRubMémoTexte
MonIndexMémo.TypeClé = hCléUnique
MonIndexMémo.TypeTri = hCroissant
MonIndexMémo.SensibleAccentuation = Faux
MonIndexMémo.SensibleCasse = Faux
MonIndexMémo.SensiblePonctuation = Faux
MonIndexMémo.TailleClé = 50
HDécritRubrique(Livre, MonIndexMémo)
```





