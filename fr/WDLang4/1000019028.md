


## HPrépareRequête (Fonction)

***En anglais : HPrepareQuery***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Initialise une requête et déclare cette requête au serveur de base de données pour optimiser les prochaines exécutions de cette requête. Cette requête n'est pas exécutée. La requête pourra ensuite être exécutée avec la fonction [HExécuteRequête](../WDLang4/3044080.md). Cette fonction peut aussi bien être utilisée avec requêtes avec ou sans bind. 

Pour libérer les ressources de cette requête, utilisez la fonction [HAnnuleDéclaration](../WDLang4/3044174.md).

Cette fonction est conseillée lors de l'exécution successive d'une même requête en modifiant uniquement quelques paramètres de cette requête à chaque exécution.


**Cette fonction est optionnelle et ne peut être utilisée que sur des bases de données Client/Serveur (actuellement disponible sur AS/400).**

**Pour les autres bases accédées par un Connecteur Natif, OLE DB ou ODBC, la fonction [HPrépareRequêteSQL](../WDLang4/3044119.md) exécute la requête.**

Sur les bases de données HFSQL (HFSQL Classic ou Client/Serveur) ou sur les bases xBase, cette fonction ne peut pas être utilisée. 

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
HPrépareRequête(REQ_MaReq, MaConnexion, hRequêteSansCorrection)

POUR i = 1 A 10
	REQ_MaReq.nom = "Nom" + i
	REQ_MaReq.prenom = "Prenom" + i
	REQ_MaReq.age_ = i
	HExécuteRequête(REQ_MaReq)
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = HPrépareRequête(<Requête> , <Connexion> [, <Mode>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'initialisation de la requête a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'obtenir plus d'informations sur le problème rencontré.




**`<Requête> : (Chaîne de caractères)`**



- Nom et chemin complet de la requête (fichier ".WDR") à initialiser.

- Nom logique de la requête à initialiser. 


Si une requête de même nom est déjà déclarée, elle est remplacée par la nouvelle requête.

**`<Connexion> : (Chaîne de caractères ou variable de type Connexion)`**

Connexion via laquelle la requête sera exécutée. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).




**`<Mode> : (Constante optionnelle de type Entier)`**

Option pour l'initialisation de la requête : 


|   |   |
| --- | --- |
| *hRequêteSansCorrection* | ![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Le moteur HFSQL n'effectue aucune vérification de la requête. Cette option doit être utilisée si la requête comporte des ordres spécifiques à un type de connexion (Oracle, SQL Server, ...).<br><br>Attention : si cette constante est utilisée :<br><br>- il est nécessaire de préciser le nom de la connexion (paramètre &lt;Connexion&gt;).<br><br>- la fonction [HFiltre](../WDLang4/3044100.md) ne peut pas être utilisée sur la requête manipulée.<br><br>- il est conseillé de ne pas spécifier de rubrique de parcours dans les fonctions suivantes : [HDernier](../WDLang4/3044101.md), [HLitDernier](../WDLang4/3044140.md), [HLitPremier](../WDLang4/3044051.md), [HPremier](../WDLang4/3044113.md), [HRechercheDernier](../WDLang4/3044129.md), [HRecherchePremier](../WDLang4/3044125.md).<br><br><br> |





<a name="XComposante"></a>

## Composante :
wd280hf.dll
