


## HModifie (Fonction)

***En anglais : HModify***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie l'enregistrement spécifié ou l'enregistrement présent en mémoire dans le fichier de données (la requête ou la vue). Les index correspondant à toutes les clés utilisées dans le fichier de données sont mis à jour automatiquement. Les mémos sont ajoutés si nécessaire si la gestion des mémos est active ([HGèreMémo](../WDLang4/3044139.md)).

Après l'exécution de la fonction **HModifie** :

- il est conseillé de réaliser une gestion des erreurs :
	![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) WINDEV propose une gestion automatique des erreurs pour les 5 types d'erreur suivants : Erreur de doublons, Erreur d'intégrité, Erreur de mot de passe, Erreur de conflit de modification et d'état lors du conflit de modification, Erreur de blocage. Pour plus de détails, consultez [Gestion assistée des erreurs HFSQL](../WDLang4/3044188.md).
	

- si la gestion des doublons est activée et si le fichier de données contient une clé unique, la fonction [HErreurDoublon](../WDLang4/3044077.md) renvoie <u><u><u>Vrai</u></u></u> si la valeur de la clé modifiée n'est pas unique. L'enregistrement n'est pas modifié.

- si un problème de blocage est rencontré (tentative de modification d'un enregistrement bloqué), la fonction [HErreurBlocage](../WDLang4/3044099.md) renvoie <u><u><u>Vrai</u></u></u> et l'enregistrement n'est pas modifié.
	
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : La gestion des blocages n'est pas disponible sur les bases de données accédées par JDBC. 

- le numéro de l'enregistrement en cours n'est pas modifié. Par défaut, le parcours en cours n'est pas affecté.




**Remarque** : Cette fonction peut être utilisée sur un fichier de données, une vue HFSQL ou une requête.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003044042&name=hmodifie_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Recherche l'enregistrement
HLitRecherchePremier(Client, Nom, "Moulin")

SI HTrouve() = Vrai ALORS
	// Modification d'un enregistrement dans un fichier de données
	// (enregistrement décrit par programmation)
	Client.Prenom = "François"
	Client.Ville = "Montpellier"
	Client.CodeP = "34000"
	Client.Pays = "France"
	HModifie(Client)
FIN
```
<a name="Exemple2"></a>

```wl
// Modifie l'enregistrement en cours du fichier de données "Client"
// affiché dans une fenêtre
EcranVersFichier() 
HModifie(Client)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HModifie([<Fichier de données> [, <Numéro d'enregistrement> [, <Options>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'enregistrement a été modifié, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème (erreur d'intégrité, de doublons, etc.) : l'enregistrement n'est pas modifié. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données, de la vue HFSQL ou de la requête manipulé. Si ce nom n'est pas spécifié, la fonction **HModifie** va manipuler le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Numéro d'enregistrement> : (Entier optionnel)`**

Numéro de l'enregistrement à modifier. L'enregistrement chargé en mémoire est ré-écrit sur l'enregistrement spécifié. 
Si ce numéro est supérieur au nombre d'enregistrements dans le fichier de données, des enregistrements supprimés intermédiaires seront créés pour que la lecture séquentielle du fichier de données (fonction [HLit](../WDLang4/3044047.md)) soit cohérente. 

Si ce paramètre n'est pas spécifié (est égal à 0 ou à la constante *hNumEnrEnCours*), la fonction **HModifie** va modifier l'enregistrement en cours dans le fichier de données.

**ATTENTION : Il ne faut pas confondre le numéro d'enregistrement avec l'identifiant automatique associé à l'enregistrement**. Dans une utilisation normale, ces deux numéros ne sont pas identiques. Le numéro d'enregistrement peut être connu par la fonction [HNumEnr](../WDLang4/3044063.md). 

Pour utiliser le paramètre &lt;Options&gt;, il est nécessaire de préciser le paramètre &lt;Numéro d'enregistrement&gt;.
               
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Ce paramètre n'est pas pris en compte.   
![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Ce paramètre doit obligatoirement correspondre au numéro de l'enregistrement en cours (constante *hNumEnrEnCours*).![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Ce paramètre doit obligatoirement correspondre au numéro de l'enregistrement en cours (constante *hNumEnrEnCours*). 

**`<Options> : (Constante optionnelle)`**

Paramètre :

- l'influence de la modification sur le parcours en cours,

- le mode de calcul de l'identifiant automatique,         

- le mode de blocage de l'enregistrement modifié. Si aucune constante de blocage n'est précisé, l'enregistrement modifié est débloqué.
	
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : La gestion des blocages n'est pas disponible sur les bases de données accédées par JDBC.




- la gestion des doublons,

- la gestion de l'intégrité.              


Remarque : Pour utiliser ce paramètre, il est nécessaire de préciser le paramètre &lt;Numéro d'enregistrement&gt;.
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Ce paramètre n'est pas pris en compte.


|   |   |
| --- | --- |
| *hAffecteParcours* | **Influence de la modification sur le parcours** : La modification affecte le parcours. <br>Par exemple, la fonction [HLitSuivant](../WDLang4/3044037.md) utilisée après la fonction **HModifie** positionne sur l'enregistrement suivant l'enregistrement modifié (en tenant compte de ses nouvelles valeurs).<br><br>ATTENTION : Dans tous les cas (constante *hAffecteParcours* utilisée ou non) : si la fonction **HModifie** est utilisée dans un parcours et si la valeur de la rubrique de parcours est modifiée, **l'enregistrement en cours pourra être lu à nouveau dans la suite du parcours**. En effet, la modification de la rubrique de parcours met à jour la clé d'index du fichier. Lors de la lecture des enregistrements suivants, cette modification est prise en compte. <br><br>La constante *hAffecteParcours* est prioritaire sur la constante *hEcritureDéfaut*. |
| *hBlocageEcriture* | **Mode de blocage de l'enregistrement modifié** : Blocage en écriture : l'enregistrement modifié sera bloqué en écriture. Cet enregistrement pourra être lu par une autre application mais ne pourra pas être modifié par une autre application. Seule l'application en cours pourra le modifier, ou le débloquer.<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hBlocageLectureEcriture* | **Mode de blocage de l'enregistrement modifié** : Blocage en lecture/écriture : l'enregistrement modifié sera bloqué en lecture et en écriture. Cet enregistrement ne pourra ni être lu ni être modifié par une autre application. Seule l'application en cours pourra le modifier, le lire ou le débloquer.<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hBlocageNon*<br> (valeur par défaut) | **Mode de blocage de l'enregistrement modifié** : Aucun blocage : l'enregistrement modifié ne sera pas bloqué.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hEcritureDéfaut*<br>(valeur par défaut) | **Influence de la modification sur le parcours** : La modification n'affecte pas le parcours en cours. <br>Par exemple, la fonction [HLitSuivant](../WDLang4/3044037.md) utilisée après la fonction **HModifie** positionne sur l'enregistrement suivant l'enregistrement en cours avant la modification.<br><br>ATTENTION : Si la fonction **HModifie** est utilisée dans un parcours et si la valeur de la rubrique de parcours est modifiée, **l'enregistrement en cours pourra être lu à nouveau dans la suite du parcours**. En effet, la modification de la rubrique de parcours met à jour la clé d'index du fichier. Lors de la lecture des enregistrements suivants, cette modification est prise en compte. <br><br>La constante *hAffecteParcours* est prioritaire sur la constante *hEcritureDéfaut*. |
| *hFalsifieHorodatage* | **Gestion des rubriques de type Horodatage** : Par défaut, une rubrique de type Horodatage contient la date et l'heure de la création/modification de l'enregistrement, calculées automatiquement. <br>Cette constante empêche la mise à jour de la rubrique de type Horodatage : la dernière valeur présente dans l'enregistrement sera conservée. |
| *hFixeIDAuto* | **Mode de calcul de l'identifiant automatique** : L'identifiant automatique n'est pas calculé lors de l'ajout : la valeur de l'identifiant sera celle mémorisée au moment de l'ajout. <br>La prochaine valeur de l'identifiant calculée par le moteur HFSQL correspondra à la plus grande valeur de l'identifiant dans le fichier +1.<br>Si les constantes *hFixeIDAuto* et *hForceIDAuto* sont utilisées en même temps, une erreur WLangage est générée. |
| *hForceIDAuto* | **Mode de calcul de l'identifiant automatique** : L'identifiant automatique n'est pas calculé lors de l'ajout. L'identifiant correspond :<br><br>- soit à la valeur affectée à la rubrique par programmation (par exemple CLCLEUNIK = 7)<br><br>- soit à la valeur par défaut de l'identifiant spécifiée dans l'éditeur d'analyses (si le fichier de données vient d'être ouvert, sans lecture d'enregistrement)<br><br>- soit à la valeur de l'identifiant présent en mémoire (valeur de l'identifiant pour le dernier enregistrement lu dans le fichier de données).<br><br><br>Après l'ajout de l'enregistrement, le prochain identifiant automatique calculé par défaut par le moteur HFSQL sera calculé sans tenir compte de la valeur ajoutée par *hForceIDAuto*.<br>Si les constantes *hFixeIDAuto* et *hForceIDAuto* sont utilisées en même temps, une erreur WLangage est générée. |
| *hIgnoreDoublon* | **Mode de gestion des doublons** : Ignore le contrôle des doublons pour cette opération, même si le contrôle automatique des doublons est branché (fonction [HGèreDoublon](../WDLang4/3044057.md)).<br>Si les constantes *hIgnoreDoublon* et *hVérifieDoublon* sont utilisées en même temps, une erreur WLangage est générée.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hIgnoreIntégrité* | **Mode de gestion de l'intégrité** : Ignore le contrôle d'intégrité sur cette opération d'ajout, même si le contrôle de l'intégrité automatique est branché (fonction [HGèreIntégrité](../WDLang4/3044058.md)).<br>Si les constantes *hIgnoreIntégrité* et *hVérifieIntégrité* sont utilisées en même temps, une erreur WLangage est générée.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hRecalculeIDAuto* | **Mode de calcul de l'identifiant automatique** : L'identifiant automatique de l'enregistrement sera re-calculé lors de l'écriture. Cette constante est prioritaire sur les constantes *hForceIDAuto* et *hFixeIDAuto*.<br> |
| *hVérifieDoublon* | **Mode de gestion des doublons** : Contrôle les doublons pour cette opération, même si le contrôle des doublons est débranché (fonction [HGèreDoublon](../WDLang4/3044057.md)).<br>Si les constantes *hIgnoreDoublon* et *hVérifieDoublon* sont utilisées en même temps, une erreur WLangage est générée.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |
| *hVérifieIntégrité* | **Mode de gestion de l'intégrité** : Contrôle l'intégrité de l'opération même si le contrôle de l'intégrité automatique est débranché (fonction [HGèreIntégrité](../WDLang4/3044058.md)).<br>Si les constantes *hIgnoreIntégrité* et *hVérifieIntégrité* sont utilisées en même temps, une erreur WLangage est générée.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas disponible. |

![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Les rubriques de type texte sont automatiquement complétées par des espaces.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Langage Externe](https://doc.pcsoft.fr/ext/images/fr/LE.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) 

### Gestion des Identifiants automatiques
<a name="gestion_des_identifiants_automatiques_ELTPARAGRAPHE000414"></a>Par défaut (sans utilisation des constantes de modification de l'identifiant automatique), la fonction **HModifie** utilisée sur un enregistrement actif ou rayé ne modifie pas l'identifiant automatique (même si l'identifiant automatique a été affecté dans le langage) : l'identifiant automatique présent dans le fichier de données est ré-utilisé.

Les constantes *hForceIDAuto* et *hFixeIDAuto* permettent de modifier le comportement par défaut de l'identifiant automatique.

Pour plus de détails sur la gestion de l'identifiant automatique lors de la modification d'un enregistrement, consultez [Gestion de l'identifiant automatique lors d'une modification](../WDLang4/3044183.md).
![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

- *Si la base de données génère un identifiant automatique*, le moteur HFSQL conserve cette valeur. Si les constantes *hForceIDAuto* ou *hFixeIDAuto* sont précisées, le moteur HFSQL remplace la valeur générée par la valeur voulue.
	**Remarque** : la constante *hForceIDAuto* équivaut à *hFixeIDAuto* : l'identifiant automatique calculé par HFSQL lors du prochain ajout sera unique dans le fichier de données. 

- *Si la base de données ne génère pas d'identifiant automatique*, le moteur HFSQL génère la valeur et l'affecte à l'identifiant automatique.



<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Langage Externe](https://doc.pcsoft.fr/ext/images/fr/LE.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) 

### Modification des enregistrements supprimés ou rayés
<a name="modification_des_enregistrements_supprimes_rayes_ELTPARAGRAPHE000441"></a>La modification d'un enregistrement rayé ou supprimé réactive l'enregistrement.
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Langage Externe](https://doc.pcsoft.fr/ext/images/fr/LE.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) 

### Conflit de modification ou de suppression
<a name="conflit_modification_suppression_ELTPARAGRAPHE000452"></a>Les erreurs de conflit de modification ou de conflit de suppression apparaissent uniquement si la fonction **HModifie** est utilisée sur l'enregistrement courant. En effet, si un numéro d'enregistrement est précisé, il ne peut y avoir de conflit, car l'enregistrement n'a pas été lu avant la modification.

Pour plus de détails sur la gestion automatique des erreurs de conflit, consultez [Gestion assistée des erreurs HFSQL](../WDLang4/3044188.md).
<a name="NOTE0_4"></a>


### Gestion des doublons et de l'intégrité
<a name="gestion_des_doublons_integrite_ELTPARAGRAPHE000469"></a>Les contrôles d'intégrité et de doublons s'effectuent uniquement sur les clés pour lesquelles :

- un contrôle est actif, 
	
	et

- la valeur de la rubrique est modifiée par rapport à l'enregistrement présent dans le fichier de données.




Exemple :

```wl
...
Client.Nom = "TREMOULET"
Client.Prénom = "Milo"
HAjoute(Client) 	// contrôles intégrité et doublon effectués sur 
				// Nom et sur Prénom si gestions actives
Client.Prénom = "Martin"
HModifie(Client) 	// contrôles intégrité et doublon effectués sur 
				// Prénom uniquement si gestions actives
...
```

<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) 

### Version du fichier de données après une modification
<a name="version_fichier_donnees_apres_une_modification_ELTPARAGRAPHE000494"></a>Si l'enregistrement a été modifié (pas d'erreur de doublons ou d'intégrité), le numéro de version du fichier de données est modifié. Pour connaître le numéro de version, utilisez la fonction [HVersion](../WDLang4/3044020.md).
<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Gestion des mémos binaires
<a name="gestion_des_memos_binaires_ELTPARAGRAPHE000508"></a>Lors de la modification d'un enregistrement, les mémos sont modifiés si nécessaire (si la gestion des mémos est activée à l'aide de la fonction [HGèreMémo](../WDLang4/3044139.md)). 
Rappel : pour initialiser une rubrique de type mémo binaire, utilisez la fonction [HAttacheMémo](../WDLang4/3044173.md).
<a name="NOTE0_7"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png) 

### Modification d'un enregistrement sélectionné dans une requête
<a name="modification_enregistrement_selectionne_dans_une_requete_ELTPARAGRAPHE000527"></a>La modification d'un enregistrement dans une requête peut être effectuée :

- soit uniquement dans le résultat de la requête

- soit directement dans les fichiers de données manipulés par la requête (constante *hModifieFichier* utilisée dans les fonctions [HExécuteRequête](../WDLang4/3044080.md) ou [HExécuteRequêteSQL](../WDLang4/3044084.md)). Dans ce cas, la constante *hAvecFiltre* est automatiquement sélectionnée.


Il est nécessaire de distinguer deux cas, en fonction du mode d'exécution de la requête (avec ou sans la constante *hAvecFiltre*).


|   |   |
| --- | --- |
| Exécution de la requête avec la constante *hAvecFiltre* | <br><br>- Seule la modification de l'enregistrement courant est possible.<br><br>- Si la fonction est exécutée pour modifier une requête basée sur plusieurs fichiers de données, la modification est répercutée sur les fichiers de données liés.<br><br>- La modification du contenu d'une rubrique calculée provoque une erreur WLangage. Le contenu de ces rubriques est automatiquement calculé lors de la modification de l'enregistrement.<br><br><br> |
| Exécution de la requête sans la constante *hAvecFiltre* | <br><br>- Si la fonction est exécutée pour modifier une requête basée sur plusieurs fichiers de données, la modification est répercutée sur les fichiers de données liés.<br><br>- Si l'enregistrement modifié ne correspond plus à la sélection de la requête, l'enregistrement sera toujours présent dans le résultat de la requête<br><br>- La modification du contenu d'une rubrique calculée provoque une erreur WLangage. Le contenu de ces rubriques est automatiquement calculé lors de la modification de l'enregistrement.<br><br><br> |

Attention :

- Toute modification dans une requête utilisant les groupes ou les agrégats est interdite.

- La gestion de l'intégrité et des doublons n'est pas réalisée lors d'opérations sur les requêtes multi-fichiers : il est conseillé d'utiliser les transactions pour éviter tout problème.



<a name="NOTE0_8"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Parcours et modification d'un enregistrement
<a name="parcours_modification_enregistrement_ELTPARAGRAPHE000567"></a>Si la modification est réalisée pendant un parcours, l'enregistrement modifié sera visible dans le parcours en cours uniquement. Si d'autres parcours ont été définis sur cette base de données, l'enregistrement modifié ne sera visible qu'après ré-initialisation de ces parcours. 

Si la constante *hAffecteParcours* est utilisée, la modification est plus lente car la table ou la requête est rafraîchie.

ATTENTION : Si la fonction **HModifie** est utilisée dans un parcours et si la valeur de la rubrique de parcours est modifiée, **l'enregistrement en cours pourra être lu à nouveau dans la suite du parcours**. En effet, la modification de la rubrique de parcours met à jour la clé d'index du fichier. Lors de la lecture des enregistrements suivants, cette modification est prise en compte. 
<a name="NOTE0_9"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### xBase
<a name="xbase_ELTPARAGRAPHE000585"></a>La fonction [HSupprime](../WDLang4/3044018.md) a le même effet que la fonction [HRaye](../WDLang4/3044121.md) : l'enregistrement est rayé et non supprimé. L'enregistrement peut donc être réactivé par la fonction **HModifie**. Dans ce cas, la fonction [HEtat](../WDLang4/3044081.md) renvoie la constante *hEtatRaye* sur un enregistrement supprimé (et non la constante *hEtatSup*).

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
