


## Fonctions SQL : Cas particulier 
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Gestion des tabulations dans les rubriques
<a name="gestion_des_tabulations_dans_les_rubriques_ELTTEXTE000115"></a>
Selon le type de parcours mis en place avec les fonctions SQL, la gestion des tabulations dans les rubriques sera différente :


|   |   |   |
| --- | --- | --- |
|   | **Parcours de type : SQLPremier/SQLCol** | **Parcours de type : SQLAvance/SQLLitCol** |
| **Gestion des tabulations** | Ce type de parcours ne permet pas de récupérer les tabulations présentes dans les valeurs des enregistrements. Une tabulation sépare deux rubriques. Seule la partie précédant la tabulation sera récupérée avec les fonctions de lecture. <br>Pour plus de détails, consultez l'aide de [SQLCol](../WDLang4/3072018.md) et [SQLAssocie](../WDLang4/3072004.md). | Ce type de parcours permet de récupérer les tabulations présentes dans les valeurs des enregistrements.<br>Pour plus de détails, consultez l'aide de [SQLLitCol](../WDLang4/3072019.md). |
| **Exemple** | <br><pre><code>ResExec = SQLExec("SELECT NOMCLI " + ...<br>	"FROM FACT", "REQ1")  <br>SI ResExec=Vrai ALORS  	<br>	SQLPremier("REQ1")  	<br>	// Transfert du nom dans <br>	// LISTE_NOM<br>	TANTQUE PAS SQL.EnDehors<br>		ListeAjoute(LISTE_NOM, ...<br>		   SQLCol("REQ1" ,1))<br>		SQLSuivant("REQ1")  	<br>	FIN  <br>SINON  	<br>	// TraiteErreur  <br>FIN  <br>SQLFerme("REQ1")</code></pre><br> | <br><pre><code>i est un entier = 0 <br>SQLExec("SELECT NOM, PRENOM," + ... <br>	"POSTE,PHOTO FROM CLIENT", ... <br>	"REQ1" )  <br>// Récupérer la requête ligne à ligne<br>TANTQUE SQLFetch("REQ1") = 0 <br>	// Il y a encore une ligne  	<br>	i++  	<br>	// Récupérer les données  	<br>	NOM[i] = SQLLitCol("REQ1", 1)  <br>	PRENOM[i] = SQLLitCol("REQ1", 2)<br>	POSTE[i] = SQLLitCol("REQ1", 3)<br>	{"IMAGE" +i} = ...  <br>		SQLLitMémo("REQ1", 4) <br>FIN<br>SQLFerme("REQ1")</code></pre><br> |

Pour plus de détails sur les différents types de parcours, consultez [Types de parcours SQL](../WDLang4/3072025.md).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Gestion des Float lors d'un accès Oracle via ODBC
<a name="gestion_des_float_lors_acces_oracle_via_odbc_ELTTEXTE000139"></a>


### Récupération de rubriques de type Float sur Oracle (via ODBC)
<a name="recuperation_rubriques_type_float_sur_oracle_via_odbc_ELTPARAGRAPHE000063"></a>Par défaut, le séparateur décimal utilisé pour les rubriques de type Float sur Oracle est le point. Or le driver ODBC renvoie la valeur avec en utilisant la virgule comme séparateur décimal. Lors de l'affectation de la valeur dans un champ de type numérique, les décimales sont perdues.

Pour éviter ce problème, il suffit de configurer le séparateur décimal pour la connexion en cours :

```wl
// Connexion à la base de données Oracle  
SQLConnecte("MaBaseOracle", "User", "Passe", "", "ODBC")  
// Requête pour changer le séparateur décimal  
SQLExec("ALTER SESSION SET NLS_NUMERIC_CHARACTERS ='. '", "ReqTemp")
```



