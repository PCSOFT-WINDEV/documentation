


## &lt;Source&gt;.LibèreRequête (Fonction)

***En anglais : &lt;Source&gt;.FreeQuery***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Libère les ressources d'une requête (suite à l'utilisation des fonctions [&lt;Source&gt;.ExécuteRequête](../WDLang4/1000024944.md) ou [&lt;Source&gt;.ExécuteRequêteSQL](../WDLang4/1000024948.md)).

**Remarque** : Cette fonction est basée sur la fonction [&lt;Source&gt;.AnnuleDéclaration](../WDLang4/1000024192.md). 

**Quand utiliser la fonction &lt;Source&gt;.LibèreRequête ?** 
Cette fonction peut être utilisée lorsqu'aucun traitement n'a plus à utiliser de résultat en provenance d'une requête. Il est conseillé d'utiliser cette fonction sur les requêtes qui renvoient un grand nombre de lignes (à partir de plusieurs dizaines de milliers) afin de libérer de l'espace mémoire. 


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Initialise la requête
SI MaRequête.ExécuteRequête() = Faux ALORS
	Erreur("Erreur d'initialisation de la requête" + RC + HErreurInfo())
	RETOUR
FIN

// Lecture du premier enregistrement de la requête
MaRequête.LitPremier()
TANTQUE PAS MaRequête.EnDehors()
	// Traitement sur l'enregistrement de la requête
	...
	// Lecture de l'enregistrement suivant
	MaRequête.LitSuivant()
FIN
MaRequête.LibèreRequête()
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Source>.LibèreRequête()`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Source> : (Type correspondant à la source spécifiée)`**

Nom de la requête ou d'une source de données associée à une requête (cas d'une libération de ressources suite à l'utilisation des fonctions [&lt;Source&gt;.ExécuteRequête](../WDLang4/1000024944.md) ou [&lt;Source&gt;.ExécuteRequêteSQL](../WDLang4/1000024948.md)). 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation de la fonction &lt;Source&gt;.LibèreRequête
<a name="conditions_utilisation_fonction_docparampagetitleshort_ELTPARAGRAPHE000262"></a>Cette fonction ne doit être utilisée QUE lorsque vous n'avez plus besoin de la requête concernée !

**Dans l'exemple suivant, la fonction &lt;Source&gt;.LibèreRequête est utilisée trop tôt : la table sera complètement faussée**. En effet, le remplissage du champ Table par la fonction [ConstruitTableFichier](../WDLang1/3074002.md) se produit dans un processus parallèle en arrière-plan. Donc, la fonction **&lt;Source&gt;.LibèreRequête** va intervenir bien avant la fin du remplissage du champ Table, ce qui rend ce champ inutilisable.

```wl
Test.ExécuteRequêteSQL("select * from client")
ConstruitTableFichier(TABLE_Table1, "test")
Test.LibèreRequête()
```

**Remarque** : Le problème peut aussi se produire avec une variable de type "source de données". Une variable "source de données" déclarée localement dans un traitement (clic de bouton, procédure, méthode ...) n'existe QUE durant l'exécution de ce code. Pour cette raison un "warning" est affiché si vous utilisez ce type de source de données : "la source de données sera détruite à la fin de ce code".

<a name="XComposante"></a>

## Composante :
wd280hf.dll
