
## Réplication journalée : Programmer la réplication journalée en WLangage
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000269"></a>
Le WLangage propose plusieurs fonctions de programmation permettant d'intégrer et de personnaliser entièrement la réplication journalée dans votre application. Dans ce cas, aucun outil extérieur n'est nécessaire : vous programmez entièrement la réplication des données entre vos bases de données.

Deux modes de réplication journalée peuvent être mis en place par programmation :

- la **réplication journalée par réseau** (cas par exemple d'un portable se connectant régulièrement au réseau de la société).

- la **réplication journalée par support transportable** (cas par exemple de sites distants n'utilisant pas de réseau).






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## La réplication journalée par réseau
<a name="replication_journalee_par_reseau_ELTTEXTE000299"></a>


### Qu'est-ce que c'est ?
<a name="questce_que_cest_ELTPARAGRAPHE000025"></a>La réplication journalée par réseau correspond à l'opération effectuée pour synchroniser deux bases de données accessibles sur le même réseau.

L'exemple le plus courant correspond à un commercial se connectant régulièrement au réseau de la société à l'aide de son portable. Grâce à la réplication, il met à jour la base de données de l'entreprise avec les nouvelles commandes saisies dans la semaine.

Lors de cette opération, la base de données de la société et la base de données du portable sont accessibles par le réseau. La réplication peut être réalisée grâce au réseau.


<a name="NOTE2_2"></a>


### Les actions possibles
<a name="les_actions_possibles_ELTPARAGRAPHE000037"></a>La réplication journalée par réseau permet de réaliser :

- une réplication mono directionnelle :

	- soit du poste maître vers les postes abonnés.

	- soit des postes abonnés vers le poste maître.




- une réplication bi-directionnelle, c'est-à-dire du poste maître vers le poste abonné et inversement.





<a name="NOTE2_3"></a>


### Comment répliquer par réseau et par programmation
<a name="comment_repliquer_par_reseau_par_programmation_ELTPARAGRAPHE000051"></a>Les opérations à faire sont les suivantes :

1. Création du réplica maître sur le poste maître (fonction [HCréeRéplicaMaître](../WDLang4/3044175.md)).

2. Création du réplica abonné sur le poste abonné (fonction [HCréeRéplicaAbonné](../WDLang4/3044253.md)). Le poste abonné doit avoir accès en lecture et écriture sur le disque où est installée l'application maître (répertoire des fichiers de données).

3. Utilisation des applications maître et abonnées.

4. Synchronisation (fonction [HSynchroniseRéplica](../WDLang4/3044014.md)) :

	- soit du poste abonné vers le poste maître (constante *rplVersMaître*) : le poste abonné doit avoir les droits en lecture et en écriture sur le disque où l'application maître est installée.

	- soit du poste maître vers le poste abonné (constante *rplVersAbonné*) : le poste maître doit avoir les droits en lecture et en écriture sur le disque où l'application abonnée est installée.

	- soit bi-directionnelle (constante *rplbidirectionel*) : le poste maître doit avoir les droits en lecture et en écriture sur le disque où l'application abonnée est installée et le poste abonné doit avoir les droits en lecture et en écriture sur le disque où l'application maître est installée.





**Attention** : Ce paragraphe suppose que les opérations nécessaires ont été réalisées dans l'analyse de l'application avant installation de l'application sur les différents postes. Pour plus de détails sur les opérations à effectuer, consultez [Réplication journalée : Modification de l'analyse](../WDLang4/3044246.md).


<a name="NOTE2_4"></a>


### Contraintes et conseils
<a name="contraintes_conseils_ELTPARAGRAPHE000082"></a>

- **Lors de la création du réplica abonné**, le poste sur lequel est installé le réplica abonné doit avoir accès en lecture écriture sur le répertoire où est installé le réplica maître.

- Pour effectuer la réplication journalée, il est possible d'utiliser pour identifier le chemin des fichiers de données à répliquer :

	- soit une lettre de disque. Dans ce cas, le poste qui lance l'opération de réplication doit utiliser la même lettre de disque que le poste avec lequel il réplique. Par exemple, si la réplication est lancée depuis le poste abonné :

		- sur le poste maître, le répertoire des fichiers de données est sur X,

		- le poste abonné doit associer à la lettre X le disque contenant les fichiers de données du poste maître.




- soit des chemins UNC

- soit des chemins relatifs.

- Pour gérer la réplication journalée dans une application, la table des opérations du journal (fichier JournalOpération.fic) doit être identique pour tous les fichiers en réplication dans une même analyse.

- Il est conseillé d'enregistrer les fichiers nécessaires à la réplication journalée (fichiers \*.RPM et \*.RPL) dans un sous-répertoire RPL des fichiers de données de l'application.

- Si la journalisation est utilisée uniquement pour la réplication, les fichiers journaux peuvent être placés dans le répertoire de l'application (ou dans un sous-répertoire).

- Si la journalisation est utilisée pour conserver une sauvegarde des fichiers, il est conseillé de placer ces fichiers sur un disque différent de celui des fichiers de données (pour plus de sécurité).






<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## La réplication journalée par support transportable
<a name="replication_journalee_par_support_transportable_ELTTEXTE000341"></a>


### Qu'est-ce que c'est ?
<a name="questce_que_cest_ELTPARAGRAPHE000104"></a>La réplication journalée par support transportable correspond à l'opération effectuée pour synchroniser deux bases de données complètement inaccessibles entre elles.

L'exemple le plus courant correspond à deux sites éloignés géographiquement : un site à Montpellier et un site à Paris par exemple. Régulièrement des mises à jour des bases de données sont effectuées grâce à divers support : transfert par FTP, par disquette ou CD ROM, ...


<a name="NOTE3_2"></a>


### Les actions possibles
<a name="les_actions_possibles_ELTPARAGRAPHE000114"></a>La réplication journalée par support transportable permet uniquement de réaliser une réplication mono directionnelle :

- soit du poste maître vers les postes abonnés

- soit des postes abonnés vers le poste maître





<a name="NOTE3_3"></a>


### Contraintes et conseils
<a name="contraintes_conseils_ELTPARAGRAPHE000125"></a>

- Pour gérer la réplication journalée  dans une application, la table des opérations du journal (fichier JournalOpération.fic) doit être identique pour tous les fichiers en réplication dans une même analyse.

- Il est conseillé d'enregistrer les fichiers nécessaires à la réplication (fichiers \*.RPM et \*.RPL) dans un sous-répertoire RPL des fichiers de données de l'application.

- Si la journalisation est utilisée uniquement pour la réplication, les fichiers journaux peuvent être placés dans le répertoire de l'application (ou dans un sous-répertoire).

- Si la journalisation est utilisée pour conserver une sauvegarde des fichiers, il est conseillé de placer ces fichiers sur un disque différent de celui des fichiers de données (pour plus de sécurité).





<a name="NOTE3_4"></a>


### Par programmation
<a name="par_programmation_ELTPARAGRAPHE000136"></a>Les opérations à faire pour synchroniser le poste maître avec le poste abonné par exemple sont les suivantes :

1. Création :

	- du réplica maître sur le poste maître (fonction WLangage [HCréeRéplicaMaître](../WDLang4/3044175.md)).

	- du réplica abonné sur le poste abonné (fonction WLangage [HCréeRéplicaAbonné](../WDLang4/3044253.md)). Chaque poste abonné doit être associé à un identifiant spécifique. Cet identifiant sera utilisé lors de la synchronisation.
			Ces deux réplica peuvent être créés dans le même répertoire (déconseillé).




2. Installation du fichier du réplica abonné sur le poste abonné. Ce fichier peut être installé :

	- soit dans le répertoire de réplication indiqué dans l'analyse (sous-répertoire \\RPL des fichiers de données par défaut).

	- soit dans un autre répertoire. Dans ce cas, l'application abonnée doit utiliser la fonction [HChangeRepRpl](../WDLang4/3044236.md) pour indiquer où le fichier du réplica abonné doit être recherché. En effet, à l'ouverture du fichier de données abonné, le fichier RPL est lu pour définir la plage des identifiants automatiques utilisés par le fichier de donnés.




3. Utilisation des applications maître et abonnées.

4. Sur le poste abonné, création du réplica transportable (fonction WLangage [HCréeRéplicaTransportable](../WDLang4/3044209.md)). Par défaut, un fichier d'extension WDZ est créé. Ce fichier doit être transmis par un moyen quelconque au poste maître.

5. Synchronisation sur le poste maître (fonction [HSynchroniseRéplica](../WDLang4/3044014.md)). Pour effectuer cette synchronisation, il est nécessaire de préciser :

	- le nom et le chemin du réplica transportable sur le poste maître

	- l'identifiant du réplica abonné (spécifié lors de la création du réplica abonné).





**Attention** : Ce paragraphe suppose que les opérations nécessaires ont été réalisées dans l'analyse de l'application avant installation de l'application sur les différents postes. Pour plus de détails sur les opérations à effectuer, consultez [Réplication avec WINDEV](../WDLang4/3044256.md).



<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Fonctions WLangage permettant de gérer la réplication journalée
<a name="fonctions_wlangage_permettant_gerer_replication_journalee_ELTTEXTE000383"></a>


### Fonctions de gestion de la réplication journalée
<a name="fonctions_gestion_replication_journalee_ELTPARAGRAPHE000183"></a>Les fonctions WLangage permettant de gérer la réplication journalée sont les suivantes :


|   |   |
| --- | --- |
| [HChangeRepRpl](../WDLang4/3044236.md) | Modifie l'emplacement de la description du réplica abonné (fichier RPL). Cette fonction doit être utilisée sur le poste abonné. |
| [HCréeRéplicaAbonné](../WDLang4/3044253.md) | Crée le fichier de description d'un réplica abonné (fichier \*.RPL). |
| [HCréeRéplicaMaître](../WDLang4/3044175.md) | Crée le fichier de description d'un réplica maître (fichier \*.RPM). |
| [HCréeRéplicaTransportable](../WDLang4/3044209.md) | Crée un fichier qui peut être utilisé pour répliquer les données de la base de données en cours vers une base de données distante (pour envoi par eMail ou disquette par exemple). |
| [HGèreRéplication](../WDLang4/3044067.md) | Débranche (ou re-branche) temporairement la réplication. Par défaut, la réplication est automatiquement gérée. |
| [HInitAbonné](../WDLang4/3044013.md) | Initialise la plage d'identifiants automatiques d'un fichier de description d'un réplica abonné (extension ".RPL"). |
| [HSynchroniseRéplica](../WDLang4/3044014.md) | Synchronise un réplica maître et un réplica abonné. |






