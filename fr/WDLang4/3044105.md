


## HFiltreIdentique (Fonction)

***En anglais : HFilterIdentical***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Définit et active un filtre permettant de rechercher la valeur exacte d'une rubrique de type chaîne. Ce filtre peut être utilisé sur un fichier de données, une vue ou une requête.

Après son exécution, les cas suivants sont les plus fréquents :

- le filtre ne peut pas être créé : la fonction **HFiltreIdentique** renvoie une chaîne vide (""). La fonction [HErreur](../WDLang4/3044088.md) permet de récupérer l'identifiant de l'erreur.

- le filtre est créé : la fonction **HFiltreIdentique** renvoie la clé de parcours optimale à utiliser pour réaliser le parcours du fichier de données, de la vue ou de la requête.





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Sélection de tous les clients ayant pour nom Archambault 
// et pour prénom Corentin
CléParcours est une chaîne
CléParcours = HFiltreIdentique(Client, NomPrénom, "Archambault", "Corentin")
HLitPremier(Client, CléParcours)
TANTQUE PAS HEnDehors()
	Trace(Client.NomClient, Client.Ville)
	HLitSuivant(Client, CléParcours)
FIN
// Désactive le filtre
HDésactiveFiltre(Client)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HFiltreIdentique(<Fichier de données> , <Rubrique clé> , <Valeur pour la composante 1 de la clé> [, <Valeur pour la composante 2 de la clé> [... [, <Valeur pour la composante N de la clé>]]])`
---

**`<Résultat> : (Chaîne de caractères)`**

Rubrique de parcours. Correspond :

- soit à la clé de parcours du fichier de données si le filtre est activé.

- soit à une chaîne vide ("") si le filtre ne peut pas être mis en place.




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données HFSQL, de la vue ou de la requête manipulé.

**`<Rubrique clé> : (Chaîne de caractères)`**

Nom de la rubrique clé sur laquelle le filtre doit être réalisé. Cette rubrique peut être une clé simple de type chaîne ou une clé composée. Attention : ce paramètre ne doit contenir que des lettres, des caractères soulignés ou des chiffres. Dans le cas contraire, il faut entourer le nom de guillemets.

**`<Valeur pour la composante 1 de la clé> : (Type de chaque composante de la clé de parcours)`**

Valeur recherchée pour la première composante de la clé composée. 
Le type de ce paramètre doit correspondre au type de la composante de la rubrique clé sur laquelle le filtre est défini.

**`<Valeur pour la composante 2 de la clé> : (Type de chaque composante de la clé de parcours)`**

Valeur recherchée pour la seconde composante de la clé composée. 
Le type de ce paramètre doit correspondre au type de la composante de la rubrique clé sur laquelle le filtre est défini.





**`<Valeur pour la composante N de la clé> : (Type de chaque composante de la clé de parcours)`**

Valeur recherchée pour la composante N de la clé composée. 
Le type de ce paramètre doit correspondre au type de la composante de la rubrique clé sur laquelle le filtre est défini.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Gestion automatique des clés composées
<a name="gestion_automatique_des_cles_composees_ELTPARAGRAPHE000120"></a>La fonction **HFiltreIdentique** gère automatiquement les filtres sur les clés simples comme sur les clés composées.

Exemple : Utilisation de la fonction **HFiltreIdentique** avec une clé simple :

```wl
Res = HFiltreIdentique(Client, Nom, "Archambault")
// Sélection du client ayant pour nom Archambault
```


Exemple : Utilisation de la fonction **HFiltreIdentique** avec une clé composée

```wl
Res = HFiltreIdentique(Client, NomPrénom, "Archambault", "Corentin")
// Sélection de tous les clients ayant pour nom Archambault et 
// pour prénom par Corentin
```
Cette ligne de code est équivalente à :

```wl
HFiltre(Client, NomPrénom, ...
	HConstruitValClé(Client, NomPrénom, "Archambault", "Corentin"), ...   
	HConstruitValClé(Client, NomPrénom, "Archambault", "Corentin")
```

<a name="NOTE0_2"></a>


### Filtre et parcours filtré
<a name="filtre_parcours_filtre_ELTPARAGRAPHE000161"></a>Après l'exécution de la fonction **HFiltreIdentique**, le parcours du fichier de données doit obligatoirement être effectué sur la rubrique renvoyée par la fonction **HFiltreIdentique**. Si une autre rubrique est utilisée pour le parcours du fichier de données, le filtre ne sera pas pris en compte.

Lorsqu'un filtre est défini et activé sur un fichier de données (une vue ou une requête), tout enregistrement lu correspond au filtre. Si il n'y a plus d'enregistrement correspondant au filtre lors du parcours : 

- la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u><u>Vrai</u></u></u></u>. 

- l'enregistrement en cours correspond au dernier enregistrement lu avec le filtre. 




Par exemple :

| Sur un fichier de données filtré, après la fonction : | l'enregistrement en cours est : |
| --- | --- |
| **[HLitPremier](../WDLang4/3044051.md)** | le premier enregistrement du fichier de données correspondant au filtre. |
| **[HLitDernier](../WDLang4/3044140.md)** | le dernier enregistrement du fichier de données correspondant au filtre. |
| **[HLitSuivant](../WDLang4/3044037.md)** (ou **[HAvance](../WDLang4/3044154.md)**) | l'enregistrement suivant (ou le nième suivant) correspondant au filtre. |
| **[HLitPrécédent](../WDLang4/3044048.md)** (ou **[HRecule](../WDLang4/3044126.md)**) | l'enregistrement précédent (ou le nième précédent) correspondant au filtre. |


<a name="NOTE0_3"></a>


### Activation/Désactivation d'un filtre
<a name="activationdesactivation_filtre_ELTPARAGRAPHE000229"></a>

- La fonction [HDésactiveFiltre](../WDLang4/3044085.md) permet de désactiver un filtre.

- La fonction [HActiveFiltre](../WDLang4/3044158.md) permet ré-activer un filtre.

- Lorsque le fichier de données (la requête ou la vue) est fermé (fonctions [HFerme](../WDLang4/3044073.md) ou [HOuvreAnalyse](../WDLang4/3044106.md) par exemple), le filtre est supprimé.

- A un même instant, il ne peut exister qu'un seul filtre sur un fichier de données (une requête ou une vue). Si la fonction **HFiltreIdentique** est utilisée plusieurs fois, seul le dernier filtre sera pris en compte : le(s) filtre(s) précédent(s) seront supprimés. De même si plusieurs filtres sont utilisés (fonctions HFiltre\*), seul le dernier filtre sera pris en compte.



<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Fichier de données non HFSQL
<a name="fichier_donnees_non_hfsql_ELTPARAGRAPHE000258"></a>

- Le filtre peut être créé à partir de n'importe quelle rubrique (rubrique clé ou non clé).

- L'exécution de la fonction **HFiltreIdentique** rend automatiquement le filtre actif.

- Les modifications apportées par les fonctions **HFiltreIdentique** et [HDésactiveFiltre](../WDLang4/3044085.md) sont prises en compte uniquement lors de l'utilisation des fonctions [HLitPremier](../WDLang4/3044051.md)/[HPremier](../WDLang4/3044113.md), [HLitDernier](../WDLang4/3044140.md)/[HDernier](../WDLang4/3044101.md) ou [HLitRecherchePremier](../WDLang4/3044036.md)/[HLitRechercheDernier](../WDLang4/3044034.md).




<a name="XComposante"></a>

## Composante :
wd280hf.dll
