


## HRetourPosition (Fonction)

***En anglais : HRestorePosition***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Restaure le contexte précédemment sauvegardé d'un fichier de données (fonction [HSauvePosition](../WDLang4/3044136.md)) : enregistrement en cours, filtre, pointeurs de lecture.

La fonction **HRetourPosition** permet de restaurer :

- le numéro de l'enregistrement manipulé,

- les différents pointeurs dans l'index (sauvegarde pour chaque clé de la position dans l'index),

- le filtre en cours (uniquement si la constante correspondante *hRPFiltre* est spécifiée).




Cette fonction peut être utilisée indifféremment avec les fichiers de données, les vues HFSQL ou les requêtes.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Recherche d'un enregistrement
HLitRecherchePremier(Client, Nom, Nom)
TANTQUE HTrouve(Client) = Vrai
	// Sauve le contexte en cours
	nPos = HSauvePosition(Client, Nom)
	// Vérification d'un client d'un autre nom
	HLitRecherche(Client, Nom, Nom2)
	SI HTrouve() = Vrai ALORS Compteur = Compteur + 1
	// Restaure le contexte
	HRetourPosition(nPos)
	HLitSuivant(Client, Nom)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Restaurer la position spécifiée

`<Résultat> = HRetourPosition(<Position> [, <Option>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la restauration de la position indiquée a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [HErreur](../WDLang4/3044088.md) permet d'obtenir plus d'informations sur le problème rencontré.




**`<Position> : (Entier)`**

Position à restaurer. Valeur retournée par la fonction [HSauvePosition](../WDLang4/3044136.md).

**`<Option> : (Constante ou combinaison de constante optionnelle)`**

Permet de paramétrer la restauration :


|   |   |
| --- | --- |
| *hRPConserve* | La position n'est pas libérée (d'autres appels à la fonction **HRetourPosition** pourront être réalisés sur cette position). |
| *hRPDéfaut*<br>(valeur par défaut) | La position est libérée. La position sauvegardée est restaurée. |
| *hRPFiltre* | Restaure le filtre posé au moment de l'appel à la fonction [HSauvePosition](../WDLang4/3044136.md). |
| *hRPHF5* | Si la position sauvegardée a été supprimée ou modifiée, cette position est tout de même restaurée.<br>Si la constante *hRPHF5* n'est pas précisée et que la sauvegarde a été réalisée sur plusieurs rubriques, le repositionnement est fait sur le numéro d'enregistrement en cours au moment de l'appel à la fonction [HSauvePosition](../WDLang4/3044136.md).<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Cette constante n'est pas supportée. |

![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Ce paramètre n'est pas pris en compte : la position sera sauvegardée pour toutes les rubriques sur lesquelles un parcours est en cours.


<a name="SYNTAXE2"></a>

### Restaurer un fichier de données

`<Résultat> = HRetourPosition([<Fichier de données>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la restauration du contexte a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [HErreur](../WDLang4/3044088.md) permet d'obtenir plus d'informations sur le problème rencontré.




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données dont le contexte doit être restauré. Si ce nom n'est pas spécifié, la fonction **HRetourPosition** va manipuler le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Réinitialisation des positions
<a name="reinitialisation_des_positions_ELTPARAGRAPHE000197"></a>Attention : toutes les fonctions entraînant l'ouverture ou la fermeture d'un fichier de données réinitialisent les numéros de contexte (par exemple [HCréation](../WDLang4/3044255.md), [HFerme](../WDLang4/3044073.md), ...).

Si l'enregistrement sauvegardé par la fonction [HSauvePosition](../WDLang4/3044136.md) a été supprimé, la fonction **HRetourPosition** conservera le contexte en cours mais se positionnera sur l'enregistrement suivant l'enregistrement supprimé.
![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png) Lors de la réinitialisation d'un parcours, les positions sauvegardées sur ce parcours sont détruites. Le moteur HFSQL utilise alors la valeur de la meilleure rubrique pour tenter un repositionnement. La meilleure rubrique est sélectionnée dans l'ordre de préférence suivant :

1. Identifiant automatique

2. Clé unique

3. Première clé

4. Première rubrique


Les fonctions suivantes réinitialisent le parcours :

- [HLitPremier](../WDLang4/3044051.md)/[HPremier](../WDLang4/3044113.md)

- [HLitDernier](../WDLang4/3044140.md)/[HDernier](../WDLang4/3044101.md)

- [HGèreMémo](../WDLang4/3044139.md)



<a name="NOTE0_2"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000243"></a>

- Le nombre d'appels à la fonction [HSauvePosition](../WDLang4/3044136.md) n'est pas limité.

- Il est possible d'imbriquer les fonctions [HSauvePosition](../WDLang4/3044136.md) et **HRetourPosition** pour un même fichier de données.



<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Principe de repositionnement pour les Connecteurs Natifs (également appelés Accès Natifs)
<a name="principe_repositionnement_pour_les_connecteurs_natifs_egalement_appeles_acces_natifs_ELTPARAGRAPHE000264"></a>L'enregistrement est restauré à partir du cache interne du Connecteur Natif.

Attention : lors de la restauration, aucune vérification n'est effectuée sur l'existence de l'enregistrement dans la base (l'enregistrement peut avoir été supprimé).

Il est possible de "forcer" la lecture sur la base en utilisant la fonction [HLit](../WDLang4/3044047.md) après la fonction **HRetourPosition**. Dans ce cas :

- les valeurs de l'enregistrement seront relues dans la base de données.

- si l'enregistrement a été supprimé, le Connecteur Natif renverra l'erreur 13 : L'enregistrement courant n'a pas pu être trouvé. Il a été modifié ou supprimé de la source de données.




**Cas particuliers : Connecteur Natif MySQL, DB2 et Informix** : Après l'utilisation de la fonction **HRetourPosition**, les fonctions [HLitSuivant](../WDLang4/3044037.md) et [HLitPrécédent](../WDLang4/3044048.md) génèrent une requête pour trouver l'enregistrement suivant ou précédant l'enregistrement restauré.

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
