


## HEnregistrementVersChaîne (Fonction)

***En anglais : HRecordToString***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Convertit sous forme de chaîne le contenu de l'enregistrement en cours (dans un fichier de données, une vue HFSQL, une requête, ...).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
Enreg est une chaîne = HEnregistrementVersChaîne(Client)
```
<a name="Exemple2"></a>

```wl
// Récupère la chaîne contenant la totalité de l'enregistrement
MonEnregistrement est une chaîne = HEnregistrementVersChaîne(Client)
// Extrait le nom du client
NomClient est une chaîne = ExtraitChaîne(MonEnregistrement, 1)
// Extrait le prénom du client
PrénomClient est une chaîne = ExtraitChaîne(MonEnregistrement, 2)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Convertir en chaîne le contenu d'un enregistrement pour le fichier spécifié

`<Résultat> = HEnregistrementVersChaîne([<Fichier de données> [, <Séparateur Rubrique> [, <Séparateur Tableau> [, <Format>]]]])`
---

**`<Résultat> : (Chaîne de caractères)`**

Valeur de l'enregistrement, exprimée sous la forme : 
&lt;Contenu rubrique 1&gt; + &lt;Séparateur rubrique&gt; + &lt;Contenu rubrique 2&gt; + ...

Les contenus des rubriques sont extraits selon l'ordre physique des rubriques dans le fichier de données. Si la rubrique correspond à une valeur NULL, &lt;Contenu de la rubrique&gt; correspond à une chaîne vide ("").

Selon le &lt;Format&gt; précisé, cette chaîne de caractères est au format ANSI (par défaut) ou UNICODE.

**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données (vue ou requête) manipulé. Si ce nom n'est pas spécifié, la fonction **HEnregistrementVersChaîne** va manipuler le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Séparateur Rubrique> : (Chaîne de caractères optionnelle)`**

Chaîne de caractères utilisée pour séparer les différentes rubriques dans le &lt;Résultat&gt;. Par défaut, le séparateur utilisé est TAB.

**`<Séparateur Tableau> : (Chaîne de caractères optionnelle)`**

Chaîne de caractères utilisée pour séparer les valeurs des rubriques tableau (ou sous-rubriques) dans le &lt;Résultat&gt;. Par défaut, le séparateur utilisé est TAB.
Attention : par compatibilité avec WINDEV 5.5, les séparateurs ne sont pas indiqués lorsque les rubriques tableau sont vides.

**`<Format> : (Constante optionnelle de type Entier)`**

Format utilisé pour renvoyer la valeur de l'enregistrement. Par défaut, une chaîne de caractères au format ANSI est renvoyé. Pour obtenir une chaîne de caractères au format UNICODE, utilisez la constante suivante :


|   |   |
| --- | --- |
| *hUnicode* | &lt;Résultat&gt; est une chaîne de caractères UNICODE. |




<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
### Convertir en chaîne le contenu d'un enregistrement pour la variable Enregistrement spécifiée

`<Résultat> = HEnregistrementVersChaîne(<Enregistrement> [, <Séparateur Rubrique> [, <Séparateur Tableau> [, <Format>]]])`
---

**`<Résultat> : (Chaîne de caractères)`**

Valeur de l'enregistrement, exprimée sous la forme : 
&lt;Contenu rubrique 1&gt; + &lt;Séparateur rubrique&gt; + &lt;Contenu rubrique 2&gt; + ...

Les contenus des rubriques sont extraits selon l'ordre physique des rubriques dans le fichier de données. Si la rubrique correspond à une valeur NULL, &lt;Contenu de la rubrique&gt; correspond à une chaîne vide ("").

Selon le &lt;Format&gt; précisé, cette chaîne de caractères est au format ANSI (par défaut) ou UNICODE.

**`<Enregistrement> : (Variable optionnelle de type Enregistrement)`**

Nom de la variable de type [Enregistrement](../WDLang4/1000020962.md) manipulée. 

**`<Séparateur Rubrique> : (Chaîne de caractères optionnelle)`**

Chaîne de caractères utilisée pour séparer les différentes rubriques dans le &lt;Résultat&gt;. Par défaut, le séparateur utilisé est TAB.

**`<Séparateur Tableau> : (Chaîne de caractères optionnelle)`**

Chaîne de caractères utilisée pour séparer les valeurs des rubriques tableau (ou sous-rubriques) dans le &lt;Résultat&gt;. Par défaut, le séparateur utilisé est TAB.
Attention : par compatibilité avec WINDEV 5.5, les séparateurs ne sont pas indiqués lorsque les rubriques tableau sont vides.

**`<Format> : (Constante optionnelle de type Entier)`**

Format utilisé pour renvoyer la valeur de l'enregistrement. Par défaut, une chaîne de caractères au format ANSI est renvoyé. Pour obtenir une chaîne de caractères au format UNICODE, utilisez la constante suivante :


|   |   |
| --- | --- |
| *hUnicode* | &lt;Résultat&gt; est une chaîne de caractères UNICODE. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Le contenu des rubriques de type mémo binaire n'est pas récupéré, mais le séparateur de rubrique est présent (pour éviter un décalage).

- Le contenu des clés composées n'est pas récupéré, mais le séparateur de rubrique est présent (pour éviter un décalage).




<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
