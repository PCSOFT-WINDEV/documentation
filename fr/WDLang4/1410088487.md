


## HExporteChaîneJSON (Fonction)

***En anglais : HExportJSONString***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Exporte les enregistrements d'un fichier de données (HFSQL ou OLE DB), d'une vue ou d'une requête dans une chaîne au format JSON.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Exporte tous les clients 
sChaîne est une chaîne
sChaîne = HExporteChaîneJSON(CLIENT)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = HExporteChaîneJSON(<Fichier> [, <Rubriques à exporter>] [, <Options> [, <Jauge>]])`
---

**`<Résultat> : (Chaîne de caractères)`**

Chaîne de caractères au format JSON.

**`<Fichier> : (Chaîne de caractères)`**

Nom du fichier de données, de la vue ou de la requête manipulé.

**`<Rubriques à exporter> : (Chaîne de caractères optionnelle)`**

Liste des noms des rubriques à exporter. Les noms sont délimités par de simples quotes, et séparées par des virgules ou des RC. Les noms des rubriques de type clé composée, binaire, mémo binaire sont ignorées.
Si ce paramètre correspond à une chaîne vide (""), toutes les rubriques du fichier de données (sauf rubriques de type clé composée, binaire, mémo binaire et mot de passe) sont exportées.

**`<Options> : (Constante optionnelle de type Entier)`**

Indique le mode de création du fichier JSON :


|   |   |
| --- | --- |
| *hExpInterruptible* | L'exportation peut être interrompue par la touche Echap du clavier. <br>Si l'exportation est interrompue, la chaîne au format JSON est valide et contient uniquement les enregistrements exportés avant interruption. |
| *hExpNormal*<br>(valeur par défaut) | Fonctionnement normal. |



**`<Jauge> : (Nom de champ ou nom de fenêtre optionnel)`**

Nom du champ de type Jauge ou nom de la fenêtre permettant de visualiser la progression de la création de la chaîne au format JSON.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Exporter le contenu d'une requête
<a name="exporter_contenu_une_requete_ELTPARAGRAPHE000190"></a>Pour exporter le contenu d'une requête, il est nécessaire d'initialiser la requête (fonction [HExécuteRequête](../WDLang4/3044080.md)) avant d'utiliser la fonction **HExporteChaîneJSON**.
<a name="1000021964_NOTE0_2"></a>


### Exporter un seul enregistrement
<a name="exporter_seul_enregistrement_ELTPARAGRAPHE000205"></a>Pour exporter un seul enregistrement vers une chaîne JSON, utilisez la fonction [HEnregistrementVersJSON](../WDLang4/1000021909.md).
<a name="1000021964_NOTE0_3"></a>


### Rubriques tableau
<a name="rubriques_tableau_ELTPARAGRAPHE000217"></a>Si une des rubriques exportées est une rubrique de type Tableau, chaque élément de la rubrique tableau est exportée dans un nouveau niveau :

```txt
{"Fichier":
	{
	"Rubrique1":Donnée de la rubrique 1,
	"Rubrique2":Donnée de la rubrique 2,
	"RubriqueTab":
		[Donnée élément 1, Donnée élément 2, ...]
	...
	}
}
```

**Rappel** : Les rubriques de type clé composée, mémo binaire, binaire ou mot de passe sont ignorées.

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
