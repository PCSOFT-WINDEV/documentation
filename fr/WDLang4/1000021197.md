


## HImporteXLS (Fonction)

***En anglais : HImportXLS***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Importe un fichier XLS ou XLSX dans un fichier de données au format HFSQL Classic ou Client/Serveur (fichier de données décrit sous l'éditeur d'analyses ou déclaré par les fonctions [HDéclare](../WDLang4/3044203.md), [HDéclareExterne](../WDLang4/3044204.md) ou [HDécritFichier](../WDLang4/3044206.md)).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Importation du fichier "C:\MesFichiers\Client.xls" dans le fichier de données Client. 
// Si le fichier de données Client existe, ce fichier de données sera écrasé (constante hImpCréation)
// Une jauge de progression sera affichée dans le champ JAUGE_Jauge1
HImporteXLS(Client, "C:\MesFichiers\Client.xls",  1, "", hImpCréation, JAUGE_Jauge1)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = HImporteXLS(<Fichier de données> , <Chemin du fichier XLS ou XLSX> [, <Numéro de feuille> [, <Liste des rubriques destination> [, <Options> [, <Jauge>]]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur. 
	La fonction [HErreur](../ErrCompil/1000001036.md) permet d'identifier le problème rencontré.




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données au format HFSQL dans lequel l'importation doit être réalisée.

Remarque : Si le fichier de données HFSQL manipulé n'existe pas physiquement, ce fichier de données est automatiquement créé.

**`<Chemin du fichier XLS ou XLSX> : (Chaîne de caractères)`**

Chemin d'accès complet au fichier XLS ou XLSX à importer.
![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Seuls les fichiers XLSX peuvent être manipulés.

**`<Numéro de feuille> : (Entier optionnel)`**

Numéro de la feuille du fichier XLS ou XLSX à importer. 

Si ce paramètre n'est pas précisé, la première feuille du fichier XLS ou XLSX est importée. 

**`<Liste des rubriques destination> : (Chaîne de caractères optionnelle)`**

Liste des noms des rubriques du fichier de données dans lequel l'importation est effectuée. Les noms peuvent être délimités par des simples quotes et sont séparés par des virgules ou RC.
Les noms des rubriques de type clé composée, mémo binaire et de type binaire sont ignorés. 
Les rubriques non importées seront initialisées avec leur valeur par défaut décrite dans l'analyse.

Si ce paramètre n'est pas précisé ou correspond à une chaîne vide, toutes les rubriques sont importées (sauf les clés composées, les rubriques binaires et mémos binaires) dans l'ordre physique de description.

**`<Options> : (Constante ou combinaison de constantes de type Entier (optionnelle))`**

Paramètre le type d'importation à effectuer :


|   |   |
| --- | --- |
| *hCopieIDAuto* | L'identifiant automatique est recopié. Il n'est pas recalculé. |
| *hImpCréation* | Si le fichier de données d'importation existe, il est écrasé. |
| *hImpIgnorePremièreLigne* | La première ligne du fichier XLS importé est ignorée. |
| *hImpIgnoreRubriqueVide* | Si une ou plusieurs rubriques ne sont pas renseignées dans le fichier XLS, les lignes correspondantes sont quand même importées. <br>Les rubriques manquantes contiennent :<br><br>- soit la valeur par défaut des rubriques si la constante *hValDéfaut* est spécifiée.<br><br>- soit la valeur des rubriques dans l'enregistrement en cours avant l'appel de la fonction **HImporteXLS**.<br><br><br> |
| *hImpInterruptible* | L'importation peut être interrompue par la touche Echap du clavier.<br>Si l'importation est interrompue, les enregistrements importés sont conservés dans le fichier de données. |
| *hImpNormal*<br>(valeur par défaut) | Si le fichier de données d'importation existe déjà, il est complété avec les données importées, sinon le fichier de données est créé.<br>Pas de gestion d'intégrité, ni de gestion de doublons.<br>Les rubriques non importées prennent la valeur de l'enregistrement en cours.<br>Les identifiants automatiques sont recalculés. <br>![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) La gestion de l'intégrité et des doublons est toujours activée. |
| *hImpTestDoublon* | Active la gestion des doublons sur les clés uniques lors de l'importation (la gestion des doublons est activée uniquement sur les clés uniques et non sur l'enregistrement complet).<br>![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) La gestion des doublons est toujours activée. |
| *hImpTestIntégrité* | Teste l'intégrité lors de l'importation.<br>![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) La gestion de l'intégrité est toujours activée. |
| *hValDéfaut* | Pour les rubriques non importées, les valeurs de l'enregistrement en cours sont réinitialisées :<br><br>- soit avec leur valeur par défaut si la constante *hValDéfaut* est spécifiée.<br><br>- soit avec la valeur des rubriques correspondantes dans l'enregistrement en cours avant l'appel de la fonction **HImporteXLS** si la constante *hValDéfaut* n'est pas spécifiée.<br><br><br> |



**`<Jauge> : (Nom de champ ou nom de fenêtre optionnel)`**



- Nom de la fenêtre dans laquelle la jauge doit être affichée, 

- Nom du champ de type Jauge utilisé pour afficher la progression.






<a name="XComposante"></a>

## Composante :
wd280hf.dll
