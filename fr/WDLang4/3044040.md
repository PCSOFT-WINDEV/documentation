
## Blocage des fichiers de données : correspondance WINDEV 5.5 et les versions supérieures
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Blocage en version 5.5
<a name="blocage_version_55_ELTTEXTE000188"></a>
Trois modes de gestion des blocages en réseau étaient disponibles :

- **HModePerso(Vrai)** : Les tests de blocage devaient être réalisés après chaque appel à une fonction Hyper File.

- **HModePerso(Faux)** : Les tests de blocage devaient être réalisés après chaque appel à une fonction Hyper File sauf pour les fonctions Hyper File de lecture non bloquante.

- **HModeSemiPerso()** : Le test du compte-rendu de blocage était automatique. En cas d'échec du blocage, l'exécution du programme était abandonnée.




La fonction **HModeAuto** était utilisée en mode mono -utilisateur.

**Remarque** : La gestion des blocages n'est pas automatique sur des rubriques de type Mémo ou Mémo Binaire.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Blocage dans les versions suivantes
<a name="blocage_dans_les_versions_suivantes_ELTTEXTE000212"></a>
Dans les versions supérieures à la version 5.5, la gestion des blocages est plus simple et plus puissante :

- **hMode(HModeMulti)** : gestion d'un mode multi-utilisateurs (réseau)

- **hMode(HModeMono)** : gestion d'un mode mono-utilisateur.




**Dans une nouvelle application WINDEV 28, par défaut, en mode multi-utilisateurs, la gestion des blocages est automatiquement gérée par le moteur HFSQL**. Il est possible de la personnaliser grâce à la fonction [HSurErreur](../WDLang4/3044017.md).



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Blocages lors de la migration d'un projet vers une version supérieure
<a name="blocages_lors_migration_projet_vers_une_version_superieure_ELTTEXTE000236"></a>
Lors de la migration d'un projet vers une version supérieure à la version 5.5, certaines opérations sont effectuées automatiquement pour conserver le comportement de WINDEV 5.5, en limitant les modifications de votre code. Le tableau ci-dessous récapitule pour chacun des modes de blocage WINDEV 5.5:

- les opérations automatiquement effectuées lors de la migration

- les opérations à effectuer dans certains cas particuliers.




**Remarque** : Un projet migré en version 28 conservera sa propre gestion des blocages. Le code est migré pour que cette gestion des blocages continue à fonctionner.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Remarques
<a name="remarques_ELTTEXTE000260"></a>




### Cas HModePerso(Vrai)
<a name="cas_hmodepersovrai_ELTPARAGRAPHE000060"></a>Type de blocage 5.5 : 

```wl
HModePerso(Vrai)
```
Code équivalent :

```wl
HMode(hModeMulti)
HSurErreur("*", hErrTout, "")
```


- Le code équivalent est automatiquement inséré à la migration du projet.

- La ligne de code **HSurErreur("\*",hErrTout,"")** est insérée dans le code d'initialisation du projet.

- Si votre code WINDEV 5.5 contenait plusieurs appels à la fonction **HModePerso**(Vrai), il est nécessaire de recopier la ligne de code **HSurErreur("\*",hErrTout,"")** après chaque appel.





<a name="NOTE4_2"></a>


### Cas HModePerso(Faux)
<a name="cas_hmodepersofaux_ELTPARAGRAPHE000077"></a>Type de blocage 5.5 : 

```wl
HModePerso(Faux)
```
Code équivalent : 

```wl
HMode(hModeMulti)
HSurErreur("*", hErrTout, "")
```


- Le code équivalent est automatiquement inséré à la migration du projet.

- Le code HSurErreur("\*",hErrTout,"") est inséré dans le code d'initialisation du projet.

- Si votre code WINDEV 5.5 contenait plusieurs appels à la fonction HModePerso(Faux), il est nécessaire de recopier la ligne de code HSurErreur("\*",hErrTout,"") après chaque appel.

- Attention : Dans le cas d'une lecture d'un enregistrement bloqué en lecture/écriture (par exemple si la fonction [HBloqueFichier](../WDLang4/3044153.md) a été appelée) :

	- le moteur Hyper File 5.5 ré-essayait indéfiniment sans tenir compte de la valeur de h.NbEssais.

	- le moteur HFSQL Classic ré-essaye en tenant compte de la valeur de h.NbEssais.








<a name="NOTE4_3"></a>


### Cas HModeSemiPerso()
<a name="cas_hmodesemiperso_ELTPARAGRAPHE000101"></a>Type de blocage 5.5 : 

```wl
HModeSemiPerso()
```
Code équivalent : 

```wl
HMode(hModeMulti)
HSurErreur("*", hErrBlocage, "_EchecBloquage" )
```


Où "_EchecBloquage" est une procédure globale du projet


```wl
PROCEDURE _EchecBloquage()
SI OuiNon("Blocage" + "Voulez réessayer ou quitter le programme") = Non ALORS
   	RENVOYER opFinProgramme
FIN
RENVOYER opRéessayer
```


- La fonction **HModeSemiPerso** est automatiquement migrée en HMode(hModeMulti).

- Le code HSurErreur("\*",hErrTout,"") est inséré dans le code d'initialisation du projet.

- Opérations à faire :

	- Créer une procédure globale au projet avec le code ci-contre.

	- Modifier la fonction [HSurErreur](../WDLang4/3044017.md) pour lancer la procédure globale.




- Si votre code WINDEV 5.5 contenait plusieurs appels à la fonction **HModeSemiPerso**, il est nécessaire de recopier l'appel à la fonction **HSurErreur** après chaque appel de HModeSemiPerso.





<a name="NOTE4_4"></a>


### Cas HModeAuto
<a name="cas_hmodeauto_ELTPARAGRAPHE000129"></a>Type de blocage 5.5 : 

```wl
HModeAuto
```
Code équivalent : 

```wl
HMode(hModeMono)
HSurErreur("*", hErrTout, "")
```


- Le code équivalent est automatiquement inséré à la migration du projet.

- Le code HSurErreur("\*",hErrTout,"") est inséré dans le code d'initialisation du projet.

- Si votre code WINDEV 5.5 contenait plusieurs appels à la fonction HModeAuto, il est nécessaire de recopier la ligne de code HSurErreur("\*", hErrTout, "") après chaque appel.







