


## &lt;Source&gt;.ChangeRepJnl (Fonction)

***En anglais : &lt;Source&gt;.ChangeLogDir***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie l'emplacement des fichiers du journal correspondant à un fichier de données HFSQL (fichier \*JNL et fichiers JournalOpération et JournalIdentification si ils existent).

**Rappel** : Les fichiers JournalOpération et JournalIdentification sont créés uniquement :

- si la gestion de la réplication est demandée pour le fichier de données.

- si la gestion du journal sélectionnée correspond au "Journal des écritures et Historique des accès".




Si seul le journal des historiques d'accès est demandé, le fichier \*JNL n'est pas créé.

Par défaut, les fichiers physiques correspondant aux journaux sont créés :

- dans le répertoire spécifié sous l'analyse (option "Description de l'analyse", onglet "Journalisation").

<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=HChangeRepJNL%20-%20HC%20N%B0002.gif)


- dans le répertoire spécifié lors de la description du fichier de données (option "Description du fichier de données" du menu contextuel, onglet "Divers"). Cette option est disponible uniquement si le répertoire de l'analyse correspond à "&lt;Répertoire par défaut des fichiers&gt;".

<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=HChangeRepJNL%20-%20HC%20N%B0003.gif)
![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) **L'emplacement des fichiers du journal ne peut pas être modifié. Cette fonction est ignorée**. L'emplacement du journal est configuré dans le [fichier HFCONF.INI](../WDLang4/3044345.md). ![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette fonction n'a aucun effet et renvoie toujours <u><u><u>Vrai</u></u></u>.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Le fichier "Client" est journalé
Client.ChangeRepJnl("\\MonServeur\Journal\JNL", "\\MonServeur\Journal\Operation")
...
Client.Ajoute()
// -> le fichier "ClientJNL" est ouvert 
// dans le répertoire "\\MonServeur\Journal\JNL"
//-> les fichiers "JournalOpération" et "JournalIdentification" 
// sont ouverts dans le répertoire "\\MonServeur\Journal\Operation"
...
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Source>.ChangeRepJnl(<Emplacement du fichier JNL> [, <Emplacement du fichier JournalOpération> [, <Emplacement sauvegarde>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur.




**`<Source> : (Type correspondant à la source spécifiée)`**

Nom du fichier de données dont le journal doit être déplacé. Ce nom est le nom logique du fichier (défini dans l'éditeur d'analyses). 

**`<Emplacement du fichier JNL> : (Chaîne de caractères)`**

Nouveau chemin d'accès au fichier JNL associé au fichier journalé (chemin complet ou relatif). 
Si ce paramètre correspond à une chaîne vide (""), l'emplacement actuel du fichier n'est pas modifié.

**`<Emplacement du fichier JournalOpération> : (Chaîne de caractères optionnelle)`**

Nouveau chemin d'accès du fichier JournalOpération et du fichier JournalIdentification associé au fichier journalé (chemin complet ou relatif). Le fichier JournalOpération contient toutes les opérations effectuées sur le fichier journalé. 
Si ce paramètre n'est pas précisé ou correspond à une chaîne vide (""), l'emplacement actuel du fichier n'est pas modifié.

**`<Emplacement sauvegarde> : (Chaîne de caractères optionnelle)`**

Chemin des sauvegardes des fichiers journaux. Par défaut, ce chemin correspond à : &lt;répertoire des fichiers JNL&gt;\\__JNLBackup

Ce chemin est utilisé lors de la modification automatique des fichiers de données pour archiver les journaux. La fonction [&lt;Source&gt;.HistoriqueModification](../WDLang4/1000024989.md) recherchera également l'historique des modifications dans ces fichiers.

Si ce paramètre correspond à une chaîne vide (""), l'emplacement actuel n'est pas modifié.

Si ce paramètre correspond à un chemin relatif (et commence par un point), le chemin sera relatif aux fichiers de données.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Priorité pour la définition de l'emplacement des fichiers du journal
<a name="priorite_pour_definition_emplacement_des_fichiers_journal_ELTPARAGRAPHE000262"></a>La définition de l'emplacement des fichiers journal se fait selon l'ordre de priorité suivant :

1. Emplacement spécifié lors de la création du fichier journalé (fonction [&lt;Source&gt;.Création](../WDLang4/1000024207.md)).

2. Emplacement spécifié par la fonction **&lt;Source&gt;.ChangeRepJnl**.

3. Emplacement spécifié dans l'analyse.

4. Emplacement du fichier journalé.



<a name="NOTE0_2"></a>


### Le fichier Journal existe lors de l'utilisation de la fonction &lt;Source&gt;.ChangeRepJnl
<a name="fichier_journal_existe_lors_utilisation_fonction_docparampagetitleshort_ELTPARAGRAPHE000285"></a>Si le fichier Journal existe déjà lors de l'appel à la fonction **&lt;Source&gt;.ChangeRepJnl**, ce fichier journal n'est plus utilisé : un fichier journal est créé à l'emplacement spécifié et associé au fichier HFSQL journalé.

**Utilisation de la fonction [&lt;Source&gt;.DéclareExterne](../WDLang4/1000024214.md) avec un fichier journalé** : si une application utilise la fonction [&lt;Source&gt;.DéclareExterne](../WDLang4/1000024214.md) sur un fichier journalé, les modifications effectuées par cette application sont enregistrées dans les fichiers journaux spécifiés dans l'entête du fichier HFSQL journalé.
<a name="NOTE0_3"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000312"></a>

- Si les fichiers sont ouverts lors de la modification du répertoire, les fichiers sont automatiquement fermés.

- Si le chemin du journal est redéfini plusieurs fois avec la fonction **&lt;Source&gt;.ChangeRepJnl**, seul le dernier chemin est utilisé. La modification est effective pour toutes les applications utilisant le fichier journalé.



<a name="NOTE0_4"></a>


### Réplication et journalisation
<a name="replication_journalisation_ELTPARAGRAPHE000326"></a>Si la fonction [&lt;Source&gt;.InitAbonné](../WDLang4/1000024998.md) est utilisée, il est également nécessaire d'initialiser l'emplacement des journaux et des tables d'opérations (fonction **&lt;Source&gt;.ChangeRepJnl**, propriétés [RépertoireJournal](../Proprietes/2512075.md), [RépertoireJournalOpération](../Proprietes/2512076.md)).

**Rappel** : La réplication se base sur les journaux et tables d'opérations des fichiers de données. Si l'emplacement des journaux et des tables d'opérations est erroné, la réplication ne peut pas fonctionner.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
