


## HModifieStructure (Fonction)

***En anglais : HModifyStructure***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet de mettre à jour la structure d'un fichier de données HFSQL en effectuant une modification automatique des données (également appelée Synchronisation de la Structure des Données Déployées).

**Attention** : Les liaisons ne sont pas gérées (pas de création ou de mise à jour des liaisons existantes). 
Pour gérer les liaisons, utilisez la fonction [HMiseAJourLiaison](../WDLang4/1000024555.md). 




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000021445&name=hmodifiestructure_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Mise à jour de la structure du fichier de données Client en tâche de fond
HModifieStructure(Client, hmsTâcheDeFond)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = HModifieStructure(<Fichier de données> [, <Option> [, <Nouveau mot de passe> [, <Sauvegarde> [, <Jauge>]]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la modification automatique des données a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Les fonctions [ErreurInfo](../WDLang1/3013008.md) et [HErreurInfo](../WDLang4/3044071.md) permettent d'identifier l'erreur.




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données (défini dans l'analyse) dont la structure doit être mise à jour. 
Si ce paramètre est égal à "\*", la modification automatique des données sera appliquée pour tous les fichiers de données connus (décrits dans l'analyse).
Ce paramètre peut également correspondre au nom d'un [groupe de fichiers (ou perso-dossier) défini dans l'analyse](../Editeurs/2011003.md) (non disponible en Android et Android Widget).

**`<Option> : (Constante ou combinaison de constantes optionnelle)`**

Options de la modification automatique des données : 


|   |   |
| --- | --- |
| *hmsNormal* <br>(Valeur par défaut) | Fonctionnement par défaut de la modification automatique des données. |
| *hmsSansContrôle* | La modification automatique des données est effectuée même si :<br><br>- la description du fichier est plus récente que celle de l'analyse,<br><br>- le GUID de l'analyse et le GUID du fichier sont différents.<br><br><br> |
| *hmsTâcheDeFond* | La modification automatique est réalisée à chaud (possible uniquement sur des fichiers de données HFSQL Client/Serveur).<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |


**Remarque** : En mode *hmsNormal* ou *hmsSansContrôle*, le fichier de données manipulé ne doit pas être ouvert (par l'application ou par une autre application). 

**`<Nouveau mot de passe> : (Chaîne de caractères optionnelle)`**



- Nouveau mot de passe du fichier de données. 

- Chaîne vide ("") pour supprimer le mot de passe. 




Si ce paramètre n'est pas précisé (ou si ce paramètre correspond à NULL), le mot de passe existant n'est pas modifié.

**`<Sauvegarde> : (Chaîne de caractères optionnelle)`**



- Répertoire de sauvegarde. 

- Chaîne vide ("") pour ne pas faire de sauvegarde (valeur par défaut).




**`<Jauge> : (Nom de champ ou nom de fenêtre optionnel)`**

Nom du champ de type Jauge ou nom de la fenêtre permettant de visualiser la progression de la modification automatique des données.
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre n'est pas disponible.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Mot de passe
<a name="mot_passe_ELTPARAGRAPHE000167"></a>Si la fonction **HModifieStructure** est la première fonction manipulant le fichier de données spécifié, la vérification du mot de passe est effectuée lors de la manipulation du fichier de données. Ce mot de passe doit avoir été spécifié via la fonction [HPasse](../WDLang4/3044108.md). Si le mot de passe est incorrect : 

- la fonction [HErreurMotDePasse](../WDLang4/3044082.md) renvoie <u><u><u><u>Vrai</u></u></u></u>.

- la fonction **HModifieStructure** renvoie <u><u><u><u>Faux</u></u></u></u>. 




<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
