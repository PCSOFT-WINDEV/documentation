


## HRégénèreFichier (Fonction)

***En anglais : HRegenerateFile***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Régénère un fichier de données à partir de son journal.

**Rappel** : Lorsque un fichier de données journalé est perdu, il est possible de le régénérer à partir de son journal. Il est conseillé pour cela d'utiliser l'outil de maintenance du journal.


|   |
| --- |
| **Attention** : La fonction **HRégénèreFichier** permet de recréer un fichier de données à partir de la description du journal. <br><br>**Cette fonction est réservée à une utilisation avancée.** Mal utilisée, cette fonction peut détruire ou corrompre les données. |


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Le fichier de données "Client" est journalé.
// Le fichier de données "Client" se trouve dans le répertoire "C:\Données".
// Le journal du fichier de données "Client.fic" se trouve dans le répertoire "C:\Journal".
// Le fichier de données "Client" a été détruit.
// Reconstruction du fichier de données à partir du journal
HRégénèreFichier("C:\Journal\ClientJNL.fic", hStructure + hDonnées)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) 
### Régénération du fichier de données en mode HFSQL Classic

`<Résultat> = HRégénèreFichier(<Fichier journal> [, <Mot de passe> [, <Répertoire destination>]] [, <Options> [, <Date et heure de début de restauration> [, <Date et heure limite de restauration> [, <Jauge de restauration> [, <Jauge de réindexation>]]]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le fichier de données a été régénéré,

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Fichier journal> : (Chaîne de caractères)`**

Nom complet du fichier journal à utiliser.

**`<Mot de passe> : (Chaîne de caractères optionnelle)`**



- Mot de passe du fichier journal (identique au mot de passe défini sur le fichier de données). Ce mot de passe est obligatoire pour préciser un répertoire de destination. 

- Chaîne vide ("") si il n'y a pas de mot de passe.




**`<Répertoire destination> : (Chaîne de caractères optionnelle)`**

Nom complet du répertoire où sera régénéré le fichier de données. 
Si ce paramètre n'est pas défini, le fichier de données est régénéré dans son répertoire d'origine.

**`<Options> : (Constante ou combinaison de constantes optionnelle)`**

Paramètre la régénération du fichier. Par défaut (aucune option sélectionnée), la fonction n'a aucun effet.


|   |   |
| --- | --- |
| *hDonnées* | Toutes les opérations conservées dans le fichier journal sont appliquées au fichier de données existant. Les données du fichier sont mises à jour avec les données du journal. |
| *hStructure* | Un nouveau fichier de données vide est créé à partir de la description du fichier de données contenue dans le fichier journal. Si le fichier de données existe déjà, il est effacé puis recréé. |



**`<Date et heure de début de restauration> : (Chaîne de caractères ou variable de type DateHeure optionnelle)`**

Date et heure (au format AAAAMMJJHHmmSSCCC : AAAA : année, MM : mois, JJ : jour, HH : heure, mm : minutes, SS : secondes, CCC : centièmes de seconde) à partir desquelles les opérations présentes dans le fichier journal seront re-jouées sur le fichier de sauvegarde. Le fichier de données sera mis à jour. Si aucune date et heure n'est précisée, toutes les opérations présentes dans le fichier journal seront effectuées.

**`<Date et heure limite de restauration> : (Chaîne de caractères ou variable de type DateHeure optionnelle)`**

Date et heure (au format AAAAMMJJHHmmSSCCC : AAAA : année, MM : mois, JJ : jour, HH : heure, mm : minutes, SS : secondes, CCC : centièmes de seconde) jusqu'auxquelles les opérations présentes dans le fichier journal seront re-jouées sur le fichier de sauvegarde. Le fichier de données sera mis à jour. Si aucune date et heure n'est précisée, toutes les opérations présentes dans le fichier journal seront effectuées.

**`<Jauge de restauration> : (Nom de champ optionnel)`**

Nom du champ Jauge présent dans la fenêtre en cours. Ce champ sera utilisé pour visualiser la progression de la restauration des données.

**`<Jauge de réindexation> : (Nom de champ optionnel)`**

Nom du champ Jauge présent dans la fenêtre en cours. Ce champ sera utilisé pour visualiser la progression de la réindexation des données (après leur restauration).


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![HFSQL Client/Serveur](https://doc.pcsoft.fr/ext/images/fr/HFCS.png) 
### Régénération du fichier de données en mode HFSQL Client/Serveur

`<Résultat> = HRégénèreFichier(<Connexion> , <Fichier journal> [, <Mot de passe> [, <Répertoire destination>]] [, <Options> [, <Date et heure de début de restauration> [, <Date et heure limite de restauration> [, <Jauge de restauration> [, <Jauge de réindexation>]]]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le fichier de données a été régénéré, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Connexion> : (Chaîne de caractères)`**

Connexion pour laquelle la base de données doit être regénérée. Cette connexion correspond : 

- soit au nom de la connexion définie sous l'éditeur d'analyses ou grâce aux fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md).

- soit au nom d'une variable de type [Connexion](../WDLang4/1514073.md).




**`<Fichier journal> : (Chaîne de caractères)`**

Nom du fichier journal à utiliser. Le chemin de ce fichier est relatif à la base de données JNL de la connexion (voir [Structure des fichiers Journal en mode Client/Serveur](../WDLang4/3044197.md)).

**`<Mot de passe> : (Chaîne de caractères optionnelle)`**



- Mot de passe du fichier journal (identique au mot de passe défini sur le fichier de données). Ce mot de passe est obligatoire pour préciser un répertoire de destination. 

- Chaîne vide ("") si il n'y a pas de mot de passe.




**`<Répertoire destination> : (Chaîne de caractères optionnelle)`**

Nom du répertoire où sera régénéré le fichier de données. Ce répertoire est relatif à la base de données définie par la connexion. Si ce paramètre n'est pas défini, le fichier de données est régénéré dans son répertoire d'origine.

**`<Options> : (Constante ou combinaison de constantes optionnelle)`**

Paramètre la régénération du fichier de données. Par défaut (aucune option sélectionnée), la fonction n'a aucun effet.


|   |   |
| --- | --- |
| *hDonnées* | Toutes les opérations conservées dans le fichier journal sont appliquées au fichier de données existant. Les données du fichier sont mises à jour avec les données du journal. |
| *hStructure* | Un nouveau fichier de données vide est créé à partir de la description du fichier contenue dans le fichier journal. Si le fichier de données existe déjà, il est effacé puis recréé. |



**`<Date et heure de début de restauration> : (Chaîne de caractères ou variable de type DateHeure optionnelle)`**

Date et heure (au format AAAAMMJJHHmmSSCCC : AAAA : année, MM : mois, JJ : jour, HH : heure, mm : minutes, SS : secondes, CCC : centièmes de seconde) à partir desquelles les opérations présentes dans le fichier journal seront re-jouées sur le fichier de sauvegarde. Le fichier de données sera mis à jour. Si aucune date et heure n'est précisée, toutes les opérations présentes dans le fichier journal seront effectuées.

**`<Date et heure limite de restauration> : (Chaîne de caractères ou variable de type DateHeure optionnelle)`**

Date et heure (au format AAAAMMJJHHmmSSCCC : AAAA : année, MM : mois, JJ : jour, HH : heure, mm : minutes, SS : secondes, CCC : centièmes de seconde) jusqu'auxquelles les opérations présentes dans le fichier journal seront re-jouées sur le fichier de sauvegarde. Le fichier de données sera mis à jour. Si aucune date et heure n'est précisée, toutes les opérations présentes dans le fichier journal seront effectuées.

**`<Jauge de restauration> : (Nom de champ optionnel)`**

Nom du champ Jauge présent dans la fenêtre en cours. Ce champ sera utilisé pour visualiser la progression de la restauration des données.

**`<Jauge de réindexation> : (Nom de champ optionnel)`**

Nom du champ Jauge présent dans la fenêtre en cours. Ce champ sera utilisé pour visualiser la progression de la réindexation des données (après leur restauration).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
La fonction **HRégénèreFichier** peut être utilisée uniquement sur des fichiers de données HFSQL (Classic ou Client/Serveur) journalés.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
