


## &lt;Source&gt;.GèreDoublon (Fonction)

***En anglais : &lt;Source&gt;.SetDuplicates***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Active ou désactive la gestion des doublons sur une clé unique.

**Remarques** : 

- Par défaut, le test des doublons est actif.

- Cette fonction n'est pas disponible sur les bases de données accédées par OLE DB ou par les Connecteurs Natifs (également appelés Accès Natifs). 



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Désactive la gestion des doublons sur le fichier de données Client pour la clé "Nom"
Client.GèreDoublon(Nom, Faux)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Source>.GèreDoublon([<Rubrique clé>, ] <Activation>)`
---

**`<Résultat> : (Booléen)`**

Ancien mode de gestion des doublons (avant utilisation de la fonction **&lt;Source&gt;.GèreDoublon**) : 

- <u><u><u><u>Vrai</u></u></u></u> si la gestion des doublons était active, 

- <u><u><u><u>Faux</u></u></u></u> si la gestion des doublons n'était pas active (ou si la clé spécifiée est une clé avec doublons). 


Si &lt;Rubrique clé&gt; = "\*", &lt;Résultat&gt; est à <u><u><u><u>Vrai</u></u></u></u> si dans l'ancien mode de gestion des doublons, le test des doublons était actif au moins sur une rubrique. 


**`<Source> : (Type correspondant à la source spécifiée)`**

Nom du fichier de données manipulé.

**`<Rubrique clé> : (Chaîne de caractères optionnelle)`**

Nom de la rubrique clé unique utilisée. 
Si ce paramètre n'est pas spécifié ou correspond à "\*", la gestion des doublons est prise en compte pour toutes les rubriques clés du fichier de données spécifié.

**`<Activation> : (Booléen)`**

Mode de gestion : 

- <u><u><u><u>Vrai</u></u></u></u> si la gestion des doublons sur la rubrique doit être activée, 

- <u><u><u><u>Faux</u></u></u></u> si cette gestion doit être désactivée. 






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Gestion des doublons activée
<a name="gestion_des_doublons_activee_ELTPARAGRAPHE000284"></a>Si la gestion du test des doublons est branchée sur une clé définie comme étant unique, le test d'unicité est effectué automatiquement lors de chaque ajout ou modification d'un enregistrement du fichier de données.

Aussi, si l'unicité n'est pas vérifiée lors d'un ajout (fonction [&lt;Source&gt;.Ajoute](../WDLang4/1000024187.md)) ou d'une modification (fonction [&lt;Source&gt;.Modifie](../WDLang4/1000025038.md)), l'enregistrement n'est pas ajouté (respectivement modifié), la fonction d'ajout (ou de modification) renvoie une erreur et la fonction [HErreurDoublon](../WDLang4/3044077.md) renvoie <u><u><u><u>Vrai</u></u></u></u>.

**Remarque** : Seules les fonctions [&lt;Source&gt;.Ajoute](../WDLang4/1000024187.md) et [&lt;Source&gt;.Modifie](../WDLang4/1000025038.md) peuvent générer une erreur de doublons.
<a name="NOTE0_2"></a>


### Généralisation du test des doublons
<a name="generalisation_test_des_doublons_ELTPARAGRAPHE000325"></a>Pour généraliser le mode de gestion des doublons à toutes les rubriques d'un fichier de données, utilisez le méta-caractère "\*". 
Par exemple :

```txt
<Fichier de données>.GèreDoublon("*", <Activation>)
```

<a name="NOTE0_3"></a>


### Désactiver le test des doublons
<a name="desactiver_test_des_doublons_ELTPARAGRAPHE000354"></a>Désactiver le test de doublons implique la possibilité de violer les règles d'unicité énoncées lors de la description des fichiers de données dans l'éditeur d'analyses. Désactiver le test de doublons n'est donc pas une opération insignifiante : elle doit être utilisée à bon escient.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
