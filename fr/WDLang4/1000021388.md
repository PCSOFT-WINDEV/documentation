


## &lt;Fenêtre&gt;.DepuisSource (Fonction)

***En anglais : &lt;Window&gt;.FromSource***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Initialise automatiquement les champs d'une fenêtre ou d'une page avec :

- les valeurs des rubriques associées dans l'enregistrement en cours (chargé en mémoire) du fichier de données HFSQL décrit sous l'éditeur d'analyses. 

- les valeurs des variables WLangage associées. 


Cette opération est effectuée quel que soit l'état des champs (grisés, inactifs, ou invisibles).

**Remarques** : 

- La fonction **&lt;Fenêtre&gt;.DepuisSource** n'effectue aucune lecture du fichier de données. C'est la valeur de l'enregistrement chargé en mémoire qui est utilisée pour initialiser les champs. Il faut donc qu'un enregistrement soit au préalable chargé en mémoire : 

	- fonctions [&lt;Source&gt;.Lit](../WDLang4/1000025019.md), [&lt;Source&gt;.LitRecherche](../WDLang4/1000025023.md), [&lt;Source&gt;.LitPremier](../WDLang4/1000025022.md), etc. 

	- fonction [&lt;Zone répétée&gt;.Affiche](../WDLang2/1000023451.md) pour un champ Zone répétée, etc.










<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Recherche le client dans le fichier de données
HLitRecherchePremier(CLIENT, NOM, "PAUL")
SI HTrouve() = Vrai ALORS
	// Affiche le client trouvé dans la fenêtre en cours
	FEN_Client.DepuisSource()
FIN

// Lecture de l'enregistrement et
// transfert des rubriques vers les champs de la fenêtre FEN_Client
HLitPremier(CLIENT, NOM)
FEN_Client.DepuisSource()
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Fenêtre>.DepuisSource([<Source>])`
---

**`<Fenêtre> : (Nom de fenêtre)`**

Nom de la fenêtre ou de la page contenant les champs à initialiser.

Si ce paramètre n'est pas spécifié ou correspond à une chaîne vide (""), la fenêtre à laquelle appartient le code en cours est utilisée.

**`<Source> : (Chaîne de caractères optionnelle)`**

Nom entre guillemets de la source à laquelle sont liés les champs à mettre à jour. Cette source peut être :

- Le nom d'un fichier de données : seuls les champs ayant un lien avec une rubrique de ce fichier de données sont pris en compte.

- Le nom d'une variable WLangage : seuls les champs ayant un lien avec cette variable WLangage sont pris en compte.
	Remarques : 

	- Si le nom de la variable est indiqué entre guillemets, la liaison sera effectuée avec la variable spécifiée. 

	- Si le nom de la variable n'est pas indiqué entre guillemets, la liaison sera effectuée avec le contenu de la variable (cas par exemple d'une variable contenant le nom d'une autre variable).





Si ce nom n'est pas spécifié, tous les champs de la fenêtre ayant un lien avec une rubrique d'un fichier de données décrit sous l'éditeur d'analyses ou une variable WLangage sont pris en compte.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Lien d'un champ avec une variable WLangage ou avec une rubrique d'un fichier de données
<a name="lien_champ_avec_une_variable_wlangage_avec_une_rubrique_fichier_donnees_ELTPARAGRAPHE000276"></a>La liaison d'un champ avec une variable WLangage ou avec une rubrique d'un fichier de données peut être connue :

- Sous l'éditeur, dans la fenêtre de description du champ (onglet "Liaison").

- Par programmation, grâce à la propriété [Liaisonfichier](../Proprietes/2510060.md).



<a name="NOTE0_2"></a>


### Liaison avec une rubrique : types de liaisons
<a name="liaison_avec_une_rubrique_types_liaisons_ELTPARAGRAPHE000292"></a>La liaison d'un champ vers une rubrique peut être de deux types :

- *liaison directe* : Dans ce cas, la fonction **&lt;Fenêtre&gt;.DepuisSource** transfère la valeur des rubriques de l'enregistrement chargé en mémoire dans le champ relié, sans effectuer de lecture.

- *liaison par recherche dans un fichier de données relié*.



<a name="NOTE0_3"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000308"></a>

- **Champ Combo auto-alimenté lié à un fichier de données HFSQL** : La fonction **&lt;Fenêtre&gt;.DepuisSource** ne doit pas se trouver dans l'événement "Déclarations globales" de la fenêtre. La fonction doit être présente dans l'événement "Initialisation" de la fenêtre.

- Les espaces dans les rubriques HFSQL sont conservés.

- La fonction **&lt;Fenêtre&gt;.DepuisSource** initialise les champs Image reliés à des rubriques de type mémo image avec la valeur de la rubrique.

- La fonction **&lt;Fenêtre&gt;.DepuisSource** gère la valeur NULL. Si le contenu de la rubrique correspond à NULL, une chaîne vide sera affichée dans le champ de saisie associé. Pour modifier ce mode d'affichage, utilisez la fonction [ChampErreur](../WDLang1/3025036.md).

- La fonction **&lt;Fenêtre&gt;.DepuisSource** ne fonctionne pas avec les vues. Il est nécessaire d'affecter une à une les rubriques aux champs.

- **Liaison avec des rubriques de type "Mot de passe sécurisé"** :

	- Dans un champ de saisie lié à une rubrique de type Mot de passe, les caractères "\*\*\*\*\*" sont affichés. Si le champ de saisie est de type "Mot de passe", des ronds sont alors affichés dans le champ de saisie. 

	- La valeur de la rubrique "Mot de passe" ne peut pas être relue tant que l'utilisateur n'a pas modifié la valeur du mot de passe.

	- La valeur de la rubrique "Mot de passe" peut toujours être comparée a une chaîne de caractères (par exemple "" ou "1234").







<a name="XComposante"></a>

## Composante :
wd280obj.dll
