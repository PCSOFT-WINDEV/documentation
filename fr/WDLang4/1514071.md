
## Description de Rubrique (Type de variable)

***En anglais : Item Description (Type of variable)***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Une variable de type **Description de Rubrique** permet de décrire par programmation une ou plusieurs rubriques d'un fichier de données. La description de chaque rubrique est validée par la fonction [HDécritRubrique](../WDLang4/3044233.md).

Après cette validation :

- Cette rubrique pourra être manipulée comme n'importe quelle rubrique décrite dans l'analyse.

- La variable de type "Description de Rubrique" est réinitialisée et pourra être utilisée pour décrire par programmation une autre rubrique de fichier de données.





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MaRubrique est une Description de Rubrique
MaRubrique1, MaRubrique2 sont des Descriptions de Rubrique
```


<a name="Exemple2"></a>



```wl
// Description du fichier UnFichier
...

// Description de la rubrique "NOM"
MaRubrique est une Description de Rubrique
MaRubrique.Nom = "NOM"
MaRubrique.Type = hRubTexte
MaRubrique.Taille = 40
MaRubrique.TypeClé = hCléUnique

// Validation de la description de la rubrique "NOM"
HDécritRubrique(UnFichier, MaRubrique)

// Validation de la description du fichier UnFichier
...
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Déclarer une ou plusieurs descriptions de rubrique

`<Nom de la variable> est une Description de Rubrique

<Nom de la variable 1>, <Nom de la variable 2> sont des Descriptions de Rubriques
`
---

**`<Nom de la variable> : ()`**

Nom de la variable de type "Description de Rubrique" à déclarer.

Remarque : Les mots-clés <u><u><u><u>une</u></u></u></u> et <u><u><u><u>des</u></u></u></u> ne sont pas obligatoires : ce sont des mots d'agrément.  


<a name="SYNTAXE2"></a>

### Décrire une variable de type "Description de Rubrique"

``
---

**Pour décrire une variable de type "Description de Rubrique"** :
utilisez les propriétés du WLangage spécifiques aux descriptions de rubriques. Pour plus de détails, consultez [les remarques](#NOTE0_1).

**Pour valider une description de variable de type "Description de Rubrique"** :
utilisez la fonction [HDécritRubrique](../WDLang4/3044170.md).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Propriétés spécifiques à la description de rubriques par programmation
<a name="proprietes_specifiques_description_rubriques_par_programmation_ELTPARAGRAPHE000088"></a>Les propriétés spécifiques à la description de rubriques sont les suivantes :

Remarque : Les propriétés en gras suivies d'un astérisque doivent obligatoirement être initialisées lors de la description d'une rubrique par programmation.

| Nom de la propriété | Effet |
| --- | --- |
| [Composante](../Proprietes/2512020.md) | Modifier une composante d'une clé composée |
| [DescriptionType](../Proprietes/1000021596.md) | Spécifier le type associé à une rubrique de type Enumération ou Combinaison. |
| [FormuleClé](../Proprietes/2512035.md) | Définir les composantes d'une clé composée. |
| [FormuleRubriqueCalculée](../Proprietes/1000021823.md) | Définir la formule SQL donnant la valeur d'une rubrique calculée (rubrique de type Formule). |
| [HauteurMaxVignette](../Proprietes/2512110.md) | Définir la hauteur maximale d'une vignette d'une rubrique. |
| [Langue](../Proprietes/1000017053.md) | Définir les paramètres de la langue utilisée pour les comparaisons et le tri dans le cas d'une rubrique Unicode. |
| [LangueDécrit](../Proprietes/1000017333.md) | Définir les paramètres de la langue utilisée pour les comparaisons et le tri dans le cas d'une rubrique Unicode. |
| [LargeurMaxVignette](../Proprietes/2512112.md) | Définir la largeur maximale d'une vignette d'une rubrique.<br><br> |
| [mdpsDérivation](../Proprietes/1410088386.md) | Définir l'algorithme de dérivation de clé utilisé pour le hachage (rubrique de type "Mot de passe"). |
| [mdpsHash](../Proprietes/1410088412.md) | Définir l'algorithme utilisé pour le salage (rubrique de type "Mot de passe"). |
| [mdpsNombreItération](../Proprietes/1410088388.md) | Définir le nombre d'itérations de l'algorithme de hachage (rubrique de type "Mot de passe"). |
| [mdpsTaille](../Proprietes/1410088387.md) | Définir la taille de la clé après hachage (rubrique de type "Mot de passe"). |
| [NbElémentTableau](../Proprietes/2512053.md) | Nombre d'éléments d'une rubrique tableau. |
| [**Nom**](../Proprietes/2510082.md) ( \* ) | Nom de la rubrique. |
| [Null](../Proprietes/2512064.md) | Prise en compte de l'option "NULL par défaut" pour la rubrique. |
| [NullAutorisé](../Proprietes/1000019492.md) | Définir si la valeur NULL est autorisée ou non pour la rubrique. |
| [PartieDécimale](../Proprietes/2512119.md) | Définir le nombre de chiffres de la partie décimale d'une rubrique de type Numérique. |
| [PartieEntière](../Proprietes/2512118.md) | Définir le nombre de chiffres de la partie entière d'une rubrique de type Numérique. |
| [PersistanceRubriqueCalculée](../Proprietes/1000021858.md) | Définir si la valeur d'un rubrique calculée (de type Formule) est mémorisée dans le fichier de données. |
| [RGPD](../Proprietes/1000025474.md) | Définir si la rubrique est concernée par le RGPD. |
| [SensibleAccentuation](../Proprietes/2512077.md) | Prise en compte de l'accentuation dans les différentes recherches effectuées sur la rubrique |
| [SensibleCasse](../Proprietes/2512085.md) | Prise en compte de la casse (majuscules/minuscules) dans les différentes recherches effectuées sur la rubrique |
| [SensiblePonctuation](../Proprietes/2512087.md) | Prise en compte de la ponctuation (virgule, point, ...) dans les différentes recherches effectuées sur la rubrique |
| [**Taille**](../Proprietes/2510125.md) (\* obligatoire selon le type spécifié) | Taille d'une rubrique de type texte (chaîne de caractères, mémo texte, caractère)<br>Taille d'une rubrique Heure. |
| [TailleClé](../Proprietes/1000017277.md) | Taille de la partie à indexer du mémo texte. |
| [TimestampType](../Proprietes/1000021954.md) | Définir le type d'horodatage de la rubrique. |
| [TimestampUTC](../Proprietes/1000021955.md) | Définir si l'heure d'une rubrique de type horodatage est UTC ou non. |
| [**Type**](../Proprietes/2510131.md) (\* ) | Identifie et modifie le type d'une rubrique. |
| [TypeClé](../Proprietes/2512060.md) | Caractéristiques d'une rubrique de type clé. |
| [TypeTri](../Proprietes/2512091.md) | Caractéristiques de tri sur une rubrique. |
| [ValeurParDéfaut](../Proprietes/2512092.md) | Valeur par défaut d'une rubrique. |
| [ValeurParDéfautCalculée](../Proprietes/1000021825.md) | Définir la formule SQL donnant la valeur par défaut de la rubrique. |




**Cas particulier : Décrire une clé composée**
Lors de la description d'une clé composée par programmation, la propriété **[Type](../Proprietes/2510131.md)** n'est pas obligatoire. Par contre, il est nécessaire d'utiliser la propriété [FormuleClé](../Proprietes/2512035.md) pour décrire la composition de la clé composée.

**Cas particulier : Décrire une clé primaire** : 

- Il est nécessaire de spécifier avec la propriété [TypeClé](../Proprietes/2512060.md) que la rubrique est une clé primaire. 

- Si la rubrique peut être nulle (propriété [NullAutorisé](../Proprietes/1000019492.md) à <u><u><u><u>Vrai</u></u></u></u>) et clé primaire, alors la propriété [NullAutorisé](../Proprietes/1000019492.md) de la rubrique sera automatiquement mise à <u><u><u><u>Faux</u></u></u></u>.   




**Cas particulier : Décrire une rubrique Combinaison ou Enumération** : 

- Il est nécessaire d'utiliser la propriété [DescriptionType](../Proprietes/1000021596.md) pour définir le type utilisé par la rubrique. 

- Il est nécessaire de spécifier le type avec la propriété [Type](../Proprietes/2510131.md) avant d'indiquer la valeur par défaut avec la propriété [ValeurParDéfaut](../Proprietes/2512092.md).




**Cas particulier : Décrire une rubrique Horodatage** : 

- La rubrique doit être de type DateHeure, Date ou Heure. 

- Il est nécessaire de spécifier le type d'horodatage avec la propriété [TimestampType](../Proprietes/1000021954.md).




**Cas particulier : Décrire une rubrique Formule** : 
Lors de la description d'une rubrique de type Formule par programmation, la propriété [Type](../Proprietes/2510131.md) ne doit pas être utilisée. Il est nécessaire d'utiliser la propriété [FormuleRubriqueCalculée](../Proprietes/1000021823.md) pour décrire la formule de calcul.
<a name="NOTE0_2"></a>


### Comment décrire des fichiers de données par programmation ? 
<a name="comment_decrire_des_fichiers_donnees_par_programmation_ELTPARAGRAPHE000364"></a>Pour décrire des fichiers de données par programmation, il faut :

1. Pour chaque fichier de données :

	- Décrire les caractéristiques du fichier de données grâce aux [propriétés HFSQL](../Proprietes/2512070.md).

	- Décrire les caractéristiques des rubriques grâce aux [propriétés HFSQL](../Proprietes/2512070.md).

	- Valider la description de chaque rubrique (fonction [HDécritRubrique](../WDLang4/3044233.md)).

	- Décrire si nécessaire les caractéristiques des index full-text grâce aux [propriétés HFSQL](../Proprietes/2512070.md).

	- Valider la description de chaque index full-text (fonction [HDécritIndexFullText](../WDLang4/1000017407.md)).

	- Valider la description du fichier de données (fonction [HDécritFichier](../WDLang4/3044206.md)).




2. Décrire si nécessaire les caractéristiques des liaisons grâce aux [propriétés HFSQL](../Proprietes/2512070.md).

3. Valider si nécessaire la description de chaque liaison (fonction [HDécritLiaison](../WDLang4/3044191.md)).





<a name="NOTE0_3"></a>




### Manipulation des rubriques d'un fichier de données décrit par programmation
<a name="manipulation_des_rubriques_fichier_donnees_decrit_par_programmation_ELTPARAGRAPHE000408"></a>Lors de la création d'un fichier de données sous l'éditeur d'analyses, les noms du fichier de données et de ses rubriques sont automatiquement reconnus par le compilateur.

Lors de la création d'un fichier de données à l'aide d'une variable de type "Description de Fichier", les noms du fichier de données et de ses rubriques sont définis grâce à la propriété [Nom](../Proprietes/2510082.md). Ces noms ne sont pas automatiquement reconnus par le compilateur. L'utilisation de ces noms pour désigner le fichier de données ou ses rubriques provoque une erreur de compilation.

Pour que les noms du fichier de données décrit par programmation et de ses rubriques soient reconnus par le compilateur, il est nécessaire de déclarer le nom du fichier de données en tant que [source de données](../WDLang4/1514053.md). Ce fichier de données et ses rubriques pourront alors être manipulés par leur nom sous l'éditeur de code.

Par exemple :


```wl
UnFichier est une Description de Fichier
...
UnFichier.Nom = "CLIENT"
...
HDécritFichier("CLIENT")
...
CLIENT est une Source de Données
...
HLitPremier(CLIENT, "NOMCLI")
```


**Remarque** : Il est également possible de déclarer le nom du fichier de données avec le mot-clé [Externe](../Motscles/1511013.md). Cependant, la vitesse d'exécution du traitement sera ralentie.


<a name="NOTE0_4"></a>




### Journalisation
<a name="journalisation_ELTPARAGRAPHE000436"></a>Lors de la description du fichier de données par programmation :

- si le fichier de données est journalé et si aucune rubrique n'est journalée, toutes les rubriques (sauf les clés composées) sont automatiquement passées en journalées.

- si le fichier de données est journalé et si au moins une rubrique est journalée, les autres rubriques ne sont pas modifiées.







