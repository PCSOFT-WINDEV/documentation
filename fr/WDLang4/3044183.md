
## Gestion des identifiants automatiques lors de l'ajout d'un enregistrement 
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000174"></a>


### Rappel
<a name="rappel_ELTPARAGRAPHE000011"></a>

Lors de l'ajout d'un enregistrement dans un fichier de données HFSQL (fonction [HAjoute](../WDLang4/3044147.md)), trois modes de gestion des identifiants automatiques sont disponibles :

- [identifiant automatique calculé par le moteur HFSQL](#NOTE2_1).

- [identifiant automatique forcé](#NOTE3_1).

- [identifiant automatique fixé](#NOTE4_1).








<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Identifiant automatique calculé par le moteur HFSQL
<a name="identifiant_automatique_calcule_par_moteur_hfsql_ELTTEXTE000204"></a>
L'identifiant automatique est calculé à chaque ajout par le moteur HFSQL. Cet identifiant est unique pour chaque enregistrement du fichier de données.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IDAUTOAJOUT1.gif)


Exemple : Ajout d'un enregistrement dans le fichier CLIENT.

Lors de l'ajout de l'enregistrement, l'identifiant automatique IDCLIENT est automatiquement calculé par le moteur HFSQL.

La dernière valeur de l'identifiant automatique était **6**. La valeur de l'identifiant automatique pour ce nouvel enregistrement sera **7**.



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Identifiant automatique forcé (hForceIdAuto)
<a name="identifiant_automatique_force_hforceidauto_ELTTEXTE000228"></a>
L'identifiant automatique n'est pas calculé lors de l'ajout. L'identifiant correspond :

- soit à la valeur affectée à la rubrique par programmation (par exemple CLCLEUNIK = 7).

- soit à la valeur par défaut de l'identifiant spécifiée dans l'éditeur d'analyses (si le fichier de données vient d'être ouvert, sans lecture d'enregistrement).

- soit à la valeur de l'identifiant présent en mémoire (valeur de l'identifiant pour le dernier enregistrement lu dans le fichier).




Après l'ajout de l'enregistrement, le prochain identifiant automatique calculé par défaut par le moteur HFSQL, sera calculé :

- par rapport à la dernière valeur de l'identifiant automatique.

- sans tenir compte de la valeur ajoutée par hForceIdAuto.




Ce mode d'utilisation de l'identifiant automatique est utile lors de copie d'enregistrements entre plusieurs alias d'un fichier de données. Mais il doit être utilisé avec précaution car il risque de provoquer des erreurs de doublons.

![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IDAUTOAJOUT2.gif)![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IDAUTOAJOUT2_BIS.Gif)

Exemple : Ajout dans le fichier CLIENT d'un enregistrement avec identifiant automatique forcé.

Deux enregistrements sont ajoutés au fichier CLIENT :

- un enregistrement dont l'identifiant automatique est forcé à 15.

- un enregistrement dont l'identifiant automatique est calculé par le moteur HFSQL. L'identifiant automatique de cet enregistrement sera calculée par rapport à la dernière valeur de l'identifiant (dans notre exemple, 7).




Dans cet exemple, les prochains ajouts ne provoqueront pas d'erreur de doublons jusqu'à ce que l'identifiant automatique prenne pour valeur 15 : l'ajout de cet enregistrement provoquera une erreur de doublons.



<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Identifiant automatique fixé (hFixeIDAuto)
<a name="identifiant_automatique_fixe_hfixeidauto_ELTTEXTE000252"></a>
L'identifiant automatique n'est pas calculé lors de l'ajout. L'identifiant correspond :

- soit à la valeur affectée à la rubrique par programmation ( par exemple CLCLEUNIK = 7). 

- soit à la valeur par défaut de l'identifiant spécifiée dans l'éditeur d'analyses (si le fichier de données vient d'être ouvert, sans lecture d'enregistrement). 

- soit à la valeur de l'identifiant présent en mémoire (valeur de l'identifiant pour le dernier enregistrement lu dans le fichier de données).




Après l'ajout de l'enregistrement, le prochain identifiant automatique calculé par défaut par le moteur HFSQL sera calculé par rapport à la plus grande valeur de l'identifiant présent dans le fichier de données. Il n'y a dans ce cas aucun risque de doublons sur l'identifiant unique.

Exemple : Ajout dans le fichier CLIENT d'un enregistrement avec identifiant automatique fixé.
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IDAUTOAJOUT3.gif)


Cas N°1 : Deux enregistrements sont ajoutés au fichier CLIENT :

- un enregistrement dont l'identifiant automatique est forcé à 3.

- un enregistrement dont l'identifiant automatique est calculé par le moteur HFSQL. L'identifiant automatique de cet enregistrement sera calculé par rapport à la plus grande valeur de l'identifiant automatique dans le fichier (7).




Cas N°2 : Deux enregistrements sont ajoutés au fichier CLIENT :

- un enregistrement dont l'identifiant automatique est forcé à 10.

- un enregistrement dont l'identifiant automatique est calculé par le moteur HFSQL. L'identifiant automatique de cet enregistrement sera calculée par rapport à la plus grande valeur de l'identifiant automatique dans le fichier (10).







