


## &lt;Variable Connexion&gt;.ModifieDroitServeur (Fonction)

***En anglais : &lt;Connection variable&gt;.ModifyServerRights***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie les droits accordés sur un serveur HFSQL pour un utilisateur ou un groupe. 

**Remarque** : il est possible de connaître les droits d'un groupe ou d'un utilisateur sur un serveur HFSQL grâce à la fonction [&lt;Variable Connexion&gt;.InfoDroitServeur](../WDLang4/1000022668.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Description de la connexion
MaConnexion est une Connexion

// Copie de droits d'un utilisateur à un autre
Droits est une chaîne
Droits = MaConnexion.InfoDroitServeur("Dupont", hDroitCréationBDD)
MaConnexion.ModifieDroitServeur("Durand", hDroitCréationBDD, Droits)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Connexion>.ModifieDroitServeur(<Utilisateur/Groupe> , <Droits à modifier> , <Nouvelles valeurs>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si les droits ont été modifiés, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'identifier l'erreur. Si le droit spécifié a déjà la nouvelle valeur, aucune modification n'est effectuée.




**Remarque** : Une erreur "Utilisateur inconnu" ou "Groupe inconnu" sera renvoyée par la fonction [HErreurInfo](../WDLang4/3044071.md) si l'utilisateur en cours n'a pas le droit de visualisation des utilisateurs (constante *hDroitVisualisationUtilisateur*) et s'il demande des informations concernant un autre utilisateur ou groupe.

**`<Connexion> : (Variable de type Connexion)`**

Nom de la variable de type [Connexion](../WDLang4/1514073.md) décrivant la connexion pour laquelle les droits d'un utilisateur ou d'un groupe d'utilisateurs doivent être modifiés.

**`<Utilisateur/Groupe> : (Chaîne de caractères)`**

Nom de l'utilisateur ou du groupe dont on veut modifier les droits.

**`<Droits à modifier> : (Constante ou combinaison de constantes de type Entier)`**

Liste des droits à modifier :


|   |   |
| --- | --- |
| *hDroitArrêtServeur* | Droit d'arrêter un serveur (fonction [&lt;Variable Connexion&gt;.ArrêteServeur](../WDLang4/1000022648.md)). |
| *hDroitChangeDroit* | Droit de changer les droits. |
| *hDroitChangeMotDePasse* | Droit de changer le mot de passe d'un utilisateur sur le serveur (Pour un utilisateur, peut changer son mot de passe, pour l'administrateur peut changer le mot de passe de chaque utilisateur). |
| *hDroitCréationBDD* | Droit de créer une base de données.<br>**Remarque** : Le droit de créer une base de données donne automatiquement le droit de connexion sur cette base de données lors de sa création. |
| *hDroitDéconnecteClient* | Droit de déconnecter les postes client. |
| *hDroitEnvoieMessageVersClient* | Droit d'envoyer des messages aux postes client. |
| *hDroitGèreTâche* | Droit de gérer les tâches planifiées. |
| *hDroitGestionServeur* | Droit d'utiliser la fonction [&lt;Variable Connexion&gt;.GèreServeur](../WDLang4/1000022664.md). |
| *hDroitGestionUtilisateur* | Droit de supprimer ou d'ajouter des utilisateurs ou des groupes. |
| *hDroitLectureLogStat* | Droit de consulter les statistiques d'activité et les logs du serveur. |
| *hDroitPriorité* | Droit de modifier la priorité de l'application en cours (fonction [&lt;Variable Connexion&gt;.Priorité](../WDLang4/1000022746.md)) ou d'une autre application cliente (fonction [&lt;Variable Connexion&gt;.PrioritéClient](../WDLang4/1000022747.md)). |
| *hDroitRéplicationServeur* | Droit de définir et de réaliser une réplication entre 2 serveurs HFSQL. |
| *hDroitSauvegarde* | Droit de réaliser une sauvegarde. |
| *hDroitVisualisationUtilisateur* | Droit de visualiser les informations concernant les utilisateurs et les groupes. |



**`<Nouvelles valeurs> : (Constantes de type entier)`**

Liste des nouvelles valeurs des droits modifiés. Pour chaque droit précisé dans le paramètre &lt;Droits à modifier&gt;, il est nécessaire de préciser la nouvelle valeur du droit (en respectant le même ordre).

Si une seule valeur est précisée dans ce paramètre, elle sera utilisée pour tous les droits indiqués dans le paramètre &lt;Droits à modifier&gt;.

Les valeurs possibles sont les suivantes :



|   |   |
| --- | --- |
| *hAutorisé* | L'utilisateur ou le groupe a le droit considéré. |
| *hHérité* | L'utilisateur héritera de la valeur du droit donnée au groupe d'utilisateurs auquel il appartient. |
| *hInterdit* | L'utilisateur ou le groupe n'a pas le droit considéré. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Quand est-ce que la modification du droit est réalisée ? 
<a name="quand_estce_que_modification_droit_est_realisee_ELTPARAGRAPHE000366"></a>La modification du droit est effective dès que la fonction **&lt;Variable Connexion&gt;.ModifieDroitServeur** est exécutée pour les utilisateurs connectés et concernés par la modification. Il n'est pas nécessaire de redémarrer le serveur pour prendre en compte les nouveaux droits.
<a name="NOTE0_2"></a>


### Quels sont les droits nécessaires pour ajouter et/ou modifier les utilisateurs ou les groupes ? 
<a name="quels_sont_les_droits_necessaires_pour_ajouter_etou_modifier_les_utilisateurs_les_groupes_ELTPARAGRAPHE000379"></a>Le tableau suivant présente les droits nécessaires pour manipuler les caractéristiques des utilisateurs et ou des groupes :

|   | hDroitGestionUtilisateur | hDroitVisualisationUtilisateur |
| --- | --- | --- |
| Actions sur les autres utilisateurs ou groupes (différents de l'utilisateur et du groupe en cours) |   | x |
| Modifier le nom d'un utilisateur ou d'un groupe | x | x |
| Ajouter un  utilisateur ou un groupe | x | x |
| Modifier les caractéristiques de l'utilisateur ou du groupe en cours | x |   |
| Voir les utilisateurs ou les groupes |   | x |



<a name="XComposante"></a>

## Composante :
wd280hf.dll
