
## HSubstRep (Fonction)

***En anglais : HSubstDir***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Associe le répertoire des données spécifié dans l'analyse à un répertoire présent sur le disque. Après l'exécution de la fonction **HSubstRep**, tous les fichiers de données associés au répertoire spécifié dans l'analyse seront manipulés dans le répertoire indiqué.

**Attention** : Les fichiers de données doivent être préalablement fermés (fonction [HFerme](../WDLang4/3044073.md)).

Pour modifier le chemin d'un seul fichier de données, utilisez la fonction [HChangeRep](../WDLang4/3044168.md).

**Remarque** : En mode Client/Serveur, utilisez la fonction [HChangeRep](../WDLang4/3044168.md).






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003044028&name=hsubstrep_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png) 
```wl
// Changement de répertoire pour les fichiers définis dans
// un répertoire spécifique dans l'analyse
HSubstRep("C:\Fichier", "D:\Fichier")
// Ouverture/création des fichiers dans le nouveau répertoire
HCréationSiInexistant("*")
```


<a name="Exemple2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/fr/HF.png) 
```wl
SI HSubstRep(".","C:\COMPTA\ANNEE2012") = Vrai ALORS
	Info("Vous allez travailler sur les fichiers présents dans le répertoire : C:\COMPTA\ANNEE2012")
SINON
	Erreur(HErreur)
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HSubstRep(<Répertoire des fichiers spécifié dans l'analyse> , <Répertoire physique des fichiers sur le disque>)`
---

**`<Résultat> : (Booléen)`**

Ce paramètre est toujours égal à <u><u><u><u>Vrai</u></u></u></u>. En cas d'erreur, la prochaine fonction d'accès au fichier de données utilisée renverra <u><u><u><u>Faux</u></u></u></u>. Par exemple, si le répertoire physique indiqué n'existe pas, une erreur de répertoire apparaîtra lors du premier accès au fichier de données.

**`<Répertoire des fichiers spécifié dans l'analyse> : (Chaîne de caractères)`**

Nom du répertoire donné lors de la description du fichier de données.

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Si ce paramètre est égal à "?" ou ".", le répertoire courant de l'application est pris en compte (répertoire retourné par la fonction [fRepEnCours](../WDLang1/3036022.md)).

**`<Répertoire physique des fichiers sur le disque> : (Chaîne de caractères)`**

Nouveau nom du répertoire (260 caractères maximum). Un chemin de type UNC peut être utilisé.

Si le répertoire spécifié contient des fichiers de données non HFSQL, la fonction **HSubstRep** est ignorée.

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Si ce paramètre correspond à :

- une chaîne vide ("") : la substitution est annulée : le répertoire des données décrit dans l'analyse est pris en compte.

- "?" ou "." : le répertoire physique des données correspond au répertoire en cours.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Substitutions de répertoire multiples
<a name="substitutions_repertoire_multiples_ELTPARAGRAPHE000125"></a>La fonction **HSubstRep** peut être appelée plusieurs fois avec des paramètres différents. Lorsque le répertoire physique est redéfini plusieurs fois pour un même répertoire logique (décrit dans l'analyse), le dernier répertoire physique spécifié remplace tous les autres.


<a name="NOTE0_2"></a>




### Substitution de répertoire
<a name="substitution_repertoire_ELTPARAGRAPHE000137"></a>La fonction [HChangeRep](../WDLang4/3044168.md) permet d'associer un répertoire à un fichier de données. Pour substituer un répertoire par un autre, utilisez la fonction **HSubstRep**.

Attention : la substitution de répertoire effectuée par **HSubstRep** s'applique sur le répertoire définit par la fonction [HChangeRep](../WDLang4/3044168.md). Par exemple :


```wl
HSubstRep("C:\Statistiques\Janvier", "C:\Nouveau\StatJanv")
HChangeRep(Stat, "C:\Statistiques\Janvier")
HCréation(Stat) //Fichier créé sous C:\Nouveau\StatJanv
```



<a name="NOTE0_3"></a>




### Divers
<a name="divers_ELTPARAGRAPHE000162"></a>

- Si la gestion du ".REP" est branchée (fonction [HGèreRep](../WDLang4/3044061.md)), la modification du chemin est enregistrée dans le fichier ".REP" (voir [gestion du .REP](../WDLang4/3044186.md)).

- La fermeture du fichier de données conserve le nouveau chemin.

- Le nombre de substitutions est illimité.






<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
