	
## HFiltreComprisEntre (Fonction)

***En anglais : HFilterIncludedBetween***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Définit et active un filtre de type "Compris entre" sur un fichier de données, une vue ou une requête. Le filtre de type "Compris Entre" permet de sélectionner tous les enregistrements compris entre deux valeurs données.

Après son exécution, les cas suivants sont les plus fréquents :

- le filtre ne peut pas être créé : la fonction **HFiltreComprisEntre** renvoie une chaîne vide (""). La fonction [HErreur](../WDLang4/3044088.md) permet de récupérer l'identifiant de l'erreur.

- le filtre est créé : la fonction **HFiltreComprisEntre** renvoie la clé de parcours optimale à utiliser pour réaliser le parcours du fichier de données, de la vue ou de la requête.





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MaCléParcours est une chaîne
MaCléParcours = HFiltreComprisEntre(Client, NomPrénom, ...
		"A", "B" + hValMax, hSéparateurBorne, "C", "D" + hvalMax)
// Sélection de tous les clients dont le nom est compris entre A et C
// et dont le prénom est compris entre C et D
HLitPremier(Client, MaCléParcours)
TANTQUE PAS HEnDehors(Client)
	Trace(Client.NomClient, Client.Ville)
	HLitSuivant(Client, MaCléParcours)
FIN
...
// Désactive le filtre
HDésactiveFiltre(Client)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HFiltreComprisEntre(<Fichier de données> , <Rubrique clé> , <Borne min de la composante 1 de la clé> [, <Borne min de la composante 2 de la clé> [... [, <Borne min de la composante N de la clé>]]] , <hSéparateurBorne> , <Borne max de la composante 1 de la clé> [, <Borne max de la composante 2 de la clé> [... [, <Borne min de la composante N de la clé>]]])`
---

**`<Résultat> : (Chaîne de caractères)`**

Rubrique de parcours. Correspond :

- soit à la clé de parcours du fichier de données si le filtre est activé.

- soit à une chaîne vide ("") si le filtre ne peut pas être mis en place.




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données, de la vue ou de la requête manipulé.

**`<Rubrique clé> : (Chaîne de caractères)`**

Nom de la rubrique clé sur laquelle le filtre doit être réalisé. Cette rubrique peut être une clé simple de type chaîne ou une clé composée. 
Attention : ce paramètre ne doit contenir que des lettres, des caractères soulignés ou des chiffres. Dans le cas contraire, il faut entourer le nom de guillemets.

**`<Borne min de la composante 1 de la clé> : (Type de la première composante de la clé de parcours)`**

Borne minimale pour la première (respectivement deuxième, ...) composante de la clé composée. Les enregistrements correspondant à cette valeur sont inclus dans le filtre. 
Le type de ce paramètre doit correspondre au type de la composante de la rubrique clé sur laquelle le filtre est défini.

**`<Borne min de la composante 2 de la clé> : (Type de la seconde composante de la clé de parcours)`**

Borne minimale pour la seconde composante de la clé composée. Les enregistrements correspondant à cette valeur sont inclus dans le filtre. 
Le type de ce paramètre doit correspondre au type de la composante de la rubrique clé sur laquelle le filtre est défini.



**`<Borne min de la composante N de la clé> : (Type de la nième composante de la clé de parcours)`**

Borne minimale pour la nième composante de la clé composée. Les enregistrements correspondant à cette valeur sont inclus dans le filtre. 
Le type de ce paramètre doit correspondre au type de la composante de la rubrique clé sur laquelle le filtre est défini.

**`<hSéparateurBorne> : (Constante de type Entier)`**

La constante *hSéparateurBorne* permet de séparer les valeurs des bornes minimales et maximales pour les composantes de la clé composée.

**`<Borne max de la composante 1 de la clé> : (Type de la première composante de la clé de parcours)`**

Borne maximale pour la première (respectivement deuxième, ...) composante de la clé composée. Les enregistrements correspondant à cette valeur sont inclus dans le filtre. 
Le type de ce paramètre doit correspondre au type de la composante de la rubrique clé sur laquelle le filtre est défini.

**`<Borne max de la composante 2 de la clé> : (Type de la seconde composante de la clé de parcours)`**

Borne maximale pour la seconde composante de la clé composée. Les enregistrements correspondant à cette valeur sont inclus dans le filtre. 
Le type de ce paramètre doit correspondre au type de la composante de la rubrique clé sur laquelle le filtre est défini.



**`<Borne min de la composante N de la clé> : (Type de la nième composante de la clé de parcours)`**

Borne minimale pour la nième composante de la clé composée. Les enregistrements correspondant à cette valeur sont inclus dans le filtre. 
Le type de ce paramètre doit correspondre au type de la composante de la rubrique clé sur laquelle le filtre est défini.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Gestion automatique des clés composées
<a name="gestion_automatique_des_cles_composees_ELTPARAGRAPHE000147"></a>La fonction **HFiltreComprisEntre** gère automatiquement les filtres sur les clés simples comme sur les clés composées.

Exemple : Utilisation de la fonction **HFiltreComprisEntre** avec une clé simple :

```wl
RésultatFiltre = HFiltreComprisEntre(Client, Nom, "A", hSéparateurBorne, "B" + hValMax)
// Sélection de tous les clients dont le nom est compris entre A et C
```


Exemple : Utilisation de la fonction **HFiltreComprisEntre** avec une clé composée

```wl
RésultatFiltre = HFiltreComprisEntre(Client, NomPrénom, "A", "B" + hValMax, ...
		hSéparateurBorne, "C", "D" + hValMax)
// Sélection de tous les clients dont le nom est compris entre A et C
// et dont le prénom est compris entre C et D
```
Cette ligne de code est équivalente à :

```wl
HFiltre(Client, NomPrénom, ...
	HConstruitValClé(Client, NomPrénom, "A", "B" + hValMin), ... 
	HConstruitValClé(Client, NomPrénom, "C", "D" + hValMax))
```

<a name="NOTE0_2"></a>


### Filtre et parcours filtré
<a name="filtre_parcours_filtre_ELTPARAGRAPHE000188"></a>Après l'exécution de la fonction **HFiltreComprisEntre**, le parcours du fichier de données doit obligatoirement être effectué sur la rubrique renvoyée par la fonction **HFiltreComprisEntre**. Si une autre rubrique est utilisée pour le parcours du fichier de données, le filtre ne sera pas pris en compte.

Lorsqu'un filtre est défini et activé sur un fichier de données (une vue ou une requête), tout enregistrement lu correspond au filtre. Si il n'y a plus d'enregistrement correspondant au filtre lors du parcours :

- la fonction [HEnDehors](../WDLang4/3044094.md) renvoie <u><u><u><u>Vrai</u></u></u></u>.

- l'enregistrement en cours correspond au dernier enregistrement lu avec le filtre.




Par exemple :


|   |   |
| --- | --- |
| **Sur un fichier de données filtré, après la fonction** : | **l'enregistrement en cours est** : |
| **[HLitPremier](../WDLang4/3044051.md)** | le premier enregistrement du fichier de données correspondant au filtre |
| **[HLitDernier](../WDLang4/3044140.md)** | le dernier enregistrement du fichier de données correspondant au filtre |
| **[HLitSuivant](../WDLang4/3044037.md)** (ou **[HAvance](../WDLang4/3044154.md)**) | l'enregistrement suivant (ou le nième suivant) correspondant au filtre |
| **[HLitPrécédent](../WDLang4/3044048.md)** (ou **[HRecule](../WDLang4/3044126.md)**) | l'enregistrement précédent (ou le nième précédent) correspondant au filtre |


<a name="NOTE0_3"></a>


### Activation/désactivation d'un filtre
<a name="activationdesactivation_filtre_ELTPARAGRAPHE000256"></a>

- La fonction [HDésactiveFiltre](../WDLang4/3044085.md) permet de désactiver un filtre.

- La fonction [HActiveFiltre](../WDLang4/3044158.md) permet de ré-activer un filtre.

- Lorsque le fichier de données (la requête ou la vue) est fermé (fonction [HFerme](../WDLang4/3044073.md) par exemple), le filtre est supprimé.

- A un même instant, il ne peut exister qu'un seul filtre sur un fichier de données (une requête ou une vue). Si la fonction **HFiltreComprisEntre** est utilisée plusieurs fois, seul le dernier filtre sera pris en compte : le(s) filtre(s) précédent(s) seront supprimés. De même si plusieurs filtres sont utilisés (fonctions HFiltre\*), seul le dernier filtre sera pris en compte.



<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Fichiers de données non HFSQL
<a name="fichiers_donnees_non_hfsql_ELTPARAGRAPHE000282"></a>

- Le filtre peut être créé à partir de n'importe quelle rubrique (rubrique clé ou non clé).

- L'exécution de la fonction **HFiltreComprisEntre** rend automatiquement le filtre actif.

- Les modifications apportées par les fonctions **HFiltreComprisEntre** et [HDésactiveFiltre](../WDLang4/3044085.md) sont prises en compte uniquement lors de l'utilisation des fonctions [HLitPremier](../WDLang4/3044051.md)/[HPremier](../WDLang4/3044113.md), [HLitDernier](../WDLang4/3044140.md)/[HDernier](../WDLang4/3044101.md) ou [HLitRecherchePremier](../WDLang4/3044036.md)/[HLitRechercheDernier](../WDLang4/3044034.md).




<a name="XComposante"></a>

## Composante :
wd280hf.dll
