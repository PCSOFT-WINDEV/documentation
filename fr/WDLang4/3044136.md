


## HSauvePosition (Fonction)

***En anglais : HSavePosition***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Mémorise le contexte en cours d'un fichier de données : enregistrement en cours, filtre, pointeurs de lecture. Il est ainsi possible de suspendre momentanément le traitement en cours, d'utiliser le fichier de données par ailleurs (pour effectuer des vérifications par exemple). Le contexte sauvegardé pourra être restitué grâce à la fonction [HRetourPosition](../WDLang4/3044137.md). Le traitement principal pourra alors continuer.

La fonction **HSauvePosition** permet de sauvegarder :

- le numéro de l'enregistrement manipulé,

- les différents pointeurs dans l'index (sauvegarde pour chaque clé de la position dans l'index),

- le filtre en cours. Il sera nécessaire d'utiliser la constante *HRPFiltre* dans la fonction [HRetourPosition](../WDLang4/3044137.md) pour retrouver le filtre sauvegardé.  




Cette fonction peut être utilisée indifféremment avec les fichiers de données, les vues HFSQL ou les requêtes.

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Recherche d'un enregistrement
HLitRecherchePremier(Client, Nom, Nom)
TANTQUE HTrouve(Client) = Vrai
	// Sauve le contexte en cours
	nPos = HSauvePosition(Client, Nom)
	// Vérification d'un client d'un autre nom
	HLitRecherche(Client, Nom, Nom2)
	SI HTrouve() = Vrai ALORS Compteur = Compteur + 1
	// Restaure le contexte
	HRetourPosition(nPos)
	HLitSuivant(Client, Nom)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HSauvePosition([<Fichier de données> [, <Rubrique>]] [, <Options>])`
---

**`<Résultat> : (Entier)`**



- Numéro de la position sauvegardée, 

- -1 en cas d'erreur.




**`<Fichier de données> : (Chaîne de caractères optionnelle)`**

Nom du fichier de données, de la vue ou de la requête manipulé. Si ce nom n'est pas spécifié, la fonction **HSauvePosition** va manipuler le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Rubrique> : (Chaîne de caractères optionnelle)`**

Nom de la rubrique utilisée. Si ce paramètre n'est pas spécifié, la fonction **HSauvePosition** sauve les positions de toutes les rubriques pour lesquelles un parcours est en cours.
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Le paramètre &lt;Rubrique&gt; ne sera pas pris en compte : la position sera sauvegardée pour toutes les rubriques sur lesquelles un parcours est en cours.

**`<Options> : (Constante optionnelle de type entier)`**

Permet de paramétrer la sauvegarde :



|   |   |   |
| --- | --- | --- |
| *hSauveRubriques* | Sauve les valeurs des rubriques en mémoire au moment de l'utilisation de la fonction **HSauvePosition**. Ces valeurs seront restaurées lors de l'appel à la fonction [HRetourPosition](../WDLang4/3044137.md).<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est disponible uniquement pour les fichiers de données HFSQL. |   |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Exemples de gestion de position dans un fichier de données
<a name="exemples_gestion_position_dans_fichier_donnees_ELTPARAGRAPHE000132"></a>Les fonctions **HSauvePosition** et [HRetourPosition](../WDLang4/3044137.md) peuvent être utilisées par exemple dans les cas suivants :

- fiche affichant un enregistrement et permettant un parcours du fichier de données selon une clé. Une autre fenêtre est appelée pour la visualisation des données sous forme de table. La gestion des positions permet de revenir simplement sur le bon enregistrement dans le parcours des fiches.

- visualisation d'un fichier de données dans un champ Table. La sélection d'un enregistrement permet d'afficher l'enregistrement sélectionné sous forme de fiche, avec possibilité de parcourir les fiches. La gestion des positions permet de revenir à l'affichage du champ Table en étant correctement positionné dans le fichier de données.



<a name="NOTE0_2"></a>


### Réinitialisation des positions
<a name="reinitialisation_des_positions_ELTPARAGRAPHE000150"></a>Attention : toutes les fonctions entraînant l'ouverture ou la fermeture d'un fichier de données réinitialisent les numéros de contexte (par exemple [HCréation](../WDLang4/3044255.md), [HFerme](../WDLang4/3044073.md), ...).
<a name="NOTE0_3"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000165"></a>

- Le nombre d'appels à la fonction **HSauvePosition** n'est pas limité.

- Il est possible d'imbriquer les fonctions **HSauvePosition** et [HRetourPosition](../WDLang4/3044137.md) pour un même fichier de données.

- Si l'enregistrement pointé lors de l'appel à la fonction **HSauvePosition** est supprimé, il n'est plus possible d'appeler la fonction [HRetourPosition](../WDLang4/3044137.md).



<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Repositionnement par OLE DB et Connecteurs Natifs MySQL, DB2 et Informix
<a name="repositionnement_par_ole_connecteurs_natifs_mysql_db2_informix_ELTPARAGRAPHE000193"></a>Si la base de données ou l'état du parcours (parcours ré-initialisé par exemple) ne permettent pas de se repositionner directement sur l'enregistrement, le repositionnement est effectué dans le cache des enregistrement lus.

Les fonctions suivantes réinitialisent le parcours :

- [HLitPremier](../WDLang4/3044051.md)/[HPremier](../WDLang4/3044113.md).

- [HLitDernier](../WDLang4/3044140.md)/[HDernier](../WDLang4/3044101.md).

- [HGèreMémo](../WDLang4/3044139.md).




Ce fonctionnement est également observé en Java.

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
