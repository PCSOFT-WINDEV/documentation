


## H.ModeSQLServer (Variable)

***En anglais : H.SQLServerMode***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet d'indiquer quelle version du Connecteur Natif SQL Server (également appelé Accès Natif SQL Server) doit être utilisée. 

La constante *hAccèsNatifSQLServer* ne change pas. Elle doit toujours être utilisée dans les fonctions permettant de manipuler le Connecteur Natif SQL Server (fonctions [HDéclareExterne](../WDLang4/3044204.md), [HDécritConnexion](../WDLang4/3044205.md), [HListeFichier](../WDLang4/3044045.md), [HOuvreConnexion](../WDLang4/3044107.md)).
<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`H.ModeSQLServer = <Valeur>`
---

**`<Valeur> : (Entier)`**



- **0** pour forcer l'utilisation du Connecteur Natif SQL Server via OLE DB.

- **1** (valeur par défaut) pour utiliser le Connecteur Natif installé. Si les deux versions du Connecteur Natif sont installées, le Connecteur Natif via OLE DB est utilisé en priorité. 

- **3** pour forcer l'utilisation du Connecteur Natif SQL Server via ODBC.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Fonctionnement
<a name="fonctionnement_ELTPARAGRAPHE000041"></a>Par défaut, le Connecteur Natif choisi lors de l'installation est utilisé. Si les Connecteurs Natifs via OLE DB et via ODBC sont installés, c'est le Connecteur Natif via OLE DB qui est utilisé.

La variable **H.ModeSQLServer** permet de forcer un mode. La variable doit être modifiée avant l'utilisation des fonctions [HDécritConnexion](../WDLang4/3044205.md) et/ou [HOuvreConnexion](../WDLang4/3044107.md). 
Le mot-clé **WD CLIENT VERSION** spécifié dans les [informations optionnelles de connexion](../WDLang4/9000124.md) permet d'indiquer le Client SQL Server à utiliser. 
Par exemple, la chaîne "WD CLIENT VERSION = 2012" permet de forcer l'accès via un Client SQL Server 2012 installé sur la station (msoledbsql), préférable au driver fournit par Windows (sqloledb).
<a name="NOTE0_2"></a>


### Note
<a name="note_ELTPARAGRAPHE000063"></a>Les fonctions [HListeProvider](../WDLang4/3044232.md) et [SQLListeSource](../WDLang4/3072027.md) tiennent compte de la variable **H.ModeSQLServer**. 
<a name="NOTE0_3"></a>


### Les DLL utilisées
<a name="les_dll_utilisees_ELTPARAGRAPHE000076"></a>

- Le Connecteur Natif SQL Server via OLE DB correspond : 

	- en 32 bits à la librairie wd280sqlserver.dll, 

	- en 64 bits à la librairie wd280sqlserver64.dll.




- Le Connecteur Natif SQL Server via ODBC correspond : 

- en 32 bits, à la librairie wd280sqlserver2.dll, 

- en 64 bits, à la librairie wd280sqlserver2_64.dll.




<a name="XComposante"></a>

## Composante :
wd280hf.dll
