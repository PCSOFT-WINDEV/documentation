


## HExporteXLS (Fonction)

***En anglais : HExportXLS***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Exporte les enregistrements d'un fichier de données (HFSQL ou OLE DB), d'une vue ou d'une requête dans un fichier Excel (XLSX).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Exporte tous les clients du fichier de données Client
HExporteXLS(Client, "C:\TEMP\Client.xlsx", hExpCréation)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = HExporteXLS(<Fichier de données> , <Chemin du fichier Excel> , <Liste des rubriques à exporter> [, <Options> [, <Jauge>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée,

- <u><u><u><u>Faux</u></u></u></u> en cas de problème. La fonction [HErreur](../WDLang4/3044088.md) permet d'identifier l'erreur.




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données, de la vue ou de la requête manipulé. Si ce nom n'est pas spécifié, la fonction **HExporteXLS** va manipuler le dernier fichier de données utilisé par la dernière fonction de gestion HFSQL (fonction commençant par la lettre H).

**`<Chemin du fichier Excel> : (Chaîne de caractères)`**

Chemin complet du fichier Excel (XLSX) à générer. 
Si ce paramètre n'est pas spécifié, un fichier &lt;Nom du fichier&gt;.XLSX sera généré dans le répertoire courant.

**`<Liste des rubriques à exporter> : (Chaîne de caractères)`**

Liste des noms des rubriques à exporter. Les noms sont délimités par de simples quotes et séparés par des virgules ou des RC. Les noms des rubriques de type clé composée, binaire, mémo binaire sont ignorés.
Si ce paramètre correspond à une chaîne vide (""), toutes les rubriques du fichier de données (sauf celles de type clé composée, binaire et mémo binaire) sont exportées.
Remarque : Pour les rubriques de type Mémo Texte, selon la taille du mémo, les données exportées peuvent être tronquées par Excel. 

**`<Options> : (Constante optionnelle de type Entier)`**

Indique le mode de création du fichier Excel :



|   |   |
| --- | --- |
| *hExpCréation* | Si le fichier d'exportation XLSX existe, il est écrasé. Si cette option n'est pas précisée et que le fichier XLSX existe, une erreur est générée. |
| *hExpInterruptible* | L'exportation peut être interrompue par la touche Echap du clavier. <br>Si l'exportation est interrompue, le fichier XLSX est valide et contient uniquement les enregistrements exportés avant interruption. |
| *hExpNormal*<br>(valeur par défaut) | Fonctionnement normal. |
| *hExpSansLigneNomRubrique* | La première ligne du fichier XLSX ne contiendra pas les noms de rubriques. |



**`<Jauge> : (Nom de champ ou nom de fenêtre optionnel)`**

Nom du champ de type Jauge ou nom de la fenêtre permettant de visualiser la progression de la création du fichier Excel.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Exporter le contenu d'une requête
<a name="exporter_contenu_une_requete_ELTPARAGRAPHE000109"></a>Pour exporter le contenu d'une requête, il est nécessaire d'initialiser la requête (fonction [HExécuteRequête](../WDLang4/3044080.md)) avant d'utiliser la fonction **HExporteXLS**.
<a name="NOTE0_2"></a>


### Rubriques tableau
<a name="rubriques_tableau_ELTPARAGRAPHE000124"></a>Si une des rubriques exportées est une rubrique de type tableau, chaque élément de la rubrique tableau &lt;RUBTAB&gt; est exportée dans une rubrique &lt;RUBTAB&gt;_&lt;Indice de l'élément&gt;.

Rappel : Les rubriques de type clé composée, mémo binaire ou binaire sont ignorées.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
