


## HErreurModification (Fonction)

***En anglais : HErrorModification***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet de : 

- Lors d'un conflit de modification : renvoyer la valeur d'une rubrique d'un enregistrement. Cette valeur est renvoyée sous forme de chaîne de caractères (chaîne vide pour les mémo binaires).
	**Remarque** : cette fonction doit être utilisée uniquement lors d'une [gestion des conflits de modification personnalisée](../WDLang4/3044188.md) (par exemple dans une procédure ou une fenêtre appelée par le moteur HFSQL pour traiter le conflit de modification).

- vérifier si un conflit de modification est survenu.





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
BOUCLE
	// Extrait la nième rubrique de la liste des rubriques en conflit
	UneRubrique = ExtraitChaîne(ListeRubrique, i, RC)
	// On sort si on n'a plus de rubrique
	SI UneRubrique = EOT ALORS SORTIR // Sortie si plus de rubrique en conflit

	// Affiche la valeur de la rubrique de l'enregistrement original
	Trace(HErreurModification(NomFichier, UneRubrique, hEnrLu))
	// Affiche la valeur de la rubrique de l'enregistrement du fichier
	Trace(HErreurModification(NomFichier, UneRubrique, hEnrFichier))
	// Affiche la valeur de la rubrique de l'enregistrement utilisateur
	Trace(HErreurModification(NomFichier, UneRubrique, hEnrUtilisateur))
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Renvoyer la valeur d'une rubrique d'un enregistrement

`<Résultat> = HErreurModification(<Fichier de données> , <Rubrique> [, <Indice de la rubrique>] , <Enregistrement à lire>)`
---

**`<Résultat> : (Chaîne de caractères)`**



- Contenu de la rubrique demandée, 

- Chaîne vide ("") s'il n'y a pas d'erreur.




**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données utilisé.

**`<Rubrique> : (Chaîne de caractères)`**

Nom de la rubrique utilisée.

**`<Indice de la rubrique> : (Entier optionnel)`**

Indice de la rubrique pour les rubriques tableau uniquement. Ce paramètre n'est pas nécessaire pour les autres types de rubriques.

**`<Enregistrement à lire> : (Constante de type Entier)`**

Permet de préciser l'enregistrement pour lequel les informations doivent être lues :


|   |   |
| --- | --- |
| *hEnrFichier* | Valeur de la rubrique enregistrée actuellement dans le fichier de données. |
| *hEnrLu* | Valeur de la rubrique pour l'enregistrement original (lu avant la modification effectuée par la fonction [HModifie](../WDLang4/3044042.md)). |
| *hEnrUtilisateur* | Valeur de la rubrique pour l'enregistrement en cours au moment de la modification (fonction [HModifie](../WDLang4/3044042.md)). |




<a name="SYNTAXE2"></a>

### Vérifier si un conflit de modification est survenu

`<Résultat> = HErreurModification()`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si un conflit de modification est survenu, 

- <u><u><u><u>Faux</u></u></u></u> sinon (pas de conflit). 






<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280hf.dll
