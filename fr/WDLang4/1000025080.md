


## &lt;Source&gt;.VérifieStructure (Fonction)

***En anglais : &lt;Source&gt;.CheckStructure***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Fixe le mode de comparaison des fichiers de données. Cette comparaison est effectuée lors de l'ouverture des fichiers de données.

Sont comparées :

- la structure du fichier de données HFSQL décrit dans l'analyse,

- la structure réelle du fichier de données physique HFSQL.




Par défaut, ces deux structures doivent être strictement identiques pour pouvoir manipuler le fichier de données.

Selon le mode choisi, une erreur WLangage peut apparaître en cas de structures incompatibles. Il est alors nécessaire d'appliquer la modification automatique des fichiers de données.

**Remarque** : La description utilisée par l'application correspond toujours à la description du fichier physique HFSQL.

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette fonction est disponible uniquement pour les fichiers de données HFSQL. Elle n'est pas disponible pour les fichiers de données accédés par JDBC. 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Autorise l'ouverture du fichier de données "Client"
// Même si les structures sont différentes
Client.VérifieStructure(hSansContrôle)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Source>.VérifieStructure(<Mode de gestion>)`
---

**`<Résultat> : (Constante de type Entier)`**

Ancien mode de gestion de la description (avant utilisation de la fonction **&lt;Source&gt;.VérifieStructure**).

**`<Source> : (Type correspondant à la source spécifiée)`**

Nom du fichier de données manipulé.

**`<Mode de gestion> : (Constante de type Entier)`**

Mode de gestion voulu :


|   |   |
| --- | --- |
| *hCompatible*<br>(valeur par défaut) | Les structures des fichiers de données doivent être compatibles. Si une des manipulations suivantes est réalisée, les structures sont considérées comme incompatibles :<br><br>- Ajout d'une rubrique clé unique (sauf identifiant automatique).<br><br>- Passage d'une clé avec doublon en clé unique.<br><br>- Suppression ou renommage d'une rubrique.<br><br>- Changement de type d'une rubrique (sauf transformation de texte en texte Unicode).<br><br>- Diminution de la taille d'une rubrique.<br><br>- Diminution de la partie entière ou décimal d'une rubrique de type Numérique.<br><br>- Une rubrique devient non clé.<br><br>- Suppression d'un index full-text.<br><br>- Ajout ou suppression de rubriques dans un index full-text (par contre, la création d'une nouvelle rubrique full-text est compatible).<br><br><br> |
| *hIdentique*<br> | Les structures doivent être strictement identiques. |
| *hSansContrôle* | Aucune vérification n'est effectuée, les descriptions de l'analyse et du fichier physique peuvent être différentes. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conseils d'utilisation
<a name="conseils_utilisation_ELTPARAGRAPHE000275"></a>La fonction **&lt;Source&gt;.VérifieStructure** doit être utilisée : 

- de préférence avant l'ouverture de la connexion pour éviter les appels au serveur. 

- avant l'ouverture des fichiers de données.



<a name="NOTE0_2"></a>


### hCompatible : conditions permettant de considérer les structures comme incompatibles
<a name="hcompatible_conditions_permettant_considerer_les_structures_comme_incompatibles_ELTPARAGRAPHE000291"></a>Si une des différences suivantes existe entre la description du fichier de données présente dans l'analyse et la description du fichier de données enregistrée dans le fichier physique, les structures sont considérées par le moteur HFSQL comme incompatibles : une modification automatique est nécessaire.


|   |   |   |
| --- | --- | --- |
| **Structure dans l'analyse** | **Structure lue dans le fichier de données physique** | **Conséquence possible** |
| - identifiant automatique<br>ou bien<br>- clé avec doublons<br>ou bien<br>- rubrique non clé | Clé unique et non identifiant automatique | Risque d'apparition d'une erreur de doublons lors d'un ajout d'un enregistrement. <br><br><br>Remarque : Si seules des lectures sont réalisées sur le fichier de données, aucun problème n'apparaîtra. |
| Utilisation de la rubrique "XXX" | La rubrique "XXX" n'existe pas | Ajout d'une valeur pour une rubrique inexistante dans le fichier physique. |
| La rubrique "XXX" a été renommée. |
| Type de la rubrique différent | Mauvaise conversion lors de l'affectation de la valeur à la rubrique.<br>Valeur affectée à la rubrique tronquée. <br><br>Changement de fonctionnement : <br><br>- Recherche possible uniquement à l'identique<br><br>- Parcours effectué sur le numéro d'enregistrement<br><br><br> |
| Taille de la rubrique différente |
| Rubrique clé | Rubrique non clé |


<a name="NOTE0_3"></a>


### Limitation
<a name="limitation_ELTPARAGRAPHE000354"></a>Cette fonction n'est pas disponible lors de l'utilisation d'une base de données via  .

<a name="XComposante"></a>

## Composante :
wd280hf.dll
