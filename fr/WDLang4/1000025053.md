


## &lt;Source&gt;.Recherche (Fonction)

***En anglais : &lt;Source&gt;.Seek***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le numéro de l'enregistrement en cours est modifié uniquement lorsqu'il est renvoyé par la fonction [&lt;Source&gt;.NumEnr](../WDLang4/1000025041.md). Pour les fonctions manipulant par défaut le numéro de l'enregistrement en cours (fonctions [&lt;Source&gt;.Supprime](../WDLang4/1000025071.md), [&lt;Source&gt;.Lit](../WDLang4/1000025019.md), [&lt;Source&gt;.Modifie](../WDLang4/1000025038.md), ...), la valeur de ce numéro n'est pas mise à jour : il faut utiliser la fonction [&lt;Source&gt;.NumEnr](../WDLang4/1000025041.md)(). Par exemple : ne pas faire : 

```wl
Client.Supprime()
```
mais 

```wl
Client.Supprime(Client.NumEnr())
```
La lecture se fait de la plus petite à la plus grande valeur de la rubrique de parcours (consultez les remarques pour plus de détails).

**Attention** : ***L'enregistrement chargé en mémoire n'est pas modifié***. Les variables HFSQL (par exemple Client.Nom, c'est-à-dire la rubrique *Nom* du fichier *Client*) ne sont pas mises à jour.

En général, la fonction **&lt;Source&gt;.Recherche** permet de se positionner dans le fichier de données pour effectuer une boucle de parcours parmi les enregistrements correspondant à une condition. La fonction [&lt;Source&gt;.Suivant](../WDLang4/1000025070.md) permet de se positionner sur l'enregistrement suivant correspondant à la condition.

Après l'exécution de la fonction **&lt;Source&gt;.Recherche**, plusieurs cas peuvent se présenter :

- un enregistrement correspondant à la condition a été trouvé : la fonction [&lt;Source&gt;.Trouve](../WDLang4/1000025076.md) renvoie <u><u><u>Vrai</u></u></u>

- le fichier de données est vide ou il n'existe pas d'enregistrement correspondant à la condition : la fonction [&lt;Source&gt;.EnDehors](../WDLang4/1000024605.md) renvoie <u><u><u>Vrai</u></u></u>




**Remarques** : 

- Par défaut, les fonctions [&lt;Source&gt;.RecherchePremier](../WDLang4/1000025055.md) et [&lt;Source&gt;.RechercheDernier](../WDLang4/1000025054.md) permettent de réaliser une recherche à l'identique.

- Par défaut, la fonction **&lt;Source&gt;.Recherche** effectue une recherche générique.





<a name="Exemple1"></a>

```wl
// Recherche générique du premier enregistrement pour lequel 
// le code postal commence par "75"
Client.Recherche(CP, "75")
```
<a name="sample_code"></a>

## Exemple

<a name="Exemple2"></a>

```wl
// Recherche du premier enregistrement à l'identique
// pour lequel le nom du Client est Dupond
// Mode 7 : Rubrique texte terminée par Caract(0)
Client.Recherche(Nom, "Dupond" + Caract(0))

// Mode 5.5 : Rubrique texte complétée par des espaces
Client.Recherche(Nom, Complète("Dupond", 30))
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Source>.Recherche(<Rubrique clé> , <Valeur recherchée> [, <Options>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le positionnement sur l'enregistrement a été effectué, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur (blocage, ...) : l'enregistrement n'est pas lu. Ce problème peut être dû :

	- soit à un problème de positionnement (fichier de données vide, ...) : la fonction [&lt;Source&gt;.Trouve](../WDLang4/1000025076.md) renvoie <u><u><u><u>Faux</u></u></u></u> et la fonction [HErreur](../WDLang4/3044088.md) renvoie 0.

	- soit à une erreur : la fonction [HErreur](../WDLang4/3044088.md) renvoie un entier différent de 0. La fonction [HErreurInfo](../WDLang4/3044071.md) permet d'obtenir plus de détails.







**`<Source> : (Type correspondant à la source spécifiée)`**

Nom du fichier de données HFSQL manipulé.

**`<Rubrique clé> : (Chaîne de caractères)`**

Nom de la rubrique clé sur laquelle la recherche doit être effectuée.

**`<Valeur recherchée> : (Type correspondant à la valeur)`**

Valeur de la rubrique recherchée.

**`<Options> : (Constante ou combinaison de constantes optionnelle)`**

Paramètre :

- le mode de blocage de l'enregistrement recherché. 

- le type de parcours

- le type de recherche effectué.





|   |   |
| --- | --- |
| *hBlocageEcriture* | Blocage en écriture : l'enregistrement en cours de lecture pourra être lu par une autre application mais ne pourra pas être modifié par une autre application. |
| *hBlocageLectureEcriture* | Blocage en lecture/écriture : l'enregistrement en cours de lecture ne pourra ni être lu ni être modifié par une autre application.<br>![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png) Blocage en écriture seulement. Fonctionnement équivalent à la constante *hBlocageEcriture*. |
| *hBlocageNon* | Aucun blocage : l'enregistrement pourra être lu ou modifié par une autre application pendant la lecture. |
| *hIdentique* | Recherche à l'identique (voir Notes). <br>Par défaut (paramètre non spécifié), la recherche effectuée est une recherche générique. |
| *hLimiteParcours* | Le parcours s'arrêtera dès que la dernière valeur recherchée sera trouvée. L'enregistrement en cours correspondra à l'enregistrement trouvé. Dans ce cas, la fonction [&lt;Source&gt;.Trouve](../WDLang4/1000025076.md) renverra <u><u><u><u>Faux</u></u></u></u> et la fonction [&lt;Source&gt;.EnDehors](../WDLang4/1000024605.md) renverra <u><u><u><u>Vrai</u></u></u></u>.<br>Cette constante permet d'optimiser la vitesse en mode Client/Serveur. |
| *hRespecteFiltre* | Le parcours prendra en compte le filtre mis en place avec la fonction [&lt;Source&gt;.Filtre](../WDLang4/1000024960.md), même si la clé de parcours utilisée n'est pas optimisée pour le filtre. Rappel : la fonction [&lt;Source&gt;.Filtre](../WDLang4/1000024960.md) renvoie la clé de parcours optimisée pour le filtre.<br>Attention : dans ce cas, sur des fichiers de données de taille importante, des problèmes de performances peuvent survenir.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Cette variable ne peut pas être utilisée. |

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Accès par JDBC : Ce paramètre est ignoré.![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) Si le provider OLE DB ou le Connecteur Natif utilisé ne gère pas les blocages, les options de blocage seront sans effet.![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Les options de blocage ne sont pas prises en compte. Utilisez des fonctions de lecture bloquantes (fonction **HLitPremierBloque**) conservées par compatibilité.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Recherche générique/Recherche à l'identique
<a name="recherche_generiquerecherche_identique_ELTPARAGRAPHE000448"></a>Selon &lt;Valeur Recherchée&gt;, la recherche peut être générique ou à l'identique.

- **Cas d'une recherche générique** : effectue une recherche de tous les enregistrements commençant par la valeur indiquée
	Pour effectuer une recherche générique, il suffit de préciser la valeur voulue dans le paramètre &lt;Valeur recherchée&gt;.

- **Cas d'une recherche à l'identique** : effectue une recherche de tous les enregistrements correspondant exactement à la valeur indiquée.
	Pour effectuer une recherche à l'identique, il faut que la taille de l'argument de recherche soit exactement égale à la taille de la clé. Il faut alors compléter l'argument de recherche par des caractères "espace" pour les clés de type texte. Utilisez pour cela la fonction [&lt;Type Chaîne Ansi&gt;.Complète](../WDLang1/1410089823.md).



<a name="NOTE0_2"></a>


### Espaces en fin de rubrique
<a name="espaces_fin_rubrique_ELTPARAGRAPHE000470"></a>Par défaut, lors de la lecture d'un enregistrement, les espaces en fin des rubriques de type texte ne sont pas supprimés dans les variables de fichier.

Pour que les espaces soient supprimés, utilisez la fonction [EspaceSignificatif](../WDLang4/3044142.md).
<a name="NOTE0_3"></a>


### Recherche sur une clé composée
<a name="recherche_sur_une_cle_composee_ELTPARAGRAPHE000485"></a>Plusieurs méthodes permettent de faire une recherche sur une clé composée :

- Utilisation d'une liste de valeurs

- Utilisation de la fonction [&lt;Source&gt;.ConstruitValClé](../WDLang4/1000024205.md)




**Utilisation d'une liste de valeurs**
Pour faire une recherche sur une clé composée, il est possible d'utiliser la syntaxe suivante :

```txt
HRecherche(<Nom du fichier>, <Nom de la clé composée>, ...
	[<Valeur de recherche du premier élément de la clé composée>, 
	<Valeur de recherche du deuxième élément de la clé>, ...])
```
Exemple :

```wl
// Recherche de l'enregistrement
Client.Recherche(Nom_Prénom, ["MOULIN","Françoise"])
```
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/fr/HF55.png) Les recherches génériques sur les clés composées fonctionnent uniquement si toutes les composantes de la clé composée sont de type Texte. Dans le cas contraire, une recherche à l'identique est effectuée.
<a name="NOTE0_4"></a>


### Recherche sur une rubrique tableau
<a name="recherche_sur_une_rubrique_tableau_ELTPARAGRAPHE000517"></a>La recherche se fait uniquement sur le premier élément du tableau (élément d'indice 1). Pour effectuer une recherche sur les autres éléments du tableau, utilisez des filtres ou des requêtes.
<a name="NOTE0_5"></a>


### Recherche et filtre
<a name="recherche_filtre_ELTPARAGRAPHE000527"></a>Si un filtre est actif (fonction [&lt;Source&gt;.Filtre](../WDLang4/1000024960.md)), la recherche tient compte du filtre.

<a name="XComposante"></a>

## Composante :
wd280hf.dll
