


## HErreurEtatModification (Fonction)

***En anglais : HErrorStatusModification***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie l'état d'un enregistrement lors d'un conflit de modification.

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette fonction doit être utilisée uniquement dans le cas d'un conflit de modification qui n'est pas géré automatiquement (dans une procédure ou une fenêtre appelée pour traiter le conflit de modification (fonction [HSurErreur](../WDLang4/3044017.md))). La fonction [HSurErreur](../WDLang4/3044017.md) n'est pas disponible lors de l'utilisation des procédures stockées.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Code d'une procédure appelée pour le traitement d'un conflit de modification
NomFichier est une chaîne = HErreurInfo(HErrFichier)
// Affiche l'état de l'enregistrement original
Trace(HErreurEtatModification(NomFichier, hEnrLu))
// Affiche l'état de la rubrique de l'enregistrement du fichier
Trace(HErreurEtatModification(NomFichier, hEnrFichier))
// Affiche l'état de la rubrique de l'enregistrement utilisateur
Trace(HErreurEtatModification(NomFichier, hEnrUtilisateur))
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HErreurEtatModification(<Fichier de données> , <Enregistrement à traiter>)`
---

**`<Résultat> : (Constante de type Entier)`**

Indique l'état de l'enregistrement.


|   |   |
| --- | --- |
| *hEtatActif* | L'enregistrement est actif |
| *hEtatInvalide* | Etat de l'enregistrement non trouvé (erreur) |
| *hEtatRaye* | L'enregistrement est rayé |
| *hEtatSup* | L'enregistrement est supprimé |



**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données utilisé.

**`<Enregistrement à traiter> : (Constante de type entier.)`**

Permet de préciser l'enregistrement dans lequel la valeur de la rubrique doit être lue.


|   |   |
| --- | --- |
| *hEnrFichier* | Etat de l'enregistrement dans le fichier de données. |
| *hEnrLu* | Etat de l'enregistrement original (lu avant l'exécution de la fonction [HModifie](../WDLang4/3044042.md)). |
| *hEnrUtilisateur* | Etat de l'enregistrement en cours au moment de l'appel à la fonction [HModifie](../WDLang4/3044042.md). |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conflit de modification et état de l'enregistrement
<a name="conflit_modification_etat_enregistrement_ELTPARAGRAPHE000120"></a>Lors de l'utilisation d'une application en réseau, des conflits peuvent survenir suite à la saisie de données contradictoires par différents utilisateurs. Par exemple :

**1.** L'utilisateur X édite la fiche du département "Cantal".

**2.** L'utilisateur Y édite la fiche du département "Cantal".

**3.** L'utilisateur X renomme le département en "Cantal_01".

**4.** L'utilisateur Y modifie le nom du département et enregistre. Lors de cet enregistrement, il y a un conflit de modification.

Un conflit d'état de modification apparaît par exemple si l'utilisateur X supprime la fiche.

Les différents cas sont récapitulés dans le tableau suivant :


|   |   |   |   |
| --- | --- | --- | --- |
| Enregistrement lu | Ajout | Rayé | Supprimé |
| Enregistrement sur disque |
| Ajout | Conflit de modification | Conflit de modification | Conflit de modification |
| Rayé | Conflit d'état de modification | Conflit de modification | Conflit de modification |
| Supprimé | Conflit d'état de modification | Conflit d'état de modification | XXXX |


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Pour plus de détails sur la gestion automatique des erreurs HFSQL, consultez [Gestion assistée des erreurs HFSQL](../WDLang4/3044188.md).

<a name="XComposante"></a>

## Composante :
wd280hf.dll
