
## CertificatSigneExécutable (Fonction)

***En anglais : CertificateSignExecutable***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Signe un fichier exécutable avec un certificat. La signature est intégrée au fichier. 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ouverture du sélecteur de certificat de Windows
MonCertificat est un Certificat
MonCertificat = CertificatSélecteur()

// Annulation ou erreur
SI MonCertificat = Null ALORS
	RETOUR
FIN

// Si le certificat sélectionné n'est pas valide pour signer
SI PAS MonCertificat.ValidePourSignature ALORS
	Info("Le certificat sélectionné ne permet de pas de générer une signature.")
	RETOUR
FIN

// Récupération du buffer contenant la signature
SI PAS CertificatSigneExécutable(sNomCompletFichier, MonCertificat) ALORS
	Erreur("Erreur de signature de l'exécutable : " + RC + ErreurInfo())
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = CertificatSigneExécutable(<Exécutable> , <Certificat> [, <Description> [, <Algorithme>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'exécutable a été signé, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Exécutable> : (Chaîne de caractères)`**

Nom complet du fichier exécutable à signer. 

**`<Certificat> : (Variable de type Certificat)`**

Nom de la variable de type [Certificat](../WDLang1/1000019287.md) contenant le certificat à utiliser pour signer l'exécutable. 

**`<Description> : (Chaîne de caractères optionnelle)`**

Texte affiché par la fenêtre de l'UAC lors du lancement de l'exécutable. 

**`<Algorithme> : (Constante de type Entier)`**

Algorithme de hachage utilisé par la signature : 



|   |   |
| --- | --- |
| *certSHA160* <br>(Valeur par défaut) | Algorithme également appelé SHA1. <br> |
| *certSHA256* | Algorithme également appelé SHA2. <br><br>Remarque : Cet algorithme n'est pas reconnu sous Windows Vista. L'UAC n'affiche aucune information et l'exécutable peut être lancé.   |













<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280std.dll
