


## ReconnaissanceVocaleAjouteCommande (Fonction)

***En anglais : SpeechRecognitionAddCommand***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute une commande vocale dans la fenêtre en cours. La commande est automatiquement désactivée à la fermeture de la fenêtre. Cette commande vocale peut être supprimée grâce à la fonction [ReconnaissanceVocaleSupprimeCommande](../WDLang1/1000020017.md).

**Remarques** : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) Un moteur de reconnaissance vocale doit être installé sur le poste d'exécution. Windows Vista est fourni par défaut avec un moteur de reconnaissance vocale. Pour les autres systèmes, il est nécessaire d'installer le logiciel "Dragon Naturally Speaking" (tests réalisés avec la version 9 "Preferred" ou "standard").





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Lance la procédure "Proc_Anim_Fenêtre" si la commande vocale est reconnue
IDVoix1 est un entier
IDVoix1 = ReconnaissanceVocaleAjouteCommande("Proc_Anim_Fenêtre", "Animer la fenêtre")
```
<a name="Exemple2"></a>

```wl
// Lance la procédure "Trouver" si la commande vocale est reconnue
IDVoix est un entier = ReconnaissanceVocaleAjouteCommande("Trouver", "Trouve la fiche de")
IDVoix2 est un entier = ReconnaissanceVocaleAjouteCommande("Trouver", "Affiche la fiche de")
IDVoix3 est un entier = ReconnaissanceVocaleAjouteCommande("Trouver", "Cherche la fiche de")
```

```wl
PROCEDURE Trouver(Param1)
sClient est une chaîne = Param1[[21 A ]]
HLitRecherchePremier(sClient, Nom_Prénom, sClient)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ReconnaissanceVocaleAjouteCommande(<Procédure WLangage> , <Phrase à reconnaître>)`
---

**`<Résultat> : (Entier)`**

Identifiant de la commande vocale.

**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure à exécuter lorsque la commande vocale est entendue. Cette procédure est de la forme :

```txt
PROCEDURE <Nom de la procédure>(<Nom du paramètre>)
```
&lt;Nom du paramètre&gt; est un paramètre de type chaîne de caractères. Lors de l'exécution, &lt;Nom du paramètre&gt; correspond à la phrase reconnue.

**`<Phrase à reconnaître> : (Chaîne de caractères)`**

Phrase à dire pour déclencher l'exécution de la procédure. Si ce paramètre correspond à une chaîne vide (""), la procédure indiquée sera exécutée à chaque phrase prononcée.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Reconnaissance phonétique
<a name="reconnaissance_phonetique_ELTPARAGRAPHE000070"></a>Si le paramètre &lt;Phrase à reconnaître&gt; correspond à une chaîne vide (""), la procédure sera exécutée à chaque phrase prononcée. Il est ainsi possible dans la procédure de traiter la phrase prononcée afin de reconnaître quelle commande vocale a été utilisée.

Il est possible par exemple de stocker dans un tableau (tableau associatif par exemple) toutes les commandes vocales disponibles, en phonétique, et la procédure associée à chacune.

Il suffit de passer en phonétique chaque mot de la phrase, et de comparer la phrase obtenue avec le tableau des commandes vocales. Si la commande est reconnue, la procédure associée peut être exécutée.

Pour améliorer la compréhension, il est également possible de supprimer tous les mots parasites situés en début et fin de phrase.
<a name="NOTE0_2"></a>


### Cas particuliers
<a name="cas_particuliers_ELTPARAGRAPHE000083"></a>

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) La fonction **ReconnaissanceVocaleAjouteCommande** doit être utilisée dans le code d'initialisation de la fenêtre ou d'un champ. Si cette fonction est utilisée dans le code d'initialisation du projet, elle n'est pas reconnue.





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=AndroidSyntheseVocale.gif) ***Android (WINDEV Mobile)*** : **Android Synthèse Vocale** <br>Cet exemple didactique montre comment gérer la reconnaissance et la synthèse vocale sous Android.<br>La synthèse vocale se fait en utilisant soit les fonctions WLangage, soit un fichier JAR externe intégré dans le projet WINDEV Mobile.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
