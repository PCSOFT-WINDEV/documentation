


## TableTrie (Fonction)

***En anglais : TableSort***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Trie un champ Table ou Table hiérarchique sur une ou plusieurs colonnes (tri lexicographique). 

**Remarque** : Lorsqu'un champ est trié avec la fonction **TableTrie**, les images permettant de connaître le sens du tri ne sont pas affichées dans les colonnes.

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Tri des colonnes "COL_Désignation" et "COL_Prix" du champ "TABLE_Produit"
// La colonne "COL_Désignation" est triée dans l'ordre croissant
// La colonne "COL_Prix" est triée dans l'ordre décroissant
TableTrie(TABLE_Produit, "COL_Désignation", "-COL_Prix")
```
<a name="Exemple2"></a>

```wl
// Tri multicolonne du champ Table
// La colonne "COL_Désignation" est triée dans l'ordre décroissant
// La colonne "COL_Prix" est triée dans l'ordre croissant 
TableTrie("-COL_Désignation" + TAB + "+COL_Prix")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Trier un champ Table/Table hiérarchique sur une ou plusieurs colonnes identifiées par leur nom

`<Résultat> = TableTrie(<Champ Table> , <Colonne 1> [, <Colonne 2> [... [, <Colonne N>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le tri a été effectué, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Champ Table> : (Nom de champ)`**

Nom du champ à manipuler. Ce champ peut correspondre à : 

- un champ Table.

- un champ Table hiérarchique.


Si ce paramètre correspond à une chaîne vide (""), le champ manipulé est le champ auquel appartient l'événement en cours.

**`<Colonne 1> : (Chaîne de caractères)`**

Nom de la première colonne à trier (16 colonnes maximum). Ce paramètre est de la forme :

```txt
"[<Sens>]<Nom de la colonne>"
```

où :

- &lt;Sens&gt; (caractère) indique le sens du tri :

	- "+" : tri croissant (par défaut),

	- "-" : tri décroissant.




- &lt;Nom de la colonne&gt; (chaîne de caractères) : nom de la colonne à trier.




**`<Colonne 2> : (Chaîne de caractères optionnelle)`**

Nom de la seconde colonne à trier (16 colonnes maximum). Ce paramètre est de la forme :

```txt
"[<Sens>]<Nom de la colonne>"
```

où :

- &lt;Sens&gt; (caractère) indique le sens du tri :

	- "+" : tri croissant (par défaut),

	- "-" : tri décroissant.




- &lt;Nom de la colonne&gt; (chaîne de caractères) : nom de la colonne à trier.






**`<Colonne N> : (Chaîne de caractères optionnelle)`**

Nom de la Nème colonne à trier (16 colonnes maximum). Ce paramètre est de la forme :

```txt
"[<Sens>]<Nom de la colonne>"
```

où :

- &lt;Sens&gt; (caractère) indique le sens du tri :

	- "+" : tri croissant (par défaut),

	- "-" : tri décroissant.




- &lt;Nom de la colonne&gt; (chaîne de caractères) : nom de la colonne à trier.





<a name="SYNTAXE2"></a>

### Trier un champ Table/Table hiérarchique selon une liste de noms de colonnes

`<Résultat> = TableTrie(<Liste des colonnes>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le tri a été effectué, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Liste des colonnes> : (Chaîne de caractères)`**

Liste des colonnes à trier (16 colonnes maximum). Ce paramètre est de la forme :

```txt
"[<Sens>]<Colonne1>" + TAB + "[<Sens>]<Colonne2>" + TAB + ...
```

où :

- &lt;Sens&gt; (caractère) indique le sens du tri :

	- "+" : tri croissant (par défaut),

	- "-" : tri décroissant.




- &lt;Colonne&gt; (chaîne de caractères) : nom de la colonne à trier. Le nom d'une colonne peut être obtenu avec la fonction [TableEnumèreColonne](../WDLang1/3074012.md). Si deux champs ont des noms de colonnes identiques, il est nécessaire de préfixer le nom de la colonne par le nom du champ (par exemple "+TABLE_Table1.COL_ColonneTri"+TAB+"+TABLE_Table1.COL_ColonnePrix").  





<a name="SYNTAXE3"></a>

### Trier un champ Table/Table hiérarchique sur les dix premières colonnes visibles du champ

`<Résultat> = TableTrie(<Champ Table> [, <A trier>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le tri sur les 10 premières colonnes du champ a été effectué, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Champ Table> : (Nom de champ)`**

Nom du champ à manipuler. Ce champ peut correspondre à : 

- un champ Table.

- un champ Table hiérarchique. 




Ce paramètre est de la forme :

```txt
"[<Sens>]<Nom du champ Table>"
```

où :

- &lt;Sens&gt; (caractère) indique le sens du tri :

	- "+" : tri croissant (par défaut),

	- "-" : tri décroissant.




- &lt;Nom du champ Table&gt; (chaîne de caractères) : nom du champ Table ou Table hiérarchique dont les 10 premières colonnes doivent être triées.




**`<A trier> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> si le tri sur les 10 premières colonnes du champ doit être effectué, 

- <u><u><u><u>Faux</u></u></u></u> si le tri précédent doit être annulé. Après l'annulation du tri, l'ordre des lignes du champ n'est pas modifié mais les lignes qui seront ajoutées par les fonctions [TableAjoute](../WDLang1/3074017.md), [TableAjouteLigne](../WDLang1/3074006.md), [TableInsère](../WDLang1/3074025.md) ou [TableInsèreLigne](../WDLang1/3074026.md) ne seront pas triées.  





<a name="SYNTAXE4"></a>

### Annuler un tri précédemment défini sur un champ Table/Table hiérarchique par programmation

`<Résultat> = TableTrie(<Champ Table> , <Faux>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le tri a été annulé, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème.




**`<Champ Table> : (Nom de champ)`**

Nom du champ à manipuler. Ce champ peut correspondre à : 

- un champ Table par programmation.

- un champ Table hiérarchique par programmation. 




**`<Faux> : (Constante)`**

*Faux* : Mot-clé permettant d'annuler un tri précédemment défini sur un champ Table ou Table hiérarchique par programmation.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000259"></a>La fonction **TableTrie** peut être utilisée indifféremment sur :

- un champ Table ou Table hiérarchique par programmation.

- un champ Table ou Table hiérarchique fichier avec parcours automatique (option "Parcours automatique" cochée dans l'onglet "Contenu" de la description du champ). Dans ce cas, le tri est exécuté uniquement sur une seule colonne.

- un champ monosélection ou multisélection.
	



<a name="NOTE0_2"></a>


### Trier un champ Table ou Table hiérarchique fichier
<a name="trier_champ_table_table_hierarchique_fichier_ELTPARAGRAPHE000296"></a>Un champ Table ou Table hiérarchique fichier sera trié uniquement selon la première colonne spécifiée (syntaxe 1 et 2). Attention : la colonne utilisée pour le tri doit être reliée à une rubrique clé dans le fichier de données utilisé pour le parcours du champ.

**Astuce** : Pour trier un champ Table ou Table hiérarchique fichier avec plusieurs colonnes, utilisez une clé composée et la propriété [RubriqueParcourue](../Proprietes/2510111.md) :

```txt
NomTable..RubriqueParcourue = NOMCLECOMPOSEE
```
Pour annuler un tri dans un champ Table ou Table hiérarchique fichier, il suffit d'affecter une chaîne vide à la propriété [RubriqueParcourue](../Proprietes/2510111.md).
<a name="NOTE0_3"></a>


### Gestion d'un champ Table ou Table hiérarchique trié
<a name="gestion_champ_table_table_hierarchique_trie_ELTPARAGRAPHE000315"></a>

- Lorsque le champ est trié par la fonction **TableTrie**, les ajouts réalisés par les fonctions [TableAjoute](../WDLang1/3074017.md), [TableAjouteLigne](../WDLang1/3074006.md), [TableInsère](../WDLang1/3074025.md) et [TableInsèreLigne](../WDLang1/3074026.md) tiennent compte du tri.

- Lorsque le champ est trié par un clic de souris, les ajouts réalisés par les fonctions [TableAjoute](../WDLang1/3074017.md), [TableAjouteLigne](../WDLang1/3074006.md), [TableInsère](../WDLang1/3074025.md) et [TableInsèreLigne](../WDLang1/3074026.md) ne tiennent pas compte du tri.

- ***Le tri n'est pas annulé*** par les fonctions [TableAffiche](../WDLang1/3074003.md), [TableAjuste](../WDLang1/3074004.md), [TableCherche](../WDLang1/3074015.md), [TableOccurrence](../WDLang1/3074021.md), [TablePosition](../WDLang1/3074022.md), [TableSelect](../WDLang1/3074020.md), [TableSelectMoins](../WDLang1/3074029.md), [TableSelectPlus](../WDLang1/3074031.md), [TableSupprime](../WDLang1/3074032.md) et [TableSupprimeTout](../WDLang1/3074034.md).

- ***Le tri est annulé*** si une colonne est modifiée (par saisie dans la colonne ou par les fonctions [TableModifie](../WDLang1/3074019.md) et [TableModifieLigne](../WDLang1/3074028.md)) et si cette colonne est triée.




Rappel : La fonction [TableColonnesTriées](../WDLang1/3074010.md) permet d'obtenir la liste des colonnes triées.
<a name="NOTE0_4"></a>


### Tri sur une colonne calculée
<a name="tri_sur_une_colonne_calculee_ELTPARAGRAPHE000395"></a>Il est déconseillé d'utiliser la fonction **TableTrie** sur des colonnes calculées. En effet, ces colonnes sont calculées lors de l'affichage de chaque ligne.

Un tri effectué avec la fonction **TableTrie** sur une colonne calculée sera valide uniquement sur les lignes déjà affichées.
<a name="NOTE0_5"></a>


### Champ Table ou Table hiérarchique parcouru par programmation
<a name="champ_table_table_hierarchique_parcouru_par_programmation_ELTPARAGRAPHE000412"></a>La fonction **TableTrie** ne fonctionne pas sur un champ parcouru par programmation.
<a name="NOTE0_6"></a>


### Réaliser un tri basé sur la valeur ASCII
<a name="realiser_tri_base_sur_valeur_ascii_ELTPARAGRAPHE000424"></a>Pour réaliser un tri basé sur la valeur ASCII, il est possible d'utiliser une zone mémoire.

Exemple :

```wl
MemCrée("ZM")
MemAjoute("ZM", "abc", "abc")
MemAjoute("ZM", "ZZZ", "ZZZ")
MemAjoute("ZM", "zbc", "zbc")
MemAjoute("ZM", "ééébc", "ééébc")
MemAjoute("ZM", "AB", "AB")
MemAjoute("ZM", "CD", "CD")
MemAjoute("ZM", "çabc", "çabc")
MemAjoute("ZM", "bbc", "bbc")
MemTrie("ZM")
i est un entier
MemPremier("ZM")
TANTQUE PAS MemEnDehors("ZM")
	i = MemEnCours("ZM")
	Trace(MemRécupère("ZM", i)) // Affichage dans l'ordre ASCII
	MemSuivant("ZM")
FIN
```

<a name="NOTE0_7"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Versions précédentes
<a name="versions_precedentes_ELTPARAGRAPHE000443"></a>Cette fonction remplace la fonction **TableTri**, conservée par compatibilité avec WINDEV 5.5.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
