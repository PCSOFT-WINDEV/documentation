


## fEcritLigne (Fonction)

***En anglais : fWriteLine***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Écrit une ligne dans un fichier externe. Les caractères nécessaires à un passage à la ligne suivante sont automatiquement insérés à la fin de la ligne ajoutée.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003036025&name=fecritligne_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Ouverture d'un fichier externe
IDFichier = fOuvre("C:\MesRépertoires\Fichier.txt", foLectureEcriture)
SI IDFichier <> -1 ALORS
	// Écriture d'une ligne dans ce fichier
	ResEcriture = fEcritLigne(IDFichier, "Compte-rendu de la réunion")
	SI ResEcriture = Faux ALORS
		...
	FIN
FIN
```


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Ouverture d'un fichier externe
MonFichier est un FichierDisque
MonFichier = fOuvre("C:\MesRépertoires\Fichier.txt", foLectureEcriture)
SI PAS ErreurDétectée ALORS
	// Écriture d'une ligne dans ce fichier
	ResEcriture = fEcritLigne(MonFichier, "Compte-rendu de la réunion")
	SI ResEcriture = Faux ALORS
		...
	FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Écrire une ligne dans un fichier externe

`<Résultat> = fEcritLigne(<Fichier manipulé> , <Ligne à écrire>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'écriture dans le fichier spécifié a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Fichier manipulé> : (Entier ou variable de type FichierDisque)`**



- Identifiant du fichier à manipuler, défini avec la fonction [fOuvre](../WDLang1/3036036.md) ou [fCrée](../WDLang1/3036017.md).

- Nom de la variable de type [FichierDisque](../WDLang1/1410088883.md) initialisée avec la fonction [fOuvre](../WDLang1/3036036.md) ou [fCrée](../WDLang1/3036017.md).
	






**`<Ligne à écrire> : (Chaîne de caractères)`**

Ligne à écrire dans le fichier (2 Go maximum).  


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Écrire une ligne d'une longueur fixe dans un fichier externe (accélère l'écriture)

`<Résultat> = fEcritLigne(<Fichier manipulé> , <Adresse de la ligne à écrire> , <Taille à écrire>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'écriture dans le fichier spécifié a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Fichier manipulé> : (Entier ou variable de type FichierDisque)`**



- Identifiant du fichier à manipuler, défini avec la fonction [fOuvre](../WDLang1/3036036.md) ou [fCrée](../WDLang1/3036017.md).

- Nom de la variable de type [FichierDisque](../WDLang1/1410088883.md) initialisée avec la fonction [fOuvre](../WDLang1/3036036.md) ou [fCrée](../WDLang1/3036017.md).




**`<Adresse de la ligne à écrire> : (Adresse)`**

Adresse de la ligne à écrire dans le fichier.

**`<Taille à écrire> : (Entier)`**

Taille en octets (caractères) de la ligne à écrire (2 Go maximum).
Ce paramètre doit être inférieur ou égal à la taille réelle de la ligne écrite dans le fichier externe. Par exemple, si la ligne à écrire est de 100 octets, le paramètre &lt;Taille à écrire&gt; doit être inférieur ou égal à 100 octets.
Si ce paramètre est inférieur à la taille réelle de la ligne écrite, seul le nombre d'octets spécifié sera écrit dans le fichier texte. La ligne sera donc tronquée.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000213"></a>La fonction **fEcritLigne** génère une erreur dans les cas suivants :

- le fichier n'est pas ouvert,

- le fichier n'est pas accessible en écriture,

- le fichier est bloqué par un autre poste ou par une autre application,

- il n'y a pas d'espace disponible sur le disque.




**Attention** : La fonction **fEcritLigne** ne peut être utilisée que sur des fichiers texte. Cette fonction ne gère pas les 0 binaires (l'écriture est arrêtée).
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Fonctionnement sous Windows Vista (et supérieur)
<a name="fonctionnement_sous_windows_vista_superieur_ELTPARAGRAPHE000491"></a>Si cette fonction ne fonctionne pas correctement sous Windows Vista (et supérieur), il est nécessaire de vérifier si le fichier ou le répertoire manipulé ne se trouve pas dans un des répertoires système (répertoire de Windows ou répertoire "Program Files").

**En effet, sous Windows Vista (et supérieur), avec le [mécanisme de l'UAC](../Editeurs/2025014.md) (contrôle des comptes utilisateurs) activé**, il est nécessaire d'avoir les privilèges administrateur pour manipuler / modifier des fichiers ou des répertoires présents dans les répertoires système (répertoire de Windows ou répertoire "Program Files").

**Conseil de programmation** : Si vous devez manipuler / modifier des fichiers ou des répertoires, sans avoir besoin de privilèges administrateur, il est conseillé :

- de ne pas écrire dans le répertoire de Windows ou dans le répertoire "Program Files",

- d'utiliser le répertoire système correspondant à l'application (connu par la fonction [SysRep](../WDLang1/3073026.md) par exemple avec la constante *srAppDataCommun*).


**Remarque** : Sous Windows Vista (et supérieur), le mécanisme de la virtualisation permet de rendre les applications compatible Vista. Si le fichier est créé dans un répertoire système sans avoir les droits nécessaires, ce fichier sera réellement créé dans un autre répertoire (C:\\Users\\&lt;LOGIN&gt;AppData\\Local\\VirtualStore\\Windows\\). Dans ce cas, le fichier ne pourra pas être partagé entre plusieurs applications.
<a name="NOTE0_3"></a>


### Position dans le fichier
<a name="position_dans_fichier_ELTPARAGRAPHE000245"></a>A l'ouverture d'un fichier, la position en cours correspond :

- au premier octet du fichier (par défaut),

- au dernier octet du fichier si le fichier est ouvert en "ajout" (constante *foAjout*).




Cette position peut être modifiée par la fonction [fPositionne](../WDLang1/3036039.md).

La fonction **fEcritLigne** écrit les éléments spécifiés à partir de la position en cours. Après l'exécution de **fEcritLigne**, la position en cours correspond au dernier octet écrit.
<a name="NOTE0_4"></a>


### Gestion ANSI / UNICODE
<a name="gestion_ansi_unicode_ELTPARAGRAPHE000270"></a>La fonction **fEcritLigne** permet d'écrire : 

- une chaîne de type Unicode dans un fichier Unicode. 

- une chaîne de type Ansi dans un fichier Ansi. 




Le fichier a été créé ou ouvert avec les fonctions [fCrée](../WDLang1/3036017.md)/[fOuvre](../WDLang1/3036036.md) en précisant le type du fichier.

**Remarques** : 

- La taille à écrire dans un fichier Unicode doit être multipliée par deux par rapport à un fichier ANSI.

- Si une chaîne de caractères ANSI est écrite dans un fichier UNICODE (et inversement), la conversion sera implicitement réalisée. 
	


|   |   |   |   |
| --- | --- | --- | --- |
|   | **Format de la chaîne passée en paramètre** | **Fichier externe <br>au format ANSI<br>(fonction [fOuvre](../WDLang1/3036036.md) ou [fCrée](../WDLang1/3036017.md) avec la constante *foAnsi*)** | **Fichier externe <br>au format UNICODE<br>(fonction [fOuvre](../WDLang1/3036036.md) ou [fCrée](../WDLang1/3036017.md) avec la constante *foUnicode*)** |
| Fonction **fEcritLigne** | ANSI | Aucune conversion n'est nécessaire avant l'écriture | Conversion automatique de la chaîne avant l'écriture |
| UNICODE | Conversion automatique de la chaîne avant l'écriture | Aucune conversion n'est nécessaire avant l'écriture |






Dans les projets WINDEV et WEBDEV, si l'option "Utiliser les chaînes ANSI en exécution" est cochée dans la description de la configuration de projet, le mode d'ouverture utilisé par défaut est *foAnsi* (1ère colonne).

Dans les projets WINDEV et WEBDEV, si l'option "Utiliser les chaîne UNICODE en exécution" est cochée dans la description de la configuration de projet, le mode d'ouverture par défaut est *foUnicode* (seconde colonne).

Dans les projets WINDEV Mobile, quels que soient la version et le mode, le mode d'ouverture par défaut est *foUnicode* (seconde colonne).

Pour plus de détails, consultez [Gestion de l'UNICODE](../WDLang1/3024038.md)


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Manipulationdefichierstexte.gif) ***Exemples unitaires (WINDEV)*** : **Manipulation de fichiers texte** <br>Manipulation des fichiers "texte" avec WINDEV :<br>- Créer un fichier texte<br>- Ecrire dans un fichier texte<br>- Lire dans un fichier texte
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Manipulationdefichierstexte.gif) ***Exemples unitaires (WEBDEV)*** : **Manipulation de fichiers texte** <br>Manipulation des fichiers "non HFSQL" avec WEBDEV (création d'un fichier texte, écriture et lecture)
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Manipulationdefichierstexte.gif) ***Exemples unitaires (WINDEV Mobile)*** : **Manipulation de fichiers texte** <br>Manipulation des fichiers externes de type "texte" :<br>- Créer un fichier texte<br>- Ecrire dans un fichier texte<br>- Lire dans un fichier texte
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LesfonctionsTableVers.gif) ***Exemples unitaires (WINDEV)*** : **Les fonctions TableVers** <br>Export des données d'une table avec les fonctions WLangage.<br>Dans cet exemple, nous abordons les principaux thèmes suivants :<br>1/ l'interfaçage avec Word et Excel<br>2/ l'envoi de données vers le presse-papiers<br>3/ la génération d'un fichier texte<br><br>Cet exemple montre comment exporter le contenu d'une table vers un document Word, un classeur Excel, le presse-papiers ou vers un fichier texte grâce aux ordres très clairs du WLangage : TableVersWord, TableVersExcel, VersPressePapier, TableVersTexte.

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280std.dll
