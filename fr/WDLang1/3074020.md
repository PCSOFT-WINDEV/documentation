


## TableSelect (Fonction)

***En anglais : TableSelect***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie l'indice de l'élément sélectionné dans le champ Table ou Table hiérarchique. Cet indice peut correspondre : 

- au numéro de la ligne sélectionnée. La ligne sélectionnée correspond à la ligne en cours sur laquelle le bandeau de sélection est affiché.

- au numéro de la colonne sélectionnée, si le champ autorise le mode de sélection à la colonne. Cette option est paramétrable dans l'onglet "UI" de la description du champ.  

- au numéro de la ligne de la cellule sélectionnée, si le champ autorise le mode de sélection à la cellule. Cette option est paramétrable dans l'onglet "UI" de la description du champ.  

- au numéro de la colonne de la cellule sélectionnée, si le champ autorise le mode de sélection à la cellule. Cette option est paramétrable dans l'onglet "UI" de la description du champ.  











<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Indice de la ligne sélectionnée dans le champ "TABLE_Produit"
ResSelect = TableSelect(TABLE_Produit)
```
<a name="Exemple2"></a>

```wl
// Lignes sélectionnées dans un champ Table par programmation multisélection
POUR i = 1 _A_ TableSelectOccurrence(TABLE_TABLE1)
	Trace("Elément sélectionné : " + TableSelect(TABLE_TABLE1, i))
FIN

// Équivalent à :
// i est un entier
// POUR TOUTE LIGNE SELECTIONNEE i DE TABLE_TABLE1
//	 Trace("Elément sélectionné : " + TableSelect(TABLE_TABLE1, i-1))
// FIN
```
<a name="Exemple3"></a>

```wl
// Supprimer toutes les lignes sélectionnées dans un champ Table
// Il est également possible d'utiliser la fonction TableSupprimeSelect
i est un entier
NbSelection est un entier 
NbSelection = TableSelectOccurrence(TABLE_MaTable)
POUR i = NbSelection A 1 PAS -1
	TableSupprime(TABLE_MaTable, TableSelect(TABLE_MaTable, i))
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = TableSelect(<Champ Table> [, <Rang> [, <Information à renvoyer>]])`
---

**`<Résultat> : (Entier)`**



- Indice de l'élément sélectionné dans le champ Table spécifié, 

- -1 si aucun élément n'est sélectionné.




**`<Champ Table> : (Nom de champ)`**

Nom du champ à manipuler. Ce champ peut correspondre à : 

- un champ Table. 

- un champ Table hiérarchique. 


Si ce paramètre correspond à une chaîne vide (""), le champ auquel appartient l'événement en cours est manipulé.

**`<Rang> : (Entier optionnel)`**

Rang de la sélection dans le cas d'un champ multisélection. Si ce paramètre n'est pas spécifié, l'indice de la première ligne sélectionnée est renvoyé.
Par exemple, pour récupérer le premier élément sélectionné, &lt;Rang&gt; = 1. 
Pour récupérer le deuxième élément sélectionné, &lt;Rang&gt; = 2, etc.



**`<Information à renvoyer> : (Constante optionnelle de type Entier)`**

Type d'information à renvoyer : 


|   |   |
| --- | --- |
| *tsColonne* | &lt;Résultat&gt; correspondra au numéro de la colonne sélectionnée. |
| *tsColonneCellule* | &lt;Résultat&gt; correspondra au numéro de la colonne pour la cellule sélectionnée. |
| *tsLigne*<br>(Valeur par défaut) | &lt;Résultat&gt; correspondra au numéro de la ligne sélectionnée. |
| *tsLigneCellule* | &lt;Résultat&gt; correspondra au numéro de la ligne pour la cellule sélectionnée.<br><br> |





Si ce paramètre n'est pas spécifié, la fonction renverra le numéro de la ligne sélectionnée. 

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre n'est pas disponible. La fonction renverra le numéro de la ligne sélectionnée. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000177"></a>La fonction **TableSelect** peut être utilisée indifféremment sur :

- un champ Table ou Table hiérarchique fichier.

- un champ Table ou Table hiérarchique par programmation.

- un champ monosélection ou multisélection. Dans le cas des champs Table multisélection, il est nécessaire d'utiliser la fonction **TableSelect** dans une boucle pour connaître toutes les lignes sélectionnées.
	



<a name="NOTE0_2"></a>


### Équivalence avec la fonction TableSelect
<a name="equivalence_avec_fonction_docparampagetitleshort_ELTPARAGRAPHE000217"></a>Les syntaxes suivantes sont équivalentes :

```txt
Indice est un entier
Indice = <Champ Table>
```
ou

```txt
Indice = TableSelect(<Champ Table>)
```

<a name="NOTE0_3"></a>


### Valeur de l'élément sélectionné
<a name="valeur_element_selectionne_ELTPARAGRAPHE000236"></a>Pour récupérer la valeur de l'élément sélectionné, la syntaxe est :

```txt
Indice est un entier
Indice = TableSelect(<Champ Table>)
<Valeur de l'élément> = <Champ Table> [Indice]
```


ou

```txt
<Valeur de l'élément> = <Champ Table> [<Champ Table>]
```

<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Sélection au niveau de la cellule
<a name="selection_niveau_cellule_ELTPARAGRAPHE000258"></a>Dans le cas d'un champ utilisant un mode de sélection "sélection multiple" pour les cellules, la propriété [Sélectionnée](../Proprietes/2510112.md) permet de savoir si une cellule est sélectionnée ou de sélectionner une cellule par programmation. 

<a name="XComposante"></a>

## Composante :
wd280obj.dll
