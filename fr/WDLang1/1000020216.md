


## &lt;Zone multiligne&gt;.AjouteLigne (Fonction)

***En anglais : &lt;Multiline zone&gt;.AddLine***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute une nouvelle ligne dynamique dans un champ Zone multiligne. Cette ligne est ajoutée à la fin de la zone des lignes dynamiques. 

La ligne dynamique a été précédemment définie en édition (ligne avec l'option "Définir comme étant la ligne répétée du champ" cochée dans l'onglet "Général" de la fenêtre de description du champ). 




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ajout d'un réseau 
nLigne est un entier 
nLigne = ZM_Réseau.AjouteLigne()
ZM_Réseau[nLigne].LIB_NomReseau = "Réseau"
ZM_Réseau[nLigne].IMG_Disponible.Visible = Vrai
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = <Champ Zone multiligne>.AjouteLigne()`
---

**`<Résultat> : (Entier)`**

Indice de la ligne ajoutée.

**`<Champ Zone multiligne> : (Nom de champ)`**

Nom du champ Zone multiligne à manipuler.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Caractéristiques de la ligne dynamique ajoutée
<a name="caracteristiques_ligne_dynamique_ajoutee_ELTPARAGRAPHE000193"></a>

- Par défaut, la ligne dynamique ajoutée est vide. 

- Pour personnaliser la ligne (libellé, couleur, visibilité d'éléments, ...), il faut modifier les champs avec la syntaxe suivante : 
	
	```txt
	<Champ Zone multiligne>[<Indice>].<Nom du champ>.<Propriété> = <Valeur>
	```

	Par exemple : 
	
	```wl
	nLigne est un entier = ZM_Produits.AjouteLigne()
	ZM_Produits[nLigne].LIB_NomProdLigne = stLigne.sLibProd
	ZM_Produits[nLigne].LIB_NomProdLigne.Couleur = BleuClair
	ZM_Produits[nLigne].SAI_QteLigne = stLigne.nQuantite
	```


- Par défaut, la ligne ajoutée n'est pas sélectionnée. Pour sélectionner la ligne ajoutée, il suffit d'affecter la valeur de l'indice de la ligne au champ Zone multiligne. 
	Par exemple : 
	
	```wl
	nLigne est un entier = ZM_Produits.AjouteLigne()
	ZM_Produits = nLigne
	```
ou
	```wl
	nLigne est un entier = ZM_Produits.AjouteLigne()
	ZM_Produits.Valeur = nLigne
	```


- Lors de l'ajout de la ligne dynamique, les événements d'initialisation des champs présents dans la ligne sont exécutés. 

- La taille du champ Zone multiligne est modifiée pour prendre en compte la ligne ajoutée : le champ s'agrandit vers le bas. Si des champs sont situés sous le champ Zone multiligne, ils sont déplacés vers le bas. La hauteur utile de la fenêtre est agrandie en conséquence : il est possible de faire défiler la fenêtre avec le doigt pour voir le bas du champ Zone multiligne et les champs éventuellement présents en dessous de cette zone.



<a name="NOTE0_2"></a>


### Cas d'erreur
<a name="cas_erreur_ELTPARAGRAPHE000236"></a>Une erreur apparaît dans les cas suivants : 

- aucune ligne dynamique n'a été définie dans le champ Zone multiligne. 

- plus de 300 lignes dynamiques existent dans le champ Zone multiligne.

- un des traitements d'initialisation des champs de la ligne entraîne une erreur.





