


## Certificat (Type de variable)

***En anglais : Certificate***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **Certificat** permet de manipuler : 

- les certificats utilisés pour signer les chaînes ou les fichiers. 

- les certificats utilisés pour signer les emails. Dans ce cas, une variable de type **Certificat** est utilisée par les variables de type [Email](../WDLang3/1000018713.md). 

- les certificats utilisés pour les [Notifications Push](../WDLang3/1000021015.md) envoyées à des applications iOS.




Les caractéristiques d'un certificat peuvent être définies et modifiées à l'aide de différentes propriétés WLangage. 

**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
MonCertificat est un Certificat

// Ouverture du sélecteur de certificat de Windows
MonCertificat = CertificatSélecteur()

// Annulation ou erreur
SI MonCertificat.Nom = "" ALORS
	RETOUR
FIN

Trace(MonCertificat.Emetteur)
Trace(MonCertificat.DateValiditéDebut)
Trace(MonCertificat.DateValiditéFin)
Trace(MonCertificat.Fiabilité)
Trace(MonCertificat.Nom)
Trace(MonCertificat.NuméroSérie)
Trace(MonCertificat.ValidePourSignature)
```

<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Propriétés spécifiques à la description des variables de type Certificat
<a name="proprietes_specifiques_description_des_variables_type_certificat_ELTPARAGRAPHE000043"></a>Les propriétés suivantes peuvent être utilisées pour manipuler un certificat :


|   |   |   |
| --- | --- | --- |
| **Nom de la propriété** | **Type manipulé** | **Effet** |
| DateValiditéDébut | DateHeure | Date et heure de début de validité du certificat. <br><br>**Cette propriété est disponible en lecture seulement**. |
| DateValiditéFin | DateHeure | Date et heure de fin de validité du certificat. <br><br>**Cette propriété est disponible en lecture seulement**. |
| Emetteur | Chaîne de caractères | Nom de l'émetteur du certificat (caractéristique "Délivré par"). <br><br>**Cette propriété est disponible en lecture seulement**. |
| EmetteurComplet | Chaîne de caractères | Nom complet de l'émetteur du certificat. <br><br>**Cette propriété est disponible en lecture seulement**. |
| Empreinte | Chaîne de caractères | Numéro unique associé au certificat. Ce numéro est créé automatiquement lors de la création d'un certificat. <br><br>**Cette propriété est disponible en lecture seulement**. |
| Fiabilité | Constante de type Entier | Niveau de fiabilité du certificat correspondant à une des constantes suivantes : <br><br>- *certificatExpiré* : la date d'expiration du certificat est dépassée.<br><br>- *certificatInvalide* : le certificat est invalide.<br><br>- *certificatNonFiable* : le certificat est non fiable. <br><br>- *certificatOk* : le certificat est fiable. <br><br><br>**Cette propriété est disponible en lecture seulement**. |
| Nom | Chaîne de caractères | Nom de la personne à qui est délivré le certificat. <br><br>**Cette propriété est disponible en lecture seulement**. |
| NuméroSérie | Chaîne de caractères | Numéro de série du certificat. <br><br>**Cette propriété est disponible en lecture seulement**. |
| Objet | Chaîne de caractères | Texte permettant d'indiquer l'objet de l'utilisation de la clé publique. Par exemple : domaine pour lequel le certificat est émis et suivant le type de certificat, informations permettant d'identifier la société exploitant le site, période de validité, ...<br><br>**Cette propriété est disponible en lecture seulement**. |
| OIDUsage | Tableau de chaînes | Liste des OID des applications qui utilisent ce certificat. <br><br>**Cette propriété est disponible en lecture seulement**. |
| UtilisationClé | Constantes de type Entier | Utilisations attendues pour ce certificat :  <br><br>- *certificatChiffrementClé* : Certificat permettant de chiffrer une clé. <br><br>- *certificatChiffrementDonnées* : Certificat permettant de chiffrer des données. <br><br>- *certificatEchangeClé* : Certificat permettant d'échanger une clé. <br><br>- *certificatNonRépudiation* : Certificat permettant la non répudiation. <br><br>- *certificatSignatureNumérique* : Certificat permettant d'effectuer une signature numérique. <br><br>- *certificatSigneClé* : Certificat permettant de signer une clé. <br><br><br><br><br>**Cette propriété est disponible en lecture seulement**. |
| ValidePourSignature | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> si le certificat peut être utilisé pour signer un document, <br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Si cette propriété est à <u><u><u><u>Faux</u></u></u></u>, les fonctions [CertificatSigneFichier](../WDLang1/1000019297.md) et [CertificatSigneChaîne](../WDLang1/1000019296.md) échoueront.<br><br><br>Cette propriété permet de savoir si le certificat possède une clé privée et toutes les caractéristiques requises pour effectuer une signature.<br><br>**Cette propriété est disponible en lecture seulement**. |


<a name="NOTE0_2"></a>


### Fonctions WLangage utilisant le type Certificat
<a name="fonctions_wlangage_utilisant_type_certificat_ELTPARAGRAPHE000194"></a>Les fonctions suivantes manipulent les variables de type **Certificat** : 

- Fonctions classiques : 
	


|   |   |
| --- | --- |
| [CertificatExtrait](../WDLang1/1000019300.md) | Extrait un certificat d'un buffer de signature ou d'un duplicata d'impression. |
| [CertificatOuvrePropriétés](../WDLang1/1000019301.md) | Ouvre la fenêtre Windows permettant de connaître les propriétés d'un certificat. |
| [CertificatSélecteur](../WDLang1/1000019295.md) | Ouvre une fenêtre de sélection de certificats. Les certificats listés sont les certificats installés dans le magasin personnel. |
| [CertificatSigneChaîne](../WDLang1/1000019296.md) | Crée la signature d'une chaîne de caractères. |
| [CertificatSigneExécutable](../WDLang1/1000020560.md) | Signe un fichier exécutable avec un certificat. |
| [CertificatSigneFichier](../WDLang1/1000019297.md) | Crée la signature d'un fichier. Cette signature peut être mémorisée dans une variable de type Buffer ou bien dans un fichier texte. |
| [NotifPushEnvoie](../WDLang3/1000020819.md) | Envoie une notification push (distante) à un appareil mobile (iOS ou Android). |

- Fonctions utilisant la syntaxe préfixée : 
	


|   |   |
| --- | --- |
| [&lt;Variable Certificat&gt;.OuvrePropriétés](../WDLang1/1000024378.md) | Ouvre la fenêtre Windows permettant de connaître les propriétés d'un certificat. |





