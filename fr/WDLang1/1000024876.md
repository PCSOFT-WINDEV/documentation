
## &lt;Type Chaîne&gt;.ExtraitChaîne (Fonction)

***En anglais : &lt;String type&gt;.ExtractString***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet de :

- extraire une sous-chaîne d'une chaîne de caractères en fonction d'un séparateur de chaîne donné.

- effectuer un parcours de sous-chaînes dans une chaîne de caractères en fonction d'un séparateur de chaîne donné.




**Remarques** :

- Le parcours de sous-chaînes est plus rapide que l'extraction de sous-chaînes.

- Il est possible d'utiliser un tableau de séparateurs. Il est ainsi possible d'utiliser plusieurs séparateurs différents simultanément.




Quelques exemples d'utilisation :

- extraire une donnée lue dans un fichier externe,

- extraire les informations retournées par la fonction [HListeFichier](../WDLang4/3044045.md) ou la fonction [&lt;Source&gt;.ListeClé](../WDLang4/1000025012.md),

- extraire une donnée d'une liste comportant des données différentes sur une même ligne.





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
Pays est une chaîne = "France, Italie, Allemagne, Espagne"
Pays.ExtraitChaîne(1, ", ")   // Renvoie "France"
Pays.ExtraitChaîne(2, ", ")   // Renvoie "Italie"
Pays.ExtraitChaîne(3, ", ")   // Renvoie "Allemagne"
Pays.ExtraitChaîne(4, ", ")   // Renvoie "Espagne"
Pays.ExtraitChaîne(5, ", ")   // Renvoie EOT
```


<a name="Exemple2"></a>



```wl
MaChaîne est une chaîne = "Fraise, Framboise, Chocolat et Banane"
MaChaîne.ExtraitChaîne(1, [", " , "," , " et "]) // Renvoie "Fraise"
MaChaîne.ExtraitChaîne(2, [", " , "," , " et "]) // Renvoie "Framboise"
MaChaîne.ExtraitChaîne(3, [", " , "," , " et "]) // Renvoie "Chocolat"
MaChaîne.ExtraitChaîne(4, [", " , "," , " et "]) // Renvoie "Banane"
```


<a name="Exemple3"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png) 
```wl
// Parcours de toutes les sous-chaînes
Pays est une chaîne = "France, Italie, Allemagne, Espagne"
SousChaîne est une chaîne = Pays.ExtraitChaîne(rangPremier, ", ")
TANTQUE SousChaîne <> EOT
	Trace(SousChaîne) // Renvoie "France", "Italie", "Allemagne", "Espagne"
	SousChaîne = Pays.ExtraitChaîne(rangSuivant, ", ")
FIN
```


<a name="Exemple4"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png) 
```wl
// Parcours de toutes les sous-chaînes
// Les séparateurs sont présents dans un tableau
sChaîne est une chaîne = "Fraise, Framboise<BR>Citron<BR>Chocolat et Banane"
sRésultat est une chaîne = sChaîne.ExtraitChaîne(rangPremier, [", " , " et ", "<BR>"])
TANTQUE sRésultat <> EOT
	Trace(sRésultat)
	sRésultat = sChaîne.ExtraitChaîne(rangSuivant, [", " , " et ", "<BR>"])
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Extraction d'une sous-chaîne en fonction d'un séparateur de chaîne

`<Résultat> = <Chaîne initiale>.ExtraitChaîne(<Rang> [, <Séparateur> [, <Sens de parcours>]])`
---

**`<Résultat> : (Chaîne de caractères)`**

Correspond à :

- La sous-chaîne comprise entre le séparateur de rang &lt;Rang&gt; - 1 et le séparateur de rang &lt;Rang&gt; si &lt;Sens de parcours&gt; n'est pas précisé ou est égal à *DepuisDébut*.

- La sous-chaîne comprise entre le séparateur de rang &lt;Rang&gt; - 1 et le séparateur de rang &lt;Rang&gt; à partir de la fin de la chaîne si &lt;Sens de parcours&gt; correspond à *DepuisFin*.

- La &lt;Chaîne initiale&gt; en totalité si la &lt;Chaîne initiale&gt; ne contient pas de &lt;Séparateur&gt; et si &lt;Rang&gt; est égal à 1.

- La constante *EOT* si &lt;Rang&gt; est plus grand que le nombre de séparateurs contenus dans la chaîne.




**`<Chaîne initiale> : (Chaîne de caractères)`**

Chaîne de caractères (taille maximale 2 Go) contenant la chaîne à extraire.

**`<Rang> : (Entier)`**

Numéro d'ordre de la sous-chaîne à extraire. Par exemple, si le séparateur est TAB et si &lt;Rang&gt; est égal à 2, la sous-chaîne extraite sera comprise entre le premier et le second TAB.

**`<Séparateur> : (Chaîne de caractères optionnelle ou Tableau de chaînes optionnel)`**

Ce paramètre peut correspondre à :

- La chaîne permettant de délimiter les sous-chaînes. Cette chaîne n'est pas incluse dans le résultat. Ce séparateur est sensible à la casse.

- Un tableau de chaînes. Les différentes chaînes présentes dans le tableau permettent de délimiter les sous-chaînes. Les séparateurs ne sont pas inclus dans le résultat. Ces séparateurs sont sensibles à la casse. 




Si ce paramètre n'est pas précisé, le séparateur par défaut est TAB.

**`<Sens de parcours> : (Constante optionnelle)`**

Sens du parcours de la recherche :



|   |   |
| --- | --- |
| *DepuisDébut*<br>(Valeur par défaut) | Recherche effectuée du premier caractère de la chaîne vers le dernier. |
| *DepuisFin* | Recherche effectuée du dernier caractère de la chaîne vers le premier. |




<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png) 
### Parcours des sous-chaînes déterminées en fonction d'un séparateur

`<Résultat> = <Chaîne initiale>.ExtraitChaîne(<Options de parcours> [, <Séparateur>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Correspond à :

- la sous-chaîne suivante ou précédente selon le parcours choisi. &lt;Résultat&gt; ne contient pas le séparateur.

- la constante EOT en fin de parcours.




**`<Chaîne initiale> : (Chaîne de caractères)`**

Chaîne de caractères (taille maximale 2 Go) contenant la chaîne à extraire.

**`<Options de parcours> : (Constante de type Entier)`**

Sens du parcours de la recherche :


|   |   |
| --- | --- |
| *rangDernier* | Débute un parcours des sous-chaînes séparées par le séparateur spécifié en partant de la fin de la chaîne. |
| *rangPrécédent* | Continue un parcours amorcé par la constante *rangDernier* |
| *rangPremier* | Débute un parcours des sous-chaînes séparées par le séparateur spécifié en partant du début de la chaîne. |
| *rangSuivant* | Continue un parcours amorcé par la constante *rangPremier* |



**`<Séparateur> : (Chaîne de caractères optionnelle ou Tableau de chaînes optionnel)`**

Ce paramètre peut correspondre à :

- La chaîne permettant de délimiter les sous-chaînes. Cette chaîne n'est pas incluse dans le résultat. Ce séparateur est sensible à la casse.

- Un tableau de chaînes. Les différentes chaînes présentes dans le tableau permettent de délimiter les sous-chaînes. Les séparateurs ne sont pas inclus dans le résultat. Ces séparateurs sont sensibles à la casse. 




Si ce paramètre n'est pas précisé, le séparateur par défaut est TAB.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Remarque sur la syntaxe Parcours des sous-chaînes déterminées en fonction d'un séparateur
<a name="remarque_sur_syntaxe_parcours_des_souschaines_determinees_fonction_separateur_ELTPARAGRAPHE000348"></a>

- Ce type de parcours fonctionne uniquement sur des chaînes constantes. Il faut donc forcément utiliser un élément du projet (variable, champ, rubrique, ...) comme chaîne initiale.

- Lorsqu'un parcours est amorcé avec les constantes *rangPremier* ou *rangDernier*, les informations de parcours sont conservées en mémoire tant que les sous-chaînes extraites n'ont pas toutes été parcourues. Il est donc conseillé d'utiliser ce type de parcours uniquement lorsque la totalité des sous-chaînes doit être traitée.



<a name="NOTE0_2"></a>


### Fonction &lt;Type Chaîne&gt;.ExtraitChaîne et UNICODE
<a name="fonction_docparampagetitleshort_unicode_ELTPARAGRAPHE000359"></a>Les paramètres &lt;Chaîne initiale&gt; et &lt;Séparateur&gt; peuvent correspondre tous les deux :

- soit à des chaînes ANSI.

- soit à des chaînes UNICODE.

- soit à des buffers.




Il est possible d'utiliser des chaînes ANSI, Unicode et des buffers dans les différents paramètres de la fonction.

La règle de conversion utilisée est la suivante pour les systèmes Ansi (Windows ou Linux) :

- Si l'une au moins des chaînes est un buffer, toutes les chaînes sont converties en buffer, et l'opération est réalisée avec des buffers.

- Si la première condition n'est pas remplie, si l'une au moins des chaînes est Unicode, toutes les chaînes sont converties en Unicode et l'opération est réalisée en Unicode (si nécessaire, la conversion est réalisée avec l'alphabet courant).

- Sinon, l'opération est réalisée en Ansi.




La règle de conversion utilisée est la suivante pour les systèmes Unicode :

- Si l'une au moins des chaînes est un buffer, toutes les chaînes sont converties en buffers et l'opération est réalisée avec des buffers.

- Sinon, l'opération est réalisée en Unicode.




Pour plus de détails sur l'UNICODE, consultez [Gestion de l'UNICODE](../WDLang1/3024038.md).

Rappel : Les paramètres linguistiques utilisés sont définis lors de l'appel de la fonction [ChangeAlphabet](../WDLang1/3054001.md).

<a name="XComposante"></a>

## Composante :
wd280vm.dll
