
## fDécompacte (Fonction)

***En anglais : fUncompress***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Décompresse un fichier préalablement compressé par la fonction [fCompacte](../WDLang1/3036016.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003036021&name=fdecompacte_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Décompression d'un fichier
ResDécompresse = fDécompacte("C:\MesRépertoires\FichierCompressé.txt", ...
	"C:\MesRépertoires\FichierDécompressé.txt")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = fDécompacte(<Chemin du fichier à décompresser> [, <Chemin du fichier décompressé>])`
---

**`<Résultat> : (Entier)`**



- 0 si la décompression a été effectuée, 

- un code d'erreur (valeur supérieure à 0) dans le cas contraire. Le message correspondant au code d'erreur peut être connu grâce à la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Chemin du fichier à décompresser> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier à décompresser (260 caractères maximum). Un chemin de type UNC peut être utilisé. Ce fichier doit avoir été préalablement compressé à l'aide de la fonction [fCompacte](../WDLang1/3036016.md).

**`<Chemin du fichier décompressé> : (Chaîne de caractères optionnelle)`**

Les différents cas gérés sont les suivants: 

- *Pour décompresser le fichier sous un nom donné et dans un répertoire donné :
	*Nom et chemin complet (ou relatif) du fichier décompressé (260 caractères maximum). Un chemin de type UNC peut être utilisé.

- *Pour décompresser le fichier sous son nom d'origine (avant compression) et dans un répertoire donné :
	*Répertoire (chaîne se terminant par "\\" ou ":") du fichier décompressé (260 caractères maximum). Un chemin de type UNC peut être utilisé.

- *Si ce paramètre n'est pas spécifié :
	*Le fichier est décompressé sous son nom et dans son répertoire d'origine (avant compression). **Attention** : Le répertoire d'origine doit exister.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Codes d'erreur
<a name="codes_erreur_ELTPARAGRAPHE000072"></a>Les codes d'erreur retournés sont les suivants :

- 1 : Le fichier à décompresser ne peut pas être ouvert.

- 2 : Impossible de créer le fichier décompressé. Cette erreur est générée :

	- si le &lt;Chemin du fichier à décompresser&gt; et le &lt;Chemin du fichier décompressé&gt; sont identiques,

	- si le répertoire du &lt;Chemin du fichier décompressé&gt; n'existe pas.




- 3 : Le fichier à décompresser n'a pas été compressé par la fonction [fCompacte](../WDLang1/3036016.md).

- 4 : Le fichier ne peut pas être décompressé : le fichier est simplement copié.

- 6 : La décompression a été abandonnée par l'utilisateur : la fonction [fStopCompacte](../WDLang1/3036057.md) a été exécutée.

- 7 : Pas assez de place disponible pour créer le fichier décompressé.




Le message correspondant au code d'erreur peut être connu grâce à la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.


<a name="NOTE0_2"></a>




### Fichiers compressés avec des versions antérieures de WINDEV 
<a name="fichiers_compresses_avec_des_versions_anterieures_windev_ELTPARAGRAPHE000102"></a>La fonction **fDécompacte** permet de décompresser des fichiers compressés avec des versions précédentes de WINDEV et de WEBDEV.


<a name="NOTE0_3"></a>
<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Jauge
<a name="jauge_ELTPARAGRAPHE000124"></a>Sous Windows, pour visualiser la progression de la décompression du fichier, utilisez la fonction [Evénement](../WDLang1/3015011.md) pour traiter le message <u><u><u><u>JaugeCompactage</u></u></u></u> (1174). A la réception de ce message, la variable _EVE.wParam contient le pourcentage de décompression du fichier.

<a name="XComposante"></a>

## Composante :
wd280std.dll
