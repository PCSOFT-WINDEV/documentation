


## SysMiniatureAjouteBouton (Fonction)

***En anglais : SysThumbnailAddButton***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute un bouton dans la miniature de l'application dans la barre de tâches. Permet par exemple de rendre rapidement accessibles certaines fonctionnalités de l'application. 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Initialisation d'un lecteur multimédia
SysMiniatureAjouteBouton("lecture.ico", "Lecture", Lecture)
SysMiniatureAjouteBouton("pause.ico", "Pause", Pause, sysbtnGrisé)
SysMiniatureAjouteBouton("stop.ico", "Stop", "", sysbtnGrisé)
SysMiniatureAjouteBouton(ComplèteRep(fRepExe()) + "ferme.gif", "Ferme", "", sysbtnFermeMiniature)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = SysMiniatureAjouteBouton(<Icône à afficher> , <Bulle d'aide> , <Procédure WLangage> [, <Options>])`
---

**`<Résultat> : (Entier)`**



- Rang du bouton ajouté (entre 1 et 7), 

- -1 en cas d'échec de l'ajout (ou si la barre est déjà pleine).




**`<Icône à afficher> : (Chaîne de caractères au format Ansi ou Unicode)`**

Chemin du fichier icône à afficher. Ce fichier peut être présent sur le disque ou dans la bibliothèque (fichier WDL) de l'application. 
Cette icône doit être au format 16x16. Si l'icône utilisée n'est pas au format 16x16, elle sera automatiquement redimensionnée par Windows. 

**`<Bulle d'aide> : (Chaîne de caractères au format Ansi ou Unicode)`**

Texte de la bulle de survol du bouton.

**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure WLangage appelée lors du clic sur le bouton. 
Si ce paramètre correspond à une chaîne vide (""), aucune procédure ne sera lancée.

**`<Options> : (Constante optionnelle de type entier)`**

Mode de gestion du bouton. Les constantes disponibles sont les suivantes : 


|   |   |
| --- | --- |
| *sysbtnActif*<br>(Valeur par défaut) | Le bouton est actif. |
| *sysbtnFermeMiniature* | Un clic sur le bouton permet de refermer la miniature de l'application. |
| *sysbtnGrisé* | Le bouton est grisé. |
| *sysbtnInactif* | Le bouton ne peut pas être cliqué (cette constante peut être utilisée quand le bouton sert simplement d'icône de notification). |
| *sysbtnInvisible* | Le bouton est invisible (son emplacement est vide dans la barre des boutons). |
| *sysbtnSansFond* | Seule l'icône du bouton est dessinée (pas le cadre du bouton). Cette constante peut être utilisée lorsque l'icône contient elle-même le dessin du cadre. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Cas particuliers
<a name="cas_particuliers_ELTPARAGRAPHE000071"></a>

- Seuls 7 boutons peuvent être associés à une miniature. 

- Si l'icône utilisée n'est pas au format 16x16, elle sera automatiquement redimensionnée par Windows. 

- Les formats d'images supportés sous Windows sont :

	- Bitmap (\*.BMP)

	- Graphics Interchange Format (\*.gif)

	- Joint Picture Experts Group (\*.jpg ; \*.jpeg)

	- Kodak Photo CD (\*.pcd)

	- PaintBrush (\*.pcx)

	- Adobe Photoshop Format (\*.psd)

	- TrueVision TARGA (\*.tga)

	- Tagged Image File Format (\*.tif ; \*.tiff)
			Remarque : l'option "tiff mosaïque" de la norme tiff 6.0 n'est pas supportée. Dans ce cas, il est conseillé d'enregistrer l'image à la norme tiff 5.0. 

	- Portable Network Graphics (\*.png)

	- Windows MetaFiles (\*.emf ; \*.wmf)

	- Icônes (\*.ico ; \*.icw)
			Remarques : 

		- Affichage HQ (Haute Qualité) disponible.

		- Gestion des planches au format BMP transparent (32 bits).




- Curseurs (\*.cur)

- Portable Document Format (\*.pdf)

- Scalable Vector Graphics (\*.svg)

- Images WINDEV (générées par l'éditeur d'images, \*.WDPIC).





### Attention
<a name="attention_ELTPARAGRAPHE000078"></a>Cette fonction ne doit pas être utilisée dans le code de déclaration des globales de la fenêtre. En effet, la fenêtre doit être affichée pour obtenir le résultat voulu. 

Si le bouton doit être présent dans la miniature dès l'ouverture de la fenêtre, la fonction doit être utilisée dans le code d'initialisation de la fenêtre. 


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LesfonctionsspecifiquesaWindows7.gif) ***Exemples unitaires (WINDEV)*** : **Les fonctions spécifiques à Windows 7** <br>Utilisation des fonctions WLangage spécifiques à Windows 7 :<br>- SysIconeAjouteImage<br>- SysMiniatureAjouteBouton<br>- SysMiniatureSupprimeTout
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDJumplists.gif) ***Exemples didactiques (WINDEV)*** : **WD Jump lists** <br>JumpList sous Windows 7<br><br>Une JumpList est un menu accessible via le menu Démarrer ou l'icône de l'application dans la barre des tâches.<br>Elle permet entre autres d'afficher les documents récemment ou fréquemment ouverts avec l'application. Elle permet également d'afficher des tâches particulières.<br><br>Dans un but didactique, cet exemple manipule des images et certaines opérations sont directement accessibles via sa JumpList.



<a name="XComposante"></a>

## Composante :
wd280std.dll
