
## ExplorerRécupère (Fonction)

***En anglais : ExplorerRetrieve***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère le nombre et le nom des fichiers "droppés" depuis l'explorateur.

**Remarque** : Pour obtenir des informations provenant de l'explorateur, il est nécessaire que le dialogue ait été initialisé avec la fonction [ExplorerAccepte](../WDLang1/3030015.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003030009&name=explorerrecupere_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
Nb = ExplorerRécupère(_eve.wparam)
// Récupération de tous les fichiers
POUR i = 1 A Nb
	Trace(ExplorerRécupère(_eve.wparam, i))
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Récupérer le nombre de fichiers "droppés"

`<Résultat> = ExplorerRécupère(<Message>)`
---

**`<Résultat> : (Entier)`**

Nombre de fichiers sélectionnés.

**`<Message> : (Entier système)`**

Premier paramètre du message WM_DROPFILES (envoyé par l'explorateur à la fenêtre ou au champ WINDEV), c'est-à-dire _EVE.wParam.  


<a name="SYNTAXE2"></a>

### Récupérer un à un le nom des fichiers "droppés"

`<Résultat> = ExplorerRécupère(<Message> , <Numéro>)`
---

**`<Résultat> : (Chaîne de caractères)`**

Nom et chemin du fichier "droppé".

**`<Message> : (Entier système)`**

Premier paramètre du message WM_DROPFILES (envoyé par l'explorateur à la fenêtre ou au champ WINDEV), c'est-à-dire _EVE.wParam.

**`<Numéro> : (Entier)`**

Indice du fichier dont on veut récupérer le nom.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
Lors d'un "Drag and Drop" entre l'explorateur et une fenêtre (ou un champ) WINDEV, l'explorateur envoie le message WM_DROPFILES à la cible considérée. Le premier paramètre de ce message (_EVE.wParam) utilisé avec la fonction **ExplorerRécupère** permet de connaître le contenu du "Drag and Drop" (nombre et nom des fichiers sélectionnés).

Remarques :

- Il est impossible de récupérer le nombre et le nom des fichiers sélectionnés dans l'explorateur si aucun "Drag and Drop" n'est réalisé entre l'explorateur et une fenêtre WINDEV.

- La constante WM_DROPFILES est définie dans le fichier Winconst.wl livré dans le sous-répertoire "Personnel\\Externe" et vaut 0x233.






<a name="XComposante"></a>

## Composante :
wd280std.dll
