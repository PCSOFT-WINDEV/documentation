
## ComposantInfo (Fonction)

***En anglais : ComponentInfo***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie des informations sur un composant externe. Ce composant externe correspond :

- soit à un composant externe intégré dans le projet en cours.

- soit au projet en cours qui permet de définir et de générer un composant externe.

- soit à un composant externe qui n'est pas intégré dans le projet en cours.




Remarque : Cette fonction permet également de connaître pour une bibliothèque WINDEV/WEBDEV (fichier WDL) : 

- le numéro de version. 

- la date de génération.



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003013025&name=composantinfo_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Informations sur le composant CompPresentation 
Trace(ComposantInfo(CompPresentation, ciVersion))
```


<a name="Exemple2"></a>



```wl
// Informations sur le composant CompPresentation
// présent dans le répertoire "C:\MonRépertoire" 
Trace(ComposantInfo(CompPresentation, ciVersion, "C:\MonRépertoire"))
```


<a name="Exemple3"></a>



```wl
// Informations sur le composant en cours
Trace(ComposantInfo("", ciVersion))
```


<a name="Exemple4"></a>



```wl
// Informations sur un composant externe
Trace(ComposantInfo("", ciVersion, "D:\MesComposants\MonComposant.WDK"))
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Obtenir des informations sur un composant externe intégré dans le projet en cours

`<Résultat> = ComposantInfo(<Nom du composant> , <Information recherchée> [, <Répertoire du composant>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Information demandée.

**`<Nom du composant> : (Chaîne de caractères)`**

Nom logique du composant externe (qui apparaît sous l'éditeur). Si le nom du composant externe n'est pas connu par le projet, une erreur WLangage apparaît.

**`<Information recherchée> : (Constante de type Entier)`**

Information disponible sur le composant :



|   |   |
| --- | --- |
| *ciChargementLancement* | Chargement du composant externe dès le lancement du projet :<br><br>- <u><u><u><u>Vrai</u></u></u></u> si le composant externe a été chargé dès le lancement du projet.<br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.<br><br><br> |
| *ciComposantGlobal* | Mode de chargement du composant externe :<br><br>- <u><u><u><u>Vrai</u></u></u></u> si le composant externe est chargé en global.<br><br>- <u><u><u><u>Faux</u></u></u></u> si le composant externe est isolé<br><br><br> |
| *ciCopyright* | Copyright du composant |
| *ciDateGénération* | Date de génération du composant ou de la bibliothèque (fichier WDL). |
| *ciEtat* | État du composant externe. Cet état correspond à une des variables suivantes :<br><br>- *cieAbsent* : Fichier WDK connu du projet mais non présent physiquement<br><br>- *cieChargé* : Fichier WDK déjà chargé<br><br>- *cieInconnu* : Fichier WDK inconnu du projet<br><br>- *ciePrêt* : Fichier WDK prêt à être utilisé<br><br>- *cieVersionTropAncienne* : Fichier WDK trop ancien<br><br>- *cieVersionTropRécente* : Fichier WDK plus récent et incompatible<br><br><br> |
| *ciLibellé* | Libellé du composant. |
| *ciNomPhysique* | Nom du fichier physique associé au composant externe. |
| *ciNuméroPatch* | Numéro du premier patch accepté par le composant externe. |
| *ciPropriétaire* | Société émettrice du composant externe. |
| *ciSociété* | Société émettrice du composant externe (idem *ciPropriétaire*) |
| *ciVersion* | Version réelle du composant ou de la bibliothèque (fichier WDL). |
| *ciVersionCompatible* | Version compatible du composant |
| *ciVersionInterne* | Version de WINDEV ou de WEBDEV avec laquelle le composant a été créé |
| *ciVersionProjet* | Version du composant avec laquelle le projet a été compilé |



**`<Répertoire du composant> : (Chaîne de caractères optionnelle)`**

Répertoire du composant externe &lt;Nom du composant&gt; (fichier WDK). Si le composant externe &lt;Nom du composant&gt; est déjà chargé, ce paramètre ne sera pas pris en compte.  


<a name="SYNTAXE2"></a>

### Obtenir des informations sur le projet en cours qui permet de définir et générer un composant externe

`<Résultat> = ComposantInfo(<Nom du composant> , <Information recherchée>)`
---

**`<Résultat> : (Chaîne de caractères)`**

Information demandée.

**`<Nom du composant> : (Chaîne de caractères)`**

Chaîne vide (""). Le composant externe en cours sera manipulé. Ce projet permet de définir et de générer un composant externe.

**`<Information recherchée> : (Constante de type Entier)`**

Information disponible sur le composant externe en cours :



|   |   |
| --- | --- |
| *ciComposantGlobal* | Mode de chargement du composant externe :<br><br>- <u><u><u><u>Vrai</u></u></u></u> si le composant externe est chargé en global.<br><br>- <u><u><u><u>Faux</u></u></u></u> si le composant externe est isolé<br><br><br> |
| *ciCopyright* | Copyright du composant externe. |
| *ciDateGénération* | Date de génération du composant ou de la bibliothèque (fichier WDL). |
| *ciEtat* | État du composant externe. Cet état correspond à la constante *cieChargé* : Fichier WDK déjà chargé. |
| *ciLibellé* | Libellé du composant externe. |
| *ciNomLogique* | Nom logique du composant externe. |
| *ciNomPhysique* | Nom du fichier physique associé au composant externe. |
| *ciNuméroPatch* | Numéro du premier patch accepté par le composant externe. |
| *ciPropriétaire* | Société émettrice du composant externe. |
| *ciSociété* | Société émettrice du composant externe (idem *ciPropriétaire*). |
| *ciVersion* | Version réelle du composant externe ou de la bibliothèque (fichier WDL). |
| *ciVersionCompatible* | Version compatible du composant externe. |
| *ciVersionInterne* | Version de WINDEV ou de WEBDEV avec laquelle le composant externe a été créé. |
| *ciVersionProjet* | Version du composant externe avec laquelle le projet a été compilé. |






<a name="SYNTAXE3"></a>

### Obtenir des informations sur un composant externe qui n'est pas intégré dans le projet en cours

`<Résultat> = ComposantInfo(<Nom du composant> , <Information recherchée> [, <Nom physique du composant>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Information demandée.

**`<Nom du composant> : (Chaîne de caractères)`**

Chaîne vide (""). Le composant externe &lt;Nom physique du composant&gt; sera manipulé.

**`<Information recherchée> : (Constante de type Entier)`**

Information disponible sur le composant externe :



|   |   |
| --- | --- |
| *ciComposantGlobal* | Mode de chargement du composant externe :<br><br>- <u><u><u><u>Vrai</u></u></u></u> si le composant externe est chargé en global.<br><br>- <u><u><u><u>Faux</u></u></u></u> si le composant externe est isolé<br><br><br> |
| *ciCopyright* | Copyright du composant externe. |
| *ciDateGénération* | Date de génération du composant ou de la bibliothèque (fichier WDL). |
| *ciEtat* | État du composant externe. Cet état correspond à une des constantes suivantes :<br><br>- *cieAbsent* : Fichier WDK non présent physiquement<br><br>- *ciePrêt* : Fichier WDK prêt à être utilisé<br><br><br> |
| *ciLibellé* | Libellé du composant externe. |
| *ciNomLogique* | Nom logique du composant externe. |
| *ciNomPhysique* | Nom du fichier physique associé au composant externe. |
| *ciNuméroPatch* | Numéro du premier patch accepté par le composant externe. |
| *ciPropriétaire* | Société émettrice du composant externe. |
| *ciSociété* | Société émettrice du composant externe (idem *ciPropriétaire*). |
| *ciVersion* | Version réelle du composant externe ou de la bibliothèque (fichier WDL). |
| *ciVersionCompatible* | Version compatible du composant externe. |
| *ciVersionInterne* | Version de WINDEV ou de WEBDEV avec laquelle le composant externe a été créé. |
| *ciVersionProjet* | Information non disponible. &lt;Résultat&gt; sera égal à "" (chaîne vide). |



**`<Nom physique du composant> : (Chaîne de caractères optionnelle)`**

Nom et chemin complet du composant externe (fichier WDK).  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Recherche du numéro de version du composant externe
<a name="recherche_numero_version_composant_externe_ELTPARAGRAPHE000315"></a>Si un composant externe chargé au démarrage du projet a une version incorrecte par rapport au projet, il y aura une erreur WLangage avant l'exécution du code d'initialisation du projet.

**Pour tester par programmation la version d'un composant externe** (constantes *ciVersionXX* ou *ciEtat*), il faut que le composant externe soit chargé lors de sa première utilisation. Le mode de chargement d'un composant externe est défini dans la description du composant externe importé dans le projet (onglet "Général").


<a name="NOTE0_2"></a>


### Informations sur une bibliothèque WINDEV/WEBDEV
<a name="informations_sur_une_bibliotheque_windevwebdev_ELTPARAGRAPHE000325"></a>Pour connaître : 

- le numéro de version d'une bibliothèque WINDEV/WEBDEV (fichier WDL), utilisez la syntaxe suivante : 
	
	```txt
	ComposantInfo("", ciVersion, <Nom physique de la WDL>)
	```


- la date de génération d'une bibliothèque WINDEV/WEBDEV (fichier WDL), utilisez la syntaxe suivante : 
	
	```txt
	ComposantInfo("", ciDateGénération, <Nom physique de la WDL>)
	```






<a name="NOTE0_3"></a>




### Recherche du numéro de patch accepté par un composant externe
<a name="recherche_numero_patch_accepte_par_composant_externe_ELTPARAGRAPHE000343"></a>Pour être pris en compte :

- Un patch doit avoir été créé à partir de la même configuration de projet que le composant externe.

- Un patch doit avoir un numéro de patch supérieur ou égal au numéro de patch du composant externe.





<a name="NOTE0_4"></a>




### Recherche du numéro de patch accepté par des éléments WINDEV/WEBDEV
<a name="recherche_numero_patch_accepte_par_des_elements_windevwebdev_ELTPARAGRAPHE000355"></a>

- Pour connaître le numéro du premier patch accepté par l'application (fichier EXE), utilisez la syntaxe suivante :
	
	```txt
	ComposantInfo("", ciNuméroPatch, <Nom physique de l'exécutable>)
	```





- Pour connaître le numéro du premier patch accepté par la bibliothèque (fichier WDL), utilisez la syntaxe suivante :
	
	```txt
	ComposantInfo("", ciNuméroPatch, <Nom physique de la WDL>)
	```





**Remarque** : [L'exemple complet](../WDLang1/1000003013025.md) de cette fonction présente une solution pour de lister les patchs utilisés par une application. 

**Remarque** : Pour être pris en compte :

- Un patch doit avoir été créé à partir de la même configuration de projet que l'exécutable ou la bibliothèque.

- Un patch doit avoir un numéro de patch supérieur ou égal au numéro de patch de l'exécutable ou de la bibliothèque.





<a name="NOTE0_5"></a>




### Composants externes partageant le contexte du projet
<a name="composants_externes_partageant_contexte_projet_ELTPARAGRAPHE000380"></a>Les informations renvoyées par la fonction **ComposantInfo** ne sont pas disponibles pour les composants externes qui partagent le contexte du projet. La fonction renvoie "" (Chaîne vide).



<a name="XComposante"></a>

## Composante :
wd280vm.dll
