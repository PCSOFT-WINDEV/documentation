
## Gestion des actions avec Undo/Redo
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000118"></a>
WINDEV permet de gérer facilement le Undo/Redo dans vos applications grâce aux fonctions ActionXXX. L'utilisateur peut alors simplement utiliser les raccourcis Ctrl + Z et Ctrl + Y pour annuler ou refaire une action. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000142"></a>
Pour gérer le Undo/Redo dans vos applications WINDEV : 

1. Déclarez les actions à enregistrer dans la pile des actions effectuées grâce à la fonction [ActionDo](../WDLang1/1000022676.md). Cette fonction attend en paramètre le nom de la procédure correspondant à l'action. Cette procédure peut être une procédure locale, globale ou interne. 

2. Dans le code de la procédure correspondant à l'action à faire, utilisez la fonction [ActionDéclareUndo](../WDLang1/1000022678.md) pour définir le code à exécuter pour annuler l'action. Cette fonction attend en paramètre le nom de la procédure à exécuter. Cette procédure peut être une procédure locale, globale ou interne.

3. Utilisez si nécessaire les fonctions suivantes : 

	- [ActionRedo](../WDLang1/1000022608.md) pour exécuter la dernière action annulée. 

	- [ActionUndo](../WDLang1/1000022677.md) pour annuler la dernière action effectuée. 







Remarques : 

- Il n'est pas possible d'empiler plusieurs fois les MEMES actions définies par la fonction [ActionDo](../WDLang1/1000022676.md). Chaque action demandée par la fonction [ActionDo](../WDLang1/1000022676.md) supprime la précédente action identique. Donc, seule la dernière MEME action peut être annulée.

- Dans le menu contextuel d'un champ, l'option "Annuler" proposée par défaut n'a pas le même effet que la fonction [ActionUndo](../WDLang1/1000022677.md) ou que le raccourci Ctrl + Z.





### Exemple
<a name="exemple_ELTPARAGRAPHE000050"></a>L'exemple suivant permet de modifier la couleur de fond de deux champs de saisie. Cette action est annulable par la combinaison de touches Ctrl + Z :

```wl
ActionDo(FEN_ACTION, Colorie)

	PROCEDURE INTERNE Colorie
	SAI_Nom.CouleurFond = VertPastel
	SAI_Prénom.CouleurFond = RougePastel
	
	ActionDeclareUndo(RetourArriere)
		PROCEDURE INTERNE RetourArriere
		SAI_Nom.CouleurFond = CouleurDéfaut
		SAI_Prénom.CouleurFond = CouleurDéfaut
		FIN
	FIN
```


Pour permettre à l'utilisateur d'annuler plusieurs actions, il suffit d'utiliser plusieurs fois la fonction [ActionDo](../WDLang1/1000022676.md) avec des procédures différentes. Par exemple : 

```wl
ActionDo(FEN_ACTION, Colorie)
ActionDo(FEN_ACTION, MemoriseValeur)

	PROCEDURE INTERNE Colorie
	SAI_Nom.CouleurFond = VertPastel
	SAI_Prénom.CouleurFond = RougePastel
	
	ActionDeclareUndo(RetourArriere)
		PROCEDURE INTERNE RetourArriere
		SAI_Nom.CouleurFond = CouleurDéfaut
		SAI_Prénom.CouleurFond = CouleurDéfaut
		FIN
	FIN
	
	PROCEDURE INTERNE MemoriseValeur()
	SAI_Nom.Note = SAI_Nom
	SAI_Prénom.Note = SAI_Prénom
	
	ActionDeclareUndo(RetourArriere)
		PROCEDURE INTERNE RetourArriere
		SAI_Nom = SAI_Nom.Note
		SAI_Prénom = SAI_Prénom.Note
		FIN
	FIN
```


Dans cet exemple, le premier Ctrl + Z annulera la mémorisation des valeurs et le second annulera la coloration des champs. 



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Fonctions WLangage
<a name="fonctions_wlangage_ELTTEXTE000172"></a>
Les fonctions WLangage de gestion des actions sont les suivantes : 



|   |   |
| --- | --- |
| [ActionDéclareUndo](../WDLang1/1000022678.md) | Déclare comment annuler une action ajoutée avec la fonction [ActionDo](../WDLang1/1000022676.md). Cette fonction **DOIT** être appelée durant l'exécution de la procédure fournie à la fonction [ActionDo](../WDLang1/1000022676.md). |
| [ActionDo](../WDLang1/1000022676.md) | Crée et exécute une action personnalisée (définie par programmation) avec support du "Undo/Redo". |
| [ActionRedo](../WDLang1/1000022608.md) | Exécute la dernière action annulée. |
| [ActionUndo](../WDLang1/1000022677.md) | Annule la dernière action effectuée par l'utilisateur final. |








