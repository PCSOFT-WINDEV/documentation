


## PlanificateurAjouteTâche (Fonction)

***En anglais : SchedulerAddTask***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Crée une tâche dans le planificateur de tâches Windows (si cette tâche n'existe pas déjà).

Avant de créer la tâche, il est nécessaire de définir tous les paramètres de cette tâche :

- dans la [structure TâchePlanifiée](../WDLang1/3089004.md).

- dans la [structure HoraireTâchePlanifiée](../WDLang1/3089002.md). Par défaut, la tâche est quotidienne, exécutée à 9h00.




Il est conseillé de réinitialiser ces structures avec la fonction [PlanificateurRAZ](../WDLang1/3089012.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003089003&name=planificateurajoutetache_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Initialisation des valeurs par défaut
PlanificateurRAZ()
// Description de la tâche à ajouter
TâchePlanifiée.Application = "Calc.exe"	// Chemin du programme
TâchePlanifiée.Utilisateur = "Janis"	// Utilisateur de la session
TâchePlanifiée.MotDePasse = SAI_MDP		// Mot de passe de la session
TâchePlanifiée.Commentaire = "Programme de calcul"	// Commentaire de la tâche
TâchePlanifiée.SuppressionAutomatique = Faux	
// Booléen à vrai si la tâche doit être supprimée 

// Ajout de la tâche préalablement décrite
PlanificateurAjouteTâche("Calculatrice")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = PlanificateurAjouteTâche(<Nom de la tâche>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la tâche a été ajoutée, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur.




**`<Nom de la tâche> : (Chaîne de caractères)`**

Nom de la tâche à créer. Ce nom sera utilisé ensuite dans toutes les fonctions de gestion du planificateur.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Eléments importants à renseigner dans la structure TâchePlanifiée 
<a name="elements_importants_renseigner_dans_structure_tacheplanifiee_ELTPARAGRAPHE000063"></a>Pour créer une tâche planifiée, les éléments indispensables à remplir dans la structure [TâchePlanifiée](../WDLang1/3089004.md) sont les suivants :

- TâchePlanifiée.Application.

- TâchePlanifiée.RépertoireTravail : Ce paramètre est obligatoire. Si ce paramètre n'est pas renseigné, il est automatiquement initialisé avec le répertoire de la variable TâchePlanifiée.Application.

- TâchePlanifiée.Utilisateur




**Remarque** : Si vous utilisez un domaine, il est nécessaire de préciser le domaine dans la variable TâchePlanifiée.Utilisateur.
<a name="NOTE0_2"></a>


### Système d'exploitation nécessaire
<a name="systeme_exploitation_necessaire_ELTPARAGRAPHE000079"></a>Pour créer une tâche planifiée sous Windows Vista et supérieur, il est nécessaire de posséder les droits "Administrateur". 

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280std.dll
