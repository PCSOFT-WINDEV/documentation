
## fCrypte (Fonction)

***En anglais : fEncrypt***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Crypte un fichier sous forme binaire ou ASCII.

**Remarque** : Ce fichier peut être décrypté avec [fDécrypte](../WDLang1/3036018.md).




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003036013&name=fcrypte_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Cryptage d'un fichier
ResCrypte = fCrypte("C:\MesRépertoires\Fichier.txt", ...
	"C:\MesRépertoires\FichierCrypté.txt", "MotDePasse")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = fCrypte(<Chemin du fichier à crypter> , <Chemin du fichier crypté> , <Mot de passe> [, <Type de cryptage> [, <Format du fichier crypté>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le cryptage a été effectué, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Chemin du fichier à crypter> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier à crypter (260 caractères maximum). Un chemin de type UNC peut être utilisé.


![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.





**`<Chemin du fichier crypté> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier crypté (260 caractères maximum). Un chemin de type UNC peut être utilisé.


![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.





**`<Mot de passe> : (Chaîne de caractères)`**

Mot de passe utilisé pour crypter le fichier. Ce mot de passe sera utilisé pour décrypter le fichier crypté (fonction [fDécrypte](../WDLang1/3036018.md)). Un mot de passe long permet une meilleure sécurité de cryptage.

**`<Type de cryptage> : (Constante optionnelle)`**

Indique le type de cryptage :


|   |   |
| --- | --- |
| *crypteAucun* | Aucun cryptage n'est effectué. |
| *crypteRapide*<br>(Valeur par défaut) | La priorité est donnée à la rapidité du cryptage (algorithme sur 128 bits).<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) L'algorithme utilisé sera de type Blowfish.<br><br><br><br> |
| *crypteRC516* | La priorité est donnée à la sécurité du cryptage (algorithme RC5 sur 16 rondes).<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'a aucun effet. |
| *crypteSécurisé* | La priorité est donnée à la sécurité du cryptage (algorithme RC5 sur 128 bits).<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) L'algorithme utilisé sera de type PBE (Password Based Encryption).<br><br><br><br> |



**`<Format du fichier crypté> : (Constante optionnelle de type Entier)`**

Indique le format du fichier crypté :


|   |   |
| --- | --- |
| *encodeAucun* ou *Faux* | Format binaire. <br>Le fichier crypté pourra comporter des caractères non-imprimables. La taille du fichier sera supérieure (environ 4 octets) à la taille du fichier d'origine. |
| *encodeBASE64* | Format BASE 64. <br>Le fichier est crypté avec l'algorithme BASE64. La taille du fichier sera supérieure (environ 30%) à la taille du fichier d'origine. <br>Ce format peut par exemple être utilisé pour insérer un fichier crypté dans le corps d'un courrier électronique. |
| *encodePCS* ou *Vrai*<br>(Valeur par défaut) | Format ASCII. <br>Le fichier crypté ne comportera que des caractères imprimables. La taille du fichier sera supérieure (environ 30%) à la taille du fichier d'origine. <br>Ce format peut par exemple être utilisé pour insérer un fichier crypté dans le corps d'un courrier électronique. |
| *encodeUUEncode* | Format UUEncode. <br>Le fichier est crypté avec l'algorithme UUEncode. La taille du fichier sera supérieure (environ 30%) à la taille du fichier d'origine. <br>Ce format peut par exemple être utilisé pour insérer un fichier crypté dans le corps d'un courrier électronique. |


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre est ignoré.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000249"></a>La fonction **fCrypte** génère une erreur dans les cas suivants :

- le fichier à crypter n'existe pas,

- le fichier à crypter est bloqué,

- le chemin du fichier à crypter est invalide,

- le &lt;Mot de passe&gt; est une chaîne vide,

- l'utilisateur n'a pas les droits en lecture sur le fichier à crypter,

- l'utilisateur n'a pas les droits en écriture sur le fichier crypté.





<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Fonctionnement sous Windows Vista (et supérieur)
<a name="fonctionnement_sous_windows_vista_superieur_ELTPARAGRAPHE000441"></a>Si cette fonction ne fonctionne pas correctement sous Windows Vista (et supérieur), il est nécessaire de vérifier si le fichier ou le répertoire manipulé ne se trouve pas dans un des répertoires système (répertoire de Windows ou répertoire "Program Files").

**En effet, sous Windows Vista (et supérieur), avec le [mécanisme de l'UAC](../Editeurs/2025014.md) (contrôle des comptes utilisateurs) activé**, il est nécessaire d'avoir les privilèges administrateur pour manipuler / modifier des fichiers ou des répertoires présents dans les répertoires système (répertoire de Windows ou répertoire "Program Files").

**Conseil de programmation** : Si vous devez manipuler / modifier des fichiers ou des répertoires, sans avoir besoin de privilèges administrateur, il est conseillé :

- de ne pas écrire dans le répertoire de Windows ou dans le répertoire "Program Files",

- d'utiliser le répertoire système correspondant à l'application (connu par la fonction [SysRep](../WDLang1/3073026.md) par exemple avec la constante *srAppDataCommun*).




**Remarque** : Sous Windows Vista (et supérieur), le mécanisme de la virtualisation permet de rendre les applications compatibles Vista. Si le fichier est créé dans un répertoire système sans avoir les droits nécessaires, ce fichier sera réellement créé dans un autre répertoire (C:\\Users\\&lt;LOGIN&gt;AppData\\Local\\VirtualStore\\Windows\\). Dans ce cas, le fichier ne pourra pas être partagé entre plusieurs applications.
<a name="NOTE0_3"></a>




### Cryptage/Décryptage d'une chaîne de caractères
<a name="cryptagedecryptage_une_chaine_caracteres_ELTPARAGRAPHE000277"></a>Pour crypter/décrypter une chaîne de caractères, utilisez les fonctions [Crypte](../WDLang1/3024014.md) et [Décrypte](../WDLang1/3024035.md).


<a name="NOTE0_4"></a>
<a name="NOTE0_5"></a>
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) **Cryptage en Android/Java et décryptage par une application WINDEV (ou inversement)**
Attention : les algorithmes de cryptage/décryptage utilisés en Java et Android ne sont pas les mêmes que ceux utilisés par WINDEV. Il n'est donc pas possible de crypter une fichier en Java ou Android et de le décrypter avec WINDEV (et inversement).  








- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Lesfonctionsdechiffrement_CrypteXXX,DecrypteXXX_.gif) ***Exemples unitaires (WINDEV)*** : **Les fonctions de chiffrement (CrypteXXX, DécrypteXXX)** <br>Utilisation des fonctions de chiffrement de WINDEV.<br>Cet exemple permet de :<br>- Chiffrer une chaîne de caractères<br>- Déchiffrer une chaîne de caractères
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Lesfonctionsdechiffrement.gif) ***Exemples unitaires (WINDEV Mobile)*** : **Les fonctions de chiffrement** <br>Utilisation des fonctions WLangage de chiffrement.<br>Cet exemple permet de :<br>- Chiffrer une chaîne de caractères<br>- Déchiffrer une chaîne de caractères



<a name="XComposante"></a>

## Composante :
wd280std.dll
