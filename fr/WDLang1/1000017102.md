
## ServiceEtat (Fonction)

***En anglais : ServiceStatus***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie l'état actuel d'un service. Ce service peut être un service présent sur le poste local ou sur un poste distant.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1001000017102&name=serviceetat_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Renvoie l'état du service présent dans la table TABLE_Service
Résultat1 est un entier
Résultat1 = ServiceEtat(COL_Nom[TABLE_Service])
SI Résultat1 = -1 ALORS
	Erreur(ErreurInfo())
SINON
	// Appel d'une procédure spécifique WLangage pour transformer le résultat en texte
	Info("Etat du service : " + EtatEnTexte(Résultat1))
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ServiceEtat(<Nom du service> [, <Poste distant>])`
---

**`<Résultat> : (Constante de type Entier)`**



- -1 en cas d'erreur. Pour plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md), 

- Etat actuel du service :  
	


|   |   |
| --- | --- |
| *serviceEtatArrêté* | Le service est arrêté. |
| *serviceEtatAttenteArrêt* | Le service a reçu une commande d'arrêt mais il n'est pas encore arrêté. |
| *serviceEtatAttenteDémarrage* | Le service a reçu une commande de démarrage mais il n'est pas encore démarré. |
| *serviceEtatAttentePause* | Le service a reçu une commande de pause mais il n'est pas encore en pause. |
| *serviceEtatAttenteRelancement* | Le service a reçu une commande de relancement mais il n'est pas encore relancé. |
| *serviceEtatDémarré* | Le service est en cours de fonctionnement. |
| *serviceEtatEnPause* | Le service est en pause. |






**`<Nom du service> : (Chaîne de caractères)`**

Nom du service à contrôler.

**`<Poste distant> : (Chaîne de caractères optionnelle)`**

Adresse IP du poste distant au format xxx.xxx.xxx.xxx (obtenu par la fonction [NetAdresseIP](../WDLang3/3056023.md)) ou nom du poste distant (obtenu par la fonction [NetNomMachine](../WDLang3/3056014.md)). Ce paramètre permet de contrôler un service sur un autre poste. Pour utiliser cette option, l'utilisateur doit être administrateur de la machine distante. 
Si ce paramètre n'est pas précisé ou correspond à une chaîne vide (""), le service est manipulé en local.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>


<a name="XComposante"></a>

## Composante :
wd280std.dll
