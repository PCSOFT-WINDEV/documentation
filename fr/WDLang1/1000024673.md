
## Procédure WLangage appelée par la fonction fListeFichier



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Procédure WLangage (également appelée "Callback") appelée par la fonction [fListeFichier](../WDLang1/3036058.md) pour chaque fichier trouvé. Cette procédure peut être une procédure locale, globale ou interne.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Connaître le nombre de fichiers de type "*.DOC" en lecture seule 
// dans un répertoire. 

// Déclaration et initialisation des variables

// Nombre de fichiers répondant aux critères
NbFichierLS est un entier 
// Nombre de fichiers de type "*.DOC"
NbFichierDoc est un entier 
NbFichierDoc = 0
CritèreRecherche est une chaîne

// Sélection du répertoire dans lequel les fichiers vont être listés
CritèreRecherche = "C:\MesDocuments\"

// Ajout du critère "\*.doc" à la fin du nom du répertoire sélectionné
CritèreRecherche = CritèreRecherche + "\*.doc"

// Liste des fichiers de type "*.DOC"
NbFichierDoc = fListeFichier(CritèreRecherche, "AttributFichier", &NbFichierLS)

// Affichage du nombre de fichiers répondant aux critères
Info("Il y a" + NbFichierLS + "fichiers en lecture seule sur" + ...
	NbFichierDoc + "fichiers listés")

// ---------------------------------------------------

// Procédure locale appelée par fListeFichier
PROCEDURE AttributFichier(Repertoire, Nom, Change, NbFichierDoc)
// Déclaration de la variable
NbFichierLS est un entier
// Fichiers en lecture seule ?
SI Position(fAttribut(Repertoire + Nom), "R") <> 0 ALORS
	Transfert(&NbFichierLS, NbFichierDoc, 4)
	NbFichierLS++
	Transfert(NbFichierDoc, &NbFichierLS, 4)
	// Affichage du nom du fichier dans la liste "LISTE_ListeFichier"
	ListeAjoute(LISTE_ListeFichier, Repertoire + Nom)
FIN
RENVOYER Vrai
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = fListeFichier_Callback(<Chemin> , <Nom du fichier> [, <Change> [, <Pointeur de la procédure>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> pour continuer le parcours des fichiers,

- <u><u><u><u>Faux</u></u></u></u> pour forcer l'interruption du parcours des fichiers. 




**`<Chemin> : (Chaîne de caractères)`**

Chemin du fichier manipulé (il contient toujours un "\\" à la fin; par exemple, "C:\\WINDEV\\").

**`<Nom du fichier> : (Chaîne de caractères)`**

Nom du fichier trouvé.

**`<Change> : (Constante optionnelle de type Entier)`**

Permet de savoir si un changement de répertoire a été effectué. Les valeurs possibles sont les suivantes : 


|   |   |
| --- | --- |
| *flChangeRépertoire* | Le fichier est le premier listé dans un sous-répertoire de &lt;Chemin&gt; (cela signifie qu'il y a eu changement de répertoire). |
| *flFichier* | Tous les autres cas. |
| *flPremierFichier* | Le fichier est le premier listé dans le &lt;Chemin&gt;. |



**`<Pointeur de la procédure> : (Entier optionnel)`**

Valeur passée dans le paramètre &lt;Pointeur&gt; de la fonction [fListeFichier](../WDLang1/3036058.md). Si le paramètre &lt;Pointeur&gt; n'est pas précisé dans la fonction [fListeFichier](../WDLang1/3036058.md), &lt;Pointeur de la procédure&gt; vaut 0.







<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Exemple de valeurs pouvant être prises par le paramètre &lt;Change&gt;
<a name="exemple_valeurs_pouvant_etre_prises_par_parametre_ELTPARAGRAPHE000069"></a>Lors du parcours des fichiers listés par la fonction [fListeFichier](../WDLang1/3036058.md), voici les différentes valeurs pouvant être prises par &lt;Change&gt; : 


| Fichier en cours | &lt;Change&gt; |
| --- | --- |
| Rep\\Fichier 1 | *flPremierFichier* |
| Rep\\Fichier n | *flFichier* |
| Rep\\SousRep 1\\Fichier 1 | *flChangeRépertoire* |
| Rep\\SousRep 1\\Fichier m | *flFichier* |
| Rep\\SousRep 2\\Fichier 1 | *flChangeRépertoire* |
| Rep\\SousRep 2\\Fichier x | *flFichier* |




<a name="NOTE0_2"></a>




### Interruption complète de la fonction fListeFichier
<a name="interruption_complete_fonction_flistefichier_ELTPARAGRAPHE000111"></a>Tant qu'il y a des fichiers à parcourir, la fonction [fListeFichier](../WDLang1/3036058.md) ne peut pas être interrompue.

Pour forcer l'interruption du parcours complet, utilisez la ligne suivante dans la procédure :


```wl
RENVOYER Faux
```


Par exemple, la procédure "RechProduit" est appelée automatiquement par la fonction [fListeFichier](../WDLang1/3036058.md) :


```wl
PROCEDURE RechProduit(Chemin, NomFichier)
...
// Arrêt demandé ?
Multitâche(-1)
SI ToucheEnfoncée(teEchap) = Vrai ALORS
	Info("La recherche va être arrêtée")
	RENVOYER Faux
FIN
...
RENVOYER Vrai
```


Dans ce cas, la fonction [fListeFichier](../WDLang1/3036058.md) retourne le nombre de fichiers parcourus jusqu'à l'appel de "RENVOYER Faux".
Dans les autres cas (pour poursuivre le parcours), la procédure DOIT renvoyer <u><u><u><u>Vrai</u></u></u></u>.

Si la procédure ne retourne aucune valeur (ni <u><u><u><u>Vrai</u></u></u></u>, ni <u><u><u><u>Faux</u></u></u></u>), une erreur est générée.


<a name="NOTE0_3"></a>




### Interruption partielle de la fonction fListeFichier
<a name="interruption_partielle_fonction_flistefichier_ELTPARAGRAPHE000159"></a>Pour que la procédure ne s'exécute pas pour un fichier donné, utilisez la ligne suivante :


```wl
RENVOYER Vrai
```


Par exemple, la procédure "RechProduit" est appelée automatiquement par la fonction [fListeFichier](../WDLang1/3036058.md) :


```wl
PROCEDURE RechProduit(Chemin, NomFichier)
...
// Fichier à ne pas prendre en compte
SI NomFichier = "MauvaisFichier.XLS" ALORS
	RENVOYER Vrai
FIN
...
RENVOYER Vrai
```


Dans ce cas, la fonction [fListeFichier](../WDLang1/3036058.md) appelle automatiquement la procédure pour le prochain fichier trouvé.

Si la procédure ne retourne aucune valeur (ni <u><u><u><u>Vrai</u></u></u></u>, ni <u><u><u><u>Faux</u></u></u></u>), une erreur est générée.







<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280std.dll
