


## TableauAjoute (Fonction)

***En anglais : ArrayAdd***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute un élément en dernière position :

- d'un tableau WLangage à une dimension.

- d'une propriété tableau d'un type avancé (tableau des événements de gglAgenda, tableau d'un document de type Traitement de texte, ...).

- d'une liste WLangage. 


Cette fonction permet également de concaténer deux tableaux ou deux listes.

**Remarques** :

- Cette fonction est identique à la fonction [Ajoute](../WDLang1/1000017348.md).













<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MonTableau est un tableau de 2 chaînes
TableauAjoute(MonTableau, "WINDEV")
TableauAjoute(MonTableau, " WEBDEV")
TableauAjoute(MonTableau, "WINDEV et WEBDEV")
// Afficher le contenu du 3° élément (les deux premiers sont vides)
Trace(MonTableau[3])  // Affiche "WINDEV"
```
<a name="Exemple2"></a>

```wl
MonTableau est un tableau de 2 chaînes
MonTableau[1] = "WINDEV"
MonTableau[2] = "WEBDEV"
TableauAjoute(MonTableau, "WINDEV et WEBDEV")
// Afficher le contenu du 3° élément
Trace(MonTableau[3]) // Affiche "WINDEV et WEBDEV"
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Ajouter un élément à un tableau, à une propriété tableau d'un type avancé ou à une liste

`<Résultat> = TableauAjoute(<Variable WLangage> [, <Valeur>])`
---

**`<Résultat> : (Entier)`**

Indice auquel l'élément spécifié a été ajouté. En cas d'erreur, une erreur fatale est affichée.

**`<Variable WLangage> : (Tableau ou Liste)`**

Nom de la variable à manipuler. Cette variable peut être :

- Une variable de type Tableau.

- Une variable de type Liste.
	




**`<Valeur> : (Type des éléments du tableau, optionnel)`**

Valeur à ajouter au tableau ou à la liste. Ce paramètre est obligatoire dans le cas d'une liste.

Dans le cas d'un tableau, si ce paramètre n'est pas spécifié, le tableau est agrandi avec la valeur par défaut du type des autres éléments du tableau.  


<a name="SYNTAXE2"></a>

### Concaténer des tableaux ou des listes

`<Résultat> = TableauAjoute(<Variable WLangage> [, <Variable WLangage à concaténer>])`
---

**`<Résultat> : (Entier)`**

Indice auquel l'élément spécifié a été ajouté. En cas d'erreur, une erreur fatale est affichée.

**`<Variable WLangage> : (Tableau ou Liste)`**

Nom de la variable à manipuler. Cette variable peut être :

- Une variable de type Tableau. 

- Une variable de type Liste. 
	




**`<Variable WLangage à concaténer> : (Tableau ou liste optionnel)`**

Nom de la variable à ajouter à la suite des éléments déjà présents. Cette variable peut être :

- Une variable de type Tableau, pour concaténer deux tableaux. Ce tableau doit être un tableau à une dimension.

- Une variable de type Liste, pour concaténer deux listes.  
	






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Ajout d'un élément dans un tableau WLangage
<a name="ajout_element_dans_tableau_wlangage_ELTPARAGRAPHE000161"></a>Lors de l'utilisation de la fonction **TableauAjoute** :

- le tableau est automatiquement agrandi pour accueillir le nouvel élément.

- l'élément est converti si nécessaire dans le type des autres éléments du tableau.




**Remarque** : Lors de la déclaration d'un tableau de N par M éléments, ce tableau contient N  éléments vides. Par exemple, le tableau déclaré ci-dessous contient 3 chaînes vides.

```wl
MonTableau est un tableau de 3 chaînes
```
Lors de l'ajout d'un élément (fonction **TableauAjoute**), cet élément est automatiquement ajouté à la suite des éléments déjà présents dans le tableau.
Dans notre exemple, l'élément ajouté correspondra au 4° élément.
<a name="NOTE0_2"></a>


### Ajout d'un élément dans une propriété tableau d'un type avancé
<a name="ajout_element_dans_une_propriete_tableau_type_avance_ELTPARAGRAPHE000186"></a>Lors de l'utilisation de la fonction **TableauAjoute** :

- la variable de type avancé doit être allouée.

- le type avancé doit avoir un énumérateur de type collection modifiable.

- le type avancé est automatiquement agrandi pour accueillir les nouveaux éléments.

- l'élément est initialisé avec la valeur passée en paramètre. Si aucune valeur n'est passée en paramètre, l'élément est initialisé avec la valeur par défaut du type des éléments du tableau.



<a name="NOTE0_3"></a>


### Ajout d'un élément dans une liste
<a name="ajout_element_dans_une_liste_ELTPARAGRAPHE000203"></a>Lors de l'utilisation de la fonction **TableauAjoute** :

- la liste est automatiquement agrandie pour accueillir le nouvel élément.

- l'élément est converti si nécessaire dans le type des autres éléments de la liste.



<a name="NOTE0_4"></a>


### Ajout d'un tableau dans un tableau (concaténation)
<a name="ajout_tableau_dans_tableau_concatenation_ELTPARAGRAPHE000222"></a>Lors de l'utilisation de la fonction **TableauAjoute** :

- le tableau est automatiquement agrandi pour accueillir les nouveaux éléments. Les éléments du &lt;Variable WLangage à concaténer&gt; sont ajoutés à la fin de &lt;Variable WLangage&gt;.

- les deux tableaux doivent être du même type.

- la dimension des tableaux doit être identique.

- les dimensions des tableaux (autres que la première dimension) doivent être identiques. 


Par exemple : 



- Code correct : 
	```wl
	t1 est un tableau de * par 2 entiers = [[1,2],[3,4]]
	t2 est un tableau de * par 2 entiers = [[5,6],[7,8],[9,10]]
	TableauAjoute(t1, t2)
	```


- Code incorrect : 
	```wl
	t1 est un tableau de * par 3 entiers = [[1,2],[3,4]]
	t2 est un tableau de * par 2 entiers = [[5,6],[7,8],[9,10]]
	TableauAjoute(t1, t2)
	```




<a name="NOTE0_5"></a>


### Ajout d'une liste dans une liste (concaténation)
<a name="ajout_une_liste_dans_une_liste_concatenation_ELTPARAGRAPHE000254"></a>Lors de l'utilisation de la fonction **TableauAjoute** :

- la liste est automatiquement agrandie pour accueillir les nouveaux éléments. Les éléments du &lt;Variable WLangage à concaténer&gt; sont ajoutés à la fin de &lt;Variable WLangage&gt;.

- les deux listes doivent être du même type.



<a name="NOTE0_5_1"></a>


### Ajouter le contenu d'une structure dans un tableau de structures sans passer par une variable de cette structure
<a name="ajouter_contenu_une_structure_dans_tableau_structures_sans_passer_par_une_variable_cette_structure_ELTPARAGRAPHE000273"></a>Si vous utilisez un tableau de structures avec peu de membres, il peut être plus simple d'ajouter directement une structure en utilisant l'opérateur [ ] (crochet). Par exemple, pour la structure suivante :

```wl
// Structure pour mémoriser une lettre et son code ASCII
STTouche est une Structure
	sTouche est une chaîne
	nCodeAscii est un entier
FIN
// Tableau de structures
tabTouches est un tableau de STTouche
```


L'ajout se fait généralement en passant par une variable du type de la structure :

```wl
// Structure temporaire pour l'ajout
stUneTouche est un STTouche
// Mémorise la lettre A
stUneTouche.sTouche = "A"
stUneTouche.nCodeAscii = Asc("A")
TableauAjoute(tabTouches, stUneTouche)
```


Avec l'opérateur [ ], vous pouvez gagner en visibilité :

```wl
// Mémorise la lettre A
TableauAjoute(tabTouches, ["A", Asc("A")])
```

<a name="NOTE0_6"></a>


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000306"></a>Cette fonction peut être utilisée avec des structures. Dans ce cas, il faut :

1. Déclarer une variable du type de la structure.

2. Initialiser chaque membre.

3. Passer la variable structure en paramètre à la fonction **TableauAjoute**.




Cette fonction ne peut pas être utilisée sur :

- les tableaux non alloués.

- les tableaux fixes.



<a name="NOTE0_7"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000327"></a>

- Pour ajouter un élément à une position donnée, utilisez la fonction [TableauInsère](../WDLang1/3075009.md) ou [Insère](../WDLang1/1000017351.md).

- Pour ajouter un élément dans un tableau trié (en respectant le tri), utilisez la fonction [TableauAjouteTrié](../WDLang1/1000017013.md).




<a name="XComposante"></a>

## Composante :
wd280vm.dll
