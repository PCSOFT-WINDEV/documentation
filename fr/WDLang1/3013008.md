


## ErreurInfo (Fonction)

***En anglais : ErrorInfo***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère des informations sur la dernière erreur d'une fonction d'une composante de WINDEV, WINDEV Mobile ou de WEBDEV.

**Attention** : 

- La fonction **ErreurInfo** doit être utilisée immédiatement après l'appel à la fonction qui a échoué. En effet, l'appel à une fonction du WLangage peut ré-initialiser et modifier le compte-rendu de la fonction **ErreurInfo**.

- La fonction **ErreurInfo** ne doit pas être utilisée pour vérifier si une erreur a été rencontrée. Pour vérifier si une fonction WLangage a échoué, il faut utiliser une des méthodes suivantes : 

	- tester le compte-rendu de la fonction WLangage. 

	- tester la variable [ErreurDétectée](../WDLang1/3087001.md). 








<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ouverture du fichier de présentation
nIDFichier est un entier = fOuvre(NomFichier, foLecture)
// Vérification de l'ouverture du fichier
SI nIDFichier = -1 ALORS
	Erreur("Impossible d'ouvrir le fichier : " + NomFichier, ErreurInfo())
	RENVOYER Faux
FIN
```


<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Erreur détectée ?
SI ErreurDétectée = Vrai ALORS
	// Message complet de l'erreur principale
	Trace(ErreurInfo())
	// Parcours des sous-erreurs (s'il y en a)
	POUR i = 1 _A_ ErreurInfo(errNombreSousErreur)
		// Message complet de chaque sous-erreur
		Trace("Sous-erreur " + i + " : " + ErreurInfo(errMessage, i))
	FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Obtenir des informations sur la dernière erreur

`<Résultat> = ErreurInfo([<Type information>])`
---

**`<Résultat> : (Chaîne de caractères ou entier)`**



- Information demandée. 

- Chaîne vide ("") si aucune erreur n'est survenue ou si l'information demandée n'est pas disponible.




**`<Type information> : (Constante optionnelle)`**

Information à renvoyer.


|   |   |
| --- | --- |
| *errCode* | Code de l'erreur<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée. |
| *errCodeSystème* | Numéro de l'erreur système (si elle existe)<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée. |
| *errComplet* | Toutes les informations de l'erreur (ligne de l'erreur, traitement en cours, ...).<br>**Remarque** : Renvoie les mêmes informations que celles récupérées lors d'un clic sur le bouton "Copier" dans la fenêtre d'erreur du WLangage. |
| *errDateHeure* | Date et heure de l'erreur<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée. |
| *errElément* | Nom de l'objet associé au traitement en cours lors de l'erreur.<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée. |
| *errFIC* | Nom complet du fichier de données (.FIC) associé à l'erreur.<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée. |
| *errFichier* | Nom logique du fichier associé à l'erreur.<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée. |
| *errInfo* | Informations complémentaires.<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée. |
| *errInfoDebug* | Informations spécifiques au débogage du problème rencontré. Ces informations ne doivent être affichées et communiquées qu'en cas de demande expresse de PC SOFT.<br>![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png) Dans le cas de l'exécution d'une requête par OLE DB, cette option permet de récupérer le code de la requête SQL réellement exécutée sur la base de données.<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante est ignorée. |
| *errLiaison* | Nom de la liaison associée à l'erreur.<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée. |
| *errLigne* | Numéro de la ligne de l'erreur.<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée. |
| *errMessage*<br>(valeur par défaut) | Message complet de l'erreur. |
| *errMessageSystème* | Message d'erreur système (si elle existe). |
| *errMMO* | Nom complet du fichier mémo (.MMO) associé à l'erreur.<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée. |
| *errNDX* | Nom complet du fichier d'index (.NDX) associé à l'erreur.<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée. |
| *errNombreSousErreur* | Nombre de sous-erreurs de l'erreur<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée. |
| *errNomCompletComposant* | Nom complet du composant en cours d'exécution. <br>Quelques exemples :<br><br>- "" (chaîne vide) : contexte principal de l'application.<br><br>- "Composant1" : Composant "Composant1" utilisé directement dans le projet.<br><br>- "Composant1.Composant2" : Composant "Composant2" utilisé depuis le "Composant1".<br><br><br><br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée. |
| *errNumEnr* | Numéro de l'enregistrement associé à l'erreur.<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée. |
| *errPendant* | Nom de la fonction WLangage qui a provoqué l'erreur.<br> |
| *errPile* | Pile des appels WLangage<br> |
| *errRésumé* | Résumé de l'erreur<br> |
| *errRubrique* | Nom de la rubrique associée à l'erreur.<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée. |
| *errTraitement* | Nom du traitement en cours lors de l'erreur.<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée. |
| *errWDD* | Nom complet du WDD associé à l'erreur.<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée. |






<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Obtenir des informations sur les sous-erreurs de la dernière erreur

`<Résultat> = ErreurInfo(<Type information> , <Indice de la sous-erreur>)`
---

**`<Résultat> : (Chaîne de caractères ou entier)`**



- Information demandée. 

- Chaîne vide ("") si aucune sous-erreur n'est survenue ou si l'information demandée n'est pas disponible.




**`<Type information> : (Constante)`**

Information à renvoyer.


|   |   |
| --- | --- |
| *errCode* | Code de la sous-erreur. |
| *errCodeSystème* | Numéro de la sous-erreur système (si elle existe). |
| *errComplet* | Toutes les informations de la sous-erreur (ligne de la sous-erreur, traitement en cours, ...). <br><br>**Remarque** : Renvoie les mêmes informations que celles récupérées lors d'un clic sur le bouton "Copier" dans la fenêtre d'erreur du WLangage. |
| *errDateHeure* | Date et heure de la sous-erreur. |
| *errElément* | Nom de l'objet associé au traitement en cours lors de la sous-erreur. |
| *errFIC* | Nom complet du fichier de données (.FIC) associé à la sous-erreur. |
| *errFichier* | Nom logique du fichier associé à la sous-erreur. |
| *errInfo* | Informations complémentaires. |
| *errInfoDébug* | Informations spécifiques au débogage du problème rencontré. Ces informations ne doivent être affichées et communiquées qu'en cas de demande expresse de PC SOFT.<br><br>![OLE DB](https://doc.pcsoft.fr/ext/images/fr/OLEDB.png) Dans le cas de l'exécution d'une requête par OLE DB, cette option permet de récupérer le code de la requête SQL réellement exécutée sur la base de données. |
| *errLiaison* | Nom de la liaison associée à la sous-erreur. |
| *errLigne* | Numéro de la ligne de la sous-erreur. |
| *errMessage*<br>(valeur par défaut) | Message complet de la sous-erreur. |
| *errMessageSystème* | Message d'erreur système (si elle existe). |
| *errMMO* | Nom complet du fichier mémo (MMO) associé à la sous-erreur. |
| *errNDX* | Nom complet du fichier d'index (.NDX) associé à la sous-erreur. |
| *errNumEnr* | Numéro de l'enregistrement associé à la sous-erreur. |
| *errPendant* | Nom de la fonction WLangage qui a provoqué la sous-erreur. |
| *errPile* | Pile des appels WLangage. |
| *errRésumé* | Résumé de la sous-erreur. |
| *errRubrique* | Nom de la rubrique associée à la sous-erreur. |
| *errTraitement* | Nom du traitement en cours lors de la sous-erreur. |
| *errWDD* | Nom complet du WDD associé à la sous-erreur. |



**`<Indice de la sous-erreur> : (Entier)`**

Indice de la sous-erreur à manipuler.

Rappel : Le nombre de sous-erreurs d'une erreur peut être connu grâce à la constante *errNombreSousErreur*.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Equivalence
<a name="equivalence_ELTPARAGRAPHE000414"></a>L'utilisation de la fonction [Erreur](../WDLang1/3021013.md) sans aucun paramètre permet d'afficher directement le message d'erreur correspondant à la dernière fonction WLangage ayant déclenché une erreur.

Dans ce cas, le code suivant :

```wl
Erreur()
```
est équivalent à :

```wl
Erreur(ErreurInfo())
```

<a name="NOTE0_2"></a>


### Erreur HFQL
<a name="erreur_hfql_ELTPARAGRAPHE000429"></a>Lors d'une erreur HFSQL, la fonction **ErreurInfo** est équivalente à la fonction [HErreurInfo](../WDLang4/3044071.md).

<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Erreur DDE
<a name="erreur_dde_ELTPARAGRAPHE000445"></a>Pour connaître les principaux codes des erreurs DDE, consultez [Codes d'erreur DDE](../WDLang1/3028012.md).

<a name="XComposante"></a>

## Composante :
wd280vm.dll
