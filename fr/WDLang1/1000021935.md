


## &lt;Table hiérarchique&gt;.ListeFils (Fonction)

***En anglais : &lt;TreeView Table&gt;.ListChild***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Liste les "fils" d'un noeud et les éléments "fils" de ces "fils" dans un champ Table hiérarchique. Une procédure du WLangage est appelée pour chaque "fils" trouvé.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Liste les "fils" du noeud "Desserts" dans le champ Table hiérarchique "TABLEH_RecetteTV"
// La procédure "DérouleTout" est appelée pour chaque "fils" trouvé du noeud "Desserts"
nNbDesserts est un entier 
nNbDesserts = TABLEH_RecetteTV.ListeFils("Recettes" + TAB + "Desserts", "DérouleTout")
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Lister les fils d'une branche identifiée par son chemin

`<Résultat> = <Champ Table hiérarchique>.ListeFils(<Nom de l'élément> , <Procédure WLangage> [, <Paramètre personnalisé>])`
---

**`<Résultat> : (Entier)`**

Nombre d'éléments listés.

**`<Champ Table hiérarchique> : (Nom de champ)`**

Nom du champ Table hiérarchique à manipuler.

**`<Nom de l'élément> : (Chaîne de caractères)`**

Nom de l'élément à manipuler. Ce paramètre est de la forme :

```txt
"<Nom de la racine>" + TAB + ["<Nom du 1er noeud>" + TAB + ...
["<Nom du 2ème noeud>" + TAB + [...]]]"<Nom de l'élément>"
```
Si ce paramètre ne correspond pas à un élément existant, une erreur WLangage est générée.

**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure WLangage appelée chaque fois qu'un élément "fils" est trouvé.

**`<Paramètre personnalisé> : (Entier optionnel)`**

Paramètre passé à la procédure &lt;Nom de la procédure&gt;.


<a name="SYNTAXE2"></a>

### Lister les fils d'une branche identifiée par son indice

`<Résultat> = <Champ Table hiérarchique>.ListeFils(<Numéro de la ligne> , <Procédure WLangage> [, <Paramètre personnalisé>])`
---

**`<Résultat> : (Entier)`**

Nombre d'éléments listés.

**`<Champ Table hiérarchique> : (Nom de champ)`**

Nom du champ Table hiérarchique à manipuler.

**`<Numéro de la ligne> : (Entier)`**

Numéro de la ligne correspondant à la branche à manipuler.

**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure WLangage appelée chaque fois qu'un élément "fils" est trouvé.

**`<Paramètre personnalisé> : (Entier optionnel)`**

Paramètre passé à la procédure &lt;Procédure WLangage&gt;.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Procédure WLangage
<a name="procedure_wlangage_ELTPARAGRAPHE000226"></a>La procédure &lt;Procédure WLangage&gt; est appelée pour chaque élément "fils" trouvé. Cette procédure est une procédure du WLangage. 

Cette procédure doit être déclarée de la manière suivante :

```txt
PROCEDURE <Procédure WLangage> (<Champ Table hiérarchique>, <Branche du fils>,.. 
	<Élément>, <Niveau>, <Paramètre optionnel>)
```
Les différents paramètres sont les suivants : 

- &lt;Champ Table hiérarchique&gt; (chaîne de caractères) : 
	Nom du champ Table hiérarchique à manipuler.

- &lt;Branche du fils&gt; (chaîne de caractères) : 
	Chemin complet du "fils" trouvé (sans le nom) ou une chaîne vide ("") s'il s'agit de la racine du champ Table hiérarchique. Ce paramètre contient toujours l'élément séparateur "TAB" à la fin. Ce paramètre sera initialisé et renseigné à chaque appel de la procédure. 

- &lt;Élément&gt; (chaîne de caractères) : 
	Nom de l'élément trouvé. Ce paramètre sera initialisé et renseigné à chaque appel de la procédure.

- &lt;Niveau&gt; (entier) : 
	Niveau de l'élément trouvé par rapport à l'élément initial de recherche :
	1. Fils direct
	2. Petit-fils
	3.  ...

- &lt;Paramètre optionnel&gt; (entier) : 
	Valeur passée dans le paramètre &lt;Paramètre personnalisé&gt; de la fonction **&lt;Table hiérarchique&gt;.ListeFils**. Si le paramètre &lt;Paramètre personnalisé&gt; n'est pas précisé, &lt;Paramètre personnalisé&gt; correspond à la constante *NULL*.




Remarque : Cette procédure peut être une [procédure interne](../Motscles/1514075.md).


### Interruption de la fonction &lt;Table hiérarchique&gt;.ListeFils
<a name="interruption_fonction_docparampagetitleshort_ELTPARAGRAPHE000270"></a>La fonction **&lt;Table hiérarchique&gt;.ListeFils** ne peut pas être interrompue tant qu'il reste des éléments "fils" à parcourir.

Pour forcer l'interruption du parcours effectué par la fonction **&lt;Table hiérarchique&gt;.ListeFils**, utilisez la ligne suivante dans la procédure &lt;Procédure WLangage&gt; :

```wl
RENVOYER Faux
```
Dans ce cas, la fonction **&lt;Table hiérarchique&gt;.ListeFils** retourne le nombre d'éléments parcourus jusqu'à l'appel de "RENVOYER Faux".

<a name="XComposante"></a>

## Composante :
wd280obj.dll
