
## ChampExécuteFermeture (Fonction)

***En anglais : ControlExecuteClosing***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Exécute l'événement WLangage de fermeture d'un champ bureautique et affiche son dialogue de confirmation si nécessaire. 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Clic sur le bouton VALIDER
SI PAS ChampExécuteFermeture(TBLR_Tableur) ALORS
	RETOUR
FIN
Ferme()
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = ChampExécuteFermeture(<Champ bureautique>)`
---

**`<Résultat> : (Booléen)`**



- Si l'événement WLangage de fermeture du champ renvoie une valeur (<u><u><u><u>Vrai</u></u></u></u> ou <u><u><u><u>Faux</u></u></u></u>), &lt;Résultat&gt; correspond à cette valeur. 

- Si l'événement WLangage de fermeture du champ ne renvoie pas de valeur : 

	- si la propriété [Modifié](../Proprietes/2510080.md) sur le champ est à <u><u><u><u>Vrai</u></u></u></u>, un dialogue de confirmation est affiché : &lt;Résultat&gt; vaut <u><u><u><u>Faux</u></u></u></u> si l'utilisateur demande la non-fermeture du document, <u><u><u><u>Vrai</u></u></u></u> dans le cas contraire.  

	- si la propriété [Modifié](../Proprietes/2510080.md) sur le champ est à <u><u><u><u>Faux</u></u></u></u>, la fonction renvoie <u><u><u><u>Vrai</u></u></u></u>. 







**`<Champ bureautique> : (Nom de champ)`**

Nom du champ bureautique à manipuler. Ce champ peut correspondre à : 

- un champ Tableur, 

- un champ Traitement de texte, 

- un champ Editeur d'images, 

- un champ Lecteur PDF. 






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Cette fonction est appelée automatiquement par le ruban des champs bureautique (champs Tableur, Traitement de texte, Editeur d'images ou Lecteur PDF) sur les actions utilisateur suivantes :

	- Nouveau.

	- Ouvrir.

	- Drag and Drop d'un document vers le champ.




- Cette fonction réalise les opération suivantes : 

	- Exécution de l'événement "Avant fermeture du document".

	- Si cet événement renvoie une valeur (<u><u><u><u>Vrai</u></u></u></u> ou <u><u><u><u>Faux</u></u></u></u>), la fonction s'arrête et renvoie cette valeur. 

	- Si cet événement ne renvoie pas de valeur : 

		- si la propriété [Modifié](../Proprietes/2510080.md) sur le champ est à <u><u><u><u>Vrai</u></u></u></u>, la fonction affiche un dialogue de confirmation à l'utilisateur et renvoie <u><u><u><u>Faux</u></u></u></u> si l'utilisateur demande la non-fermeture du document. 

		- si la propriété [Modifié](../Proprietes/2510080.md) sur le champ est à <u><u><u><u>Faux</u></u></u></u>, la fonction renvoie <u><u><u><u>Vrai</u></u></u></u>. 




- Cette fonction peut par exemple être appelée en fermeture de fenêtre ou avant l'affectation du champ avec un nouveau contenu.

- Pour afficher uniquement le dialogue de confirmation, utilisez le code suivant : 
	
	```wl
	bFermeOK = FAAExécute(TBLR_Tableur, faaDialogueFermeture)
	```


- Pour exécuter uniquement l'événement WLangage de fermeture de document, utilisez le code suivant : 
	
	```wl
	ExécuteTraitement(TBLR_Tableur, trtAvantFermetureDocument)
	```







<a name="XComposante"></a>

## Composante :
wd280obj.dll
