
## Val (Fonction)

***En anglais : Val***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie la valeur numérique d'une chaîne de caractères. Il est ainsi possible d'effectuer des calculs numériques sur des chaînes de caractères.

Remarque : Cette fonction est identique à la fonction [ChaîneVersNumérique](../WDLang1/1410087852.md). 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
Val("143")    // Renvoie 143
Val("1.67")   // Renvoie 1.67
Val("ABC")    // Renvoie 0
Val("3plus2") // Renvoie 3
Val("7,5")    // Renvoie 7
Val("1D2")    // Renvoie 100
Val("2.5e-2") // Renvoie 0.025
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = Val(<Chaîne initiale> [, <Base utilisée>])`
---

**`<Résultat> : (Réel ou entier)`**



- Valeur numérique de la chaîne.

- 0 en cas d'erreur.




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Dans cette version, &lt;Résultat&gt; correspond à un réel.

**`<Chaîne initiale> : (Chaîne de caractères ou Buffer)`**

Chaîne de caractères à convertir en valeur numérique. 
Pour un réel, le séparateur doit être le point '.' et les préfixes de notation scientifique peuvent être 'E', 'e', 'D' ou 'd'. Si le séparateur est une virgule, les chiffres présents après la virgule ne seront pas pris en compte.

Ce paramètre peut également être un buffer. Dans ce cas, le traitement du buffer varie en fonction de l'option sélectionnée dans l'onglet "Unicode" de la description de la configuration : 

- si l'option "Utiliser des chaines ANSI en exécution" est sélectionnée, le buffer sera traité comme une chaîne ANSI.

- si l'option "Utiliser des chaînes UNICODE en exécution" est sélectionnée, le buffer sera traité comme une chaîne ANSI ou UNICODE selon son contenu.




**`<Base utilisée> : (Chaîne de caractères ou entier (optionnel))`**

Base dans laquelle est représenté le chiffre. Les valeurs possibles sont les suivantes :

- "d" : base 10 (décimal)

- "x" : base 16 (hexadécimal)

- "o" : base 8 (octal)

- un entier compris entre 2 et 36




Par défaut, la base 10 est utilisée.

![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Ce paramètre n'est pas disponible. La base 10 est automatiquement utilisée.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Plage de conversion
<a name="plage_conversion_ELTPARAGRAPHE000118"></a>La conversion d'une chaîne en entier avec la fonction **Val** est réalisée si la valeur est comprise entre -9.223.372.036.854.775.808 et 9.223.372.036.854.775.807.
<a name="NOTE0_2"></a>


### Fonction Val et UNICODE
<a name="fonction_val_unicode_ELTPARAGRAPHE000130"></a>Le paramètre &lt;Chaîne initiale&gt; peut être au format ANSI ou au format UNICODE.

Pour plus de détails sur l'UNICODE, consultez [Gestion de l'UNICODE](../WDLang1/3024038.md).
<a name="NOTE0_3"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000144"></a>Dès qu'un caractère de &lt;Chaîne initiale&gt; ne peut pas constituer un nombre, la fonction **Val** arrête d'interpréter &lt;Chaîne initiale&gt; et retourne le nombre correspondant aux caractères déjà lus.

Les réels ne sont convertibles qu'à partir de la base 10. Dans les autres bases, les caractères situés après le "." (point) ne seront pas pris en compte.


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LafonctionVal.gif) ***Exemples unitaires (WINDEV)*** : **La fonction Val** <br>Utilisation de la fonction WLangage "Val" avec des bases différentes.<br>Par exemple, elle vous permet de récupérer la valeur décimale d'une chaîne au format Hexadécimal.



<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280vm.dll
