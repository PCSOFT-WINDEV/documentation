


## TâcheGantt (Type de variable)

***En anglais : TaskGantt***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **TâcheGantt** permet de définir toutes les caractéristiques avancées d'une tâche pour un Diagramme de Gantt. Les caractéristiques de cette tâche peuvent être définies et modifiées à l'aide de différentes propriétés WLangage. 

**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
NouvelleTâche1 est une TâcheGantt
NouvelleTâche1.ID = "ID1"
NouvelleTâche1.DuréeEnHeure = 0.10
NouvelleTâche1.Titre = "Ouverture de la trappe"

NouvelleTâche2 est une TâcheGantt
NouvelleTâche2.ID = 2
NouvelleTâche2.DuréeEnHeure = 2.5
NouvelleTâche2.Titre = "Lancement de la fusée"

// Ajoute la première tâche
GanttAjouteTâche(COL_Gantt, NouvelleTâche1)

// Ajoute la tâche au champ Table en créant une nouvelle ligne
TableAjouteLigne(TABLE_Exemple, NouvelleTâche2)

// Réorganise les tâches dans la colonne de type Diagramme de Gantt
GanttOrganiseTâche(COL_Gantt)
```

<a name="NOTE0"></a>

## Remarques
<a name="NOTE0_1"></a>


### Propriétés spécifiques à la description des variables de type TâcheGantt
<a name="proprietes_specifiques_description_des_variables_type_tachegantt_ELTPARAGRAPHE000028"></a>Les propriétés suivantes peuvent être utilisées pour manipuler une tâche d'un Diagramme de Gantt :

| **Nom de la propriété** | **Type manipulé** | **Effet** |
| --- | --- | --- |
| Avancement | Entier | Pourcentage d'avancement de la tâche (compris entre 0 et 100). |
| Bulle | Chaîne de caractères | Texte de la bulle d'aide affichée sur la tâche. <br><br>Par défaut, cette propriété correspond à une chaîne vide (""). |
| CouleurAvancement | Entier | Couleur utilisée pour remplir la jauge d'avancement de la tâche. Cette propriété est prise en compte uniquement si la propriété **Avancement** est différente de 0. <br><br>Cette couleur peut correspondre à :<br><br>- une couleur RVB (obtenue avec la fonction [RVB](../WDLang1/3029012.md)),<br><br>- une couleur TSL (obtenue avec la fonction [TSL](../WDLang1/3029057.md)),<br><br>- une couleur prédéfinie (voir les [couleurs prédéfinies du WLangage](../WDLang5/3010002.md)).<br><br><br> |
| CouleurFond | Entier | Couleur de fond utilisée pour l'affichage de la tâche dans la colonne de type Diagramme de Gantt.<br><br>Cette couleur peut correspondre à :<br><br>- une couleur RVB (obtenue avec la fonction [RVB](../WDLang1/3029012.md)),<br><br>- une couleur TSL (obtenue avec la fonction [TSL](../WDLang1/3029057.md)),<br><br>- une couleur prédéfinie (voir les [couleurs prédéfinies du WLangage](../WDLang5/3010002.md)).<br><br><br><br><br> |
| Cumulative | Booléen | Gestion des tâches cumulatives : <br><br>- <u><u><u><u>Vrai</u></u></u></u> : la tâche est cumulative. La tâche possède un marqueur "flèche" en début et fin. Ce type de tâche est utilisé pour symboliser l'avancement global de plusieurs tâches subordonnées.<br><br>- <u><u><u><u>Faux</u></u></u></u> : la tâche n'est pas cumulative.<br><br><br> |
| DateDébut | Chaîne de caractères ou variable de type DateHeure | Date et heure de début de la tâche.<br><br>Si cette propriété n'est pas précisée, le début de la tâche correspond à la date et à l'heure système. |
| DateFin | Chaîne de caractères ou variable de type DateHeure | Date et heure de fin de la tâche. <br><br>Cette propriété est disponible en lecture seulement. Elle est automatiquement calculée en tenant compte de la durée spécifiée (en jours ou en heures), des jours ouvrables et des heures ouvrables. <br><br>Par exemple, si une tâche dure 24 heures et si les heures ouvrables sont définies de 8 heures à 20 heures, la tâche aura une durée de 2 jours dans le Diagramme de Gantt. |
| DuréeEnHeure | Réel, entier ou numérique | Durée de la tâche exprimée en heures ouvrables. Dans ce cas, la date de fin (propriété **DateFin**) est calculée en tenant compte des heures ouvrables.<br><br>**Il est obligatoire de préciser une durée.** <br><br>Si la propriété **DuréeEnHeure** est précisée, la propriété **DuréeEnJour** ne doit pas être indiquée. |
| DuréeEnJour | Réel, entier ou numérique | Durée de la tâche exprimée en jours ouvrables. Dans ce cas, la date de fin (propriété **DateFin**) est calculée en tenant compte des jours ouvrables.<br><br>**Il est obligatoire de préciser une durée.** <br><br>Si la propriété **DuréeEnJour** est précisée, la propriété **DuréeEnHeure** ne doit pas être indiquée. |
| ID | Chaîne de caractères | Numéro identifiant la tâche.<br><br>**Cette propriété est obligatoire.** |
| Image | Image | Image affichée dans la tâche (si la tâche utilise la fenêtre interne personnalisée, FI_WinDevVueTacheGantt). Cette propriété peut correspondre :<br><br>- au chemin vers une image accessible depuis le poste en cours,<br><br>- à un fichier image présent dans la bibliothèque de l'application,<br><br>- à un champ Image contenant une image,<br><br>- à un dessin réalisé dans un champ Image grâce aux fonctions de dessin et sauvegardé en mémoire.<br><br><br> |
| Jalon | Booléen | Gestion des tâches Jalon : <br><br>- <u><u><u><u>Vrai</u></u></u></u> : la tâche est une tâche Jalon. Une tâche jalon est un repère qui permet de symboliser un événement important, une échéance intermédiaire. Une tâche jalon est représentée par un losange et n'a pas de durée ni d'avancement.<br><br>- <u><u><u><u>Faux</u></u></u></u> : la tâche n'est pas une tâche Jalon.<br><br><br> |
| Ligne | Entier | Numéro de ligne du champ Table où la tâche doit être affichée. |
| Responsable | Chaîne de caractères | Responsable de la tâche. Cette information n'est pas affichée dans le diagramme de Gantt. |
| Titre | Chaîne de caractères | Nom de la tâche. Ce nom est affiché à droite de la tâche. |


<a name="NOTE0_2"></a>


### Utilisation des variables de type TâcheGantt
<a name="utilisation_des_variables_type_tachegantt_ELTPARAGRAPHE000207"></a>

Les variables de type **TâcheGantt** sont utilisées par les fonctions suivantes : 



|   |   |
| --- | --- |
| [GanttAjouteTâche](../WDLang1/1000020904.md) | Ajoute une tâche dans une colonne d'un champ Table (ou Table hiérarchique) de type Diagramme de Gantt. |
| [GanttListeTâche](../WDLang1/1000021073.md) | Renvoie : <br><br>- la liste des tâches comprises entre deux dates données dans une colonne de type Diagramme de Gantt, <br><br>- toutes les tâches d'une colonne de type Diagramme de Gantt,<br><br>- une tâche spécifique (sélectionnée ou survolée). <br><br><br> |
| [GanttRécupèreTâche](../WDLang1/1000021026.md) | Récupère une tâche à partir de son identifiant dans une colonne (d'un champ Table ou Table hiérarchique) de type Diagramme de Gantt. |






- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDGantt.gif) ***Exemples complets (WINDEV)*** : **WD Gantt** <br>L'exemple "WD Gantt" présente une utilisation avancée du champ Diagramme de Gantt.<br>Cet exemple permet de créer un diagramme de Gantt complet avec tâches, liaisons, tâches cumulatives et jalons.<br>Les tâches peuvent être éditées dans une fenêtre spécifique.<br>Le diagramme créé peut être sauvegardé dans un fichier pour être rechargé par la suite.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampGantt.gif) ***Exemples unitaires (WINDEV)*** : **Le champ Gantt** <br>Utilisation d'un champ Diagramme de Gantt


