


## TâcheParallèleExécute (Fonction)

***En anglais : ParallelTaskExecute***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Déclenche l'exécution d'une tâche parallèle.

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000021588&name=tacheparalleleexecute_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Utilisation de la syntaxe 1 
t1 est une TâcheParallèle = TâcheParallèleExécute(ProcédureA, (), tpoThreadPrincipal)
```

```wl
// Utilisation de la syntaxe 2 
t1 est une TâcheParallèle
t1.Procédure = Procédure3
t2 est une TâcheParallèle = TâcheParallèleExécute(t1)
```

```wl
// Utilisation de la syntaxe 3 
t3 est une Description de TâcheParallèle
t3.Procédure = Procédure3
TâcheParallèleExécute(t3)
```

```wl
// Utilisation de la syntaxe 3 
t3bis est une Description de TâcheParallèle
t3bis.Procédure = Procédure3bis
t3bis.Paramètre[1] = DateDuJour()
t3bis.Paramètre[2] = HeureSys()
TâcheParallèleExécute(t3bis)
```

```wl
// Déclaration de plusieurs tâches et exécution d'un traitement à la fin de toutes ces tâches
MaDescriptionTâche est une Description de TâcheParallèle
tabMesTâches est un tableau de TâcheParallèle // Résultat des fonctions tâches parallèles 
// Tâche N°1
MaDescriptionTâche.Procédure = Exemple2_Etape1
// Exécute les tâches parallèles
// On ajoute la tâche renvoyée à un tableau de tâches 
// pour pouvoir les réutiliser dans la fonction TâcheParallèleExécuteAprèsToutes
Ajoute(tabMesTâches, TâcheParallèleExécute(MaDescriptionTâche))
// Tâche N°2
MaDescriptionTâche.Procédure = Exemple2_Etape2
Ajoute(tabMesTâches, TâcheParallèleExécute(MaDescriptionTâche))
// On donne la procédure à exécuter une fois que 
// toutes les tâches contenues dans le tableau tabMesTâches sont terminées
TâcheParallèleExécuteAprèsToutes(tabMesTâches, Exemple2_Fin, (), tpoThreadPrincipal)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Exécuter une tâche parallèle

`<Résultat> = TâcheParallèleExécute(<Procédure> [, <Paramètres> [, <Options>]])`
---

**`<Résultat> : (Variable de type TâcheParallèle)`**

Variable de type [TâcheParallèle](../WDLang1/1000021220.md) correspondant à la tâche à exécuter.

**`<Procédure> : (Chaîne de caractères ou variable de type Procédure)`**

Procédure à exécuter. Ce paramètre peut correspondre : 

- au nom de la procédure à exécuter. 

- au nom de la variable de type [Procédure](../Motscles/1000018907.md) correspondant à la procédure à exécuter.




**`<Paramètres> : (Liste de valeurs entre parenthèses et séparées par des virgules)`**

Paramètres de la procédure à exécuter. Cette liste de paramètres est de la forme :

```txt
(<Paramètre 1>, ..., <Paramètre N>)
```
où : 

- &lt;Paramètre 1&gt; : Premier paramètre de la procédure.

- ...

- &lt;Paramètre N&gt; : Nième paramètre de la procédure.




**Attention** : Les paramètres sont passés par valeur. Dans le cas de variables de types complexes (tableaux, objet), la valeur est l'élément lui-même. Pour protéger l'accès à cette variable, il est possible d'utiliser une des solutions suivantes : 

- faire une copie de la variable (avec le mot clé LOCAL), 

- utiliser des sections critiques (avec la fonction WLangage [SectionCritiqueDebut](../WDLang1/3077001.md) ou l'attribut &lt;section critique&gt;)




**`<Options> : (Constante ou combinaison de constantes optionnelle de type Entier)`**

Options de la tâche à exécuter :


|   |   |
| --- | --- |
| *tpoCopieComplèteContexteHFSQL* | Provoque la copie immédiate du contexte HFSQL courant.<br>Conseillé par exemple si la tâche parallèle doit tenir compte des positions en cours dans les fichiers et requêtes du contexte de l'appelant. |
| *tpoCopieDifféréeContexteHFSQL*<br>(Valeur par défaut) | Provoque une copie légère du contexte HFSQL **lors du premier accès aux données HFSQL**. |
| *tpoCopieLégèreContexteHFSQL* | Provoque la copie immédiate d'une partie du contexte HFSQL courant. <br>Seuls les répertoires où se trouvent les fichiers de données en HFSQL Classic et/ou les connexions en HFSQL Client/Serveur sont mémorisés. |
| *tpoThreadPrincipal* | Exécute la tâche dans le thread principal.<br>Cette constante peut être combinée avec une des autres constantes. <br>Attention : Cette constante ne peut pas être utilisée pour exécuter une tâche parallèle dans le thread principal depuis le thread principal.<br><br> |


Remarque : Pour savoir quel type de copie choisir, consultez le [comparatif des différents modes de copie](#NOTE0_1). 


<a name="SYNTAXE2"></a>

### Exécuter une tâche parallèle déjà décrite (variable de type TâcheParallèle)

`<Résultat> = TâcheParallèleExécute(<Tâche>)`
---

**`<Résultat> : (Variable de type TâcheParallèle)`**

Variable de type [TâcheParallèle](../WDLang1/1000021220.md) correspondant à la tâche exécutée.

**`<Tâche> : (Variable de type TâcheParallèle)`**

Nom de la variable de type [TâcheParallèle](../WDLang1/1000021220.md) correspondant à la tâche à exécuter. 

Attention : Si la tâche est déjà en cours d'exécution ou a déjà été exécutée, une erreur WLangage sera provoquée.


<a name="SYNTAXE3"></a>

### Exécuter une tâche parallèle connue par sa description (variable de type Description de TâcheParallèle)

`<Résultat> = TâcheParallèleExécute(<Description tâche>)`
---

**`<Résultat> : (Variable de type TâcheParallèle)`**

Variable de type [TâcheParallèle](../WDLang1/1000021220.md) correspondant à la tâche exécutée.

**`<Description tâche> : (Variable de type Description de TâcheParallèle)`**

Nom de la variable de type [Description de TâcheParallèle](../WDLang1/1000021586.md) décrivant la tâche à exécuter. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- La tâche est enregistrée dans la file d'attente des tâches à exécuter. 

- La fonction **TâcheParallèleExécute** n'est pas bloquante et n'attend pas la fin de la tâche.

- Comparatif des différents types de copie du contexte HFSQL : 
	

| Type de copie | Avantages | Inconvénients |
| --- | --- | --- |
| **Copie complète** | Copie : <br><br>	- les paramètres de connexion au sens large (connexions, chemins physiques, ...).<br><br>	- les positions, les filtres, ... définis sur les fichiers de données.<br><br>	- les requêtes. <br><br><br> | Consommation mémoire (sur le client et sur le serveur). |
| **Copie légère** | Copie les paramètres de connexion au sens large (connexions, chemins physiques, ...).<br><br>Pas de consommation mémoire sur le poste Serveur. | Les enregistrements et les filtres en cours ne sont pas copiés. Il est donc nécessaire de repositionner les enregistrements par la fonction HLitRecherche par exemple. <br><br>Pas de copie des requêtes. <br><br>Consommation mémoire sur le poste Client |
| **Copie différée** | Pas de consommation mémoire (sur le client et sur le serveur). | Risque : Si les paramètres de connexion au sens large sont modifiés, la dernière modification sera prise en compte. <br><br>Les enregistrements et les filtres en cours ne sont pas copiés. Il est donc nécessaire de repositionner les enregistrements par la fonction HLitRecherche par exemple. <br><br>Pas de copie des requêtes. |





En règle générale, la copie différée est conseillée à condition de ne pas changer les paramètres de connexion et de refaire les **HLitRecherche** nécessaires. 


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Utilisationdestachesparalleles.gif) ***Exemples unitaires (WINDEV)*** : **Utilisation des tâches parallèles** <br>Les tâches parallèles permettent notamment d’accélérer les temps de traitement et d'améliorer la réactivité d’une application.<br>Cet exemple présente les fonctions et types de variables nécessaires à l'utilisation des tâches parallèles :<br>- exécution de tâches parallèles,<br>- interaction avec les champs,<br>- tâches de continuation.

<a name="XComposante"></a>

## Composante :
wd280vm.dll
