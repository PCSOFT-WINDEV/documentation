
## fCompacte (Fonction)

***En anglais : fCompress***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Compresse un fichier. Ce fichier peut être décompressé avec la fonction [fDécompacte](../WDLang1/3036021.md).

**Remarque** : Les fichiers de petites tailles ont peu de chance d'être compactés.

**Rappel** : Les fonctions d'archivage ([fonctions zipxxx](../WDLang3/3082006.md)) permettent de gérer des archives au format ZIP, CAB, 7z, ...




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003036016&name=fcompacte_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Compression d'un fichier
Res = fCompacte("C:\Répertoires\Fichier.txt", "C:\Répertoires\FichierCompressé.txt")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = fCompacte(<Chemin du fichier à compresser> , <Chemin du fichier compressé>)`
---

**`<Résultat> : (Entier)`**



- 0 si la compression a été effectuée, 

- un code d'erreur (valeur supérieure à 0) dans le cas contraire.




**`<Chemin du fichier à compresser> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier à compresser (260 caractères maximum). Un chemin de type UNC peut être utilisé.

**`<Chemin du fichier compressé> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier compressé (260 caractères maximum). Un chemin de type UNC peut être utilisé.





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Codes d'erreur
<a name="codes_erreur_ELTPARAGRAPHE000065"></a>Les codes d'erreur retournés sont les suivants :

- 1 : Le fichier à compresser ne peut pas être ouvert.

- 2 : Impossible de créer le fichier compressé. Cette erreur est générée si le répertoire du &lt;Chemin du fichier compressé&gt; n'existe pas.

- 4 : Le fichier ne peut pas être compressé : le fichier est simplement copié (par exemple, la taille du fichier à compacter est trop petite).

- 5 : Pas assez de mémoire disponible pour effectuer la compression.

- 6 : La compression a été abandonnée par l'utilisateur : la fonction [fStopCompacte](../WDLang1/3036057.md) a été exécutée.

- 7 : Pas assez de place disponible pour créer le fichier compressé.




Le message correspondant au code d'erreur peut être connu grâce à la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.


<a name="NOTE0_2"></a>
<a name="NOTE0_3"></a>




### Jauge
<a name="jauge_ELTPARAGRAPHE000096"></a>Pour visualiser la progression de la compression du fichier, utilisez la fonction [Evénement](../WDLang1/3015011.md) pour traiter le message <u><u><u><u>JaugeCompactage</u></u></u></u> (1174). A la réception de ce message, la variable _EVE.wParam contient le pourcentage de compression du fichier.



<a name="XComposante"></a>

## Composante :
wd280std.dll
