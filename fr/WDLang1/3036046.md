


## fSauveTexte (Fonction)

***En anglais : fSaveText***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Crée et remplit un fichier texte avec le contenu d'un champ texte ou d'une variable texte (variable de type chaîne, champ de saisie d'une fenêtre, champ Libellé d'un état, ...). Si le fichier existe déjà, il est supprimé, puis recréé.

**Remarque** : Les chaînes contenant des "0" binaires ("\\0") sont supportées.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Remplit le fichier avec le contenu d'une variable
MaChaîneTexte est une chaîne = "Ceci est un test" + RC + "Utilisation de fSauveTexte"
fSauveTexte("C:\Temp\MonFichier.txt", MaChaîneTexte)

// Remplit le fichier avec le contenu d'un champ
// SAI_NOM_PRENOM est un champ de saisie
fSauveTexte("C:\Clients\NomPrenom.txt", SAI_NOM_PRENOM)

// Effectue une copie de fichier en remplaçant "Franc" par "Euro"
ContenuFichier est une chaîne
ContenuFichier = fChargeTexte("C:\Soldes\PrixFrancs.txt")
ContenuFichier = Remplace(ContenuFichier, "Franc", "Euro")
fSauveTexte("C:\Soldes\PrixEuros.txt", ContenuFichier)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = fSauveTexte(<Nom et chemin du fichier texte> , <Contenu>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a réussi, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Nom et chemin du fichier texte> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier texte à créer. Il est possible d'utiliser un chemin UNC.
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.

**`<Contenu> : (Chaîne de caractères)`**

Chaîne constituant le contenu du fichier.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png) 

### Fonctionnement sous Windows Vista (et supérieur)
<a name="fonctionnement_sous_windows_vista_superieur_ELTPARAGRAPHE000247"></a>Si cette fonction ne fonctionne pas correctement sous Windows Vista (et supérieur), il est nécessaire de vérifier si le fichier ou le répertoire manipulé ne se trouve pas dans un des répertoires système (répertoire de Windows ou répertoire "Program Files").

**En effet, sous Windows Vista (et supérieur), avec le [mécanisme de l'UAC](../Editeurs/2025014.md) (contrôle des comptes utilisateurs) activé**, il est nécessaire d'avoir les privilèges administrateur pour manipuler / modifier des fichiers ou des répertoires présents dans les répertoires système (répertoire de Windows ou répertoire "Program Files").

**Conseil de programmation** : Si vous devez manipuler / modifier des fichiers ou des répertoires, sans avoir besoin de privilèges administrateur, il est conseillé :

- de ne pas écrire dans le répertoire de Windows ou dans le répertoire "Program Files",

- d'utiliser le répertoire système correspondant à l'application (connu par la fonction [SysRep](../WDLang1/3073026.md) par exemple avec la constante *srAppDataCommun*).


**Remarque** : Sous Windows Vista (ou supérieur), le mécanisme de la virtualisation permet de rendre les applications compatibles Vista. Si le fichier est créé dans un répertoire système sans avoir les droits nécessaires, ce fichier sera réellement créé dans un autre répertoire (C:\\Users\\&lt;LOGIN&gt;AppData\\Local\\VirtualStore\\Windows\\). Dans ce cas, le fichier ne pourra pas être partagé entre plusieurs applications.
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Equivalence
<a name="equivalence_ELTPARAGRAPHE000120"></a>La fonction **fSauveTexte** est équivalente au code suivant :

```wl
// Ouvre le fichier en lecture
f est un entier = fOuvre("C:\MonFichier.txt", foCreation)
// Ecrit dans le fichier
ContenuFichier est une chaîne = "exemple de texte"
fEcrit(f, ContenuFichier)
// Ferme le fichier
fFerme(f)
```


<a name="XComposante"></a>

## Composante :
wd280std.dll
