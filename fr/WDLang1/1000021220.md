
## TâcheParallèle (Type de variable)

***En anglais : ParallelTask***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **TâcheParallèle** permet de manipuler une tâche, c'est-à-dire une procédure exécutée par un thread dans le cadre de la programmation parallèle. 

**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Déclare une variable pour manipuler une tâche parallèle
t est une TâcheParallèle
// Construit une tâche parallèle et déclenche son exécution sur une procédure
t = TâcheParallèleExécute(Proc, ("Premier paramètre", 2))
```



```wl
// Construit une tâche parallèle 
t est une TâcheParallèle(Proc, ("Premier paramètre", 2))
// Déclenche l'exécution de la tâche parallèle
TâcheParallèleExécute(t)
```



```wl
// Décrit une tâche parallèle
d est une Description de TâcheParallèle
d.Procédure = Proc
d.Paramètre[1] = "Premier paramètre"
d.Paramètre[2] = 2
// Construit une tâche parallèle et déclenche son exécution
t est une TâcheParallèle = TâcheParallèleExécute(d)
```





## Déclaration
<a name="declaration_ELTTEXTE000307"></a>
<a name="SYNTAXE1"></a>

### Déclarer une tâche parallèle non décrite

`MaVariable est une TâcheParallèle`
---

Dans ce cas, la tâche n'est pas décrite. La variable devra être affectée avec une tâche existante ou avec le résultat d'une des fonctions d'exécution des tâches parallèles.


<a name="SYNTAXE2"></a>

### Décrire une tâche parallèle via le type TâcheParallèle

`MaVariable est une TâcheParallèle(<Procédure> [, <Paramètres> [, <Options>]])`
---

**`<Procédure> : (Chaîne de caractères ou variable de type Procédure)`**

Procédure à exécuter. Ce paramètre peut correspondre : 

- au nom de la procédure à exécuter. 

- au nom de la variable de type [Procédure](../Motscles/1000018907.md) correspondant à la procédure à exécuter.




**`<Paramètres> : (Liste de valeurs entre parenthèses et séparées par des virgules)`**

Paramètres de la procédure à exécuter. Cette liste de paramètres est de la forme : 

```txt
(<Paramètre 1>, ..., <Paramètre N>)
```
où : 

- &lt;Paramètre 1&gt; : Premier paramètre de la procédure.

- ...

- &lt;Paramètre N&gt; : Nième paramètre de la procédure.




**`<Options> : (Constante optionnelle de type Entier)`**

Options de la tâche à exécuter :


|   |   |
| --- | --- |
| *tpoCopieComplèteContexteHFSQL* | Provoque la copie immédiate du contexte HFSQL courant.<br>Conseillé par exemple si la tâche parallèle doit tenir compte des positions en cours dans les fichiers et requêtes du contexte de l'appelant. |
| *tpoCopieDifféréeContexteHFSQL*<br>(Valeur par défaut) | Provoque une copie légère du contexte HFSQL **lors du premier accès aux données HFSQL**. |
| *tpoCopieLégèreContexteHFSQL* | Provoque la copie immédiate d'une partie du contexte HFSQL courant. <br>Seuls les répertoires où se trouvent les fichiers de données en HFSQL Classic et/ou les connexions en HFSQL Client/Serveur sont mémorisés. |
| *tpoThreadPrincipal* | Exécute la tâche dans le thread principal.<br>Attention : Cette constante ne peut pas être utilisée pour exécuter une tâche parallèle dans le thread principal depuis le thread principal. |



**Dans ce cas, la tâche est décrite et sa description ne peut plus être modifiée.** 
La tâche n'est pas planifiée automatiquement, une déclaration seule ne provoquera donc pas l'exécution de la tâche. Il faut appeler une des fonctions d'exécution des tâches pour déclencher l'exécution de la tâche.


<a name="SYNTAXE3"></a>

### Décrire une tâche parallèle via une Description de TâcheParallèle 

`MaVariable est une TâcheParallèle(<Description>)`
---

**`<Description> : (Variable de type Description de TâcheParallèle)`**

Nom de la variable de type [Description de TâcheParallèle](../WDLang1/1000021586.md) décrivant la tâche.

**Dans ce cas, la tâche est décrite et sa description ne peut plus être modifiée.** 
La tâche n'est pas planifiée automatiquement, une déclaration seule ne provoquera donc pas l'exécution de la tâche. Il faut appeler une des fonctions d'exécution des tâches pour déclencher l'exécution de la tâche.





<a name="NOTE0"></a>

## Remarques
<a name="NOTE0_1"></a>


### Propriétés spécifiques à la description des variables de type TâcheParallèle
<a name="proprietes_specifiques_description_des_variables_type_docparampagetitleshort_ELTPARAGRAPHE000128"></a>Les propriétés suivantes peuvent être utilisées pour manipuler une tâche parallèle :


| Nom de la propriété | Type manipulé | Effet |
| --- | --- | --- |
| Annulée | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> si la tâche est annulée, <br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. <br><br><br><br><br>Cette propriété est disponible en lecture seulement. |
|  Etat | Constante de type Entier | Etat de la tâche : <br><br>- *tpeAnnulée* : la tâche parallèle est annulée (fonction [TâcheParallèleAnnule](../WDLang1/1000021278.md)). <br><br>- *tpeAnnulationDemandée* : une demande d'annulation a été faite sur la tâche parallèle (fonction [TâcheParallèleDemandeAnnulation](../WDLang1/1000021213.md)). <br><br>- *tpeAttenteExécution* : la tâche parallèle est en attente d'exécution. <br><br>- *tpeAttentePrécédente* : la tâche parallèle attend l'exécution d'une tâche parallèle précédente. <br><br>- *tpeExécutionEnCours* : la tâche parallèle est en cours d'exécution. <br><br>- *tpeNonPlanifiée* : la tâche parallèle n'est pas planifiée. <br><br>- *tpeTerminée* : la tâche parallèle est terminée. <br><br><br><br><br>Cette propriété est disponible en lecture seulement. |
| Identifiant | Entier | Identifiant de tâche. Cet identifiant peut être utilisé par exemple à des fins de débogage. <br><br>Cette propriété est disponible en lecture seulement. |
| Terminée | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> si la tâche est terminée, <br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. <br><br><br>Cette propriété est disponible en lecture seulement. |
| ValeurRenvoyée | Valeur renvoyée par la tâche. | Attention : <br><br>- Si la tâche est toujours en cours, la propriété **ValeurRenvoyée** attend la fin de la tâche.<br><br>- Si la tâche est terminée sans erreur fatale, la propriété renvoie la ou les valeurs de retour de la procédure de la tâche.<br><br><br><br><br>Cette propriété est disponible en lecture seulement. |


<a name="NOTE0_2"></a>




### Fonctions WLangage utilisant des variables de type TâcheParallèle
<a name="fonctions_wlangage_utilisant_des_variables_type_docparampagetitleshort_ELTPARAGRAPHE000217"></a>

- Fonctions classiques : 
	


|   |   |
| --- | --- |
| [TâcheParallèleAttend](../WDLang1/1000021212.md) | Attend la fin de l'exécution d'une tâche parallèle. |
| [TâcheParallèleDemandeAnnulation](../WDLang1/1000021213.md) | Demande l'annulation d'une tâche parallèle. |
| [TâcheParallèleExécute](../WDLang1/1000021211.md) | Déclenche l'exécution d'une tâche parallèle. |
| [TâcheParallèleExécuteAprès](../WDLang1/1000021214.md) | Indique une tâche parallèle de continuation qui sera exécutée lorsque la tâche parallèle spécifiée sera terminée. |
| [TâcheParallèleExécuteAprèsToutes](../WDLang1/1000021217.md) | Indique une tâche parallèle de continuation qui sera exécutée lorsque toutes les tâches d'un tableau de tâches parallèles seront terminées. |
| [TâcheParallèleExécuteAprèsUne](../WDLang1/1000021216.md) | Indique une tâche parallèle de continuation qui sera exécutée après la première tâche terminée d'un tableau de tâches parallèles. |

- Fonctions proposant une syntaxe préfixée : 
	


|   |   |
| --- | --- |
| [&lt;Variable TâcheParallèle&gt;.Attend](../WDLang1/1000021604.md) | Attend la fin de l'exécution d'une tâche parallèle. |
| [&lt;Variable TâcheParallèle&gt;.DemandeAnnulation](../WDLang1/1000021605.md) | Demande l'annulation d'une tâche parallèle. |







