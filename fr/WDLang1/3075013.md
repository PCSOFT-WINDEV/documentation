


## TableauAjouteLigne (Fonction)

***En anglais : ArrayAddLine***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute une ligne à la fin :

- d'un tableau WLangage à une ou deux dimensions.

- d'une propriété tableau d'un type avancé à deux dimensions (xlsDocument, ...).




**Remarque** : Cette fonction est identique à la fonction [AjouteLigne](../WDLang1/1000017349.md).






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MonTableau est un tableau de 2 par 3 chaînes
TableauAjouteLigne(MonTableau, "A", "B", "C")
TableauAjouteLigne(MonTableau, "a", "b", "c")
TableauAjouteLigne(MonTableau, "D", "E", "F")
// Afficher le contenu de la 3° ligne (les deux premières sont vides)
Trace(MonTableau[3,1], MonTableau[3,2], MonTableau[3,3])
// Affiche "A B C"
```
<a name="Exemple2"></a>

```wl
MonTableau est un tableau de 2 par 3 chaînes
MonTableau[1,1] = "A"
MonTableau[1,2] = "B"
MonTableau[1,3] = "C"
MonTableau[2,1] = "a"
MonTableau[2,2] = "b"
MonTableau[2,3] = "c"
TableauAjouteLigne(MonTableau, "D", "E", "F")
// Afficher le contenu de la 3° ligne
Trace(MonTableau[3,1], MonTableau[3,2], MonTableau[3,3]) 
// Affiche "D E F"
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = TableauAjouteLigne(<Tableau WLangage> [, <Élément colonne 1> [... [, <Élément colonne N>]]])`
---

**`<Résultat> : (Entier)`**



- Indice de la ligne ajoutée, 

- -1 en cas d'erreur.




**`<Tableau WLangage> : (Tableau)`**

Nom de la variable de type Tableau à manipuler. Ce tableau doit être un tableau à une ou deux dimensions.

**`<Élément colonne 1> : (Type des éléments du tableau, optionnel)`**

Élément de la ligne à ajouter dans le tableau spécifié. Chaque élément correspond à une colonne dans le tableau. Le type de l'élément ajouté doit être compatible avec le type de la colonne concernée.
Si aucun de ces paramètres n'est spécifié, une ligne vide est ajoutée dans le tableau. Les colonnes sont initialisées avec la valeur par défaut du type des autres éléments du tableau.
Si un de ces paramètres n'est pas spécifié, la colonne correspondante est initialisée avec la valeur par défaut du type des autres éléments du tableau.



**`<Élément colonne N> : (Type des éléments du tableau, optionnel)`**

Élément de la ligne à ajouter dans le tableau spécifié. Chaque élément correspond à une colonne dans le tableau. Le type de l'élément ajouté doit être compatible avec le type de la colonne concernée.
Si aucun de ces paramètres n'est spécifié, une ligne vide est ajoutée dans le tableau. Les colonnes sont initialisées avec la valeur par défaut du type des autres éléments du tableau.
Si un de ces paramètres n'est pas spécifié, la colonne correspondante est initialisée avec la valeur par défaut du type des autres éléments du tableau.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Ajout d'une ligne dans un tableau WLangage
<a name="ajout_une_ligne_dans_tableau_wlangage_ELTPARAGRAPHE000119"></a>Lors de l'utilisation de la fonction **TableauAjouteLigne** :

- le nombre de lignes du tableau est automatiquement agrandi pour accueillir la nouvelle ligne.

- le nombre de colonnes du tableau n'est pas agrandi. Il est donc nécessaire : 

	- soit de déclarer le tableau avec le bon nombre de colonnes (deuxième dimension du tableau).

	- soit de modifier dynamiquement le nombre de colonnes avec la fonction [Dimension](../WDLang1/3013022.md). 




- les éléments sont convertis si nécessaire dans le type des autres éléments du tableau.


**Remarque** : Lors de la déclaration d'un tableau de N par M éléments, ce tableau contient N lignes vides. Par exemple, le tableau déclaré ci-dessous contient 3 lignes vides.

```wl
MonTableau est un tableau de 3 par 2 chaînes
```
Lors de l'ajout d'une ligne (fonction **TableauAjouteLigne**), cette ligne est automatiquement ajoutée à la suite des lignes déjà présentes dans le tableau.
Dans notre exemple, la ligne ajoutée correspondra à la 4° ligne.
<a name="NOTE0_2"></a>


### Ajout d'une ligne dans une propriété tableau d'un type avancé
<a name="ajout_une_ligne_dans_une_propriete_tableau_type_avance_ELTPARAGRAPHE000152"></a>Lors de l'utilisation de la fonction **TableauAjouteLigne** :

- la variable de type avancé doit être allouée.

- le type avancé doit avoir un énumérateur de type collection modifiable.

- le type avancé est automatiquement agrandi pour accueillir la nouvelle ligne.



<a name="NOTE0_3"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000168"></a>

- Cette fonction ne peut pas être utilisée sur :

	- les tableaux non alloués.

	- les tableaux fixes.









- Pour ajouter une ligne à une position donnée, utilisez la fonction [TableauInsèreLigne](../WDLang1/3075014.md) ou [Insère](../WDLang1/1000017351.md).




<a name="XComposante"></a>

## Composante :
wd280vm.dll
