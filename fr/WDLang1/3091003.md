
## ImageInfoValeur (Fonction)

***En anglais : ImageInfoValue***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie la valeur d'un marqueur Exif pour l'image manipulée.

**Remarques** : 

- Les informations Exif (EXchangeable Image File) sont incorporées dans le fichier image lui-même. Cette norme définit un ensemble de marqueurs qui permettent de stocker de nombreuses informations relatives à l'image : date, largeur, orientation, modèle de l'appareil photo, vitesse d'obturation, distance du sujet, temps d'exposition, ...

- Pour manipuler les marqueurs Exif d'une image, il est également possible d'utiliser la propriété **Exif** des variables de type [Image](../WDLang1/1000019650.md). Cette propriété peut être utilisée pour les applications Android. 



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
ListeMarqueur est une chaîne 
MonMarqueur est un entier 
i est un entier = 1 
// Récupération des marqueurs disponibles pour 
// l'image JPEG affichée dans le champ Image "IMG_MonChampImage" 
ListeMarqueur = ImageInfoListe(IMG_MonChampImage) 
TANTQUE ExtraitChaîne(ListeMarqueur, i, RC) <> EOT 
	// Récupération de chaque marqueur 
	MonMarqueur = ExtraitChaîne(ListeMarqueur, i, RC) 
	// Ajout du marqueur et de sa valeur dans la table TABLE_MaTable 
	TableAjouteLigne(TABLE_MaTable, MonMarqueur, ... 
		ImageInfoValeur(IMG_MonChampImage, MonMarqueur)) 
	i ++ 
FIN
```


<a name="Exemple2"></a>





```wl
CheminImg est une chaîne = "C:\Mes Images\MonImage.JPG"
// Connaître la date de réalisation de cette image 
Info("Date de réalisation : " + ImageInfoValeur(CheminImg, imgDate) + RC + ...
	"Luminosité : " + ImageInfoValeur(CheminImg, imgLuminosité) + RC + ...
	"Longueur focale : " + ImageInfoValeur(CheminImg, imgLongueurFocale) + RC + ...
	"Ouverture : " + ImageInfoValeur(CheminImg, imgOuverture)) 
// Fermeture du fichier image 
ImageInfoFerme(CheminImg)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ImageInfoValeur(<Image> , <Marqueur>)`
---

**`<Résultat> : (Buffer)`**

Valeur du marqueur spécifié pour l'image manipulée.

**`<Image> : (Chaîne de caractères)`**

Image à manipuler. Cette image peut correspondre à :

- un fichier image (format JPEG ou TIFF) : spécifiez le nom et le chemin complet (ou relatif) du fichier. Un chemin de type UNC peut être utilisé. 
	Dans ce cas, il est nécessaire de fermer le fichier grâce à la fonction [ImageInfoFerme](../WDLang1/3091001.md).

- une image (format JPEG ou TIFF) affichée dans un champ Image : spécifiez le nom du champ Image.

- une image (format JPEG ou TIFF) contenue dans un mémo image : spécifiez ce mémo image.

- une image (format JPEG ou TIFF) contenue dans un chaîne binaire : spécifiez cette chaîne binaire.




**`<Marqueur> : (Constante ou entier)`**

Marqueur dont la valeur est demandée. Ce marqueur peut correspondre :

- soit à un entier donné grâce à la fonction [ImageInfoListe](../WDLang1/3091002.md).

- soit à une constante du WLangage. Pour connaître la liste des constantes disponibles, consultez le paragraphe "Correspondance des marqueurs" ci-dessous.  






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Correspondance des marqueurs
<a name="correspondance_des_marqueurs_ELTPARAGRAPHE000066"></a>Le tableau suivant présente la correspondance des marqueurs avec les constantes WLangage.



| Marqueur | Constante WLangage | Valeur |
| --- | --- | --- |
| 37510 | *imgCommentaire* | Chaîne de caractères <br>Commentaires sur l'image |
| 37122 | *imgCompression* | Réel <br>Compression en bits/pixels de l'image |
| 33432 | *imgCopyright* | Chaîne de caractères <br>Copyright de l'image |
| 306 | *imgDate* | Date <br>Date et heure de l'image, au format AAAA:MM:JJ HH:MM:SS |
| 270 | *imgDescription* | Chaîne de caractères <br>Description de l'image |
| 37382 | *imgDistanceSujet* | Réel <br>Distance du sujet en mètres |
| 37380 | *imgDistorsionExposition* | Réel <br>Distorsion d'exposition en APEX |
| 37385 | *imgFlash* | Entier <br>Etat du flash au moment de la prise de vue :<br><br>- 0 : Flash non déclenché. <br><br>- 1 : Flash déclenché. <br><br>- 5 : Flash déclenché et lumière de retour non détectée. <br><br>- 7 : Flash déclenché et lumière de retour détectée.<br><br><br> |
| 928 | *imgHauteur* | Entier<br>Hauteur de l'image en pixels |
| 672 | *imgLargeur* | Entier <br>Largeur de l'image en pixels |
| 305 | *imgLogicielEnregistrement* | Chaîne de caractères<br>Nom du logiciel (ou du micro-logiciel) qui a enregistré l'image. |
| 37386 | *imgLongueurFocale* | Réel <br>Longueur focale en millimètres |
| 37379 | *imgLuminosité* | Réel <br>Luminosité de l'image en APEX |
| 271 | *imgMarqueAppareil* | Chaîne de caractères <br>Marque de l'appareil photo ayant pris l'image |
| 272 | *imgModèleAppareil* | Chaîne de caractères <br>Modèle de l'appareil photo ayant pris l'image |
| 37383 | *imgModeMesure* | Entier <br>Mode de mesure :<br><br>- 0 : inconnue. <br><br>- 1 : moyenne. <br><br>- 2 : moyenne centrée. <br><br>- 3 : point. <br><br>- 4 : multipoint.<br><br>- 5 : motif. <br><br>- 6 : partiel. <br><br>- 7 à 254 : réservé. <br><br>- 255 : autre.<br><br><br> |
| 37500 | *imgNoteFabricant* | Chaîne de caractères<br>Notes du fabricant de l'appareil photo ayant pris l'image |
| 274 | *imgOrientation* | Entier <br>Orientation de l'image :<br>Cette information indique où se trouve le point (0,0) de l'image.<br>Pour afficher l'image dans le bon sens en fonction de cette information, il faut utiliser les valeurs suivantes :<br><br>- 1 : le point (0,0) est en haut à gauche, il n'y a rien à faire. <br><br>- 2 : le point (0,0) est en haut à droite, il faut réaliser une symétrie verticale.<br><br>- 3 : le point (0,0) est en bas à droite, il faut réaliser une symétrie horizontale et verticale.<br><br>- 4 : le point (0,0) est en bas à gauche, il faut réaliser une symétrie horizontale.<br><br>- 5 : le point (0,0) est à gauche et en haut, il faut réaliser une symétrie horizontale et une rotation de 90°.<br><br>- 6 : le point (0,0) est à droite et en haut, il faut réaliser une rotation de 90°.<br><br>- 7 : le point (0,0) est à gauche et en bas, il faut réaliser une symétrie verticale et une rotation de 90°.<br><br>- 8 : le point (0,0) est à droite et en bas, il faut réaliser une rotation de -90°.<br><br><br> |
| 37378 | *imgOuverture* | Réel <br>Ouverture en APEX |
| 33437 | *imgOuvertureF* | Réel <br>Focale |
| 37381 | *imgOuvertureMax* | Réel <br>Ouverture maximale en APEX |
| 34850 | *imgProgrammeExposition* | Entier<br>Mode d'exposition utilisé au moment de la prise de vue :<br><br>- 0 : indéfini.<br><br>- 1 : manuel.<br><br>- 2 : normal.<br><br>- 3 : priorité ouverture.<br><br>- 4 : priorité vitesse.<br><br>- 5 : créatif.<br><br>- 6 : action.<br><br>- 7 : portrait de près sans arrière-plan.<br><br>- 8 : paysage.<br><br>- 9 à 255 : autres.<br><br><br> |
| 282 | *imgRésolutionX* | Réel <br>Résolution horizontale de l'image |
| 283 | *imgRésolutionY* | Réel <br>Résolution verticale de l'image |
| 37384 | *imgSourceLumière* | Entier <br>Source de lumière de l'image :<br><br>- 0 : inconnue. <br><br>- 1 : lumière du jour. <br><br>- 2 : fluorescent. <br><br>- 3 : tungsten. <br><br>- 17 : lumière standard A. <br><br>- 18 : lumière standard B. <br><br>- 19 : lumière standard C. <br><br>- 20 : D55. <br><br>- 21 : D65. <br><br>- 22 : D75. <br><br>- 23 à 254 : réservé. <br><br>- 255 : autre.<br><br><br> |
| 33434 | *imgTempsExposition* | Réel <br>Temps d'exposition |
| 296 | *imgUnitéRésolution* | Entier <br>Unité de la résolution horizontale et verticale de l'image : <br><br>- 2 : pouces. <br><br>- 3 : centimètres.<br><br><br> |
| 36864 | *imgVersionEXIF* | Chaîne de caractères<br>Version des informations Exif |
| 65536 | *imgVignette* | Chaîne binaire <br>Vignette correspondant à l'image |
| 37377 | *imgVitesseObturation* | Réel <br>Vitesse d'obturation en APEX |


D'autres marqueurs non listés dans ce tableau sont également disponibles. Ces marqueurs correspondent à des marqueurs spécifiques à certains types d'appareils photo ou à des marqueurs personnalisés.
<a name="NOTE0_2"></a>




### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000381"></a>La fonction **ImageInfoValeur** ne retourne pas de code d'erreur. Pour savoir si cette fonction a généré une erreur, utilisez la variable [ErreurDétectée](../WDLang1/3087001.md). En cas d'erreur, il est possible de connaître le détail de l'erreur grâce à la fonction [ErreurInfo](../WDLang1/3013008.md).




- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LesfonctionsEXIF.gif) ***Exemples unitaires (WINDEV)*** : **Les fonctions EXIF** <br>Utilisation des fonctions ImageXXX.<br>Ces fonctions permettent d'accéder aux informations EXIF d'une image.<br>Les informations EXIF sont contenues dans les images de type JPEG ou TIFF.<br>Il y a par exemple, la date de prise de vue de la photo, l'orientation de l'appareil quand la photo a été prise, la marque et le modèle de l'appareil photo, une miniature de l'image...



<a name="XComposante"></a>

## Composante :
wd280img.dll
