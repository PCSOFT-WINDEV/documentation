


## TreeMapAjoute (Fonction)

***En anglais : TreeMapAdd***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute un élément dans un champ TreeMap.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Remplit un champ TreeMap avec le contenu d'un champ Table
Chemin est une chaîne
TreeMapSupprimeTout(TMAP_Vin)
POUR I = 1 _A_ TABLE_VIN.Occurrence
	Chemin = TABLE_VIN.COL_Typevin[I] + "\" + TABLE_VIN.COL_Proprietaire[I]
	SELON TABLE_VIN.COL_Typevin[I]
		CAS "ROUGE"
			TreeMapAjoute(TMAP_Vin, Chemin, TABLE_VIN.COL_Prix[I], RougeClair)
		CAS "BLANC"
			TreeMapAjoute(TMAP_Vin, Chemin, TABLE_VIN.COL_Prix[I], Blanc)
		CAS "ROSÉ"
			TreeMapAjoute(TMAP_Vin, Chemin, TABLE_VIN.COL_Prix[I], RougePastel)
	FIN
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe

`<Résultat> = TreeMapAjoute(<Champ TreeMap> , <Chemin de l'élément> , <Poids de l'élément> [, <Couleur de l'élément>] [, <Texte de la bulle d'aide>])`
---

**`<Résultat> : (Entier)`**



- Indice de l'élément ajouté, 

- -1 en cas d'erreur. 


**Remarque** : L'élément ajouté peut être manipulé directement grâce à son indice. Il est par exemple possible de modifier les propriétés de cet élément.

**`<Champ TreeMap> : (Nom de champ)`**

Nom du champ TreeMap à manipuler.
Si ce paramètre correspond à une chaîne vide (""), le champ TreeMap manipulé sera le champ TreeMap auquel appartient l'événement en cours.

**`<Chemin de l'élément> : (Chaîne de caractères)`**

Chemin et libellé de l'élément à ajouter. Le chemin permet d'organiser les éléments, de les regrouper. Le séparateur des différents éléments du chemin peut être :

- soit le caractère "\\". Par exemple : "MonRépertoire\\MonFichier". 

- soit le caractère "TAB". Par exemple : "Desserts"+TAB+"Crème brulée". 




Le libellé de l'élément correspond au dernier élément du chemin. Ce libellé est affiché dans le champ TreeMap. Ce libellé peut être modifié grâce à la propriété [Libellé](../Proprietes/2510053.md).

**`<Poids de l'élément> : (Réel ou entier)`**

Poids de l'élément affiché dans le champ TreeMap.

**`<Couleur de l'élément> : (Entier optionnel)`**

Couleur de fond de l'élément. Cette couleur peut correspondre à :

- une couleur RVB (obtenue avec la fonction [RVB](../WDLang1/3029012.md)),

- une couleur TSL (obtenue avec la fonction [TSL](../WDLang1/3029057.md)),

- une couleur prédéfinie (voir [les couleurs prédéfinies du WLangage](../WDLang5/3010002.md)).




**`<Texte de la bulle d'aide> : (Chaîne de caractères optionnelle)`**

Si ce paramètre est précisé, son contenu sera affiché lors du survol de l'élément dans une bulle d'aide. Par défaut, ce paramètre correspond à une chaîne vide. 
Si ce paramètre n'est pas spécifié, la bulle d'aide affichera automatiquement le contenu du paramètre &lt;Chemin de l'élément&gt;.



<a name="XComposante"></a>

## Composante :
wd280obj.dll
