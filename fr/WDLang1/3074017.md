


## TableAjoute (Fonction)

***En anglais : TableAdd***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute une ligne dans : 

- un champ Table, 

- un champ Table hiérarchique, 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) un champ "Combo avec table" (champ Table affiché dans un champ Combo).




**Remarque** : Il est conseillé d'utiliser la fonction [TableAjouteLigne](../WDLang1/3074006.md). La fonction [TableAjouteLigne](../WDLang1/3074006.md) permet d'ajouter :

- des caractères TAB dans les colonnes,

- des valeurs de n'importe quel type dans les colonnes,

- des données UNICODE automatiquement et sans conversion.





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ajout de "Dubois", "Pierre" et "21/06/72"
// à la fin du champ "TABLE_TableClient"
ResAjout = TableAjoute(TABLE_TableClient, "Dubois" + TAB + "Pierre" + TAB + "21/06/72")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = TableAjoute(<Champ Table> [, <Ligne>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'élément a été ajouté, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Champ Table> : (Nom de champ)`**

Nom du champ à manipuler. Ce champ peut correspondre à : 

- un champ Table.

- un champ Table hiérarchique. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) un champ Combo avec table.


Si ce paramètre correspond à une chaîne vide (""), le champ manipulé sera le champ auquel appartient l'événement en cours d'exécution.

**`<Ligne> : (Chaîne de caractères optionnelle)`**

Ligne à ajouter. Cette ligne est de la forme : 

```txt
<Elément de la colonne 1> + TAB + <Elément de la colonne 2> + TAB + ...
```

Si ce paramètre n'est pas spécifié, une ligne vide est ajoutée dans le champ. Pour un champ fichier, les valeurs par défaut définies dans le fichier de données lié sont alors prises en compte.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000124"></a>La fonction **TableAjoute** peut être utilisée indifféremment sur :

- un champ Table ou Table hiérarchique fichier.

- un champ Table ou Table hiérarchique par programmation.

- un champ monosélection ou multisélection.
	



<a name="NOTE0_2"></a>


### Caractéristiques d'une ligne
<a name="caracteristiques_une_ligne_ELTPARAGRAPHE000167"></a>

- Chaque élément ajouté est converti dans le type de la colonne concernée.

- Pour ne pas spécifier de valeur pour un élément, utilisez une chaîne vide ("") ou 0 (selon le type de la colonne). Par exemple :
	
	```wl
	TableAjoute(TABLE_TableClient, "Dubois" + TAB + "Pierre" + TAB + "" + TAB + "21/06/72")
	```


- Si un élément correspond au résultat d'un calcul, mettez l'expression numérique entre parenthèses. Par exemple :
	
	```wl
	TableAjoute(TABLE_TableCalcul, (53+29) + TAB + (83-21))
	```




<a name="NOTE0_3"></a>


### Position de la ligne ajoutée
<a name="position_ligne_ajoutee_ELTPARAGRAPHE000192"></a>Par défaut, la ligne est ajoutée à la fin des lignes affichées par le champ.

Cas particulier : 

- Si le champ est trié avec la fonction [TableTrie](../WDLang1/3074035.md), la ligne ajoutée est positionnée dans le champ en fonction du tri en cours.

- Si le champ est trié par l'utilisateur, le tri n'est pas pris en compte lors de l'ajout de la ligne. La ligne est ajoutée à la fin du champ.



<a name="NOTE0_4"></a>


### Limites : Nombre maximum de lignes affichées
<a name="limites_nombre_maximum_lignes_affichees_ELTPARAGRAPHE000209"></a>Le nombre maximum de lignes pouvant être affichées dans un champ Table ou Table hiérarchique est limité uniquement par la mémoire vive disponible (maximum théorique : 2 milliards de lignes).

Il est cependant déconseillé d'utiliser des champs Table ou Table hiérarchique avec un nombre de lignes important pour des raisons de performance (temps nécessaire pour remplir le champ par exemple) et d'utilisabilité.
<a name="NOTE0_5"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000220"></a>

- Pour ajouter une ligne dans un champ Table ou Table hiérarchique à une position spécifique, utilisez la fonction [TableInsèreLigne](../WDLang1/3074026.md).

- Si la ligne ajoutée est la première ligne du champ, la ligne ajoutée devient la ligne en cours.



<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Ajout de lignes
<a name="ajout_lignes_ELTPARAGRAPHE000235"></a>La propriété [Nouveau](../Proprietes/2510073.md) permet de savoir si la ligne en cours vient d'être créée par la fonction **TableAjoute** (propriété Nouveau = <u><u><u><u>Vrai</u></u></u></u>).
<a name="NOTE0_7"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Saisie en chaîne
<a name="saisie_chaine_ELTPARAGRAPHE000256"></a>Pour effectuer une saisie en chaîne, utilisez la fonction **TableAjoute** dans l'événement "Sortie d'une ligne" du champ Table de la façon suivante :

```wl
SI TABLE_TableClient.Nouveau ALORS
	TableAjoute(TABLE_TableClient)
FIN
```

<a name="NOTE0_8"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Champ Table/Table hiérarchique fichier : Modifications dans le fichier de données lié
<a name="champ_tabletable_hierarchique_fichier_modifications_dans_fichier_donnees_lie_ELTPARAGRAPHE000280"></a>

- **Si la saisie en cascade est activée**, le fichier de données lié au champ est automatiquement modifié lorsque l'utilisateur passe à la ligne suivante.

- **Si la saisie en cascade n'est pas activée**, le fichier de données lié au champ n'est pas modifié. Pour écrire le contenu de la ligne ajoutée dans le fichier de données lié, il est nécessaire d'utiliser la fonction [TableEnregistre](../WDLang1/3074008.md) après la fonction **TableAjoute**.




**Remarques** : 

- L'option "Saisie en cascade (Ajout)" peut être sélectionnée dans l'onglet "Détail" de la description du champ.

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La saisie en cascade n'est pas disponible sur les champs Table fichier à accès direct. Cette option est disponible uniquement sur les champs Table par programmation et sur les champs Table fichier chargé en mémoire.



<a name="NOTE0_9"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Champ Table/Table hiérarchique fichier : Ajout de plusieurs lignes
<a name="champ_tabletable_hierarchique_fichier_ajout_plusieurs_lignes_ELTPARAGRAPHE000314"></a>A chaque appel de la fonction **TableAjoute** dans un champ Table ou Table hiérarchique fichier, une ligne virtuelle est créée dans le champ. Les informations seront enregistrées dans le fichier de données lié uniquement que lors de l'appel de la fonction [TableEnregistre](../WDLang1/3074008.md).

Si la fonction **TableAjoute** est appelée successivement dans le même traitement sans être suivie de la fonction [TableEnregistre](../WDLang1/3074008.md), seul le PREMIER appel est effectif (les appels suivants sont ignorés). Une seule ligne est ajoutée dans le champ Table/Table hiérarchique fichier.

<a name="NOTE0_10"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Ajout dans un champ Table fichier et déclenchement d'un trigger
<a name="ajout_dans_champ_table_fichier_declenchement_trigger_ELTPARAGRAPHE000342"></a>Il est possible de déclencher un trigger lors de l'ajout d'un enregistrement dans un champ Table fichier. Pour plus de détails, consultez la documentation de [HDécritTrigger](../WDLang4/3044074.md).

<a name="NOTE0_11"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Champ Table/Table hiérarchique fichier en saisie
<a name="champ_tabletable_hierarchique_fichier_saisie_ELTPARAGRAPHE000359"></a>Si la fonction **TableAjoute** est appelée :

- Dans un événement du champ, le curseur est automatiquement positionné sur la première colonne à saisir dans la ligne ajoutée.

- Dans un événement n'appartenant pas au champ (ou dans un autre traitement), utilisez la fonction [DonneFocusEtRetourUtilisateur](../WDLang1/1410088107.md) pour reprendre la saisie dans le champ Table ou Table hiérarchique.



<a name="NOTE0_12"></a>


### Ajout d'image
<a name="ajout_image_ELTPARAGRAPHE000377"></a>Pour ajouter une image dans un champ Table ou Table hiérarchique : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) spécifiez directement le nom et le chemin complet de l'image à ajouter.
	Par exemple :
	
	```wl
	TableAjoute(TABLE_MaTable, "C:\MesDocuments\MonImage.BMP")
	```



**Remarque** : Pour afficher correctement l'image ajoutée, la colonne doit être de type Image.
<a name="NOTE0_13"></a>


### Gestion de l'Unicode
<a name="gestion_unicode_ELTPARAGRAPHE000606"></a>La gestion de l'Unicode peut être définie au niveau de la configuration de projet (onglet "Unicode" de la fenêtre de description de la configuration) : 

- Si l'option "Utiliser des chaînes ANSI en exécution" est sélectionnée : les données sont converties en utilisant l'alphabet courant. 
	Rappel : La fonction [ChangeAlphabet](../WDLang1/3054001.md) permet de modifier l'alphabet courant.

- Si l'option "Utiliser des chaînes UNICODE en exécution" est sélectionnée, les données sont insérées sans transformation.








<a name="XComposante"></a>

## Composante :
wd280obj.dll
