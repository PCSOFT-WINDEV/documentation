


## VérifieExpressionRégulière (Fonction)

***En anglais : MatchRegularExpression***

<DIV class="specObsolete">
	<IMG style="float:left;margin-right:10px;" src="https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=warning_big.png"><B>Avertissement</B><BR>
	A partir de la version <B>27</B>,  cette fonction est conservée par compatibilité. Il est recommandé d'utiliser la fonction [RegexVérifie](../WDLang1/1000026273.md), qui utilise la grammaire ECMAScript pour les expressions régulières. 
</DIV><a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Vérifie si une chaîne de caractères correspond à un format spécifique et récupère les différentes sous-chaînes constituant le format. Un assistant dans l'éditeur de code permet de créer simplement le format à vérifier.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Vérification d'une adresse email 
SI VérifieExpressionRégulière(MonEmail, "[-.a-z0-9]+[@][-.a-z0-9]+[.][a-z]{2,4}") = Vrai ALORS
	// "[-.a-z0-9]+" : chaîne de 1 ou de plusieurs caractères
	// Cette chaîne peut contenir les lettres 'a' à 'z',
	// les chiffres '0' à '9', et les symboles '-' et '.'
	// [.] indique que ce caractère doit correspondre à un point. 
	// "[a-z]{2,4}" : chaîne contenant 2, 3 ou 4 caractères
	// Cette chaîne peut contenir les lettres 'a' à 'z'
	Info("L'adresse email : " + MonEmail + " est correcte.")
FIN
```


<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Extraction des différents éléments d'une date
// au format JJ/MM/AAAA (par exemple : 28/03/2003)
MaDate est une chaîne = "28/03/2003"
MonJour, MonMois, MonAnnée sont des chaînes
SI VérifieExpressionRégulière(MaDate, "([0-9]+)/([0-9]+)/([0-9]+)", ...
		MonJour, MonMois, MonAnnée) = Vrai ALORS
	Trace(MonJour, MonMois, MonAnnée)
SINON
	Erreur("La date n'est pas au bon format")
FIN
```


<a name="Exemple3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Variables d'extraction
UnJour est une chaîne
UnMois est une chaîne
UneAnnée est une chaîne
UneHeure est une chaîne
DateAVérifier est une chaîne = "Tue, 11 Apr 2006 18:25:09 +0200"
SI VérifieExpressionRégulière(DateAVérifier, ...
		"[A-Za-z]{3,3}[,] ([0-9]{1,2}) ([A-Za-z]{3,3}) "+...
		"([0-9]{4,4}) ([0-9]{2,2}[:][0-9]{2,2}[:][0-9]{2,2}) [\+][0-9]{4,4}", ...
		UnJour, UnMois, UneAnnée, UneHeure) = Faux ALORS
	Info("Date incorrecte")
SINON
	Info("Date correcte", "Jour : " + UnJour, "Mois :" + UnMois, "Année : " + UneAnnée, ...
		"Heure : " + UneHeure)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Vérifier un format

`<Résultat> = VérifieExpressionRégulière(<Elément à vérifier> , <Expression régulière>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la chaîne vérifie le format indiqué, 

- <u><u><u><u>Faux</u></u></u></u> si la chaîne ne vérifie pas le format.




**`<Elément à vérifier> : (Chaîne de caractères)`**

Chaîne de caractères à vérifier. Cette chaîne de caractères doit être en caractères latin. 

**`<Expression régulière> : (Chaîne de caractères)`**

Format de référence, exprimé sous forme d'une expression régulière. Cette chaîne de caractères doit être en caractères latin. Ce format utilise les caractères suivants :


|   |   |
| --- | --- |
| A B C - / _ | Lettres et symboles à vérifier. |
| [A-Z] ou [0-9] | Intervalle de lettres, de chiffres ou de symboles à vérifier. |
| \* | 0 ou plusieurs symboles à vérifier. |
| + | 1 ou plusieurs symboles à vérifier. |
| \\W | Vérifie si un caractère spécial est présent (par exemple &, #, @, ...). |


Remarque : L'utilisation du caractère | (pipe) permet de définir une condition de type "OU". 


<a name="SYNTAXE2"></a>

### Vérifier un format et récupérer les éléments correspondant au format

`<Résultat> = VérifieExpressionRégulière(<Elément à vérifier> , <Expression régulière> , <Variable 1> ... [, <Variable N>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la chaîne vérifie le format indiqué, 

- <u><u><u><u>Faux</u></u></u></u> si la chaîne ne vérifie pas le format.




**`<Elément à vérifier> : (Chaîne de caractères)`**

Chaîne de caractères à vérifier. Cette chaîne de caractères doit être en caractères latin. 

**`<Expression régulière> : (Chaîne de caractères)`**

Format de référence exprimé sous forme d'une expression régulière. Cette chaîne de caractères doit être en caractères latin. Ce format utilise les caractères suivants :


|   |   |
| --- | --- |
| A B C - / _ | Lettres et symboles à vérifier. |
| [A-Z] ou [0-9] | Intervalle de lettres, de chiffres ou de symboles à vérifier. |
| \* | 0 ou plusieurs symboles à vérifier. |
| + | 1 ou plusieurs symboles à vérifier. |
| \\W | Vérifie si un caractère spécial est présent (par exemple &, #, @, ...). |
| ( ) | Délimitation d'une partie du format pour lequel l'élément correspondant devra être extrait. |
| { } | Nombre de répétitions autorisées pour l'expression précédente (de la forme {min, max}). |


Remarque : L'utilisation du caractère | (pipe) permet de définir une condition de type "OU". 

**`<Variable 1> : (Chaîne de caractères, Entier, ...)`**

Variable qui sera automatiquement initialisée avec la valeur correspondant à la première partie du &lt;Format&gt;. Chaque partie est définie par les caractères '(' et ')'.



**`<Variable N> : (Chaîne de caractères, Entier, ...)`**

Variable qui sera automatiquement initialisée avec la valeur correspondant à la Nième partie du &lt;Format&gt;. Chaque partie est définie par les caractères '(' et ')'.


<a name="SYNTAXE3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Vérifier un format et récupérer les éléments correspondant au format dans un tableau

`<Résultat> = VérifieExpressionRégulière(<Elément à vérifier> , <Expression régulière> , <Tableau de chaînes>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la chaîne vérifie le format indiqué, 

- <u><u><u><u>Faux</u></u></u></u> si la chaîne ne vérifie pas le format.




**`<Elément à vérifier> : (Chaîne de caractères)`**

Chaîne de caractères à vérifier. Cette chaîne de caractères doit être en caractères latin. 

**`<Expression régulière> : (Chaîne de caractères)`**

Format de référence. Cette chaîne de caractères doit être en caractères latin. Ce format utilise les caractères suivants :


|   |   |
| --- | --- |
| A B C - / _ | Lettres et symboles à vérifier. |
| [A-Z] ou [0-9] | Intervalle de lettres, de chiffres ou de symboles à vérifier. |
| \* | 0 ou plusieurs symboles à vérifier. |
| + | 1 ou plusieurs symboles à vérifier. |
| \\W | Vérifie si un caractère spécial est présent (par exemple &, #, @, ...). |
| ( ) | Délimitation d'une partie du format pour lequel l'élément correspondant devra être extrait. |
| { } | Nombre de répétitions autorisées pour l'expression précédente (de la forme {min, max}). |


Remarque : L'utilisation du caractère | (pipe) permet de définir une condition de type "OU". 

**`<Tableau de chaînes> : (Tableau)`**

Nom du tableau à remplir. Les différents éléments du tableau seront automatiquement initialisés avec les valeurs correspondant aux différentes parties du &lt;Format&gt;.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Caractère d'échappement
<a name="caractere_echappement_ELTPARAGRAPHE000274"></a>Le caractère d'échappement est "\\". Ainsi, pour vérifier que le caractère { par exemple est bien dans la chaîne, l'expression régulière sera [\\{]. Ce caractère d'échappement peut également être utilisé avec le caractère "+" et "\*".

Utilisé avec W, il permet de vérifier la présence d'un caractère spécial (#, &, @, ...) dans la chaîne. Exemple : 

```wl
SI PAS VérifieExpressionRégulière(SAI_SansNom1, ".*\W.*") ALORS
	Erreur("Pas de caractères spéciaux dans la chaîne")
SINON
	Info("La chaîne contient au moins un caractère spécial")
	
FIN
```

<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Caractères spéciaux
<a name="caracteres_speciaux_ELTPARAGRAPHE000293"></a>Les caractères suivants peuvent également être utilisés dans le format :

- TAB pour vérifier la présence d'une tabulation. Par exemple : 
	
	```wl
	VérifieExpressionRégulière(sChaîne, "1" + TAB + "2")
	```


- RC pour vérifier la présence d'un Retour Chariot. Par exemple : 
	
	```wl
	VérifieExpressionRégulière(sChaîne, "1" + RC + "2")
	```




<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Utiliser une condition dans une expression régulière
<a name="utiliser_une_condition_dans_une_expression_reguliere_ELTPARAGRAPHE000309"></a>L'utilisation du caractère | (pipe) permet de définir une condition de type "OU". 

Ainsi, l'expression "[0-9]{6,6}[_](AVIS|avis|QCM|qcm)[_][0-9]{8,8}" permet de vérifier ces deux types d'expression : 

- 123456_avis_20120913

- 123456_QCM_20120913



<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Assistant de la fonction **VérifieExpressionRégulière**
<a name="assistant_fonction_docparampagetitleshort_ELTPARAGRAPHE000346"></a>La fonction **VérifieExpressionRégulière** propose sous l'éditeur de code l'utilisation d'un assistant de fonctionnalité. Cet assistant permet : 

- d'utiliser une expression régulière pré-définie. Une liste des expressions régulières pré-définies est proposée. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=V%E9rifieExpressionR%E9guli%E8re%20-%20HC%20N%B0001.gif)


- de visualiser l'expression régulière sous forme de schéma ou d'enchaînement de conditions dans une table. 

- de créer une expression régulière. Il suffit de : 

	- Sélectionner l'expression prédéfinie "Personnalisée". 

	- Cliquer sur le bouton ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=V%E9rifieExpressionR%E9guli%E8re%20-%20HC%20N%B0002%201.gif)
. 

	- Ajouter les différentes conditions via le bouton "+". L'expression régulière se construit dans le champ "Expression régulière générée". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=V%E9rifieExpressionR%E9guli%E8re%20-%20HC%20N%B0003.gif)


	- Saisir l'expression à tester. 

- Le bouton ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=V%E9rifieExpressionR%E9guli%E8re%20-%20HC%20N%B0003%201.gif)
 permet d'enregistrer l'expression régulière. Elle sera proposée dans la liste des expressions régulières prédéfinies, préfixée par "Perso". 





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Lesexpressionsregulieres.gif) ***Exemples unitaires (WINDEV)*** : **Les expressions régulières** <br>Utilisation des expressions régulières avec WINDEV.<br>Deux types d'utilisation des expressions régulières sont présentés :<br>- vérification du format d'une saisie<br>- extraction des différents éléments respectant le format d'une saisie.<br>Cet exemple montre également comment rechercher un mot dans une chaîne, avec possiblité de ne pas prendre en compte la casse, le début ou la fin d'une chaîne, mais également de ne pas tenir compte des espaces (n'importe où dans la chaîne, y compris dans le mot recherché)
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Lesexpressionsregulieres.gif) ***Exemples unitaires (WINDEV Mobile)*** : **Les expressions régulières** <br>Utilisation des expressions régulières avec WINDEV Mobile.<br>Il montre 2 types d'utilisation des expressions régulières :<br>- vérifier le format d'une saisie<br>- extraire les différents éléments respectant le format d'une saisie.<br>Cet exemple montre également comment rechercher un mot dans une chaîne, avec possiblité de ne pas prendre en compte la casse, le début ou la fin d'une chaîne, mais également de ne pas tenir compte des espaces (n'importe où dans la chaîne, y compris dans le mot recherché)
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Masquedesaisieavance.gif) ***Exemples unitaires (WINDEV)*** : **Masque de saisie avancé** <br>Manipulation des masques de saisie dans WINDEV :<br>- Définition du format des positifs/négatifs dans un champ de saisie numérique<br>- Définition de l'apparence des négatifs dans un champ de saisie numérique<br>- Définition de l'apparence de la valeur 0 dans un champ de saisie numérique<br>- Utilisation d'une expression régulière pour empêcher la saisie d'autres caractères que les chiffres 1, 2, 3, 4, 5 et 6.<br>- Utilisation d'une expression régulière pour "réguler" la saisie d'un numéro de plaque d'immatriculation français

<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280std.dll
