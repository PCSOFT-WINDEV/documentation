
## ErreurAsynchrone (Fonction)

***En anglais : ErrorAsynchronous***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Affiche un message d'erreur personnalisé dans une fenêtre d'erreur système non bloquante. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=fonctions_dialogue%20-%20HC%20N%B0003.gif)


Remarques : 

- **Cette fenêtre d'erreur est non bloquante**. Le code WLangage qui suit l'appel à la fonction **ErreurAsynchrone** continue de s'exécuter. Pour fermer la fenêtre, l'utilisateur doit valider le bouton OK. Quand l'utilisateur clique sur le bouton "OK", il est possible d'exécuter le code d'une procédure WLangage.

- Dans le code WLangage suivant l'appel de la fonction, l'ouverture d'une autre fenêtre modale n'est pas possible avant la fermeture de la boîte de dialogue. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) WINDEV permet d'appliquer le gabarit de votre projet à cette boîte de dialogue. Pour plus de détails, consultez [Personnaliser les boîtes de dialogue](../WDLang1/3021003.md).



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
TitreSuivant("Erreur : Traitement interrompu")
ErreurAsynchrone("Le traitement en cours a causé une erreur pour le client " + ...
			CLIENT.IDCLIENT + "." + RC + "Il faudra relancer le traitement pour ce client.", ...
			MaProcédure_Erreur)

PROCEDURE INTERNE MaProcédure_Erreur()
	ToastAffiche("L'utilisateur a fermé la fenêtre.")
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`ErreurAsynchrone(<Texte> [, <Procédure WLangage>])`
---

**`<Texte> : (Chaîne de caractères)`**

Texte à afficher.

**`<Procédure WLangage> : (Nom de procédure ou procédure lambda, optionnel)`**

Nom de la procédure WLangage (appelée "callback") appelée lorsque l'utilisateur clique sur le bouton "OK" de la fenêtre d'erreur. 

Cette procédure WLangage peut correspondre à : 

- un nom de procédure globale, 

- un nom de procédure interne, 

- une procédure lambda. 


Si ce paramètre n'est pas spécifié, aucune procédure n'est exécutée lorsque l'utilisateur clique sur le bouton "OK" de la fenêtre d'erreur. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Caractéristiques de la boîte de dialogue
<a name="caracteristiques_boite_dialogue_ELTPARAGRAPHE000055"></a>

- Le titre de la boîte de dialogue correspond au titre de la fenêtre (ou page) en cours.
	

- Pour modifier ou définir le titre de la boîte de dialogue, utilisez la fonction [TitreSuivant](../WDLang1/3038043.md).




- Le message est cadré à gauche.

- Le libellé du bouton dépend de la langue d'exécution de Windows.

- Le nombre maximum de caractères affichés est limité à 4096. Si une chaîne plus grande est passée en paramètre, elle sera tronquée.

- L'icône affichée (croix blanche) ne peut pas être modifiée.




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Pour personnaliser cette boîte de dialogue** (ainsi que toutes les boîtes de dialogue système de votre application), cochez l'option "Personnaliser les fenêtres système (Info, OuiNon, Confirmer, Dialogue)" dans l'onglet "Style" de la description du projet. Pour plus de détails, consultez [Personnaliser les boîtes de dialogue](../WDLang1/3021003.md).
<a name="NOTE0_2"></a>




### Saut de ligne dans la boîte de dialogue
<a name="saut_ligne_dans_boite_dialogue_ELTPARAGRAPHE000070"></a>La chaîne prédéfinie RC (Retour Chariot) peut être utilisée pour forcer le passage à la ligne suivante. Par exemple :

```wl
ErreurAsynchrone("Une erreur a été détectée lors de la saisie de l'adresse. " + RC + ...
	"Merci de modifier les données concernant le client.")
```


Il est également possible d'utiliser la syntaxe des chaînes multilignes. Par exemple : 

```wl
ErreurAsynchrone(
[
Une erreur a été détectée lors de la saisie de l'adresse.

Merci de modifier les données concernant le client.
])
```



<a name="NOTE0_4"></a>




### Divers
<a name="divers_ELTPARAGRAPHE000085"></a>

- Les timers (fonction [TimerSys](../WDLang1/3015006.md)) ne sont pas stoppés lors de l'appel de cette fonction.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Les événements Windows ne sont pas stoppés lors de l'appel à cette fonction.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) La fonction [DélaiAvantFermeture](../WDLang1/3038040.md) limite le temps d'affichage de toutes les boîtes de dialogue. La boîte de dialogue est automatiquement fermée. Pour les boîtes de question ou de confirmation, la réponse attendue correspond au bouton par défaut. 
	![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Pour limiter uniquement le temps d'affichage d'une boîte de dialogue de type Erreur, utilisez la fonction [ErreurAvecDélai](../WDLang1/1000020529.md).

- Le libellé du bouton s'affiche dans la langue utilisée par Windows sur le poste en cours.



<a name="NOTE0_5"></a>



<a name="XComposante"></a>

## Composante :
wd280obj.dll


