
## OuvreDocument (Fonction)

***En anglais : OpenDocument***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ouvre un document dans une nouvelle fenêtre (non modale) en utilisant l'éditeur WINDEV adapté au document (traitement de texte, tableur, lecteur PDF ou éditeur d'images).

Remarques : 

- Deux syntaxes sont disponibles : 

	- ouverture bloquante d'un document : l'application est bloquée jusqu'à la fermeture de la fenêtre affichant le document. 

	- ouverture asynchrone d'un document : l'application n'est pas bloquée lors de l'ouverture du document. Une procédure WLangage s'exécute lors de la fermeture du document. Cette syntaxe nécessite obligatoirement le nom de la procédure WLangage à exécuter. 




- Pour ouvrir le document sans bloquer l'application et sans spécifier de procédure WLangage, utilisez la fonction [OuvreDocumentAsynchrone](../WDLang1/1410088182.md). 



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
sDocument est une chaîne
sDocument = fSélecteur("C:\Répertoires", "Fichier.docx", ...
       "Sélectionner un fichier", ...
       "Fichier Word (*.docx)" + TAB + ".docx" + RC + "Tableur (*.xlsx)" + TAB + ".xlsx")
SI OuvreDocument(sDocument) = odEchec ALORS
	Erreur("Impossible d'ouvrir le document.")
FIN
```

```wl
OuvreDocument("Mon Document.docx", "Mon Document", odOptionAucune, "", OuvreDocument_Callback)

PROCÉDURE INTERNE OuvreDocument_Callback(DocRésultat, nCR)
	SELON nCR
		CAS odOuvertModifié
			Info("Le document " + DocRésultat + " a été modifié")
		CAS odOuvertNonModifié
			Info("Le document " + DocRésultat + " n'a pas été modifié")
		AUTRE CAS
			Info("Le document " + DocRésultat + " n'a pas pu être ouvert")
	FIN
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Ouvrir un document (syntaxe bloquante)

`<Résultat> = OuvreDocument(<Document> [, <Titre> [, <Options> [, <Mot de passe>]]])`
---

**`<Résultat> : (Constante de type Entier)`**

Compte-rendu de l'ouverture du document : 



|   |   |
| --- | --- |
| *odEchec* | Le document n'a pas pu être ouvert. |
| *odOuvertModifié* | Le document a été ouvert et a été modifié. |
| *odOuvertNonModifié* | Le document a été ouvert mais il n'a pas été modifié. |



**`<Document> : (Chaîne de caractères)`**

Document à ouvrir. Correspond :

- au chemin complet ou relatif du fichier du document à ouvrir.

- à un buffer ou un mémo HFSQL contenant le document à ouvrir. Si la fonction renvoie la constante *odOuvertModifié*, le paramètre &lt;Document&gt; contiendra le buffer ou mémo HFSQL modifié et enregistré lors de l'édition du document.

- à une variable de type [Document](../WDLang1/1000022461.md), [xlsDocument](../WDLang5/1000017464.md) ou [Image](../WDLang1/1000019650.md). Si la fonction renvoie la constante *odOuvertModifié*, le paramètre &lt;Document&gt; contiendra la variable modifiée et enregistrée lors de l'édition du document.




**`<Titre> : (Chaîne de caractères optionnelle)`**

Titre de la fenêtre ouverte pour afficher le document. Par défaut, ce paramètre correspond au titre de la fenêtre en cours. 

**`<Options> : (Constante ou combinaison de constantes optionnelle de type Entier)`**

Options d'ouverture du document :



|   |   |
| --- | --- |
| *odOptionAucune*<br>(valeur par défaut) | Document ouvert en lecture/écriture dans une fenêtre non maximisée. |
| *odOptionFenêtreMaxi* | Document ouvert en lecture/écriture dans une fenêtre maximisée. |
| *odOptionLectureSeule* | Document ouvert en lecture seule.  <br><br> |
| *odOptionVoletInvisible* | Si le document correspond à une image, l'image est affichée dans l'éditeur d'images et le volet de droite (permettant par exemple d'afficher les caractéristiques de couleur) n'est pas affiché par défaut.  <br> |



**`<Mot de passe> : (Chaîne de caractères optionnelle)`**



- Mot de passe à utiliser si le fichier est protégé,

- Chaîne vide ("") si le fichier n'est pas protégé par un mot de passe.





<a name="SYNTAXE2"></a>

### Ouvrir un document (syntaxe asynchrone, non bloquante)

`<Résultat> = OuvreDocument(<Document> , <Titre> , <Options> , <Mot de passe> , <Procédure WLangage>)`
---

**`<Résultat> : (Constante de type Entier)`**

Compte-rendu de l'ouverture du document : 



|   |   |
| --- | --- |
| *odEchec* | Le document n'a pas pu être ouvert. |
| *odOuvertNonModifié* | Le document a été ouvert mais il n'a pas été modifié. |



**`<Document> : (Chaîne de caractères)`**

Document à ouvrir. Correspond :

- au chemin complet ou relatif du fichier du document à ouvrir.

- à un buffer ou un mémo HFSQL contenant le document à ouvrir. Si la fonction renvoie la constante *odOuvertModifié*, le paramètre &lt;Document&gt; contiendra le buffer ou mémo HFSQL modifié et enregistré lors de l'édition du document.

- à une variable de type [Document](../WDLang1/1000022461.md), [xlsDocument](../WDLang5/1000017464.md) ou [Image](../WDLang1/1000019650.md). Si la fonction renvoie la constante *odOuvertModifié*, le paramètre &lt;Document&gt; contiendra la variable modifiée et enregistrée lors de l'édition du document.




**`<Titre> : (Chaîne de caractères)`**

Titre de la fenêtre ouverte pour afficher le document. Par défaut, ce paramètre correspond au titre de la fenêtre en cours. 

**`<Options> : (Constante de type Entier)`**

Options d'ouverture du document :



|   |   |
| --- | --- |
| *odOptionAucune*<br>(valeur par défaut) | Document ouvert en lecture/écriture dans une fenêtre non maximisée. |
| *odOptionFenêtreMaxi* | Document ouvert en lecture/écriture dans une fenêtre maximisée. |
| *odOptionLectureSeule* | Document ouvert en lecture seule. Cette constante peut être combinée aux constantes *odOptionAucune* et *odOptionFenêtreMaxi*. <br><br> |
| *odOptionVoletInvisible* | Si le document correspond à une image, l'image est affichée dans l'éditeur d'images en mode lecture/écriture et le volet de droite (permettant par exemple d'afficher les caractéristiques de couleur) n'est pas affiché par défaut.  <br> |



**`<Mot de passe> : (Chaîne de caractères)`**



- Mot de passe à utiliser si le fichier est protégé,

- Chaîne vide ("") si le fichier n'est pas protégé par un mot de passe.




**`<Procédure WLangage> : (Nom de procédure ou procédure lambda)`**

Nom de la procédure WLangage (appelée "callback") appelée après la fermeture de la fenêtre d'édition du document. Pour plus de détails sur cette procédure, consultez [Paramètres de la procédure utilisée par la fonction OuvreDocument](../WDLang1/1000024816.md). 

Cette procédure WLangage peut correspondre à : 

- un nom de procédure globale, 

- un nom de procédure interne, 

- une procédure lambda. 






<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
