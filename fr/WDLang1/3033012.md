
## eChangeDevise (Fonction)

***En anglais : eChangeCurrency***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Convertit une devise en une autre devise.

**Remarque** : Les devises converties peuvent être différentes de l'Euro. Pour les conversions en Euro, utilisez les fonctions [eVersDevise](../WDLang1/3033001.md) et [eVersEuro](../WDLang1/3033005.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Conversion de francs en marks
ResConversion = eChangeDevise(150, eFRF, eDEM)
```




<a name="Exemple2"></a>


![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Conversion de Pesetas en Francs Belge avec gestion de l'écart d'arrondi
// Deux décimales sont utilisées pour la conversion
ResConversion = eChangeDevise(10000, eESP, eBEF, 2, ResEcart)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = eChangeDevise(<Valeur à convertir> , <Devise source> , <Devise destination> [, <Nombre de décimales> [, <Écart d'arrondi>]])`
---

**`<Résultat> : (Monétaire)`**

Valeur convertie dans la devise spécifiée.



**`<Valeur à convertir> : (Monétaire)`**

Somme à convertir. Cette valeur est convertie :

- de la &lt;Devise source&gt; vers la devise d'identifiant "0" (l'Euro par défaut),

- de la devise d'identifiant "0" (l'Euro par défaut) vers la &lt;Devise destination&gt;.






**`<Devise source> : (Entier ou constante)`**

Identifiant de la devise source ou constante associée à la devise source (voir Notes).

**`<Devise destination> : (Entier ou constante)`**

Identifiant de la devise destination ou constante associée à la devise destination (voir Notes).

**`<Nombre de décimales> : (Entier optionnel)`**

Nombre de décimales utilisées pour le résultat de la conversion (2 par défaut).

**`<Écart d'arrondi> : (Monétaire optionnel)`**

Variable récupérant l'écart d'arrondi dû à la conversion et à l'arrondi. Cet écart est exprimé dans la devise source.





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Table des changes
<a name="table_des_changes_ELTPARAGRAPHE000093"></a>Une ***table des changes ***est conservée en mémoire. A chaque monnaie sont associés :

- Un numéro de devise permettant d'identifier la devise par programmation.

- Une constante permettant d'identifier la devise par programmation.

- Un libellé (7 caractères maximum) : ce libellé est affiché dans le champ "Monétaire + Euro" si le masque de saisie le permet (le signe $ est indiqué).

- Un taux de change. Ce taux de change correspond au taux de change de la monnaie par rapport à l'Euro.




Cette table des changes est la suivante :

| Numéro de devise | Constante | Pays | Taux de change | Libellé par défaut |
| --- | --- | --- | --- | --- |
| 0 | *eEUR* | Zone Euro | 1 | EURO |
| 1 | *eFRF* | France | 6.55957 | F |
| 2 | *eITL* | Italie | 1936.27 | ITL |
| 3 | *eBEF* | Belgique | 40.3399 | BEF |
| 4 | *eLUF* | Luxembourg | 40.3399 | LUF |
| 5 | *eDEM* | Allemagne | 1.95583 | DEM |
| 6 | *eATS* | Autriche | 13.7603 | ATS |
| 8 | *eESP* | Espagne | 166.386 | ESP |
| 9 | *eIEP* | Irlande | 0.787564 | IEP |
| 10 | *eNLG* | Pays Bas | 2.20371 | NLG |
| 11 | *ePTE* | Portugal | 200.482 | PTE |
| 14 | *eGRD* | Grèce | 340.750 | GRD |
| 15 | *eFIM* | Finlande | 5.94573 | FIM |
| **Monnaies non intégrées à l'Euro** |
|   |   |   |   |   |
| 7 | *eDKK* | Danemark | 0 | DKK |
| 12 | *eGBP* | Grande-Bretagne | 0 | GBP |
| 13 | *eSEK* | Suède | 0 | SEK |
| 16 - 25 |   |   | 0 | Libre1 à Libre10 |
| 26 | *eCYP* | Chypre | 0 | CYP |
| 27 | *eCZK* | République Tchèque | 0 | CZK |
| 28 | *eEEK* | Estonie | 0 | EEK |
| 29 | *eHUF* | Hongrie | 0 | HUF |
| 30 | *eLTL* | Lituanie | 0 | LTL |
| 31 | *eLVL* | Lettonie | 0 | LVL |
| 32 | *eMTL* | Malte | 0 | MTL |
| 33 | *ePLN* | Pologne | 0 | PLN |
| 34 | *eSIT* | Slovénie | 0 | SIT |
| 35 | *eSKK* | Slovaquie | 0 | SKK |





La première devise (ayant pour identifiant 0) est la monnaie prise pour pivot lors des conversions.


Dans cette table des changes, il est possible :

- d'ajouter de nouvelles devises en modifiant si nécessaire les devises personnalisables ("devises utilisateur" de 16 à 25) avec la fonction [eInitDevise](../WDLang1/3033003.md),

- de spécifier le taux de change de chaque devise grâce à la fonction [eInitDevise](../WDLang1/3033003.md).




**Attention** : Les monnaies ayant un taux de change nul n'apparaîtront pas dans le menu contextuel du champ de type "Monétaire + Euro". Pour définir les taux de change de ces devises, vous devez les redéfinir dans le code d'initialisation du projet avec la fonction [eInitDevise](../WDLang1/3033003.md).


<a name="NOTE0_2"></a>
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Écart d'arrondi
<a name="ecart_arrondi_ELTPARAGRAPHE000408"></a>L'&lt;écart d'arrondi&gt; est calculé avec la formule suivante :


```txt
Arrondi(<Valeur à convertir>, <Résultat en devise source>, <Nombre de décimales>)
```


Par exemple :


```wl
Écart est un monétaire
ResConversion est un monétaire
ResConversion = eChangeDevise(1.52, eFRF, eDEM, 2, Ecart)
```


ResConversion vaut 0,45 et Écart vaut 0,01.

Pour retrouver le montant initial, utilisez la ligne de code suivante :


```wl
MontantInit = eChangeDevise(ResConversion, eDEM, eFRF, 2) + Écart
```


<a name="XComposante"></a>

## Composante :
wd280std.dll
