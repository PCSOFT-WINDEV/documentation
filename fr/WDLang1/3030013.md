


## Drag and Drop programmé 
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000249"></a>
Le "Drag and Drop" programmé permet de gérer entièrement le "Glisser/Déplacer" entre différents types de champs. En fonction de son type, le champ peut être source ou cible du "Drag and Drop". 

Cette page d'aide présente : 

- [les champs pris en compte par le Drag and Drop programmé](#NOTE2_1). 

- [les différentes étapes du Drag and Drop programmé](#NOTE3_1). 




Des exemples détaillés d'utilisation du Drag and Drop programmé sont disponibles : 

- [Exemple de Drag and Drop programmé en WINDEV](../WDLang1/3030018.md). 

- [Exemple de Drag and Drop programmé en WEBDEV](../WDLang1/3030017.md).




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Champs pris en compte par le Drag and Drop programmé
<a name="champs_pris_compte_par_drag_and_drop_programme_ELTTEXTE000273"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Les champs pris en compte par le Drag and Drop programmé sont les suivants : 

| Source du Drag and Drop | Cible du Drag and Drop |
| --- | --- |
| Uniquement les champs suivants :<br><br>- Champ de saisie<br><br>- Liste et Liste image<br><br>- Arbre<br><br>- Table<br><br>- Image<br><br>- Code-Barres<br><br>- Bouton<br><br>- Zone répétée<br><br>- Graphe<br><br>- Table hiérarchique<br><br>- Calendrier<br><br>- Agenda<br><br>- Planning<br><br><br> | Tous les types de champs sauf :<br><br>- Jauge<br><br>- ActiveX<br><br>- OLE<br><br>- Forme<br><br>- Barre d'outils<br><br>- HTML<br><br>- Web Caméra<br><br>- Visio conférence<br><br><br> |


Attention : l'option "Scroll au doigt" ne doit pas être cochée dans la fenêtre description du champ. Dans le cas contraire, le Drag and Drop programmé est impossible. 
<a name="NOTE2_2"></a>

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Principe
<a name="principe_ELTTEXTE000303"></a>
Pour réaliser un "Drag and Drop" programmé entre plusieurs champs d'une application WINDEV ou d'un site WEBDEV : 

1. Dans le code d'initialisation du champ source :

	- Définissez qu'un "Drag and Drop" programmé va être réalisé (propriété [DnDSource](../Proprietes/2510014.md)).

	- Définissez la procédure exécutée lors du début de l'action "Glisser" (fonction [DnDEvénement](../WDLang1/3030006.md) pour l'événement ***dndDébutGlisser***).




2. Dans le code d'initialisation du champ cible :

	- Définissez qu'un "Drag and Drop" programmé va être réalisé (propriété [DndCible](../Proprietes/2510016.md)).

	- Définissez la procédure exécutée lors du survol du champ ([DnDEvénement](../WDLang1/3030006.md) pour l'événement ***dndSurvol***). Dans cette procédure, il est possible de définir le curseur de la souris avec la fonction [DnDCurseur](../WDLang1/3030004.md). 

	- Définissez la procédure exécutée lors du "lâcher" sur le champ ([DnDEvénement](../WDLang1/3030006.md) pour l'événement ***dndLâcher***).




3. Dans chacune des procédures WLangage appelées, définissez l'action à exécuter grâce [aux fonctions "Drag and Drop" du WLangage](../WDLang1/3030011.md).



![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Drag and Drop Programmé mode simplifié
<a name="drag_and_drop_programme_mode_simplifie_ELTPARAGRAPHE000145"></a>Pour activer le "Drag and Drop" programmé, il est également possible d'activer les traitements de "Drag and Drop" dans le code du champ. 
Cette activation remplace l'appel de la fonction [DndEvénement](../WDLang1/3030006.md) ainsi que la création des procédures associées. Cependant, cette gestion simplifiée est disponible uniquement pour les types de champs suivants :

- Table,

- Arbre,

- Table hiérarchique,

- Zone répétée.




Equivalence entre la fonction [DndEvénement](../WDLang1/3030006.md) et les traitements de gestion du Drag and Drop : 


|   |   |
| --- | --- |
| **Mode programmé complet**<br>Constante utilisée par la fonction DndEvénement(Nom procédure, Champ, Constante) | **Mode Programmé simplifié**<br><br><br>Traitement du champ |
| DndDébutGlisser | Début du Glisser/Déplacer Source (DndDébutGlisser) |
| DndEntréeChamp | Entrée en Glisser/Déplacer Cible (DndEntréeChamp) |
| DndFinGlisser | Fin du Glisser/Déplacer Source (DndFinGlisser) |
| DndLâcher | Lâcher en Glisser/Déplacer Cible (DndLâcher) |
| DndSortieChamp | Sortie en Glisser/Déplacer Source (DndSortieChamp) |
| DndSurvol | Survol en Glisser/Déplacer Cible (DndSurvol) |


Le code de la procédure sera inséré directement dans le traitement du champ.


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Draganddrop.gif) ***Exemples unitaires (WINDEV)*** : **Drag and drop** <br>Utilisation du Drag & Drop (Glisser & Déposer) avec les fonctions WLangage. <br><br>Dans cet exemple, nous abordons deux thèmes principaux :<br>1/ Comment gérer le Drag&Drop entre champs WINDEV<br>2/ Comment gérer le Drag&Drop de l'Explorateur de fichiers de Windows vers un champ WINDEV<br><br>Le Drag & Drop permet de déplacer des objets par l'intermédiaire de la souris. Lorsqu'on clique sur un objet, puis qu'on déplace la souris tout en maintenant le bouton gauche enfoncé, il s'agit du "Drag". Lorsqu'on relâche le bouton gauche, il s'agit du "Drop".<br>Le Drag & Drop est utilisable avec WINDEV sur  les champs Liste, Arbre, Table et Image.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LesfonctionnalitesdeDragAndDropHTML5.gif) ***Exemples unitaires (WEBDEV)*** : **Les fonctionnalités de Drag And Drop HTML5** <br>Utilisation des fonctionnalités de Drag n Drop HTML 5 dans un site WEBDEV.




