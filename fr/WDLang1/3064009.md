


## ComposantLocalise (Fonction)

***En anglais : ComponentLocate***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Spécifie le chemin d'accès à un composant externe du projet. Ce composant externe n'est pas chargé.

**Remarque** : Le mode de chargement du composant externe (au lancement du projet, ou à la première utilisation d'un élément du composant externe) est défini lors de l'intégration du composant externe dans le projet.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Chemin d'accès au composant
ResChemin est un entier
ResChemin = ComposantLocalise(MonComposant, "C:\MesComposants")
SELON ResChemin
	CAS cieAbsent :
	Erreur("Le composant spécifié n'est pas présent dans le répertoire indiqué")
	CAS cieVersionTropAncienne, cieVersionTropRécente :
	Erreur("La version du composant est incompatible avec l'exécutable")
	CAS cieChargé :
	Info("Le composant spécifié est déjà chargé")
	CAS ciePrêt :
	Info("Le composant spécifié est disponible")
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ComposantLocalise(<Nom du composant> , <Chemin d'accès du composant>)`
---

**`<Résultat> : (Constante de type entier)`**

Compte-rendu de l'opération :



|   |   |
| --- | --- |
| *cieAbsent* | Le composant externe n'est pas présent dans le chemin indiqué. |
| *cieChargé* | Le composant externe est déjà chargé. La fonction **ComposantLocalise** n'a aucun effet. |
| *ciePrêt* | Le composant externe est disponible et utilisable. |
| *cieVersionTopAncienne* | La version du composant externe est trop ancienne. Il est incompatible avec l'exécutable en cours. |
| *cieVersionTropRécente* | La version du composant externe est trop récente. Il est incompatible avec l'exécutable en cours. |



**`<Nom du composant> : (Chaîne de caractères)`**

Nom du composant externe (qui apparaît sous l'éditeur) dont le chemin d'accès doit être spécifié. Si le nom du composant externe n'est pas connu par le projet, une erreur WLangage apparaît.

**`<Chemin d'accès du composant> : (Chaîne de caractères)`**

Répertoire du composant externe (fichier WDK). Ce répertoire peut être terminé indifféremment par "\\" ou non. Un chemin complet, relatif ou de type UNC peut être utilisé.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Chargement d'un composant externe
<a name="chargement_composant_externe_ELTPARAGRAPHE000061"></a>Le mode de chargement du composant externe (au lancement du projet, ou à la première utilisation d'un élément du composant) est défini lors de l'intégration du composant externe dans le projet.

Pour modifier ce mode de chargement :

1. Dans le volet "Explorateur de projet" : 

	- sélectionnez le dossier "Composants externes". 

	- affichez le menu contextuel de ce dossier (clic droit)

	- sélectionnez l'option "Liste des composants externes importés dans le projet".




2. Dans la fenêtre qui s'affiche, sélectionnez le composant externe voulu et cliquez sur le bouton "Description".

3. Modifiez le mode de chargement (option "Mode de chargement du composant").




**Rappel** : Lors du chargement d'un composant externe, les événements suivants sont exécutés :

- événement de déclaration des classes du composant.

- événement de déclaration des collections de procédures du composant.

- événement d'initialisation du composant.



<a name="NOTE0_2"></a>


### Recherche du composant externe à charger
<a name="recherche_composant_externe_charger_ELTPARAGRAPHE000084"></a>Lors du chargement du composant externe, le composant externe sera recherché :

- tout d'abord, dans le répertoire spécifié dans le paramètre &lt;Répertoire du composant&gt; de la fonction [ComposantCharge](../WDLang1/3014023.md).

- puis, dans le répertoire spécifié dans le paramètre &lt;Répertoire du composant&gt; de la fonction **ComposantLocalise**.

- ensuite, dans le répertoire indiqué dans le fichier "&lt;Nom composant&gt;.INI". Pour plus de détails sur ce fichier, consultez [Déploiement d'une application utilisant un composant externe](../Editeurs/2014004.md).

- enfin, dans le répertoire EXE du projet.




<a name="XComposante"></a>

## Composante :
wd280vm.dll
