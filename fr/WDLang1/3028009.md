
## DDEEvénement (Fonction)

***En anglais : DDEEvent***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Associe une procédure WLangage à un événement DDE : lorsque l'événement DDE se produit, la procédure WLangage associée est automatiquement lancée.

**Remarque** : Cette fonction doit être utilisée uniquement pour le "Nouveau dialogue DDE" de WINDEV ou de WEBDEV.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Provoquer l'appel de la procédure "ReceptionDonnée" chaque fois que 
// le programme reçoit une donnée envoyée par DDE par une autre application
DDEEvénement("ReceptionDonnée", DDEARecevoir)
```

```wl
PROCEDURE ReceptionDonnée
SI (_DDE.Sujet = "MonSujet") ET (_DDE.Item = "MonItem") ALORS
	_DDE.Cr = 1
	Info("Donnée reçue : " + _DDE.Chaîne)
SINON
	_DDE.Cr = 0
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`DDEEvénement(<Nom de la procédure> , <Événements DDE>)`
---

**`<Nom de la procédure> : (Chaîne de caractères)`**

Nom de la procédure WLangage à lancer. Cette procédure peut être une procédure globale ou locale à la fenêtre en cours. Si ce paramètre correspond à une chaîne vide (""), l'association "Procédure - Événement DDE" est annulée.

**`<Événements DDE> : (Constante (ou combinaison de constantes) de type entier)`**




|   |   |   |
| --- | --- | --- |
| *DDEAExécuter* | Le programme reçoit une commande à exécuter provenant d'une autre application.<br><br>&lt;Procédure&gt; peut connaître le sujet concerné par _DDE.Sujet et la donnée reçue par _DDE.Chaîne (_DDE.Item n'a pas de valeur significative). | <br><br>- Si la commande est exécutée, &lt;Procédure&gt; doit mettre à jour _DDE.Cr = 1<br><br>- Si la commande n'est pas exécutée, &lt;Procédure&gt; doit mettre à jour _DDE.Cr = 0<br><br><br> |
| *DDEALier* | Le programme reçoit une demande de lien "tiède" ou "chaud" à une donnée. Cette demande provient d'une autre application.<br><br>&lt;Procédure&gt; peut connaître le sujet et l'item concernés par _DDE.Sujet et _DDE.Item (_DDE.Chaîne n'a pas de valeur significative). | <br><br>- Si le lien est créé, le programme devra appeler [DDEModifie](../WDLang1/3028011.md) à chaque fois que la donnée correspondant au sujet et à l'item sera modifiée. &lt;Procédure&gt; doit mettre à jour _DDE.Cr = 1<br><br>- Si le lien n'est pas créé, &lt;Procédure&gt; doit mettre à jour _DDE.Cr = 0<br><br><br> |
| *DDEAModifier* | Le programme reçoit le signal de la modification de la valeur d'une donnée liée. Ce signal provient d'une autre application.<br><br>Après l'événement DDEAModifier, il faut appeler [DDELien](../WDLang1/3028010.md) ou [DDELienTiède](../WDLang1/3028014.md) pour que &lt;Procédure&gt; soit appelée.<br><br>&lt;Procédure&gt; peut connaître le sujet et l'item concernés par _DDE.Sujet et _DDE.Item. | <br><br>- Si la modification est acceptée, &lt;Procédure&gt; doit mettre à jour _DDE.Cr = 1<br><br>- Si la modification n'est pas acceptée, &lt;Procédure&gt; doit mettre à jour _DDE.Cr = 0<br><br>- Si le lien est chaud, _DDE.Chaîne contient la nouvelle valeur de la donnée liée, sinon _DDE.Chaîne vaut "" (chaîne vide)<br><br><br> |
| *DDEARecevoir* | Le programme reçoit une donnée d'une autre application.<br><br>&lt;Procédure&gt; peut connaître le sujet et l'item concernés par _DDE.Sujet et _DDE.Item et la donnée reçue par _DDE.Chaîne. | <br><br>- Si la donnée est acceptée, &lt;Procédure&gt; doit mettre à jour _DDE.Cr = 1<br><br>- Si la donnée n'est pas acceptée, &lt;Procédure&gt; doit mettre à jour _DDE.Cr = 0<br><br><br> |
| *DDEARépondre* | Le programme reçoit une demande de donnée d'une autre application.<br><br>&lt;Procédure&gt; peut connaître le sujet et l'item concernés par _DDE.Sujet et _DDE.Item (_DDE.Chaîne n'a pas de valeur significative). | <br><br>- Si la demande de donnée est acceptée, &lt;Procédure&gt; doit mettre à jour :<br><br>	- _DDE.Cr = 1<br><br>	- _DDE.Chaîne = &lt;valeur à envoyer à l'application ayant fait la demande&gt;<br><br><br><br><br>- Si la demande de donnée n'est pas acceptée, &lt;Procédure&gt; doit mettre à jour _DDE.Cr = 0<br><br><br> |







<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Limites
<a name="limites_ELTPARAGRAPHE000098"></a>

- La fonction **DDEEvénement** ne peut pas être appelée dans le constructeur ou le destructeur d'une classe.

- La fonction [Multitache](../WDLang1/3015004.md) ne doit pas être exécutée dans une procédure appelée par la fonction **DDEEvénement**.

- Le débogueur ne peut pas être appelé par les touches Ctrl + Pause dans une procédure appelée par la fonction **DDEEvénement**. Il faut alors ajouter le mot-clé [Stop](../Motscles/1511014.md).





<a name="NOTE0_2"></a>




### Valeurs par défaut
<a name="valeurs_par_defaut_ELTPARAGRAPHE000124"></a>Par défaut, _DDE.Cr vaut 1 (OK) et _DDE.Chaîne vaut "" (chaîne vide).


<a name="NOTE0_3"></a>




### Déclencher la même procédure pour plusieurs événements 
<a name="declencher_meme_procedure_pour_plusieurs_evenements_ELTPARAGRAPHE000133"></a>La même procédure peut être déclenchée sur l'action de plusieurs événements DDE. Dans ce cas, la syntaxe est par exemple :


```wl
DDEEvénement("ReceptionDonnée", DDEARecevoir + DDEAModifier)
```


Pour ces deux événements, il faut identifier dans &lt;Nom de la procédure&gt; l'événement DDE qui a déclenché l'appel de la procédure. Pour cela, il suffit de consulter la variable _DDE.Evénement.

La variable _DDE.Evénement renvoie selon le cas :

- *DDEARépondre*.

- *DDEARecevoir*.

- *DDEAExécuter*.

- *DDEALier*.

- *DDEAModifier*.






<a name="XComposante"></a>

## Composante :
wd280std.dll
