
## ToucheEnfoncée (Fonction)

***En anglais : KeyPressed***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Vérifie quelle est la touche enfoncée.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Intégration du fichier "KeyConst.WL" pour gérer les touches du clavier
EXTERNE "KeyConst.WL"
POUR I = 1 A 5000
	Sablier(Vrai)
	Multitâche(-1)
	// Vérification de la touche espace
	SI ToucheEnfoncée(VK_SPACE) = Vrai ALORS Info("Touche espace enfoncée")
	// Vérification de la touche A
	SI ToucheEnfoncée(Asc("A")) = Vrai ALORS Info("Touche A enfoncée")
FIN
Sablier(Faux)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ToucheEnfoncée(<Constante> [, <Changement d'état>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la touche de contrôle est enfoncée ou a changé d'état depuis le dernier appel de la fonction **ToucheEnfoncée**, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Fonctionnement spécifique : 

- <u><u><u><u>Vrai</u></u></u></u> si la touche de contrôle est actuellement enfoncée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Constante> : (Constante de type entier)`**

Identifie la touche de contrôle :


|   |   |
| --- | --- |
| *teAlt* | Touche Alt. |
| *teBoutonD* | Bouton droit de la souris.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *teBoutonG* | Bouton gauche de la souris.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *teControl* | Touche Ctrl. |
| *teEchap* | Touche Echap. |
| *teShift* | Touche Maj. |


Des constantes supplémentaires sont disponibles dans le fichier "KeyConst.wl". Ces constantes permettent d'identifier toutes les touches du clavier. Ce fichier est disponible dans le répertoire "\\Personnel\\Externe" de WINDEV.

**`<Changement d'état> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> (valeur par défaut) pour obtenir un compte-rendu synchrone : touche enfoncée actuellement, 

- <u><u><u><u>Faux</u></u></u></u> pour obtenir un compte-rendu asynchrone : la touche a changé d'état depuis le dernier appel de la fonction **ToucheEnfoncée**.




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre est ignoré. Le compte-rendu est toujours synchrone.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Pour gérer toutes les touches du clavier avec la fonction ToucheEnfoncée :
<a name="pour_gerer_toutes_les_touches_clavier_avec_fonction_toucheenfoncee_ELTPARAGRAPHE000115"></a>

1. Intégrez le fichier KeyConst.WL dans votre projet. Ce fichier associe à chaque touche du clavier une constante spécifique. Ce fichier est disponible dans le répertoire de WINDEV (sous-répertoire Personnel\\Externe). Pour intégrer ce fichier dans vos applications, il est nécessaire d'utiliser le mot-clé [EXTERNE](../Motscles/1511013.md) de la façon suivante :
	
	```wl
	EXTERNE "KEYCONST.wl"
	```


2. Utilisez les constantes dans la fonction **ToucheEnfoncée** :
	
	```wl
	SI ToucheEnfoncée(VK_Space) ALORS ...
	```





Remarques : 

- Pour gérer les touches de caractères, il suffit d'utiliser le code ASCII du caractère (obtenu avec la fonction [Asc](../WDLang1/3024004.md)).

- Toutes les constantes contenues dans le fichier KeyConst.WL commencent par les lettres VK_. A partir du moment où le fichier a été intégré avec le mot-clé [EXTERNE](../Motscles/1511013.md), ces constantes sont proposées par la complétion automatique dans l'éditeur de code.





<a name="NOTE0_2"></a>




### Tester une combinaison de touches
<a name="tester_une_combinaison_touches_ELTPARAGRAPHE000146"></a>Pour tester une combinaison de touches, il suffit de tester deux touches enfoncées :


```wl
SI ToucheEnfoncée(teShift) ET ToucheEnfoncée(VK_TAB) ALORS
	Trace("OK")
FIN
```



<a name="NOTE0_3"></a>




### Interrompre un traitement dans une boucle de parcours
<a name="interrompre_traitement_dans_une_boucle_parcours_ELTPARAGRAPHE000157"></a>Dans une boucle de parcours, pour interrompre le traitement en testant l'appui sur Echap, il faut utiliser la fonction [Multitâche](../WDLang1/3015004.md) avant la fonction **ToucheEnfoncée**.

Exemple :


```wl
HLitPremier(Client, NumCli)
TANTQUE HEnDehors() = Faux
	// Abandon par Echap ?
	Multitâche(-1) 
	SI ToucheEnfoncée(teEchap) = Vrai ALORS SORTIR
	// Traitement
	HLitSuivant(Client, NumCli)
FIN
```



<a name="NOTE0_4"></a>


### Compte-rendu asynchrone 
<a name="compterendu_asynchrone_ELTPARAGRAPHE000175"></a>Pour éviter de récupérer une touche précédemment enfoncée (dans un autre traitement par exemple), il faut ré-initialiser l'état de la touche à tester avec la ligne de code suivante :

```txt
ToucheEnfoncée(<Touche>, Faux)
```

<a name="NOTE0_5"></a>
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Utilisation de la fonction ToucheEnfoncée
<a name="utilisation_fonction_toucheenfoncee_ELTPARAGRAPHE000185"></a>L'application doit avoir le focus pour que la fonction **ToucheEnfoncée** vérifie que la touche spécifiée est enfoncée.

<a name="XComposante"></a>

## Composante :
wd280std.dll
