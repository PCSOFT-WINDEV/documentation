


## ChaîneOccurrence (Fonction)

***En anglais : StringCount***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Calcule : 

- le nombre d'occurrences d'une chaîne de caractères spécifique (en respectant les critères de recherche) dans une autre chaîne de caractères.

- le nombre d'occurrences d'un ensemble de chaînes présentes dans un tableau.





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
Res = ChaîneOccurrence("anastasia", "a")         // Renvoie 4
Res = ChaîneOccurrence("toto titi tito", "to")   // Renvoie 3
Res = ChaîneOccurrence("grille pain", "X")       // Renvoie 0
Res = ChaîneOccurrence("Le merle est dans le chêne", "le") // Renvoie 2
Res = ChaîneOccurrence("Le merle est dans le chêne", "le", MotComplet) // Renvoie 1
Res = ChaîneOccurrence("Le merle est dans le chêne", "le", SansCasse) // Renvoie 3
Res = ChaîneOccurrence("Le merle est dans le chêne", "le", SansCasse + MotComplet) // Renvoie 2
```
<a name="Exemple2"></a>

```wl
Res = ChaîneOccurrence("anastasia", ["a","s"])         // Renvoie 6
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Nombre d'occurrences d'une chaîne de caractères

`<Résultat> = ChaîneOccurrence(<Chaîne initiale> , <Chaîne à rechercher> [, <Options>])`
---

**`<Résultat> : (Entier)`**



- Nombre d'occurrences, 

- 0 si aucune occurrence n'existe ou si &lt;Chaîne à rechercher&gt; correspond à une chaîne vide ("").




**`<Chaîne initiale> : (Chaîne de caractères)`**

Texte dans lequel les occurrences de &lt;Chaîne à rechercher&gt; doivent être recherchées.

**`<Chaîne à rechercher> : (Chaîne de caractères)`**

Texte à rechercher dans la &lt;Chaîne initiale&gt;.

**`<Options> : (Constante (ou combinaison de constantes) optionnelle)`**

Options de recherche : 


|   |   |
| --- | --- |
| *MotComplet* | Recherche un mot complet, c'est-à-dire entouré de caractères de ponctuation (caractère différent d'une lettre ou d'un chiffre) ou d'espaces.<br> |
| *SansCasse* | Recherche sans tenir compte de la casse des caractères (majuscules/minuscules). |




<a name="SYNTAXE2"></a>

### Nombre d'occurrences des chaînes de caractères contenues dans un tableau

`<Résultat> = ChaîneOccurrence(<Chaîne initiale> , <Tableau de chaînes à rechercher> [, <Options>])`
---

**`<Résultat> : (Entier)`**



- Nombre d'occurrences, 

- 0 si aucune occurrence n'existe ou si &lt;Tableau de chaînes à rechercher&gt; contient des chaînes vides ("").




**`<Chaîne initiale> : (Chaîne de caractères)`**

Texte dans lequel les occurrences de &lt;Chaîne à rechercher&gt; doivent être recherchées.

**`<Tableau de chaînes à rechercher> : (Tableau)`**

Nom du tableau contenant les chaînes de caractères à rechercher dans la &lt;Chaîne initiale&gt;.

**`<Options> : (Constante (ou combinaison de constantes) optionnelle)`**

Options de recherche : 


|   |   |
| --- | --- |
| *MotComplet* | Recherche un mot complet, c'est-à-dire entouré de caractères de ponctuation (caractère différent d'une lettre ou d'un chiffre) ou d'espaces.<br> |
| *SansCasse* | Recherche sans tenir compte de la casse des caractères (majuscules/minuscules). |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Recherche dans un tableau : gestion des ambiguïtés
<a name="recherche_dans_tableau_gestion_des_ambiguites_ELTPARAGRAPHE000111"></a>Lorsque les chaînes à rechercher sont des sous-chaînes d'autres chaînes présentes dans le tableau, ce sont toujours les chaînes trouvées les plus longues qui sont prises en compte.

Exemple : Si le tableau de chaînes ["bon", "bonjour", "bonsoir"] doit être recherché dans "Bien le bonjour mon bon monsieur", la première occurrence trouvée sera "bonjour" (et non pas "bon").
<a name="NOTE0_2"></a>


### Fonction ChaîneOccurrence et UNICODE
<a name="fonction_docparampagetitleshort_unicode_ELTPARAGRAPHE000126"></a>Il est possible d'utiliser des chaînes ANSI, Unicode et des buffers dans les différents paramètres de la fonction.

La règle de conversion utilisée est la suivante pour les systèmes Ansi (Windows ou Linux) :

- Si l'une au moins des chaînes est un buffer, toutes les chaînes sont converties en buffer, et l'opération est réalisée avec des buffers.

- Si la première condition n'est pas remplie, si l'une au moins des chaînes est Unicode, toutes les chaînes sont converties en Unicode et l'opération est réalisée en Unicode (si nécessaire, la conversion est réalisée avec l'alphabet courant).

- Sinon, l'opération est réalisée en Ansi.




La règle de conversion utilisée est la suivante pour les systèmes Unicode :

- Si l'une au moins des chaînes est un buffer, toutes les chaînes sont converties en buffers et l'opération est réalisée avec des buffers.

- Sinon, l'opération est réalisée en Unicode.




Pour plus de détails sur l'UNICODE, consultez [Gestion de l'UNICODE](../WDLang1/3024038.md).

Rappel : Les paramètres linguistiques utilisés sont définis lors de l'appel de la fonction [ChangeAlphabet](../WDLang1/3054001.md).

<a name="XComposante"></a>

## Composante :
wd280vm.dll
