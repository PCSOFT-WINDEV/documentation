
## gImage (Fonction)

***En anglais : gImage***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Construit une séquence de caractères contenant une image. 

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Dans une fenêtre, cette séquence de caractères permet d'insérer une image : 

- dans un élément d'un champ Liste ou d'un champ Combo.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) dans la barre de titre et/ou de message d'une fenêtre. 

- dans un champ Libellé. 

- dans une colonne de type Texte d'un champ Table.




L'image insérée peut être :

- soit une image classique,

- soit une image composée de plusieurs dessins. Cette image aura été préalablement découpée (grâce à la fonction [ChargeImage](../WDLang1/3029022.md) ou à la fonction [ChargePlancheImage](../WDLang1/1000018826.md)).





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Ajout de l'image "C:\MesImages\Image.BMP" dans le champ "LISTE_Client"
ListeAjoute(LISTE_Client, gImage("C:\MesImages\Image.BMP"))
```

```wl
// Ajout d'une image constituée de plusieurs dessins
// Découpage en 10 lignes et 2 colonnes
// Chargement en mémoire de l'image "C:\MesImages\ImageDec.BMP"
ChargeImage(IDImage, "C:\MesImages\ImageDec.BMP", 10, 2)
POUR RangDessin = 1 A 10*2
	ListeAjoute(LISTE_Client, gImage(IDImage, RangDessin))
FIN
```


<a name="Exemple2"></a>

```wl
// Ajout d'une image dans le titre d'une colonne d'un champ Table
TABLE_MaTable.COL_MaColonne.Titre = gImage("MonImage.BMP") + "Mon titre"
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Insérer une image classique

`<Résultat> = gImage(<Nom de l'image>)`
---

**`<Résultat> : (Chaîne de caractères)`**

Séquence de caractères de la forme &lt;Identifiant de l'image&gt;, &lt;Rang du dessin&gt;. 

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette séquence de caractères peut être : 

- utilisée dans les fonctions [ListeAjoute](../WDLang1/3049004.md), [ListeInsère](../WDLang1/3049002.md) ou [ListeModifie](../WDLang1/3049009.md).

- affectée à un champ Libellé. 

- utilisée dans la barre de titre ou de message d'une fenêtre. 

- utilisée dans une colonne de type Texte d'un champ Table.




**`<Nom de l'image> : (Chaîne de caractères)`**



- Nom et chemin complet (ou relatif) de l'image à insérer. Un chemin de type UNC peut être utilisé. 

- Nom d'un champ Image contenant l'image à insérer.  





<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Insérer une image composée de plusieurs dessins

`<Résultat> = gImage(<Identifiant de l'image> , <Rang du dessin>)`
---

**`<Résultat> : (Chaîne de caractères)`**

Séquence de caractères de la forme &lt;Identifiant de l'image&gt;, &lt;Rang du dessin&gt;. 

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette séquence de caractères peut être : 

- utilisée dans les fonctions [ListeAjoute](../WDLang1/3049004.md), [ListeInsère](../WDLang1/3049002.md) ou [ListeModifie](../WDLang1/3049009.md).

- affectée à un champ Libellé. 

- utilisée dans la barre de titre ou de message d'une fenêtre. 

- utilisée dans une colonne de type Texte d'un champ Table.




**`<Identifiant de l'image> : (Entier)`**

Identifiant de l'image (compris entre 1 et 9) correspondant à l'identifiant de l'image découpée et chargée en mémoire grâce à la fonction [ChargeImage](../WDLang1/3029022.md) ou à la fonction [ChargePlancheImage](../WDLang1/1000018826.md).

**`<Rang du dessin> : (Entier)`**

Numéro du dessin découpé. L'ensemble des dessins constitue l'image. Ce nombre est compris entre 1 et le résultat de la multiplication des paramètres &lt;Nombre de colonnes&gt; et &lt;Nombre de lignes&gt; de la fonction [ChargeImage](../WDLang1/3029022.md) ou de la fonction [ChargePlancheImage](../WDLang1/1000018826.md). 






<a name="SYNTAXE3"></a>

### Insérer une image contenue dans une variable Image

`<Résultat> = gImage(<Image> [, <Mode>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Séquence de caractères de la forme &lt;Identifiant de l'image&gt;, &lt;Rang du dessin&gt;. 

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette séquence de caractères peut être : 

- utilisée dans les fonctions [ListeAjoute](../WDLang1/3049004.md), [ListeInsère](../WDLang1/3049002.md) ou [ListeModifie](../WDLang1/3049009.md).

- affectée à un champ Libellé. 

- utilisée dans la barre de titre ou de message d'une fenêtre. 

- utilisée dans une colonne de type Texte d'un champ Table.




**`<Image> : (Variable de type image)`**

Nom de la variable de type [Image](../WDLang1/1000019650.md) à insérer. 

**`<Mode> : (Constante optionnelle de type Entier)`**

Mode d'affichage de l'image : 


|   |   |
| --- | --- |
| *imgCentré* | Centrée : Image centrée dans le champ.<br><br><br><br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IMG_Centre_1.GIF)<br> |
| *imgEtiré* | Etiré : Image déformée pour occuper toute la surface du champ.<br><br><br><br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IMG_Etiree.GIF)<br> |
| *imgHC* | Homothétique centré : Image agrandie ou rétrécie en respectant les proportions de l'image d'origine pour être affichée entièrement dans le champ et centrée dans le champ.<br><br><br><br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IMG_Homocentre.GIF)<br> |
| *imgHE* | Homothétique étendu : Image agrandie ou rétrécie en respectant les proportions de l'image d'origine pour que le plus petit côté de l'image soit affiché entièrement dans le champ.<br><br><br><br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IMG_HomoEtendu.GIF)<br> |
| *imgHEC* | Homothétique étendu centré : Image agrandie ou rétrécie en respectant les proportions de l'image d'origine pour que le plus petit côté de l'image soit affiché entièrement dans le champ et que l'image soit centrée dans le champ.<br><br><br><br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IMG_HomoCentreEtendu.GIF)<br> |
| *imgHSA* | Homothétique sans agrandissement : Si l'image peut être affichée entièrement dans le champ, elle est affichée à 100%. Sinon, l'image est automatiquement réduite proportionnellement pour être affichée entièrement. |
| *imgHSAC* | Homothétique sans agrandissement : Si l'image peut être affichée entièrement dans le champ, elle est affichée à 100% et centrée dans le champ. Sinon, l'image est automatiquement réduite proportionnellement pour être affichée entièrement au centre du champ. |
| *imgNormal* | 100% : Image affichée à 100% en haut à gauche du champ.<br><br><br><br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IMG_100_1.GIF)<br> |
| *imgSansEchelle* | En mode "Grandes polices" de Windows, l'image affichée dans un champ Image est automatiquement zoomée.<br><br>La constante *imgSansEchelle* permet de ne pas zoomer l'image en mode "Grandes polices". Cette constante est utile notamment pour les champs dans lesquels un dessin est réalisé sur une image bitmap provenant d'une copie d'écran. <br><br><br><br>Cette constante doit être combinée avec une des constantes permettant de définir le mode d'affichage de l'image. <br><br><br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Insertion d'images
<a name="insertion_images_ELTPARAGRAPHE000266"></a>

- La fonction **gImage** peut être utilisée pour insérer une image : 

	- dans les barres de titre et de message d'une fenêtre ou dans un champ Libellé.

	- dans un champ Table. Dans ce cas, l'image doit être insérée dans une colonne de type texte.




- Pour afficher un texte sur une image :

	- Insérez une image avec la fonction **gImage**,

	- Décrivez la couleur de fond du texte avec la fonction [gFond](../WDLang1/3029037.md) en utilisant la constante *Transparent*,

	- Affichez le texte.
			Par exemple :
			
		```wl
		ListeAjoute(LISTE_ListeImage, gImage(CheminImage) + gFond(Transparent) + gCoord(0, 0) + ...
			"Texte")
		```





- Si une ligne d'un champ Combo affiche une image à l'aide de la fonction **gImage**, lorsque cette ligne est sélectionnée, l'image est reprise en ligne principale.



<a name="NOTE0_2"></a>


### Hauteur de l'image (champ Liste ou champ Combo)
<a name="hauteur_image_champ_liste_champ_combo_ELTPARAGRAPHE000300"></a>La hauteur de l'image affichée dans un élément d'un champ Liste ou champ Combo est tronquée au nombre de pixels indiqué lors de la création du champ (onglet "Style" de la description du champ).


<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Image dans le titre d'une colonne d'un champ Table
<a name="image_dans_titre_une_colonne_champ_table_ELTPARAGRAPHE000311"></a>La propriété [ImageTitre](../Proprietes/1000018306.md) permet d'inclure simplement une image dans le titre d'une colonne d'un champ Table.

<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280mdl.dll
