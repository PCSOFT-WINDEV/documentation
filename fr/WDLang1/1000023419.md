
## FenRafraîchissementVisible (Fonction)

***En anglais : WinRefreshVisible***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie ou retourne l'état de visibilité du bandeau de rafraîchissement d'une fenêtre.

Cette fonction peut être utilisée lorsque la fenêtre gère l'option "Pull-to-refresh". Pour activer cette option dans une fenêtre : 

1. Affichez la fenêtre de description de la fenêtre. 

2. Dans l'onglet "Détail", dans la zone "Autres paramètres", cochez l'option "Rafraîchissement par tirer/relâcher (Pull to refresh)". 

3. Validez. 



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Evénement "Rafraîchissement des données" de la fenêtre
// -------------------------------------------------------------
// Demande à contrôler l'affichage du bandeau de sélection car l'actualisation des
// données de la fenêtre va être effectuée dans un thread secondaire. 
// Dans le cas contraire, le bandeau de rafraîchissement serait automatiquement masqué à la
// fin de l'exécution de l'événement.
FenRafraîchissementVisible(FEN_Produits, Vrai)
// Exécute l'actualisation des données de la fenêtre dans un thread secondaire
ThreadExécute("threadMajFen", threadNormal, ProcThreadMajFen)
```

```wl
//----------------------------------------------------
// Procédure de mise à jour des données de la fenêtre
PROCEDURE ProcThreadMajFen()
// Exécution d'une requête HTTP
HTTPRequete(...)
// Retourne dans le thread principal pour afficher le contenu de la requête dans la fenêtre
ExécuteThreadPrincipal(ProcMajUI, HTTPDonneRésultat())
FIN
```

```wl
// ---------------------------------------------------
// Procédure d'actualisation de l'interface de la fenêtre
PROCEDURE ProcMajUI(sDonnees est une chaîne)
// Traitement des données reçues 
// ...
// Les données sont à jour, on masque le bandeau de rafraîchissement
FenRafraîchissementVisible(FEN_Produits, Faux)
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Modifier l'état de visibilité du bandeau de rafraîchissement

`FenRafraîchissementVisible(<Fenêtre> , <Visible>)`
---

**`<Fenêtre> : (Nom de fenêtre)`**

Nom de la fenêtre à manipuler.

**`<Visible> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> pour afficher le bandeau de rafraîchissement,

- <u><u><u><u>Faux</u></u></u></u> pour le masquer.





<a name="SYNTAXE2"></a>

### Connaître l'état de visibilité du bandeau de rafraîchissement

`<Résultat> = FenRafraîchissementVisible(<Fenêtre>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le bandeau de rafraîchissement est affiché,

- <u><u><u><u>Faux</u></u></u></u> si le bandeau de rafraîchissement est masqué.




**`<Fenêtre> : (Nom de fenêtre)`**

Nom de la fenêtre à manipuler.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Lors d'un "Pull-to-refresh", le bandeau de rafraîchissement correspond à la zone affichée en haut de la fenêtre pendant le rafraîchissement des données.

- La fonction **FenRafraîchissementVisible** permet par exemple de contrôler l'affichage du bandeau de rafraîchissement lorsque l'actualisation des données de la fenêtre est effectuée dans un thread secondaire. Il est ainsi possible d'éviter de figer l'application (l'exemple utilise cette méthode). 

- Lorsque le bandeau de rafraîchissement est rendu visible par la fonction **FenRafraîchissementVisible**, l'événement "Rafraîchissement par tirer/relâcher" de la fenêtre n'est pas exécuté.
	Remarque : Il est possible de forcer l'exécution de cet événement en utilisant la fonction [ExécuteTraitement](../WDLang1/3013031.md) avec la constante *trtTirerPourRafraîchir*.

- Pour masquer le bandeau de rafraîchissement, il est nécessaire d'appeler **FenRafraîchissementVisible(Faux)** autant de fois que **FenRafraîchissementVisible(Vrai)** a été exécuté.




<a name="XComposante"></a>

## Composante :
wd280android.aar
