
## MCIEtat (Fonction)

***En anglais : MCIStatus***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie l'état d'un fichier multimédia, précédemment ouvert (fonction [MCIOuvre](../WDLang1/3051017.md)).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MCIOuvre("Son.wav", "MonSon")
...
SI MCIEtat("MonSon") = MciEtatPause ALORS
	MCIDébut("MonSon")
	MCIJoue("MonSon")
FIN
...
MCIFerme("MonSon")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = MCIEtat(<Fichier multimédia ou alias> [, <Paramètres> [, <Nom de la fenêtre de messages>]])`
---

**`<Résultat> : (Constante de type chaîne de caractères)`**

Etat du fichier (voir tableau ci-dessous) ou chaîne vide en cas d'erreur. Pour connaître le numéro de l'erreur, utilisez la fonction [MCIErr](../WDLang1/3051011.md). Pour connaître le libellé de l'erreur, utilisez la fonction [MCIMsgErr](../WDLang1/3051021.md) ou la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.
Le compte-rendu de la commande peut être connu avec la fonction [MCIRécupère](../WDLang1/3051022.md).


|   |   |
| --- | --- |
| *MciEtatArrêt* | Fichier arrêté |
| *MciEtatEnregistre* | Fichier en cours d'enregistrement |
| *MciEtatJoue* | Fichier ouvert et en cours de lecture |
| *MciEtatOuvert* | Fichier ouvert uniquement. |
| *MciEtatParqué* | Lecteur parqué : les têtes de lecture du lecteur sont parquées. |
| *MciEtatPasPrêt* | Lecteur pas prêt (pas de CD dans le lecteur par exemple) |
| *MciEtatPause* | Fichier en pause |
| *MciEtatRecherche* | Recherche / positionnement en cours dans le fichier |



**`<Fichier multimédia ou alias> : (Chaîne de caractères)`**

Nom du fichier multimédia à manipuler (AVI, MP3, ...) ou alias défini lors de l'ouverture du fichier (fonction [MCIOuvre](../WDLang1/3051017.md)).

**`<Paramètres> : (Chaîne de caractères optionnelle)`**

Paramètres complémentaires si nécessaire. Ces paramètres peuvent être connus en consultant la documentation de la fonction MCI windows "status".
Il est possible d'ajouter la constante *MciAttente* à cette chaîne. Cette constante permet d'indiquer que le programme doit attendre la fin de la commande MCI pour exécuter la suite de l'application. 

**`<Nom de la fenêtre de messages> : (Chaîne de caractères optionnelle)`**

Nom de la fenêtre permettant d'intercepter et de gérer les différents messages envoyés par MMSYSTEM.DLL. Ces messages sont du type MM_xxxxxx et sont récupérables grâce à la fonction [Evénement](../WDLang1/3015011.md). Il est par exemple possible d'obtenir des messages concernant la gestion du lecteur de CD ROM ou du Joystick.  



<a name="XComposante"></a>

## Composante :
wd280std.dll
