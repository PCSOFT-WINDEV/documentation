


## Contrôle à distance : Personnalisation avec une fenêtre
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000141"></a>
Pour personnaliser le contrôle à distance effectué sur une application WINDEV multi-utilisateurs, il est possible de remplacer la fenêtre standard par une fenêtre existante dans votre application.

Cette fenêtre sera utilisée :

- pour afficher le message de connexion impossible,

- pour afficher le message d'avertissement,

- pour afficher le message d'arrêt de l'application.




Cette fenêtre doit respecter certaines normes, aussi bien d'affichage que de programmation.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Caractéristiques de la fenêtre
<a name="caracteristiques_fenetre_ELTTEXTE000165"></a>
La fenêtre personnalisée doit contenir les éléments suivants :

- un champ permettant d'afficher le message destiné aux utilisateurs,

- une procédure permettant de récupérer les paramètres passés à la fenêtre (voir paragraphe programmation).




Cette fenêtre peut contenir n'importe quel  champ, traitement, etc. personnalisé.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Programmation
<a name="programmation_ELTTEXTE000189"></a>


### Procédure associée à la fenêtre personnalisée
<a name="procedure_associee_fenetre_personnalisee_ELTPARAGRAPHE000038"></a>Une procédure doit être déclarée dans le code de déclaration des globales de la fenêtre. En effet, lors de l'ouverture de cette fenêtre par le mécanisme de contrôle à distance, des paramètres sont passés à cette fenêtre et peuvent être récupérés par programmation.

Cette fenêtre doit être associée à une procédure du type :

```txt
PROCEDURE <Nom de la fenêtre>(<Mode>, <Message>, <Temps d'affichage>)
```
où les paramètres sont les suivants :


|   |   |
| --- | --- |
| &lt;Mode&gt; | Récupère le mode de contrôle à distance en cours sous forme de constantes :<br><br>- *acInterdit* : accès interdit à l'application<br><br>- *acAvertissement* : avertissement d'un arrêt imminent<br><br>- *acArrêt* : arrêt de l'application<br><br><br> |
| &lt;Message&gt; | Récupère le message correspondant au mode en cours (ce message doit être affiché dans la fenêtre) |
| &lt;Temps d'affichage&gt; | Temps d'affichage maximal de la fenêtre (en secondes) |


```wl
// Code de déclaration des globales de la fenêtre FEN_MessagePerso
PROCEDURE FEN_MessagePerso(ModeAccès, MessageAAfficher, TempsAff)
SELON ModeAccès
	CAS acInterdit : IMG_ChampIco.Image = "Interdit.BMP"
	CAS acAvertissement : IMG_ChampIco.Image = "Info.BMP"
	CAS acArrêt : IMG_ChampIco.Image = "Arrêt.BMP"
FIN
SAI_ChampMessage = MessageAAfficher
```

<a name="NOTE3_2"></a>


### Appel de la fenêtre personnalisée
<a name="appel_fenetre_personnalisee_ELTPARAGRAPHE000068"></a>Pour utiliser la fenêtre personnalisée pour le contrôle automatique de votre application, utilisez la fonction [AppliContrôle](../WDLang1/3013003.md) de la façon suivante dans le code d'initialisation de votre projet :

```wl
AppliContrôle("U:\MonAppli\WDUPDATE.NET", FEN_MessagePerso)
```


où : 

- FEN_MessagePerso est le nom de la fenêtre personnalisée,

- "WDUPDATE.NET" le fichier de contrôle de l'application.




Conseil : L'appel à la fonction [AppliContrôle](../WDLang1/3013003.md) doit être la première instruction du code d'initialisation du projet.
<a name="NOTE3_3"></a>


### Arrêt de l'application
<a name="arret_application_ELTPARAGRAPHE000089"></a>Lors de l'utilisation d'une fenêtre personnalisée, le mode d'arrêt de l'application (constante *acArrêt*) n'arrête pas automatiquement l'application. Vous devez intégrer l'appel à la fonction [FinProgramme](../WDLang1/3013033.md) dans votre application.


