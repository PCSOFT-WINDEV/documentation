
## ChangeAlphabet (Fonction)

***En anglais : ChangeCharset***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère et/ou change l'alphabet utilisé :

- par toutes les polices écran.

- par toutes les opérations sur les chaînes de caractères (fonctions et/ou opérateurs).




Cette fonction permet de gérer des langues utilisant des alphabets spécifiques. La modification de l'alphabet sera prise en compte à la prochaine ouverture de fenêtre / page. Il est conseillé de fermer et de ré-ouvrir toutes les fenêtres / pages.

**Remarque** : Les différentes polices de caractères sont disponibles dans différents alphabets. Ainsi, la police "Arial" existe aussi bien dans l'alphabet occidental que dans l'alphabet Grec ou Hébreu.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003054001&name=changealphabet_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Passer la langue d'affichage de l'application en chinois
// Sous-langue  : Macao (5)
// Mode de tri : bopomofo traditionnel (3)
Nation(nationChinois) 
// Modifier l'alphabet
ChangeAlphabet(alphabetChinois, langueChinois, 5, 3) 
// Re-afficher la fenêtre "FEN_Fenêtre1"
Utilise(FEN_Fenêtre1)
```


<a name="Exemple2"></a>



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Modifier l'alphabet à utiliser

`<Résultat> = ChangeAlphabet(<Nouvel alphabet> [, <Langue> [, <Sous-langue> [, <Mode de tri>]]])`
---

**`<Résultat> : (Constante de type Entier)`**

Constante identifiant l'alphabet utilisé avant la modification.

**`<Nouvel alphabet> : (Constante de type Entier)`**

Constante correspondant au nouvel alphabet à utiliser :



|   |   |
| --- | --- |
| *alphabetAnsi* | Caractères romains à la norme ANSI |
| *alphabetArabe* | Caractères arabes |
| *alphabetBalte* | Caractères baltes |
| *alphabetChinois* | Caractères chinois (République Populaire de Chine) |
| *alphabetChinoisTraditionnel* | Caractères chinois traditionnel (République de Taïwan) |
| *alphabetCoréen* | Caractères coréens |
| *alphabetDéfaut* | Utilise l'alphabet par défaut du poste. Aucun alphabet n'est forcé. |
| *alphabetEuropeEst* | Caractères d'europe de l'est (polonais, ...) |
| *alphabetGrec* | Caractères grecs |
| *alphabetHébreu* | Caractères hébreux |
| *alphabetJaponais* | Caractères japonais |
| *alphabetMac* | Caractères à la norme Mac Roman (utilisés sur les vieilles versions de Macintosh). |
| *alphabetOccidental* | Caractères romains à la norme ANSI |
| *alphabetRusse* | Caractères russes |
| *alphabetThaï* | Caractères thaï |
| *alphabetTurc* | Caractères turques |
| *alphabetUTF8* | Permet de gérer les pays pouvant utiliser deux alphabets (Hong Kong) et les pays n'ayant pas d'alphabet défini dans Windows (Géorgien et Arménien). |
| *alphabetVietnamien* | Caractères vietnamiens |



**`<Langue> : (Constante optionnelle de type Entier)`**

Nouvelle langue à utiliser. Pour plus de détails sur ces constantes, consultez [Correspondance entre les langues, les sous-langues, les alphabets et les nations](../WDLang1/3054022.md).
Cette langue doit correspondre au &lt;Nouvel alphabet&gt; spécifié. Dans le cas contraire, une erreur WLangage sera générée.
Ce paramètre permet de gérer les spécificités de chaque pays.

**`<Sous-langue> : (Entier optionnel)`**

Nouvelle sous-langue à utiliser. Pour plus de détails sur ces sous-langues, consultez [Correspondance entre les langues, les sous-langues, les alphabets et les nations](../WDLang1/3054022.md).
Cette sous-langue doit correspondre au &lt;Nouvel alphabet&gt; spécifié. Dans le cas contraire, une erreur WLangage sera générée.
Ce paramètre permet de gérer les spécificités de chaque pays.

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre est ignoré.

**`<Mode de tri> : (Entier optionnel)`**

Nouveau mode de tri à utiliser. Seuls les modes de tri suivants sont disponibles. Pour les autres langues, ce paramètre n'est pas disponible.



|   |   |   |   |
| --- | --- | --- | --- |
| **Langue** | **Mode de tri** |
| **Constante** | **Valeur** | **Tri** | **Valeur** |
| *langueAllemand* | 7 | Standard | 0 |
| Annuaire | 1 |
| *langueChinois* | 4 | Phonétique | 0 |
| Unicode | 1 |
| Stroke count order | 2 |
|   | Bopomofo traditionnel | 3 |
| *langueCoréen* | 18 | KSC | 0 |
| Unicode | 1 |
| *langueGéorgien* | 55 | Traditionnel | 0 |
| Moderne | 1 |
| *langueHongrois* | 14 | Standard | 0 |
| Technique | 1 |
| *langueJaponais* | 17 | XJIS | 0 |
| Unicode | 1 |


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre est ignoré.


<a name="SYNTAXE2"></a>

### Récupérer l'alphabet actuellement utilisé

`<Résultat> = ChangeAlphabet()`
---

**`<Résultat> : (Constante de type Entier)`**

Constante identifiant l'alphabet actuellement utilisé.


|   |   |
| --- | --- |
| *alphabetAnsi* | Caractères romains à la norme ANSI |
| *alphabetArabe* | Caractères arabes |
| *alphabetBalte* | Caractères baltes |
| *alphabetChinois* | Caractères chinois (République Populaire de Chine) |
| *alphabetChinoisTraditionnel* | Caractères chinois traditionnel (République de Taïwan) |
| *alphabetCoréen* | Caractères coréens |
| *alphabetDéfaut* | Utilise l'alphabet par défaut du poste. Aucun alphabet n'est forcé. |
| *alphabetEuropeEst* | Caractères d'Europe de l'est (polonais, ...) |
| *alphabetGrec* | Caractères grecs |
| *alphabetHébreu* | Caractères hébreux |
| *alphabetJaponais* | Caractères japonais |
| *alphabetMac* | Caractères à la norme Mac Roman (utilisés sur les vieilles versions de Macintosh). |
| *alphabetOccidental* | Caractères romains à la norme ANSI |
| *alphabetRusse* | Caractères russes |
| *alphabetThaï* | Caractères thaï |
| *alphabetTurc* | Caractères turques |
| *alphabetUTF8* | Permet de gérer les pays pouvant utiliser deux alphabets (Hong Kong) et les pays n'ayant pas d'alphabet défini dans Windows (Géorgien et Arménien). |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Comment utiliser un alphabet spécifique ? 
<a name="comment_utiliser_alphabet_specifique_ELTPARAGRAPHE000364"></a>Pour utiliser un alphabet spécifique (différent du français), vous devez :

1. Installer les fichiers correspondants aux alphabets voulus dans les options régionales de Windows (panneau de configuration).

2. Utiliser la fonction **ChangeAlphabet** dans votre programme.





<a name="NOTE0_2"></a>




### Changement de l'alphabet utilisé par les polices
<a name="changement_alphabet_utilise_par_les_polices_ELTPARAGRAPHE000379"></a>La fonction **ChangeAlphabet** modifie l'alphabet utilisé par toutes les polices. Les polices utilisant l'alphabet demandé doivent être installées sur le poste en cours. 

La fonction **ChangeAlphabet** prend effet immédiatement. Il est conseillé de fermer et de ré-ouvrir toutes les fenêtres ou pages. 
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Pour appliquer ce changement à la fenêtre en cours, il est conseillé d'utiliser la fonction [Utilise](../WDLang1/3038044.md) pour forcer la ré-ouverture de la fenêtre en cours. 

Pour plus de détails sur la gestion des alphabets spécifiques, consultez [Gérer des alphabets spécifiques dans une application](../WDLang1/3054012.md).


<a name="NOTE0_3"></a>




### Changement de l'alphabet utilisé par les opérations sur les chaînes de caractères
<a name="changement_alphabet_utilise_par_les_operations_sur_les_chaines_caracteres_ELTPARAGRAPHE000417"></a>La fonction **ChangeAlphabet** modifie l'alphabet utilisé par les opérations sur les chaînes de caractères. Ce nouvel alphabet sera pris en compte :

- lors de la comparaison de deux chaînes selon l'ordre lexicographique (fonction [ChaîneCompare](../WDLang1/3024011.md) utilisée avec la constante *ccOrdreLexicographique*). Cette comparaison ne tiendra pas compte des "doubles-lettres" (CH en espagnol ou LJ en croate par exemple).

- dans les index HFSQL (mode Classic ou mode Client/Serveur) après construction (ou reconstruction) des index (fonctions [HCréation](../WDLang4/3044255.md), [HCréationSiInexistant](../WDLang4/3044254.md) ou [HRéindexe](../WDLang4/3044133.md) utilisées avec la constante *hChangeAlphabet*). L'ordre de tri dans les index ne prendra pas en compte les "doubles-lettres" (CH en espagnol ou LJ en croate par exemple).




La fonction **ChangeAlphabet** prend effet immédiatement. Il est conseillé de fermer et de ré-ouvrir toutes les fenêtres ou pages.
 
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Pour appliquer ce changement à la fenêtre en cours, il est conseillé d'utiliser la fonction [Utilise](../WDLang1/3038044.md) pour forcer la ré-ouverture de la fenêtre en cours. 

Pour plus de détails sur la gestion des alphabets spécifiques dans les fichiers HFSQL, consultez [Gérer des alphabets spécifiques dans des fichiers de données HFSQL](../WDLang1/3054017.md).


<a name="NOTE0_4"></a>




### Changement de l'alphabet champ par champ
<a name="changement_alphabet_champ_par_champ_ELTPARAGRAPHE000471"></a>Il est également possible de modifier l'alphabet utilisé champ par champ grâce à la propriété [PoliceAlphabet](../Proprietes/2510089.md).


<a name="NOTE0_5"></a>




### Utilisation de l'alphabet alphabetUTF8
<a name="utilisation_alphabet_alphabetutf8_ELTPARAGRAPHE000483"></a>La constante *alphabetUTF8*permet de gérer les pays pouvant utiliser deux alphabets (Hong Kong) et les pays n'ayant pas d'alphabet défini dans Windows.

Dans ce mode, si un alphabet latin est utilisé, les caractères accentués ne sont plus codés sur un octet mais sur plusieurs octets. Au maximum, un caractère peut être codé sur 4 octets. 
Ce mode de fonctionnement entraîne des effets spécifiques lors de la gestion des chaînes de caractères. 
Par exemple, la fonction [Taille](../WDLang1/3024031.md) ne renvoie plus le nombre de caractères mais le nombre d'octets correspondant à la chaîne. Il est conseillé d'utiliser la fonction [UnicodeVersAnsi](../WDLang1/3024025.md) avant de réaliser des opérations précises sur les chaînes de caractères.



<a name="XComposante"></a>

## Composante :
wd280vm.dll
