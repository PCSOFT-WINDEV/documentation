


## SysIconeAjoute (Fonction)

***En anglais : SysIconAdd***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute une icône dans la barre des tâches (en bas à droite de l'écran).<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=SysIconeAjoute%20-%20HC%20N%B0001.gif)


Les éléments suivants peuvent être associés à cette icône :

- un menu contextuel,

- un message de survol de la souris (ou du stylet) sur l'icône,

- une procédure appelée automatiquement lors d'une opération de la souris (ou du stylet) sur l'icône.





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003073001&name=sysiconeajoute_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Ajout de l'icône "C:\Icones\Icone.ICO" dans la barre des tâches
ResAjoutIcone = SysIconeAjoute("C:\Icones\Icone.ICO", "", "Ventes 2022")
```
<a name="Exemple2"></a>

```wl
pProc est une Procédure = MaProc
SysIconeAjoute(fRepExe() + "\icone.ico", MENU_SansNom1, "Message", pProc)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = SysIconeAjoute(<Icône> [, <Nom du menu> [, <Message de survol> [, <Procédure WLangage>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'icône a été ajoutée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Icône> : (Chaîne de caractères ou variable de type Icône)`**

Correspond à un des éléments suivants : 

- Nom et chemin complet (ou relatif) du fichier icône à ajouter. Un chemin de type UNC est autorisé.

- Nom d'une variable de type [Icône](../WDLang1/1000020811.md). 


**Remarque** : La première image valide (non PNG) du fichier icône est utilisée et adaptée au format 16x16. Si le fichier icône contient en première position une image 16x16 / 32 bpp, la qualité de l'icône sera très bonne. Si le fichier icône contient en première position une image 48x48 / 4 bpp, la qualité de l'icône sera médiocre.

**`<Nom du menu> : (Chaîne de caractères optionnelle)`**

Nom du menu contextuel associé à l'icône. 
Si ce paramètre correspond à une chaîne vide ("") ou n'est pas précisé, aucun menu ne sera associé à l'icône.

Ce menu s'affichera lors d'un clic droit de la souris (ou d'un clic du style) sur l'icône. Ce menu doit être un menu d'une fenêtre ouverte (cette fenêtre peut être cachée).



**`<Message de survol> : (Chaîne de caractères optionnelle)`**

Message affiché lors du survol de la souris (ou du stylet) sur l'icône (64 caractères maximum). 
Si ce paramètre correspond à une chaîne vide ("") ou n'est pas précisé, aucun message de survol ne s'affichera.



**`<Procédure WLangage> : (Nom de procédure optionnel)`**

Nom de la procédure WLangage appelée lors d'une opération de la souris (ou du stylet) sur l'icône. Si ce paramètre n'est pas précisé, aucune procédure ne sera exécutée lors d'une opération de la souris sur l'icône.

**Remarque** : Ce paramètre peut correspondre à une variable de type [Procédure](../Motscles/1000018907.md).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Opération de la souris (ou du stylet) sur l'icône
<a name="operation_souris_stylet_sur_icone_ELTPARAGRAPHE000080"></a>Pour chaque opération de la souris (ou du stylet) sur l'icône, la procédure &lt;Procédure WLangage&gt; est appelée. Cette procédure est déclarée de la manière suivante :


```txt
PROCEDURE <Nom de la procédure>(<Type d'opération de la souris / du stylet>)
```
où &lt;Type d'opération de la souris / du stylet&gt; correspond au message Windows identifiant le type d'opération de la souris / du stylet.

Pour gérer simplement les constantes correspondant aux différents types d'opération, insérez le code suivant dans le code d'initialisation du projet :

```wl
EXTERNE "WinConst.wl"
```
Le fichier Winconst.wl contient toutes les déclarations des constantes Windows.

Les différents types d'opérations de la souris sont :

- Double clic gauche : WM_LBUTTONDBLCLK = 515

- Clic gauche enfoncé : WM_LBUTTONDOWN = 513

- Clic gauche relevé : WM_LBUTTONUP = 514

- Double clic milieu : WM_MBUTTONDBLCLK = 521

- Clic milieu enfoncé : WM_MBUTTONDOWN = 519

- Clic milieu relevé : WM_MBUTTONUP = 520

- Double clic droit : WM_RBUTTONDBLCLK = 518

- Clic droit enfoncé : WM_RBUTTONDOWN = 516

- Clic droit relevé : WM_RBUTTONUP = 517




Les différents types d'opérations du stylet sont :

- Double clic : WM_LBUTTONDBLCLK = 515

- Clic enfoncé : WM_LBUTTONDOWN = 513

- Clic relevé : WM_LBUTTONUP = 514



<a name="NOTE0_2"></a>


### Icône dans la barre des tâches
<a name="icone_dans_barre_des_taches_ELTPARAGRAPHE000113"></a>

- Une seule icône peut être ajoutée dans une application. Il n'est pas possible d'en ajouter plusieurs.

- La fonction [SysIconeModifie](../WDLang1/3073027.md) permet de modifier l'icône.

- La fonction [SysIconeSupprime](../WDLang1/3073022.md) permet de supprimer l'icône. L'icône est automatiquement supprimée lors de la fermeture de l'application.

- Pour ajouter l'icône dans la barre des tâches sans afficher l'application dans la barre des tâches, il faut :

	- Utiliser la fonction **SysIconeAjoute** pour afficher l'icône de l'application.

	- Rendre invisible l'application grâce à la fonction [FenEtat](../WDLang1/3038030.md) utilisée sur la première fenêtre du projet.







<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280std.dll
