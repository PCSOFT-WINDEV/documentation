


## APIParamètre (Fonction)

***En anglais : APIConfigure***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie les options d'appel de la fonction [API](../WDLang1/3014005.md) et de la fonction [AppelDLL32](../WDLang1/3014003.md).

Par défaut :

- Les fonctions [API](../WDLang1/3014005.md) et [AppelDLL32](../WDLang1/3014003.md) ne bloquent pas les autres threads.

- Si la fonction de l'API appelée modifie les paramètres systèmes régionaux, les paramètres régionaux précédents sont restaurés.




La fonction **APIParamètre** permet de configurer le comportement par défaut de ces fonctions.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Blocage des threads
APIParamètre(apiBloqueThreads, Vrai)

// Non restauration de la locale
APIParamètre(apiRestaureParamètresSystème, Faux)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Connaître la valeur d'une option des fonctions API et AppelDLL32

`<Résultat> = APIParamètre(<Option>)`
---

**`<Résultat> : (Booléen)`**

Valeur de l'option demandée : 

- <u><u><u><u>Vrai</u></u></u></u> si l'option demandée est activée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Option> : (Constante de type entier)`**

Paramètre dont la valeur est recherchée :


|   |   |
| --- | --- |
| *apiBloqueThreads* | Permet de savoir si la fonction [API](../WDLang1/3014005.md) ou la fonction [AppelDLL32](../WDLang1/3014003.md) bloque les threads pendant son exécution. <br>Par défaut, cette option est désactivée. |
| *apiRestaureParamètresSystème* | Permet de savoir si la fonction [API](../WDLang1/3014005.md) ou la fonction [AppelDLL32](../WDLang1/3014003.md) restaure les paramètres systèmes  régionaux (langue, affichage des décimales, ...) après l'exécution de l'API Windows. <br>Par défaut, cette option est activée. |




<a name="SYNTAXE2"></a>

### Modifier la valeur d'une option des fonctions API et AppelDLL32

`<Résultat> = APIParamètre(<Option> , <Valeur>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'option demandée était activée avant l'utilisation de la fonction **APIParamètre**, 

- <u><u><u><u>Faux</u></u></u></u> si l'option demandée n'était pas activée avant l'utilisation de la fonction **APIParamètre**.




**`<Option> : (Constante de type entier)`**

Paramètre dont la valeur doit être modifiée :


|   |   |
| --- | --- |
| *apiBloqueThreads* | Si le paramètre &lt;Valeur&gt; est à <u><u><u><u>Vrai</u></u></u></u>, les threads sont bloqués pendant l'exécution des fonctions [API](../WDLang1/3014005.md) et [AppelDLL32](../WDLang1/3014003.md). <br>Si le paramètre &lt;Valeur&gt; est à <u><u><u><u>Faux</u></u></u></u>, les threads ne sont pas bloqués pendant l'exécution des fonctions [API](../WDLang1/3014005.md) et [AppelDLL32](../WDLang1/3014003.md). <br>Par défaut, cette option est désactivée. |
| *apiRestaureParamètresSystème* | Si le paramètre &lt;Valeur&gt; est à <u><u><u><u>Vrai</u></u></u></u>, les paramètres systèmes  régionaux (langue, affichage des décimales, ...) sont restaurés après l'exécution de l'API Windows. <br>Si le paramètre &lt;Valeur&gt; est à <u><u><u><u>Faux</u></u></u></u>, les paramètres systèmes  régionaux (langue, affichage des décimales, ...) ne sont pas restaurés après l'exécution de l'API Windows. Dans ce cas, si l'API Windows modifie ces paramètres, les modifications seront conservées. <br>Par défaut, cette option est activée. |



**`<Valeur> : (Booléen)`**

Valeur de l'option demandée : 

- <u><u><u><u>Vrai</u></u></u></u> si l'option demandée doit être activée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.  






<a name="NOTE0"></a>
<a name="XComposante"></a>

## Composante :
wd280vm.dll
