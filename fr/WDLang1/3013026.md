


## ChangeGabarit (Fonction)

***En anglais : ChangeSkinTemplate***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Change dynamiquement le gabarit :

- de toutes les fenêtres de l'application en cours,

- des fenêtres présentes dans les composants WINDEV utilisés par l'application,

- d'une fenêtre spécifique du projet.




**Attention** : 

- Cette fonction n'a aucune influence sur les gabarits appliqués à un état.

- Cette fonction n'a aucune influence sur les fenêtres détourées. Le gabarit n'est pas modifié. 



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Utilisation du gabarit "Mer" pour toutes les fenêtres de l'application
ChangeGabarit("", "C:\MonAppli\Mer.WDY")
```
<a name="Exemple2"></a>

```wl
// Utilisation du gabarit "Emeraude" pour la fenêtre en cours
ChangeGabarit(MaFenêtre.Nom, "Emeraude.WDY")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ChangeGabarit(<Elément à modifier> , <Nouveau gabarit> [, <Procédure WLangage>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le gabarit a été modifié, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème.




**`<Elément à modifier> : (Constante ou chaîne de caractères)`**

Ce paramètre peut correspondre :


|   |   |
| --- | --- |
| "" (chaîne vide) | Le nouveau gabarit sera appliqué à toutes les fenêtres de l'application en cours (y compris les fenêtres présentes dans les composants WINDEV manipulés par l'application). <br>Dans un assemblage .NET généré avec WINDEV, le nouveau gabarit sera appliqué à toutes les fenêtres de l'assemblage en cours et à toutes les fenêtres des assemblages .NET WINDEV qui sont chargés en parallèle par l'application. |
| *TousLesComposants* | Le nouveau gabarit sera appliqué uniquement aux fenêtres présentes dans tous les composants WINDEV manipulés par l'application |
| "&lt;Nom de la fenêtre&gt;" | Le nouveau gabarit sera appliqué uniquement à la fenêtre spécifiée |



**`<Nouveau gabarit> : (Chaîne de caractères)`**

Nom du gabarit à appliquer (nom et chemin si nécessaire du fichier "\*.WDY"). Si ce paramètre correspond à une chaîne vide ("") :

- le gabarit appliqué sera celui défini par défaut sous l'éditeur de fenêtres. **Attention** : Si un gabarit a été dynamiquement appliqué avec la fonction **ChangeGabarit**, ce gabarit dynamique sera conservé.

- les fenêtres déjà ouvertes conserveront le gabarit actuel.  




**`<Procédure WLangage> : (Nom de procédure optionnel)`**

Procédure WLangage (également nommée "callback") appelée quand le gabarit est appliqué sur une fenêtre interne suite à l'appel de la fonction [ChangeFenêtreSource](../WDLang1/3038053.md). 
Cette procédure est de la forme :

```txt
PROCEDURE <Nom de la Procédure>(<Fenêtre interne destination>, <Gabarit>)
```
 où : 

- Le paramètre &lt;Fenêtre interne destination&gt; est une variable de type champ correspondant à la fenêtre interne sur laquelle le gabarit est appliqué. 

- Le paramètre &lt;Gabarit&gt; est une chaîne correspondant au nom du gabarit utilisé. 






<a name="NOTE0"></a>
<a name="NOTE0_1b"></a>

## Remarques


### Ne pas appliquer le gabarit à une des fenêtres du projet
<a name="pas_appliquer_gabarit_une_des_fenetres_projet_ELTPARAGRAPHE000090"></a>Pour ne pas appliquer le gabarit dynamiquement sur une des fenêtres du projet : 

1. Afficher la fenêtre de description de la fenêtre concernée. 

2. Dans l'onglet "Style", cochez l'option "Toujours conserver le style/gabarit d'origine". 

3. Validez. 



<a name="NOTE0_1"></a>


### Fichier ".WDY"
<a name="fichier_wdy_ELTPARAGRAPHE000105"></a>La description d'un gabarit est contenue dans un fichier ".WDY".

Les fichiers ".WDY" correspondant aux gabarits proposés par WINDEV sont livrés avec WINDEV.

Remarques :

- Lors de la création d'un gabarit, le fichier ".WDY" est automatiquement créé.

- Pour générer le fichier ".WDY" d'un gabarit existant, ouvrez le fichier "&lt;NomDuGabarit&gt;.STY" sous WINDEV et enregistrez ce fichier (![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_Enregistrer.gif)
).



<a name="NOTE0_2"></a>


### Déploiement d'une application
<a name="deploiement_une_application_ELTPARAGRAPHE000121"></a>Lors de la création du programme d'installation de votre application, les éléments suivants doivent être ajoutés dans la liste des éléments à installer :

- le fichier ".WDY" correspondant au nouveau gabarit appliqué par la fonction **ChangeGabarit**.

- les fichiers images utilisés par le nouveau gabarit appliqué par la fonction **ChangeGabarit**.




Attention : Les images doivent avoir des noms différents dans les différents gabarits utilisés sinon ces images ne seront pas modifiées. Dans le cas des boutons, l'image du bouton n'est pas concernée par le changement, seule l'image du cadre est remplacée par celle du gabarit.

**Remarque** : Pour ajouter un ou des éléments à la liste des éléments d'un projet :

1. Sous le volet "Projet", dans le groupe "Projet", déroulez "Liste des éléments" et sélectionnez "Liste des éléments du projet".

2. Cliquez sur le bouton "Ajouter".

3. Sélectionnez le ou les fichiers à ajouter et validez.



<a name="NOTE0_3"></a>


### Police de caractères
<a name="police_caracteres_ELTPARAGRAPHE000157"></a>Le changement dynamique de gabarit n'a pas d'effet sur les polices de caractères des libellés. En effet, un changement systématique de la police de caractères peut provoquer des effets d'affichage (libellés tronqués ou superpositions) car la largeur des libellés change avec la police de caractères.

Si l'application d'un gabarit par programmation doit être accompagnée d'un changement de police, utilisez la propriété [Police](../Proprietes/2510095.md) en complément de la fonction **ChangeGabarit**.
<a name="NOTE0_4"></a>


### Style des champs
<a name="style_des_champs_ELTPARAGRAPHE000172"></a>La fonction **ChangeGabarit** change dynamiquement le gabarit de TOUS les champs (champs liés à un style du projet ou champs dissociés). Pour appliquer un style d'un gabarit uniquement à certains champs, utilisez la fonction [ChangeStyle](../WDLang1/1000017171.md) sur les champs concernés.

Remarque : Il est également possible de copier le style d'un champ vers un autre grâce à la propriété [Style](../Proprietes/1000021472.md). 


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDChangementGabarits.gif) ***Exemples didactiques (WINDEV)*** : **WD Changement Gabarits** <br>L’exemple “WD Changement Gabarits” présente une solution de changement dynamique de gabarits par les utilisateurs.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
