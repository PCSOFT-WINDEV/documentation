
## DialogueAsynchrone (Fonction)

***En anglais : DialogAsynchronous***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Affiche une boîte de message non bloquante et appelle une procédure WLangage avec la valeur du bouton cliqué par l'utilisateur.

Remarques : 

- **Cette boîte de dialogue est non bloquante**. Le code WLangage qui suit l'appel à la fonction **DialogueAsynchrone** continue de s'exécuter. Pour fermer la fenêtre, l'utilisateur doit valider un des boutons. Quand l'utilisateur clique sur un des boutons, le code d'une procédure WLangage est exécuté.

- Dans le code WLangage suivant l'appel de la fonction, l'ouverture d'une autre fenêtre modale n'est pas possible avant la fermeture de la boîte de dialogue. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) WINDEV permet d'appliquer le gabarit de votre projet à cette boîte de dialogue. Pour plus de détails, consultez [Personnaliser les boîtes de dialogue](../WDLang1/3021003.md).





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// 1 : Sauver
// 2 : Ne pas sauver
DialogueAsynchrone("Voulez-vous enregistrer les modifications dans le fichier %1?", ...
			MaProcédure_Dialogue, sFichier)

PROCEDURE INTERNE MaProcédure_Dialogue(nRésultat)
	SI nRésultat = 1 ALORS
		ToastAffiche("sauver")
	FIN
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Syntaxe avec utilisation de l'assistant

`DialogueAsynchrone(<Identifiant du message> , <Procédure WLangage> [, <Paramètre 1> [... [, <Paramètre N>]]])`
---

**`<Identifiant du message> : (Entier)`**

Identifie la question posée à l'utilisateur ainsi que les différentes réponses possibles.

**`<Procédure WLangage> : (Nom de procédure ou procédure lambda)`**

Nom de la procédure WLangage (appelée "callback") appelée lorsque l'utilisateur clique sur un des boutons de la fenêtre de dialogue. Cette procédure permet de connaître la valeur du bouton cliqué et si nécessaire d'effectuer un traitement spécifique.
 Pour plus de détails sur cette procédure, consultez [Paramètres de la procédure utilisée par la fonction DialogueAsynchrone](../WDLang1/1000025311.md).  

Cette procédure WLangage peut correspondre à : 

- un nom de procédure globale ou locale, 

- un nom de procédure interne, 

- une procédure lambda.




**`<Paramètre 1> : (Chaîne de caractères optionnelle)`**

Si le message choisi contient des éléments paramétrables (identifiés par %1, %2, ...), ce paramètre permet de donner la valeur voulue à l'élément paramétrable 1. Ainsi la valeur de &lt;Paramètre 1&gt; remplacera %1.



**`<Paramètre N> : (Chaîne de caractères optionnelle)`**

Si le message choisi contient des éléments paramétrables (identifiés par %1, %2, ...), ce paramètre permet de donner la Nième valeur voulue à l'élément paramétrable N. Ainsi la valeur de &lt;Paramètre N&gt; remplacera %N.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Utilisation de la syntaxe avec assistant
<a name="utilisation_syntaxe_avec_assistant_ELTPARAGRAPHE000065"></a>Pour utiliser cette syntaxe, il est nécessaire d'utiliser [l'assistant](../WDLang1/3021020.md) proposé lors de l'écriture du nom de la fonction sous l'éditeur de code (option "&lt;Assistant&gt;" proposée par la [saisie assistée](../Editeurs/2013001.md)). Cet assistant permet de saisir les différents paramètres de la boîte de dialogue qui sera utilisée. Cette fonction ne peut pas être utilisée si la fenêtre de dialogue n'est pas construite avec l'assistant.

Pour lancer l'assistant :

1. Sous l'éditeur de code, saisissez "DialogueAsynchrone(".

2. Cliquez sur l'option "Assistant". L'assistant se lance. Passez à l'étape suivante.

3. Choisissez une question existante ou créez une nouvelle question (option &lt;Cliquez ici pour créer une nouvelle question&gt;). Passez à l'étape suivante.

4. Si vous avez choisi de créer une question, un écran apparaît. Cet écran permet de saisir les différents paramètres de la boîte de dialogue utilisée pour poser la question. Vous pouvez indiquer :

	- Le texte de la question,

	- L'image de la boîte de dialogue,

	- Les différents boutons permettant à l'utilisateur de répondre.




5. Validez l'écran de définition de la question. Le code correspondant est automatiquement inséré dans l'éditeur de code. Appuyez à nouveau sur la touche ENTREE du clavier. Le code complet est ajouté sous l'éditeur de code. Il est possible de modifier les caractéristiques de la boîte de dialogue grâce à l'icône située à côté du texte de la question.

6. Saisissez le nom de la procédure WLangage utilisée. 


Remarque : Pour écrire le code WLangage correspondant à la procédure WLangage, les différentes options possibles correspondant aux boutons de la boîte de dialogue sont indiquées en commentaire avant l'appel de la fonction **DialogueAsynchrone**. 
<a name="NOTE0_2"></a>




### Caractéristiques de la boîte de dialogue
<a name="caracteristiques_boite_dialogue_ELTPARAGRAPHE000097"></a>

- Le titre de la boîte de dialogue correspond au titre de la fenêtre (ou page) en cours.
	

- Pour modifier ou définir le titre de la boîte de dialogue, utilisez la fonction [TitreSuivant](../WDLang1/3038043.md).




- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Le gabarit du projet en cours est automatiquement appliqué à la boîte de dialogue.



<a name="NOTE0_3"></a>




### Divers
<a name="divers_ELTPARAGRAPHE000123"></a>

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) La fonction [DélaiAvantFermeture](../WDLang1/3038040.md) limite le temps d'affichage du message. La boîte de dialogue est automatiquement fermée. Pour les boîtes de question ou de confirmation, la réponse attendue correspond au bouton par défaut.





<a name="NOTE0_4"></a>



<a name="XComposante"></a>

## Composante :
wd280obj.dll


