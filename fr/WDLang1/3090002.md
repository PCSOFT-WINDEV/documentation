
## USBListePériphérique (Fonction)

***En anglais : USBListDevice***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Liste les périphériques USB actuellement branchés sur le poste en cours.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Liste des périphériques USB
sListe est une chaîne = USBListePériphérique()
```


<a name="Exemple2"></a>





```wl
// On commence l'exploration sans spécifier d'identifiant
Explore("")
```

```wl
// ----------------------------------------------------------- 
// Exploration complète de l'arborescence
PROCEDURE Explore(sDébut)
sListe est une chaîne
sListe = USBListePériphérique(sDébut)
SI sListe <> "" ALORS
	sPérif est une chaîne
	POUR TOUTE CHAINE sPerif de sListe SEPAREE PAR RC
	   Trace(USBPropriété(sPerif, USBPropriétéDescription))
	   Explore(sPerif)
	FIN
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = USBListePériphérique([<Identifiant Périphérique> [, <Options>]])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Liste des identifiants des périphériques USB actuellement branchés sur le poste en cours. Par défaut, cette liste est de la forme :
	
	```txt
	<Identifiant 1> + RC + <Identifiant 2> + RC + ...
	```

	Si le paramètre &lt;Options&gt; correspond à la constante *USBLstDescription*, la liste des identifiants est de la forme :
	
	```txt
	<Identifiant 1> + TAB + <Description 1> + RC + <Identifiant 2> + RC + ...
	```

	L'identifiant permet d'identifier un périphérique USB de manière unique. Cet identifiant est utilisé dans les [fonctions USB](../WDLang1/3090005.md) pour manipuler un périphérique.

- Chaîne vide ("") si aucun périphérique USB n'est trouvé.




**`<Identifiant Périphérique> : (Chaîne de caractères optionnelle)`**

Identifiant du périphérique USB à partir duquel la recherche doit être effectuée (voir notes)

**`<Options> : (Constante optionnelle de type Entier)`**

Option de détail du résultat :


|   |   |
| --- | --- |
| *USBLstDescription* | Permet d'obtenir la liste des identifiants des périphériques USB et leur description. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
Les périphériques USB sont organisés sous forme d'arbre.

Les racines sont les contrôleurs USB. Au niveau inférieur se trouvent les concentrateurs (hubs) et les appareils eux-mêmes. Chaque périphérique peut être le "père" d'un "sous-arbre".

Par exemple, un concentrateur USB permet d'accéder aux périphériques qui sont branchés dessus.

![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=USB.gif)


La fonction **USBListePériphérique** peut être appelée sans spécifier d'identifiant. Dans ce cas, seuls les identifiants des contrôleurs USB sont récupérés. Si la fonction **USBListePériphérique** est de nouveau appelée avec ces identifiants, il sera possible de récupérer la liste des périphériques branchés dessus. Il est ainsi possible de continuer à parcourir cet arbre jusqu'à ce que la fonction renvoie "" (chaîne vide).



<a name="XComposante"></a>

## Composante :
wd280std.dll
