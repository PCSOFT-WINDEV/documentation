


## &lt;Variable FichierDisque&gt;.Ecrit (Fonction)

***En anglais : &lt;DiskFile variable&gt;.Write***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Écrit un bloc d'octets dans un fichier externe.

**Attention** : Les éléments ajoutés ne sont pas insérés dans le fichier externe mais écrasent les éléments existants.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Ouverture d'un fichier externe
MonFichier est un FichierDisque
MonFichier = fOuvre("C:\MesRépertoires\Fichier.txt", foLectureEcriture)
SI PAS ErreurDétectée ALORS
	// Écriture dans ce fichier
	ResEcriture = MonFichier.Ecrit("Compte-rendu de la réunion")
	SI ResEcriture <> -1 ALORS
		// ...
	FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Écrire un bloc d'octets dans un fichier externe

`<Résultat> = <Fichier manipulé>.Ecrit(<Bloc à écrire> [, <Taille à écrire>])`
---

**`<Résultat> : (Entier)`**



- Nombre d'octets écrits dans le fichier. 

- -1 en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Fichier manipulé> : (Variable de type FichierDisque)`**

Nom de la variable de type [FichierDisque](../WDLang1/1410088883.md) initialisée avec la fonction [fOuvre](../WDLang1/3036036.md) ou [fCrée](../WDLang1/3036017.md).

**`<Bloc à écrire> : (Chaîne de caractères)`**

Bloc d'octets à écrire dans le fichier (2 Go maximum).

Le format du bloc d'octets est respecté. Aucune conversion n'est effectuée.

**`<Taille à écrire> : (Entier optionnel)`**

Taille en octets de la chaîne à écrire.


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Écrire une portion de mémoire dans un fichier externe (vitesse accélérée)

`<Résultat> = <Fichier manipulé>.Ecrit(<Adresse de la portion de mémoire> , <Taille à écrire>)`
---

**`<Résultat> : (Entier)`**



- Nombre d'octets (de caractères) écrit dans le fichier, 

- -1 en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Fichier manipulé> : (Variable de type FichierDisque)`**

Nom de la variable de type [FichierDisque](../WDLang1/1410088883.md) initialisée avec la fonction [fOuvre](../WDLang1/3036036.md) ou [fCrée](../WDLang1/3036017.md).

**`<Adresse de la portion de mémoire> : (Adresse)`**

Adresse de la portion de mémoire à écrire dans le fichier.

**`<Taille à écrire> : (Entier)`**

Taille en octets à écrire dans le fichier externe (2 Go maximum).
Ce paramètre doit être inférieur ou égal à la taille réelle de l'élément écrit dans le fichier externe. Par exemple, si l'élément à écrire est de 100 octets, &lt;Taille à écrire&gt; doit être inférieur ou égal à 100 octets.
Si ce paramètre est inférieur à la taille réelle de l'élément écrit, seul le nombre d'octets spécifié sera écrit dans le fichier externe.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000345"></a>La fonction **&lt;Variable FichierDisque&gt;.Ecrit** génère une erreur dans les cas suivants :

- le fichier n'est pas ouvert,

- le fichier n'est pas accessible en écriture,

- le fichier est bloqué par un autre poste ou par une autre application,

- il n'y a pas d'espace disponible sur le disque.



<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Fonctionnement sous Windows Vista (et supérieur)
<a name="fonctionnement_sous_windows_vista_superieur_ELTPARAGRAPHE000368"></a>Si cette fonction ne fonctionne pas correctement sous Windows Vista (et supérieur), il est nécessaire de vérifier si le fichier ou le répertoire manipulé ne se trouve pas dans un des répertoires système (répertoire de Windows ou répertoire "Program Files").

**En effet, sous Windows Vista (et supérieur), avec le [mécanisme de l'UAC](../Editeurs/2025014.md) (contrôle des comptes utilisateurs) activé**, il est nécessaire d'avoir les privilèges administrateur pour manipuler / modifier des fichiers ou des répertoires présents dans les répertoires système (répertoire de Windows ou répertoire "Program Files").

**Conseil de programmation** : Si vous devez manipuler / modifier des fichiers ou des répertoires, sans avoir besoin de privilèges administrateur, il est conseillé :

- de ne pas écrire dans le répertoire de Windows ou dans le répertoire "Program Files",

- d'utiliser le répertoire système correspondant à l'application (connu par la fonction [SysRep](../WDLang1/3073026.md) par exemple avec la constante *srAppDataCommun*).


**Remarque** : Sous Windows Vista (et supérieur), le mécanisme de la virtualisation permet de rendre les applications compatible Vista. Si le fichier est créé dans un répertoire système sans avoir les droits nécessaires, ce fichier sera réellement créé dans un autre répertoire (C:\\Users\\&lt;LOGIN&gt;AppData\\Local\\VirtualStore\\Windows\\). Dans ce cas, le fichier ne pourra pas être partagé entre plusieurs applications.
<a name="NOTE0_3"></a>


### Retour chariot à la fin d'une ligne
<a name="retour_chariot_fin_une_ligne_ELTPARAGRAPHE000391"></a>La fonction [&lt;Variable FichierDisque&gt;.EcritLigne](../WDLang1/1410089042.md) permet d'insérer automatiquement un retour chariot (RC) à la fin de la ligne ajoutée. Pour insérer un retour chariot (RC) avec **&lt;Variable FichierDisque&gt;.Ecrit**, il suffit d'utiliser la constante *RC*.

Par exemple :

```wl
MonFichier est un FichierDisque
...
ResEcriture = MonFichier.Ecrit("Compte-rendu" + RC + "Ventes de mars 2021")
```

<a name="NOTE0_4"></a>


### Position dans le fichier
<a name="position_dans_fichier_ELTPARAGRAPHE000417"></a>A l'ouverture d'un fichier, la position en cours correspond :

- au premier octet du fichier (par défaut),

- au dernier octet du fichier si le fichier est ouvert en "ajout" (constante *foAjout*).




Cette position peut être modifiée par la fonction [&lt;Variable FichierDisque&gt;.Positionne](../WDLang1/1410089048.md).

La fonction **&lt;Variable FichierDisque&gt;.Ecrit** écrit les éléments spécifiés à partir de la position en cours. Après l'exécution de **&lt;Variable FichierDisque&gt;.Ecrit**, la position en cours correspond au dernier octet écrit.

Remarque : Pour lire toujours le début de la zone, il faut donc faire appel à la fonction [&lt;Variable FichierDisque&gt;.Positionne](../WDLang1/1410089048.md) puis à la fonction [&lt;Variable FichierDisque&gt;.Lit](../WDLang1/1410089044.md).

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280std.dll
