


## ArbreListeFils (Fonction)

***En anglais : TreeListItem***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Liste les "fils" d'un noeud et les éléments "fils" de ces "fils" dans un champ Arbre. Une procédure du WLangage est appelée pour chaque "fils" trouvé.

Exemple de champ Arbre :
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Arbre_Vocabulaire.gif)

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003018016&name=arbrelistefils_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Liste les "fils" du noeud "Desserts" dans le champ Arbre "ARBRE_RecetteTV"
// La procédure "DérouleTout" est appelée
// pour chaque "fils" trouvé du noeud "Desserts"
Res = ArbreListeFils(ARBRE_RecetteTV, "Recettes" + TAB + "Desserts", "DérouleTout")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ArbreListeFils(<Champ Arbre> , <Chemin du noeud> , <Procédure WLangage> [, <Paramètre personnalisé> [, <Identifiant doublons>]])`
---

**`<Résultat> : (Entier)`**

Nombre d'éléments listés.

**`<Champ Arbre> : (Nom de champ)`**

Nom du champ Arbre à manipuler.

**`<Chemin du noeud> : (Chaîne de caractères)`**

Chemin complet du noeud à partir duquel les éléments doivent être listés. Ce paramètre :

- est de la forme :
	
	```txt
	"<Nom de la racine>" + TAB + ["<Nom du 1er noeud>" + TAB + ...
	["<Nom du 2ème noeud>" + TAB + [...]]]"<Nom de la feuille>"
	```
En cas de doublons sur un élément du chemin, ce chemin peut contenir l'identifiant de l'élément (indiqué à la suite du nom grâce à la fonction [ArbreID](../WDLang1/3018027.md)).

- correspond à la constante *NULL* pour lister à partir de la racine du champ Arbre.




**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure WLangage appelée chaque fois qu'un élément "fils" est trouvé. 
Pour plus de détails sur cette procédure, consultez [Paramètres de la procédure utilisée par la fonction ArbreListeFils](../WDLang1/1000024659.md). 

**`<Paramètre personnalisé> : (Entier optionnel)`**

Paramètre passé à la procédure &lt;Procédure WLangage&gt;.

**`<Identifiant doublons> : (Booléen optionnel)`**

Indique le mode de gestion des doublons dans les éléments :

- <u><u><u><u>Faux</u></u></u></u> (par défaut) : aucune gestion n'est effectuée.

- <u><u><u><u>Vrai</u></u></u></u> : les noms des éléments du chemin sont construits de manière à contenir leur identifiant.  






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
<a name="NOTE0_2"></a>


### Interruption de la fonction ArbreListeFils
<a name="interruption_fonction_docparampagetitleshort_ELTPARAGRAPHE000093"></a>La fonction **ArbreListeFils** ne peut pas être interrompue tant qu'il reste des éléments "fils" à parcourir.

Pour forcer l'interruption du parcours effectué par la fonction **ArbreListeFils**, utilisez la ligne suivante dans la procédure &lt;Procédure WLangage&gt; :

```wl
RENVOYER Faux
```


Dans ce cas, la fonction **ArbreListeFils** retourne le nombre d'éléments parcourus jusqu'à l'appel de "RENVOYER Faux".

<a name="XComposante"></a>

## Composante :
wd280obj.dll
