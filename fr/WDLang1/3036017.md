


## fCrée (Fonction)

***En anglais : fCreate***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Crée un fichier externe. Ce fichier est automatiquement ouvert en lecture et écriture.

**Remarques** : 

- Pour manipuler des fichiers externes de type texte, il est conseillé d'utiliser les fonctions [fChargeTexte](../WDLang1/3036006.md)/[fSauveTexte](../WDLang1/3036046.md) et [fChargeBuffer](../WDLang1/1000019410.md)/[fSauveBuffer](../WDLang1/1000019412.md). 

- Pour manipuler des fichiers externes de type binaire, il est conseillé d'utiliser les fonctions **fCrée** ou [fOuvre](../WDLang1/3036036.md). 





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003036017&name=fcree_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Création du fichier externe
ResCréation = fCrée("C:\MesRépertoires\Fichier.txt")
SI ResCréation <> -1 ALORS 
	...
FIN
```


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Création du fichier externe
MonFichier est un FichierDisque
ResOuverture = fCrée("C:\MesRépertoires\Fichier.txt")
SI PAS ErreurDétectée ALORS
	...
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = fCrée(<Chemin du fichier> [, <Options de création>])`
---

**`<Résultat> : (Entier)`**



- un entier :  

	- l'identifiant du fichier externe. Cet identifiant sera utilisé dans toutes les fonctions de manipulation des fichiers externes.

	- -1 en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




- une variable de type [FichierDisque](../WDLang1/1410088883.md). En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.
	




**`<Chemin du fichier> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier (260 caractères maximum). L'extension du fichier peut être précisée. Par défaut, si l'extension du fichier n'est pas précisée, le fichier externe n'aura pas d'extension. Un chemin de type UNC peut être utilisé.

Remarque : Si le fichier externe existe déjà (même répertoire et même nom), ce fichier est détruit et recréé. Pour éviter de supprimer un fichier existant, utilisez la fonction [fOuvre](../WDLang1/3036036.md) avec la constante *foCréationSiInexistant*.



**`<Options de création> : (Combinaison de constantes optionnelle)`**

Options de création du fichier : 

- Options de blocage : Un blocage peut être effectué à l'ouverture du fichier externe : 
	


|   |   |
| --- | --- |
| *foBloqueEcriture* | Le fichier sera créé en écriture seule. Les autres applications utilisant ce fichier ne pourront pas modifier ce fichier. |
| *foBloqueLecture* | Le fichier sera créé en lecture seule. Les autres applications utilisant ce fichier ne pourront pas lire ce fichier. |
| *foSuppressionAutomatique* | Le fichier est bloqué lors de son ouverture et sera automatiquement supprimé à sa fermeture (appel de la fonction [fFerme](../WDLang1/3036027.md) ou à la fin de l'application).<br>Si ce fichier est ouvert par plusieurs applications, le fichier sera automatiquement supprimé lorsque la dernière application fermera le fichier (appel de la fonction [fFerme](../WDLang1/3036027.md) ou à la fin de l'application). |


	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les options de blocage ne sont pas disponibles. Le fichier externe est toujours librement accessible par les autres applications.




- Type du fichier externe à créer. Ce type est utilisé par les fonctions [fLitLigne](../WDLang1/3036031.md) et [fEcritLigne](../WDLang1/3036025.md) pour déterminer le type des informations à lire et écrire dans le fichier externe : 
	


|   |   |
| --- | --- |
| *foAnsi* | Fichier de type Ansi. Cette constante permet de gérer un fichier Ansi lorsque le mode "Utiliser les chaînes Unicode en exécution" est activé au niveau de la configuration de projet.<br><br>Ce mode est utilisé par défaut dans les projets WINDEV et WEBDEV. |
| *foUnicode* | Fichier de type Unicode. Cette constante permet de gérer un fichier Unicode lorsque le mode "Utiliser les chaînes Ansi en exécution" est activé au niveau de la configuration de projet.<br><br>Ce mode est utilisé par défaut dans les projets WINDEV Mobile. |


	





Par défaut, si aucune constante n'est précisée : 

- le fichier externe est librement accessible par les autres applications, 

- le type du fichier correspond au mode par défaut. 






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000238"></a>La fonction **fCrée** génère une erreur dans les cas suivants :

- le fichier est bloqué par un autre poste ou par une autre application,

- l'utilisateur n'a pas les droits en écriture dans le répertoire de création.

- une chaîne Unicode a été utilisée pour le paramètre &lt;Chemin du fichier&gt; sous un système d'exploitation de type Windows 98 ou Windows Me.



<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Fonctionnement sous Windows Vista (et supérieur)
<a name="fonctionnement_sous_windows_vista_superieur_ELTPARAGRAPHE000383"></a>Si cette fonction ne fonctionne pas correctement sous Windows Vista (et supérieur), il est nécessaire de vérifier si le fichier ou le répertoire manipulé ne se trouve pas dans un des répertoires système (répertoire de Windows ou répertoire "Program Files").

**En effet, sous Windows Vista (et supérieur), avec le [mécanisme de l'UAC](../Editeurs/2025014.md) (contrôle des comptes utilisateurs) activé**, il est nécessaire d'avoir les privilèges administrateur pour manipuler / modifier des fichiers ou des répertoires présents dans les répertoires système (répertoire de Windows ou répertoire "Program Files").

**Conseil de programmation** : Si vous devez manipuler / modifier des fichiers ou des répertoires, sans avoir besoin de privilèges administrateur, il est conseillé :

- de ne pas écrire dans le répertoire de Windows ou dans le répertoire "Program Files",

- d'utiliser le répertoire système correspondant à l'application (connu par la fonction [SysRep](../WDLang1/3073026.md) par exemple avec la constante *srAppDataCommun*).


**Remarque** : Sous Windows Vista (et supérieur), le mécanisme de la virtualisation permet de rendre les applications compatible Vista. Si le fichier est créé dans un répertoire système sans avoir les droits nécessaires, ce fichier sera réellement créé dans un autre répertoire (C:\\Users\\&lt;LOGIN&gt;AppData\\Local\\VirtualStore\\Windows\\). Dans ce cas, le fichier ne pourra pas être partagé entre plusieurs applications.


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Manipulationdefichierstexte.gif) ***Exemples unitaires (WINDEV)*** : **Manipulation de fichiers texte** <br>Manipulation des fichiers "texte" avec WINDEV :<br>- Créer un fichier texte<br>- Ecrire dans un fichier texte<br>- Lire dans un fichier texte
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Manipulationdefichierstexte.gif) ***Exemples unitaires (WEBDEV)*** : **Manipulation de fichiers texte** <br>Manipulation des fichiers "non HFSQL" avec WEBDEV (création d'un fichier texte, écriture et lecture)
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Manipulationdefichierstexte.gif) ***Exemples unitaires (WINDEV Mobile)*** : **Manipulation de fichiers texte** <br>Manipulation des fichiers externes de type "texte" :<br>- Créer un fichier texte<br>- Ecrire dans un fichier texte<br>- Lire dans un fichier texte

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280std.dll
