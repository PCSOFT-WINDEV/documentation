
## ExceptionInfo (Fonction)

***En anglais : ExceptionInfo***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère des informations sur l'exception en cours.

Cette fonction est utilisable uniquement dans un traitement d'exception.

**Attention** : Les valeurs de la fonction **ExceptionInfo** sont valides pendant tout le code de traitement de l'exception.






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Code d'initialisation du projet
EXTERNE "Except.WL"
// Chargement des constantes de gestion des exceptions
```

```wl
PROCEDURE ValeurChamp(sNomChamp)
QUAND EXCEPTION DANS
	RENVOYER (sNomChamp)
FAIRE
	SI ExceptionInfo(errCode) = ExIDInconnu ALORS RENVOYER ""
FIN
```




<a name="Exemple2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
QUAND EXCEPTION DANS
 ...
FAIRE
	// Message complet de l'erreur principale
	Trace(ExceptionInfo())
	// Parcours des sous-erreurs (s'il y en a)
	POUR i = 1 A ExceptionInfo(errNombreSousErreur)
		// Message complet de chaque sous-erreur
		Trace("Sous-erreur " + i + " : " + ExceptionInfo(errMessage, i))
	FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Obtenir des informations sur la dernière exception

`<Résultat> = ExceptionInfo([<Type information>])`
---

**`<Résultat> : (Chaîne de caractères ou entier)`**



- Information demandée. 

- Chaîne vide ("") si aucune erreur n'est survenue ou si l'information demandée n'est pas disponible.




**`<Type information> : (Constante optionnelle)`**

Information à renvoyer.


|   |   |
| --- | --- |
| *errCode* | Code de l'erreur |
| *errCodeSystème* | Numéro de l'erreur système (si elle existe)<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *errComplet* | Toutes les informations de l'erreur (ligne de l'erreur, traitement en cours, ...)<br>Remarque : Renvoie les mêmes informations que celles récupérées lors d'un clic sur le bouton "Copier" dans la fenêtre d'erreur du WLangage. |
| *errDateHeure* | Date et heure de l'erreur<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *errElément* | Nom de l'objet associé au traitement en cours lors de l'erreur<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Classe Java associée à l'erreur. |
| *errExceptionDotNet* | Objet Exception .NET<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *errFIC* | Nom complet du fichier de données (.FIC) associé à l'erreur<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *errFichier* | Nom logique du fichier associé à l'erreur<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *errInfo* | Informations complémentaires<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *errLiaison* | Nom de la liaison associée à l'erreur<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *errLigne* | Numéro de la ligne de l'erreur |
| *errMessage*<br>(par défaut) | Message complet de l'erreur |
| *errMessageSystème* | Message d'erreur système (si elle existe)<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *errMMO* | Nom complet du fichier mémo (.MMO) associé à l'erreur<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *errNDX* | Nom complet du fichier d'index (.NDX) associé à l'erreur<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *errNombreSousErreur* | Nombre de sous-erreurs de l'erreur<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *errNomCompletComposant* | Nom complet du composant en cours d'exécution. <br>Quelques exemples :<br><br>- "" (chaîne vide) : contexte principal de l'application<br><br>- "Composant1" : Composant "Composant1" utilisé directement dans le projet<br><br>- "Composant1.Composant2" : Composant "Composant2" utilisé depuis le "Composant1".<br><br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante est ignorée. |
| *errNumEnr* | Numéro de l'enregistrement associé à l'erreur<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *errPendant* | Nom de la fonction WLangage qui a provoqué l'erreur<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *errPile* | Pile des appels WLangage<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *errRésumé* | Résumé de l'erreur |
| *errRubrique* | Nom de la rubrique associée à l'erreur<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *errTraitement* | Nom du traitement en cours lors de l'erreur<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *errWDD* | Nom complet du WDD associé à l'erreur<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |






<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Obtenir des informations sur les sous-erreurs de la dernière exception

`<Résultat> = ExceptionInfo([<Type information>, ] <Indice de la sous-erreur>)`
---

**`<Résultat> : (Chaîne de caractères ou entier)`**



- Information demandée. 

- Chaîne vide ("") si aucune erreur n'est survenue ou si l'information demandée n'est pas disponible.




**`<Type information> : (Constante optionnelle)`**

Information à renvoyer.


|   |   |
| --- | --- |
| *errCode* | Code de l'erreur |
| *errCodeSystème* | Numéro de l'erreur système (si elle existe) |
| *errComplet* | Toutes les informations de l'erreur (ligne de l'erreur, traitement en cours, ...)<br>Remarque : Renvoie les mêmes informations que celles récupérées lors d'un clic sur le bouton "Copier" dans la fenêtre d'erreur du WLangage. |
| *errDateHeure* | Date et heure de l'erreur |
| *errElément* | Nom de l'objet associé au traitement en cours lors de l'erreur |
| *errFIC* | Nom complet du fichier de données (.FIC) associé à l'erreur |
| *errFichier* | Nom logique du fichier associé à l'erreur |
| *errInfo* | Informations complémentaires |
| *errLiaison* | Nom de la liaison associée à l'erreur |
| *errLigne* | Numéro de la ligne de l'erreur |
| *errMessage*<br>(par défaut) | Message complet de l'erreur |
| *errMessageSystème* | Message d'erreur système (si elle existe) |
| *errMMO* | Nom complet du fichier mémo (.MMO) associé à l'erreur |
| *errNDX* | Nom complet du fichier d'index (.NDX) associé à l'erreur |
| *errNumEnr* | Numéro de l'enregistrement associé à l'erreur |
| *errPendant* | Nom de la fonction WLangage qui a provoqué l'erreur |
| *errPile* | Pile des appels WLangage |
| *errRésumé* | Résumé de l'erreur |
| *errRubrique* | Nom de la rubrique associée à l'erreur |
| *errTraitement* | Nom du traitement en cours lors de l'erreur |
| *errWDD* | Nom complet du WDD associé à l'erreur |



**`<Indice de la sous-erreur> : (Entier)`**

Indice de la sous-erreur à manipuler.

Rappel : Le nombre de sous-erreurs d'une exception peut être connu grâce à la constante *errNombreSousErreur*.  



<a name="XComposante"></a>

## Composante :
wd280vm.dll
