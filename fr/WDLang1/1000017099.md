


## ServiceInstalle (Fonction)

***En anglais : ServiceInstall***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Installe un service Windows ou un daemon Linux grâce aux informations données dans les membres de la [variable Service](../WDLang1/1000017118.md).
Ce service/daemon peut être présent sur le poste local ou sur un poste distant.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000018938&name=serviceinstalle_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Exemple d'installation de MantaManager
lsExePath est une chaîne
lsExePath = """D:\Serveur HF\MantaManager.exe"""
Service.Description = "Test d'instal de MantaManager"
Service.Type = serviceTypeSimple
Service.Démarrage = serviceDémarrageAutomatique
Service.ErreurDémarrage = serviceErreurLog
Service.LigneCommande = lsExePath + " --SERVICE"
Service.Utilisateur = "Florence"
Service.MotDePasse = "test"
SI ServiceInstalle("MantaManager") = Faux ALORS
	Erreur("ServiceInstalle('MantaManager'). '" + ErreurInfo(errComplet) + "'")
SINON 
	Info("OK")
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ServiceInstalle(<Nom du service> [, <Poste distant>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'installation a été demandée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Nom du service> : (Chaîne de caractères)`**

Nom du service à installer.

**`<Poste distant> : (Chaîne de caractères optionnelle)`**

Adresse IP du poste distant au format xxx.xxx.xxx.xxx (obtenu par la fonction [NetAdresseIP](../WDLang3/3056023.md)) ou nom du poste distant (obtenu par la fonction [NetNomMachine](../WDLang3/3056014.md)). 
Ce paramètre permet d'installer un service sur un autre poste. Pour utiliser cette option, l'utilisateur doit être administrateur de la machine distante. 
Si ce paramètre n'est pas précisé ou correspond à une chaîne vide (""), le service est manipulé en local.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Limitations
<a name="limitations_ELTPARAGRAPHE000070"></a>

- ![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) A partir de Windows Vista lorsque le mécanisme de l'UAC est activé, la fonction **ServiceInstalle** nécessite les droits d'administrateur.

- ![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) La fonction **ServiceInstalle** nécessite d'être exécutée avec les droits de l'utilisateur 'root'.



<a name="NOTE0_2"></a>


### Démarrage du service
<a name="demarrage_service_ELTPARAGRAPHE000088"></a>La fonction **ServiceInstalle** ne démarre pas automatiquement le service après son installation. Pour démarrer un service, utilisez la fonction [ServiceDémarre](../WDLang1/1000017110.md).
<a name="NOTE0_3"></a>
![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) 

### Installation manuelle d'un service Linux
<a name="installation_manuelle_service_linux_ELTPARAGRAPHE000103"></a>Si la fonction **ServiceInstalle** ne peut pas être utilisée, il est possible d'utiliser les commandes Linux suivantes : 

- lister les services : 

	- Ubuntu : utiliser la commande Service

	- lister le répertoire "/etc/init.d" : 
			
		```txt
		ls /etc/init.d
		```

			Chaque service aura un fichier binaire installé dans ce répertoire. 




- connaître l'état d'un service : 
	
	```txt
	/etc/init.d/nomService status
	```


- arrêter un service : 
	
	```txt
	/etc/init.d/nomService stop
	```


- démarrer un service : 
	
	```txt
	/etc/init.d/nomService start
	```





<a name="XComposante"></a>

## Composante :
wd280std.dll
