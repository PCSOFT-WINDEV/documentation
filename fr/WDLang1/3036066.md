
## fDateHeure (Fonction)

***En anglais : fDateTime***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie ou modifie les différentes dates et heures d'un fichier ou d'un répertoire (date de création, de modification ou d'accès).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003036066&name=fdateheure_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Récupération de la date et heure de modification d'un fichier
ResDate = fDateHeure("C:\MesRépertoires\Fichier.txt", "", fModification)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = fDateHeure(<Chemin du fichier / du répertoire> [, <Nouvelle date et heure> [, <Type de date et heure>]])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Date et heure demandée du fichier ou du répertoire (au format AAAAMMJJHHMMSS), 

- Chaîne vide ("") en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Chemin du fichier / du répertoire> : (Chaîne de caractères)`**



- Nom et chemin complet (ou relatif) du fichier (260 caractères maximum). 

- Chemin complet (ou relatif) du répertoire (260 caractères maximum). Si ce paramètre correspond à un nom de répertoire, ce nom peut être terminé indifféremment par "\\" ou non. Un chemin de type UNC peut être utilisé.










**`<Nouvelle date et heure> : (Chaîne de caractères optionnelle)`**



- Modification d'une date et d'une heure : nouvelle date et heure du fichier / répertoire (au format AAAAMMJJHHmmSS).

- Lecture d'une date et heure : chaîne vide ("").




**`<Type de date et heure> : (Constante optionnelle)`**

Indique la date et l'heure à manipuler :



|   |   |
| --- | --- |
| *fAccès* | Date et heure du dernier accès au fichier/répertoire.<br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *fCréation* | Date et heure de création du fichier/répertoire.<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) La date de création d'un fichier ou d'un répertoire ne peut pas être modifiée.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *fModification*<br>(Valeur par défaut) | Date et heure de dernière modification du fichier/répertoire.<br><br> |


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seuls les fichiers ayant une date supérieure au 1er Janvier 1970 peuvent être modifiés.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Equivalence et vitesse d'exécution
<a name="equivalence_vitesse_execution_ELTPARAGRAPHE000141"></a>La fonction **fDateHeure** est équivalente à l'utilisation successive des fonctions [fDate](../WDLang1/3036019.md) et [fHeure](../WDLang1/3036042.md). Cependant, la fonction **fDateHeure** est plus rapide.


<a name="NOTE0_2"></a>




### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000162"></a>La fonction **fDateHeure** génère une erreur dans les cas suivants :

- le fichier spécifié est ouvert ou le fichier est bloqué par une autre application,

- le fichier / répertoire spécifié n'existe pas,

- le nom du fichier spécifié est invalide,

- l'année de l'une des dates du fichier est inférieure à 1980,

- le format du paramètre &lt;Nouvelle date et heure&gt; est incorrect.

- ...





<a name="NOTE0_3"></a>




### Fonctionnement sous les différents systèmes d'exploitation
<a name="fonctionnement_sous_les_differents_systemes_exploitation_ELTPARAGRAPHE000181"></a>La date et l'heure d'un fichier ou d'un répertoire ne peuvent pas être modifiées sous les systèmes suivants : Windows 98, Windows ME.

![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) La date et l'heure de création d'un fichier ou d'un répertoire ne peuvent pas être modifiées.

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seuls les fichiers ayant une date supérieure au 1er Janvier 1970 peuvent être modifiés.
<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Fonctionnement sous Windows Vista (et supérieur)
<a name="fonctionnement_sous_windows_vista_superieur_ELTPARAGRAPHE000337"></a>Si cette fonction ne fonctionne pas correctement sous Windows Vista (et supérieur), il est nécessaire de vérifier si le fichier ou le répertoire manipulé ne se trouve pas dans un des répertoires système (répertoire de Windows ou répertoire "Program Files").

**En effet, sous Windows Vista (et supérieur), avec le [mécanisme de l'UAC](../Editeurs/2025014.md) (contrôle des comptes utilisateurs) activé**, il est nécessaire d'avoir les privilèges administrateur pour manipuler / modifier des fichiers ou des répertoires présents dans les répertoires système (répertoire de Windows ou répertoire "Program Files").

**Conseil de programmation** : Si vous devez manipuler / modifier des fichiers ou des répertoires, sans avoir besoin de privilèges administrateur, il est conseillé :

- de ne pas écrire dans le répertoire de Windows ou dans le répertoire "Program Files",

- d'utiliser le répertoire système correspondant à l'application (connu par la fonction [SysRep](../WDLang1/3073026.md) par exemple avec la constante *srAppDataCommun*).




<a name="XComposante"></a>

## Composante :
wd280std.dll
