
## Créer ses Macro-Codes Utilisateur
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000172"></a>
Les Macro-Codes Utilisateur sont des morceaux de code WLangage permettant à un utilisateur final de personnaliser son application.

La saisie de ce code est simplifiée grâce à un assistant.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000196"></a>


### Lancer l'assistant de gestion du MCU
<a name="lancer_assistant_gestion_mcu_ELTPARAGRAPHE000021"></a>Si la fenêtre permet la saisie d'un Macro-Code Utilisateur, l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=MCU_Icone.gif)
 apparaît : 

- jusqu'à Windows XP :  à côté de l'icône de réduction de la fenêtre. 

- à partir de Windows Vista : en dessous de la barre de titre. 


Lors du clic sur cette icône, un assistant apparaît et permet à l'utilisateur final de créer et d'utiliser ses macro-codes utilisateur.

**Remarque** : 

- Pour lancer le MCU, il est également possible d'utiliser le raccourci clavier touche Windows + F2.

- L'assistant peut également être lancé par un bouton personnalisé. Pour personnaliser le bouton MCU, créez un nouveau bouton, associé à l'action prédéfinie "Ouvrir la fenêtre d'édition du Macro-Code Utilisateur (MCU)". Dans ce cas, le bouton par défaut ne sera plus affiché. Le nouveau bouton pourra être positionné à n'importe quel endroit de la fenêtre.





<a name="NOTE2_2"></a>


### Ajouter un Macro-Code
<a name="ajouter_macrocode_ELTPARAGRAPHE000041"></a>Pour ajouter un Macro-Code Utilisateur :

1. Lancez l'assistant de gestion du MCU (icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=MCU_Icone.gif)
 par défaut). 

2. Cliquez sur le bouton "Ajouter un Macro-Code".

3. Indiquez le type d'action concerné par le traitement personnalisé : Action sur un champ ou sur une combinaison de touches.

4. Si vous effectuez un traitement sur un champ :

	- Sélectionnez le champ concerné. Un tableau liste les différents champs de l'application avec leur libellé. Vous pouvez également sélectionner directement le champ dans la fenêtre grâce au bouton "Choisir le champ".

	- Sélectionnez l'action à personnaliser et le moment de l'exécution de l'action personnalisée.

	- Un éditeur de code simplifié apparaît, permettant de saisie le titre de la macro et le code WLangage du Macro-Code Utilisateur.




5. Si vous effectuez un traitement sur une combinaison de touches :

	- Spécifiez la combinaison de touches concernée.  

	- Un éditeur de code simplifié apparaît, permettant de saisir le titre de la macro, le moment d'exécution et le code WLangage du Macro-Code Utilisateur. 




6. Dans l'éditeur de code simplifié :

	- La coloration syntaxique est disponible.

	- L'aide des fonctions WLangage est disponible.

	- Il est possible de tester directement le code saisi.

	- Il est possible d'obtenir la liste des champs afin de manipuler un autre champ de la fenêtre.




7. Validez. Le macro-code est ajouté et est disponible immédiatement.





<a name="NOTE2_3"></a>


### Envoyer par email les Macro-Codes Utilisateur
<a name="envoyer_par_email_les_macrocodes_utilisateur_ELTPARAGRAPHE000071"></a>Si la fonctionnalité a été autorisée par le développeur de l'application, il est possible d'envoyer par emails les Macro-Codes Utilisateur créés.

Pour envoyer les Macro-Codes Utilisateur par email :

1. Lancez l'assistant.

2. Cliquez sur le bouton "Envoyer le code".




**Attention** : cette fonctionnalité n'est pas disponible pour les applications installées avec une mise à jour automatique depuis un répertoire réseau. Dans ce cas, les fichiers MCU sont copiés dans le répertoire réseau partagé.



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Limitations
<a name="limitations_ELTTEXTE000232"></a>


### Code saisi dans les Macro-Codes Utilisateur
<a name="code_saisi_dans_les_macrocodes_utilisateur_ELTPARAGRAPHE000088"></a>

- Les traitements d'exception (Quand Exception ...) n'ont aucun effet en MCU.

- Il n'est pas possible d'utiliser les fonctions HFSQL permettant la modification des fichiers de données (fonctions [HAjoute](../WDLang4/3044147.md), [HCréation](../WDLang4/3044255.md), [HCréationSiInexistant](../WDLang4/3044254.md), [HEcrit](../WDLang4/3044092.md), [HLibère](../WDLang4/3044064.md), [HModifie](../WDLang4/3044042.md), [HRaye](../WDLang4/3044121.md) et [HSupprime](../WDLang4/3044018.md)). Les fonctions Table\* correspondantes sont également interdites.

- La fonction [Compile](../WDLang1/3013015.md) ne peut pas être utilisée.

- Lors de la configuration de l'application, il est possible d'interdire l'utilisation des fonctions de parcours des fichiers de données.

- La fonction [DonneFocusEtRetourUtilisateur](../WDLang1/1410088107.md) peut avoir un comportement différent de celui attendu.







