
## SendMessage (Fonction)

***En anglais : SendMessage***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Envoie un message Windows à un champ ou à une fenêtre. Ce message est directement envoyé : tant que le message n'est pas traité, le traitement en cours est arrêté (fonction bloquante). La fonction [PostMessage](../WDLang1/3015001.md) permet d'envoyer un message sans bloquer l'application.

**Remarque** : Cette fonction est un appel à l'API Windows *SendMessage*. Elle permet de réaliser des opérations de bas niveau sur les champs et les fenêtres. Pour connaître la signification de chaque message et de ses paramètres, il faut se reporter à l'API Windows (WIN32).

**Attention** : L'usage inapproprié de cette fonction peut conduire à des problèmes graves dans votre application et/ou à des dysfonctionnements de l'interface graphique.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Copier le contenu d'un champ de saisie dans le presse-papiers
SendMessage(Handle(SAI_SAISIE1), WM_COPY, 0, 0)
```


<a name="Exemple2"></a>





```wl
// Déclencher l'ouverture d'un menu contextuel sur un bouton
SendMessage(Handle(BTN_BOUTON1), WM_CONTEXTMENU, Handle(BTN_BOUTON1), -1)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = SendMessage(<hWnd> , <Message Windows> , <wParam> , <lParam>)`
---

**`<Résultat> : (Entier)`**

La signification de ce paramètre dépend du message envoyé.

**`<hWnd> : (Entier)`**

Identifiant (Handle) du champ ou de la fenêtre à qui le message doit être envoyé. Ce champ ou cette fenêtre peuvent être des objets n'appartenant pas à une application WINDEV. Le handle d'un champ ou d'une fenêtre peut être calculé grâce à la fonction [Handle](../WDLang1/3015005.md) (pour des objets WINDEV) ou [SysFenHandle](../WDLang1/3073007.md).

**`<Message Windows> : (Entier ou chaîne de caractères)`**

Numéro ou nom du message Windows à envoyer. Si une chaîne de caractères est utilisée, la fonction **RegisterWindowsMessage** est automatiquement appelée pour obtenir le numéro de message correspondant. 
Si ce paramètre correspond à une chaîne de caractères, cette chaîne est sensible à la casse.

**`<wParam> : (Entier)`**

Paramètre dont l'utilisation dépend du type de message envoyé.

**`<lParam> : (Entier)`**

Paramètre dont l'utilisation dépend du type de message envoyé.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Constantes définissant des messages
<a name="constantes_definissant_des_messages_ELTPARAGRAPHE000061"></a>Les constantes définissant les divers messages possibles sont définies dans le fichier "WINCONST.WL" disponible dans le répertoire de WINDEV (sous-répertoire Personnel\\Externe). Pour utiliser ce fichier dans vos applications, utilisez le code suivant :

```wl
EXTERNE "WINCONST.wl" // Définit la constante WM_MOUSEMOVE
SendMessage(Handle(SAI_SAISIE1), WM_MOUSEMOVE, 0, 0)
```




<a name="XComposante"></a>

## Composante :
wd280obj.dll
