


## Gestion de la langue de l'application par programmation
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000212"></a>
Une application multilingue est une application qui pourra être diffusée dans plusieurs langues. L'utilisateur pourra choisir la langue d'exécution de l'application. Il est possible par exemple :

- de demander la langue d'exécution au premier lancement de l'application,

- de prévoir une option (option de menu ou bouton par exemple) permettant à l'utilisateur de changer de langue en cours d'exécution de l'application.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Détermination de la langue de l'application par programmation
<a name="determination_langue_application_par_programmation_ELTTEXTE000236"></a>


### Langue par défaut
<a name="langue_par_defaut_ELTPARAGRAPHE000021"></a>Lors de l'exécution du projet, la langue par défaut est sélectionnée dans les options du projet : 

- sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description". 

- sélectionnez l'onglet "Langues". 

- sélectionnez la langue par défaut dans la liste des langues du projet et sélectionnez l'option "Langue par défaut" du menu contextuel.


Le changement de langue s'effectue par programmation.
<a name="NOTE2_2"></a>


### Changer de langue par programmation
<a name="changer_langue_par_programmation_ELTPARAGRAPHE000046"></a>Pour changer de langue par programmation : 

1. Appelez la fonction [Nation](../WDLang1/3054014.md) du WLangage avec en paramètre la langue choisie. La langue choisie sera prise en compte dès la première fonction WLangage suivant la fonction [Nation](../WDLang1/3054014.md) et pour les fenêtres, les pages et les états qui seront ouverts par la suite.

2. Appelez la fonction [ChargeErreur](../WDLang1/3054003.md) pour charger le fichier des messages d'erreur des composantes (fichiers WD\*.DLL) dans la langue choisie. Le fichier des messages d'erreur est un fichier d'extension WDM.
	Remarques :

	- Si un fichier des messages est associé à la langue choisie dans la description du projet, il n'est pas nécessaire d'utiliser la fonction [ChargeErreur](../WDLang1/3054003.md). 
			**Rappel** : Le fichier des messages est défini dans l'onglet "Divers" de la description du projet. 
			Rappel : pour afficher la description du projet, sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description". Sélectionnez l'onglet "Langues". 

	- Par défaut, les messages d'erreur des composantes sont en français. Ils peuvent être traduits avec l'outil WDINT.EXE. WDINT est un outil disponible séparément. Contactez le service commercial de PC SOFT pour plus de détails sur les conditions d'utilisation de ce produit.




3. **Si votre application gère des langues utilisant des alphabets spécifiques (grec, coréen, ...)**, changez par programmation :

	- l'alphabet utilisé (fonction [ChangeAlphabet](../WDLang1/3054001.md)). Cet alphabet pourra également être utilisé pour les données enregistrées dans les fichiers HFSQL. Pour plus de détails, consultez [Gérer des alphabets spécifiques dans des fichiers de données](../WDLang1/3054017.md).

	- la langue du clavier manipulé par les utilisateurs de l'application (fonction [ChangeClavier](../WDLang1/3054002.md)).







**Exemple de traitement d'initialisation du projet** :

```wl
// La langue est choisie avec le sélecteur SEL_ChoixLang
SELON SEL_ChoixLang
	CAS 1 : // Français
		Nation(nationFrançais)
	CAS 2 : // Anglais
		Nation(nationAnglais)
		SI ChargeErreur("ANGLAIS.WDM") > 0 ALORS
			Erreur("Fichier des messages non trouvé. ",...
				"Les messages seront affichés en français.")
		FIN
	CAS 3 : // Espagnol
		Nation(nationEspagnol)
		SI ChargeErreur("ESPAGNOL.WDM") > 0 ALORS
			Erreur("Fichier des messages non trouvé. ",...
			"Les messages seront affichés en français.")
		FIN
	CAS 4 : // Grec
		Nation(nationGrec)
		SI ChargeErreur("GREC.WDM") > 0 ALORS
			Erreur("Fichier des messages non trouvé. ",...
			"Les messages seront affichés en français.")
		FIN
		ChangeAlphabet(alphabetGrec)
		ChangeClavier(alphabetGrec)
FIN
```


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Pour changer la langue par programmation, il suffit d'appeler la fonction [Nation](../WDLang1/3054014.md) du WLangage avec en paramètre la langue choisie. La langue choisie sera prise en compte dès la première fonction WLangage suivant l'appel de la fonction [Nation](../WDLang1/3054014.md) et pour les fenêtres qui seront ouvertes par la suite.
<a name="NOTE2_3"></a>


### Conseil
<a name="conseil_ELTPARAGRAPHE000115"></a>La langue du projet peut être choisie selon plusieurs méthodes :

- Mémorisée dans un fichier de paramètres. Dans ce cas, le changement de langue pourra être effectué dans le traitement d'initialisation du projet et sera effectif dès la première fenêtre ou page du projet.

- Choisie par une option de menu. Dans ce cas, le menu sera affichée dans la langue par défaut et le changement de langue sera effectif dès l'ouverture de la prochaine fenêtre ou page.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Mécanisme des langues préférées pour les composants externes
<a name="mecanisme_des_langues_preferees_pour_les_composants_externes_ELTTEXTE000272"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Principe
<a name="principe_ELTPARAGRAPHE000129"></a>Si un composant externe utilisé dans le projet gère moins de langues que le projet qui l'utilise (ou pas les mêmes langues), le mécanisme des langues préférées permet d'afficher l'information voulue (provenant du composant externe) dans une langue, proche de celle voulue.

**Exemple** : Un composant externe propose une fenêtre a été traduite en français, anglais et russe. Une option de menu de l'application utilisant le composant externe permet de faire afficher cette fenêtre en allemand.
Le mécanisme des langues préférées recherche la langue allemande, la langue anglaise, puis l'américain.
Dans notre exemple, la fenêtre sera affichée en anglais.

**Avantage** : si vous utilisez un composant externe qui ne gère pas les mêmes langues que votre application, une traduction sera toujours affichée (même si elle ne correspond pas exactement à la langue voulue).

**Remarque** : Il est également possible de traduire l'interface du composant externe dans la langue souhaitée. Pour plus de détails, consultez [Traduction des composants externes](../Editeurs/2014014.md).
<a name="NOTE3_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Ordre des préférences
<a name="ordre_des_preferences_ELTPARAGRAPHE000151"></a>Par défaut, la langue demandée est recherchée.

Si cette langue n'est pas trouvée, c'est tout d'abord les traductions en langue anglaise qui sont recherchées et affichées.

Si l'anglais n'est pas associé à l'élément, c'est l'américain qui est recherché et affiché.

**Cas particuliers** : 

- Si l'anglais est recherché et non trouvé, c'est l'américain qui sera ensuite recherché.

- Si l'américain est recherché et non trouvé, c'est l'anglais qui sera recherché.

- Si le canadien français est recherché et non trouvé, c'est le français qui sera recherché puis l'américain puis l'anglais.

- Si le portugais est recherché et non trouvé, c'est le portugais brésilien qui sera ensuite recherché puis l'anglais et l'américain.

- Si le portugais brésilien est recherché et non trouvé, c'est le portugais qui sera ensuite recherché, puis l'anglais et l'américain.





