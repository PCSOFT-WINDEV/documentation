
## ServiceAttendEtat (Fonction)

***En anglais : ServiceWaitStatus***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Attend qu'un service soit dans un état spécifique. Ce service peut être un service présent sur le poste local ou sur un poste distant.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1001000017101&name=serviceattendetat_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Attend que le service présent dans la table TABLE_Service soit démarré
Res est un entier
ServiceDémarre(COL_Nom[TABLE_Service])
Res = ServiceAttendEtat(COL_Nom[TABLE_Service], serviceEtatDémarré, 10)
SI Res = -1 ALORS
	Erreur(ErreurInfo())
SINON
	Info("Etat en fin de timeout : " + EtatEnTexte(Res))
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ServiceAttendEtat(<Nom du service> , <Etat attendu> [, <Timeout> [, <Poste distant>]])`
---

**`<Résultat> : (Constante de type Entier)`**



- Etat actuel du service, 
	


|   |   |
| --- | --- |
| *serviceEtatArrêté* | Le service est arrêté. |
| *serviceEtatAttenteArrêt* | Le service a reçu une commande d'arrêt mais il n'est pas encore arrêté. |
| *serviceEtatAttenteDémarrage* | Le service a reçu une commande de démarrage mais il n'est pas encore démarré. |
| *serviceEtatAttentePause* | Le service a reçu une commande de pause mais il n'est pas encore en pause. |
| *serviceEtatAttenteRelancement* | Le service a reçu une commande de relancement mais il n'est pas encore relancé. |
| *serviceEtatDémarré* | Le service est en cours de fonctionnement. |
| *serviceEtatEnPause* | Le service est en pause. |
| *serviceEtatTimeout* | Le service n'a pas atteint l'état demandé à l'issue du timeout. |



- -1 en cas d'erreur. Pour plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Nom du service> : (Chaîne de caractères)`**

Nom du service à manipuler.

**`<Etat attendu> : (Constante de type Entier)`**

Etat attendu du service :


|   |   |
| --- | --- |
| *serviceEtatArrêté* | Le service est arrêté. |
| *serviceEtatAttenteArrêt* | Le service a reçu une commande d'arrêt mais il n'est pas encore arrêté. |
| *serviceEtatAttenteDémarrage* | Le service a reçu une commande de démarrage mais il n'est pas encore démarré. |
| *serviceEtatAttentePause* | Le service a reçu une commande de pause mais il n'est pas encore en pause. |
| *serviceEtatAttenteRelancement* | Le service a reçu une commande de relancement mais il n'est pas encore relancé. |
| *serviceEtatDémarré* | Le service est en cours de fonctionnement. |
| *serviceEtatEnPause* | Le service est en pause. |



**`<Timeout> : (Entier optionnel ou Durée optionnelle)`**

Durée maximale à attendre (en secondes). Ce paramètre peut correspondre à : 

- un entier correspondant au nombre de secondes, 

- une variable de type Durée, 

- l'indication directe de la durée (par exemple 1 s). 


Si ce paramètre n'est pas précisé, l'attente est de 10 secondes. 

**`<Poste distant> : (Chaîne de caractères optionnelle)`**



- Adresse IP du poste distant au format xxx.xxx.xxx.xxx (obtenu par la fonction [NetAdresseIP](../WDLang3/3056023.md)), 

- Nom du poste distant (obtenu par la fonction [NetNomMachine](../WDLang3/3056014.md)). 


Ce paramètre permet de manipuler un service sur un autre poste. Pour utiliser cette option, l'utilisateur doit être administrateur de la machine distante. 
Si ce paramètre n'est pas précisé ou correspond à une chaîne vide (""), le service est manipulé en local.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>


<a name="XComposante"></a>

## Composante :
wd280std.dll
