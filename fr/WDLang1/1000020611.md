


## TableDéplaceBranche (Fonction)

***En anglais : TableMoveBranch***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Déplace le contenu d'une ligne avec toute son arborescence descendante dans un champ Table hiérarchique. 


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Positionne le contenu de la branche 1 
// comme fils de la branche 19 du champ Table hiérarchique
TableDéplaceBranche(TABLEH_Client, 1, 19, tdEnFils)
```



```wl
// Positionne le contenu de la branche "Mes Documents\A Faire" 
// comme fils de la branche 1 du champ Table hiérarchique
TableDéplaceBranche(TABLEH_DOSSIERS, "Mes documents" + TAB + ...
		"A faire", 1, tdEnFils)
```



```wl
// Positionne le contenu de la branche 1 comme racine du champ Table hiérarchique
TableDéplaceBranche(TABLEH_Client, 1, Null, tdEnFils)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = TableDéplaceBranche(<Champ Table hiérarchique> , <Elément à déplacer> , <Elément destination> , <Type de déplacement>)`
---

**`<Résultat> : (Entier)`**

Position réelle à laquelle la ligne a été déplacée. Cette position est égale à l'indice de la ligne destination uniquement si la destination se trouve avant la source dans le champ Table hiérarchique.

**`<Champ Table hiérarchique> : (Nom de champ)`**

Nom du champ Table hiérarchique à manipuler.
Si ce paramètre correspond à une chaîne vide (""), le champ manipulé est le champ auquel appartient l'événement en cours.

**`<Elément à déplacer> : (Entier ou chaîne de caractères)`**

Branche à déplacer. Cette branche peut être identifiée : 

- soit par l'indice de la branche à déplacer. Cet indice doit être compris entre 1 et le nombre de lignes du champ (connu par la fonction [TableOccurrence](../WDLang1/3074021.md) ou la propriété [Occurrence](../Proprietes/2510097.md)). 

- soit par le chemin de l'élément à déplacer. Ce paramètre est de la forme :
	
	```txt
	"<Nom de la racine>" + TAB + ["<Nom du 1er noeud>" + TAB + ...
	["<Nom du 2ème noeud>" + TAB + [...]]]"<Nom de la feuille>"
	```





**`<Elément destination> : (Entier ou chaîne de caractères)`**

Branche destination. Cette branche peut être identifiée : 

- soit par l'indice de la branche destination. Cet indice doit être compris entre 1 et le nombre de lignes du champ (connu par la fonction [TableOccurrence](../WDLang1/3074021.md) ou la propriété [Occurrence](../Proprietes/2510097.md)). 

- soit par le chemin de l'élément destination. Ce paramètre est de la forme :
	
	```txt
	"<Nom de la racine>" + TAB + ["<Nom du 1er noeud>" + TAB + ...
	["<Nom du 2ème noeud>" + TAB + [...]]]"<Nom de la feuille>"
	```


- soit par 'Null' ou chaîne vide ("") pour spécifier la racine de la hiérarchie.  




**`<Type de déplacement> : (Constante de type Booléen)`**

Type de déplacement à effectuer : 


|   |   |
| --- | --- |
| *tdEnFils* | La branche est déplacée et sera le premier fils de la branche destination. La branche déplacée sera donc un niveau plus bas que la branche destination dans la hiérarchie. |
| *tdEnFrère* | La branche sera déplacée et sera le frère suivant de la branche destination. La branche déplacée sera donc sur le même niveau de hiérarchie que la branche destination mais à la position suivante. |





<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
