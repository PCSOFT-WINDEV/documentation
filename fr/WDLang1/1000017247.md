


## TableDéplaceLigne (Fonction)

***En anglais : TableMoveLine***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Déplace une ligne ou échange deux lignes dans un champ Table. Pour déplacer les colonnes dans un champ Table, utilisez la fonction [TableDéplaceColonne](../WDLang1/3074011.md).






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Echange la ligne en cours et la ligne 5
TableDéplaceLigne(TABLE_Table1, ligneSélectionnée, 5, tdEchange)
// Déplace la ligne en cours à la ligne 3
TableDéplaceLigne(TABLE_Table1, ligneSélectionnée, 3, tdDéplace)
// Echange la ligne en cours avec la ligne suivante
TableDéplaceLigne(TABLE_Table1, ligneSélectionnée, tdSuivant, tdEchange)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Déplacer une ligne à une position spécifique ou échanger deux lignes spécifiques

`<Résultat> = TableDéplaceLigne(<Champ Table> , <Indice de la ligne à déplacer> , <Indice de la ligne destination> [, <Opération à effectuer>])`
---

**`<Résultat> : (Entier)`**

Nouvel indice de la ligne déplacée.

**`<Champ Table> : (Nom de champ)`**

Nom du champ Table à manipuler.
Si ce paramètre correspond à une chaîne vide (""), le champ Table manipulé est le champ auquel appartient l'événement en cours.

**`<Indice de la ligne à déplacer> : (Entier)`**

Position de la ligne à déplacer. Cette position doit être comprise entre 1 et le nombre de lignes du champ Table (connu par exemple par la fonction [TableOccurrence](../WDLang1/3074021.md) ou la propriété [Occurrence](../Proprietes/2510097.md)).

Pour déplacer la ligne actuellement sélectionnée, utilisez la constante *ligneSélectionnée*.

**`<Indice de la ligne destination> : (Entier)`**

Nouvelle position de la ligne. Cette position doit être comprise entre 1 et le nombre de lignes du champ Table (connu par exemple par la fonction [TableOccurrence](../WDLang1/3074021.md) ou la propriété [Occurrence](../Proprietes/2510097.md)). Si ce paramètre n'est pas valide, une erreur fatale est générée.

Pour manipuler la ligne actuellement sélectionnée, utilisez la constante *ligneSélectionnée*.

**`<Opération à effectuer> : (Constante ou combinaison de constantes optionnelle de type Entier)`**

Changement de position de la ligne à effectuer :


|   |   |
| --- | --- |
| *tdAfficheDestination* | La ligne déplacée (ou échangée) est affichée dans le champ Table. Si nécessaire, un défilement automatique des lignes est effectué pour afficher la ligne déplacée dans le champ Table. La ligne sélectionnée (bandeau de sélection) n'est pas modifiée.<br>Cette constante peut être combinée avec les constantes *tdDéplace*et *tdEchange*.<br> |
| *tdDéplace*<br>(valeur par défaut) | La ligne est déplacée vers l'indice de la ligne destination. |
| *tdEchange* | Les lignes source et destination sont échangées. |




<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Déplacer ou échanger deux lignes par rapport à la position en cours

`<Résultat> = TableDéplaceLigne(<Champ Table> , <Indice de la ligne à déplacer> , <Déplacement relatif> [, <Opération à effectuer>])`
---

**`<Résultat> : (Entier)`**

Nouvel indice de la ligne déplacée.

**`<Champ Table> : (Nom de champ)`**

Nom du champ Table à manipuler.
Si ce paramètre correspond à une chaîne vide (""), le champ Table manipulé est le champ auquel appartient l'événement en cours.

**`<Indice de la ligne à déplacer> : (Entier)`**

Position de la ligne à déplacer. Cette position doit être comprise entre 1 et le nombre de lignes du champ Table (connu par exemple par la fonction [TableOccurrence](../WDLang1/3074021.md) ou la propriété [Occurrence](../Proprietes/2510097.md)).

Pour manipuler la ligne actuellement sélectionnée, utilisez la constante *ligneSélectionnée*.

**`<Déplacement relatif> : (Constante de type Entier)`**

Permet de déplacer ou échanger une ligne sur une position relative à l'indice de cette ligne.


|   |   |
| --- | --- |
| *tdDernier* | Déplace la ligne en dernière position. |
| *tdPagePrécédente* | Déplace la ligne d'une page vers le haut (une page correspond au nombre de lignes pouvant être affichées simultanément dans le champ Table). |
| *tdPageSuivante* | Déplace la ligne d'une page vers le bas (une page correspond au nombre de lignes pouvant être affichées simultanément dans le champ Table). |
| *tdPrécédent* | Déplace la ligne d'une position vers le haut. |
| *tdPremier* | Déplace la ligne en première position. |
| *tdSuivant* | Déplace la ligne d'une position vers le bas. |


Si ce paramètre est invalide (par exemple utilisation de la constante *tdPrécédent* sur la première ligne du champ Table), la ligne est déplacée "au plus proche" de la position demandée.

**`<Opération à effectuer> : (Constante ou combinaison de constantes optionnelle de type Entier)`**

Changement de position de la ligne à effectuer :


|   |   |
| --- | --- |
| *tdAfficheDestination* | La ligne modifiée est affichée dans le champ Table. Si nécessaire, un défilement automatique des lignes est effectué pour afficher la ligne déplacée dans le champ Table. La ligne sélectionnée (bandeau de sélection) n'est pas modifiée.<br>Cette constante peut être combinée avec les constantes *tdDéplace*et *tdEchange*.<br><br> |
| *tdDéplace*<br>(valeur par défaut) | La ligne est déplacée vers l'indice de la ligne destination. |
| *tdEchange* | Les lignes source et destination sont échangées. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000223"></a>La fonction **TableDéplaceLigne** peut être utilisée sur : 

- un champ Table par programmation. 

- un champ Table fichier chargé en mémoire.  

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) un champ Table horizontale.




Cette fonction ne peut pas être utilisée sur les champs Table hiérarchique, ni sur les champs Table fichier (accès direct). 

Remarques : Déplacement d'une ligne selon le type de champ : 

- Pour déplacer une ligne d'un champ Table hiérarchique, utilisez la fonction [TableDéplaceBranche](../WDLang1/1000020611.md).

- Pour déplacer une ligne d'un champ Liste ou Combo, utilisez la fonction [ListeDéplaceLigne](../WDLang1/1000017279.md).

- Pour déplacer une répétition d'un champ Zone répétée, utilisez la fonction [ZoneRépétéeDéplaceLigne](../WDLang2/1000017248.md).



<a name="NOTE0_2"></a>


### Champ Table multisélection
<a name="champ_table_multiselection_ELTPARAGRAPHE000266"></a>Si la fonction **TableDéplaceLigne** est utilisée sur un champ Table multisélection :

- lors d'un déplacement de ligne (constante *tdDéplace*) : seule la première ligne sélectionnée est déplacée.

- lors d'un échange de lignes (constante *tdEchange*) : seule la première ligne va être échangée.

- la constante *ligneSélectionnée*ne peut pas être utilisée. Dans le cas contraire, une erreur fatale est affichée et aucune ligne n'est déplacée.



<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Champ Table horizontale
<a name="champ_table_horizontale_ELTPARAGRAPHE000284"></a>Si la fonction **TableDéplaceLigne** est utilisée sur un champ Table horizontale, les éléments déplacés seront les colonnes.

Pour déplacer les lignes d'un champ Table horizontale, utilisez la fonction [TableDéplaceColonne](../WDLang1/3074011.md).
<a name="NOTE0_4"></a>


### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000301"></a>**Attention** : La fonction **TableDéplaceLigne** ne retourne pas de code d'erreur. Pour savoir si cette fonction a généré une erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.


<a name="XComposante"></a>

## Composante :
wd280obj.dll
