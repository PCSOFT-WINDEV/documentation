
## fRepAttribut (Fonction)

***En anglais : fDirAttribute***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie ou modifie les attributs d'un répertoire.

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Dans cette version, il est possible uniquement de connaître les attributs d'un répertoire.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Récupération des attributs d'un répertoire
ResAttribut = fRepAttribut("C:\MesRépertoires")
SI ResAttribut <> "ERR" ALORS
	...
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Récupérer les attributs d'un répertoire

`<Résultat> = fRepAttribut(<Chemin du répertoire>)`
---

**`<Résultat> : (Chaîne de caractères)`**



- "ERR" en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.

- Une ou plusieurs lettres correspondant aux attributs du répertoire ("AH" par exemple). 
	Les lettres utilisées sont :

	- **R** : Répertoire en lecture seule. Le répertoire est uniquement accessible en lecture.

	- **H** : Répertoire caché. Le nom du répertoire est généralement grisé ou invisible dans l'explorateur.
			

	- **S** : Répertoire système. Le répertoire est un répertoire système de Windows. 
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette valeur n'est pas gérée.

	- **A** : Répertoire "archive". Cet attribut indique que le répertoire peut être archivé. Certains programmes se servent de cet attribut pour savoir quels répertoires ont été sauvegardés. 
			![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette valeur n'est pas gérée.

	- **D** : Répertoire ou sous-répertoire. Le répertoire est un répertoire ou un sous-répertoire.

	- **C** : Répertoire compressé (sur les partitions NTFS). Le répertoire a été automatiquement compressé lors de sa copie sur une partition NTFS (Windows NT ou 2000). 
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette valeur n'est pas gérée.







**`<Chemin du répertoire> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du répertoire (260 caractères maximum). Un chemin de type UNC peut être utilisé. Ce nom de répertoire peut être terminé indifféremment par "\\" ou non.

![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.








<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Modifier les attributs d'un répertoire

`<Résultat> = fRepAttribut(<Chemin du répertoire> , <Attributs du répertoire>)`
---

**`<Résultat> : (Chaîne de caractères)`**



- "ERR" en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.

- Une ou plusieurs lettres correspondant aux nouveaux attributs du répertoire ("AH" par exemple), 
	Les lettres utilisées sont :

	- **R** : Répertoire en lecture seule. Le répertoire est uniquement accessible en lecture.

	- **H** : Répertoire caché. Le nom du répertoire est généralement grisé ou invisible dans l'explorateur.

	- **S** : Répertoire système. Le répertoire est un répertoire système de Windows. 

	- **A** : Répertoire "archive". Cet attribut indique que le répertoire peut être archivé. Certains programmes se servent de cet attribut pour savoir quels répertoires ont été sauvegardés. 

	- **D** : Répertoire ou sous-répertoire. Le répertoire est un répertoire ou un sous-répertoire.

	- **C** : Répertoire compressé (sur les partitions NTFS). Le répertoire a été automatiquement compressé lors de sa copie sur une partition NTFS (Windows NT ou 2000). 







**`<Chemin du répertoire> : (Chaîne de caractères)`**

Nom et chemin complet ou relatif du répertoire (260 caractères maximum). Un chemin de type UNC peut être utilisé. Ce nom de répertoire peut être terminé indifféremment par "\\" ou non.

![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.





**`<Attributs du répertoire> : (Chaîne de caractères)`**

Une ou plusieurs lettres correspondant aux nouveaux attributs du répertoire spécifié ("AH" par exemple). L'ordre des lettres n'a pas d'importance. Les lettres utilisées sont :

- R : Répertoire en lecture seule. Le répertoire est uniquement accessible en lecture.

- H : Répertoire caché. Le nom du répertoire est généralement grisé ou invisible dans l'explorateur.

- S : Répertoire système. Le répertoire est un répertoire système de Windows.

- A : Répertoire "archive". Cet attribut indique que le répertoire peut être archivé. Certains programmes se servent de cet attribut pour savoir quels répertoires ont été sauvegardés.








<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Identification des différents attributs d'un répertoire
<a name="identification_des_differents_attributs_repertoire_ELTPARAGRAPHE000184"></a>Pour connaître les différents attributs d'un répertoire, il suffit de rechercher si l'une des lettres identifiant un attribut est présente dans &lt;Résultat&gt;. Cette recherche peut être effectuée avec la fonction [Position](../WDLang1/3024027.md) par exemple.


<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png) 

### Modifier les attributs d'un répertoire (syntaxe 2)
<a name="modifier_les_attributs_repertoire_syntaxe_2_ELTPARAGRAPHE000197"></a>Après modification, les attributs du répertoire correspondent uniquement aux attributs spécifiés avec la fonction **fRepAttribut**. Par exemple, si le paramètre &lt;Attributs du répertoire&gt; correspond à "AR", le répertoire spécifié deviendra un répertoire archive en lecture seule.

Cas particuliers :

- *Modification d'un répertoire ou d'un sous-répertoire :* L'attribut "Répertoire ou sous-répertoire" (lettre D) ne peut pas être modifié. Quelle que soit la modification effectuée, le répertoire (ou le sous-répertoire) conservera l'attribut "Répertoire ou sous-répertoire" (lettre D).

- *Modification d'un répertoire compressé (sur les partitions NTFS) :* L'attribut "Répertoire compressé" (lettre C) ne peut pas être modifié. Quelle que soit la modification effectuée, le répertoire compressé conservera l'attribut "Répertoire compressé" (lettre C).



<a name="NOTE0_3"></a>




### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000213"></a>La fonction **fRepAttribut** génère une erreur dans les cas suivants :

- le répertoire spécifié n'existe pas,

- le nom du répertoire spécifié est invalide,

- le répertoire est bloqué par une autre application (uniquement en cas de modification des attributs),

- les lettres indiquées dans le paramètre &lt;Attributs du répertoire&gt; ne correspondent pas à des attributs de répertoire.





<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Fonctionnement sous Windows Vista (et supérieur)
<a name="fonctionnement_sous_windows_vista_superieur_ELTPARAGRAPHE000386"></a>Si cette fonction ne fonctionne pas correctement sous Windows Vista (et supérieur), il est nécessaire de vérifier si le fichier ou le répertoire manipulé ne se trouve pas dans un des répertoires système (répertoire de Windows ou répertoire "Program Files").

**En effet, sous Windows Vista (et supérieur), avec le [mécanisme de l'UAC](../Editeurs/2025014.md) (contrôle des comptes utilisateurs) activé**, il est nécessaire d'avoir les privilèges administrateur pour manipuler / modifier des fichiers ou des répertoires présents dans les répertoires système (répertoire de Windows ou répertoire "Program Files").

**Conseil de programmation** : Si vous devez manipuler / modifier des fichiers ou des répertoires, sans avoir besoin de privilèges administrateur, il est conseillé :

- de ne pas écrire dans le répertoire de Windows ou dans le répertoire "Program Files",

- d'utiliser le répertoire système correspondant à l'application (connu par la fonction [SysRep](../WDLang1/3073026.md) par exemple avec la constante *srAppDataCommun*).



<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Versions précédentes
<a name="versions_precedentes_ELTPARAGRAPHE000238"></a>Cette fonction remplace la fonction **fRepDroit**, conservée par compatibilité avec WINDEV 5.5.



<a name="XComposante"></a>

## Composante :
wd280std.dll
