


## ExécuteThreadPrincipal (Fonction)

***En anglais : ExecuteMainThread***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Déclenche l'exécution d'une procédure par le thread principal de l'application.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Interagir avec l'utilisateur 
UneRéponse est une chaîne 
UneRéponse = ExécuteThreadPrincipal(ProcédureInteractionUtilisateur, "Message")
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = ExécuteThreadPrincipal(<Procédure WLangage> [, <Paramètre 1> [... [, <Paramètre N>]]])`
---

**`<Résultat> : (Chaîne de caractères)`**

Valeur de retour de la procédure appelée. Cette valeur est identique à la valeur obtenue si la procédure est directement lancée.

**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure à exécuter.

**`<Paramètre 1> : (Optionnel)`**

Paramètres à passer à la procédure. Attention : ces paramètres sont passés par valeur (et non par référence).



**`<Paramètre N> : (Optionnel)`**

Paramètres à passer à la procédure. Attention : ces paramètres sont passés par valeur (et non par référence).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Fonctionnement
<a name="fonctionnement_ELTPARAGRAPHE000066"></a>L'exécution de la procédure est effectuée par le thread principal lorsque celui-ci est en attente d'interactions avec l'utilisateur. 

Lorsque le thread principal d'une application doit exécuter des procédures appelées par **ExécuteThreadPrincipal**, il faut donc respecter des règles strictes :

- le thread principal doit être hautement disponible : sections critiques très courtes et très localisées, pas de traitement long lorsqu'un thread secondaire peut avoir besoin d'appeler la fonction **ExécuteThreadPrincipal**, pas d'attente d'objet de synchronisation (sémaphores, signaux, ...).

- l'appel à la fonction **ExécuteThreadPrincipal** depuis les threads doit se faire en évitant de "tenir" des objets de synchronisation (sections critiques, sémaphores, signaux, ...) pour éviter un interblocage (deadlock).




Si le thread principal est en cours d'exécution d'un traitement, ce traitement n'est pas interrompu et l'exécution de la procédure sera faite lorsque le thread principal repassera en attente d'interaction avec l'utilisateur.

La fonction [Multitâche](../WDLang1/3015004.md) permet toutefois d'interrompre un traitement long pour traiter les actions de l'utilisateur et exécuter les procédures appelées par la fonction **ExécuteThreadPrincipal**.

L'appel de la fonction **ExécuteThreadPrincipal** est bloquant tant que le thread principal n'a pas exécuté la procédure. 

Attention : 

- La fonction **ExécuteThreadPrincipal** ne permet pas d'appeler une procédure d'un contexte d'exécution "parent". Par exemple, il n'est pas possible d'appeler une procédure du projet depuis un composant externe.

- Les erreurs et les exceptions provenant de la procédure exécutée sont remontées dans le thread appelant au niveau de l'appel de la fonction **ExécuteThreadPrincipal**.





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Utilisationdestachesparalleles.gif) ***Exemples unitaires (WINDEV)*** : **Utilisation des tâches parallèles** <br>Les tâches parallèles permettent notamment d’accélérer les temps de traitement et d'améliorer la réactivité d’une application.<br>Cet exemple présente les fonctions et types de variables nécessaires à l'utilisation des tâches parallèles :<br>- exécution de tâches parallèles,<br>- interaction avec les champs,<br>- tâches de continuation.

<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280wm.dll
