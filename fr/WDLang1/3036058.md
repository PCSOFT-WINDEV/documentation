
## fListeFichier (Fonction)

***En anglais : fListFile***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Liste les fichiers d'un répertoire et retourne la liste des fichiers listés. Les fichiers listés sont recherchés à partir du répertoire donné. 

**Autre utilisation** : Pour chaque fichier trouvé, la fonction **fListeFichier** peut appeler automatiquement une procédure spécifique écrite en WLangage. Cette procédure permet de manipuler le fichier en cours. Dans ce cas, la fonction **fListeFichier** retourne le nombre de fichiers listés.

**Remarque** : Sous Windows 64 bits, l'accès à un répertoire système à partir d'un exécutable 32 bits peut être effectué dans un répertoire différent de celui attendu. Pour plus de détails, consultez la page d'aide [64 bits natif et 32 bits natif](../Editeurs/2030048.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003036058&name=flistefichier_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
UnFichier, ResListeFichier sont des chaînes
// Liste les fichiers de type ".BMP" présents dans "C:\MesDocuments".
// Le parcours se fait également dans les sous-répertoires et est interruptible. 
ResListeFichier = fListeFichier("C:\MesDocuments\*.BMP", frRécursif + frInterruptible)
// Pour chaque fichier trouvé
POUR TOUTE CHAÎNE UnFichier DE ResListeFichier SEPAREE PAR RC
	// Ajout du fichier dans la table TABLE_TableFic
	TableAjoute(TABLE_TableFic, UnFichier)
FIN
```


<a name="Exemple2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Liste les fichiers de type ".BMP" présents dans "C:\MesDocuments".
// La procédure AttributFichier retourne le nombre de fichiers en lecture seule.
ResListeFichier = fListeFichier("C:\MesDocuments\*.BMP", "AttributFichier")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Liste les fichiers d'un répertoire

`<Résultat> = fListeFichier(<Chemin et nom générique des fichiers> , <Options>)`
---

**`<Résultat> : (Chaîne de caractères)`**

Nom complet des fichiers listés, séparés par des Retours Chariots (RC).

**Attention** : La fonction retourne les fichiers dont le nom court ou le nom long correspond au filtre.

**`<Chemin et nom générique des fichiers> : (Chaîne de caractères)`**

Chemin et nom générique des fichiers à lister. Les caractères génériques (\* et ?) sont autorisés. Cas particuliers :

- ***si le répertoire et le lecteur ne sont pas précisés*** : le chemin de recherche est constitué à partir du lecteur en cours et du répertoire en cours pour ce lecteur.

- ***si le lecteur n'est pas précisé mais le répertoire est précisé*** : le chemin de recherche est constitué à partir du lecteur en cours et du répertoire passé en paramètre.

- ***si le lecteur est précisé mais le répertoire n'est pas précisé***, le chemin de recherche est constitué à partir du lecteur précisé et du répertoire en cours pour ce lecteur.




![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.







**`<Options> : (Combinaison de constantes de type Entier)`**

Option permettant de définir les informations renvoyées ainsi que le type de parcours effectué pour les fichiers du répertoire :



|   |   |
| --- | --- |
| *fCheminUNICODE* | &lt;Résultat&gt; sera une chaîne au format Unicode.  <br><br> |
| *frInformationComplète* | Chaque ligne (séparée par des Retours Chariots (RC)) contient les informations suivantes :<br><br><pre><code><Nom du fichier complet> + TAB + <Taille en octets> + TAB + <br><Date de dernière modification> + TAB + <Attributs du fichier></code></pre><br>La date est au format AAAAMMJJHHmmSS. Les attributs sont identiques à ceux renvoyés par la fonction [fAttribut](../WDLang1/3036010.md). |
| *frInterruptible* | Le parcours peut être interrompu en utilisant la touche ECHAP. Le résultat renvoyé sera alors le nom des fichiers listés jusqu'à l'interruption. |
| *frNonRécursif* | Le parcours est non récursif. Les sous-répertoires ne sont pas pris en compte. |
| *frRécursif*<br>(Valeur par défaut) | Le parcours est récursif. Les sous-répertoires sont automatiquement pris en compte. |
| *frSansFichierCaché* | Si la constante *frInformationComplète* est utilisée, les fichiers cachés ne sont pas listés (attribut = "H"). |
| *frSansRépertoireCaché* | Si la constante *frInformationComplète* est utilisée, les répertoires cachés ne sont pas listés (attribut = "H"). |





<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Liste les fichiers d'un répertoire en appelant une procédure pour chaque fichier

`<Résultat> = fListeFichier(<Chemin et nom générique des fichiers> , <Procédure WLangage> [, <Pointeur> [, <Options>]])`
---

**`<Résultat> : (Entier)`**

Nombre de fichiers listés.

**`<Chemin et nom générique des fichiers> : (Chaîne de caractères)`**

Chemin et nom générique des fichiers à lister. Les caractères génériques (\* et ?) sont autorisés. Cas particuliers :

- ***si le répertoire et le lecteur ne sont pas précisés*** : le chemin de recherche est constitué à partir du lecteur en cours et du répertoire en cours pour ce lecteur.

- ***si le lecteur n'est pas précisé mais le répertoire est précisé*** : le chemin de recherche est constitué à partir du lecteur en cours et du répertoire passé en paramètre.

- ***si le lecteur est précisé mais le répertoire n'est pas précisé***, le chemin de recherche est constitué à partir du lecteur précisé et du répertoire en cours pour ce lecteur.










**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure WLangage (également nommée "callback") appelée pour chaque fichier listé. Cette procédure permet de manipuler le fichier en cours. Pour plus de détails sur cette procédure, consultez [Paramètres de la procédure utilisée par la fonction fListeFichier](../WDLang1/1000024673.md). 



**`<Pointeur> : (Entier optionnel)`**

Pointeur passé à la procédure &lt;Procédure WLangage&gt;.



**`<Options> : (Constante ou combinaison de constantes optionnelles de type Entier)`**

Type de parcours effectué pour les fichiers du répertoire :


|   |   |
| --- | --- |
| *fCheminUNICODE* | &lt;Résultat&gt; sera une chaîne au format Unicode. <br><br> |
| *frInterruptible* | Le parcours peut être interrompu en utilisant la touche ECHAP.<br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'a aucun effet. |
| *frNonRécursif* | Le parcours est non récursif. Les sous-répertoires ne sont pas pris en compte. |
| *frRécursif*<br>(Valeur par défaut) | Le parcours est récursif. Les sous-répertoires sont automatiquement pris en compte. |









<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000256"></a>**Attention** : La fonction **fListeFichier** ne retourne pas de code d'erreur. Pour savoir si cette fonction a généré une erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.


<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Lister les sous-répertoires d'un répertoire
<a name="lister_les_sousrepertoires_repertoire_ELTPARAGRAPHE000272"></a>Pour lister les sous-répertoires d'un répertoire, utilisez la fonction [fListeRépertoire](../WDLang1/3036062.md).

**Astuce** : Il est également possible de lister les répertoires d'un répertoire avec la fonction **fListeFichier**.
Exemple :


```wl
fListeFichier("c:\temp\anim\.", proc) 
// Ne pas oublier le '.' à la fin de la chaîne pour identifier les répertoires
```



```wl
PROCEDURE proc(Rep, fichier, nChange, ptr) 
Trace(Rep)
```



- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LafonctionfListeFichier.gif) ***Exemples unitaires (WINDEV)*** : **La fonction fListeFichier** <br>Utilisation de la fonction fListeFichier et de sa syntaxe qui renvoie directement la liste des fichiers/répertoires trouvés sous la forme d'une chaine.



<a name="XComposante"></a>

## Composante :
wd280std.dll
