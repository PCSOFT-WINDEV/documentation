


## ListeAjoute (Fonction)

***En anglais : ListAdd***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute un élément dans : 

- un champ Liste par programmation, 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) un champ Liste image par programmation,

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) un champ Carrousel,

- un champ Combo par programmation.




**Remarques** :

- Pour ajouter un élément à une position spécifique, utilisez la fonction [ListeInsère](../WDLang1/3049002.md).

- La fonction **ListeAjoute** peut être utilisée indifféremment sur les champs Liste monosélection et multisélection.

- Pour ajouter une image dans un champ Liste classique, utilisez la fonction [gImage](../WDLang1/3029042.md).

- Pour ajouter des éléments dans un champ Combo placé dans une colonne conteneur dans un champ Table, utilisez la propriété [Contenu](../Proprietes/1000017242.md).











<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ajout de "Dubois" dans le champ "LISTE_ListeClient"
ListeAjoute(LISTE_ListeClient, "Dubois")
```


<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Ajout de "Dubois" et "Dupont" dans le champ Liste "LISTE_ListeClient"
ListeAjoute(LISTE_ListeClient, "Dubois" + RC + "Dupont")
```


<a name="Exemple3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Ajout de l'image "C:\MesImages\Gorgones.JPG" dans le champ Liste image "LSI_PlongéeMer"
// Cette image aura comme libellé "Très belles gorgones"
ListeAjoute(LSI_PlongéeMer, "Très belles gorgones", "C:\MesImages\Gorgones.JPG")
```


<a name="Exemple4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// La combo "COMBO_Civilité" affiche les titres de civilité :
// "Monsieur", "Madame" et "Mademoiselle".
// Un entier représentant une civilité sera retourné au langage.
ListeAjoute(COMBO_Civilité, "Monsieur" + gValeurMémorisée("1"))
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ListeAjoute(<Champ à manipuler> [, <Élément> [, <Chemin de l'image à afficher>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'élément a été ajouté, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Champ à manipuler> : (Nom de champ)`**

Nom du champ à manipuler : 

- Champ Liste par programmation,

- Champ Liste image par programmation,

- Champ Combo par programmation.


Si ce paramètre correspond à une chaîne vide (""), l'élément est ajouté dans le champ Liste (ou Combo) auquel appartient l'événement en cours.


**`<Élément> : (Chaîne de caractères optionnelle)`**

Élément à ajouter dans le champ spécifié. Si ce paramètre n'est pas spécifié, une ligne vide est ajoutée dans le champ Liste (ou Combo). 
Ce paramètre peut contenir :

- des caractères Retour Chariot (RC) pour ajouter plusieurs éléments.

- des tabulations (TAB) pour obtenir un champ Liste multi-éléments (voir Notes).

- la fonction [gValeurMémorisée](../WDLang1/1410088363.md) pour indiquer la valeur à renvoyer lors de la sélection de l'élément. 


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Dans le cas d'un champ Carrousel**, le contenu de ce paramètre est affiché en survol de l'élément dans le coin haut gauche du champ Carrousel.![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) **Dans le cas d'un champ Liste image**, ce paramètre correspond au libellé de l'image. Ce paramètre peut contenir des caractères Retour Chariot (RC) pour ajouter plusieurs éléments. Dans ce cas : 

- si le paramètre &lt;Chemin de l'image à afficher&gt; n'est pas précisé, les éléments ajoutés seront associés à l'image par défaut (définie dans l'onglet "Détail" de la fenêtre de description du champ).

- si le paramètre &lt;Chemin de l'image à afficher&gt; est précisé, seul le premier élément sera ajouté. Cet élément sera associé à l'image spécifiée.


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les caractères Retour Chariot (RC) sont supportés mais les tabulations (TAB) ne sont pas supportées.

**`<Chemin de l'image à afficher> : (Chaîne de caractères optionnelle)`**

Nom et chemin de l'image à ajouter dans un champ Liste image. Il est également possible d'utiliser une rubrique mémo image. 
Ce paramètre est pris en compte uniquement dans le cas d'un champ Liste image, affichée en mode Liste image. 
Si ce paramètre n'est pas spécifié, l'image utilisée est l'image par défaut (définie dans l'onglet "Détail" de la fenêtre de description du champ).
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Ce paramètre n'est pas disponible.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Listes supérieures à 10 000 éléments
<a name="listes_superieures_10_000_elements_ELTPARAGRAPHE000216"></a>Le nombre maximum d'éléments contenus dans un champ Liste n'est limité que par la mémoire vive disponible (maximum théorique : 2 milliards de lignes). Néanmoins, le fait de remplir un champ Liste avec un très grand nombre d'éléments (plus de 10 000) est pénalisant en termes de performance.

Pour ajouter un grand nombre d'éléments dans un champ Liste, il est conseillé d'utiliser un champ Liste fichier (c'est-à-dire une liste directement reliée à un fichier de données HFSQL).
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Visibilité/Invisibilité des éléments d'un champ Liste ou d'un champ Combo
<a name="visibiliteinvisibilite_des_elements_champ_liste_champ_combo_ELTPARAGRAPHE000229"></a>Pour rendre un élément d'un champ Liste (ou d'un champ Combo) invisible, utilisez la fonction [gValeurMémorisée](../WDLang1/1410088363.md).
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Équivalence
<a name="equivalence_ELTPARAGRAPHE000243"></a>Les deux syntaxes suivantes sont équivalentes :

```txt
ListeAjoute(<Nom du champ>, [<Élément>])
```


et

```txt
<Nom du champ>[Indice] = <Élément>
```

<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Champ Liste triée/Champ Liste non triée
<a name="champ_liste_trieechamp_liste_non_triee_ELTPARAGRAPHE000263"></a>

- Si le champ Liste est trié, le nouvel élément est inséré dans l'ordre de tri.

- Si le champ Liste n'est pas trié, le nouvel élément est ajouté à la fin de la liste.




Le type du champ (trié ou non) est choisi lors de la description du champ (onglet "Détail").

La fonction **ListeAjoute** doit être préférée à la fonction [ListeInsère](../WDLang1/3049002.md) pour ajouter un élément dans un champ Liste trié.

<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Personnalisation des éléments d'un champ Liste ou d'un champ Combo
<a name="personnalisation_des_elements_champ_liste_champ_combo_ELTPARAGRAPHE000289"></a>Pour personnaliser les éléments présents dans un champ Liste ou dans un champ Combo (couleur de fond, image, dessin, ...), utilisez les [Fonctions de gestion des chaînes graphiques](../WDLang1/3029028.md).
<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Tabulations : Champ Liste multi-éléments
<a name="tabulations_champ_liste_multielements_ELTPARAGRAPHE000303"></a>Pour gérer des tabulations dans un champ Liste (alignement de colonnes), utilisez la constante *TAB*. Par exemple :

```wl
ListeAjoute(LISTE_Client, Nom + TAB + Prénom)
```
Dans cet exemple, tous les prénoms commencent à la même position et sont alignés les uns sous les autres.
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LISTETABULATION.gif)
**Remarque** : Le premier appel à la fonction **ListeAjoute** fixe la position des tabulations. Ces positions serviront de référence pour toutes les valeurs ajoutées par la suite. De même, si des valeurs ont été saisies sous l'éditeur, les positions de ces valeurs sont prises comme référence. Il est donc conseillé, lors du premier appel à la fonction **ListeAjoute**, de fixer la largeur des colonnes avec la fonction [Complète](../WDLang1/3024010.md). Par exemple, pour fixer la largeur des colonnes de "CLIENTS" à 10 caractères :

```wl
ListeAjoute(LISTE_Client, Complète(Nom, 10) + TAB + Complète(Prénom, 10))
```

<a name="NOTE0_7"></a>
<a name="NOTE0_8"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000372"></a>

- Pour ajouter des éléments dans un champ Table, utilisez la fonction [TableAjoute](../WDLang1/3074017.md).

- La fonction **ListeAjoute** peut être utilisée sur :

	- une colonne de type "Combo" dans un champ Table. 

	- un champ Combo de type "Table".







<a name="XComposante"></a>

## Composante :
wd280obj.dll
