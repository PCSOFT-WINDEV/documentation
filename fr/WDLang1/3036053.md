
## fSélecteur (Fonction)

***En anglais : fSelect***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ouvre le sélecteur de fichiers du système en cours. 




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003036053&name=fselecteur_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Sélection d'un fichier
FichierSélectionné est une chaîne
FichierSélectionné = fSélecteur("C:\Répertoires", "Fichier.txt", ...
	"Sélectionner un fichier", ...
	"Fichier Texte (*.TXT)" + TAB + "*.txt" + RC + "Tous" + TAB + "*.*", "txt")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Ouvrir un sélecteur en précisant le répertoire initial et le fichier sélectionné par défaut

`<Résultat> = fSélecteur(<Répertoire initial> , <Fichier sélectionné par défaut> , <Titre du sélecteur> , <Types de fichiers> , <Extension par défaut> [, <Mode de sélection>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Nom complet du ou des fichiers sélectionnés. Si plusieurs fichiers sont sélectionnés, les noms des fichiers sont séparés par des retour chariot (RC).

- Nom complet du fichier à créer.

- Chaîne vide ("") si aucun fichier n'a été sélectionné ou n'est à créer.




**`<Répertoire initial> : (Chaîne de caractères)`**

Chemin complet (ou relatif) du répertoire initial (260 caractères maximum). Ce nom de répertoire peut être terminé indifféremment par "\\" ou non. Les fichiers contenus dans ce répertoire s'affichent dans le sélecteur de fichiers. Si ce paramètre est une chaîne vide (""), le répertoire initial correspondra au répertoire en cours.

![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) Ce paramètre peut être au format Ansi ou Unicode.



**`<Fichier sélectionné par défaut> : (Chaîne de caractères)`**

Nom et extension du fichier sélectionné par défaut. Si ce paramètre est une chaîne vide (""), aucun fichier ne sera sélectionné par défaut.

![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) Ce paramètre peut être au format Ansi ou Unicode.

**`<Titre du sélecteur> : (Chaîne de caractères)`**

Intitulé affiché dans la barre de titre du sélecteur de fichiers. Si ce paramètre est une chaîne vide (""), le titre de la fenêtre WINDEV en cours sera affiché.

![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) Ce paramètre peut être au format Ansi ou Unicode.

**`<Types de fichiers> : (Chaîne de caractères)`**

Description des types de fichiers pouvant être sélectionnés. Cette description est de la forme :

```txt
<Types Fichiers> + TAB + <Liste Extensions> [ + RC + ...
<Types Fichiers 2> + TAB + <Liste Extensions 2>]
```

Où :

- &lt;Types Fichiers&gt; : chaîne de caractères décrivant le type de fichier ("BMP (\*.BMP;\*.RLE)" par exemple).

- &lt;Liste Extensions&gt; : extensions correspondant au type décrit ("\*.BMP;\*.RLE" par exemple).




Par exemple :
"BMP (\*.BMP;\*.RLE)"+TAB+"\*.BMP;\*.RLE"+RC+"Icône (\*.ICO)"+TAB+"\*.ICO"+RC+"Autres"+TAB+"\*.GIF;\*.TIF;\*.JPG"

**`<Extension par défaut> : (Chaîne de caractères)`**

Extension attribuée par défaut au fichier sélectionné (voir Notes).

![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) Ce paramètre peut être au format Ansi ou Unicode.![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre n'est pas pris en compte.

**`<Mode de sélection> : (Constante (ou combinaison de constantes) optionnelle)`**

Permet de définir le mode de sélection du sélecteur :


|   |   |
| --- | --- |
| *fCheminUNICODE* | &lt;Résultat&gt; sera une chaîne de caractères au format Unicode. <br><br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas prise en compte. |
| *fselChange* | Envoie le message <u><u><u><u>MessageSélecteur</u></u></u></u> à la fenêtre WINDEV appelante à chaque clic sur un fichier présent dans le sélecteur de fichiers. |
| *fselCrée* | Ouvre le sélecteur de fichiers en création de fichier (bouton "Enregistrer"). |
| *fselExiste* | Si cette constante est combinée :<br><br>- avec *fselCrée* : Renvoie le nom du fichier sélectionné. Si le fichier existe déjà, une boîte de dialogue propose à l'utilisateur d'écraser l'ancien fichier.<br><br>- avec *fselOuvre* : Renvoie le nom du fichier sélectionné uniquement si ce fichier existe.<br><br><br> |
| *fselMulti* | Ouvre le sélecteur en mode multisélections. L'utilisateur peut ainsi sélectionner plusieurs fichiers à l'aide des touches "Ctrl" et "Shift".<br><br> |
| *fselOuvre* | Ouvre le sélecteur de fichiers en ouverture de fichier (bouton "Ouvrir"). |


Par défaut, le sélecteur est appelé avec la combinaison *fSelOuvre* + *fSelExiste*.  


<a name="SYNTAXE2"></a>

### Ouvrir un sélecteur en précisant uniquement le fichier sélectionné par défaut 

`<Résultat> = fSélecteur(<Chemin complet du fichier sélectionné par défaut> , <Titre du sélecteur> , <Types de fichiers> , <Extension par défaut> [, <Mode de sélection>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Nom complet du ou des fichiers sélectionnés. Si plusieurs fichiers sont sélectionnés, les noms des fichiers sont séparés par des retour chariot (RC).

- Nom complet du fichier à créer.

- Chaîne vide ("") si aucun fichier n'a été sélectionné ou n'est à créer.




**`<Chemin complet du fichier sélectionné par défaut> : (Chaîne de caractères)`**

Chemin complet (ou relatif) du fichier sélectionné par défaut (avec le nom du fichier et son extension. Si ce paramètre est une chaîne vide (""), le répertoire initial correspond au répertoire en cours et aucun fichier ne sera sélectionné par défaut.

![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) Ce paramètre peut être au format Ansi ou Unicode.



**`<Titre du sélecteur> : (Chaîne de caractères)`**

Intitulé affiché dans la barre de titre du sélecteur de fichiers. Si ce paramètre est une chaîne vide (""), le titre de la fenêtre WINDEV en cours sera affiché.

![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) Ce paramètre peut être au format Ansi ou Unicode.

**`<Types de fichiers> : (Chaîne de caractères)`**

Description des types de fichiers pouvant être sélectionnés. Cette description est de la forme :

```txt
<Types Fichiers> + TAB + <Liste Extensions> [ + RC + ...
<Types Fichiers 2> + TAB + <Liste Extensions 2>]
```



- &lt;Types Fichiers&gt; : chaîne de caractères décrivant le type de fichier ("BMP (\*.BMP;\*.RLE)" par exemple).

- &lt;Liste Extensions&gt; : extensions correspondant au type décrit ("\*.BMP;\*.RLE" par exemple).




Par exemple :
"BMP (\*.BMP;\*.RLE)"+TAB+"\*.BMP;\*.RLE"+RC+"Icône (\*.ICO)"+TAB+"\*.ICO"+RC+"Autres"+TAB+"\*.GIF;\*.TIF;\*.JPG"

![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) Ce paramètre peut être au format Ansi ou Unicode.

**`<Extension par défaut> : (Chaîne de caractères)`**

Extension attribuée par défaut au fichier sélectionné (voir Notes).

![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) Ce paramètre peut être au format Ansi ou Unicode.

![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre n'est pas pris en compte.

**`<Mode de sélection> : (Constante (ou combinaison de constantes) optionnelle)`**

Permet de définir le mode de sélection du sélecteur :


|   |   |
| --- | --- |
| *fCheminUNICODE* | &lt;Résultat&gt; sera une chaîne de caractères au format Unicode. <br><br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas prise en compte. |
| *fselChange* | Envoie le message <u><u><u><u>MessageSélecteur</u></u></u></u> à la fenêtre WINDEV appelante à chaque clic sur un fichier présent dans le sélecteur de fichiers. |
| *fselCrée* | Ouvre le sélecteur de fichiers en création de fichier (bouton "Enregistrer"). |
| *fselExiste* | Si cette constante est combinée :<br><br>- avec *fselCrée* : Renvoie le nom du fichier sélectionné. Si le fichier existe déjà, une boîte de dialogue propose à l'utilisateur d'écraser l'ancien fichier.<br><br>- avec *fselOuvre* : Renvoie le nom du fichier sélectionné uniquement si ce fichier existe.<br><br><br> |
| *fselMulti* | Ouvre le sélecteur en mode multisélections. L'utilisateur peut ainsi sélectionner plusieurs fichiers à l'aide des touches "Ctrl" et "Shift".<br><br> |
| *fselOuvre* | Ouvre le sélecteur de fichiers en ouverture de fichier (bouton "Ouvrir"). |


Par défaut, le sélecteur est appelé avec la combinaison *fselOuvre* + *fselExiste*.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Extension par défaut (lors de la création d'un fichier avec la constante fselCrée)
<a name="extension_par_defaut_lors_creation_fichier_avec_constante_fselcree_ELTPARAGRAPHE000252"></a>L'extension d'un fichier sélectionné (fichier à créer) est différente selon :

- le paramètre &lt;Extension par défaut&gt;,

- l'extension saisie par l'utilisateur.




Par exemple, le tableau ci-dessous présente l'extension prise en compte selon l'&lt;Extension par défaut&gt; et l'extension saisie par l'utilisateur :

| Paramètre &lt;Extension par défaut&gt; | Extension saisie par l'utilisateur | Extension prise en compte lors de la création du fichier |
| --- | --- | --- |
| ".TXT" | "Fichier.BMP"<br>BMP est une extension valide et reconnue. | "Fichier.BMP" |
| ".TXT" | "Fichier.PAF" <br>PAF est une extension invalide. Le nom du fichier sera complété par l'&lt;Extension par défaut&gt;. | "Fichier.PAF.TXT" |
| ".TXT" | "Fichier" <br>Aucune extension n'est saisie. L'&lt;Extension par défaut&gt; est utilisée. | "Fichier.TXT" |
| "" (chaîne vide) | "Fichier.BMP"<br>BMP est une extension valide et reconnue. | "Fichier.BMP" |
| "" (chaîne vide) | "Fichier.PAF" <br>PAF est une extension invalide. Le nom du fichier sera complété par la première extension trouvée dans le "Type de fichier" affiché.<br>Type de fichier affiché : "Texte (\*.TXT;\*.DOC)" | "Fichier.PAF.TXT" |
| "" (chaîne vide) | "Fichier.PAF" <br>PAF est une extension invalide. Le type de fichier étant "\*.\*", l'extension invalide est conservée. <br>Type de fichier affiché : "Tous fichiers (\*.\*)" | "Fichier.PAF" |
| "" (chaîne vide) | "Fichier"<br>Aucune extension n'est saisie. L'extension utilisée est la première extension trouvée dans le "Type de fichier" affiché.<br>Type de fichier affiché : "Texte (\*.TXT;\*.DOC)" | "Fichier.TXT" |
| "" (chaîne vide) | "Fichier"<br>Aucune extension n'est saisie. Le type de fichier étant "\*.\*", le nom du fichier est conservé sans extension. <br>Type de fichier affiché : "Tous fichiers (\*.\*)" | "Fichier" |




<a name="NOTE0_2"></a>


### Extension par défaut lors de l'ouverture d'un fichier
<a name="extension_par_defaut_lors_ouverture_fichier_ELTPARAGRAPHE000344"></a>L'extension d'un fichier sélectionné (fichier à ouvrir) correspond à l'extension sélectionnée par défaut à l'ouverture du sélecteur de fichiers. Le paramètre &lt;Extension par défaut&gt; doit alors correspondre uniquement aux lettres correspondant à l'extension (par exemple "lst" pour sélectionner par défaut "\*.lst").


<a name="NOTE0_3"></a>


### Clic sur un fichier dans le sélecteur de fichiers
<a name="clic_sur_fichier_dans_selecteur_fichiers_ELTPARAGRAPHE000352"></a>Pour exécuter un traitement spécifique lors d'un clic sur un fichier présent dans le sélecteur de fichiers, branchez un événement sur le message <u><u><u><u>WM_USER + 600</u></u></u></u> (1624). A la réception de ce message :

- la variable ***lParam ***contient l'adresse du fichier sélectionné,

- la variable ***wParam ***contient la taille du fichier sélectionné.




Par exemple, il est possible de jouer le son sélectionné dans le sélecteur de fichiers (voir Exemple 2 disponible en cliquant sur le lien "Exemple" en haut de page d'aide).


<a name="NOTE0_4"></a>


### Sélection de répertoire
<a name="selection_repertoire_ELTPARAGRAPHE000369"></a>La fonction **fSélecteur** permet de sélectionner des fichiers. Pour sélectionner un répertoire, utilisez la fonction [fRepSélecteur](../WDLang1/3036050.md).
<a name="NOTE0_7"></a>
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Lecteurs réseau, manifeste et UAC
<a name="lecteurs_reseau_manifeste_uac_ELTPARAGRAPHE000384"></a>Sous Windows Vista et supérieur, si l'UAC est active et si l'exécutable est généré avec un manifeste demandant des privilèges (voir [Génération de l'exécutable](../Editeurs/2025013.md)), le sélecteur de fichiers ouvert par la fonction **fSélecteur** n'aura pas accès aux lecteurs réseau associés à l'utilisateur qui a ouvert la session Windows. Pour plus de détails, consultez [FAQ à propos de Windows Vista et supérieur](../Editeurs/2025016.md).
<a name="NOTE0_8"></a>
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) 

### Quelques exemples de sélecteurs de fichiers
<a name="quelques_exemples_selecteurs_fichiers_ELTPARAGRAPHE000402"></a>

![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) Le sélecteur de fichiers de Windows est le suivant :

![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=SelecteurFichiers.gif)


**Remarque** : Sous Windows Vista (et supérieur), le sélecteur de fichiers de Windows Vista est ouvert.



![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Le sélecteur de fichiers de Linux est le suivant : 

![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=SelecteurFichiers_LX.gif)


<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280std.dll
