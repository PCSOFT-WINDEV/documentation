
## HTMLVersTexte (Fonction)

***En anglais : HTMLToText***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Convertit une chaîne HTML ou un buffer HTML en chaîne texte. Pendant la conversion, les opérations suivantes sont effectuées :

- Suppression des balises HTML,

- Conversion des caractères spéciaux HTML, 

- Conversion des Retours Chariots (RC) en espaces,

- Conversion des espaces multiples en espaces uniques.







<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MonTexteHtml est une chaîne 
MonTexteHtml = "<!--test-->&lt;b&gt;&lt;i&gt;&quot;Bonjour !&quot;&lt;/i&gt;&lt;/b&gt;"
Texte est une chaîne = HTMLVersTexte(MonTexteHtml)
// Texte vaut : "Bonjour" !
```




<a name="Exemple2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Si le document HTML vaut:
//<HTML>
// <HEAD>
//  <TITLE>Ceci est un essai de page Web</TITLE>
//  <META http-equiv="content-type" content="text/html; charset=UTF-8">
// </HEAD>
//<BODY>
// <P>Ceci est &nbsp;&nbsp;&nbsp;&nbsp; une page HTML en Français</P>
// Elle contient 1 paragraphe<BR /><DD>une tabulation<BR />et 3 sauts de lignes
//  <BR /><A href="http://www.pcsoft.fr">Ceci est un lien</A>
// </BODY>
//</HTML>

Texte = HTMLVersTexte(MonTexteHtml)
// Texte contiendra : 
// Ceci est        une page HTML   en Français.
//
// Elle contient 1 paragraphe 
//   une tabulation
// et 3 sauts de lignes
// Ceci est un lien
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HTMLVersTexte(<Texte au format HTML> [, <Alphabet utilisé>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Texte correspondant au résultat de la conversion HTML. L'encodage des caractères utilisé est celui de l'alphabet courant de WINDEV ou WEBDEV.

**`<Texte au format HTML> : (Chaîne de caractères ou buffer)`**

Texte à convertir.

**`<Alphabet utilisé> : (Constante optionnelle de type Entier)`**

Constante identifiant l'alphabet utilisé pour l'écriture du &lt;Texte au format HTML&gt;. 
Par défaut, l'alphabet en cours de WINDEV/WEBDEV est utilisé (constante *alphabetCourant*). 
Si des informations sur l'alphabet utilisé sont trouvées dans le &lt;Texte au format HTML&gt;, ces informations sont prioritaires sur ce paramètre. 
Pour plus de détails sur ces constantes, consultez [Correspondance entre les langues, les sous-langues, les alphabets et les nations](../WDLang1/3054022.md).





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Règles de conversion utilisées
<a name="regles_conversion_utilisees_ELTPARAGRAPHE000099"></a>

- Les balises HTML sont analysées afin de conserver au mieux la mise en forme dans le texte de sortie (les Retours Chariots, les espaces, les tabulations). Le formatage n'est pas conservé : gras, italique, couleurs, ...

- **N'apparaissent pas dans la sortie texte** :

	- les balises HTML

	- le contenu du "header" (informations contenues dans la balise &lt;HEAD&gt;)

	- les commentaires

	- les textes de contrôle

	- les scripts

	- les définitions SSL

	- les styles CSS (sauf color)

	- les éléments de formulaire




- **Gestion des Retours Chariots**

	- 2 Retours Chariots sont insérés pour remplacer des balises &lt;P&gt;, &lt;H1&gt; à &lt;H6&gt;, &lt;TABLE&gt;, &lt;UL&gt; ou &lt;OL&gt;

	- 1 Retour Chariot est inséré pour remplacer les balises &lt;BR&gt;, &lt;TR&gt;, &lt;LI&gt;, &lt;DD&gt; ou &lt;DIV&gt;

	- 1 seul Retour Chariot est inséré si plusieurs balises identiques (&lt;TR&gt;, &lt;LI&gt;, &lt;DD&gt; ou &lt;DIV&gt;) se suivent (sauf pour les balises &lt;BR&gt;)




- **Gestion des tableaux**

	- Pour chaque ligne d'un tableau (balise &lt;TR&gt;), un Retour Chariot est inséré.

	- Pour chaque colonne d'un tableau (balise &lt;TD&gt;), une tabulation est insérée.




- **Gestion des caractères spéciaux**
	Un caractère spécial est un caractère défini dans la norme HTML. Par exemple, un espace peut s'écrire " " et le caractère "é" peut s'écrire "é,". Cette norme est automatiquement utilisée.





<a name="NOTE0_2"></a>


### Balises gérées
<a name="balises_gerees_ELTPARAGRAPHE000137"></a>Les balises non gérées sont ignorées : leur contenu est pris en compte comme du texte.  

Les balises gérées sont les suivantes :

- &lt;PRE&gt;

- &lt;UL&gt; : Saut de ligne + tabulation

- &lt;OL&gt; : Saut de ligne + tabulation

- &lt;LI&gt; : Tabulation

- &lt;H1&gt; : Saut de ligne avant et saut de ligne après

- &lt;H2&gt; : Saut de ligne avant et saut de ligne après

- &lt;H3&gt; : Saut de ligne avant et saut de ligne après

- &lt;H4&gt; : Saut de ligne avant et saut de ligne après

- &lt;H5&gt; : Saut de ligne avant et saut de ligne après

- &lt;H6&gt; : Saut de ligne avant et saut de ligne après

- &lt;P&gt; : Saut de ligne avant et saut de ligne après

- &lt;BR&gt; : Saut de ligne

- &lt;DL&gt; : Saut de ligne

- &lt;DT&gt; : Saut de ligne

- &lt;DD&gt; : Tabulation et saut de ligne

- &lt;TABLE&gt; : Saut de ligne

- &lt;TR&gt; : Saut de ligne

- &lt;TD&gt; : Eléments séparés par une tabulation

- &lt;HEAD&gt; : Contenu ignoré, sauf les paramètres de l'alphabet

- &lt;STYLE&gt; : Contenu ignoré

- &lt;SCRIPT&gt; : Contenu ignoré

- &lt;!-- --&gt; : Commentaires ignorés





<a name="NOTE0_3"></a>


### Gestion de l'alphabet
<a name="gestion_alphabet_ELTPARAGRAPHE000170"></a>Pour connaître l'alphabet utilisé dans le texte HTML, la fonction **HTMLVersTexte** utilise l'information contenue dans l'attribut CONTENT d'une balise &lt;META&gt;.

Si cette balise n'est pas présente, il est nécessaire de spécifier l'alphabet utilisé pour écrire le texte HTML avec le paramètre &lt;Alphabet utilisé&gt;.

En effet, si le contenu HTML utilise un alphabet arabe, et si WINDEV/WEBDEV utilisent par défaut un alphabet français, le texte de sortie utilisera des caractères invalides.

Remarques :

- Si le texte de sortie contient de nombreux caractères "?", cela signifie que le caractère de l'alphabet du document HTML n'a pas pu être exprimé avec un caractère de la langue en cours.

- L'alphabet UTF8 est le plus couramment utilisé pour l'encodage des pages Web.



<a name="NOTE0_4"></a>


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LesfonctionsHTMLVers.gif) ***Exemples unitaires (WEBDEV)*** : **Les fonctions HTMLVers** <br>Utilisation des fonctions WLangage HTMLVersRTF et HTMLVersTexte.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=PassageduformatRTFauformatHTML.gif) ***Exemples unitaires (WINDEV)*** : **Passage du format RTF au format HTML** <br>Utilisation des fonctions RTFVersHTML et RTFVersTexte.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDMail.gif) ***Exemples complets (WINDEV)*** : **WD Mail** <br>Cette application est un client mail complet développé en WINDEV. Il s'appuie sur les objets Email.<br>Ce client mail permet de récupérer et d'envoyer des emails en utilisant les protocoles POP, IMAP et SMTP.<br>Il est possible d'appliquer des filtres sur le courrier entrant.<br>L'écriture d'un email s'appuie sur le champ Editeur HTML.<br>L'affichage des emails utilise le champ Affichage HTML.<br>L'application permet de gérer plusieurs comptes emails différents.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LeTypeHTMLDocument.gif) ***Exemples unitaires (WINDEV)*** : **Le Type HTMLDocument** <br>Cet exemple permet de montrer comment utiliser le Type WLangage HTMLDocument.





<a name="XComposante"></a>

## Composante :
wd280rtf.dll
