
## RegistreTypeValeur (Fonction)

***En anglais : RegistryValueType***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie le type d'une valeur présente dans la base de registre.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Renvoie le type de la valeur "Langage" dans la clé "HKEY_LOCAL_MACHINE\SOFTWARE\Appli"
ResTypeLecture est une chaîne
ResTypeLecture = RegistreTypeValeur("HKEY_LOCAL_MACHINE\SOFTWARE\Appli", "Langage")

SI ResTypeLecture = registreTypeChaîne ALORS
	Info("Type de la clé langage : Chaîne")
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Connaître le type d'une valeur identifiée par son nom dans la base de registre

`<Résultat> = RegistreTypeValeur([<Mode d'accès>, ] <Chemin de la clé> , <Nom de la valeur>)`
---

**`<Résultat> : (Constante de type chaîne de caractères)`**

Type de la valeur :


|   |   |
| --- | --- |
| *registreTypeBinaire* | Clé de type Binaire. |
| *registreTypeChaîne* | Clé de type Chaîne. |
| *registreTypeChaîneEnv* | Clé de type Chaîne contenant des variables d'environnement. |
| *registreTypeEntier* | Clé de type Entier sur 4 octets. |
| *registreTypeEntier_8* | Clé de type Entier sur 8 octets. |
| *registreTypeEntierBigEndian* | Clé de type Entier au format big-endian |
| *registreTypeMultiChaîne* | Clé de type Multichaîne |



**`<Mode d'accès> : (Constante de type Entier)`**

Mode d'accès à la base de registre :



|   |   |
| --- | --- |
| *registreMode32* | Mode d'accès forcé pour accéder à la base de registre comme un programme 32 bits. |
| *registreMode64* | Mode d'accès forcé pour accéder à la base de registre comme un programme 64 bits. |
| *registreModeAuto*<br>(Valeur par défaut) | Mode d'accès à la base de registre automatique : <br><br>- une application 32 bits exécutée sur un système 32 bits manipule la base de registre comme un programme 32 bits.<br><br>- une application 32 bits exécutée sur un système 64 bits manipule la base de registre à partir de la branche suivante :<br>	<br><pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node</code></pre><br><br><br>- une application 64 bits exécutée sur un système 64 bits manipule la base de registre comme un programme 64 bits.<br><br><br> |



**`<Chemin de la clé> : (Chaîne de caractères)`**

Chemin complet de la clé à manipuler. Cette clé doit exister pour pouvoir lui donner une valeur.

**`<Nom de la valeur> : (Chaîne de caractères)`**

Nom de la valeur à manipuler.  


<a name="SYNTAXE2"></a>

### Connaître le type d'une valeur identifiée par son indice dans la base de registre

`<Résultat> = RegistreTypeValeur([<Mode d'accès>, ] <Chemin de la clé> , <Indice de la valeur>)`
---

**`<Résultat> : (Constante de type chaîne de caractères)`**

Type de la valeur :


|   |   |
| --- | --- |
| *registreTypeBinaire* | Clé de type Binaire. |
| *registreTypeChaîne* | Clé de type Chaîne. |
| *registreTypeChaîneEnv* | Clé de type Chaîne contenant des variables d'environnement. |
| *registreTypeEntier* | Clé de type Entier sur 4 octets. |
| *registreTypeEntier_8* | Clé de type Entier sur 8 octets. |
| *registreTypeEntierBigEndian* | Clé de type Entier au format big-endian |
| *registreTypeMultiChaîne* | Clé de type Multichaîne |



**`<Mode d'accès> : (Constante de type Entier)`**

Mode d'accès à la base de registre :



|   |   |
| --- | --- |
| *registreMode32* | Mode d'accès forcé pour accéder à la base de registre comme un programme 32 bits. |
| *registreMode64* | Mode d'accès forcé pour accéder à la base de registre comme un programme 64 bits. |
| *registreModeAuto*<br>(Valeur par défaut) | Mode d'accès à la base de registre automatique : <br><br>- une application 32 bits exécutée sur un système 32 bits manipule la base de registre comme un programme 32 bits.<br><br>- une application 32 bits exécutée sur un système 64 bits manipule la base de registre à partir de la branche suivante :<br>	<br><pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node</code></pre><br><br><br>- une application 64 bits exécutée sur un système 64 bits manipule la base de registre comme un programme 64 bits.<br><br><br> |



**`<Chemin de la clé> : (Chaîne de caractères)`**

Chemin complet de la clé à manipuler. Cette clé doit exister.

**`<Indice de la valeur> : (Entier)`**

Indice de la valeur à manipuler.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
<a name="NOTE0_2"></a>




### Manipulation de la base de registre sous Windows Vista (et supérieur)
<a name="manipulation_base_registre_sous_windows_vista_superieur_ELTPARAGRAPHE000082"></a>Sous Windows Vista (et supérieurs), si le [mécanisme de l'UAC](../Editeurs/2025014.md) est activé, il est nécessaire d'avoir les droits administrateur pour écrire dans la clé "HKEY_LOCAL_MACHINE\\SOFTWARE".

Si l'utilisateur n'a pas les droits nécessaires, le mécanisme de l'UAC effectue une redirection automatique vers la clé "HKEY_CURRENT_USER\\Software\\Classes\\VirtualStore\\MACHINE\\SOFTWARE". Cette redirection a pour but d'assurer la compatibilité des applications. Les clés écrites dans ce répertoire pourront être lues par l'application qui les a écrites.  

**Rappel** : lors de la création de l'exécutable, il est possible d'inclure un manifeste à l'exécutable afin de donner les droits administrateur à l'application.

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280std.dll
