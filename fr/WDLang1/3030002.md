
## DnDDonnéeDisponible (Fonction)

***En anglais : DnDIsDataAvailable***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Teste si des données d'un type spécifié sont disponibles lors du glisser/déplacer.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003030002&name=dnddonneedisponible_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Seule la copie de type "CF_TEXT" est autorisée
SI DnDDonnéeDisponible(CF_TEXT) = Vrai ALORS
	ResRécupère = DnDRécupère(CF_TEXT)
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = DnDDonnéeDisponible(<Type de données>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si des données du type spécifié sont disponibles, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Type de données> : (Entier ou chaîne de caractères)`**

Type des données copiées/déplacées (correspond au type de données spécifié avec les fonctions [DnDDonne](../WDLang1/3030001.md) et [DnDRécupère](../WDLang1/3030008.md)).

- **Type de données prédéfini** :
	Seuls quelques types de données sont présentés ci-dessous. Pour une liste complète, consultez la documentation Microsoft "Standard Clipboard Formats".
	


|   |   |   |
| --- | --- | --- |
| *CF_TEXT* | 1 | Chaîne ANSI terminée par le caractère \\0 |
| *CF_BITMAP* | 2 | .BMP (image bitmap) |
| *CF_METAFILEPICT* | 3 | .WMF (fichier de primitives graphiques) |
| *CF_SYLK* | 4 | .SLK, Excel, Multiplan |
| *CF_DIF* | 5 | Data interchange format (lotus) |
| *CF_TIFF* | 6 | .TIF (image TIFF) |
| *CF_OEMTEXT* | 7 | Chaîne OEM terminée par le caractère \\0 |
| *CF_DIB* | 8 | .DIB (bitmap indépendant des gestionnaires de périphériques) |
| *CF_PALETTE* | 9 | Palette (au sens Windows) |
| *CF_PENDATA* | 10 | Crayon optique |
| *CF_RIFF* | 11 | Format audio |
| *CF_WAVE* | 12 | .WAV (données sonores) |
| *CF_UNICODETEXT* | 13 | Chaîne texte avec des caractères sur 2 octets (support international) |
| *CF_ENHMETAFILE* | 14 | .EMF (primitives graphiques Windows 32 bits) |
| *CF_HDROP* | 15 | Format de fichier "droppé" (sous Windows NT) |
| *CF_LOCALE* | 16 | Format local à Windows (sous Windows NT) |






- **Chaîne de caractères** :
	Type de données créé préalablement.
	Par exemple :
	
	```wl
	Donnée1 est une chaîne = CLIENT.CLE + TAB + FACTURE.PRIX
	DndDonne("MonType", Donnée1)
	```

	Le type de données "MonType" correspondra à ce qui a été mis dans la chaîne "Donnée". 






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Variables
<a name="variables_ELTPARAGRAPHE000168"></a>Les variables suivantes peuvent être utilisées :

| Nom de la variable | Description |
| --- | --- |
| **_DND.Action** | Action spécifiée dans la fonction [DnDAccepte](../WDLang1/3030005.md).<br><br>Les différentes valeurs possibles sont les suivantes : *dndCopier*, *dndDéplacer* et *dndInterdit*.<br><br>Cette variable n'est pas renseignée lors du début d'un glisser/déplacer dans un champ source (constante *dndDébutGlisser*) ou lors de la sortie d'un champ cible (constante *dndSortieChamp*). |
| **_DND.ChampCible** | Nom du champ cible.<br><br>Cette variable n'est pas renseignée lors du début d'un glisser/déplacer dans un champ source (constante *dndDébutGlisser*) ou lors de la sortie d'un champ cible (constante *dndSortieChamp*). |
| **_DND.ChampSource** | Nom du champ source. |
| **_DND.CtrlEnfoncé** | Etat de la touche contrôle Ctrl :<br><br>- Vrai : la touche contrôle Ctrl est enfoncée.<br><br>- Faux : la touche contrôle Ctrl n'est pas enfoncée.<br><br><br>Cette variable n'est pas renseignée lors du début d'un glisser/déplacer dans un champ source (constante *dndDébutGlisser*) ou lors de la sortie d'un champ cible (constante *dndSortieChamp*). |
| **_DND.FenSource** | Nom de la fenêtre source.<br><br>Cette variable n'est pas renseignée lors de la sortie d'un champ cible (constante *dndSortieChamp*). |
| **_DND.SourisPosX** | Position horizontale (X) du curseur de souris par rapport au champ manipulé lors de l'événement.<br><br>Cette variable n'est pas renseignée lors de la sortie d'un champ cible (constante *dndSortieChamp*). |
| **_DND.SourisPosY** | Position verticale (Y) du curseur de souris par rapport au champ manipulé lors de l'événement.<br><br>Cette variable n'est pas renseignée lors de la sortie d'un champ cible (constante *dndSortieChamp*). |


Les variables **_DND.ChampSource** et **_DND.FenSource** retournent une chaîne vide ("") lorsque le glisser/déplacer provient d'une application différente de l'application en cours.



<a name="XComposante"></a>

## Composante :
wd280obj.dll
