
## AppliContrôle (Fonction)

***En anglais : AppControl***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
**Cette fonction est d'un usage avancé. La gestion du contrôle à distance d'une application WINDEV est automatiquement mise en place lors de l'installation d'une application en réseau.**

**Cette fonction doit être utilisée uniquement pour personnaliser la gestion du contrôle à distance.**

Active (ou désactive) le contrôle à distance de l'application WINDEV multi-utilisateurs en cours. Le contrôle à distance permet de déconnecter "en douceur" les utilisateurs de l'application WINDEV afin d'effectuer une mise à jour de l'application (mise à jour de la base de données par exemple).

Le contrôle à distance permet :

- d'empêcher toute nouvelle connexion à une application,

- d'avertir l'utilisateur que l'application va être fermée pour mise à jour,

- de déconnecter l'utilisateur pour mise à jour de l'application.




Pour plus de détails, consultez le [principe du contrôle à distance](../WDAdminExe/2028052.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Code d'initialisation du projet
AppliContrôle("C:\MonAppli\FicStop.Txt", FEN_Control)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Activer ou désactiver le contrôle automatique

`AppliContrôle(<Fichier de contrôle> [, <Exécution fermeture du projet>])`
---

**`<Fichier de contrôle> : (Chaîne de caractères)`**

Chemin complet du fichier de contrôle (chemin de type UNC possible). Le fichier de contrôle est un fichier texte, avec une structure définie (pour plus de détails, consultez [Structure du fichier de contrôle](../WDLang1/3013005.md)).
 Si ce paramètre correspond à une chaîne vide (""), le contrôle est désactivé pour l'application en cours. 
L'outil WDADMINEXE permet de simplifier la création du fichier de contrôle.

**`<Exécution fermeture du projet> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> pour exécuter l'événement "Fermeture" du projet lors de la sortie automatique de l'application, 

- <u><u><u><u>Faux</u></u></u></u> (valeur par défaut) pour ne pas exécuter l'événement "Fermeture" du projet.





<a name="SYNTAXE2"></a>

### Contrôle automatique avec ouverture d'une fenêtre personnalisée

`AppliContrôle(<Fichier de contrôle> , <Fenêtre personnalisée>)`
---

**`<Fichier de contrôle> : (Chaîne de caractères)`**

Chemin complet du fichier de contrôle. Le fichier de contrôle est un fichier texte, avec une structure définie (pour plus de détails, consultez [Structure du fichier de contrôle](../WDLang1/3013005.md)). 
Si ce paramètre correspond à une chaîne vide (""), le contrôle est désactivé pour l'application en cours. 
L'outil WDADMINEXE permet de simplifier la création du fichier de contrôle.

**`<Fenêtre personnalisée> : (Nom de fenêtre)`**

Nom de la fenêtre de l'application qui sera ouverte pour traiter les messages du contrôle à distance. Pour plus de détails sur l'utilisation d'une fenêtre, consultez [Contrôle à distance : Personnalisation avec une fenêtre](../WDLang1/3013001.md).

Cette fenêtre doit être associée à une procédure du type : 

```txt
PROCEDURE <Nom de la fenêtre> (<Mode>, <Message>, <Temps d'affichage>)
```



|   |   |
| --- | --- |
| &lt;Mode&gt; | Récupère le mode de contrôle à distance en cours :<br><br>- *acInterdit* : accès interdit à l'application.<br><br>- *acAvertissement* : avertissement d'un arrêt imminent.<br><br>- *acArrêt* : arrêt de l'application.<br><br><br> |
| &lt;Message&gt; | Récupère le message correspondant au mode en cours (ce message doit être affiché dans la fenêtre). |
| &lt;Temps d'affichage&gt; | Temps d'affichage maximal de la fenêtre (en secondes). |




<a name="SYNTAXE3"></a>

### Contrôle automatique avec procédure personnalisée

`AppliContrôle(<Fichier de contrôle> , <Procédure WLangage>)`
---

**`<Fichier de contrôle> : (Chaîne de caractères)`**

Chemin complet du fichier de contrôle. Le fichier de contrôle est un fichier texte, avec une structure définie (pour plus de détails, consultez [Structure du fichier de contrôle](../WDLang1/3013005.md)). 
Si ce paramètre correspond à une chaîne vide, le contrôle est désactivé pour l'application en cours. 
L'outil WDADMINEXE permet de simplifier la création du fichier de contrôle.

**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure WLangage appelée pour traiter les messages du contrôle à distance. Pour plus de détails sur l'utilisation d'une procédure, consultez [Contrôle à distance : Personnalisation avec une procédure](../WDLang1/3013009.md). 
Cette procédure doit être une procédure globale de l'application et avoir pour déclaration : 

```txt
PROCEDURE <Nom de la procédure> ([<Mode> [, <Message> [, <Temps d'affichage>]]])
```



|   |   |
| --- | --- |
| &lt;Mode&gt; | Récupère le mode de contrôle à distance en cours :<br><br>- *acInterdit* : accès interdit à l'application.<br><br>- *acAvertissement* : avertissement d'un arrêt imminent.<br><br>- *acArrêt* : arrêt de l'application.<br><br><br><br><br>Attention : Lors d'un arrêt de l'application (constante *acArrêt*), l'arrêt du programme n'est pas fait automatiquement : votre code doit comporter l'instruction [FinProgramme](../WDLang1/3013033.md) pour terminer l'application. |
| &lt;Message&gt; | Récupère le message correspondant au mode en cours. |
| &lt;Temps d'affichage&gt; | Temps d'affichage maximal d'une éventuelle fenêtre (en secondes). |





<a name="XComposante"></a>

## Composante :
wd280vm.dll
