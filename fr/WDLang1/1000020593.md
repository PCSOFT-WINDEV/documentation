


## &lt;Menu&gt;.AjouteOption (Fonction)

***En anglais : &lt;Menu&gt;.AddOption***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute une nouvelle option de menu à la suite de la dernière option d'un menu (déroulant ou contextuel). Cette option de menu exécute une procédure WLangage. Pour insérer une option de menu à un emplacement spécifique, utilisez la fonction [&lt;Menu&gt;.InsèreOption](../WDLang1/1000020609.md).

**Rappel** : Le nom du menu principal est défini : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) dans la fenêtre de description de la fenêtre.





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
```wl
// Ajoute un nouveau menu dans le menu MENU_MonMenu
MENU_MonMenu.AjouteMenu("OPT_Planning", "Planning")
// Ajoute une option dans le nouveau menu OPT_Planning
OPT_Planning.AjouteOption("OPT_Créer", "Créer", Créer_Planning)
// Associe une image à l'option de menu OPT_Créer
{"OPT_Créer", indChamp}..Image = "planning.png"
// Ajoute un séparateur
OPT_Planning.AjouteSéparateur()
// Ajoute une nouvelle option (OPT_Voir)
OPT_Planning.AjouteOption("OPT_Voir", "Voir", Voir_planning)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Menu d'origine>.AjouteOption(<Option à créer> , <Libellé> , <Procédure WLangage> [, <Paramètre de la procédure>])`
---

**`<Résultat> : (Entier)`**

Position de l'option dans le menu. Si l'ajout de l'option n'a pas été effectué, une erreur fatale est affichée.

**`<Menu d'origine> : (Nom de menu)`**

Nom du menu dans lequel l'option de menu doit être ajoutée. L'option de menu sera ajoutée à la suite de la dernière option de ce menu.
Remarque : Ce nom de menu peut correspondre à un menu contextuel. 

**`<Option à créer> : (Chaîne de caractères)`**

Nom de l'option de menu à ajouter. Ce nom sera utilisé pour manipuler l'option de menu par programmation. 
Si ce nom correspond à une option existante, une erreur fatale est affichée.

**`<Libellé> : (Chaîne de caractères)`**

Libellé de la nouvelle option de menu. Ce libellé sera affiché dans la fenêtre et permettra à l'utilisateur de sélectionner l'option.

**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure WLangage appelée lorsque l'option de menu est sélectionnée.

**`<Paramètre de la procédure> : (Variant optionnel)`**

Paramètre pouvant être passé à la procédure &lt;Procédure WLangage&gt; lorsque l'option de menu est sélectionnée par l'utilisateur.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Associer une image à une option de menu
<a name="associer_une_image_une_option_menu_ELTPARAGRAPHE000217"></a>Pour associer une image à une option de menu, utilisez la propriété [Image](../Proprietes/2510034.md).


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDDerniersDocuments.gif) ***Composants (WINDEV)*** : **WD DerniersDocuments** <br>Cet exemple montre comment ajouter dans un menu d'une application la liste des derniers documents ouverts.<br>Cette insertion se fait grâce à une classe proposée dans le composant "DerniersDocuments".<br>Quatre lignes de codes suffisent à insérer dans une application existante la liste des derniers documents ouverts.<br>Vous trouverez dans l'exemple ces traitements dans :<br>	- le code de déclaration des globales de la fenêtre principale,<br>	- le code de la procédure OuvreDocument,<br>	- le code des options de menu "Fichier 1" à "Fichier 10".<br>Notez que l'exemple a volontairement été réduit en nombre de fonctionnalités (consultation unique de fichiers textes) afin de mettre en évidence l'utilisation du composant.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
