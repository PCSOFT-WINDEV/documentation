


## &lt;Tableur&gt;.AutoriseProcédure (Fonction)

***En anglais : &lt;Spreadsheet&gt;.AllowProcedure***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Autorise l'utilisation d'une procédure WLangage dans une formule d'un champ Tableur. 

**Remarque** : Par défaut, les procédures WLangage ne sont pas autorisées dans les formules pour des raisons de sécurité. En effet, un utilisateur malveillant pourrait par exemple appeler une procédure d'initialisation qui remet à 0 tous les fichiers de données.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Autorise la procédure CalculeTVA() dans les formules
TBLR_Tableur.AutoriseProcédure("CalculeTVA" + RC + "PrixMax" + RC + "PrixMin")
TBLR_Tableur.AjouteFormule(1,1, "CalculeTVA(C2)")
TBLR_Tableur.AjouteFormule(2,1, "(PrixMax() + PrixMin())/2")
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Champ Tableur>.AutoriseProcédure(<Procédure WLangage>)`
---

**`<Champ Tableur> : (Nom de champ)`**

Nom du champ Tableur à manipuler.

**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure WLangage autorisée dans une formule. Cette procédure peut être une procédure locale ou globale. 
Pour spécifier plusieurs procédures, il suffit de séparer les noms par un Retour Chariot (RC). 
Cette procédure doit renvoyer la valeur à afficher dans la cellule utilisant la formule.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- **Attention** : Si une procédure WLangage est autorisée, cette procédure apparaîtra dans la liste des formules proposées à l'utilisateur. L'utilisateur final pourra donc utiliser cette procédure. Pensez à fournir une documentation des formules possibles et des paramètres attendus. 

- Cette fonction est utilisable uniquement sur un champ Tableur présent dans une fenêtre.





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampTableur.gif) ***Exemples unitaires (WINDEV)*** : **Le champ Tableur** <br>Utilisation du champ Tableur.<br>Cet exemple présente comment :<br>- charger un fichier xlsx dans un champ tableur,<br>- sauver le tableur dans un fichier,<br>- remplir le champ avec des données provenant de la base de données,<br>- insérer des lignes, des colonnes,<br>- accéder aux cellules et les manipuler (modifier leur valeur, leur style,...),<br>- saisir des formules,<br>- etc.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
