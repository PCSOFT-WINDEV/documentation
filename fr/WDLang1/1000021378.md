
## DemandeMiseAJourIHM (Fonction)

***En anglais : RequestUpdateUI***

<DIV class="specObsolete">
	<IMG style="float:left;margin-right:10px;" src="https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=warning_big.png"><B>Avertissement</B><BR>
	A partir de la version <B>25</B>,  cette fonction est conservée par compatibilité. Il est conseillé d'utiliser la fonction [DemandeMiseAJourUI](../WDLang1/1000023899.md). 
</DIV><a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Demande l'exécution de l'événement "Demande de mise à jour de l'affichage" (et rend la main **sans attendre l'exécution de l'événement**).

**Remarques** : 

- L'événement "Demande de mise à jour de l'affichage" est disponible sur les fenêtres, fenêtres internes, pages, pages internes, modèles de champs et superchamps.

- Si cette fonction est appelée plusieurs fois, les appels avec les mêmes paramètres non encore exécutés sont ignorés.

- Dans le cas d'un appel dans le thread principal, la ou les exécutions de l'événement "Demande de mise à jour de l'affichage" se feront à la fin du traitement en cours.

- Dans le cas d'un appel dans un thread secondaire, la ou les exécutions de l'événement "Demande de mise à jour de l'affichage" se feront lors du rafraichissement de la fenêtre.




**Utilisations** : Cette fonction est notamment utilisée : 

- dans le cadre d'une mise à jour de l'interface via des threads. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) dans le cadre d'une programmation de type MVP (Modèle - Vue - Présentation). Pour plus de détails, consultez [Présentation MVP : Modèle - Vue - Présentation](../Editeurs/1000021496.md). 







<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Traitement d'enregistrement
// L'interface graphique devra être mise à jour 
DemandeMiseAJourIHM()
```

```wl
// ----------------------------------------------------------------
// -- Evénement Demande de mise à jour de l'affichage de FEN_Fiche_Contact
// Mise à jour du titre de la fenêtre
MoiMême..Titre = gpclFicheContact.p_sNomComplet

// Mise à jour des champs liés de la fenêtre
SourceVersEcran()
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`DemandeMiseAJourIHM([<Paramètre 1> [... [, <Paramètre N>]]])`
---

**`<Paramètre 1> : (Paramètre optionnel correspondant au type attendu par l'événement "Demande de mise à jour de l'affichage")`**

Premier paramètre à passer à l'événement "Demande de mise à jour de l'affichage" de la fenêtre. 



**`<Paramètre N> : (Type de la valeur attendue par l'événement "Demande de mise à jour de l'affichage")`**

Nième paramètre à passer à l'événement "Demande de mise à jour de l'affichage" de la fenêtre. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Evénement "Demande de mise à jour de l'affichage"
<a name="evenement_demande_mise_jour_affichage_ELTPARAGRAPHE000081"></a>Un des événements associés à la fenêtre est l'événement "Demande de mise à jour de l'affichage". Cet événement permet de regrouper le code de mise à jour des champs de la fenêtre : contenu des champs, état (visible, grisé, ...), libellé à mettre à jour, ...

Cet événement peut attendre des paramètres. Il suffit de déclarer une procédure dans l'événement. Par exemple : 

```wl
// Demande de mise à jour de l'affichage
PROCEDURE DemandeMiseAjour(TypeMiseAJour est un booléen)
```


Cet événement est lancé sur demande grâce aux fonctions : 

- **DemandeMiseAJourIHM** : Exécute l'événement "Demande de mise à jour de l'affichage" à la fin du traitement en cours (lancement asynchrone). 

- [ExécuteMiseAJourIHM](../WDLang1/1000021379.md) : Exécute immédiatement l'événement "Demande de mise à jour de l'affichage". 

- [DemandeMiseAjourIHMParent](../WDLang1/1000022961.md) : Exécute l'événement "Demande de mise à jour de l'affichage" du niveau supérieur à la fin du traitement en cours (lancement asynchrone).

- [ExécuteMiseAJourIHMParent](../WDLang1/1000022961.md) : Exécute immédiatement l'événement "Demande de mise à jour de l'affichage" du niveau supérieur.
Lors de l'appel de ces fonctions, il est possible de préciser la valeur des paramètres attendus par l'événement "Demande de mise à jour de l'affichage". 

Remarque : L'élément dont l'événement "Demande de mise à jour de l'affichage" est exécuté dépend du code depuis lequel la fonction **DemandeMiseAJourIHM** a été appelé. S'il s'agit d'une classe ayant l'attribut **présentation**, l'élément considéré sera la fenêtre associée à la classe, sinon ce sera l'élément depuis lequel le code a été lancé.





![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 

### Attribut "présentation"
<a name="attribut_presentation_ELTPARAGRAPHE000118"></a>L'attribut **présentation** permet d'associer une classe de la couche présentation à une vue (fenêtre, page ou état). 

Cet attribut est utilisé notamment lors de la déclaration globale des fenêtres générées par le RAD MVP sous WINDEV. 

Par exemple : 

```wl
PROCEDURE FEN_Table_MonFichierExemple(...
	gclPresentation est un PTableMonFichierExemple dynamique<présentation>=Null)
```


Grâce à cet attribut, l'appel de l'événement "Demande de mise à jour de l'affichage" de la fenêtre sera déclenché par :

- tout appel à la fonction [DemandeMiseAJourIHM](../WDLang1/1000021378.md) depuis une classe déclarée comme &lt;présentation&gt;,

- tout appel depuis toute classe associée à la classe &lt;présentation&gt;. 




Pour plus de détails, consultez [RAD MVP : Attribut "présentation"](../Editeurs/1000021508.md). 







<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280vm.dll
