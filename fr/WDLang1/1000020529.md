
## ErreurAvecDélai (Fonction)

***En anglais : ErrorWithTimeout***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Affiche un message d'erreur personnalisé dans une fenêtre d'erreur système pendant un délai défini. Lorsque le délai est écoulé, la fenêtre système se ferme automatiquement. 

Remarques : 

- **Cette fenêtre d'avertissement est bloquante tant que le délai n'est pas écoulé**. Pour continuer l'exécution de l'application, l'utilisateur doit cliquer sur le bouton "OK". 
	![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Pour ne pas bloquer l'application, utilisez la fonction [ErreurAvecDélaiAsynchrone](../WDLang1/1000025428.md).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) WINDEV permet d'appliquer le gabarit de votre projet à cette boîte de dialogue. Pour plus de détails, consultez [Personnaliser les boîtes de dialogue](../WDLang1/3021003.md).





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Affiche "Une erreur a été détectée" dans une fenêtre d'erreur
// Cette fenêtre d'erreur se fermera automatiquement après 10 secondes.
ErreurAvecDélai(1000, "Une erreur a été détectée")
```


<a name="Exemple2"></a>

```wl
// Affiche la dernière erreur dans une fenêtre d'erreur 
// Cette fenêtre d'erreur se fermera automatiquement après 5 secondes.
ErreurAvecDélai(500)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Afficher un message d'erreur personnalisé

`ErreurAvecDélai(<Délai> , <Texte> [, <Ligne 2> [... [, <Ligne n>]]])`
---

**`<Délai> : (Entier ou Durée)`**

Délai (exprimé en centièmes de seconde) avant la fermeture automatique de la fenêtre d'erreur. Ce paramètre peut correspondre à : 

- un entier correspondant au nombre de centièmes de seconde, 

- une variable de type Durée, 

- l'indication directe de la durée (par exemple 1 s ou 10 ms). 




**`<Texte> : (Chaîne de caractères)`**

Texte à afficher.

**`<Ligne 2> : (Chaîne de caractères optionnelle)`**

Texte affiché sur la seconde ligne.



**`<Ligne n> : (Chaîne de caractères optionnelle)`**

Texte affiché sur la Nième ligne.


<a name="SYNTAXE2"></a>

### Afficher le message d'erreur de la dernière fonction WLangage utilisée

`ErreurAvecDélai(<Délai avant fermeture>)`
---

**`<Délai avant fermeture> : (Entier ou Durée)`**

Délai (exprimé en centièmes de seconde) avant la fermeture automatique de la fenêtre d'erreur. Ce paramètre peut correspondre à : 

- un entier correspondant au nombre de centièmes de seconde, 

- une variable de type Durée, 

- l'indication directe de la durée (par exemple 1 s ou 10 ms). 






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Caractéristiques de la boîte de dialogue
<a name="caracteristiques_boite_dialogue_ELTPARAGRAPHE000089"></a>

- Le titre de la boîte de dialogue correspond au titre de la fenêtre en cours. Pour modifier ce titre, utilisez la fonction [TitreSuivant](../WDLang1/3038043.md).

- Le message est cadré à gauche.

- Le libellé du bouton dépend de la langue d'exécution de Windows.

- Le nombre maximum de caractères affichés est limité à 4096. Si une chaîne plus grande est passée en paramètre, elle sera tronquée.

- L'icône affichée (croix blanche) ne peut pas être modifiée.




**Pour personnaliser cette boîte de dialogue** (ainsi que toutes les boîtes de dialogue système de votre application), cochez l'option "Personnaliser les fenêtres système (Info, OuiNon, Confirmer, Dialogue)" dans l'onglet "Style" de la description du projet. Pour plus de détails, consultez [Personnaliser les boîtes de dialogue](../WDLang1/3021003.md).
<a name="NOTE0_2"></a>




### Saut de ligne dans la boîte de dialogue
<a name="saut_ligne_dans_boite_dialogue_ELTPARAGRAPHE000113"></a>La chaîne prédéfinie RC (Retour Chariot) peut être utilisée pour forcer le passage à la ligne suivante. Par exemple : 

```wl
ErreurAvecDélai(500, "Une erreur a été détectée lors de la saisie de l'adresse. " + RC + ...
	"Merci de modifier les données concernant le client.")
```

est équivalent à : 

```wl
ErreurAvecDélai(500, "Une erreur a été détectée lors de la saisie de l'adresse. " , ...
	"Merci de modifier les données concernant le client.")
```


Il est également possible d'utiliser la syntaxe des chaînes multilignes. Par exemple : 

```wl
ErreurAvecDélai(500,
[
Une erreur a été détectée lors de la saisie de l'adresse. 

Merci de modifier les données concernant le client.
])
```



<a name="NOTE0_3"></a>


### Afficher le dernier message d'erreur rencontré
<a name="afficher_dernier_message_erreur_rencontre_ELTPARAGRAPHE000131"></a>L'utilisation de la fonction **ErreurAvecDélai** en précisant uniquement le délai (syntaxe 2) permet d'afficher directement le message d'erreur correspondant à la dernière fonction WLangage ayant déclenché une erreur.

Dans ce cas, le code suivant : 

```wl
ErreurAvecDélai(500)
```

est équivalent à : 

```wl
ErreurAvecDélai(500, ErreurInfo())
```


**Attention** : La fonction **ErreurAvecDélai** doit être utilisée immédiatement après l'appel à la fonction qui a échoué. En effet, l'appel à une fonction du WLangage peut ré-initialiser et modifier le compte-rendu de la fonction **ErreurAvecDélai**.
<a name="NOTE0_4"></a>




### Divers
<a name="divers_ELTPARAGRAPHE000159"></a>

- Les timers (fonction [TimerSys](../WDLang1/3015006.md)) ne sont pas stoppés lors de l'appel de cette fonction.

- Les événements Windows ne sont pas stoppés lors de l'appel à cette fonction.

- Le libellé du bouton s'affiche dans la langue utilisée par Windows sur le poste en cours.

- Equivalence : La fonction **ErreurAvecDélai** est équivalente à la fonction [Erreur](../WDLang1/3021013.md) utilisée avec la fonction [DélaiAvantFermeture](../WDLang1/3038040.md) : 
	Le code suivant : 
	
	```wl
	ErreurAvecDélai(1000, "Une erreur a été détectée")
	```

	est équivalent à : 
	
	```wl
	DélaiAvantFermeture(1000)
	Erreur("Une erreur a été détectée")
	```




<a name="NOTE0_5"></a>







<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
