
## ThreadArrête (Fonction)

***En anglais : ThreadStop***

<DIV class="specObsolete">
	<IMG style="float:left;margin-right:10px;" src="https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=warning_big.png"><B>Avertissement</B><BR>
	 L'utilisation de cette fonction est fortement déconseillée car elle arrête violemment le thread en pleine activité. Elle peut provoquer des problèmes graves (écriture de fichier incomplète, perte de mémoire, section critique non libérée, ...). Il est conseillé d'utiliser les fonctions [ThreadDemandeArrêt](../WDLang1/1000021218.md) et [ThreadArrêtDemandé](../WDLang1/1000021219.md). 
</DIV><a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Arrête un thread secondaire.

**Rappel** : Un thread est un processus lancé en parallèle de l'application en cours ("thread" principal). Il est par exemple possible de lancer l'exécution d'une tâche en traitement de fond (sauvegarde, ...).




<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ThreadArrête(<Nom du thread> [, <Durée maximale>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le thread s'est arrêté ou si le thread n'existe pas, 

- <u><u><u><u>Faux</u></u></u></u> si le thread est bloqué




**`<Nom du thread> : (Chaîne de caractères)`**

Nom du thread à arrêter. Ce nom est donné lors de l'exécution du thread (fonction [ThreadExécute](../WDLang1/3077024.md)). 

Cas particuliers :  

- Si ce paramètre correspond à une chaîne vide (""), le thread en cours est arrêté. Si le thread en cours est le thread principal, la fonction **ThreadArrête** est équivalente à la fonction [FinProgramme](../WDLang1/3013033.md). 
	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Seul ce fonctionnement est autorisé. La fonction **ThreadArrête** peut être utilisée uniquement sur le thread courant.

- Si le nom du thread n'existe pas, la fonction **ThreadArrête** ne fait rien et renvoie <u><u><u><u>Vrai</u></u></u></u>. 

- Si le nom du thread est un thread fils ou frère, la fonction **ThreadArrête** attend que la fonction du WLangage en cours (par exemple HLitPremier) soit terminée. Dans ce cas, la fonction **ThreadArrête** est bloquante.

- Si ce paramètre correspond à la constante *ThreadPrincipal*, le thread principal est arrêté.

- Dans les autres cas, une erreur du WLangage est générée. 




**`<Durée maximale> : (Entier optionnel)`**

Nombre de centièmes de seconde d'attente maximale. 

- Si à la fin de la durée spécifiée, le thread n'est pas arrêté, &lt;Résultat&gt; est égal à <u><u><u><u>Faux</u></u></u></u>. 

- Si ce paramètre n'est pas spécifié ou si la constante *Infinie* est utilisée, l'attente est infinie.


Ce paramètre peut correspondre à : 

- un entier correspondant au nombre de centièmes de seconde, 

- une variable de type Durée, 

- l'indication directe de la durée (par exemple 1 s ou 10 ms). 






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Cas particulier : Arrêt d'un thread contenant la fonction SocketAttendConnexion
<a name="cas_particulier_arret_thread_contenant_fonction_socketattendconnexion_ELTPARAGRAPHE000135"></a>Pour que le thread soit correctement arrêté avec la fonction **ThreadArrête**, il est nécessaire de mettre la fonction bloquante [SocketAttendConnexion](../WDLang3/3070006.md) dans une boucle :


```wl
Durée = 30
BOUCLE
	SocketAttendConnexion("MaSocket", Durée)
FIN
```


<a name="XComposante"></a>

## Composante :
wd280vm.dll
