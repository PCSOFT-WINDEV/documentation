
## Thread (Type de variable)

***En anglais : Thread***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **Thread** permet de définir toutes les caractéristiques d'un thread. Les caractéristiques de ce thread peuvent être définies et modifiées à l'aide de différentes propriétés WLangage. 

**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Déclare une variable pour manipuler un thread
t est un thread
// Construit un thread et déclenche son exécution sur une procédure
t = ThreadExécute(Proc, ("Premier paramètre", 2))
```



```wl
// Construit un thread
t est un Thread(Proc, ("Premier paramètre", 2))
// Déclenche l'exécution du thread
ThreadExécute(t)
```





## Déclaration
<a name="declaration_ELTTEXTE000282"></a>
<a name="SYNTAXE1"></a>

### Déclarer un thread non décrit

`MaVariable est un Thread`
---

Dans ce cas, le thread n'est pas décrit. La variable devra être affectée avec un thread existant ou avec le résultat d'une des fonctions d'exécution des threads.


<a name="SYNTAXE2"></a>

### Décrire un thread via le type Thread

`MaVariable est un Thread (<Procédure> [, <Paramètres> [, <Options>]])`
---

**`<Procédure> : (Chaîne de caractères ou variable de type Procédure)`**

Procédure à exécuter. Ce paramètre peut correspondre : 

- au nom de la procédure à exécuter. 

- au nom de la variable de type [Procédure](../Motscles/1000018907.md) correspondant à la procédure à exécuter.




**`<Paramètres> : (Liste de valeurs entre parenthèses et séparées par des virgules)`**

Paramètres de la procédure à exécuter. Cette liste de paramètres est de la forme : 

```txt
(<Paramètre 1>, ..., <Paramètre N>)
```
où : 

- &lt;Paramètre 1&gt; : Premier paramètre de la procédure.

- ...

- &lt;Paramètre N&gt; : Nième paramètre de la procédure.




**`<Options> : (Constante optionnelle de type Entier)`**

Mode de lancement du thread.


|   |   |
| --- | --- |
| *threadAttendDémarrage* | Attend le démarrage effectif du thread avant de continuer l'exécution. |
| *threadContexteGlobal* | Force l'utilisation du contexte global du projet si le thread est exécuté depuis une fenêtre. Le thread continuera donc de s'exécuter jusqu'à la fermeture de l'application.<br>Par défaut, le contexte de la fenêtre est utilisé, le thread est donc arrêté lors de la fermeture de la fenêtre. |
| *threadCopieComplèteContexteHFSQL*<br>(Valeur par défaut) | Provoque la copie immédiate du contexte HFSQL courant.<br>Conseillé par exemple si le thread doit tenir compte des positions en cours dans les fichiers et requêtes du contexte de l'appelant. |
| *threadCopieLégèreContexteHFSQL* | Provoque la copie immédiate d'une partie du contexte HFSQL courant. <br>Sont mémorisés : <br><br>- les répertoires où se trouvent les fichiers de données en HFSQL Classic. <br><br>- les connexions en HFSQL Client/Serveur.<br><br><br> |
| *threadNormal* | Lance le thread en mode normal. Le contexte HFSQL est copié lors de la première utilisation d'une fonctionnalité HFSQL. |
| *threadSécurisé* | Lance un thread en mode sécurisé. Dans ce mode : <br><br>- une erreur de compilation sera affichée si des accès aux champs sont effectués dans le thread (ou si la procédure utilise l'attribut "UI"). <br><br>- une exception sera générée : <br><br>	- si le thread accède aux champs en exécution, <br><br>	- si la fonction [ThreadArrête](../WDLang1/3077019.md) est utilisée.<br><br><br><br><br>- la fermeture de la fenêtre qui a lancé le thread provoque une demande d'arrêt (mais le thread peut continuer à s'exécuter après la fermeture de la fenêtre). <br><br><br> |



**Dans ce cas, le thread est décrit et sa description ne peut plus être modifiée.** 
Le thread n'est pas exécuté automatiquement, une déclaration seule ne provoquera donc pas l'exécution du thread. Il faut appeler une des fonctions d'exécution des threads pour déclencher l'exécution du thread.







<a name="NOTE0"></a>

## Remarques
<a name="NOTE0_1"></a>


### Propriétés spécifiques à la description des variables de type Thread
<a name="proprietes_specifiques_description_des_variables_type_thread_ELTPARAGRAPHE000113"></a>Les propriétés suivantes peuvent être utilisées pour manipuler une variable de type **Thread** :

| Nom de la propriété | Type manipulé | Effet |
| --- | --- | --- |
| ArrêtDemandé | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> si l'arrêt du thread a été demandé, <br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. <br><br><br>**Cette propriété est disponible en lecture seulement**. |
| Etat | Constante de type Entier | Etat du thread : <br><br>- *threadArrêtDemandé* : L'arrêt du thread a été demandé. <br><br>- *threadEncours* : Le thread est en cours d'exécution. <br><br>- *threadNonExécuté* : Le thread n'a pas été exécuté. <br><br>- *threadSuspendu* : Le thread est suspendu. <br><br>- *threadTerminé* : Le thread existe mais il est terminé. <br><br><br><br><br>**Cette propriété est disponible en lecture seulement**. |
| Nom | Chaîne de caractères | Nom du thread. <br><br>**Cette propriété est disponible en lecture seulement**. |
| Priorité | Constante de type Entier | Niveau de priorité actuel du thread :<br><br>- *PrioritéElevée* : Priorité élevée.<br><br>- *PrioritéNormale* : Priorité normale.<br><br>- *PrioritéBasse* : Priorité basse.<br><br><br><br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Non disponible. |
| ValeurRenvoyée | Valeur renvoyée par le thread. | Attention : <br><br>- Si le thread est toujours en cours, la propriété **ValeurRenvoyée** est bloquante en attendant la fin du thread.<br><br>- Si le thread est terminé sans erreur fatale, la propriété renvoie la ou les valeurs de retour de la procédure principale du thread.<br><br><br><br><br>**Cette propriété est disponible en lecture seulement**. <br><br>Rappel :<br><br>- La propriété **Etat** permet de connaître l'état du thread. <br><br>- Il est possible d'attendre la fin d'un thread avec la fonction [ThreadAttend](../WDLang1/3077020.md). <br><br><br> |


<a name="NOTE0_2"></a>


### Fonctions WLangage manipulant les variables de type Thread
<a name="fonctions_wlangage_manipulant_les_variables_type_thread_ELTPARAGRAPHE000199"></a>


|   |   |
| --- | --- |
| [ThreadAttend](../WDLang1/3077020.md) | Attend la fin de l'exécution du thread désigné. |
| [ThreadDemandeArrêt](../WDLang1/1000021218.md) | Envoie une demande d'arrêt à un thread. |
| [ThreadEnvoieSignal](../WDLang1/3077021.md) | Le thread en cours envoie un signal au thread spécifié pour le débloquer. |
| [ThreadExécute](../WDLang1/3077024.md) | Lance l'exécution d'un thread secondaire. |








