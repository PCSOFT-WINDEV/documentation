


## TableRafraîchissementVisible (Fonction)

***En anglais : TableRefreshVisible***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie ou renvoie l'état de visibilité du bandeau de rafraîchissement d'un champ Table ou Table hiérarchique.

Cette fonction peut être utilisée lorsque le champ Table gère l'option "Pull-to-refresh". Pour activer cette option dans un champ Table : 

1. Affichez la fenêtre de description du champ Table. 

2. Dans l'onglet "Détail", dans la zone "Déplacements et gestures", cochez l'option "Rafraîchissement par tirer/relâcher".

3. Validez. 


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette fonction est disponible sous WINDEV uniquement pour pouvoir être utilisée en mode simulateur. Utilisée dans une application WINDEV, cette fonction n'a aucun effet. 


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Evénement "Rafraîchissement par tirer/Relâcher" du champ Table
// ---------------------------------------------------------
// Demande à contrôler l'affichage du bandeau de sélection car l'actualisation des
// données du champ Table va être effectuée dans un thread secondaire. 
// Dans le cas contraire, le bandeau de rafraîchissement serait automatiquement masqué à la
// fin de l'exécution du traitement.
TableRafraîchissementVisible(TABLE_Données, Vrai)
// Exécute l'actualisation des données du champ Table dans un thread secondaire
ThreadExécute("threadMajTable", threadNormal, ProcThreadMajTable)
```

```wl
//----------------------------------------------------
// Procédure de mise à jour des données du champ Table
PROCEDURE ProcThreadMajTable()
// Exécution d'une requête HTTP
HTTPRequête(...)
// Retourne dans le thread principal pour ajouter le contenu de la requête dans le champ Table
ExécuteThreadPrincipal(ProcMajTable, HTTPDonneRésultat())
FIN
```

```wl
// ---------------------------------------------------
// Procédure de remplissage des données du champ Table
PROCEDURE ProcMajTable(sDonnees est une chaîne)
// Traitement des données reçues pour remplissage du champ Table
...
// Les données du champ Table sont à jour, on masque le bandeau de rafraîchissement
TableRafraîchissementVisible(TABLE_Données, Faux)
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Modifier l'état de visibilité du bandeau de rafraîchissement

`TableRafraîchissementVisible(<Champ Table> , <Visible>)`
---

**`<Champ Table> : (Nom de champ)`**

Nom du champ à manipuler. Ce champ peut correspondre : 

- à un champ Table.

- à un champ Table hiérarchique.




**`<Visible> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> pour afficher le bandeau de rafraîchissement,

- <u><u><u><u>Faux</u></u></u></u> pour le masquer.





<a name="SYNTAXE2"></a>

### Connaître l'état de visibilité du bandeau de rafraîchissement

`<Résultat> = TableRafraîchissementVisible(<Champ Table>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le bandeau de rafraîchissement est affiché,

- <u><u><u><u>Faux</u></u></u></u> si le bandeau de rafraîchissement est masqué.




**`<Champ Table> : (Nom de champ)`**

Nom du champ à manipuler. Ce champ peut correspondre : 

- à un champ Table.

- à un champ Table hiérarchique.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Lors d'un "Pull-to-refresh", le bandeau de rafraîchissement correspond à la zone affichée au-dessus des lignes du champ Table pendant le rafraîchissement des données.

- La fonction **TableRafraîchissementVisible** permet par exemple de contrôler l'affichage du bandeau de rafraîchissement, lorsque l'actualisation des données du champ Table est effectuée dans un thread secondaire. Il est ainsi possible d'éviter de figer l'application (l'exemple utilise cette méthode). 

- Lorsque le bandeau de rafraîchissement est rendu visible par la fonction **TableRafraîchissementVisible**, l'événement "Rafraîchissement par tirer/relâcher" du champ Table n'est pas exécuté.
	Remarque : Il est possible de forcer l'exécution de cet événement en utilisant la fonction [ExécuteTraitement](../WDLang1/3013031.md) avec la constante *trtTirerPourRafraîchir*.

- Pour masquer le bandeau de rafraîchissement, il est nécessaire d'appeler **TableRafraîchissementVisible(Faux)** autant de fois que **TableRafraîchissementVisible(Vrai)** a été exécuté.




<a name="XComposante"></a>

## Composante :
wd280java.dll
