


## HashVérifieFichier (Fonction)

***En anglais : HashCheckFile***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Vérifie le Hash d'un fichier pour un type d'algorithme défini. Il est possible de vérifier : 

- un hash simple.

- un hash avec authentification de message.

- un hash obtenu par un algorithme de dérivation de clé qui prend en paramètre un sel (PBKDF2).
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Non disponible.




**Rappel** : Le hachage permet de réaliser un résumé condensé d'un fichier ou d'une chaîne de caractères. Ce résumé est appelé Hash.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Calcul du Hash du fichier "C:\Temp\Fichier.txt"
HashMonFichier est une chaîne 
HashMonFichier = HashFichier(HA_MD5_128, "C:\Temp\Fichier.txt")

// Traitement sur le fichier
// ...

// Test si le fichier a été modifié
SI HashVérifieFichier(HA_MD5_128, "C:\Temp\Fichier.txt", ...
		HashMonFichier) = Faux ALORS
	Info("Le fichier a été modifié.")
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Vérifier un hash simple

`<Résultat> = HashVérifieFichier(<Type d'algorithme> , <Chemin du fichier> , <Hash>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le résultat du hachage du fichier &lt;Chemin du fichier&gt; par l'algorithme &lt;Type d'algorithme&gt; correspond au paramètre &lt;Hash&gt;, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Type d'algorithme> : (Constante de type Entier)`**

Indique le type d'algorithme utilisé lors du hachage du fichier &lt;Chemin du fichier&gt; :



|   |   |
| --- | --- |
| Famille MD4 | *HA_MD4*<br><br> |
| Famille MD5 | *HA_MD5_128*<br><br>Attention : ce type d'algorithme est actuellement déprécié. |
| Famille MURMUR | <br><br>- *HA_MURMUR_1* : Algorithme Murmur version 1 : hash résultat sur 32 bits<br><br>- *HA_MURMUR_2* : Algorithme Murmur version 2 : hash résultat sur 32 bits<br><br>- *HA_MURMUR_2_64A* : Algorithme Murmur version 2 : hash résultat sur 64 bits optimisé pour processeurs 64 bits<br><br>- *HA_MURMUR_2_64B* : Algorithme Murmur version 2 : hash résultat sur 64 bits optimisé pour processeurs 32 bits<br><br>- *HA_MURMUR_2_A* : Algorithme Murmur version 2 incrémentiel : hash résultat sur 32 bits<br><br>- *HA_MURMUR_2_BIG_ENDIAN* : Algorithme Murmur version 2 pour machine big-endian: hash résultat sur 32 bits<br><br>- *HA_MURMUR_2_ALIGNE* : Algorithme Murmur version 2 pour machine alignée : hash résultat sur 32 bits<br><br>- *HA_MURMUR_3_32* : Algorithme Murmur version 3 : hash résultat sur 32 bits<br><br>- *HA_MURMUR_3_128_X86* : Algorithme Murmur version 3 : hash résultat sur 128 bits optimisé pour processeur 32 bits<br><br>- *HA_MURMUR_3_128_X64* : Algorithme Murmur version 3 : hash résultat sur 128 bits optimisé pour processeur 64 bits<br><br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les constantes de cette famille ne sont pas disponibles. |
| Famille RIPEMD | <br><br>- *HA_RIPEMD_128*<br><br>- *HA_RIPEMD_160*<br><br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les constantes de cette famille ne sont pas disponibles. |
| Famille SHA | <br><br>- HA_SHA_160 (aussi appelé SHA-1)<br><br>- HA_SHA_256 (spécifications FIPS PUB 198)<br><br>- HA_SHA_256_DOUBLE<br><br>- HA_SHA_384<br><br>- HA_SHA_512<br><br><br> |
| Famille SHA-3 | <br><br>- *HA_SHA3_224*<br><br>- *HA_SHA3_256*<br><br>- *HA_SHA3_384*<br><br>- *HA_SHA3_512*<br><br><br><br><br> |
| Famille TIGER | <br><br>- *HA_TIGER_128*<br><br>- *HA_TIGER_160*<br><br>- *HA_TIGER_192*<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les constantes de cette famille ne sont pas disponibles. |
| Famille WHIRLPOOL | *HA_WHIRLPOOL*<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Non disponible. |
| Famille CKSUM | <br><br>- *HA_CKSUM_8*<br><br>- *HA_CKSUM_16*<br><br>- *HA_CKSUM_32*<br><br>- *HA_CKSUM_64*<br><br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les constantes de cette famille ne sont pas disponibles. |





- Algorithmes MD4 / MD5 / SHA / RIPEMD : fonctions de hachage cryptographiques classiques.

- Algorithmes TIGER / WHIRLPOOL : fonctions de hachage ayant de très bonnes propriétés cryptographiques optimisées pour le 64 bits (mais leur utilisation est possible en 32 bits).

- Algorithmes CKSUM : fonctions de hachage ne possédant pas de propriété cryptographique, à n'utiliser que pour des contrôles minimaux ou des tables de hachage.

- Algorithme MURMUR : fonctions de hachage très rapides et ne possédant pas de propriétés cryptographiques. C'est l'algorithme utilisé pour le "bloom filter" des portefeuilles bitcoin.




**`<Chemin du fichier> : (Chaîne de caractères)`**

Chemin du fichier pour lequel le Hash doit être vérifié.

**`<Hash> : (Chaîne de caractères)`**

Hash du fichier à contrôler. Ce Hash doit être le résultat de la fonction [HashFichier](../WDLang1/1000007112.md) précédemment appelée pour le fichier &lt;Chemin du fichier&gt; sur l'algorithme &lt;Type d'algorithme&gt;.  


<a name="SYNTAXE2"></a>

### Vérifier un hash avec authentification de message (algorithme HMAC/algorithme MURMUR)

`<Résultat> = HashVérifieFichier(<Type d'algorithme> , <Chemin du fichier> , <Hash> , <Clé secrète>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le résultat du hachage du fichier &lt;Chemin du fichier&gt; par l'algorithme &lt;Type d'algorithme&gt; correspond au paramètre &lt;Hash&gt;, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Type d'algorithme> : (Constante de type Entier)`**

Indique le type d'algorithme HMAC utilisé lors du hachage du fichier &lt;Chemin du fichier&gt; :



|   |   |
| --- | --- |
| Famille MD4 | *HA_HMAC_MD4*<br><br> |
| Famille MD5 | *HA_HMAC_MD5_128*<br><br>Attention : ce type d'algorithme est actuellement déprécié. |
| Famille MURMUR | <br><br>- *HA_MURMUR_1* : Algorithme Murmur version 1 : hash résultat sur 32 bits<br><br>- *HA_MURMUR_2* : Algorithme Murmur version 2 : hash résultat sur 32 bits<br><br>- *HA_MURMUR_2_64A* : Algorithme Murmur version 2 : hash résultat sur 64 bits optimisé pour processeurs 64 bits<br><br>- *HA_MURMUR_2_64B* : Algorithme Murmur version 2 : hash résultat sur 64 bits optimisé pour processeurs 32 bits<br><br>- *HA_MURMUR_2_A* : Algorithme Murmur version 2 incrémentiel : hash résultat sur 32 bits<br><br>- *HA_MURMUR_2_BIG_ENDIAN* : Algorithme Murmur version 2 pour machine big-endian: hash résultat sur 32 bits<br><br>- *HA_MURMUR_2_ALIGNE* : Algorithme Murmur version 2 pour machine alignée : hash résultat sur 32 bits<br><br>- *HA_MURMUR_3_32* : Algorithme Murmur version 3 : hash résultat sur 32 bits<br><br>- *HA_MURMUR_3_128_X86* : Algorithme Murmur version 3 : hash résultat sur 128 bits optimisé pour processeur 32 bits<br><br>- *HA_MURMUR_3_128_X64* : Algorithme Murmur version 3 : hash résultat sur 128 bits optimisé pour processeur 64 bits<br><br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les constantes de cette famille ne sont pas disponibles. |
| Famille RIPEMD | <br><br>- *HA_HMAC_RIPEMD_128*<br><br>- *HA_HMAC_RIPEMD_160*<br><br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les constantes de cette famille ne sont pas disponibles. |
| Famille SHA | <br><br>- *HA_HMAC_SHA_160*<br><br>- *HA_HMAC_SHA_256* <br><br>- *HA_HMAC_SHA_256_DOUBLE*<br><br>- *HA_HMAC_SHA_384*<br><br>- *HA_HMAC_SHA_512*<br><br><br> |
| Famille SHA-3 | <br><br>- *HA_HMAC_SHA3_224*<br><br>- *HA_HMAC_SHA3_256*<br><br>- *HA_HMAC_SHA3_384*<br><br>- *HA_HMAC_SHA3_512*<br><br><br><br><br> |
| Famille TIGER | <br><br>- *HA_HMAC_TIGER_128*<br><br>- *HA_HMAC_TIGER_160*<br><br>- *HA_HMAC_TIGER_192*<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les constantes de cette famille ne sont pas disponibles. |
| Famille WHIRLPOOL | *HA_HMAC_WHIRLPOOL*<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Non disponible. |





- Algorithmes MD4 / MD5 / SHA / RIPEMD : fonctions de hachage cryptographiques classiques.

- Algorithmes TIGER / WHIRLPOOL : fonctions de hachage ayant de très bonnes propriétés cryptographiques optimisées pour le 64 bits (mais leur utilisation est possible en 32 bits).

- Algorithme MURMUR : fonctions de hachage très rapides et ne possédant pas de propriétés cryptographiques. C'est l'algorithme utilisé pour le "bloom filter" des portefeuilles bitcoin.  




**`<Chemin du fichier> : (Chaîne de caractères)`**

Chemin du fichier pour lequel le Hash doit être vérifié.

**`<Hash> : (Chaîne de caractères)`**

Hash du fichier à contrôler. Ce Hash doit être le résultat de la fonction [HashFichier](../WDLang1/1000007112.md) précédemment appelée pour le fichier &lt;Chemin du fichier&gt; sur l'algorithme &lt;Type d'algorithme&gt;.

**`<Clé secrète> : (Chaîne de caractères ou Entier)`**

Clé d'authentification du message. Cette clé doit être identique à celle utilisée pour calculer le Hash.  
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre ne doit pas être une chaîne vide.


<a name="SYNTAXE3"></a>
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 
### Vérifier un hash obtenu via un algorithme de dérivation de clé qui prend en paramètre un sel (PBKDF2)

`<Résultat> = HashFichier(<Type d'algorithme> , <Chemin du fichier> , <Hash> , <Sel> , <Itération> , <Longueur> [, <Jauge>])`
---

**`<Résultat> : (Buffer)`**

Résultat du hachage du fichier &lt;Chemin du fichier&gt; avec l'algorithme &lt;Type d'algorithme&gt;.

Attention : Ce résultat peut contenir des caractères non affichables.

**`<Type d'algorithme> : (Constante de type Entier)`**

Indique le type d'algorithme pseudo-aléatoire utilisé par PBKDF2 lors du hachage du fichier &lt;Chemin du fichier&gt; :



|   |   |
| --- | --- |
| Famille MD4 | *HA_PBKDF2_HMAC_MD4* |
| Famille MD5 | *HA_PBKDF2_HMAC_MD5_128*<br><br>Attention : ce type d'algorithme est actuellement déprécié.<br><br> |
| Famille RIPEMD | <br><br>- *HA_PBKDF2_HMAC_RIPEMD_128*<br><br>- *HA_PBKDF2_HMAC_RIPEMD_160*<br><br><br> |
| Famille SHA | <br><br>- *HA_PBKDF2_HMAC_SHA_160*<br><br>- *HA_PBKDF2_HMAC_SHA_256*<br><br>- *HA_PBKDF2_HMAC_SHA_256_DOUBLE*<br><br>- *HA_PBKDF2_HMAC_SHA_384*<br><br>- *HA_PBKDF2_HMAC_SHA_512*<br><br><br> |
| Famille SHA-3 | <br><br>- *HA_PBKDF2_HMAC_SHA3_224*<br><br>- *HA_PBKDF2_HMAC_SHA3_256*<br><br>- *HA_PBKDF2_HMAC_SHA3_384*<br><br>- *HA_PBKDF2_HMAC_SHA3_512*<br><br><br><br><br> |
| Famille TIGER | <br><br>- *HA_PBKDF2_HMAC_TIGER_128*<br><br>- *HA_PBKDF2_HMAC_TIGER_160*<br><br>- *HA_PBKDF2_HMAC_TIGER_192*<br><br><br> |
| Famille WHIRLPOOL | *HA_PBKDF2_HMAC_WHIRLPOOL* |





- Algorithmes MD4 / MD5 / SHA / RIPEMD : fonctions de hachage cryptographiques classiques.

- Algorithmes TIGER / WHIRLPOOL : fonctions de hachage ayant de très bonnes propriétés cryptographiques optimisées pour le 64 bits (mais leur utilisation est possible en 32 bits).




**`<Chemin du fichier> : (Chaîne de caractères)`**

Chemin du fichier pour lequel le Hash doit être vérifié.

**`<Hash> : (Chaîne de caractères)`**

Hash du fichier à contrôler. Ce Hash doit être le résultat de la fonction [HashFichier](../WDLang1/1000007112.md) précédemment appelée pour le fichier &lt;Chemin du fichier&gt; sur l'algorithme &lt;Type d'algorithme&gt;.

**`<Sel> : (Chaîne de caractères)`**

Sel cryptographique utilisé identique à celui utilisé pour calculer le Hash.   

**`<Itération> : (Entier)`**

Nombre d'itérations de l'algorithme. Ce paramètre doit être identique à celui utilisé pour calculer le Hash. 

**`<Longueur> : (Entier)`**

Longueur de la clé dérivée. Ce paramètre doit être identique à celui utilisé pour calculer le Hash.   

**`<Jauge> : (Nom de fenêtre optionnel ou nom de champ optionnel)`**

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 

- Nom de la fenêtre dans laquelle la jauge doit être affichée,

- Nom du champ de type Jauge à utiliser. 






<a name="NOTE0_3"></a>

## Remarques
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Disponibilité des algorithmes
<a name="disponibilite_des_algorithmes_ELTPARAGRAPHE000165"></a>

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seuls les algorithmes suivants sont supportés : 

- HA_HMAC_MD5_128

- HA_HMAC_SHA_160, HA_HMAC_SHA_256, HA_HMAC_SHA_384, HA_SHA_HMAC_512

- HA_HMAC_SHA_256_DOUBLE

- HA_MD4

- HA_MD5_128

- HA_SHA_160, HA_SHA_256, HA_SHA_384, HA_SHA_512

- HA_SHA_256_DOUBLE




<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280com.dll
