
## ServiceEcritEvénementJournal (Fonction)

***En anglais : ServiceWriteEventLog***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ecrit un événement dans le journal des événements Windows.

**Remarque** : Cette fonction est ignorée si elle n'est pas appelée dans une application de type "Service Windows".
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Tentative de connexion au serveur de la base de données
HOuvreConnexion(ConnexionSrv)
SI ErreurDétectée = Vrai ALORS
	ServiceEcritEvénementJournal("Erreur détectée lors de la connexion à la base de données" + ...
		RC + ErreurInfo(), ejErreur)
	RENVOYER Faux
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`ServiceEcritEvénementJournal(<Message> [, <Type d'événement> [, <Identifiant de l'événement>]])`
---

**`<Message> : (Chaîne de caractères)`**

Description de l'événement. Ce texte pourra être relu depuis l'observateur d'événements en affichant le détail de l'événement.

**`<Type d'événement> : (Constante optionnelle de type Entier)`**

Type d'événement à inscrire dans le journal de Windows :


|   |   |
| --- | --- |
| *ejAvertissement* | Evénement d'avertissement.<br>Indique qu'un problème non fatal s'est produit pendant l'exécution du service. Par exemple : une opération a réussi mais un message de notification n'a pas pu être envoyé. |
| *ejErreur* | Evénement d'erreur.<br>Signale une erreur lors de l'exécution d'un service. Les services n'ont pas de moyen pour afficher des informations : il s'agit donc de la principale méthode pour signaler un problème. |
| *ejInformation*<br>(valeur par défaut) | Evénement d'information.<br>Signale l'état du service. Par exemple : changement de mode d'activité, démarrage, ... |



**`<Identifiant de l'événement> : (Entier optionnel)`**

Identifiant de l'événement (compris entre 1 et 100).
**Conseil** : Utilisez une valeur différente pour chaque événement du service afin de les différencier facilement.
Cette valeur pourra être récupérée par les applications lisant le journal des événements pour déclencher des actions.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Les événements générés par la fonction **ServiceEcritEvénementJournal** sont inscrits dans le journal "Application" du système d'exploitation.

- Le journal peut être relu : 

	- en utilisant l'Observateur d'événements (présent parmi les outils d'administration de Windows).

	- par programmation (en utilisant par exemple le composant "WD JournalEvenement" livré en standard avec WINDEV).











<a name="XComposante"></a>

## Composante :
wd280vm.dll
