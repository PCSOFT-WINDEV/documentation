


## ListeInsère (Fonction)

***En anglais : ListInsert***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Insère un élément dans un champ Liste par programmation (y compris Liste image) ou dans un champ Combo par programmation.

**Remarques** :

- Pour ajouter un élément à la fin d'un champ Liste (ou Combo), utilisez la fonction [ListeAjoute](../WDLang1/3049004.md).

- La fonction **ListeInsère** peut être utilisée indifféremment sur des champs Liste monosélection et multisélection.

- Pour gérer le contenu d'un champ Combo placé dans une colonne conteneur d'un champ Table, utilisez la propriété [Contenu](../Proprietes/1000017242.md). 











<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ajoute le nom "Dubois" à l'indice 4 dans le champ Liste "LISTE_ListeClient"
ListeInsère(LISTE_ListeClient, "Dubois", 4)
```


<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Ajoute l'image "C:\MesImages\Gorgones.JPG" à l'indice 5 dans le champ Liste image "LSI_Plongée"
// Cette image aura comme libellé "Très belles gorgones"
ListeInsère(LSI_Plongée, "Très belles gorgones", "C:\MesImages\Gorgones.JPG", 4)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ListeInsère(<Champ Liste> , <Élément> [, <Image> [, <Indice de l'élément>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'élément a été inséré, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Champ Liste> : (Nom de champ)`**

Nom du champ Liste par programmation ou du champ Combo par programmation à manipuler. 

Si ce paramètre correspond à une chaîne vide (""), l'élément est inséré dans le champ Liste ou Combo auquel le traitement en cours appartient.


**`<Élément> : (Chaîne de caractères)`**

Élément à insérer dans le champ Liste (ou Combo) par programmation spécifié. 
Ce paramètre peut contenir :

- des caractères Retour Chariot (RC) pour ajouter plusieurs lignes. Dans ce cas :

	- si le paramètre &lt;Indice de l'élément&gt; n'est pas précisé, les éléments sont effectivement ajoutés.

	- si le paramètre &lt;Indice de l'élément&gt; est précisé, seul le premier élément sera ajouté.




- des tabulations (TAB) pour obtenir un champ Liste multi-éléments (voir Notes).


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) **Dans le cas d'un champ Liste image**, ce paramètre correspond au libellé de l'image. Ce paramètre peut contenir des caractères Retour Chariot (RC) pour ajouter plusieurs éléments. Dans ce cas :

- si les paramètres &lt;Image&gt; **et** &lt;Indice de l'élément&gt; **ne** sont **pas** précisés, les éléments ajoutés seront associés à l'image par défaut (définie dans l'onglet "Détail" de la fenêtre de description du champ).

- si le paramètre &lt;Image&gt; **et** le paramètre &lt;Indice de l'élément&gt; **sont**précisés, seul le premier élément sera ajouté. Cet élément sera associé à l'image par défaut (définie dans l'onglet "Détail" de la fenêtre de description du champ).

- si le paramètre &lt;Image&gt; **est**précisé **et** si le paramètre &lt;Indice de l'élément&gt; **n'est pas** précisé, seul le premier élément sera ajouté. Cet élément sera associé à l'image spécifiée.


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les caractères Retour Chariot (RC) et les tabulations (TAB) ne sont pas supportés.

**`<Image> : (Chaîne de caractères optionnelle)`**

Nom et chemin de l'image à ajouter dans un champ Liste image. Ce paramètre est pris en compte uniquement dans le cas d'un champ Liste image, affichée en mode Liste image. Si ce paramètre n'est pas spécifié, l'image utilisée est l'image par défaut (définie dans l'onglet "Détail" de la fenêtre de description du champ).
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Ce paramètre n'est pas disponible.

**`<Indice de l'élément> : (Entier optionnel)`**

Indice de l'élément à insérer.

Si ce paramètre :

- n'est pas précisé, l'élément est inséré :

	- avant l'élément en cours dans le cas d'un champ Liste monosélection. Si aucun élément n'est en cours, l'élément est inséré à la fin du champ Liste (ou Combo) par programmation.

	- à la fin du champ Liste (ou Combo) par programmation dans le cas d'un champ Liste multisélection.




- est supérieur au nombre d'éléments présents dans le champ Liste (ou Combo), l'élément est inséré à la fin du champ Liste (ou Combo) par programmation. Le nombre d'éléments présents dans un champ Liste (ou Combo) peut être obtenu avec la fonction [ListeOccurrence](../WDLang1/3049014.md).

- est égal à 0, l'élément est ajouté au début du champ Liste (ou Combo) par programmation.  






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Champ Liste supérieur à 10 000 éléments
<a name="champ_liste_superieur_10_000_elements_ELTPARAGRAPHE000183"></a>Le nombre maximum d'éléments pouvant être contenus dans un champ Liste n'est limité que par la mémoire vive disponible (maximum théorique : 2 milliards de lignes). Néanmoins, le fait de remplir un champ Liste avec un très grand nombre d'éléments (plus de 10 000) est pénalisant en termes de performance. 
Pour ajouter un grand nombre d'éléments dans un champ Liste, il est conseillé d'utiliser un champ Liste fichier (c'est-à-dire un champ Liste directement reliée à un fichier de données HFSQL).
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Visibilité / Invisibilité des éléments d'un champ Liste ou d'un champ Combo
<a name="visibilite_invisibilite_des_elements_champ_liste_champ_combo_ELTPARAGRAPHE000196"></a>Pour rendre un élément d'un champ Liste ou d'un champ Combo invisible, utilisez la fonction [gValeurMémorisée](../WDLang1/1410088363.md).
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Personnalisation des éléments d'un champ Liste ou d'un champ Combo
<a name="personnalisation_des_elements_champ_liste_champ_combo_ELTPARAGRAPHE000210"></a>Pour personnaliser les éléments présents dans un champ Liste ou dans un champ Combo (couleur de fond, image, dessin, etc), utilisez les [Fonctions de gestion des chaînes graphiques](../WDLang1/3029028.md).
<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Champ Liste triée/Liste non triée
<a name="champ_liste_trieeliste_non_triee_ELTPARAGRAPHE000224"></a>

- Si le champ Liste est trié, le nouvel élément est inséré à l'emplacement courant sans trier le champ Liste.

- Si le champ Liste n'est pas trié, le nouvel élément est ajouté :

	- à l'&lt;Indice de l'élément&gt; si le paramètre &lt;Indice de l'élément&gt; est spécifié.

	- avant l'élément en cours dans le cas d'un champ Liste monosélection si le paramètre &lt;Indice de l'élément&gt; n'est pas spécifié. Si aucun élément n'est en cours, l'élément est inséré à la fin du champ Liste (ou Combo) par programmation.

	- à la fin du champ Liste (ou Combo) par programmation dans le cas d'un champ Liste multisélection si le paramètre &lt;Indice de l'élément&gt; n'est pas spécifié.







Le type du champ Liste (trié ou non) est choisi lors de la description du champ (onglet "Détail").

La fonction [ListeAjoute](../WDLang1/3049004.md) doit être préférée à la fonction **ListeInsère** pour ajouter un élément dans un champ Liste trié.

<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Tabulations : champ Liste multisélection
<a name="tabulations_champ_liste_multiselection_ELTPARAGRAPHE000253"></a>Pour gérer des tabulations dans un champ Liste (alignement de colonnes), utilisez la constante TAB. Par exemple :

```wl
ListeInsère(LISTE_Client, Nom + TAB + Prénom)
```
Dans cet exemple, tous les prénoms commencent à la même position et sont alignés les uns sous les autres.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LISTETABULATION.gif)
**Remarque** : Le premier appel à la fonction **ListeInsère** fixe la position des tabulations. Ces positions serviront de référence pour toutes les valeurs ajoutées par la suite. De même, si des valeurs ont été saisies sous l'éditeur, les positions de ces valeurs sont prises comme référence. Il est donc conseillé, lors du premier appel à la fonction **ListeInsère**, de fixer la largeur des colonnes avec la fonction [Complète](../WDLang1/3024010.md). Par exemple, pour fixer la largeur des colonnes de "LISTE_Client" à 10 caractères :

```wl
ListeInsère(LISTE_Client, Complète(Nom, 10) + TAB + Complète(Prénom, 10))
```

<a name="NOTE0_6"></a>
<a name="NOTE0_7"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000322"></a>

- Pour insérer un élément dans un champ Table, utilisez la fonction [TableInsère](../WDLang1/3074025.md).

- La fonction **ListeInsère** peut être utilisée sur une colonne de type "Combo" dans un champ Table. 




<a name="XComposante"></a>

## Composante :
wd280obj.dll
