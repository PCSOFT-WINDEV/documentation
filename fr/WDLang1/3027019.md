
## HeureSys (Fonction)

***En anglais : TimeSys***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie ou modifie l'heure système (heure actuelle définie pour le poste en cours).

**Remarque** : Cette fonction est identique à la fonction [Maintenant](../WDLang1/3027024.md).




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
Res = HeureSys()        // Res = "15332105"
Res = HeureVersChaîne(HeureSys())   // Res = "15:33:21:05"
HeureAct = Gauche(HeureSys(), 4)    // HeureAct = "1533"
```




<a name="Exemple2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Afficher l'heure actuelle dans le champ HeureActuelle

// -- Code d'initialisation d'une fenêtre/page
// Appeler toutes les secondes la procédure "Horloge"
TimerSys("Horloge", 100, 1)
```

```wl
// -- Procédure Horloge
PROCEDURE Horloge()
HeureActuelle = HeureVersChaîne(HeureSys())
```


<a name="Exemple3"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Change l'heure système et affiche la nouvelle heure
HeureSys("17280000")
Info(HeureSys())
```


<a name="Exemple4"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
DateAujourdhui est une Date = DateSys()
SAI_SaisieDate = DateVersJourEnLettre(DateAujourdhui) + " " + DateAujourdhui.Jour + ...
	" " + DateVersMoisEnLettre(DateAujourdhui) + " à " + ...
	HeureVersChaîne(HeureSys(), "HH:MM:SS")
// Le champ SAI_SaisieDate contient par exemple : Lundi 20 Août à 14:44:17
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Connaître l'heure système

`<Résultat> = HeureSys()`
---

**`<Résultat> : (Chaîne de caractères ou variable de type Heure)`**

Heure système au format HHMMSSCC (HH correspond aux heures, MM aux minutes, SS aux secondes et CC aux centièmes de seconde).  




<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Modifier l'heure système

`HeureSys(<Nouvelle heure>)`
---

**`<Nouvelle heure> : (Chaîne de caractères, variable de type Heure ou variable de type DateHeure)`**

Nouvelle heure système. Cette heure peut correspondre à : 

- une chaîne de caractères au format HHMMSSCC (HH correspond aux heures, MM aux minutes, SS aux secondes et CC aux centièmes de seconde). 

- une chaîne de caractères au format AAAAMMJJHHmmSSCC (AAAA correspond à l'année, MM au mois, JJ au jour, HH aux heures, mm aux minutes, SS aux secondes et CC aux centièmes de seconde). Dans ce cas, seule l'heure est prise en compte. 

- une variable de type Heure. 

- une variable de type DateHeure. Dans ce cas, seule l'heure est prise en compte.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- **Attention** : Pour modifier l'heure système, il est nécessaire de posséder les droits administrateur sur le poste en cours. 

- Pour obtenir l'heure dans un autre format que HHMMSSCC, il faut formater la chaîne avec les fonctions [DateVersChaîne](../WDLang1/3027025.md), [Droite](../WDLang1/3024016.md), [Gauche](../WDLang1/3024001.md), etc.

- Le format HHMMSSCC a été choisi car il permet de comparer deux heures au centième de seconde près.

- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Dans cette version, la fonction **HeureSys** permet uniquement de renvoyer l'heure système (heure actuelle définie pour le poste en cours ou celle définie sur le poste où le navigateur Internet est lancé).

- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) En mode simulation, l'heure manipulée est celle du PC où la simulation est effectuée. En utilisation réelle, l'heure manipulée est celle du mobile.





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Calculssurlesdurees.gif) ***Exemples unitaires (WINDEV)*** : **Calculs sur les durées** <br>Calculs sur les dates et heures avec les fonctions WLangage : <br>- Calculer la durée écoulée entre deux instants (dates et heures)<br>- Effectuer une somme de durées<br>- Effectuer une moyenne de durées



<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280std.dll
