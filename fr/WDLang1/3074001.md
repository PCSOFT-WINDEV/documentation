 

## TableMode (Fonction)

***En anglais : TableMode***
	

<a name="XUtilisation"></a>
<a name="Utilisation"></a>
|  |   |
| --- | --- |



|  
 | ButModifier la gestion de l'ascenseur vertical d'une table fichier pour avoir :<br><br>- soit un ascenseur qui corresponde à la position de l'enregistrement en cours dans le fichier.<br><br>- soit un ascenseur fixe.<br><br><br><br><br>Remarque : La fonction **TableMode** peut être utilisée indifféremment sur une table monosélection ou multisélections.Syntaxe&lt;Résultat&gt; = TableMode(&lt;Nom de la table&gt;, &lt;Mode de l'ascenseur&gt; [,&lt;Valeur&gt;])<br><br>- &lt;Résultat&gt; est un entier contenant le mode de gestion de l'ascenseur spécifié.<br><br>- &lt;Nom de la table&gt; est une chaîne de caractères correspondant au nom du champ Table à manipuler. Si ce paramètre correspond à une chaîne vide (""), la table manipulée est la table à laquelle appartient le traitement en cours.<br><br>- &lt;Mode de l'ascenseur&gt; est une chaîne de caractères permettant d'indiquer le mode de l'ascenseur vertical :<br><br>	- "NbEnreg" : Nombre d'enregistrements à afficher fixe.<br><br>	- "Auto" : Calcule le nombre d'enregistrements à afficher.<br><br>	- "Tout" : Nombre d'enregistrements à afficher correspondant au nombre d'enregistrements dans le fichier.<br><br>	- "Fixe" : Cage de l'ascenseur fixe.<br><br>	- "Position" : Positionne le bandeau de sélection.<br><br><br><br><br>- &lt;Valeur&gt; est un entier optionnel qui dépend du &lt;Mode de l'ascenseur&gt;.<br><br><br>Notes**Le nombre d'enregistrements à afficher est fixé : "NbEnreg"**<br><br>La fonction **TableMode**, appelée avec le paramètre "NbEnreg", permet de fixer un nombre d'enregistrements "à priori". Ce nombre d'enregistrements peut ne pas correspondre au nombre réel d'enregistrements à visualiser dans la table.<br><br>&lt;Résultat&gt; = TableMode(&lt;Nom Table&gt;, "NbEnreg" [,&lt;Nb enregistrements&gt;])<br><br>Si &lt;Nb enregistrements&gt; n'est pas précisé, par défaut le nombre d'enregistrements fixé sera le nombre total d'enregistrements actifs du fichier (donné par la fonction [HNbEnr](../WDLang4/3044006.md)).<br><br>&lt;Résultat&gt; contient :<br><br>- le nombre d'enregistrements &lt;Nb enregistrements&gt; si la fonction s'est correctement exécutée.<br><br>- 0 si une erreur est intervenue.<br><br><br><br><br>L'appel de la fonction **TableMode** avec le paramètre "NbEnreg" provoque une ré-initialisation de la table pour se placer sur le premier enregistrement à afficher.<br><br>Pour afficher tous les enregistrements dans la table, la fonction **TableMode**, avec le paramètre "NbEnreg", utilise les traitements "enregistrement suivant" et "enregistrement précédent".<br><br>Le paramètre &lt;Nb enregistrements&gt; :<br><br>- ne doit pas être précisé si le nombre d'enregistrements est important et si un des traitements "initialisation", "suivant" ou "précédent" de la table contient du code spécifique (par exemple si un de ces traitements gère une procédure de filtre).<br><br>- doit être précisé si un filtre est géré avec la fonction [HFiltre](../WDLang4/3044100.md). En effet, dans ce cas le nombre d'enregistrements pris comme référence est le nombre total d'enregistrements (sans tenir compte du filtre).<br><br>- doit être précisé si le nombre d'enregistrements à afficher est connu.<br><br><br><br><br><br><br>**Le nombre d'enregistrements à afficher est calculé : "Auto"**<br><br>La fonction **TableMode** appelée avec le paramètre "Auto" permet de calculer automatiquement le nombre d'enregistrements à afficher en faisant un pré-parcours du fichier (en exécutant les traitements "initialisation" et "enregistrement suivant" de la table).<br><br>&lt;Résultat&gt; = TableMode(&lt;Nom Table&gt;, "Auto")<br><br>&lt;Résultat&gt; contient :<br><br>- le nombre d'enregistrements trouvés correspondant au nombre d'enregistrements à afficher.<br><br>- 0 si une erreur est intervenue.<br><br><br><br><br>L'appel de la fonction **TableMode** avec le paramètre "Auto" provoque une réinitialisation de la table pour se placer sur le premier enregistrement à afficher.<br><br>Pour afficher tous les enregistrements dans la table, la fonction **TableMode** avec le paramètre "Auto" utilise les traitements "enregistrement suivant" et "enregistrement précédent".<br><br>Conseil : Si le nombre d'enregistrements à afficher est grand, le temps d'exécution du pré-parcours peut être très long. Dans ce cas, il faut préférer le mode "Fixe" ou le mode "NbEnreg".<br><br>**Le nombre d'enregistrements à afficher est le nombre total d'enregistrements du fichier : "Tout"**<br><br>La fonction **TableMode** appelée avec le paramètre "Tout" permet de visualiser tous les enregistrements du fichier. <br><br>&lt;Résultat&gt; = TableMode(&lt;Nom Table&gt; , "Tout")<br><br>&lt;Résultat&gt; contient le nombre d'enregistrements du fichier.<br><br>Dans ce mode, le parcours de la table passe en mode "Automatique" (aucun appel des traitements de parcours).<br><br>Important :<br><br>- Si un filtre a été défini sur le fichier avec la fonction [HFiltre](../WDLang4/3044100.md), le nombre d'enregistrements du fichier (retourné dans &lt;Résultat&gt;) sera plus grand ou égal au nombre d'enregistrements qui seront visualisés dans la table. En effet, le nombre d'enregistrements est celui donné par la fonction [HNbEnr](../WDLang4/3044006.md) (qui ne tient pas compte du filtre).<br><br>- Si un filtre de parcours est géré par une procédure, il ne faut pas utiliser le paramètre "Tout". En effet, dans ce cas le test du filtre ne sera pas pris en compte car les traitements de la table ne sont pas utilisés.<br><br><br><br><br>La combinaison de touches Ctrl + Fin permet de positionner le bandeau de la table sur le dernier enregistrement du fichier.<br><br>Conseil : Ce mode est le mode par défaut des tables sous WINDEV.<br><br>**La cage de l'ascenseur est fixe : "Fixe"**<br><br>La fonction **TableMode** appelée avec le paramètre "Fixe" permet d'avoir un ascenseur dont la cage est fixe et ne représente pas la position de la ligne en cours dans le fichier.<br><br>Dans ce mode, la cage de l'ascenseur permet de se déplacer à une position spécifique dans la table (on peut avancer/reculer uniquement par page = ascenseur "à rebond").<br><br>&lt;Résultat&gt; = TableMode(&lt;Nom Table&gt; , "Fixe")<br><br>&lt;Résultat&gt; contient :<br><br>- 1 si la fonction s'est correctement exécutée.<br><br>- 0 si une erreur est intervenue.<br><br><br><br><br>Si sous l'éditeur de fenêtres, la table a été décrite avec un ascenseur vertical "Automatique", par défaut l'ascenseur de la table est géré avec le paramètre "Fixe").<br><br>**Positionner le bandeau de sélection sur une ligne donnée : "Position"**<br><br>La fonction **TableMode** appelée avec le paramètre "Position" permet de fixer ou de connaître la position du bandeau dans la table.  <br><br>&lt;Résultat&gt; = TableMode(&lt;Nom Table&gt; , "Position" [,&lt;ligne&gt;])<br><br>&lt;Résultat&gt; contient le numéro de la ligne.<br><br>Si le paramètre &lt;Ligne&gt; :<br><br>- est précisé, la fonction **TableMode	** fixe la position.<br><br>- n'est pas précisé, la fonction **TableMode	** retourne la position.<br><br><br><br><br>Cette syntaxe est équivalente aux fonctions [TableSelect](../WDLang1/3074020.md) et [TableSelectPlus](../WDLang1/3074031.md).<br><br>Important : La position du bandeau dans le champ Table est donnée par rapport à la première ligne à afficher. Il est possible de se positionner sur la première ligne au début du champ Table grâce à la combinaison de touches Ctrl + Home.<br><br> |
| --- | --- |


## Composante :
wd280obj.dll
