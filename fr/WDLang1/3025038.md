


## RTFRemplace (Fonction)

***En anglais : RTFReplace***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Remplace ou insère une chaîne de caractères dans un champ RTF (dans une fenêtre ou un état WINDEV) ou dans une chaîne au format RTF (contenant un texte au format RTF).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Utilisation avec un champ de saisie RTF
n est un entier
sMotRecherché est une chaîne = "Le développement facile"
sMotRemplace est une chaîne = "Développez facile !"
// Recherche non sensible à la casse à partir de la fin de la sélection
n = RTFRecherche(SAI_Saisie1, sMotRecherché) 
// Si le mot a été trouvé
SI n <> 0 ALORS
	// Remplace le mot trouvé
	RTFRemplace(SAI_Saisie1, sMotRemplace, n, n + Taille(sMotRecherché))
FIN
```
<a name="Exemple2"></a>

```wl
// Utilisation avec une chaîne
nRes est un entier
sChaîne est une chaîne = SAI_Saisie1
// Recherche du mot complet RTF
nRes = RTFRecherche(sChaîne, "RTF", rtfMotComplet + rtfSensibleCasse)
TANTQUE nRes <> 0
	// On remplace les mots trouvés par "WD"
	sChaîne = RTFRemplace(sChaîne, "WD", nRes, nRes + 3)
	nRes = RTFRecherche(sChaîne, "RTF", rtfMotComplet + rtfSensibleCasse, nRes + 3)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Remplacement dans un champ RTF

`RTFRemplace(<Champ RTF> , <Chaîne à insérer> [, <Début> , <Fin>])`
---

**`<Champ RTF> : (Nom de champ)`**

Nom du champ RTF dans lequel le remplacement doit être effectué. Le remplacement sera directement effectué dans le champ.

**`<Chaîne à insérer> : (Chaîne de caractères)`**

Chaîne de caractères à insérer dans le champ à la position &lt;Début&gt;.

**`<Début> : (Entier optionnel)`**

Position d'insertion de la &lt;Chaîne à insérer&gt; dans le &lt;Champ RTF&gt;. Si ce paramètre n'est pas précisé, le texte remplacera la sélection en cours. S'il n'y a pas de sélection en cours, le texte sera inséré à la position du curseur. 
Si &lt;Début&gt; = &lt;Fin&gt;, le texte sera inséré à la position &lt;Début&gt;.

**`<Fin> : (Entier optionnel)`**

Précise si le texte doit être inséré ou s'il doit remplacer le texte existant. 
Si &lt;Début&gt; = &lt;Fin&gt; (ou si &lt;Début&gt; est supérieur à &lt;Fin&gt;), le texte sera inséré à la position &lt;Début&gt;. 
Si &lt;Début&gt; est inférieur à &lt;Fin&gt;, le texte remplacera les caractères présents entre &lt;Début&gt; et &lt;Fin&gt;.


<a name="SYNTAXE2"></a>

### Remplacement dans une chaîne RTF

`<Résultat> = RTFRemplace(<Chaîne RTF> , <Chaîne à insérer> [, <Début> , <Fin>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Nouvelle chaîne de caractères dans laquelle les différents remplacements ont été effectués. La chaîne initiale n'est pas modifiée.

**`<Chaîne RTF> : (Chaîne de caractères)`**

Nom de la chaîne de caractères au format RTF dans lequel le remplacement doit être effectué. Cette chaîne n'est pas modifiée

**`<Chaîne à insérer> : (Chaîne de caractères)`**

Chaîne de caractères à insérer dans le champ à la position &lt;Début&gt;.

**`<Début> : (Entier optionnel)`**

Position d'insertion de la &lt;Chaîne à insérer&gt; dans le &lt;Chaîne RTF&gt;. Si ce paramètre n'est pas précisé, le texte remplacera la sélection en cours. S'il n'y a pas de sélection en cours, le texte sera inséré à la position du curseur. 
Si &lt;Début&gt; = &lt;Fin&gt;, le texte sera inséré à la position &lt;Début&gt;.

**`<Fin> : (Entier optionnel)`**

Précise si le texte doit être inséré ou s'il doit remplacer le texte existant. 
Si &lt;Début&gt; = &lt;Fin&gt; (ou si &lt;Début&gt; est supérieur à &lt;Fin&gt;), le texte sera inséré à la position &lt;Début&gt;. 
Si &lt;Début&gt; est inférieur à &lt;Fin&gt;, le texte remplacera les caractères présents entre &lt;Début&gt; et &lt;Fin&gt;.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) Le premier caractère dans le champ de saisie a pour indice 1.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
