


## OuvrePopup (Fonction)

***En anglais : OpenPopup***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ouvre une fenêtre de type popup et attend sa fermeture. Cette fonction doit être utilisée dans le code d'un champ (code de clic d'un bouton par exemple).

Remarque : Pour personnaliser la position de la popup, utilisez la fonction [OuvrePopupPosition](../WDLang1/3038047.md). 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ouverture d'une fenêtre de sélection de couleur
MaCouleur est un entier 
MaCouleur = OuvrePopup(FEN_CouleurFenSélecteur)
// Si une couleur a été sélectionnée 
// (nCouleur <= 0 si on annule la fenêtre)
SI MaCouleur > 0 ALORS
	// Changement de couleur du rectangle du bouton
	BTN_Couleur.Libellé = gRectangle(0, 0, 72, 16, MaCouleur, 0)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = OuvrePopup(<Nom de la fenêtre> [, <Paramètre 1> [... [, <Paramètre N>]]])`
---

**`<Résultat> : (Type correspondant à la valeur récupérée (optionnel))`**

Valeur renvoyée par la fenêtre popup lors de sa fermeture. Cette valeur est renvoyée :

- soit par le mot-clé [RENVOYER](../Motscles/1510007.md) présent dans l'événement "Fermeture" associé à la fenêtre,

- soit par la fonction [Ferme](../WDLang1/3038018.md),

- soit par la propriété [ValeurRenvoyée](../Proprietes/2510134.md) utilisée avant la fermeture de la fenêtre.




**`<Nom de la fenêtre> : (Chaîne de caractères)`**

Nom de la fenêtre à ouvrir.

**`<Paramètre 1> : (Type de la valeur envoyée à la fenêtre (optionnel))`**

Premier paramètre à passer à l'événement "Déclarations globales" de la fenêtre à ouvrir. Ces paramètres sont passés par référence et sont considérés comme des variables globales à la fenêtre.



**`<Paramètre N> : (Type de la valeur envoyée à la fenêtre (optionnel))`**

Nième paramètre à passer à l'événement "Déclarations globales" de la fenêtre à ouvrir. Ces paramètres sont passés par référence et sont considérés comme des variables globales à la fenêtre.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Caractéristiques de la fenêtre popup
<a name="caracteristiques_fenetre_popup_ELTPARAGRAPHE000054"></a>

- La fenêtre se ferme automatiquement si elle perd le focus ou lors de l'appel à la fonction [Ferme](../WDLang1/3038018.md). La valeur courante est renvoyée au champ qui a ouvert la fenêtre popup grâce à une des méthodes suivantes :

	- soit par le mot-clé [RENVOYER](../Motscles/1510007.md) présent dans l'événement "Fermeture" associé à la fenêtre,

	- soit par la fonction [Ferme](../WDLang1/3038018.md),

	- soit par la propriété [ValeurRenvoyée](../Proprietes/2510134.md) utilisée avant la fermeture de la fenêtre.




- La fenêtre ouverte par la fonction **OuvrePopup** adopte le style des fenêtres popup. Si une barre de titre a été définie sous l'éditeur, cette barre de titre est réduite, et la fenêtre ne peut être maximisée ou réduite.

- La fenêtre popup s'ouvre par défaut sous le champ qui exécute la fonction **OuvrePopup**. Si il n'y a pas assez de place pour ouvrir la fenêtre, la fenêtre s'ouvrira soit au-dessus du champ, soit au-dessous du champ vers la gauche.



<a name="NOTE0_2"></a>


### Paramètres passés à la fenêtre à ouvrir
<a name="parametres_passes_fenetre_ouvrir_ELTPARAGRAPHE000085"></a>Les paramètres sont récupérés dans l'événement "Déclarations globales" de la fenêtre. La première ligne de code de cet événement doit correspondre à la ligne suivante :

```txt
PROCEDURE <Nom de la fenêtre> (<Paramètre1> [, <Paramètre2> [, ...]])
```


Pour plus de détails, consultez [Fenêtre paramétrée](../WDChamp/1010026.md).


<a name="NOTE0_3"></a>


### Limites
<a name="limites_ELTPARAGRAPHE000107"></a>

- La fonction **OuvrePopup** doit être exécutée à partir d'un code de champ.

- Le champ à partir duquel la fonction **OuvrePopup** est exécutée doit être visible.

- Il n'est pas possible d'ouvrir à partir d'une fenêtre popup une  fenêtre qui n'est pas modale. Il est nécessaire d'utiliser la fonction [Ouvre](../WDLang1/3038035.md) pour ouvrir une fenêtre. L'ouverture d'une fenêtre modale depuis une fenêtre popup ne ferme pas automatiquement la fenêtre popup. Dans ce cas, il faut traiter la valeur de retour de la fonction [Ouvre](../WDLang1/3038035.md) et utiliser la fonction [Ferme](../WDLang1/3038018.md) pour fermer la fenêtre popup.

- Il n'est pas possible d'ouvrir une fenêtre popup depuis une fenêtre popup.





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CalendrierPopup.gif) ***Exemples unitaires (WINDEV Mobile)*** : **Calendrier Popup** <br>Mise en place d'une popup calendrier de sélection de date.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
