


## &lt;Fenêtre&gt;.OuvrePopupAsynchrone (Fonction)

***En anglais : &lt;Window&gt;.OpenPopupAsynchronous***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ouvre une fenêtre de type popup dont le résultat sera récupéré par une procédure WLangage (également appelée "Callback").
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ouverture d'une fenêtre popup sans passage de paramètres 
FEN_ChoixCouleur.OuvrePopupAsynchrone(popEnDessous + popAlignéAGauche + popSelonChamp, 
	"BTN_CouleurAction", onFermeChoixCouleur)
PROCEDURE INTERNE onFermeChoixCouleur(CouleurChoisie)
	IMG_PRODUIT.Couleur = CouleurChoisie
FIN
```

```wl
// Ouverture d'une fenêtre popup avec passage de paramètres 
FEN_ChoixCouleur.OuvrePopupAsynchrone(popEnDessous + popAlignéAGauche + popSelonChamp, 
	"BTN_CouleurAction", onFermeChoixCouleur, RougeFoncé)
PROCEDURE INTERNE onFermeChoixCouleur(CouleurChoisie)
	SI CouleurChoisie <> -1 ALORS
		IMG_PRODUIT.Couleur = CouleurChoisie
	FIN
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Fenêtre>.OuvrePopupAsynchrone([<Paramètres> [, <Mode d'ouverture> [, <Champ de référence>]]] [, <Procédure WLangage>])`
---

**`<Fenêtre> : (Nom de fenêtre)`**

Nom de la fenêtre à ouvrir.

**`<Paramètres> : (Chaîne de caractères)`**

Liste des paramètres à passer à la fenêtre. Cette liste de paramètres est de la forme : 

```txt
(<Paramètre 1>, ..., <Paramètre N>)
```

où :

- &lt;Paramètre 1&gt; : Premier paramètre à passer à l'événement "Déclarations globales" de la fenêtre à ouvrir. Ce paramètre est passé par valeur et il est considéré comme une variable globale à la fenêtre.
	Ce paramètre ne peut pas correspondre à une variable de type tableau (les tableaux peuvent uniquement être passés par référence).

- &lt;Paramètre N&gt; : Nième paramètre à passer à l'événement "Déclarations globales" de la fenêtre à ouvrir. Ce paramètre est passé par valeur et il est considéré comme une variable globale à la fenêtre.
	Ce paramètre ne peut pas correspondre à une variable de type tableau (les tableaux peuvent uniquement être passés par référence).


Si aucun paramètre ne doit être passé à la fenêtre, ce paramètre doit correspondre à "()".

**`<Mode d'ouverture> : (Combinaison de constantes)`**

Précise la position et le mode d'ouverture de la fenêtre popup. Ces constantes sont les suivantes :


|   |   |
| --- | --- |
| *popAlignéADroite* | Le bord droit de la fenêtre popup sera calé sur le bord droit du champ. La fenêtre popup s'étend sur la gauche. |
| *popAlignéAGauche* | Le bord gauche de la fenêtre popup sera calé sur le bord gauche du champ. La fenêtre popup s'étend sur la droite. |
| *popAuDessus* | La fenêtre popup s'ouvrira au dessus du champ appelant. <br><br> |
| *popCentréFenêtre* | La fenêtre popup est centrée par rapport à la fenêtre parente. |
|  *popCentréHorizontalement* | La fenêtre popup est centrée horizontalement avec le champ appelant. |
| *popDéfaut* <br>(Valeur par défaut) | Par défaut, la combinaison de constantes *popAlignéAGauche* + *popEnDessous* est utilisée. |
| *popDésactiveRepostionnementAuto* | Débranche le repositionnement automatique si la fenêtre popup risque de ne pas être complètement visible à l'écran. <br><br> |
| *popEnDessous* | La fenêtre popup s'ouvrira au dessous du champ appelant. |
| *popSelonChamp* | Ouvre la fenêtre popup en fonction de la position d'un champ différent du champ appelant. Dans ce cas:<br><br>- il faut préciser le nom du champ (paramètre &lt;Nom du champ&gt;).<br><br>- le nom du champ sera automatiquement récupéré par le mot-clé [MonChampPopup](../Motscles/1511005.md).<br><br><br> |



**`<Champ de référence> : (Nom de champ optionnel)`**

Nom du champ sous lequel la fenêtre popup doit s'ouvrir. Ce paramètre doit être précisé uniquement si la constante *popSelonChamp*a été utilisée.

**`<Procédure WLangage> : (Nom de procédure ou procédure lambda optionnelle)`**

Nom de la procédure WLangage (appelée "callback") appelée après la fermeture de la fenêtre. Pour plus de détails sur cette procédure, consultez [Paramètres de la procédure utilisée par la fonction &lt;Fenêtre&gt;.OuvrePopupAsynchrone](../WDLang1/1410087854.md). 

Cette procédure WLangage peut correspondre à : 

- un nom de procédure globale, 

- un nom de procédure interne, 

- une procédure lambda.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Ouverture de la fenêtre popup
<a name="ouverture_fenetre_popup_ELTPARAGRAPHE000265"></a>

- L'ouverture de la fenêtre via la fonction **&lt;Fenêtre&gt;.OuvrePopupAsynchrone** est modale et asynchrone : 

	- l'exécution du code continue sans attendre la fermeture de la fenêtre popup, 

	- la procédure WLangage sera appelée lorsque la fenêtre popup sera fermée. 

	- si l'utilisateur clique à côté dans une autre fenêtre, la fenêtre popup sera fermée.






<a name="NOTE0_2"></a>


### Caractéristiques de la fenêtre popup
<a name="caracteristiques_fenetre_popup_ELTPARAGRAPHE000282"></a>

- La fenêtre popup se ferme automatiquement si elle perd le focus ou lors de l'appel à la fonction [Ferme](../WDLang1/3038018.md). 

- La fenêtre ouverte par la fonction **&lt;Fenêtre&gt;.OuvrePopupAsynchrone** adopte le style des fenêtres popup. Si une barre de titre a été définie sous l'éditeur, cette barre de titre est réduite et la fenêtre ne peut être maximisée ou réduite.

- La fenêtre popup s'ouvre par défaut sous le champ qui exécute la fonction **&lt;Fenêtre&gt;.OuvrePopupAsynchrone**. Si il n'y a pas assez de place pour ouvrir la fenêtre, la fenêtre s'ouvrira soit au-dessus du champ, soit au-dessous du champ vers la gauche.



<a name="NOTE0_4"></a>


### Limites
<a name="limites_ELTPARAGRAPHE000303"></a>

- La fonction **&lt;Fenêtre&gt;.OuvrePopupAsynchrone** doit être exécutée à partir d'un code de champ.

- Le champ à partir duquel la fonction **&lt;Fenêtre&gt;.OuvrePopupAsynchrone** est exécutée doit être visible.

- Il n'est pas possible d'ouvrir à partir d'une fenêtre popup une fenêtre qui n'est pas modale. Il est nécessaire d'utiliser la fonction [&lt;Fenêtre&gt;.Ouvre](../WDLang1/1000023903.md) pour ouvrir une fenêtre. L'ouverture d'une fenêtre modale depuis une fenêtre popup ne ferme pas automatiquement la fenêtre popup. Dans ce cas, il faut traiter la valeur de retour de la fonction [&lt;Fenêtre&gt;.Ouvre](../WDLang1/1000023903.md) et utiliser la fonction [Ferme](../WDLang1/3038018.md) pour fermer la fenêtre popup.

- Il n'est pas possible d'ouvrir une fenêtre popup depuis une fenêtre popup.




<a name="XComposante"></a>

## Composante :
wd280obj.dll
