
## fOuvreFichierTemp (Fonction)

***En anglais : fOpenTempFile***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Crée et ouvre un fichier temporaire. Le système fournit un nom de fichier temporaire unique.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Récupération de l'identifiant du fichier temporaire
ResFichierTempUnique = fOuvreFichierTemp(foSuppressionAutomatique, "ABC", "C:\MesRépertoires")
SI ResFichierTempUnique = -1 ALORS 
	Erreur(ErreurInfo()) 
SINON
	fEcritLigne(ResFichierTempUnique, "Compte-rendu du " + DateSys())
	...
FIN
```


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
MonFichierTempUnique est un FichierDisque
MonFichierTempUnique = fOuvreFichierTemp(foSuppressionAutomatique, "ABC", "C:\MesRépertoires")
SI ErreurDétectée ALORS
	Erreur(ErreurInfo()) 
SINON
	fEcritLigne(MonFichierTempUnique, "Compte-rendu du " + DateSys())
	...
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = fOuvreFichierTemp([<Mode d'ouverture> [, <Préfixe du fichier temporaire> [, <Répertoire du fichier temporaire>]]])`
---

**`<Résultat> : (Entier ou variable de type FichierDisque)`**

Correspond à :

- un entier : 

	- Identifiant du fichier temporaire. Cet identifiant sera utilisé dans toutes les fonctions de manipulation des fichiers externes.

	- -1 en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




- une variable de type [FichierDisque](../WDLang1/1410088883.md). En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.
	




**`<Mode d'ouverture> : (Constante (ou combinaison de constantes) optionnelle)`**

Constantes permettant de définir le mode d'ouverture du fichier, le mode d'accès au fichier et le mode de blocage du fichier.

- Mode de blocage du fichier et mode d'ouverture du fichier : 
	


|   |   |
| --- | --- |
| *foBloqueEcriture* | Les autres applications ne pourront pas modifier le fichier en cours.<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *foBloqueLecture* | Les autres applications ne pourront pas lire le fichier en cours.<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *foSansSuppression* | Le fichier ne sera pas automatiquement supprimé à sa fermeture.<br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Valeur par défaut. |
| *foSuppressionAutomatique* | Le fichier est bloqué lors de son ouverture et sera automatiquement supprimé à sa fermeture (appel de la fonction [fFerme](../WDLang1/3036027.md) ou à la fin de l'application). <br>Si le fichier a été ouvert par une autre application, il sera supprimé automatiquement par le système lorsque toutes les applications auront fermé le fichier.<br><br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Valeur par défaut.<br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas disponible.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Si le fichier est utilisé par une autre application lors de sa fermeture (appel de la fonction [fFerme](../WDLang1/3036027.md) ou à la fin de l'application), il ne sera pas supprimé. |



- Mode d'accès au fichier. Ce type est utilisé par les fonctions [fLitLigne](../WDLang1/3036031.md) et [fEcritLigne](../WDLang1/3036025.md) pour déterminer le type des informations à lire et écrire dans le fichier externe : 
	


|   |   |
| --- | --- |
| *foAnsi* | Fichier de type Ansi. Cette constante permet de gérer un fichier Ansi lorsque le mode "Utiliser les chaînes Unicode en exécution" est activé au niveau de la configuration de projet.<br><br>Mode utilisé par défaut :<br><br>	- dans les projets WINDEV et WEBDEV inférieurs à la version 17.<br><br>	- dans les configurations de projet WINDEV et WEBDEV utilisant le mode "Utiliser les chaînes Ansi en exécution" à partir de la version 17.<br><br><br> |
| *foUnicode* | Fichier de type Unicode. Cette constante permet de gérer un fichier Unicode lorsque le mode "Utiliser les chaînes Ansi en exécution" est activé au niveau de la configuration de projet.<br><br>Mode utilisé par défaut :<br><br>	- dans les projets WINDEV Mobile quels que soient le mode et la version utilisés.<br><br>	- dans les configurations de projet WINDEV et WEBDEV utilisant le mode "Utiliser les chaînes Unicode en exécution" à partir de la version 17.<br><br><br><br><br> |






**`<Préfixe du fichier temporaire> : (Chaîne de caractères optionnelle)`**

Préfixe (3 lettres) du nom du fichier temporaire. Ce paramètre permet de préfixer le nom du fichier temporaire. Seules les trois premières lettres seront prises en compte.
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.

**`<Répertoire du fichier temporaire> : (Chaîne de caractères optionnelle)`**

Répertoire (complet ou relatif) du fichier temporaire (260 caractères maximum). Un chemin de type UNC peut être utilisé. Ce nom de répertoire peut être terminé indifféremment par le caractère "\\" ou non. Ce répertoire doit exister. Dans le cas contraire, une erreur WLangage est affichée.

Si ce paramètre n'est pas précisé, le répertoire par défaut sera :

- le répertoire temporaire de Windows (si ce répertoire existe sur le poste en cours),

- le répertoire en cours (si le répertoire temporaire de Windows n'existe pas sur le poste en cours).


![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
La fonction **fOuvreFichierTemp** génère une erreur dans les cas suivants :

- le répertoire indiqué n'existe pas,

- le fichier est bloqué par un autre poste ou par une autre application,

- l'utilisateur n'a pas les droits en lecture ou en écriture sur le fichier à ouvrir.






<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280std.dll
