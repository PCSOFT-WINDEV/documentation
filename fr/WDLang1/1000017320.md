


## &lt;Liste&gt;.Cherche (Fonction)

***En anglais : &lt;List Box&gt;.Seek***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Recherche un élément dans un champ Liste (liste classique ou liste image) ou un champ Combo (y compris les valeurs décrites par la fonction [gValeurMémorisée](../WDLang1/1410088363.md)).



**Remarque** : La fonction **&lt;Liste&gt;.Cherche** peut être utilisée indifféremment sur :

- les champs Liste fichier ou Liste par programmation,

- les champs Liste monosélection ou multisélection.











<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Recherche de l'élément "Dubois" dans le champ Liste "LISTE_ListeClient"
ResCherche = LISTE_ListeClient.Cherche("Dubois")
```


<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Recherche de l'élément "Dubois" dans le champ Liste fichier "LISTE_ListeClient"
// Recherche à l'identique à partir de l'élément 5
ResCherche = LISTE_ListeClient.Cherche("Dubois", Vrai, 5)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Champ Liste>.Cherche(<Élément recherché> [, <Type de recherche> [, <Début de la recherche>]])`
---

**`<Résultat> : (Entier)`**



- Indice de l'élément trouvé. 

- -1 si aucun élément ne correspond à la recherche.


L'élément trouvé n'est pas sélectionné. Pour sélectionner l'élément trouvé, utilisez la fonction [&lt;Liste&gt;.SelectPlus](../WDLang1/1000017414.md).
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Dans un champ Liste fichier, l'élément trouvé est affiché s'il n'est pas visible.

**`<Champ Liste> : (Nom de champ)`**

Nom du champ Liste (ou Combo) à manipuler.

**`<Élément recherché> : (Chaîne de caractères)`**

Élément à rechercher dans le champ Liste (ou Combo) spécifié.

**`<Type de recherche> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> (valeur par défaut) pour une recherche à l'identique, 

- <u><u><u><u>Faux</u></u></u></u> pour une recherche générique.




**`<Début de la recherche> : (Entier optionnel)`**

Indice de départ de la recherche dans le champ Liste ou Combo. 
Si ce paramètre n'est pas spécifié, la recherche est effectuée dans tout le champ. Ce paramètre est ignoré pour les champs manipulés par programmation.




<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Type de recherche
<a name="type_recherche_ELTPARAGRAPHE000314"></a>

- **Recherche à l'identique** : 
	Seuls les éléments ayant une valeur strictement égale à &lt;Élément recherché&gt; sont retournés par la fonction **&lt;Liste&gt;.Cherche**. Par exemple : 
	
	```wl
	// Retourner tous les "Dupond" du champ Liste "LISTE_Nom"
	LISTE_Nom.Cherche("Dupond")
	```


- **Recherche générique** : 
	Les éléments commençant par &lt;Élément recherché&gt; sont retournés par la fonction **&lt;Liste&gt;.Cherche**. Par exemple :
	
	```wl
	// Retourner tous les noms commençant par "DUP"
	LISTE_Nom.Cherche("DUP", Faux)
	```




<a name="NOTE0_2"></a>


### Paramètre &lt;Début de la recherche&gt;
<a name="parametre_ELTPARAGRAPHE000349"></a>Le paramètre &lt;Début de la recherche&gt; permet de rechercher toutes les occurrences d'une chaîne dans un champ Liste ou Combo.

Par exemple, pour compter le nombre de noms commençant par "DUP" dans le champ "LISTE_ListeClient" :

```wl
Indice est un entier
Cpt est un entier = 0
// Se positionner sur le premier élément correspondant
Indice = LISTE_ListeClient.Cherche("DUP", Faux)
TANTQUE Indice <> -1
	Cpt++
	// Recherche du nom suivant commençant par "DUP"
	Indice = LISTE_ListeClient.Cherche("DUP", Faux, Indice + 1)
FIN
```

<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Majuscules/Minuscules
<a name="majusculesminuscules_ELTPARAGRAPHE000369"></a>

- Si le champ est un champ Liste par programmation, la recherche ne tient pas compte des majuscules et des minuscules.

- Si le champ est un champ Liste fichier, la recherche sur les rubriques de type "Clé" tient compte des options de recherche définies dans l'éditeur d'analyses (onglet "Général" de la description de la rubrique).

<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ListeCherche%20-%20HC%20N%B0001.gif)

<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Recherche et sélection d'un élément présent dans un champ Liste ou un champ Combo
<a name="recherche_selection_element_present_dans_champ_liste_champ_combo_ELTPARAGRAPHE000390"></a>Pour rechercher et/ou sélectionner un élément présent dans un champ Liste fichier ou un champ Combo fichier, il est également possible d'utiliser la syntaxe suivante :

```wl
LISTE_ListeCommande.RubriqueMémorisée = "IDClient"
// Recherche et sélection de l'élément dont le IDClient est "135"
LISTE_ListeCommande = 135
// Si l'élément recherché n'est pas trouvé, LISTE_ListeCommande vaudra -1
```
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) L'élément recherché est sélectionné.
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Recherche dans un champ Liste fichier ou dans un champ Combo fichier : recherche sur la valeur mémorisée ou sur la valeur affichée
<a name="recherche_dans_champ_liste_fichier_dans_champ_combo_fichier_recherche_sur_valeur_memorisee_sur_valeur_affichee_ELTPARAGRAPHE000408"></a>

**Cas 1 : Le champ Liste ou Combo est alimenté par un fichier de données (option "Accès direct")** : 
La recherche se fait suivant la valeur de la fonction [gValeurMémoriséeActive](../WDLang1/1410088364.md) :

- Si gValeurMémoriséeActive(Champ, Vrai) (par défaut) : La fonction **&lt;Liste&gt;.Cherche** recherche sur la "rubrique de parcours" déclarée dans l'onglet "Contenu" de la description du champ.

- Si gValeurMémoriséeActive(Champ, Faux) : La fonction **&lt;Liste&gt;.Cherche** recherche sur la "rubrique affichée" déclarée dans l'onglet "Contenu" de la description du champ.




**Cas 2 : Le champ Liste ou Combo est alimenté par un fichier de données (option "Chargé en mémoire")** : 
La fonction **&lt;Liste&gt;.Cherche** recherche sur la "rubrique affichée" déclarée dans l'onglet "Contenu" de la description du champ.
<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Recherche et sélection dans un champ Liste fichier
<a name="recherche_selection_dans_champ_liste_fichier_ELTPARAGRAPHE000441"></a>Si les options pour le remplissage du champ Liste sont renseignées dans la fenêtre de description du champ (onglet "Contenu"), il est possible d'utiliser la syntaxe suivante pour rechercher et sélectionner un élément dans un champ Liste :

```txt
NomDuChampListe = ElémentRecherché
```


Les options pour le remplissage du champ Liste sont les suivantes :

- Fichier parcouru,

- Rubrique affichée,

- Rubrique de parcours.

<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ListeCherche%20-%20HC%20N%B0002.gif&type=thumb)

<a name="NOTE0_7"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Divers
<a name="divers_ELTPARAGRAPHE000462"></a>

- Pour effectuer une recherche dans un champ Table ou dans un champ Combo avec table, utilisez la fonction [TableCherche](../WDLang1/3074015.md).

- La fonction **&lt;Liste&gt;.Cherche** peut être utilisée sur une colonne d'un champ Table de type "Combo".




<a name="XComposante"></a>

## Composante :
wd280obj.dll
