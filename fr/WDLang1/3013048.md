
## ModeExécution (Fonction)

***En anglais : ExecutionMode***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet de :

- connaître et/ou modifier le comportement de l'application / du site, lorsque certaines erreurs sont générées. Selon le mode d'exécution sélectionné, ces erreurs peuvent être ignorées, ou générer des messages d'erreur. Dans certains cas, la fonction **ModeExécution** permet de retrouver le comportement de WINDEV 5.5.

- optimiser l'appel aux fonctions déclarées en externe. Permet d'optimiser la vitesse d'exécution de l'application dans 2 cas :

	- Procédures déclarées en externes

	- Codes compilés dynamiquement, appel d'une procédure globale ou locale du projet.




- savoir et/ou modifier le mode d'utilisation de la [technologie JITc](../Editeurs/2020009.md) par l'application. La technologie JITc est utilisée par défaut par l'application. Il est uniquement possible de la désactiver.

- connaître et/ou modifier le mode de gestion des références faibles pour tous les objets instanciés. 







<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Mode test ?
SI EnModeTest() = Vrai ALORS
	ModeExécution(ModeNormal)
SINON
	// On applique le mode de comportement de WINDEV 5.5 
	// pour éviter l'affichage de certaines erreurs
	ModeExécution(ModePermissif)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Récupérer le mode d'exécution en cours 

`<Résultat> = ModeExécution()`
---

**`<Résultat> : (Combinaison de constantes de type Entier)`**

Mode d'exécution actuel de l'application ou du site :


|   |   |
| --- | --- |
| *AppelsExternesOptimisés* | Optimise la gestion des appels externes de procédures. Ce paramètre est combiné avec une des deux constantes suivantes. <br> |
| *DésactiveExécutionOptimisée* | La technologie JITc (Just In Time compilation) est désactivée. |
| *ForceDestructeurObjetNonDynamique* | Force la destruction des objets non dynamiques (même si une référence forte a été prise). |
| *modeAncienFonctionnementDurée* | Les propriétés du type Durée conservent le fonctionnement de la version 12. |
| *modeNormal* | Les erreurs rencontrées génèrent des messages d'erreur. |
| *modePermissif* | Les erreurs rencontrées sont ignorées (mode WINDEV 5.5 ou WEBDEV 1.5). |






<a name="SYNTAXE2"></a>

### Modifier le mode d'exécution en cours 

`<Résultat> = ModeExécution(<Nouveau mode d'exécution>)`
---

**`<Résultat> : (Constante de type Entier)`**

Mode d'exécution de l'application ou du site après modification.


|   |   |
| --- | --- |
| *AppelsExternesOptimisés* | Optimise la gestion des appels externes de procédures. Ce paramètre est combiné avec une des deux constantes suivantes. <br> |
| *DésactiveExécutionOptimisée* | La technologie JITc (Just In Time compilation) est désactivée. |
| *ForceDestructeurObjetNonDynamique* | Force la destruction des objets non dynamiques (même si une référence forte a été prise). |
| *modeAncienFonctionnementDurée* | Les propriétés du type Durée conservent le fonctionnement de la version 12. |
| *modeNormal* | Les erreurs rencontrées génèrent des messages d'erreur. |
| *modePermissif* | Les erreurs rencontrées sont ignorées (mode WINDEV 5.5 ou WEBDEV 1.5). |



**`<Nouveau mode d'exécution> : (Constante de type Entier)`**

Nouveau mode d'exécution à appliquer.


|   |   |
| --- | --- |
| *AppelsExternesOptimisés* | Optimise la gestion des appels externes de procédures. Ce paramètre est combiné avec une des deux constantes suivantes. <br> |
| *DésactiveExécutionOptimisée* | Désactive la technologie JITc (Just In Time compilation). |
| *ForceDestructeurObjetNonDynamique* | Force la prise de référence faible pour tous les objets. |
| *modeAncienFonctionnementDurée* | Les propriétés du type Durée conservent le fonctionnement de la version 12. |
| *modeNormal* | Les erreurs rencontrées génèrent des messages d'erreur. |
| *modePermissif* | Les erreurs rencontrées sont ignorées (mode WINDEV 5.5 ou WEBDEV 1.5) |







<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Désactivation de la technologie JITc
<a name="desactivation_technologie_jitc_ELTPARAGRAPHE000175"></a>Pour désactiver la technologie JIT dans une application, il est conseillé d'utiliser la fonction **ModeExécution** avec la constante *DésactiveExécutionOptimisée* dans le code d'initialisation du projet. Dans ce cas, seuls les éléments chargés avant l'exécution du code d'initialisation du projet (composants, collections de procédures, classes) utiliseront la technologie JITc.

Pour désactiver la technologie JITc pour une application WINDEV (suspicion d'un problème lié à la technologie JITc par exemple), il est conseillé de modifier (ou de créer) le fichier &lt;Nom de l'exécutable&gt;.WX. Ce fichier doit être placé à côté de l'exécutable de l'application et doit contenir les informations suivantes :


```txt
[WD_EXECUTION]
OPTIM_EXECUTION=0
```

<a name="NOTE0_2"></a>




### Optimisation des appels externes
<a name="optimisation_des_appels_externes_ELTPARAGRAPHE000190"></a>**Attention** : Lorsqu'un projet est migré depuis la version 5.5, le mode permissif a été automatiquement ajouté lors de la migration dans le code d'initialisation du projet. Pour prendre en compte l'optimisation des appels externes, il est nécessaire d'indiquer la ligne de code suivante :


```wl
ModeExécution(ModePermissif + AppelsExternesOptimisés)
```



<a name="NOTE0_3"></a>




### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000201"></a>Le tableau ci-dessous présente le comportement de l'application en fonction des erreurs rencontrées :

| Cas d'erreur | ModePermissif | ModeNormal |
| --- | --- | --- |
| Lecture d'un indice hors borne d'un champ Table, Liste ou Combo.<br><br>**Exemples** :<br><br>s = ListeA[-1] <br><br>n = ListeB[56]..Couleur  | Le programme retourne '0' ou une chaîne vide ("") selon la propriété utilisée. | Une erreur d'exécution s'affiche.<br><br>**Exemple** :<br>"L'indice spécifié [-1] est invalide" |
| Écriture dans un indice négatif d'un champ Liste, Table ou Combo.<br><br>**Exemple** :<br>  Liste[-1] = "Dupont"   | La ligne de code est ignorée | Une erreur d'exécution s'affiche.<br><br>**Exemple** :<br>"L'indice spécifié [-1] est invalide" |
| Écriture dans un indice trop grand d'un champ Liste, Table ou Combo.<br><br>**Exemple** :<br>  LISTE[54] = "Dupont"  | Un élément vide est inséré à la fin du champ Liste et prend la valeur indiquée. | Une erreur d'exécution s'affiche.<br><br>**Exemple** :<br>"L'indice spécifié [54] est invalide" |
| <br><br>Utilisation des fonctions [Ouvre](../WDLang1/3038035.md), [OuvreFenêtreMobile](../WDLang1/1000021018.md), [OuvreFille](../WDLang1/3038021.md), [OuvreSoeur](../WDLang1/3038045.md) avec un nom de fenêtre possédant des espaces supplémentaires.<br><br>**Exemple** :<br>  Ouvre("FEN1 ")  | Les espaces supplémentaires sont supprimés. | Une erreur d'exécution s'affiche.<br><br>**Exemple** :<br>"La fenêtre 'FEN1 ' est introuvable" |
| Utilisation des [fonctions de gestion des menus contextuels et déroulants](../WDLang1/3038016.md) avec un numéro de menu inexistant.<br><br>**Exemple** :<br>  MenuMarque(FEN1, 54645)  | La fonction renvoie '0' et la fonction [ErreurInfo](../WDLang1/3013008.md) est renseignée. | Une erreur d'exécution s'affiche.<br><br>**Exemple** :<br>"L'option de menu spécifiée [54645] n'existe pas dans le menu" |
| Utilisation des fonctions [Droite](../WDLang1/3024016.md) et [Gauche](../WDLang1/3024001.md) avec un nombre de caractères à extraire négatif.<br><br>**Exemple** :<br>  Gauche("abcdef", -1)  | La fonction renvoie une chaîne vide (""). | La fonction renvoie EOT et la fonction [ErreurInfo](../WDLang1/3013008.md) est renseignée. |
| Utilisation de la fonction [Milieu](../WDLang1/3024023.md) avec une position de départ négative et/ou un nombre de caractères à extraire négatif.<br><br>**Exemple** :<br>  Milieu("abcdef", -2, -4)  | La fonction :<br><br>- commence l'extraction au début de la chaîne si la position de départ est négative.<br><br>- renvoie la chaîne source complète.<br><br><br> | La fonction renvoie EOT et la fonction [ErreurInfo](../WDLang1/3013008.md) est renseignée. |





<a name="XComposante"></a>

## Composante :
wd280vm.dll
