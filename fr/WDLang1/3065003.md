
## La base de registre de Windows
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000081"></a>
WINDEV met à votre disposition des fonctions qui permettent de manipuler la base de registre de Windows.

La base de registre est un fichier dans lequel sont stockées des informations indexées (classées selon des clés) décrivant le matériel du poste, les préférences de l'utilisateur et autres données sur la configuration du poste.
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=BASEREGISTRE.gif)


**Manipulation de la base de registre sous Windows Vista** : 
Sous Windows Vista, si le [mécanisme de l'UAC](../Editeurs/2025014.md) est activé, il est nécessaire d'avoir les droits administrateur pour écrire dans la clé "HKEY_LOCAL_MACHINE\\SOFTWARE".
Si l'utilisateur n'a pas les droits nécessaires, le mécanisme de l'UAC effectue une redirection automatique vers la clé "HKEY_CURRENT_USER\\Software\\Classes\\VirtualStore\\MACHINE\\SOFTWARE. Cette redirection a pour but d'assurer la compatibilité des applications. Les clés écrites dans ce répertoire pourront être lues par l'application qui les a écrites.  

**Rappel** : Lors de la création de l'exécutable, il est possible d'insérer un manifeste dans l'exécutable afin de donner les droits administrateur à l'application.

Remarque : Les applications compilées en 32 bits peuvent également accéder à la Registry 64 bits, et les applications compilées en 64 bits peuvent également accéder à la Registry 32 bits.


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Basederegistres.gif) ***Exemples unitaires (WINDEV)*** : **Base de registres** <br>Manipulation de la base de registres de Windows :<br>- Créer une clé<br>- Ecrire une valeur<br>- Lire une valeur<br>- Supprimer une clé<br>- Connaître la clé associée au projet en cours
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDLimitationdedureedutilisation.gif) ***Exemples didactiques (WINDEV)*** : **WD Limitation de duree d utilisation** <br>Cet exemple montre comment limiter l'utilisation d'une application à une période donnée (période d'essai).<br>Dans cet exemple, nous abordons les principaux thèmes suivants :<br>	1/ la protection d'une application pour une durée donnée<br>	2/ la gestion de la base de registre<br><br>Résumé de l'exemple livré avec WINDEV :	<br>Lorsque cet exemple est lancé pour la première fois, il est activé pour une période d'essai de 5 jours.<br>L'information de la date de premier lancement est stockée dans la base de registre avec l'utilisation d'une clé de contrôle pour vérifier que l'utilisateur final n'a pas essayé de la modifier. A la fin de la période d'essai, l'application est bloquée, à moins que l'utilisateur final ne dispose du code de déverrouillage de l'application
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDOuverturePeripherique.gif) ***Exemples didactiques (WINDEV)*** : **WD Ouverture Périphérique** <br>Lors de l'insertion d'un périphérique amovible (clé USB etc..), le système d'exploitation Windows propose une liste d'action prédéfinie pour ouvrir les fichiers contenus dans ce périphérique.<br>Grâce à la collection de procédure proposée dans l'exemple, il sera très facile d'ajouter ou supprimer une application du système d'ouverture automatique pour les périphériques amovibles par programmation.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDPersistance.gif) ***Exemples didactiques (WINDEV)*** : **WD Persistance** <br>Cet exemple montre l'utilisation des fonctions InitParamètre, ChargeParamètre, SauveParamètre.<br>Ces fonctions permettent de configurer la sauvegarde de champs, de variables et de tout autre paramètre.<br>Cet exemple est décomposé en trois parties :<br>	- La configuration<br>	- La gestion manuelle de variables (Fonctions SauveParamètre et ChargeParamètre)<br>	- L'optimisation<br>1°) Configuration<br>	<br>	La fenêtre de configuration vous permet de modifier l'emplacement de la sauvegarde des paramètres (Base de registre, fichier INI, fichier XML) ainsi que son chemin (clé de registre ou le chemin du fichier).<br>2°) Gestion Manuelle de variables<br>	La gestion manuelle vous permet de sauvegarder le contenu de variables grâce à la fonction SauveParamètre et de les restaurer grâce à la fonction ChargeParamètre. Chaque paramètre est identifié par un nom. Ces valeurs sont sauvegardées à l'emplacement défini dans la fenêtre de configuration.<br>3°) L'optimisation<br>	Cette fenêtre vous explique comment optimiser votre code pour éviter les lenteurs dues à la restauration des valeurs sauvegardées. En effet, lors de la restauration de la valeur d'un champ, son code de modification est exécuté. Si vous avez des traitements longs (Requêtes paramétrées ou autres), cette fenêtre vous montre comment accélérer le chargement de la fenêtre.




