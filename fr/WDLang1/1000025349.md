


## Procédure WLangage appelée par la fonction fSurveilleFichier



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Procédure WLangage (également nommée "callback") appelée par la fonction [fSurveilleFichier](../WDLang1/1000020522.md) lors d'un changement sur le fichier surveillé. 

Cette procédure peut être une procédure locale, globale, ou interne. 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Nom du fichier à surveiller
sNomFichier est une chaîne = "C:\Temp\MonRep\MonFichier.extension"
// La procédure TraiteModification sera appelée lorsque le fichier 
// "C:\Temp\MonRep\MonFichier.extension" sera modifié.
SI fSurveilleFichier(sNomFichier, fSurveilleFichier_Callback, ...
		fsCréationFichier + fsModificationFichier + fsSuppressionFichier + ...
		fsRenommage) ALORS
	// On informe l'utilisateur de la mise sous surveillance du fichier
	Info("La mise sous surveillance du fichier " + sNomFichier + " a réussi.")
SINON
	// On informe l'utilisateur de l'échec de la mise sous surveillance du fichier
	Info("La mise sous surveillance du fichier " + sNomFichier + " a échoué.")
FIN

// Code de la procédure
PROCEDURE INTERNE fSurveilleFichier_Callback(sNomComplet, sNomFichier, nAction, sAncienNomFichier)
	sDesignationAction est une chaîne
	// La désignation de l'action subie dépend de nAction
	SELON nAction
		CAS fsCréationFichier : sDesignationAction = "Création de fichier"
		CAS fsSuppressionFichier : sDesignationAction = "Suppression de fichier"
		CAS fsModificationFichier : sDesignationAction = "Modification de fichier"
		CAS fsRenommage : sDesignationAction = "Renommage de fichier"
	FIN
	// Ajout d'une ligne contenant les informations de la modification 
	// dans le champ Table TABLE_MODIFICATIONS
	TableAjouteLigne(TABLE_MODIFICATIONS, sNomComplet, sNomFichier, ...
		sDesignationAction, sAncienNomFichier)
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`fSurveilleFichier_Callback(<Nom complet du fichier observé> , <Nom du fichier modifié> , <Action> , <Ancien nom du fichier>)`
---

**`<Nom complet du fichier observé> : (Chaîne de caractères)`**

Chemin complet (répertoire et nom) du fichier observé.

**`<Nom du fichier modifié> : (Chaîne de caractères)`**

Nom du fichier observé (après modification).

**`<Action> : (Constante de type Entier)`**

Action effectuée sur le fichier : 



|   |   |
| --- | --- |
| *fsCréationFichier* | Création du fichier &lt;Nom du fichier modifié&gt;. |
| *fsModificationFichier* | Modification du fichier &lt;Nom du fichier modifié&gt;. |
| *fsRenommage* | Renommage du fichier &lt;Nom du fichier modifié&gt;. |
| *fsSuppressionFichier* | Suppression du fichier &lt;Nom du fichier modifié&gt;. |





**`<Ancien nom du fichier> : (Chaîne de caractères)`**

Ancien nom du fichier modifié si l'action effectuée est un renommage. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Attention
<a name="attention_ELTPARAGRAPHE000061"></a>Cette procédure WLangage est exécutée dans un thread WLangage.
Attention : Il n'est pas possible d'exécuter dans les threads les traitements suivants :

- ouverture de fenêtres avec les fonctions WLangage telles que [Ouvre](../WDLang1/3038035.md), [Utilise](../WDLang1/3038044.md), [Ferme](../WDLang1/3038018.md), ... Si des fenêtres doivent être manipulées dans des threads (cas rare), une gestion spécifique doit être mise en place. Pour plus de détails, consultez [Gérer l'ouverture d'une fenêtre dans un thread secondaire](../WDLang1/3077015.md). 

- gestion d'événements.

- gestion de timers.




Pour plus de détails sur la gestion des threads, consultez [Gestion des threads](../WDLang1/3077026.md).

<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280std.dll
