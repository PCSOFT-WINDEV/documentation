
## CurseurPos (Fonction)

***En anglais : CursorPos***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie et modifie la position du curseur de souris.

**Remarque** : Pour connaître la position en cours de la souris, il est conseillé d'utiliser les fonctions [SourisPosX](../WDLang1/3071007.md) et [SourisPosY](../WDLang1/3071008.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
Res est un entier = CurseurPos(cpClient)
SI Res <> -1 ALORS
	Message("Position X = " + PoidsFaible(Res) + "Position Y = " + PoidsFort(Res))
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = CurseurPos([<Repère>, ] <Position X> , <Position Y>)`
---

**`<Résultat> : (Entier)`**

Position de la souris (les coordonnées sont obtenues avec les fonctions [PoidsFort](../WDLang1/3014017.md) et [PoidsFaible](../WDLang1/3014018.md)).

- Position actuelle si les paramètres &lt;Position X&gt; et &lt;Position Y&gt; ne sont pas spécifiés.

- Position précédente si les paramètres &lt;Position X&gt; et &lt;Position Y&gt; sont spécifiés.

- -1 en cas d'erreur (position de la souris en dehors du repère demandé par exemple).




**`<Repère> : (Constante optionnelle de type entier)`**

Indique le repère utilisé pour le calcul de la position :


|   |   |
| --- | --- |
| *cpClient* | Position de la souris par rapport à la zone client de la fenêtre ayant le focus.<br>Zone client = fenêtre sans la barre de titre ni le menu ni le cadre. |
| *cpEcran*<br>(Valeur par défaut) | Position de la souris par rapport à l'écran. |
| *cpFenêtre* | Position de la souris par rapport à la fenêtre ayant le focus. |



**`<Position X> : (Réel)`**

Nouvelle position horizontale (colonne ou abscisse) dans le repère choisi.

**`<Position Y> : (Réel)`**

Nouvelle position verticale (ligne ou ordonnée) dans le repère choisi.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Calcul de la position de la souris
<a name="calcul_position_souris_ELTPARAGRAPHE000073"></a>Pour connaître la position horizontale et verticale de la souris à partir du résultat, il est nécessaire d'utiliser les fonctions [PoidsFort](../WDLang1/3014017.md) et [PoidsFaible](../WDLang1/3014018.md).

Le poids faible de &lt;Résultat&gt; permet d'obtenir la position horizontale (X) de la souris.

Le poids fort de &lt;Résultat&gt; permet d'obtenir la position verticale (Y) de la souris. En cas d'erreur, X et Y sont égaux à -1.

Les coordonnées sont relatives au coin supérieur gauche du repère choisi.


<a name="NOTE0_2"></a>




### Divers
<a name="divers_ELTPARAGRAPHE000094"></a>

- Les fonctions [SourisPosX](../WDLang1/3071007.md) et [SourisPosY](../WDLang1/3071008.md) permettent d'obtenir respectivement les positions horizontales et verticales de la souris par rapport au champ dans lequel un clic gauche de la souris a été effectué.

- Il est possible par exemple d'effectuer le calcul de la position du curseur dans un timer afin de toujours afficher cette position à l'écran.






<a name="XComposante"></a>

## Composante :
wd280std.dll
