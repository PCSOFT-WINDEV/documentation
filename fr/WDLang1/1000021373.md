


## TableurAjouteFormule (Fonction)

***En anglais : SpreadsheetAddFormula***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute une formule de calcul dans un champ Tableur présent dans une fenêtre.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
//  Initialisation de la 1ère colonne et avec des nombres de 1 à 10
POUR I = 1 A 10
	TableurAjouteDonnée(TBLR_Tableur, 1, i, "Ligne " + I)
FIN

TableurAjouteDonnée(TBLR_Tableur, 1, 1, 13)
TableurAjouteDonnée(TBLR_Tableur, 1, 2, 20)
TableurAjouteFormule(TBLR_Tableur, 1, 3, "A1+A2/2") // Affiche 23
TableurAjouteFormule(TBLR_Tableur, "A4", "A1+A2")
TableurAjouteDonnée(TBLR_Tableur, 1, 2, 33) // Affiche 33 dans la case A3
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Ajouter une formule dans une cellule identifiée par ses coordonnées

`TableurAjouteFormule(<Champ Tableur> , <Colonne> , <Ligne> , <Formule>)`
---

**`<Champ Tableur> : (Nom de champ)`**

Nom du champ Tableur à manipuler. 

**`<Colonne> : (Entier)`**

Numéro de colonne de la cellule contenant la formule. 

**`<Ligne> : (Entier)`**

Numéro de ligne de la cellule contenant la formule. 

**`<Formule> : (Chaîne de caractères)`**

Formule à ajouter. Le premier caractère "=" ne doit pas être intégré dans la formule. Par exemple : "A1+B2-A2"
En cas d'erreur de syntaxe ou identificateur invalide, "###" est affiché dans la cellule et une erreur non fatale est affichée.


<a name="SYNTAXE2"></a>

### Ajouter une formule dans une cellule identifiée par son nom

`TableurAjouteFormule(<Champ Tableur> , <Nom de la cellule> , <Formule>)`
---

**`<Champ Tableur> : (Nom de champ)`**

Nom du champ Tableur à manipuler. 

**`<Nom de la cellule> : (Chaîne de caractères)`**

Nom de la cellule à manipuler. Par exemple : "A4". 

**`<Formule> : (Chaîne de caractères)`**

Formule à ajouter. Le premier caractère "=" ne doit pas être intégré dans la formule. Par exemple : "A1+B2-A2"
En cas d'erreur de syntaxe ou identificateur invalide, "###" est affiché dans la cellule et une erreur non fatale est affichée.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Si la cellule (Colonne, Ligne) n'existe pas, la cellule est créée.

- Si la cellule (Colonne, Ligne) existe déjà, le contenu est supprimé. Il est remplacé par la formule &lt;Formule&gt;. 

- Cette fonction est utilisable uniquement sur un champ Tableur présent dans une fenêtre. 

- Les cellules peuvent être nommées (fonction [TableurAjouteNom](../WDLang1/1000022523.md)). Il est possible d'utiliser le nom d'une cellule dans la formule. 





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampTableur.gif) ***Exemples unitaires (WINDEV)*** : **Le champ Tableur** <br>Utilisation du champ Tableur.<br>Cet exemple présente comment :<br>- charger un fichier xlsx dans un champ tableur,<br>- sauver le tableur dans un fichier,<br>- remplir le champ avec des données provenant de la base de données,<br>- insérer des lignes, des colonnes,<br>- accéder aux cellules et les manipuler (modifier leur valeur, leur style,...),<br>- saisir des formules,<br>- etc.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
