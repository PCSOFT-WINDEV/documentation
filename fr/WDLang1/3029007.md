
## dCopieImage (Fonction)

***En anglais : dCopyImage***






	<B><B>Avertissement</B></B>

	A partir de la version <B><B>18</B></B>,  cette fonction est conservée par compatibilité pour la majorité des plates-formes. Il est conseillé d'utiliser la fonction [dCopie](../WDLang1/1000020799.md). En effet :

- la fonction  [dCopie](../WDLang1/1000020799.md) gère la transparence,

- les différents modes de copie de **dCopieImage** sont remplacés par : 

	- les fonctions applicables au type [Image](../WDLang1/1000019650.md) (fonctions [dIncrusteCouleur](../WDLang1/1000019672.md), [dInverseCouleur](../WDLang1/1000019672.md), ...), 

	- les accès aux pixels.









<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Copie une image : 

- d'un champ Image vers un autre champ Image.

- dans une variable de type [Image](../WDLang1/1000019650.md).
	






![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seule la première syntaxe peut être utilisée avec le type Image.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003029007&name=dcopieimage_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Copie simple du contenu du champ Image "IMG_ImageDessin"
// dans le champ Image "IMG_ImageCopie"
ResCopie = dCopieImage(IMG_ImageDessin, IMG_ImageCopie)
```




<a name="Exemple2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Copie de l'image de l'écran dans un champ Image
dCopieImage(copieEcran, IMG_MonImage)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Copier des images présentes dans des champs Image

`<Résultat> = dCopieImage(<Champ Image source> , <Champ Image destination> [, <Mode de copie> [, <X image source> [, <Y image source> [, <Hauteur image source> [, <Largeur image source> [, <X image destination> [, <Y image destination> [, <Hauteur image destination> [, <Largeur image destination>]]]]]]]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la copie a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. 




**Remarque** : La fonction **dCopieImage** peut renvoyer <u><u><u><u>Faux</u></u></u></u> si le pilote (ou driver) écran ne supporte pas cette fonction. Un message apparaît alors dans l'image copiée. Nous vous conseillons de mettre à jour votre pilote écran pour obtenir un fonctionnement normal.

**`<Champ Image source> : (Nom de champ)`**

Nom du champ Image source à manipuler.
**Pour effectuer une copie d'écran (Hard Copy)**, utilisez la constante *copieEcran* : le contenu de l'écran est entièrement copié. 
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) La constante *copieEcran* n'est pas disponible.![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre peut correspondre : 

- soit au nom d'un champ Image, 

- soit au nom d'une variable de type [Image](../WDLang1/1000019650.md). 




**`<Champ Image destination> : (Nom de champ)`**

Nom du champ Image destination où la copie doit être effectuée.
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre peut correspondre : 

- soit au nom d'un champ Image, 

- soit au nom d'une variable de type [Image](../WDLang1/1000019650.md). 




**`<Mode de copie> : (Constante optionnelle)`**

Mode de copie à effectuer.


|   |   |
| --- | --- |
| *copieDstInverse* | Inverse les couleurs du champ Image destination.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *copieFusionCopie* | Fusionne le champ Image source et le champ Image destination.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *copieFusionPeint* | Combine par la méthode du "Et Logique" le champ Image source et la texture ("pattern") du champ Image destination.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *copieImage* | Combine l'image source et l'image destination en utilisant les informations de transparence de l'image destination<br>Permet par exemple d'incorporer un logo dans l'image destination.<br>**Remarque** : La taille et la position dans la source ne sont pas prises en compte. Ce mode ne permet pas d'homothétie ou de zoom.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |
| *copiePasSrcCopie* | Inverse les couleurs du champ Image source.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *copiePasSrcEfface* | Inverse par la méthode du "Ou" la combinaison du champ Image source et du champ Image destination.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *copiePatCopie* | Copie la texture ("pattern") du champ Image source vers le champ Image destination.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *copiePatInverse* | Combine par la méthode du "Ou Exclusif" la texture du champ Image source avec la texture ("pattern") du champ Image destination. La brosse en cours, fixée par la fonction [dFond](../WDLang1/3029002.md), est utilisée.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *copiePatPeint* | Combine par la méthode du "Ou" le champ Image source inversé avec la texture ("pattern") du champ Image destination.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *copieSrcCopie*<br>(Valeur par défaut) | Copie le champ Image source vers le champ Image destination (copie simple). |
| *copieSrcEfface* | Inverse le champ Image destination et combine le résultat avec la copie du champ Image source.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *copieSrcEt* | Combine par la méthode du "Et" les pixels du champ Image source et du champ Image destination.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *copieSrcInverse* | Combine par la méthode du "Ou Exclusif" les pixels du champ Image source et du champ Image destination.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *copieSrcPeint* | Combine par la méthode du "Ou" les pixels du champ Image source et du champ Image destination.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *copieToutBlanc* | Remplit le champ Image destination de blanc.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *copieToutNoir* | Remplit le champ Image destination de noir.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |





**`<X image source> : (Entier optionnel)`**

Abscisse (en pixels) du coin haut gauche de la zone à copier (coin haut gauche du champ Image source par défaut).

**`<Y image source> : (Entier optionnel)`**

Ordonnée (en pixels) du coin haut gauche de la zone à copier (coin haut gauche du champ Image source par défaut).

**`<Hauteur image source> : (Entier optionnel)`**

Hauteur (en pixels) de la zone à copier (hauteur du champ Image source par défaut).

**`<Largeur image source> : (Entier optionnel)`**

Largeur (en pixels) de la zone à copier (largeur du champ Image source par défaut).

**`<X image destination> : (Entier optionnel)`**

Abscisse (en pixels) du coin haut gauche de la zone destination de la copie (coin haut gauche du champ Image destination par défaut).

**`<Y image destination> : (Entier optionnel)`**

Ordonnée (en pixels) du coin haut gauche de la zone destination de la copie (coin haut gauche du champ Image destination par défaut).

**`<Hauteur image destination> : (Entier optionnel)`**

Hauteur (en pixels) de la zone dans laquelle l'image va être copiée (hauteur du champ Image destination par défaut). Si cette hauteur est supérieure à la hauteur de l'image source, l'image sera agrandie lors de la copie.

**`<Largeur image destination> : (Entier optionnel)`**

Largeur (en pixels) de la zone dans laquelle l'image va être copiée (largeur du champ Image destination par défaut). Si cette largeur est supérieure à la largeur de l'image source, l'image sera élargie lors de la copie.


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Copier des images présentes dans des variables de type Image

`<Résultat> = dCopieImage(<Nom de l'image source> , <Nom de l'image destination> [, <X image source> [, <Y image source> [, <Hauteur image source> [, <Largeur image source> [, <X image destination> [, <Y image destination> [, <Hauteur image destination> [, <Largeur image destination>]]]]]]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la copie a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. 




**Remarque** : La fonction **dCopieImage** peut renvoyer <u><u><u><u>Faux</u></u></u></u> si le pilote (ou driver) écran ne supporte pas cette fonction. Un message apparaît alors dans l'image copiée. Nous vous conseillons de mettre à jour votre pilote écran pour obtenir un fonctionnement normal.

**`<Nom de l'image source> : (Variable de type Image)`**

Nom de la variable de type [Image](../WDLang1/1000019650.md) à manipuler. Cette image est l'image source. 

**`<Nom de l'image destination> : (Variable de type Image)`**

Nom de la variable de type [Image](../WDLang1/1000019650.md) dans laquelle la copie doit être effectuée.

**`<X image source> : (Entier optionnel)`**

Abscisse (en pixels) du coin haut gauche de la zone à copier (coin haut gauche de l'image source par défaut).

**`<Y image source> : (Entier optionnel)`**

Ordonnée (en pixels) du coin haut gauche de la zone à copier (coin haut gauche de l'image source par défaut).

**`<Hauteur image source> : (Entier optionnel)`**

Hauteur (en pixels) de la zone à copier (hauteur de l'image source par défaut).

**`<Largeur image source> : (Entier optionnel)`**

Largeur (en pixels) de la zone à copier (largeur de l'image source par défaut).

**`<X image destination> : (Entier optionnel)`**

Abscisse (en pixels) du coin haut gauche de la zone destination de la copie (coin haut gauche de l'image destination par défaut).

**`<Y image destination> : (Entier optionnel)`**

Ordonnée (en pixels) du coin haut gauche de la zone destination de la copie (coin haut gauche de l'image destination par défaut).

**`<Hauteur image destination> : (Entier optionnel)`**

Hauteur (en pixels) de la zone dans laquelle l'image va être copiée (hauteur de l'image destination par défaut). Si cette hauteur est supérieure à la hauteur de l'image source, l'image sera agrandie lors de la copie.

**`<Largeur image destination> : (Entier optionnel)`**

Largeur (en pixels) de la zone dans laquelle l'image va être copiée (largeur de l'image destination par défaut). Si cette largeur est supérieure à la largeur de l'image source, l'image sera élargie lors de la copie.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Zoom sur une image
<a name="zoom_sur_une_image_ELTPARAGRAPHE000360"></a>Lors d'une copie, il est possible d'agrandir ou de réduire une partie de l'image source en la copiant vers l'image destination. Pour cela :

- Définissez la zone à agrandir (ou réduire) dans l'image source (avec les paramètres &lt;X image source&gt;, &lt;Y image source&gt;, &lt;Hauteur image source&gt; et &lt;Largeur image source&gt;),

- Définissez la zone d'affichage de l'image résultat. Cette zone doit être plus grande pour un agrandissement de l'image et plus petite pour une réduction de l'image. Par défaut, la totalité de l'image destination est prise en compte. Utilisez si nécessaire les paramètres &lt;X image destination&gt;, &lt;Y image destination&gt;, &lt;Hauteur image destination&gt; et &lt;Largeur image destination&gt;.




Le pourcentage du zoom est fonction du coefficient multiplicatif entre les dimensions des deux zones.

Par exemple :


|   |   |
| --- | --- |
| **1.** La zone à zoomer est comprise dans un rectangle d'une largeur de 30 pixels et d'une hauteur de 40 pixels. | **2.** Pour effectuer un zoom de 200 %, la zone destination doit être deux fois plus importante que la zone source : rectangle d'une largeur de 60 pixels et d'une hauteur de 80 pixels. |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ChampSource.gif)<br> | ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ChampDestinationpsd.gif)<br> |

Dans ce cas, la ligne de code permettant de réaliser le zoom lors de la copie est la suivante :

```wl
dCopieImage(IMG_ChampSource, IMG_ChampDestination, copieSrcCopie, 10, 10, 30, 40, 10, 10, 60, 80)
```

<a name="NOTE0_2"></a>
<a name="NOTE0_3"></a>

<a name="XComposante"></a>

## Composante :
wd280obj.dll
