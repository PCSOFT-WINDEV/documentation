
## Gestion des certificats
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000158"></a>
Signer un fichier permet de s'assurer ensuite que ce fichier n'a pas été modifié ou altéré depuis sa signature. La signature permet également de s'assurer de l'identité de l'émetteur. 

En utilisant les certificats Windows, WINDEV permet de signer : 

- des fichiers ou des chaînes de données. 

- des emails. 

- des exécutables.




La norme de signature utilisée est PKCS7. 





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Les certificats
<a name="les_certificats_ELTTEXTE000182"></a>
Il existe deux types de certificats : 

- les certificats "qualifiés".

- les certificats "non qualifiés".




Un certificat "qualifié" est délivré par une autorité de confiance (Verisign, Thawte, ...) et doit en général s'acheter. Un certificat "qualifié" sera en général utilisé lorsque les fichiers sont diffusés à l'extérieur de l'entreprise ou de l'organisation. Par exemple, des fichiers proposés en téléchargement. 

Un certificat "non qualifié" peut être créé directement par un utilisateur depuis Windows. Un certificat "non qualifié" peut suffire dans le cadre interne d'une entreprise ou d'une organisation. 

Windows dispose d'un "magasin de certificats" dans lequel sont installés les certificats d'utilisateur (appelés également certificats personnels). 


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Utiliser les certificats pour signer un fichier
<a name="utiliser_les_certificats_pour_signer_fichier_ELTTEXTE000206"></a>
Pour signer un fichier (ou une chaîne de caractères), le WLangage met à votre disposition : 

- La famille de fonctions [CertificatXXXX](../WDLang1/1000019302.md). 

- Le type avancé [Certificat](../WDLang1/1000019287.md). 




Le principe est le suivant : 

**1.** Sélectionnez le certificat à utiliser à l'aide des fonctions suivantes : 



|   |   |
| --- | --- |
| [CertificatListe](../WDLang1/1000019293.md) | Renvoie la liste des certificats disponibles sur le poste. |
| [CertificatSélecteur](../WDLang1/1000019295.md) | Ouvre une fenêtre de sélection de certificats. Les certificats listés sont les certificats installés dans le magasin personnel. |





Le certificat est stocké dans une variable de type [Certificat](../WDLang1/1000019287.md) qui permet d'obtenir toutes ses caractéristiques. 

**2.** Créez la signature du fichier (ou de la chaîne) à l'aide du certificat. Cette signature est une variable de type buffer qui peut être stockée par exemple : dans un fichier, une variable, ...

Les fonctions WLangage permettant de créer cette signature sont les suivantes : 



|   |   |
| --- | --- |
| [CertificatSigneChaîne](../WDLang1/1000019296.md) | Crée la signature d'une chaîne de caractères. |
| [CertificatSigneFichier](../WDLang1/1000019297.md) | Crée la signature d'un fichier. Cette signature peut être mémorisée dans une variable de type Buffer ou bien dans un fichier texte. |





**Remarque** : La signature n'est pas intégrée au fichier mais disponible à part. Cette méthode permet de créer une signature pour tous les formats de fichiers. 

**3.** Pour vérifier la signature d'un fichier, il suffit de vérifier la correspondance entre le fichier et sa signature. Les fonctions WLangage permettant de réaliser cette opération sont les suivantes : 



|   |   |
| --- | --- |
| [CertificatVérifieChaîne](../WDLang1/1000019298.md) | Extracts a certificate from a signature buffer or from a print duplicate. |





**Remarques** : 

- Il est également possible de signer un exécutable grâce à la fonction [CertificatSigneExécutable](../WDLang1/1000020560.md). Dans ce cas, la signature est intégrée au fichier exécutable.

- Il est également possible de signer et de vérifier la signature des fichiers duplicata. Pour plus de détails, consultez [Imprimer des duplicatas](../WDChamp/1011075.md). 






<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Utiliser les certificats pour signer un email
<a name="utiliser_les_certificats_pour_signer_email_ELTTEXTE000261"></a>
La signature d'un email et de toutes ses pièces jointes permet de s'assurer ensuite que ces éléments n'ont pas été modifiés ou altérés depuis leur signature. Cette signature permet également de s'assurer de l'identité de l'émetteur. 

Pour signer un email, il suffit de préciser le certificat utilisé dans les propriétés de la variable de type [Email](../WDLang3/1000018713.md). La variable de type [Certificat](../WDLang1/1000019287.md) contenant le certificat à utiliser est associé à la propriété **Certificat** de la variable de type [Email](../WDLang3/1000018713.md) contenant l'email à envoyer.

La vérification de l'intégrité d'un email reçu est effectuée en testant la valeur de la propriété **Signature** de la variable de type [Email](../WDLang3/1000018713.md) contenant l'email reçu.  




