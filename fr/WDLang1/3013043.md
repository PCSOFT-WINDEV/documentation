


## INILit (Fonction)

***En anglais : INIRead***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Lit le contenu d'un fichier INI (ou structuré comme un fichier .INI). Il est possible d'obtenir :

- la valeur d'un mot-clé présent dans une section spécifique,

- la liste des mots-clés d'une section,

- la liste des sections du fichier.




Exemple de fichier .INI

```txt
[Exemples WD]
Nom1 = Wdinstall
Nom2 = WDBench
[Description du projet WDInstall]
Libellé = Utilisez le panneau de configuration de Windows
LST = 43
Page = 12
```

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003013043&name=inilit_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Lecture dans la section [Exemples WD]
INILit("Exemples WD", "Nom2", "", "C:\Temp\ExemplesLST.INI")
```
<a name="Exemple2"></a>

```wl
// Choix par défaut lu dans le .INI
nProduit est un entier = Val(INILit("USER", ...
	"LastProd", "", fRepExe() + "\Port.INI"))
SI nProduit > 0 ALORS ListeSelectPlus(LISTE_Produit, nProduit)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = INILit(<Section> [, <Mot-clé> [, <Non trouvé> [, <Fichier>]]])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Texte recherché ou liste des mots-clés de la section (chaque mot-clé est séparé par RC), 

- Liste des sections du fichier (chaque section est séparée par RC).

- Contenu du paramètre &lt;Non trouvé&gt; dans les cas suivants :

	- la chaîne correspondant au mot-clé est vide,

	- le mot-clé n'est pas trouvé,

	- le fichier n'est pas trouvé.




- Chaîne vide (si &lt;Non trouvé&gt; n'est pas précisé ou est égal à une chaîne vide) dans les cas suivants :

	- la chaîne correspondant au mot-clé est vide,

	- le mot-clé n'est pas trouvé,

	- le fichier n'est pas trouvé.







**`<Section> : (Chaîne de caractères)`**

Nom de la section à lire dans le fichier INI. 
Si ce paramètre ainsi que le paramètre &lt;Mot clé&gt; correspondent à une chaîne vide, &lt;Résultat&gt; contient la liste des sections présentes dans le fichier, séparées par des RC.

**Remarque** : Ce nom ne peut pas contenir le caractère "-".


**`<Mot-clé> : (Chaîne de caractères optionnelle)`**

Nom du mot-clé contenant les informations à lire. 
Si ce paramètre est une chaîne vide, &lt;Résultat&gt; contient la liste des mots clé de la section &lt;Section&gt;, séparés par des RC.


**`<Non trouvé> : (Chaîne de caractères optionnelle ou entier optionnel)`**

Texte ou entier à renvoyer si la lecture du mot-clé demandé n'a pas été effectuée. Par défaut, ce paramètre correspond à une chaîne vide.
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre correspond uniquement à une chaîne de caractères. 

**`<Fichier> : (Chaîne de caractères optionnelle)`**

Nom complet du fichier à lire (avec son extension). 

- Si ce paramètre n'est pas précisé, le fichier considéré est le fichier WIN.INI. 

- Si seul le nom du fichier est précisé, le fichier indiqué sera recherché dans le répertoire de Windows.




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Nom complet du fichier à lire (avec son extension). 

- Si ce paramètre n'est pas précisé, le fichier utilisé sera celui portant le nom du projet et se situant dans le répertoire d'exécution de l'application. 

- Si le fichier n'existe pas, il sera créé. 

- Si seul le chemin n'est pas précisé, le fichier indiqué sera recherché dans le répertoire d'exécution de l'application.


![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Nom complet du fichier à lire (avec son extension). Si ce paramètre n'est pas précisé, le fichier considéré est le fichier **.PCS.conf** (ce fichier doit se trouver dans le répertoire home de l'utilisateur). Si seul le chemin n'est pas précisé, le fichier indiqué sera recherché dans le répertoire de home de l'utilisateur.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Lecture des valeurs persistantes
<a name="lecture_des_valeurs_persistantes_ELTPARAGRAPHE000158"></a>Pour lire des valeurs persistances dans un fichier INI (sauvées grâce à la fonction [SauveParamètre](../WDLang1/3025046.md)), utilisez la fonction [ChargeParamètre](../WDLang1/3025047.md).
<a name="NOTE0_2"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000171"></a>

- Pour lire dans la base de registre, utilisez les fonctions spécifiques à la base de registre : [RegistreLit](../WDLang1/3065012.md), ...

- Les fichiers de type INI sont limités à 64 Ko.

- **TSE** : La fonction **INILit** utilise par défaut le répertoire Windows.
	Attention : Jusqu'en version 21, la fonction **INILit** utilisait par défaut le répertoire Windows de l'utilisateur.
	Rappel : En mode TSE, l'accès à un fichier '.INI' avec un nom relatif est déconseillé. Il est recommandé d'utiliser une des solutions suivantes : 

	- Fonctions [SauveParamètre](../WDLang1/3025046.md) et [ChargeParamètre](../WDLang1/3025047.md). 

	- Base de registre, 

	- utilisation d'un nom absolu, basé sur la fonction [fRepDonnées](../WDLang1/3036001.md) par exemple.






<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Windows Vista (et supérieur)
<a name="windows_vista_superieur_ELTPARAGRAPHE000216"></a>Les normes de programmation Windows déconseillent l'écriture :

- dans le fichier WIN.INI,

- dans les répertoires systèmes (répertoire de Windows, répertoire "Program Files", ...).




**Sous Windows Vista (et supérieur) avec le mécanisme de l'UAC (contrôle des comptes utilisateurs) activé**, il est nécessaire d'avoir des privilèges administrateur pour effectuer ces opérations. Si l'application n'a pas les privilèges administrateur requis, le [mécanisme de l'UAC](../Editeurs/2025014.md) entraînera la redirection des fichiers (appelée virtualisation) vers un répertoire propre à l'utilisateur qui utilise l'application (C:\\Users\\&lt;LOGIN&gt;AppData\\Local\\VirtualStore\\Windows\\). Les fichiers pourront être relus avec la fonction **INILit** utilisée dans la même application. Ce mécanisme de virtualisation des fichiers est proposé par Windows Vista (et supérieur) uniquement par compatibilité, et n'est pas disponible en 64 bits.

**Attention** : Si le fichier INI est automatiquement virtualisé par Windows Vista (et supérieur), le fichier INI ne pourra pas être partagé entre plusieurs applications (surtout si ces applications utilisent des privilèges différents).

**Conseil de programmation** : Pour créer un fichier INI sans avoir besoin de privilèges administrateur, il est conseillé : 

- de ne pas utiliser le fichier WIN.INI (le paramètre &lt;Fichier&gt; doit être précisé)

- de ne pas écrire dans le répertoire de Windows ou dans le répertoire "Program Files",

- d'utiliser le répertoire système correspondant à l'application (connu par la fonction [SysRep](../WDLang1/3073026.md) par exemple avec la constante *srAppDataCommun*).




<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280std.dll
