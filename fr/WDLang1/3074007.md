


## TableInfoXY (Fonction)

***En anglais : TableInfoXY***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie pour une position donnée dans un champ Table ou Table hiérarchique (coordonnées d'un point du champ) :

- soit le nom de la colonne affichée pour la position indiquée.

- soit l'indice de la ligne ou de la colonne pour la position indiquée.









<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003074007&name=tableinfoxy_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
```wl
// Code optionnel de clic sur le champ Table TABLE_TABLE1
MaLigne est un entier
MaColonne est une chaîne
MaLigne = TableInfoXY(TABLE_TABLE1, tiNumLigne, SourisPosX(), SourisPosY())
MaColonne = TableInfoXY(TABLE_TABLE1, tiNomColonne, SourisPosX(), SourisPosY())
Trace("Vous avez sélectionné la cellule (" + MaColonne + ", " + MaLigne + ")")
```


<a name="Exemple2"></a>

```wl
// Indice de la ligne au point (50, 100) du champ Table "TABLE_TableProduit" 
ResInfo = TableInfoXY(TABLE_TableProduit, tiNumLigne, 50, 100)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = TableInfoXY(<Champ Table> , <Type d'information> , <X> , <Y>)`
---

**`<Résultat> : (Chaîne de caractères, entier ou booleén)`**



- Information demandée.

- Une chaîne vide ("") s'il n'y a pas de nom de colonne.

- -1 s'il n'y a pas d'indice de colonne ou de numéro de ligne, ou si la position spécifiée correspond à une ligne vide ou à une colonne vide.




**`<Champ Table> : (Nom de champ)`**

Nom du champ Table ou Table hiérarchique à manipuler.

Si ce paramètre correspond à une chaîne vide (""), le champ manipulé est le champ auquel appartient l'événement en cours.

**`<Type d'information> : (Constante de type entier)`**

Type d'information demandée :


|   |   |
| --- | --- |
| *tiNomColonne* | Nom de la colonne.<br><br> |
| *tiNumColonne* | Indice de création de la colonne.<br><br> |
| *tiNumLigne* | Numéro de la ligne. |
| *tiOrigineEcran* | Les coordonnées à analyser sont données par rapport à l'écran. <br><br>Rappel : Par défaut, les coordonnées à analyser sont données par rapport au champ Table : le point (0,0) correspond à la ligne 1, colonne 1 du champ Table manipulé (les ascenseurs étant situés à l'origine).<br><br>Cette constante ne peut pas être utilisée seule.<br><br> |
| *tiSurBoutonEnrouleDéroule* | Boutons "+/-" pour déplier/replier une ligne. Dans ce cas, &lt;Résultat&gt; vaut <u><u><u><u>Vrai</u></u></u></u> (1). <br><br>Cette constante est disponible uniquement pour les champs Table hiérarchique.<br><br> |



**`<X> : (Entier)`**

Coordonnée X (en pixels) à analyser. Cette coordonnée est relative au champ (si la constante *tiOrigineEcran* n'est pas précisée).

**`<Y> : (Entier)`**

Coordonnée Y (en pixels) à analyser. Cette coordonnée est relative au champ (si la constante *tiOrigineEcran* n'est pas précisée).  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000159"></a>La fonction **TableInfoXY** peut être utilisée indifféremment sur :

- un champ Table ou Table hiérarchique fichier.

- un champ Table ou Table hiérarchique par programmation.

- un champ monosélection ou multisélection.



<a name="NOTE0_2"></a>


### Les différents types d'indices de colonne
<a name="les_differents_types_indices_colonne_ELTPARAGRAPHE000181"></a>Il existe 2 types d'indices pour les colonnes :

- Indice de la position visible : indice de la colonne lors de l'exécution de la fenêtre.

- Indice de création : indice de la colonne lors de la création de la table sous l'éditeur de fenêtres.


Ces indices sont différents à partir du moment où les colonnes ont été déplacées par l'utilisateur.

De plus, si l'ascenseur horizontal est utilisé, la fonction **TableInfoXY** tient compte de ce déplacement.
<a name="NOTE0_3"></a>


### Utilisation des fonctions SourisPosX et SourisPosY
<a name="utilisation_des_fonctions_sourisposx_sourisposy_ELTPARAGRAPHE000200"></a>Pour utiliser les fonctions [SourisPosX](../WDLang1/3071007.md) et [SourisPosY](../WDLang1/3071008.md) dans les paramètres X et Y de la fonction, il est nécessaire de s'assurer que seul un clic de souris pourra déclencher l'exécution du code contenant cette fonction. 

Par exemple, l'événement "Sélection d'une ligne" d'un champ Table peut être lancé par un clic de souris mais aussi par une sélection au clavier. Il faut donc éviter d'utiliser les fonctions [SourisPosX](../WDLang1/3071007.md) et [SourisPosY](../WDLang1/3071008.md) dans cet événement. Préférez un événement optionnel. Dans cet exemple, utilisez l'événement optionnel "Bouton gauche relâché" sur un champ Table.

<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
