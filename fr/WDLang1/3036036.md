


## fOuvre (Fonction)

***En anglais : fOpen***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ouvre un fichier externe (ANSI ou UNICODE) pour le manipuler par programmation. Il est également possible d'utiliser la fonction [fChargeTexte](../WDLang1/3036006.md).

Remarques : 

- Pour manipuler des fichiers externes de type texte, il est conseillé d'utiliser les fonctions [fChargeTexte](../WDLang1/3036006.md)/[fSauveTexte](../WDLang1/3036046.md) et [fChargeBuffer](../WDLang1/1000019410.md)/[fSauveBuffer](../WDLang1/1000019412.md). 

- Pour manipuler des fichiers externes de type binaire, utilisez les fonctions [fCrée](../WDLang1/3036017.md) ou **fOuvre**. 

- Pour ouvrir et afficher un fichier externe dans le logiciel associé (par exemple pour afficher sous Word un fichier .DOC), utilisez la fonction [LanceAppliAssociée](../WDLang1/3035007.md).



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003036036&name=fouvre_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Ouverture d'un fichier externe
ResOuverture = fOuvre("C:\MesRépertoires\Fichier.txt", foLectureEcriture)
SI ResOuverture <> -1 ALORS 
	...
FIN
```


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Ouverture d'un fichier externe
MonFichier est un FichierDisque
ResOuverture = fOuvre("C:\MesRépertoires\Fichier.txt", foLectureEcriture)
SI PAS ErreurDétectée ALORS
	...
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = fOuvre(<Chemin du fichier> [, <Mode d'ouverture>])`
---

**`<Résultat> : (Entier ou variable de type FichierDisque)`**

Correspond à :

- un entier :  

	- l'identifiant du fichier externe. Cet identifiant sera utilisé dans toutes les fonctions de manipulation des fichiers externes.

	- -1 en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




- une variable de type [FichierDisque](../WDLang1/1410088883.md). En cas d'erreur, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.
	




**`<Chemin du fichier> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier (260 caractères maximum). Un chemin de type UNC peut être utilisé.


**`<Mode d'ouverture> : (Constante (ou combinaison de constantes) optionnelle)`**

Constantes permettant de définir le mode d'ouverture du fichier, le mode d'accès au fichier et le mode de blocage du fichier.

- Mode d'ouverture du fichier : 
	


|   |   |
| --- | --- |
| *foAjout* | Ouverture du fichier en "ajout". A l'ouverture, la position en cours correspond au dernier octet du fichier. |
| *foCréation* | Création du fichier. Si le fichier existe déjà (même répertoire, même nom), ce fichier est détruit et recréé. |
| *foCréationSiInexistant* | Création du fichier uniquement si ce fichier n'existe pas. La position en cours correspond au premier octet du fichier. |



- Mode d'accès au fichier. Ce type est utilisé par les fonctions [fLitLigne](../WDLang1/3036031.md) et [fEcritLigne](../WDLang1/3036025.md) pour déterminer le type des informations à lire et écrire dans le fichier externe :
	


|   |   |
| --- | --- |
| *foAnsi* | Fichier de type Ansi. Cette constante permet de gérer un fichier Ansi lorsque le mode "Utiliser les chaînes Unicode en exécution" est activé au niveau de la configuration de projet.<br><br>Mode utilisé par défaut :<br><br>	- dans les projets WINDEV et WEBDEV inférieurs à la version 17.<br><br>	- dans les configurations de projet WINDEV et WEBDEV utilisant le mode "Utiliser les chaînes Ansi en exécution" à partir de la version 17.<br><br><br> |
| *foUnicode* | Fichier de type Unicode. Cette constante permet de gérer un fichier Unicode lorsque le mode "Utiliser des chaînes ANSI en exécution" est activé au niveau de la configuration de projet.<br><br>Mode utilisé par défaut :<br><br>	- dans les projets WINDEV Mobile quels que soient le mode et la version utilisés.<br><br>	- dans les configurations de projet WINDEV et WEBDEV utilisant le mode "Utiliser les chaînes Unicode en exécution" à partir de la version 17.<br><br><br> |



- Mode de blocage du fichier : 
	


|   |   |
| --- | --- |
| *foBloqueEcriture* | Les autres applications ne pourront pas modifier le fichier en cours.<br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *foBloqueLecture* | Les autres applications ne pourront pas lire le fichier en cours.<br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *foEcriture* | Ouverture du fichier en "écriture seule". Il sera uniquement possible de modifier ce fichier.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *foLecture* | Ouverture du fichier en "lecture seule". Il sera uniquement possible de lire dans ce fichier. |
| *foLectureEcriture*<br>(Valeur par défaut) | Ouverture du fichier en "lecture/écriture". Il sera possible de lire et de modifier ce fichier (équivalent à *foLecture*+*foEcriture*). |
| *foSuppressionAutomatique* | Le fichier est bloqué lors de son ouverture et sera automatiquement supprimé à sa fermeture (appel de la fonction [fFerme](../WDLang1/3036027.md) ou à la fin de l'application).<br>Si ce fichier est ouvert par plusieurs applications, le fichier sera automatiquement supprimé lorsque la dernière application fermera le fichier (appel de la fonction [fFerme](../WDLang1/3036027.md) ou à la fin de l'application).<br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas disponible.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Si le fichier est utilisé par une autre application lors de sa fermeture (appel de la fonction [fFerme](../WDLang1/3036027.md) ou à la fin de l'application), il ne sera pas supprimé. |



- Autres options : 
	


|   |   |
| --- | --- |
| *foAccèsSéquentiel* | Optimise la gestion des caches pour le fichier en indiquant à Windows que le fichier va être lu du début à la fin. <br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |








<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000294"></a>La fonction **fOuvre** génère une erreur dans les cas suivants :

- le fichier n'existe pas,

- le fichier est bloqué par un autre poste ou par une autre application,

- l'utilisateur n'a pas les droits en lecture ou en écriture sur le fichier à ouvrir.

- une chaîne Unicode a été utilisée pour le paramètre &lt;Chemin du fichier&gt; sous un système d'exploitation de type Windows 98 ou Windows Me.


**Remarque** : L'ouverture en modification d'un fichier présent sur une disquette protégée en écriture réussit.
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Fonctionnement sous Windows Vista (et supérieur)
<a name="fonctionnement_sous_windows_vista_superieur_ELTPARAGRAPHE000539"></a>Si cette fonction ne fonctionne pas correctement sous Windows Vista (et supérieur), il est nécessaire de vérifier si le fichier ou le répertoire manipulé ne se trouve pas dans un des répertoires système (répertoire de Windows ou répertoire "Program Files").

**En effet, sous Windows Vista (et supérieur), avec le [mécanisme de l'UAC](../Editeurs/2025014.md) (contrôle des comptes utilisateurs) activé**, il est nécessaire d'avoir les privilèges administrateur pour manipuler / modifier des fichiers ou des répertoires présents dans les répertoires système (répertoire de Windows ou répertoire "Program Files").

**Conseil de programmation** : Si vous devez manipuler / modifier des fichiers ou des répertoires, sans avoir besoin de privilèges administrateur, il est conseillé :

- de ne pas écrire dans le répertoire de Windows ou dans le répertoire "Program Files",

- d'utiliser le répertoire système correspondant à l'application (connu par la fonction [SysRep](../WDLang1/3073026.md) par exemple avec la constante *srAppDataCommun*).



<a name="NOTE0_3"></a>


### Mode d'ouverture du fichier
<a name="mode_ouverture_fichier_ELTPARAGRAPHE000320"></a>Par défaut, si le mode d'accès au fichier n'est pas spécifié, le fichier est ouvert selon l'attribut du fichier (défini sous Windows).

Si le mode d'accès spécifié ne correspond pas à l'attribut du fichier, une erreur est générée.

Un fichier en "lecture/écriture" pourra être ouvert dans tous les modes d'accès proposés par **fOuvre** (constantes *foEcriture*, *foLecture* et *foLectureEcriture*).

Un fichier en "lecture seule" pourra être uniquement ouvert en mode "lecture seule" (constante *foLecture*).
<a name="NOTE0_4"></a>


### Ouvertures multiples d'un même fichier
<a name="ouvertures_multiples_meme_fichier_ELTPARAGRAPHE000336"></a>Il est possible d'ouvrir un même fichier plusieurs fois en même temps. Chaque ouverture est associée à un identifiant de fichier différent. Chaque version du fichier doit être manipulée par son propre identifiant.
<a name="NOTE0_5"></a>


### Position dans le fichier
<a name="position_dans_fichier_ELTPARAGRAPHE000343"></a>A l'ouverture d'un fichier, la position en cours correspond :

- au premier octet du fichier,

- au dernier octet du fichier si le fichier est ouvert en "ajout" (constante *foAjout*).




Cette position peut être modifiée par la fonction [fPositionne](../WDLang1/3036039.md).
<a name="NOTE0_6"></a>


### Concaténation de plusieurs fichiers externes
<a name="concatenation_plusieurs_fichiers_externes_ELTPARAGRAPHE000358"></a>Pour concaténer plusieurs fichiers externes, il faut :

- ouvrir le fichier destination en "ajout" (constante *foAjout*),

- ouvrir le fichier source en "lecture" (constante *foLecture* ou *foLectureEcriture*),

- lire le fichier source ligne à ligne avec la fonction [fLitLigne](../WDLang1/3036031.md),

- écrire dans le fichier destination ligne à ligne avec la fonction [fEcritLigne](../WDLang1/3036025.md).



<a name="NOTE0_7"></a>


### Compatibilité entre les différentes versions de WINDEV/WEBDEV
<a name="compatibilite_entre_les_differentes_versions_windevwebdev_ELTPARAGRAPHE000376"></a>Les constantes *foTexte* (ouverture en mode texte) et *foBinaire* (ouverture en mode binaire) ne sont plus nécessaires. Elles sont remplacées par la valeur 0. Dans ce cas, la fonction **fOuvre** tente d'ouvrir le fichier en lecture/écriture.
<a name="NOTE0_8"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Blocage et déblocage
<a name="blocage_deblocage_ELTPARAGRAPHE000388"></a>Un fichier bloqué dès son ouverture (constantes *foBloqueLecture* ou *foBloqueEcriture*) sera automatiquement débloqué lors de sa fermeture (avec la fonction [fFerme](../WDLang1/3036027.md)).
<a name="NOTE0_9"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Gestion des fichiers texte au format UNICODE
<a name="gestion_des_fichiers_texte_format_unicode_ELTPARAGRAPHE000400"></a>La fonction **fOuvre** permet de lire et d'écrire des fichiers texte au format UNICODE "UTF-16 little endian".

La syntaxe :

- **fOuvre(&lt;Nom du fichier&gt;, foLecture + foUnicode)** : permet d'ouvrir un fichier Unicode. Si la marque "Unicode courant" (FFFE) est trouvée au début du fichier, elle est automatiquement lue. 

- ** fOuvre(&lt;Nom du fichier&gt;, foCréation + foUnicode)** : permet de créer un fichier Unicode. La marque "Unicode courant" (FFFE) est automatiquement ajoutée au début du fichier. 

- ** fOuvre(&lt;Nom du fichier&gt;, foCréationSiInexistant + foUnicode)** : permet de créer un fichier UNICODE si ce fichier n'existe pas. La marque "UNICODE courant" (FFFE) est automatiquement ajoutée au début du fichier si celui-ci est effectivement créé. Si le fichier existe et s'il commence par la marque "UNICODE courant" (FFFE), cette marque est automatiquement lue.





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Manipulationdefichierstexte.gif) ***Exemples unitaires (WINDEV)*** : **Manipulation de fichiers texte** <br>Manipulation des fichiers "texte" avec WINDEV :<br>- Créer un fichier texte<br>- Ecrire dans un fichier texte<br>- Lire dans un fichier texte
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Manipulationdefichierstexte.gif) ***Exemples unitaires (WEBDEV)*** : **Manipulation de fichiers texte** <br>Manipulation des fichiers "non HFSQL" avec WEBDEV (création d'un fichier texte, écriture et lecture)
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Manipulationdefichierstexte.gif) ***Exemples unitaires (WINDEV Mobile)*** : **Manipulation de fichiers texte** <br>Manipulation des fichiers externes de type "texte" :<br>- Créer un fichier texte<br>- Ecrire dans un fichier texte<br>- Lire dans un fichier texte

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280std.dll
