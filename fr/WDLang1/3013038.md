
## Hasp (Fonction)

***En anglais : Hasp***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Interroge une clé électronique HASP de type HASP-3, HASP-4, MemoHasp ou NetHasp. La fonction **Hasp** est utilisée pour protéger des applications développées avec WINDEV ou WEBDEV par des clés Hasp.

**Remarques** :

- Pour utiliser la fonction **Hasp**, il faut connaître le fonctionnement des clés Hasp et avoir sa documentation.

- La fonction **Hasp** n'est pas disponible en mode 64 bits. Utilisez plutôt les fonctions de type HaspHLxxx.



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Test de lecture de la cellule 10 de la clé :
// la numérotation commence à 0
NumFonc = 3	// Fonction READ_WORD
Entier1 = 10
Hasp(NumFonc, SeedCode, Lpt, Passe1, Passe2, ...
	&Entier1, &Entier2, &Entier3, &Entier4)
SI Entier3 = 0 ALORS
	Info("Contenu adresse mémoire 10 de la clé>" + Entier2 + "<")
SINON
	Info("Erreur : code retour = " + Entier3)
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`Hasp(<NumFonction> , <SeedC> , <LPT> , <Pass1> , <Pass2> , <Ent1> , <Ent2> , <Ent3> , <Ent4>)`
---

**`<NumFonction> : (Entier)`**

Numéro de la fonction Hasp à effectuer :

- 1 : Vérifie la clé Hasp.

- 2 : &lt;SeedC&gt; permet d'exécuter dans la clé un programme qui fournira en retour 4 entiers différents pour chaque valeur passée. Cela permet de vérifier la présence de la clé et qu'elle n'est pas simulée.

- 3 : Lire le contenu de la clé.

- 4 : Écrire le contenu de la clé.

- 5 : Renvoie le contenu de la clé et les informations sur le port parallèle.

- 6 : Renvoie l'identifiant de la clé.

- 50 : Lit un bloc de données de la clé.

- 51 : Écrit un bloc de données de la clé.




Pour les fonctions de lecture et d'écriture d'une chaîne fixe (Ch) dans la clé : &lt;Ent3&gt; = 0, &lt;Ent4&gt; = &Ch.

**`<SeedC> : (Entier)`**

Utilisé uniquement si &lt;NumFonction&gt; = 2.

**`<LPT> : (Entier)`**

Numéro du port. Si &lt;LPT&gt; = 0, **Hasp** recherche la clé sur le "bon" port parallèle (sans avoir besoin de préciser son numéro).

**`<Pass1> : (Entier)`**

Paramètre fourni par le constructeur de la clé. Ce paramètre garantit la sécurité des données stockées dans la clé.

**`<Pass2> : (Entier)`**

Paramètre fourni par le constructeur de la clé. Ce paramètre garantit la sécurité des données stockées dans la clé.

**`<Ent1> : (Entier)`**

Valeurs passées par référence (avec l'opérateur &). Ces valeurs peuvent être lues en entrée et/ou modifiées en sortie.

**`<Ent2> : (Entier)`**

Valeurs passées par référence (avec l'opérateur &). Ces valeurs peuvent être lues en entrée et/ou modifiées en sortie.

**`<Ent3> : (Entier)`**

Valeurs passées par référence (avec l'opérateur &). Ces valeurs peuvent être lues en entrée et/ou modifiées en sortie.

**`<Ent4> : (Entier)`**

Valeurs passées par référence (avec l'opérateur &). Ces valeurs peuvent être lues en entrée et/ou modifiées en sortie.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Récapitulatif des paramètres nécessaires
<a name="recapitulatif_des_parametres_necessaires_ELTPARAGRAPHE000076"></a>Le tableau suivant récapitule les paramètres nécessaires selon &lt;NumFonction&gt; :


|   |   |   |   |   |   |   |   |   |   |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| &lt;NumFonction&gt; | E/S | SeedC | Lpt | Pass1 | Pass2 | Ent1 | Ent2 | Ent3 | Ent4 |
| 1 | E |   |   | x |   |   |   |   |   |
| 1 | S |   |   |   |   |   | 0/1 |   |   |
| 2 | E | x | x | x | x |   |   |   |   |
| 2 | S |   |   |   |   | r1 | r2 | r3 | r4 |
| 3 | E |   | x | x | x | addr |   |   |   |
| 3 | S |   |   |   |   |   | Data | Status |   |
| 4 | E |   | x | x | x | addr | Data |   |   |
| 4 | S |   |   |   |   |   |   | Status |   |
| 5 | E |   | x | x | x |   |   |   |   |
| 5 | S |   |   |   |   | M/S | Type | Lpt |   |
| 6 | E |   | x | x | x |   |   |   |   |
| 6 | S |   |   |   |   | Idlow | IdHigh | Status |   |
| 50 | E |   | x | x | x | addr | Lng | Segm | OffSet |
| 50 | S |   |   |   |   |   |   | Status |   |
| 51 | E |   | x | x | x | addr | Lng | Segm | OffSet |
| 51 | S |   |   |   |   |   |   | Status |   |





Légende : 

- addr : adresse d'une cellule de la clé

- M/S : taille mémoire de la clé

- Type : type de la clé

- Data : donnée à lire ou à écrire

- Lng : longueur des données à lire/écrire dans la clé

- Segm : 0

- OffSet : &Texte où Texte est une chaîne contenant les informations à lire ou à écrire

- IdLow : pour reconstituer l'identifiant de la clé id = idHigh\*65536+idLow

- IdHigh : pour reconstituer l'identifiant de la clé id = idHigh\*65536+idLow

- Status : compte-rendu d'exécution de la fonction

- r1...r4 : entier contenant les valeurs magiques par rapport à un Seed code et une clé donnés.






<a name="XComposante"></a>

## Composante :
wd280rtf.dll
