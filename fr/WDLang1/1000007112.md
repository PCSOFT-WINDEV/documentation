


## HashFichier (Fonction)

***En anglais : HashFile***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Calcule le Hash d'un fichier d'après un algorithme défini. Il est possible de calculer : 

- un hash simple.

- un hash avec authentification de message.

- un hash obtenu par un algorithme de dérivation de clé qui prend en paramètre un sel (PBKDF2).
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Non disponible.




**Rappel** : Le hachage permet de réaliser un résumé condensé d'un fichier ou d'une chaîne de caractères. Ce résumé est appelé Hash.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000007118&name=hashfichier_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Calcul du Hash de deux fichiers
Hash1 est un Buffer = HashFichier(HA_MD5_128, "C:\Mes fichiers\FichierA.txt")
Hash2 est un Buffer = HashFichier(HA_MD5_128, "D:\Mes fichiers\FichierB.txt")
// Comparaison des deux Hash
SI Hash1 = Hash2 ALORS Info("Les deux fichiers sont identiques.")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Calculer un hash simple

`<Résultat> = HashFichier(<Type d'algorithme> , <Chemin du fichier> [, <Jauge>])`
---

**`<Résultat> : (Buffer)`**

Résultat du hachage du fichier &lt;Chemin du fichier&gt; avec l'algorithme &lt;Type d'algorithme&gt;.

Attention : Ce résultat peut contenir des caractères non affichables.

**`<Type d'algorithme> : (Constante de type Entier)`**

Indique le type d'algorithme utilisé lors du hachage du fichier &lt;Chemin du fichier&gt; :



|   |   |
| --- | --- |
| Famille MD4 | *HA_MD4*<br><br> |
| Famille MD5 | *HA_MD5_128*<br><br>Attention : ce type d'algorithme est actuellement déprécié. |
| Famille MURMUR | <br><br>- *HA_MURMUR_1* : Algorithme Murmur version 1 : hash résultat sur 32 bits<br><br>- *HA_MURMUR_2* : Algorithme Murmur version 2 : hash résultat sur 32 bits<br><br>- *HA_MURMUR_2_64A* : Algorithme Murmur version 2 : hash résultat sur 64 bits optimisé pour processeurs 64 bits<br><br>- *HA_MURMUR_2_64B* : Algorithme Murmur version 2 : hash résultat sur 64 bits optimisé pour processeurs 32 bits<br><br>- *HA_MURMUR_2_A* : Algorithme Murmur version 2 incrémentiel : hash résultat sur 32 bits<br><br>- *HA_MURMUR_2_BIG_ENDIAN* : Algorithme Murmur version 2 pour machine big-endian: hash résultat sur 32 bits<br><br>- *HA_MURMUR_2_ALIGNE* : Algorithme Murmur version 2 pour machine alignée : hash résultat sur 32 bits<br><br>- *HA_MURMUR_3_32* : Algorithme Murmur version 3 : hash résultat sur 32 bits<br><br>- *HA_MURMUR_3_128_X86* : Algorithme Murmur version 3 : hash résultat sur 128 bits optimisé pour processeur 32 bits<br><br>- *HA_MURMUR_3_128_X64* : Algorithme Murmur version 3 : hash résultat sur 128 bits optimisé pour processeur 64 bits<br><br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les constantes de cette famille ne sont pas disponibles. |
| Famille RIPEMD | <br><br>- *HA_RIPEMD_128*<br><br>- *HA_RIPEMD_160*<br><br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les constantes de cette famille ne sont pas disponibles. |
| Famille SHA | <br><br>- HA_SHA_160 (aussi appelé SHA-1)<br><br>- HA_SHA_256 (spécifications FIPS PUB 198)<br><br>- HA_SHA_256_DOUBLE<br><br>- HA_SHA_384<br><br>- HA_SHA_512<br><br><br> |
| Famille SHA-3 | <br><br>- *HA_SHA3_224*<br><br>- *HA_SHA3_256*<br><br>- *HA_SHA3_384*<br><br>- *HA_SHA3_512*<br><br><br><br><br> |
| Famille TIGER | <br><br>- *HA_TIGER_128*<br><br>- *HA_TIGER_160*<br><br>- *HA_TIGER_192*<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les constantes de cette famille ne sont pas disponibles. |
| Famille WHIRLPOOL | *HA_WHIRLPOOL*<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Non disponible. |
| Famille CKSUM | <br><br>- *HA_CKSUM_8*<br><br>- *HA_CKSUM_16*<br><br>- *HA_CKSUM_32*<br><br>- *HA_CKSUM_64*<br><br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les constantes de cette famille ne sont pas disponibles. |





- Algorithmes MD4 / MD5 / SHA / RIPEMD : fonctions de hachage cryptographiques classiques.

- Algorithmes TIGER / WHIRLPOOL : fonctions de hachage ayant de très bonnes propriétés cryptographiques optimisées pour le 64 bits (mais leur utilisation est possible en 32 bits).

- Algorithmes CKSUM : fonctions de hachage ne possédant pas de propriété cryptographique, à n'utiliser que pour des contrôles minimaux ou des tables de hachage.

- Algorithme MURMUR : fonctions de hachage très rapides et ne possédant pas de propriétés cryptographiques. C'est l'algorithme utilisé pour le "bloom filter" des portefeuilles bitcoin.




**`<Chemin du fichier> : (Chaîne de caractères)`**

Chemin du fichier sur lequel sera effectué le calcul.  

**`<Jauge> : (Nom de fenêtre optionnel ou nom de champ optionnel)`**

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 

- Nom de la fenêtre dans laquelle la jauge doit être affichée,

- Nom du champ de type Jauge à utiliser. 





<a name="SYNTAXE2"></a>

### Calculer un hash avec authentification de message (algorithme HMAC/algorithme MURMUR)

`<Résultat> = HashFichier(<Type d'algorithme> , <Chemin du fichier> , <Clé secrète> [, <Jauge>])`
---

**`<Résultat> : (Buffer)`**

Résultat du hachage du fichier &lt;Chemin du fichier&gt; avec l'algorithme &lt;Type d'algorithme&gt;.

Attention : Ce résultat peut contenir des caractères non affichables.

**`<Type d'algorithme> : (Constante de type Entier)`**

Indique le type d'algorithme HMAC utilisé lors du hachage du fichier &lt;Chemin du fichier&gt; :



|   |   |
| --- | --- |
| Famille MD4 | *HA_HMAC_MD4*<br><br> |
| Famille MD5 | *HA_HMAC_MD5_128*<br><br>Attention : ce type d'algorithme est actuellement déprécié. |
| Famille MURMUR | <br><br>- *HA_MURMUR_1* : Algorithme Murmur version 1 : hash résultat sur 32 bits<br><br>- *HA_MURMUR_2* : Algorithme Murmur version 2 : hash résultat sur 32 bits<br><br>- *HA_MURMUR_2_64A* : Algorithme Murmur version 2 : hash résultat sur 64 bits optimisé pour processeurs 64 bits<br><br>- *HA_MURMUR_2_64B* : Algorithme Murmur version 2 : hash résultat sur 64 bits optimisé pour processeurs 32 bits<br><br>- *HA_MURMUR_2_A* : Algorithme Murmur version 2 incrémentiel : hash résultat sur 32 bits<br><br>- *HA_MURMUR_2_BIG_ENDIAN* : Algorithme Murmur version 2 pour machine big-endian: hash résultat sur 32 bits<br><br>- *HA_MURMUR_2_ALIGNE* : Algorithme Murmur version 2 pour machine alignée : hash résultat sur 32 bits<br><br>- *HA_MURMUR_3_32* : Algorithme Murmur version 3 : hash résultat sur 32 bits<br><br>- *HA_MURMUR_3_128_X86* : Algorithme Murmur version 3 : hash résultat sur 128 bits optimisé pour processeur 32 bits<br><br>- *HA_MURMUR_3_128_X64* : Algorithme Murmur version 3 : hash résultat sur 128 bits optimisé pour processeur 64 bits<br><br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les constantes de cette famille ne sont pas disponibles. |
| Famille RIPEMD | <br><br>- *HA_HMAC_RIPEMD_128*<br><br>- *HA_HMAC_RIPEMD_160*<br><br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les constantes de cette famille ne sont pas disponibles. |
| Famille SHA | <br><br>- *HA_HMAC_SHA_160*<br><br>- *HA_HMAC_SHA_256* <br><br>- *HA_HMAC_SHA_256_DOUBLE*<br><br>- *HA_HMAC_SHA_384*<br><br>- *HA_HMAC_SHA_512*<br><br><br> |
| Famille SHA-3 | <br><br>- *HA_HMAC_SHA3_224*<br><br>- *HA_HMAC_SHA3_256*<br><br>- *HA_HMAC_SHA3_384*<br><br>- *HA_HMAC_SHA3_512*<br><br><br><br><br> |
| Famille TIGER | <br><br>- *HA_HMAC_TIGER_128*<br><br>- *HA_HMAC_TIGER_160*<br><br>- *HA_HMAC_TIGER_192*<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les constantes de cette famille ne sont pas disponibles. |
| Famille WHIRLPOOL | *HA_HMAC_WHIRLPOOL*<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Non disponible. |





- Algorithmes MD4 / MD5 / SHA / RIPEMD : fonctions de hachage cryptographiques classiques.

- Algorithmes TIGER / WHIRLPOOL : fonctions de hachage ayant de très bonnes propriétés cryptographiques optimisées pour le 64 bits (mais leur utilisation est possible en 32 bits).

- Algorithme MURMUR : fonctions de hachage très rapides et ne possédant pas de propriétés cryptographiques. C'est l'algorithme utilisé pour le "bloom filter" des portefeuilles bitcoin.  




**`<Chemin du fichier> : (Chaîne de caractères)`**

Chemin du fichier sur lequel sera effectué le calcul.

**`<Clé secrète> : (Chaîne de caractères ou Entier)`**

Clé d'authentification du message. 

- Si un algorithme HMAC est utilisé, ce paramètre doit être une chaîne. 

- Si un algorithme MURMUR est utilisé, la clé doit être un entier.




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre ne doit pas être une chaîne vide.

**`<Jauge> : (Nom de champ optionnel ou nom de fenêtre optionnel)`**

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 

- Nom de la fenêtre dans laquelle la jauge doit être affichée,

- Nom du champ de type Jauge à utiliser. 





<a name="SYNTAXE3"></a>
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 
### Calculer un hash via un algorithme de dérivation de clé qui prend en paramètre un sel (PBKDF2)

`<Résultat> = HashFichier(<Type d'algorithme> , <Chemin du fichier> , <Sel> , <Itération> , <Longueur> [, <Jauge>])`
---

**`<Résultat> : (Buffer)`**

Résultat du hachage du fichier &lt;Chemin du fichier&gt; avec l'algorithme &lt;Type d'algorithme&gt;.

Attention : Ce résultat peut contenir des caractères non affichables.

**`<Type d'algorithme> : (Constante de type Entier)`**

Indique le type d'algorithme pseudo-aléatoire utilisé par PBKDF2 lors du hachage du fichier &lt;Chemin du fichier&gt; :



|   |   |
| --- | --- |
| Famille MD4 | *HA_PBKDF2_HMAC_MD4* |
| Famille MD5 | *HA_PBKDF2_HMAC_MD5_128*<br><br>Attention : ce type d'algorithme est actuellement déprécié.<br><br> |
| Famille RIPEMD | <br><br>- *HA_PBKDF2_HMAC_RIPEMD_128*<br><br>- *HA_PBKDF2_HMAC_RIPEMD_160*<br><br><br> |
| Famille SHA | <br><br>- *HA_PBKDF2_HMAC_SHA_160*<br><br>- *HA_PBKDF2_HMAC_SHA_256*<br><br>- *HA_PBKDF2_HMAC_SHA_256_DOUBLE*<br><br>- *HA_PBKDF2_HMAC_SHA_384*<br><br>- *HA_PBKDF2_HMAC_SHA_512*<br><br><br> |
| Famille SHA-3 | <br><br>- *HA_PBKDF2_HMAC_SHA3_224*<br><br>- *HA_PBKDF2_HMAC_SHA3_256*<br><br>- *HA_PBKDF2_HMAC_SHA3_384*<br><br>- *HA_PBKDF2_HMAC_SHA3_512*<br><br><br><br><br> |
| Famille TIGER | <br><br>- *HA_PBKDF2_HMAC_TIGER_128*<br><br>- *HA_PBKDF2_HMAC_TIGER_160*<br><br>- *HA_PBKDF2_HMAC_TIGER_192*<br><br><br> |
| Famille WHIRLPOOL | *HA_PBKDF2_HMAC_WHIRLPOOL* |





- Algorithmes MD4 / MD5 / SHA / RIPEMD : fonctions de hachage cryptographiques classiques.

- Algorithmes TIGER / WHIRLPOOL : fonctions de hachage ayant de très bonnes propriétés cryptographiques optimisées pour le 64 bits (mais leur utilisation est possible en 32 bits).




**`<Chemin du fichier> : (Chaîne de caractères)`**

Chemin du fichier sur lequel sera effectué le calcul.

**`<Sel> : (Chaîne de caractères)`**

Sel cryptographique utilisé. Chaîne, généralement aléatoire, ajoutée au fichier pour modifier son empreinte.  

**`<Itération> : (Entier)`**

Nombre d'itérations de l'algorithme (par défaut, 10000). Ce nombre dépend de la puissance de la machine de calcul et de la criticité du hachage. Un nombre minimum de 1000 itérations est en général recommandé.

**`<Longueur> : (Entier)`**

Longueur de la clé dérivée. Par défaut, correspond à la taille de la clé générée par l'algorithme pseudo-aléatoire. Cette longueur est techniquement non-bornée mais de par l'algorithme, elle est limitée à (2^32  1) \* (la longueur des chaînes sorties par l'algorithme utilisé par PBKDF2).   

**`<Jauge> : (Nom de fenêtre optionnel ou nom de champ optionnel)`**

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 

- Nom de la fenêtre dans laquelle la jauge doit être affichée,

- Nom du champ de type Jauge à utiliser. 






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Notes
<a name="notes_ELTPARAGRAPHE000668"></a>

- Deux fichiers de contenu identique auront, pour un même type d'algorithme, deux Hash identiques.

- Le résultat du Hash peut contenir des caractères non affichables. Ces caractères ne pourront pas être vus lors de l'utilisation par exemple des fonctions [Info](../WDLang1/3021011.md) ou [Trace](../WDLang1/3013050.md).



<a name="NOTE0_3"></a>
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Disponibilité des algorithmes
<a name="disponibilite_des_algorithmes_ELTPARAGRAPHE000684"></a>

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Seuls les algorithmes suivants sont supportés : 

- HA_HMAC_MD5_128

- HA_HMAC_SHA_160, HA_HMAC_SHA_256, HA_HMAC_SHA_384, HA_SHA_HMAC_512

- HA_HMAC_SHA_256_DOUBLE

- HA_MD4

- HA_MD5_128

- HA_SHA_160, HA_SHA_256, HA_SHA_384, HA_SHA_512

- HA_SHA_256_DOUBLE





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LesfonctionsdeHashage.gif) ***Exemples unitaires (WINDEV)*** : **Les fonctions de Hashage** <br>Utilisation des fonctions de hashage.<br>Les fonctions HashFichier et HashChaîne permettent de calculer une clé de Hashage pour une chaîne ou pour un fichier.<br>Cette clé de Hashage permet par exemple de : <br>- Vérifier que le fichier est intègre suite à un transfert par exemple<br>- Rechercher des doublons de fichiers <br>- ...

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280com.dll
