
## SysChangeEnvironnement (Fonction)

***En anglais : SysChangeEnvironment***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie les variables d'environnement du système d'exploitation du poste en cours.

**Remarque** : La fonction [SysEnvironnement](../WDLang1/3073014.md) permet de connaître les variables d'environnement du système d'exploitation du poste en cours.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
VAR est une chaîne = "VAR_UTILISATEUR"
SI SysEnvironnement(VAR) = "" ALORS
	// La variable n'existe pas, on la crée
	SysChangeEnvironnement(VAR, "VAL_VAR_UTILISATEUR", sysEnvUtilisateur)
	Info("La variable a été ajoutée," 
		" la modification sera prise en compte au prochain démarrage")
SINON
	// La variable existe, on la supprime
	SysChangeEnvironnement(VAR, Null, sysEnvUtilisateur)
	Info("La variable a été supprimée,"
		" la modification sera prise en compte au prochain démarrage")
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = SysChangeEnvironnement(<Nom> , <Valeur> [, <Permanent>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la modification a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> en cas d'erreur.




**`<Nom> : (Chaîne de caractères)`**

Nom de la variable d'environnement à modifier. Si la variable d'environnement n'existe pas, elle est créée.

**`<Valeur> : (Chaîne de caractères)`**

Nouvelle valeur de la variable d'environnement spécifiée.

**`<Permanent> : (Constante optionnelle de type Entier)`**

Correspond à une des constantes suivantes : 


|   |   |
| --- | --- |
| *sysEnvGlobal* | Changement global pour le système : le processus en cours ainsi que tous les nouveaux processus du système sont affectés. La nouvelle valeur sera prise en compte uniquement à la prochaine connexion de l'utilisateur.<br><br>Remarque : Pour utiliser cette constante, l'utilisateur doit être administrateur. |
| *sysEnvProcessus* <br>(Valeur par défaut) | Changement du processus en cours uniquement. |
| *sysEnvUtilisateur* | Changement effectué uniquement pour l'utilisateur en cours : le processus en cours ainsi que tous les nouveaux processus lancés par l'utilisateur sont affectés.<br><br>La nouvelle valeur sera prise en compte uniquement à la prochaine connexion de l'utilisateur. |





![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre est ignoré.



<a name="NOTE0"></a>


<a name="XComposante"></a>

## Composante :
wd280std.dll
