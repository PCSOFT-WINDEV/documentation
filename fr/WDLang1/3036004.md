
## fCopieFichier (Fonction)

***En anglais : fCopyFile***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Copie un ou plusieurs fichiers (quels que soient leurs attributs).






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003036004&name=fcopiefichier_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Copie de "Fichier.doc" vers "CopieFichier.doc"
Res = fCopieFichier("C:\Répertoires\Fichier.doc", "D:\Documents\CopieFichier.doc")
```


<a name="Exemple2"></a>




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Copie les fichiers présents dans le répertoire "C:\MesImages"
// Les sous-répertoires et leurs fichiers sont pris en compte (constante frRécursif)
ResCopie = fCopieFichier("C:\MesImages\*.*", "D:\MesFichiers\", frRécursif)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Copier un fichier ou un répertoire

`<Résultat> = fCopieFichier(<Fichier source> , <Fichier ou répertoire destination> [, <Indicateur de copie>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le ou les fichiers ont été copiés, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Fichier source> : (Chaîne de caractères)`**

Fichier à copier (260 caractères maximum). Ce paramètre peut correspondre à : 

- un nom de fichier. Ce fichier sera automatiquement recherché dans le répertoire en cours (connu avec la fonction [fRepEnCours](../WDLang1/3036022.md)).

- un nom de fichier avec son chemin (complet ou relatif). Un chemin de type UNC peut être utilisé.




Cas particuliers selon les plateformes : 

- ![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.




**Gestion des caractères joker  (\*, ?)** : Par défaut, les caractères jokers sont autorisés dans le nom du fichier.
Cas particulier selon les plateformes : 

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Si l'expression "\*.\*" est utilisée, seuls les fichiers avec extension seront copiés.






**`<Fichier ou répertoire destination> : (Chaîne de caractères)`**

Fichier et/ou répertoire destination (260 caractères maximum). Ce paramètre peut correspondre à :

- un nom de fichier. Ce fichier sera automatiquement créé dans le répertoire en cours (connu avec la fonction [fRepEnCours](../WDLang1/3036022.md)).

- un nom de fichier avec son chemin (complet ou relatif). Un chemin de type UNC peut être utilisé. 

- un chemin (complet ou relatif), uniquement dans le cas d'une copie avec caractères jokers.


Si ce paramètre correspond à un nom de répertoire, ce nom peut être terminé indifféremment par "\\" ou non.

Cas particuliers selon les plateformes : 

- ![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.




**`<Indicateur de copie> : (Constante optionnelle)`**

Type de copie à effectuer :


|   |   |
| --- | --- |
| *frConfirmer* | Copie d'un fichier avec demande de confirmation avant l'écrasement d'un fichier de même nom.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |
| *frJauge* | Une fenêtre de progression est affichée. Si le fichier est petit (quelques octets), la jauge n'est pas affichée. <br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *frRécursif* | Copie récursive de fichiers. Les sous-répertoires et leurs fichiers sont pris en compte. |


Par défaut, &lt;Indicateur de copie&gt; est vide. Aucune des options n'est sélectionnée.




<a name="SYNTAXE2"></a>

<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000372"></a>La fonction **fCopieFichier** génère une erreur dans les cas suivants :

- le fichier à copier n'existe pas,

- le fichier à copier est bloqué,

- le &lt;Chemin du fichier à copier&gt; est invalide,

- le &lt;Chemin du fichier copié&gt; est une chaîne vide,

- le &lt;Chemin du fichier à copier&gt; et le &lt;Chemin du fichier copié&gt; sont identiques.





<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Fonctionnement sous Windows Vista (et supérieur)
<a name="fonctionnement_sous_windows_vista_superieur_ELTPARAGRAPHE000541"></a>Si cette fonction ne fonctionne pas correctement sous Windows Vista (et supérieur), il est nécessaire de vérifier si le fichier ou le répertoire manipulé ne se trouve pas dans un des répertoires système (répertoire de Windows ou répertoire "Program Files").

**En effet, sous Windows Vista (et supérieur), avec le [mécanisme de l'UAC](../Editeurs/2025014.md) (contrôle des comptes utilisateurs) activé**, il est nécessaire d'avoir les privilèges administrateur pour manipuler / modifier des fichiers ou des répertoires présents dans les répertoires système (répertoire de Windows ou répertoire "Program Files").

**Conseil de programmation** : Si vous devez manipuler / modifier des fichiers ou des répertoires, sans avoir besoin de privilèges administrateur, il est conseillé :

- de ne pas écrire dans le répertoire de Windows ou dans le répertoire "Program Files",

- d'utiliser le répertoire système correspondant à l'application (connu par la fonction [SysRep](../WDLang1/3073026.md) par exemple avec la constante *srAppDataCommun*).



<a name="NOTE0_3"></a>


### Création de répertoires lors de la copie
<a name="creation_repertoires_lors_copie_ELTPARAGRAPHE000396"></a>

- Si un des répertoires du chemin destination n'existe pas, il est automatiquement créé.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) Si le fichier source correspond à l'ensemble des fichiers d'un répertoire (par exemple, C:\\Temp\\\*.\*), il faut utiliser la constante *frRécursif* afin de créer les sous-répertoires dans la destination (et copier leur contenu).


**Remarque** : Pour effectuer des copies de répertoires, il est également possible d'utiliser la fonction [fRepCopie](../WDLang1/3036041.md).


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Manipulationdefichierstexte.gif) ***Exemples unitaires (WINDEV)*** : **Manipulation de fichiers texte** <br>Manipulation des fichiers "texte" avec WINDEV :<br>- Créer un fichier texte<br>- Ecrire dans un fichier texte<br>- Lire dans un fichier texte
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Manipulationdefichierstexte.gif) ***Exemples unitaires (WEBDEV)*** : **Manipulation de fichiers texte** <br>Manipulation des fichiers "non HFSQL" avec WEBDEV (création d'un fichier texte, écriture et lecture)
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Manipulationdefichierstexte.gif) ***Exemples unitaires (WINDEV Mobile)*** : **Manipulation de fichiers texte** <br>Manipulation des fichiers externes de type "texte" :<br>- Créer un fichier texte<br>- Ecrire dans un fichier texte<br>- Lire dans un fichier texte



<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280std.dll
