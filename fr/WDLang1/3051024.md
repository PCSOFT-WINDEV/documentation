
## Lecture d'une vidéo grâce aux fonctions MCI
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000148"></a>
Les fonctions MCI permettent de manipuler simplement les fichiers multimédia. Cette page d'aide présente les différentes possibilités des fonctions MCI sur les vidéos.

Pour manipuler simplement une vidéo en WINDEV, il suffit d'utiliser un champ Image.

Les manipulations pouvant être réalisées sont les suivantes :

- Ouvrir et jouer une vidéo dans un champ Image,

- Mettre la lecture en pause ou arrêter la lecture,

- Régler le volume.






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Ouvrir et jouer une vidéo dans un champ Image
<a name="ouvrir_jouer_une_video_dans_champ_image_ELTTEXTE000172"></a>


### Ouvrir un fichier Vidéo
<a name="ouvrir_fichier_video_ELTPARAGRAPHE000027"></a>L'ouverture d'un fichier vidéo se fait simplement grâce à la fonction [MCIOuvre](../WDLang1/3051017.md). La plupart des fichiers vidéo peuvent être manipulés avec les fonctions MCI.

Exemple :


```wl
// Sélection du fichier Vidéo
sFic est une chaîne
sFic = fSélecteur(SAI_FIC, "Sélectionnez un fichier vidéo...",...
	"Fichiers vidéo (*.avi)"+ TAB + "*.avi" + RC + ...
	"Fichiers vidéo MPEG (*.mpg)" + TAB + "*.mpg" + RC + ...
	"Fichiers Quick Time (*.mov)" + TAB + "*.mov" + RC + ...
	"Tous les fichiers (*.*)" + TAB + "*.*", ...
	"*", fselOuvre + fselExiste)
// Si un fichier a été sélectionné
SI sFic <> "" ALORS
	 SAI_FIC = sFic
	 // Fermeture du fichier Vidéo précédent s'il y en a un
	 // Ne fait rien sinon 
	 MCIFerme("MaVidéo") 
	 // Ouverture du fichier Vidéo sélectionné 
	 // "MaVidéo" est le nom logique (alias) choisi arbitrairement 
	 // c'est ce nom que l'on utilisera par la suite pour manipuler le fichier 
	 // IMG_VIDEO est le champ Image où va s'afficher la vidéo 
	 MCIOuvre(SAI_FIC, "MaVidéo", MciStyleFille, IMG_VIDEO) 
	 // Si l'ouverture a échoué
	 SI ErreurDétectée = Vrai ALORS
		 // Affichage du compte-rendu
		  Erreur(ErreurInfo()) 
	 FIN
FIN
```



<a name="NOTE2_2"></a>


### Jouer un fichier vidéo
<a name="jouer_fichier_video_ELTPARAGRAPHE000042"></a>Pour jouer un fichier vidéo, il suffit d'utiliser la fonction [MCIJoue](../WDLang1/3051001.md).


```wl
// Lecture de la vidéo sélectionnée
// Rappel : "MaVidéo" est le nom logique choisi pour ce fichier lors de son ouverture
MCIJoue("MaVidéo")
```


**Remarque** : Pour jouer la vidéo (de type AVI) en boucle, il suffit d'utiliser la fonction [MCIExécute](../WDLang1/3051005.md), en précisant la ligne de commande "play AVI repeat" :

```wl
// Jouer la vidéo de type AVI en boucle
MCIExécute("play AVI Repeat")
```




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Mettre la lecture en pause ou arrêter la lecture
<a name="mettre_lecture_pause_arreter_lecture_ELTTEXTE000202"></a>


### Mettre la lecture en pause
<a name="mettre_lecture_pause_ELTPARAGRAPHE000063"></a>Pour mettre la lecture en pause, il suffit d'utiliser la fonction [MCIPause](../WDLang1/3051015.md).


```wl
// Mise en pause de la vidéo sélectionnée
// Rappel : "MaVidéo" est le nom logique  choisi pour ce fichier lors de son ouverture
MCIPause("MaVidéo")
```



<a name="NOTE3_2"></a>


### Arrêter la lecture
<a name="arreter_lecture_ELTPARAGRAPHE000076"></a>Pour arrêter la lecture, il suffit d'utiliser la fonction [MCIArrêt](../WDLang1/3051003.md).


```wl
// Arrêt de la vidéo sélectionnée
// Rappel : "MaVidéo" est le nom logique choisi pour ce fichier lors de son ouverture
MCIArrêt("MaVidéo")
```


**Astuce** : N'oubliez pas de repositionner la vidéo au début du fichier. Ainsi, lorsque l'utilisateur relancera la vidéo, elle commencera au début.


```wl
// Repositionnement au début du fichier
// Lorsque l'utilisateur redemandera de lire le fichier, la lecture recommencera au début
MCIDébut("MaVidéo")
```




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Régler le volume
<a name="regler_volume_ELTTEXTE000232"></a>
Le réglage du volume est effectué grâce à la fonction [MCIVolume](../WDLang1/3051012.md). Il est possible de régler le volume à droite, à gauche, le volume des aigus ou des graves.




- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Lectured'unevideo.gif) ***Exemples unitaires (WINDEV)*** : **Lecture d'une vidéo** <br>Visualisation d'une vidéo depuis une application WINDEV :<br>- Charger une vidéo<br>- Jouer une vidéo<br>- Mettre une vidéo en pause<br>- Arrêter une vidéo
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDMultimedia.gif) ***Exemples complets (WINDEV)*** : **WD Multimedia** <br>Cet exemple montre comment jouer des vidéos (AVI, MPEG...), des sons (CD AUDIO, MP3, WAV) et des animations avec le champ Multimédia de WINDEV.


