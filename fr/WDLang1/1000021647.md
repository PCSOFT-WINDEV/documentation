


## TableurChampFormule (Fonction)

***En anglais : SpreadsheetControlFormula***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet d'utiliser un champ pour réaliser une barre de formule personnalisée pour le champ Tableur.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// -- Code d'initialisation du champ Tableur
// Enlève la barre de formule par défaut
TBLR_MonTableur.BarreDeFormuleVisible = Faux
// Définit le champ permettant de visualiser 
// les coordonnées de la cellule sélectionnée dans le champ Tableur
TableurChampFormule(TBLR_MonTableur, tblrfSélection, LIB_Sélection)
// Définit le champ permettant de saisir les formules dans le champ Tableur
TableurChampFormule(TBLR_MonTableur, tblrfFormule, SAI_Formule)
```

```wl
// -- Code de clic du bouton permettant de valider la formule
// Utilisation de la fonction FAAExécute
FAAExécute(TBLR_MonTableur, faaValiderSaisieFonc)
```

```wl
// -- Code de clic du bouton permettant d'annuler la formule
// Utilisation de la fonction FAAExécute
FAAExécute(TBLR_MonTableur, faaAnnulerSaisieFonc)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`TableurChampFormule(<Champ Tableur> , <Type> , <Champ à utiliser>)`
---

**`<Champ Tableur> : (Nom de champ)`**

Nom du champ Tableur à manipuler.

**`<Type> : (Constante de type Entier)`**

Usage du champ : 


|   |   |
| --- | --- |
| *tblrfFormule* | Le champ permet la saisie de la formule pour la cellule en cours dans le champ Tableur. <br><br>Attention : le champ utilisé DOIT être un champ de saisie. |
| *tblrfSélection* | Le champ affiche la sélection en cours (cellule ou la plage de cellules) dans le champ Tableur. |



**`<Champ à utiliser> : (Nom de champ)`**

Nom du champ de la fenêtre à utiliser pour personnaliser l'affichage de la formule ou de la sélection. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Après l'exécution de cette fonction, les champs de la barre de formule par défaut ne sont plus utilisés. Il est conseillé de désactiver l'affichage de la barre de formule par défaut à l'aide de la propriété [BarreDeFormuleVisible](../Proprietes/1000021334.md). 

- Pour valider la saisie dans la barre de formule personnalisée, il est nécessaire d'exécuter la fonction [FAAExécute](../WDLang1/1000022099.md) avec la constante *faaValiderSaisieFonc*.

- Pour annuler la saisie dans la barre de formule personnalisée, il est nécessaire d'exécuter la fonction [FAAExécute](../WDLang1/1000022099.md) avec la constante *faaAnnulerSaisieFonc*.

- Cette fonction est utilisable uniquement sur un champ Tableur présent dans une fenêtre. 




<a name="XComposante"></a>

## Composante :
wd280obj.dll
