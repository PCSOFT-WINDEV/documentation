
## DonneFocusEtRetourUtilisateur (Fonction)

***En anglais : SetFocusAndReturnToUserInput***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Arrête le traitement en cours, donne le focus au champ, à la fenêtre ou à la page spécifié(e) et permet à l'utilisateur de reprendre la saisie.



Remarque : Cette fonction est identique à la fonction [RepriseSaisie](../WDLang1/3025027.md). 




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Si l'utilisateur n'a rien saisi dans le champ
SI SAI_Saisie1 = "" ALORS
	// On affiche un message et on remet l'utilisateur en saisie sur le champ 
	Erreur("Saisissez une valeur")
	DonneFocusEtRetourUtilisateur(SAI_Saisie1)
FIN
```
<a name="Exemple2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Positionner le curseur de souris dans une cellule d'un champ Table (multisélection ou non) 
TABLE_Nom_De_Table = Indice_de_ligne
DonneFocusEtRetourUtilisateur(TABLE_Nom_De_Table.COL_Nom_de_colonne)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`DonneFocusEtRetourUtilisateur([<Elément à manipuler>])`
---

**`<Elément à manipuler> : (Nom de champ, nom de fenêtre ou nom de page optionnel)`**

Nom du champ, de la colonne ou de la fenêtre qui doit prendre le focus (voir Remarques). Si ce paramètre n'est pas spécifié, le focus est donné au champ en cours.

Pour indiquer un champ appartenant à une fenêtre ouverte différente de la fenêtre en cours, &lt;Elément à manipuler&gt; doit être de la forme &lt;Nom de fenêtre&gt;.&lt;Nom du champ&gt;.







<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Prise de focus
<a name="prise_focus_ELTPARAGRAPHE000077"></a>La possession du "focus" est matérialisée de différentes manières :

- Curseur clignotant (ou "Caret") pour les champs de saisie.

- Rectangle pointillé pour les autres types de champs (champs Bouton, champs Liste, champs Sélecteur, etc.).





<a name="NOTE0_2"></a>




### Fonctions EcranPremier, DonneFocus et DonneFocusEtRetourUtilisateur
<a name="fonctions_ecranpremier_donnefocus_docparampagetitleshort_ELTPARAGRAPHE000089"></a>Ces fonctions ont un comportement très différent :

- La fonction **DonneFocusEtRetourUtilisateur** arrête le traitement en cours pour forcer la reprise de la saisie dans le champ indiqué. 

- La fonction [EcranPremier](../WDLang1/3025039.md) décrit quel sera le prochain champ ayant la saisie (lorsque le code en cours s'arrêtera et que la saisie reprendra).

- La fonction [DonneFocus](../WDLang1/3025001.md) arrête le traitement en cours, décrit quel sera le prochain champ ayant la saisie et reprend le traitement en cours.





<a name="NOTE0_3"></a>




### Erreur
<a name="erreur_ELTPARAGRAPHE000113"></a>Une erreur du WLangage apparaît si le &lt;Elément à manipuler&gt; ne correspond pas à un champ existant dans la fenêtre ou la page en cours.


<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Fonction DonneFocusEtRetourUtilisateur sur une fenêtre
<a name="fonction_docparampagetitleshort_sur_une_fenetre_ELTPARAGRAPHE000123"></a>Si le paramètre &lt;Elément à manipuler&gt; correspond à un nom de fenêtre, la fenêtre est activée. Le champ prenant le focus dans cette fenêtre correspondra :

- soit au dernier champ précédemment en saisie dans cette fenêtre,

- soit au premier champ pouvant prendre le focus dans cette fenêtre (si aucune saisie n'a été effectuée précédemment dans cette fenêtre).



<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Fonction DonneFocusEtRetourUtilisateur sur une colonne d'un champ Table
<a name="fonction_docparampagetitleshort_sur_une_colonne_champ_table_ELTPARAGRAPHE000138"></a>La fonction **DonneFocusEtRetourUtilisateur** donne le focus à la colonne spécifiée. Si le champ Table n'est pas en cours de saisie, le champ Table passe en saisie.
<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Fonction DonneFocusEtRetourUtilisateur sur le champ en cours
<a name="fonction_docparampagetitleshort_sur_champ_cours_ELTPARAGRAPHE000153"></a>La fonction **DonneFocusEtRetourUtilisateur** utilisée sans paramètre permet de donner le focus au champ en cours. Cette fonction, utilisée par exemple dans le code de sortie d'un champ de saisie, permet de forcer la saisie dans le champ en cours si les informations saisies ne correspondent pas aux informations attendues.
<a name="NOTE0_7"></a>
<a name="NOTE0_8"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Evénements/traitements exécutés lors de l'utilisation de la fonction DonneFocusEtRetourUtilisateur
<a name="evenementstraitements_executes_lors_utilisation_fonction_docparampagetitleshort_ELTPARAGRAPHE000202"></a>Le code WLangage qui suit l'appel à la fonction **DonneFocusEtRetourUtilisateur** n'est pas exécuté et l'utilisateur reprend la main. 

**Cas particuliers** :

- si l'appel de la fonction **DonneFocusEtRetourUtilisateur** est fait dans un code appelé par la fonction [Exécute](../WDLang1/3013041.md), [ExécuteCode](../WDLang1/1000019783.md) ou [ExécuteTraitement](../WDLang1/3013031.md), le code appelé par la fonction [Exécute](../WDLang1/3013041.md), [ExécuteCode](../WDLang1/1000019783.md) ou [ExécuteTraitement](../WDLang1/3013031.md) est interrompu. L'exécution reprend après l'appel de la fonction [Exécute](../WDLang1/3013041.md), [ExécuteCode](../WDLang1/1000019783.md) ou [ExécuteTraitement](../WDLang1/3013031.md). 

- si l'appel de la fonction **DonneFocusEtRetourUtilisateur** est fait dans le code d'une fonction d'une autre fenêtre que la fenêtre courante, le code de cette fonction est interrompu et l'exécution reprend après son l'appel.

- si l'appel de la fonction **DonneFocusEtRetourUtilisateur** est fait dans un code d'un composant (procédure ou méthode), le code du composant est interrompu et l'exécution reprend après l'appel de la procédure ou de la méthode du composant.

- si l'appel de la fonction **DonneFocusEtRetourUtilisateur** est fait dans un code d'une procédure de fenêtre interne, le code de la procédure de la fenêtre interne est interrompu et l'exécution reprend après l'appel de la procédure de la fenêtre interne.

- si l'appel de la fonction **DonneFocusEtRetourUtilisateur** est fait dans le code d'une option de menu, le code de l'option de menu est interrompu et l'exécution reprend après l'appel de l'option de menu.

- si l'appel de la fonction **DonneFocusEtRetourUtilisateur** est fait dans une procédure de fenêtre appelée depuis un superchamp, le code de la procédure est interrompu et l'exécution reprend après l'appel de la procédure dans le superchamp.

- si l'appel de la fonction **DonneFocusEtRetourUtilisateur** est fait dans une procédure d'un superchamp ou d'un modèle de champs, le code de la procédure est interrompu et l'exécution reprend après l'appel de la procédure du superchamp ou du modèle de champs.




Le traitement en cours est interrompu définitivement. Par exemple :


```wl
DonneFocusEtRetourUtilisateur(SAI_Saisie1)
Info("XXX")    // N'est jamais exécuté
```


En règle générale, les événements de sortie (du champ ou de la fenêtre en cours) et d'entrée (dans le champ ou dans la fenêtre spécifiée) sont exécutés en même temps que la fonction **DonneFocusEtRetourUtilisateur**.

Exceptions :

- Aucun code n'est exécuté si &lt;Elément à manipuler&gt; est le champ en cours.

- Le code de sortie du champ en cours n'est pas exécuté si la fonction **DonneFocusEtRetourUtilisateur** est utilisée dans un des événements de ce champ.




Pour ne pas interrompre le traitement, utilisez la fonction [EcranPremier](../WDLang1/3025039.md) ou [DonneFocus](../WDLang1/3025001.md).

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Le code WLangage qui suit l'appel à la fonction **DonneFocusEtRetourUtilisateur** n'est pas exécuté. L'exécution des traitements reprend :

- soit quand l'utilisateur reprend la main. 

- soit lors de l'appel de la fonction [Exécute](../WDLang1/3013041.md) ou [ExécuteTraitement](../WDLang1/3013031.md).



<a name="NOTE0_9"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Fonction DonneFocusEtRetourUtilisateur et FIN:
<a name="fonction_docparampagetitleshort_fin_ELTPARAGRAPHE000315"></a>Après un appel à la fonction **DonneFocusEtRetourUtilisateur**, le code suivant [l'instruction "FIN:"](../Motscles/1510014.md) n'est pas exécuté. La fonction **DonneFocusEtRetourUtilisateur** peut être remplacée par l'appel à la fonction [EcranPremier](../WDLang1/3025039.md) suivie de RETOUR ou RENVOYER.

<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
