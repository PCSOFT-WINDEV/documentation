
## fRep (Fonction)

***En anglais : fDir***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Recherche un fichier ou un répertoire. Cette recherche peut être effectuée à l'aide de caractères jokers (\*, ?).

**Remarques** : 

- Pour tester l'existence d'un fichier, utilisez la fonction [fFichierExiste](../WDLang1/3036015.md).

- Pour tester l'existence d'un répertoire, d'un disque ou d'un partage, utilisez la fonction [fRépertoireExiste](../WDLang1/3036059.md).

- Pour lister les sous-répertoires d'un répertoire, utilisez la fonction [fListeRépertoire](../WDLang1/3036062.md).







<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003036056&name=frep_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Recherche du fichier "C:\MonRépertoire\MonFichier.doc"
ResRecherche = fRep("C:\MonRépertoire\MonFichier.doc")

// Recherche du fichier "C:\MonRépertoire\MonFichier.doc"
ResRecherche = fRep("C:\MonRépertoire\MonFichier.doc", frFichier)

// Recherche du répertoire "C:\MonRépertoire\"
ResRecherche = fRep("C:\MonRépertoire\", frRépertoire)

// Recherche du premier fichier de type ".doc" dans le répertoire "C:\MonRépertoire"
ResRecherche = fRep("C:\MonRépertoire\*.doc")
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = fRep(<Nom du fichier ou du répertoire recherché> [, <Options>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Nom du fichier (avec son extension) ou du répertoire trouvé. 

- Chaîne vide ("") dans le cas contraire. Pour savoir si cette fonction a généré une erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Nom du fichier ou du répertoire recherché> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier (ou du répertoire) recherché (260 caractères maximum). Un chemin de type UNC peut être utilisé. Il est possible d'utiliser des caractères jokers (\*, ?) dans le nom du fichier.
Si ce paramètre est vide, la fonction poursuit la recherche pour obtenir le nom du prochain fichier (ou répertoire) correspondant : il est ainsi possible d'obtenir la liste des fichiers ou des répertoires appartenant à un répertoire donné.
Si ce paramètre correspond à un nom de répertoire, ce nom peut être terminé indifféremment par "\\" ou non.

![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.





![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Si l'expression "\*.\*" est utilisée, seuls les fichiers avec extension seront recherchés.



**`<Options> : (Constante ou combinaison de constantes optionnelle de type Entier)`**

Options de recherche :


|   |   |
| --- | --- |
| *fCheminUNICODE* | &lt;Résultat&gt; sera une chaîne de caractères au format Unicode.<br>Cette constante peut être combinée avec *frFichier*ou *frRépertoire*. |
| *frFichier*<br> (Valeur par défaut) | Recherche d'un fichier. |
| *frRépertoire* | Recherche d'un répertoire. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Attention : la fonction fRep conserve un accès sur le répertoire
<a name="attention_fonction_docparampagetitleshort_conserve_acces_sur_repertoire_ELTPARAGRAPHE000144"></a>L'appel à la fonction **fRep** conserve un accès sur le répertoire, bloquant ainsi sa suppression ou la modification de son nom. Pour débloquer le répertoire, ajoutez la ligne suivante à votre traitement :


```wl
fRep("")
```



<a name="NOTE0_2"></a>




### Parcours de répertoires
<a name="parcours_repertoires_ELTPARAGRAPHE000161"></a>Il ne faut pas imbriquer des parcours de répertoires effectués avec la fonction **fRep**.

Dans une boucle de parcours de répertoires effectuée avec la fonction **fRep**, il ne faut pas utiliser la fonction [fCopieFichier](../WDLang1/3036004.md).


<a name="NOTE0_3"></a>




### Windows
<a name="windows_ELTPARAGRAPHE000181"></a>Sous Windows, un nom de fichier ou de répertoire peut être constitué de minuscules et/ou de majuscules (les noms de fichiers ne sont pas "case sensitive").

Ainsi, il ne faut pas écrire :


```wl
SI fRep(NomFichier) = "TOTO" ALORS Info("Fichier trouvé")
```


Mais, il faut écrire :


```wl
SI fRep(NomFichier) ~= "TOTO" ALORS Info("Fichier trouvé")
```



<a name="NOTE0_4"></a>




### Utilisation de la fonction fRep dans les threads
<a name="utilisation_fonction_docparampagetitleshort_dans_les_threads_ELTPARAGRAPHE000198"></a>Il est déconseillé d'utiliser la fonction **fRep** au même moment dans deux threads différents. 

En effet, le dernier parcours demandé par **fRep** remplace automatiquement le parcours en cours.



<a name="XComposante"></a>

## Composante :
wd280std.dll
