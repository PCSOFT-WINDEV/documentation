
## FichierVersTableau (Fonction)

***En anglais : FileToArray***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Remplit un tableau de classes ou de structures avec le contenu d'un fichier de données ou d'une requête HFSQL. Les valeurs des membres des instances de structures ou de classes sont remplies avec les valeurs des rubriques des enregistrements du fichier de données ou de la requête.






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Déclaration d'une classe MesContacts
MesContacts est une classe
 	NomDeFamille est une chaîne
 	Prénom est une chaîne
 	AdresseEmail est une chaîne
FIN

// Chargement des enregistrements d'un fichier de données Contacts.fic
// dans un tableau d'objet de la classe MesContacts
tabContact est un tableau de MesContacts

HOuvre(Contacts)
FichierVersTableau(tabContact, Contacts)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`FichierVersTableau(<Tableau> [, <Fichier de données> [, <Clé de parcours>]])`
---

**`<Tableau> : (Tableau de structures ou d'objets)`**

Nom du tableau à 1 dimension dans lequel les éléments contenus dans le fichier de données ou dans la requête doivent être ajoutés. Ce tableau doit être alloué dans un type structure ou classe.

**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données HFSQL ou de la requête manipulé.

**`<Clé de parcours> : (Chaîne de caractères)`**

Nom de la rubrique de parcours utilisée. Ce paramètre est utilisé lorsqu'un filtre est défini avec la fonction [HFiltre](../WDLang4/3044100.md). Ce paramètre correspond à la clé de parcours optimale à utiliser, renvoyée par la fonction [HFiltre](../WDLang4/3044100.md).







## Remarques


- Le tableau est entièrement vidé par la fonction **FichierVersTableau**.

- Les tableaux automatiques sont automatiquement redimensionnés en fonction des besoins.

- Le parcours du fichier est effectué en respectant le filtre courant sur le fichier de données.

- La position et les valeurs de l'enregistrement courant ne sont pas modifiés par la fonction **FichierVersTableau**.

- Pour chaque enregistrement du fichier de données ou de la requête :

	- pour chaque membre de la structure ou de la classe ayant le même nom, ou le même attribut "[mapping](../Motscles/1515003.md)", qu'une rubrique du fichier de données, la valeur de la rubrique est recopiée dans la valeur du membre. 

	- si un membre de la structure ou de la classe n'a pas de rubrique de même nom dans le fichier de données, sa valeur n'est pas modifiée.

	- si une rubrique du fichier de données n'a pas de membre de même nom dans la classe, aucune recopie de valeur n'a lieu.




- Attention : La fonction **FichierVersTableau** est bloquante pour tous les threads. 








<a name="XComposante"></a>

## Composante :
wd280vm.dll
