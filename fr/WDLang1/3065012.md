
## RegistreLit (Fonction)

***En anglais : RegistryQueryValue***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Lit la valeur d'un registre dans la base de registre de Windows.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003065012&name=registrelit_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Lit la valeur "Langage" dans la clé "HKEY_LOCAL_MACHINE\SOFTWARE\Appli"
// Le booléen ResExécute permet de savoir si la valeur a été lue
ResLecture = RegistreLit("HKEY_LOCAL_MACHINE\SOFTWARE\Appli", "Langage", ResExécute)

SI ResExécute = Vrai ALORS
	Info("La valeur a été lue et vaut : " + ResLecture)
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Lire une valeur identifiée par son nom

`<Résultat> = RegistreLit([<Mode d'accès>, ] <Chemin de la clé> , <Nom de la valeur> [, <Exécution>])`
---

**`<Résultat> : (Chaîne de caractères, entier, réel ou pointeur)`**



- Valeur lue, 

- Chaîne vide ("") si aucune valeur n'a été lue.




**`<Mode d'accès> : (Constante de type Entier)`**

Mode d'accès à la base de registre :



|   |   |
| --- | --- |
| *registreMode32* | Mode d'accès forcé pour accéder à la base de registre comme un programme 32 bits. |
| *registreMode64* | Mode d'accès forcé pour accéder à la base de registre comme un programme 64 bits. |
| *registreModeAuto*<br>(Valeur par défaut) | Mode d'accès à la base de registre automatique : <br><br>- une application 32 bits exécutée sur un système 32 bits manipule la base de registre comme un programme 32 bits.<br><br>- une application 32 bits exécutée sur un système 64 bits manipule la base de registre à partir de la branche suivante :<br>	<br><pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node</code></pre><br><br><br>- une application 64 bits exécutée sur un système 64 bits manipule la base de registre comme un programme 64 bits.<br><br><br> |



**`<Chemin de la clé> : (Chaîne de caractères)`**

Chemin de la clé à lire.

**`<Nom de la valeur> : (Chaîne de caractères)`**

Nom de la valeur à lire.

**`<Exécution> : (Booléen optionnel)`**



- <u><u><u><u>Vrai</u></u></u></u> si la valeur a été lue, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.  





<a name="SYNTAXE2"></a>

### Lire une valeur identifiée par son indice

`<Résultat> = RegistreLit([<Mode d'accès>, ] <Chemin de la clé> , <Indice de la valeur> , <Exécution>)`
---

**`<Résultat> : (Chaîne de caractères, entier, réel ou pointeur)`**



- Valeur lue, 

- Chaîne vide ("") si aucune valeur n'a été lue.




**`<Mode d'accès> : (Constante de type Entier)`**

Mode d'accès à la base de registre :



|   |   |
| --- | --- |
| *registreMode32* | Mode d'accès forcé pour accéder à la base de registre comme un programme 32 bits. |
| *registreMode64* | Mode d'accès forcé pour accéder à la base de registre comme un programme 64 bits. |
| *registreModeAuto*<br>(Valeur par défaut) | Mode d'accès à la base de registre automatique : <br><br>- une application 32 bits exécutée sur un système 32 bits manipule la base de registre comme un programme 32 bits.<br><br>- une application 32 bits exécutée sur un système 64 bits manipule la base de registre à partir de la branche suivante :<br>	<br><pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node</code></pre><br><br><br>- une application 64 bits exécutée sur un système 64 bits manipule la base de registre comme un programme 64 bits.<br><br><br> |



**`<Chemin de la clé> : (Chaîne de caractères)`**

Chemin de la clé à lire.

**`<Indice de la valeur> : (Entier)`**

Indice de la valeur à lire.

**`<Exécution> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la valeur a été lue, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.  






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Limites de la fonction RegistreLit
<a name="limites_fonction_docparampagetitleshort_ELTPARAGRAPHE000071"></a>La fonction **RegistreLit** ne fonctionne pas sur les entrées du type "(par défaut)". En effet, ces entrées sont spécifiques. Pour atteindre ces entrées, remplacez le nom de la clé par une chaîne vide.

**Exemple** :

Ne pas faire :


```wl
RegistreLit("HKEY_CLASSES_ROOT\.jar", "(par défaut)", "myfile")
```


Faire :


```wl
RegistreLit("HKEY_CLASSES_ROOT\.jar", "", "myfile")
```




<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280std.dll
