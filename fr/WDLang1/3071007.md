
## SourisPosX (Fonction)

***En anglais : MouseXPos***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Utilisée dans un événement lié à la souris ou au stylet (code de clic, code de survol, code de bouton gauche ou droit enfoncé, ...) renvoie la position horizontale (X) du curseur de souris par rapport au champ ou à la fenêtre considérée.

Il est ainsi possible par exemple de connaître :

- la position de la souris (ou du stylet) lors d'un clic gauche dans un champ Image (fonction utilisée dans l'événement "Clic" du champ Image).

- la position de la souris (ou du stylet) lors du survol d'une fenêtre (fonction utilisée dans l'événement optionnel "Survol souris" d'une fenêtre).






**Remarques** : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) La position de la souris peut aussi être connue avec la fonction [CurseurPos](../WDLang1/3071006.md). La fonction [CurseurPos](../WDLang1/3071006.md) est conseillée uniquement pour modifier la position de la souris.

- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Il est conseillé d'utiliser cette fonction uniquement dans les événements des champs survolés par la souris.

- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) La fonction **SourisPosX** retourne la dernière position connue du doigt sur l'écran de l'appareil.









<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Survol souris de la fenêtre "FEN_Dessin"
// Code optionnel de la fenêtre
Message("Position de la souris : X : " + SourisPosX() + " Y : " + SourisPosY())
```


<a name="Exemple2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Affiche un message différent selon l'endroit cliqué
SI SourisPosX() > 25 ALORS
	Info("A droite")
SINON
	Info("A gauche")
FIN
```


<a name="Exemple3"></a>



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Récupérer la position de la souris dans une fenêtre

`<Résultat> = SourisPosX([<Repère>])`
---

**`<Résultat> : (Entier)`**



- Position horizontale (ou abscisse) en pixels de la souris (ou du stylet). Par défaut, cette position est donnée par rapport au coin haut gauche du champ sur lequel le bouton gauche de la souris a été enfoncé.  

- -1 en cas d'erreur.




**`<Repère> : (Constante optionnelle de type Entier)`**

Repère utilisé pour le calcul de la position : 


|   |   |
| --- | --- |
| *spChamp*<br>(Valeur par défaut) | Position de la souris par rapport au point haut gauche du champ survolé (ou de la fenêtre si l'événement est sur la fenêtre). |
| *spEcran* | Position de la souris dans l'écran (par rapport au coin haut gauche de l'écran). |
| *spFenêtre* | Position de la souris par rapport au coin haut gauche de la fenêtre. |
| *spImage* | Position de la souris dans le champ Image (par rapport au coin haut gauche du champ Image). <br><br>Cette constante doit être utilisée uniquement lorsque la fonction **SourisPosX** est appelée dans un événement associé à un champ Image. Dans le cas contraire, la fonction **SourisPosX** retournera -1. |


![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Ce paramètre n'est pas disponible.




<a name="SYNTAXE2"></a>

<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Erreur
<a name="erreur_ELTPARAGRAPHE000176"></a>Les principaux cas d'erreur sont les suivants :

- Aucune fenêtre n'est ouverte.

- Aucun clic de souris n'est effectué.

- La fonction **SourisPosX** n'est pas appelée dans un événement lié à la souris.

- Le code de clic est exécuté par la fonction [Exécute](../WDLang1/3013041.md) ou [ExécuteTraitement](../WDLang1/3013031.md).



<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Divers
<a name="divers_ELTPARAGRAPHE000199"></a>

- Il est possible de connaître la position verticale de la souris (ou du stylet) grâce à la fonction [SourisPosY](../WDLang1/3071008.md).

- La fonction **SourisPosX** utilisée dans le code de sélection de ligne ou de table renvoie toujours 0.

- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Il est conseillé d'utiliser cette fonction uniquement dans les événements WLangage associés aux champs survolés par la souris.



<a name="NOTE0_3"></a>


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Lesfonctionsdedessin.gif) ***Exemples unitaires (WINDEV)*** : **Les fonctions de dessin** <br>Utilisation des principales fonctions de dessin de WINDEV pour :<br>- Initialiser un champ Image pour dessiner<br>- Dessiner des figures simples<br>- Ecrire un texte dans un dessin<br>- Changer la couleur dans un dessin



<a name="XComposante"></a>

## Composante :
wd280obj.dll
