


## ChaîneVersDate (Fonction)

***En anglais : StringToDate***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Transforme une date sous forme de chaîne de caractères en une date au format AAAAMMJJ.

**Remarque** : La transformation effectuée par la fonction **ChaîneVersDate** consiste à identifier dans la chaîne de caractères initiale les différents composants de la date pour construire la chaîne de caractères résultat.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
Res = ChaîneVersDate("25/12/2001")  // Res = "20011225"
Res = ChaîneVersDate("25-12-2001")  // Res = "20011225"
ChaîneVersDate("")                  // Renvoie ""
Res = ChaîneVersDate("12-25-2001", "MM-JJ-AAAA")  // Res = "20011225"
Res = ChaîneVersDate("12-25-01", "MM-JJ-AA")      // Res = "20011225"
Res = ChaîneVersDate("12-25-2001", "MM-JJ-AA")    // Res = ""
Res = ChaîneVersDate("12-25-01", "MM-JJ-AA")       // Res = "20011225"
```



```wl
Res = ChaîneVersDate("Sun, 25 Nov 2012 12:11:55 +0100", maskDateEmail) // Res = "20121125121155"
Res = ChaîneVersDate("Sat, 25 Aug 2012 12:11:55 +0200", maskDateEmail) // Res = "20120825121155"
```



```wl
Res = ChaîneVersDate("Sun, 24 Nov 2019 23:00:00 +0000", maskDateEmailUTC) // Res = "20191124230000000"
Res = ChaîneVersDate("2019-08-25T00:00:00.000+02:00", maskDateInternet) // Res = "20190825000000000"
Res = ChaîneVersDate("2019-08-24T22:00:00.000Z", maskDateInternetUTC) // Res = "20190824220000000"
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ChaîneVersDate(<Date> [, <Format>])`
---

**`<Résultat> : (Chaîne de caractères ou variable de type Date)`**



- Date au format AAAAMMJJ (AAAA correspond à l'année, MM au mois et JJ au jour). 

- Chaîne vide ("") en cas de problème.




**`<Date> : (Chaîne de caractères)`**

Date au format spécifié dans le paramètre &lt;Format&gt;.

**`<Format> : (Chaîne de caractères optionnelle ou constante optionnelle)`**

Format de la date à convertir : 

- sous forme de chaîne : 
	Dans cette chaîne :

	- AAAA représente l'année sur 4 positions.

	- AA représente l'année sur 2 positions. Les années renvoyées seront comprises entre 1951 et 2050.

	- M représente le mois (le zéro n'est pas affiché devant le numéro du mois). 

	- MM représente le mois (le mois doit être sur 2 positions).

	- MMM représente le mois en lettres sur 3 caractères (par exemple jan). La casse utilisée dépend des options linguistiques du projet.
			

	- Mmm représente le mois en lettres sur 3 caractères avec la première lettre forcée en majuscule (par exemple Jan). 
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette notation n'est pas disponible.
			

	- mmm représente le mois en lettres sur 3 caractères avec la première lettre forcée en minuscule (par exemple jan)
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette notation n'est pas disponible.
			

	- MMMM représente le mois en lettres complet (par exemple janvier). La casse utilisée dépend des options linguistiques du projet.
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette notation n'est pas disponible.
			

	- Mmmm représente le mois en lettres complet avec la première lettre forcée en majuscule (par exemple Janvier)
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette notation n'est pas disponible.
			

	- mmmm représente le mois en lettres complet avec la première lettre forcée en minuscule (par exemple janvier)
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette notation n'est pas disponible.
			

	- J représente le jour (le zéro n'est pas affiché devant le numéro du jour), 

	- JJ représente le jour sur 2 chiffres,

	- JJJ représente le jour en lettres sur 3 caractères (par exemple lun). La casse utilisée dépend des options linguistiques du projet.

	- Jjj représente le jour en lettres sur 3 caractères avec la première lettre forcée en majuscule (par exemple Lun)
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette notation n'est pas disponible.

	- jjj représente le jour en lettres sur 3 caractères avec la première lettre forcée en minuscule (par exemple lun)
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette notation n'est pas disponible.

	- JJJJ représente le jour en lettres complet (par exemple lundi). La casse utilisée dépend des options linguistiques du projet.

	- Jjjj représente le jour en lettres complet avec la première lettre forcée en majuscule (par exemple Lundi)
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette notation n'est pas disponible.

	- jjjj représente le jour en lettres complet avec la première lettre forcée en minuscule (par exemple lundi)
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette notation n'est pas disponible.

	- L représente la première lettre du jour (par exemple L,M,M,J,V,S,D)
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette notation n'est pas disponible.




- via les constantes suivantes : 
	


|   |   |
| --- | --- |
| *maskDateEmail* | Le format utilisé correspond au format de date de la norme RFC-5322 utilisé pour l'encryption d'un mail, d'un flux RSS, ...<br>Le résultat est exprimé dans le fuseau horaire local. <br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Non disponible. |
| *maskDateEmailUTC* | Le format utilisé correspond au format de date de la norme RFC-5322 utilisé pour l'encryption d'un mail, d'un flux RSS, ...<br>Le résultat est exprimé en temps universel (UTC). <br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Non disponible. |
| *maskDateInternet* | Le format utilisé correspond au format de date de la norme RFC-3339 utilisé pour les communications internationales.<br>Le résultat est exprimé dans le fuseau horaire local. <br><br> |
| *maskDateInternetUTC* | Le format utilisé correspond au format de date de la norme RFC-3339 utilisé pour les communications internationales.<br>Le résultat est exprimé en temps universel (UTC). <br><br><br><br> |
| *maskDateSystème* | Le format utilisé correspond au format défini dans la description du projet pour la langue en cours : <br><br>	1. Sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description". <br><br>	2. Sélectionnez l'onglet "Langues" puis l'onglet "Date". <br><br>	3. Le format utilisé correspond :<br><br>		- soit aux paramètres du système d'exploitation,<br><br>		- soit aux paramètres spécifiés (avec les jours et mois définis).<br><br><br><br><br><br> |




Si ce paramètre n'est pas spécifié, le format utilisé par défaut est JJ/MM/AAAA (JJ + un caractère spécifique + MM + un caractère spécifique + AAAA).  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Cohérence entre la date et le format
<a name="coherence_entre_date_format_ELTPARAGRAPHE000272"></a>Il est nécessaire de vérifier la cohérence entre la &lt;Date&gt; et le &lt;Format&gt; spécifié. Ainsi :

- Si &lt;Date&gt; = "La date de l'inauguration de ce monument était le 10/02 de l'année 1995", le format utilisé doit être le suivant : 
	&lt;Format&gt; = "La date de l'inauguration de ce monument était le JJ/MM de l'année AAAA".

- Si &lt;Date&gt; = "Le 03/11/1970", le format utilisé doit être le suivant : 
	&lt;Format&gt; = "Le JJ/MM/AAAA".





### PHP : Limitation
<a name="php_limitation_ELTPARAGRAPHE000284"></a>Le format avec 9 décimales est supporté uniquement à partir de PHP 8. Exemple : 

```wl
ChaîneVersDate("2019-03-05T07:21:45.123456789+11:00", maskDateInternet)
```



- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LesfonctionsEXIF.gif) ***Exemples unitaires (WINDEV)*** : **Les fonctions EXIF** <br>Utilisation des fonctions ImageXXX.<br>Ces fonctions permettent d'accéder aux informations EXIF d'une image.<br>Les informations EXIF sont contenues dans les images de type JPEG ou TIFF.<br>Il y a par exemple, la date de prise de vue de la photo, l'orientation de l'appareil quand la photo a été prise, la marque et le modèle de l'appareil photo, une miniature de l'image...

<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280std.dll
