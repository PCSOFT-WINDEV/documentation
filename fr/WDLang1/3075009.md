


## TableauInsère (Fonction)

***En anglais : ArrayInsert***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Insère un élément à une position donnée :

- dans un tableau à une dimension.

- dans un tableau associatif.

- dans une propriété tableau d'un type avancé (tableau des événements de gglAgenda, ...).

- dans une liste WLangage. 




Cette fonction permet également de concaténer deux tableaux ou deux listes.

**Remarques** : 

- Cette fonction est équivalente à la fonction [Insère](../WDLang1/1000017351.md).













<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MonTableau est un tableau de 2 chaînes
TableauInsère(MonTableau, 1, "WINDEV")
TableauInsère(MonTableau, 2, "WEBDEV")
TableauInsère(MonTableau, 3, "WINDEV et WEBDEV")
// Afficher le contenu du 3° élément
Trace(MonTableau[3]) // Affiche "WINDEV et WEBDEV"
```
<a name="Exemple2"></a>

```wl
MonTableau est un tableau de 2 chaînes
MonTableau[1] = "WINDEV"
MonTableau[2] = "WEBDEV"
TableauInsère(MonTableau, 3, "WINDEV et WEBDEV")
// Afficher le contenu du 3° élément
Trace(MonTableau[3]) // Affiche "WINDEV et WEBDEV"
```
<a name="Exemple3"></a>

```wl
// Tableau associatif NOM - Prénom
taNomPrenom est un tableau associatif de chaînes
TableauInsère(taNomPrenom, "Moulin", "Françoise")
TableauInsère(taNomPrenom, "Montgomery", "Julie")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Insérer un élément dans un tableau ou dans une propriété tableau d'un type avancé

`TableauInsère(<Tableau WLangage> , <Indice d'insertion> [, <Valeur de l'élément>])`
---

**`<Tableau WLangage> : (Tableau)`**

Nom de la variable de type Tableau à manipuler. Ce tableau doit être un tableau à une dimension.

**`<Indice d'insertion> : (Entier)`**

Indice du tableau où l'élément doit être inséré. Tous les éléments à partir de cet indice seront décalés de 1 élément. 
Si &lt;Indice d'insertion&gt; est égal au nombre d'éléments du tableau +1, l'élément est ajouté à la fin du tableau (équivalent à la fonction [TableauAjoute](../WDLang1/3075003.md)). 
Si &lt;Indice d'insertion&gt; est supérieur au nombre d'éléments du tableau +1, une erreur WLangage est générée.

**`<Valeur de l'élément> : (Tout type, optionnel)`**

Elément à insérer dans le tableau spécifié, à la position indiquée. Si ce paramètre n'est pas spécifié, le tableau est agrandi avec la valeur par défaut du type des autres éléments du tableau.  


<a name="SYNTAXE2"></a>

### Insérer un élément dans un tableau associatif

`TableauInsère(<Tableau WLangage> , <Clé de l'élément> , <Valeur de l'élément>)`
---

**`<Tableau WLangage> : (Tableau)`**

Nom de la variable de type Tableau à manipuler. Ce tableau doit être un tableau à une dimension.

**`<Clé de l'élément> : (Type de la clé du tableau associatif)`**

Valeur de la clé pour laquelle l'élément doit être inséré. Dans un tableau associatif sans doublons, si l'élément existe déjà, une erreur WLangage est affichée.

**`<Valeur de l'élément> : (Tout type)`**

Elément à ajouter au tableau spécifié.  


<a name="SYNTAXE3"></a>

### Insérer un tableau dans un tableau

`TableauInsère(<Tableau WLangage> , <Indice d'insertion> [, <Tableau à insérer>])`
---

**`<Tableau WLangage> : (Tableau)`**

Nom de la variable de type Tableau à manipuler. Ce tableau doit être un tableau à une dimension.

**`<Indice d'insertion> : (Entier)`**

Indice du tableau où l'élément doit être inséré. Tous les éléments à partir de cet indice seront décalés de 1 élément. 
Si &lt;Indice d'insertion&gt; est égal au nombre d'éléments du tableau +1, l'élément est ajouté à la fin du tableau (équivalent à la fonction [TableauAjoute](../WDLang1/3075003.md)). 
Si &lt;Indice d'insertion&gt; est supérieur au nombre d'éléments du tableau +1, une erreur WLangage est générée.

**`<Tableau à insérer> : (Tableau optionnel)`**

Nom de la variable Tableau à insérer à l'indice d'insertion spécifié dans &lt;Tableau WLangage&gt;.  


<a name="SYNTAXE4"></a>

### Insérer un élément dans une liste

`TableauInsère(<Liste WLangage> , <Indice d'insertion> , <Valeur de l'élément>)`
---

**`<Liste WLangage> : (Liste)`**

Nom de la variable de type Liste à manipuler.

**`<Indice d'insertion> : (Constante de type entier)`**

Indice de la liste où l'élément doit être inséré. Les constantes suivantes peuvent être utilisées :


|   |   |
| --- | --- |
| *AprèsElémentCourant* | L'élément est inséré après l'élément courant.<br>Cette constante est disponible uniquement lors du parcours des éléments de la liste.<br>**Attention** : L'élément sera parcouru par l'itération suivante si la boucle est ascendante. |
| *AvantElémentCourant* | L'élément est inséré avant l'élément courant.<br>Cette constante est disponible uniquement lors du parcours des éléments de la liste.<br>**Attention** : L'élément sera parcouru par l'itération suivante si la boucle est descendante. |
| *DernierElément* | L'élément est inséré en fin de liste. |
| *PremierElément* | L'élément est inséré au début de la liste. |



**`<Valeur de l'élément> : (Tout type)`**

Elément à insérer dans la liste à la position indiquée.  


<a name="SYNTAXE5"></a>

### Insérer une liste dans une liste

`TableauInsère(<Liste WLangage> , <Indice d'insertion> , <Liste à insérer>)`
---

**`<Liste WLangage> : (Liste)`**

Nom de la variable de type Liste à manipuler.

**`<Indice d'insertion> : (Constante de type entier)`**

Indice de la liste où la liste doit être insérée. Les constantes suivantes peuvent être utilisées :


|   |   |
| --- | --- |
| *AprèsElémentCourant* | La liste est insérée après l'élément courant.<br>Cette constante est disponible uniquement lors du parcours des éléments de la liste. |
| *AvantElémentCourant* | La liste est insérée avant l'élément courant.<br>Cette constante est disponible uniquement lors du parcours des éléments de la liste. |
| *DernierElément* | La liste est insérée en fin de liste &lt;Nom de la liste&gt;. |
| *PremierElément* | La liste est insérée au début de la liste &lt;Nom de la liste&gt;. |




**`<Liste à insérer> : (Liste)`**

Nom de la liste à insérer à l'indice d'insertion spécifié.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Insertion d'un élément dans un tableau
<a name="insertion_element_dans_tableau_ELTPARAGRAPHE000276"></a>Lors de l'utilisation de la fonction **TableauInsère** :

- le tableau est automatiquement agrandi pour accueillir le nouvel élément.

- l'élément est converti si nécessaire dans le type des autres éléments du tableau.




Lors de la déclaration d'un tableau de N éléments, ce tableau contient N éléments vides. Par exemple, le tableau déclaré ci-dessous contient 3 chaînes vides.

```wl
MonTableau est un tableau de 3 chaînes
```
Lors de l'insertion d'un élément (fonction **TableauInsère**), cet élément est automatiquement inséré parmi les éléments déjà présents dans le tableau.

Dans notre exemple, après l'insertion d'un élément, le tableau contiendra 4 éléments.
<a name="NOTE0_2"></a>


### Ajout d'un élément dans une propriété tableau d'un type avancé
<a name="ajout_element_dans_une_propriete_tableau_type_avance_ELTPARAGRAPHE000300"></a>Lors de l'utilisation de la fonction **TableauInsère** :

- la variable de type avancé doit être allouée.

- le type avancé doit avoir un énumérateur de type collection modifiable.

- le type avancé est automatiquement agrandi pour accueillir les nouveaux éléments.

- l'élément est initialisé avec la valeur passée en paramètre. Si aucune valeur n'est passée en paramètre, l'élément est initialisé avec la valeur par défaut du type des éléments du tableau.



<a name="NOTE0_3"></a>


### Insertion d'un élément dans une liste
<a name="insertion_element_dans_une_liste_ELTPARAGRAPHE000317"></a>Lors de l'utilisation de la fonction **TableauInsère** :

- la liste est automatiquement agrandie pour accueillir le nouvel élément.

- l'élément est converti si nécessaire dans le type des autres éléments de la liste.



<a name="NOTE0_4"></a>


### Insertion d'un tableau
<a name="insertion_tableau_ELTPARAGRAPHE000336"></a>Lors de l'utilisation de la fonction **TableauInsère** :

- le tableau est automatiquement agrandi pour accueillir les nouveaux éléments. Les éléments du &lt;Nom du tableau à insérer&gt; sont ajoutés à la position spécifiée dans &lt;Nom du tableau&gt;.

- les deux tableaux doivent être du même type.

- la dimension des tableaux doit être identique.

- les valeurs des dimensions des tableaux (à l'exception de la première) doivent être identiques.



<a name="NOTE0_5"></a>


### Insertion d'une liste
<a name="insertion_une_liste_ELTPARAGRAPHE000353"></a>Lors de l'utilisation de la fonction **TableauInsère** :

- la liste est automatiquement agrandie pour accueillir les nouveaux éléments. Les éléments du &lt;Nom de la liste à insérer&gt; sont ajoutés à la position spécifiée.

- les deux listes doivent être du même type.



<a name="NOTE0_6"></a>


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000372"></a>Cette fonction peut être utilisée avec des structures. Dans ce cas, il faut :

1. Déclarer une variable du type de la structure.

2. Initialiser chaque membre.

3. Passer la variable structure en paramètre à la fonction **TableauInsère**.




Cette fonction ne peut pas être utilisée sur :

- les tableaux non alloués

- les tableaux fixes.



<a name="NOTE0_7"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000393"></a>

- Pour ajouter un élément à la fin d'un tableau à une dimension, utilisez la fonction [TableauAjoute](../WDLang1/3075003.md) ou la fonction [Ajoute](../WDLang1/1000017348.md).

- Pour ajouter un élément dans un tableau trié (en respectant le tri), utilisez la fonction [TableauAjouteTrié](../WDLang1/1000017013.md).




<a name="XComposante"></a>

## Composante :
wd280vm.dll
