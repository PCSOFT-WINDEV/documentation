
## USBDétecteStockageAmovible (Fonction)

***En anglais : USBDetectRemovableStorage***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Détecte si une unité de stockage amovible (par exemple CD, clé USB, appareil photo USB, ...) a été ajoutée ou enlevée.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
SI USBDétecteStockageAmovible("ProcédureUSB") = Faux ALORS
	Erreur(ErreurInfo())
FIN
```

```wl
// ----------------------------------------
PROCEDURE ProcédureUSB(Lettre, Action)
SI Action = StockageAmovibleInséré ALORS
	Info(Lettre + ": Inséré")
SINON
	Info(Lettre + ": Ejecté")
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = USBDétecteStockageAmovible(<Procédure WLangage>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la détection a été effectuée. 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. 




**`<Procédure WLangage> : (Nom de procédure)`**



- Nom de la procédure WLangage à exécuter lors de la détection, 

- Chaîne vide ("") pour désactiver la détection. 




Cette procédure est appelée à chaque fois qu'une unité de stockage est insérée ou éjectée.

Cette procédure est de la forme :

```txt
PROCEDURE <Procédure WLangage>(<Lettre du lecteur>, <Type d'action>)
```


Le paramètre &lt;Lettre du lecteur&gt; est une chaîne, permettant de connaître la lettre du lecteur associée à l'unité de stockage. 
Remarque : Si l'unité de stockage provoque l'apparition de plusieurs lettres de lecteurs, celles-ci seront séparées par des tabulations (&lt;Lettre lecteur 1&gt; + TAB + &lt;Lettre lecteur 2&gt; + ... + TAB + &lt;Lettre lecteur N&gt;).

La paramètre &lt;Type d'action&gt; est une constante de type entier permettant de savoir si le périphérique a été inséré ou éjecté. Ce paramètre peut prendre pour valeur :


|   |   |
| --- | --- |
| *StockageAmovibleInséré* | Une unité de stockage amovible a été insérée. |
| *StockageAmovibleRetiré* | Une unité de stockage amovible a été éjectée. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Appels multiples de la fonction USBDétecteStockageAmovible
<a name="appels_multiples_fonction_usbdetectestockageamovible_ELTPARAGRAPHE000065"></a>Si cette fonction est exécutée plusieurs fois avec des procédures différentes passées en paramètres, la dernière procédure utilisée remplacera toutes les procédures appelées auparavant : les premières procédures ne seront plus rappelées.


<a name="NOTE0_2"></a>


### Procédure locale à la fenêtre
<a name="procedure_locale_fenetre_ELTPARAGRAPHE000073"></a>Si la procédure WLangage est une procédure locale à une fenêtre, la détection prendra fin lorsque la fenêtre sera fermée. Il est conseillé d'utiliser une procédure globale.


<a name="NOTE0_3"></a>




### Limitations
<a name="limitations_ELTPARAGRAPHE000082"></a>La fonction **USBDétecteStockageAmovible** ne doit pas être exécutée depuis un thread secondaire.


<a name="NOTE0_4"></a>




### Equivalence
<a name="equivalence_ELTPARAGRAPHE000094"></a>La fonction **USBDétecteStockageAmovible** est équivalente à la fonction [fDétecteStockageAmovible](../WDLang1/3036061.md).



<a name="XComposante"></a>

## Composante :
wd280std.dll
