


## TableSupprimeAvecAnimation (Fonction)

***En anglais : TableDeleteWithAnimation***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Supprime une ligne dans un champ Table, un champ Table hiérarchique (ou une table affichée dans un champ Combo) avec une animation. La durée de cette animation est paramétrable :

- dans l'onglet "Style" de la fenêtre de description du champ Table : 

	- Dans l'onglet "Style", sélectionnez l'élément "Animation de champ".

	- Dans la liste des animations, sélectionnez "Modification par TableXXXAvecAnimation()" et cliquez sur le bouton "Paramètres".  




- dans la fenêtre de description du projet :

	- Dans l'onglet "Avancé", cliquez sur le bouton "Animations des champs". 

	- Dans la zone "Champ table et zone répétée", sélectionnez "Modification par TableXXXAvecAnimation()" et cliquez sur le bouton "Paramètres".







Remarque : Cette fonction est identique à la fonction [TableSupprime](../WDLang1/3074032.md). La seule différence est la gestion de l'animation.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Suppression de la ligne 5 dans le champ "TABLE_Produit"
TableSupprimeAvecAnimation(TABLE_Produit, 5)
```


<a name="Exemple2"></a>

```wl
// Supprimer toutes les lignes sélectionnées dans un champ Table
i est un entier
NbSelection est un entier = TableSelectOccurrence(TABLE_MaTable)
POUR i = NbSelection A 1 PAS -1
	TableSupprimeAvecAnimation(TABLE_MaTable, TableSelect(TABLE_MaTable, i))
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`TableSupprimeAvecAnimation(<Champ Table> [, <Indice>])`
---

**`<Champ Table> : (Nom de champ)`**

Nom du champ à manipuler. Ce champ peut correspondre à : 

- un champ Table.

- un champ Table hiérarchique. 

- un champ Combo avec table.


Si ce paramètre correspond à une chaîne vide (""), le champ Table manipulé sera celui auquel appartient l'événement en cours.

**`<Indice> : (Entier optionnel)`**

Indice de la ligne à supprimer. 
Si ce paramètre n'est pas précisé, la ou les lignes sélectionnées sont supprimées. Si ce paramètre n'est pas précisé et si aucune ligne n'est sélectionnée, la fonction **TableSupprimeAvecAnimation** n'a aucun effet.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000096"></a>La fonction **TableSupprimeAvecAnimation** peut être utilisée sur :

- un champ Table ou Table hiérarchique fichier.

- un champ Table ou Table hiérarchique par programmation.

- un champ monosélection ou multisélection. 




L'animation n'est pas jouée dans les cas suivants : 

- si les animations sont désactivées (fonction [AnimationActive](../WDLang1/1000017399.md)).

- si la fonction est utilisée dans les événements suivants de la fenêtre : "Déclarations globales", "Fin d'initialisation" ou "Fermeture". 

- si l'application est en mode TSE. 

- si la suppression est effectuée en dehors de la zone visible (en-dessous ou au-dessus). Dans ce cas, la suppression est réalisée et la fonction rend la main immédiatement.


La fonction ne rend la main qu'à la fin de l'animation.
<a name="NOTE0_2"></a>


### Suppression dans un champ Table ou Table hiérarchique fichier
<a name="suppression_dans_champ_table_table_hierarchique_fichier_ELTPARAGRAPHE000124"></a>La fonction **TableSupprimeAvecAnimation** supprime l'enregistrement correspondant dans le fichier de données associé au champ. Si des rubriques sont reliées à d'autres fichiers de données, aucune modification n'est effectuée automatiquement sur ces fichiers de données liés.
<a name="NOTE0_3"></a>


### Intégrité référentielle et champ Table ou Table hiérarchique fichier
<a name="integrite_referentielle_champ_table_table_hierarchique_fichier_ELTPARAGRAPHE000136"></a>Si la gestion de l'intégrité référentielle est active (fonction [HGèreIntégrité](../WDLang4/3044058.md)), testez la fonction [HErreurIntégrité](../WDLang4/3044086.md) après l'appel de la fonction **TableSupprimeAvecAnimation** pour vérifier l'intégrité.

Si une erreur d'intégrité est détectée, la ligne n'est pas supprimée et reste visible dans le champ.
<a name="NOTE0_4"></a>


### Suppression dans un champ Table fichier et Trigger
<a name="suppression_dans_champ_table_fichier_trigger_ELTPARAGRAPHE000156"></a>Il est possible de déclencher un trigger lors de la suppression d'un enregistrement dans un champ Table fichier. Pour plus de détails, consultez la documentation de la fonction [HDécritTrigger](../WDLang4/3044074.md).
<a name="NOTE0_5"></a>


### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000168"></a>En cas d'échec de la suppression, la variable [ErreurDétectée](../WDLang1/3087001.md) est à <u><u><u><u>Vrai</u></u></u></u>. Pour plus de détails sur l'erreur, il est possible d'utiliser la fonction [ErreurInfo](../WDLang1/3013008.md).  

Exemple de cas d'erreur : Suppression d'une ligne dont l'indice correspond à une ligne non sélectionnée dans la partie visible du champ Table.
<a name="NOTE0_6"></a>


### Blocage du fichier de données lié
<a name="blocage_fichier_donnees_lie_ELTPARAGRAPHE000189"></a>Si le fichier de données est bloqué dans le traitement en cours, la fonction **TableSupprimeAvecAnimation** supprime la ligne spécifiée et débloque le fichier de données.
<a name="NOTE0_7"></a>


### Suppression dans un champ Table par programmation avec un filtre de type "Contient"
<a name="suppression_dans_champ_table_par_programmation_avec_filtre_type_contient_ELTPARAGRAPHE000201"></a>La fonction **TableSupprimeAvecAnimation** utilisée sur un champ Table par programmation utilisant un filtre de type "Contient" fait apparaître des enregistrements qui ne correspondent pas au filtre. Les filtres définis par les FAA (Fonctionnalités Automatiques de vos Applications) sont annulés. 

<a name="XComposante"></a>

## Composante :
wd280obj.dll
