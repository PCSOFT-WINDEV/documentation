


## RTFSélection (Fonction)

***En anglais : RTFSelection***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Change ou liste les attributs du texte actuellement sélectionné dans un champ RTF (d'une fenêtre ou d'un état WINDEV). Il est également possible d'utiliser cette fonction sur une chaîne de caractères contenant du texte au format RTF.

**Remarque** : Dans une fenêtre, le texte peut être sélectionné par l'utilisateur ou par programmation avec les propriétés [Curseur](../Proprietes/2510025.md) et [FinCurseur](../Proprietes/2510047.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Passe la sélection en Arial
RTFSélection(SAI_Saisie1,rtfNomPolice, "Arial")
// Passe la sélection police de taille 12
RTFSélection(SAI_Saisie1, rtfTaillePolice, 12)
// Passe la sélection en gras
RTFSélection(SAI_Saisie1, rtfGras, Vrai)
// Modifie la couleur de la sélection
RTFSélection(SAI_Saisie1, rtfCouleur, RVB(134, 345, 255))
// Si la sélection contient des valeurs diverses
SI RTFSélection(SAI_Saisie1, rtfGras) = "" ALORS
	// On passe tout en gras
	RTFSélection(SAI_Saisie1, rtfGras, Vrai)
SINON
	// On inverse l'état
	bGras est un booléen = RTFSélection(SAI_Saisie1, rtfGras)
	RTFSélection(SAI_Saisie1, rtfGras, PAS bGras)
FIN
```
<a name="Exemple2"></a>

```wl
// Passer tous les "WINDEV" d'un texte en rouge souligné
I est un entier
I = RTFRecherche(SAI_Saisie1, "WINDEV")
TANTQUE I > 0
	// Passage en rouge
	RTFSélection(SAI_Saisie1, rtfCouleur, RougeClair, I, 6)
	// Passage en souligné
	RTFSélection(SAI_Saisie1, rtfSouligné, Vrai, I, 6)
	// Recherche du suivant "WINDEV"
	I = RTFRecherche(SAI_Saisie1, "WINDEV", rtfSensibleCasse, I + 1)
FIN
```
<a name="Exemple3"></a>

```wl
// Transformation d'un texte RTF
MonTexte est une chaîne
MonTexteRTF est une chaîne
MonTexte = "Texte sans mise en forme provenant d'une chaîne de caractères du WLangage"
MonTexteRTF = RTFSélection(MonTexte, rtfGras, Vrai, 1, Taille(MonTexte))
SAI_SaisieRTF = MonTexteRTF
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Sélection dans un champ RTF

`<Résultat> = RTFSélection(<Champ RTF> , <Attribut> [, <Nouvelle valeur> [, <Début> [, <Taille>]]])`
---

**`<Résultat> : (Chaîne de caractères, entier, booléen)`**



- Ancienne valeur de l'attribut. Le type dépend de l'attribut spécifié.

- Chaîne vide ("") si la sélection contient différentes versions du même attribut (sélection en gras et non gras par exemple).




**`<Champ RTF> : (Nom de champ)`**

Nom du champ de type RTF.

**`<Attribut> : (Constante)`**

Attribut à récupérer ou à modifier :


|   |   |
| --- | --- |
| *rtfAlignement* | Alignement du ou des paragraphes sélectionnés. Valeurs possibles :<br><br>- *chGauche* : à gauche.<br><br>- *chDroite* : à droite.<br><br>- *chCentre* : au centre.<br><br>- *chJustifié* : justifié.<br><br><br> |
| *rtfBarré* | Caractères barrés (type de l'attribut : Booléen). |
| *rtfCouleur* | Couleur du texte (type de l'attribut : Entier). |
| *rtfCouleurFond* | Couleur de fond du texte (type de l'attribut : Entier). |
| *rtfGras* | Caractères en gras (type de l'attribut : Booléen). |
| *rtfItalique* | Caractères en italique (type de l'attribut : Booléen). |
| *rtfNomPolice* | Nom de la police utilisée (type de l'attribut : Chaîne de caractères). |
| *rtfSouligné* | Caractères soulignés (type de l'attribut : Booléen). |
| *rtfTaillePolice* | Taille de la police de caractères (en pixels) (type de l'attribut : Entier). |



**`<Nouvelle valeur> : (Chaîne de caractères, entier, booléen (optionnel))`**

Dans le cas d'une modification, nouvelle valeur de l'attribut spécifié.

**`<Début> : (Entier optionnel)`**

Position du caractère à partir duquel la récupération ou le changement du type de l'attribut doit être effectué. Si ce paramètre n'est pas spécifié, l'attribut du texte actuellement sélectionné dans le champ de saisie est récupéré ou changé.

**`<Taille> : (Entier optionnel)`**

Nombre de caractères dont on veut connaître ou modifier le type de l'attribut. Si ce paramètre n'est pas spécifié, l'attribut du texte actuellement sélectionné dans le champ de saisie est récupéré ou changé.


<a name="SYNTAXE2"></a>

### Sélection dans une chaîne RTF

`<Résultat> = RTFSélection(<Chaîne RTF> , <Attribut> , <Nouvelle valeur> , <Début> , <Taille>)`
---

**`<Résultat> : (Chaîne de caractères)`**

Nouvelle chaîne de caractères dans laquelle les différents changements ont été effectués. La chaîne initiale n'est pas modifiée.

**`<Chaîne RTF> : (Chaîne de caractères)`**

Chaîne de caractères au format RTF.

**`<Attribut> : (Constante)`**

Attribut à récupérer ou à modifier :


|   |   |
| --- | --- |
| *rtfAlignement* | Alignement du ou des paragraphes sélectionnés. Valeurs possibles :<br><br>- *chGauche* : à gauche.<br><br>- *chDroite* : à droite.<br><br>- *chCentre* : au centre.<br><br>- *chJustifié* : justifié.<br><br><br> |
| *rtfBarré* | Caractères barrés (type de l'attribut : Booléen). |
| *rtfCouleur* | Couleur du texte (type de l'attribut : Entier). |
| *rtfCouleurFond* | Couleur de fond du texte (type de l'attribut : Entier). |
| *rtfGras* | Caractères en gras (type de l'attribut : Booléen). |
| *rtfItalique* | Caractères en italique (type de l'attribut : Booléen) |
| *rtfNomPolice* | Nom de la police utilisée (type de l'attribut : Chaîne de caractères). |
| *rtfSouligné* | Caractères soulignés (type de l'attribut : Booléen). |
| *rtfTaillePolice* | Taille de la police de caractères (en pixels) (type de l'attribut : Entier). |



**`<Nouvelle valeur> : (Chaîne de caractères, entier, booléen)`**

Dans le cas d'une modification, nouvelle valeur de l'attribut spécifié.

**`<Début> : (Entier)`**

Position du caractère à partir duquel la récupération ou le changement du type de l'attribut doit être effectué. Attention : Cette position ne prend pas en compte les balises RTF. 

**`<Taille> : (Entier)`**

Nombre de caractères dont on veut connaître ou modifier le type de l'attribut.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Colonne de table
<a name="colonne_table_ELTPARAGRAPHE000153"></a>La fonction **RTFSélection** permet de modifier la sélection de la cellule en cours de saisie. Il n'est pas possible de modifier une autre cellule.

Le code suivant provoque une erreur :

```wl
RTFSélection({ChampEnCours()}[TableSelect(TABLE_Table1)], rtfCouleur, GrisClair)
```
Le code à utiliser est le suivant :

```wl
RTFSélection({ChampEnCours()}, rtfCouleur, GrisClair)
```

<a name="NOTE0_2"></a>


### Attribut rtfCouleur
<a name="attribut_rtfcouleur_ELTPARAGRAPHE000168"></a>L'attribut *rtfCouleur* peut renvoyer ou recevoir la valeur *CouleurDéfaut* : la couleur du texte dépend alors des paramètres de couleurs définis dans le panneau de configuration de Windows.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
