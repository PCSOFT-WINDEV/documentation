


## ExeInfo (Fonction)

***En anglais : ExeInfo***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère les informations spécifiées sur la version d'un exécutable ou d'une DLL.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
VersionProg est une chaîne
VersionProg = ExeInfo(exeVersion, "Appli.exe")
SI VersionProg <> "2.0A" ALORS
	Erreur("La version du programme installé n'est pas la bonne")
FIN
```
<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Récupérer le nom de l'application (sans le chemin complet)
NomProg = ExeInfo("OriginalFilename", "Appli.exe")
// L'exécutable n'a pas été renommé
NomProg = fExtraitChemin(ExeInfo(exeNom), fFichier + fExtension)
```
<a name="Exemple3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
sRepExe est une chaîne 
SI EnModeTest() = Vrai ALORS 
	// En mode test on renvoie le répertoire d'exécution
	sRepExe = fRepEnCours()
SINON
	sRepExe = ExeInfo(exeRépertoire)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ExeInfo(<Mot-clé> [, <Nom de l'exécutable>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Information demandée. 

- Chaîne vide ("") s'il n'y a pas d'information ou si la fonction a échoué.




**`<Mot-clé> : (Constante de type chaîne)`**

Information à récupérer : 


|   |   |
| --- | --- |
| *exeCopyright* | Copyright du programme<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *exeDescription* | Description accompagnant le programme<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Version du JRE (Java Runtime Environment) avec laquelle l'application en cours est exécutée.![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible.![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante ne fonctionne qu'avec les libraires ou exécutables PC SOFT. |
|   | Si cette constante est spécifiée, &lt;Résultat&gt; peut correspondre à :<br><br>- chaîne vide ("") si l'application a été lancée manuellement par l'utilisateur.<br><br>- la constante *exeNotificationPush* si l'application a été lancée automatiquement par le système suite à la réception d'une notification push.<br><br>- la constante *exeEnArrièrePlan* si l'application a été lancée en arrière-plan (détection d'un groupe de Beacons ou lors du suivi de géolocalisation). <br><br>- la constante *exeGéoSuivi* si l'application a été lancée en arrière-plan lors de la gestion de suivi de géolocalisation. Pour plus de détails, consultez [Suivi de géolocalisation](../WDLang3/1000019277.md).<br>	Cette constante est conservée par compatibilité à partir de la version 230050. Elle est équivalente à la constante *exeEnArrièrePlan*. <br><br><br> |
| *exeMode* | Mode du programme : compilé en 16, 32 ou 64 bits, programme DOS, etc.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible.![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante renvoie une chaîne vide (""). |
| *exeNom* | Nom et chemin complet de l'exécutable.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Nom de l'archive java de l'application en cours d'exécution.<br>Attention : Ce nom ne correspond pas au nom du package de l'application. |
| *exeRépertoire* | Répertoire de l'exécutable (sans le \\ final, mais avec les ":")<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *exeSociété* | Nom saisi pour la société lors de la création de l'exécutable.<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |
| *exeVersion* | Version du module spécifié. <br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante ne fonctionne qu'avec les libraires ou exécutables PC SOFT.![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Numéro de version de l'application.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |
| *exeVersionFormatWindows* | Version du module spécifié au format standard Windows (par exemple "14.0.204.98"). <br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |



**`<Nom de l'exécutable> : (Chaîne de caractères optionnelle)`**

Nom et chemin complet (ou relatif) de l'exécutable ou du module manipulé (260 caractères maximum). Si ce paramètre n'est pas précisé, l'exécutable en cours est manipulé.



![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre ne doit pas être indiqué.

![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Ce paramètre est obligatoire.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Mode d'exécution du programme
<a name="mode_execution_programme_ELTPARAGRAPHE000233"></a>Pour connaître le mode d'exécution du programme, utilisez la constante *exeMode* :

```wl
ModeProg = ExeInfo(ExeMode)
```
Le résultat de la fonction peut alors correspondre à :

- "16" si le programme Windows est compilé en 16 bits,

- "32" si le programme Windows est compilé en 32 bits,

- "64" si le programme Windows est compilé en 64 bits,

- "DOS" si le programme est un programme DOS,

- une chaîne vide ("") si le programme n'est pas un exécutable.



<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Mots-clé de la fonction API "VerQueryValue"
<a name="motscle_fonction_api_verqueryvalue_ELTPARAGRAPHE000250"></a>Il est possible de remplacer le paramètre &lt;Mot-clé&gt; par un des mots-clés utilisé par la fonction API "VerQueryValue" :

"Comments" "LegalTrademarks"

"CompanyName" "OriginalFilename"

"FileDescription" "PrivateBuild"

"FileVersion" "ProductName"

"InternalName" "ProductVersion"

"LegalCopyright" "SpecialBuild"
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Exécution de la fonction en mode test sous Windows
<a name="execution_fonction_mode_test_sous_windows_ELTPARAGRAPHE000271"></a>Lors de l'exécution de la fonction **ExeInfo** en mode test depuis WINDEV, les informations données sur l'exécutable en cours sont celles concernant "WDTst", le moteur de test de WINDEV (présent dans le sous-répertoire "Programmes" du répertoire d'installation de WINDEV).

<a name="XComposante"></a>

## Composante :
wd280std.dll
