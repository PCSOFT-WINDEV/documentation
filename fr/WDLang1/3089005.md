
## PlanificateurEtatTâche (Fonction)

***En anglais : SchedulerTaskStatus***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Récupère ou modifie l'état d'une tâche créée dans le planificateur de tâches Windows.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// L'interrupteur INT_ActiveTâche est coché si la tâche doit être activée
SI INT_ActiveTâche = Vrai ALORS
	// Activation de la tâche
	PlanificateurEtatTâche("MaTache", tâchePlanifiéeActive)
SINON
	// Désactivation de la tâche
	PlanificateurEtatTâche("MaTache", tâchePlanifiéeDésactive)
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Connaître l'état d'une tâche

`<Résultat> = PlanificateurEtatTâche(<Nom de la tâche>)`
---

**`<Résultat> : (Constante de type Entier)`**

État de la tâche spécifiée :


|   |   |
| --- | --- |
| *tâchePlanifiéeAucunHoraire* | La tâche n'a aucun horaire ou les horaires de la tâche sont tous invalides ou inactifs. |
| *tâchePlanifiéeDésactivée* | La tâche est désactivée (elle ne sera jamais exécutée jusqu'à sa ré-activation). |
| *tâchePlanifiéeErreur* | La tâche spécifiée n'existe pas. |
| *tâchePlanifiéeExécution* | La tâche planifiée est en cours d'exécution. |
| *tâchePlanifiéeNonPlanifiée* | Les propriétés de la tâche ne permettent pas de l'exécuter. |
| *tâchePlanifiéePasExécutée* | La tâche n'a pas encore été exécutée. |
| *tâchePlanifiéePlusExécutée* | La tâche n'a plus d'exécutions planifiées. |
| *tâchePlanifiéePrête* | La tâche est prête à être exécutée, en attente dans le planificateur. |
| *tâchePlanifiéeTerminée* | La dernière exécution de la tâche a été terminée par l'utilisateur. |


Avant la première exécution de la tâche, &lt;Résultat&gt; vaut *tâchePlanifiéePasExécutée*. 
Pendant l'exécution de la tâche, &lt;Résultat&gt; vaut *tâchePlanifiéeExécution*. 
Après l'exécution de la tâche, &lt;Résultat&gt; vaut *tâchePlanifiéePrête*.

**`<Nom de la tâche> : (Chaîne de caractères)`**

Nom de la tâche à manipuler. Cette tâche a été créée avec la fonction [PlanificateurAjouteTâche](../WDLang1/3089003.md).  


<a name="SYNTAXE2"></a>

### Modifier l'état d'une tâche

`<Résultat> = PlanificateurEtatTâche(<Nom de la tâche> , <Action>)`
---

**`<Résultat> : (Constante de type Entier)`**

Nouvel état de la tâche spécifiée :


|   |   |
| --- | --- |
| *tâchePlanifiéeAucunHoraire* | La tâche n'a aucun horaire ou les horaires de la tâche sont tous invalides ou inactifs. |
| *tâchePlanifiéeDésactivée* | La tâche est désactivée (elle ne sera jamais exécutée jusqu'à sa ré-activation). |
| *tâchePlanifiéeErreur* | La tâche spécifiée n'existe pas. |
| *tâchePlanifiéeExécution* | La tâche planifiée est en cours d'exécution. |
| *tâchePlanifiéeNonPlanifiée* | Les propriétés de la tâche ne permettent pas de l'exécuter. |
| *tâchePlanifiéePasExécutée* | La tâche n'a pas encore été exécutée. |
| *tâchePlanifiéePlusExécutée* | La tâche n'a plus d'exécutions planifiées. |
| *tâchePlanifiéePrête* | La tâche est prête à être exécutée, en attente dans le planificateur. |
| *tâchePlanifiéeTerminée* | La dernière exécution de la tâche a été terminée par l'utilisateur. |



**`<Nom de la tâche> : (Chaîne de caractères)`**

Nom de la tâche à manipuler. Cette tâche a été créée avec la fonction [PlanificateurAjouteTâche](../WDLang1/3089003.md).

**`<Action> : (Constante de type Entier)`**

Action à effectuer sur la tâche spécifiée :


|   |   |
| --- | --- |
| *tâchePlanifiéeActive* | Active la tâche spécifiée. |
| *tâchePlanifiéeDésactive* | Désactive la tâche spécifiée. |
| *tâchePlanifiéeExécute* | Exécute immédiatement la tâche indépendamment de sa planification. <br>Remarque : Cette action est asynchrone : la tâche ne sera probablement pas encore en exécution à la fin de l'appel de la fonction **PlanificateurEtatTâche**. |
| *tâchePlanifiéeTermine* | Si la tâche est dans l'état *tâchePlanifiéeExécution*, termine son exécution. <br>Remarque : Cette action est asynchrone : la tâche ne sera probablement pas encore terminée à la fin de l'appel de la fonction **PlanificateurEtatTâche**. |


Avant la première exécution de la tâche, &lt;Résultat&gt; vaut *tâchePlanifiéePasExécutée*. 
Pendant l'exécution de la tâche, &lt;Résultat&gt; vaut *tâchePlanifiéeExécution*. Après, &lt;Résultat&gt; vaut *tâchePlanifiéePrête*.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>


<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280std.dll
