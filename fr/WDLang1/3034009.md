
## ErreurChangeParamètre (Fonction)

***En anglais : ErrorChangeParameter***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Paramètre le comportement automatique à adopter en cas d'erreur dans le traitement en cours. Le comportement précédent pourra être retrouvé grâce à la fonction [ErreurRestaureParamètre](../WDLang1/3034012.md).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Initialise la connexion à la base HFSQL Client/Serveur
// Renvoie Vrai si tout s'est bien passé, Faux sinon
PROCEDURE InitialiseConnexion()
// En cas d'erreur, on sort en renvoyant Faux
ErreurChangeParamètre(epRenvoyer, Faux)
// Description de la connexion
HDécritConnexion("Connexion", "utilisateur", "mot de passe", ...
	"serveur", "base de données", hAccèsHFClientServeur)
// Ouverture de la connexion
HOuvreConnexion("Connexion")
// OK
RENVOYER Vrai 

// Code remplacé
// Initialise la connexion à la base HFSQL Client/Serveur
// Renvoie Vrai si tout s'est bien passé, Faux sinon
// PROCEDURE InitialiseConnexion()
// Description de la connexion
// SI HDécritConnexion("Connexion", "utilisateur", "mot de passe", ...
// 	"serveur", "base de données", hAccèsHFClientServeur) = Faux ALORS
// RENVOYER Faux
// FIN

// Ouverture de la connexion
// SI HOuvreConnexion("Connexion") = Faux ALORS
//	RENVOYER Faux
// FIN

//  OK
// RENVOYER Vrai
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`ErreurChangeParamètre(<Comportement à adopter> [, <Paramètre 1> [, <Paramètre 2>]])`
---

**`<Comportement à adopter> : (Constante de type entier)`**

Comportement à adopter :  


|   |   |
| --- | --- |
| *epAfficheMessage* | Affiche le message d'erreur dans une fenêtre en proposant à l'utilisateur les choix Réessayer, Annuler et Arrêter.<br><br> |
| *epAfficheMessageFinProgramme* | Affiche le message d'erreur dans une fenêtre en proposant à l'utilisateur les choix Arrêter et Relancer l'application (Arrêter par défaut).<br><br> |
| *epAfficheMessageFinTraitement* | Affiche le message d'erreur dans une fenêtre en proposant à l'utilisateur les choix Annuler et Arrêter.<br><br> |
| *epAfficheMessageRelanceProgramme* | Affiche le message d'erreur dans une fenêtre en proposant à l'utilisateur les choix Arrêter et Relancer l'application (Relancer par défaut).<br><br> |
| *epCode* | Mode actuel : l'erreur est traitée par programmation (test de la valeur de retour des fonctions, utilisation de [ErreurDétectée](../WDLang1/3087001.md), ...) |
| *epExécuteProcédure* | Exécute la procédure indiquée en paramètre. Cette procédure doit renvoyer une des constantes suivantes :<br><br>- *opAnnuler* : la fonction entraîne une erreur dans le code d'appel de la procédure.<br><br>- *opFinTraitement* : l'erreur est validée et l'utilisateur reprend la main<br><br>- *opFinProgramme* (par défaut) : l'application est arrêtée.<br><br>- *opRéessayer* : réessaye l'instruction<br><br>- *opRelanceProgramme* : arrête et relance l'application.<br><br><br> |
| *epGotoCasErreur* | Exécute le code défini par l'étiquette : CAS ERREUR: |
| *epRenvoyer* | Valide les erreurs. Sort du traitement en cours en renvoyant la valeur indiquée (&lt;Paramètre1&gt; contient la valeur à renvoyer). |
| *epRenvoyerErreur* | Valide les erreurs. Sort du traitement en cours en renvoyant la valeur indiquée (&lt;Paramètre1&gt; contient la valeur à renvoyer) et en propageant l'erreur.<br><br>L'erreur est alors traitée par le niveau supérieur de manière automatique (si le traitement d'erreur est activé) ou grâce à un SI PAS xxx ou un SI [ErreurDétectée](../WDLang1/3087001.md).<br><br>&lt;Paramètre2&gt; contient n messages d'erreur supplémentaire. |
| *epRetour* | Valide les erreurs. Sort du traitement en cours.<br><br>Si la gestion automatique des erreurs est activée dans le code appelant, l'erreur n'est pas remontée. |
| *epRetourErreur* | Valide les erreurs. Sort du traitement en cours en propageant l'erreur.<br><br>L'erreur est alors traitée par le niveau supérieur de manière automatique (si le traitement d'erreur est activé) ou grâce à un SI PAS xxx ou un SI [ErreurDétectée](../WDLang1/3087001.md). Si la gestion automatique des erreurs est activée dans le code appelant, l'erreur est remontée. |





Il est possible de combiner ces constantes avec la constante *epAfficheMessage* : dans ce cas, le message d'erreur sera affiché avant d'exécuter le comportement indiqué.

**`<Paramètre 1> : (Paramètre optionnel)`**

Paramètre optionnel dépendant du comportement choisi.

**`<Paramètre 2> : (Paramètre optionnel)`**

Paramètre optionnel dépendant du comportement choisi.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Comment obtenir des informations sur l'erreur traitée ? 
<a name="comment_obtenir_des_informations_sur_erreur_traitee_ELTPARAGRAPHE000158"></a>La fonction [ErreurInfo](../WDLang1/3013008.md) permet de récupérer les informations de l'erreur.


<a name="NOTE0_2"></a>




### Cas particulier
<a name="cas_particulier_ELTPARAGRAPHE000170"></a>Le mécanisme de traitement de l'erreur, qu'il soit automatique (géré par la [fenêtre de gestion des erreurs](../WDLang1/3034010.md)) ou par programmation (fonction **ErreurChangeParamètre**) ne se déclenche pas si la fonction WLangage ou la procédure utilisateur se trouve dans un des cas suivants :


```txt
SI PAS <Fonction ou procédure> ALORS
	// traitement de l'erreur
FIN
```



```txt
<Fonction ou procédure>
SI ErreurDétectée = Vrai ALORS
	// traitement de l'erreur
FIN
```


Le mécanisme considère alors que l'erreur est traitée par programmation et ne déclenche pas le traitement automatique.



<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280vm.dll
