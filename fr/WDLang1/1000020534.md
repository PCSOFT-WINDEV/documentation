


## TCDCalculeMiseAJour (Fonction)

***En anglais : PVTCalculateUpdate***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Met à jour une partie des données d'un champ Tableau croisé dynamique à partir d'une date. 

**Remarques** : 

- Le contenu du champ Tableau croisé dynamique a préalablement été chargé en mémoire par la fonction [TCDCharge](../WDLang1/1000020507.md). 

- Le champ Tableau dynamique possède une colonne, une ligne ou un filtre d'affichage de type date. 



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Construit le nom du fichier
sFichier = SysRep(srAppData) + ["\"] + "StatsParPays.tcd"

// Le fichier existe ?
SI fFichierExiste(sFichier) ALORS
	// Oui, on le charge 
	TCDCharge(TCD_Statistiques, sFichier)
	// On met à jour le champ Tableau croisé dynamique à partir de la dernière date du calcul
	// (on suppose que les enregistrements associés à une date antérieure
	// n'ont pas été modifiés)
	TCDCalculeMiseAJour(TCD_Statistiques, ChargeParamètre(DATE_DERNIER_CALCUL))
SINON
	// Le fichier n'existe pas, on le calcule
	TCDCalculeTout(TCD_Statistiques)
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`TCDCalculeMiseAJour(<Champ Tableau croisé dynamique> [, <Date de départ>])`
---

**`<Champ Tableau croisé dynamique> : (Nom de champ)`**

Nom du champ Tableau croisé dynamique à manipuler.

**`<Date de départ> : (Chaîne de caractères ou variable de type Date optionnelle)`**

Date à partir de laquelle le re-calcul du contenu du champ Tableau croisé dynamique doit être effectué. Cette date doit être au format "AAAAMMJJ". Tous les enregistrements associés à une rubrique de type Date dont le contenu correspond à une date supérieure à la &lt;Date de départ&gt; seront pris en compte.

Si ce paramètre n'est pas spécifié, la date prise en compte correspond à la date maximale du dernier résultat calculé ou lu par la fonction [TCDCharge](../WDLang1/1000020507.md). 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Mode de calcul
<a name="mode_calcul_ELTPARAGRAPHE000061"></a>Les enregistrements pris en compte pour le recalcul ont les caractéristiques suivantes : 

- Les enregistrements possèdent une rubrique de type Date. 

- Le contenu de la rubrique de type date est supérieur ou égal à la valeur du paramètre &lt;Date de départ&gt;. 




Les anciennes valeurs présentes dans le champ Tableau croisé dynamique (s'il y en a) sont supprimées du champ Tableau croisé dynamique à partir de &lt;Date de départ&gt;.

Le calcul peut être assez long si beaucoup de données doivent être lues. Une jauge est alors affichée dans le champ.

A la fin du calcul, le nouveau contenu du champ Tableau croisé dynamique est affiché. Le résultat obtenu peut ensuite être sauvé par la fonction [TCDSauve](../WDLang1/1000020471.md). 
<a name="NOTE0_2"></a>


### Quand utiliser la fonction **TCDCalculeMiseAJour** ? 
<a name="quand_utiliser_fonction_docparampagetitleshort_ELTPARAGRAPHE000082"></a>La fonction **TCDCalculeMiseAJour** doit être utilisée lorsque les données sont figées : par exemple des factures. Il est possible uniquement d'ajouter de nouvelles factures. Dans ce cas, la date de re-calcul correspond à la date de dernière sauvegarde du contenu du champ Tableau croisé dynamique. 

Si les données affichées dans le champ Tableau croisé dynamique peuvent être modifiées (par exemple modification d'une quantité, d'un prix, ...), il est nécessaire : 

- soit de recalculer entièrement le contenu du champ Tableau croisé dynamique. 

- soit de recalculer le contenu du champ Tableau croisé dynamique à partir de la date correspondant à l'enregistrement modifié. 




<a name="XComposante"></a>

## Composante :
wd280obj.dll
