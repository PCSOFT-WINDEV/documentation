


## OKAnnuler (Fonction)

***En anglais : OKCancel***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Affiche un message dans une boîte de dialogue standard proposant les réponses "OK" et "Annuler" et renvoie la réponse de l'utilisateur.
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=fonctions_dialogue%20-%20HC%20N%B0006.gif)


Remarques : 

- **Cette boîte de dialogue est bloquante**. Pour continuer l'exécution de l'application, l'utilisateur doit valider un des boutons. 
	![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Pour ne pas bloquer l'application, utilisez la fonction [OKAnnulerAsynchrone](../WDLang1/1000025308.md).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) WINDEV permet d'appliquer le gabarit de votre projet à cette boîte de dialogue. Pour plus de détails, consultez [Personnaliser les boîtes de dialogue](../WDLang1/3021003.md).





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Suppression d'une ligne avec confirmation (oui par défaut)
SI OKAnnuler("Supprimer cet enregistrement ?") ALORS
	HSupprime(CLIENT)
FIN
```
<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Choix pour la sortie du programme
SI OKAnnuler("Voulez-vous quitter le programme?") = Oui ALORS
	Ferme()
FIN
```
<a name="Exemple3"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Demande de confirmation de la suppression du fichier dont 
// le nom est contenu dans la variable NOM_FIC, avec 
// positionnement sur le bouton "Non" de la fenêtre OKAnnuler
SI OKAnnuler(Non, "Supprimer le fichier ?") ALORS
	fSupprime(NOM_FIC)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Afficher une boîte de dialogue OK / Annuler

`<Résultat> = OKAnnuler([<Bouton sélectionné>, ] <Texte> [, <Ligne 2> [... [, <Ligne N>]]])`
---

**`<Résultat> : (Booléen)`**

Identifie le bouton sélectionné par l'utilisateur :


|   |   |
| --- | --- |
| *Faux* | L'utilisateur a choisi le bouton "Annuler". |
| *Vrai* | L'utilisateur a choisi le bouton "OK". |



**`<Bouton sélectionné> : (Booléen optionnel)`**

Bouton sélectionné par défaut dans la boîte de dialogue :


|   |   |
| --- | --- |
| *Non* | Bouton "Annuler" sélectionné par défaut. |
| *Vrai*<br>(par défaut) | Bouton "OK" sélectionné par défaut. |



**`<Texte> : (Chaîne de caractères)`**

Texte à afficher.

**`<Ligne 2> : (Chaîne de caractères optionnelle)`**

Texte affiché sur les lignes suivantes.



**`<Ligne N> : (Chaîne de caractères optionnelle)`**

Texte affiché sur les lignes suivantes.


<a name="SYNTAXE2"></a>

<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Caractéristiques de la boîte de dialogue
<a name="caracteristiques_boite_dialogue_ELTPARAGRAPHE000157"></a>

- Le titre de la boîte de dialogue correspond au titre de la fenêtre (ou page) en cours.
	

- Pour modifier ou définir le titre de la boîte de dialogue, utilisez la fonction [TitreSuivant](../WDLang1/3038043.md).




- Le message est cadré à gauche.

- Les libellés des boutons dépendent de la langue d'exécution de Windows.

- Le nombre maximum de caractères affichés est limité à 4096. Si une chaîne plus grande est passée en paramètre, elle sera tronquée.

- L'icône affichée (point d'exclamation) ne peut pas être modifiée.


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Pour personnaliser cette boîte de dialogue** (ainsi que toutes les boîtes de dialogue système de votre application), cochez l'option "Personnaliser les fenêtres système (Info, OuiNon, Confirmer, Dialogue)" dans l'onglet "Style" de la description du projet. Pour plus de détails, consultez [Personnaliser les boîtes de dialogue](../WDLang1/3021003.md).
<a name="NOTE0_2"></a>
<a name="NOTE0_3"></a>


### Saut de ligne dans la boîte de dialogue
<a name="saut_ligne_dans_boite_dialogue_ELTPARAGRAPHE000194"></a>La chaîne prédéfinie RC (Retour Chariot) peut être utilisée pour forcer le passage à la ligne suivante. Par exemple :

```wl
SI OKAnnuler("Attention : vous allez supprimer cet enregistrement" + RC + ...
	"Voulez-vous continuer ?") ALORS
	HSupprime(CLIENT)
FIN
```
est équivalent à :

```wl
SI OKAnnuler("Attention : vous allez supprimer cet enregistrement", ...
	"Voulez-vous continuer ?") ALORS
	HSupprime(CLIENT)
FIN
```


Il est également possible d'utiliser la syntaxe des chaînes multilignes. Par exemple : 

```wl
OKAnnuler(
[
Attention : vous allez supprimer cet enregistrement.

Voulez-vous continuer ?
])
```

<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Divers
<a name="divers_ELTPARAGRAPHE000209"></a>

- Les timers (fonction [TimerSys](../WDLang1/3015006.md)) ne sont pas stoppés lors de l'appel de cette fonction.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Les événements Windows ne sont pas stoppés lors de l'appel à cette fonction.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Lors de la saisie de la fonction sous l'éditeur de code, vous pouvez utiliser l'assistant de code. Selon les caractéristiques saisies dans l'assistant, la fonction utilisée peut être différente dans le code automatiquement généré.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La fonction [DélaiAvantFermeture](../WDLang1/3038040.md) limite le temps d'affichage du message. La boîte de dialogue est automatiquement fermée. Pour les boîtes de question ou de confirmation, la réponse attendue correspond au bouton par défaut.

- Le libellé des boutons s'affiche dans la langue utilisée par Windows sur le poste en cours.



<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Pilotage
<a name="pilotage_ELTPARAGRAPHE000249"></a>Il est possible de piloter un message OkAnnuler à l'aide de la fonction [PiloteOkAnnuler](../WDLang1/1000009007.md).
<a name="NOTE0_6"></a>



<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
