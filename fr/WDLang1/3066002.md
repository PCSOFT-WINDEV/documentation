
## RéseauConnecte (Fonction)

***En anglais : NetworkConnect***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Associe un lecteur à un répertoire réseau partagé.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Associe la lettre "E:" au répertoire réseau \\DocumentsPartagés\Fichiers
ResConnexion est un entier = RéseauConnecte("E:", "\\DocumentsPartagés\Fichiers")

SELON ResConnexion 
	CAS 1
		Erreur("La connexion n'est pas supportée.")
	CAS 2
		Erreur("Il n'y a pas assez de mémoire disponible.")
	CAS 3
		Erreur("Mauvais pointeur.")
	CAS 4
		Erreur("Mauvais type de device.")
	CAS 5
		Erreur("Mauvais profil utilisateur.")
	CAS 7
		Erreur("Il y a déjà une entrée pour ce device dans le profil utilisateur (Déjà connecté)")
	CAS 8
		Erreur("Mauvais réseau ou mauvais chemin.")
	CAS 9
		Erreur("Pas de réseau.")
	CAS 10
		Erreur("Erreur réseau..")
	CAS 11
		Erreur("Mauvais nom de réseau.")
	CAS 12
		Erreur("La lettre du lecteur est invalide.")
	CAS 13
		Erreur("Mauvais mot de passe.")
	CAS 14
		Erreur("Accès refusé.")			
	AUTRE CAS	
		Info("Lecteur créé avec succès")		
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = RéseauConnecte(<Lettre du lecteur> , <Répertoire réseau> [, <Options>] [, <Utilisateur> [, <Mot de passe>]])`
---

**`<Résultat> : (Entier)`**



- 0 si la connexion a été effectuée

- un code d'erreur (valeur supérieure à 0) dans le cas contraire.




**`<Lettre du lecteur> : (Chaîne de caractères)`**

Lecteur réseau à créer au format "&lt;Lettre du lecteur&gt;**:**".

**`<Répertoire réseau> : (Chaîne de caractères)`**

Répertoire réseau à associer au lecteur réseau.

**`<Options> : (Constante optionnelle de type Entier)`**

Paramètre la persistance de la connexion : 


|   |   |
| --- | --- |
| *rcOptionAucune* | Aucune option de persistance. |
| *rcOptionPersistant*<br>(valeur par défaut) | Connexion persistante (la connexion reste après le redémarrage de la machine). |





**`<Utilisateur> : (Chaîne de caractères optionnelle)`**

Nom de l'utilisateur autorisé à accéder au répertoire spécifié. Par défaut, ce paramètre correspond à *Null*.

**`<Mot de passe> : (Chaîne de caractères optionnelle)`**

Mot de passe permettant d'accéder au répertoire spécifié. Si &lt;Utilisateur&gt; correspond au nom de l'utilisateur courant, le mot de passe est ignoré par Windows. Par défaut, ce paramètre correspond à une chaîne vide ("").  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Codes d'erreur
<a name="codes_erreur_ELTPARAGRAPHE000057"></a>Les codes d'erreur retournés sont les suivants :

- 1 : La connexion n'est pas supportée.

- 2 : Il n'y a pas assez de mémoire disponible.

- 3 : Mauvais pointeur.

- 4 : Mauvais type de device.

- 5 : Mauvais profil utilisateur.

- 7 : Il y a déjà une entrée pour ce device dans le profil utilisateur (Déjà connecté)

- 8 : Mauvais réseau ou mauvais chemin.

- 9 : Pas de réseau.

- 10 : Erreur réseau.

- 11 : Mauvais nom de réseau.

- 12 : La lettre du lecteur est invalide.

- 13 : Mauvais mot de passe.

- 14 : Accès refusé.




Le message correspondant au code d'erreur peut être connu grâce à la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.


<a name="NOTE0_2"></a>


### Utilisation sous Windows Vista (et supérieur)
<a name="utilisation_sous_windows_vista_superieur_ELTPARAGRAPHE000084"></a>Sous Windows Vista (et supérieur), lorsque l'application est lancée en mode "Administrateur", les connexions réseau peuvent être perdues pour l'application. En effet, si le [système de l'UAC](../Editeurs/2025014.md) est activé, les lecteurs réseau sont déconnectés lorsque les privilèges de l'utilisateur sont augmentés. Pour pouvoir les utiliser, il est nécessaire de les reconnecter spécifiquement avec la fonction **RéseauConnecte**.



<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280std.dll
