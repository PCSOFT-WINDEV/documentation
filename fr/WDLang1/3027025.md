


## DateVersChaîne (Fonction)

***En anglais : DateToString***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Convertit : 

- une date en une chaîne au format spécifié.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) une date heure en une chaîne au format spécifié.
	La fonction [DateHeureVersChaîne](../WDLang1/1000025516.md) permet également de convertir une date heure vers une chaîne avec un format spécifique.




**Conseil** : Si la date formatée contient les caractères séparateurs "/", il ne faut pas l'afficher dans un champ de saisie de type Date.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
Res = DateVersChaîne("20191225")	// Res = "25/12/2019"

Res = DateVersChaîne(EntierVersDate(73773))	// Res = "25/12/2001"

DateVersChaîne("") 	// Retourne ""

Res = DateVersChaîne("20191225", "MM-JJ-AAAA")	// Res = "12-25-2019"

Res = DateVersChaîne("20791225", "Le numéro du jour JJ du mois n° MM de l'année AAAA")

Res = DateVersChaîne(DateSys(), maskDateSystème) 
// Res utilise le format défini dans le projet
```

```wl
// La casse des jours et mois en lettres est dépendante des options linguistiques du projet 
Res = DateVersChaîne("20031202", "JJJ JJ MMM AAAA")
// Res = "mar. 02 déc. 2003" ou "Mar. 02 Déc. 2003"

Res = DateVersChaîne("20031202", "JJJJ JJ MMMM AAAA") 
// Res = "mardi 02 décembre 2003" ou "Mardi 02 Décembre 2003"

// La casse des jours et des mois est forcée avec une majuscule
Res = DateVersChaîne("20031202", "Jjj JJ Mmm AAAA") // Res = "Mar. 02 Déc. 2003" 
Res = DateVersChaîne("20031202", "Jjjj JJ Mmmm AAAA") // Res = "Mardi 02 Décembre 2003"
```

```wl
Res = DateVersChaîne("20191125", maskDateEmail) 
// Renvoie "Mon, 25 Nov 2019 00:00:00 +0100"

Res = DateVersChaîne("20190825", maskDateEmail)  
// Renvoie "Sun, 25 Aug 2019 00:00:00 +0200"
```

```wl
Res = DateVersChaîne("20191125", maskDateEmailUTC) 
// Renvoie "Sun, 24 Nov 2019 23:00:00 +0000"

Res = DateVersChaîne("20190825", maskDateInternet)  
// Renvoie "2019-08-25T00:00:00.000+02:00"

Res = DateVersChaîne("20190825", maskDateInternetUTC)  
// Renvoie "2019-08-24T22:00:00.000Z"
```



```wl
// A la date du 22/01/2019
Res = DateVersChaîne("20190101", maskDateDuréeRelative) 
// Renvoie : il y a 3 semaines

Res = DateVersChaîne("20191125", maskDateDuréeRelative) 
// Renvoie : dans 10 mois

Res = DateVersChaîne("20190118", maskDateDuréeRelative) 
// Renvoie : la semaine dernière
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Convertir une date en chaîne

`<Résultat> = DateVersChaîne(<Date> [, <Format>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Chaîne de caractères au format spécifié.

**`<Date> : (Chaîne de caractères, variable de type Date)`**

Date à convertir. Si cette date correspond à une chaîne, elle doit être au format AAAAMMJJ (AAAA correspond à l'année, MM au mois et JJ au jour). 

**`<Format> : (Chaîne de caractères optionnelle)`**

Format de la date convertie. Ce paramètre peut contenir un mot, une phrase, ... Les caractères spécifiques représentant les différents éléments de la date (AAAA, AA, MM ou JJ) seront automatiquement remplacés par leur valeur identifiée dans la chaîne &lt;Date&gt;. Dans cette chaîne :

- AAAA représente l'année sur 4 positions,

- AA représente l'année sur 2 positions.

- M représente le mois (le zéro n'est pas affiché devant le numéro du mois), 

- MM représente le mois sur 2 chiffres,

- MMM représente le mois en lettres sur 3 caractères (par exemple jan). La casse utilisée dépend des options linguistiques du projet.

- Mmm représente le mois en lettres sur 3 caractères avec la première lettre forcée en majuscule (par exemple Jan)
	

- mmm représente le mois en lettres sur 3 caractères avec la première lettre forcée en minuscule (par exemple jan)
	

- MMMM représente le mois en lettres complet (par exemple janvier). La casse utilisée dépend des options linguistiques du projet.
	

- mmmm représente le mois en lettres complet avec la première lettre forcée en minuscule (par exemple janvier)
	

- J représente le jour (le zéro n'est pas affiché devant le numéro du jour), 

- JJ représente le jour sur 2 chiffres,

- JJJ représente le jour en lettres sur 3 caractères (par exemple lun). La casse utilisée dépend des options linguistiques du projet.
	

- Jjj représente le jour en lettres sur 3 caractères avec la première lettre forcée en majuscule (par exemple Lun)
	

- jjj représente le jour en lettres sur 3 caractères avec la première lettre forcée en minuscule (par exemple lun)
	

- JJJJ représente le jour en lettres complet (par exemple lundi). La casse utilisée dépend des options linguistiques du projet.

- Jjjj représente le jour en lettres complet avec la première lettre forcée en majuscule (par exemple Lundi).
	

- jjjj représente le jour en lettres complet avec la première lettre forcée en minuscule (par exemple lundi).
	

- L représente la première lettre du jour (par exemple L,M,M,J,V,S,D).

Si ce paramètre correspond à la constante : 


|   |   |
| --- | --- |
| *maskDateDuréeRelative* | Le format utilisé permet d'exprimer la durée écoulée (ou à venir) entre la date du jour et la date spécifiée. Ce format est exprimé en langage naturel. Les différentes formulations utilisées sont configurables dans la description du projet pour la langue en cours :<br><br>	1. Sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description". <br><br>	2. Dans l'onglet "Langues" :<br><br>		- sélectionnez la langue à configurer.<br><br>		- sélectionnez l'onglet "Date".<br><br><br><br><br>	3. Cliquez sur le bouton "Dates et Heures en langage naturel". <br><br>	4. Définissez les libellés personnalisés à utiliser si nécessaire. Ces libellés seront utilisés :<br><br>		- pour le résultat de la fonction **DateVersChaîne**.<br><br>		- pour les champs utilisant le masque d'affichage "Durée relative".<br><br><br><br><br><br><br><br> |
| *maskDateEmail* | Le format utilisé correspond au format de date de la norme RFC-5322 utilisé pour l'encryption d'un mail, d'un flux RSS, ...<br>Le résultat est exprimé dans le fuseau horaire local. <br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Non disponible. |
| *maskDateEmailUTC* | Le format utilisé correspond au format de date de la norme RFC-5322 utilisé pour l'encryption d'un mail, d'un flux RSS, ...<br>Le résultat est exprimé en temps universel (UTC). <br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Non disponible. |
| *maskDateInternet* | Le format utilisé correspond au format de date de la norme RFC-3339 utilisé pour les communications internationales.<br>Le résultat est exprimé dans le fuseau horaire local. <br><br> |
| *maskDateInternetUTC* | Le format utilisé correspond au format de date de la norme RFC-3339 utilisé pour les communications internationales.<br>Le résultat est exprimé en temps universel (UTC). <br><br><br><br> |
| *maskDateSystème* | Le format utilisé correspond au format défini dans la description du projet pour la langue en cours : <br><br>	1. Sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description". <br><br>	2. Sélectionnez l'onglet "Langues" puis l'onglet "Date". <br><br>	3. Le format utilisé correspond :<br><br>		- soit aux paramètres du système d'exploitation,<br><br>		- soit aux paramètres spécifiés (avec les jours et mois définis).<br><br><br><br><br><br> |


	Si ce paramètre n'est pas spécifié, le format utilisé par défaut est JJ/MM/AAAA.





<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 
### Convertir une dateheure en chaîne

`<Résultat> = DateVersChaîne(<Date et heure> [, <Format>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Chaîne de caractères au format spécifié.

**`<Date et heure> : (Chaîne de caractères, variable de type DateHeure)`**

Date et Heure à convertir. Ce paramètre peut correspondre à : 

- une chaîne de caractères contenant la date et l'heure au format AAAAMMJJHHmmSSCC (AAAA correspond à l'année, MM au mois, JJ au jour, HH aux heures, mm aux minutes, SS aux secondes et CC aux centièmes de seconde).

- une variable de type DateHeure. 




**`<Format> : (Chaîne de caractères optionnelle)`**

Format de la date et de l'heure converties. Ce paramètre peut contenir un mot, une phrase, ... Les caractères spécifiques représentant les différents éléments de la date et de l'heure seront automatiquement remplacés par leur valeur identifiée dans la chaîne &lt;Date et heure&gt;. Dans cette chaîne :

- AAAA représente l'année sur 4 positions,

- AA représente l'année sur 2 positions,

- M représente le mois (le zéro n'est pas affiché devant le numéro du mois), 

- MM représente le mois sur 2 chiffres,

- MMM représente le mois en lettres sur 3 caractères (par exemple jan). La casse utilisée dépend des options linguistiques du projet. 

- Mmm représente le mois en lettres sur 3 caractères avec la première lettre forcée en majuscule (par exemple Jan)
	

- mmm représente le mois en lettres sur 3 caractères avec la première lettre forcée en minuscule (par exemple jan)
	

- MMMM représente le mois en lettres complet (par exemple janvier). La casse utilisée dépend des options linguistiques du projet.

- Mmmm représente le mois en lettres complet avec la première lettre forcée en majuscule (par exemple Janvier)
	

- mmmm représente le mois en lettres complet avec la première lettre forcée en minuscule (par exemple janvier)
	

- J représente le jour (le zéro n'est pas affiché devant le numéro du jour), 

- JJ représente le jour sur 2 chiffres,

- JJJ représente le jour en lettres sur 3 caractères (par exemple lun). La casse utilisée dépend des options linguistiques du projet.

- Jjj représente le jour en lettres sur 3 caractères avec la première lettre forcée en majuscule (par exemple Lun)
	

- jjj représente le jour en lettres sur 3 caractères avec la première lettre forcée en minuscule (par exemple lun)
	

- JJJJ représente le jour en lettres complet (par exemple lundi). La casse utilisée dépend des options linguistiques du projet.

- Jjjj représente le jour en lettres complet avec la première lettre forcée en majuscule (par exemple Lundi)
	

- jjjj représente le jour en lettres complet avec la première lettre forcée en minuscule (par exemple lundi)
	

- L représente la première lettre du jour (par exemple L,M,M,J,V,S,D)

- HH représente le nombre d'heures,

- mm représente le nombre de minutes,

- SS représente le nombre de secondes,

- CC représente le nombre de centièmes de seconde,

- AP représente "AM" ou "PM" (si "AP" est présent dans le format, l'heure est affichée sur 12 heures).




Si ce paramètre correspond à la constante : 


|   |   |
| --- | --- |
| *maskDateDuréeRelative* | Le format utilisé permet d'exprimer la durée écoulée (ou à venir) entre la date du jour et la date spécifiée. Ce format est exprimé en langage naturel. Les différentes formulations utilisées sont configurables dans la description du projet pour la langue en cours :<br><br>1. Sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description". <br><br>2. Dans l'onglet "Langues" :<br><br>	- sélectionnez la langue à configurer.<br><br>	- sélectionnez l'onglet "Date".<br><br><br><br><br>3. Cliquez sur le bouton "Dates et Heures en langage naturel". <br><br>4. Définissez les libellés personnalisés à utiliser si nécessaire. Ces libellés seront utilisés :<br><br>	- pour le résultat de la fonction **DateVersChaîne**.<br><br>	- pour les champs utilisant le masque d'affichage "Durée relative".<br><br><br><br><br><br><br><br> |
| *maskDateEmail* | Le format utilisé correspond au format de date de la norme RFC-5322 utilisé pour l'encryption d'un mail, d'un flux RSS, ...<br>Le résultat est exprimé dans le fuseau horaire local. <br><br> |
| *maskDateEmailUTC* | Le format utilisé correspond au format de date de la norme RFC-5322 utilisé pour l'encryption d'un mail, d'un flux RSS, ...<br>Le résultat est exprimé en temps universel (UTC). <br><br> |
| *maskDateInternet* | Le format utilisé correspond au format de date de la norme RFC-3339 utilisé pour les communications internationales.<br>Le résultat est exprimé dans le fuseau horaire local. <br><br> |
| *maskDateInternetUTC* | Le format utilisé correspond au format de date de la norme RFC-3339 utilisé pour les communications internationales.<br>Le résultat est exprimé en temps universel (UTC). <br><br><br><br> |
| *maskDateSystème* | Le format utilisé correspond au format défini dans la description du projet pour la langue en cours : <br><br>1. Sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description". <br><br>2. Sélectionnez l'onglet "Langues" puis l'onglet "Date". <br><br>3. Le format utilisé correspond :<br><br>	- soit aux paramètres du système d'exploitation,<br><br>	- soit aux paramètres spécifiés (avec les jours et mois définis).<br><br><br><br><br><br> |


Si ce paramètre n'est pas spécifié, le format utilisé par défaut est JJ/MM/AAAA HH:mm:SS:CC.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Validité de la date
<a name="validite_date_ELTPARAGRAPHE000516"></a>La validité de la date passée en paramètre est vérifiée. Un message est affiché en cas de date invalide. Il est possible de tester la validité d'une date avec la fonction [DateValide](../WDLang1/3027003.md). 
Le format de stockage des dates permet de stocker des dates comprises entre le 01/01/0001 et le 31/12/9999.

Les calculs sur les dates réalisés avec les [fonctions WLangage](../WDLang1/3027029.md) ou les [propriétés WLangage](../Proprietes/2514010.md) sont fiables à partir du 1er Janvier 1583.
<a name="NOTE0_2"></a>


### Format de date
<a name="format_date_ELTPARAGRAPHE000529"></a>La fonction **DateVersChaîne** permet de formater une date retournée par la fonction [EntierVersDate](../WDLang1/3027009.md) ou la fonction [DateSys](../WDLang1/3027026.md). Le résultat pourra par exemple être affecté à un champ de type texte.

Pour obtenir la date sous un autre format, il faut utiliser les fonctions [Droite](../WDLang1/3024016.md), [Gauche](../WDLang1/3024001.md), [Milieu](../WDLang1/3024023.md), etc.
<a name="NOTE0_3"></a>


### Cas particulier : le paramètre &lt;Format&gt; n'est pas spécifié
<a name="cas_particulier_parametre_nest_pas_specifie_ELTPARAGRAPHE000558"></a>Les options linguistiques spécifiées pour les dates dans la description du projet sont prises en compte si aucun format spécifique n'est défini. 

Pour afficher les options linguistiques du projet : 

1. Affichez la description du projet : sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description".

2. Sélectionnez l'onglet "Langues". 




Par exemple : 

- si le projet utilise les options linguistiques de Windows pour les dates, sur un poste utilisant Windows en Français, les jours de la semaine et les mois commenceront par défaut avec une minuscule. 

- si le projet utilise des paramètres spécifiques pour les dates pour une ou plusieurs langues (nom du jour ou du mois personnalisés, ...), ces paramètres seront pris en compte pour la langue spécifiée.





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Gestiondesdates.gif) ***Exemples unitaires (WINDEV)*** : **Gestion des dates** <br>Utilisation du type Date du WLangage et des fonctions de manipulations de dates.

<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280std.dll
