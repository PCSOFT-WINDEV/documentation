
## LanceAppli (Fonction)

***En anglais : ExeRun***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Lance l'exécution d'un programme (exécutable par exemple) depuis l'application en cours. 

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) Il est possible de récupérer :

- la valeur de retour de l'exécutable avec la constante *exeValeurRetour*.

- l'identificateur du processus, appelé également PID avec la constante *exePID*.




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Remarques** :

- A partir de Windows Vista, le lancement d'applications peut échouer si le mécanisme de l'UAC est activé. Pour plus de détails, consultez [les remarques](#NOTE0_5).

- Sous Windows 64 bits, l'accès à un répertoire système à partir d'un exécutable 32 bits peut ne pas se faire dans le répertoire attendu. Pour plus de détails, consultez la page d'aide [64 bits natif et 32 bits natif](../Editeurs/2030048.md).







<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
```wl
// Lancement du bloc-notes avec le mode par défaut
LanceAppli("NOTEPAD.EXE Lisezmoi.txt")
```


<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
```wl
// Lancement d'un programme avec un nom long comprenant des espaces
// Par exemple : Word avec "Mes documents" pour répertoire de travail

// Solution 1 : Utilisation de la syntaxe spécifique des chaînes multilignes
// (évite de doubler ou tripler les guillemets)
SI LanceAppli([
	"C:\Program Files\Microsoft Office\Office12\WINWORD.EXE"
	], ...
	exeActif, exeNonBloquant, SysRep(srMesDocuments)) = Faux ALORS
		Erreur(ErreurInfo())
FIN

// Solution 2 : Doublement des guillemets
LanceAppli("""C:\Program Files\Microsoft Office\Office12\WINWORD.EXE""", ...
	exeActif, exeNonBloquant, SysRep(srMesDocuments))
```
<a name="Exemple3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
```wl
// Lancement d'applications avec un fichier en ligne de commande
// Nom de l'application à lancer
sNomAppli est une chaîne = "C:\Program Files\Adobe\Photoshop 6.0\Photoshp.exe"
// Nom de l'image à ouvrir
sNomImage est une chaîne = "C:\Users\Mon Nom\Pictures\Photos Immeubles\IMGP0993.JPG"

// Lancement équivalent à "Démarrer Exécuter" 
// Il faut obtenir une chaîne de caractères contenant des "" du type : 
// "C:\Program Files\Adobe\Photoshop 6.0\Photoshp.exe" 
// "C:\Users\Mon Nom\Pictures\Photos Immeubles\IMGP0993.JPG"
SI LanceAppli(ChaîneConstruit([
"%1" "%2"
], sNomAppli, sNomImage)) = Faux ALORS
	Erreur(ErreurInfo())
FIN
```
<a name="Exemple4"></a>





<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Lancer un exécutable (en mode bloquant ou non bloquant)

`<Résultat> = LanceAppli(<Nom du programme> [, <Mode> [, <Attente fin> [, <Répertoire de travail>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le programme a été lancé, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. La fonction [ErreurInfo](../WDLang1/3013008.md) permet d'obtenir plus de détails sur l'erreur.






**`<Nom du programme> : (Chaîne de caractères)`**

Nom du programme à lancer avec si nécessaire son chemin et/ou les paramètres à passer au programme. 

- **Si aucun chemin n'est précisé**, le programme est recherché tout d'abord dans le répertoire en cours, puis dans le répertoire de Windows et dans les répertoires accessibles par le PATH. 

- **Si l'exécutable correspond à un nom long avec espaces**, il est nécessaire d'utiliser la syntaxe suivante :
	
	```txt
	<Nom du programme> = " " " Nom_Long_avec_espaces" " Ligne_commande"
	```







**`<Mode> : (Constante optionnelle de type entier)`**

Mode de lancement du programme (aucune action sur les programmes DOS) : 


|   |   |
| --- | --- |
| *exeActif*<br>(Valeur par défaut) | Le programme lancé est actif, il s'exécute en "prenant la main" sur le programme en cours. |
| *exeIconise* | Le programme lancé est inactif et s'exécute icônisé.<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *exeInactif* | Le programme lancé est inactif : il s'exécute alors que le programme en cours garde le focus. <br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *exeMaximise* | Le programme lancé est actif, il s'exécute en "prenant la main" sur le programme en cours (la fenêtre d'exécution a la taille maximale autorisée).<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *exeSansHéritageHandle* | Permet d'indiquer que l'exécutable ne doit pas hériter des "Handles" du parent (attention, s'applique à TOUS les handles, fichiers compris). L'exécutable est indépendant de l'application qui le lance.  <br><br>Cette constante peut être combinée avec les autres constantes de mode de lancement de l'application. <br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |







![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Le programme lancé est toujours actif : il s'exécute en "prenant la main" sur le programme en cours. 

**`<Attente fin> : (Constante de type Booléen optionnelle)`**

Paramètre le délai nécessaire à la reprise de l'exécution du programme en cours : 


|   |   |
| --- | --- |
| *exeBloquant* | Le programme en cours reprend son exécution lorsque le programme lancé est terminé.<br><br> |
| *exeNonBloquant*<br>(Valeur par défaut) | Le programme en cours et le programme lancé s'exécutent en parallèle. |







**`<Répertoire de travail> : (Chaîne de caractères optionnelle)`**

Répertoire de travail de l'application à lancer.




<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Lancer un programme et récupérer une valeur

`<Résultat> = LanceAppli(<Nom du programme> [, <Mode> [, <Elément à renvoyer> [, <Répertoire de travail>]]])`
---

**`<Résultat> : (Entier)`**

Valeur recherchée :

- Valeur de retour de l'exécutable si &lt;Elément à renvoyer&gt; correspond à la constante *exeValeurRetour*.

- PID de l'exécutable si &lt;Elément à renvoyer&gt; correspond à la constante *exePID*.




La fonction [ErreurInfo](../WDLang1/3013008.md) permet de savoir si une erreur a été rencontrée.

**`<Nom du programme> : (Chaîne de caractères)`**

Nom du programme à lancer avec si nécessaire son chemin et/ou les paramètres à passer au programme. 

- **Si aucun chemin n'est précisé**, le programme est recherché tout d'abord dans le répertoire en cours, puis dans le répertoire de Windows et dans les répertoires accessibles par le PATH. 

- **Si l'exécutable correspond à un nom long avec espaces**, il est nécessaire d'utiliser la syntaxe suivante :
	&lt;Nom du programme&gt; = " " " Nom_Long_avec_espaces" " Ligne_commande"




**`<Mode> : (Constante optionnelle de type entier)`**

Mode de lancement du programme (aucune action sur les programmes DOS).


|   |   |
| --- | --- |
| *exeActif*<br>(Valeur par défaut) | Le programme lancé est actif, il s'exécute en "prenant la main" sur le programme en cours |
| *exeIconise* | Le programme lancé est inactif et s'exécute iconisé |
| *exeInactif* | Le programme lancé est inactif : il s'exécute alors que le programme en cours garde le focus |
| *exeMaximise* | Le programme lancé est actif, il s'exécute en "prenant la main" sur le programme en cours (la fenêtre d'exécution a la taille maximale autorisée) |





![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre est ignoré. Le programme lancé est actif, il s'exécute en "prenant la main" sur le programme en cours. 

**`<Elément à renvoyer> : (Constante optionnelle)`**

Paramètre le résultat de la fonction :


|   |   |
| --- | --- |
| *exePID* | Le programme en cours et le programme lancé s'exécutent en parallèle. &lt;Résultat&gt; correspond à l'identificateur du processus créé (également appelé PID) de l'exécutable, si celui-ci a été lancé, 0 en cas d'échec. <br>Cet identificateur peut être utilisé par exemple dans certaines API.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *exeValeurRetour* | Le programme en cours reprend son exécution lorsque le programme lancé est terminé. &lt;Résultat&gt; correspond à la valeur de retour de l'exécutable. |



**`<Répertoire de travail> : (Chaîne de caractères optionnelle)`**

Répertoire de travail de l'application à lancer.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Utilisation d'une ligne de commande
<a name="utilisation_une_ligne_commande_ELTPARAGRAPHE000270"></a>Pour passer des paramètres en ligne de commande à l'exécutable lancé, il est nécessaire de spécifier le chemin complet et le nom de l'exécutable à lancer.

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Si le programme lancé est réalisé avec WINDEV ou WINDEV Mobile, il sera possible de récupérer la ligne de commande avec la fonction [LigneCommande](../WDLang1/3013051.md).


<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Utilisation de la constante exeActif
<a name="utilisation_constante_exeactif_ELTPARAGRAPHE000287"></a>Si le traitement dans lequel l'application est lancée (avec la constante *exeActif*) exécute un code permettant au programme appelant de reprendre le focus, le programme appelé perd la main.

Pour que le programme appelé conserve le focus, il ne faut pas :

- appeler une autre fenêtre ou boîte de dialogue après l'appel de la fonction **LanceAppli**,

- appeler la fonction [DonneFocusEtRetourUtilisateur](../WDLang1/1410088107.md) après la fonction **LanceAppli**.




De plus, le champ Bouton (éventuel) dont l'événement "Clic" associé contient un appel de la fonction **LanceAppli** ne doit pas être "Tab Stop" (option "Accessible par TAB" dans l'onglet "UI" de la description du champ).
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Valeur de retour d'un exécutable WINDEV
<a name="valeur_retour_executable_windev_ELTPARAGRAPHE000319"></a>Un exécutable WINDEV peut renvoyer une valeur de retour. Il suffit de :

1. Créer une variable globale au projet de type Entier.

2. Initialiser cette variable avec la valeur à renvoyer.

3. Renvoyer cette variable avec le mot-clé [RENVOYER](../Motscles/1510007.md) dans le code de fermeture du projet.



<a name="NOTE0_4"></a>
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Lancement d'une application sous Windows Vista (et supérieur)
<a name="lancement_une_application_sous_windows_vista_superieur_ELTPARAGRAPHE000351"></a>Si le mécanisme de l'UAC (contrôle des comptes utilisateurs) est activé, l'application qui utilise la fonction **LanceAppli** pour lancer une autre application doit avoir des droits supérieurs à l'application qui est lancée.

Par exemple, une première application lancée avec les droits administrateur peut lancer une seconde application qui ne nécessite pas de droits spécifiques. 

Si la seconde application nécessite plus de droits que l'application qui la lance, il est possible que la seconde application ne se lance pas. Windows propose alors d'activer la gestion de la compatibilité avec Windows Vista. Si la gestion de la compatibilité est activée, la seconde application sera exécutée à son prochain lancement. Il est également possible d'utiliser la fonction [LanceAppliAssociée](../WDLang1/3035007.md). 
<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Divers
<a name="divers_ELTPARAGRAPHE000370"></a>

- La fonction **LanceAppli** ne modifie pas le répertoire en cours. Le répertoire en cours avant l'exécution de la fonction **LanceAppli** est identique au répertoire en cours après l'exécution de la fonction **LanceAppli**. 

- Si le programme lancé ne prend pas en compte le mode d'exécution spécifié, le programme est lancé par défaut en mode *exeActif*.



<a name="NOTE0_9"></a>



<a name="XComposante"></a>

## Composante :
wd280std.dll
