


## Ferme (Fonction)

***En anglais : Close***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ferme une fenêtre WINDEV (en renvoyant si nécessaire une valeur).

![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette fonction est disponible uniquement pour simplifier la Webisation de projets WINDEV. Dans un site WEBDEV, cette fonction se comporte selon les cas soit comme la fonction [PageFermeDialogue](../WDLang2/1000017166.md), soit comme la fonction [ContexteFerme](../WDLang2/3058003.md). 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Fermeture de la fenêtre "FEN_Saisie" 
Ferme(FEN_Saisie)
```


<a name="Exemple2"></a>
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Fermeture de la fenêtre "FEN_SaisieLogin" 
// avec récupération de plusieurs valeurs de retour
Ferme(FEN_SaisieLogin, Nom, Prénom)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`Ferme([<Fenêtre> [, <Valeur renvoyée> [... [, <Valeur renvoyée N>]]]])`
---

**`<Fenêtre> : (Nom de fenêtre optionnel)`**

Nom de la fenêtre à fermer. Si ce paramètre n'est pas précisé ou correspond à une chaîne vide (""), la fenêtre en cours est fermée.

**`<Valeur renvoyée> : (Type correspondant à la valeur renvoyée (optionnel))`**

Valeur renvoyée par la fenêtre lors de sa fermeture. 
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette valeur est récupérée uniquement si la fenêtre a été ouverte avec la fonction [Ouvre](../WDLang1/3038035.md). 
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette valeur est récupérée uniquement si la fenêtre a été ouverte avec la fonction [OuvreFenêtreMobile](../WDLang1/1000021018.md) (ou la fonction [OuvreFille](../WDLang1/3038021.md)).

Il est possible de renvoyer : 

- des types simples (chaîne de caractères, booléen, ...). 

- des types avancés : structure, structure dynamique, classe, type avancé, tableau, tableau associatif, file, pile, liste.






**`<Valeur renvoyée N> : (Type correspondant à la valeur renvoyée (optionnel))`**

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) Valeur N renvoyée par la fenêtre lors de sa fermeture (cas où plusieurs valeurs sont renvoyées).  
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette valeur est récupérée uniquement si la fenêtre a été ouverte avec la fonction [Ouvre](../WDLang1/3038035.md). 


Il est possible de renvoyer : 

- des types simples (chaîne de caractères, booléen, ...). 

- des types avancés : structure, structure dynamique, classe, type avancé, tableau, tableau associatif, file, pile, liste.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Codes exécutés lors de la fermeture
<a name="codes_executes_lors_fermeture_ELTPARAGRAPHE000152"></a>

- Lors de la fermeture d'une fenêtre :

	1. Le traitement en cours est interrompu définitivement.

	2. L'événement "Fermeture" de la fenêtre est exécuté.




- Si la fonction [DonneFocusEtRetourUtilisateur](../WDLang1/1410088107.md) est appelée dans l'événement "Fermeture" de la fenêtre, la fenêtre n'est pas fermée.

- Si la fonction **Ferme** est exécutée dans une procédure appelée par la fonction [Timer](../WDLang1/3015008.md), il est nécessaire de tester l'existence de la fenêtre à fermer avec les fonctions [FenEtat](../WDLang1/3038030.md) ou [FenEnCours](../WDLang1/3038033.md) sinon toutes les fenêtres ouvertes risquent d'être fermées. Par exemple :
	
	```wl
	// Procédure appelée par timer
	Fenêtre est une chaîne 
	Fenêtre = FenEnCours()
	SI Fenêtre <> "Nom fenêtre" ALORS
		Ferme()
	FIN
	```




<a name="NOTE0_2"></a>


### Fermeture en fonction du type de fenêtre
<a name="fermeture_fonction_type_fenetre_ELTPARAGRAPHE000181"></a>

- Si la fenêtre à fermer est une fenêtre mère ayant des fenêtre filles, ces fenêtres filles sont fermées en premier (leur code de fermeture est exécuté).

- Si la fenêtre à fermer est une fenêtre fille, la fenêtre mère devient la fenêtre en cours. Le code de prise de focus de la fenêtre mère est exécuté.



<a name="NOTE0_3"></a>


### Dernière fenêtre d'un projet
<a name="derniere_fenetre_projet_ELTPARAGRAPHE000189"></a>Si la dernière fenêtre d'un projet est fermée, l'événement "Fermeture" du projet est exécuté avant la fin du programme.
<a name="NOTE0_4"></a>
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Valeur renvoyée à la fonction Ouvre
<a name="valeur_renvoyee_fonction_ouvre_ELTPARAGRAPHE000210"></a>Il est possible de renvoyer, à l'aide de la fonction **Ferme**, une valeur ou plusieurs à la fonction [Ouvre](../WDLang1/3038035.md).

Rappel : Il est également possible de renvoyer une valeur à l'aide de la propriété [ValeurRenvoyée](../Proprietes/2510134.md) (&lt;Nom de la fenêtre&gt;.*ValeurRenvoyée*) exécutée avant la fonction **Ferme**. Dans ce cas, une seule valeur peut être renvoyée. 

Exemples : 

- L'utilisateur doit saisir un mot de passe dans une fenêtre. Ce mot de passe saisi est récupéré lors de la fermeture de cette fenêtre et renvoyé à la fonction [Ouvre](../WDLang1/3038035.md) :
	
	```wl
	MonMotDePasse = Ouvre(FEN_SaisieMotDePasse)
	SI MonMotDePasse <> "" ALORS
		Info("Mot de passe incorrect") 
	FIN
	
	// -- Code de clic sur le bouton "OK" de la fenêtre "FEN_SaisieMotDePasse"
	// L'utilisateur saisit son mot de passe dans le champ SAI_MotDePasse 
	// et valide la fenêtre.
	Ferme("", SAI_MotDePasse)
	```


- L'utilisateur doit saisir un login et un mot de passe dans une fenêtre. Ce login et mot de passe saisi sont récupérés lors de la fermeture de cette fenêtre et renvoyés à la fonction [Ouvre](../WDLang1/3038035.md) : 
	
	```wl
	(MonLogin, MonMotDePasse) = Ouvre(FEN_SaisieMotDePasse)
	SI MonLogin <> "" OU MonMotDePasse <> "" ALORS 
		Info("Login ou mot de passe incorrect")
	FIN
	
	// -- Code de clic sur le bouton "OK" de la fenêtre "FEN_SaisieMotDePasse"
	// L'utilisateur saisit son login et son mot de passe 
	// dans le champ SAI_MotDePasse et valide la fenêtre.
	Ferme("", SAI_Login, SAI_MotDePasse)
	```




<a name="NOTE0_6"></a>
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) 

### Valeur renvoyée lors de la fermeture d'une fenêtre fille
<a name="valeur_renvoyee_lors_fermeture_une_fenetre_fille_ELTPARAGRAPHE000252"></a>La fonction **Ferme** permet de renvoyer une valeur à la fenêtre mère qui a ouverte la fenêtre fille.

Rappel : Il est également possible de renvoyer une valeur à l'aide de la propriété [ValeurRenvoyée](../Proprietes/2510134.md) (&lt;Nom de la fenêtre&gt;.*ValeurRenvoyée*) exécutée avant la fonction **Ferme**.

La valeur renvoyée par la fenêtre fille pourra être lue dans l'événement "Fermeture d'une fenêtre fille" de la fenêtre ayant ouvert la fenêtre fille (celle qui a utilisé la fonction [OuvreFenêtreMobile](../WDLang1/1000021018.md) ou [OuvreFille](../WDLang1/3038021.md)) : il suffit d'utiliser la propriété [ValeurRenvoyée](../Proprietes/2510134.md) sur le mot-clé [MaFenêtreFille](../Motscles/1511021.md).

Par exemple :

- Dans le code de fermeture de la fenêtre fille, la fonction [Ferme](../WDLang1/3038018.md) est utilisée pour renvoyer un paramètre : 
	
	```wl
	Ferme("", MonParamètre)
	```


- Dans l'événement "Fermeture d'une fenêtre fille" de la fenêtre appelante, le nom de la fenêtre fille ainsi que la valeur renvoyée peuvent être récupérés en utilisant le mot-clé [MafenêtreFille](../Motscles/1511021.md) : 
	
	```wl
	// Fermeture d'une fenêtre fille
	NomFenêtreFille = MaFenêtreFille.Nom
	ValeurFenêtreFille = MaFenêtreFille.ValeurRenvoyée
	```




<a name="NOTE0_7"></a>


### Combinaison des touches Alt + F4
<a name="combinaison_des_touches_alt_ELTPARAGRAPHE000299"></a>La combinaison de touches Alt + F4 peut avoir plusieurs comportements :

- Si la fenêtre comporte un bouton de type "Abandon", l'événement WLangage associé au bouton d'abandon est exécuté.

- Si la fenêtre comporte un bouton ayant Alt + F4 comme raccourci clavier, l'événement WLangage associé à ce bouton est exécuté.

- Si la fenêtre ne comporte ni de bouton d'abandon, ni de bouton ayant Alt + F4 comme raccourci clavier, l'événement "Fermeture" de la fenêtre est exécuté et la fenêtre est fermée (sauf si la fonction [DonneFocusEtRetourUtilisateur](../WDLang1/1410088107.md) est utilisée).

- Si la fenêtre est ouverte depuis un programme en langage externe, Alt + F4 retourne "ESC" dans WdTouche.



<a name="NOTE0_8"></a>


### Équivalence
<a name="equivalence_ELTPARAGRAPHE000314"></a>La ligne de code suivante : 

```txt
FenEtat(<Fenêtre>, Inexistant)
```
est équivalente à : 

```txt
Ferme(<Fenêtre>)
```


<a name="XComposante"></a>

## Composante :
wd280obj.dll
