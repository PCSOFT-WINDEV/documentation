
## fRepDonnéesUtilisateur (Fonction)

***En anglais : fDataDirUser***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie un chemin de répertoire pour les données de l'utilisateur courant de l'application courante.

Ce répertoire est utilisable sans restriction sous Windows XP, Vista, ... Ce répertoire permet de stocker par exemple :

- les fichiers de configuration de l'application (fichiers .INI, fichiers .XML, ...) spécifiques à l'utilisateur en cours.

- les fichiers de données spécifiques à l'utilisateur en cours (fichiers HFSQL .fic, .ndx, .mmo).




Ce répertoire est automatiquement créé s'il n'existe pas.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
Trace(fRepDonnéesUtilisateur())
// Sous Windows 7, le chemin renvoyé peut être par exemple : 
// C:\Users\fp\AppData\Roaming\Applications WinDev\WD TreeMap
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = fRepDonnéesUtilisateur([<Options>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Chemin du répertoire à utiliser pour les données de l'utilisateur d'une application. Le résultat renvoyé par cette fonction est différent en mode test et en exécution :

- ***en mode test*** : &lt;Répertoire de base de l'utilisateur&gt;\\&lt;Données des applications&gt;\\Applications WinDev\\&lt;Nom du projet&gt;

- ***en exécution*** : &lt;Répertoire de base de l'utilisateur&gt;\\&lt;Données des applications&gt;\\&lt;Nom de la société&gt;\\&lt;Nom de l'exécutable&gt;
	Remarque : le nom de la société est spécifié lors de la création de l'exécutable. Si ce nom n'est pas spécifié, il est remplacé par "Applications WinDev".




Sous Windows 98 et Me, &lt;Résultat&gt; correspond au répertoire d'exécution de l'application (également renvoyé par la fonction [fRepExe](../WDLang1/3036049.md)).



**`<Options> : (Constante optionnelle)`**

Indique si le répertoire doit être créé ou non :


|   |   |
| --- | --- |
| *frdDéfaut*<br>(Valeur par défaut) | Le répertoire est créé s'il n'existe pas. |
| *frdSansCréation* | Le répertoire n'est pas créé s'il n'existe pas. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Norme de programmation sous Windows XP, Vista et supérieur
<a name="norme_programmation_sous_windows_vista_superieur_ELTPARAGRAPHE000090"></a>Pour augmenter la sécurité des postes face aux vers et virus, Windows Vista (et supérieur) a mis en place le [mécanisme de l'UAC](../Editeurs/2025014.md) (le contrôle de compte utilisateur).

Par défaut, ce mécanisme considère que tous les utilisateurs (y compris les administrateurs) sont de simples utilisateurs avec des droits réduits. Pour exécuter une application nécessitant des droits supplémentaires, le mécanisme de l'UAC demande une confirmation.

Lors de la conception de vos applications, il est conseillé de respecter les normes de programmation Windows, afin qu'un simple utilisateur (sans droits spécifiques) puisse utiliser votre application. Ainsi :

- **Si une application doit créer ou modifier des fichiers de données HFSQL locaux ou des fichiers de configuration (.INI, .XML)**, ces fichiers doivent être localisés dans le répertoire correspondant à l'application.

	- Si ces fichiers sont spécifiques à l'utilisateur en cours, ils doivent être stockés dans le répertoire renvoyé par la fonction **fRepDonnéesUtilisateur**.

	- Si ces fichiers sont communs à tous les utilisateurs du poste, ils doivent être stockés dans le répertoire renvoyé par la fonction [fRepDonnéesCommun](../WDLang1/3036070.md).




- **Si plusieurs applications doivent créer ou modifier les mêmes fichiers de données HFSQL ou fichiers de configuration (.INI, .XML)**, ces fichiers doivent être localisés dans le répertoire commun des applications

	- Si ces fichiers sont spécifiques à l'utilisateur en cours, ils doivent être stockés dans le répertoire renvoyé par la fonction [fRepGlobalUtilisateur](../WDLang1/3036073.md).

	- Si ces fichiers sont communs à tous les utilisateurs du poste, ils doivent être stockés dans le répertoire renvoyé par la fonction [fRepGlobalCommun](../WDLang1/3036072.md).







Tableau récapitulatif : 



|   |   |   |
| --- | --- | --- |
|   | 1 application | Plusieurs applications |
| 1 utilisateur | **fRepDonnéesUtilisateur** | [fRepGlobalUtilisateur](../WDLang1/3036073.md) |
| Plusieurs utilisateurs | [fRepDonnéesCommun](../WDLang1/3036070.md) | [fRepGlobalCommun](../WDLang1/3036072.md) |


Remarques :

- Ces fonctions sont conseillées dans le cas des applications monopostes multi-utilisateurs ou TSE.

- Si le domaine ou l'Active Directory permet l'utilisation d'un profil itinérant, les informations concernant l'utilisateur sont automatiquement recopiées lors du changement de poste.




Pour vous aider à concevoir des applications respectant ces normes de programmation, WINDEV propose des options spécifiques lors du test de l'application. Pour plus de détails, consultez [Paramétrage du mode test d'un projet](../Editeurs/2019017.md).



<a name="XComposante"></a>

## Composante :
wd280vm.dll
