


## &lt;Type Date&gt;.VersChaîne (Fonction)

***En anglais : &lt;Date type&gt;.ToString***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Formate la date spécifiée au format spécifié.

**Conseil** : Si la date formatée contient les caractères séparateurs "/", il ne faut pas l'afficher dans un champ de saisie de type Date.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MaDate est une Date
MaDate = "20191225"
Res = MaDate.VersChaîne()
// Res = "25/12/2019"

Res = MaDate.VersChaîne("MM-JJ-AAAA") 
// Res = "12-25-2019"

Res = MaDate.VersChaîne("Le numéro du jour JJ du mois n° MM de l'année AAAA")

MaDate = DateSys()
Res = MaDate.VersChaîne(maskDateSystème) 
// Res utilise le format défini dans le projet
```

```wl
MaDate est une Date
MaDate = "20031202"
// La casse des jours et mois en lettres est dépendante des options linguistiques du projet 
Res = MaDate.VersChaîne("JJJ JJ MMM AAAA") 
// Res = "mar. 02 déc. 2003" ou "Mar. 02 Déc. 2003" 

Res = MaDate.VersChaîne("JJJJ JJ MMMM AAAA") 
// Res = "mardi 02 décembre 2003" ou "Mardi 02 Décembre 2003"

// La casse des jours et des mois est forcée avec une majuscule
Res = MaDate.VersChaîne("Jjj JJ Mmm AAAA") // Res = "Mar. 02 Déc. 2003" 
Res = MaDate.VersChaîne("Jjjj JJ Mmmm AAAA") // Res = "Mardi 02 Décembre 2003"
```

```wl
MaDate est une Date
MaDate = "20191125"
Res = MaDate.VersChaîne(maskDateEmail) 
// Renvoie "Mon, 25 Nov 2019 00:00:00 +0100"

Res = MaDate.VersChaîne(maskDateEmail)  
// Renvoie "Sun, 25 Aug 2019 00:00:00 +0200"
```

```wl
MaDate est une Date
MaDate = "20121125"
Res = MaDate.VersChaîne(maskDateEmail) 
// Renvoie "Sun, 25 Nov 2012 00:00:00 +0100"

Res = MaDate.VersChaîne(maskDateEmail)  
// Renvoie "Sat, 25 Aug 2012 00:00:00 +0200"
```

```wl
MaDate est une Date
MaDate = "20190101"
// A la date du 22/01/2019
Res = MaDate.VersChaîne(maskDateDuréeRelative) 
// Renvoie : il y a 3 semaines

Res = MaDate.VersChaîne(maskDateDuréeRelative) 
// Renvoie : dans 10 mois

Res = MaDate.VersChaîne(maskDateDuréeRelative) 
// Renvoie : la semaine dernière
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Convertir une date en chaîne

`<Résultat> = <Date>.VersChaîne([<Format>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Chaîne de caractères au format spécifié.

**`<Date> : (Variable de type Date)`**

Nom de la variable de type Date à convertir. 

**`<Format> : (Chaîne de caractères optionnelle)`**

Format de la date convertie. Ce paramètre peut contenir un mot, une phrase, ... Les caractères spécifiques représentant les différents éléments de la date (AAAA, AA, MM ou JJ) seront automatiquement remplacés par leur valeur identifiée dans la chaîne &lt;Date&gt;. Dans cette chaîne :

- AAAA représente l'année sur 4 positions,

- AA représente l'année sur 2 positions.

- M représente le mois (le zéro n'est pas affiché devant le numéro du mois), 

- MM représente le mois sur 2 chiffres,

- MMM représente le mois en lettres sur 3 caractères (par exemple jan). La casse utilisée dépend des options linguistiques du projet.

- Mmm représente le mois en lettres sur 3 caractères avec la première lettre forcée en majuscule (par exemple Jan)
	

- mmm représente le mois en lettres sur 3 caractères avec la première lettre forcée en minuscule (par exemple jan)
	

- MMMM représente le mois en lettres complet (par exemple janvier). La casse utilisée dépend des options linguistiques du projet.
	

- mmmm représente le mois en lettres complet avec la première lettre forcée en minuscule (par exemple janvier)
	

- J représente le jour (le zéro n'est pas affiché devant le numéro du jour), 

- JJ représente le jour sur 2 chiffres,

- JJJ représente le jour en lettres sur 3 caractères (par exemple lun). La casse utilisée dépend des options linguistiques du projet.
	

- Jjj représente le jour en lettres sur 3 caractères avec la première lettre forcée en majuscule (par exemple Lun)
	

- jjj représente le jour en lettres sur 3 caractères avec la première lettre forcée en minuscule (par exemple lun)
	

- JJJJ représente le jour en lettres complet (par exemple lundi). La casse utilisée dépend des options linguistiques du projet.

- Jjjj représente le jour en lettres complet avec la première lettre forcée en majuscule (par exemple Lundi).
	

- jjjj représente le jour en lettres complet avec la première lettre forcée en minuscule (par exemple lundi).
	

- L représente la première lettre du jour (par exemple L,M,M,J,V,S,D).

Si ce paramètre correspond à la constante : 


|   |   |
| --- | --- |
| *maskDateDuréeRelative* | Le format utilisé permet d'exprimer la durée écoulée (ou à venir) entre la date du jour et la date spécifiée. Ce format est exprimé en langage naturel. Les différentes formulations utilisées sont configurables dans la description du projet pour la langue en cours :<br><br>	1. Sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description". <br><br>	2. Dans l'onglet "Langues" :<br><br>		- sélectionnez la langue à configurer.<br><br>		- sélectionnez l'onglet "Date".<br><br><br><br><br>	3. Cliquez sur le bouton "Dates et Heures en langage naturel". <br><br>	4. Définissez les libellés personnalisés à utiliser si nécessaire. Ces libellés seront utilisés :<br><br>		- pour le résultat de la fonction **&lt;Type Date&gt;.VersChaîne**.<br><br>		- pour les champs utilisant le masque d'affichage "Durée relative".<br><br><br><br><br><br><br><br> |
| *maskDateEmail* | Le format utilisé correspond au format de date de la norme RFC-5322 utilisé pour l'encryption d'un mail, d'un flux RSS, ...<br>Le résultat est exprimé dans le fuseau horaire local. <br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Non disponible. |
| *maskDateEmailUTC* | Le format utilisé correspond au format de date de la norme RFC-5322 utilisé pour l'encryption d'un mail, d'un flux RSS, ...<br>Le résultat est exprimé en temps universel (UTC). <br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Non disponible. |
| *maskDateInternet* | Le format utilisé correspond au format de date de la norme RFC-3339 utilisé pour les communications internationales.<br>Le résultat est exprimé dans le fuseau horaire local. <br><br> |
| *maskDateInternetUTC* | Le format utilisé correspond au format de date de la norme RFC-3339 utilisé pour les communications internationales.<br>Le résultat est exprimé en temps universel (UTC). <br><br><br><br> |
| *maskDateSystème* | Le format utilisé correspond au format défini dans la description du projet pour la langue en cours : <br><br>	1. Sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description". <br><br>	2. Sélectionnez l'onglet "Langues" puis l'onglet "Date". <br><br>	3. Le format utilisé correspond :<br><br>		- soit aux paramètres du système d'exploitation,<br><br>		- soit aux paramètres spécifiés (avec les jours et mois définis).<br><br><br><br><br><br> |


	Si ce paramètre n'est pas spécifié, le format utilisé par défaut est JJ/MM/AAAA.





<a name="SYNTAXE2"></a>

<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Validité de la date
<a name="validite_date_ELTPARAGRAPHE000454"></a>La validité de la date passée en paramètre est vérifiée. Un message est affiché en cas de date invalide. Il est possible de tester la validité d'une date avec la fonction [DateValide](../WDLang1/3027003.md). 
Le format de stockage des dates permet de stocker des dates comprises entre le 01/01/0001 et le 31/12/9999.

Les calculs sur les dates réalisés avec les [fonctions WLangage](../WDLang1/1000023943.md) ou les [propriétés WLangage](../Proprietes/2514010.md) sont fiables à partir du 1er Janvier 1583.
<a name="NOTE0_2"></a>


### Format de date
<a name="format_date_ELTPARAGRAPHE000478"></a>La fonction **&lt;Type Date&gt;.VersChaîne** permet de formater une date retournée par la fonction [EntierVersDate](../WDLang1/3027009.md) ou la fonction [DateSys](../WDLang1/3027026.md). Le résultat pourra par exemple être affecté à un champ de type texte.

Pour obtenir la date sous un autre format, il faut utiliser les fonctions [&lt;Type Chaîne Ansi&gt;.Droite](../WDLang1/1410089825.md), [Gauche](../WDLang1/3024001.md), [Milieu](../WDLang1/3024023.md), etc.
<a name="NOTE0_3"></a>


### Cas particulier : le paramètre &lt;Format&gt; n'est pas spécifié
<a name="cas_particulier_parametre_nest_pas_specifie_ELTPARAGRAPHE000510"></a>Les options linguistiques spécifiées pour les dates dans la description du projet sont prises en compte si aucun format spécifique n'est défini. 

Pour afficher les options linguistiques du projet : 

1. Affichez la description du projet : sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description".

2. Sélectionnez l'onglet "Langues". 




Par exemple : 

- si le projet utilise les options linguistiques de Windows pour les dates, sur un poste utilisant Windows en Français, les jours de la semaine et les mois commenceront par défaut avec une minuscule. 

- si le projet utilise des paramètres spécifiques pour les dates pour une ou plusieurs langues (nom du jour ou du mois personnalisés, ...), ces paramètres seront pris en compte pour la langue spécifiée.




<a name="XComposante"></a>

## Composante :
wd280std.dll
