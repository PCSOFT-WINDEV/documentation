


## dbgActiveAudit (Fonction)

***En anglais : dbgEnableAudit***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Active l'audit dynamique par programmation.

Le rapport de l'audit dynamique est un fichier ".waudit" contenant les comportements erronés ou anormaux, les opérations consommatrices de temps, ... Par exemple :

- les assertions même si elles ne sont pas actives.

- les erreurs non fatales non traitées.

- les erreurs fatales (exceptions), qu'elles soient traitées par QUAND EXCEPTION ou pas.

- les warnings d'exécution concernant des anomalies du projet (dépassement de capacité d'une variable, ...).

- les warnings d'exécution concernant des problèmes de performances (ressources cherchées sur un réseau et non trouvées, ...).

- les commentaires et les warnings d'exécution personnalisés.




**Remarque** : Si le projet correspondant à l'audit dynamique est ouvert sous l'éditeur, le fichier d'audit pourra être ouvert directement sous l'éditeur : 

- soit sous le volet "Accueil", dans le groupe "Général", déroulez "Ouvrir", sélectionnez "Ouvrir" et sélectionnez le fichier ".waudit" voulu.

- soit en effectuant un "Drag and Drop" du fichier ".waudit" de l'explorateur de fichiers vers l'éditeur. 





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Active l'audit dynamique avec toutes les options activées
dbgActiveAudit()
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = dbgActiveAudit([<Nom du fichier d'audit> [, <Options>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'audit dynamique a démarré, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Nom du fichier d'audit> : (Chaîne de caractères optionnelle)`**

Emplacement et nom du fichier d'audit à créer. Le nom et l'emplacement du fichier d'audit peuvent être : 

- complètement personnalisés. 

- construits à l'aide des mots-clés suivants : 
	


|   |   |
| --- | --- |
| [%RepExe%] | Répertoire de l'exécutable, toujours complété par le caractère "\\". Ce répertoire est équivalent au résultat de la fonction [fRepExe](../WDLang1/3036049.md). |
| [%NomExe%] | Nom de l'exécutable. |
| [%Date%] | Date de lancement de l'audit d'exécution (format AAAAMMJJ). |
| [%Heure%] | Heure de lancement de l'audit d'exécution (format HHMMSS). |
| [%NomUtilisateur%] | Nom de l'utilisateur courant. |
| [%NomMachine%] | Nom de la machine. |
| [%RepDonnees%] | Répertoire des fichiers de données HFSQL spécifié par l'utilisateur lors de l'installation de l'application. Ce répertoire est équivalent au résultat de la fonction [fRepDonnées](../WDLang1/3036001.md). |
| [%RepDonneesUtilisateur%] | Répertoire pour les données de l'utilisateur courant de l'application courante.  Ce répertoire est équivalent au résultat de la fonction [fRepDonnéesUtilisateur](../WDLang1/3036071.md). |





Par défaut : 

- l'extension du fichier d'audit est ".wdaudit". 

- le nom du fichier d'audit correspond à : "[%RepDonneesUtilisateur%][%NomExe%]_[%Date%]_[%Heure%]". 
	Par exemple : "C:\\Users\\Doc\\AppData\\Roaming\\Applications WinDev\\MonAppli\\MonAppli_20071023_130812.waudit".




Attention : Si vous utilisez la construction dynamique des chaînes (option "Autoriser "[% %]" dans les chaînes" dans l'onglet "Compilation" de la description du projet, une erreur de compilation apparaît (identificateur inconnu). Dans ce cas, il est nécessaire de faire précéder chaque chaîne par '-%'. Exemple : 

```wl
dbgActiveAudit("[%RepDonneesUtilisateur%][%NomExe%]_[%Date%]_[%Heure%]")
```
 devient
```wl
dbgActiveAudit(-%"[%RepDonneesUtilisateur%][%NomExe%]_[%Date%]_[%Heure%]")
```


**`<Options> : (Constante ou combinaison de constantes optionnelle de type Entier)`**

Permet de paramétrer les options de l'audit dynamique :


|   |   |
| --- | --- |
| *AuditActif* | L'audit dynamique est immédiatement actif. |
| *AuditAssertion* | Les assertions sont inscrites dans l'audit dynamique. |
| *AuditCommentaire* | Les commentaires d'audit sont inscrits dans l'audit dynamique. Un commentaire d'audit est écrit grâce à la fonction [dbgEcritCommentaireAudit](../WDLang1/1000018839.md). |
| *AuditErreur* | Les erreurs non fatales non traitées sont inscrites dans l'audit dynamique. |
| *AuditException* | Les erreurs fatales, traitées par QUAND EXCEPTION ou non traitées, sont inscrites dans l'audit dynamique. |
| *AuditPause* | L'audit dynamique est initialisé mais n'est pas immédiatement actif. Il pourra être activé ultérieurement grâce à la fonction [dbgEtatAudit](../WDLang1/1000018836.md). |
| *AuditTout*<br>(Valeur par défaut) | Tous les événements d'audit sont inscrits dans l'audit dynamique. |
| *AuditWarningAnomalie* | Les warnings d'exécution concernant les anomalies détectées sont inscrits dans l'audit dynamique. |
| *AuditWarningPerformance* | Les warnings d'exécution concernant les performances sont inscrits dans l'audit dynamique. |
| *AuditWarningUtilisateur* | Les warnings d'exécution personnalisés sont inscrits dans l'audit dynamique. Un warning personnalisé est déclenché grâce à la fonction [dbgEcritWarningAudit](../WDLang1/1000018838.md). |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Fonctionnement de l'audit dynamique
<a name="fonctionnement_audit_dynamique_ELTPARAGRAPHE000271"></a>

- La fonction **dbgActiveAudit** ne doit être appelée qu'une seule fois. Tout autre appel à cette fonction sera sans effet.

- Pour activer ou désactiver momentanément l'audit dynamique, utilisez la fonction [dbgEtatAudit](../WDLang1/1000018836.md).

- Pour modifier les options de l'audit dynamique, utilisez la fonction [dbgOptionAudit](../WDLang1/1000018837.md).


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Remarque** : L'audit dynamique peut être également démarré grâce au fichier ".wx" placé à côté de l'exécutable. Pour plus de détails, consultez [Audit dynamique](../Editeurs/1014502.md).


### Divers
<a name="divers_ELTPARAGRAPHE000294"></a>

- La fonction **dbgActiveAudit** peut être utilisée dans un webservice REST. 

- L'emplacement du fichier d'audit peut être totalement personnalisé. Dans ce cas, ne pas oublier les problèmes de droits qui peuvent se poser. 
	Rappel : Le répertoire des données est normalement toujours disponible en écriture.   





## Composante :
wd280vm.dll
