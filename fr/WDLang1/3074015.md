


## TableCherche (Fonction)

***En anglais : TableSearch***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Effectue une recherche dans : 

- un champ Table, 

- un champ Table hiérarchique, 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) une table affichée dans un champ Combo.


Deux modes de recherche sont disponibles :  

- Recherche d'un élément dans une colonne. 

- Recherche d'un élément dans la valeur mémorisée du champ. 



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Recherche l'élément "Chemise" dans la colonne "COL_Produit"
// Recherche générique à partir de ligne 5
soit ResCherche = TableCherche(COL_Produit, "Chemise", rechercheCommencePar, 5)
```
<a name="Exemple3"></a>

```wl
// Permet de lister toutes les occurrences d'une valeur recherchée.
Résultat1 est un entier
Résultat1 = TableCherche(COL_NomColonne, "ValeurRecherchée", rechercheIdentique)
TANTQUE Résultat1 <> -1
	Trace(Résultat1)
	Résultat1 = TableCherche(COL_NomColonne, "ValeurRecherchée", ...
		rechercheIdentique, Résultat1 + 1)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Rechercher un élément dans une colonne

`<Résultat> = TableCherche(<Nom de la colonne> , <Élément recherché> [, <Type de recherche> [, <Ligne de départ>]])`
---

**`<Résultat> : (Entier)`**



- Indice de l'élément trouvé, 

- -1 si aucun élément ne correspond à la recherche.




Si la recherche est réalisée :

- dans un champ Table par programmation, l'élément trouvé n'est pas sélectionné. Pour sélectionner l'élément trouvé, utilisez la fonction [TableSelectPlus](../WDLang1/3074031.md).

- dans un champ Table fichier, l'élément trouvé n'est pas sélectionné, les lignes du champ Table défilent jusqu'à l'élément recherché.




**`<Nom de la colonne> : (Chaîne de caractères)`**

Nom de la colonne dans laquelle s'effectue la recherche. 
Si ce paramètre correspond à une chaîne vide (""), la colonne manipulée est la colonne à laquelle appartient le traitement en cours.

**Dans un champ Table ou Table hiérarchique fichier**, la colonne de recherche doit être liée à une rubrique de type clé. Il n'est pas possible de faire une recherche sur une colonne non liée à une rubrique.

**`<Élément recherché> : (Type de l'élément recherché)`**

Élément à rechercher dans la colonne spécifiée. Si l'élément recherché est de type :

- "Date" ou "Heure" : la recherche est effectuée sur la valeur retournée.

- "Monétaire + Euro" : la recherche est effectuée sur la devise mémorisée.




**`<Type de recherche> : (Constante optionnelle de type Entier)`**

Type de recherche à effectuer : 



|   |   |
| --- | --- |
| *rechercheCommencePar* (ou <u><u><u><u>Faux</u></u></u></u> par compatibilité) | **Recherche générique du type "Commence par"**<br><br>Les éléments ayant une valeur commençant par &lt;Élément recherché&gt; sont retournés. <br><br>Attention : Dans un champ Table par programmation, les espaces au début du texte sont ignorés. |
| *rechercheContient* | **Recherche générique du type "Contient"**<br><br>Les éléments ayant une valeur contenant &lt;Élément recherché&gt; sont retournés. <br><br> |
| *rechercheDéfaut* | **Recherche par défaut**. Pour cette fonction, la recherche par défaut est une recherche à l'identique (du type "Egale à").  <br><br>Les éléments ayant une valeur strictement égale à &lt;Élément recherché&gt; sont retournés.<br><br>Attention : Dans un champ Table par programmation, les espaces au début du texte sont ignorés. <br><br> |
| *rechercheIdentique* (ou <u><u><u><u>Vrai</u></u></u></u> par compatibilité)<br>(Valeur par défaut) | **Recherche à l'identique** (du type "Egale à") <br><br>Les éléments ayant une valeur strictement égale à &lt;Élément recherché&gt; sont retournés.<br><br>Attention : Dans un champ Table par programmation, les espaces au début du texte sont ignorés. |



**`<Ligne de départ> : (Entier optionnel)`**

Numéro de la ligne de départ de la recherche dans la colonne. 
Si ce paramètre n'est pas spécifié, la recherche est effectuée dans toute la colonne. 
Ce paramètre permet de rechercher toutes les occurrences d'une chaîne dans une colonne.
Ce paramètre est ignoré dans le cas d'un champ Table fichier.  


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Rechercher un élément dans un champ Table (valeur mémorisée)

`<Résultat> = TableCherche(<Champ Table> , <Valeur recherchée>)`
---

**`<Résultat> : (Entier)`**



- Indice de l'élément trouvé, 

- -1 si aucun élément ne correspond à la recherche.




**`<Champ Table> : (Nom de champ)`**

Nom du champ à manipuler. Ce champ peut correspondre à : 

- un champ Table.

- un champ Table hiérarchique.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) un champ Combo avec table.




Le champ Table doit être lié à un fichier de données ou une variable. 

**`<Valeur recherchée> : (Type de l'élément recherché)`**

Valeur de l'élément recherché. Cette valeur est recherchée dans la valeur mémorisée du champ.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000179"></a>**Syntaxe 1** : La **recherche d'un élément dans une colonne** est disponible pour :

- un champ Table ou Table hiérarchique fichier.

- un champ Table ou Table hiérarchique par programmation.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) une table affichée dans un champ Combo,

- un champ monosélection ou multisélection.
	




Pour un champ Table ou Table hiérarchique fichier : 

- le mode de parcours doit être automatique. 

- la colonne doit être liée à une rubrique de type clé.


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) **Syntaxe 2** : La **recherche un élément dans la valeur mémorisée** est disponible pour : 

- un champ Table ou Table hiérarchique fichier. 

- un champ Table ou Table hiérarchique sur variable. 

- un champ monosélection ou multisélection.
	



<a name="NOTE0_2"></a>


### Type de recherche
<a name="type_recherche_ELTPARAGRAPHE000219"></a>

- ***Recherche à l'identique*** : Seuls les éléments ayant une valeur strictement égale à &lt;Élément recherché&gt; sont retournés par la fonction **TableCherche**. Par exemple :
	
	```wl
	// Retourner tous les "Dupond" de la colonne "COL_ColonneNom"
	TableCherche(COL_ColonneNom, "Dupond")
	```
Attention : Dans un champ Table par programmation, les espaces au début du texte sont ignorés. 

- ***Recherche générique*** : Les éléments commençant par &lt;Élément recherché&gt; sont retournés par la fonction **TableCherche**. 
	Par exemple : 
	
	```wl
	// Retourner tous les noms commençant par "DUP"
	TableCherche(COL_ColonneNom, "DUP", rechercheCommencePar)
	```




<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Champ Table fichier
<a name="champ_table_fichier_ELTPARAGRAPHE000242"></a>

- Dans un champ Table fichier, il est possible d'utiliser la syntaxe suivante pour rechercher un élément dans une colonne :
	
	```txt
	NomDeLaTable = ElémentRecherché
	```


- Sur les champs Table fichier à accès direct, lors de l'utilisation de la fonction **TableCherche** : 

	- l'affichage du champ Table est déplacé.

	- l'indice renvoyé correspond à un indice "approchant" car ce type de champ Table peut gérer des milliards d'enregistrements.  






<a name="NOTE0_4"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000258"></a>

- **Dans un champ Table par programmation**, la recherche effectuée avec la fonction **TableCherche** : 

	- n'est pas sensible à la casse (majuscules/minuscules).

	- ignore les espaces au début du texte. 




- **Dans un champ Table fichier**, la recherche effectuée avec la fonction **TableCherche** tient compte des caractéristiques de recherche définies dans l'analyse pour la rubrique liée à la colonne de recherche (sensible ou non à la casse, ...).




<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
