


## TableSelectPlus (Fonction)

***En anglais : TableSelectPlus***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Sélectionne une ligne dans un champ Table ou Table hiérarchique. La ligne sélectionnée correspond à la ligne en cours sur laquelle le bandeau de sélection est affiché.

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Sélection de la ligne 5 dans le champ "TABLE_TableProduit"
TableSelectPlus(TABLE_TableProduit, 5)
```
<a name="Exemple2"></a>

```wl
// Sélection des lignes 5 et 7 
// dans le champ Table multisélection "TABLE_TableProduit"
TableSelectPlus(TABLE_TableProduit, 5, 7)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`TableSelectPlus(<Champ Table> [, <Indice 1> [... [, <Indice N>]]])`
---

**`<Champ Table> : (Nom de champ)`**

Nom du champ à manipuler. Ce champ peut correspondre à : 

- un champ Table. 

- un champ Table hiérarchique.


Si ce paramètre correspond à une chaîne vide (""), le champ manipulé est le champ auquel le traitement en cours appartient.

**`<Indice 1> : (Entier optionnel)`**

Indice de la première ligne à sélectionner. 

Si les paramètres &lt;Indice 1&gt; et &lt;Indice N&gt; ne sont pas précisés, toutes les lignes du champ sont sélectionnées. 

Si les paramètres &lt;Indice 1&gt; et &lt;Indice N&gt; correspondent à des lignes déjà sélectionnées, la fonction **TableSelectPlus** est sans effet. L'indice d'une ligne sélectionnée peut être obtenu avec la fonction [TableSelect](../WDLang1/3074020.md).

Si ce paramètre correspond à -1, la ligne "en cours" (celle qui a le focus) est sélectionnée.




**`<Indice N> : (Entier optionnel)`**

Indice de la Nième ligne à sélectionner. 

Si les paramètres &lt;Indice 1&gt; et &lt;Indice N&gt; ne sont pas précisés, toutes les lignes du champ spécifié sont sélectionnées.

Si les paramètres &lt;Indice 1&gt; et &lt;Indice N&gt; correspondent à des lignes déjà sélectionnées, la fonction **TableSelectPlus** est sans effet. L'indice d'une ligne sélectionnée peut être obtenu avec la fonction [TableSelect](../WDLang1/3074020.md).




<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000132"></a>La fonction **TableSelectPlus** peut être utilisée indifféremment sur :

- un champ Table ou Table hiérarchique fichier.

- un champ Table ou Table hiérarchique par programmation.

- un champ monosélection ou multisélection. 
	



<a name="NOTE0_2"></a>


### Se positionner sur la dernière ligne du champ Table ou Table hiérarchique
<a name="positionner_sur_derniere_ligne_champ_table_table_hierarchique_ELTPARAGRAPHE000169"></a>Pour se positionner sur la dernière ligne d'un champ Table ou Table hiérarchique, les syntaxes suivantes sont possibles :

- Fonction **TableSelectPlus** : 
	
	```txt
	TableSelectPlus(<Champ Table>, <Champ Table>.Occurrence)
	```


- Propriété [Occurrence](../WDLang1/3025009.md) : 
	
	```txt
	<Champ Table> = <Champ Table>.Occurrence
	```


- Fonction [TableOccurrence](../WDLang1/3074021.md) : 
	
	```txt
	<Champ Table> = TableOccurrence(<Champ Table>)
	```




<a name="NOTE0_3"></a>


### Équivalence avec la fonction TableSelectPlus
<a name="equivalence_avec_fonction_tableselectplus_ELTPARAGRAPHE000207"></a>Dans le cas d'un champ Table ou Table hiérarchique monosélection (sans rubrique mémorisée), les deux syntaxes suivantes sont équivalentes :

```txt
TableSelectPlus(<Champ Table>, <Indice>)

<Champ Table> = <Indice>
```

<a name="NOTE0_4"></a>


### Cas particulier : Champ Table avec ascenseur à rebond
<a name="cas_particulier_champ_table_avec_ascenseur_rebond_ELTPARAGRAPHE000222"></a>La sélection d'une ligne non visible dans le champ Table ne donne pas le focus à la ligne sélectionnée.

**Remarque** : Il est conseillé d'utiliser un champ Table avec un ascenseur proportionnel.  
<a name="NOTE0_5"></a>


### Evénement "Sélection d'une ligne"
<a name="evenement_selection_une_ligne_ELTPARAGRAPHE000233"></a>L'événement "Sélection d'une ligne" n'est pas exécuté lors de l'appel de la fonction **TableSelectPlus**.
<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Sélection au niveau de la cellule
<a name="selection_niveau_cellule_ELTPARAGRAPHE000249"></a>Dans le cas d'un champ Table utilisant un mode de sélection "Sélection multiple" pour les cellules, la propriété [Sélectionnée](../Proprietes/2510112.md) permet de savoir si une cellule est sélectionnée ou de sélectionner une cellule par programmation.

Par exemple : 

```wl
// Exemple de sélection d'une cellule
TABLE_ListeClients[3,2].Sélectionnée = Vrai
```

<a name="NOTE0_7"></a>


### Champ Table fichier de plus de 10 000 lignes
<a name="champ_table_fichier_plus_10_000_lignes_ELTPARAGRAPHE000264"></a>Dans un champ Table fichier de plus de 10 000 lignes, pour des raisons de performances, le positionnement dans le champ Table est approximatif. 

Pour un positionnement exact, il est nécessaire de : 

1. Faire une recherche avec la fonction [HLitRecherche](../WDLang4/3044050.md). 

2. Utiliser la fonction [TableAffiche](../WDLang1/3074003.md) avec la constante *taCourantBandeau*. 



<a name="NOTE0_8"></a>


### Sélecteur de ligne
<a name="selecteur_ligne_ELTPARAGRAPHE000284"></a>Lorsque le style du champ Table contient un sélecteur de ligne, la flèche à gauche est positionnée sur :

- la dernière ligne sélectionnée lorsque la sélection multiple est faite à la souris ou au clavier,

- la ligne à laquelle le "focus" est donné en affectant le champ Table. Par exemple : 
	
	```wl
	// Positionne le sélecteur de ligne sur la 3ème ligne
	// Et sélectionne les lignes 3, 4 et 5
	TABLE_ListeClients = 3 
	TableSélectPlus(TABLE_ListeClients, 3, 4, 5)
	```





<a name="XComposante"></a>

## Composante :
wd280obj.dll
