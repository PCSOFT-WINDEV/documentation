
## ActionDo (Fonction)

***En anglais : ActionDo***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Crée et exécute une action personnalisée (définie par programmation) avec support du "Undo/Redo". Cette action est ajoutée dans la liste des actions effectuées dans la fenêtre. 

Cette action supporte le "Undo/Redo" : elle peut être manipulée par les fonctions [ActionUnDo](../WDLang1/1000022677.md) et [ActionReDo](../WDLang1/1000022608.md). 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
ActionDo(ProcCreéLib, "Nouveau")
PROCEDURE INTERNE ProcCreéLib(sLib)
	pNouveau est un Champ
	pNouveau <- ChampCrée( "LIB_" + DonneIdentifiant(), typLibellé, 0, 0, 100, 20, Vrai)  
	pNouveau..Libellé = sLib 
	ActionDéclareUndo(ProcAnnuler)
	PROCEDURE INTERNE ProcAnnuler()
		ChampSupprime(pNouveau)
	FIN
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Créer et exécuter une action personnalisée

`ActionDo(<Procédure WLangage> [, <Paramètre 1> [... [, <Paramètre N>]]])`
---

**`<Procédure WLangage> : (Nom de procédure)`**

Nom d'une procédure WLangage à exécuter. Le code de cette procédure doit appeler la fonction [ActionDéclareUndo](../WDLang1/1000022678.md). Les actions de cette procédure seront prises en compte dans le Undo/Redo.

Remarque : L'utilisation d'une procédure interne permet un accès direct aux variables locales. 

**`<Paramètre 1> : (Type quelconque optionnel)`**

Premier paramètre optionnel à passer à la procédure.



**`<Paramètre N> : (Type quelconque optionnel)`**

Nème paramètre optionnel à passer à la procédure.


<a name="SYNTAXE2"></a>

### Créer et exécuter une action personnalisée liée à une fenêtre

`ActionDo(<Fenêtre> , <Procédure WLangage> [, <Paramètre 1> [... [, <Paramètre N>]]])`
---

**`<Fenêtre> : (Nom de fenêtre)`**

Nom de la fenêtre ou de la fenêtre interne à manipuler.  

**`<Procédure WLangage> : (Nom de procédure)`**

Nom d'une procédure WLangage à exécuter. Le code de cette procédure doit appeler la fonction [ActionDéclareUndo](../WDLang1/1000022678.md). Les actions de cette procédure seront prises en compte dans le Undo/Redo.

Remarque : L'utilisation d'une procédure interne permet un accès direct aux variables locales. 

**`<Paramètre 1> : (Type quelconque optionnel)`**

Premier paramètre optionnel à passer à la procédure.



**`<Paramètre N> : (Type quelconque optionnel)`**

Nème paramètre optionnel à passer à la procédure.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Si le nom de la fenêtre est précisé (syntaxe 2), la fonction **ActionDo** est équivalente à la fonction [FenEdDo](../WDLang1/1000021897.md). 

- Durant l'exécution de la procédure associée à la fonction **ActionDo**, la fonction [ActionDéclareUndo](../WDLang1/1000022678.md) doit être appelée sinon une erreur WLangage est générée. L'utilisateur final peut alors annuler cette action (Ctrl + Z ou utilisation de la fonction [ActionUnDo](../WDLang1/1000022677.md)) puis éventuellement la refaire (Ctrl + Y ou appel de la fonction [ActionRedo](../WDLang1/1000022608.md)). 






<a name="XComposante"></a>

## Composante :
wd280obj.dll
