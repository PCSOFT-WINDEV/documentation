
## fRepEnCours (Fonction)

***En anglais : fCurrentDir***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Identifie ou modifie le répertoire en cours.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003036022&name=frepencours_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Connaître le répertoire en cours
ResRepEnCours = fRepEnCours()
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Connaître le répertoire en cours sur le disque spécifié

`<Résultat> = fRepEnCours([<Disque> [, <Option>]])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Chemin du répertoire en cours sur le disque spécifié (260 caractères maximum). Ce chemin se termine par le caractère "\\" uniquement à la racine d'un disque ("A:\\" par exemple).
	
	
	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Par défaut (si le paramètre &lt;Disque&gt; n'est pas spécifié), ce répertoire correspond au répertoire d'installation de l'application. Il n'est pas possible de lire ou d'écrire dans ce répertoire.

- **-1** en cas d'erreur. Pour connaître le libellé de cette erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Disque> : (Chaîne de caractères optionnelle)`**

Nom du disque sur lequel le répertoire en cours est recherché. Ce nom est sous la forme :

- &lt;lettre du lecteur&gt;**:**. Par exemple : "**A:**".

- chemin UNC. Par exemple : "\\\\&lt;NomServeur&gt;\\&lt;NomPartage&gt;".




Si ce paramètre n'est pas précisé, le disque correspond au disque en cours.

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre n'est pas disponible.

**`<Option> : (Constante optionnelle de type Entier)`**

Permet de spécifier le format du résultat de la fonction. Par défaut, la fonction **fRepEnCours** renvoie une chaîne de caractères Ansi. 


|   |   |
| --- | --- |
| *fCheminUNICODE* | &lt;Résultat&gt; sera une chaîne de caractères au format Unicode. |


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre n'est pas disponible.


<a name="SYNTAXE2"></a>

### Modifier le répertoire en cours

`<Résultat> = fRepEnCours(<Chemin du nouveau répertoire en cours> [, <Option>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Chemin du répertoire en cours (260 caractères maximum). Ce chemin se termine par le caractère "\\" uniquement à la racine d'un disque ("A:\\" par exemple). 

- **-1** en cas d'erreur. Pour connaître le libellé de cette erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Chemin du nouveau répertoire en cours> : (Chaîne de caractères)`**

Chemin complet (ou relatif) du nouveau répertoire en cours (260 caractères maximum). Un chemin de type UNC peut être utilisé : il doit être de la forme "\\\\&lt;NomServeur&gt;\\&lt;NomPartage&gt;\\&lt;NomRépertoire&gt;".
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.

**`<Option> : (Constante optionnelle de type Entier)`**

Permet de spécifier le format du résultat de la fonction. Par défaut, la fonction **fRepEnCours** renvoie une chaîne de caractères Ansi. 


|   |   |
| --- | --- |
| *fCheminUNICODE* | &lt;Résultat&gt; sera une chaîne de caractères au format Unicode. |


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre n'est pas disponible.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Espace
<a name="espace_ELTPARAGRAPHE000147"></a>Les espaces à droite de la chaîne &lt;Chemin du nouveau répertoire en cours&gt; sont automatiquement supprimés par la fonction **fRepEnCours** :

```wl
fRepEnCours("C:\MonRépertoire\    ")
```


est équivalent à :


```wl
fRepEnCours("C:\MonRépertoire")
```



<a name="NOTE0_2"></a>


### Modification du disque et du répertoire en cours
<a name="modification_disque_repertoire_cours_ELTPARAGRAPHE000163"></a>Si un changement de disque doit être effectué, il est conseillé d'utiliser :

1. La fonction [fDisqueEnCours](../WDLang1/3036023.md) pour modifier le disque en cours,

2. La fonction **fRepEnCours** pour modifier le répertoire en cours sur le nouveau disque.




Si le disque demandé avec la fonction **fRepEnCours** ne correspond pas au disque en cours, le changement de disque est automatiquement réalisé.
<a name="NOTE0_3"></a>




### Répertoire en cours lors de tests 
<a name="repertoire_cours_lors_tests_ELTPARAGRAPHE000185"></a>Lors de tests depuis l'éditeur WINDEV (GO de fenêtre ou de projet), le répertoire en cours correspond : 

- au répertoire de génération de la [configuration de projet](../Editeurs/9000030.md) courante, 

- ou à défaut au sous-répertoire EXE de votre projet.





<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Serveur SOAP
<a name="serveur_soap_ELTPARAGRAPHE000204"></a>La fonction **fRepEnCours** utilisée sur un serveur SOAP retourne le répertoire en cours du serveur Internet utilisé. Il est interdit de modifier ce répertoire.


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Manipulationdefichierstexte.gif) ***Exemples unitaires (WINDEV)*** : **Manipulation de fichiers texte** <br>Manipulation des fichiers "texte" avec WINDEV :<br>- Créer un fichier texte<br>- Ecrire dans un fichier texte<br>- Lire dans un fichier texte
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Manipulationdefichierstexte.gif) ***Exemples unitaires (WEBDEV)*** : **Manipulation de fichiers texte** <br>Manipulation des fichiers "non HFSQL" avec WEBDEV (création d'un fichier texte, écriture et lecture)
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Manipulationdefichierstexte.gif) ***Exemples unitaires (WINDEV Mobile)*** : **Manipulation de fichiers texte** <br>Manipulation des fichiers externes de type "texte" :<br>- Créer un fichier texte<br>- Ecrire dans un fichier texte<br>- Lire dans un fichier texte



<a name="XComposante"></a>

## Composante :
wd280std.dll
