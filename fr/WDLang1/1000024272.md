


## &lt;Table&gt;.InsèreLigneAvecAnimation (Fonction)

***En anglais : &lt;Table&gt;.InsertLineWithAnimation***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Insère une ligne dans un champ Table ou un champ Table hiérarchique avec une animation. La durée de cette animation est paramétrable : 

- dans l'onglet "Style" de la fenêtre de description du champ Table : 

	- Dans l'onglet "Style", sélectionnez l'élément "Animation de champ".

	- Dans la liste des animations, sélectionnez "Modification par TableXXXAvecAnimation()" et cliquez sur le bouton "Paramètres".  




- dans la fenêtre de description du projet : 

	- Dans l'onglet "Avancé", cliquez sur le bouton "Animations des champs". 

	- Dans la zone "Champ table et zone répétée", sélectionnez "Modification par TableXXXAvecAnimation()" et cliquez sur le bouton "Paramètres".







**Remarques** : 

- Pour ajouter des éléments à la fin d'un champ Table, utilisez la fonction [&lt;Table&gt;.AjouteLigne](../WDLang1/1000023404.md) ou [&lt;Table&gt;.AjouteLigneAvecAnimation](../WDLang1/1000023678.md).

- Pour ajouter des lignes à l'intérieur d'une hiérarchie (champ Table hiérarchique), utilisez la fonction [&lt;Table hiérarchique&gt;.InsèreFils](../WDLang1/1000021934.md).



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Insertion des éléments "Paul" et "Dubois" dans la cinquième
// ligne du champ Table "TABLE_TableClient"
TABLE_TableClient.InsèreLigneAvecAnimation(5, "Paul", "Dubois")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Champ Table>.InsèreLigneAvecAnimation([<Indice> [, <Élément colonne 1> [... [, <Élément colonne N>]]]])`
---

**`<Champ Table> : (Nom de champ)`**

Nom du champ à manipuler. Ce champ peut correspondre à : 

- un champ Table.

- un champ Table hiérarchique.  




**`<Indice> : (Entier optionnel)`**

Indice de la ligne dans laquelle les éléments doivent être insérés. La première ligne a pour indice 1.


|   |   |
| --- | --- |
| Indice non précisé | La ligne est insérée avant la ligne en cours. Si aucune ligne n'est sélectionnée, la ligne est insérée à la fin du champ. |
| Indice supérieur au nombre de lignes du champ | La ligne est insérée à la fin du champ. |
| Indice égal à 0 | La ligne est insérée au début du champ. |
| Indice égal à -1 | La ligne est insérée avant la ligne en cours. |



**`<Élément colonne 1> : (Type de la colonne associée (optionnel))`**

Premiers éléments de la ligne à insérer dans le champ spécifié. Chaque élément correspond à une colonne du champ. Le type de l'élément inséré doit être compatible avec le type de la colonne concernée.
Si aucun de ces paramètres n'est spécifié, une ligne vide est ajoutée dans le champ. Pour un champ fichier, les valeurs par défaut définies dans le fichier de données lié sont prises en compte.



**`<Élément colonne N> : (Type de la colonne associée (optionnel))`**

Nèmes éléments de la ligne à insérer dans le champ spécifié. Chaque élément correspond à une colonne du champ. Le type de l'élément inséré doit être compatible avec le type de la colonne concernée.
Si aucun de ces paramètres n'est spécifié, une ligne vide est ajoutée dans le champ. Pour un champ fichier, les valeurs par défaut définies dans le fichier de données lié sont prises en compte.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000276"></a>La fonction **&lt;Table&gt;.InsèreLigneAvecAnimation** peut être utilisée indifféremment sur :

- un champ Table ou Table hiérarchique fichier.

- un champ Table ou Table hiérarchique par programmation.

- un champ monosélection ou multisélection. 




L'animation n'est pas jouée dans les cas suivants : 

- si les animations sont désactivées (fonction [AnimationActive](../WDLang1/1000017399.md)).

- si la fonction est utilisée dans les traitements suivants de la fenêtre : "Déclarations globales", "Fin d'initialisation" ou "Fermeture".

- si l'application est en mode TSE. 

- si l'insertion est effectué en dehors de la zone visible (en-dessous ou au-dessus). Dans ce cas, l'insertion est réalisée et la fonction rend la main immédiatement.


La fonction ne rend la main qu'à la fin de l'animation.
<a name="NOTE0_2"></a>


### Caractéristiques des éléments de la ligne
<a name="caracteristiques_des_elements_ligne_ELTPARAGRAPHE000305"></a>

- Pour ne pas spécifier de valeur pour un des éléments, utilisez une chaîne vide ("") ou 0 (selon le type de la colonne).

- Si un élément correspond au résultat d'un calcul, mettez l'expression numérique entre parenthèses. Par exemple :
	
	```wl
	TABLE_TableCalcul.InsèreLigneAvecAnimation(3, (53+29), (83-21))
	```




<a name="NOTE0_3"></a>


### Position de la ligne insérée
<a name="position_ligne_inseree_ELTPARAGRAPHE000323"></a>Par défaut, la ligne est insérée à la position indiquée.

Cas particuliers : 

- Si le champ est trié avec la fonction [&lt;Table&gt;.Trie](../WDLang1/1000024293.md), la ligne insérée est positionnée dans le champ en fonction du tri en cours et non de l'indice spécifié.

- Si le champ est trié par l'utilisateur, le tri n'est pas pris en compte lors de l'insertion de la ligne. La ligne est insérée à la position indiquée.



<a name="NOTE0_4"></a>


### Limites : Nombre maximum de lignes affichées
<a name="limites_nombre_maximum_lignes_affichees_ELTPARAGRAPHE000345"></a>Le nombre maximum de lignes pouvant être affichées dans un champ Table ou Table hiérarchique est limité uniquement par la mémoire vive disponible (maximum théorique : 2 milliards de lignes). 

Il est cependant déconseillé d'utiliser des champs Table ou Table hiérarchique avec un nombre de lignes important pour des raisons de performance (temps nécessaire pour remplir le champ par exemple) et d'utilisabilité.
<a name="NOTE0_5"></a>


### Champ Table/Table hiérarchique fichier : Modifications dans le fichier de données lié
<a name="champ_tabletable_hierarchique_fichier_modifications_dans_fichier_donnees_lie_ELTPARAGRAPHE000357"></a>

- **Si la saisie en cascade est activée**, le contenu du fichier de données lié au champ est automatiquement modifié lorsque l'utilisateur passe à la ligne suivante.

- **Si la saisie en cascade n'est pas activée**, le contenu du fichier de données lié au champ n'est pas modifié. Pour écrire le contenu de la ligne insérée dans le fichier de données lié, il est nécessaire d'utiliser la fonction [&lt;Table&gt;.Enregistre](../WDLang1/1000024249.md) après la fonction **&lt;Table&gt;.InsèreLigneAvecAnimation**. 




**Remarque** : L'option "Saisie en cascade (Ajout)" peut être sélectionnée dans l'onglet "Détail" de la description du champ.
<a name="NOTE0_6"></a>


### Champ Table/Table hiérarchique fichier : Insertion de plusieurs lignes
<a name="champ_tabletable_hierarchique_fichier_insertion_plusieurs_lignes_ELTPARAGRAPHE000382"></a>A chaque appel de la fonction **&lt;Table&gt;.InsèreLigneAvecAnimation** dans un champ Table ou Table hiérarchique fichier, une ligne virtuelle est créée dans le champ. Les informations ne seront enregistrées dans le fichier de données que lors de l'appel de la fonction [&lt;Table&gt;.Enregistre](../WDLang1/1000024249.md).

Si la fonction **&lt;Table&gt;.InsèreLigneAvecAnimation** est appelée successivement dans le même traitement sans être suivie de la fonction [&lt;Table&gt;.Enregistre](../WDLang1/1000024249.md), seul le PREMIER appel est effectif (les appels suivants sont ignorés). Une seule ligne est ajoutée dans le champ Table/Table hiérarchique fichier.
<a name="NOTE0_7"></a>


### Champ Table/Table hiérarchique en saisie
<a name="champ_tabletable_hierarchique_saisie_ELTPARAGRAPHE000410"></a>Si la fonction **&lt;Table&gt;.InsèreLigneAvecAnimation** est appelée :

- Dans un événement du champ, le curseur est automatiquement positionné sur la première colonne à saisir dans la ligne insérée.

- Dans un événement n'appartenant pas au champ (ou dans un autre traitement), utilisez la fonction [DonneFocusEtRetourUtilisateur](../WDLang1/1410088107.md) pour reprendre la saisie dans le champ Table ou Table hiérarchique.



<a name="NOTE0_8"></a>


### Insertion d'image
<a name="insertion_image_ELTPARAGRAPHE000429"></a>Pour insérer une image dans un champ Table ou Table hiérarchique, spécifiez directement le nom et le chemin complet de l'image à insérer.
Par exemple :

```wl
TABLE_MaTable.InsèreLigneAvecAnimation(5, "C:\MesDocuments\MonImage.BMP")
```


**Remarque** : Pour afficher correctement l'image insérée, la colonne doit être de type Image.

<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
