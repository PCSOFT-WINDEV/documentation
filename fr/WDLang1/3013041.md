
## Exécute (Fonction)

***En anglais : Execute***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Lance l'exécution d'un traitement par programmation. Cette fonction est utilisée principalement pour exécuter les procédures.

Par compatibilité, le traitement exécuté peut également être un traitement d'un champ, d'une fenêtre ou d'une page. Dans ces différents cas, il est conseillé d'utiliser [ExécuteTraitement](../WDLang1/3013031.md).






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Exécution d'une procédure
Exécute("Proced1")
```


<a name="Exemple2"></a>



```wl
// -- Clic sur le bouton BTN_BOUTON1
// Exécution d'une procédure retournant un résultat
Info(Exécute("Doubler_Nombre", 2)) // Affiche 4
```

```wl
// Procédure Doubler_Nombre
PROCEDURE Doubler_Nombre(X)
RENVOYER 2*X
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Exécuter une procédure pouvant retourner un résultat

`<Résultat> = Exécute(<Procédure WLangage> [, <Paramètre 1> [... [, <Paramètre N>]]])`
---

**`<Résultat> : (Quelconque)`**

Valeur de retour de la procédure appelée. Cette valeur est identique à la valeur obtenue si la procédure est directement lancée.

**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure WLangage à exécuter. Cette procédure retourne un résultat.

**`<Paramètre 1> : (Type quelconque optionnel)`**

Premier paramètre optionnel à passer à la procédure. Ces paramètres sont toujours passés par valeur.



**`<Paramètre N> : (Type quelconque optionnel)`**

Nème paramètre optionnel à passer à la procédure. Ces paramètres sont toujours passés par valeur.


<a name="SYNTAXE2"></a>

### Exécuter le traitement d'un champ (syntaxe conservée pour compatibilité)

`Exécute(<Nom du champ> , <Traitement>)`
---

**`<Nom du champ> : (Chaîne de caractères)`**

Nom du champ auquel est associé le traitement à exécuter.

**`<Traitement> : (Chaîne de caractères)`**

Traitement à exécuter :


|   |   |
| --- | --- |
| *Clic* | Code de clic d'un champ (ou d'une option de menu) |
| *Sortie* | Code de sortie du champ<br> |
| *Entrée* | Code d'entrée du champ<br> |
| *Initialisation* | Code d'initialisation du champ<br> |
| *Précédent* | Code de lecture de l'enregistrement précédent (table fichier en parcours programmé uniquement)<br><br> |
| *Suivant* | Code de lecture de l'enregistrement suivant (table fichier en parcours programmé uniquement)<br><br> |
| *Affiche* | Code d'affichage de ligne (table uniquement) <br> |
| *LSortie* | Code de sortie d'une ligne de table<br> |
| *LEntree* | Code d'entrée dans une ligne de table<br> |
| *FIN* | Code de lecture du dernier enregistrement (table uniquement)<br> |
| *Modifie* | Code A chaque modification du champ<br> |
| *DBL* | Code de double-clic sur un élément d'un arbre<br><br><br> |
| *CLD* | Code de clic droit sur un élément d'un arbre<br> |
| *CLI* | Clic (OnClick) (code navigateur)<br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette constante n'est pas disponible. |
| *KDN* | Touche enfoncée (OnKeyDown) (code navigateur)<br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette constante n'est pas disponible. |
| *KPR* | Touche enfoncée et relâchée (OnKeyPressed) (code navigateur)<br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette constante n'est pas disponible. |
| *KUP* | Touche relâchée (OnKeyUp) (code navigateur)<br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette constante n'est pas disponible. |
| *MDN* | Bouton de la souris enfoncé (OnMouseDown) (code navigateur)<br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette constante n'est pas disponible. |
| *MMV* | Souris bouge au-dessus du champ (OnMouseMove) (code navigateur)<br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette constante n'est pas disponible. |
| *MOU* | Souris sort du champ (OnMouseOut) (code navigateur)<br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette constante n'est pas disponible. |
| *MOV* | Souris entre sur le champ (OnMouseOver) (code navigateur)<br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette constante n'est pas disponible. |
| *MUP* | Bouton de la souris relâché (OnMouseUp) (code navigateur)<br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette constante n'est pas disponible. |
| *BLU* | Perte de focus (OnBlur) (code navigateur)<br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette constante n'est pas disponible. |
| *CHG* | Modification (OnChange) (code navigateur)<br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette constante n'est pas disponible. |
| *FOC* | Prise de focus (OnFocus) (code navigateur)<br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette constante n'est pas disponible. |
| *SEL* | Texte sélectionné (OnSelect) (code navigateur)<br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette constante n'est pas disponible. |
| *HLP* | Touche F1 (OnHelp) (code navigateur)<br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette constante n'est pas disponible. |




<a name="SYNTAXE3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Exécuter le traitement d'une fenêtre (syntaxe conservée par compatibilité)

`Exécute([<Nom de la fenêtre>, ] <Type de traitement>)`
---

**`<Nom de la fenêtre> : (Chaîne de caractères optionnelle)`**

Nom de la fenêtre dont il faut exécuter un traitement. Si ce nom n'est pas spécifié, le traitement de la fenêtre en cours est lancé.

**`<Type de traitement> : (Chaîne de caractères)`**

Traitement à exécuter :



|   |   |
| --- | --- |
| INF | Ouverture de la fenêtre |
| FEF | Fermeture de la fenêtre |
| PRF | Prise de focus de la fenêtre |
| PEF | Perte de focus de la fenêtre |
| MOD | Modification de taille de la fenêtre |






<a name="SYNTAXE4"></a>

<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Exécuter l'événement associé à un champ ou une procédure d'une fenêtre (ou d'une page) différente de la fenêtre (ou de la page) en cours
<a name="executer_evenement_associe_champ_une_procedure_une_fenetre_une_page_differente_fenetre_page_cours_ELTPARAGRAPHE000539"></a>Il est possible d'exécuter l'événement associé à un champ ou une procédure d'une fenêtre (ou d'une page) différente de la fenêtre (ou de la page) en cours. Il suffit de préfixer le nom du champ ou de la procédure par le nom de la fenêtre (ou de la page).

Par exemple : 


```wl
// Exécuter l'événement "Clic" du bouton Valider de MaSoeur (fenêtre ou page ouverte)
Exécute("MaSoeur.Valider..CLI")

// Exécuter la procédure PROC1 de MaSoeur (fenêtre ou page ouverte)
Exécute("MaSoeur.PROC1")
```



<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Chaîne passée en paramètre à la fonction Exécute
<a name="chaine_passee_parametre_fonction_docparampagetitleshort_ELTPARAGRAPHE000556"></a>La chaîne passée en paramètre à la fonction **Exécute** ne peut pas être une chaîne construite ou une variable. Il est nécessaire d'utiliser directement la chaîne contenant le nom du champ, de la fenêtre ou de la page et le traitement/événement à exécuter.


```wl
// Code correct
Exécute("Saisie2..Sortie")

// Code incorrect
i est un entier = 5
Exécute("Saisie" + i + "..Sortie")
```

<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Les tableaux
<a name="les_tableaux_ELTPARAGRAPHE000572"></a>La fonction **Exécute** ne reconnaît pas les tableaux.

Par exemple :


```wl
var_tab est un tableau de 10 chaînes
// Appel une procédure MAPROC avec un tableau passé en paramètre
MAPROC(var_tab)
// L'instruction suivante provoque une erreur
Exécute("MAPROC..PRO", var_tab)
```

<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Ouverture de la fenêtre/page
<a name="ouverture_fenetrepage_ELTPARAGRAPHE000588"></a>La fonction **Exécute** ne doit pas être appelée pour exécuter l'événement WLangage d'ouverture d'une fenêtre/page car les variables globales risquent d'être ré-initialisées. Il faut dans ce cas utiliser des procédures.
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Appeler une procédure globale de composant
<a name="appeler_une_procedure_globale_composant_ELTPARAGRAPHE000600"></a>La fonction **Exécute** permet d'appeler une procédure globale de composant. Il suffit d'utiliser la syntaxe suivante :


```txt
Exécute(<Nom Composant>.<Nom Collection de procédures>.<Nom Procédure>)
```


Exemple : 


```wl
Exécute("MonComposant.Collection_WDExemple.MaProcédure")
```


Dans un thread lancé par un composant, il n'est pas possible d'appeler une procédure locale d'une fenêtre du projet hôte par **Exécute**.

Il est nécessaire d'utiliser un procédure globale du projet hôte qui rappelle la procédure locale de la fenêtre.
<a name="NOTE0_6"></a>
<a name="NOTE0_7"></a>

<a name="XComposante"></a>

## Composante :
wd280vm.dll
