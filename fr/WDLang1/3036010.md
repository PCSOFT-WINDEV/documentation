
## fAttribut (Fonction)

***En anglais : fAttribute***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie ou modifie les attributs d'un fichier.

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Dans cette version, il est possible uniquement de connaître les attributs d'un fichier.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003036010&name=fattribut_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Récupération des attributs d'un fichier
ResAttribut = fAttribut(CheminFichier + "\Fichier.txt")
SI ResAttribut <> "ERR" ALORS
	...
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Récupérer les attributs d'un fichier ou d'un répertoire

`<Résultat> = fAttribut(<Chemin du fichier>)`
---

**`<Résultat> : (Chaîne de caractères)`**



- "ERR" en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.

- Une ou plusieurs lettres correspondant aux attributs du fichier ("AH" par exemple). 
	Les lettres utilisées sont :

	- **R** : Fichier en lecture seule. Le fichier est uniquement accessible en lecture.

	- **H** : Fichier caché. Le nom du fichier est généralement grisé ou invisible dans l'explorateur. 
			

	- **S** : Fichier système. Le fichier est un fichier système Windows.
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette valeur n'est pas disponible.

	- **A** : Fichier "archive". Cet attribut indique que le fichier peut être archivé. Certains programmes se servent de cet attribut pour savoir quels fichiers ont été sauvegardés.
			![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette valeur n'est pas gérée.

	- **D** : Répertoire ou sous-répertoire. Le fichier est un répertoire ou un sous-répertoire.

	- **C** : Fichier compressé (sur les partitions NTFS). Le fichier a été automatiquement compressé lors de sa copie sur une partition NTFS (Windows NT ou 2000).
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette valeur n'est pas disponible.

	- **L** : Lecteur. Le nom donné correspond au nom de volume d'un des disques accessible depuis le poste.
			







**`<Chemin du fichier> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier (260 caractères maximum). Un chemin de type UNC peut être utilisé.
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Modifier les attributs d'un fichier ou d'un répertoire

`<Résultat> = fAttribut(<Chemin du fichier> , <Attributs du fichier>)`
---

**`<Résultat> : (Chaîne de caractères)`**



- "ERR" en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.

- Une ou plusieurs lettres correspondant aux nouveaux attributs du fichier ("AH" par exemple). Les lettres utilisées sont :

	- **R** : Fichier en lecture seule. Le fichier est uniquement accessible en lecture.

	- **H** : Fichier caché. Le nom du fichier est généralement grisé ou invisible dans l'explorateur.

	- **S** : Fichier système. Le fichier est un fichier système Windows.

	- **A** : Fichier "archive". Cet attribut indique que le fichier peut être archivé. Certains programmes se servent de cet attribut pour savoir quels fichiers ont été sauvegardés.

	- **D** : Répertoire ou sous-répertoire. Le fichier est un répertoire ou un sous-répertoire.

	- **C** : Fichier compressé (sur les partitions NTFS). Le fichier a été automatiquement compressé lors de sa copie sur une partition NTFS (Windows NT ou 2000).







**`<Chemin du fichier> : (Chaîne de caractères)`**

Nom et chemin complet ou relatif du fichier (260 caractères maximum). Un chemin de type UNC peut être utilisé.
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.

**`<Attributs du fichier> : (Chaîne de caractères)`**

Une ou plusieurs lettres correspondant aux nouveaux attributs du fichier spécifié ("AH" par exemple). L'ordre des lettres n'a pas d'importance. Les lettres utilisées sont :

- **R** : Fichier en lecture seule. Le fichier est uniquement accessible en lecture.

- **H** : Fichier caché. Le nom du fichier est généralement grisé ou invisible dans l'explorateur.

- **S** : Fichier système. Le fichier est un fichier système Windows.

- **A** : Fichier "archive". Cet attribut indique que le fichier peut être archivé. Certains programmes se servent de cet attribut pour savoir quels fichiers ont été sauvegardés.

- "" (chaîne vide). Tous les attributs sont désactivés.  






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Identification des différents attributs d'un fichier
<a name="identification_des_differents_attributs_fichier_ELTPARAGRAPHE000172"></a>Pour connaître les différents attributs d'un fichier, il suffit de rechercher si l'une des lettres identifiant un attribut est présente dans &lt;Résultat&gt;. Cette recherche peut être effectuée avec la fonction [Position](../WDLang1/3024027.md) par exemple.
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Modifier les attributs d'un fichier (syntaxe 2)
<a name="modifier_les_attributs_fichier_syntaxe_2_ELTPARAGRAPHE000184"></a>Après modification, les attributs du fichier correspondent uniquement aux attributs spécifiés avec la fonction **fAttribut**. Par exemple, si le paramètre &lt;Attributs du fichier&gt; correspond à "AR", le fichier spécifié deviendra un fichier archive en lecture seule.

Cas particuliers :

- Modification d'un répertoire ou d'un sous-répertoire : l'attribut "Répertoire ou sous-répertoire" (lettre D) ne peut pas être modifié. Quelle que soit la modification effectuée, le répertoire (ou le sous-répertoire) conservera l'attribut "Répertoire ou sous-répertoire" (lettre D).

- Modification d'un fichier compressé (sur les partitions NTFS) : l'attribut "Fichier compressé" (lettre C) ne peut pas être modifié. Quelle que soit la modification effectuée, le fichier compressé conservera l'attribut "Fichier compressé" (lettre C).



<a name="NOTE0_3"></a>


### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000199"></a>La fonction **fAttribut** génère une erreur dans les cas suivants :

- le fichier spécifié n'existe pas,

- le nom du fichier spécifié est invalide,

- le fichier spécifié est ouvert ou bloqué par une autre application (uniquement en cas de modification des attributs),

- les lettres indiquées dans le paramètre &lt;Attributs du fichier&gt; ne correspondent pas à des attributs de fichier.



<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Fonctionnement sous Windows Vista (et supérieur)
<a name="fonctionnement_sous_windows_vista_superieur_ELTPARAGRAPHE000218"></a>Si cette fonction ne fonctionne pas correctement sous Windows Vista (et supérieur), il est nécessaire de vérifier si le fichier ou le répertoire manipulé ne se trouve pas dans un des répertoires système (répertoire de Windows ou répertoire "Program Files").

**En effet, sous Windows Vista (et supérieur), avec le [mécanisme de l'UAC](../Editeurs/2025014.md) (contrôle des comptes utilisateurs) activé**, il est nécessaire d'avoir les privilèges administrateur pour manipuler / modifier des fichiers ou des répertoires présents dans les répertoires système (répertoire de Windows ou répertoire "Program Files").

**Conseil de programmation** : Si vous devez manipuler / modifier des fichiers ou des répertoires, sans avoir besoin de privilèges administrateur, il est conseillé :

- de ne pas écrire dans le répertoire de Windows ou dans le répertoire "Program Files",

- d'utiliser le répertoire système correspondant à l'application (connu par la fonction [SysRep](../WDLang1/3073026.md) par exemple avec la constante *srAppDataCommun*).




<a name="XComposante"></a>

## Composante :
wd280std.dll
