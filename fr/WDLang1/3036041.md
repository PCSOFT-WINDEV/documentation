


## fRepCopie (Fonction)

***En anglais : fCopyDir***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Copie le contenu d'un répertoire et éventuellement ses sous-répertoires.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003036041&name=frepcopie_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Copie d'un répertoire
Res = fRepCopie("C:\Répertoire\MesFichiers", "D:\Documents\CopieFichier", ...
		frConfirmer + frJauge + frRécursif)
```


<a name="Exemple2"></a>

```wl
// Copie d'un répertoire
Res = fRepCopie("C:\Répertoire\MesFichiers", "D:\Documents\CopieFichier", FiltreFichier)
```

```wl
PROCEDURE FiltreFichier(sCheminSource, sCheminDestination, flChange, nParamètrePerso)

// On ne copie pas les fichiers temporaires
SI fExtraitChemin(sCheminSource, fExtension) ~= ".tmp"
	RENVOYER fcIgnore
SINON
	RENVOYER fcCopie
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Copier un répertoire

`<Résultat> = fRepCopie(<Chemin du répertoire à copier> , <Chemin du répertoire destination> [, <Indicateur de copie>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la copie a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) <u><u><u><u>Faux</u></u></u></u> si un seul fichier n'est pas copié.

**`<Chemin du répertoire à copier> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du répertoire à copier (260 caractères maximum). Un chemin de type UNC peut être utilisé. Les caractères jokers (\*, ?) sont autorisés dans le nom du fichier. Ce nom de répertoire peut être terminé indifféremment par "\\" ou non.
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les caractères jokers (\*, ?) ne sont pas autorisés dans le nom du fichier.

**`<Chemin du répertoire destination> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du répertoire copié (260 caractères maximum). Un chemin de type UNC peut être utilisé. Ce nom de répertoire peut être terminé indifféremment par "\\" ou non.
Si ce répertoire n'existe pas, il est automatiquement créé.
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.

**`<Indicateur de copie> : (Constante (ou combinaison de constantes) optionnelle)`**

Type de copie à effectuer :


|   |   |
| --- | --- |
| *frConfirmer* | La copie d'un répertoire demande confirmation avant l'écrasement d'un répertoire de même nom.<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |
| *frJauge* | Une fenêtre de progression est affichée.<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *frRécursif* | Les sous-répertoires sont traités. |


Par défaut, &lt;Indicateur de copie&gt; est vide. Aucune des options n'est sélectionnée.  


<a name="SYNTAXE2"></a>

### Copier un répertoire en manipulant chaque fichier copié

`<Résultat> = fRepCopie(<Chemin du répertoire à copier> , <Chemin du répertoire destination> , <Procédure WLangage> [, <Pointeur> [, <Indicateur de copie>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la copie a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Chemin du répertoire à copier> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du répertoire à copier (260 caractères maximum). Un chemin de type UNC peut être utilisé. Les caractères jokers (\*, ?) sont autorisés dans le nom du fichier. Ce nom de répertoire peut être terminé indifféremment par "\\" ou non.

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les caractères jokers (\*, ?) ne sont pas autorisés dans le nom du fichier.

![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.

**`<Chemin du répertoire destination> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du répertoire copié (260 caractères maximum). Un chemin de type UNC peut être utilisé. Ce nom de répertoire peut être terminé indifféremment par "\\" ou non.
Si ce répertoire n'existe pas, il est automatiquement créé.

![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.

**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure WLangage (également nommée "callback") appelée pour chaque fichier copié. Cette procédure permet de manipuler le fichier en cours.

Pour plus de détails sur cette procédure, consultez [Paramètres de la procédure utilisée par la fonction fRepCopie](../WDLang1/1000025347.md). 

**`<Pointeur> : (Entier optionnel)`**

Pointeur passé à la procédure &lt;Procédure WLangage&gt;.

**`<Indicateur de copie> : (Constante optionnelle)`**

Type de copie à effectuer :


|   |   |
| --- | --- |
| *frRécursif* | Les sous-répertoires sont traités. |


Par défaut, &lt;Indicateur de copie&gt; est vide : le traitement n'est pas récursif.   



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Fonctionnement sous Windows Vista (et supérieur)
<a name="fonctionnement_sous_windows_vista_superieur_ELTPARAGRAPHE000311"></a>Si cette fonction ne fonctionne pas correctement sous Windows Vista (et supérieur), il est nécessaire de vérifier si le fichier ou le répertoire manipulé ne se trouve pas dans un des répertoires système (répertoire de Windows ou répertoire "Program Files").

**En effet, sous Windows Vista (et supérieur), avec le [mécanisme de l'UAC](../Editeurs/2025014.md) (contrôle des comptes utilisateurs) activé**, il est nécessaire d'avoir les privilèges administrateur pour manipuler / modifier des fichiers ou des répertoires présents dans les répertoires système (répertoire de Windows ou répertoire "Program Files").

**Conseil de programmation** : Si vous devez manipuler / modifier des fichiers ou des répertoires, sans avoir besoin de privilèges administrateur, il est conseillé :

- de ne pas écrire dans le répertoire de Windows ou dans le répertoire "Program Files",

- d'utiliser le répertoire système correspondant à l'application (connu par la fonction [SysRep](../WDLang1/3073026.md) par exemple avec la constante *srAppDataCommun*).


**Remarque** : Sous Windows Vista (et supérieur), le mécanisme de la virtualisation permet de rendre les applications compatible Vista. Si le fichier est créé dans un répertoire système sans avoir les droits nécessaires, ce fichier sera réellement créé dans un autre répertoire (C:\\Users\\&lt;LOGIN&gt;AppData\\Local\\VirtualStore\\Windows\\). Dans ce cas, le fichier ne pourra pas être partagé entre plusieurs applications.

<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280std.dll
