


## TableAffiche (Fonction)

***En anglais : TableDisplay***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Rafraîchit l'affichage d'un champ Table ou Table hiérarchique à partir d'une position donnée :

- pour un champ Table ou Table hiérarchique "fichier" : les modifications effectuées sur le fichier de données lié sont répercutées dans le champ.

- pour un champ Table ou Table hiérarchique "par programmation" : les colonnes calculées sont re-calculées.





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Rafraîchissement du champ "TABLE_TableProduit" à partir du début
TableAffiche(TABLE_TableProduit, taDébut)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`TableAffiche(<Champ Table> [, <Position>])`
---

**`<Champ Table> : (Nom de champ)`**

Nom du champ à rafraîchir. Ce champ peut correspondre :

- à un champ Table, 

- à un champ Table hiérarchique.


Si ce paramètre correspond à une chaîne vide (""), le champ auquel appartient l'événement en cours est rafraîchi.

**`<Position> : (Entier, caractère ou constante (optionnel))`**

Indique la position de départ du rafraîchissement. Si ce paramètre n'est pas spécifié :

- ***Dans le cas d'un champ "fichier"***, la fonction se comporte comme si la constante *taInit* avait été passée en paramètre.

- ***Dans le cas d'un champ "par programmation"***, la fonction n'a aucun effet.




Ce paramètre peut correspondre à :

- Un entier. Le rafraîchissement est effectué à partir de cette position. La ligne sélectionnée dans le champ n'est pas modifiée.
	***Dans le cas d'un champ "fichier"***, l'événement "Affichage de la ligne" &lt;Position&gt; est exécuté. La ligne en cours dans le champ correspond à l'enregistrement en cours dans le fichier de données.
	***Dans le cas d'un champ "par programmation"***, la ligne &lt;Position&gt; est ré-affichée.

- Un caractère ou une constante :
	

|   | Champ Table ou Table hiérarchique Fichier | Champ Table ou Table hiérarchique Fichier chargé en mémoire | Champ Table ou Table hiérarchique par programmation |
| --- | --- | --- | --- |
| *taDébut*<br>(Valeur par défaut) | <br><br>	- Rafraîchit le champ en se positionnant au début du champ.<br><br>	- La première ligne du champ est sélectionnée. Cette ligne correspond au premier enregistrement du fichier de données.<br><br><br> | Aucun effet. | Aucun effet. |
| *taCourantBandeau* | <br><br>	- Rafraîchit le champ à partir de la position du bandeau de sélection.<br><br>	- La position du bandeau de sélection n'est pas modifiée. L'enregistrement courant dans le fichier de données correspondra à l'enregistrement sélectionné dans le champ (après exécution de la fonction **TableAffiche**).<br><br><br> | <br><br>	- Ré-affiche le champ en ré-initialisant les valeurs des colonnes calculées.<br><br>	- La ligne sélectionnée est inchangée.<br><br><br> | <br><br>	- Ré-affiche le champ en re-calculant les valeurs des colonnes calculées.<br><br>	- La ligne sélectionnée est inchangée.<br><br><br> |
| *taCourantEnreg* | <br><br>	- Ré-exécute la requête liée si nécessaire.<br><br>	- Prend en compte des enregistrements ajoutés, modifiés, supprimés par d'autres postes.<br><br>	- Sélectionne l'enregistrement courant (si le parcours défini dans le champ se fait sur une clé unique). Si l'enregistrement courant est supprimé ou ne correspond pas au filtre, sélectionne l'enregistrement suivant non supprimé.<br>		S'il y a des doublons sur la rubrique de parcours, la ligne sélectionnée parmi les doublons sera indéterminée.<br><br>	- La position de l'ascenseur est conservée tant que la sélection reste visible.<br><br>	- Exécute les événements de début et de fin d'initialisation, puis l'événement "Sélection de la ligne" pour la ligne sélectionnée (même si elle n'est pas modifiée).<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. | Aucun effet. | Aucun effet. |
| *taCourantPremier* | <br><br>	- Rafraîchit le champ à partir de l'enregistrement courant dans le fichier de données.<br><br>	- La première ligne du champ est sélectionnée. Cette ligne correspond à l'enregistrement courant.<br><br><br> | <br><br>	- Ré-affiche le champ en recalculant les valeurs des colonnes calculées.<br><br>	- La ligne sélectionnée est inchangée.<br><br><br> |
| *taInit* | <br><br>	- Exécute les codes d'initialisation du champ (code d'initialisation et de fin d'initialisation).<br><br>	- Exécute le code d'initialisation des colonnes du champ.<br><br>	- Remplit le champ.<br><br>	- La première ligne du champ Table est sélectionnée. Cette ligne correspond à l'enregistrement en cours dans le fichier de données lors de la fin du code d'initialisation du champ.<br><br><br> | Aucun effet.<br> | Aucun effet. |
| *taPrécédent* | <br><br>	- Rafraîchit le champ en se positionnant au début du champ de la page précédente (équivalent à l'utilisation de la réglette pour accéder à la page précédente).<br><br>	- La première ligne visible du champ est sélectionnée. Cette ligne correspond à l'enregistrement courant dans le fichier de données.<br><br><br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette constante n'est pas disponible. | Aucun effet. | Aucun effet. |
| *taRéExécuteRequête* | <br><br>	- Ré-exécute la requête liée au champ. Pour plus de détails, consultez [Champ Table et requêtes](../WDChamp/1013203.md).<br><br>	- Rafraîchit le champ en se positionnant au début du champ.<br><br>	- La première ligne du champ est sélectionnée. Cette ligne correspond au premier enregistrement dans le résultat de la requête.<br><br><br>**Attention** : Seule la requête liée au champ est exécutée. Si des options spécifiques ont été précisées avec la fonction [HExécuteRequête](../WDLang4/3044080.md) (par exemple, utilisation de la constante *hModifieFichier*), ces options ne sont pas prises en compte. | Aucun effet. | Aucun effet. |
| *taSuivant* | <br><br>	- Rafraîchit le champ en se positionnant au début du champ Table de la page suivante (équivalent à l'utilisation de la réglette pour accéder à la page suivante).<br><br>	- La première ligne visible du champ est sélectionnée. Cette ligne correspond à l'enregistrement courant dans le fichier de données.<br><br><br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette constante n'est pas disponible. | Aucun effet | Aucun effet. |








<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000214"></a>La fonction **TableAffiche** peut être utilisée indifféremment sur :

- un champ Table ou Table hiérarchique fichier.

- un champ Table ou Table hiérarchique par programmation.

- un champ monosélection ou multisélection.



<a name="NOTE0_2"></a>


### Cas particuliers
<a name="cas_particuliers_ELTPARAGRAPHE000237"></a>La fonction **TableAffiche** est sans effet :

- Si le paramètre &lt;Position&gt; est un entier et si cet entier est invalide.

- Si le paramètre &lt;Position&gt; est un entier et si le paramètre &lt;Champ Table&gt; est un champ Table fichier en mode "ascenseur à rebond".




**Rappel** : L'ascenseur à rebond est un ancien mode de fonctionnement. Lorsqu'un ascenseur est à rebond, la cage de l'ascenseur revient au milieu de l'ascenseur à chaque clic sur les boutons de l'ascenseur (ou en utilisant la touche flèche haut ou flèche bas). Pour qu'un ascenseur soit à rebond, décochez l'option "Ascenseur proportionnel" dans l'onglet "Détail" de la fenêtre de description du champ.

<a name="NOTE0_3"></a>


### Astuce pour les champs Table et Table hiérarchique fichier
<a name="astuce_pour_les_champs_table_table_hierarchique_fichier_ELTPARAGRAPHE000264"></a>Pour afficher un calcul dans une colonne calculée ou pour mettre en forme une cellule (par exemple "fond rouge si valeur supérieure à 50"), utilisez l'événement "Affichage de ligne" du champ.
<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Connecteurs Natifs (Accès Natifs)](https://doc.pcsoft.fr/ext/images/fr/AN.png) 

### Connecteur Natif SQL Server
<a name="connecteur_natif_sql_server_ELTPARAGRAPHE000275"></a>Si la fonction **TableAffiche** manipule un champ lié à un fichier de données accédé par le Connecteur Natif SQL Server, il est conseillé d'utiliser les constantes *taCourantPremier* et *taDébut*.
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Divers
<a name="divers_ELTPARAGRAPHE000289"></a>La constante ***taDepuisFichier*** est identique à la constante ***taCourantPremier***. Cette constante est conservée par compatibilité avec les versions précédentes et apparaît en orange sous l'éditeur de code.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
