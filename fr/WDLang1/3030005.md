
## DnDAccepte (Fonction)

***En anglais : DnDAccept***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Indique l'action acceptée par la cible du glisser/déplacer et gère le curseur de souris lors du glisser/déplacer.

**Remarque** : La fonction **DnDAccepte** doit être utilisée lors de l'appel de l'événement *dndLâcher* (fonction [DnDEvénement](../WDLang1/3030006.md)).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003030005&name=dndaccepte_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Procédure appelée par l'événement dndLâcher
PROCEDURE SurLâcher()
// Seul le déplacement est autorisé (pas la copie)
DnDAccepte(dndDéplacer)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`DnDAccepte(<Action autorisée>)`
---

**`<Action autorisée> : (Constante)`**

Action autorisée sur le champ cible :


|   |   |
| --- | --- |
| *dndCopier* | Copie des données autorisée dans le champ cible. Le curseur de copie sera affiché lors de la copie : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=dndcp.gif)<br> |
| *dndDéfaut* | Copie ou déplacement des données autorisé dans le champ cible. <br>Le curseur par défaut sera affiché lors du déplacement :![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=flechdnd.gif)<br><br>(pour effectuer une copie, la touche Ctrl doit être maintenue enfoncée lors du déplacement des données. Le curseur par défaut sera alors :![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=dndcp.gif)<br>). |
| *dndDéplacer* | Déplacement des données autorisé dans le champ cible. Le curseur de déplacement sera affiché lors du déplacement : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=flechdnd.gif)<br> |
| *dndInterdit* | Toute action interdite dans le champ cible. Le curseur "interdit" sera affiché lors de la copie/du déplacement : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=dndinter.gif)<br> |







<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Variables
<a name="variables_ELTPARAGRAPHE000079"></a>Les variables suivantes peuvent être utilisées :

| Nom de la variable | Description |
| --- | --- |
| **_DND.Action** | Action spécifiée dans la fonction **DnDAccepte**.<br><br>Les différentes valeurs possibles sont les suivantes : *dndCopier*, *dndDéplacer* et *dndInterdit*.<br><br>Cette variable n'est pas renseignée lors du début d'un glisser/déplacer dans un champ source (constante *dndDébutGlisser*) ou lors de la sortie d'un champ cible (constante *dndSortieChamp*). |
| **_DND.ChampCible** | Nom du champ cible.<br><br>Cette variable n'est pas renseignée lors du début d'un glisser/déplacer dans un champ source (constante *dndDébutGlisser*) ou lors de la sortie d'un champ cible (constante *dndSortieChamp*). |
| **_DND.ChampSource** | Nom du champ source. |
| **_DND.CtrlEnfoncé** | Etat de la touche contrôle Ctrl :<br><br>- Vrai : la touche contrôle Ctrl est enfoncée.<br><br>- Faux : la touche contrôle Ctrl n'est pas enfoncée.<br><br><br>Cette variable n'est pas renseignée lors du début d'un glisser/déplacer dans un champ source (constante *dndDébutGlisser*) ou lors de la sortie d'un champ cible (constante *dndSortieChamp*). |
| **_DND.FenSource** | Nom de la fenêtre source.<br><br>Cette variable n'est pas renseignée lors de la sortie d'un champ cible (constante *dndSortieChamp*). |
| **_DND.SourisPosX** | Position horizontale (X) du curseur de souris par rapport au champ manipulé lors de l'événement.<br><br>Cette variable n'est pas renseignée lors de la sortie d'un champ cible (constante *dndSortieChamp*). |
| **_DND.SourisPosY** | Position verticale (Y) du curseur de souris par rapport au champ manipulé lors de l'événement.<br><br>Cette variable n'est pas renseignée lors de la sortie d'un champ cible (constante *dndSortieChamp*). |


Les variables **_DND.ChampSource** et **_DND.FenSource** retournent une chaîne vide ("") lorsque le glisser/déplacer provient d'une application différente de l'application en cours.

Lors d'un "Glisser / Déplacer", il faut supprimer par programmation les données de la source dans le code correspondant au "Lâcher" (en testant **_DND.Action** et **_DND.ChampSource**).



<a name="XComposante"></a>

## Composante :
wd280obj.dll
