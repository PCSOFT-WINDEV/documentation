


## Procédure WLangage appelée par la fonction fListeRépertoire



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Procédure (également appelée "Callback") appelée par la fonction [fListeRépertoire](../WDLang1/3036062.md) pour chaque fichier trouvé. Cette procédure peut être une procédure locale, globale ou interne.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Déclaration et initialisation des variables

// Nombre de répertoires répondant aux critères
NbRepertoireLS est un entier  
NbRépertoire est un entier = 0
CritèreRecherche est une chaîne
// Sélection du répertoire dans lequel les répertoires vont être listés
CritèreRecherche = fRepSélecteur("", "Sélectionner un répertoire", ...
		"Recherche des répertoires cachés")
// Liste des répertoires
NbRepertoireLS = fListeRépertoire("C:\MesDocuments", "AttributRépertoire", ...
		&NbRepertoireLS)
// Affichage du nombre de fichiers répondant aux critères
Info("Il y a " + NbRepertoireLS + " répertoires cachés sur " + ...
		NbRepertoire + " répertoires listés")
```

```wl
// --------------------------------------------------------
// Procédure locale appelée par la fonction fListeRépertoire
PROCEDURE AttributRepertoire(Répertoire, Nom, Change, NbRepertoire)
// Déclaration de la variable
NbRepertoireLS est un entier
// Répertoire caché ?
SI Position(fAttribut(Répertoire + Nom), "H") <> 0 ALORS
	Transfert(&NbrepertoireLS, NbRepertoire, 4)
   	NbRepertoireLS ++
   	Transfert(NbRepertoire, &NbRepertoireLS, 4)
   	// Affichage du nom du répertoire dans la liste "LISTE_ListeFichier"
   	ListeAjoute(LISTE_ListeFichier, Répertoire + Nom)
FIN
RENVOYER Vrai
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = fListeRépertoire_Callback(<Chemin> , <Nom du répertoire> [, <Change> [, <Pointeur de la procédure>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> pour continuer le parcours des fichiers,

- <u><u><u><u>Faux</u></u></u></u> pour forcer l'interruption du parcours des fichiers.




**`<Chemin> : (Chaîne de caractères)`**

Chemin du répertoire manipulé (il contient toujours un "\\" à la fin; par exemple, "C:\\Mes Fichiers\\").

**`<Nom du répertoire> : (Chaîne de caractères)`**

Nom du répertoire trouvé.

**`<Change> : (Constante optionnelle de type Entier)`**

Permet de savoir si un changement de répertoire a été effectué. Les valeurs possibles sont les suivantes : 


|   |   |
| --- | --- |
| flChangeRépertoire | Le répertoire est le premier listé dans un sous-répertoire de &lt;Chemin&gt; (cela signifie qu'il y a eu changement de répertoire). |
| flRépertoire | Tous les autres cas. |



**`<Pointeur de la procédure> : (Entier optionnel)`**

Valeur passée dans le paramètre &lt;Pointeur&gt; de la fonction [fListeRépertoire](../WDLang1/3036062.md). Si le paramètre &lt;Pointeur&gt; n'est pas précisé dans la fonction [fListeRépertoire](../WDLang1/3036062.md), &lt;Pointeur de la procédure&gt; vaut 0.

Pour récupérer la valeur du &lt;Pointeur de la procédure&gt;, affectez la valeur du &lt;Pointeur de la procédure&gt; à la valeur du &lt;Pointeur&gt; dans la procédure avec la fonction [Transfert](../WDLang1/3014015.md) (voir Exemple détaillé accessible en haut de page).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Exemple de valeurs pouvant être prises par le paramètre &lt;Change&gt;
<a name="exemple_valeurs_pouvant_etre_prises_par_parametre_ELTPARAGRAPHE000070"></a>Lors du parcours des fichiers listés par la fonction [fListeRépertoire](../WDLang1/3036062.md), voici les différentes valeurs pouvant être prises par &lt;Change&gt; : 


| Répertoire en cours | &lt;Change&gt; |
| --- | --- |
| Rep\\Répertoire 1 | *flRépertoire* |
| Rep\\Répertoire n | *flRépertoire* |
| Rep\\SousRep 1\\Répertoire 1 | *flChangeRépertoire* |
| Rep\\SousRep 1\\Répertoire m | *flRépertoire* |
| Rep\\SousRep 2\\Répertoire 1 | *flChangeRépertoire* |
| Rep\\SousRep 2\\Répertoire x | *flRépertoire* |


<a name="NOTE0_2"></a>


### Interruption complète de la fonction fListeRépertoire
<a name="interruption_complete_fonction_flisterepertoire_ELTPARAGRAPHE000110"></a>Tant qu'il y a des fichiers à parcourir, la fonction [fListeRépertoire](../WDLang1/3036062.md) ne peut pas être interrompue.

Pour forcer l'interruption du parcours complet, utilisez la ligne suivante dans la procédure :


```wl
RENVOYER Faux
```


Dans ce cas, la fonction [fListeRépertoire](../WDLang1/3036062.md) retourne le nombre de répertoires parcourus jusqu'à l'appel de "Renvoyer Faux".

Dans les autres cas (pour poursuivre le parcours), la procédure &lt;Nom de la procédure&gt; DOIT renvoyer <u><u><u><u>Vrai</u></u></u></u>.

Si la procédure &lt;Nom de la procédure&gt; retourne aucune valeur (ni <u><u><u><u>Vrai</u></u></u></u>, ni <u><u><u><u>Faux</u></u></u></u>), une erreur est générée.


## Composante :
wd280std.dll
