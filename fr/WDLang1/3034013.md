


## Gestion automatique des exceptions
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000159"></a>
La gestion des exceptions peut être personnalisée par traitement.

Vous pouvez choisir d'utiliser un traitement automatique d'exception ou opter pour une gestion avancée grâce à différentes fonctions WLangage.

**Important** : La gestion automatique des erreurs et des exceptions fonctionne uniquement pour le traitement pour lequel elle est définie. Pour utiliser un traitement global et unique en cas d'exception, il faut utiliser le [mécanisme des exceptions générales](../WDLang1/3034001.md).




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Gestion automatique des exceptions
<a name="gestion_automatique_des_exceptions_ELTTEXTE000183"></a>


### Mettre en place la gestion automatique des exceptions
<a name="mettre_place_gestion_automatique_des_exceptions_ELTPARAGRAPHE000042"></a>Pour mettre en place la gestion automatique des exceptions : 

1. Affichez sous l'éditeur de code, le traitement dans lequel les exceptions doivent être traitées : code d'initialisation, code de clic, procédure, ...

2. Dans l'entête du code, cliquez sur "Quand exception : par programme".

3. La fenêtre qui s'affiche permet de spécifier le type de traitement automatique à effectuer :
	<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Exception_auto_1.gif&type=thumb)





Une gestion avancée des erreurs peut être réalisée grâce à la fonction [ExceptionChangeParamètre](../WDLang1/3034007.md).
<a name="NOTE2_2"></a>


### Exécuter le traitement d'erreur ("CAS EXCEPTION:" dans le code)
<a name="executer_traitement_erreur_cas_exception_dans_code_ELTPARAGRAPHE000060"></a>Si cette option est sélectionnée, une ligne de code est ajoutée dans le code en cours "CAS EXCEPTION:". Les lignes de code suivant cette étiquette seront exécutées lorsqu'une exception sera rencontrée dans les lignes de code précédentes (ou dans un traitement appelé par ces lignes de code).

Par exemple :

```wl
CAS EXCEPTION:
// Affichage d'un message d'erreur
Erreur("Une erreur fatale a été détectée.", ExceptionInfo(), "", "Arrêt de la procédure.")
// Gestion de cette erreur
...
```
Cette option est conseillée pour regrouper par exemple tous les traitements d'exception pouvant survenir.
<a name="NOTE2_3"></a>


### Exécuter une procédure de traitement d'exception :
<a name="executer_une_procedure_traitement_exception_ELTPARAGRAPHE000071"></a>Si cette option est sélectionnée, lorsqu'une exception sera rencontrée dans le traitement en cours (ou dans les traitements appelés par le traitement en cours), la procédure indiquée sera automatiquement exécutée pour traiter l'erreur. Cette option est conseillée si vous possédez dans votre application une procédure existante traitant les exceptions. L'appel à cette procédure sera automatique dès qu'une exception est rencontrée. Aucun test à faire.

Dans cette procédure, il est possible de renvoyer une des constantes présentées dans le tableau ci-dessous.

En fonction de la constante renvoyée, WINDEV, WEBDEV ou WINDEV Mobile effectuera le traitement correspondant.


|   |   |
| --- | --- |
| ***opAnnuler*** | Relance l'exception |
| ***opFinProgramme*** | La fonction ayant déclenché l'erreur renvoie une erreur et le programme s'arrête. Équivalent à la fonction [FinProgramme](../WDLang1/3013033.md). |
| ***opFinTraitement*** | La fonction ayant déclenché l'erreur renvoie une erreur et le traitement en cours s'arrête. Équivalent à la fonction [DonneFocusEtRetourUtilisateur](../WDLang1/1410088107.md). |
| ***opRelanceProgramme*** | Termine l'application et relance automatiquement l'application.<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Fonctions de gestion automatique des exceptions
<a name="fonctions_gestion_automatique_des_exceptions_ELTTEXTE000219"></a>



|   |   |
| --- | --- |
| [ExceptionActive](../WDLang1/3034002.md) | Ré-active le traitement d'exception en cours si l'exception a pu être corrigée. |
| [ExceptionAffiche](../WDLang1/1000019408.md) | Affiche la fenêtre standard des exceptions avec le contenu de l'exception courante. |
| [ExceptionChangeParamètre](../WDLang1/3034007.md) | Paramètre le comportement automatique à adopter en cas d'exception dans le traitement en cours. |
| [ExceptionDéclenche](../WDLang1/3034005.md) | Déclenche artificiellement le mécanisme de sécurité de WLangage en provoquant une exception. |
| [ExceptionInfo](../WDLang1/3034006.md) | Récupère des informations sur l'exception en cours. |
| [ExceptionPropage](../WDLang1/3034014.md) | Propage une exception. |
| [ExceptionRestaureParamètre](../WDLang1/3034008.md) | Rétablit le traitement d'exception d'un traitement. |






