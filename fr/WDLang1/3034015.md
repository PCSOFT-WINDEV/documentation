
## ErreurPropage (Fonction)

***En anglais : ErrorPropagate***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Propage une erreur non fatale qui pourra être traitée par le code appelant si ce code a activé une gestion des erreurs non fatales (sous l'éditeur de code, ou par la fonction [ErreurChangeParamètre](../WDLang1/3034009.md)).

L'erreur est traitée par le niveau supérieur si :

- le niveau supérieur a activé un traitement d'erreur.

- l'erreur n'est pas gérée par un SI ... PAS ou par la variable [ErreurDétectée](../WDLang1/3087001.md).





<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Propager une erreur non fatale (en ajoutant un message si nécessaire)

`ErreurPropage([<Message>])`
---

**`<Message> : (Chaîne de caractères optionnelle)`**

Message supplémentaire pouvant être ajouté à l'erreur. Ce message est inséré au début de l'erreur.  


<a name="SYNTAXE2"></a>

### Propager une erreur non fatale en modifiant le numéro de l'erreur (et en ajoutant un message si nécessaire)

`ErreurPropage(<Numéro> [, <Message>])`
---

**`<Numéro> : (Entier)`**

Numéro de l'erreur, défini par le développeur. Ce numéro doit être compris entre 1 et 1000. Ce numéro remplace le numéro de l'erreur existant. 

**`<Message> : (Chaîne de caractères optionnelle)`**

Message supplémentaire pouvant être ajouté à l'erreur. Ce message est inséré au début de l'erreur.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Comment obtenir des informations sur l'erreur traitée ? 
<a name="comment_obtenir_des_informations_sur_erreur_traitee_ELTPARAGRAPHE000084"></a>La fonction [ErreurInfo](../WDLang1/3013008.md) permet de récupérer les informations de l'erreur.


<a name="NOTE0_2"></a>




### Exemple d'utilisation 
<a name="exemple_utilisation_ELTPARAGRAPHE000096"></a>But : Encapsuler la fonction **fOuvre** dans une procédure tout en remontant l'erreur de la fonction fOuvre (si elle apparaît) : 


```wl
PROCEDURE OuvreFichier(LOCAL sNomFichier est une chaîne)

fOuvre(sNomFichier)
SI ErreurDétectée = Vrai ALORS
	ErreurPropage()
	RETOUR		// ou RENVOYER
FIN
...
```


Il est ensuite possible d'appeler la procédure **OuvreFichier** : 


```wl
...
OuvreFichier(sNomFichier)
SI ErreurDétectée = Vrai ALORS
	// traitement de l'erreur
FIN
```


**Note** : Il est bien sûr possible de faire l'équivalent avec les modes automatiques de gestion des erreurs.
<a name="NOTE0_3"></a>




### Cas particulier
<a name="cas_particulier_ELTPARAGRAPHE000112"></a>Le mécanisme de traitement de l'erreur, qu'il soit automatique (géré par la [fenêtre de gestion des erreurs](../WDLang1/3034010.md)) ou par programmation (fonction [ErreurChangeParamètre](../WDLang1/3034009.md)) ne se déclenche pas si la fonction WLangage ou la procédure utilisateur se trouve dans un des cas suivants :


```txt
SI PAS <Fonction ou procédure> ALORS
	// traitement de l'erreur
FIN
```



```txt
<Fonction ou procédure>
SI ErreurDétectée = Vrai ALORS
	// traitement de l'erreur
FIN
```


Le mécanisme considère alors que l'erreur est traitée par programmation et ne déclenche pas le traitement automatique.



<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280vm.dll
