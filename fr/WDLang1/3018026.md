


## ArbreInfoXY (Fonction)

***En anglais : TreeInfoXY***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie l'élément d'un champ Arbre se trouvant à une position donnée.

Exemple de champ Arbre :
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Arbre_Vocabulaire.gif)

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// -- Clic sur le champ Arbre ARBRE_Arbre1
X, Y sont des entiers
X = PoidsFaible(CurseurPos())
Y = PoidsFort(CurseurPos())
// Recherche du numéro de la ligne correspondant au clic
LigneClic est un entier 
LigneClic = ArbreInfoXY(ARBRE_Arbre1, aiNumLigne + aiOrigineEcran, X, Y)
// Recherche du nom de la branche
Branche est une chaîne 
Branche = ArbreInfoXY(ARBRE_Arbre1, aiNomBranche + aiOrigineEcran, X, Y)
Trace("Vous avez cliqué sur la branche " + ...
		Branche + "(ligne n°" + LigneClic + ")")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ArbreInfoXY(<Champ Arbre> , <Type d'information> , <X> , <Y>)`
---

**`<Résultat> : (Chaîne de caractères, entier ou constante de type Entier)`**

Information demandée :

- Numéro de la ligne au point spécifié, -1 s'il n'y a pas de ligne.

- Nom de la branche au point spécifié, chaîne vide ("") s'il n'y a pas de branche.

- Type de la zone survolée. Ce type correspond à une des constantes suivantes :
	


|   |   |
| --- | --- |
| *aizBouton* | Bouton "+ / -" situé devant le libellé de l'élément du champ Arbre. |
| *aizCoche* | Coche de l'élément. |
| *aizDroite* | Espace situé à droite du libellé de l'élément. |
| *aizEnDehors* | Espace situé sous les éléments du champ Arbre. |
| *aizGauche* | Espace situé à gauche du libellé de l'élément. |
| *aizImage* | Image située devant le libellé de l'élément. |
| *aizLibellé* | Libellé de l'élément. |






**`<Champ Arbre> : (Nom de champ)`**

Nom du champ Arbre à manipuler.
Si ce paramètre correspond à une chaîne vide (""), la fonction **ArbreInfoXY** manipule le champ Arbre auquel appartient l'événement en cours.

**`<Type d'information> : (Constante ou combinaison de constantes)`**

Type d'information demandée :


|   |   |
| --- | --- |
| *aiArbreID* | Identifiant de l'élément au point (X,Y). |
| *aiNomBranche* | Nom de l'élément au point (X, Y). |
| *aiNumLigne* | Numéro de la ligne au point (X, Y). |
| *aiOrigineEcran* | Si cette option est précisée, l'origine des coordonnées spécifiées correspond à l'écran et non au champ Arbre.<br>Cette constante ne peut pas être utilisée seule. |
| *aiZone* | Type de la zone survolée |



**`<X> : (Entier)`**

Coordonnée X (en pixels) à analyser. Cette coordonnée est relative au champ Arbre (si la constante *aiOrigineEcran* n'est pas précisée).

**`<Y> : (Entier)`**

Coordonnée Y (en pixels) à analyser. Cette coordonnée est relative au champ Arbre (si la constante *aiOrigineEcran* n'est pas précisée).  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Numéro de la ligne au point spécifié
<a name="numero_ligne_point_specifie_ELTPARAGRAPHE000131"></a>Si la constante *aiNumLigne* est utilisée, la fonction **ArbreInfoXY** renvoie le numéro de la ligne au point spécifié. Ce numéro de ligne est un numéro de ligne "instantané", tenant compte des éléments déroulés au dessus de la ligne. 
Cette ligne peut ensuite être manipulée en utilisant la syntaxe : 

```txt
<Champ Arbre>[<Numéro de la ligne à manipuler>]
```


Pour plus de détails sur les différentes syntaxes permettant de manipuler un élément d'une ligne, consultez [Manipuler un élément d'un champ Arbre par programmation](../WDChamp/1013040.md).
<a name="NOTE0_2"></a>


### Détail des différents éléments obtenus avec la constante aiZone
<a name="detail_des_differents_elements_obtenus_avec_constante_aizone_ELTPARAGRAPHE000152"></a>Le dessin ci-dessous présente les différentes zones pouvant être récupérées avec la constante *aiZone*.
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Arbre_InfoXY.gif)

<a name="NOTE0_3"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000162"></a>La fonction **ArbreInfoXY** peut être utilisée avec un champ Arbre gérant les doublons. Pour plus de détails, consultez [Gestion des doublons dans les champs Arbre](../WDChamp/1013053.md).

<a name="XComposante"></a>

## Composante :
wd280obj.dll
