
## ImageInfoSauve (Fonction)

***En anglais : ImageInfoSave***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Enregistre les modifications effectuées sur les marqueurs Exif d'une image à l'aide de la fonction [ImageInfoModifie](../WDLang1/3091005.md).

**Remarques** :

- Les informations Exif (EXchangeable Image File) sont incorporées dans le fichier image lui-même. Cette norme définit un ensemble de marqueurs qui permettent de stocker de nombreuses informations relatives à l'image : date, largeur, orientation, modèle de l'appareil photo, vitesse d'obturation, distance du sujet, temps d'exposition, ...

- La fonction [dSauveImageJpeg](../WDLang1/3029038.md) permet également d'enregistrer les modifications effectuées sur les marqueurs Exif d'une image présente dans un champ Image ou une variable de type [Image](../WDLang1/1000019650.md).

- Pour manipuler les marqueurs Exif d'une image, il est également possible d'utiliser la propriété **Exif** des variables de type [Image](../WDLang1/1000019650.md). Cette propriété peut être utilisée pour les applications Android. 



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
CheminImg est une chaîne = "C:\Voyage\Maurice1.JPG" 
// Modification du copyright et de la description
ImageInfoModifie(CheminImg, imgCopyright, "PC Soft" + DateSys())
ImageInfoModifie(CheminImg, imgDescription, "Paysage de rêve")
// Enregistrement de la modification dans le
// même fichier image
ImageInfoSauve(CheminImg)
// Fermeture du fichier image
ImageInfoFerme(CheminImg)
```


<a name="Exemple2"></a>



```wl
// Modification des commentaires de l'image
// affichée dans le champ Image "IMG_MonChampImage"
ImageInfoModifie(IMG_MonChampImage, imgCommentaire, "Belles gorgones")
// Enregistrement de la modification dans le
// fichier "C:\Plongees\Gorgone1.JPG"
ImageInfoSauve(MonChampImage, "C:\Plongees\Gorgone1.JPG", 100)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ImageInfoSauve(<Image> [, <Nouvelle image> [, <Qualité>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'enregistrement des modifications a été effectué, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Il est possible de connaître le détail de l'erreur grâce à la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Image> : (Chaîne de caractères)`**

Image à manipuler. Cette image peut correspondre à :

- un fichier image (format JPEG) : spécifiez le nom et le chemin complet (ou relatif) du fichier. Un chemin de type UNC peut être utilisé. 
	Dans ce cas, il est nécessaire de fermer le fichier grâce à la fonction [ImageInfoFerme](../WDLang1/3091001.md).

- une image affichée dans un champ Image : spécifiez le nom du champ Image. Si cette image n'est pas au format JPEG, cette image sera automatiquement convertie à ce format.

- un image (format JPEG) contenue dans un mémo image : spécifiez ce mémo image.

- un image (format JPEG) contenue dans un chaîne binaire : spécifiez cette chaîne binaire.




**`<Nouvelle image> : (Chaîne de caractères optionnelle)`**

Nom et chemin complet (ou relatif) du nouveau fichier JPEG. Un chemin de type UNC peut être utilisé.

Si &lt;Image&gt; correspond à un fichier image, ce paramètre est optionnel. Dans ce cas, le fichier &lt;Image&gt; sera modifié.

Si &lt;Image&gt; correspond à une image affichée dans un champ Image, seule la partie visible de l'image affichée dans le champ Image est sauvegardée. Les marqueurs Exif sont également conservés.

**`<Qualité> : (Entier optionnel)`**

Qualité de l'image sauvegardée. Valeur comprise entre 1 et 100 (80 par défaut). Plus la qualité de l'image sera faible, plus le taux de compression de l'image sera élevé et plus la taille du fichier sera petite. 

Ce paramètre est pris en compte uniquement si &lt;Image&gt; correspond à une image affichée dans un champ Image. Dans les autres cas, ce paramètre est ignoré.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Image affichée dans un champ Image
<a name="image_affichee_dans_champ_image_ELTPARAGRAPHE000087"></a>La fonction [dSauveImageJPEG](../WDLang1/3029038.md) permet également d'enregistrer les modifications effectuées sur les marqueurs Exif d'une image affichée dans un champ Image.

Ainsi, les syntaxes suivantes sont similaires :


```wl
// Enregistrement des modifications
ImageInfoSauve(MonChampImage, "C:\Mes Images\PlongeeMaurice.JPG", 100)
```



```wl
// Enregistrement des modifications
dSauveImageJpeg(MonChampImage, "C:\Mes Images\PlongeeMaurice.JPG", 100, imgSauveInformation)
```


**Rappel** : Seule la partie visible de l'image affichée dans le champ Image est sauvegardée. Les marqueurs Exif sont également conservés.



<a name="XComposante"></a>

## Composante :
wd280img.dll
