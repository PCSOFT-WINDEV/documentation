
## eVersEuro (Fonction)

***En anglais : eToEuro***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Convertit en Euros une valeur exprimée dans une devise spécifique.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Conversion de Marks en Euros
ResConversion = eVersEuro(150, eDEM)
```




<a name="Exemple2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Conversion de Lires en Euros avec gestion de l'écart d'arrondi
// Deux décimales sont utilisées pour la conversion
ResConversion = eVersEuro(10000, eITL, 2, ResEcart)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = eVersEuro(<Valeur à convertir> [, <Devise source> [, <Nombre de décimales> [, <Écart d'arrondi>]]])`
---

**`<Résultat> : (Monétaire)`**

Valeur convertie en Euros.

**`<Valeur à convertir> : (Monétaire)`**

Somme à convertir.

**`<Devise source> : (Entier ou constante (optionnel))`**

Identifiant de la devise source ou constante associée à la devise source. Si ce paramètre n'est pas spécifié, la devise à convertir est la devise ayant pour identifiant "1" (le Franc Français par défaut).

**`<Nombre de décimales> : (Entier optionnel)`**

Nombre de décimales utilisées pour le résultat de la conversion (2 par défaut).

**`<Écart d'arrondi> : (Monétaire optionnel)`**

Variable récupérant l'écart d'arrondi dû à la conversion et à l'arrondi. Cet écart est exprimé dans la devise source.
Ce paramètre n'a d'intérêt que pour les monnaies dont le taux de change est supérieur à l'Euro (Franc Belge, Peseta, etc.). Pour les autres devises, ce paramètre est toujours nul.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Table des changes
<a name="table_des_changes_ELTPARAGRAPHE000071"></a>Une ***table des changes*** est conservée en mémoire. A chaque monnaie sont associés :

- Un numéro de devise permettant d'identifier la devise par programmation.

- Une constante permettant d'identifier la devise par programmation.

- Un libellé (7 caractères maximum) : ce libellé est affiché dans le champ "Monétaire + Euro" si le masque de saisie le permet (le signe $ est indiqué).

- Un taux de change. Ce taux de change correspond au taux de change de la monnaie par rapport à l'Euro.




Cette table des changes est la suivante :

| Numéro de devise | Constante | Pays | Taux de change | Libellé par défaut |
| --- | --- | --- | --- | --- |
| 0 | *eEUR* | Zone Euro | 1 | EURO |
| 1 | *eFRF* | France | 6.55957 | F |
| 2 | *eITL* | Italie | 1936.27 | ITL |
| 3 | *eBEF* | Belgique | 40.3399 | BEF |
| 4 | *eLUF* | Luxembourg | 40.3399 | LUF |
| 5 | *eDEM* | Allemagne | 1.95583 | DEM |
| 6 | *eATS* | Autriche | 13.7603 | ATS |
| 8 | *eESP* | Espagne | 166.386 | ESP |
| 9 | *eIEP* | Irlande | 0.787564 | IEP |
| 10 | *eNLG* | Pays Bas | 2.20371 | NLG |
| 11 | *ePTE* | Portugal | 200.482 | PTE |
| 14 | *eGRD* | Grèce | 340.750 | GRD |
| 15 | *eFIM* | Finlande | 5.94573 | FIM |
| **Monnaies non intégrées à l'Euro** |
|   |   |   |   |   |
| 7 | *eDKK* | Danemark | 0 | DKK |
| 12 | *eGBP* | Grande-Bretagne | 0 | GBP |
| 13 | *eSEK* | Suède | 0 | SEK |
| 16 - 25 | ** |   | 0 | Libre1 à Libre10 |
| 26 | *eCYP* | Chypre | 0 | CYP |
| 27 | *eCZK* | République Tchèque | 0 | CZK |
| 28 | *eEEK* | Estonie | 0 | EEK |
| 29 | *eHUF* | Hongrie | 0 | HUF |
| 30 | *eLTL* | Lituanie | 0 | LTL |
| 31 | *eLVL* | Lettonie | 0 | LVL |
| 32 | *eMTL* | Malte | 0 | MTL |
| 33 | *ePLN* | Pologne | 0 | PLN |
| 34 | *eSIT* | Slovénie | 0 | SIT |
| 35 | *eSKK* | Slovaquie | 0 | SKK |





La première devise (ayant pour identifiant 0) est la monnaie prise pour pivot lors des conversions.


Dans cette table des changes, il est possible :

- d'ajouter de nouvelles devises en modifiant si nécessaire les devises personnalisables ("devises utilisateur" de 16 à 25) avec la fonction [eInitDevise](../WDLang1/3033003.md),

- de spécifier le taux de change de chaque devise grâce à la fonction [eInitDevise](../WDLang1/3033003.md).




**Attention** : Les monnaies ayant un taux de change nul n'apparaîtront pas dans le menu contextuel du champ de type "Monétaire + Euro". Pour définir les taux de change de ces devises, vous devez les redéfinir dans le code d'initialisation du projet avec la fonction [eInitDevise](../WDLang1/3033003.md).


<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Écart d'arrondi
<a name="ecart_arrondi_ELTPARAGRAPHE000388"></a>L'&lt;écart d'arrondi&gt; est calculé avec la formule suivante :


```txt
Arrondi(<Valeur à convertir>, <Résultat en devise source>, <Nombre de décimales>)
```


Par exemple :


```wl
Ecart, ResConversion sont des monétaires
ResConversion = eVersEuro(1.52, eFRF, 2, Ecart)
```


ResConversion vaut 0,45 et Ecart vaut 0,01.

Pour retrouver le montant initial, utilisez la ligne de code suivante :


```wl
MontantInit = eVersDevise(ResConversion, eFRF, 2) + Ecart
```


<a name="XComposante"></a>

## Composante :
wd280std.dll
