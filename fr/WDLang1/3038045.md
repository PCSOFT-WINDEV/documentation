


## OuvreSoeur (Fonction)

***En anglais : OpenSister***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ouvre une fenêtre soeur non modale. La fonction **OuvreSoeur** permet également de :

- définir la position d'affichage de la fenêtre soeur,

- passer des paramètres à la fenêtre soeur.




Lors de l'appel de la fonction **OuvreSoeur**, les opérations suivantes sont effectuées :

- exécution de l'événement "Déclarations globales" de la fenêtre soeur,

- exécution des événements d'initialisation des champs (l'ordre est indéterminé),

- exécution des traitements suivant l'appel de la fonction **OuvreSoeur** de la fenêtre appelante,

- affichage de la fenêtre soeur.




**Remarque** : Par défaut, la fenêtre soeur conserve le focus une fois ouverte.



![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette fonction est disponible uniquement pour simplifier la Webisation de projets WINDEV. Dans un site WEBDEV, cette fonction se comporte comme la fonction [PageAffiche](../WDLang2/3058008.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003038045&name=ouvresoeur_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Ouverture de la fenêtre soeur "FEN_SaisieFenêtre"
// sans positionnement et sans passage de paramètres
OuvreSoeur(FEN_SaisieFenêtre)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Ouvrir une fenêtre soeur

`OuvreSoeur(<Nom de la fenêtre> [, <Paramètre 1> [... [, <Paramètre N>]]])`
---

**`<Nom de la fenêtre> : (Chaîne de caractères)`**



- Nom de la fenêtre soeur à ouvrir.

- Nom et chemin complet de la fenêtre soeur (fichier ".WDW") à ouvrir.




**`<Paramètre 1> : (Type de la valeur envoyée à la fenêtre (optionnel))`**

Premier paramètre à passer à l'événement "Déclarations globales" de la fenêtre à ouvrir. Ce paramètre est passé par valeur et il est considéré comme une variable globale à la fenêtre.
Ce paramètre ne peut pas correspondre à une variable de type tableau (les tableaux peuvent uniquement être passés par référence).



**`<Paramètre N> : (Type de la valeur envoyée à la fenêtre (optionnel))`**

Nième paramètre à passer à l'événement "Déclarations globales" de la fenêtre à ouvrir. Ce paramètre est passé par valeur et il est considéré comme une variable globale à la fenêtre.
Ce paramètre ne peut pas correspondre à une variable de type tableau (les tableaux peuvent uniquement être passés par référence).


<a name="SYNTAXE2"></a>

### Ouvrir une fenêtre soeur en définissant sa position et son niveau d'affichage

`OuvreSoeur(<Nom de la fenêtre [ + <Niveau>]> [, <Paramètre 1> [... [, <Paramètre N>]]])`
---

**`<Nom de la fenêtre [ + ]> : (Chaîne de caractères)`**

Permet d'indiquer : 

- **la fenêtre à ouvrir** (&lt;Nom de la fenêtre&gt;). Ce paramètre peut correspondre au : 

	- Nom de la fenêtre soeur à ouvrir.

	- Nom et chemin complet de la fenêtre soeur (fichier ".WDW") à ouvrir.


 Par défaut, la fenêtre est affichée selon la position définie sous l'éditeur. Il est possible de définir la position d'affichage de la fenêtre. Le nom de la fenêtre est alors complété par les coordonnées d'affichage de la fenêtre à son ouverture. Ce paramètre est de la forme : 
	
	```txt
	"[<Alias>] = <Nom de la fenêtre> [, <Y>, <X>]"
	```

	 où : 
	

- &lt;Alias&gt; : alias de la fenêtre si la même fenêtre est ouverte plusieurs fois.

- &lt;Nom de la fenêtre&gt; : nom de la fenêtre soeur à ouvrir.
			![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Pour ne pas donner le focus à la fenêtre ouverte, utilisez la notation &lt;Nom de la fenêtre&gt; + **SansFocus**. L'événement "Prise de focus" de la fenêtre soeur ne sera pas exécuté. Attention : dans ce cas le nom de la fenêtre doit être entre guillemets.

- &lt;Y&gt; : coordonnée verticale (en pixels) d'affichage de la fenêtre (par rapport au coin haut gauche de l'écran ou de la fenêtre mère).

- &lt;X&gt; : coordonnée horizontale (en pixels) d'affichage de la fenêtre (par rapport au coin haut gauche de l'écran ou de la fenêtre mère).

- **le niveau d'affichage de la fenêtre** (&lt;Niveau&gt;) :
	


|   |   |
| --- | --- |
| *Dessus* | Fenêtre ouverte au-dessus de toutes ses fenêtres soeurs. |
| *DessusTout* | Fenêtre ouverte au-dessus de toutes les autres fenêtres (y compris les fenêtres des autres applications). |

 **Remarque** : Si deux fenêtres sont ouvertes avec la même constante (*Dessus* ou *DessusTout*), la seconde fenêtre sera ouverte au-dessus de la première fenêtre. 
	Il est conseillé d'utiliser la fonction [FenEtat](../WDLang1/3038030.md) pour modifier le niveau d'affichage d'une fenêtre.




**`<Paramètre 1> : (Type de la valeur envoyée à la fenêtre (optionnel))`**

Premier paramètre à passer à l'événement "Déclarations globales" de la fenêtre à ouvrir. Ce paramètre est passé par valeur et il est considéré comme une variable globale à la fenêtre.
Ce paramètre ne peut pas correspondre à une variable de type tableau (les tableaux peuvent uniquement être passés par référence).



**`<Paramètre N> : (Type de la valeur envoyée à la fenêtre (optionnel))`**

Dernier paramètre à passer à l'événement "Déclarations globales" de la fenêtre à ouvrir. Ce paramètre est passé par valeur et il est considéré comme une variable globale à la fenêtre.
Ce paramètre ne peut pas correspondre à une variable de type tableau (les tableaux peuvent uniquement être passés par référence).


<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Paramètres passés à la fenêtre soeur à ouvrir
<a name="parametres_passes_fenetre_soeur_ouvrir_ELTPARAGRAPHE000149"></a>Les paramètres sont récupérés dans l'événement "Déclarations globales" de la fenêtre. Il suffit d'indiquer en début de code la ligne suivante :

```txt
PROCEDURE <Nom de la fenêtre>(<Paramètre1> [, <Paramètre2> [, ...]])
```
Ces paramètres sont passés par valeur et non par référence.

Pour plus de détails, consultez [Fenêtre paramétrée](../WDChamp/1010026.md).


<a name="NOTE0_2"></a>


### Mode d'ouverture de la fenêtre
<a name="mode_ouverture_fenetre_ELTPARAGRAPHE000172"></a>L'ouverture de la fenêtre est non modale :

- la fenêtre parente reste la fenêtre en cours.

- après l'ouverture de la fenêtre soeur, les traitements suivant l'appel de la fonction **OuvreSoeur** dans la fenêtre appelante sont exécutés.

- l'utilisateur pourra cliquer dans l'une des fenêtres parentes de la fenêtre en cours.


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Pour gérer le MDI, utilisez la fonction [MDIOuvre](../WDLang1/3052005.md).
<a name="NOTE0_3"></a>


### Ouverture d'une même fenêtre plusieurs fois
<a name="ouverture_une_meme_fenetre_plusieurs_fois_ELTPARAGRAPHE000193"></a>

- Si une même fenêtre est ouverte plusieurs fois, il est conseillé d'utiliser un alias. Cet alias permet de différencier chaque fenêtre.

- Le positionnement de la fenêtre appelante (relatif à l'écran ou à la fenêtre soeur) est choisi lors de la description de la fenêtre sous l'éditeur. Si une même fenêtre est ouverte plusieurs fois (avec un alias), il faut modifier les positions d'affichage à chaque ouverture (sinon les fenêtres seront superposées).

- Le nombre de fenêtres pouvant être ouvertes simultanément dépend de la mémoire disponible.



<a name="NOTE0_4"></a>


### Fermeture d'une fenêtre
<a name="fermeture_une_fenetre_ELTPARAGRAPHE000202"></a>Une fenêtre ouverte avec la fonction **OuvreSoeur** peut être fermée avec la fonction [Ferme](../WDLang1/3038018.md) (sans paramètre) à partir de n'importe quel événement :

- de la fenêtre,

- d'un champ de la fenêtre.



<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Titre de la fenêtre à ouvrir
<a name="titre_fenetre_ouvrir_ELTPARAGRAPHE000220"></a>Par défaut, le titre de la fenêtre est celui défini sous l'éditeur.

Pour modifier le titre de la fenêtre, utilisez les fonctions [TitreSuivant](../WDLang1/3038043.md) ou [TitreEnCours](../WDLang1/3038023.md).
<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Ouvrir une fenêtre d'un composant
<a name="ouvrir_une_fenetre_composant_ELTPARAGRAPHE000237"></a>Pour ouvrir une fenêtre d'un composant, il suffit d'utiliser directement le nom de la fenêtre du composant (le composant étant intégré dans le projet). Par exemple :

```wl
OuvreSoeur(FenêtreDuComposant)
```
En cas de conflit avec un élément du projet, il suffit de préfixer le nom de l'élément par le nom du composant. Par exemple :

```wl
OuvreSoeur(MonComposant.Fenêtre)
```
Pour utiliser le nom de la fenêtre dans une variable, il est nécessaire de préciser le nom du composant. Par exemple :

```wl
sFenêtre est une chaîne = "MonComposant.MaFenêtre"
OuvreSoeur(sFenêtre)
```


<a name="XComposante"></a>

## Composante :
wd280obj.dll
