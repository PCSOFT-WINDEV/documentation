


## Evénement (Fonction)

***En anglais : Event***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Intercepte un événement Windows sur un champ, un groupe de champs ou une fenêtre WINDEV ou WINDEV Mobile. Lorsque l'événement survient sur l'objet spécifié, une procédure WLangage spécifique est automatiquement exécutée. Pour mettre fin à la gestion de l'événement, il suffit d'utiliser la fonction [FinEvénement](../WDLang1/3015010.md).

**Remarque** : La fonction **Evénement** ne fonctionne PAS sur une fenêtre non WINDEV.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Capture du clic souris sur un champ de saisie 
WM_LBUTTONDOWN est un entier = 513
Evénement(ClicSouris, "SAI_SAISIE1", WM_LBUTTONDOWN)
```

```wl
// Procédure ClicSouris 
PROCEDURE ClicSouris()
SAI_SAISIE1 = ""   // Remise à 0 du champ lorsque l'on clique dessus
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = Evénement(<Procédure WLangage> , <Nom de l'objet> , <Message Windows>)`
---

**`<Résultat> : (Entier)`**



- Identifiant de l'événement, 

- 0 en cas d'erreur.




**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure WLangage à lancer lors de l'interception de l'événement. Cette procédure peut être une procédure globale au projet ou une procédure locale à la fenêtre qui contient le code en cours d'exécution. Cette fonction doit respecter une norme spécifique (voir Remarques). 
Pour un objet donné, une seule procédure peut intercepter un événement donné.

**`<Nom de l'objet> : (Chaîne de caractères)`**

Nom du champ, du groupe de champs ou de la fenêtre WINDEV sur lequel l'événement doit être géré. Il est aussi possible d'utiliser les chaînes de caractères génériques suivantes :


|   |   |
| --- | --- |
| **&lt;Nom de la fenêtre&gt;.\*** | L'événement est géré sur tous les champs de la fenêtre &lt;Nom de la fenêtre&gt; (sauf pour la fenêtre &lt;Nom de la fenêtre&gt; elle-même). |
| **.\* (point étoile)** | L'événement est géré sur tous les champs de la fenêtre en cours (sauf la fenêtre elle-même). |
| **\*. (étoile point)** | L'événement est géré dans toutes les fenêtres WINDEV de l'application en cours. |
| **\*.\* (étoile point étoile)** | L'événement est géré dans toutes les fenêtres WINDEV et dans tous les champs de toutes les fenêtres WINDEV ouvertes de l'application en cours. |



**`<Message Windows> : (Entier ou chaîne de caractères)`**

Numéro ou nom du message Windows à gérer. Consultez la [liste des événements Windows](../AppelDLL/6510001.md). Remarque : Il est possible d'intégrer les constantes Windows directement dans votre code WLangage grâce au mot-clé [EXTERNE](../Motscles/1511013.md). 
Si ce paramètre correspond à une chaîne de caractères, cette chaîne est sensible à la casse.  
Si ce paramètre correspond à 0, tous les messages Windows sont interceptés.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Appeler plusieurs fois le même événement sur le même objet 
<a name="appeler_plusieurs_fois_meme_evenement_sur_meme_objet_ELTPARAGRAPHE000075"></a>La fonction **Evénement** peut être utilisée pour gérer plusieurs fois le même événement sur le même élément (champ, fenêtre, ...).

Dans ce cas, les événements sont "empilés" :

- le premier événement est géré jusqu'à l'appel de l'événement suivant.

- lorsque un événement n'est plus géré (fonction [FinEvénement](../WDLang1/3015010.md)), l'événement immédiatement précédent (s'il existe) est pris en compte.



<a name="NOTE0_2"></a>


### Procédure appelée par la fonction Evénement
<a name="procedure_appelee_par_fonction_docparampagetitleshort_ELTPARAGRAPHE000093"></a>La procédure d'interception appelée par la fonction **Evénement** doit être de la forme :

```txt
FONCTION ProcédureGestionEvénement(MessageWindows, wParam, lParam)
```
MessageWindows, wParam et lParam sont trois entiers optionnels, permettant d'envoyer et de recevoir des informations sur le message et les objets concernés.
<a name="NOTE0_3"></a>


### Paramètres utilisés par la procédure
<a name="parametres_utilises_par_procedure_ELTPARAGRAPHE000108"></a>La procédure d'interception appelée par la fonction **Evénement** peut utiliser les variables suivantes :

| Variables | Signification | Variable 5.5 conservée par compatibilité |
| --- | --- | --- |
| **MoiMême..Nom** | Nom de l'objet (champ, groupe de champs ou fenêtre)<br>Variable en lecture | _EVE.Nom |
| **Message** | Numéro du message (premier paramètre de la procédure)<br>Variable en lecture | _EVE.wMessage |
| **wParam** | Premier paramètre du message (second paramètre de la procédure)<br>Variable en lecture | _EVE.wParam |
| **lParam** | Second paramètre du message (troisième paramètre de la procédure)<br>Variable en lecture | _EVE.lParam |
| **Handle("")** | Handle de l'objet qui a reçu le message<br>Variable en lecture | _EVE.hWnd |
| **Valeur retournée par la procédure** | Renvoie une valeur à Windows | _EVE.Retour |



**Remarque** : Si le traitement retourne une valeur (forcément de type entier), l'événement Windows est arrêté : c'est cette valeur qui est renvoyée. Si le traitement ne renvoie PAS de valeur, l'exécution se poursuit normalement.
<a name="NOTE0_4"></a>


### Evénements utilisés par WINDEV
<a name="evenements_utilises_par_windev_ELTPARAGRAPHE000175"></a>WINDEV utilise pour son fonctionnement interne les événements compris entre "WM_USER + 700" et "WM_USER + 1200". Il est donc nécessaire d'utiliser d'autres plages d'événements (par exemple, "WM_USER + 1300" à "WM_USER + 1400").


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDEcrandeveille.gif) ***Exemples didactiques (WINDEV)*** : **WD Ecran de veille** <br>Cet exemple illustre la réalisation d'un économiseur d'écran avec les fonctions WLangage.<br>Dans cet exemple, nous abordons les principaux thèmes suivants :<br>1/ l'appel périodique d'une procédure (les "timers")<br>2/ la gestion des événements Windows <br>3/ les fonctions système (appel d'API Windows)<br>Pour utiliser l'écran de veille :<br>- Renommer l'exécutable (.EXE) en .SCR<br>- Copier le fichier dans le répertoire de Windows (Ex: C:\WINDOWS)<br>- Ouvrir la fenêtre de propriétés d'affichage du bureau<br>- Choisir l'onglet "Ecran de Veille"<br>- Sélectionnez l'écran de veille généré avec WINDEV
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDPlanning.gif) ***Exemples complets (WINDEV)*** : **WD Planning** <br>Cet exemple illustre la gestion d'un planning graphique.<br><br>Dans cet exemple, nous abordons les principaux thèmes suivants :<br>1/ le champ planning<br>2/ les fonctions Google agenda

<a name="XComposante"></a>

## Composante :
wd280obj.dll
