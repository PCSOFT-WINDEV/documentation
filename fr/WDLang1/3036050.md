


## fRepSélecteur (Fonction)

***En anglais : fSelectDir***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ouvre un sélecteur de répertoires.

Le sélecteur de répertoires est le suivant (selon le système utilisé, l'apparence du sélecteur peut varier) :<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=fRepS%E9lecteur%20-%20HC%20N%B0001.gif)
**Remarque** : Il est possible de sélectionner un répertoire local ou un répertoire présent sur un disque réseau.

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003036050&name=frepselecteur_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Sélection d'un répertoire
Répertoire = fRepSélecteur("C:\Répertoires\", "Sélectionnez un répertoire", ...
	"Sélectionnez le répertoire que vous désirez copier")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = fRepSélecteur(<Répertoire sélectionné par défaut> , <Titre du sélecteur> [, <Commentaires du sélecteur> [, <Répertoire racine> [, <Options>]]])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Chemin et nom complet du répertoire sélectionné, 

- Chaîne vide ("") si aucun répertoire n'a été sélectionné. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Répertoire sélectionné par défaut> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du répertoire sélectionné par défaut. Un chemin de type UNC peut être utilisé. Ce paramètre doit être terminé par "\\". Si ce paramètre est une chaîne vide (""), aucun répertoire ne sera sélectionné par défaut.
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) Ce paramètre peut être au format Ansi ou Unicode.

**`<Titre du sélecteur> : (Chaîne de caractères)`**

Intitulé affiché dans la barre de titre du sélecteur de répertoires. 
Si ce paramètre est une chaîne vide (""), le titre "Rechercher un dossier" sera affiché.

![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) Ce paramètre peut être au format Ansi ou Unicode.

**`<Commentaires du sélecteur> : (Chaîne de caractères optionnelle)`**

Commentaires affichés en haut du sélecteur de répertoires.

![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) Ce paramètre peut être au format Ansi ou Unicode.

**`<Répertoire racine> : (Chaîne de caractères optionnelle)`**

Nom et chemin complet du répertoire "racine" de l'arborescence proposée. Un chemin de type UNC peut être utilisé. Si ce paramètre est une chaîne vide (""), le répertoire "Bureau" débutera l'arborescence proposée.
Ce paramètre permet de limiter la sélection uniquement aux répertoires d'un disque donné ou uniquement aux sous-répertoires d'un répertoire donné.

![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) Ce paramètre peut être au format Ansi ou Unicode.

Si ce paramètre est différent de chaîne vide (""), l'ancien sélecteur de répertoire sera utilisé.

**`<Options> : (Constante optionnelle de type Entier)`**

Permet de spécifier : 

- le format du résultat de la fonction. Par défaut, **fRepSélecteur** renvoie une chaîne de caractères Ansi. 

- le look du sélecteur de répertoire. 





|   |   |
| --- | --- |
| *fCheminUNICODE* | &lt;Résultat&gt; sera une chaîne de caractères au format Unicode.<br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Cette constante n'est pas disponible. |
| *frAncienAspect* | Permet d'utiliser l'ancien sélecteur de répertoire (ancien look). <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=SelectRep.gif)<br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *frInterditDossierVirtuel* | &lt;Résultat&gt; ne contiendra pas les répertoires virtuels.<br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Sélection de fichiers
<a name="selection_fichiers_ELTPARAGRAPHE000125"></a>La fonction **fRepSélecteur** permet de sélectionner un répertoire. Pour sélectionner un fichier, utilisez la fonction [fSélecteur](../WDLang1/3036053.md).
<a name="NOTE0_3"></a>
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Fonctionnement en Java
<a name="fonctionnement_java_ELTPARAGRAPHE000140"></a>**En Java, sous Windows**, l'utilisation de la fonction **fRepSélecteur** affiche une fenêtre Java qui simule l'aspect et le fonctionnement du sélecteur de répertoire natif Windows.

Pour forcer l'utilisation du sélecteur de répertoire Java, il faut utiliser la propriété système &lt;wd.prop.sel_rep_defaut&gt; au lancement de l'application, en lui passant une des valeurs suivantes : oui/o/yes/y/vrai/true. 
**Exemple** de ligne de commande permettant de lancer une application Java en forçant l'utilisation du sélecteur de répertoire Java :

```txt
java -Dwd.prop.sel_rep_defaut=y -jar MonApplication.jar
```

 
**En Java, sous les autres OS (Linux, Mac, ...),** l'utilisation de la fonction **fRepSélecteur** affiche le sélecteur de répertoire Java.

Pour forcer l'affichage d'une fenêtre Java qui simule l'aspect et le fonctionnement du sélecteur de répertoire natif Windows, il faut utiliser la propriété système &lt;wd.prop.sel_rep_windows&gt; au lancement de l'application, en lui passant une des valeurs suivantes : oui/o/yes/y/vrai/true. 
**Exemple** de ligne de commande permettant de lancer une application Java en forçant l'utilisation du sélecteur de répertoire Windows :

```txt
java -Dwd.prop.sel_rep_windows=y -jar MonApplication.jar
```

<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Ancien et nouveau sélecteur de répertoire
<a name="ancien_nouveau_selecteur_repertoire_ELTPARAGRAPHE000170"></a>A partir de la version 23, le nouveau sélecteur de répertoires est utilisé par défaut. 

Si le nouveau sélecteur n'est pas supporté (le nouveau sélecteur est supporté uniquement à partir de Windows Vista) ou si le paramètre &lt;Racine&gt; n'est pas vide (le répertoire racine n'est pas supporté par le nouveau sélecteur), l'ancien sélecteur est affiché même si la constante *frAncienAspect* n'est pas précisée.

<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280std.dll
