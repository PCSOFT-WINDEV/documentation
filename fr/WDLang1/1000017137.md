


## dbgActiveLog (Fonction)

***En anglais : dbgEnableLog***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Active par programmation le log d'exécution.

**Remarque** : A partir de la version 28, le log d'exécution est composé d'un fichier ".wxl", d'un fichier ".ndx" et d'un fichier ".mmo". Si le projet correspondant au log d'exécution est ouvert sous l'éditeur, le fichier de log pourra être ouvert directement sous l'éditeur : 

- soit sous le volet "Accueil", dans le groupe "Général", déroulez "Ouvrir", sélectionnez "Ouvrir" et sélectionnez le fichier ".wxl" voulu.

- soit en effectuant un "Drag and Drop" du fichier ".wxl" de l'explorateur de fichiers vers l'éditeur. 


Pour plus de détails, consultez [Log d'exécution](../Editeurs/2019030.md).

Note : Dans les versions précédentes, le log d'exécution correspondait à un fichier ".wlog". 


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Active le log d'exécution par défaut
dbgActiveLog()
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = dbgActiveLog([<Fichier Log> [, <Options>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le log d'exécution a démarré, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Fichier Log> : (Chaîne de caractères optionnelle)`**

Emplacement et nom du fichier log à créer. Le nom et l'emplacement du fichier log peuvent être : 

- complètement personnalisés. 

- construits à l'aide des mots-clés suivants : 
	


|   |   |
| --- | --- |
| [%RepExe%] | Répertoire de l'exécutable, toujours complété par le caractère "\\". Ce répertoire est équivalent au résultat de la fonction [fRepExe](../WDLang1/3036049.md). |
| [%NomExe%] | Nom de l'exécutable. |
| [%Date%] | Date de lancement du log d'exécution (format AAAAMMJJ). |
| [%Heure%] | Heure de lancement du log d'exécution (format HHMMSS). |
| [%NomUtilisateur%] | Nom de l'utilisateur courant. |
| [%NomMachine%] | Nom de la machine. |
| [%RepDonnees%] | Répertoire des fichiers de données HFSQL spécifié par l'utilisateur lors de l'installation de l'application. Ce répertoire est équivalent au résultat de la fonction [fRepDonnées](../WDLang1/3036001.md). |
| [%RepDonneesUtilisateur%] | Répertoire pour les données de l'utilisateur courant de l'application courante.  Ce répertoire est équivalent au résultat de la fonction [fRepDonnéesUtilisateur](../WDLang1/3036071.md). |





Par défaut, le nom du fichier Log correspond à : 
"[%RepDonneesUtilisateur%][%NomExe%]_[%Date%]_[%Heure%]". 
Par exemple : 
"C:\\Users\\Doc\\AppData\\Roaming\\Applications WinDev\\MonAppli\\Monappli_20071023_130812.wlog".

Attention : Si vous utilisez la construction dynamique des chaînes (option "Autoriser "[% %]" dans les chaînes" dans l'onglet "Compilation" de la description du projet, une erreur de compilation apparaît (identificateur inconnu). Dans ce cas, il est nécessaire de faire précéder chaque chaîne par '-%'. Exemple : 

```wl
dbgActiveLog("[%RepDonneesUtilisateur%][%NomExe%]_[%Date%]_[%Heure%]")
```
 devient
```wl
dbgActiveLog(-%"[%RepDonneesUtilisateur%][%NomExe%]_[%Date%]_[%Heure%]")
```


**`<Options> : (Constante ou combinaison de constantes optionnelle de type Entier)`**

Permet de paramétrer les options du log d'exécution :


|   |   |
| --- | --- |
| *LogActif* | Le log d'exécution est immédiatement actif. |
| *LogFonctionsWLangage* | Les fonctions WLangage sont inscrites dans le log d'exécution. |
| *LogParamètres* | Les paramètres des fonctions sont inscrits dans le log d'exécution. |
| *LogPause* | Le log d'exécution n'est pas immédiatement actif |
| *LogTout* | Le log d'exécution récupère :<br><br>- les fonctions WLangage<br><br>- les paramètres des fonctions<br><br>- les traitements<br><br><br> |
| *LogTraitementUniquement* | Le log d'exécution récupère uniquement les informations des traitements. |


Par défaut, si ce paramètre n'est pas spécifié, la combinaison de constantes *LogActif*+ *LogFonctionsWLangage*est utilisée.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Fonctionnement du log d'exécution
<a name="fonctionnement_log_execution_ELTPARAGRAPHE000270"></a>

- La fonction **dbgActiveLog** ne doit être appelée qu'une seule fois. Tout autre appel à cette fonction sera sans effet.

- Pour activer / désactiver momentanément le log d'exécution, utilisez la fonction [dbgEtatLog](../WDLang1/1000017138.md).

- Pour modifier les options du log d'exécution, utilisez la fonction [dbgOptionLog](../WDLang1/1000017136.md).


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Remarque : Le log d'exécution peut être également démarré grâce au fichier ".wx" placé à côté de l'exécutable. Pour plus de détails, consultez [Log d'exécution](../Editeurs/2019030.md).


### Divers
<a name="divers_ELTPARAGRAPHE000293"></a>

- La fonction **dbgActiveLog** peut être utilisée dans un webservice REST. 

- L'emplacement du fichier de log peut être totalement personnalisé. Dans ce cas, ne pas oublier les problèmes de droits qui peuvent se poser. 
	Rappel : Le répertoire des données est normalement toujours disponible en écriture.   




<a name="XComposante"></a>

## Composante :
wd280vm.dll
