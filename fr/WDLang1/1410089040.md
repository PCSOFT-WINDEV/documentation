


## &lt;Variable FichierDisque&gt;.Débloque (Fonction)

***En anglais : &lt;DiskFile variable&gt;.Unlock***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Débloque entièrement ou partiellement un fichier externe. Le fichier a été préalablement bloqué par la fonction [&lt;Variable FichierDisque&gt;.Bloque](../WDLang1/1410089037.md).

**Attention** : Le déblocage peut être effectué uniquement si la partie à débloquer correspond à la partie bloquée.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ouverture d'un fichier externe
MonFichier est un FichierDisque
MonFichier = fOuvre("C:\MesRépertoires\Fichier.txt", foLectureEcriture)
SI PAS ErreurDétectée ALORS
	// Blocage du fichier
	ResBloque = MonFichier.Bloque()
	...
	// Déblocage du fichier externe
	ResDébloque = MonFichier.Débloque()
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Fichier manipulé>.Débloque([<Premier octet à débloquer> [, <Nombre d'octets à débloquer>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le déblocage a été effectué, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Fichier manipulé> : (Variable de type FichierDisque)`**

Nom de la variable de type [FichierDisque](../WDLang1/1410088883.md) initialisée avec la fonction [fOuvre](../WDLang1/3036036.md) ou [fCrée](../WDLang1/3036017.md).

**`<Premier octet à débloquer> : (Entier optionnel)`**

Position du premier octet (caractère) à débloquer (0 correspond au premier octet du fichier).

**`<Nombre d'octets à débloquer> : (Entier optionnel)`**

Nombre d'octets (de caractères) à débloquer.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Le déblocage n'a pas été effectué
<a name="deblocage_pas_ete_effectue_ELTPARAGRAPHE000250"></a>La fonction **&lt;Variable FichierDisque&gt;.Débloque** renvoie <u><u><u><u>Faux</u></u></u></u> si le déblocage n'a pas été effectué. Le déblocage peut être effectué uniquement si :

- le fichier externe est ouvert.

- l'identifiant du fichier est valide.

- le fichier ou les octets à débloquer sont bloqués à l'identique. Par exemple, si seule une partie du fichier a été bloquée, cette même partie doit être débloquée. Si le fichier a été bloqué en totalité, il n'est pas possible de débloquer uniquement une partie du fichier.

- le fichier ou les octets à débloquer ont été bloqués par la même application et depuis le même poste.



<a name="NOTE0_2"></a>


### Déblocage d'un fichier
<a name="deblocage_fichier_ELTPARAGRAPHE000272"></a>

- Le fichier est débloqué dans sa totalité si les paramètres &lt;Premier octet à débloquer&gt; et &lt;Nombre d'octets à débloquer&gt; ne sont pas précisés.

- Le fichier est débloqué du premier octet à débloquer (paramètre &lt;Premier octet à débloquer&gt;) jusqu'à la fin si le paramètre &lt;Nombre d'octets à débloquer&gt; n'est pas précisé.

- Un fichier bloqué (ou partiellement bloqué) sera automatiquement débloqué lors de sa fermeture.




![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) **Cas particulier** : 
Le blocage n'est effectif que entre 2 sites ou 2 contextes différents. Contrairement à Windows, un traitement ne peut pas bloquer un fichier qu'il a bloqué précédemment.
<a name="NOTE0_3"></a>


### Position dans le fichier
<a name="position_dans_fichier_ELTPARAGRAPHE000290"></a>A l'ouverture d'un fichier, la position en cours correspond :

- soit au premier octet du fichier (par défaut),

- soit au dernier octet du fichier si le fichier est ouvert en "ajout" (constante *foAjout*).




Cette position peut être modifiée par la fonction [&lt;Variable FichierDisque&gt;.Positionne](../WDLang1/1410089048.md).

La position en cours n'est pas modifiée par l'exécution de la fonction **&lt;Variable FichierDisque&gt;.Débloque**.
<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Fonctionnement sous Windows Vista (et supérieur)
<a name="fonctionnement_sous_windows_vista_superieur_ELTPARAGRAPHE000319"></a>Si cette fonction ne fonctionne pas correctement sous Windows Vista (et supérieur), il est nécessaire de vérifier si le fichier ou le répertoire manipulé ne se trouve pas dans un des répertoires système (répertoire de Windows ou répertoire "Program Files").

**En effet, sous Windows Vista (et supérieur), avec le [mécanisme de l'UAC](../Editeurs/2025014.md) (contrôle des comptes utilisateurs) activé**, il est nécessaire d'avoir les privilèges administrateur pour manipuler / modifier des fichiers ou des répertoires présents dans les répertoires système (répertoire de Windows ou répertoire "Program Files").

**Conseil de programmation** : Si vous devez manipuler / modifier des fichiers ou des répertoires, sans avoir besoin de privilèges administrateur, il est conseillé :

- de ne pas écrire dans le répertoire de Windows ou dans le répertoire "Program Files",

- d'utiliser le répertoire système correspondant à l'application (connu par la fonction [SysRep](../WDLang1/3073026.md) par exemple avec la constante *srAppDataCommun*).




<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280std.dll
