


## InitParamètre (Fonction)

***En anglais : InitParameter***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Initialise la gestion des valeurs persistantes. Spécifie l'endroit où seront conservées :

- les valeurs des champs persistants.

- la taille et la position sauvegardée des champs et des fenêtres.

- les valeurs gérées par les fonctions [SauveParamètre](../WDLang1/3025046.md) et [ChargeParamètre](../WDLang1/3025047.md).




**Remarque** : L'initialisation des valeurs persistantes est "globale". Ainsi, si un composant initialise la gestion des valeurs persistantes, la gestion des valeurs persistantes sera initialisée pour l'application utilisant le composant.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Paramétrage des valeurs persistantes 
// dans un fichier .XML qui dépend de l'utilisateur 
InitParamètre(paramXML, "Param_" + USER + ".xml")
```
<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Paramétrage des valeurs persistantes
// dans une clé de la base de registre avec un n° de version
InitParamètre(paramRegistre, ProjetInfo(piRegistre) + "\3.51")
// autre possibilité :
InitParamètre(paramRegistre, "HKEY_CURRENT_USER\Software\DDSoft\DDTool\3.51")
```
<a name="Exemple3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Paramétrage des valeurs persistantes
// Paramétrage par une chaîne
MaChaîne est une chaîne
MaChaîne = fChargeTexte("MonFichier.xml")
InitParamètre(paramChaîne, MaChaîne)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = InitParamètre(<Mode d'initialisation> [, <Source des valeurs>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Mode d'initialisation utilisé avant l'appel de la fonction **InitParamètre**. &lt;Résultat&gt; est de la forme : 

```txt
<Mode d'initialisation> + TAB + <Source des valeurs>
```


**`<Mode d'initialisation> : (Constante de type Entier)`**

Type d'enregistrement des données persistantes :



|   |   |
| --- | --- |
| *paramChaîne* | Les paramètres seront lus dans une chaîne XML. Le paramètre &lt;Source des valeurs&gt; (obligatoire) doit être une variable de type chaîne.<br>Dans ce cas, les paramètres ne sont pas sauvés dans un fichier XML mais dans la variable de type chaîne.<br>Cette constante peut par exemple être utilisée pour récupérer des paramètres provenant d'un serveur HTTP (paramètres obtenus par exemple grâce à la fonction [HTTPRequête](../WDLang3/3043007.md)).<br> |
| *paramIni* | Les paramètres seront sauvegardés dans une section [Global] d'un fichier au format .INI.<br>Si cette option est choisie :<br><br>- par défaut, le nom du fichier INI est &lt;Nom du projet&gt;.INI. Ce fichier est créé dans le répertoire de l'exécutable. <br>	<br>	![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce fichier est créé dans le dossier "$HOME/.local/share".<br><br>- le paramètre &lt;Source des valeurs&gt; correspond au nom du fichier .INI à utiliser.<br>	Si le répertoire n'est pas précisé, le fichier est créé dans le répertoire de l'exécutable.<br>	<br>	![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce fichier est créé dans le dossier "$HOME/.local/share".<br><br><br> |
| *paramRegistre* | Les paramètres seront sauvegardés dans la base de registre.<br>Si cette option est choisie :<br><br>- par défaut, l'entrée utilisée correspond au résultat de ProjetInfo(piRegistre) (c'est-à-dire HKEY_CURRENT_USER\\Software\\&lt;Société&gt;\\&lt;Nom du projet&gt;)<br>	&lt;Société&gt; correspond à la société indiquée lors de la création de l'exécutable. Si ce nom n'est pas renseigné, &lt;Société&gt; correspond à "Applications WinDev".<br><br>- en mode Test, le chemin utilisé dans la base de registre est le suivant : HKEY_CURRENT_USER\\SOFTWARE\\PC SOFT\\WinDev\\28\\ModeTest\\&lt;Nom du projet&gt;. <br><br>- le paramètre &lt;Source des valeurs&gt; correspond à l'entrée de la base de registre à utiliser.<br><br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Le paramètre &lt;Source des valeurs&gt; sera ignoré. Si ce mode est choisi pour stocker des données persistantes, le support d'enregistrement varie en fonction du système d'exploitation sur lequel l'application s'exécute. Par exemple, sous Windows, les données sont enregistrées dans la base de registre (HKEY_CURRENT_USER\\Software\\JavaSoft\\Prefs) et sous Mac OSX, les données sont sauvées dans les préférences système.![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre n'est pas supporté dans cette version. |
| *paramXML* | Les paramètres seront sauvegardés dans un fichier au format .XML.<br>Si cette option est choisie :<br><br>- par défaut, le nom du fichier XML est &lt;Nom du projet&gt;.XML. Ce fichier est créé dans le répertoire de l'exécutable. <br>	<br>	![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce fichier est créé dans le dossier "$HOME/.local/share".<br><br>- le paramètre &lt;Source des valeurs&gt; correspond au nom du fichier .XML à utiliser. <br>	Si le répertoire n'est pas précisé, le fichier est créé dans le répertoire de l'exécutable. <br>	<br>	![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce fichier est créé dans le dossier "$HOME/.local/share".<br><br><br> |



**`<Source des valeurs> : (Chaîne de caractères optionnelle)`**

Ce paramètre dépend du mode d'initialisation choisi.  




- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDPersistance.gif) ***Exemples didactiques (WINDEV)*** : **WD Persistance** <br>Cet exemple montre l'utilisation des fonctions InitParamètre, ChargeParamètre, SauveParamètre.<br>Ces fonctions permettent de configurer la sauvegarde de champs, de variables et de tout autre paramètre.<br>Cet exemple est décomposé en trois parties :<br>	- La configuration<br>	- La gestion manuelle de variables (Fonctions SauveParamètre et ChargeParamètre)<br>	- L'optimisation<br>1°) Configuration<br>	<br>	La fenêtre de configuration vous permet de modifier l'emplacement de la sauvegarde des paramètres (Base de registre, fichier INI, fichier XML) ainsi que son chemin (clé de registre ou le chemin du fichier).<br>2°) Gestion Manuelle de variables<br>	La gestion manuelle vous permet de sauvegarder le contenu de variables grâce à la fonction SauveParamètre et de les restaurer grâce à la fonction ChargeParamètre. Chaque paramètre est identifié par un nom. Ces valeurs sont sauvegardées à l'emplacement défini dans la fenêtre de configuration.<br>3°) L'optimisation<br>	Cette fenêtre vous explique comment optimiser votre code pour éviter les lenteurs dues à la restauration des valeurs sauvegardées. En effet, lors de la restauration de la valeur d'un champ, son code de modification est exécuté. Si vous avez des traitements longs (Requêtes paramétrées ou autres), cette fenêtre vous montre comment accélérer le chargement de la fenêtre.

<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280std.dll
