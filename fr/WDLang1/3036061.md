


## fDétecteStockageAmovible (Fonction)

***En anglais : fDetectRemovableStorage***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Détecte si une unité de stockage amovible (par exemple CD, clé USB, appareil photo USB, ...) a été ajoutée ou enlevée.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
SI fDétecteStockageAmovible("MaProcédure") = Faux ALORS
	Erreur(ErreurInfo())
FIN
```

```wl
//----------------------------------------
PROCEDURE Maprocédure(Lettre, Action)
SI Action = StockageAmovibleInséré ALORS
	Info(Lettre + ": Inséré")
SINON
	Info(Lettre + ": Ejecté")
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = fDétecteStockageAmovible(<Procédure WLangage>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la détection a été effectuée. 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. 




**`<Procédure WLangage> : (Nom de procédure)`**



- Nom de la procédure WLangage à exécuter lors de la détection. Cette procédure est appelée à chaque fois qu'une unité de stockage est insérée ou éjectée.

- Chaîne vide ("") pour désactiver la détection. 




Cette procédure est de la forme :

```txt
PROCEDURE <Nom de la procédure>(<Lettre du lecteur>, <Type d'action>)
```


Le paramètre &lt;Lettre du lecteur&gt; est une chaîne permettant de connaître la lettre du lecteur associée à l'unité de stockage.

Le paramètre &lt;Type d'action&gt; est un entier permettant de savoir si le périphérique a été inséré ou éjecté. Ce paramètre peut prendre pour valeur :


|   |   |
| --- | --- |
| *StockageAmovibleInséré* | Une unité de stockage amovible a été insérée. |
| *StockageAmovibleRetiré* | Une unité de stockage amovible a été éjectée. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Appels multiples de la fonction fDétecteStockageAmovible
<a name="appels_multiples_fonction_fdetectestockageamovible_ELTPARAGRAPHE000058"></a>Si cette fonction est exécutée plusieurs fois avec des procédures différentes passées en paramètres, la dernière procédure utilisée remplacera toutes les procédures appelées auparavant : les premières procédures ne seront plus rappelées.
<a name="NOTE0_2"></a>


### Procédure locale à la fenêtre
<a name="procedure_locale_fenetre_ELTPARAGRAPHE000065"></a>Si &lt;Procédure WLangage&gt; est une procédure locale à une fenêtre, la détection prendra fin lorsque la fenêtre sera fermée. Il est conseillé d'utiliser une procédure globale.
<a name="NOTE0_3"></a>


### Limitations
<a name="limitations_ELTPARAGRAPHE000072"></a>La fonction **fDétecteStockageAmovible** ne doit pas être exécutée depuis un thread secondaire.
<a name="NOTE0_4"></a>


### Equivalence
<a name="equivalence_ELTPARAGRAPHE000082"></a>La fonction **fDétecteStockageAmovible** est équivalente à la fonction [USBDétecteStockageAmovible](../WDLang1/3090007.md).

<a name="XComposante"></a>

## Composante :
wd280std.dll
