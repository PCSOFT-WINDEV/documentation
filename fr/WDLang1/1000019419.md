
## RegistreRenomme (Fonction)

***En anglais : RegistryRename***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renomme une clé et/ou une valeur de la base de registre.

**Remarque** : Renommer une clé consiste à : 

- Copier la clé. 

- Renommer la clé copiée. 

- Supprimer l'ancienne clé. 





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Renomme la clé "MonAppli" en "MonApplication"
RegistreRenomme("HKEY_LOCAL_MACHINE\SOFTWARE\MonAppli", ...
		"HKEY_LOCAL_MACHINE\SOFTWARE\MonApplication")

// Renomme la valeur "Auto" en "Automatique"
RegistreRenomme("HKEY_LOCAL_MACHINE\SOFTWARE\MonAppli", "Auto", "Automatique")
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Renommage d'une clé de la base de registre

`<Résultat> = RegistreRenomme([<Mode d'accès>, ] <Nom de la clé à renommer> , <Nouveau nom de la clé>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le renommage a été effectué, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. 




**`<Mode d'accès> : (Constante de type Entier)`**

Mode d'accès à la base de registre :



|   |   |
| --- | --- |
| *registreMode32* | Mode d'accès forcé pour accéder à la base de registre comme un programme 32 bits. |
| *registreMode64* | Mode d'accès forcé pour accéder à la base de registre comme un programme 64 bits. |
| *registreModeAuto*<br>(Valeur par défaut) | Mode d'accès à la base de registre automatique : <br><br>- une application 32 bits exécutée sur un système 32 bits manipule la base de registre comme un programme 32 bits.<br><br>- une application 32 bits exécutée sur un système 64 bits manipule la base de registre à partir de la branche suivante :<br>	<br><pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node</code></pre><br><br><br>- une application 64 bits exécutée sur un système 64 bits manipule la base de registre comme un programme 64 bits.<br><br><br> |



**`<Nom de la clé à renommer> : (Chaîne de caractères)`**

Chemin complet de la clé à renommer. Si cette clé n'existe pas, &lt;Résultat&gt; renverra <u><u><u><u>Faux</u></u></u></u>.

**`<Nouveau nom de la clé> : (Chaîne de caractères ()`**

Nouveau chemin et nom de la clé. Si cette clé existe déjà, &lt;Résultat&gt; renverra <u><u><u><u>Faux</u></u></u></u>.


<a name="SYNTAXE2"></a>

### Renommage d'une clé de la base de registre et de sa valeur

`<Résultat> = RegistreRenomme([<Mode d'accès>, ] <Nom de la clé à renommer> , <Nom de la valeur à renommer> [, <Nouveau nom de la clé>] , <Nouveau nom de la valeur>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le renommage a été effectué, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Mode d'accès> : (Constante de type Entier)`**

Mode d'accès à la base de registre :



|   |   |
| --- | --- |
| *registreMode32* | Mode d'accès forcé pour accéder à la base de registre comme un programme 32 bits. |
| *registreMode64* | Mode d'accès forcé pour accéder à la base de registre comme un programme 64 bits. |
| *registreModeAuto*<br>(Valeur par défaut) | Mode d'accès à la base de registre automatique : <br><br>- une application 32 bits exécutée sur un système 32 bits manipule la base de registre comme un programme 32 bits.<br><br>- une application 32 bits exécutée sur un système 64 bits manipule la base de registre à partir de la branche suivante :<br>	<br><pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node</code></pre><br><br><br>- une application 64 bits exécutée sur un système 64 bits manipule la base de registre comme un programme 64 bits.<br><br><br> |



**`<Nom de la clé à renommer> : (Chaîne de caractères)`**

Chemin complet de la clé à renommer. Si cette clé n'existe pas, &lt;Résultat&gt; renverra <u><u><u><u>Faux</u></u></u></u>.

**`<Nom de la valeur à renommer> : (Chaîne de caractères)`**

Nom de la valeur à renommer dans la base de registre pour la clé spécifiée. Si cette valeur n'existe pas, &lt;Résultat&gt; renverra <u><u><u><u>Faux</u></u></u></u>.

**`<Nouveau nom de la clé> : (Chaîne de caractères optionnelle)`**

Nouveau chemin et nom de la clé. Si ce paramètre correspond à une chaîne vide ("") ou n'est pas précisé, le nom de la clé n'est pas modifié. Si cette clé existe déjà, &lt;Résultat&gt; renverra <u><u><u><u>Faux</u></u></u></u>.

**`<Nouveau nom de la valeur> : (Chaîne de caractères)`**

Nouveau nom de la valeur dans la base de registre pour la clé spécifiée. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- La fonction **RegistreRenomme** effectue une copie récursive puis une suppression récursive.

- Sous Windows Vista (et supérieurs), les opérations liées au renommage sont effectuées dans une transaction. En cas d'échec d'une opération, toutes les opérations précédentes sont annulées.

- Le propriétaire de la clé n'est pas conservé pendant le renommage (déplacement). 




<a name="XComposante"></a>

## Classification Métier / UI :
Code métier
## Composante :
wd280std.dll
