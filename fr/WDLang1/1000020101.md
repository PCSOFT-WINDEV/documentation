


## TableauChercheParProcédure (Fonction)

***En anglais : ArraySeekByProcedure***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Recherche un élément dans un tableau WLangage à une dimension en utilisant une procédure de comparaison. 

Remarque : Cette fonction est équivalente à la fonction [ChercheParProcédure](../WDLang1/1000020102.md). 






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Création d'un tableau de références
tabRéférence est un tableau de chaînes
// Recherche d'une référence connue par ses 6 premiers caractères
nIndice est un entier
nIndice = TableauChercheParProcédure(tabRéférence, ProcCompareRéférenceCourte, ...
		tcLinéaire, 0, "123456")

// Procédure ProcCompareRéférenceCourte
PROCEDURE INTERNE ProcCompareRéférenceCourte(ElémentRecherché, Recherche)
	// On compare les 6 premiers caractères des éléments du tableau 
	// avec la référence cherchée
	RENVOYER ChaîneCompare(Gauche(ElémentRecherché, 6), Recherche)
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = TableauChercheParProcédure(<Tableau WLangage> , <Procédure WLangage> , <Type de recherche> [, <Indice de départ> [, <Valeur recherchée 1> [... [, <Valeur recherchée N>]]]])`
---

**`<Résultat> : (Entier)`**

Indice de l'élément trouvé dans le tableau.

**`<Tableau WLangage> : (Tableau)`**

Nom de la variable de type Tableau dans laquelle la recherche doit être effectuée. Ce tableau doit être un tableau à une dimension.

**`<Procédure WLangage> : (Nom de procédure)`**

Procédure WLangage de comparaison. Pour plus de détails, consultez [les remarques](#NOTE0_1). 

**`<Type de recherche> : (Constante de type Entier)`**

Type de recherche à effectuer : 



|   |   |
| --- | --- |
| *tcDichotomique* | Recherche dichotomique. <br>Ce mode de recherche est rapide mais il doit être utilisé sur un tableau trié par ordre croissant avec la même procédure de comparaison ou une procédure équivalente (voir fonction [TableauTrie](../WDLang1/3075007.md)). |
| *tcLinéaire* | Recherche linéaire. La recherche démarre :<br><br>- soit à partir du premier élément, si le paramètre &lt;Indice de départ&gt; vaut 0,<br><br>- soit à partir de l'&lt;Indice de départ&gt;.<br><br><br>La recherche s'arrête au premier élément trouvé. |
| *tcLinéaireDernier* | Recherche linéaire à partir du dernier élément. Cette constante ne doit pas être utilisée si le paramètre &lt;Indice de départ&gt; est précisé. |
| *tcLinéairePrécédent* | Recherche linéaire de l'élément précédent. Cette recherche est effectuée à partir de la position en cours ou de la valeur du paramètre &lt;Indice de départ&gt;. |
| *tcLinéairePremier* | Recherche linéaire à partir du premier élément. Lorsque cette constante est utilisée, le paramètre &lt;Indice de départ&gt; n'est pas pris en compte. |
| *tcLinéaireSuivant* | Recherche linéaire de l'élément suivant. Cette recherche est effectuée à partir de la position en cours (si le paramètre &lt;Indice de départ&gt; vaut 0) ou de la valeur du paramètre &lt;Indice de départ&gt;. |



**`<Indice de départ> : (Entier optionnel)`**

Position de départ de la recherche (uniquement pour une recherche linéaire). Pour la recherche dichotomique, ce paramètre n'est pas nécessaire.

**`<Valeur recherchée 1> : (Tout type)`**

Valeur de l'élément recherché. 



**`<Valeur recherchée N> : (Tout type)`**

Valeur de l'élément recherché. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Procédure WLangage de comparaison
<a name="procedure_wlangage_comparaison_ELTPARAGRAPHE000152"></a>Cette procédure de comparaison est de la forme : 

```txt
PROCEDURE <Nom Procédure>(<Elément> , <Valeur recherchée 1> [, ... , [<Valeur recherchée N>]])
```


Cette procédure est appelée autant de fois que nécessaire. 

Le premier paramètre de la procédure correspond à l'élément du tableau à comparer. 
Les paramètres suivants sont les valeurs de recherche passées en paramètre à la fonction **TableauChercheParProcédure**. 

La procédure de comparaison doit renvoyer les valeurs suivantes : 

- Si l'élément du tableau est trop petit par rapport aux valeurs de recherche, la procédure doit renvoyer -1.

- Si l'élément du tableau est trop grand par rapport aux valeurs de recherche, la procédure doit renvoyer 1.

- Si l'élément du tableau correspond aux valeurs de recherche, la procédure doit renvoyer 0.




**Attention** : dans le cas de la recherche dichotomique, la procédure de comparaison doit renvoyer les valeurs suivantes : 

- Si l'élément du tableau est trop petit par rapport aux valeurs de recherche, la procédure doit renvoyer 1.

- Si l'élément du tableau est trop grand par rapport aux valeurs de recherche, la procédure doit renvoyer -1.

- Si l'élément du tableau correspond aux valeurs de recherche, la procédure doit renvoyer 0.




<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280vm.dll
