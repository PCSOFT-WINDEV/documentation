


## &lt;Tableau de bord&gt;.AjouteWidget (Fonction)

***En anglais : &lt;Dashboard&gt;.AddWidget***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute et affiche un Widget (fenêtre ou page interne) dans un champ Tableau de bord.

**Attention** : Les Widgets ajoutés par programmation ne s'affichent pas automatiquement. Il est nécessaire d'utiliser la fonction [&lt;Tableau de bord&gt;.ConfigurationInitiale](../WDLang1/1000022525.md) avant le premier affichage du champ Tableau de bord.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
```wl
// Ajout 2 éléments
TDB_MonTableauDeBord.AjouteWidget(FI_Ventes, "Ventes")
TDB_MonTableauDeBord.AjouteWidget(FI_StatMensuelle, "Stats Mensuelles Juillet", "201307")
```


<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
```wl
nIndice est un entier 

// Ajoute un Widget qui attend des paramètres
nIndice = TDB_TableauDeBord.AjouteWidget(FI_Widget_Horloge, "Horloge " + ...
	COMBO_AjoutWidget[COMBO_AjoutWidget].ValeurAffichée, ...
	COMBO_AjoutWidget[COMBO_AjoutWidget].ValeurAffichée)

// Affiche ce Widget à la demande
SI OuiNon(Oui, "Souhaitez-vous afficher ce Widget ?") = Oui ALORS
	TDB_TableauDeBord[nIndice].Visible = Vrai
SINON
 	ToastAffiche("Le Widget a été ajouté au tableau de bord en ""caché""." + ...
		"Passez en mode édition pour l'ajouter.", ...
		toastCourt, cvMilieu, chCentre)
FIN
```


<a name="Exemple3"></a>

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = <Champ Tableau de bord>.AjouteWidget(<Widget> , <Libellé> [, <Paramètre 1> [... [, <Paramètre N>]]])`
---

**`<Résultat> : (Entier)`**

Indice de l'élément ajouté. Cet indice peut être utilisé pour manipuler le Widget.

**`<Champ Tableau de bord> : (Nom de champ)`**

Nom du champ Tableau de bord à manipuler.

**`<Widget> : (Nom de fenêtre interne ou nom de page interne)`**



- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Nom de la fenêtre interne à ajouter dans le champ Tableau de Bord.




**`<Libellé> : (Chaîne de caractères)`**

Libellé du Widget. Ce libellé sera affiché dans le menu contextuel du champ Tableau de bord et permettra à l'utilisateur de manipuler le Widget.

**`<Paramètre 1> : (Type de la valeur envoyée à la fenêtre/page (optionnel))`**

Premier paramètre à passer à l'événement "Déclarations globales" de la fenêtre interne ou de la page interne à ouvrir. Ce paramètre est passé par référence et il est considéré comme une variable globale à la fenêtre interne ou à la page interne.
Attention : Seuls les types simples sont disponibles.



**`<Paramètre N> : (Type de la valeur envoyée à la fenêtre/page (optionnel))`**

Nième paramètre à passer à l'événement "Déclarations globales" de la fenêtre interne ou de la page interne à ouvrir. Ce paramètre est passé par référence et il est considéré comme une variable globale à la fenêtre interne ou à la page interne.
Attention : Seuls les types simples sont disponibles.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Nouveau Widget
<a name="nouveau_widget_ELTPARAGRAPHE000253"></a>Le Widget est déclaré en plus des Widgets définis dans la description du champ Tableau de bord. 

Ce Widget peut être rendu visible : 

- soit en utilisant la fonction [&lt;Tableau de bord&gt;.ConfigurationInitiale](../WDLang1/1000022525.md) avant le premier affichage.

- soit par l'utilisateur final via le menu contextuel.

- soit en utilisant la syntaxe : 
	
	```txt
	TDB_NomTableauBord[Indice].Visible = Vrai
	```
où &lt;Indice&gt; est le numéro du Widget renvoyé par la fonction **&lt;Tableau de bord&gt;.AjouteWidget**.





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDTableaudebord.gif) ***Exemples didactiques (WINDEV)*** : **WD Tableau de bord** <br>L'exemple "WD Tableau de bord" est un exemple didactique sur l'utilisation du champ Tableau de bord.<br>Cet exemple présente comment :<br>- manipuler le champ en mode "édition",<br>- sauver/charger une configuration,<br>- configurer le champ (configuration initiale, ajout / suppression de widgets, ...),<br>- rafraîchir un widget,<br>- etc.

<a name="XComposante"></a>

## Composante :
wd280obj.dll


