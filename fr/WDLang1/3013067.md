
## LanceEtatsEtRequêtes (Fonction)

***En anglais : RunReportsAndQueries***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Lance le logiciel Etats & Requêtes et ouvre le projet WINDEV correspondant à l'application en cours. Lorsque le logiciel Etats & Requêtes est lancé et si le projet WINDEV est ouvert, la fonction **LanceEtatsEtRequêtes** permet également :

- soit d'ouvrir un état. Cet état doit être contenu dans une bibliothèque WINDEV (fichier .WDL) de l'application.

- soit de lancer l'assistant de création d'un état.

- soit de lancer l'assistant de création d'une requête.




Pour plus de détails sur le logiciel Etats & Requêtes, consultez [Logiciel Etats & Requêtes](../Presentation/3088003.md).

**Remarques** : 

- Cette fonction n'est pas disponible en mode test (Go de fenêtre ou de projet). 

- Si le logiciel "Etats & Requêtes" n'est pas installé sur le poste, la fonction **LanceEtatsEtRequêtes** affiche une fenêtre spécifique proposant à l'utilisateur de rechercher ce logiciel pour l'installer.




![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LanceEtatsEtRequ%EAtes%20-%20HC%20N%B0001.gif)

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ouvre le projet WINDEV correspondant à l'application en cours
// dans le logiciel Etats & Requêtes
LanceEtatsEtRequêtes()
```


<a name="Exemple2"></a>



```wl
// Ouvre l'état "ETAT_MonEtatStat" dans le logiciel Etats & Requêtes
LanceEtatsEtRequêtes(ETAT_MonEtatStat)
```


<a name="Exemple3"></a>



```wl
// Lance l'assistant de création d'une requête 
// dans le logiciel Etats & Requêtes
LanceEtatsEtRequêtes(CréeRequête)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Ouvrir le projet WINDEV correspondant à l'application en cours sous le logiciel Etats & Requêtes

`<Résultat> = LanceEtatsEtRequêtes()`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le projet correspondant à l'application en cours s'est ouvert sous le logiciel Etats & Requêtes, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.  





<a name="SYNTAXE2"></a>

### Ouvrir un état sous le logiciel Etats & Requêtes

`<Résultat> = LanceEtatsEtRequêtes(<Etat à ouvrir>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'état spécifié s'est ouvert sous le logiciel Etats & Requêtes, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Etat à ouvrir> : (Chaîne de caractères)`**

Nom logique de l'état à ouvrir sous le logiciel Etats & Requêtes. Cet état doit être modifiable sous le logiciel Etats & Requêtes (option "Modifiable sous Etats et Rêquêtes" cochée dans l'onglet "Détail" de la description de l'état).

Lors du premier appel à la fonction **LanceEtatsEtRequêtes**, le fichier correspondant à l'état à ouvrir (fichier ".WDE") est automatiquement extrait de la bibliothèque de l'application et copié dans le répertoire "Etats et requêtes personnels" (défini lors de la création de la procédure d'installation de l'application WINDEV ou lors de l'installation de l'application WINDEV). C'est ce fichier que l'utilisateur final manipule.

Lors des appels suivants à la fonction **LanceEtatsEtRequêtes**, l'état à ouvrir sera recherché :

- tout d'abord, dans le répertoire des "Etats et requêtes personnels".

- puis, dans le répertoire des "Etats et requêtes partagés".


Ces répertoires ont été définis dans l'assistant d'installation de l'application. 

Pour plus de détails sur le fonctionnement du logiciel Etats & Requêtes, consultez [Diffuser le logiciel Etats & Requêtes](../Presentation/3088002.md).  


<a name="SYNTAXE3"></a>

### Créer un état ou une requête sous le logiciel Etats & Requêtes

`<Résultat> = LanceEtatsEtRequêtes(<Type d'élément à créer>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'assistant de création d'un état ou d'une requête s'est lancé sous le logiciel Etats & Requêtes, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Type d'élément à créer> : (Constante de type entier)`**

Type d'élément à créer :


|   |   |
| --- | --- |
| *CréeEtat* | Lance l'assistant de création d'un état |
| *CréeRequête* | Lance l'assistant de création d'une requête |





<a name="NOTE0"></a>


<a name="XComposante"></a>

## Composante :
wd280etat.dll
