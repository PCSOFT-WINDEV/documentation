
## dChargeImage (Fonction)

***En anglais : dLoadImage***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Charge une image dans une variable de type [Image](../WDLang1/1000019650.md) à partir d'un mémo, d'un fichier ou d'un buffer binaire (buffer contenant les données complètes d'un fichier image reconnu). 

 

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Chargement d'une image à partir d'un fichier dans le répertoire de l'exécutable
MonImage est une Image
MonImage = dChargeImage("image.png")
```





```wl
sNomFichierPDF est une chaîne = fRepDonnees() + fSep() +"MonFichier.pdf"
// Chargement d'une image vectorielle (ici un PDF, cela pourrait être un SVG)
// Récupération des caractéristiques de l'image
sInfoPDF est une chaîne = InfoBitmap(sNomFichierPDF)
// Les images vectorielles sont transformées en images bitmap (raster, donc non vectorielles)
// On  définit la résolution à laquelle on désire cette image
nDpiVoulu est entier = 300
soit nLargeurPixel = Val(ExtraitChaîne(sInfoPDF,2))*nDpiVoulu / 96 
soit nHauteurPixel = Val(ExtraitChaîne(sInfoPDF,3))*nDpiVoulu / 96
// (Divisé par 96 car c'est la résolution utilisée
// pour donner la taille d'une image vectorielle par la fonction InfoBitmap)
// Charge l'image à l'écran dans un champ Image avec la taille correspondant au DPI voulu
IMG_PDF = dChargeImage(sNomFichierPDF, imgConvertir, nLargeurPixel,nHauteurPixel)
// Ou si l'image n'est pas affichée, utilisation d'une variable Image :
MonImage est une Image = dChargeImage(sNomFichierPDF, imgConvertir, nLargeurPixel, nHauteurPixel)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = dChargeImage(<Image> [, <Options> [, <Largeur> [, <Hauteur>]]])`
---

**`<Résultat> : (Variable de type Image)`**

Nom de la variable de type [Image](../WDLang1/1000019650.md) dans laquelle l'image doit être chargée. 

**`<Image> : (Chaîne de caractères)`**

Image à charger. Cette image peut correspondre : 

- au chemin complet du fichier image,

- au nom d'un fichier image (si le fichier image est dans le répertoire de l'exécutable), 

- à une rubrique mémo binaire présente dans un fichier de données, 

- à un buffer binaire contenant les données complètes d'un fichier image reconnu (résultat d'une fonction de sauvegarde d'image, par exemple de la fonction [dSauveImagePNG](../WDLang1/3029027.md)). 




**`<Options> : (Constante optionnelle de type Entier)`**

Options de chargement de l'image : 


|   |   |
| --- | --- |
| *imgConvertir* | Conversion d'une image 8 bits au format 24 bits. Cette option permet par exemple par la suite d'appliquer les algorithmes d'effet à cette image. Cette constante peut être utilisée par exemple pour les images correspondant à des fichiers PDF.<br><br>**Dans le cas des images vectorielles (SVG)**, cette constante est obligatoire. Elle permet d'indiquer que l'image doit être convertie en image bitmap (raster) avant d'être chargée (en effet, le type [Image](../WDLang1/1000019650.md) ne gère pas les images vectorielles).<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |
| *imgDéfaut* <br>(Valeur par défaut) | Chargement de l'image telle quelle. |



**`<Largeur> : (Entier optionnel)`**

Largeur de destination voulue (image vectorielle uniquement). Cette largeur est exprimée en pixels. 

**`<Hauteur> : (Entier optionnel)`**

Hauteur de destination voulue (image vectorielle uniquement). Cette hauteur est exprimée en pixels. 









<a name="XComposante"></a>

## Composante :
wd280pnt.dll
