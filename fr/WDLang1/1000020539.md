


## TCDCalculeTout (Fonction)

***En anglais : PVTCalculateAll***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Calcule ou recalcule entièrement un champ Tableau croisé dynamique. Attention : cette opération peut être relativement longue. 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
SI OuiNon("Voulez-vous recalculer entièrement le Tableau croisé dynamique?") ALORS
	TCDCalculeTout(TCD_Ventes)
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`TCDCalculeTout(<Champ Tableau croisé dynamique>)`
---

**`<Champ Tableau croisé dynamique> : (Nom de champ)`**

Nom du champ Tableau croisé dynamique à calculer ou recalculer. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Comment le calcul est-il effectué ? 
<a name="comment_calcul_estil_effectue_ELTPARAGRAPHE000044"></a>Le calcul est effectué en parcourant tous les enregistrements nécessaires. Ce calcul peut être relativement long selon la taille de la base de données. Par exemple, un calcul sur une base d'un million d'enregistrements peut prendre quelques minutes. 

- Le contenu du champ Tableau croisé dynamique doit être recalculé entièrement : 

	- Lors de l'ajout de nouvelles rubriques à afficher. 

	- Lors de la modification des fonctions de filtrage. 

	- Lors de la modification des données source du calcul. 




- Le contenu du champ Tableau croisé dynamique n'a pas besoin d'être recalculé entièrement : 

	- Lors de l'utilisation d'un filtre sur une dimension déjà calculée. 

	- Lors du changement de dimension.  

	- Lors du déroulement ou de l'enroulement d'une dimension (par exemple, visualiser les trimestres au lieu des années). 








### Progression du calcul
<a name="progression_calcul_ELTPARAGRAPHE000064"></a>

- Pendant le calcul du champ Tableau croisé dynamique, une jauge de progression est affichée. 

- L'utilisateur a la possibilité d'annuler le calcul via un bouton "Annuler". ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=FAA_TCD_Cellule_Jauge.gif)
 Pour savoir si le calcul a été effectué jusqu'au bout, utilisez la variable [ErreurDétectée](../WDLang1/3087001.md). 
	Exemple : 
	
	```wl
	PROCEDURE Chargement_TCD()
	
	TCDCalculeTout(TCD_Statistiques)
	SI ErreurDétectée = Vrai ALORS
		SELON Dialogue("Voulez-vous annuler le traitement en cours ?")
			// Annuler
			CAS 1
				Ferme()
			// Continuer
			CAS 0
				Chargement_TCD()
		FIN
	FIN
	```






- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDTableauCroiseDynamique.gif) ***Exemples didactiques (WINDEV)*** : **WD TableauCroiséDynamique** <br>Cet exemple illustre l'utilisation du champ Tableau croisé dynamique.<br><br>Ce champ tableau croisé dynamique permet d'afficher des statistiques dynamiques en effectuant des regroupements.<br>Ces statistiques sont calculées à partir de la base de données.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
