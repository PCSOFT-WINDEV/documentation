
## Milieu (Fonction)

***En anglais : Middle***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Extrait : 

- soit une sous-chaîne d'une chaîne à partir d'une position donnée.

- soit une portion d'un buffer à partir d'une position donnée.






**Remarque** : Il est possible d'obtenir la même fonctionnalité avec l'opérateur [[]].




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Extraction de caractères
Milieu("Eponine", 2, 3)   // Renvoie "pon"
Milieu("Eponine", 2)    // Renvoie "ponine"
Milieu("Eponine", 50)    // Renvoie ""
Milieu("Eponine", 2, 50)   // Renvoie "ponine"
// Equivalent à 
// MaChaîne est une chaîne = Eponine
// MaChaîne = MaChaîne[[2,50]]

MaChaîne est une chaîne = "Antananarivo - Madagascar"
Milieu(MaChaîne, 10, 7)   // Renvoie "ivo - M"
```




<a name="Exemple2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Extraction d'octets
MonBuffer est un Buffer = "Antananarivo - Madagascar"
Milieu(MonBuffer, 10, 7) // Renvoie "ivo - M"
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Extraire une sous-chaîne d'une chaîne

`<Résultat> = Milieu(<Chaîne initiale> , <Position de départ> [, <Longueur>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Partie de &lt;Chaîne initiale&gt;.

- Chaîne vide ("") si le paramètre &lt;Position de départ&gt; est supérieur à la longueur de &lt;Chaîne initiale&gt;.

- EOT si le paramètre &lt;Position de départ&gt; et/ou le paramètre &lt;Longueur&gt; sont négatifs. Une erreur du WLangage est générée (erreur non fatale). Pour plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Chaîne initiale> : (Chaîne de caractères)`**

Chaîne de caractères contenant la sous-chaîne à extraire. Cette chaîne n'est pas modifiée.

**`<Position de départ> : (Entier)`**

Position du premier caractère à extraire. 
Si &lt;Position de départ&gt; est nul, l'extraction commence au début de la chaîne.

**`<Longueur> : (Entier optionnel)`**

Nombre de **caractères** à extraire. 
Si ce paramètre n'est pas précisé ou est supérieur au nombre de caractères restant après la &lt;Position de départ&gt;, la chaîne est renvoyée à partir de la &lt;Position de départ&gt;.  


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Extraire une portion d'un buffer

`<Résultat> = Milieu(<Buffer initial> , <Position de départ> [, <Taille>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Partie de &lt;Buffer initial&gt;.

- Chaîne vide ("") si le paramètre &lt;Position de départ&gt; est supérieur à la longueur de &lt;Buffer initial&gt;.

- EOT si le paramètre &lt;Position de départ&gt; et/ou le paramètre &lt;Taille&gt; sont négatifs. Une erreur du WLangage est générée (erreur non fatale). Pour plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).

- Buffer invalide si &lt;Buffer initial&gt; contient une chaîne de caractères au format UNICODE.




**`<Buffer initial> : (Buffer)`**

Buffer contenant la portion à extraire. Ce buffer n'est pas modifié.

**`<Position de départ> : (Entier)`**

Position du premier octet à extraire. 
Si &lt;Position de départ&gt; est nul, l'extraction commence au début du buffer.

**`<Taille> : (Entier optionnel)`**

Nombre **d'octets** à extraire. 
Si ce paramètre n'est pas précisé ou est supérieur au nombre de caractères restant après la &lt;Position de départ&gt;, la chaîne est renvoyée à partir de la &lt;Position de départ&gt;. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Fonction Milieu et UNICODE
<a name="fonction_docparampagetitleshort_unicode_ELTPARAGRAPHE000130"></a>Si la chaîne passée en paramètre est au format ANSI, le résultat sera au format ANSI.

Si la chaîne passée en paramètre est au format UNICODE, le résultat sera au format UNICODE.

**Rappel** : En UNICODE, chaque caractère occupe deux octets de mémoire. La taille mémoire d'une chaîne UNICODE correspond donc au double du nombre de caractères réellement contenu dans la chaîne.

Le premier caractère de la chaîne possède l'indice 1.

**Remarque** : Si le résultat sur une chaîne ANSI est affecté à une chaîne UNICODE (et inversement), la conversion sera implicitement réalisée.

Pour plus de détails, consultez [Gestion de l'UNICODE](../WDLang1/3024038.md).
<a name="NOTE0_2"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000140"></a>Il est possible d'obtenir la même fonctionnalité avec l'opérateur [[]].



<a name="XComposante"></a>

## Composante :
wd280vm.dll
