


## ListeOccurrence (Fonction)

***En anglais : ListCount***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie le nombre d'éléments présents dans un champ Liste, Liste image ou Combo.

**Remarque** : La fonction **ListeOccurrence** peut être utilisée indifféremment sur :

- les champs Liste fichier ou Liste par programmation,

- les champs Liste monosélection ou multisélections.













<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Nombre d'éléments présents dans le champ "LISTE_ListeClient"
ResNombreElément = ListeOccurrence(LISTE_ListeClient)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ListeOccurrence(<Champ Liste>)`
---

**`<Résultat> : (Entier)`**

Nombre d'éléments (lignes) présents dans le champ spécifié.

**`<Champ Liste> : (Nom de champ)`**

Nom du champ Liste ou Combo à manipuler. Si ce paramètre correspond à une chaîne vide (""), le champ manipulé correspond au champ auquel le traitement en cours appartient.




<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Limitations
<a name="limitations_ELTPARAGRAPHE000103"></a>Si le champ Liste (ou Combo) spécifié est relié à un fichier de données qui contient plus de 2 147 483 647 enregistrements, la valeur renvoyée est tronquée à cette valeur.
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Champ Liste fichier
<a name="champ_liste_fichier_ELTPARAGRAPHE000114"></a>Pour un champ Liste fichier, la fonction **ListeOccurrence** renvoie :

- soit le nombre total d'enregistrements du fichier relié si aucun filtre n'a été défini.

- soit le nombre d'enregistrements qui correspondent au filtre si un filtre a été défini.

- soit le nombre d'enregistrements présents dans la requête liée au champ.




Le code de fin d'initialisation du champ est exécuté uniquement lorsque le total est calculé.

**Attention** : Le temps de calcul du nombre d'enregistrements peut être long.
<a name="NOTE0_3"></a>


### Dernier élément
<a name="dernier_element_ELTPARAGRAPHE000135"></a>Pour se positionner sur le dernier élément d'un champ Liste, la syntaxe est :

```txt
ListeSelectPlus(<Champ Liste>, <Champ Liste>.Occurrence)
```


ou

```txt
<Champ Liste> = <Champ Liste>.Occurrence
```
ou

```txt
<Champ Liste> = ListeOccurrence(<Champ Liste>)
```



<a name="NOTE0_4"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000161"></a>

- Pour connaître le nombre de lignes d'un champ Table, utilisez la fonction [TableOccurrence](../WDLang1/3074021.md).

- La fonction **ListeOccurrence** peut être utilisée sur une colonne d'un champ Table de type "Combo".




<a name="XComposante"></a>

## Composante :
wd280obj.dll
