


## TCDSauve (Fonction)

***En anglais : PVTSave***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Sauve le résultat du calcul d'un champ Tableau croisé dynamique (dans un fichier ou en mémoire). Cette sauvegarde pourra être rechargée dans un champ Tableau croisé dynamique grâce à la fonction [TCDCharge](../WDLang1/1000020507.md). 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
sFichier est une chaîne
// Construit le nom du fichier
sFichier = SysRep(srAppData) + ["\"] + "StatsParPays.tcd"

// Le fichier existe ?
SI fFichierExiste(sFichier) ALORS
	// Oui, on le charge 
	TCDCharge(TCD_Statistiques, sFichier)
	SI OuiNon("Voulez-vous tout recalculer ?") ALORS TCDCalculeTout(TCD_Statistiques)
SINON
	// Le fichier n'existe pas, on le calcule
	TCDCalculeTout(TCD_Statistiques)
FIN
TCDSauve(TCD_Statistiques, sFichier)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Sauvegarder un champ Tableau croisé dynamique avec son interface et un mot de passe

`<Résultat> = TCDSauve(<Champ Tableau croisé dynamique> , <Support de sauvegarde> [, <Mode de sauvegarde> [, <Mot de passe>]])`
---

**`<Résultat> : (Type selon le support de sauvegarde)`**



- Sauvegarde en mémoire : Buffer contenant la sauvegarde. Cette sauvegarde peut être par la suite enregistrée dans un ficher (fonction [fSauveBuffer](../WDLang1/1000019412.md)), ...

- Sauvegarde dans un fichier : 

	- <u><u><u><u>Vrai</u></u></u></u> si la sauvegarde a été effectuée, 

	- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.  







**`<Champ Tableau croisé dynamique> : (Nom de champ)`**

Nom du champ Tableau croisé dynamique à manipuler.

**`<Support de sauvegarde> : (Chaîne de caractères ou constante)`**



- Sauvegarde en mémoire : constante *enMémoire* : Sauvegarde le contenu du champ Tableau croisé dynamique en mémoire. &lt;Résultat&gt; contient le résultat de la sauvegarde. 

- Sauvegarde dans un fichier : Nom et chemin complet du fichier dans lequel le contenu du champ Tableau croisé dynamique sera sauvé.




**`<Mode de sauvegarde> : (Constante optionnelle de type Entier)`**

Par défaut, seules les données sont sauvegardées. Il est également possible de sauvegarder l'interface du champ Tableau croisé dynamique : 


|   |   |
| --- | --- |
| *tcdAvecUI* | Sauvegarde la configuration du champ Tableau croisé dynamique :<br><br>- taille des colonnes,<br><br>- taille des lignes,<br><br>- entêtes de colonnes et de lignes enroulées ou déroulées.<br><br><br><br><br>Remarque : Avant la version 25, cette constante s'appelait *tcdAvecIHM*. |

Si les paramètres &lt;Mode de sauvegarde&gt; et &lt;Mot de passe&gt; ne sont pas spécifiés, seules les données du champ Tableau croisé dynamique seront sauvegardées et la sauvegarde ne sera pas protégée par mot de passe. Pour sauvegarder uniquement les données et protéger la sauvegarde par un mot de passe, utilisez la syntaxe 2. 

**`<Mot de passe> : (Chaîne de caractères optionnelle)`**

Mot de passe de la sauvegarde. Si la sauvegarde est protégée par un mot de passe, ce mot de passe devra être indiqué lors du chargement de la sauvegarde avec la fonction [TCDCharge](../WDLang1/1000020507.md). 


<a name="SYNTAXE2"></a>

### Sauvegarder un champ Tableau croisé dynamique sans son interface et un mot de passe

`<Résultat> = TCDSauve(<Champ Tableau croisé dynamique> , <Support de sauvegarde> [, <Mot de passe>])`
---

**`<Résultat> : (Type selon le support de sauvegarde)`**



- Sauvegarde en mémoire : Buffer contenant la sauvegarde. Cette sauvegarde peut être par la suite enregistrée dans un ficher (fonction [fSauveBuffer](../WDLang1/1000019412.md)), ...

- Sauvegarde dans un fichier : 

	- <u><u><u><u>Vrai</u></u></u></u> si la sauvegarde a été effectuée, 

	- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.  







**`<Champ Tableau croisé dynamique> : (Nom de champ)`**

Nom du champ Tableau croisé dynamique à manipuler.

**`<Support de sauvegarde> : (Chaîne de caractères ou constante)`**



- Sauvegarde en mémoire : constante *enMémoire* : Sauvegarde le contenu du champ Tableau croisé dynamique en mémoire. &lt;Résultat&gt; contient le résultat de la sauvegarde. 

- Sauvegarde dans un fichier : Nom et chemin complet du fichier dans lequel le contenu du champ Tableau croisé dynamique sera sauvé.




**`<Mot de passe> : (Chaîne de caractères optionnelle)`**

Mot de passe de la sauvegarde. Si la sauvegarde est protégée par un mot de passe, ce mot de passe devra être indiqué lors du chargement de la sauvegarde avec la fonction [TCDCharge](../WDLang1/1000020507.md). 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Sauvegarde et chargement d'un champ Tableau croisé dynamique
<a name="sauvegarde_chargement_champ_tableau_croise_dynamique_ELTPARAGRAPHE000142"></a>Lorsque le contenu d'un champ Tableau croisé dynamique est calculé avec la fonction [TCDCalculeTout](../WDLang1/1000020539.md), le résultat peut être sauvé avec la fonction **TCDSauve**. Il est ensuite possible de le recharger avec la fonction [TCDCharge](../WDLang1/1000020507.md) : dans ce cas, le contenu du champ Tableau croisé dynamique n'est pas recalculé.  

<a name="XComposante"></a>

## Composante :
wd280obj.dll
