
## Dialoguer avec l'utilisateur
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000255"></a>
Les boîtes de dialogue sont des fenêtres standard permettant de dialoguer avec l'utilisateur. Il est ainsi possible de lui signaler une erreur, de lui demander une confirmation, ...

Les boîtes de dialogue comportent toujours les mêmes éléments :

- Une icône permettant d'identifier rapidement le type du message affiché (Information, Question ou Erreur).

- Un titre affiché dans la barre de titre. 

- Un ou plusieurs boutons permettant à l'utilisateur de choisir la réponse voulue. Le nombre et le type de ces boutons dépendent du type de la boîte de dialogue utilisée.

- Un texte sur une ou plusieurs lignes correspondant au message destiné à l'utilisateur.




Différentes boîtes de dialogue sont disponibles : 

- **[Les boîtes de dialogue simples](#NOTE2_1)**
	Ces boîtes de dialogue sont composées d'une image, d'un texte et d'un ou plusieurs boutons OK, Annuler, Oui ou Non. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) **[Les boîtes de dialogue avancées](#NOTE3_1)**. 
	Ces boîtes de dialogue peuvent afficher un texte spécifique dans les boutons ou permettre une saisie à l'utilisateur. 




Il est possible de : 

- [personnaliser ces boîtes de dialogue](#NOTE4_1). 

- [gérer ces boîtes de dialogue par programmation](#NOTE5_1). 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Les boîtes de dialogue simples
<a name="les_boites_dialogue_simples_ELTTEXTE000279"></a>
Plusieurs types de boîtes de dialogue sont disponibles :

- Les boîtes d'information ou d'erreur. Par exemple : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=fonctions_dialogue%20-%20HC%20N%B0004.gif)


- Les boîtes de question. Par exemple : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=fonctions_dialogue%20-%20HC%20N%B0007.gif)


- Les boîtes de confirmation. Par exemple : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=fonctions_dialogue%20-%20HC%20N%B0005.gif)





**Remarques** :

- Dans chaque type de boîte de dialogue, il est possible de choisir le bouton à sélectionner par défaut.

- Le libellé des boutons s'affiche dans la langue utilisée par Windows sur le poste en cours.

- Selon la plateforme utilisée, certaines fonctions peuvent ne pas être disponibles.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Les boîtes de dialogue avancées
<a name="les_boites_dialogue_avancees_ELTTEXTE000303"></a>
Les boîtes de dialogue avancées permettent de gérer :

- ![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) **la saisie immédiate**.
	La saisie immédiate permet d'éviter la création d'une nouvelle fenêtre pour saisir uniquement une information. Grâce à la fonction [Saisie](../WDLang1/3021016.md), vous pouvez utiliser une simple boîte de dialogue pour saisir une donnée (champ de saisie ou case à cocher). L'utilisateur peut valider ou annuler la saisie.![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=fonctions_dialogue%20-%20HC%20N%B0008.gif)


- **l'interrogation directive**.
	 L'interrogation directive consiste à guider l'utilisateur dans la saisie de sa réponse, pour éviter toute ambiguïté : l'utilisateur répond à une question grâce à des boutons contenant le texte de l'action à effectuer. ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=fonctions_dialogue%20-%20HC%20N%B0009.gif)
La fonction [Dialogue](../WDLang1/3021015.md) propose via un assistant :

	- soit de sélectionner un message déjà existant, présent dans la base des messages. 

	- soit de créer un nouveau message grâce à une fenêtre très simple.


 Lorsque les différentes caractéristiques du message sont saisies, le code correspondant est automatiquement généré.




**Remarque : Base de messages de l'interrogation directive**
WINDEV propose une liste de messages par défaut. Ces messages ne peuvent pas être supprimés. Ils constituent la base des messages. 
Lors de la création d'un message, ce message est automatiquement ajouté à la base de messages. Par défaut, la base de messages est présente dans le répertoire "Personnel\\Messages" de WINDEV. 
Ce répertoire peut être modifié dans les options de WINDEV : 

1. Sous le volet "Accueil", dans le groupe "Environnement", déroulez "Options" et sélectionnez "Options générales de WINDEV". 

2. Dans l'onglet "Répertoires", spécifiez le répertoire voulu pour la base des messages.




Pour supprimer un message de la base de messages :

1. Affichez l'éditeur de code.

2. Sous le volet "Code", dans le groupe "Langues", déroulez "Traduire les chaînes" et sélectionnez "Interrogations directives".

3. Sélectionnez le message à supprimer et cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IconeSupprimeFavoris.gif)
.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Personnaliser les boites de dialogue
<a name="personnaliser_les_boites_dialogue_ELTTEXTE000327"></a>
Les boîtes de dialogue affichées peuvent : 

- utiliser le look système. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) proposer les FAA (Fonctionnalités Automatiques de vos Applications). L'utilisateur pourra ainsi paramétrer par exemple le raccourci clavier associé à chaque bouton ou l'exécution automatique du bouton. 
	Remarque : A partir de la version 28 U2 (version 280075), cette fonctionnalité est disponible par défaut pour les nouveaux projets.

- être entièrement personnalisées. Il est ainsi possible de leur appliquer automatiquement le gabarit de l'application en cours ou d'utiliser des boîtes de dialogue multilingues. 




Pour plus de détails, consultez [Personnaliser les boîtes de dialogue](../WDLang1/3021003.md).





<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Programmation des boites de dialogue
<a name="programmation_des_boites_dialogue_ELTTEXTE000351"></a>
Les fonctions permettant de gérer un dialogue avec l'utilisateur sont les suivantes : 



|   |   |
| --- | --- |
| [Avertissement](../WDLang1/3021009.md) | Affiche un message personnalisé dans une fenêtre d'avertissement système. |
| [Confirmer](../WDLang1/3021007.md) | Affiche un message dans une boîte de dialogue standard proposant les réponses "Oui", "Non", "Annuler" et renvoie la réponse de l'utilisateur. |
| [Dialogue](../WDLang1/3021015.md) | Affiche une boîte de message et renvoie la valeur du bouton cliqué par l'utilisateur. |
| [Erreur](../WDLang1/3021013.md) | Affiche un message d'erreur personnalisé dans une fenêtre d'erreur système. |
| [Info](../WDLang1/3021011.md) | Affiche un message personnalisé dans une fenêtre d'information système. |
| [OKAnnuler](../WDLang1/3021004.md) | Affiche un message dans une boîte de dialogue standard proposant les réponses "OK" et "Annuler" et renvoie la réponse de l'utilisateur. |
| [OuiNon](../WDLang1/3021005.md) | Affiche un message dans une boîte de dialogue standard proposant les réponses "Oui" et "Non" et renvoie la réponse de l'utilisateur. |
| [Saisie](../WDLang1/3021016.md) | Affiche un message en permettant à l'utilisateur de saisir une information. |



Par défaut, les boîtes de dialogue affichées sont bloquantes. 

Pour que ces boîtes de dialogue ne soient pas bloquantes, il est possible de : 

- fermer automatiquement ces boîtes de dialogue. En effet, par défaut, les boîtes de dialogue sont fermées uniquement lors de l'action de l'utilisateur sur un des boutons de la boîte. Si aucun bouton n'est enfoncé, l'application est bloquée. 
	Pour éviter tout risque de blocage, il suffit d'utiliser la fonction [DélaiAvantFermeture](../WDLang1/3038040.md) en indiquant la durée voulue avant la fermeture automatique de la boîte de dialogue.

- utiliser les fonctions [ErreurAvecDélai](../WDLang1/1000020529.md) et [InfoAvecDélai](../WDLang1/1000020528.md) qui permettent de ne pas bloquer l'application lors de l'affichage de ces boîtes d'information ou d'erreur.

- utiliser les fonctions de dialogue asynchrone.



![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Dialogue asynchrone
<a name="dialogue_asynchrone_ELTPARAGRAPHE000196"></a>Le principe du dialogue asynchrone est le suivant : 

- L'appel de la fonction affiche la boîte de dialogue correspondant à la fonction. 

- Le code qui suit l'appel continue à s'exécuter. 

- Quand l'utilisateur clique sur un des boutons de la boîte de dialogue, la procédure "callback" de la fonction est exécutée. Cette procédure permet de traiter si nécessaire la réponse de l'utilisateur. 




WINDEV et WINDEV Mobile proposent des fonctions WLangage permettant de gérer un dialogue asynchrone. Ces fonctions sont identiques aux fonctions standards. Seul le mot "Asynchrone" a été ajouté pour les identifier rapidement : 



|   |   |
| --- | --- |
| [AvertissementAsynchrone](../WDLang1/1000025270.md) | Affiche un message personnalisé dans une fenêtre d'avertissement système non bloquante. |
| [ConfirmerAsynchrone](../WDLang1/1000025305.md) | Affiche un message non bloquant dans une boîte de dialogue standard proposant les réponses "Oui", "Non", "Annuler" et appelle une procédure WLangage avec la réponse de l'utilisateur. |
| [DialogueAsynchrone](../WDLang1/1000025310.md) | Affiche une boîte de message non bloquante et appelle une procédure WLangage avec la valeur du bouton cliqué par l'utilisateur. |
| [ErreurAsynchrone](../WDLang1/1000025306.md) | Affiche un message d'erreur personnalisé dans une fenêtre d'erreur système non bloquante. |
| [ErreurAvecDélaiAsynchrone](../WDLang1/1000025428.md) | Affiche un message d'erreur personnalisé dans une fenêtre d'erreur système non bloquante pendant un délai défini. |
| [InfoAsynchrone](../WDLang1/1000025269.md) | Affiche un message personnalisé et non bloquant dans une fenêtre d'information système. |
| [InfoAvecDélaiAsynchrone](../WDLang1/1000025271.md) | Affiche un message personnalisé dans une fenêtre d'information système non bloquante pendant un délai défini. |
| [OKAnnulerAsynchrone](../WDLang1/1000025308.md) | Affiche un message dans une boîte de dialogue standard non bloquante proposant les réponses "OK" et "Annuler" et appelle une procédure WLangage avec la réponse de l'utilisateur. |
| [OuiNonAsynchrone](../WDLang1/1000025272.md) | Affiche un message dans une boîte de dialogue standard non bloquante proposant les réponses "Oui" et "Non" et appelle une procédure WLangage avec la réponse de l'utilisateur. |





**Ces fonctions sont obligatoires pour compiler une application Catalyst**. Elles peuvent également être très utiles dans vos applications Windows. En effet, elles permettent un dialogue non bloquant avec l'utilisateur. L'application peut ainsi donner une information à l'utilisateur ou lui poser une question mais le code continue de s'exécuter, même si l'utilisateur n'est pas devant son écran ou s'il a besoin de temps pour répondre : l'exécution du programme n'est pas bloquée. 


