
## ExécuteJS (Fonction)

***En anglais : ExecuteJS***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Exécute du code Javascript dans le contexte de la page Web affichée par un champ d'affichage HTML. 

**Attention** : L'option "Interdit l'exécution des scripts JavaScript" doit être décochée dans l'onglet "Général" de la fenêtre de description du champ d'affichage HTML. 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
codeJS est une chaîne = [
var Maintenant = new Date();
alert('Nous sommes le : ' + Maintenant);
]
ExécuteJS(HTM_MonChampHTML, codeJS)
```


<a name="Exemple2"></a>

```wl
codeJS est une chaîne = [
var Maintenant = new Date();
var resultat = '' + Maintenant;
''+Maintenant;
]

ExécuteJS(HTM_MonChamp, codeJS, ExécuteJS_Callback)

PROCEDURE INTERNE ExécuteJS_Callback(bSuccès est booléen, ValeurRetour est une chaîne)
	SI PAS bSuccès
		Erreur(ErreurInfo())
		RETOUR
	FIN
	Info(ValeurRetour)
FIN
```





<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = ExécuteJS(<Champ d'affichage HTML> , <Code Javascript> [, <Procédure WLangage>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le code Javascript a été transmis pour exécution au champ, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. 




**`<Champ d'affichage HTML> : (Nom de champ)`**

Nom du champ d'affichage HTML sur lequel le script Javascript doit être exécuté. 

**`<Code Javascript> : (Chaîne de caractères)`**

Code Javascript à exécuter. Ce code est exécuté de manière asynchrone. Le résultat de l'exécution du code Javascript peut être connu grâce au paramètre &lt;Procédure WLangage&gt;. 

La valeur retournée par le code Javascript correspond à la valeur de l'expression qui se trouve sur la dernière ligne du code Javascript. Il ne faut pas utiliser "return". L'expression à récupérer doit être une chaîne.

**`<Procédure WLangage> : (Nom de procédure optionnel)`**

Procédure WLangage (également nommée "callback") permettant de connaître le résultat de l'exécution du code Javascript. Cette procédure est de la forme : 

```txt
PROCEDURE <Nom de la procédure>(bSuccès est un booléen, ValeurRetour est une chaîne)
```
Cette procédure est appelée une fois l'exécution du code Javascript terminée. Les paramètres de cette procédure sont : 

- &lt;bSuccès&gt; : 

	- <u><u><u><u>Vrai</u></u></u></u> si l'exécution du code Javascript s'est correctement terminée, 

	- <u><u><u><u>Faux</u></u></u></u> si l'exécution du code Javascript s'est terminée en erreur (erreur dans le code Javascript par exemple). Dans ce cas, il est possible d'obtenir le détail de l'erreur grâce à la fonction [ErreurInfo](../WDLang1/3013008.md). 
			




- &lt;ValeurRetour&gt; contient la valeur de la dernière expression de l'exécution du code Javascript (valeur retournée).






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
<a name="NOTE0_2"></a>


### Appel de code WLangage depuis le code Javascript
<a name="appel_code_wlangage_depuis_code_javascript_ELTPARAGRAPHE000119"></a>Il est possible d'appeler du code WLangage depuis un code Javascript exécuté via la fonction **ExécuteJS** ou via le code HTML contenu dans le champ d'affichage HTML. Les manipulations à effectuer sont les suivantes : 

1. Dans l'onglet "Général" du champ d'affichage HTML, cochez l'option "Autoriser l'appel de WLangage depuis le code HTML (fonction JavaScript WL.Execute)". 

2. Dans le code du HTML du champ, utilisez **WL.Execute** pour exécuter une procédure WLangage. La syntaxe à utiliser est la suivante : 
	
	```txt
	WL.Execute(<Nom procédure WLangage> [, <Paramètre 1> [, ... [, <Paramètre N>]]] )
	```
 où : 

	- &lt;Nom procédure WLangage&gt; correspond au nom de la procédure à exécuter. 

	- &lt;Paramètre N&gt; correspond aux différents paramètres à passer à la procédure : 

		- Nombre de paramètres : 

			- ![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) entre 0 et N.




- Type des paramètres : 

	- ![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) Les paramètres de la procédure WLangage seront passés selon leur type en tant que boolean, string, number, null. 




Exemple : 

- Procédure WLangage 
	
	```wl
	PROCÉDURE ProcFromJS(t)
	ToastAffiche("Appelé depuis le JS : " + t)
	```


- Code du champ HTML : 
	
	```wl
	s est chaîne = [
		<html>
		<head>
		<title> Un exemple simple 
		</title>
		<script>	
		function myFunction() 
		{
			WL.Execute("ProcFromJS","titaa");
		}
		</script>
		</head>
		<body>
		<h1> Voici une page HTML </h1>
		<p id="demo">Un paragraphe</p>
		<button type="button" onclick="myFunction()">Essayer</button>
		</body>
		</html>
	]
	HTM_SansNom1 = s
	```








- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WMDialogueHTML.gif) ***Exemples multiplateforme (WINDEV Mobile)*** : **WM Dialogue HTML** <br>Cet exemple vous montre comment dialoguer avec un champ HTML. <br>Il utilise la fonction WLangage "ExecuteJS" et la fonction Javascript "WL.Execute".



<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
