


## &lt;Image&gt;.SauveBMP (Fonction)

***En anglais : &lt;Image&gt;.SaveBMP***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Sauve une image :

- soit dans un fichier au format BMP.

- soit en mémoire.




Cette image correspond à l'image contenue dans un champ Image.

**Remarques** :

- Seule la partie visible du champ Image est sauvegardée. 

- Cette fonction permet uniquement de sauvegarder des images pour des résolutions d'écran allant jusqu'à 32 bits.

- Cette fonction ne peut pas être utilisée avec les champs Image présents dans les états.


![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) **Attention** : L'utilisation de cette fonction sous Linux nécessite une configuration spécifique. Pour plus de détails, consultez [Les dessins](../WDLang1/3029035.md). 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Sauve en mémoire l'image présente dans "IMG_ImageDessin"
ResSauvegarde = IMG_ImageDessin.SauveBMP(enMémoire)
```


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Sauve l'image présente dans "IMG_ImageDessin" sur "C:\Documents\Image.BMP"
ResSauvegarde = IMG_ImageDessin.SauveBMP("C:\Documents\Image.BMP")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Sauvegarder une image dans un fichier au format BMP

`<Résultat> = <Champ Image>.SauveBMP(<Nom du fichier> [, <Nombre de couleurs>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'image a été sauvegardée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Champ Image> : (Nom de champ)`**

Nom du champ Image à manipuler.

**`<Nom du fichier> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier BMP à créer. Un chemin de type UNC peut être utilisé. L'extension du fichier n'est pas obligatoire.

**Attention** : 

- Pour que l'image soit sauvée, le répertoire de destination doit exister.

- L'existence du fichier BMP n'est pas vérifiée. Si ce fichier existe, il est automatiquement écrasé.




**`<Nombre de couleurs> : (Entier optionnel)`**

Nombre de couleurs de l'image sauvegardée :

- 0 (par défaut) : nombre de couleurs défini dans la résolution d'écran

- 16 : 16 couleurs


Ce paramètre correspond au nombre de couleurs proposées dans la palette de couleurs lors de l'utilisation du fichier BMP.

<a name="SYNTAXE2"></a>
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Syntaxe non disponible
### Sauvegarder une image en mémoire

`<Résultat> = <Champ Image>.SauveBMP(<enMémoire> [, <Nombre de couleurs>])`
---

**`<Résultat> : (Buffer)`**

Chaîne d'octets contenant l'image au format BMP. Cette chaîne d'octets peut être par la suite affectée à un champ Image, enregistrée dans un fichier (fonction [fSauveTexte](../WDLang1/3036046.md)), envoyée à travers un réseau (grâce aux [fonctions Socket](../WDLang3/3070007.md)), ...



**`<Champ Image> : (Nom de champ)`**

Nom du champ Image à manipuler.

**`<enMémoire> : (Constante)`**

*enMémoire* : Constante permettant de sauvegarder une image en mémoire.

**`<Nombre de couleurs> : (Entier optionnel)`**

Nombre de couleurs de l'image sauvegardée :

- 0 (par défaut) : nombre de couleurs défini dans la résolution d'écran.

- 16 : 16 couleurs.




Ce paramètre correspond au nombre de couleurs proposées dans la palette de couleurs lors de l'utilisation du fichier BMP.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Image présente dans un champ Web Caméra
<a name="image_presente_dans_champ_web_camera_ELTPARAGRAPHE000450"></a>Seule l'image affichée au moment de l'exécution de la fonction **&lt;Image&gt;.SauveBMP** est sauvegardée. Pour sauvegarder cette image, il est également possible d'utiliser :

- la fonction [&lt;Caméra&gt;.Capture](../WDLang1/1000022382.md) : l'image sera sauvegardée au format BMP

- la fonction [&lt;Image&gt;.SauveGIF](../WDLang1/1000024342.md) : l'image sera sauvegardée soit au format Gif, soit en mémoire

- la fonction [&lt;Image&gt;.SauveJPEG](../WDLang1/1000024344.md) : l'image sera sauvegardée soit au format Jpeg, soit en mémoire

- la fonction [&lt;Image&gt;.SauvePNG](../WDLang1/1000024345.md) : l'image sera sauvegardée soit au format PNG, soit en mémoire



<a name="NOTE0_2"></a>
<a name="NOTE0_3"></a>


<a name="XComposante"></a>

## Composante :
wd280pnt.dll
