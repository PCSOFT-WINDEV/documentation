
## ImageInfoModifie (Fonction)

***En anglais : ImageInfoModify***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie la valeur d'un marqueur Exif pour l'image manipulée.

Cette modification est effectuée uniquement en mémoire. Pour enregistrer cette modification, utilisez la fonction [ImageInfoSauve](../WDLang1/3091006.md) ou la fonction [dSauveImageJPEG](../WDLang1/3029038.md).

**Remarques** :

- Les informations Exif (EXchangeable Image File) sont incorporées dans le fichier image lui-même. Cette norme définit un ensemble de marqueurs qui permettent de stocker de nombreuses informations relatives à l'image : date, largeur, orientation, modèle de l'appareil photo, vitesse d'obturation, distance du sujet, temps d'exposition, ...

- Si le marqueur Exif spécifié n'existe pas pour l'image manipulée, ce marqueur est ajoutée à l'image.

- Certains marqueurs spécifiques (les "Offsets" par exemple) ne peuvent pas être modifiés. Dans ce cas, la modification est ignorée (&lt;Résultat&gt; = <u><u><u>Faux</u></u></u>).

- Pour manipuler les marqueurs Exif d'une image, il est également possible d'utiliser la propriété **Exif** des variables de type [Image](../WDLang1/1000019650.md). Cette propriété peut être utilisée pour les applications Android. 



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
CheminImg est une chaîne = "C:\Mes Images\MonImage.JPG" 
// Modification du copyright
// Ce marqueur existe. Le type actuel de ce marqueur sera utilisé  
ImageInfoModifie(CheminImg, imgCopyright, "PC Soft " + DateDuJour()) 
// Enregistrement de la modification
ImageInfoSauve(CheminImg)
// Fermeture du fichier image
ImageInfoFerme(CheminImg)
```


<a name="Exemple2"></a>



```wl
// Modification des commentaires de l'image JPEG
// affichée dans le champ Image "IMG_MonChampImage"
// Le marqueur "imgCommentaire" n'existe pas, il sera rajouté. 
// Le type "ExifChaîne" sera automatiquement déduit
// à partir de la chaîne contenant les commentaires
ImageInfoModifie(IMG_MonChampImage, imgCommentaire, "Belles gorgones") 
// Enregistrement de la modification
ImageInfoSauve(IMG_MonChampImage, "C:\Plongees\Gorgone1.JPG")
```


<a name="Exemple3"></a>



```wl
CheminImg est une chaîne = "C:\Mes Images\Chien1.JPG" 
// Modification de la focale
// Si ce marqueur n'existe pas, la valeur de la focale
// sera enregistrée sous forme de rationnel signé
// Si ce marqueur existe, le type actuel de ce
// marqueur sera utilisé
ImageInfoModifie(CheminImg, imgOuvertureF, 2.8, ExifRationnel) 
// Enregistrement de la modification
ImageInfoSauve(CheminImg)
// Fermeture du fichier image
ImageInfoFerme(CheminImg)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ImageInfoModifie(<Image> , <Marqueur> , <Nouvelle valeur> [, <Type du marqueur>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la modification a été effectuée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Image> : (Chaîne de caractères)`**

Image à manipuler. Cette image peut correspondre à :

- un fichier image (format JPEG) : spécifiez le nom et le chemin complet (ou relatif) du fichier. Un chemin de type UNC peut être utilisé. 
	Dans ce cas, il est nécessaire de fermer le fichier grâce à la fonction [ImageInfoFerme](../WDLang1/3091001.md).

- une image affichée dans un champ Image : spécifiez le nom du champ Image. Si cette image n'est pas au format JPEG, cette image sera automatiquement convertie à ce format lors de sa sauvegarde (fonction [ImageInfoSauve](../WDLang1/3091006.md) ou [dSauveImageJPEG](../WDLang1/3029038.md)).

- une image (format JPEG) contenue dans un mémo image : spécifiez ce mémo image.

- une image (format JPEG) contenue dans un chaîne binaire : spécifiez cette chaîne binaire.




**`<Marqueur> : (Constante ou entier)`**

Marqueur dont la valeur doit être modifiée. Ce marqueur peut correspondre :

- soit à un entier donné grâce à la fonction [ImageInfoListe](../WDLang1/3091002.md).

- soit à une constante du WLangage. Pour connaître la liste des constantes disponibles, consultez le paragraphe "Correspondance des marqueurs" ci-dessous.




**`<Nouvelle valeur> : (Type de la valeur du marqueur à modifier)`**

Nouvelle valeur du marqueur spécifié.

**`<Type du marqueur> : (Constante optionnelle de type entier)`**

Type dans lequel la valeur du marqueur sera enregistrée :


|   |   |
| --- | --- |
| *ExifBinaire* | Chaîne binaire |
| *ExifChaîne* | Chaîne de caractères ASCII |
| *ExifEntier4* | Entier signé sur 4 octets |
| *ExifEntierN1* | Entier non signé sur 1 octet |
| *ExifEntierN2* | Entier non signé sur 2 octets |
| *ExifEntierN4* | Entier non signé sur 4 octets |
| *ExifRationnel* | Rationnel signé |
| *ExifRationnelN* | Rationnel non signé |


Si le marqueur modifié existe déjà pour l'image manipulée, ce paramètre ne sera pas pris en compte et le type actuel du marqueur modifié sera utilisé.

Si le marqueur modifié n'existe pas pour l'image manipulée, nous vous conseillons de spécifier le type du marqueur. Par défaut, le type sera automatiquement déduit en fonction de la valeur &lt;Nouvelle valeur&gt;.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Correspondance des marqueurs
<a name="correspondance_des_marqueurs_ELTPARAGRAPHE000138"></a>Le tableau suivant présente la correspondance des marqueurs avec les constantes WLangage.

| Marqueur | Constante WLangage | Valeur |
| --- | --- | --- |
| 37510 | *imgCommentaire* | Chaîne de caractères <br>Commentaires sur l'image |
| 37122 | *imgCompression* | Réel <br>Compression en bits/pixels de l'image |
| 33432 | *imgCopyright* | Chaîne de caractères <br>Copyright de l'image |
| 306 | *imgDate* | Date<br>Date et heure de l'image, au format AAAA:MM:JJ HH:MM:SS |
| 270 | *imgDescription* | Chaîne de caractères <br>Description de l'image |
| 37382 | *imgDistanceSujet* | Réel <br>Distance du sujet en mètres |
| 37380 | *imgDistorsionExposition* | Réel <br>Distorsion d'exposition en APEX |
| 37385 | *imgFlash* | Entier <br>Etat du flash au moment de la prise de vue : <br><br>- 0 : Flash non déclenché. <br><br>- 1 : Flash déclenché. <br><br>- 5 : Flash déclenché et lumière de retour non détectée. <br><br>- 7 : Flash déclenché et lumière de retour détectée.<br><br><br> |
| 928 | *imgHauteur* | Entier <br>Hauteur de l'image en pixels |
| 672 | *imgLargeur* | Entier <br>Largeur de l'image en pixels |
| 305 | *imgLogicielEnregistrement* | Chaîne de caractères<br>Nom du logiciel (ou du micro-logiciel) qui a enregistré l'image. |
| 37386 | *imgLongueurFocale* | Réel <br>Longueur focale en millimètres. |
| 37379 | *imgLuminosité* | Réel <br>Luminosité de l'image en APEX. |
| 271 | *imgMarqueAppareil* | Chaîne de caractères <br>Marque de l'appareil photo ayant pris l'image. |
| 272 | *imgModèleAppareil* | Chaîne de caractères <br>Modèle de l'appareil photo ayant pris l'image. |
| 37383 | *imgModeMesure* | Entier <br>Mode de mesure : <br><br>- 0 : inconnue. <br><br>- 1 : moyenne. <br><br>- 2 : moyenne centrée. <br><br>- 3 : point. <br><br>- 4 : multipoint. <br><br>- 5 : motif. <br><br>- 6 : partiel. <br><br>- 7 à 254 : réservé. <br><br>- 255 : autre.<br><br><br> |
| 37500 | *imgNoteFabricant* | Chaîne de caractères<br>Notes du fabricant de l'appareil photo ayant pris l'image |
| 274 | *imgOrientation* | Entier <br>Orientation de l'image : <br><br>- 1 à 4 : paysage. <br><br>- 5 à 8 : portrait.<br><br><br> |
| 37378 | *imgOuverture* | Réel <br>Ouverture en APEX. |
| 33437 | *imgOuvertureF* | Réel <br>Focale |
| 37381 | *imgOuvertureMax* | Réel <br>Ouverture maximale en APEX |
| 34850 | *imgProgrammeExposition* | Entier<br>Mode d'exposition utilisé au moment de la prise de vue :<br><br>- 0 : indéfini.<br><br>- 1 : manuel.<br><br>- 2 : normal.<br><br>- 3 : priorité ouverture.<br><br>- 4 : priorité vitesse.<br><br>- 5 : créatif.<br><br>- 6 : action.<br><br>- 7 : portait de prés sans arrière-plan.<br><br>- 8 : paysage.<br><br>- 9 à 255 : autres.<br><br><br> |
| 282 | *imgRésolutionX* | Réel <br>Résolution horizontale de l'image |
| 283 | *imgRésolutionY* | Réel <br>Résolution verticale de l'image |
| 37384 | *imgSourceLumière* | Entier <br>Source de lumière de l'image : <br><br>- 0 : inconnue. <br><br>- 1 : lumière du jour. <br><br>- 2 : fluorescent. <br><br>- 3 : tungsten. <br><br>- 17 : lumière standard A. <br><br>- 18 : lumière standard B. <br><br>- 19 : lumière standard C. <br><br>- 20 : D55. <br><br>- 21 : D65. <br><br>- 22 : D75. <br><br>- 23 à 254 : réservé. <br><br>- 255 : autre.<br><br><br> |
| 33434 | *imgTempsExposition* | Réel <br>Temps d'exposition |
| 296 | *imgUnitéRésolution* | Entier <br>Unité de la résolution horizontale et verticale de l'image : <br><br>- 2 : pouces. <br><br>- 3 : centimètres.<br><br><br> |
| 36864 | *imgVersionEXIF* | Chaîne de caractères <br>Version des informations Exif |
| 65536 | *imgVignette* | Chaîne binaire <br>Vignette correspondant à l'image |
| 37377 | *imgVitesseObturation* | Réel <br>Vitesse d'obturation en APEX |


D'autres marqueurs non listés dans ce tableau sont également disponibles. Ces marqueurs correspondent à des marqueurs spécifiques à certains types d'appareils photo ou à des marqueurs personnalisés.


<a name="NOTE0_2"></a>




### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000442"></a>La fonction **ImageInfoModifie** ne retourne pas de code d'erreur. Pour savoir si cette fonction a généré une erreur, utilisez la variable [ErreurDétectée](../WDLang1/3087001.md). En cas d'erreur, il est possible de connaître le détail de l'erreur grâce à la fonction [ErreurInfo](../WDLang1/3013008.md).



<a name="XComposante"></a>

## Composante :
wd280img.dll
