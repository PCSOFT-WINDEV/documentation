


## TableAjouteColonne (Fonction)

***En anglais : TableAddColumn***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute des éléments à droite d'un champ Table horizontale.

**Attention** : Cette fonction ne permet pas d'ajouter des colonnes dans un champ Table standard (champ Table verticale). Pour ajouter dynamiquement des colonnes dans un champ Table standard, utilisez la fonction [ChampClone](../WDLang1/3025017.md).


<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = TableAjouteColonne(<Champ Table> [, <Élément ligne 1> [... [, <Élément ligne N>]]])`
---

**`<Résultat> : (Entier)`**



- Indice de la colonne ajoutée, 

- -1 en cas d'erreur.




**`<Champ Table> : (Nom de champ)`**

Nom du champ Table horizontale à manipuler.

Si ce paramètre correspond à une chaîne vide (""), le champ Table manipulé est le champ auquel le traitement en cours appartient.

**`<Élément ligne 1> : (Type de la ligne associée (optionnel))`**

Éléments de la colonne à ajouter dans le champ Table spécifié. Chaque élément correspond à une ligne. Le type de l'élément ajouté doit être compatible avec le type de la ligne concernée.
Si aucun de ces paramètres n'est spécifié, une colonne vide est ajoutée dans le champ Table. Pour un champ Table fichier, les valeurs par défaut définies dans le fichier de données lié sont prises en compte.



**`<Élément ligne N> : (Type de la colonne associée (optionnel))`**

Éléments de la colonne à ajouter dans le champ Table spécifié. Chaque élément correspond à une ligne. Le type de l'élément ajouté doit être compatible avec le type de la ligne concernée.
Si aucun de ces paramètres n'est spécifié, une colonne vide est ajoutée dans le champ Table. Pour un champ Table fichier, les valeurs par défaut définies dans le fichier de données lié sont prises en compte.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Caractéristiques des éléments de la colonne
<a name="caracteristiques_des_elements_colonne_ELTPARAGRAPHE000068"></a>

- Pour ne pas spécifier de valeur pour un élément, utilisez une chaîne vide ("") ou 0 (selon le type de la ligne).

- Si un élément correspond au résultat d'un calcul, mettez l'expression numérique entre parenthèses. Par exemple :
	
	```wl
	TableAjouteColonne(TABLE_TableCalcul, (53+29), (83-21))
	```




<a name="NOTE0_2"></a>


### Position de la colonne ajoutée
<a name="position_colonne_ajoutee_ELTPARAGRAPHE000085"></a>Par défaut, la colonne est ajoutée à la fin du champ Table.

- Si le champ Table est trié avec la fonction [TableTrie](../WDLang1/3074035.md), la colonne ajoutée est positionnée dans le champ en fonction du tri en cours.

- Si le champ Table est trié par l'utilisateur, le tri n'est pas pris en compte lors de l'ajout de la colonne. La colonne est ajoutée à la fin du champ.



<a name="NOTE0_3"></a>


### Limites : Nombre maximum de colonnes affichées
<a name="limites_nombre_maximum_colonnes_affichees_ELTPARAGRAPHE000100"></a>Le nombre maximum de colonnes pouvant être affichées dans un champ Table est limité uniquement par la mémoire vive disponible (maximum théorique : 2 milliards de colonnes).

Il est cependant déconseillé d'utiliser des champs Table avec un nombre de colonnes important pour des raisons de performance (temps nécessaire pour remplir le champ par exemple) et d'utilisabilité.
<a name="NOTE0_4"></a>


### Champ Table fichier : Modifications dans le fichier de données lié
<a name="champ_table_fichier_modifications_dans_fichier_donnees_lie_ELTPARAGRAPHE000111"></a>Si la saisie en cascade est activée, le fichier de données lié au champ Table fichier est automatiquement modifié lorsque l'utilisateur passe à la colonne suivante.

Si la saisie en cascade n'est pas activée, le fichier de données lié au champ Table fichier n'est pas modifié. Pour écrire le contenu de la colonne ajoutée dans le fichier de données lié, il est nécessaire d'utiliser la fonction [TableEnregistre](../WDLang1/3074008.md) après la fonction **TableAjouteColonne**.

**Rappel** : L'option "Saisie en cascade (Ajout)" peut être sélectionnée :

- Lors de la création d'un champ Table.

- Dans l'onglet "Détail" de la description du champ.



<a name="NOTE0_5"></a>


### Champ Table fichier : Ajout de plusieurs colonnes
<a name="champ_table_fichier_ajout_plusieurs_colonnes_ELTPARAGRAPHE000137"></a>A chaque appel de la fonction **TableAjouteColonne** dans un champ Table fichier, une colonne virtuelle est créée dans le champ. Les informations seront enregistrées dans le fichier de données uniquement lors de l'appel de la fonction [TableEnregistre](../WDLang1/3074008.md).

Si la fonction **TableAjouteColonne** est appelée successivement dans le même traitement sans être suivie de la fonction [TableEnregistre](../WDLang1/3074008.md), seul le PREMIER appel est effectif (les appels suivants sont ignorés). Une seule colonne est ajoutée dans le champ Table fichier.
<a name="NOTE0_6"></a>


### Ajout dans un champ Table fichier et Trigger
<a name="ajout_dans_champ_table_fichier_trigger_ELTPARAGRAPHE000160"></a>Il est possible de déclencher un trigger lors de l'ajout d'un enregistrement dans un champ Table fichier. Pour plus de détails, consultez la documentation de [HDécritTrigger](../WDLang4/3044074.md).
<a name="NOTE0_7"></a>


### Ajout d'une image
<a name="ajout_une_image_ELTPARAGRAPHE000172"></a>Pour ajouter une image dans un champ Table, spécifiez directement le nom et le chemin complet de l'image à ajouter.

Par exemple :

```wl
TableAjouteColonne(TABLE_MaTable, "C:\MesDocuments\MonImage.BMP")
```

**Remarque** : Pour afficher correctement l'image ajoutée, la ligne doit être de type Image.
<a name="NOTE0_8"></a>


### Champ Table en saisie
<a name="champ_table_saisie_ELTPARAGRAPHE000191"></a>Si la fonction **TableAjouteColonne** est appelée :

- ***Dans un événement du champ Table***, le curseur est automatiquement positionné sur la première ligne à saisir dans la colonne ajoutée.

- ***Dans un événement n'appartenant pas au champ Table (ou dans un traitement personnalisé)***, utilisez la fonction [DonneFocusEtRetourUtilisateur](../WDLang1/1410088107.md) pour reprendre la saisie dans le champ Table.




<a name="XComposante"></a>

## Composante :
wd280obj.dll
