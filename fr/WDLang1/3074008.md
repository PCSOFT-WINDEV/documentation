


## TableEnregistre (Fonction)

***En anglais : TableSave***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie ou ajoute l'enregistrement associé à la ligne en cours dans le champ Table fichier ou Table hiérarchique fichier. L'enregistrement est mis à jour : 

- dans le fichier de données lié au champ.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) dans la variable lié au champ. 





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Enregistrement des données de la ligne en cours 
// pour le champ Table "TABLE_Produit"
TableEnregistre(TABLE_Produit)
```



```wl
// Enregistrement des données de la ligne 5 
// avec modification d'une colonne par programmation
TABLE_Produit = 5
TABLE_Produit[5].COL_Lib = "nouvelle valeur"
TableEnregistre(TABLE_Produit)
```



```wl
// Evénement Sortie d'une ligne
SI TABLE_Client.Modifié = Faux ALORS
	RETOUR 
FIN
pclPresentationFiche est un PFicheClient dynamique
SI TABLE_Client.Nouveau ALORS
	pclPresentationFiche<-gclPresentation.Nouveau()
SINON
	pclPresentationFiche<-gclPresentation.Modifier()
FIN
TableEnregistre(TABLE_Client, pclPresentationFiche)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Enregistrer dans un fichier de données

`TableEnregistre(<Champ Table>)`
---

**`<Champ Table> : (Nom de champ)`**

Nom du champ Table ou Table hiérarchique fichier à manipuler. La ligne en cours de ce champ Table sera enregistrée.

Si ce paramètre correspond à une chaîne vide (""), le champ Table manipulé est celui auquel le traitement en cours appartient.


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
### Enregistrer dans un objet (syntaxe disponible notamment pour le MVP)

`TableEnregistre(<Champ Table> , <Nom de l'objet>)`
---

**`<Champ Table> : (Nom de champ)`**

Nom du champ Table sur variable à manipuler. 

Si ce paramètre correspond à une chaîne vide (""), le champ Table manipulé est celui auquel le traitement en cours appartient.

**`<Nom de l'objet> : (Chaîne de caractères)`**

Nom de l'objet à manipuler. Le contenu de la ligne en cours du champ Table sera enregistré dans les membres de l'objet associé.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000108"></a>La fonction **TableEnregistre** peut être utilisée indifféremment sur : 

- un champ Table fichier ou un champ Table hiérarchique fichier. 

- un champ monosélection ou multisélection. Dans le cas d'un champ multisélection, seul le dernier enregistrement sélectionné est modifié (l'enregistrement correspondant à la dernière ligne en cours).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) un champ Table sur variable (syntaxe 2). 



<a name="NOTE0_2"></a>


### Mise à jour du fichier de données lié au champ Table ou Table hiérarchique
<a name="mise_jour_fichier_donnees_lie_champ_table_table_hierarchique_ELTPARAGRAPHE000128"></a>La fonction **TableEnregistre** enregistre la ligne en cours du champ dans le fichier de données lié au champ. Les rubriques sont automatiquement affectées avec les valeurs des colonnes associées dans la ligne en cours.

Lors d'une modification, la fonction **TableEnregistre** remplace les anciennes valeurs par les nouvelles. Les rubriques ne figurant pas dans le champ ne sont pas modifiées.

**Attention** :

- La fonction **TableEnregistre** ne gère que le fichier de données associé au champ. Si certaines colonnes sont reliées à des rubriques d'autres fichiers de données, ces fichiers de données ne sont pas gérés automatiquement.

- Les colonnes "image" ne sont pas enregistrées par la fonction **TableEnregistre**. Pour modifier le contenu du mémo associé à l'image (cas rare), utilisez la fonction [HAttacheMémo](../WDLang4/3044173.md).

- Dans les colonnes de type Interrupteur, l'appel à la fonction **TableEnregistre** est implicite et non désactivable. La modification de la valeur de l'interrupteur sera donc dans tous les cas reportée dans le fichier de données.



<a name="NOTE0_3"></a>


### Saisie en cascade et mise à jour du fichier de données lié
<a name="saisie_cascade_mise_jour_fichier_donnees_lie_ELTPARAGRAPHE000163"></a>

- **Si la saisie en cascade est activée**, le fichier de données lié au champ Table ou Table hiérarchique est automatiquement modifié lorsque l'utilisateur passe à la ligne suivante (utilisation des fonctions [TableAjoute](../WDLang1/3074017.md), [TableAjouteLigne](../WDLang1/3074006.md), [TableInsère](../WDLang1/3074025.md), [TableInsèreLigne](../WDLang1/3074026.md), [TableModifie](../WDLang1/3074019.md) et [TableModifieLigne](../WDLang1/3074028.md)). La fonction **TableEnregistre** est inutile.

- **Si la saisie en cascade n'est pas activée**, le fichier de données lié au champ Table ou Table hiérarchique n'est pas modifié. Pour écrire la ligne ajoutée ou modifiée dans le fichier de données lié, il est nécessaire d'utiliser la fonction [TableEnregistre](../WDLang1/3074008.md) après la fonction d'ajout ou de modification.




Remarques :

- La propriété [Nouveau](../Proprietes/2510073.md) permet de savoir si la ligne en cours vient d'être créée par les fonctions [TableAjoute](../WDLang1/3074017.md), [TableAjouteLigne](../WDLang1/3074006.md), [TableInsère](../WDLang1/3074025.md) et [TableInsèreLigne](../WDLang1/3074026.md) (propriété Nouveau = Vrai).

- La propriété [Modifié](../Proprietes/2510080.md) permet de savoir si une ligne a été modifiée par saisie directe de l'utilisateur dans le champ (propriété Modifié = Vrai).


![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La saisie en cascade n'est pas disponible sur les champs Table fichier à accès direct. Cette option est disponible sur les champs Table fichier chargés en mémoire.
<a name="NOTE0_4"></a>


### Ré-affichage de la ligne enregistrée
<a name="reaffichage_ligne_enregistree_ELTPARAGRAPHE000224"></a>Après l'utilisation de la fonction **TableEnregistre**, la ligne enregistrée peut "disparaître". Cette "disparition" est due à la valeur de la clé de parcours de l'enregistrement ajouté ou modifié.

Pour éviter ce problème, ré-affichez le champ Table ou Table hiérarchique avec la fonction [TableAffiche](../WDLang1/3074003.md).
<a name="NOTE0_5"></a>


### Blocage du fichier de données et mise à jour
<a name="blocage_fichier_donnees_mise_jour_ELTPARAGRAPHE000241"></a>Si le fichier de données est bloqué dans le traitement en cours, la fonction **TableEnregistre** enregistre la ligne en cours et débloque le fichier de données.
<a name="NOTE0_6"></a>


### Doublons et intégrité référentielle
<a name="doublons_integrite_referentielle_ELTPARAGRAPHE000253"></a>

- Si la gestion des doublons est active (fonction [HGèreDoublon](../WDLang4/3044057.md)), testez la fonction [HErreurDoublon](../WDLang4/3044077.md) après l'exécution de la fonction **TableEnregistre** pour tester l'unicité de la clé.

- Si la gestion de l'intégrité référentielle est active (fonction [HGèreIntegrité](../WDLang4/3044058.md)), testez la fonction [HErreurIntegrité](../WDLang4/3044086.md) après l'exécution de la fonction **TableEnregistre** pour tester l'intégrité référentielle.



<a name="NOTE0_7"></a>


### Utilisez la fonction TableEnregistre pour économiser vos lignes de code
<a name="utilisez_fonction_docparampagetitleshort_pour_economiser_vos_lignes_code_ELTPARAGRAPHE000281"></a>La fonction **TableEnregistre** économise plusieurs lignes de code. Cette seule ligne remplace l'affectation des variables des rubriques une par une.

Par exemple, le code suivant :

```wl
Client.Nom = ColonneNom
Client.Prénom = ColonnePrénom
Client.Adresse = ColonneAdresse
Client.CP = ColonneCP
Client.Ville = ColonneVille
HAjoute(Client)
```
est remplacé par la ligne suivante :

```wl
TableEnregistre(TABLE_Client)
```


<a name="XComposante"></a>

## Composante :
wd280obj.dll
