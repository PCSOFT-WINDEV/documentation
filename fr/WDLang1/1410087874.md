


## &lt;Fenêtre&gt;.OuvrePopupPosition (Fonction)

***En anglais : &lt;Window&gt;.OpenPopupPosition***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ouvre une fenêtre de type popup en précisant sa position d'ouverture et attend sa fermeture.

Cette fonction doit être utilisée dans le code d'un champ (code de clic d'un bouton par exemple).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ouverture d'une fenêtre de sélection de couleur
MaCouleur est un entier 
MaCouleur = FEN_CouleurFenSélecteur.OuvrePopupPosition(popEnDessous + popAlignéADroite + ...
	popSelonChamp, BTN_CouleurAction, CouleurCourante)
// Si une couleur a été sélectionnée 
// (MaCouleur <= 0 si on annule la fenêtre)
SI MaCouleur > 0 ALORS
	// On conserve la nouvelle couleur sélectionnée
	CouleurCourante = MaCouleur
	// Changement de couleur du rectangle du champ Bouton
	BTN_Couleur.Libellé = gRectangle(0, 0, 72, 16, CouleurCourante, 0)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Fenêtre popup>.OuvrePopupPosition(<Mode d'ouverture> [, <Champ de référence>] [, <Paramètre 1> [... [, <Paramètre N>]]])`
---

**`<Résultat> : (Type correspondant à la valeur récupérée (optionnel))`**

Valeur renvoyée par la fenêtre popup lors de sa fermeture. Cette valeur est renvoyée :

- soit par le mot-clé [RENVOYER](../Motscles/1510007.md) présent dans le code de fermeture de la fenêtre,

- soit par la fonction [Ferme](../WDLang1/3038018.md),

- soit par la propriété [ValeurRenvoyée](../Proprietes/2510134.md) utilisée avant la fermeture de la fenêtre.




**`<Fenêtre popup> : (Nom de fenêtre)`**

Nom de la fenêtre à ouvrir.

**`<Mode d'ouverture> : (Combinaison de constantes)`**

Précise la position et le mode d'ouverture de la fenêtre popup. Ces constantes sont les suivantes :


|   |   |
| --- | --- |
| *popAlignéADroite* | Le bord droit de la fenêtre popup sera calé sur le bord droit du champ. La fenêtre popup s'étend sur la gauche.<br>(Correspond à la constante *poGauche* dans les versions précédentes). |
| *popAlignéAGauche* | Le bord gauche de la fenêtre popup sera calé sur le bord gauche du champ. La fenêtre popup s'étend sur la droite.<br>(Correspond à la constante *poDroite* dans les versions précédentes). |
| *popAuDessus* | La fenêtre popup s'ouvrira au dessus du champ appelant. <br>(Correspond à la constante *poHaut* dans les versions précédentes).<br><br> |
| *popCentréFenêtre* | La fenêtre popup est centrée par rapport à la fenêtre parente. |
|  *popCentréHorizontalement* | La fenêtre popup est centrée horizontalement avec le champ appelant. |
| *popDéfaut* <br>(Valeur par défaut) | Par défaut, la combinaison de constantes *popAlignéAGauche* + *popEnDessous* est utilisée. |
| *popDésactiveRepostionnementAuto* | Débranche le repositionnement automatique si la fenêtre popup risque de ne pas être complètement visible à l'écran. <br>(Correspond à la constante *poPositionFixe* dans les versions précédentes).<br><br> |
| *popEnDessous* | La fenêtre popup s'ouvrira au dessous du champ appelant. <br>(Correspond à la constante *poBas* dans les versions précédentes). |
| *popSelonChamp* | Ouvre la fenêtre popup en fonction de la position d'un champ différent du champ appelant. Dans ce cas:<br><br>- il faut préciser le nom du champ (paramètre &lt;Nom du champ&gt;).<br><br>- le nom du champ sera automatiquement récupéré par le mot-clé [MonChampPopup](../Motscles/1511005.md).<br><br><br>(Correspond à la constante *poSelonChamp* dans les versions précédentes). |



**`<Champ de référence> : (Nom de champ optionnel)`**

Nom du champ sous lequel la fenêtre popup doit s'ouvrir. Ce paramètre doit être précisé uniquement si la constante *poSelonChamp*a été utilisée.

**`<Paramètre 1> : (Type de la valeur envoyée à la fenêtre (optionnel))`**

Premier paramètre à passer à l'événement "Déclarations globales" de la fenêtre à ouvrir. Ces paramètres sont passés par référence et sont considérés comme des variables globales à la fenêtre.



**`<Paramètre N> : (Type de la valeur envoyée à la fenêtre (optionnel))`**

Nième paramètre à passer à l'événement "Déclarations globales" de la fenêtre à ouvrir. Ces paramètres sont passés par référence et sont considérés comme des variables globales à la fenêtre.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Caractéristiques de la fenêtre popup
<a name="caracteristiques_fenetre_popup_ELTPARAGRAPHE000271"></a>

- La fenêtre se ferme automatiquement si elle perd le focus ou lors de l'appel à la fonction [Ferme](../WDLang1/3038018.md). La valeur courante est renvoyée au champ qui a ouvert la fenêtre popup grâce à une des méthodes suivantes :

	- soit par le mot-clé [RENVOYER](../Motscles/1510007.md) présent dans le code de fermeture de la fenêtre,

	- soit par la fonction [Ferme](../WDLang1/3038018.md),

	- soit par la propriété [ValeurRenvoyée](../Proprietes/2510134.md) utilisée avant la fermeture de la fenêtre.




- La fenêtre ouverte par la fonction **&lt;Fenêtre&gt;.OuvrePopupPosition** adopte le style des fenêtres popup. Si une barre de titre a été définie sous l'éditeur, cette barre de titre est réduite et la fenêtre ne peut être maximisée ou réduite.

- La fenêtre popup s'ouvre par défaut sous le champ qui exécute la fonction **&lt;Fenêtre&gt;.OuvrePopupPosition**. Si il n'y a pas assez de place pour ouvrir la fenêtre, la fenêtre s'ouvrira soit au-dessus du champ, soit au-dessous du champ vers la gauche.



<a name="NOTE0_2"></a>


### Paramètres passés à la fenêtre à ouvrir
<a name="parametres_passes_fenetre_ouvrir_ELTPARAGRAPHE000305"></a>Les paramètres sont récupérés dans l'événement "Déclarations globales" de la fenêtre. Il suffit d'indiquer en début de code la ligne suivante :

```txt
PROCEDURE <Nom de la fenêtre> (<Paramètre1> [, <Paramètre2> [, ...]])
```


Pour plus de détails, consultez [Fenêtre paramétrée](../WDChamp/1010026.md).


<a name="NOTE0_3"></a>


### Quel mode d'ouverture choisir ? 
<a name="quel_mode_ouverture_choisir_ELTPARAGRAPHE000330"></a>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ouvrepopupPosition.gif)
**Remarques** :

- si vous utilisez uniquement la constante *poBas*, la fenêtre popup sera ouverte à la position *poDroite* + *poBas*.

- si vous utilisez uniquement la constante *poHaut*, la fenêtre popup sera ouverte à la position *poDroite* + *poHaut*.



<a name="NOTE0_4"></a>


### Limites
<a name="limites_ELTPARAGRAPHE000344"></a>

- La fonction **&lt;Fenêtre&gt;.OuvrePopupPosition** doit être exécutée à partir d'un code de champ.

- Le champ à partir duquel la fonction **&lt;Fenêtre&gt;.OuvrePopupPosition** est exécutée doit être visible.

- Il n'est pas possible d'ouvrir à partir d'une fenêtre popup une  fenêtre qui n'est pas modale. Il est nécessaire d'utiliser la fonction [&lt;Fenêtre&gt;.Ouvre](../WDLang1/1000023903.md) pour ouvrir une fenêtre. L'ouverture d'une fenêtre modale depuis une fenêtre popup ne ferme pas automatiquement la fenêtre popup. Dans ce cas, il faut traiter la valeur de retour de la fonction [&lt;Fenêtre&gt;.Ouvre](../WDLang1/1000023903.md) et utiliser la fonction [Ferme](../WDLang1/3038018.md) pour fermer la fenêtre popup.

- Il n'est pas possible d'ouvrir une fenêtre popup depuis une fenêtre popup.




<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
