


## &lt;Arbre&gt;.Insère (Fonction)

***En anglais : &lt;TreeView&gt;.Insert***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Insère une feuille à une position spécifique dans un champ Arbre. Cette insertion est effectuée par rapport à un élément "frère" existant.

Exemple de champ Arbre : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Arbre_Vocabulaire.gif)

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Insertion de la feuille "Gâteaux" au même niveau que
// la feuille "Glaces" dans le champ Arbre "ARBRE_RecetteTV"
// La feuille "Gâteaux" sera insérée avant la feuille "Glaces"
Res = ARBRE_RecetteTV.Insère("Recettes" + TAB + "Desserts" + TAB + "Glaces", ...
	"Gâteaux", aDéfaut, aDéfaut, Null, aAvant)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Champ Arbre>.Insère(<Chemin du noeud frère> , <Nom de la feuille> [, <Image enroulée> [, <Image déroulée> [, <Identifiant de la feuille> [, <Mode d'ajout> [, <Texte de la bulle d'aide>]]]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la feuille a été insérée dans le champ Arbre, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Champ Arbre> : (Nom de champ)`**

Nom du champ Arbre à manipuler.

**`<Chemin du noeud frère> : (Chaîne de caractères)`**

Chemin complet du noeud "frère" de la feuille à insérer dans le champ Arbre. Ce noeud frère doit exister. Ce paramètre est de la forme :

```txt
"<Nom de la racine>" + TAB + ["<Nom du 1er noeud>" + TAB + ...
["<Nom du 2ème noeud>" + TAB + [...]]]"<Nom de la feuille>"
```
En cas de doublons sur un élément du chemin, ce chemin peut contenir l'identifiant de l'élément (indiqué à la suite du nom grâce à la fonction [ArbreID](../WDLang1/3018027.md)).

**`<Nom de la feuille> : (Chaîne de caractères)`**

Nom (libellé) de la feuille à insérer.

**`<Image enroulée> : (Chaîne de caractères ou constante optionnelle)`**

Image associée à l'élément inséré. Cette image est affichée lorsque l'élément est un noeud enroulé (voir Notes). En exécution, le libellé d'un noeud enroulé est précédé du signe "+". 
Ce paramètre correspond :

- soit au nom et au chemin complet (ou relatif) de l'image. Un chemin de type UNC peut être utilisé.

- soit à la constante :
	


|   |   |
| --- | --- |
| *aDéfaut*<br>(Valeur par défaut) | Image par défaut (dossier fermé) :![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ImageEnroule.GIF)<br> |
| *Null* | Aucune image |






**`<Image déroulée> : (Chaîne de caractères ou constante optionnelle)`**

Image associée à l'élément inséré. Cette image est affichée lorsque l'élément est un noeud déroulé (voir Notes). En exécution, le libellé d'un noeud déroulé est précédé du signe "-". 
Ce paramètre correspond :

- soit au nom et au chemin complet (ou relatif) de l'image. Un chemin de type UNC peut être utilisé.

- soit à la constante :
	


|   |   |
| --- | --- |
| *aDéfaut*<br>(Valeur par défaut) | Image par défaut (dossier ouvert) :![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ImageDeroulee.GIF)<br> |
| *Null* | Aucune image |






**`<Identifiant de la feuille> : (Chaîne de caractères ou entier (optionnel))`**

Chaîne de caractères ou entier associé à l'élément inséré. Par défaut, ce paramètre correspond à une chaîne vide (""). Pour associer un identifiant à un élément déjà créé, utilisez la fonction [&lt;Arbre&gt;.Modifie](../WDLang1/1000023763.md).

**`<Mode d'ajout> : (Constante optionnelle)`**

Position de la feuille insérée par rapport au noeud "frère" dans le champ Arbre.


|   |   |
| --- | --- |
| *aAprès*<br>(Valeur par défaut) | La feuille insérée est placée après l'élément "frère" spécifié. |
| *aAvant* | La feuille insérée est placée avant l'élément "frère" spécifié. |



**`<Texte de la bulle d'aide> : (Chaîne de caractères optionnelle)`**

Si ce paramètre est précisé, son contenu sera affiché lors du survol de l'élément dans une bulle d'aide. Par défaut, ce paramètre correspond à une chaîne vide. Si aucune bulle d'aide n'est associée à l'élément, la bulle d'aide associée au champ Arbre sera automatiquement affichée.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Noeud "frère"
<a name="noeud_frere_ELTPARAGRAPHE000275"></a>Si le noeud "frère" n'existe pas, l'insertion n'est pas effectuée : la fonction **&lt;Arbre&gt;.Insère** renvoie <u><u><u><u>Faux</u></u></u></u>.
<a name="NOTE0_2"></a>


### Doublons
<a name="doublons_ELTPARAGRAPHE000292"></a>La fonction **&lt;Arbre&gt;.Insère** ne permet pas le contrôle de doublons lors de l'insertion d'un élément.

Pour gérer simplement les doublons, il est conseillé de gérer un identifiant spécifique pour identifier le niveau où l'insertion doit être effectuée. Pour plus de détails, consultez [Gestion des doublons dans les champs Arbre](../WDChamp/1013325.md).
<a name="NOTE0_3"></a>


### Format des images enroulées/déroulées
<a name="format_des_images_enrouleesderoulees_ELTPARAGRAPHE000310"></a>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Les formats d'images supportés sous Windows sont :

- Bitmap (\*.BMP)

- Graphics Interchange Format (\*.gif)

- Joint Picture Experts Group (\*.jpg ; \*.jpeg)

- Kodak Photo CD (\*.pcd)

- PaintBrush (\*.pcx)

- Adobe Photoshop Format (\*.psd)

- TrueVision TARGA (\*.tga)

- Tagged Image File Format (\*.tif ; \*.tiff)
	Remarque : l'option "tiff mosaïque" de la norme tiff 6.0 n'est pas supportée. Dans ce cas, il est conseillé d'enregistrer l'image à la norme tiff 5.0. 

- Portable Network Graphics (\*.png)

- Windows MetaFiles (\*.emf ; \*.wmf)

- Icônes (\*.ico ; \*.icw)
	Remarques : 

	- Affichage HQ (Haute Qualité) disponible.

	- Gestion des planches au format BMP transparent (32 bits).




- Curseurs (\*.cur)

- Portable Document Format (\*.pdf)

- Scalable Vector Graphics (\*.svg)

- Images WINDEV (générées par l'éditeur d'images, \*.WDPIC).





### Type des images enroulées/déroulées
<a name="type_des_images_enrouleesderoulees_ELTPARAGRAPHE000356"></a>Les images utilisées peuvent être :

- des fichiers image,

- des rubriques d'un fichier de données HFSQL de type "Mémo Binaire" contenant une image.

- des dessins réalisés à l'aide des [fonctions de manipulation de chaînes graphiques](../WDLang1/3029028.md).




L'image spécifiée est réduite proportionnellement à la taille 16 x 16 pixels : dans la majorité des cas, la hauteur de l'image correspond à la hauteur de la ligne du champ Arbre.



**Remarque** : Il est conseillé d'utiliser des images 16 x 16 pixels (taille des petites icônes).

<a name="XComposante"></a>

## Composante :
wd280obj.dll
