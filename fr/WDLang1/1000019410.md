
## fChargeBuffer (Fonction)

***En anglais : fLoadBuffer***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Charge le contenu d'un fichier externe (texte, image, ...) dans une variable de type buffer.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
MonBuffer est un Buffer 
MonBuffer = fChargeBuffer("c:\tmp\MonFichier.raw")
```


<a name="Exemple2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Lecture des 50 premiers octets (au maximum) du fichier à partir du début
MonBuffer est un Buffer 
MonBuffer = fChargeBuffer("C:\Dir\Fic.test", 0, 50)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = fChargeBuffer(<Fichier externe> [, <Position> [, <Taille>]])`
---

**`<Résultat> : (Buffer)`**

Contenu du fichier texte.

**`<Fichier externe> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier externe (texte, image, ...). Il est possible d'utiliser un chemin UNC. Ce fichier n'est pas forcément un fichier au format TXT : en effet, les 0 binaires sont autorisés.



**`<Position> : (Entier optionnel)`**

Position  à partir de laquelle le fichier texte doit être chargé. Cette position est exprimée en octets (ou en nombre de caractères).

Par défaut, ce paramètre correspond à 0 (début du fichier). 

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre n'est pas disponible. 

**`<Taille> : (Entier optionnel)`**

Taille maximale du fichier à charger. Cette taille est exprimée en octets (ou en nombre de caractères). 

Par défaut, cette taille correspond à la taille totale du fichier. 

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre n'est pas disponible. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Fonctionnement sous Windows Vista (et supérieur)
<a name="fonctionnement_sous_windows_vista_superieur_ELTPARAGRAPHE000234"></a>Si cette fonction ne fonctionne pas correctement sous Windows Vista (et supérieur), il est nécessaire de vérifier si le fichier ou le répertoire manipulé ne se trouve pas dans un des répertoires système (répertoire de Windows ou répertoire "Program Files").

**En effet, sous Windows Vista (et supérieur), avec le [mécanisme de l'UAC](../Editeurs/2025014.md) (contrôle des comptes utilisateurs) activé**, il est nécessaire d'avoir les privilèges administrateur pour manipuler / modifier des fichiers ou des répertoires présents dans les répertoires système (répertoire de Windows ou répertoire "Program Files").

**Conseil de programmation** : Si vous devez manipuler / modifier des fichiers ou des répertoires, sans avoir besoin de privilèges administrateur, il est conseillé :

- de ne pas écrire dans le répertoire de Windows ou dans le répertoire "Program Files",

- d'utiliser le répertoire système correspondant à l'application (connu par la fonction [SysRep](../WDLang1/3073026.md) par exemple avec la constante *srAppDataCommun*).








<a name="XComposante"></a>

## Composante :
wd280std.dll
