


## &lt;Saisie&gt;.AjouteJeton (Fonction)

***En anglais : &lt;Edit&gt;.AddToken***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute un jeton dans un champ de saisie de type "Jetons de texte".
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Clic sur [Tous les destinataires]
SAI_Destinataire.SupprimeToutJeton()
POUR TOUT mail DE tabMail
	SAI_Destinataire.AjouteJeton(mail.Nom, mail.Adresse)
FIN
```

```wl
// Syntaxe avec le type Jeton
SAI_Destinataire.SupprimeToutJeton()
POUR TOUT mail DE tabMail
	MonJeton est un Jeton
	MonJeton.Libellé = mail.Adresse
	MonJeton.Valeur = mail.Nom
	SAI_Destinataire.AjouteJeton(MonJeton)
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Ajouter un jeton directement

`<Résultat> = <Champ de saisie>.AjouteJeton(<Valeur> [, <Libellé>])`
---

**`<Résultat> : (Entier)`**



- Indice du jeton ajouté, 

- 0 en cas d'erreur :

	- Si le champ de saisie n'est pas un champ de type "Jetons de texte" (propriété [JetonActif](../Proprietes/1000023782.md) vaut <u><u><u><u>Faux</u></u></u></u>). 

	- Si un doublon a été détecté et si la propriété [JetonAutoriseDoublon](../Proprietes/1000023784.md) vaut <u><u><u><u>Faux</u></u></u></u>.







**`<Champ de saisie> : (Nom de champ)`**

Nom du champ de saisie de type "Jetons de texte".

**`<Valeur> : (Chaîne de caractères)`**

Valeur du jeton.

**`<Libellé> : (Chaîne de caractères optionnelle)`**

Libellé du jeton. Si cette valeur n'est pas précisée, elle correspondra à la valeur du jeton.


<a name="SYNTAXE2"></a>

### Ajouter un jeton via le type Jeton

`<Résultat> = <Champ de saisie>.AjouteJeton(<Jeton>)`
---

**`<Résultat> : (Entier)`**



- Indice du jeton ajouté, 

- 0 en cas d'erreur :

	- Si le champ de saisie n'est pas un champ de type "Jetons de texte" (propriété [JetonActif](../Proprietes/1000023782.md) vaut <u><u><u><u>Faux</u></u></u></u>). 

	- Si un doublon a été détecté et si la propriété [JetonAutoriseDoublon](../Proprietes/1000023784.md) vaut <u><u><u><u>Faux</u></u></u></u>.







**`<Champ de saisie> : (Nom de champ)`**

Nom du champ de saisie de type "Jetons de texte".

**`<Jeton> : (Variable de type Jeton)`**

Nom de la variable WLangage de type [Jeton](../WDLang1/1000023942.md) décrivant le jeton à ajouter.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Le jeton est ajouté à la position du curseur de saisie. Si le curseur de saisie est situé entre des jetons, le jeton est inséré entre les jetons. 

- Pour ajouter un jeton à la fin de tous les jetons, utilisez la fonction [&lt;Saisie&gt;.InsèreJeton](../WDLang1/1000024044.md). 

- La propriété [ValeurMémorisée](../Proprietes/2510127.md) du champ de saisie renvoie les valeurs mémorisées des jetons du champ séparées par le caractère &lt;RC&gt; (Retour Chariot).




- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampJeton.gif) ***Exemples unitaires (WINDEV)*** : **Le champ Jeton** <br>Utilisation d'un champ de saisie "Jetons de texte".
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampJeton.gif) ***Exemples unitaires (WEBDEV)*** : **Le champ Jeton** <br>Utilisation d'un champ de saisie "Jetons de texte".
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampJeton.gif) ***Exemples unitaires (WINDEV Mobile)*** : **Le champ Jeton** <br>Utilisation d'un champ de saisie "Jetons de texte".


<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
