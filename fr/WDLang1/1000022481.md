
## FAASécuritéExport (Fonction)

***En anglais : AAFExportSecurity***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Sécurise l'export de données confidentielles dans les FAA (Fonctionnalités Automatiques de vos Applications) qui permettent l'export, l'impression ou l'enregistrement de données. Il est possible : 

- soit d'interdire l'export. Dans ce cas, l'option de la FAA correspondante n'est pas proposée. 

- soit de demander un mot de passe. Dans ce cas : 

	- un cadenas est affiché dans l'option de menu de la FAA. 
			Remarque : Pour les versions inférieures à Windows 8, le symbole affiché est une étoile ('\*'). 

	- une fenêtre demandant un mot de passe est affichée avant de réaliser l'action. Si le mot de passe est invalide, l'action n'est pas effectuée.






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Autorise les exports
FAASécuritéExport(faaExportLibre)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Sécuriser l'export via les FAA pour toute l'application

`FAASécuritéExport(<Niveau de sécurité> [, <Mot de passe> [, <Message>]])`
---

**`<Niveau de sécurité> : (Constante de type Entier)`**

Niveau de sécurité à utiliser pour toutes les exportations possibles depuis les FAA :


|   |   |
| --- | --- |
| *faaExportInterdit* | Les exports depuis les FAA d'export sont interdits. |
| *faaExportLibre* | Les exports depuis les FAA d'export sont autorisés. |
| *faaExportMdp* | Les exports depuis les FAA d'export nécessitent un mot de passe. <br>Un cadenas (ou une étoile '\*') est affiché dans l'option de menu de la FAA pour signaler à l'utilisateur la sécurisation de l'option. <br><br>Les paramètres &lt;Mot de passe&gt; et &lt;Message&gt; peuvent être spécifiés. |
| *faaExportMdpCopieEcranLibre* | <br><br>- Les exports depuis les FAA d'export nécessitent un mot de passe. <br>	Un cadenas (ou une étoile '\*') est affiché dans l'option de menu de la FAA pour signaler à l'utilisateur la sécurisation de l'option. <br><br>- La copie d'écrans via par la touche [IMPR ECRAN] ou par programmation ne nécessite pas de mot de passe. <br><br><br><br><br>Les paramètres &lt;Mot de passe&gt; et &lt;Message&gt; peuvent être spécifiés. |



**`<Mot de passe> : (Chaîne de caractères optionnelle)`**

Mot de passe qui devra être saisi par l'utilisateur pour pouvoir exporter les données. Ce mot de passe doit être saisi dans une fenêtre automatiquement proposée par WINDEV. 
Si ce paramètre correspond à une chaîne vide ("") ou n'est pas précisé, la sécurité est désactivée. 

**`<Message> : (Chaîne de caractères optionnelle)`**

Message affiché dans la fenêtre de demande du mot de passe. 
Si ce paramètre correspond à une chaîne vide ("") ou n'est pas précisé, un message par défaut est affiché (en français si l'application est exécutée en français, en anglais dans les autres cas).


<a name="SYNTAXE2"></a>

### Sécuriser l'export via les FAA pour un champ ou une fenêtre

`FAASécuritéExport(<Champ ou fenêtre> , <Niveau de sécurité> [, <Mot de passe> [, <Message>]])`
---

**`<Champ ou fenêtre> : (Chaîne de caractères)`**

Nom du champ ou de la fenêtre à manipuler. Si ce champ ou cette fenêtre n'existe pas, une erreur WLangage est générée.

**`<Niveau de sécurité> : (Constante de type Entier)`**

Niveau de sécurité à utiliser pour toutes les exportations possibles depuis les FAA :


|   |   |
| --- | --- |
| *faaExportInterdit* | Les exports depuis les FAA d'export sont interdits. Les options correspondantes dans le menu contextuel ne sont pas affichées. |
| *faaExportLibre* | Les exports depuis les FAA d'export sont autorisés. |
| *faaExportMdp* | Les exports depuis les FAA d'export nécessitent un mot de passe. Un cadenas (ou une étoile '\*') est affiché dans l'option de menu de la FAA pour signaler à l'utilisateur la sécurisation de l'option. <br><br>Les paramètres &lt;Mot de passe&gt; et &lt;Message&gt; peuvent être spécifiés. |
| *faaExportMdpCopieEcranLibre* | <br><br>- Les exports depuis les FAA d'export nécessitent un mot de passe. <br>	Un cadenas (ou une étoile '\*') est affiché dans l'option de menu de la FAA pour signaler à l'utilisateur la sécurisation de l'option. <br><br>- La copie d'écrans via par la touche "Impr écran" ou par programmation ne nécessite pas de mot de passe. <br><br><br><br><br>Les paramètres &lt;Mot de passe&gt; et &lt;Message&gt; peuvent être spécifiés.  |



**`<Mot de passe> : (Chaîne de caractères optionnelle)`**

Mot de passe qui devra être saisi par l'utilisateur pour pouvoir exporter les données. Ce mot de passe doit être saisi dans une fenêtre automatiquement proposée par WINDEV. 
Si ce mot de passe correspond à une chaîne vide ("") ou n'est pas précisé, la sécurité est désactivée. 

**`<Message> : (Chaîne de caractères optionnelle)`**

Message affiché dans la fenêtre de demande du mot de passe. Si ce message n'est pas indiqué, un message par défaut est affiché (en français si l'application est exécutée en français, en anglais dans les autres cas). 







<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Types d'export pris en compte
<a name="types_export_pris_compte_ELTPARAGRAPHE000118"></a>Cette fonction s'applique : 

- sur les exports (vers Word, Excel, XML, ...) disponibles dans le menu contextuel des FAA des champs Table, Table hiérarchique et Zones répétée. 

- sur l'option "Imprimer" disponible dans le menu contextuel des FAA des champs Table, Table hiérarchique, Agenda, Planning, Diagramme de Gantt, .... 
	Attention : si un bouton de type "Etat sur table" est créé, seule l'option du menu contextuel est sécurisée. 

- sur l'option "Enregistrer sous" du menu contextuel d'un champ Image, Organigramme, Tableur, Tableau de bord, ...

- sur l'option "Copier" si plus d'une ligne ou plus de 100 caractères sont sélectionnés.

- sur l'option "Tout copier" ou "Copier le contenu" du menu contextuel des champs Table, Table hiérarchique, Agenda, Planning, Diagramme de Gantt, ... 

- sur les images écran réalisées (sauf si la constante *faaExportMdpCopieEcranLibre* est utilisée) : 

	- par la touche Impr écran.

	- par programmation (par exemple fonction [dCopieImageFenêtre](../WDLang1/1000019912.md)).


 Si une option de sécurité est définie (mot de passe ou interdiction), l'image écran sera noire. 







### Sécurités multiples
<a name="securites_multiples_ELTPARAGRAPHE000140"></a>Si plusieurs sécurités sont appliquées à un élément, les sécurités sont prises en compte selon l'ordre suivant : 

1. Sécurité définie sur le champ.  

2. Sécurité définie sur la fenêtre.

3. Sécurité définie sur l'application.




La sécurité définie sur le champ est prioritaire. Ainsi, si l'export est interdit sur l'application mais autorisé sur un champ, l'utilisateur pourra exporter les données du champ. 




### Gestion du mot de passe
<a name="gestion_mot_passe_ELTPARAGRAPHE000152"></a>



Si un mot de passe est demandé : 

- l'option de menu affiche une indication pour spécifier à l'utilisateur qu'une action spécifique est nécessaire : 

	- un cadenas sous Windows 8 et supérieur. 

	- le signe '\*' sous Windows 7 et inférieur. 




- la saisie du mot de passe est effectuée dans une fenêtre spécifique. Cette fenêtre : 

	- utilise le thème de gabarit de l'application si l'option "Appliquer le thème de gabarit sur les composants intégrés dans le projet et sur les fenêtres des FAA" est cochée (onglet "Style" de la fenêtre de description du projet). 

	- affiche par défaut le message suivant en français : "Ces données sont confidentielles. Veuillez saisir un mot de passe pour continuer". Ce message peut être modifié via le paramètre &lt;Message&gt;. Pour les applications multilingues, si aucun message personnalisé multilingue n'a été défini, le message par défaut s'affiche en anglais. 

	- a pour titre le titre de la fenêtre en cours. 

	- contient un champ de saisie de type mot de passe pour saisir le mot de passe. Si le mot de passe saisi ne correspond pas à celui attendu, l'export n'est pas réalisé. 










### Cas particulier : champ ActiveX
<a name="cas_particulier_champ_activex_ELTPARAGRAPHE000174"></a>L'interdiction de copier l'écran peut limiter les possibilités d'affichage de certains ActiveX. Dans ce cas, si l'ActiveX dans sa version la plus récente ne parvient pas à s'afficher, il faut autoriser la copie d'écran dans la fenêtre concernée avec la constante *faaExportMdpCopieEcranLibre*.





<a name="XComposante"></a>

## Composante :
wd280obj.dll
