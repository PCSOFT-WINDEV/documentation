


## &lt;Arbre&gt;.Affiche (Fonction)

***En anglais : &lt;TreeView&gt;.Display***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Rafraîchit l'affichage d'un champ Arbre à partir d'une position donnée. 

**Remarque** : La fonction **&lt;Arbre&gt;.Affiche** peut être utilisée indifféremment sur :

- un champ Arbre fichier. Dans ce cas, les modifications effectuées sur le fichier de données lié sont répercutées dans le champ Arbre.

- un champ Arbre par programmation. 

- un champ Arbre monosélection ou multisélections.



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ajout d'un élément dans un fichier de données HFSQL
HAjoute(FIC_Elément)
// Réinitialisation du champ Arbre
ARBRE_MonArbre.Affiche()
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Champ Arbre>.Affiche([<Position>])`
---

**`<Champ Arbre> : (Nom de champ)`**

Nom du champ Arbre à rafraîchir.

**`<Position> : (Entier, caractère ou constante (optionnel))`**

Indique la position de départ du rafraîchissement. Si ce paramètre n'est pas spécifié :

- ***Dans le cas d'un champ Arbre fichier***, la fonction se comporte comme si la constante *taInit* avait été passée en paramètre.

- ***Dans le cas d'un champ Arbre par programmation***, aucun effet.




Ce paramètre peut correspondre à :

- Un entier. Le rafraîchissement est effectué à partir de cette position. La ligne sélectionnée n'est pas modifiée.
	***Dans le cas d'un champ Arbre fichier***, l'événement "Affichage d'une ligne" pour la ligne &lt;Position&gt; est exécuté. L'élément en cours dans le champ Arbre est le même que l'enregistrement en cours dans le fichier de données.
	***Dans le cas d'un champ Arbre par programmation***, la ligne &lt;Position&gt; est ré-affichée.

- Un caractère ou une constante : 
	

|   | Champ Arbre fichier chargé en mémoire | Champ Arbre par programmation |
| --- | --- | --- |
| *taCourantBandeau* | <br><br>	- Ré-affiche le champ Arbre.<br><br>	- La ligne sélectionnée est inchangée.<br><br><br> | <br><br>	- Ré-affiche le champ Arbre.<br><br>	- La ligne sélectionnée est inchangée.<br><br><br> |
| *taCourantEnreg* | <br><br>	- Ré-exécute la requête liée si nécessaire.<br><br>	- Prend en compte des enregistrements ajoutés, modifiés, supprimés par d'autres postes.<br><br>	- Sélectionne l'enregistrement courant.<br><br>	- La position de l'ascenseur est conservée tant que la sélection reste visible.<br><br>	- Exécute les événements "Initialisation" et "Fin d'initialisation" du champ, puis l'événement "Sélection d'une ligne" pour la ligne sélectionnée (même si elle n'est pas modifiée).<br><br><br> | Aucun effet. |
| *taDébut* | <br><br>	- Rafraîchit le champ Arbre en se positionnant au début du champ.<br><br>	- La première ligne est sélectionnée. Cette ligne correspond au premier enregistrement.<br><br><br> | Aucun effet. |
| *taInit* | <br><br>	- Exécute les codes d'initialisation du champ Arbre (code d'initialisation et de fin d'initialisation).<br><br>	- Remplit le champ Arbre.<br><br>	- La première ligne du champ Arbre est sélectionnée. Cette ligne correspond à l'enregistrement en cours lors de la fin du code d'initialisation du champ Arbre.<br><br><br> | Aucun effet. |
| *taRéExécuteRequête* | <br><br>	- Ré-exécute la requête liée au champ Arbre.<br><br>	- Rafraîchit le champ Arbre en se positionnant au début du champ.<br><br>	- La première ligne du champ Arbre est sélectionnée. Cette ligne correspond au premier enregistrement.<br><br><br>**Attention** : Seule la requête liée au champ Arbre est exécutée. Si des options spécifiques ont été précisées avec la fonction [&lt;Source&gt;.ExécuteRequête](../WDLang4/1000024944.md) (par exemple *hModifieFichier*), ces options ne sont pas prises en compte. | Aucun effet. |








<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
