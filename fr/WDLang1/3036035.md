
## fRepDéplace (Fonction)

***En anglais : fMoveDir***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Déplace le contenu d'un répertoire dans un autre répertoire.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003036035&name=frepdeplace_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Déplacement du contenu d'un répertoire 
// Le contenu du répertoire "C:\Répertoires\MesFichiers" est déplacé 
// dans le répertoire "D:\Documents\CopieFichier"
Res est un booléen
Res = fRepDéplace("C:\Répertoires\MesFichiers", "D:\Documents\CopieFichier", frRécursif)
SI Res = Faux ALORS
	Erreur(ErreurInfo(errMessage))
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = fRepDéplace(<Chemin du répertoire à déplacer> , <Chemin du répertoire de destination> [, <Indicateur de déplacement>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le contenu du répertoire a été déplacé, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Chemin du répertoire à déplacer> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du répertoire dont le contenu doit être déplacé (260 caractères maximum). Un chemin de type UNC peut être utilisé. Les caractères jokers (\*, ?) sont autorisés. Ce nom de répertoire peut être terminé indifféremment par "\\" ou non.
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.

**`<Chemin du répertoire de destination> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du répertoire de destination (260 caractères maximum). Un chemin de type UNC peut être utilisé. Ce nom de répertoire peut être terminé indifféremment par "\\" ou non.
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.

**`<Indicateur de déplacement> : (Constante (ou combinaison de constantes) optionnelle)`**

Les constantes utilisables sont les suivantes (par défaut, aucune option n'est sélectionnée) :


|   |   |
| --- | --- |
| *frConfirmer* | Le contenu du répertoire est déplacé après confirmation de l'écrasement du répertoire de même nom.<br> |
| *frJauge* | Une fenêtre de progression est affichée.<br> |
| *frRécursif* | Le contenu du répertoire d'origine est déplacé (fichiers et sous-répertoires). Si le répertoire d'origine contient des fichiers ou des sous-répertoires et si cette constante n'est pas précisée, la copie n'est pas effectuée. |





Par défaut, &lt;Indicateur de déplacement&gt; est vide. Aucune des options n'est sélectionnée.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Déplacement du répertoire et de son contenu
<a name="deplacement_repertoire_son_contenu_ELTPARAGRAPHE000095"></a>**Pour déplacer uniquement le contenu du répertoire**, seuls le chemin et le nom du répertoire à déplacer sont à préciser. Par exemple, la ligne de code :


```wl
fRepDéplace("C:\MesRépertoires\MesFichiers", "D:\MesDocuments\CopieFichier", frRécursif)
```


- Copie uniquement les fichiers présents dans le répertoire "C:\\MesRépertoires\\MesFichiers" dans le répertoire "D:\\MesDocuments\\CopieFichier". Le répertoire d'origine n'est pas recrée. 

- Le répertoire original et son contenu sont détruits.




**Pour déplacer le répertoire et son contenu**, il est conseillé d'utiliser la fonction [fRenomme](../WDLang1/3036038.md). 


<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Fonctionnement sous Windows Vista (et supérieur)
<a name="fonctionnement_sous_windows_vista_superieur_ELTPARAGRAPHE000244"></a>Si cette fonction ne fonctionne pas correctement sous Windows Vista (et supérieur), il est nécessaire de vérifier si le fichier ou le répertoire manipulé ne se trouve pas dans un des répertoires système (répertoire de Windows ou répertoire "Program Files").

**En effet, sous Windows Vista (et supérieur), avec le [mécanisme de l'UAC](../Editeurs/2025014.md) (contrôle des comptes utilisateurs) activé**, il est nécessaire d'avoir les privilèges administrateur pour manipuler / modifier des fichiers ou des répertoires présents dans les répertoires système (répertoire de Windows ou répertoire "Program Files").

**Conseil de programmation** : Si vous devez manipuler / modifier des fichiers ou des répertoires, sans avoir besoin de privilèges administrateur, il est conseillé :

- de ne pas écrire dans le répertoire de Windows ou dans le répertoire "Program Files",

- d'utiliser le répertoire système correspondant à l'application (connu par la fonction [SysRep](../WDLang1/3073026.md) par exemple avec la constante *srAppDataCommun*).




**Remarque** : Sous Windows Vista (et supérieur), le mécanisme de la virtualisation permet de rendre les applications compatibles Vista. Si le fichier est créé dans un répertoire système sans avoir les droits nécessaires, ce fichier sera réellement créé dans un autre répertoire (C:\\Users\\&lt;LOGIN&gt;AppData\\Local\\VirtualStore\\Windows\\). Dans ce cas, le fichier ne pourra pas être partagé entre plusieurs applications.

<a name="XComposante"></a>

## Composante :
wd280std.dll
