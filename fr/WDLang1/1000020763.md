
## ChampRechercheTextePremier (Fonction)

***En anglais : ControlFindTextFirst***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Recherche et sélectionne le premier élément correspondant au texte recherché dans une fenêtre ou un champ.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// A chaque modification de SAI_RECH
// Recherche et surligne toutes les occurrences
// Surligne en bleu la 1er occurrence et l'affiche si nécessaire
SI ChampRechercheTextePremier(MaFenêtre.Nom, SAI_RECH, 0, iBleuClair) = 0 ALORS
	BTN_Suivant.Etat = Grisé
	Info("Texte non trouvé")
SINON
	BTN_Suivant.Etat = Actif
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = ChampRechercheTextePremier(<Elément> , <Texte recherché> [, <Options de recherche> [, <Surlignage premier élément> [, <Surlignage éléments trouvés>]]])`
---

**`<Résultat> : (Entier)`**



- Nombre d'occurrences trouvées du texte dans le champ ou dans la fenêtre. 

- 0 si aucun élément ne contient le texte recherché. 




**`<Elément> : (Nom de fenêtre ou nom de champ)`**

Nom de l'élément dans lequel la recherche doit être effectuée. Cet élément peut correspondre : 

- à un nom de fenêtre. La recherche est alors effectuée dans le libellé des champs, le texte des boutons, le texte des champs de saisie, le texte des lignes de tables, ... La recherche est effectuée dans tous les champs visibles qui n'ont aucun parent invisible. 

- à un nom de champ. Si cet élément correspond à un champ Ruban, la recherche est effectuée dans tous les champs du ruban. 




**`<Texte recherché> : (Chaîne de caractères)`**



- Texte à rechercher dans l'élément spécifié. 

- "" (chaîne vide) pour annuler la recherche. 




**`<Options de recherche> : (Constante optionnelle de type Entier)`**

Indique les options de la recherche : 



|   |   |
| --- | --- |
| *MotComplet* | Recherche un mot complet (entouré par des caractères de ponctuation ou des espaces) |
| *SansCasse* | Recherche sans tenir compte de la casse (différences majuscules / minuscules) ou des accents |
| 0 | Recherche en tenant compte de la casse (différences majuscules / minuscules) sur un texte "contenu dans". |


Par défaut, aucune option n'est sélectionnée : la recherche est sensible à la casse et est effectuée sur les mots incomplets. 

**`<Surlignage premier élément> : (Entier ou constante (optionnel))`**

Couleur utilisée pour surligner le premier élément trouvé. Cette couleur peut correspondre à :

- une couleur RVB (obtenue avec la fonction [RVB](../WDLang1/3029012.md)),

- une couleur TSL (obtenue avec la fonction [TSL](../WDLang1/3029057.md)),

- [une couleur prédéfinie du WLangage](../WDLang5/3010002.md).




**Remarque** : La couleur utilisée par défaut est le bleu foncé. 

**`<Surlignage éléments trouvés> : (Entier ou constante (optionnel))`**

Couleur utilisée pour surligner les occurrences trouvées. Cette couleur peut correspondre à :

- une couleur RVB (obtenue avec la fonction [RVB](../WDLang1/3029012.md)),

- une couleur TSL (obtenue avec la fonction [TSL](../WDLang1/3029057.md)),

- [une couleur prédéfinie du WLangage](../WDLang5/3010002.md).




**Remarque** : La couleur utilisée par défaut est le jaune clair. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Une seule recherche de texte peut être en cours dans un champ ou une fenêtre à un moment donné. 

- L'appel à la fonction **ChampRechercheTextePremier** annule un éventuel appel précédent à la fonction [ChampRechercheSurligne](../WDLang1/1000020535.md). 

- La recherche n'est pas effectuée dans les champs suivants : 

	- Champ HTML et champ de saisie au format HTML. 

	- Champ ActiveX.

	- Zone non affichée des champs Zone répétée, Liste, Tables.

	- Liste, table ou popup affichée par les combos. 







<a name="XComposante"></a>

## Composante :
wd280obj.dll
