
## HTMLVersRTF (Fonction)

***En anglais : HTMLToRTF***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Convertit une chaîne HTML ou un buffer HTML en chaîne au format RTF. Pendant la conversion, les opérations suivantes sont effectuées :

- Suppression des balises HTML,

- Conversion des caractères spéciaux HTML, 

- Conversion des Retours Chariots (RC) en espaces,

- Conversion des espaces multiples en espaces uniques.




Le formatage est conservé "au mieux".




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MonTexteHTML est une chaîne = "<!--test--><b><i>&quote;Bonjour !&quote;</i>"
Texte est une chaîne = HTMLVersRTF(MonTexteHTML)
// Texte vaut : "Bonjour" !
```




<a name="Exemple2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Si le document HTML vaut:
//<HTML>
// <HEAD>
//  <TITLE>Ceci est un essai de page Web</TITLE>
//  <META http-equiv="content-type" content="text/html; charset=UTF-8">
// </HEAD>
//<BODY>
// <H2>Ceci est      une page HTML   en Français</H2>
//  <A href="http://www.pcsoft.fr">Ceci est un lien</A>
// </BODY>
//</HTML>

Texte = HTMLVersRTF(MonTexteHTML)
// Texte contiendra le code RTF correspondant au texte suivant : 
// Ceci est     une page HTML   en Français.
//
// Ceci est un lien
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HTMLVersRTF(<Texte au format HTML> [, <Alphabet utilisé>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Texte RTF correspondant au résultat de la conversion HTML. L'encodage des caractères utilisé est celui de l'alphabet courant de WINDEV ou WEBDEV.

**`<Texte au format HTML> : (Chaîne de caractères ou buffer)`**

Texte à convertir.

**`<Alphabet utilisé> : (Constante de type Entier optionnelle)`**

Constante identifiant l'alphabet utilisé pour l'écriture du &lt;Texte au format HTML&gt;. Par défaut, l'alphabet en cours de WINDEV/WEBDEV est utilisé (constante *alphabetCourant*). Si des informations sur l'alphabet utilisé sont trouvées dans le &lt;Texte au format HTML&gt;, ces informations sont prioritaires sur ce paramètre. 
Pour plus de détails sur ces constantes, consultez [Correspondance entre les langues, les sous-langues, les alphabets et les nations](../WDLang1/3054022.md).  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Règles de conversion utilisées
<a name="regles_conversion_utilisees_ELTPARAGRAPHE000077"></a>

- Les balises HTML sont analysées afin de conserver au mieux la mise en forme dans le texte de sortie (les Retours Chariots, les espaces, les tabulations). Le formatage est conservé au mieux : gras, italique, couleurs, ...

- **N'apparaissent pas dans la sortie RTF** : 

	- les balises HTML

	- le contenu du "header" (informations contenues dans la balise &lt;HEAD&gt;)

	- les commentaires

	- les textes de contrôles

	- les scripts

	- les définitions SSL

	- les styles CSS (sauf les attributs "color")




- **Gestion des Retours Chariots**

	- 2 Retours Chariots sont insérés pour remplacer des balises &lt;P&gt;, &lt;H1&gt; à &lt;H6&gt;, &lt;TABLE&gt;, &lt;UL&gt; ou &lt;OL&gt;

	- 1 Retour Chariot est inséré pour remplacer les balises &lt;BR&gt;, &lt;TR&gt;, &lt;LI&gt;, &lt;DD&gt; ou &lt;DIV&gt;

	- 1 seul Retour Chariot est inséré si plusieurs balises identiques (&lt;TR&gt;, &lt;LI&gt;, &lt;DD&gt; ou &lt;DIV&gt;) se suivent (sauf pour les balises &lt;BR&gt;)




- **Gestion des tableaux**

	- Pour chaque ligne d'un tableau (balise &lt;TR&gt;), un Retour Chariot est inséré.

	- Pour chaque colonne d'un tableau (balise &lt;TD&gt;), une tabulation est insérée.




- **Gestion des caractères spéciaux**
	Un caractère spécial est un caractère défini dans la norme HTML. Par exemple, un espace peut s'écrire " " et le caractère "é" peut s'écrire "é,". Cette norme est automatiquement utilisée.





<a name="NOTE0_2"></a>




### Balises gérées
<a name="balises_gerees_ELTPARAGRAPHE000107"></a>Les balises non gérées sont ignorées : leur contenu est pris en compte comme du texte.  

Les balises gérées sont les suivantes :

- &lt;PRE&gt;

- &lt;UL&gt; : Saut de ligne + tabulation

- &lt;OL&gt; : Saut de ligne + tabulation

- &lt;LI&gt; : Tabulation

- &lt;H1&gt; : Saut de ligne avant et saut de ligne après, gras et taille de la fonte appliqués

- &lt;H2&gt; : Saut de ligne avant et saut de ligne après, gras et taille de la fonte appliqués

- &lt;H3&gt; : Saut de ligne avant et saut de ligne après, gras et taille de la fonte appliqués

- &lt;H4&gt; : Saut de ligne avant et saut de ligne après, gras et taille de la fonte appliqués

- &lt;H5&gt; : Saut de ligne avant et saut de ligne après, gras et taille de la fonte appliqués

- &lt;H6&gt; : Saut de ligne avant et saut de ligne après, gras et taille de la fonte appliqués

- &lt;P&gt; : Saut de ligne avant et saut de ligne après

- &lt;BR&gt; : Saut de ligne

- &lt;B&gt; : Gras

- &lt;STRONG&gt; : Gras

- &lt;I&gt; : Italique

- &lt;EM&gt; : Italique

- &lt;FONT&gt; : Taille et couleur

- &lt;A HREF&gt; : Lien hypertexte

- &lt;SPAN&gt; : Style : Couleur

- &lt;DL&gt; : Saut de ligne

- &lt;DT&gt; : Saut de ligne

- &lt;DD&gt; : Tabulation et saut de ligne

- &lt;TABLE&gt; : Saut de ligne

- &lt;TR&gt; : Saut de ligne

- &lt;TD&gt; : Eléments séparés par une tabulation

- &lt;HEAD&gt; : Contenu ignoré, sauf les paramètres de l'alphabet

- &lt;STYLE&gt; : Contenu ignoré

- &lt;SCRIPT&gt; : Contenu ignoré

- &lt;!-- --&gt; : Commentaires ignorés





<a name="NOTE0_3"></a>




### Gestion de l'alphabet
<a name="gestion_alphabet_ELTPARAGRAPHE000148"></a>Pour connaître l'alphabet utilisé dans le texte HTML, la fonction **HTMLVersRTF** utilise l'information contenue dans l'attribut CONTENT d'une balise &lt;META&gt;.

Si cette balise n'est pas présente, il est nécessaire de spécifier l'alphabet utilisé pour écrire le texte HTML avec le paramètre &lt;Alphabet utilisé&gt;.

En effet, si le contenu HTML utilise un alphabet arabe et si WINDEV/WEBDEV utilisent par défaut un alphabet français, le texte de sortie utilisera des caractères invalides.

Remarques :

- Si le texte de sortie contient de nombreux caractères "?", cela signifie que le caractère de l'alphabet du document HTML n'a pas pu être exprimé avec un caractère de la langue en cours.

- L'alphabet UTF8 est le plus couramment utilisé pour l'encodage des pages Web.







- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LesfonctionsHTMLVers.gif) ***Exemples unitaires (WEBDEV)*** : **Les fonctions HTMLVers** <br>Utilisation des fonctions WLangage HTMLVersRTF et HTMLVersTexte.



<a name="XComposante"></a>

## Composante :
wd280rtf.dll
