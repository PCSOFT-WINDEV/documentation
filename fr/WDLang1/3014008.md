


## CréeRaccourci (Fonction)

***En anglais : CreateShortcut***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Crée un raccourci sur le bureau de Windows, dans le menu "Démarrer" de Windows ou dans un répertoire spécifique. Ce raccourci peut être associé à tout type de fichier : exécutable, document, etc.

**Remarque** : Sous Windows Vista et supérieur, pour créer un raccourci, l'application doit être lancée en mode "Administrateur". 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003014008&name=creeraccourci_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Vista/7... : Privilèges administrateur nécessaires 
// Crée le raccourci "Test" du programme "C:\Test\Test.exe"
// sur le bureau (de tous les utilisateurs), avec Ctrl + Alt + A comme raccourci clavier
SI CréeRaccourci(raccourciBureau, "Test", "C:\Test\Test.exe", "", sfaNormal, "A") = Faux ALORS
	Erreur("Echec de création du raccourci dans" + SysRep(srBureauCommun) + ...
		", vérifiez vos droits (privilèges administrateur nécessaires)", ErreurInfo())
SINON
	Info("Raccourci créé")
FIN
```
<a name="Exemple2"></a>

```wl
// Vista/7... : Privilèges administrateur nécessaires 
// Créer le raccourci dans "Démarrer/Programmes/Accessoires" de tous les utilisateurs
SI CréeRaccourci(raccourciProgramme, "Test", "C:\Test\Test.exe", ...
	"Accessoires", sfaNormal, "A") = Faux ALORS
	Erreur("Echec de création du raccourci dans" + SysRep(srProgrammesCommun) + ...
		", vérifiez vos droits (privilèges administrateur nécessaires)", ErreurInfo())
	
SINON
	Info("Raccourci créé")
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = CréeRaccourci(<Emplacement> , <Nom> , <Ligne de commande> [, <Chemin du raccourci> [, <Mode d'ouverture> [, <Touche de raccourci> [, <Répertoire de travail> [, <Icône>]]]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le raccourci a été créé, 

- <u><u><u><u>Faux</u></u></u></u> en cas de problème.




**`<Emplacement> : (Constante de type entier)`**

Emplacement du raccourci :


|   |   |
| --- | --- |
| *raccourciBureau*<br>(Valeur par défaut) | Raccourci créé sur le bureau de Windows de tous les utilisateurs du poste.<br><br>Pour créer un raccourci sur le bureau sous Windows Vista (et supérieur), l'application qui crée le raccourci doit avoir un manifeste administrateur. |
| *raccourciBureauUtilisateur* | Raccourci créé sur le bureau de Windows de l'utilisateur courant du poste. |
| *raccourciDémarrage* | Raccourci créé dans le menu "Démarrer .. Programmes .. Démarrage" de Windows pour tous les utilisateurs du poste. |
| *raccourciDémarrageUtilisateur* | Raccourci créé dans le menu "Démarrer .. Programmes .. Démarrage" de Windows pour l'utilisateur courant du poste. |
| *raccourciDémarrer* | Raccourci créé dans le menu "Démarrer" de Windows pour tous les utilisateurs du poste. |
| *raccourciDémarrerUtilisateur* | Raccourci créé dans le menu "Démarrer" de Windows pour l'utilisateur courant du poste. |
| *raccourciLancementRapide* | Raccourci créé dans la barre de lancement rapide (Windows 98 et version supérieures). |
| *raccourciLibre* | Raccourci créé dans le répertoire indiqué par le paramètre &lt;Chemin&gt;. |
| *raccourciProgramme* | Raccourci créé dans le menu "Démarrer .. Programmes" de Windows pour tous les utilisateurs du poste.<br><br>Pour créer un  raccourci dans "Démarrer .. Programmes" sous Windows Vista (et supérieur), l'application qui crée le raccourci doit avoir un manifeste administrateur.<br>Pour créer un  raccourci sur le menu Programmes de l'utilisateur en cours, utilisez la constante *raccourciLibre*, puis utilisez SysRep(srProgrammes) dans le paramètre &lt;Chemin du raccourci&gt;. Dans ce cas, l'application qui crée le raccourci ne nécessite pas un manifeste administrateur. |
| *raccourciProgrammeUtilisateur* | Raccourci créé dans le menu "Démarrer .. Programmes" de Windows pour l'utilisateur courant du poste. |
| *raccourciRechercheWindows8* | Raccourci créé uniquement pour la recherche en Windows 8 pour tous les utilisateurs du poste. Le raccourci n'est pas présent sur l'écran d'accueil.<br><br>Si le système utilisé n'est pas Windows 8, le raccourci est créé dans le menu "Démarrer .. Programmes" de Windows pour tous les utilisateurs du poste. |



**`<Nom> : (Chaîne de caractères)`**

Nom du raccourci.

**`<Ligne de commande> : (Chaîne de caractères)`**

Ligne de commande complète associée au raccourci. Cette ligne de commande sera exécutée lors du double clic sur le lien. Les chemins des fichiers contenant des espaces doivent être encadrés par des guillemets.
Dans les propriétés du raccourci, la ligne de commande correspond à la cible.


**`<Chemin du raccourci> : (Chaîne de caractères optionnelle)`**

Répertoire où le raccourci doit être créé (répertoire relatif à &lt;Emplacement&gt;). Le raccourci peut être créé par exemple dans un "Répertoire" (ou groupe de programmes) du menu "Démarrer .. Programmes", ou dans un dossier sur le bureau.
Si &lt;Emplacement&gt; = ***raccourciLibre***, le chemin est absolu (le disque est précisé), sinon le chemin est relatif à l'emplacement indiqué.
Si ce paramètre n'est pas précisé ou correspond à une chaîne vide (""), le raccourci sera créé directement dans l'&lt;Emplacement&gt; indiqué.
Les chemins contenant des espaces doivent être encadrés par des guillemets.

**`<Mode d'ouverture> : (Constante optionnelle de type entier)`**

Mode d'ouverture de la fenêtre principale de l'application associée au lien. La couleur du bandeau de sélection sera modifiée pour ce champ (table, liste ou combo).


|   |   |
| --- | --- |
| *sfaIconise* | Ouverture de la fenêtre icônisée. |
| *sfaMaximise* | Ouverture de la fenêtre maximisée. |
| *sfaNormal*<br>(Valeur par défaut) | Ouverture à la taille standard. |



**`<Touche de raccourci> : (Chaîne de caractères optionnelle)`**

Touche ou combinaison de touches au clavier permettant de lancer le raccourci. Chaque touche est représentée par un ou plusieurs caractères. Il n'est pas nécessaire de préciser "Ctrl-Alt" qui est ajouté automatiquement. Par défaut, il n'y a pas de touche de raccourci.

- Pour utiliser un seul caractère du clavier, il suffit d'utiliser le caractère proprement dit. Par exemple, pour représenter la lettre A, affectez la valeur "A" au paramètre &lt;Touche de raccourci&gt;. 
	Attention : La fonction attribue une signification spéciale aux signes suivants :

	- plus (+),

	- insertion (^),

	- pourcentage (%),

	- parenthèses ( ).


 Pour utiliser l'un de ces caractères, il est nécessaire de le placer entre accolades. Par exemple, pour utiliser le signe plus (+), tapez {+}. Pour utiliser des accolades, utilisez les caractères {{} et {}}.

- Pour utiliser des caractères spéciaux, des codes spécifiques sont nécessaires pour identifier :

	- les caractères n'ayant aucune action à l'écran (par exemple, la touche Entrée),

	- les caractères correspondant à une action (par exemple, les touches de fonction).


 Il est nécessaire d'utiliser les codes suivants :
	

| Touche | Code | Touche | Code |
| --- | --- | --- | --- |
| RET.ARR | {RA} | PAUSE | {PAUSE} |
| VERR.MAJ | {VERRMAJ} | SUPPR | {SUPPR} |
| BAS | {BAS} | FIN | {FIN} |
| ENTREE | {ENTREE} | ECHAP | {ECHAP} |
| AIDE | {AIDE} | ORIGINE | {ORIGINE} |
| INSERTION | {INSER} | GAUCHE | {GAUCHE} |
| VERR.NUM | {VERRNUM} | PG.SUIV | {PGSUIV} |
| PG.PREC | {PGPREC} | IMPR. ECRAN | {IMPRECR} |
| DROITE | {DROITE} | ARRET.DEFIL | {ARRETDEFIL} |
| TAB | {TAB} | HAUT | {HAUT} |
| F1 | {F1} | F2 | {F2} |
| F3 | {F3} | F4 | {F4} |
| F5 | {F5} | F6 | {F6} |
| F7 | {F7} | F8 | {F8} |
| F9 | {F9} | F10 | {F10} |
| F11 | {F11} | F12 | {F12} |
| F13 | {F13} | F14 | {F14} |
| F15 | {F15} | F16 | {F16} |



- Pour spécifier une combinaison de touches avec Maj, Ctrl ou Alt, il est nécessaire de faire précéder le code normal de la touche d'un ou plusieurs codes parmi les suivants :
	

| Touche | Code |
| --- | --- |
| MAJ | + |
| Ctrl | ^ |
| Alt | % |



- Pour spécifier que les touches Maj, Ctrl et/ou Alt doivent être maintenues enfoncées pendant que l'on appuie sur une autre touche : par exemple, pour que la touche Maj soit maintenue enfoncée en même temps que la touche E, utilisez "+E".




**`<Répertoire de travail> : (Chaîne de caractères optionnelle)`**

Répertoire de travail associé au programme lancé. Par défaut, aucun répertoire de travail n'est spécifié. Les chemins contenant des espaces doivent être encadrés par des guillemets.

**`<Icône> : (Chaîne de caractères optionnelle)`**

Nom et chemin de l'icône associée au raccourci. Par défaut, l'icône de l'exécutable est utilisée (ou l'icône associée au type de fichier).



<a name="XComposante"></a>

## Composante :
wd280std.dll
