


## docFragment (Type de variable)

***En anglais : docFragment***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **docFragment** permet de définir toutes les caractéristiques d'un fragment d'un document "docx". Les caractéristiques de ce fragment peuvent être définies et modifiées à l'aide de différentes propriétés WLangage. 

Un fragment est défini par ses positions de début et de fin. Il peut donc :

- s'étendre sur plusieurs paragraphes, 

- commencer au milieu d'un mot quelconque,

- se terminer au milieu d'un mot quelconque.




**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Changement de la couleur de la sélection
// Récupération de la sélection actuelle
MaSélection est un docFragment(TT_MonDocument, TT_MonDocument.Curseur, ...
		TT_MonDocument.LongueurSélection)
// Changement de la couleur
MaSélection.MiseEnForme.CouleurTexte = RougePastel
```
<a name="Exemple2"></a>

```wl
// Chargement du document
MonDoc est un Document = "c:\temp\doc.docx"

// Ajoute du texte à la fin du document
FragmentFin est un docFragment(MonDoc, -1 , 0)
FragmentFin.Texte += "Fin de document"
```


## Syntaxe
<a name="SYNTAXE1"></a>

### Déclarer un fragment d'un document non décrit

`MaVariable est une docFragment`
---

Dans ce cas, le fragment du document n'est pas décrit. La variable devra être affectée avec un fragment existant ou avec le résultat d'une des fonctions de manipulations de documents (par exemple avec la fonction [DocRecherche](../WDLang1/1000022388.md)). 


<a name="SYNTAXE2"></a>

### Déclarer et décrire un fragment

`MaVariable est un docFragment([<Document> [, <Début du fragment> [, <Longueur>]]])`
---

**`<Document> : (Variable optionnelle de type Document ou chaîne de caractères)`**

Document dans lequel l'extraction d'un fragment doit être effectuée. Ce document correspond : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) au nom d'un champ Traitement de texte. 

- à une variable de type [Document](../WDLang1/1000022461.md). 




**`<Début du fragment> : (Entier optionnel)`**

Position du début du fragment du document à manipuler. Cette position est donnée en nombre de caractères : 

- depuis le début du document (nombre positif). 

- depuis la fin du document (nombre négatif). 




**`<Longueur> : (Entier optionnel)`**

Longueur du fragment à manipuler, exprimée en nombre de caractères. 
Remarque : un nombre négatif permet de prendre un nombre de caractères depuis la fin : '-1' = jusqu'à la fin, '-2' = jusqu'à 1 caractère avant la fin, etc.



<a name="NOTE0"></a>

## Remarques
<a name="NOTE0_1"></a>


### Propriétés spécifiques à la description des variables de type docFragment
<a name="proprietes_specifiques_description_des_variables_type_docfragment_ELTPARAGRAPHE000071"></a>Les propriétés suivantes peuvent être utilisées pour manipuler une variable de type **docFragment** :


   | --- |
| --- | --- | --- |
| **Nom de la propriété** | Type manipulé | Effet |
| Elément | Tableau de [docElément](../WDLang1/1000022484.md) | Eléments composant le fragment du document manipulé. Il est possible de parcourir les éléments du fragment via l'instruction POUR TOUT. |
| Etendue | Entier | Nombre de caractères contenus dans le fragment. Correspond à la position de fin moins la position de début. <br>L'étendue peut correspondre à une valeur positive, négative ou nulle. <br><br>Remarques :<br><br>- Si le fragment contient un tableau ou un morceau de tableau, tous les caractères du tableau ou du morceau de tableau sont comptés. <br><br>- Si le fragment contient une image ou une zone de texte, l'image et la zone de texte correspondent chacun à 1 caractère. <br><br><br> |
| IdentifiantSousDocument | Entier | Identifiant correspondant au sous-document associé au fragment. Cette propriété est d'un usage avancé. <br><br> |
| LangueOrthographe | Chaîne de caractères | Langue du fragment. La notation utilisée correspond à la norme 639-1. Par exemple "FR-fr". <br><br>En lecture, cette propriété renvoie une information valide uniquement si le fragment correspond à une seule langue. <br><br>**Remarque** : Pour réaliser la correction orthographique correspondant à la langue du fragment, il est nécessaire de charger le dictionnaire de cette langue avec la fonction [DictionnaireCharge](../WDLang1/1000022958.md).<br><br> |
| MiseEnForme | Variable de type [docMiseEnForme](../WDLang1/1000022817.md) | Informations de mise en forme de tous les éléments composant le fragment du document manipulé.<br><br> |
| MiseEnPage | <br><br> | Mise en page du fragment en cours. <br><br> |
|   | MiseEnPage.CouleurFond | Entier | Couleur de fond du fragment. Cette couleur peut correspondre à :<br><br>- une couleur RVB (obtenue avec la fonction [RVB](../WDLang1/3029012.md)),<br><br>- [une couleur prédéfinie](../WDLang5/3010002.md). <br><br><br> |
|   | MiseEnPage.TrameFond | Variable de type [Fond](../WDLang1/1000022038.md) | Caractéristiques de fond du fragment. <br><br> |
| Mot | Tableau de **docFragment** | Mots composant le fragment du document manipulé. Il est possible de parcourir les mots du fragment via l'instruction POUR TOUT. |
| Paragraphe | Tableau de [docParagraphe](../WDLang1/1000022483.md) | Paragraphes concernés par le fragment (cas où un fragment est composé de plusieurs paragraphes). Il est possible de parcourir les paragraphes via l'instruction POUR TOUT. |
| PositionDébut | Entier | Position du début du fragment. Cette position est relative au document entier. |
| PositionFin | Entier | Position de fin du fragment. Cette position est relative au document entier. |
| StyleID | Chaîne de caractères | Identifiant du style appliqué au fragment. Cet identifiant doit exister parmi les styles liés au document. <br><br>Remarque : le changement de style d'un paragraphe ou d'un fragment applique automatiquement le style paragraphe et le style caractère liés s'ils existent. |
| Texte | Chaîne de caractères | Texte brut correspondant au contenu du fragment manipulé. |
| TypeSousDocument | Constante de type Entier | Partie du document auquel le fragment appartient. <br>Les valeurs possibles sont les suivantes : <br><br>- *typeSousDocCanvas* : Conteneur d'images.<br><br>- *typeSousDocCorps* : Corps du document. <br><br>- *typeSousDocEnTêtePageImpaire* : Entête de page impaire. <br><br>- *typeSousDocEnTêtePagePaire* : Entête de page paire. <br><br>- *typeSousDocEnTêtePremièrePage* : Entête de la première page. <br><br>- *typeSousDocPiedDePageImpaire* : Pied de page impaire. <br><br>- *typeSousDocPiedDePagePaire* : Pied de page paire. <br><br>- *typeSousDocPiedDePremièrePage* : Pied de page de la première page. <br><br>- *typeSousDocZoneDeTexte* : Zone de texte.<br><br><br><br><br>Cette propriété est disponible en lecture seulement. |


<a name="NOTE0_2"></a>


### Fonctions WLangage utilisant les variables de type docFragment
<a name="fonctions_wlangage_utilisant_les_variables_type_docfragment_ELTPARAGRAPHE000431"></a>Les variables de type **docFrament** sont manipulées par plusieurs fonctions WLangage : 

- fonctions WLangage utilisant une syntaxe classique : 
	


|   |   |
| --- | --- |
| [DocAjoute](../WDLang1/1000022919.md) | Ajoute : <br><br>	- à la fin d'un document de type Traitement de texte : un élément, un document, un paragraphe, un texte, une image ou un fragment.<br><br>	- à la fin d'un fragment : un élément, un texte ou une image.<br><br><br> |
| [DocInsère](../WDLang1/1000022732.md) | Insère un objet dans un document de type Traitement de texte ou remplace le contenu du fragment en cours. Les objets manipulables sont : <br><br>	- un élément,<br><br>	- un document, <br><br>	- un paragraphe, <br><br>	- un texte, <br><br>	- une image, <br><br>	- un fragment.<br><br><br> |
| [DocInsèreTableau](../WDLang1/1000022967.md) | Insère un tableau dans un document de type Traitement de texte. |
| [DocRecherche](../WDLang1/1000022388.md) | Recherche une chaîne de caractères : <br><br>	- dans l'ensemble d'un document de type Traitement de texte.<br><br>	- dans un fragment.<br><br><br> |
| [DocSélectionne](../WDLang1/1000022391.md) | Sélectionne un fragment dans un champ Traitement de texte. |

- fonctions WLangage utilisant une syntaxe préfixée : 
	


|   |   |
| --- | --- |
| [&lt;Variable docFragment&gt;.Ajoute](../WDLang1/1000024505.md) | Ajoute un élément, un texte ou une image à la fin d'une variable docFragment. |
| [&lt;Variable docFragment&gt;.Insère](../WDLang1/1000024512.md) | Remplace le contenu du fragment en cours. Les objets manipulables sont : <br><br>	- un élément,<br><br>	- un document, <br><br>	- un paragraphe, <br><br>	- un texte, <br><br>	- une image, <br><br>	- un fragment.<br><br><br> |
| [&lt;Variable docFragment&gt;.InsèreTableau](../WDLang1/1000024514.md) | Remplace le fragment spécifié par un tableau. |





