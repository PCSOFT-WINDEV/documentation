
## INIEcrit (Fonction)

***En anglais : INIWrite***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ecrit une valeur spécifique dans un fichier INI (ou structuré comme un fichier .INI). Il est possible de :

- écrire la valeur d'un mot-clé présent dans une section spécifique,

- créer ou supprimer un mot-clé,

- créer ou supprimer une section.









<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Mémorisation du produit sélectionné dans le .INI
INIEcrit("USER", "LastProd", ...
	NumériqueVersChaîne(ListeSelect(LISTE_Produit)), ...
	fRepEnCours() + "\Port.INI")
```


<a name="Exemple2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
Exemple de fichier .INI :

```txt
[Exemples WD]
Nom1 = Wdinstall
Nom2 = WDBench
[Description du projet WDInstall]
Libellé = Utilisez le panneau de configuration de Windows
LST = 43
Page = 12
```



```wl
// Écriture dans la section [Exemples WD]
INIEcrit("Exemples WD", "Nom3", "WDExemple", "C:\Temp\ExemplesLST.INI")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = INIEcrit(<Section> [, <Mot-clé> [, <Valeur> [, <Fichier>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'opération a été réalisée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Section> : (Chaîne de caractères)`**

Nom de la section où l'écriture doit être effectuée. Si cette section n'existe pas, elle est automatiquement créée.

**Remarque** : Ce nom ne peut pas contenir le caractère "-".

**`<Mot-clé> : (Chaîne de caractères optionnelle)`**

Nom du mot-clé contenant les informations à écrire. Si ce mot-clé n'existe pas, il est automatiquement créé.
Si ce paramètre est une chaîne vide ("") ou correspond à NULL, la section sera supprimée.



**`<Valeur> : (Chaîne de caractères optionnelle)`**

Texte à écrire pour le mot-clé et la section spécifiée. Si ce paramètre est une chaîne vide ("") ou correspond à NULL, le mot-clé sera supprimé.

**Remarque** : Ce texte ne peut pas contenir le caractère TAB.


**`<Fichier> : (Chaîne de caractères optionnelle)`**

Nom complet du fichier à compléter (avec son extension). 

- Si ce paramètre n'est pas précisé, le fichier considéré est le fichier WIN.INI. 

- Si seul le chemin n'est pas précisé, le fichier indiqué sera recherché dans le répertoire de Windows. 

- Si le répertoire n'existe pas, il ne sera pas créé. 

- Si le fichier n'existe pas dans le répertoire indiqué, le fichier sera créé.




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Nom complet du fichier à compléter (avec son extension). 

- Si ce paramètre n'est pas précisé, le fichier utilisé sera celui portant le nom du projet et se situant dans le répertoire d'exécution de l'application. Si le fichier n'existe pas, il sera créé. 

- Si seul le chemin n'est pas précisé, le fichier indiqué sera recherché dans le répertoire d'exécution de l'application.


![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Ce paramètre est obligatoire. Ce paramètre peut correspondre à un chemin complet ou relatif par rapport au répertoire en cours. Le répertoire en cours correspond au répertoire des données de l'application.
**Rappel** : Seuls les fichiers présents dans le répertoire des données associé à l'application peuvent être manipulés.







<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Ecriture dans un fichier INI en mode Unicode
<a name="ecriture_dans_fichier_ini_mode_unicode_ELTPARAGRAPHE000163"></a>Votre application est en mode Unicode (option "Utiliser des chaînes UNICODE en exécution" cochée dans l'onglet "Unicode" de la description de la configuration).

Dans ce cas, pour écrire dans un fichier INI, ce fichier INI doit être Unicode, c'est-à-dire avoir un entête BOM Unicode. 

Exemple : 


```wl
fCrée(gsFicINI, foUnicode) // crée gsFicINI avec un BOM UNICODE
INIEcrit("Français", "Pays", "France",gsFicINI)
INIEcrit("??","??", "??", gsFicINI)
```



<a name="NOTE0_2"></a>




### Divers
<a name="divers_ELTPARAGRAPHE000177"></a>

- Il est déconseillé d'écrire dans le fichier WIN.INI.  

- Pour écrire dans la base de registre, utilisez les fonctions spécifiques à la base de registre : [RegistreEcrit](../WDLang1/3065006.md), etc.

- Les fichiers de type INI sont limités à 64 Ko (sous Windows 98).





<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Windows Vista (et supérieur)
<a name="windows_vista_superieur_ELTPARAGRAPHE000192"></a>Les normes de programmation Windows déconseillent l'écriture :

- dans le fichier WIN.INI

- dans les répertoires systèmes (répertoire de Windows, répertoire "Program Files", ...).




**Sous Windows Vista (et supérieur) avec le mécanisme de l'UAC (contrôle des comptes utilisateurs) activé**, il est nécessaire d'avoir des privilèges administrateur pour effectuer ces opérations. Si l'application n'a pas les privilèges administrateur requis, le [mécanisme de l'UAC](../Editeurs/2025014.md) entraînera la redirection des fichiers (appelée virtualisation) vers un répertoire propre à l'utilisateur qui utilise l'application (C:\\Users\\&lt;LOGIN&gt;AppData\\Local\\VirtualStore\\Windows\\). Les fichiers pourront être relus avec la fonction [INILit](../WDLang1/3013043.md) utilisée dans la même application. Ce mécanisme de virtualisation des fichiers est proposé par Windows Vista (et supérieur) uniquement par compatibilité et n'est pas disponible en 64 bits.

**Attention** : Si le fichier INI est automatiquement virtualisé par Windows Vista (et supérieur), le fichier INI ne pourra pas être partagé entre plusieurs applications (surtout si ces applications utilisent des privilèges différents).

**Conseil de programmation** : Pour créer un fichier INI sans avoir besoin de privilèges administrateur, il est conseillé : 

- de ne pas utiliser le fichier WIN.INI (le paramètre &lt;Fichier&gt; doit être précisé),

- de ne pas écrire dans le répertoire de Windows ou dans le répertoire "Program Files",

- d'utiliser le répertoire système correspondant à l'application (connu par la fonction [SysRep](../WDLang1/3073026.md) par exemple avec la constante *srAppDataCommun*).








<a name="XComposante"></a>

## Composante :
wd280std.dll
