
## Type Monétaire + Euro
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000361"></a>
Dans une application WINDEV ou un site WEBDEV, il est nécessaire de gérer l'Euro dans tous les champs permettant de saisir ou d'afficher des valeurs monétaires :

- [champs de saisie](../WDChamp/1013145.md),

- [colonnes de champs Table](../WDChamp/1013245.md) (champ Table par programmation ou fichier),

- [champs calculés](../WDChamp/1013212.md) ou [champs rubrique](../WDChamp/1013059.md) dans un état.




Tous ces champs peuvent être de type "Monétaire + Euro".

Les caractéristiques spécifiques à ce type de champ sont les suivantes :

- [Devise mémorisée](#NOTE2_1),

- [Devise saisie et affichée](#NOTE3_1),

- [Bulle d'aide](#NOTE4_1),

- [Double affichage](#NOTE5_1). 



<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=type_monetaire_euro%20-%20HC%20N%B0001.gif&type=thumb)




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Devise mémorisée
<a name="devise_memorisee_ELTTEXTE000385"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000055"></a>La devise mémorisée correspond à la devise de la valeur retournée au programme ou transférée dans une rubrique. C'est avec la devise mémorisée que tous les calculs vont être effectués dans l'application.

Il est possible de préciser le nombre de décimales pris en compte pour cette devise mémorisée (5 par défaut). La valeur exprimée dans la devise mémorisée sera automatiquement arrondie selon le nombre de décimales précisé.
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=type_monetaire_euro%20-%20HC%20N%B0002%201.gif)


Les résultats pourront ensuite être affichés dans n'importe quelle devise choisie par l'intermédiaire de la "Devise saisie et affichée". La conversion sera automatiquement réalisée.

La devise mémorisée associée à un champ peut être modifiée par programmation grâce à la propriété [DeviseMemoire](../Proprietes/2510013.md).

**Attention** : Pour éviter des erreurs, il est conseillé d'utiliser le même nombre de décimales :

- dans le masque d'affichage/et de saisie du champ,

- dans l'arrondi de la devise mémorisée.





<a name="NOTE2_2"></a>


### Paramétrer la devise mémorisée
<a name="parametrer_devise_memorisee_ELTPARAGRAPHE000079"></a>La devise mémorisée est choisie sous l'éditeur de fenêtres ou l'éditeur d'états dans une liste présentant les différentes devises. Cette liste contient :

- le numéro identifiant la devise,

- l'abréviation de la devise selon la norme ISO,

- le nom du pays concerné par cette devise.




Les quatre dernières devises de cette liste sont des devises utilisateurs : elles permettent de choisir une devise supplémentaire créée par programmation avec la fonction [eInitDevise](../WDLang1/3033003.md).

**Remarque** : La devise &lt;Défaut&gt; correspond par défaut à l'Euro. Cette devise par défaut pourra être connue et modifiée par programmation grâce à la fonction [eDeviseMemParDéfaut](../WDLang1/3033016.md).



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Devise saisie et affichée
<a name="devise_saisie_affichee_ELTTEXTE000415"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000103"></a>La devise affichée correspond à la devise dans laquelle la valeur du champ est affichée ou saisie. La devise affichée est affichée selon le masque de saisie spécifié pour le champ.

Si la devise affichée est différente de la devise mémorisée, la conversion est automatiquement réalisée entre la devise d'affichage et la devise mémorisée. L'utilisation d'une devise d'affichage et d'une devise mémorisée différente permet de ne stocker qu'une seule devise dans le fichier de données : la valeur stockée pourra être affichée dans n'importe quelle devise.
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=type_monetaire_euro%20-%20HC%20N%B0002%202.gif)


**Attention** : Pour éviter des erreurs, il est conseillé d'utiliser le même nombre de décimales :

- dans le masque d'affichage/et de saisie du champ,

- dans l'arrondi de la devise mémorisée.




La devise affichée peut être modifiée par programmation grâce à la propriété [DeviseAffichage](../Proprietes/2510030.md).


<a name="NOTE3_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Configuration avancée
<a name="configuration_avancee_ELTPARAGRAPHE000127"></a>

Dans le cas d'un champ de saisie ou d'une colonne de table, des paramètres avancés peuvent être utilisés :

- **Devise modifiable par un menu contextuel** : L'utilisateur pourra choisir la devise d'affichage à l'aide d'un menu contextuel. Ce menu contextuel présente le résultat de la conversion de la valeur saisie dans les différentes devises gérées. Le menu contextuel présente uniquement les devises dont le taux de change est différent de zéro.

- **Afficher une tilde (~) en cas d'écart d'arrondi** : Cette tilde indique un écart d'arrondi entre la valeur exprimée dans la devise affichée et la valeur exprimée de la devise mémorisée.



<a name="NOTE3_3"></a>


### Paramétrer la devise affichée
<a name="parametrer_devise_affichee_ELTPARAGRAPHE000137"></a>La devise affichée est choisie sous l'éditeur de fenêtres ou de pages dans une liste présentant les différentes devises. Cette liste contient :

- le numéro identifiant la devise,

- l'abréviation de la devise selon la norme ISO,

- le nom du pays concerné par cette devise.




Les quatre dernières devises de cette liste sont des devises utilisateurs : elles permettent de choisir une devise supplémentaire créée par programmation avec la fonction [eInitDevise](../WDLang1/3033003.md).

Remarques :

- La devise &lt;Défaut&gt; correspond par défaut à l'Euro. Cette devise par défaut pourra être connue et modifiée par programmation grâce à la fonction [eDeviseAffParDéfaut](../WDLang1/3033009.md).

- Le libellé de la devise affichée sera présent à côté de la valeur si le signe $ est spécifié dans le masque d'affichage. Par exemple : "$ 999,99" affichera par exemple pour des francs : F 945,00.






<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Bulle d'aide
<a name="bulle_aide_ELTTEXTE000451"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Présentation
<a name="presentation_ELTPARAGRAPHE000166"></a>

Une bulle d'aide peut être affichée automatiquement en survol des champs de saisie (ou des colonnes de table) pour afficher la valeur saisie dans une monnaie différente.
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=type_monetaire_euro%20-%20HC%20N%B0002%203.gif)


Exemple :
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Eurobulle.gif)

<a name="NOTE4_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Règles de conversion dans la bulle d'aide
<a name="regles_conversion_dans_bulle_aide_ELTPARAGRAPHE000181"></a>

La bulle d'aide affiche la valeur du champ convertie :

- Soit dans la devise spécifiée.

- Soit dans la devise mémorisée si la devise de la bulle est la devise par défaut et si la devise mémorisée est différente de la devise affichée.

- Soit en Euro si la devise de la bulle est la devise par défaut et si les devises mémorisée et affichées sont identiques entre elles et différentes de l'Euro.

- Soit en Franc si la devise de la bulle est la devise par défaut et si les devises mémorisée et affichées sont identiques entre elles et correspondent à l' Euro.



<a name="NOTE4_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Paramétrer l'affichage de la bulle d'aide
<a name="parametrer_affichage_bulle_aide_ELTPARAGRAPHE000195"></a>

La devise utilisée pour la bulle d'aide est choisie sous l'éditeur de fenêtres dans les options avancées de l'Euro. Cette devise est sélectionnée dans une liste présentant les différentes devises. Cette liste contient :

- le numéro identifiant la devise,

- l'abréviation de la devise selon la norme ISO,

- le nom du pays concerné par cette devise.




Les quatre dernières devises de cette liste sont des devises utilisateurs : elles permettent de choisir une devise supplémentaire créée par programmation grâce à la fonction [eInitDevise](../WDLang1/3033003.md).

<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Double affichage
<a name="double_affichage_ELTTEXTE000487"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Présentation
<a name="presentation_ELTPARAGRAPHE000215"></a>

Le double affichage permet d'afficher dans deux champs la même valeur exprimée dans des devises différentes. Le vocabulaire suivant est utilisé :

- Champ de base : champ dans lequel la valeur est saisie.

- Champ suiveur : champ affichant la valeur du champ de base dans une autre devise. La valeur affichée dans le champ suiveur reflète en permanence la valeur saisie dans le champ de base.



<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=type_monetaire_euro%20-%20HC%20N%B0002%204.gif)


**Remarques** :

- Si le champ de base est un champ de saisie, le champ suiveur est un champ de saisie.

- Si le champ de base est une colonne de table, le champ suiveur est une autre colonne de la même table.

- Un champ de base peut être le champ suiveur de son propre champ suiveur. Il est alors possible de saisir une valeur indifféremment dans l'un ou l'autre des champs. La mise à jour du champ associé sera automatiquement effectuée.



<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=EuroDoubleaffichage2.gif)


**Exemple**

Le champ "SAI_SAISIE1" permet la saisie en Francs. Il est rattaché à la rubrique "PrixHT". Il a pour champ suiveur le champ "SAI_SAISIE2". Les valeurs saisies dans le champ SAI_SAISIE1 seront automatiquement converties en Euros dans le champ SAI_SAISIE2.

Le champ "SAI_SAISIE2" permet la saisie en Euros. Il a pour champ de double affichage le champ "SAI_SAISIE1". Les valeurs saisies dans le champ "SAI_SAISIE2" seront automatiquement converties en Francs dans le champ "SAI_SAISIE1".

Dans cet exemple, les prix seront enregistrés dans le fichier de données HFSQL uniquement en Francs.
<a name="NOTE5_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Fonctionnement du double affichage pour un champ de saisie
<a name="fonctionnement_double_affichage_pour_champ_saisie_ELTPARAGRAPHE000245"></a>

Un champ de saisie suiveur est mis à jour :

- Lors de la saisie d'une valeur dans le champ de base par l'utilisateur.

- Lors de l'affectation de la valeur du champ de base par programmation.

- Lors de l'utilisation de la fonction [FichierVersEcran](../WDLang4/3044210.md) si le champ suiveur n'est pas relié à une rubrique HFSQL.




**Cas particulier** : La conversion n'est pas réalisée si le champ suiveur est relié à une rubrique d'un fichier de données HFSQL.
<a name="NOTE5_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Fonctionnement du double affichage pour une colonne de table
<a name="fonctionnement_double_affichage_pour_une_colonne_table_ELTPARAGRAPHE000263"></a>

La colonne permettant le double affichage correspond le plus souvent à une colonne calculée : son fonctionnement est identique à celui des colonnes calculées.

Dans le cas d'un champ Table fichier, il est nécessaire d'initialiser la colonne permettant le double affichage dans le code d'affichage d'une ligne du champ Table. Le code utilisé peut être par exemple :


```wl
// -- Affichage d'une ligne de Table
COL_PrixEuro = eVersEuro(COL_PUHT, 1)
```


avec : 

- COL_PrixEuro : nom de la colonne affichant la valeur en Euro.

- COL_PUHT : nom de la colonne liée à une rubrique d'un fichier HFSQL, affichant la valeur en Francs.




La colonne permettant le double affichage est automatiquement mise à jour :

- en cas de modification de la colonne de base par l'utilisateur,

- en cas de modification de la colonne de base par programmation.




**Rappel** : Les fonctions de lecture de fichier de données ou d'affichage d'un fichier de données dans le champ Table n'ont aucune incidence sur une colonne calculée.
<a name="NOTE5_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Configuration avancée
<a name="configuration_avancee_ELTPARAGRAPHE000288"></a>

Dans le cas d'un champ de saisie ou d'une colonne d'un champ Table, le paramètre **"Afficher l'écart d'arrondi dans la barre de message"** est disponible.

Cette option permet d'afficher l'écart d'arrondi lors de la conversion de la valeur entre le champ de base et le champ suiveur. Cet écart d'arrondi sera exprimé dans la devise dont le pouvoir d'expression est le plus faible : pour cette devise, sa plus petite unité a la plus faible valeur. 
Par exemple, 1 centime en Francs Français est plus faible que 1 cent en Euro : la différence sera exprimée en Francs Français.

**Remarque** : La devise de l'écart d'arrondi sera affichée dans le message. Cet écart d'arrondi peut aussi être récupéré grâce à la fonction [eDifférenceArrondi](../WDLang1/3033015.md).
<a name="NOTE5_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Paramétrer le double affichage
<a name="parametrer_double_affichage_ELTPARAGRAPHE000310"></a>Le champ suiveur est sélectionné sous l'éditeur de fenêtres ou l'éditeur d'états dans les caractéristiques du champ. WINDEV propose automatiquement la liste des champs de type "Monétaire + Euro" présents dans la fenêtre ou l'état en cours.


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=CalculatriceEuro.gif) ***Exemples unitaires (WINDEV)*** : **Calculatrice Euro** <br>Manipulation des devises européennes par rapport à l'euro :<br>- Convertir un montant en euros<br>- Convertir un montant en euros dans une monnaie nationale<br>- Réaliser des opérations sur des valeurs monétaires


