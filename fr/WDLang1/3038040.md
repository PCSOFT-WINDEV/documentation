
## DélaiAvantFermeture (Fonction)

***En anglais : DelayBeforeClosing***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Limite le temps d'affichage d'une fenêtre ou d'une boîte de dialogue. 

Si aucune action de l'utilisateur n'est effectuée, lorsque le temps spécifié est écoulé :

- dans le cas d'une fenêtre, le code d'un bouton de la fenêtre sera exécuté. 

- dans le cas d'une boîte de dialogue, la boîte de dialogue est automatiquement fermée. Pour les boîtes de question ou de confirmation, la réponse attendue correspond au bouton par défaut.




Le temps spécifié pour la fermeture automatique n'est plus pris en compte dans les cas suivants :

- si l'utilisateur clique sur un bouton.

- si l'utilisateur modifie un champ.

- si l'utilisateur appuie sur n'importe quelle touche du clavier.




**Remarque** : Les boîtes de dialogue prises en compte sont les suivantes :

- information ou d'erreur (fonction [Info](../WDLang1/3021011.md), [Erreur](../WDLang1/3021013.md), [Avertissement](../WDLang1/3021009.md) du WLangage). 

- question (fonction [OuiNon](../WDLang1/3021005.md), [Dialogue](../WDLang1/3021015.md) du WLangage).

- confirmation (fonction [Confirmer](../WDLang1/3021007.md), [OKAnnuler](../WDLang1/3021004.md) du WLangage).




 Par défaut, les boîtes de dialogue sont bloquantes : tant que ces fenêtres sont ouvertes, l'application est bloquée. 


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Fermeture de la boîte de dialogue dans 2 secondes
DélaiAvantFermeture(200)
Erreur("L'application va se terminer")
FinProgramme()
```


<a name="Exemple2"></a>



```wl
// Exécution du code de BTN_Ferme dans 5 secondes
DélaiAvantFermeture(MaFenêtre, BTN_Ferme, 500)
// Le code du bouton BTN_Ferme appelle la fonction Ferme
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Délai avant fermeture des boîtes de dialogue

`<Résultat> = DélaiAvantFermeture([<Délai>])`
---

**`<Résultat> : (Entier)`**

Temps défini précédemment (avant la modification effectuée par la fonction **DélaiAvantFermeture**).

**`<Délai> : (Entier optionnel ou Durée optionnelle)`**

Nouveau temps avant la fermeture automatique des boîtes de dialogue de l'application (exprimé en centièmes de seconde). Ce paramètre peut correspondre à : 

- un entier correspondant au nombre de centièmes de seconde, 

- une variable de type Durée, 

- l'indication directe de la durée (par exemple 1 s ou 10 ms). 


Si ce paramètre vaut 0 ou est omis, le délai est infini (cas par défaut) : les boîtes de dialogue ne sont pas fermées automatiquement.  


<a name="SYNTAXE2"></a>

### Délai avant fermeture des fenêtres

`<Résultat> = DélaiAvantFermeture(<Nom de la fenêtre> , <Nom du bouton> [, <Délai>])`
---

**`<Résultat> : (Entier)`**

Temps défini précédemment (avant la modification effectuée par la fonction **DélaiAvantFermeture**).

**`<Nom de la fenêtre> : (Chaîne de caractères)`**

Nom de la fenêtre pour laquelle il faut gérer un traitement automatique.

**`<Nom du bouton> : (Chaîne de caractères)`**

Nom du bouton dont le code sera exécuté au bout du délai spécifié. Si la fenêtre doit se fermer, le code du bouton doit contenir la fonction [Ferme](../WDLang1/3038018.md).

**`<Délai> : (Entier optionnel ou Durée optionnelle)`**

Temps avant l'exécution automatique du code de clic sur le bouton spécifié (exprimé en centièmes de seconde). 
Ce paramètre peut correspondre à : 

- un entier correspondant au nombre de centièmes de seconde, 

- une variable de type Durée, 

- l'indication directe de la durée (par exemple 1 s ou 10 ms). 


Si ce paramètre vaut 0 ou est omis, le délai est infini (cas par défaut) : la fenêtre spécifiée ne sera pas automatiquement fermée et le délai précédemment donné est annulé.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Portée de la fonction DélaiAvantFermeture
<a name="portee_fonction_delaiavantfermeture_ELTPARAGRAPHE000139"></a>

- **Boîtes de dialogue** : La fonction **DélaiAvantFermeture** est prise en compte pour toutes les boîtes de dialogue ouvertes par l'application, quel que soit le code où cette fonction est appelée. 
	Pour revenir à un fonctionnement normal, il suffit d'utiliser à nouveau la fonction **DélaiAvantFermeture** sans préciser de durée.

- **Fenêtre** : La fonction **DélaiAvantFermeture** porte uniquement sur la fenêtre spécifiée. Lorsque cette fenêtre est fermée, la fonction est désactivée : si cette fenêtre est à nouveau ouverte (fonction [Ouvre](../WDLang1/3038035.md)), la fenêtre ne sera pas refermée automatiquement. Il faut ré-utiliser la fonction **DélaiAvantFermeture**.






<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
