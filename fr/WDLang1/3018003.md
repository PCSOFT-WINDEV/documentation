


## ArbreSelect (Fonction)

***En anglais : TreeSelect***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie le chemin complet de l'élément sélectionné dans un champ Arbre.

Exemple de champ Arbre :<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Arbre_Vocabulaire.gif)
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Remarque** : La fonction **ArbreSelect** peut être utilisée indifféremment sur :

- un champ Arbre fichier, Arbre par programmation ou Arbre sur variable. 

- un champ Arbre monosélection ou multisélection. Dans le cas des champs Arbre multisélection, il est nécessaire d'utiliser la fonction **ArbreSelect** dans une boucle pour connaître toutes les lignes sélectionnées. 



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Chemin complet de l'élément sélectionné dans le champ Arbre "ARBRE_RecetteTV"
ResChemin = ArbreSelect(ARBRE_RecetteTV)
```
<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
```wl
// Lignes sélectionnées dans un champ Arbre par programmation multisélection
POUR i = 1 _A_ ArbreSelectOccurrence(ARBRE_ARBRE1)
	Trace("Elément sélectionné : " + ArbreSelect(ARBRE_ARBRE1, Faux, i))
FIN

// Équivalent à :
// i est un entier
// POUR TOUTE LIGNE SELECTIONNEE i DE ARBRE_ARBRE1
// 	Trace("Elément sélectionné : " + ArbreSelect(ARBRE_ARBRE1, Faux, i-1))
// FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ArbreSelect(<Champ Arbre> [, <Gestion des doublons> [, <Rang>]])`
---

**`<Résultat> : (Chaîne de caractères)`**

Chemin complet de l'élément sélectionné, de la forme :

```txt
"<Nom de la racine>" + TAB + ["<Nom du 1er noeud>" + TAB + ...
["<Nom du 2ème noeud>" + TAB + [...]]]"<Nom de la feuille>"
```


**`<Champ Arbre> : (Nom de champ)`**

Nom du champ Arbre à manipuler.

**`<Gestion des doublons> : (Booléen optionnel)`**

Mode de gestion des doublons dans les éléments :

- <u><u><u><u>Faux</u></u></u></u> (par défaut) : aucune gestion n'est effectuée.

- <u><u><u><u>Vrai</u></u></u></u> : les noms des éléments du chemin sont construits de manière à contenir leur identifiant. Pour plus de détails, consultez [Gestion des doublons dans les champs Arbre](../WDChamp/1013053.md).




![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre est ignoré.

**`<Rang> : (Entier optionnel)`**

Rang de la sélection dans le cas d'un champ Arbre multisélection. Si ce paramètre n'est pas spécifié, l'indice de la première ligne sélectionnée est renvoyé.
Par exemple, pour récupérer le premier élément sélectionné, &lt;Rang&gt; = 1. 
Pour récupérer le deuxième élément sélectionné, &lt;Rang&gt; = 2, etc.
  
![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Ce paramètre n'est pas supporté.




- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LechampArbre_Treeview_.gif) ***Exemples unitaires (WINDEV)*** : **Le champ Arbre (Treeview)** <br>Utilisation du champ Arbre par programmation grâce aux fonctions Arbre du WLangage.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
