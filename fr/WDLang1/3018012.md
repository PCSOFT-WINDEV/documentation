


## ArbreAjoute (Fonction)

***En anglais : TreeAdd***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute un élément "feuille" (et tous les noeuds nécessaires) dans un champ Arbre.

Exemple de champ Arbre : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Arbre_Vocabulaire.gif)

<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ajout de la feuille "Glace" dans le champ Arbre "ARBRE_RecetteTV"
Res = ArbreAjoute(ARBRE_RecetteTV, "Recettes" + TAB + ...
		"Desserts" + TAB + "Glaces", ...
		aDéfaut, aDéfaut, IDFeuille)
```

```wl
// Initialisation du champ Arbre
ArbreAjoute(ARBRE_Arbre1, "Racine", aDéfaut, aDéfaut, "")
ArbreAjoute(ARBRE_Arbre1, "Racine" + TAB + "Feuille 1", aDéfaut, aDéfaut, "1")
ArbreAjoute(ARBRE_Arbre1, "Racine" + TAB + "Feuille 2", aDéfaut, aDéfaut, "2")
ArbreAjoute(ARBRE_Arbre1, "Racine" + TAB + "Feuille 3", aDéfaut, aDéfaut, "3")
ArbreAjoute(ARBRE_Arbre1, "Racine" + TAB + "Feuille 4", aDéfaut, aDéfaut, "4")
ArbreAjoute(ARBRE_Arbre1, "Racine" + TAB + "Feuille 2" + TAB + ...
		"Sous Feuille 2-1", aDéfaut, aDéfaut, "5")
ArbreAjoute(ARBRE_Arbre1, "Racine" + TAB + "Feuille 2" + TAB + ...
		"Sous Feuille 2-2", aDéfaut, aDéfaut, "6")
ArbreAjoute(ARBRE_Arbre1, "Racine" + TAB + "Feuille 2" + TAB + ...
		"Sous Feuille 2-3", aDéfaut, aDéfaut, "7")
ArbreAjoute(ARBRE_Arbre1, "Racine" + TAB + "Feuille 2" + TAB + ...
		"Sous Feuille 2-4", aDéfaut, aDéfaut, "8")
ArbreAjoute(ARBRE_Arbre1, "Racine" + TAB + "Feuille 2" + TAB + ...
		"Sous Feuille 2-5", aDéfaut, aDéfaut, "9")

// Sélection d'une ligne du champ Arbre
ArbreSelectPlus(ARBRE_Arbre1, "Racine" + TAB + "Feuille 2" + TAB + ...
		"Sous Feuille 2-5")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ArbreAjoute(<Champ Arbre> , <Chemin de la feuille> [, <Image enroulée> [, <Image déroulée> [, <Identifiant de la feuille> [, <Mode d'ajout> [, <Texte de la bulle d'aide>]]]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la feuille a été ajoutée au champ Arbre, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Champ Arbre> : (Nom de champ)`**

Nom du champ Arbre à manipuler.

**`<Chemin de la feuille> : (Chaîne de caractères)`**

Chemin complet de la feuille à ajouter dans le champ Arbre. Ce paramètre est de la forme : 

```txt
"<Nom de la racine>" + TAB + ["<Nom du 1er noeud>" + TAB + ...
["<Nom du 2ème noeud>" + TAB + [...]]]"<Nom de la feuille>"
```
En cas de doublons sur un élément du chemin, ce chemin peut contenir l'identifiant de l'élément (indiqué à la suite du nom de la feuille grâce à la fonction [ArbreID](../WDLang1/3018027.md)).

**`<Image enroulée> : (Chaîne de caractères ou constante optionnelle)`**

Image associée à l'élément. Cette image est affichée lorsque l'élément est un noeud enroulé (voir Remarques). En exécution, le libellé d'un noeud enroulé est précédé du signe "+".

Ce paramètre correspond :

- soit au nom et au chemin complet (ou relatif) de l'image. Un chemin de type UNC peut être utilisé.

- soit à la constante :
	


|   |   |
| --- | --- |
| *aDéfaut*<br>(Valeur par défaut) | Image par défaut (dossier fermé) :![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=imageEnroule.gif)<br> |
| *Null* | Aucune image |






**`<Image déroulée> : (Chaîne de caractères ou constante optionnelle)`**

Image associée à l'élément. Cette image est affichée lorsque l'élément est un noeud déroulé (voir Remarques). En exécution, le libellé d'un noeud déroulé est précédé du signe "-". 

Ce paramètre correspond :

- soit au nom et au chemin complet (ou relatif) de l'image. Un chemin de type UNC peut être utilisé.

- soit à la constante :
	


|   |   |
| --- | --- |
| *aDéfaut*<br>(Valeur par défaut) | Image par défaut (dossier ouvert) : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=imagederoulee.gif)<br> |
| *Null* | Aucune image |






**`<Identifiant de la feuille> : (Chaîne de caractères ou entier (optionnel))`**

Identifiant associé à un élément spécifique du champ Arbre. Par défaut, ce paramètre correspond à une chaîne vide (""). Pour associer un identifiant à un élément déjà créé, utilisez la fonction [ArbreModifie](../WDLang1/3018013.md).

**Attention** : Le caractère de tabulation (TAB) est interdit dans les identifiants des éléments.

**`<Mode d'ajout> : (Constante (ou combinaison de constantes) optionnelle)`**

Position de l'élément (la feuille) ajouté par rapport aux éléments du même niveau dans le champ Arbre.


|   |   |
| --- | --- |
| *aAccepteDoublon* | Les doublons sont acceptés (deux éléments de même niveau peuvent avoir le même nom). La feuille ajoutée est insérée suivant l'ordre alphabétique, parmi les éléments du même niveau. |
| *aDernier* | La feuille est ajoutée à la dernière place du niveau. |
| *aPremier* | La feuille est ajoutée à la première place du niveau. |
| *aTriAlpha*<br>(Valeur par défaut) | La feuille ajoutée est insérée suivant l'ordre alphabétique, parmi les éléments du même niveau. |



**`<Texte de la bulle d'aide> : (Chaîne de caractères optionnelle)`**

Si ce paramètre est précisé, son contenu sera affiché lors du survol de l'élément dans une bulle d'aide. Par défaut, ce paramètre correspond à une chaîne vide (""). Si aucune bulle d'aide n'est associée à l'élément, la bulle d'aide associée au champ Arbre sera automatiquement affichée.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Branche de la feuille
<a name="branche_feuille_ELTPARAGRAPHE000155"></a>Si un des niveaux supérieurs à la feuille ajoutée n'existe pas et n'est pas associé à un identifiant (gestion des doublons), ce niveau est automatiquement créé. Les caractéristiques de ce nouveau niveau (ou branche de l'élément) sont les suivantes :

- image enroulée et image déroulée par défaut (constante *aDéfaut*),

- identifiant égal à *Null*,

- mode d'ajout correspondant à la constante *aDernier*.




Si un des niveaux supérieurs à la feuille est associé à un identifiant et si ce niveau n'existe pas ou n'est pas associé à cet identifiant, une erreur WLangage apparaît. En effet, il est nécessaire de créer tous les niveaux supérieurs avec leurs identifiants respectifs pour pouvoir les manipuler.
<a name="NOTE0_2"></a>


### Ordre de priorité pour le tri
<a name="ordre_priorite_pour_tri_ELTPARAGRAPHE000170"></a>L'ordre de priorité des paramètres du mode d'ajout est le suivant :

- *aPremier*

- *aDernier*

- *aTriAlpha*




Par exemple, dans l'expression *aPremier* + *aDernier* + *aTriAlpha*, seule la constante *aPremier* est prise en compte.
<a name="NOTE0_3"></a>


### Doublons
<a name="doublons_ELTPARAGRAPHE000185"></a>L'acceptation des doublons est à manipuler avec précaution (constante *aAccepteDoublon*). En effet, il est nécessaire de gérer un identifiant spécifique pour identifier le niveau où l'ajout doit être effectué. Pour plus de détails, consultez [Gestion des doublons dans les champs Arbre](../WDChamp/1013053.md).

Si cette gestion n'est pas effectuée, quelques incohérences peuvent survenir.

Par exemple : Si deux "Niveau 2" existent, dans lequel faut-il rajouter "Niveau 3" ? Impossible de trouver quel est le "Niveau 2" à manipuler. Par défaut, l'ajout sera effectué dans le premier élément trouvé.
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=TVDoub.gif)
En cas d'ajout d'un élément déjà existant dans un niveau, la fonction **ArbreAjoute** retourne <u><u><u><u>Faux</u></u></u></u> si le mode d'ajout n'a pas été défini avec la constante *aAccepteDoublon*. L'élément n'est pas ajouté.
<a name="NOTE0_4"></a>


### Format des images enroulées/déroulées
<a name="format_des_images_enrouleesderoulees_ELTPARAGRAPHE000210"></a>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Les formats d'images supportés sous Windows sont :

- Bitmap (\*.BMP)

- Graphics Interchange Format (\*.gif)

- Joint Picture Experts Group (\*.jpg ; \*.jpeg)

- Kodak Photo CD (\*.pcd)

- PaintBrush (\*.pcx)

- Adobe Photoshop Format (\*.psd)

- TrueVision TARGA (\*.tga)

- Tagged Image File Format (\*.tif ; \*.tiff)
	Remarque : l'option "tiff mosaïque" de la norme tiff 6.0 n'est pas supportée. Dans ce cas, il est conseillé d'enregistrer l'image à la norme tiff 5.0. 

- Portable Network Graphics (\*.png)

- Windows MetaFiles (\*.emf ; \*.wmf)

- Icônes (\*.ico ; \*.icw)
	Remarques : 

	- Affichage HQ (Haute Qualité) disponible.

	- Gestion des planches au format BMP transparent (32 bits).




- Curseurs (\*.cur)

- Portable Document Format (\*.pdf)

- Scalable Vector Graphics (\*.svg)

- Images WINDEV (générées par l'éditeur d'images, \*.WDPIC).





### Type des images enroulées/déroulées
<a name="type_des_images_enrouleesderoulees_ELTPARAGRAPHE000222"></a>Les images utilisées peuvent être :

- des fichiers image,

- des rubriques d'un fichier de données HFSQL de type "Mémo Binaire" contenant une image.

- des dessins réalisés à l'aide des [fonctions de manipulation de chaînes graphiques](../WDLang1/3029028.md).




L'image spécifiée est réduite proportionnellement à la taille 16 x 16 pixels : dans la majorité des cas, la hauteur de l'image correspond à la hauteur de la ligne du champ Arbre.
**Remarque** : Il est conseillé d'utiliser des images 16 x 16 pixels (taille des petites icônes).
<a name="NOTE0_5"></a>


### Astuce concernant les images des branches
<a name="astuce_concernant_les_images_des_branches_ELTPARAGRAPHE000247"></a>Attention : Si le nom de l'image ne change pas entre deux appels à la fonction **ArbreAjoute**, l'image n'est pas rechargée en mémoire (même si son contenu a changé).

**Exemple** : Le code suivant crée une image de même nom, avec un contenu différent, et utilise cette image pour chaque appel à la fonction **ArbreAjoute** : dans ce cas, la même image sera toujours utilisée.

```wl
POUR I = 1 A 10
	// Procédure permettant de créer un fichier image de type xx.BMP
	// Le contenu change à chaque itération
	CréerImage(I)
	ArbreAjoute(ARBRE_MonArbre, "xx", "xx.BMP")
FIN
```


**Solution** : Pour utiliser la bonne image, il faut donner un nouveau nom pour chaque nouvelle image créée. Par exemple :

```wl
POUR I = 1 A 10
	// Procédure permettant de créer un fichier image 
	// de type "xx" + I + ".BMP"
	// Le contenu change à chaque itération
	CréerImage(I)
	ArbreAjoute(ARBRE_MonArbre, "xx", "xx" + I + ".BMP")
FIN
```


<a name="XComposante"></a>

## Composante :
wd280obj.dll
