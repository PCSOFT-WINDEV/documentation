


## ComposantCharge (Fonction)

***En anglais : ComponentLoad***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Charge un composant externe. Ce composant peut être : 

- un composant externe présent dans le projet en cours. Dans ce cas le composant externe est chargé en mémoire jusqu'à ce que l'application se termine.

- un composant externe indépendant du projet en cours. Le composant est chargé dans une variable de type [Composant](../WDLang1/1410089120.md). Il est ainsi possible de récupérer une [interface](../POO/6010017.md) globale sur le composant. 




**Remarques** :

- **Composant externe intégré au projet** : Le mode de chargement du composant externe (au lancement du projet, ou à la première utilisation d'un élément du composant) est défini lors de l'intégration du composant dans le projet.

- Lors du chargement du composant, les événements WLangage suivants sont exécutés :

	- Déclaration des classes du composant externe.

	- Déclaration des collections de procédures du composant externe.

	- Initialisation du composant externe.






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Charger le composant externe intégré au projet
ResChargement est un entier
ResChargement = ComposantCharge(MonComposant, "C:\MonApplication")
SELON ResChargement
	CAS cieAbsent :
		Erreur("Le chemin spécifié ne correspond pas au composant externe indiqué")
	CAS cieVersionTropAncienne, cieVersionTropRécente :
		Erreur("La version du composant externe est incompatible avec l'exécutable")
	CAS cieChargé :
		Info("Composant externe chargé")
FIN
```

```wl
// Charment d'un composant
compo est un Composant
SI ComposantCharge(compo, fRepExe() + fSep() + "CompoExemple.wdk") ALORS
	Trace("OK")
	// Exécution des procédures du composant
	Trace(ComposantExécute("ProcéduresGlobales.Test"))
	Trace(ComposantExécute("ProcéduresGlobales.TestAvecParam", (1)))
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Charger un composant externe intégré au projet

`<Résultat> = ComposantCharge(<Nom du composant> [, <Répertoire du composant> [, <Mode de chargement>]])`
---

**`<Résultat> : (Constante de type entier)`**

Compte-rendu du chargement : 



|   |   |
| --- | --- |
| *cieAbsent* | Le composant externe n'est pas présent dans le chemin indiqué. |
| *cieChargé* | Le composant externe s'est chargé correctement et est utilisable. |
| *cieVersionTropAncienne* | La version du composant externe est trop ancienne. Il est incompatible avec l'exécutable en cours. |
| *cieVersionTropRécente* | La version du composant externe est trop récente. Il est incompatible avec l'exécutable en cours. |



**`<Nom du composant> : (Chaîne de caractères)`**

Nom du composant externe (qui apparaît sous l'éditeur) à charger. Si le nom du composant externe n'est pas connu par le projet, une erreur WLangage apparaît.

**`<Répertoire du composant> : (Chaîne de caractères optionnelle)`**

Répertoire du composant externe (fichier WDK) à charger. Ce répertoire peut être terminé indifféremment par "\\" ou non. Un chemin complet, relatif ou de type UNC peut être utilisé.

Si ce paramètre n'est pas précisé, le composant externe sera recherché :

- tout d'abord, dans le répertoire spécifié dans le paramètre &lt;Répertoire du composant&gt; de la fonction [ComposantLocalise](../WDLang1/3064009.md).

- puis, dans le répertoire indiqué dans le fichier "&lt;Nom composant&gt;.INI". Pour plus de détails sur ce fichier, consultez [Déploiement d'une application utilisant un composant externe](../Editeurs/2014004.md).

- enfin, dans le répertoire EXE du projet.




**`<Mode de chargement> : (Constante optionnelle de type Entier)`**

Mode de chargement du composant externe. Correspond à une des constantes suivantes : 



|   |   |
| --- | --- |
| *ccGlobal* | Le composant externe est chargé en global. Par exemple, le même contexte sera utilisé si le composant est chargé par le projet et par un composant du projet. |
| *ccIsolé*<br>(Valeur par défaut) | Le composant externe est isolé. Par exemple, si le composant est chargé par le projet et par un composant du projet, chaque composant utilisera un contexte spécifique. |




<a name="SYNTAXE2"></a>

### Charger un composant externe indépendant du projet en cours

`<Résultat> = ComposantCharge(<Composant> , <Nom du composant>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le composant a été chargé, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. 




**`<Composant> : (Variable de type Composant)`**

Nom de la variable de type [Composant](../WDLang1/1410089120.md) dans laquelle le composant doit être chargé.

**`<Nom du composant> : (Chaîne de caractères)`**

Chemin complet et nom physique du composant externe à charger (fichier WDK).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Chargement en mémoire d'un composant externe intégré au projet
<a name="chargement_memoire_composant_externe_integre_projet_ELTPARAGRAPHE000168"></a>Le mode de chargement du composant externe (au lancement du projet, ou à la première utilisation d'un élément du composant) est défini lors de l'intégration du composant dans le projet.

Pour modifier ce mode de chargement :

1. Affichez la liste des composants externes importés dans le projet : 

	- Dans le volet "Explorateur de projet", sélectionnez le dossier "Composants externes". 

	- Affichez le menu contextuel du dossier et sélectionnez l'option "Liste des composants externes importés dans le projet".




2. Sélectionnez le composant voulu et cliquez sur le bouton "Description".

3. Modifiez le mode de chargement (option "Mode de chargement du composant").




**Rappel** : Lors du chargement d'un composant, les événements WLangage suivants sont exécutés :

- Déclaration des classes du composant externe.

- Déclaration des collections de procédures du composant externe.

- Initialisation du composant externe.



<a name="NOTE0_2"></a>


### Chargement d'un composant externe indépendant du projet
<a name="chargement_composant_externe_independant_projet_ELTPARAGRAPHE000194"></a>La fonction **ComposantCharge** ne provoque pas d'erreur fatale. La fonction renvoie <u><u><u><u>Faux</u></u></u></u> dans les cas suivants : 

- le composant n'est pas trouvé. 

- il y a une tentative de remplacement du composant chargé par un autre composant.  




<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280vm.dll
