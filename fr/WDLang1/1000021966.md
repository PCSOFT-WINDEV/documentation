


## TableAjoutEnCours (Fonction)

***En anglais : TableAddInProgress***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie ou renvoie l'état de visibilité de la fenêtre interne de patience lors de l'ajout d'éléments supplémentaires dans un champ Table infinie.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Evénement "Ajout d'éléments supplémentaires"
TableAjoutEnCours(TABLE_TableInfinie, Vrai)
ThreadExécute("ThreadRemplissage", threadNormal, maProcRecupResultatSuppl)

PROCEDURE INTERNE maProcRecupResultatSuppl()
	REQ_PlusDeDonnées.IDMin = TABLE_TableInfinie[TABLE_TableInfinie.Occurrence].ID
	HExécuteRequête(REQ_PlusDeDonnées)
	HLitPremier(REQ_PlusDeDonnées)
	tabLignes est un tableau de chaînes
	TANTQUE PAS HEnDehors(REQ_PlusDeDonnées)
		Ajoute(tabLignes, REQ_PlusDeDonnées.Titre + TAB + REQ_PlusDeDonnées.IDArticle)
		HLitSuivant(REQ_PlusDeDonnées)
	FIN	
	ExécuteThreadPrincipal(ProcAjoutDansTable)
	PROCEDURE INTERNE ProcAjoutDansTable()
		POUR TOUTE sLigne DE tabLignes
			TableAjoute(TABLE_TableInfinie, sLigne)
		FIN
		TableAjoutEnCours(TABLE_TableInfinie, Faux)
	FIN
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Modifier l'état de visibilité de la fenêtre interne de patience

`TableAjoutEnCours(<Champ Table> , <Visible>)`
---

**`<Champ Table> : (Nom de champ)`**

Nom du champ Table à manipuler.

**`<Visible> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> pour afficher la fenêtre interne de patience,

- <u><u><u><u>Faux</u></u></u></u> pour la masquer.





<a name="SYNTAXE2"></a>

### Récupérer l'état de visibilité de la fenêtre interne de patience

`<Résultat> = TableAjoutEnCours(<Champ Table>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la fenêtre interne de patience est affichée,

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Champ Table> : (Nom de champ)`**

Nom du champ Table à manipuler.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Lors de l'utilisation d'un champ Table infinie, une fenêtre interne de patience (contenant un champ Jauge) est affichée au-dessus des lignes du champ Table pendant l'ajout des données supplémentaires dans le champ. Cette fenêtre de patience est masquée à la fin de l'exécution de l'événement "Ajout d'éléments supplémentaires". 

- La fonction **TableAjoutEnCours** permet par exemple de contrôler l'affichage de la fenêtre de patience lorsque l'actualisation des données du champ Table est effectuée dans un thread secondaire. Il est ainsi possible d'éviter de figer l'application (l'exemple utilise cette méthode).

- Lorsque la fenêtre de patience est rendue visible par la fonction **TableAjoutEnCours**, l'événement "Ajout d'éléments supplémentaires" du champ Table n'est pas exécuté.

- Pour masquer le bandeau de rafraîchissement, il est nécessaire d'appeler le code : 
	
	```txt
	TableAjoutEncours(<Champ Table>, Faux)
	```
 autant de fois que le code 
	
	```txt
	TableAjoutEncours(<Champ Table>, Vrai)
	```
 a été exécuté.




<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
