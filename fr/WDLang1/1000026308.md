


## &lt;Editeur HTML&gt;.VersEmail (Fonction)

***En anglais : &lt;HTML editor&gt;.ToEmail***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Exporte le contenu d'un champ Editeur HTML vers une variable de type Email (pour envoyer l'email).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
MonMessage est un Email
EDHTML_MonEditeurHTML.VersEmail(MonMessage)
MonMessage.Destinataire = "flop-fr@gmail.com"
MonMessage.Sujet = "Test"
EmailEnvoieMessage(MaSession, MonMessage, emailOptionEncodeEntête)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Champ Editeur HTML>.VersEmail(<Email> [, <Option>])`
---

**`<Champ Editeur HTML> : (Nom de champ)`**

Nom du champ Editeur HTML manipulé.

**`<Email> : (Variable de type Email)`**

Nom de la variable de type [Email](../WDLang3/1000018713.md) dans laquelle le document HTML présent dans le champ Editeur HTML doit être importé. Si ce paramètre n'est pas spécifié ou correspond à une chaîne vide (""), la structure [Email](../WDLang3/3032029.md) est utilisée.
 
Remarque : La propriété **HTML** de la variable  de type [Email](../WDLang3/1000018713.md) (ou la variable **Email.HTML** de la structure [Email](../WDLang3/3032029.md)) est automatiquement affectée avec le HTML contenu dans le champ Editeur HTML. Les caractères sont encodés en UTF8 et le charset correspondant est inséré.

**`<Option> : (Constante optionnelle de type Entier)`**

Options d'exportation, valables uniquement dans le cas d'utilisation de la structure Email : 


|   |   |
| --- | --- |
| *emailOptionDéfaut*<br>(Valeur par défaut) | Un identifiant unique est généré pour identifier chaque image contenue dans le fichier HTML. **Cet identifiant est unique quelque soit le fichier HTML exporté**.<br><br>Fonctionnement par défaut. |
| *emailOptionSansCID* | Un identifiant est généré pour les images contenues dans le fichier HTML. **Cet identifiant n'est pas unique. Si plusieurs fichiers HTML sont exportés, ils peuvent utiliser les mêmes identifiants d'images**. |





<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
