


## &lt;Editeur HTML&gt;.ExécuteJS (Fonction)

***En anglais : &lt;HTML editor&gt;.ExecuteJS***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Exécute du code Javascript dans un champ Editeur HTML.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Récupère le nombre d'images dans le document en cours d'édition
EDHTML_MonEditeurHTML.ExécuteJS("document.body.images.length", ...
			EditeurHTMLExécuteJS_Callback)
PROCEDURE INTERNE EditeurHTMLExécuteJS_Callback(OK est un booléen, LeRésultat est une chaîne)
	dbgAssertion(OK)
	Info("Il y a " + LeRésultat + " images dans le document.") 
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Champ Editeur HTML>.ExécuteJS(<Code Javascript> [, <Procédure WLangage>])`
---

**`<Champ Editeur HTML> : (Nom de champ)`**

Nom du champ Editeur HTML manipulé.

**`<Code Javascript> : (Chaîne de caractères)`**

Code Javascript à exécuter.

**`<Procédure WLangage> : (Nom de procédure optionnel)`**

Procédure WLangage (également nommée "callback") permettant de connaître le résultat de l'exécution du code Javascript. Cette procédure est de la forme : 

```txt
PROCEDURE <Nom de la procédure>(bSuccès est un booléen, ValeurRetour est une chaîne)
```
Cette procédure est appelée une fois l'exécution du code Javascript terminée. Les paramètres de cette procédure sont : 

- &lt;bSuccès&gt; : 

	- <u><u><u><u>Vrai</u></u></u></u> si l'exécution du code Javascript s'est correctement terminée, 

	- <u><u><u><u>Faux</u></u></u></u> si l'exécution du code Javascript s'est terminée en erreur (erreur dans le code Javascript par exemple). Dans ce cas, il est possible d'obtenir le détail de l'erreur grâce à la fonction [ErreurInfo](../WDLang1/3013008.md). 
			




- &lt;ValeurRetour&gt; contient la valeur de la dernière expression de l'exécution du code Javascript (valeur retournée).






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
Le code Javascript est exécuté dans le contexte du document en cours d'édition : "document" représente le document édité.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
