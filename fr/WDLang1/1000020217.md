


## &lt;Zone multiligne&gt;.InsèreLigne (Fonction)

***En anglais : &lt;Multiline zone&gt;.InsertLine***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Insère une nouvelle ligne dynamique dans un champ Zone multiligne. Cette ligne est ajoutée à la position indiquée dans la zone des lignes dynamiques.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ajout d'un réseau
nLigne est un entier = 4
ZM_Réseau.InsèreLigne(nLigne)
ZM_Réseau[nLigne].LIB_NomReseau = "Réseau"
ZM_Réseau[nLigne].IMG_Disponible.Visible = Vrai
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Champ Zone multiligne>.InsèreLigne(<Position>)`
---

**`<Champ Zone multiligne> : (Nom de champ)`**

Nom du champ Zone multiligne à manipuler.

**`<Position> : (Entier)`**

Indice de la ligne à ajouter. 
L'indice "1" correspond à la première ligne du champ Zone multiligne. Toutes les lignes sont numérotées (lignes statiques et lignes dynamiques). 
Si le champ Zone multiligne contient des lignes statiques et des lignes dynamiques, il est nécessaire de prendre en compte le nombre de lignes statiques.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Caractéristiques de la ligne dynamique insérée
<a name="caracteristiques_ligne_dynamique_inseree_ELTPARAGRAPHE000191"></a>

- Par défaut, la ligne dynamique insérée est vide. 

- Pour personnaliser la ligne (libellé, couleur, visibilité d'éléments, ...), il faut modifier les champs avec la syntaxe suivante : 
	
	```txt
	<Champ Zone multiligne>[<Indice>].<Nom du champ>.<Propriété> = <Valeur>
	```

	Par exemple : 
	
	```wl
	ZM_Produits.InsèreLigne(nLigne)
	ZM_Produits[nLigne].LIB_NomProdLigne = stLigne.sLibProd
	ZM_Produits[nLigne].LIB_NomProdLigne.Couleur = BleuClair
	ZM_Produits[nLigne].SAI_QteLigne = stLigne.nQuantite
	```


- Par défaut, la ligne insérée n'est pas sélectionnée. Pour sélectionner la ligne ajoutée, il suffit d'affecter la valeur de l'indice de la ligne du champ Zone multiligne. 
	Par exemple : 
	
	```wl
	ZM_Produits.InsèreLigne(nLigne)
	ZM_Produits = nLigne
	```
ou
	```wl
	ZM_Produits.InsèreLigne(nLigne)
	ZM_Produits.Valeur = nLigne
	```


- Lors de l'ajout de la ligne dynamique, les traitements d'initialisation des champs présents dans la ligne sont exécutés. 

- La taille du champ Zone multiligne est modifiée pour prendre en compte la ligne insérée : le champ s'agrandit vers le bas. Si des champs sont situés sous le champ Zone multiligne, ils sont déplacés vers le bas. La hauteur utile de la fenêtre est agrandie en conséquence : il est possible de faire défiler la fenêtre avec le doigt pour voir le bas du champ Zone multiligne et les champs éventuellement présents en dessous de cette zone.



<a name="NOTE0_2"></a>


### Cas d'erreur
<a name="cas_erreur_ELTPARAGRAPHE000232"></a>Une erreur apparaît dans les cas suivants : 

- aucune ligne dynamique n'a été définie dans le champ Zone multiligne. 

- plus de 300 lignes dynamiques existent dans le champ Zone multiligne.

- un des événements d'initialisation des champs de la ligne entraîne une erreur.





