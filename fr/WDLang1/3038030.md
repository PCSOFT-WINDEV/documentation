
## FenEtat (Fonction)

***En anglais : WinStatus***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Identifie ou modifie l'état d'une fenêtre.

**Remarque** : La fonction **FenEtat** permet également de tester l'existence d'une fenêtre.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Identification de l'état de la fenêtre en cours
ResFenEtat = FenEtat()
```


<a name="Exemple2"></a>



```wl
// Modification de l'état d'une fenêtre
SELON FenEtat(FEN_NomFenêtre)
	CAS Actif
		FenEtat(FEN_NomFenêtre, Grisé)
	CAS Inexistant
		Ouvre(FEN_NomFenêtre)
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Identifier l'état d'une fenêtre

`<Résultat> = FenEtat([<Fenêtre manipulée>])`
---

**`<Résultat> : (Constante)`**

Etat actuel de la fenêtre :


|   |   |
| --- | --- |
| *Actif* | Fenêtre active (fenêtre en saisie, même si elle n'a pas le focus). |
| *AffichageSeulement* | Fenêtre inactive (cette fenêtre n'est pas en saisie). |
| *Grisé* | Les champs de la fenêtre sont grisés. |
| *HorsEcran* | Fenêtre active mais présente en dehors de la zone visible de l'écran.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |
| *Inexistant* | Fenêtre fermée ou inexistante. |
| *Invisible* | Fenêtre invisible à l'écran et inactive. |



**`<Fenêtre manipulée> : (Nom de fenêtre optionnel ou chaîne de caractères optionnelle)`**

Nom ou alias de la fenêtre à manipuler. 
Si ce paramètre n'est pas précisé ou correspond à une chaîne vide (""), l'état de la fenêtre en cours est retourné.  


<a name="SYNTAXE2"></a>

### Modifier l'état d'une fenêtre

`<Résultat> = FenEtat(<Fenêtre manipulée> , <Etat de la fenêtre>)`
---

**`<Résultat> : (Constante)`**

Etat après modification :


|   |   |
| --- | --- |
| *Actif* | Fenêtre active (fenêtre en saisie). |
| *AffichageSeulement* | Fenêtre inactive (cette fenêtre n'est pas en saisie). |
| *Grisé* | Les champs de la fenêtre sont grisés. |
| *HorsEcran* | Fenêtre active mais présente en dehors de la zone visible de l'écran.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |
| *Inexistant* | Fenêtre fermée ou inexistante. |
| *Invisible* | Fenêtre invisible à l'écran et inactive.<br><br> |



**`<Fenêtre manipulée> : (Nom de fenêtre ou chaîne de caractères)`**

Nom ou alias de la fenêtre à manipuler. 
Si ce paramètre correspond à une chaîne vide (""), l'état de la fenêtre en cours est modifié.

**`<Etat de la fenêtre> : (Constante)`**

Indique le nouvel état et le nouveau positionnement de la fenêtre spécifiée. 
Si ce paramètre correspond à une chaîne vide (""), le changement de position (constante *Dessus*, *DessusTout*, *Normal*) d'une fenêtre est annulé.


|   |   |
| --- | --- |
| *Actif* | La fenêtre devient active (fenêtre en saisie). |
| *ActifDevant* | La fenêtre devient active (fenêtre en saisie) et mise en avant plan. Cette constante correspond au résultat d'un clic sur la barre de titre de la fenêtre.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |
| *AffichageSeulement* | La fenêtre devient inactive (aucun champ de la fenêtre ne permet la saisie). |
| *Dessus* | La fenêtre passe en premier plan par rapport aux autres fenêtres de l'application.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |
| *DessusTout* | La fenêtre passe en premier plan par rapport à toutes les autres fenêtres, même celles des autres applications. Cette constante est ignorée dans le cas des fenêtres filles MDI affichées à partir d'une fenêtre mère MDI.<br><br>![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *Grisé* | Les champs de la fenêtre sont grisés. |
| *HorsEcran* | La fenêtre reste active mais elle se positionne en dehors de la zone visible de l'écran.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |
| *Inexistant* | La fenêtre se ferme. Si cette fenêtre n'existe pas, une erreur du WLangage est générée. |
| *Invisible* | La fenêtre devient invisible à l'écran et inactive.<br><br> |
| *Normal* | Une fenêtre en mode *DessusTout* passe en mode normal (les fenêtres des autres applications peuvent à nouveau passer devant). Dans les autres cas, cette constante est sans effet.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Cette constante n'est pas disponible. |







<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Ouverture modale/Ouverture non modale
<a name="ouverture_modaleouverture_non_modale_ELTPARAGRAPHE000228"></a>En ouverture modale (fenêtre mère MDI et fenêtre fille MDI), la fonction **FenEtat** ne peut pas être utilisée :

- pour rendre active une fenêtre mère.

- pour afficher une fenêtre fille "dessus" avec la constante *Dessus* ou *DessusTout* depuis une mère MDI.




En ouverture modale, si une fenêtre mère est rendue invisible, la fenêtre fille est également rendue invisible.

En ouverture non modale, si une fenêtre mère ayant au moins une fenêtre fille est rendue invisible, la ou les fenêtres filles ne sont pas rendues invisibles.


<a name="NOTE0_2"></a>


### Différences entre les constantes Invisible et HorsEcran
<a name="differences_entre_les_constantes_invisible_horsecran_ELTPARAGRAPHE000246"></a>

- Si une fenêtre mère est de type :

	- ***HorsEcran***, cette fenêtre apparaît dans la liste des applications Windows (accessible par la combinaison de touches Alt Tab).

	- ***Invisible***, cette fenêtre n'apparaît pas dans la liste des applications Windows (accessible par la combinaison de touches Alt + Tab).




- Les coordonnées d'une fenêtre de type ***HorsEcran*** sont négatives.

- Le passage de l'état :

	- ***Invisible*** à l'état ***Actif*** déclenche l'exécution des traitements de prise et de perte de focus de manière incohérente.

	- ***HorsEcran*** à l'état ***Actif*** déclenche correctement l'exécution des traitements de prise et de perte de focus.







**Conseil** : Préférez l'état *HorsEcran* à l'état *Invisible*.

- Si une fenêtre qui est de type *HorsEcran* est ré-affichée avec la fonction **FenEtat** et la constante *Actif*, la fonction **FenEtat** ne donne pas le focus à la fenêtre.

- Si la fenêtre de type *HorsEcran* n'avait pas le focus, elle n'a pas le focus après l'utilisation de la fonction **FenEtat**.





<a name="NOTE0_3"></a>


### Fenêtre inactive ou invisible
<a name="fenetre_inactive_invisible_ELTPARAGRAPHE000279"></a>Si la fenêtre en cours devient inactive ou invisible, le traitement de "perte de focus" de la fenêtre sera exécuté avant le changement d'état.




<a name="NOTE0_4"></a>


### Fermeture de la fenêtre
<a name="fermeture_fenetre_ELTPARAGRAPHE000291"></a>Le code suivant permet de fermer la fenêtre : 


```txt
FenEtat(<Nom de la fenêtre>, Inexistant)
```


Ce code est équivalent à la fonction [Ferme](../WDLang1/3038018.md).



<a name="XComposante"></a>

## Composante :
wd280obj.dll
