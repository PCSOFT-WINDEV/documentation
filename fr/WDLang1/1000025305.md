
## ConfirmerAsynchrone (Fonction)

***En anglais : ConfirmAsynchronous***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Affiche un message non bloquant dans une boîte de dialogue standard proposant les réponses "Oui", "Non", "Annuler" et appelle une procédure WLangage avec la réponse de l'utilisateur. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=fonctions_dialogue%20-%20HC%20N%B0005.gif)


Remarques : 

- **Cette boîte de dialogue est non bloquante**. Le code WLangage qui suit l'appel à la fonction **ConfirmerAsynchrone** continue de s'exécuter. Pour fermer la fenêtre, l'utilisateur doit valider un des boutons. Quand l'utilisateur clique sur un des boutons, le code d'une procédure WLangage est exécuté.

- Dans le code WLangage suivant l'appel de la fonction, l'ouverture d'une autre fenêtre modale n'est pas possible avant la fermeture de la boîte de dialogue. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) WINDEV permet d'appliquer le gabarit de votre projet à cette boîte de dialogue. Pour plus de détails, consultez [Personnaliser les boîtes de dialogue](../WDLang1/3021003.md).



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
TitreSuivant("Modification de fiche")
ConfirmerAsynchrone(Oui,"Des modifications ont été apportées à la fiche." + RC + ...
	"Souhaitez-vous les enregistrer avant de sortir de la fiche ?", ...
					TraiteConfirmation)

PROCEDURE INTERNE TraiteConfirmation(nRéponse est un entier)
	SELON nRéponse
		CAS Oui : SauveFiche() // Traitement de sauvegarde
		CAS Non : Ferme()
		CAS Annuler : DonneFocusEtRetourUtilisateur()
	FIN
FIN
```





<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`ConfirmerAsynchrone([<Bouton sélectionné>, ] <Texte> , <Procédure WLangage>)`
---

**`<Bouton sélectionné> : (Constante optionnelle de type entier)`**

Bouton sélectionné par défaut dans la boîte de dialogue :


|   |   |   |
| --- | --- | --- |
| *Annuler* | 2 | sélectionné par défaut. |
| *Non* | 0 | sélectionné par défaut. |
| *Oui*<br>(Valeur par défaut) | 1 | sélectionné par défaut. |



**`<Texte> : (Chaîne de caractères)`**

Texte à afficher.

**`<Procédure WLangage> : (Nom de procédure ou procédure lambda)`**

Nom de la procédure WLangage (appelée "callback") appelée lorsque l'utilisateur clique sur un des boutons de la fenêtre de confirmation. Cette procédure permet de connaître le bouton cliqué et si nécessaire d'effectuer un traitement spécifique. 
 Pour plus de détails sur cette procédure, consultez [Paramètres de la procédure utilisée par la fonction ConfirmerAsynchrone](../WDLang1/1000025427.md).  

Cette procédure WLangage peut correspondre à : 

- un nom de procédure globale ou locale, 

- un nom de procédure interne, 

- une procédure lambda. 






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Caractéristiques de la boîte de dialogue
<a name="caracteristiques_boite_dialogue_ELTPARAGRAPHE000083"></a>

- Le message est cadré à gauche.

- Les libellés des boutons dépendent de la langue d'exécution de Windows (ou du poste Navigateur dans le cas d'un site WEBDEV).

- Le nombre maximum de caractères affichés est limité à 4096. Si une chaîne plus grande est passée en paramètre, elle sera tronquée.

- L'icône affichée (point d'exclamation dans une application WINDEV, point d'interrogation dans une application WEBDEV) ne peut pas être modifiée.




- Le titre de la boîte de dialogue correspond au titre de la fenêtre (ou page) en cours.
	

- Pour modifier ou définir le titre de la boîte de dialogue, utilisez la fonction [TitreSuivant](../WDLang1/3038043.md).




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Pour personnaliser cette boîte de dialogue** (ainsi que toutes les boîtes de dialogue système de votre application), cochez l'option "Personnaliser les fenêtres système (Info, OuiNon, Confirmer, Dialogue)" dans l'onglet "Style" de la description du projet. Pour plus de détails, consultez [Personnaliser les boîtes de dialogue](../WDLang1/3021003.md).
<a name="NOTE0_2"></a>


### Saut de ligne dans la boîte de dialogue
<a name="saut_ligne_dans_boite_dialogue_ELTPARAGRAPHE000097"></a>La chaîne prédéfinie RC (Retour Chariot) peut être utilisée pour forcer le passage à la ligne suivante. Par exemple : 

```wl
ConfirmerAsynchrone("La fiche XXX a été modifiée." + RC + ...
	"Voulez-vous la sauver avant de quitter ?", Procédure_ConfirmerAsynchrone)
```


Il est également possible d'utiliser la syntaxe des chaînes multilignes. Par exemple : 

```wl
ConfirmerAsynchrone(
[
La fiche XXX a été modifiée.

Voulez-vous la sauver avant de quitter ?
], Procédure_ConfirmerAsynchrone)
```

<a name="NOTE0_3"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000110"></a>

- Les timers (fonction [TimerSys](../WDLang1/3015006.md)) ne sont pas stoppés lors de l'appel de cette fonction.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Les événements Windows ne sont pas stoppés lors de l'appel à cette fonction.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) La fonction [DélaiAvantFermeture](../WDLang1/3038040.md) limite le temps d'affichage du message. La boîte de dialogue est automatiquement fermée. Pour les boîtes de question ou de confirmation, la réponse attendue correspond au bouton par défaut.

- Le libellé des boutons s'affiche dans la langue utilisée par Windows sur le poste en cours.



<a name="NOTE0_4"></a>



<a name="XComposante"></a>

## Composante :
wd280obj.dll
