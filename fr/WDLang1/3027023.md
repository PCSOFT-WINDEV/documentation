


## HeureVersChaîne (Fonction)

***En anglais : TimeToString***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Convertit une heure en une chaîne au format spécifié.






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Formater l'heure spécifiée selon le format "HH:MM:SS:CC"
HeureVersChaîne("12005956")   // Renvoie "12:00:59:56"
Gauche(HeureVersChaîne("12005956"), 5) // Renvoie "12:00"
```


<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Formater l'heure spécifiée selon le format "Il est : HH h MM"
HeureVersChaîne(Maintenant(), "Il est : HH h MM") // Renvoie "Il est : 12 h 32"
```


<a name="Exemple3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
DateAujourdhui est une Date = DateSys()
SAI_SaisieDate = DateVersJourEnLettre(DateAujourdhui) + " " + DateAujourdhui.Jour + ...
	" " + DateVersMoisEnLettre(DateAujourdhui) + " à " + ...
	HeureVersChaîne(HeureSys(), "HH:MM:SS")
// Le champ SAI_SaisieDate contient par exemple : Lundi 20 Août à 14:44:17
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = HeureVersChaîne(<Heure à convertir> [, <Format>])`
---

**`<Résultat> : (Chaîne de caractères)`**

Chaîne de caractères au format spécifié.

**`<Heure à convertir> : (Chaîne de caractères, variable de type Heure ou variable de type DateHeure)`**

Heure à manipuler. Cette heure peut correspondre à : 

- une chaîne de caractères au format HHMMSSCC (HH correspond aux heures, MM aux minutes, SS aux secondes et CC aux centièmes de seconde). 

- une chaîne de caractères au format AAAAMMJJHHmmSSCC (AAAA correspond à l'année, MM au mois, JJ au jour, HH aux heures, mm aux minutes, SS aux secondes et CC aux centièmes de seconde). Dans ce cas, seule l'heure est prise en compte. 

- une variable de type Heure. 

- une variable de type DateHeure. Dans ce cas, seule l'heure est prise en compte.




**`<Format> : (Chaîne de caractères optionnelle)`**

Format à appliquer à l'heure. Ce paramètre correspond : 

- soit à une chaîne de caractères (une phrase par exemple). Les caractères spécifiques représentant les différents éléments de l'heure (HH, MM, SS, CC ou AP) seront automatiquement remplacés par leur valeur identifiée dans la chaîne &lt;Heure&gt;. Dans cette chaîne :

	- HH représente le nombre d'heures,

	- MM représente le nombre de minutes,

	- SS représente le nombre de secondes,

	- CC représente le nombre de centièmes de seconde,

	- AP représente "AM" ou "PM" (si "AP" est présent dans le format, l'heure est affichée sur 12 heures).




- soit à la constante *maskHeureSystème*. Cette constante permet d'utiliser directement le masque utilisé par l'heure système. 
	![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible.




Si ce paramètre n'est spécifié, le format du résultat est HH:MM:SS:CC.




<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Validité de l'heure
<a name="validite_heure_ELTPARAGRAPHE000116"></a>La validité de l'heure passée en paramètre est vérifiée. Un message est affiché en cas d'heure invalide. Il est possible de tester la validité d'une heure avec la fonction [HeureValide](../WDLang1/3027021.md).

**Conseil** : Pour avoir une chaîne contenant une heure valide, il faut saisir l'heure dans un champ de saisie de type Heure.
<a name="NOTE0_2"></a>


### Format d'heure
<a name="format_heure_ELTPARAGRAPHE000128"></a>La fonction **HeureVersChaîne** permet de formater une heure retournée par la fonction [EntierVersHeure](../WDLang1/3027006.md) ou la fonction [HeureSys](../WDLang1/3027019.md). Le résultat pourra par exemple être affecté à un champ de type texte.

<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280std.dll
