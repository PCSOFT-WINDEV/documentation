


## TableInsèreColonne (Fonction)

***En anglais : TableInsertColumn***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Insère des éléments sous forme de colonne dans ***un champ Table horizontale***.

**Attention** : Cette fonction ne permet pas d'insérer des colonnes dans un champ Table standard. Pour ajouter dynamiquement des colonnes dans un champ Table standard, utilisez la fonction [ChampClone](../WDLang1/3025017.md).


<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`TableInsèreColonne(<Champ Table> [, <Indice> [, <Élément colonne 1> [... [, <Élément colonne N>]]]])`
---

**`<Champ Table> : (Nom de champ)`**

Nom du champ Table horizontale à manipuler.

Si ce paramètre correspond à une chaîne vide (""), le champ Table manipulé est le champ Table auquel appartient l'événement en cours.

**`<Indice> : (Entier optionnel)`**

Indice de la colonne dans laquelle les éléments doivent être insérés. La première colonne a pour indice 1.


|   |   |
| --- | --- |
| Indice non précisé | La colonne est insérée avant la colonne en cours. Si aucune colonne n'est sélectionnée, la colonne est insérée à la fin du champ Table. |
| Indice supérieur au nombre de colonnes du champ Table | La colonne est insérée à la fin du champ Table. |
| Indice égal à 0 | La colonne est insérée au début du champ Table. |
| Indice égal à -1 | La colonne est insérée avant la colonne en cours. |



**`<Élément colonne 1> : (Type de la colonne associée (optionnel))`**

Premier élément de la colonne à insérer dans le champ Table spécifié. Chaque élément correspond à une ligne du champ Table. Le type de l'élément inséré doit être compatible avec le type de la ligne concernée.
Si aucun de ces paramètres n'est spécifié, une colonne vide est ajoutée dans le champ Table. Pour un champ Table fichier, les valeurs par défaut définies dans le fichier lié sont prises en compte.



**`<Élément colonne N> : (Type de la colonne associée (optionnel))`**

Nième élément de la colonne à insérer dans le champ Table spécifié. Chaque élément correspond à une ligne du champ Table. Le type de l'élément inséré doit être compatible avec le type de la ligne concernée.
Si aucun de ces paramètres n'est spécifié, une colonne vide est ajoutée dans le champ Table. Pour un champ Table fichier, les valeurs par défaut définies dans le fichier lié sont prises en compte.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Caractéristiques des éléments de la colonne
<a name="caracteristiques_des_elements_colonne_ELTPARAGRAPHE000084"></a>

- Pour ne pas spécifier de valeur pour un des éléments, utilisez une chaîne vide ("") ou 0 (selon le type de la ligne).

- Si un élément correspond au résultat d'un calcul, mettez l'expression numérique entre parenthèses. Par exemple :
	
	```wl
	TableInsèreColonne(TABLE_TableCalcul, 3, (53+29), (83-21))
	```




<a name="NOTE0_2"></a>


### Position de la colonne insérée
<a name="position_colonne_inseree_ELTPARAGRAPHE000101"></a>Par défaut, la colonne est insérée à la position indiquée.

- Si le champ Table est trié avec la fonction [TableTrie](../WDLang1/3074035.md), la colonne insérée est positionnée dans le champ Table en fonction du tri en cours, et non de l'indice spécifié.

- Si le champ Table est trié par l'utilisateur, le tri n'est pas pris en compte lors de l'insertion de la colonne. La colonne est insérée à la position indiquée.



<a name="NOTE0_3"></a>


### Limites : Nombre maximum de colonnes affichées
<a name="limites_nombre_maximum_colonnes_affichees_ELTPARAGRAPHE000116"></a>Le nombre maximum de colonnes pouvant être affichées dans un champ Table est limité uniquement par la mémoire vive disponible (maximum théorique : 2 milliards de colonnes).

Il est cependant déconseillé d'utiliser des champs Table importants pour des raisons de performance (temps nécessaire pour remplir le champ par exemple) et d'utilisabilité.
<a name="NOTE0_4"></a>


### Champ Table fichier : Modifications dans le fichier de données lié
<a name="champ_table_fichier_modifications_dans_fichier_donnees_lie_ELTPARAGRAPHE000127"></a>Si la saisie en cascade est activée, le fichier de données lié au champ Table fichier est automatiquement modifié lorsque l'utilisateur passe à la colonne suivante.

Si la saisie en cascade n'est pas activée, le fichier de données lié au champ Table fichier n'est pas modifié. Pour écrire l'enregistrement dans le fichier de données, exécutez la fonction [TableEnregistre](../WDLang1/3074008.md) après la fonction **TableInsèreColonne**.

**Rappel** : L'option "saisie en cascade" peut être sélectionnée :

- Lors de la création d'un champ Table.

- Dans l'onglet "Détail" de la fenêtre de description du champ Table sous l'éditeur de fenêtres.



<a name="NOTE0_5"></a>


### Champ Table fichier : Insertion de plusieurs colonnes
<a name="champ_table_fichier_insertion_plusieurs_colonnes_ELTPARAGRAPHE000149"></a>A chaque appel de la fonction **TableInsèreColonne** dans un champ Table fichier, une colonne virtuelle est créée dans le champ Table. Les informations seront enregistrées dans le fichier de données uniquement lors de l'appel de la fonction [TableEnregistre](../WDLang1/3074008.md).

Si la fonction **TableInsèreColonne** est appelée successivement dans le même traitement sans être suivie de la fonction [TableEnregistre](../WDLang1/3074008.md), seul le PREMIER appel est effectif (les appels suivants sont ignorés). Une seule colonne est ajoutée dans le champ Table fichier.
<a name="NOTE0_6"></a>


### Insertion d'une image
<a name="insertion_une_image_ELTPARAGRAPHE000172"></a>Pour insérer une image dans un champ Table, spécifiez directement le nom et le chemin complet de l'image à insérer.

Par exemple :

```wl
TableInsèreColonne(TABLE_MaTable, 5, "C:\MesDocuments\MonImage.BMP")
```
**Remarque** : Pour afficher correctement l'image insérée, la ligne doit être de type Image.
<a name="NOTE0_7"></a>


### Champ Table en saisie
<a name="champ_table_saisie_ELTPARAGRAPHE000190"></a>Si la fonction **TableInsèreColonne** est appelée :

- Dans un événement du champ, le curseur est automatiquement positionné sur la première ligne à saisir dans la colonne insérée.

- Dans un événement n'appartenant pas au champ (ou dans un autre traitement), utilisez la fonction [DonneFocusEtRetourUtilisateur](../WDLang1/1410088107.md) pour reprendre la saisie dans le champ Table.




<a name="XComposante"></a>

## Composante :
wd280obj.dll
