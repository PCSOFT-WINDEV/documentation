


## TimelineAjouteEvénement (Fonction)

***En anglais : TimelineAddEvent***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute un événement dans un champ TimeLine. 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ajoute un événement de 5 secondes dans un champ TimeLine configuré à la seconde
MaPiste est une chaîne
MonTitre est une chaîne
DébutEvt est un entier
FinEvt est un entier 

MaPiste = "Cordes"
MonTitre = "Début"
DébutEvt = 4
FinEvt = 9

TimeLineAjouteEvénement(TL_Musique, MaPiste, MonTitre, DébutEvt, FinEvt)
```
<a name="Exemple2"></a>

```wl
TimelineSupprimeTout(TL_Automates)
Evt est un EvénementTimeline

TimelineAjoutePiste(TL_Automates, "Automate 1")
Evt.Piste = "Automate 1"
Evt.Titre = "Démarrage"
Evt.Début = 10
Evt.Fin = 150
Evt.CouleurFond = VertClair
TimelineAjouteEvénement(TL_Automates, Evt)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Ajouter un événement en précisant ses caractéristiques

`<Résultat> = TimelineAjouteEvénement(<Champ TimeLine> , <Piste> , <Titre> , <Début> [, <Fin> [, <Catégorie>]])`
---

**`<Résultat> : (Entier)`**



- Indice de l'événement ajouté,

- -1 en cas d'erreur. La fonction [ErreurInfo](../WDLang1/3013008.md) permet d'identifier l'erreur.




**Remarque** : L'événement ajouté peut être manipulé directement grâce à son indice en utilisant la notation suivante : &lt;Champ TimeLine&gt;[&lt;Indice&gt;]. Il est par exemple possible de modifier les propriétés de cet élément.

**`<Champ TimeLine> : (Nom de champ)`**

Nom du champ TimeLine dans lequel l'événement doit être ajouté.

**`<Piste> : (Chaîne de caractères)`**

Nom de la piste associée à l'événement. 

**`<Titre> : (Chaîne de caractères)`**

Titre de l'événement. 

**`<Début> : (Entier)`**

Début de l'événement. Ce paramètre est exprimé dans l'unité choisie pour la résolution d'affichage du champ TimeLine. Si la résolution d'affichage utilisée est la seconde, ce paramètre correspondra à l'horaire de début de l'événement en secondes. 

Remarque : La résolution d'affichage peut être modifiée : 

- dans la fenêtre de description du champ TimeLine (onglet "Détail"). 

- avec la fonction [TimelineChangeMode](../WDLang1/1000020397.md). 




**`<Fin> : (Entier optionnel)`**

Fin de l'événement. Ce paramètre est exprimé dans l'unité choisie pour la résolution d'affichage du champ TimeLine.
Si ce paramètre n'est pas spécifié, la durée par défaut de l'événement sera de 1 unité.

**`<Catégorie> : (Chaîne de caractères optionnelle)`**

Nom de la catégorie associée à l'événement. Si ce paramètre n'est pas spécifié, l'événement n'est associé à aucune catégorie. Si la catégorie n'existe pas, elle est automatiquement créée.


<a name="SYNTAXE2"></a>

### Ajouter un événement dans un champ TimeLine en utilisant le type EvénementTimeline

`<Résultat> = TimelineAjouteEvénement(<Champ TimeLine> , <Evénement>)`
---

**`<Résultat> : (Entier optionnel)`**



- Indice de l'événement ajouté, 

- -1 en cas d'erreur. La fonction [ErreurInfo](../WDLang1/3013008.md) permet d'identifier l'erreur.




**Remarque** : L'événement ajouté peut être manipulé directement grâce à son indice en utilisant la notation suivante : &lt;Nom du champ TimeLine&gt;[&lt;Indice&gt;]. Il est par exemple possible de modifier les propriétés de cet élément. 

**`<Champ TimeLine> : (Nom de champ)`**

Nom du champ TimeLine dans lequel l'événement doit être ajouté. 

**`<Evénement> : (Variable de type EvénementTimeline)`**

Nom de la variable de type [EvénementTimeline](../WDLang1/1000020612.md) décrivant les caractéristiques de l'événement à ajouter.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
La fonction **TimelineAjouteEvénement** permet d'associer un événement à une seule piste. Pour associer le même événement à plusieurs pistes, la fonction **TimelineAjouteEvénement** doit être appelée pour chaque piste.

<a name="XComposante"></a>

## Composante :
wd280mdl.dll
