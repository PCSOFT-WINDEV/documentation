


## Gestion automatique des erreurs
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000290"></a>
La gestion des erreurs peut être personnalisée par traitement.

C'est la fin des fameux "SI ...PAS", "SI ErreurDétectée ...", et autres tests imbriqués qui rendaient le code moins lisible.

Vous pouvez choisir d'utiliser un traitement automatique d'erreur ou opter pour une gestion avancée grâce à différentes fonctions WLangage.

**Important** : La gestion automatique des erreurs et des exceptions fonctionne uniquement pour le traitement pour lequel elle est définie.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Gestion automatique des erreurs
<a name="gestion_automatique_des_erreurs_ELTTEXTE000314"></a>


### Mettre en place la gestion automatique des erreurs
<a name="mettre_place_gestion_automatique_des_erreurs_ELTPARAGRAPHE000024"></a>Pour mettre en place la gestion automatique des erreurs : 

1. Affichez sous l'éditeur de code, l'événement ou le traitement dans lequel les erreurs doivent être traitées : code d'initialisation, code de clic, procédure, ...

2. Dans l'entête du code, cliquez sur "Si Erreur : par programme".
	
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Erreur_auto1.gif&type=thumb)


3. La fenêtre qui s'affiche permet de spécifier le type de traitement automatique à effectuer :
	
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Erreur_auto2.gif&type=thumb)





**Remarques** :

- Le code de gestion de l'erreur présent dans le traitement en cours est prioritaire sur les traitements automatiques dans les deux cas suivants :

	- Test d'une fonction de type "SI PAS xxxx = Vrai ou Faux"

	- Test des erreurs avec la variable [ErreurDétectée](../WDLang1/3087001.md).
			![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Le code de gestion de l'erreur présent dans le traitement en cours n'est pas prioritaire sur les traitements automatiques : le traitement d'erreur du code ET le traitement automatique seront exécutés dans tous les cas.




- Une gestion avancée des erreurs peut être réalisée grâce à la fonction [ErreurChangeParamètre](../WDLang1/3034009.md).



<a name="NOTE2_2"></a>


### Exécuter le traitement d'erreur ("CAS ERREUR:" dans le code)
<a name="executer_traitement_erreur_cas_erreur_dans_code_ELTPARAGRAPHE000057"></a>Si cette option est sélectionnée, une ligne de code est ajoutée dans le code en cours "CAS ERREUR: ". Les lignes de code suivant cette étiquette seront exécutées lorsqu'une erreur sera rencontrée dans les lignes de codes précédentes. Cette option est conseillée pour regrouper par exemple tous les traitements d'erreurs pouvant survenir.

**Remarque** : Si "CAS ERREUR" est directement écrit dans un code, l'option "Exécuter le traitement d'erreur ("CAS ERREUR:" dans le code)" sera automatiquement sélectionnée.
<a name="NOTE2_3"></a>


### Exécuter une procédure de traitement d'erreur
<a name="executer_une_procedure_traitement_erreur_ELTPARAGRAPHE000068"></a>Si cette option est sélectionnée, lorsqu'une erreur sera rencontrée dans le traitement en cours, la procédure indiquée sera automatiquement exécutée pour traiter l'erreur. Cette option est conseillée si vous possédez dans votre application une procédure existante traitant les erreurs. L'appel à cette procédure sera automatique dès qu'une erreur est rencontrée. Aucun test à faire.

Dans cette procédure, il est possible de renvoyer une des constantes présentées dans le tableau ci-dessous.

En fonction de la constante renvoyée, WINDEV, WEBDEV ou WINDEV Mobile effectuera le traitement correspondant.


|   |   |
| --- | --- |
| ***opAnnuler*** | La fonction ayant déclenché l'erreur renvoie une erreur et le code continue à s'exécuter. |
| ***opFinProgramme*** | La fonction ayant déclenché l'erreur renvoie une erreur et le programme s'arrête. Équivalent à une ligne de code de type :<br><br>SI PAS &lt;Fonction&gt; ALORS FinProgramme() |
| ***opFinTraitement*** | La fonction ayant déclenché l'erreur renvoie une erreur et le traitement en cours s'arrête. Équivalent à une ligne de code de type :<br><br>SI PAS &lt;Fonction HFSQL&gt; ALORS DonneFocusEtRetourUtilisateur() |
| ***opRéessayer*** | La fonction ayant déclenché l'erreur est ré-exécutée.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible en Java. |
| ***opRelanceProgramme*** | Termine l'application et relance automatiquement l'application.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |


<a name="NOTE2_4"></a>


### Afficher l'erreur et quitter l'application
<a name="afficher_erreur_quitter_application_ELTPARAGRAPHE000111"></a>Si cette option est sélectionnée, si une erreur est rencontrée dans l'application la fenêtre suivante s'affiche automatiquement :
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Erreur_auto_Fen1.gif)
Dans cette fenêtre, l'utilisateur peut :

- Copier les informations concernant l'erreur dans le presse-papiers (par exemple pour transmettre ces informations au développeur de l'application)

- Arrêter l'application

- Relancer automatiquement l'application après son arrêt. Cette option n'est pas disponible en Java.




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Remarque** : si le composant "Feedback" est intégré à l'application (soit directement, soit par le menu utilitaire ("?") de votre application), l'utilisateur a également la possibilité d'envoyer le rapport d'erreur au fournisseur de l'application. 
<a name="NOTE2_5"></a>


### Afficher l'erreur et retourner en saisie dans la fenêtre courante
<a name="afficher_erreur_retourner_saisie_dans_fenetre_courante_ELTPARAGRAPHE000128"></a>Si cette option est sélectionnée, si une erreur est rencontrée dans l'application la fenêtre suivante s'affiche automatiquement :
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Erreur_auto_Fen2.gif)
Dans cette fenêtre, l'utilisateur peut :

- Copier les informations concernant l'erreur dans le presse-papiers (par exemple pour transmettre ces informations au développeur de l'application)

- Arrêter l'application

- Annuler l'opération : le traitement en cours est annulé. La fenêtre en cours de l'application s'affiche.

- Relancer automatiquement l'application après son arrêt.




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Remarque** : si le composant "Feedback" est intégré à l'application (soit directement, soit par le menu utilitaire ("?") de votre application), l'utilisateur a également la possibilité d'envoyer le rapport d'erreur au fournisseur de l'application. 
<a name="NOTE2_6"></a>


### Afficher l'erreur et laisser l'utilisateur décider
<a name="afficher_erreur_laisser_utilisateur_decider_ELTPARAGRAPHE000146"></a>Si cette option est sélectionnée, si une erreur est rencontrée dans l'application la fenêtre suivante s'affiche automatiquement :
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Erreur_auto_Fen3.gif)
Dans cette fenêtre, l'utilisateur peut :

- Copier les informations concernant l'erreur dans le presse-papiers (par exemple pour transmettre ces informations au développeur de l'application)

- Arrêter l'application

- Annuler l'opération : le traitement en cours est annulé. La fenêtre en cours de l'application s'affiche.

- Ré-essayer l'opération : l'opération qui a provoqué l'erreur sera annulée puis ré-exécutée.

- Relancer automatiquement l'application après son arrêt. Cette option n'est pas disponible en Java.




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **Remarque** : si le composant "Feedback" est intégré à l'application (soit directement, soit par le menu utilitaire ("?") de votre application), l'utilisateur a également la possibilité d'envoyer le rapport d'erreur au fournisseur de l'application. ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette option a le même fonctionnement que l'option "Afficher l'erreur et retourner en saisie dans la fenêtre courante".
<a name="NOTE2_7"></a>


### Sortir de la procédure et renvoyer XXX et afficher l'erreur
<a name="sortir_procedure_renvoyer_xxx_afficher_erreur_ELTPARAGRAPHE000168"></a>Si cette option est sélectionnée, lorsque l'erreur est rencontrée dans le code, le code effectuera automatiquement un RENVOYER XXX, que votre programme pourra traiter.

Les valeurs pouvant être renvoyées sont :

- -1

- 0

- Chaîne vide ("")

- FAUX

- NULL

- VRAI




Il est également possible d'afficher l'erreur.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Personnaliser les fenêtres de gestion automatique des erreurs
<a name="personnaliser_les_fenetres_gestion_automatique_des_erreurs_ELTTEXTE000374"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Par défaut, les fenêtres de gestion des erreurs, des exceptions et des assertions sont intégrées à l'application. Ces fenêtres sont disponibles en français et en anglais. 

Pour personnaliser ces fenêtres (ou pour les traduire dans une autre langue), il suffit d'importer les fenêtres correspondantes dans votre projet :  

1. Sous le volet "Projet", dans le groupe "Projet", déroulez "Importer" et sélectionnez "Des éléments WINDEV et leurs dépendances". 

2. Sélectionnez le répertoire des éléments à importer : "Programmes\\Donnees\\Fenêtres prédéfinies\\Assertion - Erreur - Exception". 

3. Sélectionnez les fenêtres à importer : 
	

| WINDEV | Type de fenêtre |
| --- | --- |
| WD_AfficheAssertion.wdw | Fenêtre de gestion des assertions |
| WD_AfficheErreur.wdw | Fenêtre de gestion des erreurs |
| WD_AfficheException.wdw | Fenêtre de gestion des exceptions |
| WD_ModeleErreur.wdt | Modèle utilisé par les fenêtres WINDEV. |



4. Validez. La ou les fenêtres sont intégrées à votre projet. Ces fenêtres seront automatiquement utilisées et remplaceront les fenêtres par défaut. 




**Remarque** : Pour utiliser les fenêtres par défaut, il suffit de supprimer les fenêtres importées de votre projet. 

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Fonctions de gestion automatique des erreurs
<a name="fonctions_gestion_automatique_des_erreurs_ELTTEXTE000398"></a>
Les fonctions de gestion automatique des erreurs sont les suivantes : 



|   |   |
| --- | --- |
| [ErreurChangeParamètre](../WDLang1/3034009.md) | Paramètre le comportement automatique à adopter en cas d'erreur dans le traitement en cours. |
| [ErreurDéclenche](../WDLang1/3034011.md) | Déclenche une erreur non fatale. |
| [ErreurInfo](../WDLang1/3013008.md) | Récupère des informations sur la dernière erreur d'une fonction d'une composante de WINDEV, WINDEV Mobile ou de WEBDEV. |
| [ErreurPropage](../WDLang1/3034015.md) | Propage une erreur non fatale qui pourra être traitée par le code appelant, si ce code a activé une gestion des erreurs non fatales (sous l'éditeur de code, ou par la fonction [ErreurChangeParamètre](../WDLang1/3034009.md)). |
| [ErreurRestaureParamètre](../WDLang1/3034012.md) | Rétablit le traitement d'erreur d'un traitement. |






- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDGestionAutoErreurs.gif) ***Exemples didactiques (WINDEV)*** : **WD Gestion Auto Erreurs** <br>L'exemple "WD Gestion Auto Erreurs" est un exemple didactique sur la gestion automatique des erreurs.<br>Cet exemple montre le cas des erreurs fatales, non fatales, sur plusieurs niveaux.
- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDGestiondeserreursJava.gif) ***Exemples didactiques (WINDEV)*** : **WD Gestion des erreurs Java** <br>Avec WINDEV, vous développez des applications Java belles et fonctionnelles et sans avoir besoin de connaître le langage Java.<br>Vous bénéficiez de la puissance de l'environnement de WINDEV, et aussi de tout ses automatismes.<br>Un de ces automatismes très apprécié est la gestion automatique des erreurs.<br>Cet exemple didactique permet de comprendre le fonctionnement et la mise en œuvre du mécanisme de gestion des erreurs de WINDEV.<br>Des illustrations concrètes permettent de comprendre et de constater la simplification réalisée lors de la mise en œuvre de cette fonctionnalité. <br>Ce projet est configuré pour générer une archive Java.


