
## ConstruitTableFichier (Fonction)

***En anglais : BuildBrowsingTable***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Crée un champ Table à partir des rubriques présentes dans un fichier de données (une vue ou une requête). Chaque colonne du champ est associée à une rubrique du fichier de données. La largeur des colonnes est automatiquement adaptée en fonction des données présentes dans le fichier ou la requête.

Cette fonction permet d'obtenir un champ Table adapté au parcours d'un fichier de données spécifique.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003074002&name=construittablefichier_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Affiche le contenu du fichier "CLIENTS" dans un champ Table fichier 
ConstruitTableFichier(TABLE_TABLE1, "CLIENTS", taAvecIDAuto)
```


<a name="Exemple2"></a>

```wl
// Affiche le contenu d'une requête dans un champ Table par programmation
SI HExécuteRequête(REQ_LISTE_CLIENTS_ACTIFS) = Vrai ALORS
	ConstruitTableFichier(TABLE_CLIENTS, ...
			REQ_LISTE_CLIENTS_ACTIFS, taRemplirTable)
FIN
```





<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`ConstruitTableFichier(<Champ Table> , <Fichier de données> [, <Options>])`
---

**`<Champ Table> : (Nom de champ)`**

Nom du champ Table (Table fichier ou Table par programmation). 

Attention : Ce champ doit exister dans la fenêtre. Il peut avoir été créé avec la fonction [ChampCrée](../WDLang1/1000020876.md).

Si ce paramètre correspond à un champ Table fichier, les enregistrements du fichier de données sont directement visualisés.

**`<Fichier de données> : (Chaîne de caractères)`**

Nom du fichier de données, de la vue ou de la requête servant de base à la création du champ Table.

**`<Options> : (Constante (optionnelle) ou combinaison de constantes)`**

Paramètre le mode de création des colonnes du champ Table.

|   | Fonctionnement avec la constante | Fonctionnement par défaut |
| --- | --- | --- |
| *taAvecBinaire* | Les rubriques de type binaire (clé composée de liaison par exemple) sont ajoutées dans le champ Table. | Par défaut : Les rubriques de type binaire (clé composée de liaison par exemple) ne sont pas ajoutées dans le champ Table. |
| *taAvecIDAuto* | Une colonne est générée pour l'identifiant automatique. | Par défaut : Pas de colonne pour l'identifiant automatique. |
| *taAvecLiaisonDétail* | Une sous-table est automatiquement générée pour afficher les rubriques des fichiers de données liés dans l'analyse. | Par défaut : Aucune fenêtre "détail d'une ligne" n'est affichée. <br><br> |
| *taGardeCléParcours* | La clé de parcours du champ Table fichier n'est pas modifiée (cette clé de parcours est connue grâce à la propriété [RubriqueParcourue](../Proprietes/2510111.md)). | Par défaut : La première rubrique clé rencontrée est positionnée comme clé de parcours. |
| *taGardeColonne* | Les colonnes existantes du champ Table ne sont pas supprimées. | Par défaut : Les colonnes existantes sont supprimées. |
| *taLibelléRubrique* | Utilise les libellés des rubriques pour les titres des colonnes. | Par défaut : Utilise le nom de la rubrique en titre de colonnes. |
| *taParOrdreLogique* | Les colonnes sont créées selon l'ordre logique des rubriques défini sous l'éditeur d'analyses.<br>Pour les requêtes, l'ordre logique et physique des rubriques est identique. | Par défaut : L'ordre physique des rubriques dans le fichier de données est utilisé.<br>Pour les requêtes, l'ordre logique et physique des rubriques est identique. |
| *taRemplirTable* | Un champ Table par programmation sera rempli avec le contenu du fichier de données (Attention : opération longue pouvant saturer la mémoire). | Par défaut : Pas de remplissage des champs Table par programmation. |
| *taSaisieIDAuto* | Saisie autorisée dans la colonne associée à l'identifiant automatique (si elle existe et si le champ Table est en saisie). |   |
| *taSansAjuste* | La largeur des colonnes n'est pas ajustée (pas de lecture des enregistrements). |   |
| *taSansMémoTexte* | Les rubriques de type 'mémo texte' ne sont pas ajoutées dans le champ Table. | Par défaut : Les rubriques de type 'mémo texte' sont ajoutées dans le champ Table. |
| *taSansMémoImage* | Les rubriques de type 'mémo image' ne sont pas ajoutées dans le champ Table. | Par défaut : Les rubriques de type 'mémo image' sont ajoutées dans le champ Table. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Caractéristiques du champ Table (par défaut)
<a name="caracteristiques_champ_table_par_defaut_ELTPARAGRAPHE000142"></a>

- Les colonnes du champ Table définies sous l'éditeur sont supprimées.

- Les modes de saisie définis sous l'éditeur pour le champ Table sont conservés.

- Pour chaque rubrique du fichier de données, une colonne du type de la rubrique est créée.

- Aucune colonne n'est créée pour les rubriques de type mémo binaire (une colonne est créée pour les rubriques de type mémo texte ou mémo image).

- Les propriétés du champ Table et des colonnes sont mises à jour pour permettre le parcours du fichier de données :
	
	```txt
	<Champ Table>.FichierParcouru = <Nom du fichier de données>
	```

	et pour chaque colonne :
	
	```txt
	<Nom Colonne>.LiaisonFichier = <Nom de la rubrique associée>
	<Nom Colonne>.RubriqueParcourue = <Première clé du fichier de donnée>
	```






<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Champ Table par programmation
<a name="champ_table_par_programmation_ELTPARAGRAPHE000162"></a>Si le paramètre &lt;Champ Table&gt; correspond à un champ Table par programmation, aucune donnée n'est affichée (le champ Table est vide) mais les propriétés du champ Table et des colonnes sont affectées comme pour un champ Table fichier.

Pour afficher des données dans le champ Table, il faut alors utiliser la fonction [TableAjoute](../WDLang1/3074017.md) ou la fonction **ConstruitTableFichier** avec la constante *taRemplirTable*.

**Remarque** : La constante *taRemplirTable* ne permet pas de remplir un champ Table par programmation avec des mémos image. Pour ajouter une image dans un champ Table par programmation, le fichier correspondant doit être présent dans la bibliothèque de l'application (fichier WDL) ou accessible depuis le poste en cours.
<a name="NOTE0_3"></a>




### Colonnes
<a name="colonnes_ELTPARAGRAPHE000180"></a>Les colonnes créées portent les noms "_COL1", "_COL2", "_COL3", etc. Ces colonnes sont accessibles par programmation via l'opérateur d'indirection { }.

**Il n'est pas possible d'écrire** :


```wl
TABLE_TABLE1._COL1.Largeur = 120 // Génère une erreur "_COL1 inconnu"
```


Il faut écrire :


```wl
{"TABLE_TABLE1._COL1"}..Largeur = 120
```



<a name="NOTE0_4"></a>




### Divers
<a name="divers_ELTPARAGRAPHE000197"></a>

- La fonction **ConstruitTableFichier** effectue un parcours dans le fichier de données. L'enregistrement en cours risque d'être modifié après l'utilisation de cette fonction.

- Le remplissage de la table par la fonction **ConstruitTableFichier** est réalisé dans un processus parallèle en arrière-plan : si la source de données est une requête, il ne faut pas libérer cette requête avant la fermeture de la fenêtre ou la réinitialisation du champ Table.






<a name="XComposante"></a>

## Composante :
wd280obj.dll
