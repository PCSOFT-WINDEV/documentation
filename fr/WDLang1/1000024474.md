


## TableEnrouleDéroule (Fonction)

***En anglais : TableCollapseExpand***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Enroule ou déroule un élément d'un champ Table ou Table hiérarchique.

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Champ Table hiérarchique : 

- Enroule la branche si elle est déroulée. Les noeuds "fils" ne sont alors plus visibles dans le champ Table hiérarchique. Les noeuds fils restent dans leur état (enroulé ou déroulé).

- Déroule la branche si elle est enroulée. Les noeuds "fils" sont alors visibles dans le champ Table hiérarchique.




Champ Table : 

- Enroule la rupture si elle est déroulée. Les éléments de la rupture ne sont plus visibles dans le champ Table.

- Déroule la rupture si elle est enroulée. Les éléments de la rupture sont alors visibles dans le champ Table.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) enroule ou déroule une fenêtre de détail affichée pour une ligne (Pour plus de détails, consultez [Gérer le détail d'une ligne d'un champ Table](../WDChamp/1013200.md)) :

	- Enroule la fenêtre si elle est déroulée.

	- Déroule la fenêtre si elle est enroulée.






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Enroule ou déroule la branche sélectionnée dans le champ Table hiérarchique 
SELON TableEnrouleDéroule(TABLEH_Planning)
	CAS taEnroule
	Info(" La branche a été déroulée. ")
	CAS taDéroule
	Info(" La branche a été enroulée. ")
	CAS taErreur
	Info(" La branche n'existe pas. ")
FIN
```
<a name="Exemple2"></a>

```wl
// Enroule ou déroule la branche de la première ligne du champ Table hiérarchique "TABLEH_Planning"
TableEnrouleDéroule(TABLEH_Planning, 1)
```
<a name="Exemple3"></a>

```wl
// Enroule ou déroule la branche spécifiée dans le champ Table hiérarchique
TableEnrouleDéroule(TABLEH_Planning, "MaRacine" + TAB + "MaBranche")
```
<a name="Exemple4"></a>

```wl
// Enroule ou déroule la rupture de la ligne en cours dans le champ Table "TABLE_Rupture"
TableEnrouleDéroule(TABLE_Rupture, TABLE_Rupture)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Table hiérarchique : Enrouler ou dérouler une branche en spécifiant le numéro de la ligne

`<Résultat> = TableEnrouleDéroule(<Champ Table hiérarchique> [, <Ligne manipulée>])`
---

**`<Résultat> : (Entier)`**

Etat de la branche spécifiée avant l'appel à la fonction :


|   |   |
| --- | --- |
| *taDéroule* | Branche déroulée. |
| *taEnroule* | Branche enroulée. |
|  *taErreur* | Branche inexistante. |



**`<Champ Table hiérarchique> : (Nom de champ)`**

Nom du champ Table hiérarchique à manipuler.

**`<Ligne manipulée> : (Entier optionnel)`**

Numéro de la ligne contenant la branche à enrouler ou à dérouler. Si ce paramètre n'est pas spécifié, la branche contenue dans la ligne en cours est manipulée.


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
### Table hiérarchique : Enrouler ou dérouler une branche en spécifiant son nom

`<Résultat> = TableEnrouleDéroule(<Champ Table hiérarchique> [, <Branche manipulée>])`
---

**`<Résultat> : (Entier)`**

Etat de la branche spécifiée avant l'appel à la fonction :


|   |   |
| --- | --- |
| *taDéroule* | Branche déroulée. |
| *taEnroule* | Branche enroulée. |
|  *taErreur* | Branche inexistante. |



**`<Champ Table hiérarchique> : (Nom de champ)`**

Nom du champ Table hiérarchique à manipuler.

**`<Branche manipulée> : (Chaîne de caractères optionnelle)`**

Nom de la branche à enrouler ou à dérouler. Ce paramètre est de la forme :

```txt
"<Nom de la racine>" + TAB + ["<Nom du 1er noeud>" + TAB + ...
["<Nom du 2ème noeud>" + TAB + [...]]]"<Nom de la branche>"
```


Si ce paramètre ne correspond pas à une branche existante, une erreur WLangage est générée.

Si ce paramètre n'est pas spécifié, la branche contenue dans la ligne en cours est manipulée.  

Si deux branches correspondent au chemin spécifié, seule la première est manipulée. 


<a name="SYNTAXE3"></a>

### Table avec ruptures : Enrouler ou dérouler une rupture

`<Résultat> = TableEnrouleDéroule(<Champ Table> [, <Ligne manipulée> [, <Rupture>]])`
---

**`<Résultat> : (Entier)`**

Etat de la rupture spécifiée avant l'appel à la fonction :


|   |   |
| --- | --- |
| *taDéroule* | Branche déroulée. |
| *taEnroule* | Branche enroulée. |
|  *taErreur* | Branche inexistante. |



**`<Champ Table> : (Nom de champ)`**

Nom du champ Table à manipuler. Ce champ doit posséder une ou plusieurs ruptures. Dans le cas contraire, cette fonction n'a aucun effet.

**`<Ligne manipulée> : (Entier optionnel)`**

Numéro de la ligne de la rupture à enrouler ou à dérouler. Ce numéro doit correspondre soit au numéro de la ligne en cours, soit au numéro de la première ligne de la rupture à enrouler ou à dérouler. Si ce paramètre n'est pas spécifié, la rupture de la ligne en cours est manipulée.

**`<Rupture> : (Chaîne de caractères optionnelle)`**

Nom de la rupture à enrouler ou à dérouler. Ce paramètre doit être spécifié dans le cas de ruptures imbriquées. Il permet de définir la rupture qui sera enroulée ou déroulée. Par défaut, si des ruptures sont imbriquées, aucune rupture n'est manipulée.  


<a name="SYNTAXE4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
### Table et table hiérarchique : enrouler une fenêtre de détail

`<Résultat> = TableEnrouleDéroule(<Champ Table> [, <Ligne manipulée>])`
---

**`<Résultat> : (Entier)`**

Etat de la fenêtre de détail spécifiée avant l'appel à la fonction :


|   |   |
| --- | --- |
| *taDéroule* | Branche déroulée. |
| *taEnroule* | Branche enroulée. |
|  *taErreur* | Branche inexistante. |





**`<Champ Table> : (Nom de champ)`**

Nom du champ Table ou Table hiérarchique à manipuler.

**`<Ligne manipulée> : (Entier optionnel)`**

Numéro de la ligne dont le détail doit être enroulé ou déroulé. Si ce paramètre n'est pas spécifié, le détail de la ligne en cours est manipulé.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000189"></a>La fonction **TableEnrouleDéroule** peut être utilisée sur : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) un champ Table hiérarchique.

- un champ Table fichier.

- un champ Table par programmation.  




Cette fonction ne peut pas être utilisée sur les champs Table fichier (accès direct). 
<a name="NOTE0_2"></a>


### Branche à enrouler ou à dérouler
<a name="branche_enrouler_derouler_ELTPARAGRAPHE000215"></a>La fonction **TableEnrouleDéroule** n'a aucun effet :


|   |   |
| --- | --- |
| Champ Table hiérarchique | Champ Table avec ruptures |
| <br><br>- si la branche à manipuler est introuvable.<br><br>- si la branche à manipuler est une feuille.<br><br>- si la branche à manipuler est déjà enroulée.<br><br><br> | <br><br>- si le champ Table n'a pas de ruptures.<br><br>- si le champ Table contient plusieurs ruptures et si la rupture à manipuler n'est pas indiquée.<br><br>- si aucune ligne n'est sélectionnée dans le champ Table et si le paramètre &lt;Numéro de la ligne&gt; n'est pas spécifié.<br><br><br> |


**Remarque pour les champs Table hiérarchique** : 

- Si le paramètre &lt;Ligne manipulée&gt; ou &lt;Branche manipulée&gt; correspond à la branche contenue dans la première ligne, toute la hiérarchie du champ Table hiérarchique est enroulée (équivalent à la fonction [TableEnrouleTout](../WDLang1/1000010003.md)) ou déroulée (équivalent à la fonction [TableDérouleTout](../WDLang1/1000010001.md)).

- Lors de l'appel à la fonction **TableEnrouleDéroule**, si la branche spécifiée est déroulée et possède une procédure associée via la propriété [AjouteFilsDifféré](../Proprietes/1000020927.md), cette procédure sera exécutée. 



<a name="NOTE0_3"></a>


### Gestion du bandeau de sélection lors de l'enroulement
<a name="gestion_bandeau_selection_lors_enroulement_ELTPARAGRAPHE000258"></a>**Pour les champs Table hiérarchique** :

- Si le bandeau de sélection était positionné sur un des éléments du noeud à enrouler, le bandeau se positionne sur le noeud enroulé ou déroulé après l'appel de la fonction **TableEnrouleDéroule**.

- Le code de modification est appelé à chaque déplacement du bandeau de sélection. Si deux niveaux sont enroulés et si le bandeau de sélection se positionne sur le noeud supérieur, les codes de modification de chacun des niveaux sont exécutés.




**Pour les champs Table avec ruptures**, le bandeau de sélection n'est pas modifié. Il reste sur l'élément en cours même si la rupture est enroulée.
<a name="NOTE0_4"></a>


### Gestion du bandeau de sélection lors du déroulement
<a name="gestion_bandeau_selection_lors_deroulement_ELTPARAGRAPHE000275"></a>La fonction **TableEnrouleDéroule** ne modifie pas la position du bandeau de sélection.
<a name="NOTE0_5"></a>


### Vitesse d'exécution pour les champs Table hiérarchique
<a name="vitesse_execution_pour_les_champs_table_hierarchique_ELTPARAGRAPHE000287"></a>La vitesse d'exécution de la syntaxe 1 est plus rapide que celle de la syntaxe 2.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
