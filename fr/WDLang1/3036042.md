
## fHeure (Fonction)

***En anglais : fTime***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie ou modifie les différentes heures d'un fichier ou d'un répertoire (heure de création, de modification ou d'accès).






<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003036042&name=fheure_fonction&product=WD">Voir des exemples supplémentaires</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Récupération de l'heure de modification d'un fichier
ResHeure = fHeure("C:\MesRépertoires\Fichier.txt", "", fModification)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = fHeure(<Chemin du fichier ou du répertoire> [, <Nouvelle heure> [, <Type d'heure>]])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Heure demandée du fichier ou du répertoire (au format HHMMSS), 

- Chaîne vide ("") en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Chemin du fichier ou du répertoire> : (Chaîne de caractères)`**



- Nom et chemin complet (ou relatif) du fichier (260 caractères maximum). 

- Chemin complet (ou relatif) du répertoire (260 caractères maximum).




Un chemin de type UNC peut être utilisé. Si ce paramètre correspond à un nom de répertoire, ce nom peut être terminé indifféremment par "\\" ou non.

![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre peut être au format Ansi ou Unicode.







**`<Nouvelle heure> : (Chaîne de caractères optionnelle)`**



- Modification d'une heure : nouvelle heure du fichier ou du répertoire spécifié (au format HHMMSS),

- Lecture d'une heure : chaîne vide ("").






**`<Type d'heure> : (Constante optionnelle)`**

Indique l'heure à manipuler :


|   |   |
| --- | --- |
| *fAccès* | Heure du dernier accès au fichier/au répertoire.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *fCréation* | Heure de création du fichier/du répertoire.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *fModification*<br>(Valeur par défaut) | Heure de dernière modification du fichier/du répertoire. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png) 

### Modification de la date et de l'heure d'un fichier
<a name="modification_date_heure_fichier_ELTPARAGRAPHE000137"></a>Pour modifier la date et l'heure d'un fichier, il est possible d'utiliser la fonction [fDateHeure](../WDLang1/3036066.md).

**Remarque** : Il est également possible d'utiliser successivement les fonctions [fDate](../WDLang1/3036019.md) et **fHeure**. Cependant, la fonction [fDateHeure](../WDLang1/3036066.md) est plus rapide.
<a name="NOTE0_2"></a>




### Gestion des secondes
<a name="gestion_des_secondes_ELTPARAGRAPHE000159"></a>Toutes les méthodes de formatage du disque (FAT, NTFS, ...) ne sont pas précises à la seconde près. Suivant la méthode utilisée, la fonction **fHeure** peut arrondir l'heure passée en paramètre de quelques secondes.

Par exemple, avec une méthode de formatage du disque de type FAT, l'heure d'accès aux fichiers est précisée à un jour près. L'heure d'accès correspond donc à "000000" et ne peut être modifiée.


<a name="NOTE0_3"></a>




### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000173"></a>La fonction **fHeure** génère une erreur dans les cas suivants :

- le fichier spécifié est ouvert ou bloqué par une autre application,

- le fichier spécifié n'existe pas,

- le nom du fichier spécifié est invalide,

- le format du paramètre &lt;Nouvelle heure&gt; est incorrect. Si le format du paramètre &lt;Nouvelle heure&gt; est incorrect, une erreur du WLangage est générée.

- une chaîne Unicode a été utilisée pour le paramètre &lt;Chemin du fichier ou du répertoire&gt; sous un système d'exploitation de type Windows 98 ou Windows Me.





<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Fonctionnement sous Windows Vista (et supérieur)
<a name="fonctionnement_sous_windows_vista_superieur_ELTPARAGRAPHE000344"></a>Si cette fonction ne fonctionne pas correctement sous Windows Vista (et supérieur), il est nécessaire de vérifier si le fichier ou le répertoire manipulé ne se trouve pas dans un des répertoires système (répertoire de Windows ou répertoire "Program Files").

**En effet, sous Windows Vista (et supérieur), avec le [mécanisme de l'UAC](../Editeurs/2025014.md) (contrôle des comptes utilisateurs) activé**, il est nécessaire d'avoir les privilèges administrateur pour manipuler / modifier des fichiers ou des répertoires présents dans les répertoires système (répertoire de Windows ou répertoire "Program Files").

**Conseil de programmation** : Si vous devez manipuler / modifier des fichiers ou des répertoires, sans avoir besoin de privilèges administrateur, il est conseillé :

- de ne pas écrire dans le répertoire de Windows ou dans le répertoire "Program Files",

- d'utiliser le répertoire système correspondant à l'application (connu par la fonction [SysRep](../WDLang1/3073026.md) par exemple avec la constante *srAppDataCommun*).



<a name="NOTE0_5"></a>




### Fonctionnement sous les différents systèmes d'exploitation
<a name="fonctionnement_sous_les_differents_systemes_exploitation_ELTPARAGRAPHE000200"></a>

- L'heure d'un fichier ou d'un répertoire ne peut pas être modifiée sous les systèmes suivants : Windows 98, Windows ME.




<a name="XComposante"></a>

## Composante :
wd280std.dll
