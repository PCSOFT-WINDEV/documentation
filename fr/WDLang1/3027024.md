


## Maintenant (Fonction)

***En anglais : Now***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet de : 

- Renvoyer ou modifier l'heure système (heure actuelle définie pour le poste en cours).

- Initialiser certains éléments du WLangage de type Date, Heure ou DateHeure.




**Remarques** : Pour la gestion de l'heure système, cette fonction est identique à la fonction [HeureSys](../WDLang1/3027019.md).




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
Res = Maintenant()        // Res = "15332105"
Res = HeureVersChaîne(Maintenant())   // Res = "15:33:21:05"
HeureAct = Gauche(Maintenant(), 4)    // HeureAct = "1533"
```
<a name="Exemple2"></a>

```wl
// Afficher l'heure actuelle dans le champ HeureActuelle

// -- Code d'initialisation d'une fenêtre/page
// Appeler toutes les secondes la procédure "Horloge"
TimerSys("Horloge", 100, 1)
```

```wl
// -- Procédure Horloge
PROCEDURE Horloge()
HeureActuelle = HeureVersChaîne(Maintenant())
```


<a name="Exemple3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png) 
```wl
// Change l'heure système et affiche la nouvelle heure
Maintenant("17280000")
Info(Maintenant())
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Connaître l'heure système et initialiser un élément du WLangage avec l'heure système

`<Elément> = Maintenant()`
---

**`<Elément> : (Chaîne de caractères ou Type correspondant à l'élément)`**

**Le résultat de la fonction s'adapte à l'utilisation qui en est faite**. 
Elément à initialiser. Cet élément peut correspondre : 

- à une chaîne de caractères. Elle contiendra l'heure système au format HHMMSSCC (HH correspond aux heures, MM aux minutes, SS aux secondes et CC aux centièmes de seconde).

- à une variable de type Date, Heure ou DateHeure. 

- à une rubrique de type Date, Heure ou DateHeure. 

- à un champ de saisie ou une colonne de type Date, Heure ou DateHeure. 

- à un attribut d'un champ Zone répétée associé à la propriété **Valeur** d'un champ de saisie ou d'une colonne de type Date, Heure ou DateHeure. 




Dans ce cas : 

- les éléments de type Date seront initialisés avec la date système. 

- les éléments de type Heure seront initialisés avec l'heure système.

- les éléments de type DateHeure seront initialisés avec la date et l'heure système.





<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png)![Procédures stockées](https://doc.pcsoft.fr/ext/images/fr/PS.png) 
### Modifier l'heure système

`Maintenant(<Nouvelle heure>)`
---

**`<Nouvelle heure> : (Chaîne de caractères ou variable de type Heure)`**

Nouvelle heure système au format HHMMSSCC (HH correspond aux heures, MM aux minutes, SS aux secondes et CC aux centièmes de seconde).  


<a name="SYNTAXE3"></a>

<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- **Attention** : Pour modifier l'heure système, il est nécessaire de posséder les droits administrateur sur le poste en cours. 

- Pour obtenir l'heure sous un format différent de HHMMSSCC, il faut formater la chaîne avec les fonctions [DateVersChaîne](../WDLang1/3027025.md), [Droite](../WDLang1/3024016.md), [Gauche](../WDLang1/3024001.md), etc.

- Le format HHMMSSCC a été choisi car il permet de comparer deux heures au centième de seconde près.

- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Dans cette version, la fonction **Maintenant** permet uniquement de renvoyer l'heure système du poste en cours (ou celle définie pour le poste navigateur). 

- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) En mode simulation, l'heure manipulée est celle du PC où la simulation est effectuée. En utilisation réelle, l'heure manipulée est celle du mobile. 




<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wd280std.dll
