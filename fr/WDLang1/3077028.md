


## ThreadMode (Fonction)

***En anglais : ThreadMode***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie les modes de gestion des threads. Les modes de gestion disponibles sont :

- la gestion automatique ou manuelle des sections critiques sur les procédures et les méthodes.

- la répartition de l'exécution des threads sur les différents processeurs ou les différents coeurs de la machine.




Les sections critiques automatiques empêchent l'exécution d'une procédure ou d'une méthode par plusieurs threads simultanément. Par défaut, les sections critiques automatiques sont activées.
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La fonction **ThreadMode** est sans effet : le mode de gestion est toujours multi-processeur, avec gestion manuelle des sections critiques.
<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Modifier les modes de gestion des threads

`<Résultat> = ThreadMode(<Nouveaux modes de gestion>)`
---

**`<Résultat> : (Entier)`**

Modes de gestion des threads avant la modification, combinaison des constantes ci-dessous.

**`<Nouveaux modes de gestion> : (Constante ou combinaison de constantes)`**

Mode de gestion des sections critiques des procédures et des méthodes :


|   |   |
| --- | --- |
| *threadAuto* | Gestion automatique des sections critiques : chaque procédure ou méthode ne pourra être exécutée que par un seul thread. |
| *threadSectionCritique*<br>(Valeur par défaut) | Gestion manuelle des sections critiques : chaque procédure ou méthode pourra être exécutée par plusieurs threads simultanément. Il est alors nécessaire de protéger les accès aux ressources partagées entre les différents threads par des sections critiques. |

Répartition des threads sur les processeurs ou les coeurs :


|   |   |
| --- | --- |
| *threadMonoProcesseur* | Tous les threads de l'application s'exécutent sur un seul processeur ou un seul coeur. |
| *threadMultiProcesseur*<br>(Valeur par défaut) | Les threads sont automatiquement répartis entre les différents processeurs ou les différents coeurs. |

![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Les constantes correspondant à la répartition des threads sur les processeurs ou les coeurs ne sont pas disponibles.


<a name="SYNTAXE2"></a>

### Récupérer les modes de gestion des threads

`<Résultat> = ThreadMode()`
---

**`<Résultat> : (Constante ou combinaison de constantes de type Entier)`**

Modes actuels de gestion des threads : 

Mode de gestion des sections critiques des procédures et des méthodes :


|   |   |
| --- | --- |
| *threadAuto* | Gestion automatique des sections critiques : chaque procédure ou méthode ne pourra être exécutée que par un seul thread. |
| *threadSectionCritique*<br>(Valeur par défaut) | Gestion manuelle des sections critiques : chaque procédure ou méthode pourra être exécutée par plusieurs threads simultanément. Il est alors nécessaire de protéger les accès aux ressources partagées entre les différents threads par des sections critiques. |

Répartition des threads sur les processeurs ou les coeurs :


|   |   |
| --- | --- |
| *threadMonoProcesseur* | Tous les threads de l'application s'exécutent sur un seul processeur ou un seul coeur. |
| *threadMultiProcesseur*<br>(Valeur par défaut) | Les threads sont automatiquement répartis entre les différents processeurs ou les différents coeurs. |

![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Les constantes correspondant à la répartition des threads sur les processeurs ou les coeurs ne sont pas disponibles.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Gestion des multi-processeurs
<a name="gestion_des_multiprocesseurs_ELTPARAGRAPHE000142"></a>Cette option n'est à utiliser que dans certains cas avancés.

Sur une machine **mono-processeur mono-coeur**, les constantes *threadMonoProcesseur* et *threadMutiProcesseur* n'ont aucune influence.

Sur une machine **multi-processeurs ou multi-coeurs** :

- Le mode de gestion *threadMonoProcesseur* force l'application à utiliser uniquement un seul processeur ou un seul coeur.

- Le mode de gestion *threadMultiProcesseur* permet de revenir en mode d'utilisation normal : dans ce cas, le système gère automatiquement la répartition des threads sur les processeurs ou les coeurs.




<a name="XComposante"></a>

## Composante :
wd280vm.dll
