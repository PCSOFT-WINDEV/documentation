


## dSauveImageBMP (Fonction)

***En anglais : dSaveImageBMP***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Sauve une image :

- soit dans un fichier au format BMP.

- soit en mémoire.


Cette image correspond à l'image contenue :

- soit dans un champ Image.

- soit dans une variable de type [Image](../WDLang1/1000019650.md).
	

- soit dans un champ Code-barres.
	![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Dans cette version, les champs de type Code-barres ne sont pas disponibles. Il n'est donc pas possible de sauver une image contenue dans un champ Code-barres.

- soit dans un champ Web Caméra. 




**Remarques** :

- Seule la partie visible du champ Image est sauvegardée. 

- Cette fonction permet uniquement de sauvegarder des images pour des résolutions d'écran allant jusqu'à 32 bits.

- Cette fonction ne peut pas être utilisée avec les champs Image présents dans les états.


![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) **Attention** : L'utilisation de cette fonction sous Linux nécessite une configuration spécifique. Pour plus de détails, consultez [Les dessins](../WDLang1/3029035.md). 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003029026&name=dsauveimagebmp_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Sauve en mémoire l'image présente dans "IMG_ImageDessin"
ResSauvegarde = dSauveImageBMP(IMG_ImageDessin, enMémoire)
```


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Sauve l'image présente dans "IMG_ImageDessin" sur "C:\Documents\Image.BMP"
ResSauvegarde = dSauveImageBMP(IMG_ImageDessin, "C:\Documents\Image.BMP")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Sauvegarder une image dans un fichier au format BMP

`<Résultat> = dSauveImageBMP(<Image> , <Nom du fichier> [, <Nombre de couleurs>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'image a été sauvegardée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Image> : (Nom de champ ou variable de type Image)`**



- Nom du champ Image, Code-barres ou Web Caméra à manipuler. Les champs Image présents dans un état ne peuvent pas être utilisés. 

- Nom de la variable de type [Image](../WDLang1/1000019650.md) à manipuler.
	




**`<Nom du fichier> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier BMP à créer. Un chemin de type UNC peut être utilisé. L'extension du fichier n'est pas obligatoire.

**Attention** : 

- Pour que l'image soit sauvée, le répertoire de destination doit exister.

- L'existence du fichier BMP n'est pas vérifiée. Si ce fichier existe, il est automatiquement écrasé.




**`<Nombre de couleurs> : (Entier optionnel)`**

Nombre de couleurs de l'image sauvegardée :

- 0 (par défaut) : nombre de couleurs défini dans la résolution d'écran

- 16 : 16 couleurs


Ce paramètre correspond au nombre de couleurs proposées dans la palette de couleurs lors de l'utilisation du fichier BMP.  


<a name="SYNTAXE2"></a>
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Syntaxe non disponible
### Sauvegarder une image en mémoire

`<Résultat> = dSauveImageBMP(<Image> , <enMémoire> [, <Nombre de couleurs>])`
---

**`<Résultat> : (Buffer)`**

Chaîne d'octets contenant l'image au format BMP. Cette chaîne d'octets peut être par la suite affectée à un champ Image, enregistrée dans un fichier (fonction [fSauveTexte](../WDLang1/3036046.md)), envoyée à travers un réseau (grâce aux [fonctions Socket](../WDLang3/3070007.md)), ...



**`<Image> : (Nom de champ ou variable de type Image)`**



- Nom du champ Image, Code-barres ou Web Caméra à manipuler. Les champs Image présents dans un état ne peuvent pas être utilisés. 

- Nom de la variable de type [Image](../WDLang1/1000019650.md) à manipuler.
	




**`<enMémoire> : (Constante)`**

*enMémoire* : Constante permettant de sauvegarder une image en mémoire.

**`<Nombre de couleurs> : (Entier optionnel)`**

Nombre de couleurs de l'image sauvegardée :

- 0 (par défaut) : nombre de couleurs défini dans la résolution d'écran.

- 16 : 16 couleurs.




Ce paramètre correspond au nombre de couleurs proposées dans la palette de couleurs lors de l'utilisation du fichier BMP.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Image présente dans un champ Web Caméra
<a name="image_presente_dans_champ_web_camera_ELTPARAGRAPHE000318"></a>Seule l'image affichée au moment de l'exécution de la fonction **dSauveImageBMP** est sauvegardée. Pour sauvegarder cette image, il est également possible d'utiliser :

- la fonction [VidéoCapture](../WDLang1/3079007.md) : l'image sera sauvegardée au format BMP

- la fonction [dSauveImageGIF](../WDLang1/3029040.md) : l'image sera sauvegardée soit au format Gif, soit en mémoire

- la fonction [dSauveImageJPEG](../WDLang1/3029038.md) : l'image sera sauvegardée soit au format Jpeg, soit en mémoire

- la fonction [dSauveImagePNG](../WDLang1/3029027.md) : l'image sera sauvegardée soit au format PNG, soit en mémoire



<a name="NOTE0_2"></a>
<a name="NOTE0_3"></a>

<a name="XComposante"></a>

## Composante :
wd280pnt.dll
