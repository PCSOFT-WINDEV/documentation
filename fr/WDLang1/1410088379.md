


## &lt;Table&gt;.VersExcel (Fonction)

***En anglais : &lt;Table&gt;.ToExcel***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Crée un fichier Excel avec les données d'un champ Table ou Table hiérarchique. 

**Remarque** : Ce fichier pourra être ouvert sous Excel ou sous OpenOffice Calc (selon le logiciel installé sur le poste en cours).




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
sFic est une chaîne
// Demande le nom du fichier
sFic = fSélecteur("", "", "Choisissez le fichier d'exportation", ...
	"Fichiers Excel (*.xls) *.xls", "xls", fselCrée + fselExiste)
// Si le nom n'a pas été fourni, abandonne l'export
// Sinon, exporte le contenu du champ Table TABLE_TABLE1
SI sFic <> "" ALORS TABLE_TABLE1.VersExcel(sFic, taSansTitre)
```
<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
sNomFichier est une chaîne
...
// Génère un fichier Excel sur le bureau
sFichierID est une chaîne
sFichierID = ComplèteRep(SysRep(srBureau) + fSep() + sNomFichier)
SI sFichierID <> "" ALORS
	SI TABLE_Produit.VersExcel(sFichierID, taSansTitre) = Faux ALORS
		Info(ErreurInfo())
	SINON
		ToastAffiche("Fichier généré")
	FIN
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Sélection de toutes les lignes ou des N premières lignes du champ Table ou Table hiérarchique

`<Résultat> = <Champ Table>.VersExcel(<Fichier XLS à créer> [, <Options> [, <Nombre de lignes exportées>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le fichier a été créé, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour obtenir plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Champ Table> : (Nom de champ)`**

Nom du champ à manipuler. Ce champ peut correspondre à : 

- un champ Table. 

- un champ Table hiérarchique.




**`<Fichier XLS à créer> : (Chaînes de caractères)`**

Nom et chemin complet du fichier Excel à créer. Si le fichier existe déjà, il est remplacé par le nouveau fichier.

**`<Options> : (Constante optionnelle de type Entier ou combinaison de constantes)`**

Paramètre le fichier XLS à créer.


|   |   |
| --- | --- |
| *taAvecColonnesInvisibles* | Exporte aussi les colonnes invisibles du champ.<br><br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Les colonnes définies comme non imprimables et non exportables sont exportées. Ces colonnes sont définies : <br><br>- soit par programmation : propriété [VisibleEnExportEtImpression](../Proprietes/1000022320.md) à <u><u><u><u>Faux</u></u></u></u>. <br><br>- soit dans l'onglet "Général" de la fenêtre de description des colonnes : option "Export et impression" à "Jamais".<br><br><br> |
| *taAvecMiseEnForme* | Exporte la couleur et la police utilisées dans le champ. |
| *taColonneOrdreAffiché* | Exporte les colonnes selon l'ordre des colonnes actuellement affiché dans le champ (et non selon l'ordre des colonnes défini sous l'éditeur).<br> |
| *taFusion* | Si le fichier XLS existe déjà, fusionne le contenu existant avec le nouveau contenu : les formules, la mise en forme, ... des cellules existantes est conservée. Les données existantes ne sont pas conservées. Seules les données des colonnes et des lignes présentes en plus dans le fichier XLS sont conservées. |
| *taLigneSélectionnées* | Exporte uniquement les lignes sélectionnées (par défaut, toutes les lignes sont exportées). N'exporte pas les totaux. |
| *taSansTitre* | Seules les données sont copiées dans le fichier. |
| *taSansTotaux* | N'exporte pas : <br><br>- les lignes de totaux, moyenne et comptage automatique (par défaut, ces lignes sont exportées).<br><br>- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) les lignes de calculs personnalisés (par défaut, ces lignes sont exportées).<br><br><br> |
| *taTitreColonnes*<br>(valeur par défaut) | Le titre des colonnes est inséré dans le fichier. |



**`<Nombre de lignes exportées> : (Entier optionnel)`**

Nombre de lignes à exporter. Seules les lignes 1 à &lt;Nombre de lignes exportées&gt; seront exportées.

Si ce paramètre n'est pas précisé, toutes les lignes du champ Table seront exportées.


<a name="SYNTAXE2"></a>

### Sélection des lignes du champ Table ou Table hiérarchique

`<Résultat> = <Champ Table>.VersExcel(<Fichier XLS à créer> [, <Options> [, <Ligne début> [, <Ligne fin> [, <Mot de passe>]]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le fichier a été créé, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour obtenir plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Champ Table> : (Nom de champ)`**

Nom du champ à manipuler. Ce champ peut correspondre à : 

- un champ Table. 

- un champ Table hiérarchique.




**`<Fichier XLS à créer> : (Chaînes de caractères)`**

Nom et chemin complet du fichier Excel à créer. Si le fichier existe déjà, il est remplacé par le nouveau fichier.

**`<Options> : (Constante optionnelle de type Entier ou combinaison de constantes)`**

Paramétrage du fichier XLS à créer.


|   |   |
| --- | --- |
| *taAvecColonnesInvisibles* | Exporte aussi les colonnes invisibles du champ.<br>![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Les colonnes définies comme non imprimables et non exportables sont exportées. Ces colonnes sont définies : <br><br>- soit par programmation : propriété [VisibleEnExportEtImpression](../Proprietes/1000022320.md) à <u><u><u><u>Faux</u></u></u></u>. <br><br>- soit dans l'onglet "Général" de la fenêtre de description des colonnes : option "Export et impression" à "Jamais".<br><br><br> |
| *taAvecMiseEnForme* | Exporte la couleur et la police utilisées dans le champ. |
| *taColonneOrdreAffiché* | Exporte les colonnes selon l'ordre des colonnes actuellement affiché dans le champ (et non selon l'ordre des colonnes défini sous l'éditeur).<br> |
| *taFusion* | Si le fichier XLS existe déjà, fusionne le contenu existant avec le nouveau contenu : les formules, la mise en forme, ... des cellules existantes est conservée. |
| *taLigneSélectionnées* | Exporte uniquement les lignes sélectionnées (par défaut, toutes les lignes sont exportées).<br>N'exporte pas les totaux. |
| *taSansTitre* | Seules les données sont copiées dans le fichier. |
| *taSansTotaux* | N'exporte pas : <br><br>- les lignes de totaux, moyenne et comptage automatique (par défaut, ces lignes sont exportées).<br><br>- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) les lignes de calculs personnalisés (par défaut, ces lignes sont exportées).<br><br><br> |



**`<Ligne début> : (Entier optionnel)`**

Numéro de la ligne de début de l'exportation. Si ce paramètre et le paramètre &lt;Ligne fin&gt; ne sont pas précisés, toutes les lignes du champ seront exportées.

**`<Ligne fin> : (Entier optionnel)`**

Numéro de la ligne de fin de l'exportation. Si ce paramètre et le paramètre &lt;Ligne début&gt; ne sont pas précisés, toutes les lignes du champ seront exportées.

**`<Mot de passe> : (Chaîne de caractères optionnelle)`**

Mot de passe du fichier Excel généré (uniquement pour les fichiers XLSX). Ce mot de passe est nécessaire pour ouvrir le fichier Excel généré.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000434"></a>La fonction **&lt;Table&gt;.VersExcel** peut être utilisée indifféremment sur : 

- un champ Table ou Table hiérarchique fichier.

- un champ Table ou Table hiérarchique par programmation.

- un champ monosélection ou multisélection.



<a name="NOTE0_2"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000451"></a>

- Les fichiers Excel sont limités à 65536 lignes et 256 colonnes si l'extension utilisée est ".xls". Cette limite peut être dépassée en utilisant l'extension ".xlsx" afin de créer des fichiers au format Excel 2007. Attention : dans ce cas, les anciennes versions de Excel devront être équipée du "Pack de compatibilité Office 2007", téléchargeable gratuitement sur le site de Microsoft afin de pouvoir ouvrir les documents générés.

- Le fichier créé pourra être ouvert avec Excel version 97 ou supérieure ou avec OpenOffice Calc version 2 ou supérieure.

- Il est possible de créer des fichiers au format XLSX : Il suffit de préciser l'extension dans le paramètre &lt;Fichier XLS à créer&gt;.

- Les colonnes de type "Numérique Haute Précision" (38 chiffres significatifs) seront exportés sous forme de nombre exponentiel.

- La fusion des colonnes dans un champ Table est ignorée.

- Les colonnes au format Unicode sont exportées au format Unicode dans Excel.

- Les colonnes de type Interrupteur sont exportées sous forme de cases à cocher.

- Les colonnes de type "RTF" sont exportées sans mise en forme.

- Les éléments suivants ne sont pas exportés dans le fichier Excel : 

	- Les images, 

	- Les graphes, 

	- Les codes-barres.






<a name="NOTE0_3"></a>


### Impression dans un fichier XLS
<a name="impression_dans_fichier_xls_ELTPARAGRAPHE000473"></a>Il est possible de réaliser directement une impression dans un fichier XLS : 

- grâce à la fonction [iDestination](../WDLang5/3046074.md), 

- depuis le visualisateur de rapports. 


Le paramétrage du fichier XLS créé est réalisé grâce à la fonction [iParamètreXLS](../WDLang5/1000017224.md).

<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280xls.dll
