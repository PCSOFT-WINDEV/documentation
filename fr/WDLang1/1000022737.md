


## RuptureAjoute (Fonction)

***En anglais : BreakAdd***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute une rupture dans un champ Table ou dans un champ Zone répétée.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ajout d'une rupture verte sur la date dans un champ Table
x est un Champ
x <- RuptureAjoute(TABLE_Commande.COL_DATE, "RuptDate", ruptHaut, 50) 
x.CouleurFond = VertFoncé // Colorie en vert la rupture
```
<a name="Exemple2"></a>

```wl
// Ajout d'un haut et d'un bas de rupture dans un champ Table 
RuptureHaut est un Champ
RuptureBas est un Champ
(RuptureHaut, RuptureBas) <- RuptureAjoute(TABLE_Client.COL_NOM, "NomRuptureHaut" + TAB + ...
	"NomRuptureBas", ruptHautEtBas)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = RuptureAjoute(<Nom élément> , <Nom de la rupture> [, <Type de la rupture> [, <Hauteur>]])`
---

**`<Résultat> : (Variable de type Champ)`**

Nom de la variable de type [Champ](../WDLang1/1000020967.md) permettant de manipuler la rupture créée. Dans ce cas, l'affectation doit être réalisée avec l'opérateur **'<-'**. 

Si le paramètre &lt;Type de rupture&gt; correspond à la constante *ruptHautEtBas*, la fonction renvoie 2 champs. La syntaxe devient : 

```txt
(<NomChampRuptureHaut>,<NomChampRuptureBas>) <- ] RuptureAjoute(<Nom élément>, ...
<Nom de la rupture Haut> + TAB + <Nom de la rupture Bas> , ruptHautBas)
```


**`<Nom élément> : (Chaîne de caractères)`**

Nom de l'élément sur lequel la rupture doit être faite. Il s'agit soit d'une colonne de Table soit du nom d'un attribut d'une Zone répétée.

**`<Nom de la rupture> : (Chaîne de caractères)`**

Nom de la rupture à créer. Ce nom ne doit pas exister dans le champ Table ou le champ Zone répétée. 

Si le paramètre &lt;Type de rupture&gt; correspond à la constante *ruptHautEtBas*, ce paramètre est de la forme : 

```txt
<Nom de la rupture Haut> + TAB + <Nom de la rupture Bas>
```


**`<Type de la rupture> : (Constante de type Entier)`**

Type de rupture à créer : 


|   |   |
| --- | --- |
| *ruptHaut*<br>(Valeur par défaut) | Ajoute un haut de rupture. |
| *ruptBas* | Ajoute un bas de rupture. |
| *ruptHautEtBas* | Ajoute un haut et un bas de rupture. |



**`<Hauteur> : (Entier optionnel)`**

Hauteur de la rupture en pixels. Par défaut, la rupture est de 32 pixels. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Les ruptures créées avec la fonction **RuptureAjoute** peuvent être supprimées avec la fonction [RuptureSupprime](../WDLang1/1000022738.md).

- Si le champ Table ou Zone répétée contient déjà des ruptures, la rupture est créée au niveau suivant : 
	
	```txt
	[Haut de rupture existant]
		[Nouveau Haut de rupture]
			Ligne 1 de la table
		[Nouveau bas de rupture]
	[Bas de rupture existant]
	```


- La fonction** RuptureAjoute** ne peut pas être utilisée sur : 

	- Les champs Table et Zone répétée fichier en accès direct. 

	- Les champs Table verticale. 


 Dans ce cas, la fonction échoue et une erreur non fatale est affichée. 



<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll


