
## gValeurMémorisée (Fonction)

***En anglais : gStoredValue***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute une valeur "invisible" dans un élément d'un champ Liste, Combo ou Planning. Cette valeur sera la valeur mémorisée lorsque l'utilisateur sélectionnera l'élément du champ.

**Remarques** :

- Pour connaître la valeur mémorisée associée à un élément du champ, utilisez la propriété [ValeurMémorisée](../Proprietes/2510127.md).

- Pour que la récupération de la valeur définie par la fonction **gValeurMémorisée** soit active :

	- soit utilisez la fonction [gValeurMémoriséeActive](../WDLang1/1410088364.md).

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) soit cochez l'option "Retourne la valeur spécifiée avec la fonction gValeurMémorisée" (onglet "Détail" de la description du champ). 


 Dans ce cas, le champ renverra directement la valeur de **gValeurMémorisée** correspondant à l'option sélectionnée.

- Cette fonction est identique à la fonction [gLien](../WDLang1/3029043.md). 



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Code du champ Bouton permettant de remplir le champ Combo
// ----------------------------------------------
// La combo "COMBO_Civilité" affiche les titres de civilité :
// "Monsieur", "Madame" et "Mademoiselle".
// Un entier représentant une civilité sera retourné au langage
ListeAjoute(COMBO_Civilité, "Monsieur" + gValeurMémorisée("1"))
// Seule la chaîne de caractères "1" est retournée au langage.
// Cette chaîne de caractères retournée n'est pas affichée dans le champ Combo.
```

```wl
// Code du champ Bouton permettant de connaître la valeur de gValeurMémorisée
// -------------------------------------------------------------------------------
// Code permettant d'obtenir la valeur du gValeurMémorisée de l'option sélectionnée 
Info(COMBO_Civilité[COMBO_Civilité].ValeurMémorisée)
// Affiche "1" dans notre exemple.
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = gValeurMémorisée(<Chaîne à retourner>)`
---

**`<Résultat> : (Chaîne de caractères)`**

Chaîne de contrôle à utiliser dans les fonctions [ListeAjoute](../WDLang1/3049004.md), [ListeInsère](../WDLang1/3049002.md) ou [ListeModifie](../WDLang1/3049009.md).

**`<Chaîne à retourner> : (Chaîne de caractères)`**

Valeur texte à retourner. Seule cette chaîne sera retournée au langage. Cette chaîne ne sera pas affichée dans la ligne.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Place de gValeurMémorisée
<a name="place_docparampagetitleshort_ELTPARAGRAPHE000075"></a>La fonction **gValeurMémorisée** peut être appelée à n'importe quelle place dans la ligne à ajouter.

Par exemple :


```wl
ListeAjoute(COMBO_COMBO1, gValeurMémorisée("1") + "Monsieur")
// ou
ListeAjoute(COMBO_COMBO1, "Monsieur" + gValeurMémorisée("1"))
```



<a name="NOTE0_2"></a>


### Valeur ajoutée
<a name="valeur_ajoutee_ELTPARAGRAPHE000092"></a>Lorsqu'une valeur est ajoutée par la fonction **gValeurMémorisée**, cette valeur n'est prise en compte ni dans le tri, ni pour les lettres d'appel.

Si plusieurs valeurs sont ajoutées dans un élément d'une liste avec **gValeurMémorisée**, seule la première valeur sera retournée.


```wl
ListeAjoute(LISTE_LISTE1, "MonElément" + gValeurMémorisée("Lien1") + gValeurMémorisée("Lien2"))
```


Dans cet exemple, seule la valeur "Lien1" sera retournée.

La fonction [ListeCherche](../WDLang1/3049003.md) tient compte des valeurs ajoutées par la fonction **gValeurMémorisée**.


<a name="NOTE0_3"></a>




### Sensibilité à la casse
<a name="sensibilite_casse_ELTPARAGRAPHE000121"></a>La fonction **gValeurMémorisée** n'est pas sensible à la casse (minuscules/majuscules).

Ainsi le code suivant : 

```wl
ListeAjoute(LISTE_LISTE1, "MonElément" + gValeurMémorisée("AAA"))
```
sera équivalent au code :

```wl
ListeAjoute(LISTE_LISTE1, "MonElément" + gValeurMémorisée("aaa"))
```



<a name="NOTE0_4"></a>




### Combos auto-alimentées
<a name="combos_autoalimentees_ELTPARAGRAPHE000138"></a>La fonction **gValeurMémorisée** est utilisée pour gérer les champs de type "Combo auto-alimentée".


<a name="NOTE0_5"></a>




### Élément récupéré
<a name="element_recupere_ELTPARAGRAPHE000150"></a>Lorsqu'un élément est récupéré dans un champ Combo ou Liste, l'ordre de priorité est le suivant :

1. Valeurs ajoutées par **gValeurMémorisée**.

2. Valeurs ajoutées par [gARécupérer](../WDLang1/3029025.md).




Pour connaître la valeur mémorisée associée à un élément du champ, utilisez la propriété [ValeurMémorisée](../Proprietes/2510127.md).


<a name="NOTE0_6"></a>




### Champ Planning
<a name="champ_planning_ELTPARAGRAPHE000173"></a>Si les ressources du planning ont été créées avec la fonction [PlanningAjouteRessource](../WDLang1/1000019279.md) en utilisant la fonction **gValeurMémorisée**, le nom de la ressource obtenue par exemple avec la propriété [RessourceSélectionnée](../Proprietes/1000019445.md) correspondra à la valeur précisée dans la fonction **gValeurMémorisée** pour cette ressource.

Exemple : 

```wl
// Ajoute une ressource (ici une salle de réunion) dans le champ Planning
// Reunion est le fichier de données qui décrit les différentes salles disponibles
PlanningAjouteRessource(PLN_OccupationSalles, Reunion.Nom + gValeurMémorisée(Reunion.IDReunion))

...

// Code de clic sur le bouton BTN_NOUVEAU_RDV
MonRDV est un RendezVous
SI PLN_OccupationSalles.RessourceSélectionnée = "" ALORS
        RETOUR
FIN

MonRDV.DateDébut = PLN_OccupationSalles.DateDébut
MonRDV.DateFin = PLN_OccupationSalles.DateFin
MonRDV.Ressource = PLN_OccupationSalles.RessourceSélectionnée
// Le nom de la ressource correspond à la valeur précisée 
// dans la fonction gValeurMémorisée pour cette ressource
```

<a name="NOTE0_7"></a>


### Cas particulier : Champ Combo ou Combo dans un champ Table
<a name="cas_particulier_champ_combo_combo_dans_champ_table_ELTPARAGRAPHE000195"></a>Si la fonction **gValeurMémorisée** doit retourner une chaîne vide (""), le résultat obtenu est différent si le champ utilisé est un champ Combo ou une colone de type Combo dans une champ Table. 

Ainsi, si le code suivant est utilisé : 

```wl
ListeAjoute(COMBO, "MonElément" + gValeurMémorisée(""))
```
la valeur récupérée sera : 

1. une chaîne vide ("") dans le cas d'un champ Combo,

2. 0 (zéro) dans le cas d'une colonne Combo d'un champ Table.




Pour conserver le même code de récupération de la valeur de **gValeurMémorisée** pour un champ Combo et une colonne Combo, il est conseillé d'utiliser un champ Combo placé dans une [colonne de type conteneur](../WDChamp/1013263.md) du champ Table.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
