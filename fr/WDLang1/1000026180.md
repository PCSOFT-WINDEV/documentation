
## SaisieInvalideDétecte (Fonction)

***En anglais : InvalidInputDetect***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Détecte et met en erreur les champs dont la saisie est invalide et /ou obligatoire.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Evénement Autorisation de fermeture d'une fenêtre
SI SaisieInvalideDétecte() ALORS
	RENVOYER Faux
SINON 
	RENVOYER Vrai
FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = SaisieInvalideDétecte([<Elément manipulé>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la saisie est invalide ou obligatoire pour au moins un champ, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. 




**`<Elément manipulé> : (Nom de champ ou nom de fenêtre optionnel)`**

Nom du champ ou de la fenêtre dans le(la)quel(le) la vérification doit être effectuée. Si le champ est un conteneur (champ Onglet, Superchamp, etc.), la vérification sera effectuée en profondeur pour tous les champs de ce conteneur. 
Si ce paramètre n'est pas spécifié, la détection est effectuée sur tous les champs de la fenêtre en cours.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Caractéristiques de la vérification/détection des champs dont la saisie est invalide et /ou obligatoire
<a name="caracteristiques_verificationdetection_des_champs_dont_saisie_est_invalide_obligatoire_ELTPARAGRAPHE000042"></a>La vérification de la saisie sera effectuée pour les types de champs suivants : 

- **Champ Sélecteur/Interrupteur** : si l'option de saisie obligatoire a été activée (ou propriété [SaisieObligatoire](../Proprietes/1000026174.md) à <u><u><u><u>Vrai</u></u></u></u>), vérifie qu'au moins une option est sélectionnée.

- **Champ Notation** : si l'option de saisie obligatoire a été activée (ou propriété [SaisieObligatoire](../Proprietes/1000026174.md) à <u><u><u><u>Vrai</u></u></u></u>), vérifie qu'une note a été attribuée.

- **Combo en saisie** : si l'option de saisie obligatoire a été activée (ou propriété [SaisieObligatoire](../Proprietes/1000026174.md) à <u><u><u><u>Vrai</u></u></u></u>), vérifie qu'une valeur a été saisie ou sélectionnée dans la combo. 
	Si un masque de saisie a été utilisé, la fonction vérifie que la saisie est valide pour ce masque. 
	Dans le cas de l'utilisation d'un masque personnalisé avec une variable de type [MasqueDeSaisie](../WDLang1/1000024886.md), la vérification est effectuée en exécutant la procédure associée à la propriété **VérifieSiSaisieValide** de ce masque.

- **Combo sans saisie** : si l'option de saisie obligatoire a été activée (ou propriété [SaisieObligatoire](../Proprietes/1000026174.md) à <u><u><u><u>Vrai</u></u></u></u>), vérifie qu'une valeur a été sélectionnée dans la combo. 

- **Champ de saisie** : si l'option de saisie obligatoire a été activée (ou propriété [SaisieObligatoire](../Proprietes/1000026174.md) à <u><u><u><u>Vrai</u></u></u></u>), vérifie qu'une valeur a été saisie ou sélectionnée dans le champ. 
	Si un masque de saisie a été utilisé, la fonction vérifie que la saisie est valide pour ce masque. Dans le cas de l'utilisation d'un masque personnalisé avec une variable de type [MasqueDeSaisie](../WDLang1/1000024886.md), la vérification est effectuée en exécutant la procédure associée à la propriété **VérifieSiSaisieValide** de ce masque.


La vérification est effectuée uniquement sur les champs actifs et visibles.
<a name="NOTE0_2"></a>


### Divers
<a name="divers_ELTPARAGRAPHE000104"></a>

- La fonction donne le focus au premier champ détecté selon l'ordre de navigation.

- Il est possible de personnaliser le mode d'affichage de l'erreur dans la fenêtre de description des champs concernés.

- L'état en erreur d'un champ sera annulé dès lors que la saisie du champ est modifiée par l'utilisateur ou par programmation.

- Pour connaitre les champs dont la saisie est invalide/obligatoire sans les passer en erreurs, utilisez la fonction [SaisieInvalideListeChamp](../WDLang1/1000026244.md).

- Les propriétés [TexteSaisieObligatoire](../Proprietes/1000026176.md) et [TexteSaisieInvalide](../Proprietes/1000026245.md) permettent de personnaliser les messages d'erreur affichés en cas de saisie invalide/obligatoire.

- Cas particulier : champ de saisie ou combo avec saisie possédant un masque personnalisé via une variable de type [MasqueDeSaisie](../WDLang1/1000024886.md). Si le champ n'a pas le focus au moment de l'appel de la fonction **SaisieInvalideDétecte**, le texte affiché dans le champ sera au préalable formaté avec la procédure de la propriété **FormateEnEntrée** du masque avant de vérifier sa validité.






<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
