
## FinService (Fonction)

***En anglais : EndService***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Termine l'exécution du service en cours.

**Remarque** : Cette fonction n'a d'effet que dans l'événement "Exécution du service (appelé en boucle)"
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// --- Exécution du service (appelé en boucle)

// Exécution du service
ExécutionService()	
// Pause de 60 secondes
ServiceTemporise(6000)

CAS EXCEPTION:
	// En cas d'exception, ajoute une erreur dans le journal des événements
	ServiceEcritEvénementJournal(ExceptionInfo, ejErreur)
	// Arrête le service
	FinService(fsDéfaillance)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`FinService([<Option de terminaison>])`
---

**`<Option de terminaison> : (Constante optionnelle de type Entier)`**

Les options de terminaison d'un service sont :



|   |   |
| --- | --- |
| *fsArrêt*<br>(valeur par défaut) | Les différents codes de terminaison sont exécutés puis le service s'arrête normalement. |
| *fsDéfaillance* | Les différents codes de terminaison ne sont pas exécutés et le service s'arrête en provoquant une défaillance.<br>![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) Sous Windows, la gestion des défaillances est effectuée selon les paramètres spécifiés lors de l'installation du service. Pour plus de détails, consultez la variable [Service](../WDLang1/1000017118.md) et la fonction [ServiceInstalle](../WDLang1/1000017099.md). |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Fonctions FinService et FinProgramme
<a name="fonctions_finservice_finprogramme_ELTPARAGRAPHE000055"></a>Dans un service : 

- la fonction **FinService** permet de terminer l'exécution du service en réalisant les opérations suivantes : 

	- paramétrage de l'exécution des codes de terminaison

	- simulation éventuelle d'une défaillance du service qui déclenche les opérations de défaillances de l'OS (relancement automatique ou redémarrage de la machine par exemple en Windows). 




- la fonction [FinProgramme](../WDLang1/3013033.md) peut être utilisée avec les spécificités suivantes :

	- le message est ignoré.

	- les codes de terminaison sont exécutés ou non selon la présence du booléen en dernier paramètre.

	- le service se termine normalement et ne simule pas de défaillance.







Dans une application, la fonction **FinService** peut être utilisée avec les spécificités suivantes :

- aucun message n'est affiché en sortie de l'application. 

- les codes de terminaison sont exécutés ou non selon la présence de l'option de terminaison. 

- l'option de défaillance n'a aucun effet. 










<a name="XComposante"></a>

## Composante :
wd280vm.dll
