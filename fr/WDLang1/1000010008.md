


## TableEnroule (Fonction)

***En anglais : TableCollapse***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Enroule :

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) une branche d'un champ Table hiérarchique précédemment déroulée. Les noeuds "fils" ne sont alors plus visibles dans le champ Table hiérarchique. Les noeuds fils restent dans leur état (enroulé ou déroulé).

- une rupture d'un champ Table précédemment déroulée. Les éléments de la rupture ne sont plus visibles dans le champ Table. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) une fenêtre de détail affichée pour une ligne. Pour plus de détails, consultez [Gérer le détail d'une ligne d'un champ Table](../WDChamp/1013200.md). 




**Rappel** : En exécution, un noeud est enroulé lorsque le signe "+" précède le nom du noeud.

![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Les ruptures ne sont pas disponibles sur les champs Table dans cette version.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
```wl
// Enroule la branche sélectionnée dans le champ Table hiérarchique
TableEnroule(TABLEH_Planning)
```


<a name="Exemple2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
```wl
// Enroule le champ Table hiérarchique "TABLEH_Planning"
TableEnroule(TABLEH_Planning, 1)
// Equivalent à : TableEnrouleTout(TABLEH_Planning)
```


<a name="Exemple3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
```wl
// Enroule la branche spécifiée dans le champ Table hiérarchique
TableEnroule(TABLEH_Planning, "MaRacine" + TAB + "MaBranche")
```


<a name="Exemple4"></a>

```wl
// Enroule la rupture de la ligne en cours dans le champ Table "TABLE_Rupture"
TableEnroule(TABLE_Rupture, TABLE_Rupture)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
### Table hiérarchique : Enrouler une branche en spécifiant le numéro de la ligne

`TableEnroule(<Champ Table hiérarchique> [, <Numéro de la ligne>])`
---

**`<Champ Table hiérarchique> : (Nom de champ)`**

Nom du champ Table hiérarchique à manipuler.

**`<Numéro de la ligne> : (Entier optionnel)`**

Numéro de la ligne contenant la branche à enrouler. Si ce paramètre n'est pas spécifié, la branche contenue dans la ligne en cours est enroulée.  


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
### Table hiérarchique : Enrouler une branche en spécifiant son nom

`TableEnroule(<Champ Table hiérarchique> [, <Nom de la branche>])`
---

**`<Champ Table hiérarchique> : (Nom de champ)`**

Nom du champ Table hiérarchique à manipuler.

**`<Nom de la branche> : (Chaîne de caractères optionnelle)`**

Nom de la branche à enrouler. Ce paramètre est de la forme :

```txt
"<Nom de la racine>" + TAB + ["<Nom du 1er noeud>" + TAB + ...
["<Nom du 2ème noeud>" + TAB + [...]]]"<Nom de la branche>"
```


Si ce paramètre ne correspond pas à une branche existante, une erreur WLangage est générée.

Si ce paramètre n'est pas spécifié, la branche contenue dans la ligne en cours est enroulée.  

Si deux branches correspondent au chemin spécifié, seule la première est enroulée. 


<a name="SYNTAXE3"></a>

### Table avec ruptures : Enrouler une rupture

`TableEnroule(<Champ Table> [, <Numéro de la ligne> [, <Nom de la rupture>]])`
---

**`<Champ Table> : (Nom de champ)`**

Nom du champ Table à manipuler. Ce champ doit posséder une ou plusieurs ruptures. Dans le cas contraire, cette fonction n'a aucun effet.

**`<Numéro de la ligne> : (Entier optionnel)`**

Numéro de la ligne de la rupture à enrouler. Ce numéro doit correspondre soit au numéro de la ligne en cours, soit au numéro de la première ligne de la rupture à enrouler. Si ce paramètre n'est pas spécifié, la rupture de la ligne en cours est enroulée.

**`<Nom de la rupture> : (Chaîne de caractères optionnelle)`**

Nom de la rupture à enrouler. Ce paramètre doit être spécifié dans le cas de ruptures imbriquées. Il permet de définir la rupture qui sera enroulée. Par défaut, si des ruptures sont imbriquées, aucune rupture n'est enroulée.  


<a name="SYNTAXE4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 
### Table et table hiérarchique : enrouler une fenêtre de détail

`TableEnroule(<Champ Table> [, <Numéro de la ligne>])`
---

**`<Champ Table> : (Nom de champ)`**

Nom du champ Table ou Table hiérarchique à manipuler. 

**`<Numéro de la ligne> : (Entier optionnel)`**

Numéro de la ligne dont le détail doit être enroulé. Si ce paramètre n'est pas spécifié, le détail de la ligne en cours est enroulé.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000205"></a>La fonction **TableEnroule** peut être utilisée sur : 

- un champ Table ou Table hiérarchique fichier chargé en mémoire.

- un champ Table ou Table hiérarchique par programmation.   




Cette fonction ne peut pas être utilisée sur les champs Table fichier (accès direct).
<a name="NOTE0_2"></a>


### Branche à enrouler
<a name="branche_enrouler_ELTPARAGRAPHE000228"></a>La fonction **TableEnroule** n'a aucun effet :


|   |   |
| --- | --- |
| Champ Table hiérarchique | Champ Table avec ruptures |
| <br><br>- si la branche à enrouler est introuvable.<br><br>- si la branche à enrouler est une feuille.<br><br>- si la branche à enrouler est déjà enroulée.<br><br><br> | <br><br>- si le champ Table n'a pas de ruptures.<br><br>- si le champ Table contient plusieurs ruptures et si la rupture à enrouler n'est pas indiquée.<br><br>- si aucune ligne n'est sélectionnée dans le champ Table et si le paramètre &lt;Numéro de la ligne&gt; n'est pas spécifié.<br><br><br> |


**Remarque pour les champs Table hiérarchique** : Si le paramètre &lt;Numéro de ligne&gt; ou &lt;Nom de la branche&gt; correspond à la branche contenue dans la première ligne, toute la hiérarchie du champ Table hiérarchique est enroulée (équivalent à la fonction [TableEnrouleTout](../WDLang1/1000010003.md)).
<a name="NOTE0_3"></a>


### Bandeau de sélection
<a name="bandeau_selection_ELTPARAGRAPHE000259"></a>**Pour les champs Table hiérarchique** :

- Si le bandeau de sélection était positionné sur un des éléments du noeud à enrouler, le bandeau se positionne sur le noeud enroulé après l'appel de la fonction **TableEnroule**.

- Le code de modification est appelé à chaque déplacement du bandeau de sélection. Si deux niveaux sont enroulés et si le bandeau de sélection se positionne sur le noeud supérieur, les codes de modification de chacun des niveaux sont exécutés.




**Pour les champs Table avec ruptures**, le bandeau de sélection n'est pas modifié. Il reste sur l'élément en cours même si la rupture est enroulée.
<a name="NOTE0_4"></a>


### Vitesse d'exécution pour les champs Table hiérarchique
<a name="vitesse_execution_pour_les_champs_table_hierarchique_ELTPARAGRAPHE000276"></a>La vitesse d'exécution de la syntaxe 1 est plus rapide que celle de la syntaxe 2.

<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
