
## TélémétrieParamètre (Fonction)

***En anglais : TelemetryConfigure***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Permet de connaître et de modifier les paramètres de la télémétrie. 


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Force l'envoi des données de télémétrie toutes les demi-heures
TélémétrieParamètre(tpPériodeMaximaleCollecte, 1800)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Connaître les paramètres de la télémétrie

`<Résultat> = TélémétrieParamètre(<Paramètre>)`
---

**`<Résultat> : (Entier)`**

Valeur du paramètre spécifié. 

**`<Paramètre> : (Constante de type Entier)`**

Paramètre à récupérer. Ce paramètre correspond à une des constantes suivantes : 


|   |   |
| --- | --- |
| *tpActiveLog* | Paramétrage du log de la télémétrie. Peut correspondre à une combinaison des constantes suivantes : <br><br>- *tpLogFichier* : La télémétrie utilise un log fichier. Le fichier correspondant est enregistré dans le répertoire "&lt;user&gt;\\AppData\\Roaming\\&lt;société&gt;\\&lt;application&gt;". <br>	<br><br>- *tpLogMémoire* : La télémétrie utilise un log mémoire. <br><br><br> |
| *tpDélaiInactivité* | Utilisé pour le comptage du temps d'activité sur une fenêtre : le chronomètre de comptage est automatiquement arrêté au bout de ce délai d'inactivité. <br>Par défaut, ce délai est de 1 minute. |
| *tpEtat* | Etat actuel de la télémétrie. Cet état peut correspondre à une des constantes suivantes : <br><br>- *teAbandon* : la télémétrie est abandonnée après trop d'erreurs d'envoi. <br><br>- *teCollecte* : la télémétrie est active et en cours de collecte. <br><br>- *teEnvoi* : la télémétrie est active et elle a réussi à envoyer des informations. <br><br>- *teErreur* : la télémétrie est active mais l'envoi des informations au serveur a échoué. <br><br>- *teInactive* : la télémétrie est inactive.<br><br><br> |
| *tpModeDéconnecté* | Mode de fonctionnement de la télémétrie : <br><br>- <u><u><u><u>Vrai</u></u></u></u> (valeur par défaut). La télémétrie fonctionne en mode déconnecté. <br><br>- <u><u><u><u>Faux</u></u></u></u>. La télémétrie fonctionne en mode connecté (fonctionnement par défaut avant la version 25). <br><br><br><br><br>Pour plus de détails sur le mode de fonctionnement de la télémétrie, consultez [Télémétrie : Mode d'envoi des données](../WDLang1/1410086649.md). |
| *tpNombreEssaisEnvoi* | Nombre maximal d'essais pour l'envoi des données de télémétrie en mode connecté : <br><br>- 0. Les essais ne sont pas comptés. Les informations sont envoyées à chaque fois, même si le serveur ne répond pas. <br><br>- 1. Les informations sont envoyées une seule fois au lancement de l'application. Si le serveur ne répond pas, il n'y aura pas d'autre essai. <br><br>- autre valeur (3 par défaut). Permet de configurer un nombre total d'essais par rapport à la période maximale d'envoi. <br><br><br><br><br>Par défaut, tpNombreEssaisEnvoi = 3 et tpPériodeMaximaleCollecte = 1 donc il y a 3 heures de tentatives d'envoi. |
| *tpPériodeMaximaleCollecte* | Périodicité maximale de collecte (en secondes) des données de la télémétrie. L'envoi des données sera effectué à la fin de cette période quelle que soit la taille des données collectées. <br>Par défaut, cette période est de 1 heure. |
| *tpPériodeMinimaleCollecte* | Périodicité minimale de collecte (en secondes) des données de télémétrie. L'envoi des données pourra être effectué à la fin de cette période si la taille minimale est atteinte. <br>Par défaut, cette période est de 5 minutes. |
| *tpRécupèreLogMémoire* | Renvoie le contenu du log mémoire. |
| *tpTailleMinimaleCollecte* | Taille minimale (en kilo-octets) des données collectées pour la période minimale de collecte. <br>Par défaut, cette taille est de 5 Mo. |




<a name="SYNTAXE2"></a>

### Modifier les paramètres de la télémétrie

`<Résultat> = TélémétrieParamètre(<Paramètre> , <Nouvelle valeur>)`
---

**`<Résultat> : (Entier)`**

Ancienne valeur du paramètre spécifié.

**`<Paramètre> : (Constante de type Entier)`**

Paramètre à modifier. Ce paramètre correspond à une des constantes suivantes : 


|   |   |
| --- | --- |
| *tpActiveLog* | Paramétrage du log de la télémétrie. Peut correspondre à une combinaison des constantes suivantes : <br><br>- *tpLogFichier* : La télémétrie utilise un log fichier. Le fichier correspondant est enregistré dans le répertoire "&lt;user&gt;\\AppData\\Roaming\\&lt;société&gt;\\&lt;application&gt;". <br><br>- *tpLogMémoire* : La télémétrie utilise un log mémoire. <br><br><br> |
| *tpDélaiInactivité* | Utilisé pour le comptage du temps d'activité sur une fenêtre : le chronomètre de comptage est automatiquement arrêté au bout de ce délai d'inactivité. Par défaut, ce délai est de 1 minute. |
| *tpModeDéconnecté* | Mode de fonctionnement de la télémétrie : <br><br>- <u><u><u><u>Vrai</u></u></u></u> (valeur par défaut). La télémétrie fonctionne en mode déconnecté. <br><br>- <u><u><u><u>Faux</u></u></u></u>. La télémétrie fonctionne en mode connecté (fonctionnement par défaut avant la version 25). <br><br><br><br><br>Pour plus de détails sur le mode de fonctionnement de la télémétrie, consultez [Télémétrie : Mode d'envoi des données](../WDLang1/1410086649.md). |
| *tpNombreEssaisEnvoi* | Nombre maximal d'essais pour l'envoi des données de télémétrie en mode connecté : <br><br>- 0. Les essais ne sont pas comptés. Les informations sont envoyées à chaque fois, même si le serveur ne répond pas. <br><br>- 1. Les informations sont envoyées une seule fois au lancement de l'application. Si le serveur ne répond pas, il n'y aura pas d'autre essai. <br><br>- autre valeur (3 par défaut). Permet de configurer un nombre total d'essais par rapport à la période maximale d'envoi. <br><br><br><br><br>Par défaut, tpNombreEssaisEnvoi = 3 et tpPériodeMaximaleCollecte = 1 donc il y a 3 heures de tentatives d'envoi. |
| *tpPériodeMaximaleCollecte* | Périodicité maximale de collecte (en secondes) des données de la télémétrie. L'envoi des données sera effectué à la fin de cette période quelle que soit la taille des données collectées. Par défaut, cette période est de 1 heure. |
| *tpPériodeMinimaleCollecte* | Périodicité minimale de collecte (en secondes) des données de télémétrie. L'envoi des données pourra être effectué à la fin de cette période si la taille minimale est atteinte. Par défaut, cette période est de 5 minutes. |
| *tpTailleMinimaleCollecte* | Taille minimale (en kilo-octets) des données collectées pour la période minimale de collecte. Par défaut, cette taille est de 5 Mo. |



**`<Nouvelle valeur> : (Entier)`**

Nouvelle valeur du paramètre. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques
La fonction **TélémétrieParamètre** peut être appelée avant la fonction [TélémétrieActive](../WDLang1/1000021900.md). 

Si la fonction **TélémétrieParamètre** est appelée après la fonction [TélémétrieActive](../WDLang1/1000021900.md), les nouveaux paramètres seront pris en compte uniquement après un délai correspondant au temps de collecte minimal précédent.





<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
wdxxxsimu.dll
