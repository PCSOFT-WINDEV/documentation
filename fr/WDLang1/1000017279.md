


## ListeDéplaceLigne (Fonction)

***En anglais : ListMoveLine***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Déplace une ligne ou échange deux lignes d'un champ Liste ou Combo. 

**Remarques** :            

- Pour déplacer une ligne d'un champ Table, utilisez [TableDéplaceLigne](../WDLang1/1000017247.md).

- Pour déplacer une répétition d'un champ Zone répétée, utilisez la fonction [ZoneRépétéeDéplaceLigne](../WDLang2/1000017248.md). 







<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Echange la ligne en cours et la ligne 5
ListeDéplaceLigne(LISTE_Liste1, ligneSélectionnée, 5, tdEchange)
// Déplace la ligne en cours à la ligne 3
ListeDéplaceLigne(LISTE_Liste1, ligneSélectionnée, 3, tdDéplace)
// Echange la ligne en cours avec la ligne suivante
ListeDéplaceLigne(LISTE_Liste1, ligneSélectionnée, tdSuivant, tdEchange)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Déplacement à une position spécifique

`<Résultat> = ListeDéplaceLigne(<Champ Liste> , <Indice de la ligne à déplacer> , <Indice de la ligne destination> [, <Opération à effectuer>])`
---

**`<Résultat> : (Entier)`**

Nouvel indice de la ligne déplacée.

**`<Champ Liste> : (Nom de champ)`**

Nom du champ Liste ou Combo à manipuler.
Si ce paramètre correspond à une chaîne vide (""), le champ manipulé correspond au champ auquel appartient l'événement en cours.

**`<Indice de la ligne à déplacer> : (Entier)`**

Position de la ligne à déplacer. Cette position doit être comprise entre 1 et le nombre de lignes du champ Liste ou Combo (connu par exemple par la fonction [ListeOccurrence](../WDLang1/3049014.md) ou la propriété [Occurrence](../Proprietes/2510097.md)).

Pour déplacer la ligne actuellement sélectionnée, utilisez la constante *ligneSélectionnée*.

**`<Indice de la ligne destination> : (Entier)`**

Nouvelle position de la ligne. Cette position doit être comprise entre 1 et le nombre de lignes du champ Liste ou Combo (connu par exemple par la fonction [ListeOccurrence](../WDLang1/3049014.md) ou la propriété [Occurrence](../Proprietes/2510097.md)). Si ce paramètre n'est pas valide, une erreur fatale est générée.

Pour manipuler la ligne actuellement sélectionnée, utilisez la constante *ligneSélectionnée*.

**`<Opération à effectuer> : (Constante ou combinaison de constantes optionnelle de type Entier)`**

Changement de position de la ligne à effectuer :


|   |   |
| --- | --- |
| *tdAfficheDestination* | La ligne modifiée est affichée dans le champ Liste (ou Combo). Si nécessaire, un défilement automatique des lignes est effectué pour afficher la ligne modifiée. La ligne sélectionnée (bandeau de sélection) n'est pas modifiée.<br>Cette constante peut être combinée avec les constantes *tdDéplace*et *tdEchange*.<br><br><br> |
| *tdDéplace*<br>(valeur par défaut) | La ligne est déplacée vers l'indice de la ligne destination. |
| *tdEchange* | La ligne source et destination sont échangées. |




<a name="SYNTAXE2"></a>

### Déplacement relatif à la position en cours

`<Résultat> = ListeDéplaceLigne(<Champ Liste> , <Indice de la ligne à déplacer> , <Déplacement relatif> [, <Opération à effectuer>])`
---

**`<Résultat> : (Entier)`**



- Nouvel indice de la ligne déplacée, 

- 0 en cas d'erreur.




**`<Champ Liste> : (Nom de champ)`**

Nom du champ Liste à manipuler.
Si ce paramètre correspond à une chaîne vide (""), le champ manipulé correspond au champ auquel appartient l'événement en cours.

**`<Indice de la ligne à déplacer> : (Entier)`**

Position de la ligne à déplacer. Cette position doit être comprise entre 1 et le nombre de lignes du champ Liste (connu par exemple par la fonction [ListeOccurrence](../WDLang1/3049014.md) ou la propriété [Occurrence](../Proprietes/2510097.md)).

Pour manipuler la ligne actuellement sélectionnée, utilisez la constante *ligneSélectionnée*.

**`<Déplacement relatif> : (Constante de type Entier)`**

Permet de réaliser un déplacement ou un échange sur une position relative à l'indice de la ligne à déplacer.


|   |   |
| --- | --- |
| *tdDernier* | Déplace la ligne en dernière position. |
| *tdPagePrécédente* | Déplace la ligne d'une page vers le haut (une page correspond au nombre de lignes pouvant être affichées simultanément dans le champ Liste).<br><br><br> |
| *tdPageSuivante* | Déplace la ligne d'une page vers le bas (une page correspond au nombre de lignes pouvant être affichées simultanément dans le champ Liste).<br><br><br> |
| *tdPrécédent* | Déplace la ligne d'une position vers le haut. |
| *tdPremier* | Déplace la ligne en première position. |
| *tdSuivant* | Déplace la ligne d'une position vers le bas. |


Si ce paramètre est invalide (par exemple utilisation de *tdPrécédent* sur la première ligne du champ Liste), la ligne est déplacée "au plus proche".

**`<Opération à effectuer> : (Constante ou combinaison de constantes optionnelle de type Entier)`**

Changement de position de la ligne à effectuer :


|   |   |
| --- | --- |
| *tdAfficheDestination* | La ligne modifiée est affichée dans le champ Liste. Si nécessaire, un défilement automatique des lignes est effectué pour afficher la ligne modifiée. La ligne sélectionnée (bandeau de sélection) n'est pas modifiée.<br>Cette constante peut être combinée avec les constantes *tdDéplace* et *tdEchange*.<br><br><br> |
| *tdDéplace*<br>(valeur par défaut) | La ligne est déplacée vers l'indice de la ligne destination. |
| *tdEchange* | La ligne source et destination sont échangées. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Fonctionnement sur un champ Combo
<a name="fonctionnement_sur_champ_combo_ELTPARAGRAPHE000231"></a>Lorsque la fonction **ListeDéplaceLigne** est utilisée sur un champ Combo, l'élément sélectionné reste le même. L'indice de l'élément sélectionné dans la liste déroulée (c'est-à-dire la valeur renvoyée par le champ Combo) est modifié.
<a name="NOTE0_2"></a>


### Champ Liste multisélection
<a name="champ_liste_multiselection_ELTPARAGRAPHE000243"></a>Si la fonction **ListeDéplaceLigne** est utilisée sur un champ Liste multisélection :

- lors d'un déplacement de lignes (constante *tdDéplace*) : toutes les lignes sélectionnées seront déplacées.

- lors d'un échange de lignes (constante *tdEchange*) : seule la première ligne va être échangée.

- la constante *ligneSélectionnée* ne peut pas être utilisée. Dans le cas contraire, une erreur fatale est affichée et aucune ligne n'est déplacée.



<a name="NOTE0_3"></a>


### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000259"></a>**Attention** : La fonction **ListeDéplaceLigne** ne retourne pas de code d'erreur. Pour savoir si cette fonction a généré une erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
