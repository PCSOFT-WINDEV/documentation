


## dSauveImageJPEG (Fonction)

***En anglais : dSaveImageJPEG***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Sauve une image :

- soit dans un fichier au format JPEG.

- soit en mémoire.




Cette image correspond à l'image contenue :

- soit dans un champ Image.

- soit dans une variable de type [Image](../WDLang1/1000019650.md).
	

- soit dans un champ Code-barres.
	![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Dans cette version, les champs de type Code-barres ne sont pas disponibles. Il n'est donc pas possible de sauver une image contenue dans un champ Code-barres.

- soit dans un champ Web Caméra.




**Remarques** :

- Seule la partie visible du champ Image est sauvegardée.

- Cette fonction permet uniquement de sauvegarder des images pour des résolutions d'écran allant jusqu'à 32 bits.

- Cette fonction ne peut pas être utilisée avec les champs Image présents dans les états.

- Cette fonction permet également d'enregistrer les modifications effectuées sur les marqueurs Exif d'une image à l'aide de la fonction [ImageInfoModifie](../WDLang1/3091005.md).

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) La sauvegarde d'images au format JPEG est supportée uniquement si l'application est exécutée par la machine virtuelle Java (JVM) distribuée par SUN. Cette sauvegarde ne fonctionne pas avec d'autres machines virtuelles Java. 


![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) **Attention** : L'utilisation de cette fonction sous Linux nécessite une configuration spécifique. Pour plus de détails, consultez [Les dessins](../WDLang1/3029035.md). 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=1000003029038&name=dsauveimagejpeg_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// Sauve en mémoire l'image présente dans "IMG_ImageDessin"
ResSauvegarde = dSauveImageJPEG(IMG_ImageDessin, enMémoire)
```


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Sauve l'image présente dans "IMG_ImageDessin" sur "C:\Documents\Image.JPEG"
ResSauvegarde = dSauveImageJPEG(IMG_ImageDessin, "C:\Documents\Image.JPEG")
```


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Modification des commentaires de l'image
// affichée dans le champ Image "IMG_MonChampImage"
ImageInfoModifie(IMG_MonChampImage, imgCommentaire, "Belles gorgones")
// Enregistrement de la modification dans le 
// fichier "C:\Plongees\Gorgone1.JPG"
dSauveImageJPEG(IMG_MonChampImage, "C:\Plongees\Gorgone1.JPG", 100, imgSauveInformation)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Sauvegarder une image dans un fichier au format JPEG

`<Résultat> = dSauveImageJPEG(<Image> , <Nom du fichier> [, <Qualité> [, <Marqueur Exif>]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'image a été sauvegardée, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Image> : (Nom de champ ou variable de type Image)`**



- Nom du champ Image, Code-barres ou Web Caméra à manipuler. Les champs Image présents dans un état ne peuvent pas être utilisés. 

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Nom du champ Image à manipuler.

- Nom de la variable de type [Image](../WDLang1/1000019650.md) à manipuler.
	




**`<Nom du fichier> : (Chaîne de caractères)`**

Nom et chemin complet (ou relatif) du fichier JPEG. Un chemin de type UNC peut être utilisé. L'extension du fichier n'est pas obligatoire.

**Attention** : 

- Pour que l'image soit sauvée, le répertoire de destination doit exister.

- L'existence du fichier JPEG n'est pas vérifiée. Si ce fichier existe, il est automatiquement écrasé.




**`<Qualité> : (Entier optionnel)`**

Qualité de l'image sauvegardée. Valeur comprise entre 1 et 100 (80 par défaut). Plus la qualité de l'image sera faible, plus le taux de compression de l'image sera élevé et plus la taille du fichier sera petite.

**`<Marqueur Exif> : (Constante (ou combinaison de constantes) optionnelle)`**

Enregistrement des marqueurs Exif modifiés à l'aide de la fonction [ImageInfoModifie](../WDLang1/3091005.md) :


|   |   |
| --- | --- |
| *imgAjouteVignette* | Ajoute une vignette dans le fichier image &lt;Nom du fichier&gt;.<br>Si une vignette est présente dans le fichier image affiché dans le champ Image, cette constante n'est pas prise en compte.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *imgJPEGProgressif* | Permet de sauvegarder l'image au format JPEG progressif. Ce format est notamment utilisé pour les sites Web. Il permet un chargement plus rapide des pages (les images étant chargées et affichées progressivement).<br><br> |
| *imgNiveauDeGris* | Permet de sauvegarder l'image en noir et blanc (mode d'affichage "Niveau de gris").<br><br> |
| *imgSauveInformation* | Enregistre les marqueurs Exif.<br>Si une vignette est présente dans le fichier image affiché dans le champ Image, une nouvelle vignette est recalculée.<br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |


Par défaut, les marqueurs Exif ne sont pas enregistrés, aucune opération sur les vignettes n'est réalisée.

![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Ce paramètre n'est pas disponible.


<a name="SYNTAXE2"></a>
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Syntaxe non disponible
### Sauvegarder une image en mémoire

`<Résultat> = dSauveImageJPEG(<Image> , <enMémoire> [, <Qualité> [, <Marqueur Exif>]])`
---

**`<Résultat> : (Buffer)`**

Chaîne d'octets contenant l'image au format JPEG.
Cette chaîne d'octets peut être par la suite affectée à un champ Image, enregistrée dans un fichier (fonction [fSauveTexte](../WDLang1/3036046.md)), envoyée à travers un réseau (grâce aux [fonctions Socket](../WDLang3/3070007.md)), ...



**`<Image> : (Nom de champ ou variable de type Image)`**



- Nom du champ Image, Code-barres ou Web Caméra à manipuler. Les champs Image présents dans un état ne peuvent pas être utilisés. 

- ![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Nom du champ Image à manipuler.

- Nom de la variable de type [Image](../WDLang1/1000019650.md) à manipuler.
	




**`<enMémoire> : (Constante)`**

*enMémoire* : Constante permettant de sauvegarder une image en mémoire.

**`<Qualité> : (Entier optionnel)`**

Qualité de l'image sauvegardée. Valeur comprise entre 1 et 100 (80 par défaut). Plus la qualité de l'image sera faible, plus le taux de compression de l'image sera élevé et plus la taille du fichier sera petite.

**`<Marqueur Exif> : (Constante (ou combinaison de constantes) optionnelle)`**

Enregistrement des marqueurs Exif modifiés à l'aide de la fonction [ImageInfoModifie](../WDLang1/3091005.md) :


|   |   |
| --- | --- |
| *imgAjouteVignette* | Ajoute une vignette dans le fichier image &lt;Nom du fichier&gt;.<br>Si une vignette est présente dans le fichier image affiché dans le champ Image, cette constante n'est pas prise en compte.<br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |
| *imgJPEGProgressif* | Permet de sauvegarder l'image au format JPEG progressif. Ce format est notamment utilisé pour les sites Web. Il permet un chargement plus rapide des pages (les images étant chargées et affichées progressivement).<br><br><br><br> |
| *imgSauveInformation* | Enregistre les marqueurs Exif.<br>Si une vignette est présente dans le fichier image affiché dans le champ Image, une nouvelle vignette est recalculée.<br><br>![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) Cette constante n'est pas disponible. |


Par défaut, les marqueurs Exif ne sont pas enregistrés, aucune opération sur les vignettes n'est réalisée.

Ce paramètre est disponible uniquement si &lt;Nom du champ&gt; correspond au nom d'un champ Image.





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Image présente dans un champ Web Caméra
<a name="image_presente_dans_champ_web_camera_ELTPARAGRAPHE000423"></a>Seule l'image affichée au moment de l'exécution de la fonction **dSauveImageJPEG** est sauvegardée. Pour sauvegarder cette image, il est également possible d'utiliser :

- la fonction [VidéoCapture](../WDLang1/3079007.md) : l'image sera sauvegardée au format BMP

- la fonction [dSauveImageBMP](../WDLang1/3029026.md) : l'image sera sauvegardée soit au format BMP, soit en mémoire

- la fonction [dSauveImageGif](../WDLang1/3029040.md) : l'image sera sauvegardée soit au format Gif, soit en mémoire

- la fonction [dSauveImagePNG](../WDLang1/3029027.md) : l'image sera sauvegardée soit au format PNG, soit en mémoire.



<a name="NOTE0_2"></a>
<a name="NOTE0_3"></a>

<a name="XComposante"></a>

## Composante :
wd280pnt.dll
