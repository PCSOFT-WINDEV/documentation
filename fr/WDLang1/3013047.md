
## Son (Fonction)

***En anglais : Sound***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Joue un son au format WAV. Ce son peut être :

- stocké sur le disque.

- intégré dans la bibliothèque (.WDL).

- présent dans un mémo HFSQL.




Cette fonction permet également de : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) jouer un son système. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) jouer un son d'une fréquence donnée pendant le temps désiré.




**Remarque** : Une carte son doit être installée sur le poste. Le son sera joué en fonction des paramètres de Windows (volume, balance, qualité du rendu, etc.).








<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
// Joue le son contenu dans le fichier "TADA.WAV"
Son("Tada.wav")
// Joue en bloquant sur carte sonore
Son("tada.wav", sonBloque)
// Joue en bouclant sur carte sonore
Son("C:\MSOFFICE\Sons\Voiture.wav", sonBoucle)
```


<a name="Exemple3"></a>




<a name="Exemple4"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 
```wl
// Jouer un son d'une fréquence donnée
BOUCLE (10)
	POUR nIndice = 1 A 5536 PAS 100
		Son(nIndice, 1)
	FIN
	POUR nIndice = 5536 A 1 PAS -100
		Son(nIndice, 1)
	FIN
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Jouer un fichier .WAV

`Son(<Nom du fichier WAV> [, <Option>])`
---

**`<Nom du fichier WAV> : (Chaîne de caractères)`**

Nom complet ou relatif du fichier à jouer. Ce fichier peut être : 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) un fichier WAV.

- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) un fichier au format mp3, wav, wma ou m4a. 




Remarques : 


- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Il n'est pas possible de jouer un fichier WAV se trouvant dans une rubrique mémo HFSQL.




**`<Option> : (Constante optionnelle de type entier)`**

Mode d'exécution du son :


|   |   |
| --- | --- |
| *sonBloque* | Le code est bloqué tant que le son n'est pas complètement joué. |
| *sonBoucle* | Le son est joué en boucle.<br><br>Attention : Le fichier à jouer doit être présent sur le disque et non dans la bibliothèque (fichier WDL). |
| *sonDéfaut*<br>(Valeur par défaut) | Le code continue de s'exécuter dès que le son est lancé. |




<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Jouer un son système

`Son(<Son système>)`
---

**`<Son système> : (Constante)`**

Son prédéfini du système à jouer : 


|   |   |
| --- | --- |
| *sonSystèmeArrêtCritique* | Son système correspondant à l'arrêt critique du poste. |
| *sonSystèmeAstérisque* | Son système astérisque. |
| *sonSystèmeDéfaut* | Son par défaut du système (bip en général). |
| *sonSystèmeExclamation* | Son système exclamation. |
| *sonSystèmeFermeture* | Son système de fermeture de Windows. |
| *sonSystèmeQuestion* | Son système question. |




<a name="SYNTAXE3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Jouer un son d'une fréquence donnée pendant le temps désiré

`<Résultat> = Son(<Fréquence> , <Durée>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le son a bien été joué, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




Remarque : Jusqu'à Windows 7, le son est joué sur le haut-parleur interne du PC. A partir de Windows 7, le son est joué sur la carte son.  

**`<Fréquence> : (Entier sans signe)`**

Fréquence du son en Hertz.

Remarque : Pour les versions inférieures à Windows 7, seules les fréquences audibles peuvent être utilisées (entre 37 et 32767).

**`<Durée> : (Entier sans signe)`**

Durée en millisecondes pendant laquelle le son est émis. Attention : le son est bloquant. Ce paramètre peut correspondre à : 

- un entier correspondant au nombre de millisecondes, 

- une variable de type Durée, 

- l'indication directe de la durée (par exemple 1 s ou 10 ms). 










<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Arrêt d'un son non bloquant
<a name="arret_son_non_bloquant_ELTPARAGRAPHE000243"></a>Un son exécuté en mode non bloquant peut être arrêté par le code suivant, appelé par exemple sur une action de l'utilisateur (clic, modification d'un champ, etc.) : 


```wl
Son("")
```

<a name="NOTE0_2"></a>


### Taille des fichiers son
<a name="taille_des_fichiers_son_ELTPARAGRAPHE000252"></a>L'utilisation de fichiers WAV d'une taille importante peut provoquer plusieurs problèmes (pas assez de mémoire vive pour charger le son, arrêt du système selon la version de Windows, etc.). Pour des fichiers ".WAV" importants (plusieurs dizaines de mégas), il est conseillé d'utiliser les [fonctions MCI](../WDLang1/3051010.md).
<a name="NOTE0_3"></a>


### Son bloquant
<a name="son_bloquant_ELTPARAGRAPHE000262"></a>Un son est nécessairement bloquant :

- Si le son est stocké dans une bibliothèque WINDEV (fichier .WDL).

- Si le son est issu d'un mémo binaire.



<a name="NOTE0_4"></a>


### Son et composant
<a name="son_composant_ELTPARAGRAPHE000272"></a>Par défaut, la fonction **Son** est non bloquante. Pour utiliser la fonction **Son** dans un composant sans bloquer l'application, il faut respecter les contraintes suivantes :

- Le fichier correspondant au son ne doit pas être présent dans la WDL ou dans le composant.

- Le fichier correspondant au son doit être présent dans le répertoire EXE de l'application.




<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
