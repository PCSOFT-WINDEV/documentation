


## WDADMINEXE : Contrôle de l'application à distance
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000169"></a>
Le contrôle à distance d'une application WINDEV permet au responsable d'une application utilisée en réseau : 

- [de gérer l'arrêt (automatique ou forcé) de l'application](#NOTE2_1) pour tous les utilisateurs en cours. Cet arrêt de l'application peut être nécessaire par exemple lors d'une mise à jour de l'application ou de la base de données.
	Pour plus de détails, consultez le [Principe du contrôle à distance](../WDLang1/3013006.md).
	**Remarque** : Il est possible de personnaliser la gestion du contrôle à distance grâce à la fonction [AppliContrôle](../WDLang1/3013003.md) du WLangage.

- [de gérer la fréquence de vérification des mises à jour](#NOTE4_1).




Le paramétrage de cette gestion s'effectue dans l'onglet "Contrôle" de WDADMINEXE.

**Important** : Si les options de contrôle à distance sont modifiées directement dans le programme d'administration "WDADMINEXE", ces options seront réinitialisées à chaque installation avec les options spécifiées lors de la création du programme d'installation.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Etat de l'application
<a name="etat_application_ELTTEXTE000193"></a>
L'onglet "Contrôle" de WDADMINEXE permet de gérer l'état de l'application et les messages affichés selon l'état de l'application : 

![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDAdminExe%20-%20HC%20N%B0001.gif)


- **Fonctionnement normal** : la gestion de la déconnexion des utilisateurs de l'application sera automatique. Pour plus de détails, consultez [Gestion de déconnexion automatique](#NOTE2_1).

- **Connexion interdite** : les utilisateurs ne pourront pas se connecter à l'application. Lors de l'exécution de l'application, le message associé à la connexion interdite s'affichera pendant la "durée d'affichage des messages" spécifiée.
	Les utilisateurs déjà connectés pourront utiliser l'application normalement.

- **Avertissement d'un arrêt imminent** : le message d'avertissement associé s'affichera sur les postes utilisateurs connectés actuellement à l'application. Ce message s'affichera :

	- pendant la "durée d'affichage des messages" spécifiée.

	- à chaque fois que l'application vérifiera son état en se connectant au poste serveur. Cette vérification est effectuée à intervalle de temps régulier (défini dans l'option "Délai de vérification de l'état").
			Si des utilisateurs tentent de se connecter à l'application, le message associé à la connexion interdite s'affichera.




- **Arrêt forcé** : le message d'arrêt forcé associé s'affichera sur les postes utilisateurs connectés actuellement à l'application. Ce message s'affichera :

	- pendant la "durée d'affichage des messages" spécifiée.

	- dès que l'application vérifiera son état en se connectant au poste serveur. Cette vérification est effectuée à intervalle de temps régulier (défini dans l'option "Délai de vérification de l'état").
			Après l'affichage du message, les utilisateurs seront automatiquement déconnectés et ne pourront pas se reconnecter.
			Si des utilisateurs tentent de se connecter à l'application, le message associé à la connexion interdite s'affichera.







Les options de durée des contrôles sont les suivantes : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDAdminExe%20-%20HC%20N%B0001%201.gif)


- **Délai de vérification de l'état** : Dans une application installée en réseau, l'application utilisateur vérifie à intervalle de temps régulier : 

	- son état en fonction de l'application serveur (application de référence).

	- si une mise à jour est disponible (après mise à jour de l'application de référence).




- **Durée d'affichage des messages** : Les différents messages de WDADMINEXE (message de connexion interdite, d'avertissement d'un arrêt imminent et d'arrêt forcé) sont affichés pendant une durée spécifiée. Les utilisateurs peuvent fermer la fenêtre affichant ce message avant la fin de la durée spécifiée.




Remarque : Lors de l'installation d'une mise à jour de l'application, les paramètres modifiés dans WDADMINEXE sont conservés. Pour retrouver les valeurs spécifiées lors de la préparation de l'installation, cliquez sur le lien "Rétablir les valeurs par défaut". 

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Gestion de déconnexion des utilisateurs automatique
<a name="gestion_deconnexion_des_utilisateurs_automatique_ELTTEXTE000217"></a>
Pour que la gestion de la déconnexion des utilisateurs de l'application soit automatique, il suffit de sélectionner l'option "Fonctionnement normal".

Si cette option est sélectionnée, lors de la mise à jour **obligatoire** de l'application sur le poste serveur, les opérations suivantes sont automatiquement réalisées :

- Les utilisateurs connectés actuellement à l'application sont listés.

- Dès que l'application utilisateur vérifiera son état en se connectant au poste serveur, le message d'avertissement d'arrêt imminent s'affichera sur les postes utilisateurs. Ce message s'affichera pendant la durée d'affichage des messages spécifiée.

- Après que tous les utilisateurs aient reçu le message d'avertissement d'arrêt imminent, la mise à jour de l'application sur le poste serveur passe en mode "Arrêt forcé" pendant deux minutes.

- Pendant ces deux minutes, le message d'arrêt forcé s'affichera sur les postes utilisateurs.

- Après ces deux minutes, les utilisateurs seront automatiquement déconnectés et ne pourront pas se reconnecter jusqu'à la fin de la mise à jour de l'application sur le poste serveur.

- Après que la mise à jour de l'application sur le poste serveur soit effectuée, les utilisateurs se reconnectant à l'application devront mettre à jour leur application utilisateur.




Si cette option est sélectionnée, lors de la mise à jour **non obligatoire** de l'application sur le poste serveur, les opérations suivantes sont automatiquement réalisées :

- La mise à jour de l'application sur le poste serveur s'effectue normalement.

- Les utilisateurs connectés actuellement à l'application ne seront pas déconnectés.

- Après que la mise à jour de l'application sur le poste serveur soit effectuée, les utilisateurs se reconnectant à l'application pourront au choix installer la mise à jour ou lancer directement l'application.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Vérification des mises à jour
<a name="verification_des_mises_jour_ELTTEXTE000241"></a>
L'onglet "Contrôle" de WDADMINEXE permet de gérer la vérification des mises à jour : 

![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WDAdminExe_2%20-%20HC%20N%B0001.gif)


Par défaut, la vérification de la disponibilité éventuelle d'une mise à jour sur le serveur est effectuée à chaque lancement de l'application. Cette fréquence de vérification est paramétrable. Elle peut être effectuée : 

- A chaque ouverture de l'application. 

- Tous les X jours. 




Une application installée via une installation réseau vérifie à chaque lancement si une mise à jour est disponible sur le serveur de référence. 

- Si une version plus récente est disponible sur le serveur, la mise à jour de l'application est proposée à l'utilisateur final. 

- Si la connexion réseau n'est pas trouvée à l'ouverture de l'application, le traitement par défaut est d'afficher un message d'avertissement. 
	Ce message peut être inutile dans le cadre d'une application utilisée sur un portable, connecté par intermittence. Dans ce cas, il suffit de sélectionner l'option "Vérification silencieuse : Ne pas informer l'utilisateur"





