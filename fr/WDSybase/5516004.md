
## Connecteur Natif Sybase : Spécificités et remarques 
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000407"></a>
Les paragraphes suivants présentent les remarques générales et les spécificités de Connecteur Natif Sybase.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Remarques générales
<a name="remarques_generales_ELTTEXTE000431"></a>


### Version nécessaire
<a name="version_necessaire_ELTPARAGRAPHE000018"></a>**Attention** : Cette version du Connecteur Natif Sybase ne fonctionne qu'avec WINDEV 28 et/ou WEBDEV 28.


<a name="NOTE2_2"></a>


### Rubriques Unicode
<a name="rubriques_unicode_ELTPARAGRAPHE000030"></a>Les rubriques Unicode ne sont pas gérées par le Connecteur Natif Sybase. Il est conseillé d'utiliser des rubriques texte au format Ansi et de réaliser si nécessaire la conversion avec la fonction [UnicodeVersAnsi](../WDLang1/3024025.md).

La fonction [HCréation](../WDLang4/3044255.md) affichera un message d'erreur lors de la création de fichiers contenant des rubriques au format Unicode.


<a name="NOTE2_3"></a>


### Code de page
<a name="code_page_ELTPARAGRAPHE000046"></a>Par défaut le code de page (charset) utilisé par le Connecteur Natif Sybase est cp850. Si le serveur utilise un autre code de page, vous pouvez paramétrer le charset utilisé par le Connecteur Natif.

Le code de page (charset) utilisé par le client Sybase :

- soit dans WDSYBINS.INI (présent dans le répertoire "C:\\Windows") :
	Spécifier le charset à utiliser dans l'entrée 'CHARSET' de la section correspondant au nom du serveur. Par exemple :
	
	```txt
	[MARS]
	CHARSET=iso_1
	```


- soit dans les informations étendues de connexion : CHARSET=iso_1





<a name="NOTE2_4"></a>


### Le blocage d'un fichier se fait dans une transaction
<a name="blocage_fichier_fait_dans_une_transaction_ELTPARAGRAPHE000063"></a>La fonction [HBloqueFichier](../WDLang4/3044153.md) débute une transaction avant de bloquer la table en mode Exclusif. La fonction [HDébloqueFichier](../WDLang4/3044160.md) valide la transaction et débloque la table.


<a name="NOTE2_5"></a>


### Spécifier le timeout d'exécution des requêtes
<a name="specifier_timeout_execution_des_requetes_ELTPARAGRAPHE000077"></a>Pour spécifier le timeout d'exécution des requêtes :

- en mode SQL (fonction [SQLExec](../WDLang4/3072007.md)), il est nécessaire de saisir dans le fichier "WDSYBINS.INI" situé dans le répertoire de Windows la ligne suivante dans l'entrée "[OPTIONS]" : 
	
	```txt
	TIMEOUT = <Timeout en secondes>
	```
Par défaut, ce timeout est égal à 60 secondes.
	Pour définir une attente infinie, saisissez la ligne suivante :
	
	```txt
	NOWAIT = Y
	```


- avec les fonctions HFSQL (fonctions [HAjoute](../WDLang4/3044147.md), [HExécuteRequête](../WDLang4/3044080.md), ...), il suffit d'indiquer ce timeout dans la fenêtre de description de la connexion utilisée.




Il est également possible de spécifier le timeout d'exécution des requêtes grâce aux options "WD Connect Timeout et "WD Command Timeout" des fonctions [HDécritConnexion](../WDLang4/3044205.md) et [HOuvreConnexion](../WDLang4/3044107.md).


<a name="NOTE2_6"></a>


### Requêtes de type INSERT et Identifiant automatique
<a name="requetes_type_insert_identifiant_automatique_ELTPARAGRAPHE000118"></a>Les requêtes de type INSERT (créées par programmation ou grâce à l'éditeur de requêtes) ne gèrent pas les identifiants automatiques. Pour utiliser un identifiant automatique, utilisez la fonction [HAjoute](../WDLang4/3044147.md) sur la table.


<a name="NOTE2_7"></a>


### Numéro d'enregistrement
<a name="numero_enregistrement_ELTPARAGRAPHE000129"></a>Il n'est pas possible de spécifier un numéro d'enregistrement différent de zéro dans les fonctions [HEcrit](../WDLang4/3044092.md) et [HLit](../WDLang4/3044047.md). Le numéro d'enregistrement "zéro" correspond à l'enregistrement en cours.

De même, les fonctions [HBloqueNumEnr](../WDLang4/3044152.md) et [HDébloqueNumEnr](../WDLang4/3044194.md) ne peuvent être utilisées que sur l'enregistrement en cours.



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Spécificités générales
<a name="specificites_generales_ELTTEXTE000491"></a>


### Options de l'analyse
<a name="options_analyse_ELTPARAGRAPHE000153"></a>

- Les options de l'analyse concernant les index full-text ne sont pas gérées par le Connecteur Natif.

- Les options de l'analyse concernant l'indexation partielle des mémos texte ne sont pas gérées par le Connecteur Natif.

- Que les options "Sensible à la casse", "Sensible à l'accentuation", "Sensible à la ponctuation" soient cochées ou non dans l'éditeur d'analyses, ***la recherche sera toujours sensible à la casse, à l'accentuation et à la ponctuation***. 





<a name="NOTE3_2"></a>


### Rubriques de type Tableau
<a name="rubriques_type_tableau_ELTPARAGRAPHE000163"></a>Les rubriques de type Tableau ne sont pas gérées par le Connecteur Natif. Si vous utilisez une rubrique tableau, seule la valeur de l'indice 1 du tableau sera manipulable avec les fonctions HFSQL (en écriture et en lecture).


<a name="NOTE3_3"></a>


### Contexte HFSQL indépendant
<a name="contexte_hfsql_independant_ELTPARAGRAPHE000171"></a>La gestion des contextes HFSQL indépendants (case à cocher disponible dans la description des fenêtres et des états) n'est pas disponible dans cette version.


<a name="NOTE3_4"></a>


### Enregistrements identiques
<a name="enregistrements_identiques_ELTPARAGRAPHE000179"></a>Le Connecteur Natif Sybase n'est pas capable de différencier deux enregistrements identiques (dont les valeurs de toutes les rubriques sont égales, sans tenir compte des rubriques de type mémo).

En cas de modification ou de suppression d'enregistrement, tous les enregistrements identiques seront modifiés ou supprimés.


<a name="NOTE3_5"></a>


### Blocage des enregistrements
<a name="blocage_des_enregistrements_ELTPARAGRAPHE000189"></a>Les options de blocage (***HBlocageEcriture*** et ***HBlocageLectureEcriture***) sont ignorées sur les fonctions de lecture (**HLitXXX**, **HLitRechercheXXX**). Cependant, ces options de blocage peuvent être utilisées avec les fonctions [HAjoute](../WDLang4/3044147.md) et [HModifie](../WDLang4/3044042.md).


Si un enregistrement est ajouté ou modifié avec une option de blocage, cet enregistrement est bloqué :

- pour tous les autres utilisateurs

- pour l'auteur de l'ajout ou de la modification, si les fonctions [HLitPremier](../WDLang4/3044051.md) et [HLitRecherchePremier](../WDLang4/3044036.md) sont utilisées sur cet enregistrement. Si la fonction [HLit](../WDLang4/3044047.md) est utilisée sur ce même enregistrement, l'enregistrement ne sera pas bloqué pour l'auteur de la modification ou de l'ajout.




**Remarque** : Pour débloquer l'enregistrement (pour tous les utilisateurs), utilisez la fonction [HDébloqueNumEnr](../WDLang4/3044194.md)(hnumEnrEnCours).

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Spécificités concernant les fonctions HFSQL
<a name="specificites_concernant_les_fonctions_hfsql_ELTTEXTE000539"></a>
Les spécificités concernant l'utilisation des fonctions HFSQL avec le Connecteur Natif Sybase sont les suivantes :

| Limitations | Fonctions concernées |
| --- | --- |
| La constante *hAffecteParcours* n'est pas prise en compte. A la fin de l'opération, le parcours continue à partir de l'enregistrement en cours avant l'ajout ou la modification. | [HAjoute](../WDLang4/3044147.md), [HModifie](../WDLang4/3044042.md) |
| La constante *hDistinct* n'est pas prise en compte : tous les enregistrements (y compris les doublons) sont parcourus. | [HAvance](../WDLang4/3044154.md), [HRecule](../WDLang4/3044126.md),<br>[HLitPrécédent](../WDLang4/3044048.md), [HLitSuivant](../WDLang4/3044037.md)<a name="?"></a><br>, [HSuivant](../WDLang4/3044027.md) |
| **Requête multi-fichiers.** Les fonctions **HAjoute**, **HModifie** et **HSupprime** ne sont pas supportées. | [HAjoute](../WDLang4/3044147.md)<br>[HModifie](../WDLang4/3044042.md)<br>[HSupprime](../WDLang4/3044018.md) |
| Les fonctions **HRecherche**, **HPremier**, **HSuivant** permettent de se positionner sur un enregistrement sans le lire.<br>Ces fonctions lisent également l'enregistrement. | [HRecherche](../WDLang4/3044130.md)<br>[HPremier](../WDLang4/3044113.md)<br>[HSuivant](../WDLang4/3044027.md) |
| Après une erreur de doublons sur la fonction **HModifie**, la fonction **HLit** (utilisée avec la constante *hNumEnrEnCours*) ne lit pas l'enregistrement demandé.<br>Ce problème sera corrigé dans une prochaine version. | [HLit](../WDLang4/3044047.md) |
| La constante *hForceIDAuto* n'est pas prise en compte avec la fonction [HModifie](../WDLang4/3044042.md). Sybase n'autorise pas à modifier une colonne de type "IDENTITY". | [HModifie](../WDLang4/3044042.md) |





<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Remarques spécifiques à la base de données Sybase
<a name="remarques_specifiques_base_donnees_sybase_ELTTEXTE000563"></a>


### Colonne agrégat
<a name="colonne_agregat_ELTPARAGRAPHE000302"></a>Une colonne agrégat (SUM, MIN, etc) ne peut pas être utilisée dans une clause WHERE (dans l'éditeur de requêtes, dans les fonctions [HFiltre](../WDLang4/3044100.md), [HLitRecherche](../WDLang4/3044050.md), [HExécuteRequêteSQL](../WDLang4/3044084.md) et [SQLExec](../WDLang4/3072007.md)).


**Solution de contournement** : Pour utiliser une colonne agrégat, il suffit de remplacer la clause WHERE par la clause HAVING GROUP BY.


<a name="NOTE5_2"></a>


### Colonne de type IDENTITY
<a name="colonne_type_identity_ELTPARAGRAPHE000324"></a>En mode SQL (fonctions [SQLExec](../WDLang4/3072007.md) ou [HExécuteRequêteSQL](../WDLang4/3044084.md)), pour insérer une valeur dans une colonne de type IDENTITY, il suffit de :

- faire précéder la requête de la syntaxe suivante : SET IDENTITY_INSERT &lt;NomTable&gt; ON

- faire suivre la requête de la syntaxe suivante : SET IDENTITY_INSERT &lt;NomTable&gt; OFF




Par exemple, pour insérer la valeur "12" dans la colonne "IDClient" de la table "Client", utilisez la syntaxe suivante :


```wl
SQLExec("SET IDENTITY_INSERT Client ON INSERT INTO Client(IDClient)" + ...
		" VALUES (12) SET IDENTITY_INSERT Client OFF", "Req1")
```



<a name="NOTE5_3"></a>


### Sensibilité à la casse des noms de table et de colonne
<a name="sensibilite_casse_des_noms_table_colonne_ELTPARAGRAPHE000345"></a>Il est nécessaire de respecter la casse des noms de table et de colonne :

- dans les requêtes exécutées par les fonctions [HExécuteRequêteSQL](../WDLang4/3044084.md) ou [SQLExec](../WDLang4/3072007.md).

- dans le paramètre "Condition de sélection" de la fonction [HFiltre](../WDLang4/3044100.md).







