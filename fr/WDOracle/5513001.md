
## Paramétrage de la connexion avec WDORAINS (paramétrage optionnel)
			

<DIV class="specObsolete">
	<IMG style="float:left;margin-right:10px;" src="https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=warning_big.png"><B>Avertissement</B><BR>
	 Pour compatibilité avec les versions précédentes du Connecteur Natif Oracle (également appelé Accès Natif Oracle), il est toujours possible de configurer la connexion dans le logiciel WDORAINS (livré avec le Connecteur Natif Oracle).
WDORAINS permet également de configurer certaines options spécifiques du Connecteur Natif.

**Il est désormais recommandé d'utiliser**&nbsp;: 

- [Instant Client](../WDOracle/5513011.md) pour la partie cliente Oracle,

- les [informations optionnelles](../WDLang4/9000124.md) de connexion pour les réglages.



</DIV><a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000200"></a>
Ce logiciel est livré : 

- en 32 bits : WDORAINS.EXE

- en 64 bits : WDORAINS64.EXE




A partir de la version 8, l'utilisation de WDORAINS n'est plus obligatoire.

**Rappel** : Le paramétrage de la connexion réalisé par WDORAINS doit être effectué une seule fois.

Cette page présente :

- [le paramétrage d'une connexion](#NOTE2_1).

- [la définition des options d'une connexion](#NOTE3_1).

- [le test d'une connexion](#NOTE4_1).






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Paramétrage d'une connexion
<a name="parametrage_une_connexion_ELTTEXTE000239"></a>
Pour paramétrer la connexion :

1. Lancez WDORAINS (32 bits ou 64 bits). 

2. Dans la fenêtre qui s'ouvre (elle liste les différentes connexions existantes), cliquez sur le bouton "Ajouter" pour créer une nouvelle connexion. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Parametrage.gif)


3. Donnez les paramètres de la connexion : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Connexion.gif)





- Choisissez le **nom de la source de données**. Ce nom sera passé en paramètre à la fonction [SQLConnecte](../WDLang4/3072005.md) pour se connecter à la base. Si la connexion a été définie dans l'éditeur d'analyses de WINDEV ou WEBDEV, indiquez le nom de la connexion correspondante.

- Ajoutez un libellé de **description**

- Spécifiez une **chaîne de connexion**. Cette chaîne de connexion va permettre à SQL\*Net de retrouver la base de données. Sa valeur doit être fournie par l'administrateur de la base Oracle. Exemple de chaîne de connexion : "OracleServeur". Dans ce cas, "OracleServeur" est l'alias vers le serveur défini dans SQL\*Net.

- Indiquez si vous voulez conserver la **compatibilité 5.5 pour le format des dates**. 
	Rappel : Entre la version 5.5 et 5.5B, le format de date renvoyé a été modifié. Si vous cochez la case, vous retrouverez le format de date renvoyé avant la version 5.5B (voir paragraphe ci-dessous).

- Indiquez le **format des dates pour les requêtes INSERT et UPDATE** : cette option permet de définir le format utilisé par défaut pour les dates au format texte. Si le format de date n'est pas précisé dans la requête, c'est ce format qui est utilisé.

- Indiquez les **options de prefetch** pour Oracle 8i ou version supérieure.
	**Rappel** : Oracle 8i rapatrie les enregistrements par blocs (opération nommée "prefetch"). Un bloc de taille importante utilise plus de mémoire, mais limite le trafic réseau lors de la récupération des enregistrements suivants.

	- Le nombre d'enregistrements correspond au nombre de lignes de chaque bloc.

	- La mémoire maximum utilisée correspond à la taille en octets de chaque bloc. L'option "Pas de limite" permet de n'imposer aucune limitation.




- Spécifiez si les **transactions distribuées** doivent être utilisées ou non. Par défaut, les blocages et les transactions manipulées avec le Connecteur Natif Oracle utilisent les transactions distribuées. Cochez cette option dans les cas suivants :

	- Votre serveur ne permet pas de gérer les transactions distribuées.

	- Les versions des couches client ne permettent pas l'utilisation des transactions distribuées (Erreur ORA_02041).




- Après validation des paramètres, la connexion est ajoutée dans la liste.





<a name="NOTE2_2"></a>


### Remarques
<a name="remarques_ELTPARAGRAPHE000089"></a>

- Les informations sur le paramétrage sont mémorisées dans le .INI dans le répertoire de Windows.

- WDSQL permet de vérifier que la connexion à la base est correcte.





<a name="NOTE2_3"></a>


### Format de Date renvoyé par le driver natif Oracle (compatibilité 5.5)
<a name="format_date_renvoye_par_driver_natif_oracle_compatibilite_55_ELTPARAGRAPHE000098"></a>**En version 5.5** : La date renvoyée par le driver natif Oracle lors de la lecture d'une rubrique de type Date était : JJ-MM-AAAA

**En version 5.5B** : La date renvoyée par le driver natif Oracle lors de la lecture d'une rubrique de type Date est désormais : AAAAMMJJ.

**Raisons de la modification** : Harmonise la gestion des dates dans WINDEV. Simplifie l'affectation de la date lue par le driver Oracle dans un champ WINDEV de type DATE. Aucun traitement particulier n'est nécessaire pour convertir la date dans un format reconnu par WINDEV.

**Comment garder l'ancien fonctionnement ?**

Paramétrer le format de date retourné dans WDORAINS : il suffit de cocher la case "Compatibilité : renvoyer les dates au format 'JJ-MM-AAAA' " lors de la description de la base utilisée.

**Rappel** : Lors de l'écriture dans une base de données grâce au driver natif Oracle, utiliser de préférence le format standard ODBC {d 'AAAA-MM-JJ'} (avec un espace entre le d et ' ). Le driver convertit alors automatiquement la date dans le format utilisé par la base.

Exemple :

```sql
INSERT INTO TABLE(DATE) VALUES ({d '1999-12-25'})
```


**Remarque** : Depuis la version 12, les dates vides correspondent à des chaînes complétées par des 0. Dans les versions antérieures, les dates vides correspondaient à des chaînes vides.



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Options d'une connexion
<a name="options_une_connexion_ELTTEXTE000275"></a>


### Options pour les blocages
<a name="options_pour_les_blocages_ELTPARAGRAPHE000123"></a>La fonction [SQLBloque](../WDLang4/3072003.md) attend deux paramètres :

- l'attente : l'attente lors de l'appel de [SQLBloque](../WDLang4/3072003.md) peut être infinie ou non (boucle de blocage).

- le mode de blocage. Pour connaître les différents modes de blocage possibles, il faut se référer à la documentation du serveur.





![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=options.gif)


**Remarque** : Si la version du serveur Oracle est inférieure à la version du client Oracle (serveur Oracle 7.3 et client Oracle 8 par exemple), certains dysfonctionnements peuvent être rencontrés. Pour éviter ces dysfonctionnements, cochez l'option "Toujours utiliser un client 7.x".



<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Test d'une connexion
<a name="test_une_connexion_ELTTEXTE000299"></a>
Pour tester une connexion depuis WDORAINS :

1. Sélectionnez la connexion à tester.

2. Cliquez sur le bouton "Tester".

3. Indiquez le nom de l'utilisateur et son mot de passe.

4. Cliquez sur le bouton "Tester la connexion". Le compte-rendu apparaît.
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=test.gif)








