
## Leçon 9.3. Import/Export


<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Ce que vous allez apprendre dans cette leçon
<a name="que_vous_allez_apprendre_dans_cette_lecon_ELTTEXTE000242"></a>


- Importer des éléments d'un projet dans un autre.

- Exporter les éléments de votre projet.

- Imports spécifiques (projets WINDEV, pages HTML).





|   |   |
| --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=dur%E9e.png)<br> | <br>Durée estimée : 10 mn |

| [Leçon précédente](../TutoWB/1410087508.md) | [Sommaire](../TutoWB/1410087510.md) | [Leçon suivante](../TutoWB/1410087204.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Importer des éléments
<a name="importer_des_elements_ELTTEXTE000289"></a>
Vous avez la possibilité d'importer des éléments WEBDEV existants dans votre projet. Vous pouvez importer tous les types d'éléments WEBDEV :

- des pages, des états,

- des classes, des composants,

- des procédures, 

- etc.




- Pour importer des éléments existants dans le projet en cours :

	1. Sous le volet "Projet", dans le groupe "Projet", déroulez "Importer" et sélectionnez "Des éléments WEBDEV et leurs dépendances...".

	2. Cliquez sur "..." et sélectionnez le répertoire où se trouvent les éléments à importer (le répertoire doit comporter des éléments WEBDEV).

	3. Validez. WEBDEV liste alors les différents éléments que vous pouvez importer présents dans le répertoire spécifié (les sous-répertoires ne sont pas pris en compte).
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P9_Import%20Export%20-%20HC%20N%B0002.jpg&type=thumb)


	4. Sélectionnez les éléments à importer, puis validez. Les éléments (et tous les fichiers utilisés par ces éléments : images, etc.) font désormais partie du projet.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | Le bouton "Calculer" (présent dans la fenêtre d'importation) permet de calculer la taille des éléments sélectionnés avec toutes leurs dépendances. |





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Exporter des éléments
<a name="exporter_des_elements_ELTTEXTE000331"></a>
Vous pouvez également exporter des éléments de votre projet vers un autre répertoire par exemple. Ces éléments pourront alors être réutilisés dans d'autres projets.|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=avertissement.png)<br> | Attention ! | L'exportation d'éléments est plus qu'une simple copie d'éléments. En effet, c'est le seul moyen sûr pour transmettre un élément d'un projet avec toutes ses dépendances (images, icônes, etc.). Une solution pratique pour transmettre des pages avec leurs dépendances par e-mail, par exemple. |







- Pour exporter des éléments de votre projet :

	1. Sous le volet "Accueil", dans le groupe "Général", déroulez "Enregistrer" et sélectionnez l'option "Exporter .. Vers un répertoire...".

	2. Dans la fenêtre qui s'affiche, sélectionnez les éléments de votre projet que vous souhaitez exporter.
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P9_Import%20Export%20-%20HC%20N%B0001.jpg&type=thumb)


	3. Indiquez le nom du répertoire de destination (ou sélectionnez-le avec le bouton “...”).

4. Validez. Les éléments sont alors exportés vers le répertoire indiqué. Ces éléments sont toujours disponibles dans votre projet.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | Le bouton "Calculer" (présent dans la fenêtre d'exportation) permet de calculer la taille des éléments sélectionnés avec toutes leurs dépendances. |





<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Importations spécifiques
<a name="importations_specifiques_ELTTEXTE000391"></a>


### Importation d'un projet WINDEV : Webisation d'un projet
<a name="importation_projet_windev_webisation_projet_ELTPARAGRAPHE000094"></a>Un besoin répandu aujourd'hui est de transformer des applications Windows (ou des parties d'applications) en sites Web dynamiques.

Grâce à l'assistant de Webisation, WEBDEV vous permet : 

- de transformer vos fenêtres en pages, 

- d'avoir une assistance pour l'adaptation du code WLangage. 




Pour tester la webisation d'une application WINDEV, nous avons préparé un projet WINDEV. |   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | La webisation d'une application WINDEV peut être réalisée uniquement :<br><br>- soit en utilisant WINDEV 28 avec WEBDEV 28 inclus.<br><br>- soit en utilisant WEBDEV 28.<br><br><br> |





- Pour transformer un projet WINDEV existant en site Internet :

	1. Affichez la page d'accueil de WEBDEV (Ctrl + &lt;). 

	2. Dans la page d'accueil, cliquez sur "Tutoriel" puis dans la zone "Partie 9 - Leçon 9.3 - Import/Export", double-cliquez sur "Webiser un projet WINDEV - Exercice".

	3. Deux possibilités s'offrent à vous selon le logiciel utilisé : 

		- **Si vous utilisez WINDEV**, sous le volet "Projet", dans le groupe "Webisation", déroulez "Webiser" et sélectionnez "Webiser". 

		- **Si vous utilisez WEBDEV seul**, l'assistant de webisation se lance et indique qu'une configuration de projet WEBDEV va être créée. Passez à l'étape suivante de l'assistant. 




4. L'assistant propose les différents éléments à convertir. Dans notre cas, sélectionnez tous les éléments. 
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | Lors de la webisation d'un projet WINDEV, il est conseillé de commencer par convertir une ou deux fenêtres de votre application. Il sera possible de convertir les autres fenêtres au fur et à mesure. |





5. Passez à l'étape suivante. 

6. L'assistant propose les éléments à intégrer dans le site. Dans notre exemple, nous conservons l'état. Ne changez rien et passez à l'étape suivante. 

7. L'assistant est terminé. Cliquez sur le bouton "Terminer". 

8. L'audit de projet pour la conversion de pages se lance automatiquement. Cet audit permet de traiter certaines erreurs de compilation en proposant des solutions. Il est nécessaire de traiter toutes ces erreurs pour que l'application soit complètement webisée. Certaines erreurs peuvent concerner des traitements ou des fonctionnalités non disponibles en Web, des fonctions WLangage non disponibles, etc. Dans notre exemple, l'audit affiche les problèmes suivants : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Webisation.jpg&type=thumb)




- Nous allons examiner les différents problèmes un par un : 

	1. Notre application WINDEV imprimait un état en mode "Visualisateur de rapports". Cette option n'est pas disponible dans un site WEBDEV. Il est nécessaire de modifier le code pour créer un fichier PDF. 

		- Double-cliquez sur "Clic (Serveur)" situé à côté du libellé "Erreurs". Le code de clic comportant l'erreur est affiché.

		- Dans le bandeau de l'événement "Clic sur BTN_Imprimer_Le_devis", cliquez sur "AJAX activé" **pour désactiver le mode Ajax**. 

		- Remplacez le code par : 
						
			```wl
			iDestination(iPDFGénérique)
			ETAT_BonDeCommande.Imprime()
			FichierAffiche(iDernierFichier, typeMimePDF, iDernierFichier)
			fSupprime(iDernierFichier)
			```


		- Dans la fenêtre de l'audit, rafraichissez l'affichage : toutes les erreurs d'impression ont disparu. 




2. Le problème suivant concerne les les traitements qui ne sont pas supportés en Web. Il suffit de vérifier le comportement de l'élément et si nécessaire de déplacer ou de supprimer le code WLangage correspondant. 

3. Le dernier problème détecté concerne l'utilisation de la fonction [fSélecteur](../WDLang1/3036053.md). En effet, dans un site Web, il n'est pas possible d'utiliser un sélecteur de fichier. Il est préférable d'utiliser un champ Upload. Nous avons déjà vu ce type de champ dans la partie 3 (paragraphe ["Gestion de l'image d'un produit"](../TutoWB/1410087490.md)). 




Ce petit exemple nous a permis de voir la simplicité et l'assistance proposées par WEBDEV pour convertir un projet WINDEV en un site. 

Remarque : Dans certains cas, de nouveaux développements peuvent être nécessaires pour adapter le fonctionnement de l'application au Web. Par exemple, si l'application utilisait un champ Traitement de texte, il peut être nécessaire d'utiliser un champ HTML, avec si nécessaire adaptation de l'analyse pour gérer le format HTML.

Pour plus de détails sur la webisation d'un projet WINDEV, consultez [Transformez vos applications WINDEV existantes en sites Internet](../Editeurs/9500225.md).
<a name="NOTE4_2"></a>


### Importation d'une page HTML
<a name="importation_une_page_html_ELTPARAGRAPHE000167"></a>Une page d'un site non WEBDEV vous intéresse ? Vous souhaitez récupérer son interface ? Rien de plus simple.

WEBDEV offre la possibilité d'importer vos pages HTML existantes dans votre projet WEBDEV. Chaque page HTML importée devient un élément de votre site WEBDEV. Cette page est modifiable bien entendu !|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | La fonctionnalité d'import de page HTML est une aide apportée au développeur de sites WEBDEV. Il ne s'agit en aucun cas d'une fonctionnalité d'"aspiration" de sites Internet.<br><br>Il peut subsister certaines différences d'affichage entre la page HTML avant importation et la page HTML après importation. |







- Pour importer une page HTML dans un projet WEBDEV :

	1. Ouvrez votre projet WEBDEV (par exemple : un projet existant ou un nouveau projet).

	2. Sous le volet "Projet", dans le groupe "Projet", déroulez "Importer" et sélectionnez "Une page Html...". L'assistant d'importation de pages HTML se lance.
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P9_Import%20Export%20-%20HC%20N%B0003.jpg&type=thumb)
Remarque : Si vous utilisez le produit WEBDEV intégré à WINDEV, l'option devient : sous le volet "Projet", dans le groupe "Projet", déroulez "Importer" et sélectionnez "De WEBDEV" puis "Une page Html"). 

	3. Indiquez l'emplacement de la page HTML. Cette page peut être un fichier présent sur votre poste (bouton "...") ou une adresse Internet (par exemple : http://www.monsitewebdev.fr/mapage.html). La page HTML s'affiche dans le cadre "Aperçu de la page".

	4. Validez. Une nouvelle page WEBDEV vient d'être créée.

	5. Enregistrez la page. La page est automatiquement ajoutée à la liste des éléments de votre projet.







| [Leçon précédente](../TutoWB/1410087508.md) | [Sommaire](../TutoWB/1410087510.md) | [Leçon suivante](../TutoWB/1410087204.md) |
| --- | --- | --- |




