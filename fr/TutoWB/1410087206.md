
## Leçon 10.2. Optimiser un projet : Analyseur de performances 
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Ce que vous allez apprendre dans cette leçon
<a name="que_vous_allez_apprendre_dans_cette_lecon_ELTTEXTE000233"></a>


- Présentation.

- Lancer l'analyseur de performances.

- Analyser le résultat.





|   |   |
| --- | --- |
| <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=dur%E9e.png)<br> | <br>Durée estimée : 15 mn |

| [Leçon précédente](../TutoWB/1410087204.md) | [Sommaire](../TutoWB/1410087510.md) | [Leçon suivante](../TutoWB/1410087210.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000280"></a>
L'analyseur de performances (appelé également Profiler) est un outil permettant de vérifier et d'optimiser le temps d'exécution des traitements de votre site.

**Son principe est simple** :

- Vous testez votre site.

- Pendant ce test, l'analyseur de performances répertorie toutes les actions effectuées et sauvegarde les temps d'exécution de chacun des traitements exécutés.




A la fin du test, l'analyseur de performances vous présente :

- les 10 manipulations qui ont pris le plus de temps,

- la durée et le nombre d'appels de tous les traitements exécutés.


Le projet "WW_Optimisation" contient une page spécifique permettant de visualiser des exemples de résultats obtenus avec l'analyseur de performances.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Lancer l'analyseur de performances
<a name="lancer_analyseur_performances_ELTTEXTE000304"></a>
L'analyseur de performances peut être lancé :

- **directement depuis l'éditeur de WEBDEV** : 
	Dans ce cas, le projet est alors automatiquement exécuté en mode test. Vous pouvez manipuler votre application et lancer les traitements de votre choix. 
	Pour revenir sous l'éditeur WEBDEV, il suffit de quitter votre site. 
	L'analyseur de performances affiche alors le résultat de l'analyse. Ce résultat est enregistré sous forme d'un fichier WPF.

- **depuis un de vos traitements en WLangage**, grâce aux fonctions suivantes :
	


|   |   |
| --- | --- |
| [AnalyseurDébut](../WDLang1/3013012.md) | Lance la "collecte d'informations" pour l'analyseur de performances. |
| [AnalyseurFin](../WDLang1/3013002.md) | Arrête la "collecte d'informations" pour l'analyseur de performances. |


	Dans ce cas, seul le code présent entre les fonctions [AnalyseurDébut](../WDLang1/3013012.md) et [AnalyseurFin](../WDLang1/3013002.md) est analysé. Le résultat est enregistré sous forme d'un fichier WPF.




- Dans notre exemple, nous allons utiliser la première méthode. Pour lancer l'analyseur de performances sur le projet "WW_Optimisation" :

	1. Dans le ruban, sous le volet "Projet", dans le groupe "Audit et performances", déroulez "Analyser les performances" et sélectionnez "Analyser les performances".
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png) | Note | L'analyseur de performances peut également être lancé depuis le tableau de bord du projet, via le widget "Performances". Il suffit de : <br><br>		- activer le Widget si nécessaire (cliquez sur le lien "Cliquez ici pour réactiver").<br><br>		- cliquer sur la flèche et de sélectionner "Analyser les performances". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P10_Analyseur%20de%20performances%20-%20HC%20N%B0001.jpg)<br><br><br><br> |





	2. Le test du projet se lance.

	3. Cliquez sur le bouton "PAGE DE TEST DE L'ANALYSEUR DE PERFORMANCES".

	4. Cliquez sur le bouton "TRAITEMENT A ANALYSER".

	5. Validez la fenêtre d'information et arrêtez le test du projet en fermant le navigateur. La fenêtre du compte-rendu de l'analyseur de performances apparaît.







<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Analyse du résultat
<a name="analyse_resultat_ELTTEXTE000346"></a>


- Examinons la fenêtre du compte-rendu de l'analyseur de performances. Les résultats sont affichés dans plusieurs onglets :

	- l'onglet "Synthèse" présente les dix traitements qui ont pris le plus de temps.

	- l'onglet "Cartographie" présente une vision graphique des traitements les plus importants.

	- l'onglet "Détail" présente tous les traitements lancés lors du test de l'application (classés du plus long au plus rapide).

	- l'onglet "Appels" permet de visualiser le détail des opérations réalisées dans un traitement.







- Détaillons ces différents onglets dans le cas de notre exemple.

	- L'onglet "Synthèse" présente les dix traitements les plus consommateurs de temps. Dans notre exemple, nous pouvons voir que la procédure locale "MetAJourStockProduits" prend plus de 3 secondes à s'exécuter (ce temps peut varier en fonction de la puissance de votre machine). <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P10_Analyseur%20de%20performances%20-%20HC%20N%B0002.jpg&type=thumb)


	- L'onglet "Cartographie" permet d'identifier de manière visuelle ce qui a pris le plus de temps. Dans notre cas, c'est un appel à la fonction [HTTPRequête](../WDLang3/3043007.md) : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P10_Analyseur%20de%20performances%20-%20HC%20N%B0003.jpg&type=thumb)




- Dans notre cas, l'onglet "Détail" permet de retrouver l'appel à la fonction [HTTPRequête](../WDLang3/3043007.md) dans les éléments prenant le plus de temps.

	1. Sélectionnez cette ligne. Nous allons voir dans le code si un problème peut expliquer ce ralentissement.

	2. En cliquant sur le bouton "Appels", le détail des appels de la procédure **MetAjourStockProduits** apparaît.  <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P10_Analyseur%20de%20performances%20-%20HC%20N%B0005.jpg&type=thumb)


	3. Sélectionnez la ligne "HTTPRequête" et cliquez sur le bouton "Code" : la ligne de code WLangage correspondante est affichée sous l'éditeur de code.

4. Fermez l'analyseur de performances.

5. La ligne de code WLangage exécutée est la suivante :
			
		```wl
		HTTPRequête("adr-fournisseur")
		```
Le ralentissement vient du fait que l'adresse spécifiée pour la fonction [HTTPRequête](../WDLang3/3043007.md) est inaccessible. 
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png) | Note | L'éditeur de code indique qu'une erreur a été trouvée en exécution sur cette ligne de code en affichant une icône "Sens interdit". En survolant cette icône, le détail de l'erreur est affiché. |










- Testons rapidement le fonctionnement de l'application en optimisant ce code :

	1. Remplacez la ligne de code contenant la fonction [HTTPRequête](../WDLang3/3043007.md) par la ligne de code suivante :
			
		```wl
		// Vérifie l'accessibilité du serveur fournisseur
		HTTPRequête("www.google.fr")
		```


	2. Enregistrez le code (Ctrl + S).







- Nous allons maintenant relancer l'analyseur de performances :

	1. Sous le volet "Projet", dans le groupe "Audit et performances", déroulez "Analyser les performances" et sélectionnez "Analyser les performances".

	2. Le test du projet se lance.

	3. Cliquez sur le bouton "PAGE DE TEST DE L'ANALYSEUR DE PERFORMANCES".

	4. Cliquez sur le bouton "TRAITEMENT A ANALYSER".

	5. Validez la fenêtre d'information et arrêtez le test du projet. La fenêtre du compte-rendu de l'analyseur de performances apparaît.

	6. Sous l'onglet "Cartographie", la fonction [HTTPRequête](../WDLang3/3043007.md) n'apparaît plus avec la même importance. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P10_Analyseur%20de%20performances%20-%20HC%20N%B0006.jpg&type=thumb)








- Fermez la fenêtre de rapport de l'analyseur de performances.




| [Leçon précédente](../TutoWB/1410087204.md) | [Sommaire](../TutoWB/1410087510.md) | [Leçon suivante](../TutoWB/1410087210.md) |
| --- | --- | --- |




