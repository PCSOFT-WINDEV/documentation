


## Connecteur Natif SQL Server pour WINDEV et WEBDEV
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000195"></a>
En option, WINDEV et WEBDEV proposent un Connecteur Natif (appelé également module d'Accès Natif) à SQL Server. Ce Connecteur Natif gère les versions 7, 2000, 2005, 2008, 2012, 2014, 2016, 2019 et 2022 ainsi que les versions Express de SQL Server. Ce Connecteur Natif gère également l'accès aux bases de données SQL Azure. 
Ce Connecteur Natif permet d'accéder à une base SQL SERVER sans driver externe depuis un programme en WLangage.

Le Connecteur Natif SQL Server propose plusieurs modes d'utilisation :




|   |   |
| --- | --- |
| SQL Server via OLE DB | SQL Server via ODBC |
| Le Connecteur Natif SQL permet d'accéder à la couche client par un accès OLE DB. <br><br>Cette méthode permet d'utiliser les différentes couches clientes proposées par Microsoft :<br><br>- *MSOLEDBSQL* (recommandée)<br><br>- *SQLnCli 11* : Couche cliente correspondant à SQL Server 2012. <br><br>- *SQLnCli 10* : Couche cliente correspondant à SQL Server 2008. <br><br>- *SQLnCli* : Couche cliente correspondant à SQL Server 2005. Elle est plus performante que SQLOLEDB mais nécessite d'être installée sur les postes utilisateurs.<br><br>- *SQLOLEDB* : Couche cliente livrée à partir de SQL Server 2000. Elle est présente en standard dans les systèmes d'exploitation Microsoft à partir de Windows XP.<br><br><br><br><br>**Cette méthode est disponible sous Windows, en 32 bits et 64 bits**. | Le Connecteur Natif SQL permet d'accéder à la couche client par un accès ODBC. <br><br>Cette méthode permet d'utiliser les différentes couches clientes proposées par Microsoft :<br><br>- *msodbcsql17* (recommandée)<br><br>- *msodbcsql13*<br><br>- *SQLnCli 11*<br><br>- *SQLnCli 10* : Couche cliente correspondant à SQL Server 2008. A partir de cette version, il est possible d'exploiter les nouveaux types TIME et DATE par exemple (nouveautés de la version 17).<br><br>- *SQLnCli* : Couche cliente correspondant à SQL Server 2005. Elle est plus performante que SQLOLEDB mais nécessite d'être installée sur les postes utilisateurs.<br><br><br><br><br>**Cette méthode est disponible sous Windows en 32 et 64 bits, et sous Linux en 64 bits**. |
| En 32 bits, la DLL **wd280sqlserver.dll** est nécessaire pour ce mode d'utilisation du Connecteur Natif via OLE DB.<br><br>En 64 bits, la DLL **wd280sqlserver64.dll** est nécessaire pour ce mode d'utilisation du Connecteur Natif via OLE DB. | En 32 bits, la DLL **wd280sqlserver2.dll** est nécessaire pour ce mode d'utilisation du Connecteur Natif via OBDC.<br><br>En 64 bits, la DLL **wd280sqlserver2_64.dll** est nécessaire pour ce mode d'utilisation du Connecteur Natif via ODBC. |


Remarque : Cette documentation est commune aux deux modes d'utilisation du Connecteur Natif. Les différences de manipulation ou de comportement sont indiquées si nécessaire.
**Voici quelques-uns des nombreux avantages de l'utilisation du Connecteur Natif SQL Server** : 

- Les fonctions HLitxxx (HLitSuivant, HModifie, ...) sont utilisables sur les bases de données SQL Server. C'est-à-dire que vous manipulez une base SQL Server avec les mêmes ordres qu'une base de données HFSQL. Le portage d'une application existante vers des bases tierces est donc grandement facilité. 

- Le RAD permet de générer du code avec les fonctions Hxxx (HLitSuivant, ...) ou SQLxxx.

- WDMAP (le visionneur de données) est utilisable sur vos bases de données SQL Server. 

- Support des bases SQL Server toutes versions (à partir de la version 7).

- Les performances sont supérieures à celles d'un accès par ODBC par exemple.

- Le Connecteur Natif permet d'exploiter un plus grand nombre de fonctionnalités ([procédures stockées](../WDSQLServer/5515009.md), fonction [HPrépareRequêteSQL](../WDLang4/3044119.md), ...)

- etc.




L'utilisation de ce Connecteur Natif est fortement conseillé pour tout développement d'application Client/Serveur avec WINDEV ou WEBDEV, accédant à des bases de données SQL Server. Pour toute information complémentaire, n'hésitez pas à nous contacter. 

**Remarque** : Si vous ne possédez pas le Connecteur Natif SQL Server, contactez le service commercial de PC SOFT. 

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Utilisation
<a name="utilisation_ELTTEXTE000225"></a>


### Utiliser le Connecteur Natif SQL Server dans vos applications WINDEV ou vos sites WEBDEV
<a name="utiliser_connecteur_natif_sql_server_dans_vos_applications_windev_vos_sites_webdev_ELTPARAGRAPHE000094"></a>Pour utiliser SQL Server en natif, il faut :

- paramétrer la connexion : 

	- dans l'éditeur d'analyses,

	- via la fonction [HDécritConnexion](../WDLang4/3044205.md), 

	- dans WDSQSINS (étape optionnelle). 
			Remarque : WDSQSINS permet de compléter les paramètres définis dans l'éditeur d'analyses ou avec la fonction [HDécritConnexion](../WDLang4/3044205.md).




- programmer :

	- soit avec les fonctions "HFSQL" du WLangage (voir [Programmation à l'aide des fonctions HFSQL](../WDSQLServer/5515011.md)).

	- soit avec les fonctions "SQL" du WLangage (voir [Programmation à l'aide des fonctions SQL](../WDSQLServer/5515010.md)).







**Remarques** : 

- Le choix de la version du Connecteur Natif utilisé est réalisé grâce à la variable [H.ModeSQLServer](../WDLang4/3044276.md). 

- Le choix de la version de la couche client SQL SERVER utilisée est réalisé avec le mot-clé "WD CLIENT VERSION" (précisé dans les [informations optionnelles de connexion](../WDLang4/9000124.md)).

- N'oubliez pas de consulter les [limitations concernant l'utilisation du Connecteur Natif SQL Server.](../WDSQLServer/5515005.md)

- Pour déployer des sites utilisant le Connecteur Natif SQL Server, il est nécessaire d'installer le Connecteur Natif SQL Server sur le poste Serveur (Serveur d'Application WEBDEV). 

- L'option "Créer automatiquement les fichiers de données s'ils n'existent pas" (disponible dans l'onglet "Fichiers" de la description du projet) est prise en compte par le Connecteur Natif SQL Server. 

- Le pilote Msoledbsql pour SQL Server est supporté par le Connecteur Natif SQL Server.

- Gestion des erreurs dans les threads : Lorsqu'un appel au Connecteur Natif SQL Server est effectué
depuis un thread, il est possible de gérer les erreurs de manière habituelle.

- Le Connecteur Natif SQL Server gère les identifiants uniques de type UUID.





