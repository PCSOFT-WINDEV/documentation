


## Paramétrage de la connexion avec WDSQSINS
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000179"></a>
Pour compatibilité avec les versions précédentes du Connecteur Natif SQL Server (également appelé Accès Natif SQL Server), il est toujours possible de configurer la connexion dans le logiciel WDSQSINS (livré avec le Connecteur Natif SQL Server).

Ce logiciel est livré : 

- en 32 bits : WDSQSINS.EXE

- en 64 bits : WDSQSINS64.EXE




**Rappel** : Le paramétrage de la connexion réalisé par WDSQSINS doit être effectué une seule fois.

Cette page présente :

- [le paramétrage d'une connexion](#NOTE2_1).

- [la définition des options d'une connexion](#NOTE3_1).

- [le test d'une connexion](#NOTE4_1).




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Paramétrage d'une connexion
<a name="parametrage_une_connexion_ELTTEXTE000203"></a>
Pour paramétrer la connexion :

1. Lancez WDSQSINS.EXE.

2. Dans la fenêtre qui s'ouvre (elle liste les différentes connexions existantes), cliquez sur le bouton "Ajouter" pour créer une nouvelle connexion. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Parametrage_1.gif)


3. Donnez les paramètres de la connexion : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Connexion_1.gif)





- Choisissez le nom de la source de données. Ce nom sera passé en paramètre à la fonction [SQLConnecte](../WDLang4/3072005.md) pour se connecter à la base. Si la connexion a été définie dans l'éditeur d'analyses de WINDEV ou WEBDEV, indiquez le nom de la connexion correspondante.

- Ajoutez un libellé de description.

- Spécifiez une chaîne de connexion. **La chaîne de connexion** est le nom du serveur sur lequel est installé SQL Server. Il permet de retrouver la base de données. Exemple de chaîne de connexion : CSNT

- Indiquez si vous voulez conserver la compatibilité 5.5 pour le format des dates. 
	Rappel : Entre la version 5.5 et 5.5B, le format de date renvoyé a été modifié. Si vous cochez la case, vous retrouverez le format de date renvoyé avant la version 5.5B (voir paragraphe ci-dessous).

- Spécifiez les options à utiliser :

	- **Utiliser une requête count(\*) avec SQLPremier** : Lors d'un parcours avec la fonction [SQLPremier](../WDLang4/3072017.md), la fonction [SQLInfoGene](../WDLang4/3072028.md) renseigne la variable *SQL.NbLig* (nombre de lignes du résultat). 
			Par défaut, pour renseigner cette variable, une requête de type **COUNT** est générée (option "Utiliser une requête count(\*) avec SQLPremier" est cochée). Cette requête augmente le nombre d'échanges sur le réseau mais accélère l'exécution de la fonction [SQLPremier](../WDLang4/3072017.md). 
			Pour éviter l'augmentation du nombre d'échanges sur le réseau, décocher l'option "Utiliser une requête count(\*) avec SQLPremier". Dans ce cas, l'exécution de la fonction [SQLPremier](../WDLang4/3072017.md) peut être plus lente.

	- **SET ANSI_NULLS** : Ouvre la connexion en mode 'SET ANSI_NULLS ON'. Si cette option n'est pas cochée, les paramètres par défaut de la connexion sont utilisés (paramètres définis sur le serveur). Cette option est nécessaire lorsqu'on accède à un serveur distant (appelé linked server).

	- **SET ANSI_WARNINGS** : Ouvre la connexion en mode 'SET ANSI_WARNINGS ON'. Si cette option n'est pas cochée, les paramètres par défaut de la connexion sont utilisés (paramètres définis sur le serveur). Cette option est nécessaire lors d'un accès à un serveur distant (appelé linked server).




- Après validation des paramètres, la connexion est ajoutée dans la liste.



<a name="NOTE2_2"></a>


### Remarques
<a name="remarques_ELTPARAGRAPHE000082"></a>

- Les informations sur le paramétrage sont mémorisées dans le fichier **Wdsqsins.ini** dans le répertoire de Windows ("C:\\Windows\\" ou "C:\\Users\\LOGIN\\AppData\\Local\\VirtualStore\\Windows\\" sous Windows Vista/7).

- WDSQL permet de vérifier que la connexion à la base est correcte.



<a name="NOTE2_3"></a>


### Format de Date renvoyé par le driver natif SQL Server
<a name="format_date_renvoye_par_driver_natif_sql_server_ELTPARAGRAPHE000090"></a>**En version 5.5** : La date renvoyée par le driver natif SQL Server lors de la lecture d'une rubrique de type Date était : JJ-MM-AAAA

**En version 5.5B** : La date renvoyée par le driver natif SQL Server lors de la lecture d'une rubrique de type Date est désormais : AAAAMMJJ.

**Raisons de la modification** : Harmonise la gestion des dates dans WINDEV. Simplifie l'affectation de la date lue par le driver SQL Server dans un champ WINDEV de type DATE. Aucun traitement particulier n'est nécessaire pour convertir la date dans un format reconnu par WINDEV.

**Comment garder l'ancien fonctionnement ?**
Paramétrer le format de date retourné dans WDSQSINS : il suffit de cocher la case "Renvoyer les dates au format 'JJ-MM-AAAA' (pour les fonctions SQLCol et SQLLitCol) " lors de la description de la base utilisée.

**Rappel** : Lors de l'écriture dans une base de données grâce au driver natif SQL Server, utiliser de préférence le format standard ODBC {d 'AAAA-MM-JJ'} (avec un espace entre le d et ' ). Le driver convertit alors automatiquement la date dans le format utilisé par la base.

Exemple :

```sql
INSERT INTO TABLE(DATE) VALUES ({d '1999-12-25'})
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Options d'une connexion
<a name="options_une_connexion_ELTTEXTE000239"></a>


### Options pour les blocages
<a name="options_pour_les_blocages_ELTPARAGRAPHE000112"></a>La fonction **SQLBloque** attend deux paramètres :

- l'attente : l'attente lors de l'appel de **SQLBloque** peut être infinie ou non (boucle de blocage). Le délai du "Time out" est par défaut de 1 minute, il peut être modifié.

- le mode de blocage. Pour connaître les différents modes de blocage possibles, il faut se référer à la documentation du serveur.



![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=options_1.gif)


<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Test d'une connexion
<a name="test_une_connexion_ELTTEXTE000263"></a>
Pour tester une connexion depuis WDSQSINS :

1. Sélectionnez la connexion à tester.

2. Cliquez sur le bouton "Tester".

3. Indiquez le nom de l'utilisateur et son mot de passe.

4. Cliquez sur le bouton "Tester la connexion". Le compte-rendu apparaît. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=test_1.gif)






