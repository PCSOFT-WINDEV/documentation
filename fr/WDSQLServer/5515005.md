


## Connecteur Natif SQL Server : Spécificités et remarques
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000286"></a>
Les paragraphes suivants présentent les remarques générales et les spécificités du Connecteur Natif SQL Server. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Spécificités du  Connecteur Natif SQL Server
<a name="specificites_connecteur_natif_sql_server_ELTTEXTE000310"></a>


### Champ Table fichier chargé en mémoire
<a name="champ_table_fichier_charge_memoire_ELTPARAGRAPHE000018"></a>Les nouveaux enregistrements ajoutés dans un champ Table fichier chargé en mémoire ne peuvent pas être modifiés immédiatement. Pour modifier ces nouveaux enregistrements directement dans le champ Table, il est nécessaire après les ajouts d'utiliser la fonction [TableAffiche](../WDLang1/3074003.md) avec la constante *taInit*.
<a name="NOTE2_2"></a>


### Blocage d'un fichier de données (table) dans une transaction
<a name="blocage_fichier_donnees_table_dans_une_transaction_ELTPARAGRAPHE000028"></a>La fonction [HBloqueFichier](../WDLang4/3044153.md) débute une transaction avant de bloquer la table en mode Exclusif. La fonction [HDébloqueFichier](../WDLang4/3044160.md) valide la transaction et débloque la table.
<a name="NOTE2_3"></a>


### Numéro d'enregistrement
<a name="numero_enregistrement_ELTPARAGRAPHE000041"></a>Il n'est pas possible de spécifier un numéro d'enregistrement différent de zéro dans les fonctions [HEcrit](../WDLang4/3044092.md) et [HLit](../WDLang4/3044047.md). Le numéro d'enregistrement "zéro" correspond à l'enregistrement en cours.

De même, les fonctions [HBloqueNumEnr](../WDLang4/3044152.md) et [HDébloqueNumEnr](../WDLang4/3044194.md) ne peuvent être utilisées que sur l'enregistrement en cours.
<a name="NOTE2_4"></a>


### Récupération des types DATEHEURE
<a name="recuperation_des_types_dateheure_ELTPARAGRAPHE000062"></a>

- La précision des valeurs lues et écrites est limitée à la précision du WLangage : la milliseconde. 
	**Cas particulier** : Le type datetime : La précision est limitée par SQLServer à 0.00333 seconde.

- Les nouveaux types SQLServer 2008 date et time sont gérés uniquement à partir de la couche client SQLnCLI pour SQL Server 2008. Pour les couches client plus anciennes, ces rubriques sont vues comme des rubriques "texte unicode".



<a name="NOTE2_5"></a>


### Options de l'analyse
<a name="options_analyse_ELTPARAGRAPHE000072"></a>

- Que les options "Sensible à la casse", "Sensible à l'accentuation", "Sensible à la ponctuation" soient cochées ou non dans l'éditeur d'analyses, la recherche sera toujours sensible à la casse, à l'accentuation et à la ponctuation.

- Les options de l'analyse concernant les index full-text ne sont pas gérées par le Connecteur Natif.

- Les options de l'analyse concernant l'indexation partielle des mémos texte ne sont pas gérées par le Connecteur Natif.



<a name="NOTE2_6"></a>


### Rubriques de type Tableau
<a name="rubriques_type_tableau_ELTPARAGRAPHE000081"></a>Les rubriques de type tableau ne sont pas gérées par le Connecteur Natif. Si vous utilisez une rubrique tableau, seule la valeur de l'indice 1 du tableau sera manipulable avec les fonctions HFSQL (en écriture et en lecture).
<a name="NOTE2_7"></a>


### Cryptage par SSL
<a name="cryptage_par_ssl_ELTPARAGRAPHE000088"></a>Le cryptage par SSL (Secure Socket Layer) n'est pas supporté dans cette version.
<a name="NOTE2_8"></a>


### Procédures stockées
<a name="procedures_stockees_ELTPARAGRAPHE000095"></a>**Limite** : La fonction [HPrépareRequêteSQL](../WDLang4/3044119.md) ne peut pas être utilisée pour préparer une procédure stockée qui renvoie :

- des enregistrements.

- des colonnes.


Il est nécessaire d'utiliser la fonction [HExécuteRequêteSQL](../WDLang4/3044084.md).
<a name="NOTE2_9"></a>


### Valeurs par défaut des rubriques
<a name="valeurs_par_defaut_des_rubriques_ELTPARAGRAPHE000115"></a>Les valeurs par défaut des rubriques sont gérées par le Connecteur Natif SQL Server. Ces valeurs par défaut peuvent être : 

- une valeur, 

- une formule SQL. Dans ce cas, l'expression SQL doit être reconnue par le moteur HFSQL et par la base SQL Server. 



<a name="NOTE2_10"></a>


### Spécificités sur les fonctions HFSQL
<a name="specificites_sur_les_fonctions_hfsql_ELTPARAGRAPHE000125"></a>Les spécificités pour l'utilisation des fonctions HFSQL avec le Connecteur Natif SQL Server sont les suivantes :  

| Spécificités | Fonctions concernées |
| --- | --- |
| La constante ***hDistinct*** n'est pas prise en compte : tous les enregistrements (y compris les doublons) sont parcourus. | [HAvance](../WDLang4/3044154.md), [HRecule](../WDLang4/3044126.md)<br>[HLitPrécédent](../WDLang4/3044048.md), [HLitSuivant](../WDLang4/3044037.md)<br>[HPrécédent](../WDLang4/3044112.md), [HSuivant](../WDLang4/3044027.md) |
| **Requête multi-fichiers** <br>Les fonctions **HAjoute**, **HModifie** et **HSupprime** ne sont pas supportées. | [HAjoute](../WDLang4/3044147.md), [HModifie](../WDLang4/3044042.md)<br>[HSupprime](../WDLang4/3044018.md) |
| Après une erreur de doublons sur la fonction **HModifie**, la fonction **HLit**(utilisée avec la constante ***hNumEnrEnCours***) ne lit pas l'enregistrement demandé.<br>Ce problème sera corrigé dans une prochaine version. | [HLit](../WDLang4/3044047.md) |
| La constante ***hForceIDAuto*** n'est prise en compte avec la fonction **HModifie**. SQL Server n'autorise pas à modifier une colonne de type "IDENTITY". | [HModifie](../WDLang4/3044042.md) |
| Les options de blocage des fonctions de lecture ([HLitRecherche](../WDLang4/3044050.md), etc.) ne sont pas prises en compte. | Fonctions de lecture ([HLitPremier](../WDLang4/3044051.md), etc.) |
| La relecture d'un enregistrement qui a été bloqué par la fonction [HBloqueNumEnr](../WDLang4/3044152.md) le débloque. | Fonctions de lecture ([HLitPremier](../WDLang4/3044051.md), etc.) |
| La fonction [HCréation](../WDLang4/3044255.md) crée des rubriques DATE et TIME si la version du serveur et de la couche client correspondent au moins à SQLServer 2008. | [HCréation](../WDLang4/3044255.md) |




### Problèmes de fonctionnement
<a name="problemes_fonctionnement_ELTPARAGRAPHE000208"></a>Lors de l'utilisation de le Connecteur Natif SQL Server, certaines fonctionnalités telles que le Drag and Drop, les ActiveX ou .NET peuvent ne pas fonctionner. 
Pour retrouver un fonctionnement correct, il est conseillé d'ajouter les lignes de code suivantes dans le code d'initialisation du projet : 

```wl
ChargeDLL("ole32")
API("ole32", "CoInitializeEx", 0, 2)
```

<a name="NOTE4_2"></a>


### Cas particulier : SQL Azure
<a name="cas_particulier_sql_azure_ELTPARAGRAPHE000220"></a>SQL Azure nécessite la présence d'un "clustered index" dans les fichiers.

- Si vous créez les fichiers de données avec la fonction [HCréation](../WDLang4/3044255.md), le Connecteur Natif crée automatiquement le "clustered index" si la description du fichier de données contient un identifiant automatique.

- Si vous créez les fichiers de données avec des requêtes SQL (ou pour ajouter un "clustered index" à un fichier de données existant), consultez la documentation de SQL Azure pour connaître la syntaxe à utiliser.



<a name="NOTE4_3"></a>


### Gestion des rubriques calculées
<a name="gestion_des_rubriques_calculees_ELTPARAGRAPHE000235"></a>Des rubriques calculées peuvent être utilisées dans les fichiers de données. 

La gestion des rubriques calculées est disponible uniquement avec SQL Server 2005 minimum via un Connecteur Natif SQL Server via OLE DB ou ODBC. 


