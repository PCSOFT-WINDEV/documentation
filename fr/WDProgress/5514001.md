


## Connecteur Natif Progress : Programmation à l'aide des fonctions HFSQL
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000231"></a>
Pour utiliser une base de données Progress avec le Connecteur Natif (également appelé "Accès Natif"), il est nécessaire de :

1. Configurer l'administrateur ODBC. 

2. Importer la structure des tables Progress dans l'analyse WINDEV ou WEBDEV.




**Différences par rapport à la programmation SQL** : Pour manipuler les données Progress, les requêtes ne sont pas obligatoires. En effet, vous pouvez directement utiliser les fonctions HFSQL pour lire vos données, effectuer des recherches, des filtres, ... Cependant, il est nécessaire d'importer la structure des fichiers Progress dans l'analyse WINDEV ou WEBDEV.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Configuration de l'administrateur ODBC
<a name="configuration_administrateur_odbc_ELTTEXTE000261"></a>
Pour configurer l'administrateur ODBC :

1. Lancez l'administrateur de données ODBC (ODBCAD32.EXE) sur votre poste. Utilisez par exemple l'option "Démarrer .. Exécuter" de Windows et saisissez "ODBCAD32.EXE".

2. Sélectionnez l'onglet "Base de données Utilisateur".

3. Cliquez sur le bouton "Ajouter".

4. Sélectionnez le driver ODBC pour Progress (installé avec la version client de Progress).

5. Cliquez sur le bouton "Terminer".

6. Saisissez le nom de la source de données Progress. Ce nom permettra d'identifier la base de données Progress dans vos programmes WINDEV ou vos sites WEBDEV.

7. Validez (bouton "OK").



<a name="NOTE2_2"></a>


### Remarque
<a name="remarque_ELTPARAGRAPHE000038"></a>Il est possible de se connecter à une base de données Progress sans déclarer de source ODBC. Dans ce cas, tous les paramètres de connexion doivent être fournis par la fonction [HOuvreConnexion](../WDLang4/3044107.md).

Par exemple, pour accéder à la base "Sports" située sur le serveur "Mars", en utilisant le service "srv_sports", la syntaxe de la fonction [HOuvreConnexion](../WDLang4/3044107.md) devient :

```wl
// Définition d'une connexion
// Au mieux encore : utilisation du nom de la connexion définie dans l'analyse 
// (dans ce cas ne pas déclarer l'objet ici)
cnxProgress est une Connexion 

// Nom du serveur Progress
cnxProgress.Serveur = "Mars"
// Nom de la base de données
cnxProgress.BaseDeDonnées = "Sports"
// Utilisateur de la base
cnxProgress.Utilisateur = "sysprogress"
// Mot de passe de la base
cnxProgress.MotDePasse = "xxxx"
// Connecteur natif Progress
cnxProgress.Provider = hAccèsNatifProgress
// Informations étendues pour préciser le port et l'emplacement de la couche client Progress
cnxProgress.InfosEtendues = "PORT=srv_sports"
// Test de la connexion à la base
SI PAS HOuvreConnexion(cnxProgress) ALORS
	Erreur("Echec de la connexion à la base", HErreurInfo())
	FinProgramme()	
FIN
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Importation de la structure des fichiers
<a name="importation_structure_des_fichiers_ELTTEXTE000291"></a>


### Les étapes de l'importation
<a name="les_etapes_importation_ELTPARAGRAPHE000056"></a>Pour réaliser cette importation : 

1. Lancez l'éditeur d'analyses : cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Ico_Analyse.gif) parmi les boutons d'accès rapide.

2. Sous le volet "Analyse", dans le groupe "Création", déroulez "Importer" et sélectionnez "Importer des descriptions de fichiers/tables".

3. L'assistant se lance. Une connexion à la base de données Progress est automatiquement créée et associée aux fichiers importés dans l'analyse. Cette connexion devra être utilisée pour manipuler le fichier de données Progress par programmation.




Dans les différents écrans de l'assistant, choisissez les options suivantes :

- Type de base de données : Progress. 

- Caractéristiques de la connexion : Serveur de données, Utilisateur et mot de passe, base de données.  

- L'application accédera aux données dans le format actuel.

- Lorsque la connexion est établie, il suffit de sélectionner les tables à importer dans l'analyse WINDEV/WEBDEV. Ces tables pourront être manipulées par programmation grâce aux fonctions HyperFileSQL du WLangage. Ces tables apparaîtront en bleu sous l'éditeur d'analyses.




**Si vous avez défini une source ODBC**, il n'est pas nécessaire de préciser tous les paramètres dans la connexion (seule la source de données définie dans l'administrateur ODBC est nécessaire).

**Si vous n'avez pas défini de source ODBC**, il est nécessaire de saisir tous les paramètres dans la connexion :

- Base de données,

- Numéro ou nom de service sur lequel la database va répondre. Cette information doit être indiquée dans les paramètres avancés de la connexion (informations étendues), ...



<a name="NOTE3_2"></a>


### Prendre en compte les évolutions de la base de données Progress
<a name="prendre_compte_les_evolutions_base_donnees_progress_ELTPARAGRAPHE000095"></a>Pour prendre en compte les évolutions des tables importées sous l'éditeur d'analyses, sous le volet "Analyse", dans le groupe "Analyse", déroulez "Synchronisation" et sélectionnez "Mettre à jour l'analyse depuis les bases de données externes".

Un assistant se lance et permet au choix :

- soit d'analyser les différences uniquement pour les tables importées.

- soit d'analyser les différences pour toutes les tables Progress.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Programmation
<a name="programmation_ELTTEXTE000321"></a>


### 1. Ouverture de la connexion
<a name="1_ouverture_connexion_ELTPARAGRAPHE000121"></a>Pour ouvrir la connexion à la base de données Progress, utilisez la fonction [HOuvreConnexion](../WDLang4/3044107.md) en précisant le nom de la connexion à ouvrir. Ce nom de connexion a été défini lors de l'importation de la structure des fichiers dans l'analyse.

Pour modifier certains paramètres de cette connexion (par exemple le nom d'utilisateur ou le mot de passe), utilisez la fonction [HConnecte](../WDLang4/3044263.md).

**Remarque** : Si vous tentez de lire directement le fichier (fonction [HLitPremier](../WDLang4/3044051.md), ...), la connexion associée à la description du fichier dans l'analyse sera automatiquement ouverte.
<a name="NOTE4_2"></a>


### 2. Exécution de requêtes
<a name="2_execution_requetes_ELTPARAGRAPHE000141"></a>Les fonctions [HExécuteRequête](../WDLang4/3044080.md) et [HExécuteRequêteSQL](../WDLang4/3044084.md) permettent d'exécuter des requêtes sur la base de données en cours.

- [HExécuteRequête](../WDLang4/3044080.md) : permet d'exécuter une requête prédéfinie avec l'éditeur de requêtes de WINDEV et WEBDEV.

- [HExécuteRequêteSQL](../WDLang4/3044084.md) : permet d'exécuter une requête en précisant directement le code SQL de la requête, et le nom qui sera attribué à ce code SQL.
	
	```wl
	// Initialisation de la requête "Client_84"
	HExécuteRequête(CLIENT_84, "MaBaseProgress")
	HExécuteRequêteSQL(ReqClient, "MaBaseProgress", hRequêteSansCorrection, ...
		"SELECT NOM FROM CLIENT")
	```




<a name="NOTE4_3"></a>


### 3. Récupération du résultat
<a name="3_recuperation_resultat_ELTPARAGRAPHE000163"></a>Le parcours du résultat est réalisé avec toutes les fonctions de lecture classiques : [HLitPremier](../WDLang4/3044051.md), [HLitSuivant](../WDLang4/3044037.md), [HLitRecherche](../WDLang4/3044050.md), ...
<a name="NOTE4_4"></a>


### 4. Fermeture de la connexion
<a name="4_fermeture_connexion_ELTPARAGRAPHE000179"></a>La fonction [HFermeConnexion](../WDLang4/3044095.md) permet de fermer la connexion à la base de données lorsque toutes les requêtes nécessaires ont été réalisées.


