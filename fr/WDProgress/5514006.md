
## Connecteur Natif Progress : Programmation à l'aide des fonctions SQL
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000158"></a>
L'utilisation des fonctions SQL pour manipuler des données Progress n'implique pas une importation de la structure des fichiers dans l'analyse. Cependant, les données doivent être manipulées uniquement par requêtes. Il n'est pas possible de lire directement le contenu des fichiers Progress.

Remarque : N'oubliez pas de consulter [les limitations concernant l'utilisation du Connecteur Natif Progress](../WDProgress/5514002.md).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Configuration de l'administrateur ODBC
<a name="configuration_administrateur_odbc_ELTTEXTE000182"></a>
Pour configurer l'administrateur ODBC : 

1. Lancez l'administrateur de données ODBC (ODBCAD32.EXE) sur votre poste. Utilisez par exemple l'option "Démarrer .. Exécuter" de Windows et saisissez "ODBCAD32.EXE".

2. Sélectionnez l'onglet "Base de données Utilisateur".

3. Cliquez sur le bouton "Ajouter".

4. Sélectionnez le driver ODBC pour Progress (installé avec la version client de Progress).

5. Cliquez sur le bouton "Terminer".

6. Saisissez le nom de la source de données Progress. Ce nom permettra d'identifier la base de données Progress dans vos programmes WINDEV.

7. Validez (bouton "OK").






<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Programmation
<a name="programmation_ELTTEXTE000206"></a>


### 1. Ouverture de la connexion
<a name="1_ouverture_connexion_ELTPARAGRAPHE000039"></a>La fonction [SQLConnecte](../WDLang4/3072005.md) permet d'ouvrir une connexion à une base de données Progress par le Connecteur Natif. Il est nécessaire de passer en paramètre à la fonction [SQLConnecte](../WDLang4/3072005.md) le type de la base utilisée, ici PROGRESS.

Le nom de la base correspond au nom de la source ODBC (définie dans l'administrateur ODBC).


```wl
NumConnexion = SQLConnecte("BaseProgress", "sa", "", "", "PROGRESS")
```



<a name="NOTE3_2"></a>


### 2. Exécution de requêtes
<a name="2_execution_requetes_ELTPARAGRAPHE000057"></a>L'exécution de requêtes est réalisée grâce à la fonction [SQLExec](../WDLang4/3072007.md). La fonction [SQLExec](../WDLang4/3072007.md) attend en paramètres le texte de la requête SQL et le nom qui sera donné à cette requête.


```wl
SQLExec("SELECT NOM, PRENOM, POSTE, PHOTO FROM CLIENT", "REQ1")
```



<a name="NOTE3_3"></a>


### 3. Récupération du résultat
<a name="3_recuperation_resultat_ELTPARAGRAPHE000073"></a>Plusieurs modes de récupération du résultat sont disponibles :

- [SQLPremier](../WDLang4/3072017.md) : Permet de récupérer le résultat et initialise un parcours du résultat de type [SQLPremier/SQLCol](../WDLang4/3072025.md).

- [SQLTable](../WDLang4/3072031.md) : Permet de récupérer le résultat de la requête dans un champ Table par programmation de l'application WINDEV/WEBDEV. Il est possible de récupérer le résultat de la requête par Fetch partiel.

- [SQLFetch (SQLAvance)](../WDLang4/3072011.md) : Permet de parcourir les différentes lignes résultat de la requête. Le parcours du résultat de la requête est du type [SQLAvance/SQLLitCol](../WDLang4/3072025.md).




La fonction [SQLBloque](../WDLang4/3072003.md) permet de bloquer soit les enregistrements de la table, soit les enregistrements sélectionnés par la requête (voir aussi : [Connecteur Natif Progress : limitations](../WDProgress/5514002.md)).


<a name="NOTE3_4"></a>


### 4. Fermeture de la connexion
<a name="4_fermeture_connexion_ELTPARAGRAPHE000105"></a>La fonction [SQLFerme](../WDLang4/3072015.md) permet de fermer la connexion à la base de données lorsque toutes les requêtes nécessaires ont été réalisées.




