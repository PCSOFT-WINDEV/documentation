


## Extraire les messages d'un projet
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000287"></a>
Les messages extraits sont les suivants :

- Messages multilingues présents dans :

	- le projet (fichier ".WDP", ".WWP" ou ".WPP").

	- les classes du projet (fichier ".WDC").

	- les états du projet (fichier ".WDE").

	- les fenêtres du projet (fichier ".WDW" ou ".WPW").

	- les pages du projet (fichier ".WWH").

	- les requêtes du projet (fichier ".WDR").

	- les collections de procédures (fichier ".WDG", ".WWN" ou ".WWG").




- Titre d'une fenêtre, d'une page.

- Libellé d'un champ (d'une fenêtre, d'une page ou d'un état).

- Message d'aide d'un champ.

- Bulle d'aide d'un champ.

- Titre et texte de la fenêtre d'aide d'un champ.

- Note d'un champ (d'une fenêtre, d'une page ou d'un état).

- Contenu d'un champ (par exemple champ Liste, Combo, Interrupteur, Sélecteur, Zone de texte Riche, etc.).

- Libellé et message d'aide d'une option de menu.

- Messages de patience d'un état.

- Caractéristiques des informations partagées saisies dans l'analyse.

- Titre du système d'aide.

- Copyright du système d'aide.

- Mots-clés d'index du système d'aide.

- Titre et contenu d'une page d'aide.

- Message d'erreur personnalisé saisi lors de la création de l'exécutable.

- Nom de la fenêtre ou de la page interne utilisée.

- ...




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Comment le faire ?
<a name="comment_faire_ELTTEXTE000311"></a>


### Extraire les messages d'un projet
<a name="extraire_les_messages_projet_ELTPARAGRAPHE000047"></a>Pour extraire les messages de votre projet :

1. Ouvrez votre projet sous WINDEV, WEBDEV ou WINDEV Mobile : sous le volet "Accueil", dans le groupe "Général", déroulez "Ouvrir" et sélectionnez "Ouvrir un projet".
	Remarque : Pour extraire l'ensemble des ressources d'un projet multiproduit, ouvrez le projet multiproduit sous WINDEV (dans une configuration avec WEBDEV et WINDEV Mobile intégrés à WINDEV). 

2. Lancez WDMSG : sous le volet "Projet", dans le groupe "Traduire", déroulez "Traduire" et sélectionnez "Extraction des messages".

3. Sélectionnez les langues des messages à extraire. Ces langues correspondent aux langues déjà disponibles dans le projet, à traduire vers d'autres langues.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Assistant%20WDMSG%20-%20HC%20N%B0001.gif&type=thumb)
Les langues proposées sont celles définies dans l'onglet "Langues" de la description du projet. 
	Remarques : 

	- Le nom des langues personnalisées est également proposé. 

	- Pour afficher la description du projet, sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description".

	- Pour sélectionner plusieurs langues d'extraction, utilisez les touches Ctrl et/ou Maj du clavier.




4. Passez à l'étape suivante de l'assistant.

5. Si vous avez sélectionné plusieurs langues, précisez la langue de référence, c'est-à-dire la langue utilisée lors du développement. Les messages de cette langue de référence doivent être traduits dans d'autres langues. 

6. Passez à l'étape suivante de l'assistant.  

7. Sélectionnez les différents éléments (fenêtres, pages, états, ...) dont les messages (libellé, message de code, etc.) doivent être extraits. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Assistant%20WDMSG%20-%20HC%20N%B0002.gif&type=thumb)
Remarques : 

	- Il est possible de sélectionner uniquement les éléments dont la traduction ou la correction n'a pas été réalisée dans la langue sélectionnée.
			Pour simplifier la recherche des éléments à extraire, indiquez le nom de l'élément voulu et lancez la recherche.

	- Si les éléments de votre projet sont regroupés par perso-dossiers, les éléments proposés par WDMSG seront également regroupés par perso-dossiers.




8. Passez à l'étape suivante.

9. Choisissez le type de fichier à générer : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Assistant%20WDMSG%20-%20HC%20N%B0003.gif&type=thumb)


	- Archive WDMSG. Ce type de fichier peut uniquement être utilisé pour réaliser une traduction avec WDTRAD. 

- Fichier HFSQL. Ce type de fichier peut uniquement être utilisé pour réaliser une traduction avec WDTRAD.  

- Fichier texte. Ce type de fichier peut être utilisé pour réaliser une traduction avec WDTRAD ou avec un autre logiciel de traduction. 

10. Passez à l'étape suivante.

11. Sélectionnez les paramètres du fichier résultat, créé par l'extraction (voir [Détail des paramètres](#NOTE2_2)). Indiquez le nom et le répertoire du fichier d'extraction (par défaut, le fichier d'extraction est créé dans le répertoire du projet en cours). <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Assistant%20WDMSG%20-%20HC%20N%B0004.gif&type=thumb)


12. Passez à l'étape suivante.

13. Lors de l'extraction des messages, il est possible de vérifier si les messages précédemment extraits sont identiques aux messages du projet en cours. Pour plus de détails, consultez [Extraire les messages modifiés](../WDMsg/3518033.md). 

14. Passez à l'étape suivante.

15. Validez.




Le fichier d'extraction est créé dans le répertoire choisi (par défaut, celui du projet). Nous vous conseillons de réaliser une copie de sauvegarde du fichier d'extraction. Cette copie de sauvegarde permettra de :

- retrouver le format du fichier d'extraction (par exemple, en cas de modification des mots-clés de ce fichier par inadvertance).

- comparer les messages extraits et les messages du projet en cours, lors de la réintégration.




Le fichier d'extraction peut être traduit : 

- par un logiciel de traduction spécifique (fichier d'extraction au format texte uniquement). 

- à l'aide de [WDTRAD](../WDTrad/3518010.md), outil d'aide à la saisie des traductions livré avec WDMSG.




**Remarques** : 

- Dans le cas d'une extraction sous forme d'un fichier de données au format HFSQL, 3 fichiers sont créés : 

	- fichier de données (.fic).

	- fichier d'index (.ndx).

	- fichier mémo (.mmo).




- Extraction multilingue : Lors d'une extraction multilingue : 

	- au format texte, un fichier est généré pour chaque langue. 

	- au format HFSQL ou WDMSG, un seul fichier contenant les différentes langues est généré. 






<a name="NOTE2_2"></a>


### Paramètres d'extraction
<a name="parametres_extraction_ELTPARAGRAPHE000167"></a>Les paramètres d'extraction communs à tous les types de fichiers d'extraction sont les suivants :

- **Conserver l'indicateur de lettre d'appel ("&") dans les messages extraits** : ce paramètre permet d'inclure le caractère "&" dans les libellés des champs pour indiquer la lettre d'appel du champ.
	Rappel : Cette lettre d'appel permet en exécution de se positionner directement sur le champ, en utilisant la combinaison de touches Alt + Lettre. Dans le libellé d'un champ, si une lettre est précédée de "&", elle devient automatiquement "lettre d'appel".

- **Transformer les chaînes en dur dans le code en chaînes multi-langues** : Dans le code, il existe deux types de chaînes de caractères :

	- *les chaînes de caractères multilingues*. Ces chaînes sont suivies d'une icône :<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=MessageMultilangue.gif)


	- *les chaînes de caractères non multilingues (également appelées "en dur")*. Ces chaînes sont seulement entourées de guillemets.<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=MessageNonMultilangue.gif)

- **Convertir au format OEM (ANSI par défaut)** : si cette option est cochée, le texte du fichier d'extraction sera au format OEM (format des caractères DOS, utilisable avec un logiciel DOS), sinon le texte est par défaut au format ANSI (format des caractères Windows, utilisable avec un logiciel Windows).




Il est également possible d'indiquer des paramètres spécifiques au logiciel de traduction utilisé (voir le paragraphe suivant).
<a name="NOTE2_3"></a>


### Paramètre d'extraction pour un logiciel de traduction
<a name="parametre_extraction_pour_logiciel_traduction_ELTPARAGRAPHE000194"></a>Si vous utilisez [WDTRAD](../WDTrad/3518010.md) pour traduire les messages de votre projet, les paramètres suivants ne sont pas nécessaires.

Si vous utilisez un autre logiciel de traduction, des paramètres spéciaux sont à définir (paramètres différents selon le logiciel utilisé). Les paramètres spécifiques au logiciel de traduction utilisé sont les suivants :

- **Ajouter un délimiteur de parties de texte à ne pas traduire** : pour certains logiciels de traduction, il est possible d'ignorer des parties de texte dans un document à traduire. Par exemple, il est possible d'ignorer les commentaires générés par WDMSG. Pour cela, il faut encadrer le texte à ignorer avec des délimiteurs (spécifiques au logiciel).
	Si l'option est cochée, tous les textes spécifiques au format du fichier d'extraction seront encadrés par les délimiteurs (par défaut SSTRX) pour qu'ils ne soient pas traduits.
	Pour connaître les délimiteurs à employer, consultez la documentation du logiciel de traduction utilisé.

- **Ajouter un espace avant le délimiteur** : pour certains logiciels de traduction, il est nécessaire d'ajouter un espace avant le délimiteur. 
	Si cette option est cochée, un espace est ajouté au début du délimiteur.

- **Ajouter un espace après le délimiteur** : pour certains logiciels de traduction, il est nécessaire d'ajouter un espace après le délimiteur. 
	Si cette option est cochée, un espace est ajouté à la fin du délimiteur.

- **Ajouter des informations complémentaires en commentaire** : si cette option est cochée, des lignes de commentaires seront ajoutées dans le fichier d'extraction créé. Ces lignes permettent de connaître l'origine des messages (messages rattachés à un champ, une fenêtre, ...).




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Notes
<a name="notes_ELTTEXTE000347"></a>


### Format du fichier texte des messages
<a name="format_fichier_texte_des_messages_ELTPARAGRAPHE000223"></a>Le fichier texte d'extraction créé par WDMSG utilise un format spécifique. Pour plus de détails, consultez le [format des fichiers texte des messages](../WDMsg/3518030.md).
<a name="NOTE3_2"></a>


### Projet multiproduit
<a name="projet_multiproduit_ELTPARAGRAPHE000233"></a>Si le projet en cours est un projet multiproduit (WINDEV, WEBDEV et/ou WINDEV Mobile) :

- lors de l'extraction depuis WINDEV (avec WEBDEV et WINDEV Mobile intégrés à WINDEV), les éléments des différents produits sont tous pris en compte.
	Par exemple, les fenêtres et les pages sont extraites dans un projet WINDEV et WEBDEV.

- lors de la réintégration depuis WINDEV (avec WEBDEV et WINDEV Mobile intégrés à WINDEV), les éléments des différents produits sont tous pris en compte.





