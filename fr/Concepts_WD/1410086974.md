
## 8. Les fenêtres en pratique
			

| [Page précédente](../Concepts_WD/1410086973.md) | [Sommaire](../Concepts_WD/1410087098.md) | [Page suivante](../Concepts_WD/1410086975.md) |
| --- | --- | --- |



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>
Une fenêtre a pour but d'afficher, de consulter et de saisir des informations. Ces informations peuvent provenir de fichiers de données d'une analyse, de fichiers externes, de requêtes, etc.

WINDEV propose plusieurs solutions pour créer les fenêtres d'un projet :

- Créer une fenêtre vierge avec l'assistant.

- Construire l'ensemble des fenêtres de l'application à partir de la description de l'analyse.

- Créer une fenêtre à partir de la description de l'analyse (avec son code ou non).

- Créer des fenêtres standard.

- Créer des fenêtres basées sur un modèle, etc.




Quelle que soit la méthode utilisée, la fenêtre pourra être modifiée après sa création : il sera possible d'ajouter, modifier ou supprimer des champs, de modifier les caractéristiques de la fenêtre.

Pour plus de détails sur la manipulation des champs d'une fenêtre, consultez [Les champs en pratique](../Concepts_WD/1410086976.md).

Ce chapitre traite les sujets suivants :

- [Création d'une fenêtre](#NOTE2_1).

- [Manipulations simples sur une fenêtre depuis l'éditeur](#NOTE3_1).

- [Principales caractéristiques d'une fenêtre](#NOTE4_1).

- [Fenêtre et image](#NOTE5_1).

- [Ouvrir une fenêtre popup](#NOTE6_1).

- [Grisage automatique des fenêtres](#NOTE7_1).

- [Fenêtre interne](#NOTE8_1).

- [Modèles de fenêtres](#NOTE9_1).

- [Evénements associés aux fenêtres](#NOTE10_1).

- [Les menus](#NOTE11_1).

- [La barre de message](#NOTE14_1).




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Création d'une fenêtre
<a name="creation_une_fenetre_ELTTEXTE001016"></a>
WINDEV permet de créer plusieurs types de fenêtres :

- Fenêtres vierges, sans aucun champ.

- Fenêtres créées par le RAD.

- Fenêtres internes. Ces fenêtres pourront être utilisées dans des champs de type "Fenêtre Interne".

- Fenêtres basées sur un modèle de fenêtres.

- Fenêtres importées à partir d'une application non WINDEV.




Ce paragraphe détaille uniquement la création de fenêtres vierges, internes ou basées sur un modèle. Pour plus de détails, consultez l'aide en ligne.
<a name="NOTE2_2"></a>


### Création de fenêtres vierges
<a name="creation_fenetres_vierges_ELTPARAGRAPHE000085"></a>**Pour créer une fenêtre vierge** :

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P1_ICO_Cr%E9er_cpt.gif)
 parmi les boutons d'accès rapide. La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Fenêtre" puis sur "Fenêtre". L'assistant de création d'une fenêtre se lance.

2. Choisissez le type "Vierge".

3. Spécifiez le gabarit de la fenêtre.

4. Validez la création de la fenêtre. Une fenêtre vierge est créée sous l'éditeur. La fenêtre de sauvegarde apparaît automatiquement. 

5. Spécifiez le titre et le nom de la fenêtre. La fenêtre correspond à un fichier ".WDW". Par défaut, ce fichier sera créé dans le répertoire principal du projet. Ce nom sera utilisé pour manipuler la fenêtre.

6. Validez l'enregistrement de la fenêtre. 

7. Créez les champs dans la fenêtre.


**Remarque** : Les principales caractéristiques des fenêtres sont détaillées dans l'aide en ligne. Les différents types de champs sont présentés dans le chapitre [Les champs en pratique](../Concepts_WD/1410086976.md).
<a name="NOTE2_3"></a>


### Fenêtre interne
<a name="fenetre_interne_ELTPARAGRAPHE000109"></a>Une fenêtre interne est une fenêtre sans barre de titre, ni barre de message qui sera directement incluse dans les autres fenêtres de votre application grâce au champ "Fenêtre interne".

Ainsi, il est possible d'inclure une fenêtre (et son code) dans une autre fenêtre.

**Pour créer une fenêtre interne** :

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P1_ICO_Cr%E9er_cpt.gif)
 parmi les boutons d'accès rapide. La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Fenêtre" puis sur "Fenêtre". L'assistant de création d'une fenêtre se lance. 

2. Sélectionnez l'onglet "Fenêtre interne".

3. Sélectionnez le type de fenêtre et le gabarit associé.

4. Validez. La fenêtre de sauvegarde apparaît automatiquement. 



<a name="NOTE2_4"></a>


### Fenêtre basée sur un modèle de fenêtres
<a name="fenetre_basee_sur_modele_fenetres_ELTPARAGRAPHE000129"></a>WINDEV permet également de créer une fenêtre basée sur un modèle de fenêtres. Dans ce cas, il suffit de sélectionner le modèle de fenêtres voulu.
Les modèles de fenêtres contiennent tous les éléments graphiques et le code communs à l'ensemble des fenêtres de votre application.

**Pour créer une fenêtre basée sur un modèle de fenêtres** :

1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P1_ICO_Cr%E9er_cpt.gif)
 parmi les boutons d'accès rapide. La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Fenêtre" puis sur "Fenêtre". L'assistant de création d'une fenêtre se lance.

2. Sélectionnez l'onglet "Basée sur un modèle".

3. Sélectionnez le modèle voulu et le gabarit associé.

4. Validez. La fenêtre de sauvegarde apparaît automatiquement. 




Les modifications effectuées dans un modèle de fenêtres sont automatiquement reportées sur toutes les fenêtres utilisant ce modèle.

Un modèle de fenêtres permet de respecter la charte graphique définie pour une application.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Manipulations simples sur une fenêtre depuis l'éditeur
<a name="manipulations_simples_sur_une_fenetre_depuis_editeur_ELTTEXTE001058"></a>
L'éditeur de fenêtres permet de réaliser les manipulations suivantes sur les fenêtres :

- Ouvrir une fenêtre sous l'éditeur : Il suffit de double-cliquer sur le nom de la fenêtre affiché dans le volet "Explorateur de projet".

- Modifier la taille d'une fenêtre.

- Sauvegarder et copier une fenêtre.

- Importer et exporter une fenêtre.

- Modifier l'ordre de navigation.


Pour plus de détails sur ces manipulations, consultez l'aide en ligne.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Principales caractéristiques d'une fenêtre
<a name="principales_caracteristiques_une_fenetre_ELTTEXTE001082"></a>


### Caractéristiques
<a name="caracteristiques_ELTPARAGRAPHE000171"></a>Une fenêtre peut accueillir tous les types de champs disponibles. Une fenêtre peut :

- être ***redimensionnable*** : l'utilisateur pourra agrandir ou diminuer la taille de la fenêtre. Selon les caractéristiques d'ancrage définies pour chacun des champs, la position des champs dans la fenêtre pourra varier lors de ce redimensionnement (pour plus de détails sur l'ancrage, consultez [Les champs en pratique](../Concepts_WD/1410086976.md)).

- avoir une ***image de fond*** : cette image est affichée en fond de la fenêtre et les champs viennent se superposer à cette image. Il est également possible de définir des caractéristiques de redimensionnement grâce au mode 9 images. Pour plus de détails, consultez [Fenêtre et image](#NOTE5_1).

- être ***détourée*** : la fenêtre aura ainsi une forme originale (fenêtre en forme de cercle, d'ordinateur, ...). Pour plus de détails, consultez le paragraphe [Fenêtre détourée](#NOTE5_3).

- avoir un ***menu déroulant*** : ce menu permettra aux utilisateurs d'accéder plus rapidement aux principales fonctionnalités de l'application. Pour créer un menu déroulant dans une fenêtre, sous le volet "Fenêtre", dans le groupe "Barres et menus", déroulez "Menu principal" et sélectionnez l'option "Ajouter le menu principal". La première option apparaît dans la fenêtre. Les options peuvent être manipulées grâce au menu contextuel des options. Les options de menu peuvent ensuite être manipulées par programmation. Pour plus de détails, consultez [Les menus](#NOTE11_1).

- avoir une ***barre de message*** : cette barre de message affichera les messages d'aide associés aux différents champs de la fenêtre. Cette barre de message permet également d'afficher des informations supplémentaires. Pour plus de détails, consultez [La barre de message](#NOTE14_1).

- être ***multilingue*** : toutes les langues définies pour la fenêtre seront disponibles pour tous les champs de la fenêtre. Une fenêtre peut être associée à plus de langues que le projet (cas par exemple des fenêtres partagées entre plusieurs projets). Pour plus de détails, consultez le chapitre [Applications multilingues](../Concepts_WD/1410087068.md).

- se ***griser*** automatiquement si elle devient inaccessible. Cette fonctionnalité s'appelle GFI pour Grisage des Fenêtres Inaccessibles. Pour plus de détails, consultez le paragraphe [Grisage automatique des fenêtres](#NOTE7_1).

- autoriser le ***drag and drop***. Pour plus de détails sur le drag and drop et sa programmation, consultez l'aide en ligne.

- autoriser la ***modification de l'UI*** par l'utilisateur final. Pour plus de détails, consultez l'aide en ligne. 




**Remarque** : Pour forcer une action sur une fenêtre, il suffit de définir un champ Bouton de cette fenêtre en mode "Exécution automatique". Pour plus de détails, consultez le paragraphe [Les champs en pratique](../Concepts_WD/1410086976.md).
<a name="NOTE4_2"></a>


### Fenêtre de description
<a name="fenetre_description_ELTPARAGRAPHE000228"></a>La fenêtre de description est une fenêtre à onglets, regroupant toutes les caractéristiques paramétrables de la fenêtre.
**Remarque** : Il est également possible de visualiser et/ou de modifier les caractéristiques d'une fenêtre dans le modifieur. Pour plus de détails, consultez l'aide en ligne.
<a name="NOTE4_3"></a>


### Affichage des caractéristiques
<a name="affichage_des_caracteristiques_ELTPARAGRAPHE000239"></a>Pour afficher la fenêtre de description :

- soit double-cliquez sur le fond de la fenêtre.
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P1_Detail_Description_FEN%20-%20HC%20N%B0001.gif&type=thumb)


- soit sélectionnez l'option "Description" du menu contextuel de la fenêtre (clic droit de la souris).

- soit sélectionnez la fenêtre et utilisez le raccourci clavier Alt + Entrée.



<a name="NOTE4_4"></a>


### Caractéristiques par onglet
<a name="caracteristiques_par_onglet_ELTPARAGRAPHE000253"></a>Ce paragraphe présente rapidement les différentes catégories de caractéristiques affichées par onglet.
Pour plus de détails sur chacune des caractéristiques présentes dans les différents onglets, consultez l'aide en ligne.

**Onglet Général**

L'onglet "Général" permet de spécifier le nom de la fenêtre et son titre.

**Onglet UI**

L'onglet "UI" permet de définir les différents paramètres de l'interface de la fenêtre :

- visibilité de la fenêtre,

- position de la fenêtre,

- gestion du clic droit, du curseur de la souris,

- association à un menu contextuel, etc.




**Onglet Détail**

L'onglet "Détail" permet de définir les différents paramètres de la fenêtre :

- type de la fenêtre

- modification de l'UI (Interface Utilisateur) par l'utilisateur final,

- animation,

- fermeture automatique.




**Onglet Image**

Cet onglet permet de paramétrer :

- l'image de fond de la fenêtre,

- l'image de la poignée de redimensionnement,

- l'icône de la fenêtre.




**Onglet Langues**

Cet onglet permet de connaître les langues gérées par la fenêtre, ainsi que la langue affichée sous l'éditeur. Il est possible d'ajouter, de modifier ou de supprimer des langues.

**Onglet Notes**

L'onglet "Notes" permet de décrire le fonctionnement détaillé de la fenêtre. Ces informations seront imprimées dans les documentations techniques (documentation technique du projet, de la fenêtre, etc.).   

**Onglet Aide**

L'onglet "Aide" permet d'associer un fichier d'aide contextuelle à la fenêtre. Ce fichier d'aide contient les pages d'aide contextuelle affichées par chaque champ.

**Onglet Style**

L'onglet "Style" permet de définir le style de la fenêtre :

- Présence de la barre de titre.

- Présence des différentes icônes.

- Présence de la barre de message, etc.




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Fenêtre et image
<a name="fenetre_image_ELTTEXTE001124"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000315"></a>Pour optimiser le look des fenêtres de vos applications, WINDEV permet d'utiliser :

- des couleurs de fond. De nombreuses couleurs standard peuvent être utilisées. La couleur de fond est configurée dans l'onglet "Style" de la fenêtre de description de la fenêtre.

- des images. Ces images sont utilisées en image de fond de la fenêtre. Vos champs sont superposés sur cette image. La configuration de l'image de fond est réalisée dans l'onglet "Image" de la fenêtre.




**Remarque** : Pour personnaliser vos fenêtres, vous pouvez également utiliser un gabarit ou un modèle de fenêtres.
<a name="NOTE5_2"></a>


### Configuration de l'image de fond
<a name="configuration_image_fond_ELTPARAGRAPHE000329"></a>La configuration est effectuée dans l'onglet "Image" de la description de la fenêtre.

Vous pouvez sélectionner directement le fichier correspondant à l'image de fond ou sélectionner une image du catalogue. Les principaux formats d'image pouvant être affichés sont les suivants : BMP, JPEG, TIFF ou GIF.

Il est également possible de réaliser directement un Drag and Drop du fichier image présent dans l'explorateur de fichiers Windows vers la fenêtre WINDEV.

Les options possibles sur l'image sont :

- Gestion des images multilingues.

- Mode d'affichage.

- Position.

- Transparence.

- Symétrie.

- Mode 9 images.

- Détourage de la fenêtre selon l'image de fond.




**Gestion des images multilingues**

Une image de fond différente peut être affichée selon la langue d'exécution du programme. Les caractéristiques d'affichage peuvent être spécifiques à chaque langue.

**Pour définir une image de fond multilingue** :

1. Cliquez sur le bouton à droite du nom de l'image de fond.

2. Dans le menu qui s'affiche, sélectionnez l'option "Multilingue". 

3. Pour chaque langue définie dans votre fenêtre, choisissez l'image appropriée.

4. Validez. Le libellé "Valeur multilingue" apparaît dans le champ de définition des images de fond.




**Mode d'affichage**

Une image peut être affichée dans une fenêtre selon plusieurs modes d'affichage. Ces modes d'affichage permettent d'obtenir différents effets :

- **100%** : l'image est affichée à 100% à partir du coin haut gauche de la fenêtre.

- **100% Centré** : l'image est affichée à 100% et centrée dans la fenêtre.

- **Etiré** : l'image est déformée pour occuper tout l'espace de la fenêtre.

- **Répété** : l'image est affichée à 100% et répétée dans le fond de la fenêtre pour occuper tout l'espace de la fenêtre.

- **Homothétique** : l'image est agrandie proportionnellement pour être affichée entièrement dans la fenêtre.

- **Homothétique centré** : l'image est homothétique et centrée dans la fenêtre.

- **Homothétique étendu** : l'image est proportionnellement agrandie pour que le plus petit côté de l'image soit affiché entièrement dans la fenêtre.

- **Homothétique étendu centré** : l'image est étendue et centrée dans la fenêtre.

- **Homothétique sans agrandissement** : si l'image peut être affichée entièrement dans la fenêtre, elle est affichée à 100%. Si l'image est plus grande que la fenêtre, elle est automatiquement réduite proportionnellement pour être affichée entièrement.

- **Homothétique centré sans agrandissement** : l'image est centrée et homothétique sans agrandissement.




L'option "Affichage haute qualité (HQ)" permet en mode homothétique d'améliorer la qualité de l'image lorsque celle-ci est réduite par rapport à sa taille initiale.

**Position**

Ce paramètre permet de définir la position du point haut gauche de l'image par rapport à la surface de la fenêtre.

Ces options seront conservées même si l'image est modifiée par programmation (propriété [Image](../Proprietes/2510034.md)).

**Transparence**

Les options de transparence de l'image de fond sont les suivantes :

- **Magenta transparent** : Le magenta présent dans l'image sera transparent à l'affichage sous l'éditeur comme en exécution. 
	


|   |   |
| --- | --- |
| Transparence : aucune | Magenta transparent |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IMG_MAGENTA1.gif)<br> | ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IMG_MAGENTA2.gif)<br> |


	

- **Point haut gauche** : tous les points ayant la même couleur que celle du point haut gauche de l'image seront transparents.




Ces options seront conservées même si l'image est modifiée par programmation (propriété [Image](../Proprietes/2510034.md)).

**Symétrie**

Les options de symétrie permettent de changer l'orientation de l'image contenue dans le fichier image. Ces options seront conservées même si l'image est modifiée par programmation (propriété [Image](../Proprietes/2510034.md)).

Image originale :

![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IMG_SYM_HV.gif)



|   |   |   |
| --- | --- | --- |
| **Symétrie verticale** |   | **Symétrie horizontale et verticale**  |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IMG_SYM_H.gif)<br> | <br><br> | ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IMG_SYM_V.gif)<br> |




**Mode 9 images**

Si cette option est sélectionnée, le mode 9 images sera utilisé sur l'image de fond de la fenêtre.

Le mode 9 images consiste à découper l'image de fond en 9 zones. ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Mode9image3.gif)


**Pour chaque zone**, il est possible de définir si la partie de l'image correspondant à la zone doit être affichée ou non : il suffit de cliquer dans la zone pour la rendre visible ou invisible. Si la partie de l'image n'est pas affichée, elle sera remplacée par la couleur de fond de la fenêtre ou du champ.

**Les marges** permettent de définir la taille de chaque zone. Il est possible de saisir directement les valeurs des différentes zones ou de déplacer directement la ligne correspondant à la marge.

Lors du redimensionnement de la fenêtre, seules les zones 2, 4, 6, 8 et 5 changent de taille pour occuper tout l'espace : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Mode9image2.gif)


Le mode 9 images permet de gérer le fonctionnement de chaque zone lors du redimensionnement de la fenêtre. Pour chaque zone, l'image sera agrandie :

- soit en répétant l'image qui compose la zone

- soit en étirant l'image qui compose la zone



<a name="NOTE5_3"></a>


### Fenêtre détourée
<a name="fenetre_detouree_ELTPARAGRAPHE000454"></a>WINDEV permet de détourer les fenêtres. Les fenêtres auront ainsi des formes originales (fenêtre en forme de cercle, d'ordinateur, etc.).

La forme de la fenêtre est définie par une image. Dans cette image, utilisez une couleur spécifique pour définir les zones transparentes de l'image (par exemple, la couleur "Magenta Clair"). Toutes ces zones seront invisibles lors de l'affichage de la fenêtre en exécution : la fenêtre sera alors détourée.

**Attention** : Les bordures de cette image doivent être les plus nettes possible (pas de dégradé, etc.) afin de ne pas obtenir d'effets d'affichage lors de l'aperçu ou de l'ouverture de la fenêtre détourée.
La configuration du détourage de la fenêtre est effectuée dans l'onglet "Image" de la fenêtre de description de la fenêtre.

<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Ouvrir une fenêtre "popup"
<a name="ouvrir_une_fenetre_popup_ELTTEXTE001175"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000471"></a>WINDEV permet d'ouvrir des fenêtres de type "popup".

Une fenêtre "popup" correspond à une fenêtre de taille réduite s'ouvrant au-dessus de la fenêtre en cours. Généralement, cette fenêtre permet à l'utilisateur de réaliser une sélection. Cette fenêtre renvoie donc à la fenêtre principale la valeur sélectionnée par l'utilisateur. Cette fenêtre se ferme automatiquement dès qu'un clic gauche de souris est effectué (à l'intérieur ou non de la fenêtre popup).

Par exemple :![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P1_Ouvrir%20une%20fenetre%20popup%20-%20HC%20N%B0001.gif)
**Remarque** : Les caractéristiques d'une fenêtre popup sont les suivantes :

- ouverture par défaut sous le champ qui ouvre la fenêtre (ou au-dessus ou à gauche du champ si la place disponible sous le champ est insuffisante).
	La position d'ouverture peut être modifiée par programmation.

- fermeture automatique dès que la fenêtre n'a plus le focus ou dès l'appel de la fonction [Ferme](../WDLang1/3038018.md). 

- seule l'icône de fermeture apparaît dans la barre de titre de la fenêtre (si la barre de titre a été définie dans le style).




<a name="NOTE7"></a>
<a name="NOTE7_1"></a>


## Grisage automatique des fenêtres
<a name="grisage_automatique_des_fenetres_ELTTEXTE001199"></a>
Votre application ouvre plusieurs fenêtres simultanément et vous ne savez plus quelle fenêtre est celle à utiliser ?

La ou les fenêtres inactives peuvent se griser automatiquement. Ainsi, vous devinez instinctivement la fenêtre à utiliser.

Cette fonctionnalité s'appelle GFI pour Grisage des Fenêtres Inaccessibles.

Par exemple :
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P1_Grisage%20automatique%20des%20fenetres%20-%20HC%20N%B0001.gif&type=thumb)
Etape 1 : Vous modifiez des informations concernant un client puis vous cliquez sur le bouton "Valider".
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P1_Grisage%20automatique%20des%20fenetres%20-%20HC%20N%B0002.gif&type=thumb)
Etape 2 : Une fenêtre vous demande de confirmer ou d'annuler ces modifications. La fenêtre principale (en arrière-plan) est devenue inaccessible. Elle s'est grisée automatiquement. Vous savez immédiatement quelle fenêtre doit être utilisée.

Les fonctionnalités du GFI sont disponibles au niveau du projet ou personnalisables au niveau de chaque fenêtre.

Il est également possible d'agir sur le GFI par programmation.

Pour plus de détails, consultez l'aide en ligne.

<a name="NOTE8"></a>
<a name="NOTE8_1"></a>


## Fenêtre interne
<a name="fenetre_interne_ELTTEXTE001223"></a>
Les fenêtres internes permettent de partager dynamiquement une même partie d'UI au sein d'une ou de plusieurs applications.

L'UI à utiliser plusieurs fois est créée dans une fenêtre de type "Fenêtre Interne".

Cette UI est utilisée dans les différentes fenêtres de votre application grâce au champ de type "Fenêtre interne".

**Remarque** : La fenêtre à fusionner peut être issue d'un composant.

Pour plus de détails, consultez l'aide en ligne.

<a name="NOTE9"></a>
<a name="NOTE9_1"></a>


## Modèles de fenêtres
<a name="modeles_fenetres_ELTTEXTE001247"></a>
WINDEV permet de créer des modèles de fenêtres. Ces modèles contiennent tous les éléments graphiques et le code communs à l'ensemble des fenêtres de votre application.

Les modifications effectuées dans un modèle de fenêtres sont automatiquement reportées sur toutes les fenêtres utilisant ce modèle.

Un modèle de fenêtres permet de respecter la charte graphique définie pour une application.

L'utilisation de modèles de fenêtres dans vos applications permet de :

- simplifier la création des fenêtres de l'application.

- simplifier la mise en page des fenêtres de l'application.

- simplifier la mise à jour de la charte graphique de l'application.


Un modèle de fenêtres se crée aussi simplement qu'une fenêtre. Pour créer une fenêtre en utilisant un modèle, il suffit de choisir l'option "basée sur un modèle".

Par défaut, toute modification effectuée dans le modèle est reportée dans les fenêtres l'utilisant. Il est cependant possible dans une fenêtre spécifique de gérer des cas particuliers en surchargeant les éléments du modèle.

Pour plus de détails, consultez l'aide en ligne.

<a name="NOTE10"></a>
<a name="NOTE10_1"></a>


## Evénements associés aux fenêtres
<a name="evenements_associes_aux_fenetres_ELTTEXTE001271"></a>


### Evénements gérés par défaut
<a name="evenements_geres_par_defaut_ELTPARAGRAPHE000564"></a>WINDEV gère par défaut les événements suivants (ordre d'apparition sous l'éditeur de code) :

- **Déclarations globales** :
	Déclaration des variables globales à la fenêtre.

- **Fin d'initialisation** :
	Exécuté lors de l'ouverture de la fenêtre, avant le code de prise de focus. L'événement d'initialisation des champs de la fenêtre est exécuté après ce code.

- **Demande de mise à jour de l'affichage** :
	Permet de regrouper le code de mise à jour des champs de la fenêtre : contenu des champs, état (visible, grisé, ...), libellé à mettre à jour, ...
	Cet événement est lancé sur demande grâce aux fonctions :

	- [DemandeMiseAJourUI](../WDLang1/1000023899.md) : Exécute l'événement à la fin de l'événement en cours (lancement asynchrone).

	- [ExécuteMiseAJourUI](../WDLang1/1000023901.md) : Exécute immédiatement l'événement.




- **Fermeture d'une fenêtre fille** : 
		Exécuté lors de la fermeture d'une fenêtre fille ouverte depuis la fenêtre en cours.

- **Fermeture** :
	Exécuté lors de la fermeture de la fenêtre. Remarque : une reprise de saisie sur un des champs de la fenêtre dans ce code empêche la fenêtre de se fermer.

- **Affectation de la propriété Valeur (fenêtre interne uniquement)**
	Exécuté lors de l'utilisation de la propriété [Valeur](../Proprietes/2510130.md) en affectation sur le champ Fenêtre Interne.

- **Récupération de la propriété Valeur (fenêtre interne uniquement)**
	Exécuté lors de l'utilisation de la propriété [Valeur](../Proprietes/2510130.md) en lecture sur le champ Fenêtre Interne.



<a name="NOTE10_2"></a>


### Evénements optionnels
<a name="evenements_optionnels_ELTPARAGRAPHE000610"></a>Plusieurs événements optionnels peuvent être gérés. Il suffit de : 

1. Cliquer sur "Ajouter d'autres événements à" présent à la fin de la liste des événements affichés dans l'éditeur de code. 

2. La fenêtre des événements optionnels s'affiche. 

3. Sélectionner le ou les événements optionnels à ajouter et valider. 

4. Les événements sélectionnés sont automatiquement ajoutés à la suite des événements proposés par défaut. 




Il est ainsi possible de gérer par exemple :

- la prise et la perte de focus, 

- la modification d'un des champs de la fenêtre, 

- la modification de la taille de la fenêtre,

- le survol de la fenêtre par la souris,

- le bouton gauche enfoncé, relâché, avec double-clic,

- le bouton droit enfoncé, relâché, avec double-clic, 

- la roulette de la souris, ...




<a name="NOTE11"></a>
<a name="NOTE11_1"></a>


## Les menus contextuels
<a name="les_menus_contextuels_ELTTEXTE001301"></a>
Un menu contextuel peut être ouvert par l'utilisateur grâce à un clic droit de la souris. Ce menu permet aux utilisateurs d'accéder plus facilement aux fonctionnalités spécifiques d'un champ d'une fenêtre ou d'une fenêtre.

WINDEV permet de gérer deux types de menu contextuel :

- **les menus contextuels système** gérés par Windows. Ces menus contextuels s'affichent lors d'un clic droit sur certains types de champs (champ de saisie, table, ...). Pour plus de détails, consultez le paragraphe [Menu contextuel système par défaut](#NOTE11_4).

- **les menus contextuels personnalisés** gérés par WINDEV. Ces menus sont créés sous l'éditeur de fenêtres et peuvent être manipulés par programmation.




WINDEV permet de créer des menus contextuels personnalisés et d'associer ces menus contextuels :

- soit à un ou plusieurs champs d'une fenêtre.

- soit à une fenêtre.


Par exemple :![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P1_Les%20menus%20contextuels%20-%20HC%20N%B0001.gif)

<a name="NOTE11_2"></a>


### Fenêtres d'édition des menus contextuels
<a name="fenetres_edition_des_menus_contextuels_ELTPARAGRAPHE000659"></a>WINDEV permet de créer et de modifier des menus contextuels personnalisés dans une fenêtre d'édition particulière. Pour mieux comprendre la gestion des menus contextuels personnalisés, voici le vocabulaire lié à cette fenêtre d'édition :![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P1_Les%20menus%20contextuels%203%20-%20HC%20N%B0001.gif)

<a name="NOTE11_3"></a>


### Fonctionnalités disponibles
<a name="fonctionnalites_disponibles_ELTPARAGRAPHE000669"></a>WINDEV permet de :

- Créer un menu contextuel personnalisé.

- Associer un menu contextuel personnalisé existant à un ou plusieurs éléments (fenêtre ou champs).

- Editer un menu contextuel personnalisé.

- Afficher la fenêtre de description d'un menu contextuel personnalisé.

- Supprimer un menu contextuel personnalisé.




Pour plus de détails, consultez l'aide en ligne.
<a name="NOTE11_4"></a>


### Menu contextuel système par défaut
<a name="menu_contextuel_systeme_par_defaut_ELTPARAGRAPHE000686"></a>Les types de champ suivants ont un menu contextuel système par défaut (affiché si aucun menu contextuel personnalisé n'est associé au champ) :

- un champ de saisie :
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P1_Les%20menus%20contextuels%20-%20HC%20N%B0003.gif)
Pour plus de détails sur la traduction de ce menu, consultez l'aide en ligne.

- une colonne de table :![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P1_Les%20menus%20contextuels%202%20-%20HC%20N%B0001.gif)
Pour plus de détails sur la traduction de ce menu, consultez l'aide en ligne.

- un champ ActiveX :![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P1_Les%20menus%20contextuels%20-%20HC%20N%B0005.gif)
**Remarque** : Le menu contextuel système affiché dépend de l'ActiveX associé au champ.


Ce menu contextuel par défaut peut être désactivé aussi bien depuis l'éditeur que par programmation.

<a name="NOTE12"></a>
<a name="NOTE12_1"></a>


## Les menus principaux
<a name="les_menus_principaux_ELTTEXTE001343"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000711"></a>Un menu principal est obligatoirement associé à une fenêtre. Ce menu est affiché sous la barre de titre de la fenêtre sous WINDEV. En règle générale, les applications contiennent une fenêtre menu. Cette fenêtre contient uniquement un menu principal et permet d'accéder aux autres fenêtres de l'application.

Par exemple :
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P1_Les%20menus%20principaux%20-%20HC%20N%B0001.gif)

<a name="NOTE12_2"></a>


### Vocabulaire associé aux menus principaux
<a name="vocabulaire_associe_aux_menus_principaux_ELTPARAGRAPHE000723"></a>Pour manipuler simplement un menu principal, il est nécessaire de connaître le vocabulaire suivant :![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P1_Les%20menus%20principaux%20-%20HC%20N%B0002.gif)

<a name="NOTE12_3"></a>


### Fonctionnalités disponibles
<a name="fonctionnalites_disponibles_ELTPARAGRAPHE000733"></a>WINDEV permet de :

- Créer un menu principal.

- Editer un menu principal.

- Supprimer un menu principal.




Pour plus de détails, consultez l'aide en ligne.

**Cas particulier : Menu utilitaire**

WINDEV permet d'insérer automatiquement un menu "utilitaire" (de type "?") dans votre application. Sous le volet "Fenêtre", dans le groupe "Barres et menus", déroulez "Menu principal" et sélectionnez l'option "Ajouter le menu "?"". 

<a name="NOTE13"></a>
<a name="NOTE13_1"></a>


## Les options de menus
<a name="les_options_menus_ELTTEXTE001379"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000766"></a>Un menu (contextuel personnalisé ou principal) est composé d'une ou de plusieurs options et sous-options. Chaque option permet d'exécuter un code WLangage.

Les manipulations des options de menu sous l'éditeur sont identiques que le menu soit un menu principal ou un menu contextuel personnalisé.

Pour manipuler les options de menu, il suffit d'éditer le menu concerné.

Pour éditer (ou afficher sous l'éditeur) :

- le menu principal d'une fenêtre :

	- ouvrez la fenêtre concernée sous WINDEV.

	- sélectionnez une des options de menu. Les options et les sous-options s'affichent automatiquement.




- un menu contextuel personnalisé d'une fenêtre : sous le volet "Fenêtre", dans le groupe "Barres et menus", déroulez "Menus contextuels" et sélectionnez l'option "&lt;NomMenuContextuel&gt;".



<a name="NOTE13_2"></a>


### Manipuler les options de menu sous l'éditeur
<a name="manipuler_les_options_menu_sous_editeur_ELTPARAGRAPHE000799"></a>L'éditeur de fenêtres permet de réaliser très simplement les manipulations suivantes :

- Ajouter une option de menu.

- Ajouter un séparateur.

- Ajouter un sous-menu.

- Supprimer une option de menu.


Les options de menu peuvent également être directement manipulées sous l'éditeur de fenêtres et leurs caractéristiques sont modifiables grâce à une fenêtre de description.

La fenêtre de description des options de menu permet par exemple de :

- modifier le libellé de l'option.

- cocher ou décocher une option de menu.

- associer une image à une option de menu.

- associer un raccourci clavier à une option de menu.




Il est également possible d'associer du code WLangage à une option de menu. Seules les options de menu ne possédant pas de sous-menu peuvent lancer un traitement WLangage.

Pour plus de détails, consultez l'aide en ligne.
<a name="NOTE13_3"></a>


### Manipuler les options de menu par programmation
<a name="manipuler_les_options_menu_par_programmation_ELTPARAGRAPHE000826"></a>La manipulation d'une option de menu est identique que le menu soit un menu contextuel ou un menu principal.

Pour manipuler par programmation une option de menu, utilisez la notation :

- ***"&lt;NomOption&gt;"*** si l'option de menu est manipulée depuis la fenêtre.

- ***"&lt;NomFenêtre&gt;.&lt;NomMenu&gt;.&lt;NomOption&gt;"*** si l'option est manipulée depuis une autre fenêtre.




<a name="NOTE14"></a>
<a name="NOTE14_1"></a>


## La barre de message
<a name="barre_message_ELTTEXTE001415"></a>
Il est possible d'afficher dans la barre de message d'une fenêtre :

- un ***message d'information lié au champ en cours***. Ce message est saisi dans l'onglet "Aide" de la fenêtre de description du champ.
	Le message sera affiché dans la barre de message lorsque l'utilisateur sélectionnera le champ.

- un ***message d'information spécifique***. Ce message est affiché par programmation grâce à la fonction [Message](../WDLang1/3021006.md).

- une ***jauge de progression***. Cette jauge est affichée par programmation grâce à la fonction [Jauge](../WDLang1/3021008.md).




Pour afficher simultanément diverses informations, il est possible de diviser la barre de message en plusieurs cases (option "Insérer une case" dans le menu contextuel de la barre de message).
<a name="NOTE14_2"></a>


### Fenêtre de description d'une barre de message
<a name="fenetre_description_une_barre_message_ELTPARAGRAPHE000863"></a>La fenêtre de description d'une barre de message permet de :

- ajouter et/ou supprimer des cases.

- modifier l'ordre des cases.

- spécifier pour chaque case les informations à afficher.




Pour plus de détails, consultez l'aide en ligne.
<a name="NOTE14_3"></a>


### Type d'une case de la barre de message
<a name="type_une_case_barre_message_ELTPARAGRAPHE000878"></a>Le type de la case permet d'afficher :

- La jauge de progression. Cette jauge sera exécutée lors de l'utilisation de la fonction [Jauge](../WDLang1/3021008.md).

- Le message d'aide associé au champ ayant le focus. Ce message d'aide est défini dans l'onglet "Aide" du champ ou par programmation grâce à la propriété [Message](../Proprietes/2510078.md).

- La date du poste en cours.

- L'heure du poste en cours.

- La position du curseur dans le champ de saisie en cours (option Colonne et Ligne du Caret).

- L'état de la touche Maj, indiquant si la touche de verrouillage des majuscules est activée ou non.

- L'état de la touche Inser, indiquant si la touche Inser est activée ou non.

- Le nom de l'utilisateur actuel dans une application utilisant le groupware utilisateur.




Deux options spécifiques sont également disponibles :

- Par programmation : Les informations affichées dans la barre de message sont spécifiées par programmation (fonction [Message](../WDLang1/3021006.md) par exemple).

- L'événement de mise à jour : L'événement "A chaque mise à jour" est automatiquement associé à la case de la barre de message. Cet événement est alors exécuté régulièrement. Cet événement peut par exemple contenir les éléments à afficher dans la case.



<a name="NOTE14_4"></a>


### Caractéristiques d'une case de la barre de message
<a name="caracteristiques_une_case_barre_message_ELTPARAGRAPHE000910"></a>La fenêtre de description de la barre de message permet également de définir les différentes caractéristiques d'affichage des cases de la barre de message.

- La position de la case dans la barre de message.

- L'image de fond de la case.

- La couleur de fond de la case.

- La largeur de la case.

- Si la case est en saisie.

- L'ancrage de la case (son fonctionnement lors du redimensionnement de la fenêtre).


Toutes ces caractéristiques peuvent être manipulées par programmation grâce aux propriétés disponibles sur les cases des barres de message.

| [Page précédente](../Concepts_WD/1410086973.md) | [Sommaire](../Concepts_WD/1410087098.md) | [Page suivante](../Concepts_WD/1410086975.md) |
| --- | --- | --- |




