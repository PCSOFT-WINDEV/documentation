


## JSON (Type de variable)

***En anglais : JSON***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **JSON** permet de simplifier les manipulations des données au format JSON.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
V est un JSON
```

```wl
jedi est un JSON = [
	{
	"id": 5,
	"name": "Luke Skywalker",
	"pilotingScore": 98,
	"shootingScore": 56,
	"isForceUser": true
	}
]
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Déclaration et affectation d'un type JSON

`<Nom de la variable> est un JSON = <Valeur>

OU 
  <Nom de la variable> est un JSON
  <Nom de la variable> = <Valeur>`
---

**`<Nom de la variable> : ()`**

Nom de la variable à déclarer.

**`<Valeur> : ()`**

Valeur à affecter à la variable. Une variable de type JSON peut être affectée avec :

- NULL,

- un booléen (Vrai ou Faux),

- un numérique, 

- une date (convertie automatiquement en chaîne au format RFC),

- une chaîne Ansi ou Unicode contenant une donnée, 

- une chaîne Ansi contenant des données au format JSON. 






<a name="NOTE0"></a>

## Remarques
<a name="NOTE0_1"></a>


### Importation de fichiers au format JSON
<a name="importation_fichiers_format_json_ELTPARAGRAPHE000049"></a>Les variables de type **JSON** peuvent être déclarées en indiquant un document exemple (un fichier texte). La structure de ce document sera lue par WINDEV, WEBDEV et WINDEV Mobile. Il sera ainsi possible de disposer de la complétion automatique sur les noms des noeuds directement dans l'éditeur de code.

Pour déclarer une variable de type JSON avec un document exemple :

1. Ajoutez le document texte dans le projet grâce à une des méthodes suivantes : 

	- sous le volet "Projet", dans le groupe "Projet", déroulez "![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_listeprojet.gif)
 Liste des éléments" et cliquez sur "Liste des éléments du projet". La liste des éléments du projet s'affiche. Cliquez sur le bouton "Ajouter" et sélectionnez le document texte. 

	- réalisez un "Drag and Drop" du fichier vers le dossier "Descriptions externes" du volet "Explorateur de projet". 

	- dans le volet "Explorateur de projet", sélectionnez le dossier "Descriptions externes", puis l'option "Importer un XML ou un JSON dans ce projet" du menu contextuel. 




2. Le document JSON apparaît sous le dossier "Descriptions externes" de l'explorateur de projet. Il est possible de visualiser sa structure.

3. Déclarez la variable de la façon suivante :
	
	```txt
	<Nom de la variable> est un JSON , description =  <Nom du document>
	```

	ou
	
	```txt
	<Nom de la variable> est un JSON <description =  "Nom du document">
	```

	 peut correspondre au nom du document exemple (avec ou sans son extension). 
	**Remarque** :  Cette déclaration peut être obtenue automatiquement en "droppant" le nom du document texte directement depuis l'explorateur de projet. 

4. Vous pouvez maintenant accéder directement aux noeuds de la variable par leurs noms. Ces noms sont proposés automatiquement par le mécanisme de complétion automatique de l'éditeur de code.




Remarque : Il est également possible d'obtenir l'assistance et la vérification à la compilation sur une sous-partie du JSON en utilisant la syntaxe suivante : 

```txt
v2 est un JSON, description="FichierJSON.Membre.SousMembre"
```


```txt
v2 est un JSON <description="FichierJSON.Membre.SousMembre">
```
<a name="NOTE0_2"></a>


### Affectation et lecture
<a name="affectation_lecture_ELTPARAGRAPHE000094"></a>

- **Affectation d'une variable JSON** 
	La notation "j = ..." essaie d'analyser la valeur comme une chaîne au format JSON. Cette notation est "presque" équivalent à la notation "j..FormatJSON = ..." **sauf** si la chaîne au format JSON est invalide : elle est alors recopiée directement sans interprétation, comme valeur de l'élément JSON.
	La notation "j..Membre = ..." affecte la valeur du membre. Cette notation est équivalente à "j..Membre..Valeur = ... ". 

- **Lecture d'une variable JSON**
	La notation "... = j" renvoie la chaîne au format JSON correspondant au contenu de la variable. Cette notation est équivalente à "... = j..FormatJSON". 
	La notation "... = j..Membre" renvoie la valeur du membre. Cette notation est équivalente à "... = j..Membre..Valeur". 



<a name="NOTE0_3"></a>


### Propriétés spécifiques à la description des variables de type JSON
<a name="proprietes_specifiques_description_des_variables_type_json_ELTPARAGRAPHE000110"></a>Les propriétés suivantes peuvent être utilisées pour manipuler une variable de type JSON :

| Nom de la propriété | Type manipulé | Effet |
| --- | --- | --- |
| Existe | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> si l'élément existe, <br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. <br><br><br>**Cette propriété est disponible en lecture seulement**. |
| FormatJSON | Chaîne de caractères | Chaîne au format JSON correspondant à la valeur de l'élément. Si cette chaîne n'est pas au format JSON, un warning est affiché. |
| Membre | Tableau de variables JSON | Membres de la variable JSON. |
| Nom | Chaîne de caractères | Nom du membre. Correspond à chaîne vide ("") s'il n'y a pas de membre. |
| Occurrence | Entier | Nombre d'éléments : <br><br>- 0 pour les éléments simples, <br><br>- 1 pour les objets, <br><br>- Nombre d'éléments pour les tableaux. <br><br><br>**Cette propriété est disponible en lecture seulement**. |
| Type | Entier | Type de l'élément. <br>**Cette propriété est disponible en lecture seulement**. |
| Valeur | Tous types | <br><br>- Valeur d'un élément simple, <br><br>- NULL pour un élément complexe. <br><br><br> |






