


## Durée (Type de variable)

***En anglais : Duration***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **Durée** permet de manipuler simplement des intervalles de dates et d'heures. Le type **Durée** peut être utilisé par exemple pour réaliser des calculs (différence, addition, ...). Pour plus de détails, consultez le chapitre [Opérations disponibles sur le type Durée](../Motscles/1514040.md).

**Remarques** :

- Plusieurs propriétés peuvent être utilisées avec le type **Durée**, pour récupérer par exemple le nombre de jours ou de minutes.

- Pour affecter une durée provenant du résultat d'une fonction, utilisez la fonction [ChaîneVersDurée](../WDLang1/3027002.md).

- Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
HeureDébut est une Heure = "1330"
HeureFin est une Heure = "1730"     
DuréeCongrès est une Durée = HeureFin - HeureDébut
```

```wl
DuréeTâche est une durée = 3 min 30s
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Déclarer et initialiser une variable

`<Nom de la variable> est une Durée = <Valeur>
OU

 <Nom de la variable> est une Durée
<Nom de la variable> = <Valeur>`
---

**`<Nom de la variable> : ()`**

Nom de la variable à déclarer. Lorsque plusieurs variables du même type sont déclarées et initialisées sur la même ligne, seule la dernière variable est initialisée.

**`<Valeur> : ()`**

Le plus souvent, une durée est le résultat d'une opération effectuée entre des variables de type [Date](../Motscles/1514066.md), [Heure](../Motscles/1514068.md) ou [DateHeure](../Motscles/1514070.md). 
Cette valeur peut correspondre à : 

- une chaine de caractères, 

- un entier (nombre de millisecondes de la durée), 

- une durée (par exemple, une autre variable de type durée), 

- l'indication directe de la durée (par exemple : 30 s). 


0 permet de ré-initialiser la durée.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Valeurs d'une durée
<a name="valeurs_une_duree_ELTPARAGRAPHE000105"></a>Si une variable de type Durée est manipulée : 

- grâce à une chaîne, cette chaîne est au format : "+JHHMMSSCCC" (Jours, heures, minutes, secondes, millièmes de seconde).  

- grâce à un entier, cet entier correspond au nombre de millisecondes de la durée.

- grâce à une durée, cette durée peut correspondre à une variable de type Durée ou à l'indication directe de la durée. 


Le plus souvent, une durée est le résultat d'une opération effectuée entre des variables de type [Date](../Motscles/1514066.md), [Heure](../Motscles/1514068.md) ou [DateHeure](../Motscles/1514070.md). Cette valeur peut être une durée.

0 permet de ré-initialiser la durée.


<a name="NOTE0_2"></a>


### Les propriétés utilisables sur les durées
<a name="les_proprietes_utilisables_sur_les_durees_ELTPARAGRAPHE000135"></a>Les propriétés utilisables sur les durées sont les suivantes : 


|   |   |
| --- | --- |
| [EnHeures](../Proprietes/1000017296.md) | Renvoie ou modifie le nombre d'heures correspondant à une durée. Le nombre d'heures est exprimé sous forme de réel. |
| [EnJours](../Proprietes/1000017295.md) | Renvoie ou modifie le nombre de jours correspondant à une durée. Le nombre de jours est exprimé sous forme de réel. |
| [EnMillisecondes](../Proprietes/1000017299.md) | Renvoie ou modifie le nombre de millisecondes correspondant à une durée. Le nombre de millisecondes est exprimé sous forme d'entier. |
| [EnMinutes](../Proprietes/1000017297.md) | Renvoie ou modifie le nombre de minutes correspondant à une durée. Le nombre de minutes est exprimé sous forme de réel. |
| [EnSecondes](../Proprietes/1000017298.md) | Renvoie ou modifie le nombre de secondes correspondant à une durée. Le nombre de secondes est exprimé sous forme de réel. |
| [Heure](../Proprietes/2512038.md) | Renvoie ou modifie le nombre d'heures. Le nombre d'heures est exprimé sous forme d'entier. |
| [Jour](../Proprietes/2512043.md) | Renvoie ou modifie le nombre de jours. Le nombre de jours est exprimé sous forme d'entier. |
| [Milliseconde](../Proprietes/2512062.md) | Renvoie ou modifie le nombre de millisecondes. Le nombre de millisecondes est exprimé sous forme d'entier. |
| [Minute](../Proprietes/2512050.md) | Renvoie ou modifie le nombre de minutes. Le nombre de minutes est exprimé sous forme d'entier. |
| [Seconde](../Proprietes/2512081.md) | Renvoie ou modifie le nombre de secondes. Le nombre de secondes est exprimé sous forme d'entier. |


Pour plus de détails sur les opérations possibles sur les durées (addition, soustraction, comparaison), consultez [Opérations disponibles sur le type Durée](../Motscles/1514040.md).

```wl
HeureDébut est une Heure = "1330"
HeureFin est une Heure = "1730"     
DuréeCongrès est une Durée = HeureFin - HeureDébut
Info("Le congrès a duré : " + DuréeCongrès.Heure + " heures")
```

**Important** : Pour mémoriser les valeurs des propriétés listées dans le tableau ci-dessus, il est impératif de respecter le type de variable renvoyé par chaque propriété. Par exemple :

```wl
MaDurée est une Durée
CombienEnHeure est un réel

MaDurée.Jour = 5
CombienEnHeure = MaDurée.EnHeures

Info(MaDurée.Jour + " jours = " + CombienEnHeure + " heures.")
```

Dans cet exemple, la variable **CombienEnHeure** doit être déclarée en tant que réel et non en tant que entier. Si cette variable est déclarée en tant que entier, sa valeur sera approchée.
<a name="NOTE0_3"></a>


### Valeurs gérées
<a name="valeurs_gerees_ELTPARAGRAPHE000207"></a>Le type **Durée** permet de gérer des durées comprises entre plus et moins 2 milliards de jours. La précision est la milliseconde.
<a name="NOTE0_4"></a>


### Affichage d'une durée dans un champ de saisie
<a name="affichage_une_duree_dans_champ_saisie_ELTPARAGRAPHE000214"></a>Pour afficher une durée dans un champ de saisie, il est possible d'utiliser la propriété [MasqueAffichage](../Proprietes/1000020008.md). Pour plus de détails, consultez [Masque d'affichage pour les durées](../Proprietes/1000020008.md). 


- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Calculssurlesdurees.gif) ***Exemples unitaires (WINDEV)*** : **Calculs sur les durées** <br>Calculs sur les dates et heures avec les fonctions WLangage : <br>- Calculer la durée écoulée entre deux instants (dates et heures)<br>- Effectuer une somme de durées<br>- Effectuer une moyenne de durées


