


## Instruction RENVOYER

***En anglais : RESULT***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
L'instruction **RENVOYER** permet de sortir de l'événement, traitement ou procédure en cours en renvoyant un compte-rendu.

Ce compte-rendu peut correspondre à : 

- une valeur. 

- plusieurs valeurs. Pour plus de détails, consultez [Valeurs de retour multiples](#NOTE0_4). 
	




L'instruction **RENVOYER** peut être utilisée dans :

- Le code de fermeture du projet,

- Le code de fermeture d'une fenêtre ou d'une page,

- Le code de fermeture d'un état,

- Une procédure (test de condition, boucle de type [POUR](../Motscles/1510001.md), [POUR TOUT](../Motscles/1510013.md), [BOUCLE](../Motscles/1510004.md), [TANTQUE](../Motscles/1510010.md), ...).




Remarque : Le mot-clé RETOUR peut également être utilisé à la place du mot-clé RENVOYER.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Appel d'une procédure renvoyant RIEN en cas de problème
// Traitement différent selon la valeur de retour
Valeur_Champ est une chaîne
Valeur_Champ = MonTraitement(Nom_Champ)
SI Valeur_Champ = "Rien" ALORS 
	Info("Aucune valeur n'a pu être calculée")
SINON
	Info("Valeur du champ : " + Valeur_Champ)
FIN
```



```wl
// -- Procédure MonTraitement
PROCEDURE MonTraitement(Champ)
SI Champ..Type = typSaisieTexte ALORS
	RENVOYER Champ..Valeur
SINON
	RENVOYER "Rien"
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Procédure

`PROCEDURE <Nom de la procédure> ([<Paramètre>])
SI <Condition> ALORS 
     RENVOYER <Valeur(s) à renvoyer>
SINON
     RENVOYER <Valeur(s) à renvoyer>
FIN`
---

**Remarques** : 

- Si la &lt;Condition&gt; est vérifiée, les opérations effectuées sont :

	- Renvoi d'un compte-rendu au traitement appelant. Le type et la valeur de &lt;Valeur à renvoyer&gt; dépend de la valeur attendue par le traitement d'appel de la procédure.

	- Sortie du bloc d'instructions.

	- Sortie du traitement (ou de la procédure) en cours.




- Il est possible de renvoyer plusieurs valeurs. Pour plus de détails, consultez [Valeurs de retour multiples](#NOTE0_4). 





<a name="SYNTAXE2"></a>

### Code de fermeture de la fenêtre, de la page ou de l'état

`RENVOYER <Valeur à renvoyer>
`
---

**Remarques** : 

- Dans ce cas, le paramètre &lt;Valeur à renvoyer&gt; doit correspondre à la valeur attendue lors de l'appel de la fenêtre, de la page ou de l'état. 

- Il est possible de renvoyer plusieurs valeurs. Pour plus de détails, consultez [Valeurs de retour multiples](#NOTE0_4). 





<a name="SYNTAXE3"></a>

### Code de fermeture du projet

`RENVOYER <Valeur à renvoyer>
`
---

**Remarque** : Dans ce cas, la &lt;Valeur à renvoyer&gt; doit être un entier. Cette valeur peut être récupérée par n'importe quelle application. Dans le cas d'une application WINDEV, la valeur renvoyée par une autre application peut être connue par la fonction [LanceAppli](../WDLang1/3035006.md).  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Instructions pouvant renvoyer une valeur
<a name="instructions_pouvant_renvoyer_une_valeur_ELTPARAGRAPHE000123"></a>Plusieurs instructions peuvent renvoyer une valeur dans une procédure :

- Instruction SI
	
	```txt
	PROCEDURE <Nom de la procédure> ([<Paramètre>])
	SI <Condition> ALORS 
		RENVOYER <Valeur à renvoyer>
	SINON
		RENVOYER <Valeur à renvoyer>
	FIN
	```


- Instruction POUR
	
	```txt
	PROCEDURE <Nom de la procédure> ([<Paramètre>])
	POUR <Variable de contrôle> = <Valeur initiale> A <Valeur finale> [PAS <x>]
		SI <Condition> ALORS RENVOYER <Valeur à renvoyer>
	FIN
	```


- Instruction POUR TOUT
	
	```txt
	PROCEDURE <Nom de la procédure> ([<Paramètre>])
	POUR TOUT <Fichier> SUR <Rubrique clé>
	...
		SI <Condition> ALORS RENVOYER <Valeur à renvoyer>
	FIN
	```


- Instruction BOUCLE
	
	```txt
	PROCEDURE <Nom de la procédure> ([<Paramètre>])
	BOUCLE
	...
		SI <Condition> ALORS RENVOYER <Valeur à renvoyer>
	...
	FIN
	```


- Instruction TANTQUE
	
	```txt
	PROCEDURE <Nom de la procédure> ([<Paramètre>])
	TANTQUE <Condition 1>
		...
		SI <Condition> ALORS RENVOYER <Valeur à renvoyer>
		...
	FIN
	```



Remarque : Ces instructions peuvent également renvoyer plusieurs valeurs. Pour plus de détails, consultez [Valeurs de retour multiples](#NOTE0_4).
<a name="NOTE0_2"></a>


### Autres instructions permettant de sortir d'une boucle ou d'une procédure
<a name="autres_instructions_permettant_sortir_une_boucle_une_procedure_ELTPARAGRAPHE000153"></a>Plusieurs instructions sont possibles :

- [RETOUR](../Motscles/1510009.md) : Sortie de la boucle et sortie du traitement (ou de la procédure) en cours.

- [SORTIR](../Motscles/1510012.md) : Sortie de la boucle et exécution de la suite du traitement (ou de la procédure) en cours.




La fonction [Ferme](../WDLang1/3038018.md) permet de sortir de la boucle (ou de la procédure) et de fermer la fenêtre en cours.
<a name="NOTE0_3"></a>


### Types renvoyés
<a name="types_renvoyes_ELTPARAGRAPHE000180"></a>Les types suivants peuvent être renvoyés :

- structure 

- structure dynamique

- classe

- type avancé

- tableau

- tableau associatif

- file

- pile

- liste



<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Valeur de retour multiple
<a name="valeur_retour_multiple_ELTPARAGRAPHE000203"></a>Une procédure, une fonction, une méthode de classe, ou une fenêtre peut renvoyer plusieurs valeurs.

La syntaxe à utiliser est la suivante : 

```txt
RENVOYER (<Valeur 1>, <Valeur 2>, ... <Valeur N>)
```
ou bien

```txt
RETOUR = (<Valeur 1>, <Valeur 2>, ... <Valeur N>)
```
Exemple : 

```wl
// Code de la procédure
PROCEDURE MaProc()

// Traitement
RENVOYER (1, 2, 3)


// Code d'appel de la procédure
( x, y, z ) = MaProc()
// x vaut 1, y vaut 2, z vaut 3
```


**Note** : 

- Dans le cas d'une fenêtre, la fonction [Ferme](../WDLang1/3038018.md) permet également de renvoyer plusieurs valeurs.

- Dans une procédure, tous les **RENVOYER** ou **RETOUR** présents dans cette procédure doivent renvoyer le même nombre de valeurs.

- Les retours multiples ne sont pas autorisés dans une procédure stockée.

- Les propriétés ne peuvent pas utiliser de valeurs multiples. 

- Dans le cas d'une procédure, les valeurs renvoyées peuvent correspondre à des types simples (entier, booléen, ...) ou à des types complexes (structures, ...). 

- Dans le cas d'une fenêtre ou d'un état, les valeurs renvoyées peuvent correspondre à des types simples (entier, booléen, ...). 

- Si la procédure, la fenêtre ou l'état renvoie plusieurs valeurs, il n'est pas obligatoire de récupérer toutes les valeurs. Il est possible d'en lire qu'une seule. Par exemple : 

	- Lecture de toutes les valeurs : 
		```wl
		( x, y, z ) = MaProc()
		```


	- Lecture d'une seule valeur : 

		- Lecture de la première valeur : 
			```wl
			(x) = MaProc()
			```
 ou bien : 
			```wl
			x = MaProc()
			```


		- Lecture de la seconde valeur : 
			```wl
			(,y) = MaProc()
			```






**Typage des valeurs de retour**
Il est possible de typer les valeurs de retour à une procédure. La syntaxe est la suivante : 

```txt
PROCEDURE NomProcédure() : ([<Type valeur 1>, [<Type valeur 2>, ... , [<Type valeur N>]]])
```
Remarque : Il n'est pas obligatoire de typer toutes les valeurs de retour. 

**Valeur de retour multiple utilisée en paramètre**
Il est possible de passer une valeur de retour multiple en paramètre à une procédure ou une fonction du WLangage.

Exemple : 

```wl
PROCEDURE f()
RENVOYER (1, 2)

PROCEDURE g(x, y)
RENVOYER x+y

z est un entier
z = g(f())
// z vaut 3
```



