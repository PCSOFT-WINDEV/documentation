
## Objet Automation

***En anglais : Automation***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le mot-clé **Automation** permet de déclarer un objet automation. L'allocation de cet objet est directement effectuée lors de la déclaration. Les objets automation permettent par exemple de manipuler des logiciels tels que Office 2007 (Word, Excel, ...).

Remarque : Il est aussi possible d'utiliser un [objet automation dynamique](../Motscles/1514015.md). Son allocation est effectuée à la demande, au cours du programme.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Déclaration d'un objet automation
MonObjetAutomation est un objet automation MonServeur
```


<a name="Exemple2"></a>



```wl
// Appel d'une méthode d'un objet automation
MonObjetAutomation>>FichierOuvrir(NomDoc)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Déclarer un objet automation

`<Nom de l'objet automation> est un objet automation <Nom du serveur automation>
`
---

**`<Nom de l'objet automation> : (Chaîne de caractères)`**

Nom de l'objet automation à déclarer.

**`<Nom du serveur automation> : (Chaîne de caractères)`**

Nom du serveur de l'objet automation.  


<a name="SYNTAXE2"></a>

### Appeler une méthode d'un objet  automation

`<Nom de l'objet automation>>><Nom de la méthode>([<Paramètres>])
`
---

**`<Nom de l'objet automation> : (Chaîne de caractères)`**

Nom de l'objet automation à manipuler. Cet objet a été préalablement déclaré.

**`<Nom de la méthode> : (Chaîne de caractères)`**

Nom de la méthode de l'objet automation à exécuter. Cette méthode est donnée par le serveur.

Remarque : La liste des méthodes pouvant être utilisées dépend du serveur. Pour connaître les méthodes, reportez-vous à la documentation du serveur.

**`<Paramètres> : (Tout type (optionnel))`**

Paramètres passés à la méthode. Pour utiliser la valeur par défaut d'un paramètre optionnel, il est possible d'utiliser "\*" ou la constante *OLEIgnore*. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Durée de vie d'un objet automation
<a name="duree_vie_objet_automation_ELTPARAGRAPHE000060"></a>L'objet automation est créé lors de sa déclaration.

L'objet automation est automatiquement détruit à la fin du traitement contenant sa déclaration.

Un objet automation déclaré "global" dans le code :

- **d'initialisation d'une fenêtre (ou d'une page)** sera détruit à la fin du traitement de fermeture de la fenêtre (ou de la page).

- **d'initialisation d'un projet** sera détruit à la fin du traitement de fermeture de la première fenêtre / page du projet.





<a name="NOTE0_2"></a>




### Allocation d'un objet automation
<a name="allocation_objet_automation_ELTPARAGRAPHE000076"></a>

- Lors de l'allocation d'un objet automation, le serveur automation est automatiquement lancé.

- Pour allouer un objet automation avec une instance existante d'un serveur automation, utilisez la fonction [ObjetActif](../WDLang3/3057006.md).





<a name="NOTE0_3"></a>




### Passage de paramètre à une méthode
<a name="passage_parametre_une_methode_ELTPARAGRAPHE000089"></a>

- Les méthodes des serveurs automation peuvent attendre un ou plusieurs paramètres.

- Lors de l'appel d'une méthode, l'ordre des paramètres doit être respecté (reportez-vous à la documentation du serveur et de ses méthodes si nécessaire).

- Pour certains serveurs automation, certains paramètres des méthodes ne sont pas valués : seule la présence du paramètre a de l'importance. La valeur prise par ce paramètre n'en a pas.
	Par exemple, la méthode "EditionRemplacer" de Word Basic accepte 10 paramètres, le dernier (RemplacerTout) étant non valué.
	En WLangage, pour les paramètres non valués, il suffit de passer une valeur quelconque.

- Les méthodes de certains serveurs automation peuvent avoir des paramètres optionnels situés à n'importe quel rang dans la liste des paramètres.




En WLangage, les paramètres optionnels doivent nécessairement être situés à droite des paramètres obligatoires.

Ainsi pour donner une valeur quelconque à un paramètre optionnel, il suffit d'affecter le caractère \* au paramètre optionnel. Par contre, ce caractère sera inutile pour les paramètres optionnels situés à droite du dernier paramètre obligatoire.




<a name="NOTE0_4"></a>
![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Utilisation d'un objet OLE Automation depuis un service
<a name="utilisation_objet_ole_automation_depuis_service_ELTPARAGRAPHE000110"></a>Tous les objets OLE Automation ne peuvent pas être utilisés par défaut depuis un [service](../WDLang1/1000017114.md). 

Par exemple, l'allocation d'un objet OpenOffice depuis un service s'exécutant avec le compte système local peut se solder par le retour d'une erreur de type "L'objet automation com.sun.star.ServiceManager n'est pas installé sur votre système". 


```wl
m_oApplication = allouer un objet Automation "com.sun.star.ServiceManager"
```


Il faut dans ce cas intervenir sur la configuration de Windows pour permettre l'utilisation de l'objet OLE Automation depuis un service. Les opérations à effectuer sont les suivantes : 

- Affichez le panneau de configuration de Windows,

- Sélectionnez l'option "Outils d'administration",

- Sélectionnez "Service de composants",

- Déroulez l'arborescence Ordinateurs/Poste de Travail/Configuration DCOM 

- Sélectionnez "OpenOffice service manager" et affichez ses propriétés (option "Propriétés" du menu contextuel)

- Dans l'onglet "Identité", sélectionnez une identité adaptée (le compte utilisateur qui exécutera l'application).









<a name="NOTE0_5"></a>


