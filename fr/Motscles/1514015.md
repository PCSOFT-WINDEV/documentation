
## Objet Automation Dynamique

***En anglais : Dynamic Automation***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Un objet automation dynamique est un objet automation alloué à la demande, au cours du programme. Les objets automation permettent par exemple de manipuler des logiciels tels que Office 2007 (Word, Excel, ...).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Déclaration d'un objet automation dynamique
MonObjetDynamique est un objet automation dynamique
```


<a name="Exemple2"></a>



```wl
// Création d'un objet automation dynamique
MonObjetDynamique = allouer un objet automation MonServeur
```


<a name="Exemple3"></a>





```wl
// Appeler une méthode d'un objet automation dynamique
MonObjetDynamique>>FichierOuvrir(NomDoc)
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Déclarer un objet automation dynamique

`<Nom de l'objet automation dynamique> est un objet automation dynamique
`
---

**`<Nom de l'objet automation dynamique> : (Chaîne de caractères)`**

Nom de l'objet automation dynamique à déclarer.  


<a name="SYNTAXE2"></a>

### Allouer un objet automation dynamique

`<Nom de l'objet automation dynamique> = allouer un objet automation <Nom du serveur automation>
`
---

**`<Nom de l'objet automation dynamique> : (Chaîne de caractères)`**

Nom de l'objet automation dynamique à allouer. Cet objet a été préalablement déclaré.

**`<Nom du serveur automation> : (Chaîne de caractères)`**

Nom du serveur de l'objet automation dynamique.  


<a name="SYNTAXE3"></a>

### Appeler une méthode d'un objet automation dynamique

`<Nom de l'objet automation dynamique>>><Nom de la méthode>([<Paramètres>])
`
---

**`<Nom de l'objet automation dynamique> : (Chaîne de caractères)`**

Nom de l'objet automation dynamique à manipuler. Cet objet a été préalablement déclaré puis alloué.

**`<Nom de la méthode> : (Chaîne de caractères)`**

Nom de la méthode de l'objet automation dynamique à exécuter. Cette méthode est donnée par le serveur.

Remarque : La liste des méthodes pouvant être utilisées dépend du serveur automation. Pour connaître les méthodes, reportez-vous à la documentation du serveur.

**`<Paramètres> : (Tout type (optionnel))`**

Paramètres passés à la méthode.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Durée de vie d'un objet automation dynamique
<a name="duree_vie_objet_automation_dynamique_ELTPARAGRAPHE000066"></a>L'objet automation dynamique est créé lors de l'allocation de l'objet.

L'objet automation dynamique est automatiquement détruit à la fin du traitement contenant sa déclaration ou lors d'une nouvelle allocation de l'objet.

Un objet automation dynamique déclaré "global" dans le code :

- ***d'initialisation d'une fenêtre*** sera détruit à la fin du traitement de fermeture de la fenêtre.

- ***d'initialisation d'un projet*** sera détruit à la fin du traitement de fermeture de la première fenêtre du projet.




Pour libérer explicitement un objet automation dynamique, utilisez la syntaxe suivante :


```txt
Libérer <Nom de l'objet automation dynamique>
```



<a name="NOTE0_2"></a>




### Allocation d'un objet dynamique
<a name="allocation_objet_dynamique_ELTPARAGRAPHE000086"></a>

- Lors de l'allocation d'un objet automation dynamique, le serveur automation est automatiquement lancé.

- Pour allouer un objet automation dynamique avec une instance existante d'un serveur automation, utilisez la fonction [ObjetActif](../WDLang3/3057006.md).





<a name="NOTE0_3"></a>


### Passage de paramètre à une méthode
<a name="passage_parametre_une_methode_ELTPARAGRAPHE000098"></a>

- Les méthodes des serveurs automation peuvent attendre un ou plusieurs paramètres.

- Lors de l'appel d'une méthode, l'ordre des paramètres doit être respecté (reportez-vous à la documentation si nécessaire).

- Pour certains serveurs automation, certains paramètres des méthodes ne sont pas valués : seule la présence du paramètre a de l'importance. La valeur prise par ce paramètre n'en a pas.
	Par exemple, la méthode "EditionRemplacer" de Word Basic accepte 10 paramètres, le dernier (RemplacerTout) étant non valué.
	En WLangage, pour les paramètres non valués, il suffit de passer une valeur quelconque.

- Les méthodes de certains serveurs automation peuvent avoir des paramètres optionnels situés à n'importe quel rang dans la liste des paramètres.




En WLangage, les paramètres optionnels doivent nécessairement être situés à droite des paramètres obligatoires.

Ainsi pour donner une valeur quelconque à un paramètre optionnel, il suffit d'affecter le caractère \* au paramètre optionnel. Par contre, ce caractère sera inutile pour les paramètres optionnels situés à droite du dernier paramètre obligatoire.


<a name="NOTE0_4"></a>


