


## Variable globale et locale
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000360"></a>
Les variables peuvent être de deux types :

- ***Variable locale*** : utilisable uniquement dans le traitement dans lequel cette variable a été déclarée.

- ***Variable globale*** : utilisable dans tous les traitements dépendant du traitement dans lequel cette variable a été déclarée.




**Important** : Il ne faut pas déclarer deux variables avec le même nom (notamment une variable globale et une variable locale).



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Variable globale
<a name="variable_globale_ELTTEXTE000384"></a>


### Variables globales à un projet
<a name="variables_globales_projet_ELTPARAGRAPHE000034"></a>Les variables globales ***déclarées dans l'événement "Initialisation" d'un projet*** peuvent être utilisées dans tous les événements ou traitements :

- du projet.

- de la fenêtre ou de la page (événements de la fenêtre ou de la page, de ses champs et des procédures locales associées).

- de l'état (événements de l'état, de ses champs et des procédures locales associées).





<a name="NOTE2_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Variables globales à une fenêtre
<a name="variables_globales_une_fenetre_ELTPARAGRAPHE000090"></a>Les variables globales ***déclarées dans l'événement "Déclarations globales" d'une fenêtre*** peuvent être utilisées dans tous les événements ou traitements :

- de la fenêtre.

- des champs de la fenêtre.

- des procédures locales associées à la fenêtre.




**Limites :**

- Les variables globales d'une fenêtre ne peuvent pas être utilisées par ses fenêtres soeurs.

- Les variables globales déclarées dans une fenêtre fille ne peuvent pas être utilisées dans sa fenêtre mère.

- Lorsque la fenêtre dans laquelle la variable a été déclarée est fermée, cette variable ne peut plus être utilisée.




**Remarque : Utilisation d'une variable globale dans une fenêtre fille de la fenêtre de déclaration**

Les variables déclarées globales dans une fenêtre sont visibles dans les fenêtres filles de cette fenêtre dans les cas suivants :

- Si le mot-clé [Externe](../Motscles/1511013.md) est utilisé pour déclarer la variable dans la fenêtre fille.

- Si le nom de la variable est préfixé par le nom de la fenêtre.

- Si la variable est passée en paramètre à la fenêtre fille.



<a name="NOTE2_3"></a>
<a name="NOTE2_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Variables globales à un état
<a name="variables_globales_etat_ELTPARAGRAPHE000204"></a>Les variables globales ***déclarées dans l'événement "Ouverture" d'un état*** peuvent être utilisées dans tous les événements ou traitements :

- de l'état.

- des champs de l'état.

- des procédures locales associées à l'état.



<a name="NOTE2_5"></a>


### Variables globales à une collection de procédures
<a name="variables_globales_une_collection_procedures_ELTPARAGRAPHE000215"></a>Les variables globales ***déclarées dans l'événement "Déclaration" d'une collection de procédures*** peuvent être utilisées dans tous les événements ou traitements :

- des différentes procédures de la collection.

- du projet en cours.



<a name="NOTE2_6"></a>


### Comment utiliser une variable globale depuis un composant
<a name="comment_utiliser_une_variable_globale_depuis_composant_ELTPARAGRAPHE000225"></a>Le but du composant étant généralement d'être autonome, il n'est pas recommandé d'utiliser une variable globale du projet depuis celui-ci.

La méthode recommandée est cependant la suivante :

- créez une variable globale dans le composant.

- créez dans le composant une procédure permettant d'initialiser ces variables globales.

- depuis l'événement "Initialisation" du projet, et à chaque modification de la valeur des variables globales du projet, appelez cette procédure pour affecter une valeur similaire aux variables globales du composant. 




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Variable globale : Syntaxe
<a name="variable_globale_syntaxe_ELTTEXTE000438"></a>


### Déclarer une ou plusieurs variables globales
<a name="declarer_une_plusieurs_variables_globales_ELTPARAGRAPHE000240"></a>
```txt
GLOBAL
	<Variables globales>
```
**Détail de la syntaxe**


|   |   |
| --- | --- |
| **GLOBAL** | Début de déclaration des variables globales. |
| **&lt;Variables globales&gt;** | Variables globales à déclarer. |

Remarque : Le mot-clé **GLOBAL** peut être remplacé par le mot-clé **GLOBALE** ou **GLOBALES**.


```wl
GLOBAL // Toutes les déclarations qui suivent sont des variables globales
Indice est un entier
NomClient est une chaîne
Taux est un réel

LOCAL // Toutes les déclarations qui suivent sont des variables locales
I est un entier 
PrénomClient est une chaîne
Prix est un monétaire
```


<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Variable locale
<a name="variable_locale_ELTTEXTE000462"></a>
Les variables locales peuvent être utilisées uniquement dans les événements ou traitements dans lesquels elles sont déclarées. En dehors de ces événements ou traitements, les variables locales sont inconnues. Ces variables ne pourront pas être partagées par plusieurs événements ou traitements.

Par défaut, lors de sa déclaration, une variable est locale.

<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Variable locale : Syntaxe
<a name="variable_locale_syntaxe_ELTTEXTE000486"></a>


### Déclarer une ou plusieurs variables locales
<a name="declarer_une_plusieurs_variables_locales_ELTPARAGRAPHE000274"></a>
```txt
[LOCAL]
	<Variables locales>
```
**Détail de la syntaxe**


|   |   |
| --- | --- |
| **LOCAL** | Début de déclaration des variables locales. L'utilisation du mot-clé **LOCAL** est optionnelle. |
| **&lt;Variables locales&gt;** | Variables locales à déclarer. |


Remarque : Le mot-clé **LOCAL** peut être remplacé par le mot-clé **LOCALE** ou **LOCALES**.
```wl
LOCAL // Toutes les déclarations qui suivent sont des variables locales
I est un entier
PrénomClient est une chaîne 
Prix est un monétaire
```

```wl
// Toutes les déclarations qui suivent sont des variables locales
I est un entier
PrénomClient est une chaîne 
Prix est un monétaire
```


<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Variables locales et globales zombie
<a name="variables_locales_globales_zombie_ELTTEXTE000510"></a>
Une variable locale ou globale peut devenir obsolète. Il est ainsi possible de savoir que cet élément ne doit plus être utilisé (mais il n'est pas encore supprimé). 

Pour déclarer une variable comme étant obsolète, il suffit d'utiliser l'attribut d'extension &lt;Zombie&gt;. 

La syntaxe est la suivante : 

```txt
<Nom Variable> est un <type de la variable> <zombie [commentaire = "texte"]>
```


Dans cette syntaxe, le mot-clé optionnel **commentaire** permet d'indiquer le texte qui sera affiché dans l'erreur de compilation associée à la variable obsolète. 

Exemple : 

```wl
PrénomClient est une chaîne <zombie commentaire = "Ne plus utiliser - utiliser la structure Client">
```



