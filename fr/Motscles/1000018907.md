
## Procédure (Type de variable)

***En anglais : Procedure ***
				



<a name="description"></a>
Le type **Procédure** permet de manipuler par programmation :  

- les procédures ou méthodes présentes dans le projet. 

- les procédures ou méthodes présentes dans un composant interne.

- les procédures ou méthodes présentes dans un composant externe. 




Ce type de variable est très utile notamment : 

- pour optimiser le temps de lancement des procédures. L'utilisation de ce type de variable permet de remplacer les procédures exécutées par la fonction [ExécuteTraitement](../WDLang1/3013031.md). 

- pour mettre en place des algorithmes avancés (événements personnalisés, notifications, ...). 








Cette page d'aide présente : 

- [Affectation simple d'une variable de type Procédure](#NOTE0_1). 

- [Affectation multiple d'une variable de type Procédure](#NOTE0_2). 

- [Ordre d'exécution des procédures](#NOTE0_5).

- [Passage de paramètres de type Procédure par référence ou par valeur](#NOTE0_3).

- [Appel des procédures présentes dans une variable de type Procédure](#NOTE0_4).  





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
p est une Procédure
// Affectation de la variable Procédure avec la procédure "MaProcédure" présente dans le projet
p = MaProcédure
// Exécution de la procédure
p(5)
// Equivalent de MaProcédure(5)
```



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Affectation d'une variable de type Procédure
<a name="affectation_une_variable_type_procedure_ELTPARAGRAPHE000079"></a>Une variable de type **Procédure** peut être affectée avec : 

- **une procédure connue dans le projet**. 
	La syntaxe à utiliser est la suivante : 
	
	```txt
	<Nom de la variable de type Procédure> = <Procédure>
	```

	Par exemple : 
	
	```wl
	p est une Procédure
	p = TestExistence
	```

	Remarques : 

	- Le paramètre &lt;Procédure&gt; doit correspondre à une procédure existante dans le projet. 

	- Le paramètre &lt;Procédure&gt; ne doit pas être mis entre guillemets. 

	- Le paramètre &lt;Procédure&gt; ne doit pas être suivi des paramètres d'appel. 

	- Le paramètre &lt;Procédure&gt; ne doit pas correspondre au nom d'une procédure interne. 




- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) **une procédure compilée dynamiquement avec la fonction [Compile](../WDLang1/3013015.md)**. 
	La syntaxe à utiliser est la suivante : 
	
	```txt
	<Nom de la variable de type Procédure> = Compile(<Code de la procédure>)
	
	ou 
	
	<Nom de la variable de type Procédure> = 
				Compile(<Nom Procédure>, <Code de la procédure>)
	```

	Par exemple : 
	
	```wl
	p est une Procédure
	p = Compile("RENVOYER n1 + n2")
	```

	Remarques : 

	- Si le nom de la procédure est spécifiée, la procédure pourra également être exécutée par les fonctions [Exécute](../WDLang1/3013041.md) et [ExécuteTraitement](../WDLang1/3013031.md). 

	- Par défaut, la procédure compilée dynamiquement est une procédure globale. Pour définir une procédure locale, il est nécessaire d'utiliser la syntaxe définissant le nom de la procédure pour spécifier l'élément voulu dans le nom de la procédure. 




- **une méthode de classe**. 
	La syntaxe à utiliser est la suivante : 
	
	```txt
	<Nom de la variable de type Procédure> = <Méthode>
	```

	Remarques : 

	- Le paramètre &lt;Méthode&gt; peut correspondre à une méthode de la classe courante ou d'une classe de base. 

	- Si &lt;Méthode&gt; est une méthode d'instance, la notation suivante doit être utilisée :
			
		```txt
		<Un_Objet>.<Méthode>
		```










**Autres syntaxes disponibles**

- Il est également possible de recopier les procédures d'une variable de type **Procédure** dans une autre variable de type **Procédure**. La syntaxe est la suivante : 
	
	```txt
	<Nom de la variable de type Procédure destination> = 
			<Nom de la variable de type Procédure source>
	```

	Remarque : Il s'agit d'une copie de variable : toute modification sur une des variables ne sera pas répercutée sur l'autre. 

- Il est également possible de chercher à l'exécution une procédure connue par son nom et de l'affecter à une variable de type **Procédure**. Dans ce cas, la syntaxe à utiliser est la suivante : 
	
	```txt
	<Nom de la variable de type Procédure> = <Nom de la procédure (avec guillemets)>
	```

	Remarque : L'utilisation de cette syntaxe pour l'affectation d'une variable de type **Procédure** est relativement lente car le nom de la procédure est recherché dans toutes les procédures du projet.  

- **Affectation par référence (opérateur &lt;-)**
	L'affectation par prise de référence force l'élément destination à référencer la même zone de données que l'élément source.
	Ainsi, une variable de type **Procédure** peut être manipulée par une autre variable de type **Procédure**. Pour cela, il faut récupérer une référence sur la variable **Procédure** elle-même. Toute modification ultérieure sur une des variables sera répercutée sur l'autre.
	La syntaxe à utiliser est la suivante : 
	
	```txt
	<Nom variable de type Procédure destination> <- <Nom variable de type Procédure source>
	```




<a name="NOTE0_2"></a>


### Affectation multiple d'une variable de type Procédure
<a name="affectation_multiple_une_variable_type_procedure_ELTPARAGRAPHE000167"></a>Il est possible d'affecter plusieurs procédures ou méthodes à une variable de type **Procédure** grâce à l'opérateur "+=". Les différentes procédures seront appelées les unes à la suite des autres. 

Par exemple : 


```wl
p est une procédure
p += Proc1
p += Proc2
```


Remarque : Pour supprimer une procédure d'une variable de type **Procédure**, il est possible d'utiliser l'opérateur "-=". 

Par exemple : 


```wl
p est une procédure
p += Proc1
p += Proc2

...

p -= Proc2
```

<a name="NOTE0_5"></a>


### Ordre d'exécution des procédures
<a name="ordre_execution_des_procedures_ELTPARAGRAPHE000188"></a>

Il est possible de remplacer ou d'insérer une procédure avant ou après les autres procédures dans un élément de type **Procédure** grâce aux propriétés [Avant](../Proprietes/1000020916.md) et [Après](../Proprietes/1000020917.md). 

Exemple : 


```wl
p est une Procédure
p = MaProcédure
p.Après = MaProcédureAppeléeAprès
p.Avant = MaProcédureAppeléeAvant

// L'ordre d'appel des procédures sera :
// - MaProcédureAppeléeAvant
// - MaProcédure
// - MaProcédureAppeléeAprès
p()
```





<a name="NOTE0_3"></a>


### Passage de paramètres de type Procédure par référence ou par valeur
<a name="passage_parametres_type_procedure_par_reference_par_valeur_ELTPARAGRAPHE000206"></a>

Pour manipuler une procédure comme paramètre d'une autre procédure, il est nécessaire de typer le paramètre. La syntaxe à utiliser est la suivante : 

- pour un passage de paramètres par référence : 
	
	```txt
	PROCEDURE <NomProcédure>(MaProcédure est une Procédure)
	```


- pour un passage de paramètres par valeur : 
	
	```txt
	PROCEDURE <NomProcédure>(LOCAL MaProcédure est une Procédure)
	```





Les appels possibles à la procédure &lt;NomProcédure&gt; sont alors : 

- **appel en spécifiant une procédure connue du projet** : la syntaxe à utiliser est la suivante : 
	
	```txt
	NomProcédure(<Procédure du projet>)
	```

	Remarques : 

	- Le paramètre &lt;Procédure du projet&gt; doit correspondre à une procédure existante dans le projet. 

	- Le paramètre &lt;Procédure du projet&gt; ne doit pas être mis entre guillemets. 

	- Le paramètre &lt;Procédure du projet&gt; ne doit pas être suivi des paramètres d'appel. 




- **appel en spécifiant une méthode de classe** : la syntaxe à utiliser est la suivante : 
	
	```txt
	NomProcédure(<Méthode>)
	```

	Remarques : 

	- Le paramètre &lt;Méthode&gt; peut correspondre à une méthode de la classe courante ou d'une classe de base.

	- Si &lt;Méthode&gt; est une méthode d'instance, la notation suivante doit être utilisée &lt;Un_Objet&gt;.&lt;Méthode&gt;.




- **appel avec référence à une variable procédure** : la syntaxe à utiliser est la suivante : 
	
	```txt
	NomProcédure(<Nom de la variable de type Procédure>)
	```


- **appel avec recherche à l'exécution une procédure connue par son nom** : la syntaxe à utiliser est la suivante : 
	
	```txt
	NomProcédure(<Nom de la procédure (avec guillemets)>)
	```




<a name="NOTE0_4"></a>


### Appel des procédures présentes dans une variable de type Procédure
<a name="appel_des_procedures_presentes_dans_une_variable_type_procedure_ELTPARAGRAPHE000248"></a>L'appel des procédures présentes dans une variable de type Procédure est réalisé par la syntaxe classique des procédures. Cette syntaxe est utilisée directement sur la variable Procédure avec des parenthèses contenant 0, 1 ou plusieurs paramètres : 


```txt
<Nom de la variable Procédure> ([<Paramètre 1> [, ...[, <Paramètre N>]]])
```


Exemples : 


```wl
p1 est une Procédure
p1 = Proc1
p1()

p2 est une Procédure
p2 = Proc2
p2(1,2)
```


Si la variable de type Procédure contient plusieurs procédures, toutes les procédures sont exécutées dans l'ordre des affectations. 


```wl
p3 est une Procédure
p3 += Proc3_1
p3 += Proc3_2
p3("paramètre")	// appelle Proc3_1 et Proc3_2
```


**Gestion de la valeur de retour**

- Si la variable de type Procédure contient une seule procédure, l'appel renvoie la valeur de retour de la procédure.

- Si la variable de type Procédure contient plusieurs procédures, l'appel renvoie la valeur de retour de la dernière procédure appelée.







- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=LetypeProcedure.gif) ***Exemples unitaires (WINDEV)*** : **Le type Procédure** <br>Utilisation du type Procédure du WLangage.<br>Ce type Procédure permet de gérer très facilement une liste de procédures.<br>Il est possible d'en ajouter et d'en supprimer dynamiquement (avec les opérateurs += et -=)




