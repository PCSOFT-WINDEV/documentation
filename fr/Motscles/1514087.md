
## Portée des procédures
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000187"></a>
La portée d'une procédure définit si elle est publique, privée, etc. Cette page présente les différences des types de portée possibles selon le type de procédure utilisé et leurs conséquences sur votre code. 

La portée des procédures peut concerner : 

- Les procédures d'une collection de procédures.

- Les méthodes d'une classe. 

- Les procédures d'un champ. 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Procédures d'une collection
<a name="procedures_une_collection_ELTTEXTE000211"></a>
Lors de la création d'une procédure, différentes visibilités sont possibles : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Port%E9e_proc%E9dure%20-%20HC%20N%B0001.gif)


Par défaut, la procédure est "Publique".

Trois cas sont possibles :

- **Procédure publique** : La procédure sera utilisable depuis n'importe que traitement ou événement du projet. 
	Dans le cas d'un projet permettant de générer un Webservice, cette procédure publique sera exportée dans le Webservice (la procédure est un point d'entrée visible du Webservice). 

- **Procédure privée** : La procédure n'est pas utilisable depuis un autre élément du projet (collections de procédures, fenêtres, ...). 
	Dans le cas d'un projet permettant de générer un Webservice, cette procédure privée ne sera pas exportée dans le Webservice. 
	La procédure peut être appelée uniquement depuis la collection de procédures dans laquelle elle est définie.

- **Procédure restreinte** : La procédure sera utilisable dans tout le projet mais sans être exportée dans un Webservice ou un composant externe.








<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Méthodes d'une classe
<a name="methodes_une_classe_ELTTEXTE000235"></a>
Lors de la création d'une méthode de classe, différentes visibilités sont possibles : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Port%E9e_proc%E9dure%20-%20HC%20N%B0002.gif)


Par défaut, une méthode de classe est "Publique".

Plusieurs cas sont possibles :

- **Méthode publique** : la méthode de classe est accessible depuis n'importe quel élément du projet et elle est exportée lors de la génération d'un composant externe ou d'un Webservice.

- **Méthode restreinte** : la méthode de classe reste utilisable dans tous les éléments du projet mais elle n'est pas exportée dans les composants externes ou dans les Webservices.

- **Méthode protégée** : la méthode est accessible à l'intérieur du code de la classe et des classes dérivées uniquement. La méthode est exportée lors de la génération d'un composant externe ou d'un Webservice.

- **Méthode protégée restreinte** : la limitation est identique à la portée "protégée", mais la méthode ne sera pas exportée lors d'une génération de composant externe ou de Webservice.

- **Méthode privée** : la méthode est accessible uniquement à l'intérieur du code de la classe courante.








<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Procédures d'un champ
<a name="procedures_champ_ELTTEXTE000259"></a>
Les champs peuvent contenir des procédures locales au champ (fonctionnalité utilisée par exemple par les Champs Métier livrés dans le produit). Ces procédures peuvent être publiques ou privées. 


![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Port%E9e_proc%E9dure%20-%20HC%20N%B0003.gif)


Une procédure privée sera utilisable uniquement dans le champ auquel elle appartient. Cela permet par exemple d'isoler le code et d'éviter des appels abusifs : un champ A ne pourra pas appeler une procédure d'un champ B.





<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Tableau récapitulatif
<a name="tableau_recapitulatif_ELTTEXTE000283"></a>



|   |   |   |   |
| --- | --- | --- | --- |
|   | Publique | Restreinte | Privée |
| Accès depuis l'élément | Oui | Oui | Oui |
| Accès depuis un autre élément du projet | Oui | Oui | Non |
| Accès depuis un projet tiers via un Webservice ou un composant externe | Oui | Non | Non |







<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Modifications de la portée
<a name="modifications_portee_ELTTEXTE000307"></a>


### Modifier la portée d'une procédure
<a name="modifier_portee_une_procedure_ELTPARAGRAPHE000119"></a>La portée d'une procédure ou d'une méthode peut être modifiée à tout moment :

- soit en écrivant directement la nouvelle portée dans le code de la procédure ou de la méthode,

- soit en effectuant un clic droit sur l'élément dans le volet "Explorateur du projet" et en cochant la visibilité souhaitée.


Dans le volet "Explorateur de projet", la portée de la procédure ou de la méthode peut être identifiée via la couleur du picto :

- les éléments privés en rouge,

- les éléments protégés en orange,

- les éléments publics en vert.









### Passage d'un projet issu d'une ancienne version vers la version 28 ou supérieure
<a name="passage_projet_issu_une_ancienne_version_vers_version_28_superieure_ELTPARAGRAPHE000137"></a>Pour les projets issus d'une ancienne version (version 27 et antérieures), une nouvelle erreur de compilation liée au changement de comportement du mot-clé "PRIVÉ" peut apparaître lors du passage en version 28.
En effet, avant la version 28, le mot-clé "Privé" avait pour le même effet que le mot-clé "Restreint" actuel. Lors du passage en version 28, il peut donc être nécessaire de remplacer le mot-clé "Privé" par le mot-clé "Restreint". Une erreur de compilation vous aide à détecter les différents cas dans votre projet. 


