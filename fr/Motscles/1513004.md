


## Surcharger une fonction WLangage ou utiliser une fonction WLangage dans une requête SQL
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000293"></a>
Le WLangage propose le mot-clé "**WL.**" pour :

- [Surcharger une fonction WLangage](#NOTE2_1).

- [Utiliser une fonction WLangage dans une requête SQL exécutée par le moteur HFSQL](#NOTE3_1).
	Remarque : Le mot-clé "**WL.**" permet également d'utiliser une constante WLangage dans une requête SQL contenant une fonction WLangage.






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Surcharger une fonction WLangage
<a name="surcharger_une_fonction_wlangage_ELTTEXTE000323"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Présentation
<a name="presentation_ELTPARAGRAPHE000057"></a>La surcharge d'une fonction WLangage permet d'utiliser une fonction personnelle du même nom que la fonction WLangage.

Par exemple, au lieu d'utiliser la fonction standard du WLangage [Info](../WDLang1/3021011.md), il est possible d'utiliser une procédure personnelle nommée ***Info***. A chaque fois que la fonction ***Info*** sera utilisée, ce sera la procédure personnelle qui sera exécutée.
<a name="NOTE2_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Comment surcharger une fonction WLangage ?
<a name="comment_surcharger_une_fonction_wlangage_ELTPARAGRAPHE000071"></a>Pour surcharger une fonction WLangage : 

1. Créez une nouvelle procédure dans votre projet (procédure locale ou globale). Cette procédure doit avoir les caractéristiques suivantes :

	- Le même nom que la fonction WLangage à surcharger.

	- Le même nombre de paramètres que la fonction WLangage à surcharger. Ces paramètres doivent également être du même type que ceux de la fonction WLangage.




2. Lorsque le nom de la fonction / procédure sera utilisée dans le projet (ou dans la fenêtre si la procédure créée est locale), la procédure personnalisée sera utilisée à la place de la fonction WLangage.




**Remarques** : 

- La surcharge des fonctions du WLangage n'est pas prise en compte lors de la compilation dynamique. Par exemple, si vous avez surchargé la fonction [Trace](../WDLang1/3013050.md), l'appel de cette fonction dans un code compilé dynamiquement appellera la fonction WLangage et non la fonction surchargée.

- La surcharge des fonctions du WLangage n'est pas prise en compte dans les traitements d'une fenêtre interne, si la surcharge se trouve dans la fenêtre qui contient le champ Fenêtre interne. 

- Lorsque la fonction WLangage surchargée a plusieurs syntaxes (par exemple, fonction [ToastAffiche](../WDLang1/1000019358.md)), toutes les syntaxes appelées de cette fonction exécuteront la surcharge. Si la fonction WLangage surchargée a plusieurs syntaxes avec des paramètres de types différents, la nouvelle procédure devra donc avoir [plusieurs syntaxes](../Motscles/1514063.md) si elle doit correspondre à toutes les possibilités d'appel.

- Il est possible de surcharger des fonctions manipulant des fenêtres, des pages ou des états. Il suffit d'utiliser la notation suivante pour définir le paramètre correspondant à l'élément voulu dans la procédure surchargeant la fonction : 

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Pour les fenêtres, le paramètre doit être défini avec la notation "NomFenêtre est une chaîne &lt;nom de fenêtre&gt;". Par exemple, pour surcharger la fonction [Ouvre](../WDLang1/3038035.md), le code de la procédure sera : 
			
		```wl
		PROCEDURE Ouvre(NomFenêtre est une chaîne <nom de fenêtre>, *)
		```


	- Pour les états, le paramètre doit être défini avec la notation "NomEtat est une chaîne &lt;nom de l'état&gt;". Par exemple, pour surcharger la fonction [iImprimeEtat](../WDLang5/3046032.md), le code de la procédure sera : 
			
		```wl
		PROCEDURE iImprimeEtat(NomEtat est une chaîne <nom d'état>, *)
		```





Pour plus de détails, consultez [Paramètres d'une procédure](../Motscles/1513001.md). 



<a name="NOTE2_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Différencier la fonction WLangage et la fonction personnalisée
<a name="differencier_fonction_wlangage_fonction_personnalisee_ELTPARAGRAPHE000132"></a>Si vous avez surchargé une fonction WLangage, pour utiliser la fonction originale, il suffit de préfixer le nom de la fonction par les lettres **WL**. La syntaxe à utiliser est la suivante :

```txt
WL.<Nom de la fonction>
```
Par exemple, pour surcharger la fonction ***Trace*** du WLangage, il est possible d'utiliser le code suivant :

```wl
PROCEDURE Trace(Information1)
Message("Lancement d'une trace")
WL.Trace(Information1)
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Utiliser des fonctions WLangage dans des requêtes SQL pour HFSQL
<a name="utiliser_des_fonctions_wlangage_dans_des_requetes_sql_pour_hfsql_ELTTEXTE000359"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000144"></a>Une fonction WLangage peut être utilisée dans une requête SQL. Cette requête SQL pourra être exécutée sur des fichiers HFSQL. Il est ainsi possible par exemple d'utiliser des fonctions WLangage pour créer des conditions de sélection avancées.  

Il est possible d'utiliser des fonctions WLangage : 

- directement dans le code SQL d'une requête, 

- dans l'éditeur de requêtes (par exemple lors de la création d'une rubrique de calcul utilisant une formule mathématique), 

- avec les requêtes définies par le type [Requête SQL](../Motscles/1514082.md). 





<a name="NOTE3_2"></a>


### Comment le faire ?
<a name="comment_faire_ELTPARAGRAPHE000172"></a>Pour utiliser des fonctions WLangage dans des requêtes pour HFSQL : 

1. Créez une requête sous l'éditeur de requêtes.

2. Pour utiliser les fonctions WLangage dans la requête, utilisez la notation : WL.&lt;Nom de la fonction&gt;
	Les fonctions WLangage peuvent être utilisées par exemple :

	- Dans le code SQL de la requête. Exemple : 
			
		```sql
		-- Sélection des tâches de plus de 5 jours
		SELECT Tâche.Libellé FROM Tâche WHERE 
		WL.DateDifférence(Tâche.HeureDébut, Tâche.DateFin) > 5
		```


	- Dans une formule mathématique manipulée par une rubrique calculée.




3. La requête peut être :

	- exécutée directement sous l'éditeur de requêtes,

	- exécutée avec la fonction [HExécuteRequêteSQL](../WDLang4/3044084.md) (cas d'une requête SQL) ou avec la fonction [HExécuteRequête](../WDLang4/3044080.md).






<a name="NOTE3_3"></a>


### Remarques
<a name="remarques_ELTPARAGRAPHE000199"></a>

- Seules les fonctions WLangage sont utilisables dans les requêtes. Les propriétés ne peuvent pas être utilisées.

- Il est possible d'imbriquer plusieurs fonctions WLangage dans une requête.

- Si la fonction WLangage est utilisée dans le SELECT, le type de la valeur renvoyée est un mémo texte.

- Cette syntaxe peut être utilisée uniquement avec HFSQL Classic, Mobile et Client/Serveur.

- Les limites de la fonction WLangage sont identiques si elle est utilisée dans une requête.

- Les fonctions actuellement disponibles dans les requêtes sont les suivantes :

	- Les [fonctions de gestion des chaînes de caractères](../WDLang1/3024015.md) (Droite, Gauche, ChaîneVersDate, ...).

	- Les [fonctions de gestion des dates](../WDLang1/3027029.md) (DateSys, DateVersEntier, ...).

	- Les fonctions de gestion des entiers (EstImpair, EstPair, Exp, ...).

	- Les [fonctions de gestion des fichiers texte](../WDLang1/3036034.md).

	- Les fonctions de gestion des fichiers INI.

	- Les [fonctions de gestion de la base de registre](../WDLang1/3065004.md).




- Pour utiliser les fonctions [Ouvre](../WDLang1/3038035.md), [OuvreFille](../WDLang1/3038021.md) et [OuvrePopup](../WDLang1/3038046.md) dans les requêtes, il faut passer le nom des fenêtres sous la forme de chaînes de caractères (entre guillemets).

- Pour utiliser une constante WLangage dans les requêtes contenant des fonctions WLangage, utilisez la notation : 
	
	```txt
	WL.<Nom de la constante>
	```

	Par exemple, code SQL de la requête : 
	
	```sql
	SELECT
		WL.ExtraitChaîne('A|B|C',1,'|'),
		WL.ExtraitChaîne('A|B|C',1,'|', WL.DepuisFin) 
		FROM 
			DUAL
	```






- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=SurchargedefonctionsWLangage.gif) ***Exemples unitaires (WINDEV)*** : **Surcharge de fonctions WLangage** <br>Surcharge de fonctions du WLangage.<br>Cet exemple surcharge la fonction Trace et permet de : <br>- Afficher une trace "normale"<br>- Afficher une trace et enregistrer les données dans un fichier<br>- Effectuer une trace fichier (Les informations sont seulement enregistrées dans un fichier)


