


## Procédure locale
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000437"></a>
Les procédures peuvent être de deux types :

- ***[Procédure globale](../Motscles/1513005.md)*** : utilisable dans tous les traitements/événements du projet. Cette procédure globale est mémorisée dans le projet.

- ***Procédure locale*** : utilisable dans tous les traitements/événements dépendant de l'objet (fenêtre, page, état ou champ) dans lequel cette procédure a été déclarée. Cette procédure locale est mémorisée dans l'objet. 
	




**Important** : Il ne faut pas déclarer deux procédures avec le même nom (notamment une procédure globale et une procédure locale).

**Rappel** :

- En WLangage, il n'existe pas de distinction entre les procédures et les fonctions. Les syntaxes de déclaration et d'utilisation décrites pour les procédures sont les mêmes pour les fonctions.

- Il est possible de créer des procédures multisyntaxes. Pour plus de détails, consultez [Surcharge de prototype](../Motscles/1514063.md).






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Procédure locale
<a name="procedure_locale_ELTTEXTE000461"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Procédures locales à une fenêtre
<a name="procedures_locales_une_fenetre_ELTPARAGRAPHE000072"></a>Les procédures locales ***déclarées dans une fenêtre*** peuvent être appelées depuis tous les traitements/événements :

- de la fenêtre,

- des champs de la fenêtre,

- des procédures locales associées à la fenêtre.




Ces procédures sont mémorisées dans la fenêtre.

**Limites :**

- Les procédures locales d'une fenêtre ne peuvent pas être utilisées par ses fenêtres soeurs.

- Les procédures locales déclarées dans une fenêtre fille ne peuvent pas être utilisées dans sa fenêtre mère.



<a name="NOTE2_2"></a>
<a name="NOTE2_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/fr/WINDOWS.png) 

### Procédures locales à un état
<a name="procedures_locales_etat_ELTPARAGRAPHE000125"></a>Les procédures locales ***déclarées dans un état*** peuvent être appelées depuis tous les traitements/événements :

- de l'état,

- des champs de l'état,

- des procédures locales associées à l'état.


Ces procédures sont mémorisées dans l'état.
<a name="NOTE2_4"></a>


### Procédures locales à un champ
<a name="procedures_locales_champ_ELTPARAGRAPHE000140"></a>Les procédures locales ***déclarées dans un champ*** peuvent être appelées depuis tous les traitements/événements :

- du champ,

- des procédures locales associées au champ.


Ces procédures sont mémorisées avec le champ. Lors de la copie du champ, les procédures locales associées au champ seront copiées. 

Une procédure locale à un champ peut être créée pour un champ d'une fenêtre, d'une page ou d'un état. 





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Création d'une procédure locale
<a name="creation_une_procedure_locale_ELTTEXTE000503"></a>


### Création depuis l'éditeur de code
<a name="creation_depuis_editeur_code_ELTPARAGRAPHE000161"></a>Pour créer une procédure locale à l'élément en cours **depuis l'éditeur de code** :

- **Méthode 1** : 

	1. Créez la procédure : 

		- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Pour créer une procédure locale à une fenêtre, un champ, un état, sous le volet "Code", dans le groupe "Procédures", déroulez "Nouveau" et sélectionnez "Nouvelle procédure locale" (raccourci clavier F4).




2. Dans la fenêtre qui s'affiche : 

	- Indiquez le nom de la procédure à créer. 

	- L'option "Générer un commentaire d'en-tête" permet de générer automatiquement le commentaire du prototype de la procédure.
						Pour plus de détails, consultez [Documentation automatique des procédures](../Motscles/1513006.md).

	- Indiquez le rôle de la procédure : Non défini, Métier, UI. Par défaut, une procédure a un rôle "Non défini".

	- Si l'éditeur de code affiche le code d'un champ, l'option "Créer la procédure au niveau du champ" permet de spécifier si la procédure locale doit être associée au champ ou non. 




- **Méthode 2** :  

	1. Créez la procédure :

		- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Pour créer une procédure locale : sélectionnez l'option "Nouveau .. Nouvelle procédure locale" du menu contextuel.




2. Dans la fenêtre qui s'affiche : 

	- Indiquez le nom de la procédure à créer. 

	- L'option "Générer un commentaire d'en-tête" permet de générer automatiquement le commentaire du prototype de la procédure.
						Pour plus de détails, consultez [Documentation automatique des procédures](../Motscles/1513006.md).

	- Indiquez le rôle de la procédure : Non défini, Métier, UI. Par défaut, une procédure a un rôle "Non défini".

	- Si l'éditeur de code affiche le code d'un champ, l'option "Créer la procédure au niveau du champ" permet de spécifier si la procédure locale doit être associée au champ ou non. 

- **Méthode 3** : Pour créer une procédure locale :

	1. Positionnez le curseur dans l'événement "Déclarations globales" de la fenêtre ou de la page, dans un événement lié au champ ou dans l'événement "Ouverture" de l'état.

	2. Tapez le prototype de la procédure à créer. 

	3. Validez. La procédure locale est automatiquement créée.







**Remarque** : Pour transformer une partie de code déjà saisi dans une procédure locale en une procédure locale :

1. Sélectionnez le code correspondant.

2. Utilisez l'option "Nouveau .. Créer une procédure locale contenant le code sélectionné" du menu contextuel.

3. Indiquez : 

	- le nom de la procédure. 

	- la portée de la procédure. Par défaut, la procédure créée est publique. Pour plus de détails, consultez le paragraphe [Procédure locale publique ou privée](#NOTE6_1).




4. La procédure est créée, le code correspondant est remplacé par l'appel de la procédure avec les paramètres nécessaires.





<a name="NOTE3_3"></a>


### Création depuis le volet "Explorateur de projet"
<a name="creation_depuis_volet_explorateur_projet_ELTPARAGRAPHE000303"></a>Pour créer une procédure locale depuis le volet "Explorateur de projet" :

1. Sélectionnez l'élément associé à la procédure locale (fenêtre, page, état, champ, ...).

2. Déroulez les options de l'élément et sélectionnez l'option "Procédures" de l'élément.
	Remarque : Pour les champs, si aucune procédure n'est associée au champ, l'option "Procédures" n'est pas affichée. Dans ce cas, sélectionnez le nom du champ. 

3. Affichez le menu contextuel. 

4. Sélectionnez : 

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) l'option "Nouvelle procédure".




5. Dans la fenêtre qui s'affiche : 

	- Indiquez le nom de la nouvelle procédure locale. 

	- L'option "Générer un commentaire d'en-tête" permet de générer automatiquement le commentaire du prototype de la procédure.
			Pour plus de détails, consultez [Documentation automatique des procédures](../Motscles/1513006.md).

	- Indiquez le rôle de la procédure : Non défini, Métier, UI. Par défaut, une procédure a un rôle "Non défini".




6. Cliquez sur le bouton "Ajouter". La procédure locale est créée. Par défaut, la procédure créée est publique. Pour plus de détails, consultez le paragraphe [Procédure locale publique ou privée](#NOTE6_1). 

7. Validez.



<a name="NOTE3_5"></a>


### Afficher la liste des procédures locales
<a name="afficher_liste_des_procedures_locales_ELTPARAGRAPHE000344"></a>Pour afficher la liste des procédures locales dans le volet "Explorateur de projet", utilisez la touche F8 sous l'éditeur de code. 

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Suppression d'une procédure locale
<a name="suppression_une_procedure_locale_ELTTEXTE000557"></a>
Pour supprimer une procédure locale depuis le volet "Explorateur de projet" :

1. Sélectionnez l'élément associé à la procédure locale (fenêtre, page, état, champ, ...).

2. Déroulez les options de l'élément. 

3. Déroulez l'option "Procédures" de l'élément.

4. Sélectionnez la procédure voulue.

5. Affichez le menu contextuel de la procédure et sélectionnez l'option "Supprimer".




<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Procédure locale publique ou privée
<a name="procedure_locale_publique_privee_ELTTEXTE000581"></a>
Une procédure locale est publique par défaut : elle est accessible depuis n'importe quel code. 

Dans certains cas, il est nécessaire de restreindre l'accès à une procédure locale en la rendant "Privée". 

Lors de la création d'une procédure locale, il est possible de spécifier si la procédure est publique ou privée.

**Pour modifier le mode d'accès à une procédure locale** : 

1. Sélectionnez la procédure locale dans le volet "Explorateur de projet". 

2. Dans le menu contextuel de la procédure, sélectionnez le nouveau mode d'accès : 

	- publique.

	- privé.







La couleur du bandeau de la procédure change en fonction de son mode d'accès : 

- début de bandeau rouge : procédure privée.

- début de bandeau habituel : procédure publique.


**Remarque : Composant externe et procédures locales privées ou publiques** : 
L'utilisation de procédures locales privées ou publiques a un impact notamment dans les composants externes. En effet, seules les procédures explicitement publiques (utilisant le mot-clé PUBLIC dans leur prototype) présentes dans un composant externe pourront pas être accessibles depuis le projet intégrant ce composant. 


