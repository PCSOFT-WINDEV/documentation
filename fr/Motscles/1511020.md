
## SUR  (Mot réservé)

***En anglais : ON***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le mot-clé **SUR** est utilisé exclusivement dans les tests automatiques générés par WINDEV et WEBDEV. Ce mot-clé permet d'éviter le découpage des scénarios de test (1 par fenêtre) lors de l'enregistrement d'un test automatique. Le mot-clé SUR indique "sur" quelle fenêtre s'appliquent les actions indiquées.

Les tests générés automatiquement contiennent le mot-clé **SUR**. Tout le code avec tous les enchaînements et toutes les actions est visible dans le même scénario : la lisibilité est ainsi améliorée.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
PiloteMenu("_Menu", "Gestion_des_collaborateurs2")
PiloteSouris(FEN_CRM, psEnfonceBoutonGauche, 354, 34)

// Scénario à exécuter lors de l'ouverture de la fenêtre FEN_GestionCollaborateur
SUR FEN_GestionCollaborateur FAIRE
	PiloteSouris(FEN_GestionCollaborateur.SAI_NOM, psEnfonceBoutonGauche, 66, 33)
	PiloteSouris(FEN_GestionCollaborateur.SAI_NOM, psRelacheBoutonGauche, 62, 5)
	PiloteSaisie(FEN_GestionCollaborateur.SAI_NOM, "b")
	PiloteSouris(FEN_GestionCollaborateur.LSI_COLLABORATEUR, psDoubleClicGauche, 165, 61)

	// Scénario à exécuter lors de l'ouverture de la fenêtre FEN_AjoutCollaborateur
	SUR FEN_AjoutCollaborateur FAIRE
		PiloteSouris(FEN_AjoutCollaborateur.Civilite, psRelacheBoutonGauche, 112, -11)
		PiloteSouris(FEN_AjoutCollaborateur.BTN_ANNULE, psClicGauche, 46, 14)
	FIN

	PiloteSouris(FEN_GestionCollaborateur.BTN_ANNULE, psClicGauche, 43, 9)
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Code à exécuter lors du test d'une fenêtre

`SUR <Nom de la fenêtre> FAIRE
   <Code à exécuter>
FIN
`
---

**`<Nom de la fenêtre> : ()`**

Nom de la fenêtre ouverte par le test automatique.

**`<Code à exécuter> : ()`**

Code à exécuter lors dans la fenêtre ouverte par le test automatique.  


<a name="SYNTAXE2"></a>

### Code à exécuter lors du test d'une boîte de dialogue ou d'une fonction ne renvoyant pas de résultat

`SUR <Nom de la fonction> RETOUR
`
---

**`<Nom de la fonction WLangage> : ()`**

Nom de la fonction WLangage à exécuter. 

Par exemple, pour empêcher l'ouverture des boites de dialogue de la fonction [Erreur](../WDLang1/3021013.md) : 

```wl
SUR Erreur RETOUR
```



<a name="SYNTAXE4"></a>

### Code à exécuter lors du test d'une fonction WLangage qui renvoie une valeur

`SUR <Nom de la fonction WLangage> RENVOYER <Valeur>
`
---

**`<Nom de la fonction WLangage> : ()`**

Nom de la fonction WLangage à exécuter. 

Par exemple :

```wl
SUR fSélecteurImage RENVOYER fRepExe() + "\ImageExemple.jpg"
```


Dans ce cas, le test de la fonction n'est pas effectué et la valeur fRepExe() + "\\ImageExemple.jpg" est renvoyée au scénario.

**`<Valeur> : ()`**

Valeur à renvoyer au scénario.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Position du bloc SUR
<a name="position_bloc_sur_ELTPARAGRAPHE000061"></a>Le bloc SUR doit être placé juste après l'appel aux fonctions WLangage qui déclenchent le SUR. 

Par exemple, le code suivant ne fonctionne pas : 

```wl
// Clique sur l'option "Exporter vers le format texte"
PiloteSouris("FEN_Principale.DISP_EXPORTER[1].BTN_EXPORT_TEXTE", psClicGauche, 173, 37)
// Définit un fichier de test
soit sFichierExport = fFichierTemp() + ".TXT"
SUR fSélecteur RENVOYER sFichierExport
```
Il faut utiliser le code : 

```wl
// Définit un fichier de test
soit sFichierExport = fFichierTemp() + ".TXT"
// Clique sur l'option "Exporter vers le format texte"
PiloteSouris("FEN_Principale.DISP_EXPORTER[1].BTN_EXPORT_TEXTE", psClicGauche, 173, 37)
SUR fSélecteur RENVOYER sFichierExport
```



