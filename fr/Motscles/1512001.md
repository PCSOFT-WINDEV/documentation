
## Opérateurs sur chaînes de caractères
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Utilisation
<a name="utilisation_ELTTEXTE000549"></a>
Les chaînes de caractères peuvent être manipulées par des fonctions spécifiques du WLangage ou par les opérateurs +, [[ et ]].

Les opérateurs sur des chaînes de caractères sont :

- "** +**" : Pour concaténer des chaînes

- "** [**" et "** ]**" : Pour concaténer optionnellement des chaînes

- "** [[**" et "**]]**" (double crochets ouvrants et double crochets fermants) : Opérateur d'extraction d'une sous-chaîne

- " **=**" : Égalité stricte

- " **~=**" : Égalité souple

- " **~~**" : Égalité très souple

- " **[=**" : Commence par

- " **[% %]**" : Construction dynamique de chaînes. Pour plus de détails, consultez [Interpolation de chaînes](../Motscles/1514044.md).





```wl
Texte est une chaîne = "San Francisco"
Texte[[5]]                // Retourne "F"
Texte[[5 à 10]]           // Retourne "Franci"
Texte[[5 à]]              // Retourne "Francisco"
Texte[[à 10]]              // Retourne "San Franci"
Texte[[10 sur 4]]          // Retourne "isco"
Texte + " et New York"      // Retourne "San Francisco et New York"
Si Texte [= "San" Alors Trace(Texte)
```






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Notes
<a name="notes_ELTTEXTE000573"></a>


### L'opérateur [ et ]
<a name="operateur_ELTPARAGRAPHE000102"></a>L'opérateur [ et ] permet de concaténer optionnellement des chaînes. Le séparateur n'est pas concaténé si la chaîne d'origine est une chaîne vide ("") ou si la chaîne d'origine se termine par le séparateur.

Quelques exemples :

- ChaîneDébut += [ChaîneFin]
	ChaîneFin se concatène à ChaîneDébut uniquement si ChaîneDébut ne se termine pas par ChaîneFin.
	Par exemple :
	
	```wl
	ChaîneDébut = "San Francisco"
	ChaîneFin = "Francisco"
	ChaîneDébut += [ChaîneFin]
	// ChaîneDébut contient "San Francisco"
	```

	
	```wl
	ChaîneDébut = "San "
	ChaîneFin = "Francisco"
	ChaîneDébut += [ChaîneFin]
	// ChaîneDébut contient "San Francisco"
	```


- ChaîneDébut += [ChaîneMilieu] + ChaîneFin 
	ChaîneMilieu se concatène à ChaîneDébut uniquement si ChaîneDébut ne se termine pas par ChaîneMilieu et si ChaîneFin ne commence pas par ChaîneMilieu. Le séparateur n'est pas concaténé si la chaîne d'origine est une chaîne vide (""). 
	Par exemple :
	
	```wl
	ChaîneDébut = "C:\MesFichiers\"
	ChaîneMilieu = "\"
	ChaîneFin = "MonFichier.TXT"
	ChaîneDébut += [ChaîneMilieu] + ChaîneFin
	// ChaîneDébut contient "C:\MesFichiers\MonFichier.TXT"
	```

	
	```wl
	ChaîneDébut = "C:\MesFichiers"
	ChaîneMilieu = "\"
	ChaîneFin = "\MonFichier.TXT"
	ChaîneDébut += [ChaîneMilieu] + ChaîneFin
	// ChaîneDébut contient "C:\MesFichiers\MonFichier.TXT"
	```

	
	```wl
	ChaîneDébut = "C:\MesFichiers"
	ChaîneMilieu = "\"
	ChaîneFin = "MonFichier.TXT"
	ChaîneDébut += [ChaîneMilieu] + ChaîneFin
	// ChaîneDébut contient "C:\MesFichiers\MonFichier.TXT"
	```


- MaChaîne = [ChaîneDébut] + ChaîneFin 
	ChaîneDébut se concatène à ChaîneFin uniquement si ChaîneFin ne commence pas par ChaîneDébut.
	Par exemple :
	
	```wl
	ChaîneDébut = "Tome"
	ChaîneFin = "Tome de programmation"
	MaChaîne = [ChaîneDébut] + ChaîneFin
	// ChaîneDébut contient "Tome de programmation"
	```

	
	```wl
	ChaîneDébut = "Tome"
	ChaîneFin = " de programmation"
	MaChaîne = [ChaîneDébut] + ChaîneFin
	// ChaîneDébut contient "Tome de programmation"
	```





**Exemples :**

- Remplissage d'une chaîne avec des éléments séparés par des RC (Retour Chariot). Le séparateur n'est pas concaténé si la chaîne d'origine est une chaîne vide.
	
	```wl
	ChaîneRes est une chaîne
	POUR TOUT Client
		ChaîneRes += [RC] + Client.Nom
	FIN
	```


- Création d'un chemin de fichier sans se soucier des caractères "\\" absents ou présents.
	
	```wl
	fOuvre(NomRépertoire + ["\"] + NomFichier)
	```





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Laconcatenationoptionnelle.gif) ***Exemples unitaires (WINDEV)*** : **La concaténation optionnelle** <br>Utilisation de la concaténation optionnelle de chaîne.<br>La concaténation optionnelle permet d'ajouter une chaîne de caractères à la fin d'une autre seulement si elle n'existe pas déjà.



<a name="NOTE2_2"></a>


### L'opérateur [[ et ]]
<a name="operateur_ELTPARAGRAPHE000180"></a>L'opérateur [[ et ]] permet d'extraire et de remplacer une sous-chaîne.



Quelques exemples :

- CHAINEAEXTRAIRE[[&lt;Position&gt;]]

- CHAINEAEXTRAIRE[[&lt;Position&gt;]] = &lt;Nouvelle chaîne&gt; : Remplace le caractère de la chaîne par la nouvelle chaîne. 
	

- CHAINEAEXTRAIRE[[&lt;Début&gt; à &lt;Fin&gt;]]

- CHAINEAEXTRAIRE[[&lt;Début&gt; à]]

- CHAINEAEXTRAIRE[[à &lt;Fin&gt;]]

- CHAINEAEXTRAIRE[[&lt;Début&gt; sur &lt;Nombre&gt;]]




**Attention** : Si vous utilisez une procédure manipulant les chaînes avec les opérateurs [[]], méfiez-vous de la syntaxe utilisée. Vous pouvez sans le vouloir modifier vos chaînes de caractères. 
Par exemple, la procédure suivante peut entraîner la modification d'une partie de la chaîne.


```wl
PROCEDURE P(sChaîne)
Si sChaîne alors sChaîne="5"
// -- Appel de la procédure par la ligne :
p(sVar[[3 à]])
```


Pour éviter toute modification de la chaîne initiale, il est nécessaire de passer le paramètre par valeur :

- soit en utilisant des parenthèses autour du paramètre dans l'appel de la procédure,

- soit en utilisant le [mot-clé Local](../Motscles/1513001.md) dans l'entête de la procédure.




 **Différence avec WINDEV 7.5** : 

- WINDEV : L'opérateur [[]] utilisé avec une valeur négative en seconde borne renvoie une chaîne vide ("").

- WINDEV 7.5 : L'opérateur [[]] utilisé avec une valeur négative en seconde borne renvoie la chaîne complète.




**Exemple** : Parcours d'une chaîne de caractères, caractère par caractère : SAI_HTML et SAI_TEXTE sont 2 champs de saisie.

```wl
// Variables
sChaîne est une chaîne = SAI_HTML
sCaract est une chaîne
i est un entier = 1
// Parcours du champ HTML
sCaract = sChaîne[[i A i]]
TANTQUE i <= Taille(sChaîne) 
	i++
	// ICI traitement sur sCaract 
	// Caractères suivants
	sCaract = sChaîne[[i A i]]
FIN
```

<a name="NOTE2_3"></a>


### Égalité souple et égalité très souple
<a name="egalite_souple_egalite_tres_souple_ELTPARAGRAPHE000340"></a>L'égalité souple (~=) et l'égalité très souple (~~) agissent uniquement sur les chaînes de caractères (sauf les chaînes fixes). Ces opérateurs permettent de :

- ne pas différencier les caractères majuscules des caractères minuscules,

- ne pas tenir compte des espaces situés avant et après la chaîne à tester,

- ne pas tenir compte des caractères accentués minuscules,

- ne pas tenir compte des espaces et des ponctuations à l'intérieur des chaînes **(égalité très souple uniquement).**




**Équivalence HFSQL** : Pour retrouver l'équivalence à l'égalité très souple lors d'une recherche sur une clé texte dans un fichier HFSQL, il est nécessaire de configurer les options suivantes lors de la description de la rubrique dans l'analyse :<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Indexation%20des%20m%E9mos%20-%20HC%20N%B0002.gif)



<a name="NOTE2_4"></a>


### Opérateurs sur les chaînes de caractères et UNICODE
<a name="operateurs_sur_les_chaines_caracteres_unicode_ELTPARAGRAPHE000360"></a>Les opérateurs disponibles sont :

- "** +**" : Pour concaténer des chaînes

- "** [**" et " **]**" : Pour concaténer optionnellement des chaînes

- "** [[**" et " **]]**" (double crochets ouvrants et double crochets fermants) : Opérateur d'extraction d'une sous-chaîne

- "** [=**" : Commence par




**Opérateur "+", "[" et "]"**
Il est possible de concaténer deux chaînes UNICODE. Il n'est pas possible de concaténer une chaîne UNICODE et une chaîne ANSI.
Remarque : Si la concaténation de deux chaînes AINSI est affectée à une chaîne UNICODE (et inversement), la conversion sera implicitement réalisée.

**Opérateur "[[" et "]]"**
Toutes les syntaxes de l'opérateur [[]] sont disponibles sur les chaînes UNICODE.

- Si la chaîne passée en paramètre est au format ANSI, l'opérateur [[]] renvoie le résultat au format ANSI.

- Si la chaîne passée en paramètre est au format UNICODE, l'opérateur [[]] renvoie le résultat au format UNICODE.

- Les paramètres de position et de longueur sont donnés en nombre de caractères.


**Remarque** : Si le résultat de l'opérateur [[]] sur une chaîne ANSI est affecté à une chaîne UNICODE (et inversement), la conversion sera implicitement réalisée. 


<a name="NOTE2_5"></a>


### Position dans une chaîne de caractères
<a name="position_dans_une_chaine_caracteres_ELTPARAGRAPHE000464"></a>

- Le premier caractère est en position 1 (et non en position 0).					

- La fonction [Position](../WDLang1/3024027.md) retourne la position de départ d'une chaîne de caractères donnée à l'intérieur d'une autre chaîne de caractères.



<a name="NOTE2_6"></a>


### Fonctions du WLangage
<a name="fonctions_wlangage_ELTPARAGRAPHE000475"></a>Les chaînes de caractères peuvent également être manipulées grâce aux fonctions :

- [Droite](../WDLang1/3024016.md)

- [Gauche](../WDLang1/3024001.md)

- [Milieu](../WDLang1/3024023.md)

- [de gestion des chaînes de caractères](../WDLang1/3024015.md)


**Remarque** : les opérateurs [[]] sont dans la plupart des cas plus performants que les fonctions WLangage.








- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Operateurs____.gif) ***Exemples unitaires (WINDEV)*** : **Opérateurs [[ ]]** <br>Utilisation des opérateurs [[ ]] et des différentes syntaxes.


