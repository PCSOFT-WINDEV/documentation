
## Appeler une procédure/une fonction

***En anglais : Calling a procedure/a function***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
L'appel d'une procédure est le même qu'il s'agisse d'une procédure globale ou d'une procédure locale.

**Rappel** : 

- En WLangage, il n'existe pas de distinction entre les procédures et les fonctions. Les syntaxes de déclaration et d'utilisation décrites pour les procédures sont les mêmes pour les fonctions.

- Dans le cas d'une procédure multisyntaxe, l'appel de la bonne syntaxe est résolu à l'exécution. Pour plus de détails, consultez [Surcharge de prototype](../Motscles/1514063.md).







<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Appel de la procédure Trouve qui retourne un booléen
SI Trouve(Client, NumCli, Numéro) ALORS
	Info("Numéro de client trouvé")
SINON
	Info("Numéro de client inexistant")
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Appeler une procédure renvoyant un paramètre

`[<Valeur retournée> = ] <Nom de la procédure>([<Paramètres>])
`
---

**`<Valeur retournée> : ()`**

Valeur retournée (optionnel) par la procédure, uniquement si la procédure retourne un résultat.

Il est possible de typer la valeur de retour d'une procédure lors de sa déclaration. Pour plus de détails, consultez [Déclarer une procédure](../Motscles/1513008.md). 

**`<Nom de la procédure> : ()`**

Nom de la procédure à appeler.

**`<Paramètres> : ()`**

Paramètres passés à la procédure. Chaque paramètre est séparé par une virgule. 
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Il est possible d'utiliser des paramètres nommés. Pour plus de détails, consultez le paragraphe "[Paramètres nommés](#NOTE0_2)". 

Pour plus de détails sur la déclaration des paramètres d'une procédure, consultez [Les paramètres d'une procédure](../Motscles/1513001.md).  


<a name="SYNTAXE2"></a>

### Appeler une procédure renvoyant plusieurs paramètres

`(<Valeur 1>, ..., <Valeur N>) = <Nom de la procédure>([<Paramètres>])
`
---

**`<Valeur 1 à N> : ()`**

Valeurs retournées par la procédure.

Il est possible de typer les valeurs de retour d'une procédure lors de sa déclaration. Pour plus de détails, consultez [Déclarer une procédure](../Motscles/1513008.md). 

**`<Nom de la procédure> : ()`**

Nom de la procédure à appeler.

**`<Paramètres> : ()`**

Paramètres passés à la procédure. Chaque paramètre est séparé par une virgule. 
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Il est possible d'utiliser des paramètres nommés. Pour plus de détails, consultez le paragraphe "[Paramètres nommés](#NOTE0_2)". 

Pour plus de détails sur la déclaration des paramètres d'une procédure, consultez [Les paramètres d'une procédure](../Motscles/1513001.md). 





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Cas particuliers
<a name="cas_particuliers_ELTPARAGRAPHE000111"></a>

- Pour des raisons de lisibilité des programmes, le mot-clé **PROCEDURE** peut être remplacé par le mot-clé **FONCTION**.

- Si la procédure n'attend aucun paramètre, il est également possible d'utiliser la syntaxe suivante : 
	
	```txt
	[<Valeur retournée> = ] <Nom de la procédure>
	```


- Pour exécuter une procédure d'une fenêtre ouverte, il suffit d'utiliser la fonction [ExécuteTraitement](../WDLang1/3013031.md). Exemple : 
	
	```wl
	// Exécution de la procédure MaProc contenue dans la fenêtre FEN_MaFenêtre
	NomFen est une chaîne = "FEN_MaFenêtre"
	ExécuteTraitement(NomFen + ".MaProc", trtProcédure)
	```




<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) 

### Paramètres nommés
<a name="parametres_nommes_ELTPARAGRAPHE000131"></a>Si une procédure possède des paramètres avec des valeurs par défaut, il est possible d'appeler la procédure en nommant ses paramètres. Deux syntaxes sont possibles : 

- Paramètres nommés monolignes,

- Paramètres nommés multilignes. 




**1. Paramètres nommés monolignes**
La syntaxe utilisée est la suivante : 

```txt
NomProcédure(< <nom du paramètre1> > : <valeur1>, < <nom du paramètre2> > : <valeur2>, ...)
```


Voyons les différentes règles de fonctionnement à l'aide d'un exemple : 

- Code de la procédure : 
	
	```wl
	PROCEDURE MaProcédure(p1, p2, p3 = 0, p4 = 0, p5 = 0)
	```


- Appel de la procédure en utilisant des paramètres nommés : 
	
	```wl
	MaProcédure(<p1>:1, <p2>:2)
	```


- Les paramètres optionnels non renseignés seront affectés avec leur valeur par défaut.
	
	```wl
	MaProcédure(<p1>:1, <p2>:2, <p4>:4)
	```


- Les paramètres obligatoires peuvent être passés sans leur nom, en utilisant les paramètres ordonnés classiques. Les paramètres nommés sont forcément après les paramètres ordonnés : 
	
	```wl
	MaProcédure(1, 2, <p4>:4)
	```

	
	```wl
	MaProcédure(1, <p4>:4, 2) // Provoque une erreur
	```


- Tous les paramètres obligatoires doivent être précisés sinon une erreur de compilation sera générée.
	
	```txt
	MaProcédure(<p1>:1) // erreur : p2 manquant
	```

	
	```txt
	MaProcédure(<p1>:1, <p4>:4)// erreur : p2 manquant
	```


- Chaque paramètre ne peut être précisé qu'une seule fois sinon une erreur de compilation sera générée. 
	
	```txt
	MaProcédure(<p2>:2, <p1>:1, <p2>:2) //erreur : p2 en double
	```


- Les paramètres peuvent être indiqués dans n'importe quel ordre : les valeurs des paramètres sont évaluées dans l'ordre d'écriture habituel (de gauche à droite).
	
	```txt
	MaProcédure(f1(), f2(), <p5>:f3(), <p4>:f4()) // Ordre d'exécution : f1, f2, f3, f4
	```





Les règles de passage des paramètres sont identiques à celles appliquées lors d'un appel classique. Pour plus de détails, consultez [Passage de paramètres](../Motscles/1514077.md). 

**2. Paramètres nommés multilignes**
La syntaxe utilisée est la suivante : 

```txt
// Définition des paramètres
NomProcédure.<Nom du paramètre 1> = <Valeur 1>
...
NomProcédure.<Nom du paramètre N> = <Valeur N>
// Appel de la procédure
NomProcédure()
```


Cette syntaxe est disponible :

- sur les procédures globales.

- sur les procédures locales appelées depuis l'élément qui possède la procédure.

- sur les méthodes appelées depuis une méthode de la classe ou d'une classe dérivée.




Exemple : 

- Code de la procédure : 
	
	```wl
	PROCEDURE MaProcédure(p1, p2, p3 = 0, p4 = 0, p5 = 0)
	```


- Code d'appel : 
	
	```wl
	// Définition des paramètres
	MaProcédure.p1 = 1
	MaProcédure.p2 = 2
	// Appel de la procédure
	MaProcédure()
	```





Remarques : 

- Les paramètres de la procédure sont limités au traitement courant. L'appel doit donc se trouver dans le même traitement que les affectations. Une erreur de compilation est provoquée si des paramètres sont renseignés et si aucun appel à la procédure n'est détecté dans le traitement.

- Aucune vérification n'est faite sur la présence des paramètres obligatoires. Une erreur peut donc se produire à l'exécution si un paramètre obligatoire n'a pas été renseigné. 

- Les paramètres sont réinitialisés au moment de l'appel pour qu'un paramètre ne soit pas réutilisé par erreur ; il n'est donc pas possible de faire deux appels avec les mêmes paramètres.

- Attention : Le passage de paramètres se fait dans ce cas par valeur et non plus par variable.





<a name="NOTE0_4"></a>


