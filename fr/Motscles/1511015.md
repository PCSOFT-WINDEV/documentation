
## Null (Mot réservé)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000299"></a>
Le mot-clé ***Null*** peut être utilisé de différentes manières en WLangage :

- Pour indiquer qu'un paramètre ne doit pas être pris en compte dans une requête. Consultez le paragraphe ["Null et les requêtes"](#NOTE2_1) de cette page.

- Pour spécifier qu'une variable de type variant ne contient pas de valeur. Consultez le paragraphe ["Null et les variants"](#NOTE3_1) de cette page.  

- Pour comparer une valeur à 0. Consultez le paragraphe ["Null et les numériques"](#NOTE4_1) de cette page.

- Dans certaines fonctions du WLangage, pour indiquer que le paramètre ne doit pas être pris en compte. Consultez le paragraphe ["Null et les fonctions du WLangage"](#NOTE5_1) de cette page.

- Pour vérifier si un objet dynamique est alloué ou non. Consultez le paragraphe ["Null et les objets dynamiques"](#NOTE6_1) de cette page.








<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Null et les requêtes
<a name="null_les_requetes_ELTTEXTE000323"></a>




### Ignorer des paramètres : Null dans la fonction HExécuteRequête
<a name="ignorer_des_parametres_null_dans_fonction_hexecuterequete_ELTPARAGRAPHE000077"></a>Lors de l'exécution d'une requête paramétrée avec la fonction [HExécuteRequête](../WDLang4/3044080.md), tous les paramètres de la requête ne doivent pas obligatoirement être précisés. Les conditions de la requête utilisant des paramètres non précisés ou ayant pour valeur Null seront ignorés.

**Exemple** : Soit la requête "Clients_nom_prénom" dont le code SQL est le suivant :


```sql
SELECT * FROM CLIENT WHERE NOM = {Param1} AND PRENOM = {Param2}
```




- **Cas 1 : Les 2 paramètres sont donnés**
	
	```wl
	HExécuteRequête(Clients_nom_prénom, hRequêteDéfaut, "Dupond", "Jean")
	```

	exécutera la requête : 
	
	```sql
	SELECT * FROM CLIENT WHERE NOM = 'Dupond' AND PRENOM = 'Jean'
	```





- **Cas 2 : Seul le nom est donné**
	
	```wl
	HExécuteRequête(Clients_nom_prénom, hRequêteDéfaut, "Dupond")
	```

	exécutera la requête
	
	```sql
	SELECT * FROM CLIENT WHERE NOM = 'Dupond'
	```





- **Cas 3 : Seul le prénom est donné**
	
	```wl
	// utilisation du variant obligatoire pour variable de type Null (non renseignée)
	sNom est un Variant = Null 
	HExécuteRequête(Clients_nom_prénom, hRequêteDéfaut, sNom, "Jean")
	```

	Ou
	
	```wl
	HExécuteRequête(Clients_nom_prénom, hRequêteDéfaut, Null, "Jean")
	```

	exécutera la requête
	
	```sql
	SELECT * FROM CLIENT WHERE PRENOM = 'Jean'
	```




<a name="NOTE2_2"></a>


### Paramètres d'une requête provenant d'un champ de saisie : Null si vide
<a name="parametres_une_requete_provenant_champ_saisie_null_vide_ELTPARAGRAPHE000120"></a>Pour que votre requête s'exécute même si aucune valeur n'est saisie par l'utilisateur, cochez l'option ***"NULL si vide"*** des champs de saisie (onglet "Détail" de la description du champ).

Grâce à cette option, si le champ est vide, la valeur du paramètre renvoyée à la requête correspondra à la constante NULL. Ainsi, lors de l'exécution de la requête, aucune erreur n'est générée : la ou les conditions dépendant de ce paramètre sont simplement ignorées.

**Par exemple**, le code SQL exécuté est :


```sql
SELECT NomDesRubriques
FROM NomDesFichiers
WHERE Rubrique = {Param1}
```


La requête "Ex1" est exécutée dans le bouton "Btn_OK" par la fonction **HExécuteRequête**. Le code WLangage utilisé est le suivant :


```wl
HExécuteRequête(Ex1, hRequêteDéfaut, SAI_ChampSaisie1)
```


Dans ce code, SAI_ChampSaisie1 correspond au champ dans lequel l'utilisateur doit saisir le paramètre de la requête.

Pour cet exemple, le tableau ci-dessous décrit l'utilisation de l'option "NULL si vide" :

| Valeur saisie par l'utilisateur dans le champ SAI_ChampSaisie1 | Option "NULL si vide" cochée pour le champ SAI_ChampSaisie1 | Code SQL exécuté |
| --- | --- | --- |
| Aucune valeur | Option cochée | SELECT NomDesRubriques<br>FROM NomDesFichiers |
| Aucune valeur | Option décochée | SELECT NomDesRubriques<br>FROM NomDesFichiers<br>WHERE Rubrique = ' ' |
| Une valeur est saisie | Option cochée ou décochée | SELECT NomDesRubriques<br>FROM NomDesFichiers<br>WHERE Rubrique = 'ValeurSaisie' |





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Null et les variants
<a name="null_les_variants_ELTTEXTE000353"></a>
Pour spécifier qu'une variable de type Variant ne contient pas de valeur, il suffit d'utiliser la constante NULL.

Remarques :

- Pour un type variant, NULL signifie "Pas affecté"

- Pour un type numérique, NULL signifie "égal 0" (voir ci-dessous)
	
	```wl
	vVal est un variant
	SI vVal = Null ALORS ... 
		// Le test renvoie Vrai car le variant n'est pas affecté
	FIN
	 
	vVal = 0
	SI vVal = Null ALORS ... 
		// Le test renvoie Faux car le variant est affecté 
		// avec un entier de valeur 0
	FIN
	 
	vVal = 5
	SI vVal = Null ALORS ... 
		// Le test renvoie Faux car le variant est affecté
		// avec un entier de valeur 5
	FIN
	```







<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Null et les valeurs numériques
<a name="null_les_valeurs_numeriques_ELTTEXTE000377"></a>
Utilisé avec des valeurs numériques, ***Null*** permet de comparer une valeur à 0. Il est uniquement possible d'utiliser les opérateurs de comparaison d'égalité et de différence (opérateur = et opérateur &lt;&gt;).

Remarques :

- Pour un type variant, NULL signifie "Pas affecté" (voir ci dessus)

- Pour un type numérique, NULL signifie "égal 0"
	
	```wl
	nVal est un entier
	SI nVal = Null ALORS ... 
		// Le test renvoie Vrai car nVal=0
	FIN
	 
	nVal = 5
	SI nVal = Null ALORS ... 
		// Le test renvoie Faux car nVal=5
	FIN
	```







<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Null et les fonctions du WLangage
<a name="null_les_fonctions_wlangage_ELTTEXTE000401"></a>
Certaines fonctions du WLangage acceptent en paramètre ***Null*** pour spécifier que le paramètre ne prend aucune valeur.

Quelques exemples :


|   |   |
| --- | --- |
| [ArbreAjoute](../WDLang1/3018012.md), [ArbreInsère](../WDLang1/3018023.md) | Null permet de ne pas afficher d'images pour les différents niveaux des éléments ajoutés. |
| [ArbreListeFils](../WDLang1/3018016.md) | Null permet de lister les fils à partir de la racine de l'arbre. |
| [ArbreModifie](../WDLang1/3018013.md) | Null permet de ne pas modifier l'image définie avec la fonction ArbreAjoute |
| [INIEcrit](../WDLang1/3013039.md) | Null permet de supprimer un mot-clé ou une section dans le fichier INI |





<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Null et les objets dynamiques
<a name="null_les_objets_dynamiques_ELTTEXTE000425"></a>
Pour tous les objets dynamiques (classe, structure, tableau, objet automation, ...), ***Null*** permet de savoir si l'objet est alloué ou non.

Par exemple :


```wl
// Déclaration d'un l'objet automation dynamique
MonObjetDynamique est un objet automation dynamique
...

SI MonObjetDynamique = Null ALORS
	// Création d'un l'objet automation dynamique
	MonObjetDynamique = allouer un objet automation dynamique MonServeur
FIN
```





