


## Procédure/Fonction globale
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Définition
<a name="definition_ELTTEXTE000380"></a>
Les procédures peuvent être de deux types :

- **Procédure globale** : utilisable dans tous les traitements du projet. Cette procédure globale est mémorisée dans le projet.

- [Procédure locale](../Motscles/1513009.md) : utilisable dans tous les traitements dépendant de l'objet (fenêtre, page, état, champ) dans lequel cette procédure a été déclarée. Cette procédure locale est mémorisée dans l'objet.




**Important** : Il ne faut pas déclarer deux procédures avec le même nom (notamment une procédure globale et une procédure locale).

**Rappel** : 

- En WLangage, il n'existe pas de distinction entre les procédures et les fonctions. Les syntaxes de déclaration et d'utilisation décrites pour les procédures sont les mêmes pour les fonctions.

- Il est possible de créer des procédures multisyntaxes. Pour plus de détails, consultez [Surcharge de prototype](../Motscles/1514063.md).






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Procédure globale
<a name="procedure_globale_ELTTEXTE000404"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png) 

### Procédures globales et collections de procédures
<a name="procedures_globales_collections_procedures_ELTPARAGRAPHE000065"></a>Les procédures globales sont mémorisées dans [des collections de procédures](../Motscles/1513003.md), associées au projet. Chaque collection de procédures est un fichier ".WDG".

Chaque projet contient au moins une collection de procédures. Cette collection est créée par défaut lors de la création du projet.

Les procédures globales contenues dans une collection de procédures peuvent être appelées depuis tous les événements/traitements :

- du projet,

- de la fenêtre ou de la page (événements de la fenêtre / de la page, de ses champs et traitements des procédures locales associées),

- de l'état (événements de l'état, de ses champs et traitements des procédures locales associées).




**Conseil** : Si une procédure est utilisée par une seule fenêtre ou page, il est conseillé de décrire cette procédure comme locale à la fenêtre ou à la page. La fenêtre / page est alors "indépendante".
<a name="NOTE2_2"></a>

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Création d'une procédure globale
<a name="creation_une_procedure_globale_ELTTEXTE000434"></a>


### Création depuis l'éditeur de code
<a name="creation_depuis_editeur_code_ELTPARAGRAPHE000105"></a>**Pour créer une procédure globale depuis l'éditeur de code** :

- Méthode 1 : 

	- Affichez l'éditeur de code (touche F2 sur un élément de votre fenêtre ou de votre page). 

	- Sous le volet "Code", dans le groupe "Procédures", déroulez "Nouveau" et sélectionnez "Nouvelle procédure globale" (raccourci clavier Shift F4).

	- Dans la fenêtre qui s'affiche : 

		- Indiquez le nom de la procédure à créer. 

		- L'option "Générer un commentaire d'en-tête" permet de générer automatiquement le commentaire du prototype de la procédure.
						Pour plus de détails, consultez [Documentation automatique des procédures](../Motscles/1513006.md).

		- Indiquez la portée de la procédure. Par défaut, la procédure créée est publique. Pour plus de détails, consultez le paragraphe [Procédure globale publique ou privée](#NOTE6_1). 




- Méthode 2 : 

	- Affichez l'éditeur de code (touche F2 sur un élément de votre fenêtre ou de votre page).

	- Sélectionnez l'option "Nouveau .. Nouvelle procédure globale vide" du menu contextuel.

	- Dans la fenêtre qui s'affiche : 

		- Indiquez le nom de la procédure à créer. 

		- L'option "Générer un commentaire d'en-tête" permet de générer automatiquement le commentaire du prototype de la procédure.
						Pour plus de détails, consultez [Documentation automatique des procédures](../Motscles/1513006.md).

		- Indiquez la portée de la procédure. Par défaut, la procédure créée est publique. Pour plus de détails, consultez le paragraphe [Procédure globale publique ou privée](#NOTE6_1). 




- Méthode 3 : 

	- Affichez l'éditeur de code (touche F2 sur un élément de votre fenêtre ou de votre page).

	- Positionnez-vous à la fin du code d'une procédure. 

	- Tapez le prototype de la procédure à créer. 

	- Validez. La procédure est automatiquement créé. 





**Pour transformer une partie de code déjà saisi dans une procédure globale en une procédure globale** :

1. Sélectionnez le code correspondant.

2. Utilisez l'option "Nouveau .. Créer une procédure globale contenant le code sélectionné" du menu contextuel.

3. Indiquez : 

	- le nom de la procédure. 

	- la portée de la procédure. Par défaut, la procédure créée est publique. Pour plus de détails, consultez le paragraphe [Procédure globale publique ou privée](#NOTE6_1). 




4. La procédure est créée, le code correspondant est remplacé par l'appel de la procédure avec les paramètres nécessaires.



<a name="NOTE3_2"></a>


### Création depuis le volet "Explorateur de projet"
<a name="creation_depuis_volet_explorateur_projet_ELTPARAGRAPHE000207"></a>Pour créer une procédure globale depuis le volet "Explorateur de projet" :

1. Sélectionnez le dossier "Procédures".

2. Sélectionnez la collection de procédures voulue.

3. Affichez le menu contextuel de la collection de procédures et sélectionnez l'option "Nouvelle procédure globale".

4. Dans la fenêtre qui s'affiche : 

	- Indiquez le nom de la nouvelle procédure globale. 

	- L'option "Générer un commentaire d'en-tête" permet de générer automatiquement le commentaire du prototype de la procédure.
			Pour plus de détails, consultez [Documentation automatique des procédures](../Motscles/1513006.md).

	- Indiquez la portée de la procédure. Par défaut, la procédure créée est publique. Pour plus de détails, consultez le paragraphe [Procédure globale publique ou privée](#NOTE6_1). 




5. Validez.



<a name="NOTE3_3"></a>


### Afficher la liste des procédures globales
<a name="afficher_liste_des_procedures_globales_ELTPARAGRAPHE000233"></a>Pour afficher la liste des procédures globales, utilisez la combinaison de touches Ctrl + F8 de l'éditeur de code.

Les procédures globales sont affichées dans le volet "Explorateur de projet" si ce volet est affiché.



<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Suppression d'une procédure globale
<a name="suppression_une_procedure_globale_ELTTEXTE000497"></a>


### Suppression depuis l'éditeur de code
<a name="suppression_depuis_editeur_code_ELTPARAGRAPHE000250"></a>Pour supprimer une procédure globale depuis l'éditeur de code : 

1. Cliquez sur le bandeau de la procédure dans l'éditeur de code. 

2. Dans le menu contextuel, sélectionnez "Supprimer". 



<a name="NOTE4_2"></a>


### Suppression depuis le volet "Explorateur de projet"
<a name="suppression_depuis_volet_explorateur_projet_ELTPARAGRAPHE000259"></a>Pour supprimer une procédure globale depuis le volet "Explorateur de projet" :

1. Sélectionnez le dossier "Procédures".

2. Sélectionnez la collection de procédures voulue.

3. Affichez le menu contextuel de la collection de procédures et sélectionnez l'option "Supprimer".






<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Test d'une procédure globale
<a name="test_une_procedure_globale_ELTTEXTE000527"></a>


### Depuis l'éditeur de code
<a name="depuis_editeur_code_ELTPARAGRAPHE000276"></a>Pour tester une procédure globale :

1. Affichez la procédure globale sous l'éditeur de code.

2. Cliquez sur le bouton "GO" présent parmi les boutons d'accès rapide.

3. La fenêtre de description du test de la procédure s'affiche. Cette fenêtre permet de :

	- Saisir les différents paramètres de la procédure.

	- Lancer le test de la procédure (bouton "Tester la procédure").

	- Vérifier la valeur de retour.






<a name="NOTE5_2"></a>


### Depuis le volet "Explorateur de projet"
<a name="depuis_volet_explorateur_projet_ELTPARAGRAPHE000291"></a>Pour tester une procédure globale :

1. Sélectionnez le dossier "Procédures" dans le volet "Explorateur de projet".

2. Sélectionnez le nom de la procédure globale à tester.

3. Sélectionnez l'option "Tester la procédure" du menu contextuel.

4. La fenêtre de description du test de la procédure s'affiche. Cette fenêtre permet de :

	- Saisir les différents paramètres de la procédure.

	- Lancer le test de la procédure (bouton "Tester la procédure").

	- Vérifier la valeur de retour.







<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Procédure globale publique ou privée
<a name="procedure_globale_publique_privee_ELTTEXTE000557"></a>
Une procédure globale est publique par défaut : elle est accessible depuis n'importe quel code. 

Dans certains cas, il est nécessaire de restreindre l'accès à une procédure globale en la rendant "Privée". Dans ce cas, la procédure globale et accessible uniquement par une autre procédure globale présente dans la collection de procédures. 

Lors de la création d'une procédure globale, il est possible de spécifier si la procédure est publique ou privée.

**Pour modifier le mode d'accès à une procédure globale** : 

1. Sélectionnez la procédure globale dans le volet "Explorateur de projet". 

2. Dans le menu contextuel de la procédure, sélectionnez le nouveau mode d'accès : 

	- publique.

	- privé.





La couleur du bandeau de la procédure change en fonction de son mode d'accès : 

- début de bandeau rouge : procédure privée.

- début de bandeau habituel : procédure publique.


**Remarque : Composant externe et procédures globales privées** : 
L'utilisation de procédures globales privées ou publiques a un impact notamment dans les composants externes. En effet, seules les procédures explicitement privées (utilisant le mot-clé PRIVEE dans leur prototype) présentes dans un composant externe ne pourront pas être utilisées directement par le projet intégrant ce composant. 


