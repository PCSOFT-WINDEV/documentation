


## Instruction POUR TOUT / POUR TOUS (parcours de champs)

***En anglais : FOR EACH / FOR ALL***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
L'instruction **POUR TOUT** permet d'effectuer différents types de parcours de champs (champs Liste, champs Table, champs Zone répétée) :

- Parcours des éléments du champ.

- Parcours des valeurs des éléments sélectionnés.

- Parcours des indices des éléments sélectionnés.




**Remarque** : Les instructions **POUR TOUT, POUR TOUS, POUR CHAQUE** sont acceptées. Dans cette documentation, seule l'instruction **POUR TOUT** est utilisée et peut être remplacée par **POUR TOUS** ou **POUR CHAQUE**.

Limitation : Cette instruction n'est pas utilisable sur les champs Combo.

L'instruction POUR TOUT peut également être utilisée pour parcourir les objets DotNet qui implémentent l'interface IEnumerable.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Pour chaque utilisateur sélectionné dans le champ Table TABLE_Utilisateur
POUR TOUTE LIGNE SELECTIONNEE DE TABLE_Utilisateur
	// Envoi d'un email
	Proc_EnvoieMessage(COL_Nom, COL_Email)
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Parcours des éléments du champ (Table, Liste et Zone répétée)

`POUR TOUTE LIGNE [<Indice> [, <Compteur>]] DE <Champ>
   ...
FIN
`
---

**`<POUR TOUTE LIGNE> : ()`**

Signale le début du bloc d'instructions.

**`<Indice> : ()`**

Variable optionnelle de type Entier. A chaque itération, contient l'indice de la ligne en cours.

**`<Compteur> : ()`**

Variable optionnelle de type Entier. Cette variable compte le nombre d'itérations.

**`<Champ> : ()`**

Champ à parcourir : champ Liste, champ Table ou champ Zone répétée.  

![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Les champs Table ne sont pas disponibles.


<a name="SYNTAXE2"></a>

### Parcours des éléments sélectionnés

`POUR TOUTE LIGNE SELECTIONNEE [<Indice>, [<Compteur>]] DE <Champ>

     ...
FIN
`
---

**`<POUR TOUTE LIGNE SELECTIONNEE> : ()`**

Signale le début du bloc d'instructions.

**`<Indice> : ()`**

Variable de type Entier. A chaque itération, contient l'indice de la ligne sélectionnée en cours.

**`<Compteur> : ()`**

Variable optionnelle de type Entier. Cette variable compte le nombre d'itérations (nombre de lignes sélectionnées par exemple).

**`<Champ> : ()`**

Champ à parcourir : champ Liste, champ Table ou champ Zone répétée.  

![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Les champs Table ne sont pas disponibles.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Syntaxe 1 : Parcours des éléments du champ
<a name="syntaxe_1_parcours_des_elements_champ_ELTPARAGRAPHE000088"></a>Cette syntaxe permet de parcourir toutes les lignes, visibles ou non, d'un champ Liste, d'un champ Table ou d'un champ Zone répétée.

Pour chaque ligne parcourue :

- &lt;Nom du champ&gt; renvoie l'indice de la ligne en cours. &lt;Indice&gt; permet également de connaître l'indice de la ligne en cours.

- &lt;Nom du champ&gt;[&lt;Nom du champ&gt;] renvoie toutes les colonnes séparées par des TAB. Cette syntaxe est équivalente à &lt;Nom du champ&gt;[&lt;Indice&gt;].

- &lt;Nom de la colonne&gt; renvoie la valeur de la colonne pour la ligne en cours de parcours.




Le parcours n'a aucune influence sur la sélection courante.

Le comportement est indéterminé si le nombre d'éléments du champ est modifié pendant la boucle de parcours.
<a name="NOTE0_2"></a>


### Syntaxe 2 : Parcours des éléments sélectionnés du champ
<a name="syntaxe_2_parcours_des_elements_selectionnes_champ_ELTPARAGRAPHE000117"></a>Cette syntaxe permet de parcourir toutes les lignes sélectionnées  d'un champ Liste, d'un champ Table ou d'un champ Zone répétée.

Pour chaque ligne parcourue :

- &lt;Nom du champ&gt; renvoie l'indice de la ligne sélectionnée en cours. &lt;Indice&gt; permet également de connaître l'indice de la ligne sélectionnée en cours.

- &lt;Nom du champ&gt;[&lt;Nom du champ&gt;] renvoie toutes les colonnes séparées par des TAB.

- &lt;Nom de la colonne&gt; renvoie la valeur de la colonne pour la ligne en cours de parcours. Il est également possible d'utiliser la syntaxe : &lt;Colonne&gt;[&lt;Indice&gt;]




**Changement de comportement de la version 12** : Avant la version 12, le parcours n'avait aucune influence sur la sélection courante. Désormais, la ligne courante de la table est toujours déplacée pendant le parcours.

Le comportement est indéterminé si le nombre d'éléments du champ est modifié pendant la boucle de parcours.
<a name="NOTE0_3"></a>


### Parcours des lignes d'un champ Table
<a name="parcours_des_lignes_champ_table_ELTPARAGRAPHE000145"></a>Lors du parcours des lignes d'un champ Table :

- l'affichage de ce champ Table est bloqué. La fonction [MultitâcheRepeint](../WDLang1/3038004.md) n'est pas pris en compte.

- il ne faut pas modifier la ou les lignes sélectionnées et/ou la ligne en cours (fonction [TableSelectMoins](../WDLang1/3074029.md), [TableSelectPlus](../WDLang1/3074031.md), ...).

- dans le cas d'un champ Table fichier, dans la boucle de parcours, l'enregistrement en cours est l'enregistrement traité par le parcours.




![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png) Rappel : Les champs Table ne sont pas disponibles.


