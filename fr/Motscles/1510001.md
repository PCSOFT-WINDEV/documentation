
## Instruction POUR

***En anglais : FOR***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le bloc d'instructions est répété en modifiant une variable de contrôle puis en la comparant à une valeur limite, avant chaque début du bloc d'instructions.

Le bloc d'instructions est alors exécuté pour chacune des valeurs que prend successivement la variable de contrôle. La variable de contrôle reçoit la valeur initiale lors de la première entrée dans l'instruction **POUR**.

Une syntaxe optimisée est disponible : cette syntaxe permet de ne pas ré-évaluer la valeur limite et / ou la valeur du pas à chaque itération (utile par exemple dans le cas d'une répétition sur le nombre de ligne d'une table).


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
POUR Indice = 1 A 10
	MonTableau[Indice] = MaVariable + 10
FIN
```


<a name="Exemple2"></a>



```wl
POUR Indice = 10 A 1 PAS -1
	MonTableau[Indice] = MaVariable + 10
FIN
```


<a name="Exemple3"></a>



```wl
POUR Indice = 1 A 5
	Trace(Indice)
FIN
Info(Indice)	   // Indice vaut 6
```


<a name="Exemple4"></a>



```wl
// Syntaxe optimisée
// Parcours des lignes du champ Table. 
// Le nombre de lignes est calculé une seule fois
POUR Indice = 1 _A_ TABLE_MaTable.Occurrence
	COL_MaCol[Indice].Couleur = iVertFoncé
FIN
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`POUR <Variable de contrôle> = <Valeur initiale> A <Valeur finale> [PAS <x>]
...
FIN
`
---

**`<POUR> : ()`**

Signale le début du bloc d'instructions.

**`<Variable de contrôle> : ()`**

Variable simple de type scalaire (entier ou réel).

Il n'est pas nécessaire de déclarer cette variable. En effet, cette variable est déclarée automatiquement.

**`<Valeur initiale> : ()`**

Valeur initiale de la variable de contrôle (entier ou réel).

**`<Valeur finale> : ()`**

Valeur finale de la variable de contrôle (entier ou réel).

**`<PAS> : ()`**

Pas d'incrémentation (optionnel) de la variable de contrôle (par défaut, 1).

**`<x> : ()`**

Valeur (optionnelle) du pas d'incrémentation (type identique au type de la variable de contrôle).

**`<FIN> : ()`**

Signale la fin du bloc d'instructions.  


<a name="SYNTAXE2"></a>

### Autres syntaxes disponibles

`POUR <Variable de contrôle> = <Valeur initiale> _A_ <Valeur finale> [PAS <x>]
...
FIN
 
POUR <Variable de contrôle> = <Valeur initiale> _A_ <Valeur finale> [_PAS_ <x>]
...
FIN
 
POUR <Variable de contrôle> = <Valeur initiale> A <Valeur finale> [_PAS_ <x>]
...
FIN
`
---

**`<_A_> : ()`**

Signale que la valeur finale doit être évaluée une seule fois

**`<_PAS_> : ()`**

Signale que le pas d'incrémentation doit être évalué une seule fois.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Syntaxe équivalente
<a name="syntaxe_equivalente_ELTPARAGRAPHE000106"></a>Il est également possible d'utiliser la syntaxe suivante :


```txt
POUR <Variable de contrôle> = <Valeur initiale> A <Valeur finale> [PAS <x>]; ... ; FIN
```


Le point virgule permet de séparer les différentes lignes.


<a name="NOTE0_2"></a>




### Code à exécuter
<a name="code_executer_ELTPARAGRAPHE000119"></a>Le code à exécuter est placé entre les instructions **POUR** et **FIN**.


<a name="NOTE0_3"></a>




### Pas d'incrémentation
<a name="pas_incrementation_ELTPARAGRAPHE000128"></a>Le pas d'incrémentation de l'instruction **POUR** doit être constant. Si le pas d'incrémentation est susceptible de varier à chaque répétition, un warning apparaît lors de la compilation du projet.


<a name="NOTE0_4"></a>




### Sortir d'une boucle de type POUR
<a name="sortir_une_boucle_type_pour_ELTPARAGRAPHE000137"></a>Plusieurs instructions sont possibles :

- [RETOUR](../Motscles/1510009.md) : Sortie de la boucle **POUR** et sortie du traitement (ou de la procédure) en cours.

- [RENVOYER](../Motscles/1510007.md) : Renvoi d'un compte-rendu au traitement appelant. Sortie de la boucle **POUR** et sortie du traitement (ou de la procédure) en cours.

- [SORTIR](../Motscles/1510012.md) : Sortie de la boucle **POUR** et exécution de la suite du traitement en cours.




La fonction [Ferme](../WDLang1/3038018.md) permet de sortir de la boucle **POUR** et de fermer la fenêtre en cours.

**Attention** : Il n'est pas possible d'utiliser les instructions [RETOUR](../Motscles/1510009.md) et [RENVOYER](../Motscles/1510007.md) dans un même traitement.


<a name="NOTE0_5"></a>




### Exécution de l'itération suivante
<a name="execution_iteration_suivante_ELTPARAGRAPHE000169"></a>Pour exécuter directement l'itération suivante **sans terminer le code de l'itération en cours**, utilisez l'instruction [Continuer](../Motscles/1510003.md) :


```txt
POUR <Variable de contrôle> = <Valeur initiale> A <Valeur finale> [PAS <x>]
	...
	SI <Condition> ALORS CONTINUER		   // Retour au mot-clé POUR
	...
FIN
```


Dans ce cas, la variable de contrôle est automatiquement incrémentée.




