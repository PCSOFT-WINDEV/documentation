
## Variable composée

***En anglais : Composite variable***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Une variable composée est une variable composée d'éléments (membres) de types différents.

**Remarque** : Si vous manipulez des variables personnalisées, il est conseillé de déclarer :

- une ***variable composée***, si une seule variable de ce type est utilisée dans votre projet (par exemple utilisation ponctuelle pour passer des paramètres à une API).

- un type ***structure***, si plusieurs variables de ce type sont utilisées dans différents traitements du projet.





<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
RefProduit est composée de
	CodeF est un entier
	CodePr est une chaîne fixe sur 10
FIN
RefProduit.CodeF = 7
RefProduit.CodePr = "Ecran"
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Déclarer une variable composée

`<Nom de la variable> est composée de
    <Membres de la variable composée>
FIN
`
---

**`<Nom de la variable> : ()`**

Nom de la variable composée à déclarer.

**`<Membres de la structure> : ()`**

Déclarations des variables contenues dans la variable composée. Ces variables sont appelées les ***membres*** de la variable composée.

**`<FIN> : ()`**

Fin de déclaration de la variable composée.  


<a name="SYNTAXE2"></a>

### Manipuler un membre d'une variable composée

`<Nom de la variable> .<Nom du membre>
`
---

**`<Nom de la variable> : ()`**

Nom de la variable de type structure à déclarer.

**`<Nom du membre> : ()`**

Nom du membre à manipuler.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Manipuler une variable composée
<a name="manipuler_une_variable_composee_ELTPARAGRAPHE000082"></a>Une variable composée peut être utilisée sans faire référence à ses membres.

Par exemple :


```wl
VarComposée est composée de
	Membre1 est une chaîne fixe sur 8
	Membre2 est une chaîne fixe sur 12
FIN
Ch = VarComposée // Ch est construit en concaténant tous les membres
				// de la variable composée
VarComposée = Ch // Ch est transféré vers la variable composée
```



<a name="NOTE0_2"></a>




### Type des membres d'une variable composée
<a name="type_des_membres_une_variable_composee_ELTPARAGRAPHE000095"></a>Les membres d'une variable composée peuvent être de type :

- [Entier](../Motscles/1514049.md) (ou sélectionné parmi les [entiers avancés](../Motscles/1514049.md)).

- [Réel](../Motscles/1514048.md) (ou sélectionné parmi les [réels avancés](../Motscles/1514048.md)).

- [Monétaire](../Motscles/1514043.md).

- [Chaîne](../Motscles/1514044.md) (ou sélectionné parmi les [chaînes avancées](../Motscles/1514044.md)).

- Tableau ([tableau "simple"](../Motscles/1514030.md), [tableau dynamique](../Motscles/1514057.md) ou [tableau fixe](../Motscles/1514025.md)).

- [Automation](../Motscles/1514014.md) ou [Automation Dynamique](../Motscles/1514015.md).

- [Classe](../POO/6010006.md). Cette classe doit posséder un constructeur sans paramètre (ou avec des paramètres facultatifs).

- [Variant](../Motscles/1514019.md).




Tous les autres types de données (variable composée, constante, ...) sont interdits.


<a name="NOTE0_3"></a>




### Déclarer un membre de type tableau dans une structure
<a name="declarer_membre_type_tableau_dans_une_structure_ELTPARAGRAPHE000150"></a>

- ***Déclarer un membre de type tableau simple :***
	Les dimensions du tableau sont fixées dès la déclaration. Il est possible de modifier les dimensions du tableau avec la fonction [Dimension](../WDLang1/3013022.md)

- ***Déclarer un membre de type tableau dynamique :***
	Il est nécessaire de définir les dimensions du tableau (c'est-à-dire d'allouer le tableau) avant d'utiliser le tableau.




Par exemple :


```wl
// Déclaration d'une variable composée
MaVarComp est composée de
	x1 est un entier
	x2 est un tableau dynamique      // Déclaration du tableau
FIN
 
// Allocation du tableau
MaVarComp.x2 = allouer un tableau dynamique de 4,7 entiers
// Initialisation du tableau
MaVarComp.x2[1,1] = 25
```



<a name="NOTE0_4"></a>




### Limites d'une variable composée
<a name="limites_une_variable_composee_ELTPARAGRAPHE000170"></a>Il n'est pas possible de :

- affecter directement une variable composée à une autre variable composée : chaque membre doit être affecté un par un.

- comparer deux variables composées.

- passer une variable composée en paramètre à une procédure.

- définir un héritage dans une variable composée.

- restreindre l'accès à un membre d'une variable composée : tous les membres d'une variable composée doivent être publics.





<a name="NOTE0_5"></a>




### Quels types "avancés" peuvent être membre ?
<a name="quels_types_avances_peuvent_etre_membre_ELTPARAGRAPHE000185"></a>Une variable "avancée" peut être membre d'une variable "avancée". Le tableau ci-dessous présente les différentes combinaisons :

| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=Fleche_1.gif)<br> | Variable composée | Structure | Classe | Tableau |
| --- | --- | --- | --- | --- |
| **Variable composée** | Non | Non | Non | Non |
| **Structure** | Oui | Oui | Oui | Oui |
| **Classe** | Oui | Oui | Oui | Oui |
| **Tableau** | Oui | Oui | Oui | Non |






<a name="NOTE0_6"></a>




### Déclaration de variables de même nom
<a name="declaration_variables_meme_nom_ELTPARAGRAPHE000246"></a>Il est interdit de déclarer :

- deux variables de même nom (quel que soit le type de ces variables) dans un traitement.

- deux membres de même nom dans une même variable composée.







