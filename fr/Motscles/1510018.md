
## Instruction POUR TOUT / POUR TOUS (parcours de chaînes)

***En anglais : FOR EACH / FOR ALL***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
L'instruction **POUR TOUT** permet d'effectuer différents types de parcours de chaînes :

- Parcours des sous-chaînes séparées par un séparateur. 

- Parcours des occurrences d'une chaîne dans une autre.




**Remarque** : Les instructions **POUR TOUT, POUR TOUS, POUR CHAQUE** sont acceptées. Dans cette documentation, seule l'instruction **POUR TOUT** est utilisée et peut être remplacée par **POUR TOUS** ou **POUR CHAQUE**.

L'instruction POUR TOUT peut également être utilisée pour parcourir les objets DotNet qui implémentent l'interface IEnumerable.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Récupère la liste des librairies chargées en mémoire
ListeLibrairie est une chaîne = ListeDLL()

// Pour chaque librairie
POUR TOUTE CHAÎNE UneLibrairie DE ListeLibrairie SEPAREE PAR RC
	// Ajoute la librairie dans la table TABLE_Librairie
	TableAjouteLigne(TABLE_Librairie, ExtraitChaîne(UneLibrairie, 1, TAB))
FIN
```


<a name="Exemple2"></a>



```wl
// Le fichier "C:\MesDocuments\Exports.TXT" contient la liste
// des produits exportés séparés par des ";"
// Récupération de chaque produit
ProduitExport est une chaîne = fChargeTexte("C:\MesDocuments\Exports.TXT")
AnciennePosition est un entier

// Pour chaque produit
POUR TOUTE POSITION PositionActuelle DE ";" DANS ProduitExport
	// Ajoute le produit dans la liste ListeProduit
	ListeAjoute(LISTE_Produit, ...
		ProduitExport[[AnciennePosition + 1 A PositionActuelle - 1]]
	// Mémorisation de la position
	AnciennePosition = PositionActuelle 
FIN
```


<a name="Exemple3"></a>



```wl
POUR TOUTE CHAINE sc1, nPosition, nCompteur DE "A.B.C" SEPAREE PAR "."
	Trace(sc1 + " - " + nPosition + " - " + nCompteur)
FIN
// Renvoie
// A - 1 - 1
// B - 3 - 2
// C - 5 - 3
```


<a name="Exemple4"></a>



```wl
s est une chaîne = "je suis une phrase"+RC+"sur plusieurs lignes"
POUR TOUTE CHAÎNE s2 DE s SEPAREE PAR [" ",RC]
	Trace(s2)
FIN

// Renvoie
// je
// suis
// une
// phrase
// sur
// plusieurs
// lignes
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Parcours des sous-chaînes séparées par un séparateur

`POUR TOUTE CHAÎNE <Sous-chaîne> [, <Position> [, <Compteur>]]  DE <Chaîne initiale> 
                                                                    [SEPAREEE PAR <Séparateur>] [<Sens>]

     ...
FIN
`
---

**`<POUR TOUTE CHAÎNE> : ()`**

Signale le début du bloc d'instructions.

**`<Sous-Chaîne> : ()`**

Variable de type chaîne contenant le texte de la sous-chaîne. Il n'est pas nécessaire de déclarer cette variable.

**`<Position> : ()`**

Variable de type entier contenant la position de la sous-chaîne dans la chaîne. Il n'est pas nécessaire de déclarer cette variable.

**`<Compteur> : ()`**

Variable de type entier contenant le nombre d'itérations. Il n'est pas nécessaire de déclarer cette variable.

**`<Chaîne initiale> : ()`**

Chaîne contenant le texte complet. Si cette chaîne est vide, le parcours des sous-chaînes n'est pas effectué.

**`<Séparateur> : ()`**

Chaîne optionnelle contenant le séparateur des sous-chaînes (TAB par défaut).

Pour spécifier plusieurs séparateurs, il suffit d'utiliser la syntaxe : 


```txt
[<Séparateur1> , ..., <Séparateur N>]
```


Par exemple : [TAB, RC]

**`<Sens> : ()`**

Indicateur optionnel du sens de parcours :


|   |   |
| --- | --- |
| *DepuisDébut* <br>(valeur par défaut) | Parcours la chaîne du premier caractère au dernier. |
| *DepuisFin* | Parcours la chaîne du dernier caractère au premier. |






<a name="SYNTAXE2"></a>

### Parcours des occurrences d'une chaîne dans une autre chaîne

`POUR TOUTE POSITION <Position> DE <Recherche> DANS <Chaîne initiale> [<Sens>]

     ...
FIN
`
---

**`<POUR TOUTE POSITION> : ()`**

Signale le début du bloc d'instructions.

**`<Position> : ()`**

Variable de type Entier contenant la position en cours. Il n'est pas nécessaire de déclarer cette variable.

**`<Recherche> : ()`**

Chaîne recherchée.

**`<Chaîne initiale> : ()`**

Chaîne contenant le texte complet.

**`<Sens> : ()`**

Indicateur optionnel du sens de parcours :


|   |   |
| --- | --- |
| *DepuisDébut*<br>(valeur par défaut) | Parcours la chaîne du premier caractère au dernier. |
| *DepuisFin* | Parcours la chaîne du dernier caractère au premier. |






<a name="SYNTAXE3"></a>

### Parcours des occurrences d'une chaîne dans une autre chaîne

`POUR TOUTE POSITION <Position> DE <Recherche> DANS <Chaîne initiale> AVEC <Options>

     ...
FIN
`
---

**`<POUR TOUTE POSITION> : ()`**

Signale le début du bloc d'instructions.

**`<Position> : ()`**

Variable de type Entier contenant la position en cours. Il n'est pas nécessaire de déclarer cette variable.

**`<Recherche> : ()`**

Chaîne recherchée.

**`<Chaîne initiale> : ()`**

Chaîne contenant le texte complet.

**`<Options> : ()`**

Indicateur des options sélectionnées (combinables) :


|   |   |
| --- | --- |
| *DepuisDébut*<br>(valeur par défaut) | Parcours la chaîne du premier caractère au dernier. |
| *DepuisFin* | Parcours la chaîne du dernier caractère au premier. |
| *MotComplet* | Recherche sur le mot complet |
| *SansCasse* | Recherche sans tenir compte de la casse (Majuscules / minuscules) |







<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Syntaxe 1 : Parcours des sous-chaînes séparées par un séparateur
<a name="syntaxe_1_parcours_des_souschaines_separees_par_separateur_ELTPARAGRAPHE000177"></a>Parcourt toutes les sous-chaînes de la chaîne &lt;Chaîne initiale&gt; séparées par le séparateur &lt;Séparateur&gt;. Si &lt;Chaîne initiale&gt; correspond à une chaîne vide, le parcours n'est pas effectué.

A chaque itération :

- la variable &lt;Sous-chaîne&gt; est renseignée avec la sous-chaîne en cours.

- la variable &lt;Position&gt; contient la position de la sous-chaîne dans la chaîne. 

- la variable &lt;Compteur&gt; contient le nombre d'itérations effectuées. 




Le comportement est indéterminé si la chaîne initiale ou le séparateur est modifié lors du parcours.

**Remarque** : Si &lt;Chaîne initiale&gt; se termine par le séparateur, &lt;Sous-Chaîne&gt; renvoie une chaîne vide à la fin. Dans le cas contraire, &lt;Sous-Chaîne&gt; correspond au dernier élément extrait.


<a name="NOTE0_2"></a>




### Syntaxe 2 et 3 : Parcours des occurrences d'une chaîne dans une autre
<a name="syntaxe_2_3_parcours_des_occurrences_une_chaine_dans_une_autre_ELTPARAGRAPHE000203"></a>Parcourt toutes les positions de la sous-chaîne &lt;Recherche&gt; dans la chaîne &lt;Chaîne initiale&gt;.

A chaque itération, la variable &lt;Position&gt; est renseignée avec la position de la sous-chaîne en cours.

Le comportement est indéterminé si la chaîne initiale ou la chaîne recherchée est modifiée lors du parcours.


<a name="NOTE0_3"></a>




### POUR TOUTE CHAÎNE, POUR TOUTE POSITION et UNICODE
<a name="pour_toute_chaine_pour_toute_position_unicode_ELTPARAGRAPHE000216"></a>Les paramètres &lt;Sous-chaîne&gt;, &lt;Chaîne initiale&gt;, &lt;Séparateur&gt; et &lt;Recherche&gt; peuvent tous correspondre :

- soit à des chaînes ANSI.

- soit à des chaînes UNICODE.




Cependant, il n'est pas possible d'utiliser des chaînes ANSI **et** des chaînes UNICODE dans la même syntaxe.

Pour plus de détails, consultez [Gestion de l'UNICODE](../WDLang1/3024038.md).


<a name="NOTE0_4"></a>


### Astuce : Comment récupérer le séparateur ? 
<a name="astuce_comment_recuperer_separateur_ELTPARAGRAPHE000234"></a>Pour récupérer le séparateur dans la boucle, il suffit d'utiliser la syntaxe suivante qui permet de connaître la position du séparateur. Pour connaître le séparateur, il suffit de récupérer le caractère suivant. 

Par exemple : 


```wl
POUR TOUTE CHAÎNE sChaineTemp, nPosition DE sChaineIN SEPAREE PAR [" ","-"]
	sSeparateur = sChaineIN[[nPosition + Taille(sChaineTemp)]]
	...
FIN
```


<a name="NOTE0_5"></a>


### Astuce : Parcours d'une chaîne XML 
<a name="astuce_parcours_une_chaine_xml_ELTPARAGRAPHE000245"></a>Pour parcourir un fichier XML, avant d'utiliser la syntaxe "POUR TOUT", exécutez la fonction [XMLExécuteXPath](../WDLang5/3081015.md).



