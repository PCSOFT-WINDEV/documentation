
## Connecteur Natif MariaDB : Spécificités et remarques
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000391"></a>
Les paragraphes suivants présentent les remarques générales et les spécificités du Connecteur Natif MariaDB.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Remarques générales
<a name="remarques_generales_ELTTEXTE000421"></a>




### Versions nécessaires
<a name="versions_necessaires_ELTPARAGRAPHE000020"></a>Attention : Cette version du Connecteur Natif MariaDB fonctionne uniquement avec :


- WINDEV 28 ou WEBDEV 28.

- Couche cliente de MariaDB (fichier libmariadb.DLL)

	- Couche Cliente 32 bits pour utiliser le Connecteur Natif MariaDB 32 bits (version 3.x.x à 10.x.x testée).

	- Couche Cliente 64 bits pour utiliser le Connecteur Natif MariaDB 64 bits (version 10.x.x testée).




- La DLL ***LibMariaDB.DLL*** doit être présente :

	- Sur le poste de développement : 

		- dans le répertoire "\\Programmes\\Framework\\Win32x86" du répertoire d'installation de WINDEV ou WEBDEV (32 bits).

		- dans le répertoire "\\Programmes\\Framework\\Win64x86" du répertoire d'installation de WINDEV ou WEBDEV (64 bits).




- Sur le poste de déploiement, dans le répertoire de l'exécutable ou dans le répertoire de Windows. En cas de déploiement sur un serveur Web, la DLL doit être présente dans le répertoire du Connecteur Natif ou dans le répertoire de Windows.





<a name="NOTE2_2"></a>




### Utilisation d'ordres WLangage dans les requêtes SQL
<a name="utilisation_ordres_wlangage_dans_les_requetes_sql_ELTPARAGRAPHE000030"></a>Dans les requêtes SQL, il n'est pas possible d'utiliser des ordres WLangage. 


<a name="NOTE2_3"></a>




### Limitations de MariaDB version 3.23x
<a name="limitations_mariadb_version_323x_ELTPARAGRAPHE000039"></a>La base de données MariaDB version 3.23x ne supporte pas :

- le Fetch Partiel. L'utilisation du Fetch Partiel avec les fonctions SQL du WLangage a le même effet que si le Fetch Partiel n'était pas utilisé.

- les Unions.





<a name="NOTE2_4"></a>




### Gestion de fichiers de taille importante
<a name="gestion_fichiers_taille_importante_ELTPARAGRAPHE000051"></a>Lors de la manipulation de fichiers de taille importante, tous les enregistrements sont chargés en mémoire. Pour réduire l'occupation mémoire, il est conseillé de :

- utiliser un filtre (fonction [HFiltre](../WDLang4/3044100.md)) avant d'initialiser un parcours (fonctions [HLitPremier](../WDLang4/3044051.md)/[HLitDernier](../WDLang4/3044140.md), ...).

- utiliser des requêtes dont les conditions de sélection soient suffisamment discriminantes.

- éviter les recherches.





<a name="NOTE2_5"></a>




### Requêtes de type INSERT et Identifiant automatique
<a name="requetes_type_insert_identifiant_automatique_ELTPARAGRAPHE000073"></a>Les requêtes de type INSERT (créées par programmation ou grâce à l'éditeur de requêtes) ne gèrent pas les identifiants automatiques. Pour utiliser un identifiant automatique, utilisez la fonction [HAjoute](../WDLang4/3044147.md) sur la table.


<a name="NOTE2_6"></a>




### Création de table avec la fonction HCréation
<a name="creation_table_avec_fonction_hcreation_ELTPARAGRAPHE000085"></a>La fonction [HCréation](../WDLang4/3044255.md) crée des tables de type "InnoDB" pour permettre la gestion des blocages et des transactions. Consultez [Connecteur Natif MariaDB : Particularités](../WDMySQL/5517005.md) pour plus d'informations.


<a name="NOTE2_7"></a>




### Support de Unicode
<a name="support_unicode_ELTPARAGRAPHE000100"></a>**Lorsque Unicode est supporté sur la connexion (mode par défaut)**, le type des rubriques texte des requêtes exécutées avec la constante *hRequêteSansCorrection* est Unicode. Si une chaîne Unicode est affectée dans une chaîne Ansi, WINDEV et WEBDEV font automatiquement la conversion en utilisant l'alphabet défini avec la fonction [ChangeAlphabet](../WDLang1/3054001.md).

**Si la connexion est ANSI** (option "WD Unicode Support = 0" dans les informations étendues spécifiées avec les fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md)), le type des rubriques texte des requêtes exécutées avec la constante *hRequêteSansCorrection* est ANSI.

Pour plus de détails sur les connexions Unicode ou ANSI, consultez [Programmation d'une base de données MariaDB avec les fonctions HFSQL](../WDMariaDB/1000021528.md).


<a name="NOTE2_8"></a>


### Connexion avec certificats SSL
<a name="connexion_avec_certificats_ssl_ELTPARAGRAPHE000124"></a>Pour l'établissement d'une connexion avec certificat SSL, il est nécessaire de : 

1. Installer une version du serveur MariaDB gérant les connexions SSL. Pour plus de détails, consultez la documentation MariaDB.

2. Créer les certificats nécessaires. 

3. Etablir une connexion en utilisant les mots-clés suivants dans les informations avancées de la connexion : 
	

| Mot-clé | Utilisation |
| --- | --- |
| SSL Key | Chemin du fichier de clé. |
| SSL Cert | Chemin du fichier de certificat. |
| SSL CA | Chemin du fichier de l'autorité de certification. |
| SSL CAPath | Chemin du répertoire contenant les certificats des autorités de certification SLL reconnues, au format PEM. |
| SSL Cipher | Liste des chiffrements autorisés. |






Exemple de connexion SSL sur la base CRM du serveur serveurmariadb.domaine.fr : 

```wl
MaConnexion est une Connexion

// Description de la connexion
MaConnexion.Utilisateur = "root"
MaConnexion.MotDePasse = "secret"
MaConnexion.Serveur = "serveurmariadb.domaine.fr"
MaConnexion.BaseDeDonnées = "CRM"
MaConnexion.Provider = hAccèsNatifMariaDB
MaConnexion.Accès = hOLectureEcriture

// Description des informations étendues pour une connexion SSL
MaConnexion.InfosEtendues = [
SSL KEY = E:\MySSLCertificates\mariadb.key;
SSL CERT = E:\MySSLCertificates\mariadb_cert.pem;
SSL CA = E:\MySSLCertificates\ca-cert.pem;
SSL CAPATH = E:\MySSLCertificates\CA\
]

// Ouverture de la connexion
HOuvreConnexion(MaConnexion)
```


**Remarque** : Ces paramètres correspondent aux paramètres de même nom de la fonction mysql_ssl_set de l'API C d'accès à MariaDB.

Pour plus de détails, consultez la page d'aide [Informations optionnelles de connexion](../WDLang4/9000124.md). 



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Spécificités générales
<a name="specificites_generales_ELTTEXTE000504"></a>




### Blocage des enregistrements
<a name="blocage_des_enregistrements_ELTPARAGRAPHE000176"></a>Les options de blocage (constantes *hBlocageEcriture* et *hBlocageLectureEcriture*) utilisables avec les fonctions HFSQL ne sont pas gérées dans cette version.

Consultez [Connecteur Natif MariaDB : Particularités](../WDMariaDB/1000021522.md) pour plus d'informations.


<a name="NOTE3_2"></a>


### Enregistrements identiques
<a name="enregistrements_identiques_ELTPARAGRAPHE000189"></a>Le Connecteur Natif MariaDB n'est pas capable de différencier deux enregistrements identiques (dont les valeurs de toutes les rubriques sont égales, sans tenir compte des rubriques de type mémo).

En cas de modification ou de suppression d'enregistrement, tous les enregistrements identiques seront modifiés ou supprimés.


<a name="NOTE3_3"></a>


### Transactions
<a name="transactions_ELTPARAGRAPHE000199"></a>Pour gérer les transactions, il est nécessaire d'utiliser un type de la table MariaDB permettant de gérer les ordres BEGIN, COMMIT et ROLLBACK.

Consultez [Connecteur Natif MariaDB : Particularités](../WDMariaDB/1000021522.md) pour plus d'informations.


<a name="NOTE3_4"></a>


### Rubriques de type SET ou ENUM
<a name="rubriques_type_set_enum_ELTPARAGRAPHE000212"></a>Les rubriques de type SET ou ENUM sont automatiquement traitées et importées sous forme de mémo texte sous WINDEV et WEBDEV. En effet les rubriques de type SET ou ENUM n'ont pas d'équivalence en HFSQL. Elles contiennent des valeurs numériques (indices) qui correspondent à des valeurs "texte". Ce sont ces valeurs "texte" qui sont importées.


<a name="NOTE3_5"></a>


### Rubriques de type xBlob
<a name="rubriques_type_xblob_ELTPARAGRAPHE000220"></a>Les rubriques de type xBlob sous MariaDB sont automatiquement traitées et importées sous WINDEV et WEBDEV :

- les rubriques BLOB sont importées sous forme de rubriques de type mémo binaire.

- les rubriques LONGTEXT sont importées sous forme de rubriques de type mémo texte.





<a name="NOTE3_6"></a>


### Rubriques de type Tableau
<a name="rubriques_type_tableau_ELTPARAGRAPHE000231"></a>Les rubriques de type tableau ne sont pas gérées par le Connecteur Natif. Si vous utilisez une rubrique tableau, seule la valeur de l'indice 1 du tableau sera manipulable avec les fonctions HFSQL (en écriture et en lecture).


<a name="NOTE3_7"></a>


### Utilisation de requêtes INSERT/UPDATE pour insérer du texte dans une rubrique de type LONGBLOB (mémo binaire) sur MariaDB
<a name="utilisation_requetes_insertupdate_pour_inserer_texte_dans_une_rubrique_type_longblob_memo_binaire_sur_mariadb_ELTPARAGRAPHE000239"></a>Pour permettre la gestion des rubriques Unicode, les connexions du Connecteur Natif MariaDB sont ouvertes en UTF8 : toutes les requêtes et les données sont échangées en UTF8 avec le serveur.

Le serveur convertit la requête et les valeurs dans l'alphabet (charset) correspondant à chaque colonne, sauf dans le cas d'une rubrique **LONGBLOB** (mémo binaire) : dans ce cas, la valeur est insérée telle qu'elle.

**Pour une rubrique LONGBLOB** :

- si la connexion est ANSI, la valeur texte insérée est ANSI.

- si la connexion est UTF8, la valeur texte insérée est UTF8, ce qui peut poser un problème de compatibilité avec l'existant.




Pour ne pas avoir ce problème de conversion en UTF8, il est possible :

- soit de forcer l'utilisation d'une connexion ANSI en utilisant le paramètre : "WD Unicode Support = 0" des informations étendues de la connexion (fonctions [HDécritConnexion](../WDLang4/3044205.md) ou [HOuvreConnexion](../WDLang4/3044107.md)). Pour plus de détails, consultez [Programmation d'une base de données MariaDB avec les fonctions HFSQL](../WDMariaDB/1000021528.md).

- soit de changer le type de la rubrique LONGBLOB par LONGTEXT sur la base de données MariaDB.





<a name="NOTE3_8"></a>


### Indexation partielle des mémos et indexation full-text
<a name="indexation_partielle_des_memos_indexation_fulltext_ELTPARAGRAPHE000268"></a>L'indexation partielle des mémos ainsi que l'indexation full-text ne sont pas prises en compte :

- lors de l'importation des tables MariaDB dans l'analyse.

- lors de l'utilisation de la fonction [HCréation](../WDLang4/3044255.md).




Si ces fonctionnalités sont définies dans l'analyse, elles seront prises en compte uniquement lors de l'exécution de requêtes SQL (avec la constante *hRequêteSansCorrection*) utilisant les fonctions SQL "CREATE TABLE" et "MATCH AGAINST".



<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Spécificités pour les fonctions HFSQL et les fonctions SQL
<a name="specificites_pour_les_fonctions_hfsql_les_fonctions_sql_ELTTEXTE000570"></a>
Les spécificités pour l'utilisation des fonctions HFSQL et des fonctions SQL avec le Connecteur Natif MariaDB sont les suivantes :

| Spécificités | Fonctions concernées |
| --- | --- |
| Requête multi-fichier : <br>Les fonctions ***HAjoute***, ***HModifie*** et ***HSupprime*** ne sont pas supportées. | [HAjoute](../WDLang4/3044147.md)<br>[HModifie](../WDLang4/3044042.md)<br>[HSupprime](../WDLang4/3044018.md) |
| Les recherches réalisées sur certaines requêtes complexes avec la fonction HLitRecherche\* peuvent échouer dans cette version. <br>Ce problème sera corrigé dans une prochaine version. | [HLitRecherche](../WDLang4/3044050.md), [HLitRecherchePremier](../WDLang4/3044036.md), [HLitRechercheDernier](../WDLang4/3044034.md) |
| Lors de l'utilisation du Connecteur Natif MariaDB, il est nécessaire de préciser la "DataBase" utilisée.<br>Si vous utilisez la fonction ***HConnecte***, la "dataBase" doit être spécifiée dans les informations complémentaires de la manière suivante :<br>"initial catalog = NomDataBase" | [HConnecte](../WDLang4/3044263.md) |
| En création de tables avec la fonction ***HCréation***, les noms des tables ne doivent pas contenir d'accent (exemple : "FichierAccentué").<br>Ceci est un problème interne à MariaDB (testé sur les versions **3.23.52-max-nt** et **3.23.47-max-nt** du serveur MariaDB). L'exécution de l'ordre SQL "DROP TABLE", effectuée par [HCréation](../WDLang4/3044255.md) pour supprimer la table si elle existe déjà, peut provoquer un arrêt inopiné du serveur MariaDB.<br>Consultez [Connecteur Natif MariaDB : Particularités](../WDMariaDB/1000021522.md) pour plus d'informations. | [HCréation](../WDLang4/3044255.md) |










