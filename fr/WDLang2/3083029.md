


## ZoneRépétéeIndiceRupture (Fonction)

***En anglais : LooperBreakIndex***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Renvoie l'indice du haut et du bas de rupture d'une rupture donnée dans un champ Zone répétée : 

- L'indice du haut de rupture d'une rupture donnée correspond également à l'indice de la première répétition dans cette rupture.

- L'indice du bas de rupture d'une rupture donnée correspond également à l'indice de la dernière répétition dans cette rupture.









<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Le champ Zone répétée ZR_Factures liste les factures de chaque client
// Une rupture sur chaque client est effectuée
// Le bas de rupture contient le champ TotalFacture 
// lié à l'attribut ATT_Total
// Ce champ affiche le total de toutes les factures de chaque client
MaRépétition est un entier = 1	// Début du champ Zone répétée
DébutRupture est un entier		// Indice du haut de rupture
FinRupture est un entier		// Indice du bas de rupture
Indice est un entier			// Indice des répétitions
Total est un entier			// Total de chaque rupture

// Calcul des totaux pour tout le champ Zone répétée
TANTQUE MaRépétition <= ZR_Factures.Occurrence
	// Indice de la rupture courante
	DébutRupture = ZoneRépétéeIndiceRupture(RUPT_HautClient, MaRépétition)
	FinRupture = ZoneRépétéeIndiceRupture(RUPT_BasClient, MaRépétition)

	// Parcours des répétitions de la rupture courante
	// pour calculer le total
	POUR Indice = DébutRupture A FinRupture
		Total += ATT_Valeur[Indice]
	FIN

	// Affectation du total
	ATT_Total[FinRupture] = Total

	// Passage à la rupture suivante
	MaRépétition = FinRupture + 1
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ZoneRépétéeIndiceRupture(<Haut / Bas de rupture> [, <Indice>])`
---

**`<Résultat> : (Entier)`**



- Indice du haut / bas de rupture spécifié dans la rupture contenant la répétition &lt;Indice&gt;, 

- 0 en cas d'erreur. Pour connaître le libellé de l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.




**`<Haut / Bas de rupture> : (Chaîne de caractères)`**

Nom du haut ou du bas de rupture à manipuler. 
Ce paramètre peut correspondre :

- soit directement au nom du haut de rupture ou au nom du bas de rupture.

- soit au &lt;Nom du champ Zone répétée&gt;.&lt;Nom du haut ou du bas de rupture&gt;.




**`<Indice> : (Entier optionnel)`**

Indice d'une des répétitions contenues dans la rupture voulue.
Si ce paramètre n'est pas spécifié, l'indice du haut / bas de rupture spécifié dans la rupture contenant la répétition en cours est retourné.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000092"></a>La fonction **ZoneRépétéeIndiceRupture** peut être utilisée indifféremment sur : 

- un champ Zone répétée fichier,

- un champ Zone répétée par programmation. 



<a name="NOTE0_2"></a>


### Utilisation de la fonction ZoneRépétéeIndiceRupture
<a name="utilisation_fonction_docparampagetitleshort_ELTPARAGRAPHE000101"></a>Il est conseillé d'appeler la fonction **ZoneRépétéeIndiceRupture** après l'affichage complet du champ Zone répétée. Dans le cas contraire, les indices renvoyés par la fonction **ZoneRépétéeIndiceRupture** peuvent ne pas correspondre aux indices réellement affichés dans le champ Zone répétée.

<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
