


## &lt;Upload&gt;.CopieFichier (Fonction)

***En anglais : &lt;Upload&gt;.CopyFile***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Enregistre sur le serveur un fichier "uploadé" par l'internaute. Cet upload a pu être effectuée : 

- via un champ de saisie de type "Upload". 

- via un champ Upload mono ou multi-fichiers. 




Lors de cet enregistrement, il est possible de renommer le fichier copié sur le serveur.




<a name="sample_code"></a>

## Exemple

<a name="Exemple1"></a>
<a name="3012023_Exemple1"></a>

```wl
// Récupération du fichier envoyé par le client
refFic est une chaîne
refFic = SAI_File.CopieFichier("C:\Documents", "REF_3304")
// Si le fichier source est : "/User/Truc.jpg"
// refFic = "REF_3304.jpg" et le fichier a été copié dans "C:\documents\REF_3304.jpg"
```
<a name="Exemple2"></a>

```wl
// Upload réalisé à partir d'un champ Upload multi-fichiers
// Pour chaque fichier envoyé
POUR i = 1 _A_ UPL_Upload..Occurrence
	// Copie le fichier dans le répertoire des données
	UPL_Upload.CopieFichier(fRepDonnées(), "",  i)	
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Champ Upload>.CopieFichier(<Chemin sur le serveur> , <Nom du fichier> [, <Indice du fichier>])`
---

**`<Résultat> : (Chaîne de caractères)`**



- Nom (nom + extension) du fichier uploadé sur le serveur (ne contient pas le chemin du fichier),

- Chaîne vide ("") en cas d'erreur.




**`<Champ Upload> : (Nom de champ)`**

Nom du champ Upload manipulé. Ce champ peut correspondre : 

- à champ de saisie de type "Upload". Ce champ contient le nom et le chemin du fichier à envoyer sur le serveur. 
	Remarque : il est possible d'utiliser l'attribut d'un champ Zone répétée (propriété Valeur pour l'attribut).

- à un champ Upload monofichier ou multifichier.




**`<Chemin sur le serveur> : (Chaîne de caractères)`**

Chemin du répertoire du serveur où le fichier doit être copié. Ce chemin peut par exemple correspondre au chemin renvoyé par la fonction [fRepDonnées](../WDLang1/3036001.md). Ce chemin peut également correspondre à [fRepEnCours](../WDLang1/3036022.md), mais les hébergeurs donnent rarement les droits pour écrire dans ce répertoire.
![Linux](https://doc.pcsoft.fr/ext/images/fr/LX.png) Ce paramètre n'est pas pris en compte. Le fichier est uploadé dans le répertoire "/tmp" du serveur Linux. Ce répertoire est non modifiable. 

**`<Nom du fichier> : (Chaîne de caractères)`**

Nom du fichier (nom et extension) uploadé sur le serveur. Si le fichier existe déjà, il est automatiquement écrasé.

Si ce paramètre correspond à :

- une chaîne vide ("") : le nom du fichier sur le serveur sera identique au nom du fichier sur le poste de l'internaute.

- uniquement le nom du fichier (sans l'extension), l'extension du fichier sur le serveur sera identique à l'extension du fichier sur le poste de l'internaute.

- le nom du fichier et l'extension du fichier, ce nom et cette extension seront utilisés pour la copie du fichier sur le serveur.




**`<Indice du fichier> : (Entier optionnel)`**

Indice du fichier à enregistrer sur le serveur. Ce paramètre est utilisé uniquement dans le cas d'un upload réalisé avec le champ Upload multi-fichiers. Par défaut, cet indice correspond à 1.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Taille maximale des fichiers à uploader
<a name="taille_maximale_des_fichiers_uploader_ELTPARAGRAPHE000245"></a>**Par défaut,** la taille des fichiers à uploader est illimitée dans le moteur WEBDEV. Cette taille peut être limitée par le serveur d'application WEBDEV. 
Si le fichier à uploader dépasse la taille limite, le fichier n'est pas uploadé.
Pour modifier la taille maximale des fichiers à uploader dans le serveur d'application WEBDEV, il est nécessaire de modifier la base de registre sur le serveur :  

1. Pour modifier la taille des fichiers uploadés pour toutes les applications WEBDEV 28, sélectionnez la clé : HKEY_LOCAL_MACHINE\\SOFTWARE\\PC SOFT\\WEBDEV\\28.0 sur une machine 32 bits et HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\PC SOFT\\WEBDEV\\28.0 sur une machine 64 bits.

2. Ajoutez la chaîne MAX_UPLOAD. Cette chaîne aura pour valeur la taille maximale des fichiers à uploader (en Ko).



<a name="NOTE0_2"></a>


### Nom du fichier uploadé
<a name="nom_fichier_uploade_ELTPARAGRAPHE000277"></a>La fonction [&lt;Upload&gt;.NomFichier](../WDLang2/1000019064.md) permet de connaître le nom d'un fichier "uploadé".
<a name="NOTE0_3"></a>


### Sessions prélancées
<a name="sessions_prelancees_ELTPARAGRAPHE000294"></a>Si votre projet utilise les sessions prélancées, cette fonction ne doit pas être utilisée dans l'événement "Initialisation" du projet. Cette fonction doit être utilisée dans l'événement "Initialisation du projet après connexion au site". 

- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=UploadouDownloadd'unfichier.gif) ***Exemples unitaires (WEBDEV)*** : **Upload ou Download d'un fichier** <br>Upload (copier vers le serveur) et download (télécharger depuis le serveur) d'un fichier :<br>- Copier un fichier du poste navigateur vers le poste serveur<br>- Télécharger un fichier présent sur le serveur<br>- Télécharger un fichier présent sur le serveur grâce à un lien<br>- Télécharger un fichier présent sur le serveur en demandant son ouverture


<a name="XComposante"></a>

## Composante :
wd280page.dll
