


## &lt;Zone répétée&gt;.RafraîchissementVisible (Fonction)

***En anglais : &lt;Looper&gt;.RefreshVisible***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie ou renvoie l'état de visibilité du bandeau de rafraîchissement d'un champ Zone répétée.

Cette fonction peut être utilisée lorsque le champ Zone répétée gère l'option "Pull-to-refresh". Pour activer cette option dans un champ Zone répétée : 

1. Affichez la fenêtre de description du champ Zone répétée. 

2. Dans l'onglet "Détail", dans la zone "Déplacements et gestures", cochez l'option "Rafraîchissement par tirer/relâcher (Pull to refresh)".

3. Validez. 


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cette fonction est disponible sous WINDEV uniquement pour pouvoir être utilisée en mode simulateur. Utilisée dans une application WINDEV, cette fonction n'a aucun effet. 


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Evénement "Rafraîchissement par tirer/Relâcher" du champ Zone répétée
// ---------------------------------------------------------
// On demande à contrôler l'affichage du bandeau de sélection car l'actualisation des
// données du champ Zone répétée va être effectuée dans un thread secondaire. 
// Dans le cas contraire, le bandeau de rafraîchissement serait automatiquement masqué à la
// fin de l'exécution du traitement.
ZR_Donnees.RafraîchissementVisible(Vrai)
// Exécute l'actualisation des données du champ Zone répétée dans un thread secondaire
ThreadExecute("threadMajZR", threadNormal, ProcThreadMajZR)
```

```wl
// Procédure de mise à jour des données du champ Zone répétée
PROCEDURE ProcThreadMajZR()
// Exécution d'une requête HTTP
HTTPRequête(...)
// On retourne dans le thread principal pour ajouter le contenu de la requête dans le
// champ Zone répétée
ExecuteThreadPrincipal(ProcMajZR, HTTPDonneRésultat())
FIN
```

```wl
// Procédure de remplissage des données du champ Zone répétée
PROCEDURE ProcMajZR(sDonnees est une chaîne)
// Traitement des données reçues pour remplissage du champ Zone répétée
...
// Les données du champ Zone répétée sont à jour, 
// on masque le bandeau de rafraîchissement
ZR_Donnees.RafraîchissementVisible(Faux)

FIN
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Modifier l'état de visibilité du bandeau de rafraîchissement

`<Champ Zone répétée>.RafraîchissementVisible(<Visible>)`
---

**`<Champ Zone répétée> : (Nom de champ)`**

Nom du champ Zone répétée à manipuler.

**`<Visible> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> pour afficher le bandeau de rafraîchissement,

- <u><u><u><u>Faux</u></u></u></u> pour le masquer.





<a name="SYNTAXE2"></a>

### Connaître l'état de visibilité du bandeau de rafraîchissement

`<Résultat> = <Champ Zone répétée>.RafraîchissementVisible()`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le bandeau de rafraîchissement est affiché,

- <u><u><u><u>Faux</u></u></u></u> si le bandeau de rafraîchissement est masqué.




**`<Champ Zone répétée> : (Nom de champ)`**

Nom du champ Zone répétée à manipuler.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Lors d'un "Pull-to-refresh", le bandeau de rafraîchissement correspond à la zone affichée au-dessus des cellules du champ Zone répétée pendant le rafraîchissement des données.

- La fonction **&lt;Zone répétée&gt;.RafraîchissementVisible** permet par exemple de contrôler l'affichage du bandeau de rafraîchissement lorsque l'actualisation des données du champ Zone répétée est effectuée dans un thread secondaire. Il est ainsi possible d'éviter de figer l'application (l'exemple utilise cette méthode). 

- Lorsque le bandeau de rafraîchissement est rendu visible par la fonction **&lt;Zone répétée&gt;.RafraîchissementVisible**, l'événement "Rafraîchissement par tirer/relâcher" du champ Zone répétée n'est pas exécuté.
	Remarque : Il est possible de forcer l'exécution de cet événement en utilisant la fonction [ExécuteTraitement](../WDLang1/3013031.md) avec la constante *trtTirerPourRafraîchir*.

- Pour masquer le bandeau de rafraîchissement, il est nécessaire d'appeler **&lt;Zone répétée&gt;.RafraîchissementVisible(Faux)** autant de fois que **&lt;Zone répétée&gt;.RafraîchissementVisible(Vrai)** a été exécuté.




<a name="XComposante"></a>

## Composante :
wd280java.dll
