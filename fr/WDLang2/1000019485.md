


## Les sessions prélancées
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000211"></a>
Une session prélancée est une session d'un site Web (ou d'un webservice) lancée automatiquement sur le serveur Web depuis le Serveur d'Application WEBDEV. 

L'utilisation des sessions prélancées permet d'accélérer l'affichage des pages en effectuant par anticipation des traitements longs : connexions aux bases de données, chargement des configurations de pages, ...

Les sessions prélancées peuvent être utilisées avec les sites WEBDEV en mode Session, les sites WEBDEV AWP et les webservices SOAP et les Webservices REST. Le mode de fonctionnement est identique dans tous les cas. 

**Remarque** : Les sessions prélancées sont autorisées uniquement sur le serveur illimité ou 10 connexions. Elles ne sont pas actives sur le poste de développement. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Importance des sessions prélancées
<a name="importance_des_sessions_prelancees_ELTTEXTE000235"></a>


### Principe d'une requête d'affichage d'une page AWP
<a name="principe_une_requete_affichage_une_page_awp_ELTPARAGRAPHE000024"></a>Pour comprendre l'importance des sessions prélancées (notamment pour les pages AWP), revenons un instant sur le principe des pages AWP.

Lorsqu'un internaute effectue une requête à partir d'une page AWP, les opérations suivantes sont réalisées : 

1. La requête est transmise du navigateur au serveur Web. 

2. Le serveur Web analyse la requête. 

3. Le serveur Web transmet la requête au Serveur d'application WEBDEV. 

4. Le Serveur d'application WEBDEV : 

	- charge le projet correspondant à la page. 

	- exécute le code d'initialisation du projet, puis le code de la page. 

	- renvoie la réponse au serveur Web. 




5. Le serveur Web renvoie la réponse au navigateur. 





### Intérêt des sessions prélancées
<a name="interet_des_sessions_prelancees_ELTPARAGRAPHE000041"></a>Lors de l'affichage d'une page AWP, chaque appel au Serveur d'application WEBDEV est totalement indépendant. 

**Conséquence** : A chaque requête (et donc à chaque changement de page, chaque appel Ajax), le Serveur d'application WEBDEV recharge le projet et ré-exécute le code d'initialisation. Ce code d'initialisation du projet exécute souvent des opérations "longues" : 

- connexion à la base de données, 

- chargement des fichiers de configuration, 

- ...




Les sessions prélancées permettent de demander au Serveur d'application WEBDEV de faire ces opérations à l'avance, par anticipation. 

Ainsi, lorsque la requête de l'internaute arrive au Serveur d'application WEBDEV, le serveur d'application n'a plus qu'à exécuter la requête et envoyer le résultat. 

Les sessions prélancées présentent donc un bénéfice en temps de réponse puisqu'une partie du code est exécuté en avance. Cependant, les sessions pré-lancées ne réduisent pas la charge sur le serveur (le code étant tout de même exécuté) et ne remplacent pas l'optimisation des codes d'initialisation.  

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Mise en place
<a name="mise_place_ELTTEXTE000265"></a>


### Les différentes étapes
<a name="les_differentes_etapes_ELTPARAGRAPHE000062"></a>Pour mettre en place les sessions pré-lancées dans un projet WEBDEV : 

1. Activez la détection des erreurs spécifiques aux sessions prélancées. 

2. Corrigez les erreurs en utilisant l'événement "Initialisation du projet après connexion au site". 

3. Activez les sessions prélancées sur le Serveur d'application WEBDEV. 



<a name="NOTE3_2"></a>


### Activer la détection des erreurs spécifiques aux sessions prélancées
<a name="activer_detection_des_erreurs_specifiques_aux_sessions_prelancees_ELTPARAGRAPHE000073"></a>Si votre projet utilise des sessions prélancées, certaines fonctions ne peuvent plus être utilisées lors de l'initialisation du projet. 

Pour connaître les problèmes potentiels lors de l'utilisation des sessions prélancées, il suffit d'activer le mode de détection des erreurs spécifiques aux sessions prélancées : 

1. Affichez si nécessaire le volet "Erreurs de compilation" : sous le volet "Accueil", dans le groupe "Environnement", déroulez "Volets" et sélectionnez "Volets" puis "Erreurs de compilation". 

2. Dans le volet des erreurs de compilation, cliquez sur l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ico_ErreurSession.gif). 

3. La liste des erreurs s'affiche. 




Remarque : L'activation de la détection des erreurs peut également être effectuée depuis la fenêtre de description de la configuration courante : 

1. Sous le volet "Projet", dans le groupe "Configuration de projet", cliquez sur "Configuration courante". 

2. Dans l'onglet "Compatibilité", cochez l'option "Afficher les erreurs de compilation relatives aux sessions prélancées". 

3. Validez. 

4. Dans le volet des erreurs, la liste des erreurs s'affiche.



<a name="NOTE3_3"></a>


### Corriger les erreurs spécifiques aux sessions prélancées
<a name="corriger_les_erreurs_specifiques_aux_sessions_prelancees_ELTPARAGRAPHE000123"></a>Les erreurs des sessions prélancées indiquent les fonctions WLangage interdites dans l'événement "Initialisation" du projet. 

Ces fonctions sont les suivantes : 



|   |   |
| --- | --- |
| [AnnuleContexteAWP](../WDLang2/1000017170.md) | Supprime du contexte AWP une variable ajoutée par la fonction [DéclareContexteAWP](../WDLang2/3058028.md). |
| [AnnuleContexteWebservice](../WDLang3/1000019591.md) | Supprime du contexte du webservice une variable ajoutée par la fonction [DéclareContexteWebservice](../WDLang3/1000019460.md). |
| [ASPAffiche](../WDLang2/3012003.md) | Appelle un script ASP externe et renvoie la page résultat dans la fenêtre en cours du navigateur. |
| [CertificatClientInfo](../WDLang2/1000019393.md) | Renvoie des informations sur le certificat utilisé par le poste client. |
| [ChaîneAffiche](../WDLang2/3012001.md) | Renvoie une chaîne spécifique (ou un buffer) sur le navigateur du client en réponse à la requête reçue. |
| [ConfigureContexteAWP](../WDLang2/1000017066.md) | Configure le mode de fonctionnement du contexte AWP. |
| [Confirmer](../WDLang1/3021007.md) | Affiche un message dans une boîte de dialogue standard proposant les réponses "Oui", "Non", "Annuler" et renvoie la réponse de l'utilisateur. |
| [ContexteFerme](../WDLang2/3058003.md) | Ferme un contexte de page. |
| [ContexteOuvre](../WDLang2/3058004.md) | Ouvre un nouveau contexte de page sans renvoyer les informations vers le navigateur. |
| [CookieLit](../WDLang2/3012009.md) | Récupère la valeur d'un cookie enregistré sur le poste de l'internaute. |
| [DéclareContexteAWP](../WDLang2/3058028.md) | Permet de déclarer une liste de variables dont la valeur sera persistante entre les affichages successifs des pages AWP. |
| [DéclareContexteWebservice](../WDLang3/1000019460.md) | Permet de déclarer une liste de variables dont la valeur sera persistante entre les appels successifs à un Webservice. |
| [ExécuteProcédureDifférée](../WDLang2/1000020682.md) | Exécute une procédure différée (dans le serveur d'application WEBDEV). |
| [FichierAffiche](../WDLang2/3012005.md) | Affiche un fichier sur le navigateur de l'internaute. |
| [FramesetActualise](../WDLang2/3058014.md) | Actualise un frameset affiché dans le navigateur de l'internaute à partir du contexte présent sur le serveur. |
| [FramesetAffiche](../WDLang2/3058006.md) | Affiche un frameset WEBDEV dans le navigateur de l'internaute. |
| [FramesetUtilise](../WDLang2/3058012.md) | Affiche un frameset WEBDEV dans le navigateur de l'internaute et ferme tous les contextes de pages et de framesets en cours. |
| [GglConnecte](../WDLang5/1000017332.md) | Permet de s'authentifier auprès d'un serveur Google (via le mode d'authentification "OAuth 2.0"). |
| [gpwOuvre](../WDLang6/3041002.md) | Ouvre la fenêtre ou la page de login du groupware utilisateur. |
| [IdentifiantContexteAWP](../WDLang2/1000017144.md) | Renvoie l'identifiant du contexte AWP. |
| [ImagePosX](../WDLang2/3045003.md) | Renvoie la position horizontale (X) du curseur de souris par rapport au champ Image considéré. |
| [ImagePosY](../WDLang2/3045001.md) | Renvoie la position verticale (Y) du curseur de souris par rapport au champ Image cliquable considéré. |
| [ImageZone](../WDLang2/3045002.md) | Renvoie le numéro de la zone de l'image cliquée par l'internaute. |
| [LibèreContexteAWP](../WDLang2/1000020429.md) | Libère de manière anticipée le contexte AWP (sur disque) pour permettre à d'autres appels sur le même contexte AWP d'être traités en parallèle. |
| [NavigateurAdresseIP](../WDLang2/3055003.md) | Renvoie l'adresse IP du poste de l'Internaute connecté au site WEBDEV. |
| [NavigateurNom](../WDLang2/3055005.md) | Renvoie le nom du navigateur de l'internaute ("user agent"). |
| [NavigateurPlateforme](../WDLang2/1000019486.md) | Retourne la plateforme du navigateur utilisée par l'internaute. |
| [NavigateurType](../WDLang2/1000019487.md) | Retourne le type du navigateur utilisé par l'internaute. |
| [NavigateurVersion](../WDLang2/1000019488.md) | Retourne la version du navigateur utilisé par l'internaute. |
| [OKAnnuler](../WDLang1/3021004.md) | Affiche un message dans une boîte de dialogue standard proposant les réponses "OK" et "Annuler" et renvoie la réponse de l'utilisateur. |
| [OuiNon](../WDLang1/3021005.md) | Affiche un message dans une boîte de dialogue standard proposant les réponses "Oui" et "Non" et renvoie la réponse de l'utilisateur. |
| [PageActualise](../WDLang2/3058011.md) | Actualise une page affichée dans le navigateur de l'internaute à partir du contexte présent sur le serveur. |
| [PageAffiche](../WDLang2/3058008.md) | Affiche une page du site dans le navigateur de l'internaute. |
| [PageAfficheDialogue](../WDLang2/1000017124.md) | Affiche une page de manière modale. Cette fonction permet de créer un dialogue avec l'utilisateur. La page est affichée devant et en arrière-plan se trouve la page ouvrante, grisée par le mécanisme de GFI. |
| [PageFermeDialogue](../WDLang2/1000017166.md) | Ferme la page courante. Cette page a été ouverte avec la fonction [PageAfficheDialogue](../WDLang2/1000017124.md). Une valeur de retour peut être renvoyée à la page appelante. |
| [PageParamètre](../WDLang2/3058026.md) | Renvoie la valeur d'un paramètre passé à la page en cours. |
| [PageUtilise](../WDLang2/3058016.md) | Affiche une page WEBDEV dans le navigateur de l'internaute et ferme tous les contextes de pages actuellement ouverts sur le serveur. |
| [PHPAffiche](../WDLang2/3012021.md) | Appelle un script PHP externe et renvoie la page résultat dans la fenêtre en cours du navigateur. |
| [rssAffiche](../WDLang5/1000017397.md) | Construit un flux RSS et renvoie le contenu du flux RSS au client. |
| [ScriptAffiche](../WDLang2/3012017.md) | Appelle un script ou une page externe (par exemple .php, .asp, .mhtml ou .mht) et renvoie la page résultat dans la fenêtre en cours du navigateur. |
| [UploadCopieFichier](../WDLang2/3012023.md) | Enregistre sur le serveur un fichier "uploadé" par l'internaute. Cet upload a pu être effectué : <br><br>- via un champ de saisie de type "Upload". <br><br>- via un champ Upload mono ou multi-fichiers.<br><br><br> |
| [UploadNomFichier](../WDLang2/3012022.md) | Renvoie le nom d'un fichier "uploadé" par l'internaute. Cet upload a pu être effectué : <br><br>- via un champ de saisie de type "Upload". <br><br>- via un champ Upload mono ou multi-fichiers.<br><br><br> |
| [WebserviceAdresseIPClient](../WDLang3/1000019641.md) | Renvoie l'adresse IP du poste utilisant et appelant le Webservice. |





Pour gérer les sessions prélancées, deux événements sont associés au projet : 

- l'événement "Initialisation" du projet, exécuté avant l'arrivée de la requête sur le Serveur d'application WEBDEV. Ce code est exécuté lors du lancement de la session prélancée. 

- l'événement "Initialisation du projet après connexion au site", exécuté lorsque le Serveur d'application WEBDEV traite la requête. 




Pour corriger les erreurs spécifiques aux sessions prélancées, il suffit de déplacer le code correspondant dans l'événement "Initialisation du projet après connexion au site". 

Lorsque le site est compatible avec le mécanisme des sessions prélancées, il est possible de le déployer et d'activer les sessions prélancées sur le Serveur d'application WEBDEV. 
<a name="NOTE3_4"></a>


### Activer les sessions prélancées sur le serveur
<a name="activer_les_sessions_prelancees_sur_serveur_ELTPARAGRAPHE000142"></a>Pour activer les sessions prélancées pour un site : 

1. Lancez l'administrateur WEBDEV. 

2. Affichez l'onglet "Configuration". 

3. Cochez l'option "Autoriser les sessions prélancées.". Par défaut, tous les sites et webservices ont un nombre de sessions prélancées égal à 0. 

4. Sélectionnez le site ou le webservice à configurer (onglet "Sites" ou onglet "Webservice"). 

5. Dans les paramètres du site (option "Paramètres" de l'onglet "Sites") ou du Webservice (option "Paramètres" de l'onglet "Webservices"), précisez le nombre de sessions prélancées à utiliser. 

6. Validez. 




Remarques : 

- Les sessions prélancées sont comptées dans le nombre total de connexions au site (ou au Webservice). Cette information doit être prise en compte lors du paramétrage du serveur d'application WEBDEV. 

- Le nombre de sessions prélancées à définir dépend de l'utilisation du serveur et du nombre de requêtes.

	- Quand un utilisateur se connecte (dans le cas d'un site en mode Session) ou affiche une page (cas d'un site AWP), le serveur d'application WEBDEV utilise une session prélancée de cette application s'il en existe une, sinon le serveur d'application WEBDEV lance une session normale (comme si le site n'avait pas de sessions prélancées).

	- Le nombre de sessions prélancées disponibles est vérifié (par site) chaque seconde. Donc le nombre de sessions prélancées dépend du nombre de connexions (cas d'un site en mode Session) ou d'affichages de page (cas d'un site AWP) par seconde.

	- Attention, il faut tenir compte du temps de lancement des sessions prélancées : si une session prend plus de une seconde à se (pré)lancer, le nombre de sessions prélancées effectivement disponible diminue.








