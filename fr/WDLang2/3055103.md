


## AJAX Programmé
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000243"></a>
Le schéma suivant présente l'utilisation de "AJAX programmé" dans un site WEBDEV :
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=AjaxProg.GIF)



|   |   |
| --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=PuceAjax1.gif)<br> | Exécution d'un traitement navigateur (fonction [AJAXExécute](../WDLang2/3055114.md) ou [AJAXExécuteAsynchrone](../WDLang2/3055115.md)). |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=PuceAjax2.gif)<br> | Demande d'exécution d'une procédure serveur. |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=PuceAjax3.gif)<br> | Exécution de la procédure serveur. |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=PuceAjax4.gif)<br> | Génération du résultat. Le résultat de la procédure sera exprimé sous forme d'une chaîne de caractères ou d'un document XML. |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=PuceAjax5.gif)<br> | Envoi du résultat de la procédure (mot-clé [RENVOYER](../Motscles/1510007.md)). |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=PuceAjax6.gif)<br> | Analyse du résultat de la procédure. |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=PuceAjax7.gif)<br> | Affichage des informations modifiées. Seuls les champs nécessaires sont rafraîchis. |



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Fonctions de gestion AJAX
<a name="fonctions_gestion_ajax_ELTTEXTE000267"></a>
Pour gérer les traitements plus complexes, WEBDEV propose plusieurs fonctions AJAX (classées ici par ordre d'intérêt) :


|   |   |
| --- | --- |
| [AJAXAnnuleAppelAsynchrone](../WDLang2/3055110.md) | Annule l'exécution automatique de la procédure navigateur appelée par la fonction [AJAXExécuteAsynchrone](../WDLang2/3055115.md). |
| [AJAXAppelAsynchroneEnCours](../WDLang2/3055111.md) | Permet de savoir si une procédure serveur appelée par la fonction [AJAXExécuteAsynchrone](../WDLang2/3055115.md) est en cours d'exécution. |
| [AJAXDisponible](../WDLang2/3055112.md) | Permet de savoir si la technologie AJAX est utilisable dans le navigateur en cours. |
| [AJAXExécute](../WDLang2/3055114.md) | Exécute une procédure serveur sans rafraîchir la page. Cette fonction est bloquante. Tant que le résultat de la procédure exécutée n'est pas récupéré, aucun autre traitement n'est exécuté. |
| [AJAXExécuteAsynchrone](../WDLang2/3055115.md) | Exécute une procédure serveur sans rafraîchir la page. Cette fonction n'est pas bloquante. Les autres traitements continuent de s'exécuter normalement (que le résultat de la procédure exécutée soit récupéré ou non). |


Grâce à ces fonctions, il est possible d'exécuter une procédure serveur à partir d'un traitement navigateur.

**Attention** : Il est nécessaire d'assurer la cohésion des informations stockées sur le serveur et celles affichées sur le poste des internautes. Par exemple, si des données sont modifiées, il est nécessaire de modifier ces données à la fois sur le serveur et à la fois sur la page affichée dans le navigateur.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Procédures pouvant être appelées par AJAX
<a name="procedures_pouvant_etre_appelees_par_ajax_ELTTEXTE000291"></a>
Par défaut, pour sécuriser les sites WEBDEV, les procédures serveurs sont protégées de tout appel illégal (tentative de détournement de session par exemple). Pour exécuter une procédure serveur à partir d'un traitement navigateur (fonction [AJAXExécute](../WDLang2/3055114.md) ou [AJAXExécuteAsynchrone](../WDLang2/3055115.md)), il est donc nécessaire d'autoriser l'appel de cette procédure par AJAX.

Pour permettre l'appel d'une procédure serveur par AJAX, cliquez simplement sur le terme "AJAX" présent dans le bandeau de la procédure : ![Procédure ne pouvant pas être appelée par AJAX](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=AJAXProcRouge.GIF)
![Procédure pouvant être appelée par AJAX](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=AJAXProcVert.GIF)


<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Fonctions WLangage non utiles en AJAX
<a name="fonctions_wlangage_non_utiles_ajax_ELTTEXTE000315"></a>
Toutes les fonctions disponibles en WEBDEV serveur sont utilisables en AJAX. Cependant, les fonctions suivantes n'ont aucun intérêt en AJAX. Ces fonctions ne sont donc pas disponibles en AJAX.


|   |   |
| --- | --- |
| [ChaîneAffiche](../WDLang2/3012001.md) | Affiche une chaîne de caractères (ou un buffer) dans le navigateur. |
| [ContexteFerme](../WDLang2/3058003.md) | Ferme un contexte de page |
| [ContexteOuvre](../WDLang2/3058004.md) | Ouvre un nouveau contexte de page sans renvoyer les informations vers le navigateur. |
| [FichierAffiche](../WDLang2/3012005.md) | Affiche un fichier sur le navigateur de l'internaute. |
| [FramesetActualise](../WDLang2/3058014.md) | Actualise un frameset affiché dans le navigateur de l'internaute à partir du contexte présent sur le serveur. |
| [FramesetAffiche](../WDLang2/3058006.md) | Affiche un frameset WEBDEV dans le navigateur de l'internaute. |
| [FramesetUtilise](../WDLang2/3058012.md) | Affiche un frameset WEBDEV dans le navigateur de l'internaute et ferme tous les contextes de pages et de frameset en cours. |
| [InitFenêtre](../WDLang1/3038019.md) | Remet à zéro (ou non) les champs de la page en cours et lance les traitements d'initialisation des champs. |
| [PageInitialisation](../WDLang2/3058025.md) | Remet à zéro (ou non) les champs de la page en cours et lance les traitements d'initialisation des champs. |
| [PageUtilise](../WDLang2/3058016.md) | Affiche une page WEBDEV dans le navigateur de l'internaute et ferme tous les contextes de pages en cours. |
| [ScriptAffiche](../WDLang2/3012017.md) | Appelle un script externe (par exemple .php, .asp, .mhtml ou .mht) et renvoie la page résultat dans la fenêtre en cours du navigateur. |
| [UploadCopieFichier](../WDLang2/3012023.md) | Enregistre sur le serveur un fichier "uploadé" par l'internaute. |
| [UploadNomFichier](../WDLang2/3012022.md) | Connaître le nom d'un fichier "uploadé" par l'internaute. |
| [Utilise](../WDLang1/3038044.md) | Affiche une page dans le navigateur de l'internaute. |


Cette liste peut évoluer. Il est conseillé de consulter la documentation de chaque fonction. Le sigle ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=IconeAjax.GIF)
 indique si la fonction est disponible en AJAX ou non.


