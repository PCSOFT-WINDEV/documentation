
## JaugeExécute (Fonction)

***En anglais : ProgressBarExecute***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Lance un traitement navigateur relativement long et fait avancer une jauge via Ajax selon l'avancement de ce traitement.

Dans ce cas, le traitement navigateur est divisé en un ensemble de petits traitements navigateur. L'exécution de chaque petit traitement permet de faire avancer la jauge. 

**Remarque** : Cette fonction peut être utilisée dans un site PHP ou AWP. 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Code navigateur
JaugeExécute(JAUGE_SansNom1, MAJ_Jauge, 0, 100, 10)
```

```wl
// Code navigateur de la procédure appelée par la fonction JaugeExécute
PROCEDURE MAJ_Jauge(nValeur)
// Traitement optionnel permettant de lancer un traitement serveur
AJAXExécute(TraitementServeur)
```
<a name="Exemple2"></a>

```wl
// Code navigateur
tabValeurs est un tableau de 6 chaînes
tabValeurs[1] = "image1.jpg"
tabValeurs[2] = "image2.jpg"
tabValeurs[3] = "image3.jpg"
tabValeurs[4] = "image4.jpg"
tabValeurs[5] = "image5.jpg"
tabValeurs[6] = "image6.jpg"
JaugeExécute(JAUGE_SansNom1, MAJ_Jauge, tabValeurs)
```

```wl
// Code navigateur de la procédure appelée par la fonction JaugeExécute
PROCEDURE MAJ_Jauge(nValeur)
// Traitement optionnel permettant de lancer un traitement serveur
AJAXExécute(TraitementServeur)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Modifier la jauge à l'aide d'une procédure lancée périodiquement

`JaugeExécute(<Champ Jauge> , <Procédure WLangage> , <Borne minimale> , <Borne maximale> [, <Pas>])`
---

**`<Champ Jauge> : (Nom de champ)`**

Nom du champ Jauge à manipuler.

**`<Procédure WLangage> : (Nom de procédure)`**

Procédure WLangage en code navigateur appelée à chaque itération. Cette procédure est de la forme :

```txt
PROCEDURE <Nom de la procédure>(<Valeur>)
```

Le paramètre &lt;Valeur&gt; correspond à la position courante dans l'itération.

**`<Borne minimale> : (Réel)`**

Valeur minimale transmise à la procédure.

**`<Borne maximale> : (Réel)`**

Valeur maximale transmise à la procédure.

**`<Pas> : (Réel optionnel)`**

Pas de modification de la valeur entre chaque appel de la procédure. Par défaut, ce paramètre vaut 1. 


<a name="SYNTAXE2"></a>

### Modifier la jauge à l'aide d'une procédure lancée pour chaque élément d'un tableau

`JaugeExécute(<Champ Jauge> , <Procédure WLangage> , <Tableau>)`
---

**`<Champ Jauge> : (Nom de champ)`**

Nom du champ Jauge à manipuler.

**`<Procédure WLangage> : (Nom de procédure)`**

Procédure WLangage en code navigateur appelée pour chaque élément du tableau. Cette procédure est de la forme :

```txt
PROCEDURE <Nom de la procédure>(<Valeur>)
```

Le paramètre &lt;Valeur&gt; correspond à l'élément courant du tableau. 

**`<Tableau> : (Variable de type Tableau)`**

Nom de la variable de type Tableau contenant les valeurs à transmettre à la procédure WLangage.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Fonctionnement
<a name="fonctionnement_ELTPARAGRAPHE000066"></a>En code navigateur, il n'est pas possible d'avoir un traitement navigateur exécuté en arrière-plan dans le contexte de la page. En effet, tout traitement bloque le rafraîchissement du navigateur et donc empêche le rafraîchissement d'une jauge.

La fonction **JaugeExécute** appelle périodiquement une procédure WLangage navigateur et provoque le rafraîchissement de la jauge entre chaque appel. 

Un traitement long doit donc être découpé en plusieurs étapes. Ces étapes sont appelées une par une par la procédure WLangage navigateur. Si un traitement serveur doit être effectué, il peut être lancé par la fonction [AJAXExécute](../WDLang2/3055114.md) utilisée dans le code de la procédure WLangage navigateur.

La fonction **JaugeExécute** est une fonction asynchrone : elle lance le traitement et se termine immédiatement. Donc au moment du retour de la fonction, le traitement long n'est probablement pas terminé.
<a name="NOTE0_2"></a>


### Equivalences
<a name="equivalences_ELTPARAGRAPHE000088"></a>La fonction **JaugeExécute** est équivalente aux codes suivants : 

Première syntaxe :

```txt
POUR Valeur = <BorneMin> A <BorneMax> PAS <Pas>
	<Procédure>(Valeur)
FIN
```


Seconde syntaxe :

```txt
POUR TOUT Valeur DE <Tableau>
	<Procédure>(Valeur)
FIN
```


**Attention** : Ces codes sont synchrones et ne permettent donc pas le rafraîchissement de la jauge. 



<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
WDJS.DLL
