


## SiteDynamiqueAffiche (Fonction)

***En anglais : DynamicSiteDisplay***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Lance un site dynamique WEBDEV à partir d'une page statique ou dynamique WEBDEV. Le site dynamique à lancer doit se trouver sur le même serveur Web que le site en cours.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Affiche un site dynamique dans le cadre en cours
SiteDynamiqueAffiche("MONSITE")
```
<a name="Exemple2"></a>

```wl
// Affiche un site dans un nouveau navigateur redimensionnable (500x400)
// La fermeture du navigateur pourra être effectuée si le navigateur appelant est fermé
sNomSite est une chaîne = "MONSITE"
SiteDynamiqueAffiche(sNomSite, "", "", NouveauNavigateur, ...
		"NOUVNAV", ONDimension + ONAscenseur, 500, 400, 0, 0, "dependent=1")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`SiteDynamiqueAffiche(<Site> [, <Page> [, <Paramètres HTTP> [, <Destination> [, <Nom de la fenêtre> [, <Options> [, <Largeur> [, <Hauteur> [, <Position horizontale> [, <Position verticale> [, <Paramètres Javascript>]]]]]]]]]])`
---

**`<Site> : (Chaîne de caractères)`**

Nom du site WEBDEV à afficher.

**`<Page> : (Chaîne de caractères optionnelle)`**

Nom de la page à afficher. Si ce paramètre n'est pas spécifié ou correspond à une chaîne vide (""), la première page du site sera affichée.

**`<Paramètres HTTP> : (Chaîne de caractères optionnelle)`**

Paramètres à passer au site dynamique WEBDEV. Ces paramètres pourront être récupérés grâce à la fonction [PageParamètre](../WDLang2/3058026.md). La liste des paramètres doit être de la forme :

```txt
<Nom paramètre1>=<valeur paramètre1> [&<Nom paramètre2>=<valeur paramètre2> [...]>]
```


Par exemple : "param1=1¶m2=texte"
Si aucun paramètre ne doit être passé au site, ce paramètre peut correspondre à une chaîne vide ("").

**`<Destination> : (Chaîne de caractères ou constante optionnelle)`**

Nom de la frame de destination. &lt;Destination&gt; peut également prendre les valeurs suivantes :


|   |   |
| --- | --- |
| *FrameEnCours* | La destination est le cadre en cours (valeur par défaut). <br>Ce paramètre peut également correspondre à la chaîne "_self" (compatibilité avec WEBDEV 1.5). |
| *FrameParent* | La destination est le conteneur de la page en cours (frameset parent, navigateur parent). <br>Ce paramètre peut également correspondre à la chaîne "_parent" (compatibilité avec WEBDEV 1.5). |
| *NavigateurEnCours* | La destination est le navigateur en cours. <br>Ce paramètre peut également correspondre à la chaîne "_top" (compatibilité avec WEBDEV 1.5). |
| *NouveauNavigateur* | La destination est un nouveau navigateur (une nouvelle fenêtre de navigateur est ouverte). Les paramètres suivants de la fonction **SiteDynamiqueAffiche** permettent de configurer cette nouvelle fenêtre. <br>Ce paramètre peut également correspondre à la chaîne "_blank" (compatibilité avec WEBDEV 1.5). |



**`<Nom de la fenêtre> : (Chaîne de caractères optionnelle)`**

Nom de la fenêtre du nouveau navigateur si &lt;Destination&gt; est égal à la constante *NouveauNavigateur*. Ce paramètre permet de réafficher une page dans un navigateur portant le même nom (si plusieurs navigateurs sont ouverts sur le poste de l'internaute).

**`<Options> : (Constante ou combinaison de constantes de type entier (optionnelle))`**

Paramètres de la fenêtre du nouveau navigateur si &lt;Destination&gt; est égal à la constante *NouveauNavigateur* :


|   |   |
| --- | --- |
| *ONAdresse* | La barre d'adresse sera affichée. |
| *ONAscenseur* | Les barres de défilement seront affichées. |
| *ONComplet*<br>(Valeur par défaut) | La fenêtre du nouveau navigateur sera complète (équivalent à la combinaison de toutes les constantes). |
| *ONDimension* | La fenêtre du nouveau navigateur sera redimensionnable. |
| *ONLien* | La barre des liens sera affichée. |
| *ONMenu* | La barre de menu sera affichée. |
| *ONMessage* | La barre de message sera affichée. |
| *ONOutils* | La barre d'outils sera affichée. |
| *ONSimple* | La fenêtre du nouveau navigateur sera minimale (aucune combinaison de constantes). |



**`<Largeur> : (Entier optionnel)`**

Largeur en pixels de la fenêtre du nouveau navigateur.

**`<Hauteur> : (Entier optionnel)`**

Hauteur en pixels de la fenêtre du nouveau navigateur.

**`<Position horizontale> : (Entier optionnel)`**

Position horizontale en pixels de la fenêtre du nouveau navigateur (par rapport au coin haut gauche de l'écran).

**`<Position verticale> : (Entier optionnel)`**

Position verticale en pixels de la fenêtre du nouveau navigateur (par rapport au coin haut gauche de l'écran).

**`<Paramètres Javascript> : (Chaîne de caractères optionnelle)`**

Autres paramètres Javascript à utiliser lors de l'ouverture d'un nouveau navigateur si &lt;Destination&gt; est égal à la constante *NouveauNavigateur*. Par exemple, "dependent = 1" permet de forcer la fermeture du nouveau navigateur si le navigateur en cours est fermé.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Multilingue
<a name="multilingue_ELTPARAGRAPHE000128"></a>La fonction **SiteDynamiqueAffiche** transmet automatiquement la langue en cours de la page courante au site WEBDEV à afficher. Ainsi, si la page courante est en Français (*Nation(5)*), le site WEBDEV sera lancé en Français.
<a name="NOTE0_2"></a>


### Afficher une page différente de la première page du site
<a name="afficher_une_page_differente_premiere_page_site_ELTPARAGRAPHE000138"></a>Le paramètre &lt;Page&gt; peut correspondre à n'importe quelle page du site. Cette page doit avoir l'option "Accessible par la fonction SiteDynamiqueAffiche" cochée dans l'onglet "Général" de la description de la page. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=SiteDynamiqueAffiche.gif)

<a name="NOTE0_3"></a>


### Sécurité : Comment sélectionner la page à afficher
<a name="securite_comment_selectionner_page_afficher_ELTPARAGRAPHE000150"></a>Pour choisir la page du site dynamique à afficher, il est conseillé d'utiliser un mécanisme personnalisé d'identification des pages.

**Pour des questions de sécurité**, il est en effet déconseillé de passer directement le nom de la page à afficher en paramètre à la fonction **SiteDynamiqueAffiche**. Utilisez plutôt un identifiant numérique.

Exemple : Dans un code de clic navigateur d'une page :

```wl
SiteDynamiqueAffiche("Site", "", "Param=1")
```


Dans le code d'initialisation du site "Site" : 

```wl
// Récupère le numéro de la page à afficher
NuméroPage est un entier = PageParamètre("Param")
// selon le numéro de page
SELON NuméroPage
	CAS 1 : PageAffiche(PageAAfficher)
FIN

// Si on n'a pas précisé de page par défaut, 
// on laisse s'afficher la première page du projet
```

<a name="NOTE0_4"></a>


### Choisir la destination
<a name="choisir_destination_ELTPARAGRAPHE000168"></a>Pour choisir la destination du fichier, il est conseillé d'utiliser le paramètre &lt;Destination&gt; de la fonction **SiteDynamiqueAffiche** plutôt que la fonction [ChangeDestination](../WDLang2/3058005.md). En effet, dans ce cas, le code Javascript correspondant est plus petit et donc la taille de vos pages est optimisée.
<a name="NOTE0_5"></a>


### Attention
<a name="attention_ELTPARAGRAPHE000181"></a>Bien que la fonction **SiteDynamiqueAffiche** soit une fonction utilisée en code Navigateur, son appel déclenche un retour au serveur. Il est donc déconseillé d'utiliser cette fonction depuis un bouton de type "Submit" ayant un code Serveur. 
<a name="NOTE0_6"></a>


### Comment depuis une page AWP passer des paramètres à une page dynamique (en mode Session) WEBDEV ?
<a name="comment_depuis_une_page_awp_passer_des_parametres_une_page_dynamique_mode_session_webdev_ELTPARAGRAPHE000191"></a>La page dynamique (en mode Session) doit avoir l'option "Accessible par la fonction SiteDynamiqueAffiche" activée dans le volet "Général" de la description de cette page.
Une autre page de type AWP possède un champ Bouton ayant l'option "Lors de l'action" qui correspond à "Ne rien envoyer au serveur".

Voici un exemple de code de ce bouton :

```wl
sParametres est une chaîne
sParametres = "P1=" + LIB_P1 + "&P2=" + LIB_P2 + "&P3=" + LIB_P3
SiteDynamiqueAffiche("MONSITE", "MAPAGE", sParametres, NouveauNavigateur)
```
Voici un exemple de récupération de ces paramètres dans le code de déclaration de globale de la page dynamique :

```wl
nParam1 est un entier = PageParamètre("P1")
bParam2 est un booléen = PageParamètre("P2")
sParam2 est une chaîne = PageParamètre("P3")
```


<a name="XComposante"></a>

## Composante :
WDJS.DLL
