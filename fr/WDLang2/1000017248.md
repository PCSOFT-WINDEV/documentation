


## ZoneRépétéeDéplaceLigne (Fonction)

***En anglais : LooperMoveLine***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Déplace une répétition ou échange deux répétitions d'un champ Zone répétée. 










<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Echange la répétition en cours et la répétition 5
ZoneRépétéeDéplaceLigne(ZR_ZoneRépétée1, ligneSélectionnée, 5, tdEchange)
// Déplace la répétition en cours à la répétition 3
ZoneRépétéeDéplaceLigne(ZR_ZoneRépétée1, ligneSélectionnée, 3, tdDéplace)
// Echange la ligne en cours avec la ligne suivante
ZoneRépétéeDéplaceLigne(ZR_ZoneRépétée1, ligneSélectionnée, ...
	tdSuivant, tdEchange)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Déplacement à une position spécifique

`<Résultat> = ZoneRépétéeDéplaceLigne(<Champ Zone répétée> , <Indice de la répétition à déplacer> , <Indice de la répétition destination> [, <Opération à effectuer>])`
---

**`<Résultat> : (Entier)`**

Nouvel indice de la répétition déplacée.

**`<Champ Zone répétée> : (Nom de champ)`**

Nom du champ Zone répétée à manipuler.
Si ce paramètre correspond à une chaîne vide (""), le champ manipulé est le champ Zone répétée auquel le traitement en cours appartient.

**`<Indice de la répétition à déplacer> : (Entier)`**

Position de la répétition à déplacer. Cette position doit être comprise entre 1 et le nombre de répétitions du champ (connu par exemple par la fonction [ZoneRépétéeOccurrence](../WDLang2/3083014.md) ou la propriété [Occurrence](../Proprietes/2510097.md)).

Pour déplacer la répétition actuellement sélectionnée, utilisez la constante *ligneSélectionnée*.

**`<Indice de la répétition destination> : (Entier)`**

Nouvelle position de la répétition. Cette position doit être comprise entre 1 et le nombre de répétitions du champ (connu par exemple par la fonction [ZoneRépétéeOccurrence](../WDLang2/3083014.md) ou la propriété [Occurrence](../Proprietes/2510097.md)). Si ce paramètre n'est pas valide, une erreur fatale est générée.

Pour manipuler la répétition actuellement sélectionnée, utilisez la constante *ligneSélectionnée*.

**`<Opération à effectuer> : (Constante ou combinaison de constantes optionnelle de type Entier)`**

Changement de position de la répétition à effectuer :


|   |   |
| --- | --- |
| *tdAfficheDestination* | La répétition modifiée est affichée dans le champ Zone répétée. Si nécessaire, un défilement automatique des répétitions est effectué pour afficher la répétition modifiée. La répétition sélectionnée (bandeau de sélection) n'est pas modifiée.<br>Cette constante peut être combinée avec les constantes *tdDéplace*et *tdEchange*. |
| *tdDéplace*<br>(valeur par défaut) | La répétition est déplacée vers l'indice de la répétition destination. |
| *tdEchange* | La répétition source et la répétition destination sont échangées. |




<a name="SYNTAXE2"></a>

### Déplacement relatif à la position en cours

`<Résultat> = ZoneRépétéeDéplaceLigne(<Champ Zone répétée> , <Indice de la répétition à déplacer> , <Déplacement relatif> [, <Opération à effectuer>])`
---

**`<Résultat> : (Entier)`**

Nouvel indice de la répétition déplacée.

**`<Champ Zone répétée> : (Nom de champ)`**

Nom du champ Zone répétée à manipuler.
Si ce paramètre correspond à une chaîne vide (""), le champ manipulé est le champ Zone répétée auquel le traitement en cours appartient.

**`<Indice de la répétition à déplacer> : (Entier)`**

Position de la répétition à déplacer. Cette position doit être comprise entre 1 et le nombre de répétitions du champ (connu par exemple par la fonction [ZoneRépétéeOccurrence](../WDLang2/3083014.md) ou la propriété [Occurrence](../Proprietes/2510097.md)).

Pour déplacer la répétition actuellement sélectionnée, utilisez la constante *ligneSélectionnée*.

**`<Déplacement relatif> : (Constante de type Entier)`**

Permet de réaliser un déplacement ou un échange sur une position relative à l'indice de la répétition à déplacer.


|   |   |
| --- | --- |
| *tdDernier* | Déplace la répétition en dernière position. |
| *tdPagePrécédente* | Déplace la répétition d'une page vers le haut (une page correspond aux nombre de répétitions pouvant être affichées simultanément dans le champ Zone répétée). |
| *tdPageSuivante* | Déplace la répétition d'une page vers le bas (une page correspond aux nombre de répétitions pouvant être affichées simultanément dans le champ Zone répétée). |
| *tdPrécédent* | Déplace la répétition d'une position vers le haut. |
| *tdPremier* | Déplace la répétition en première position. |
| *tdSuivant* | Déplace la répétition d'une position vers le bas. |


Si ce paramètre est invalide (par exemple utilisation de *tdPrécédent* sur la première répétition du champ Zone répétée), la répétition est déplacée "au plus proche" de la position demandée.

**`<Opération à effectuer> : (Constante ou combinaison de constantes optionnelle de type Entier)`**

Changement de position de la répétition à effectuer :


|   |   |
| --- | --- |
| *tdAfficheDestination* | La répétition modifiée est affichée. Si nécessaire, un défilement automatique des répétitions est effectué pour afficher la répétition modifiée. La répétition sélectionnée (bandeau de sélection) n'est pas modifiée.<br>Cette constante peut être combinée avec les constantes *tdDéplace*et *tdEchange*. |
| *tdDéplace*<br>(valeur par défaut) | La répétition est déplacée vers l'indice de la répétition destination. |
| *tdEchange* | La répétition source et la répétition destination sont échangées. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000229"></a>La fonction **ZoneRépétéeDéplaceLigne** peut être utilisée indifféremment sur : 

- un champ Zone répétée fichier chargé en mémoire,

- un champ Zone répétée par programmation. 



<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 

### Zone répétée multisélection
<a name="zone_repetee_multiselection_ELTPARAGRAPHE000253"></a>Si la fonction **ZoneRépétéeDéplaceLigne** est utilisée sur un champ Zone répétée multisélection :

- lors du déplacement de répétitions/lignes (constante *tdDéplace*) : toutes les répétitions/lignes sélectionnées seront déplacées.

- lors d'un échange de répétitions/lignes (constante *tdEchange*) : seule la première répétiton/ligne sélectionnée sera échangée.

- la constante *ligneSélectionnée* ne peut pas être utilisée. Dans le cas contraire, une erreur fatale est affichée et aucune répétition ne sera déplacée.



<a name="NOTE0 3"></a>


### Gestion des erreurs
<a name="gestion_des_erreurs_ELTPARAGRAPHE000269"></a>**Attention** : La fonction **ZoneRépétéeDéplaceLigne** ne retourne pas de code d'erreur. Pour savoir si cette fonction a généré une erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md) avec la constante *errMessage*.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
