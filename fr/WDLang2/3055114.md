
## AJAXExécute (Fonction)

***En anglais : AJAXExecute***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Exécute une procédure serveur sans rafraîchir la page. Cette fonction est bloquante. Tant que le résultat de la procédure exécutée n'est pas récupéré, aucun autre traitement n'est exécuté.

Pour éviter de bloquer les traitements, utilisez la fonction [AJAXExécuteAsynchrone](../WDLang2/3055115.md).




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple
<a class="notetitle" target="_blank" href="$DOC$=3055118&name=ajaxexecute_fonction&product=WD">Voir des exemples supplémentaires</a>

```wl
// AJAX supporté sur le navigateur en cours ?
SI AJAXDisponible() = Vrai ALORS
	// Exécution de la procédure serveur "MaProc"
	Res est une chaîne
	Res = AJAXExécute(MaProc, IDProduit, VilleClient)
	// Utilisation des données à modifier 
	...
SINON
	// Traitements sans utilisation de AJAX 
	... 
FIN
```

```wl
// -- Procédure serveur MaProc // --
// Procédure permettant de rechercher les données à modifier dans la page 
PROCEDURE MaProc(RefProd, CVille)
// Recherche des données à modifier
...
// Renvoi du résultat
RENVOYER Résultat1
```



<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = AJAXExécute([<Options>, ] <Procédure WLangage> [, <Paramètre 1> [... [, <Paramètre N>]]])`
---

**`<Résultat> : (Chaîne de caractères)`**

Résultat de la procédure &lt;Procédure WLangage&gt;. Ce résultat contient les données à modifier dans la page.

**`<Options> : (Constante ou combinaison de constantes de type Entier)`**

Mode de réactualisation : 


|   |   |
| --- | --- |
| *ajaxActualiseChamps* | Les champs modifiés sont automatiquement actualisés dans la page. |
| *ajaxAppelSimple*<br>(valeur par défaut) | Les champs modifiés ne sont pas actualisés dans la page. |
| *ajaxEnvoieValeurChamps* | La valeur de tous les champs de la page doit être envoyée au serveur. La procédure WLangage utilisera ainsi la valeur des champs en cours de saisie dans le navigateur. |
| *ajaxSansBloquerContexteAWP* | L'appel Ajax ne va pas utiliser le contexte AWP et donc il ne va pas bloquer ce contexte. Permet de paralléliser les appels Ajax sur le serveur. <br><br>Attention : Cette constante n'a pas d'effet en GO de page ou de projet. |
| *ajaxSynchroniseVariablesServeur* | L'appel Ajax va transmettre les variables ayant l'attribut &lt;Synchronisé navigateur&gt;. |


Attention : ces constantes doivent être utilisées directement (il n'est pas possible d'utiliser une variable pour stocker leur valeur). 

**`<Procédure WLangage> : (Nom de procédure)`**

Nom de la procédure serveur à exécuter (procédure globale ou locale). Cette procédure permet de rechercher les données à modifier dans la page.
Le résultat de cette procédure doit être une chaîne de caractères renvoyée au navigateur grâce au mot-clé [RENVOYER](../Motscles/1510007.md). Pour plus de détails, consultez [les remarques](#NOTE0_1).
Cette procédure doit être autorisée à être appelée par AJAX (voir les Notes).

**`<Paramètre 1> : (Chaîne de caractères optionnelle)`**

Premier paramètre passé à la procédure &lt;Nom de la procédure&gt;.
Attention : Seuls les types simples sont utilisables (chaîne de caractères, entier, ...). Les types structurés ne peuvent pas être utilisés.



**`<Paramètre N> : (Chaîne de caractères optionnelle)`**

Nième paramètre passé à la procédure &lt;Nom de la procédure&gt;.
Attention : Seuls les types simples sont utilisables (chaîne de caractères, entier, ...). Les types structurés ne peuvent pas être utilisés.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Résultat de la procédure serveur
<a name="resultat_procedure_serveur_ELTPARAGRAPHE000098"></a>La procédure serveur &lt;Procédure WLangage&gt; permet de rechercher les données à modifier dans la page. Le résultat de cette procédure correspond aux données à modifier.

Pour renvoyer ce résultat au navigateur, il suffit d'utiliser le mot-clé [RENVOYER](../Motscles/1510007.md) en spécifiant :

- soit la chaîne de caractères contenant les données.

- soit le nom du document XML contenant les données.




Ce résultat sera automatiquement contenu dans le paramètre &lt;Résultat&gt; de la fonction **AJAXExécute**. Il suffit ensuite de gérer ce résultat pour rafraîchir les données à modifier.

Si ce résultat correspond au nom d'un document XML, ce document sera automatiquement transmis et créé sur le navigateur. Ce document pourra alors être manipulé grâce aux [fonctions XML](../WDLang5/3081005.md).

**Remarque** : Dans le cas d'utilisation d'un document XML :

- le document XML n'est pas détruit automatiquement sur le serveur lors de sa transmission au navigateur.

- si un document XML du même nom existe déjà sur le navigateur, le nouveau document XML le remplace automatiquement.





<a name="NOTE0_2"></a>


### Procédures pouvant être appelées par AJAX
<a name="procedures_pouvant_etre_appelees_par_ajax_ELTPARAGRAPHE000129"></a>Par défaut, pour sécuriser les sites WEBDEV, les procédures serveurs sont protégées de tout appel illégal (tentative de détournement de session par exemple). Pour exécuter une procédure serveur à partir d'un traitement navigateur (fonction **AJAXExécute** ou [AJAXExécuteAsynchrone](../WDLang2/3055115.md)), il est donc nécessaire d'autoriser l'appel de cette procédure par AJAX.

Pour permettre l'appel d'une procédure serveur par AJAX, cliquez simplement sur le terme "AJAX" dans le bandeau de la procédure :
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=AJAXProcRouge.GIF)
Procédure ne pouvant pas être appelée par AJAX
<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=AJAXProcVert.GIF)
Procédure pouvant être appelée par AJAX


<a name="NOTE0_3"></a>


### Anciens navigateurs
<a name="anciens_navigateurs_ELTPARAGRAPHE000155"></a>La fonction [AJAXDisponible](../WDLang2/3055112.md) permet de savoir si le navigateur en cours supporte la technologie AJAX. Si un traitement utilisant la technologie AJAX est exécuté sur un navigateur ne supportant pas cette technologie, le traitement s'exécute "comme si" il n'utilisait pas la technologie AJAX (rafraîchissement de la page entière par exemple).

<a name="XComposante"></a>

## Classification Métier / UI :
Code neutre
## Composante :
WDJS.DLL
