


## &lt;Zone répétée&gt;.VersExcel (Fonction)

***En anglais : &lt;Looper&gt;.ToExcel***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Crée un fichier Excel avec les données d'un champ Zone répétée (champ Zone répétée fichier ou champ Zone répétée mémoire).

**Remarque** : Ce fichier pourra être ouvert sous Excel ou sous OpenOffice Calc (selon le logiciel installé sur le poste en cours).




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple

![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
```wl
sFic est une chaîne
// Nom du fichier
sFic = fSélecteur("", "", "Choisissez le fichier d'exportation", ...
	"Fichiers Excel (*.xls) *.xls", "xls", fSelCrée + fSelExiste)
// Si le nom n'a pas été fourni, on abandonne l'export
// Sinon, on exporte le contenu du champ Zone répétée ZR_Client
SI sFic <> "" ALORS 
	ZR_Client.VersExcel(sFic)
FIN
```
<a name="Exemple2"></a>

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = <Champ Zone répétée>.VersExcel(<Nom du fichier XLS> [, <Options> [, <Répétition début> [, <Répétition fin>]]])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si le fichier a été créé, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire. Pour obtenir plus de détails sur l'erreur, utilisez la fonction [ErreurInfo](../WDLang1/3013008.md).




**`<Champ Zone répétée> : (Nom de champ)`**

Nom du champ Zone répétée à manipuler.

**`<Nom du fichier XLS> : (Chaîne de caractères)`**

Nom et chemin complet du fichier Excel à créer. Si le fichier existe déjà, il est remplacé par le nouveau fichier.

**`<Options> : (Constante optionnelle de type Entier)`**

Paramètre le fichier XLS à créer.


|   |   |
| --- | --- |
| *taAvecMiseEnForme* | Exporte la couleur et la police utilisées dans le champ. |
| *taFusion* | Si le fichier XLS existe déjà, fusionne le contenu existant avec le nouveau contenu : les formules, la mise en forme, ... des cellules existantes est conservée. Les données existantes ne sont pas conservées. Seules les données des colonnes et des lignes présentes en plus dans le fichier XLS sont conservées. |
| *taLigneSélectionnées* | Exporte uniquement les répétitions sélectionnées (par défaut, toutes les répétitions sont exportées). |
| *taSansTitre* | Seules les données sont copiées dans le fichier. Le nom des attributs n'est pas indiqué en titre de colonnes dans le fichier Excel. |
| *taTitreColonnes*<br>(valeur par défaut) | Le nom des attributs est utilisé dans le fichier Excel comme titre des colonnes. |



**`<Répétition début> : (Entier optionnel)`**

Numéro de la répétition de début de l'exportation. 
Si ce paramètre n'est pas précisé, la répétition de début est la première répétition du champ Zone répétée.

**`<Répétition fin> : (Entier optionnel)`**

Numéro de la répétition de fin de l'exportation. 
Si ce paramètre n'est pas précisé, la répétition de fin est la dernière répétition du champ Zone répétée.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Les fichiers Excel sont limités à 65536 lignes et 256 colonnes (soit 65536 répétitions contenant chacune 256 champs). Cette limite peut être dépassée en utilisant l'extension ".xlsx" afin de créer des fichiers au format Excel 2007. Attention : dans ce cas, les anciennes versions de Excel devront être équipées du "Pack de compatibilité Office 2007", téléchargeable gratuitement sur le site de Microsoft afin de pouvoir ouvrir les documents générés.

- Seuls les 256 premiers caractères de chaque champ sont exportés.

- Le fichier créé pourra être ouvert avec Excel version 97 ou supérieure, ou avec OpenOffice Calc version 2 ou supérieure.

- Les colonnes de type "Numérique Haute Précision" (38 chiffres significatifs) seront exportées sous forme de nombre exponentiel.

- Les colonnes au format Unicode sont exportées au format Unicode dans Excel.

- Les colonnes de type Interrupteur sont exportées sous forme de cases à cocher.

- Les éléments suivants ne sont pas exportés dans le fichier Excel : 

	- Les images, 

	- Les graphes, 

	- Les codes-barres.







<a name="XComposante"></a>

## Composante :
wd280xls.dll
