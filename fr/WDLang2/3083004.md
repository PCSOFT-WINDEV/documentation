


## ZoneRépétéeAjouteLigne (Fonction)

***En anglais : LooperAddLine***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute une répétition à la fin d'un champ Zone répétée. Les attributs de la répétition ajoutée peuvent contenir des tabulations.










<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Initialisation du champ Zone répétée ZR_REPETE1 
ZoneRépétéeSupprimetout(ZR_REPETE1) 
HLitPremier(Produit, NomProd) 
TANTQUE HEnDehors(Produit) = Faux
	ZoneRépétéeAjouteLigne(ZR_REPETE1, Produit.NomProd, Produit.Code) 
	HLitSuivant(Produit, NomProd) 
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE2"></a>

## Syntaxe

### Ajouter un répétition dans un champ Zone répétée avec attributs

`<Résultat> = ZoneRépétéeAjouteLigne(<Champ Zone répétée> [, <Valeur 1> [... [, <Valeur N>]]])`
---

**`<Résultat> : (Entier)`**



- Numéro de la répétition ajoutée, 

- 0 en cas d'erreur.




**`<Champ Zone répétée> : (Nom de champ)`**

Nom du champ Zone répétée à manipuler.
Si ce paramètre est égal à chaîne vide (""), l'ajout sera effectué dans le champ Zone répétée en cours.

**`<Valeur 1> : (Type de l'attribut associé (optionnel))`**

Valeur du 1er attribut de la nouvelle répétition. 
Les différentes valeurs doivent être indiquées dans l'ordre des attributs (fenêtre de description du champ Zone répétée).
Pour ne pas spécifier de valeur pour un des attributs, utilisez une chaîne vide ("") ou 0 (selon le type de l'attribut).
Si aucun des ces paramètres n'est spécifié, une répétition vide sera ajoutée.



**`<Valeur N> : (Type de l'attribut associé (optionnel))`**

Valeur du Nième attribut de la nouvelle répétition. 
Les différentes valeurs doivent être indiquées dans l'ordre des attributs (fenêtre de description du champ Zone répétée).
Pour ne pas spécifier de valeur pour un des attributs, utilisez une chaîne vide ("") ou 0 (selon le type de l'attribut).
Si aucun des ces paramètres n'est spécifié, une répétition vide sera ajoutée.


<a name="SYNTAXE3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Ajouter un répétition dans un champ Zone répétée sans attributs

`<Résultat> = ZoneRépétéeAjouteLigne(<Champ Zone répétée>)`
---

**`<Résultat> : (Entier)`**

Numéro de la répétition ajoutée.

**`<Champ Zone répétée> : (Nom de champ)`**

Nom du champ Zone répétée à manipuler.
Si ce paramètre est égal à chaîne vide (""), l'ajout sera effectué dans le champ Zone répétée en cours.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000142"></a>La fonction **ZoneRépétéeAjouteLigne** peut être utilisée indifféremment sur : 

- un champ Zone répétée fichier,

- un champ Zone répétée par programmation. 



<a name="NOTE0_2"></a>


### Ajout d'une répétition vide
<a name="ajout_une_repetition_vide_ELTPARAGRAPHE000157"></a>Après l'ajout d'une répétition vide, il est nécessaire d'initialiser chaque attribut ou chaque champ un à un.

Par exemple :
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cas d'un champ Zone répétée avec attributs :

```wl
// Ajout d'une répétition vide
Indice = ZoneRépétéeAjouteLigne(ZR_Zone1)

// Puis initialisation des attributs
ATT_AttributNom[Indice] = "Hobbes"
ATT_AttributPrénom[Indice] = "Samantha"
ATT_AttributCouleurPrénom[Indice] = RougeClair
ATT_AttributVisibleAdresse[Indice] = Faux
```


![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Cas d'un champ Zone répétée sans attributs :

```wl
// Ajout d'une répétition vide
Indice = ZoneRépétéeAjouteLigne(ZR_Zone1)

// Puis initialisation des champs
ZR_Zone1[Indice].ChampNom = "Hobbes"
ZR_Zone1[Indice].ChampPrénom = "Samantha"
ZR_Zone1[Indice].ChampPrénom.CouleurFond = RougeClair
ZR_Zone1[Indice].ChampAdresse.Visible = Faux
```

<a name="NOTE0_3"></a>


### Caractéristiques de la répétition
<a name="caracteristiques_repetition_ELTPARAGRAPHE000189"></a>

- Si une valeur correspond au résultat d'un calcul, mettez l'expression numérique entre parenthèses. 
	Par exemple :
	
	```wl
	ZoneRépétéeAjouteLigne(ZR_ZoneCalcul, (53+29), (83-21))
	```


- Les attributs de formatage (couleur par exemple)  qui ne sont pas renseignés dans le code d'affichage de la répétition (ou ligne) sont automatiquement ré-initialisés.



<a name="NOTE0_4"></a>


### Position de la répétition ajoutée
<a name="position_repetition_ajoutee_ELTPARAGRAPHE000208"></a>Par défaut, la répétition est ajoutée à la fin du champ Zone répétée.

Si le champ Zone répétée est trié (fonction [ZoneRépétéeTrie](../WDLang2/3083009.md)), la répétition ajoutée est positionnée dans le champ Zone répétée en fonction du tri en cours.
<a name="NOTE0_5"></a>

<a name="XComposante"></a>

## Composante :
wd280obj.dll
