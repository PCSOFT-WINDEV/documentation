


## PopupAffichePage (Fonction)

***En anglais : PopupDisplayPage***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Affiche une page WEBDEV comme une popup dans la page courante avec un effet de GFI (Grisage des Fenêtres Inaccessibles). Cette fonction permet de simuler simplement une boite de dialogue en code navigateur.

**Remarque** : Pour afficher une page Popup, la fonction **PopupAffichePage** peut être utilisée : 

- soit dans le code d'un champ Bouton de type "Exécuter le code de clic navigateur uniquement". Dans ce cas, seul le code navigateur du champ Bouton sera exécuté. 

- soit dans le code d'un champ Bouton de type "Exécuter les codes serveur et navigateur" (avec envoi des valeurs au serveur). AJAX doit être activé dans le code de ce champ Bouton. Dans ce cas, les codes navigateur et serveur du champ seront exécutés.



<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Affiche la page PAGE_DétailsProduit en popup
PopupAffichePage(PAGE_DétailsProduit, (nIDProduit), popupCentre)
```



<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Afficher une page Popup à une position spécifique

`PopupAffichePage(<Page> [, <Paramètres> [, <Options d'affichage> [, <X> [, <Y>]]]])`
---

**`<Page> : (Nom de page)`**

Nom de la page à afficher.

**`<Paramètres> : (Liste de valeurs entre parenthèses et séparées par des virgules)`**

Paramètres de la page à afficher. Cette liste de paramètres est de la forme : 

```txt
(<Paramètre 1>, ..., <Paramètre N>)
```
où : 

- &lt;Paramètre 1&gt; : Premier paramètre de la page.

- ...

- &lt;Paramètre N&gt; : Nième paramètre de la page.




**Attention** : 

- Les paramètres sont passés par valeur. 

- Dans le cas d'un appel en code navigateur, les valeurs sont converties en chaînes lors de la transmission au serveur. Il est donc conseillé d'utiliser uniquement des paramètres de type simple (booléen, chaîne, entier, ...). 




**`<Options d'affichage> : (Constante optionnelle de type Entier)`**

Options d'affichage de la popup : 


|   |   |
| --- | --- |
| *popupAnnulable* | La page Popup est volatile : la popup peut être fermée via la touche ESC ou lors d'un clic hors de la popup. <br>Cette constante peut être combinée avec une des autres constantes de positionnement de la popup. |
| *popupBasCentre* | La page Popup est placée en bas au centre de la partie visible de la page courante. |
| *popupBasDroite* | La page Popup est placée en bas à droite de la partie visible de la page courante. |
| *popupBasGauche* | La page Popup est placée en bas à gauche de la partie visible de la page courante. |
| *popupCentre*<br>(Valeur par défaut) | La page Popup est centrée dans la partie visible de la page courante. |
| *popupCentreDroite* | La page Popup est placée au centre à droite de la partie visible de la page courante. |
| *popupCentreGauche* | La page Popup est placée au centre à gauche de la partie visible de la page courante. |
| *popupEpinglée* | La page Popup est épinglée à la position indiquée : la Popup ne changera pas de position si la page est scrollée ou si la taille du navigateur est modifiée. <br>Cette constante peut être combinée avec une des autres constantes de positionnement de la Popup (à l'exclusion de popupPositionXY et popupSourisXY). |
| *popupHautCentre* | La page Popup est placée en haut au centre de la partie visible de la page courante. |
| *popupHautDroite* | La page Popup est placée en haut à droite de la partie visible de la page courante. |
| *popupHautGauche* | La page Popup est placée en haut à gauche de la partie visible de la page courante. |
| *popupPositionXY* | La page Popup sera ouverte aux positions X et Y indiquées. |
| *popupSourisXY* | La page Popup sera ouverte à la position de la souris. Cette constante ne peut être utilisée que dans un événement navigateur (d'un champ ou d'une page). Cette constante ne peut pas être utilisée :<br><br>- dans les procédures navigateur.<br><br>- dans les événements appelés directement ou indirectement depuis une procédure navigateur (par l'intermédiaire de la fonction [ExécuteTraitement](../WDLang1/3013031.md) par exemple).<br><br>- dans le code navigateur d'un champ Bouton ou d'un champ Lien.<br><br><br> |



**`<X> : (Entier optionnel)`**

Si la constante *popupPositionXY* est utilisée, indique la position X d'affichage du champ Popup (par rapport au coin en haut à gauche de page). Ce paramètre est exprimé en pixels. 

**`<Y> : (Entier optionnel)`**

Si la constante *popupPositionXY* est utilisée, donne la position Y d'affichage de la popup (par rapport au coin en haut à gauche du champ). Ce paramètre est exprimé en pixels. 


<a name="SYNTAXE2"></a>

<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- La page affichée est ouverte sur le serveur. 

- La page affichée pourra être masquée avec la fonction [PopupFermePage](../WDLang2/1410087259.md).

- Les navigateurs ne rafraîchissent pas l'affichage au milieu d'un code Javascript : les fonctions **PopupAffichePage** et [PopupFermePage](../WDLang2/1410087259.md) doivent être utilisées dans des événements/traitements différents. Si ces fonctions sont utilisées dans le même événement/traitement, la page n'est pas affichée.

- Il n'est pas possible d'afficher deux pages différentes en popup en même temps avec la fonction **PopupAffichePage**. 

- Le GFI peut se désactiver et se personnaliser par programmation avec les fonctions [PageActiveGFI](../WDLang2/1000017087.md) et [PageTauxGFI](../WDLang2/1000017086.md). 

- Les traitements AJAX de la page affichée par la fonction **PopupAffichePage** peuvent mettre à jour uniquement les champs de cette même page. Pour actualiser le contenu de champs de la page qui fait l'appel de la fonction **PopupAffichePage**, il est possible de :

	1. créer une procédure navigateur dans la page qui fait l'appel de la fonction **PopupAffichePage**. La procédure prendra en paramètres les nouvelles données, afin de les affecter dans les champs de la page.

	2. appeler cette procédure navigateur depuis les traitements de la page affichée par la fonction **PopupAffichePage** en passant les nouvelles valeurs en paramètres.







<a name="XComposante"></a>

## Composante :
wd280page.dll
