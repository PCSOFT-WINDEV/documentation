


## ZoneRépétéeInsère (Fonction)

***En anglais : LooperInsert***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Insère une répétition dans un champ Zone répétée.

**Remarque** : Il est conseillé d'utiliser la fonction [ZoneRépétéeInsèreLigne](../WDLang2/3083002.md). En effet, la fonction [ZoneRépétéeInsèreLigne](../WDLang2/3083002.md) permet d'insérer :

- des caractères TAB dans les attributs / champs.

- des valeurs de n'importe quel type dans les attributs / champs.




![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png) Pour les champs Zone répétée sans attributs, il est conseillé d'utiliser la fonction [ZoneRépétéeInsèreLigne](../WDLang2/3083002.md).








<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Initialisation du champ Zone répétée ZR_REPETE1
ZoneRépétéeSupprimeTout(ZR_REPETE1)
HLitPremier(Produit, NomProd)
TANTQUE HEnDehors() = Faux
	ZoneRépétéeInsère(ZR_REPETE1, Produit.NomProd + TAB + Produit.Code)
	HLitSuivant(Produit, NomProd)
FIN
```
<a name="Exemple2"></a>

```wl
// Ajout de valeurs dans le champ Zone répétée en 12ème position
ZoneRépétéeInsère(ZR_Zone1, Nom+ TAB + Prénom + TAB + NumTel + TAB + NumFax, 12)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ZoneRépétéeInsère(<Champ Zone répétée> , <Valeur> [, <Indice>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'ajout a réussi, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Champ Zone répétée> : (Nom de champ)`**

Nom du champ Zone répétée à manipuler.
Si ce paramètre est égal à chaîne vide (""), l'ajout sera effectué dans le champ Zone répétée en cours.

**`<Valeur> : (Chaîne de caractères)`**

Liste des valeurs à insérer dans la nouvelle répétition. Ce paramètre doit être de la forme :

```txt
<Valeur 1> + TAB + ... + <Valeur N>
```

Les différentes valeurs doivent être indiquées dans l'ordre des attributs (fenêtre de description du champ Zone répétée).
Pour ne pas spécifier de valeur pour un attribut, utilisez une chaîne vide ("") ou 0 (selon le type de l'attribut).

**`<Indice> : (Entier optionnel)`**

Indice de la répétition à partir duquel la répétition sera insérée.

- Si ce paramètre n'est pas précisé ou égal à -1, l'insertion sera effectuée avant la répétition en cours. Si aucune répétition n'est sélectionnée, l'insertion sera effectuée à la fin du champ Zone répétée.

- Si &lt;Indice&gt; est supérieur au nombre de répétitions, l'insertion sera effectuée à la fin du champ Zone répétée. Dans ce cas, la fonction **ZoneRépétéeInsère** est équivalente à la fonction [ZoneRépétéeAjoute](../WDLang2/3083006.md).

- Si ce paramètre est égal à 0, l'insertion sera effectuée au début du champ Zone répétée.  






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000150"></a>La fonction **ZoneRépétéeInsère** peut être utilisée indifféremment sur : 

- un champ Zone répétée fichier,

- un champ Zone répétée par programmation. 



<a name="NOTE0_2"></a>


### Caractéristiques de la répétition
<a name="caracteristiques_repetition_ELTPARAGRAPHE000165"></a>Si une valeur correspond au résultat d'un calcul, mettez l'expression numérique entre parenthèses. Par exemple :

```wl
ZoneRépétéeInsère(ZR_ZoneCalcul, (53+29) + TAB + (83-21), 12)
```

<a name="NOTE0_3"></a>


### Manipulation d'un mémo binaire
<a name="manipulation_memo_binaire_ELTPARAGRAPHE000180"></a>Pour insérer un mémo binaire dans un champ Zone répétée, utilisez la fonction [ZoneRépétéeInsèreLigne](../WDLang2/3083002.md).
<a name="NOTE0_4"></a>


### Tri
<a name="tri_ELTPARAGRAPHE000192"></a>La fonction **ZoneRépétéeInsère** ne tient pas compte du tri.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
