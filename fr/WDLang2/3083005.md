


## ZoneRépétéeCherche (Fonction)

***En anglais : LooperSearch***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Recherche une valeur dans un attribut d'un champ Zone répétée.

Remarque : Pour effectuer une recherche dans tous les attributs d'un champ Zone répétée, utilisez la fonction [ZoneRépétéeCherchePartout](../WDLang2/1000021997.md). 










<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Compte les noms commençant par "DUP" 
// Le premier
Indice est un entier = ZoneRépétéeCherche(ATT_NOM, "DUP", Faux)
Cpt est un entier = 0
TANTQUE Indice <> -1
	Cpt++
	// Suivant
	Indice = ZoneRépétéeCherche(ATT_NOM, "DUP", Faux, Indice + 1)
FIN
Info("Il y a " + Cpt + " noms commençant par 'DUP'")
```
<a name="Exemple2"></a>

```wl
// Recherche la position du client n°1234
Indice est un entier = ZoneRépétéeCherche(ATT_IDCLIENT, "1234")
// Si on a trouvé ce client
SI Indice <> -1 ALORS
	// Positionne le champ Zone répétée sur le client trouvé
	ZR_ZONE1 = Indice
	// Récupère le nom du client (ATT_NOM est un "attribut" de ZR_ZONE1) 
	// et l'affecte dans un champ Libellé
	LIB_LIBELLE1 = " Informations sur " + ATT_NOM
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Résultat> = ZoneRépétéeCherche(<Attribut> , <Valeur recherchée> [, <Type de recherche> [, <Début>]])`
---

**`<Résultat> : (Entier)`**



- Indice de l'élément trouvé, 

- -1 si la recherche a échoué.




**`<Attribut> : (Chaîne de caractères)`**

Attribut du champ Zone répétée sur lequel la recherche doit être effectuée.
Si ce paramètre est égal à une chaîne vide (""), la recherche est effectuée sur l'attribut auquel appartient l'événement en cours.

**`<Valeur recherchée> : (Chaîne de caractères)`**

Valeur recherchée dans l'attribut spécifié.

**`<Type de recherche> : (Constante optionnelle de type Entier)`**

Type de recherche à effectuer : 



|   |   |
| --- | --- |
| *rechercheCommencePar* (ou <u><u><u><u>Faux</u></u></u></u> par compatibilité) | **Recherche générique du type "Commence par"**<br><br>L'indice des éléments ayant une valeur commençant par &lt;Valeur recherchée&gt; est retourné. |
| *rechercheContient* | **Recherche générique du type "Contient"**<br><br>L'indice des éléments contenant la &lt;Valeur recherchée&gt; est retourné. <br> |
| *rechercheIdentique* (ou <u><u><u><u>Vrai</u></u></u></u> par compatibilité)<br>(Valeur par défaut) | **Recherche à l'identique** (du type "Egale à") <br><br>L'indice des éléments ayant une valeur strictement égale à &lt;Valeur recherchée&gt; est retourné. |



**`<Début> : (Entier optionnel)`**

Indice de départ pour la recherche (1 par défaut).  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000172"></a>La fonction **ZoneRépétéeCherche** peut être utilisée indifféremment sur : 

- un champ Zone répétée fichier,

- un champ Zone répétée par programmation. 



<a name="NOTE0_2"></a>


### Sensibilité à la casse
<a name="sensibilite_casse_ELTPARAGRAPHE000181"></a>Aucune distinction n'est faîte entre les minuscules et les majuscules, et ce, même si la recherche est effectuée à l'identique.

<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
