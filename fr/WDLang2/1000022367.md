
## serveurAppliTâchePlanifiée (Type de variable)

***En anglais : appServerScheduledTask***
				



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Le type **serveurAppliTâchePlanifiée** permet de gérer par programmation une tâche planifiée du serveur d'application WEBDEV (pour un site ou un webservice).

**Remarque** : Pour plus de détails sur la déclaration de ce type de variable et l'utilisation des propriétés WLangage, consultez [Déclaration d'une variable](../Motscles/1514032.md).
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Programme la tâche pour s'exécuter toutes les heures
MaTâchePlanifiée est un serveurAppliTâchePlanifiée
MaTâchePlanifiée.Nom = "MaTache"
MaTâchePlanifiée.Procédure = MaProc
MaTâchePlanifiée.Mois = "*"
MaTâchePlanifiée.JourDuMois = "*"
MaTâchePlanifiée.JourDeLaSemaine = "*"
MaTâchePlanifiée.Heure = "*"
MaTâchePlanifiée.Minute = "0"

SI PAS ServeurAppliAjouteTâchePlanifiée(MaTâchePlanifiée) ALORS
	// Cas d'erreur (par exemple si une tâche de même nom existe déjà)
FIN
```





<a name="NOTE0"></a>

## Remarques
<a name="NOTE0_1"></a>


### Propriétés spécifiques à la description des variables de type serveurAppliTâchePlanifiée
<a name="proprietes_specifiques_description_des_variables_type_serveurapplitacheplanifiee_ELTPARAGRAPHE000029"></a>Les propriétés suivantes peuvent être utilisées pour manipuler une Tâche planifiée :

| Nom de la propriété | Type manipulé | Effet |
| --- | --- | --- |
| Activé | Booléen | Indique si la tâche est active ou non : <br><br>- <u><u><u><u>Vrai</u></u></u></u> si la planification de la tâche est active. <br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.<br><br><br> |
| EnExécution | Booléen | Indique si la tâche est en cours d'exécution : <br><br>- <u><u><u><u>Vrai</u></u></u></u> si la tâche est en cours d'exécution.<br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.<br><br><br>**Cette propriété est disponible en lecture seulement**.<br><br>Cette propriété est mise à jour uniquement par les fonctions [ServeurAppliInfoTâchePlanifiée](../WDLang2/1000022789.md) et [ServeurAppliListeTâchePlanifiée](../WDLang2/1000022352.md). La valeur lue reflète l'état au moment de l'appel de ces fonctions et non pas l'état au moment de la lecture de la propriété. |
| Heure | Chaîne de caractères | Heure d'exécution de la tâche planifiée. Si la propriété **HeureUTC** est à <u><u><u><u>Vrai</u></u></u></u>, cette heure est au format UTC (temps universel).<br><br>Les valeurs possibles sont :<br><br>- un chiffre compris entre 0 et 23.<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs heures.<br><br>- un intervalle. Par exemple "9-13".<br><br>- une étoile "\*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "\*/2" pour lancer la tâche à toutes les heures paires.<br><br><br> |
| HeureUTC | Booléen | <br><br>- <u><u><u><u>Vrai</u></u></u></u> (valeur par défaut) si l'heure est exprimée en heure UTC, c'est-à-dire en temps universel (propriétés **Heure** et **Minute**). <br><br>- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.<br><br><br> |
| JourDeLaSemaine | Chaîne de caractères | Numéro du jour de la semaine pour lequel la tâche planifiée doit être exécutée (par exemple "2"). Ce nombre est compris entre 1 et 7 (1 = Lundi, 2 = Mardi, ...).<br><br>Cette propriété peut également correspondre à :<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs jours.<br><br>- un intervalle. Par exemple "1-3" (la tâche est planifiée pour Lundi, Mardi et Mercredi).<br><br>- une étoile "\*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "\*/2" pour lancer la tâche à tous les jours de la semaine pairs.<br><br>- le jour de la semaine en toutes lettres ("lundi", "mardi", "mercredi", "jeudi", "vendredi").<br><br><br> |
| JourDuMois | Chaîne de caractères | Numéro du jour du mois pour lequel la tâche planifiée doit être exécutée (par exemple "31"). Ce nombre est compris entre 0 et 31.<br><br>Cette propriété peut également correspondre à :<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs mois.<br><br>- un intervalle. Par exemple "9-13" (la tâche est planifiée du 9 au 13 du mois).<br><br>- une étoile "\*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "\*/2" pour lancer la tâche à tous les jours impairs du mois.<br><br><br> |
| JourDuMoisOuDeLaSemaine | Booléen | Permet de gérer l'exécution d'une tâche planifiée en précisant le numéro de jour de la semaine ou le numéro de jour du mois. <br><br>Exemple : exécution tous les lundis 1er jour du mois.<br><br>Cette propriété peut correspondre à :<br><br>- <u><u><u><u>Vrai</u></u></u></u> pour exécuter la tâche planifiée tous les lundis ET le premier jour du mois (conditions cumulées).<br><br>- <u><u><u><u>Faux</u></u></u></u> pour exécuter la tâche uniquement les lundis 1er (conditions exclusives).<br><br><br> |
| Minute | Chaîne de caractères | Minutes de l'heure d'exécution de la tâche planifiée. Si la propriété **HeureUTC** est à <u><u><u><u>Vrai</u></u></u></u>, cette heure est au format UTC (temps universel).<br><br>Les valeurs possibles sont :<br><br>- un chiffre compris entre 0 et 59.<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs minutes.<br><br>- un intervalle. Par exemple "9-13".<br><br>- une étoile "\*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "\*/2" pour lancer la tâche à toutes les minutes paires.<br><br><br> |
| Mois | Chaîne de caractères | Numéro du mois d'exécution de la tâche planifiée (par exemple "11").<br><br>Les valeurs possibles sont :<br><br>- un chiffre compris entre 1 et 12<br><br>- une liste de nombres séparés par des virgules : permet de spécifier plusieurs mois.<br><br>- un intervalle. Par exemple, "9-11".<br><br>- une étoile "\*" pour indiquer toute la plage.<br><br>- un intervalle avec un pas, par exemple "\*/2" pour lancer la tâche tous les mois impairs.<br><br><br> |
| MotDePasse | Chaîne de caractères | Mot de passe de l'utilisateur. |
| Nom | Chaîne de caractères | Nom de la tâche. <br><br>Ce nom permet de différencier les tâches associées à une même procédure. <br><br>Si cette propriété n'est pas renseignée, le nom de la tâche correspondra au nom complet de la procédure (par exemple : MaColletion.NomDeLaProcédure). |
| NomProcédure | Chaîne de caractères | Nom de la procédure à exécuter. <br><br>Cette propriété est en lecture seule et permet de récupérer le nom de la procédure associée à la tâche (pour l'afficher dans un écran spécifique par exemple). |
| Paramètre | Tableau | Paramètres à transmettre à la tâche planifiée lors de son exécution. <br><br>Chacun des paramètres doit pouvoir être transformé par la fonction [Sérialise](../WDLang1/3013065.md) (la sérialisation utilisée est une sérialisation binaire). En effet, le Serveur d'application WEBDEV besoin de conserver les paramètres pour pouvoir les transmettre à chaque appel. Pour cela, la valeur de chacun des paramètres sera sérialisée. <br><br>Remarque : Lors de l'exécution de la tâche planifiée, le Serveur d'application WEBDEV transmettra automatiquement les paramètres à la procédure. Une même procédure peut donc être associée à plusieurs tâches planifiées qui lui passeront des paramètres différents. |
| Procédure | Nom de la procédure | Procédure à exécuter par la tâche planifiée. Ce nom est de la forme :<br><br>- pour une procédure présente dans une collection de procédures : &lt;Nom de la collection de procédures&gt;.&lt;Nom de la procédure&gt;.<br><br>- pour une procédure présente dans un composant : &lt;Nom du composant&gt;.&lt;Nom de la collection de procédures&gt;.&lt;Nom de la procédure&gt;.<br><br><br><br><br>Cette propriété n'accepte pas :<br><br>- Les procédures locales. Une procédure locale existe uniquement dans le contexte de l'appel de sa procédure parente. Ce contexte n'existera plus lors de l'appel de la tâche planifiée.<br><br>- Une variable de type [Procédure](../Motscles/1000018907.md) (sauf si celle-ci ne désigne une procédure appartenant à une collection de procédures).<br><br><br> |
| Utilisateur | Chaîne de caractères | Indique l'utilisateur du système d'exploitation qui exécutera la tâche. Si cette valeur n'est pas remplie, l'utilisateur utilisé est l'utilisateur par défaut de l'application (site ou webservice). |


<a name="NOTE0_2"></a>


### Liste des fonctions manipulant le type serveurAppliTâchePlanifiée
<a name="liste_des_fonctions_manipulant_type_serveurapplitacheplanifiee_ELTPARAGRAPHE000252"></a>


|   |   |
| --- | --- |
| [ServeurAppliAjouteTâchePlanifiée](../WDLang2/1000022347.md) | Ajoute une nouvelle tâche planifiée à l'application (site ou webservice). |
| [ServeurAppliExécuteTâchePlanifiée](../WDLang2/1000022350.md) | Lance immédiatement l'exécution d'une tâche planifiée sur un Serveur d'Application WEBDEV. |
| [ServeurAppliInfoTâchePlanifiée](../WDLang2/1000022789.md) | Lit la description d'une tâche planifiée. |
| [ServeurAppliModifieTâchePlanifiée](../WDLang2/1000022348.md) | Modifie une tâche planifiée existante. |
| [ServeurAppliSupprimeTâchePlanifiée](../WDLang2/1000022349.md) | Supprime une tâche planifiée associée à l'application (site ou Webservice). |












