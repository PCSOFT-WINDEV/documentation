


## ZoneRépétéeAjoute (Fonction)

***En anglais : LooperAdd***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute une répétition à la fin d'un champ Zone répétée.








	<B><B><B>Avertissement</B></B></B>

	 Il est conseillé d'utiliser la fonction [ZoneRépétéeAjouteLigne](../WDLang2/3083004.md). En effet, la fonction [ZoneRépétéeAjouteLigne](../WDLang2/3083004.md) permet d'ajouter :

- des caractères TAB dans les attributs/champs.

- des valeurs de n'importe quel type dans les attributs/champs.




<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Initialisation du champ Zone répétée ZR_REPETE1 
ZoneRépétéeSupprimetout(ZR_REPETE1) 
HLitPremier(Produit, NomProd) 
TANTQUE HEnDehors() = Faux
	ZoneRépétéeAjoute(ZR_REPETE1, Produit.NomProd + TAB + Produit.CodeProduit) 
	HLitSuivant(Produit, NomProd) 
FIN
```
<a name="Exemple2"></a>

```wl
// Ajout d'une répétition vide 
ZoneRépétéeAjoute(ZR_Zone1) 
// Positionnement sur la répétition vide 
Indice = ZoneRépétéeOccurrence(ZR_Zone1) 
// Puis initialisation des attributs 
ATT_AttributNom[Indice] = "Hobbes"
ATT_AttributPrénom[Indice] = "Samantha"

// Ou initialisation des champs
// ZR_Zone1[Indice].ChampNom = "Hobbes"
// ZR_Zone1[Indice].ChampPrénom = "Samantha"
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Ajouter une répétition dans un champ Zone répétée avec attributs

`<Résultat> = ZoneRépétéeAjoute(<Champ Zone répétée> [, <Valeur>])`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'ajout a réussi, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Champ Zone répétée> : (Nom de champ)`**

Nom du champ Zone répétée à manipuler.
Si ce paramètre est égal à chaîne vide (""), l'ajout sera effectué dans le champ Zone répétée en cours.

**`<Valeur> : (Chaîne de caractères optionnelle)`**

Liste des valeurs à insérer dans la nouvelle répétition. Ce paramètre doit être de la forme : 

```txt
<Valeur 1> + TAB + ... + <Valeur N>
```

Les différentes valeurs doivent être indiquées dans l'ordre des attributs (fenêtre de description du champ Zone répétée).
Pour ne pas spécifier de valeur pour un des attributs, utilisez une chaîne vide ("") ou 0 (selon le type de l'attribut).
Si ce paramètre correspond à une chaîne vide (""), une répétition vide sera ajoutée.  


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Ajouter une répétition dans un champ Zone répétée sans attributs

`<Résultat> = ZoneRépétéeAjoute(<Champ Zone répétée>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si l'ajout a réussi, 

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Champ Zone répétée> : (Nom de champ)`**

Nom du champ Zone répétée à manipuler.
Si ce paramètre est égal à chaîne vide (""), l'ajout sera effectué dans le champ Zone répétée en cours.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000158"></a>La fonction **ZoneRépétéeAjoute** peut être utilisée indifféremment sur : 

- un champ Zone répétée fichier,

- un champ Zone répétée par programmation. 



<a name="NOTE0_2"></a>


### Ajout d'une répétition vide
<a name="ajout_une_repetition_vide_ELTPARAGRAPHE000188"></a>Après l'ajout d'une répétition vide, il est nécessaire d'initialiser chaque attribut ou chaque champ un à un.

Par exemple :

- Cas d'un champ Zone répétée avec attributs :
	
	```wl
	// Ajout d'une répétition vide
	ZoneRépétéeAjoute(ZR_Zone1)
	
	// Positionnement sur la répétition vide
	Indice = ZoneRépétéeOccurrence(ZR_Zone1)
	// Puis initialisation des attributs
	ATT_AttributNom[Indice] = "Hobbes"
	ATT_AttributPrénom[Indice] = "Samantha"
	ATT_AttributCouleurPrénom[Indice] = RougeClair
	ATT_AttributVisibleAdresse[Indice] = Faux
	```


- Cas d'un champ Zone répétée sans attributs : 
	
	```wl
	// Ajout d'une répétition vide
	ZoneRépétéeAjoute(ZR_Zone1)
	
	// Positionnement sur la répétition vide
	Indice = ZoneRépétéeOccurrence(ZR_Zone1)
	// Puis initialisation des champs
	ZR_Zone1[Indice].ChampNom = "Hobbes"
	ZR_Zone1[Indice].ChampPrénom = "Samantha"
	ZR_Zone1[Indice].ChampPrénom.CouleurFond = RougeClair
	ZR_Zone1[Indice].ChampAdresse.Visible = Faux
	```




<a name="NOTE0_3"></a>


### Caractéristiques de la répétition
<a name="caracteristiques_repetition_ELTPARAGRAPHE000216"></a>Si une valeur correspond au résultat d'un calcul, mettez l'expression numérique entre parenthèses. Par exemple :

```wl
ZoneRépétéeAjoute(ZR_ZoneCalcul, (53+29) + TAB + (83-21))
```

<a name="NOTE0_4"></a>


### Position de la répétition ajoutée
<a name="position_repetition_ajoutee_ELTPARAGRAPHE000231"></a>Par défaut, la répétition est ajoutée à la fin du champ Zone répétée.

Si le champ Zone répétée est trié (fonction [ZoneRépétéeTrie](../WDLang2/3083009.md)), la répétition ajoutée est positionnée dans le champ Zone répétée en fonction du tri en cours.
<a name="NOTE0_5"></a>


### Manipulation d'un mémo binaire
<a name="manipulation_memo_binaire_ELTPARAGRAPHE000245"></a>Pour ajouter un mémo binaire dans un champ Zone répétée, utilisez la fonction [ZoneRépétéeAjouteLigne](../WDLang2/3083004.md).

<a name="XComposante"></a>

## Composante :
wd280obj.dll
