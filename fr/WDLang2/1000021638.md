


## ZoneRépétéeAjoutEnCours (Fonction)

***En anglais : LooperAddInProgress***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Modifie ou renvoie l'état de visibilité de la fenêtre interne de patience lors de l'ajout d'éléments supplémentaires dans un champ Zone répétée infinie.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Evénement "Ajout d'éléments supplémentaires"
ZoneRépétéeAjoutEnCours(ZR_MaZoneRépétée, Vrai)
ThreadExécute(maProcRécupRésultatSuppl)

// -----
Procédure maProcRécupRésultatSuppl()

REQ_PlusDeDonnées.IDMin = ZR_MaZoneRépétée[ZR_MaZoneRépétée.Occurrence].ID
HExécuteRequête(REQ_PlusDeDonnées)	// Exécution d'une requête longue
HLitPremier(REQ_PlusDeDonnées)
TANTQUE PAS HEnDehors(REQ_PlusDeDonnées)
	// Ajoute des éléments au champ Zone répétée depuis le thread principal 
	// pour modifier l'interface (UI)
	// AjouteDansTheadPrincipal utilisera la fonction WLangage ExécuteThreadPrincipal 
	AjouteDansTheadPrincipal(ZR_MaZoneRépétée, REQ_PlusDeDonnées.Titre, ...
		REQ_PlusDeDonnées.Photo, REQ_PlusDeDonnées.IDArticle)
	HLitSuivant(REQ_PlusDeDonnées) 
FIN

ZoneRépétéeAjoutEnCours(ZR_MaZoneRépétée, Faux)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

### Modifier l'état de visibilité de la fenêtre interne de patience

`ZoneRépétéeAjoutEnCours(<Champ Zone répétée> , <Visible>)`
---

**`<Champ Zone répétée> : (Nom de champ)`**

Nom du champ Zone répétée à manipuler.

**`<Visible> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> pour afficher la fenêtre interne de patience,

- <u><u><u><u>Faux</u></u></u></u> pour la masquer.





<a name="SYNTAXE2"></a>

### Récupérer l'état de visibilité de la fenêtre interne de patience

`<Résultat> = ZoneRépétéeAjoutEnCours(<Champ Zone répétée>)`
---

**`<Résultat> : (Booléen)`**



- <u><u><u><u>Vrai</u></u></u></u> si la fenêtre interne de patience est affichée,

- <u><u><u><u>Faux</u></u></u></u> dans le cas contraire.




**`<Champ Zone répétée> : (Nom de champ)`**

Nom du champ Zone répétée à manipuler.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Lors de l'utilisation d'un champ Zone répétée infinie, une fenêtre interne de patience (contenant un champ Jauge) est affichée au-dessus des lignes du champ Zone répétée pendant l'ajout des données supplémentaires dans le champ. Cette fenêtre de patience est masquée à la fin de l'exécution de l'événement "Ajout d'éléments supplémentaires". 

- La fonction **ZoneRépétéeAjoutEnCours** permet par exemple de contrôler l'affichage de la fenêtre de patience lorsque l'actualisation des données du champ Zone répétée est effectuée dans un thread secondaire. Il est ainsi possible d'éviter de figer l'application (l'exemple utilise cette méthode).

- Lorsque la fenêtre de patience est rendue visible par la fonction **ZoneRépétéeAjoutEnCours**, l'événement "Ajout d'éléments supplémentaire" du champ Zone répétée n'est pas exécuté.

- Pour masquer le bandeau de rafraîchissement, il est nécessaire d'appeler **ZoneRépétéeAjoutEnCours**(Faux) autant de fois que **ZoneRépétéeAjoutEnCours**(Vrai) a été exécuté.




<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
