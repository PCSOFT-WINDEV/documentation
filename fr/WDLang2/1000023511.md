


## &lt;Zone répétée&gt;.InsèreLigne (Fonction)

***En anglais : &lt;Looper&gt;.InsertLine***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Insère une répétition dans un champ Zone répétée.

**Remarque** : Pour ajouter des éléments à la fin d'un champ Zone répétée, utilisez la fonction [&lt;Zone répétée&gt;.AjouteLigne](../WDLang2/1000023475.md).










<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Ajout de valeurs dans le champ Zone répétée en 12ème position
ZR_Zone1.InsèreLigne(12, Nom, Prénom, NumTel, NumFax)
```
<a name="Exemple2"></a>

```wl
// Insertion d'informations recherchées dans la base de données
i est un entier = 1
ZR_REPETE1.Supprimetout()
HLitRecherche(Produit, NomProd, "Fenêtre")
TANTQUE HEnDehors() = Faux
	ZR_REPETE1.InsèreLigne(i, Produit.NomProd, Produit.Code)
	HLitSuivant(Produit, NomProd)
	i ++
FIN
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

### Insérer une répétition dans un champ Zone répétée avec attributs

`<Champ Zone répétée>.InsèreLigne([<Indice> [, <Valeur 1> [, <Valeur N>]]])`
---

**`<Champ Zone répétée> : (Nom de champ)`**

Nom du champ Zone répétée à manipuler.

**`<Indice> : (Entier optionnel)`**

Indice de la répétition à partir duquel la répétition sera insérée. 



|   |   |
| --- | --- |
| Indice non précisé | La répétition est insérée avant la répétition en cours. Si aucune répétition n'est sélectionnée, la répétition est insérée à la fin du champ Zone répétée. |
| Indice supérieur au nombre de répétitions du champ | La répétition est insérée à la fin du champ Zone répétée. Dans ce cas, la fonction **&lt;Zone répétée&gt;.InsèreLigne** est équivalente à la fonction [&lt;Zone répétée&gt;.AjouteLigne](../WDLang2/1000023475.md). |
| Indice égal à 0 | La répétition est insérée au début du champ Zone répétée. |
| Indice égal à -1 | La répétition est insérée avant la répétition en cours. Si aucune répétition n'est sélectionnée, la répétition est insérée à la fin du champ Zone répétée. |



**`<Valeur 1> : (Type de l'attribut associé (optionnel))`**

Valeur du 1er attribut de la répétition à insérer dans le champ Zone répétée spécifié.
Les différentes valeurs doivent être indiquées dans l'ordre des attributs (fenêtre de description du champ Zone répétée).
Pour ne pas spécifier de valeur pour un des attributs, utilisez une chaîne vide ("") ou 0 (selon le type de l'attribut).
Si aucun des ces paramètres n'est spécifié, une répétition vide est insérée dans le champ Zone répétée.

**`<Valeur N> : (Type de l'attribut associé (optionnel))`**

Valeur du Nième attribut de la répétition à insérer dans le champ Zone répétée spécifié.
Les différentes valeurs doivent être indiquées dans l'ordre des attributs (fenêtre de description du champ Zone répétée).
Pour ne pas spécifier de valeur pour un des attributs, utilisez une chaîne vide ("") ou 0 (selon le type de l'attribut).
Si aucun des ces paramètres n'est spécifié, une répétition vide est insérée dans le champ Zone répétée.


<a name="SYNTAXE2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/fr/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/fr/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/fr/JAVA.png)![Code Utilisateur (MCU)](https://doc.pcsoft.fr/ext/images/fr/MCU.png) 
### Insérer une répétition dans un champ Zone répétée sans attributs

`<Champ Zone répétée>.InsèreLigne([<Indice>])`
---

**`<Champ Zone répétée> : (Nom de champ)`**

Nom du champ Zone répétée à manipuler.

**`<Indice> : (Entier optionnel)`**

Indice de la répétition à partir duquel la répétition sera insérée.

- Si ce paramètre n'est pas précisé ou égal à -1, l'insertion sera effectuée avant la répétition en cours. Si aucune répétition n'est sélectionnée, l'insertion sera effectuée à la fin du champ Zone répétée.

- Si &lt;Indice&gt; est supérieur au nombre de répétitions, l'insertion sera effectuée à la fin du champ Zone répétée. Dans ce cas, la fonction **&lt;Zone répétée&gt;.InsèreLigne** est équivalente à la fonction [&lt;Zone répétée&gt;.AjouteLigne](../WDLang2/1000023475.md).

- Si ce paramètre est égal à 0, l'insertion sera effectuée au début du champ Zone répétée.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Conditions d'utilisation
<a name="conditions_utilisation_ELTPARAGRAPHE000335"></a>La fonction **&lt;Zone répétée&gt;.InsèreLigne** peut être utilisée indifféremment sur : 

- un champ Zone répétée fichier,

- un champ Zone répétée par programmation. 



<a name="NOTE0_2"></a>


### Ajout d'une répétition vide
<a name="ajout_une_repetition_vide_ELTPARAGRAPHE000366"></a>Après l'ajout d'une répétition vide, il est nécessaire d'initialiser chaque attribut ou chaque champ un à un.

Par exemple :

- Cas d'un champ Zone répétée avec attributs :
	
	```wl
	// Ajout d'une répétition vide
	ZR_REPETE1.InsèreLigne(14)
	
	// Puis initialisation des attributs
	AttributNom[14] = "Hobbes"
	AttributPrénom[14] = "Samantha"
	AttributCouleurPrénom[14] = RougeClair
	AttributVisibleAdresse[14] = Faux
	```


- Cas d'un champ Zone répétée sans attributs : 
	
	```wl
	// Ajout d'une répétition vide
	ZR_REPETE1.InsèreLigne(14)
	
	// Puis initialisation des champs
	ZR_Zone1[14].ChampNom = "Hobbes"
	ZR_Zone1[14].ChampPrénom = "Samantha"
	ZR_Zone1[14].ChampPrénom.CouleurFond = RougeClair
	ZR_Zone1[14].ChampAdresse.Visible = Faux
	```




<a name="NOTE0_3"></a>


### Caractéristiques de la répétition
<a name="caracteristiques_repetition_ELTPARAGRAPHE000395"></a>Si une valeur correspond au résultat d'un calcul, mettez l'expression numérique entre parenthèses. 

Par exemple :

```wl
ZR_ZoneCalcul.InsèreLigne(10, (53+29), (83-21))
```

<a name="NOTE0_4"></a>


### Tri
<a name="tri_ELTPARAGRAPHE000413"></a>La fonction **&lt;Zone répétée&gt;.InsèreLigne** ne tient pas compte du tri.

<a name="XComposante"></a>

## Composante :
wd280obj.dll
