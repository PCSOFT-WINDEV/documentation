


## ZoneRépétéeEnregistre (Fonction)

***En anglais : LooperSave***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Valide la modification ou l'ajout de l'enregistrement associé à la répétition en cours dans le champ Zone répétée fichier. L'enregistrement est mis à jour dans le fichier de données lié au champ Zone répétée fichier.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Enregistrement des données du champ Zone répétée "ZR_ZoneProduit" 
ZoneRépétéeEnregistre(ZR_ZoneProduit)
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`ZoneRépétéeEnregistre(<Champ Zone répétée>)`
---

**`<Champ Zone répétée> : (Nom de champ)`**

Nom du champ Zone répétée à manipuler. La répétition en cours de ce champ Zone répétée sera enregistrée dans le fichier de données lié.
Si ce paramètre correspond à une chaîne vide (""), le champ Zone répétée auquel appartient l'événement en cours est manipulé.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Mise à jour du fichier de données lié au champ Zone répétée
<a name="mise_jour_fichier_donnees_lie_champ_zone_repetee_ELTPARAGRAPHE000058"></a>La fonction **ZoneRépétéeEnregistre** enregistre la répétition en cours du champ Zone répétée dans le fichier de données lié au champ Zone répétée. Les rubriques sont automatiquement affectées avec les valeurs des champs associées dans la répétition en cours.

Lors d'une modification, la fonction **ZoneRépétéeEnregistre** remplace les anciennes valeurs par les nouvelles. Les rubriques ne figurant pas dans le champ Zone répétée ne sont pas modifiées.

Attention :

- La fonction **ZoneRépétéeEnregistre** ne gère que le fichier de données associé au champ Zone répétée. Si certains attributs / champs sont reliés à des rubriques d'autres fichiers de données, ces fichiers de données ne sont pas gérés automatiquement.

- Les attributs / champs "Image" ne sont pas enregistrés par la fonction **ZoneRépétéeEnregistre**. Pour modifier le contenu du mémo associé à l'image (cas rare), utilisez la fonction [HAttacheMémo](../WDLang4/3044173.md). 



<a name="NOTE0_2"></a>


### Saisie en cascade et mise à jour du fichier de données lié
<a name="saisie_cascade_mise_jour_fichier_donnees_lie_ELTPARAGRAPHE000089"></a>Si la saisie en cascade est activée, le fichier de données lié au champ Zone répétée fichier est automatiquement modifié lorsque l'utilisateur passe à la répétition suivante (utilisation des fonctions [ZoneRépétéeAjoute](../WDLang2/3083006.md), [ZoneRépétéeAjouteLigne](../WDLang2/3083004.md), [ZoneRépétéeInsère](../WDLang2/3083003.md), [ZoneRépétéeInsèreLigne](../WDLang2/3083002.md), [ZoneRépétéeModifie](../WDLang2/3083013.md) et [ZoneRépétéeModifieLigne](../WDLang2/3083015.md)). La fonction **ZoneRépétéeEnregistre** est inutile.

Si la saisie en cascade n'est pas activée, le fichier de données lié au champ Zone répétée fichier n'est pas modifié. Pour écrire la répétition ajoutée ou modifiée dans le fichier de données lié, il est nécessaire d'utiliser la fonction **ZoneRépétéeEnregistre** après la fonction d'ajout ou de modification.

Remarques :

- La propriété [Nouveau](../Proprietes/2510073.md) permet de savoir si la répétition en cours vient d'être créée par les fonctions [ZoneRépétéeAjoute](../WDLang2/3083006.md), [ZoneRépétéeAjouteLigne](../WDLang2/3083004.md), [ZoneRépétéeInsère](../WDLang2/3083003.md) et [ZoneRépétéeInsèreLigne](../WDLang2/3083002.md) (..Nouveau = Vrai).

- La propriété [Modifié](../Proprietes/2510080.md) permet de savoir si une répétition a été modifiée par saisie directe de l'utilisateur dans le champ Zone répétée (..Modifié = Vrai).



<a name="NOTE0_3"></a>


### Ré-affichage de la répétition enregistrée
<a name="reaffichage_repetition_enregistree_ELTPARAGRAPHE000147"></a>Après l'utilisation de la fonction **ZoneRépétéeEnregistre**, la répétition enregistrée peut "disparaître". Cette "disparition" est due à la valeur de la clé de parcours de l'enregistrement ajouté ou modifié.

Pour éviter ce problème, ré-affichez le champ Zone répétée avec la fonction [ZoneRépétéeAffiche](../WDLang2/3083001.md).
<a name="NOTE0_4"></a>


### Blocage du fichier de données et mise à jour
<a name="blocage_fichier_donnees_mise_jour_ELTPARAGRAPHE000164"></a>Si le fichier de données est bloqué dans le traitement en cours, la fonction **ZoneRépétéeEnregistre** enregistre la répétition en cours et débloque le fichier de données.
<a name="NOTE0_5"></a>


### Doublons et intégrité référentielle
<a name="doublons_integrite_referentielle_ELTPARAGRAPHE000176"></a>

- Si la gestion des doublons est active (fonction [HGèreDoublon](../WDLang4/3044057.md)), testez la fonction [HErreurDoublon](../WDLang4/3044077.md) après l'exécution de la fonction **ZoneRépétéeEnregistre** pour tester l'unicité de la clé.

- Si la gestion de l'intégrité référentielle est active (fonction [HGèreIntegrité](../WDLang4/3044058.md)), testez la fonction [HErreurIntegrité](../WDLang4/3044086.md) après l'exécution de la fonction **ZoneRépétéeEnregistre** pour tester l'intégrité référentielle.



<a name="NOTE0_6"></a>


### Utilisez la fonction ZoneRépétéeEnregistre pour économiser vos lignes de code
<a name="utilisez_fonction_docparampagetitleshort_pour_economiser_vos_lignes_code_ELTPARAGRAPHE000204"></a>La fonction **ZoneRépétéeEnregistre** économise plusieurs lignes de code. Cette seule ligne remplace l'affectation des variables des rubriques une par une.

Par exemple, le code suivant :

```wl
Client.Nom = ATT_Nom
Client.Prénom = ATT_Prénom
Client.Adresse = ATT_Adresse
Client.CP = ATT_CP
Client.Ville = ATT_Ville
HAjoute(Client)
```
est remplacé par la ligne suivante :

```wl
ZoneRépétéeEnregistre(ZR_ZoneRépétéeClient)
```


<a name="XComposante"></a>

## Composante :
wd280obj.dll
