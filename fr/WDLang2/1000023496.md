


## &lt;Zone répétée&gt;.Enregistre (Fonction)

***En anglais : &lt;Looper&gt;.Save***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Valide la modification ou l'ajout de l'enregistrement associé à la répétition en cours dans le champ Zone répétée fichier. L'enregistrement est mis à jour dans le fichier de données lié au champ Zone répétée fichier.


<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Enregistrement des données du champ Zone répétée "ZR_ZoneProduit" 
ZR_ZoneProduit.Enregistre()
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`<Champ Zone répétée>.Enregistre()`
---

**`<Champ Zone répétée> : (Nom de champ)`**

Nom du champ Zone répétée à manipuler. La répétition en cours de ce champ Zone répétée sera enregistrée dans le fichier de données lié.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Mise à jour du fichier de données lié au champ Zone répétée
<a name="mise_jour_fichier_donnees_lie_champ_zone_repetee_ELTPARAGRAPHE000202"></a>La fonction **&lt;Zone répétée&gt;.Enregistre** enregistre la répétition en cours du champ Zone répétée dans le fichier de données lié au champ Zone répétée. Les rubriques sont automatiquement affectées avec les valeurs des champs associées dans la répétition en cours.

Lors d'une modification, la fonction **&lt;Zone répétée&gt;.Enregistre** remplace les anciennes valeurs par les nouvelles. Les rubriques ne figurant pas dans le champ Zone répétée ne sont pas modifiées.

Attention :

- La fonction **&lt;Zone répétée&gt;.Enregistre** ne gère que le fichier de données associé au champ Zone répétée. Si certains attributs / champs sont reliés à des rubriques d'autres fichiers de données, ces fichiers de données ne sont pas gérés automatiquement.

- Les attributs / champs "Image" ne sont pas enregistrés par la fonction **&lt;Zone répétée&gt;.Enregistre**. Pour modifier le contenu du mémo associé à l'image (cas rare), utilisez la fonction [&lt;Source&gt;.AttacheMémo](../WDLang4/1000024194.md).



<a name="NOTE0_2"></a>


### Saisie en cascade et mise à jour du fichier de données lié
<a name="saisie_cascade_mise_jour_fichier_donnees_lie_ELTPARAGRAPHE000236"></a>Si la saisie en cascade est activée, le fichier de données lié au champ Zone répétée fichier est automatiquement modifié lorsque l'utilisateur passe à la répétition suivante (utilisation des fonctions [&lt;Zone répétée&gt;.Ajoute](../WDLang2/1000023469.md), [&lt;Zone répétée&gt;.AjouteLigne](../WDLang2/1000023475.md), [&lt;Zone répétée&gt;.Insère](../WDLang2/1000023509.md), [&lt;Zone répétée&gt;.InsèreLigne](../WDLang2/1000023511.md), [&lt;Zone répétée&gt;.Modifie](../WDLang2/1000023512.md) et [&lt;Zone répétée&gt;.ModifieLigne](../WDLang2/1000023520.md)). La fonction **&lt;Zone répétée&gt;.Enregistre** est inutile.

Si la saisie en cascade n'est pas activée, le fichier de données lié au champ Zone répétée fichier n'est pas modifié. Pour écrire la répétition ajoutée ou modifiée dans le fichier de données lié, il est nécessaire d'utiliser la fonction **&lt;Zone répétée&gt;.Enregistre** après la fonction d'ajout ou de modification.

Remarques :

- La propriété [Nouveau](../Proprietes/2510073.md) permet de savoir si la répétition en cours vient d'être créée par les fonctions [&lt;Zone répétée&gt;.Ajoute](../WDLang2/1000023469.md), [&lt;Zone répétée&gt;.AjouteLigne](../WDLang2/1000023475.md), [&lt;Zone répétée&gt;.Insère](../WDLang2/1000023509.md) et [&lt;Zone répétée&gt;.InsèreLigne](../WDLang2/1000023511.md) (..Nouveau = Vrai).

- La propriété [Modifié](../Proprietes/2510080.md) permet de savoir si une répétition a été modifiée par saisie directe de l'utilisateur dans le champ Zone répétée (..Modifié = Vrai).



<a name="NOTE0_3"></a>


### Ré-affichage de la répétition enregistrée
<a name="reaffichage_repetition_enregistree_ELTPARAGRAPHE000315"></a>Après l'utilisation de la fonction **&lt;Zone répétée&gt;.Enregistre**, la répétition enregistrée peut "disparaître". Cette "disparition" est due à la valeur de la clé de parcours de l'enregistrement ajouté ou modifié.

Pour éviter ce problème, ré-affichez le champ Zone répétée avec la fonction [&lt;Zone répétée&gt;.Affiche](../WDLang2/1000023451.md).
<a name="NOTE0_4"></a>


### Blocage du fichier de données et mise à jour
<a name="blocage_fichier_donnees_mise_jour_ELTPARAGRAPHE000335"></a>Si le fichier de données est bloqué dans le traitement en cours, la fonction **&lt;Zone répétée&gt;.Enregistre** enregistre la répétition en cours et débloque le fichier de données.
<a name="NOTE0_5"></a>


### Doublons et intégrité référentielle
<a name="doublons_integrite_referentielle_ELTPARAGRAPHE000348"></a>

- Si la gestion des doublons est active (fonction [&lt;Source&gt;.GèreDoublon](../WDLang4/1000024985.md)), testez la fonction [HErreurDoublon](../WDLang4/3044077.md) après l'exécution de la fonction **&lt;Zone répétée&gt;.Enregistre** pour tester l'unicité de la clé.

- Si la gestion de l'intégrité référentielle est active (fonction [&lt;Variable Connexion&gt;.GèreIntégrité](../WDLang4/1000023960.md)), testez la fonction [HErreurIntegrité](../WDLang4/3044086.md) après l'exécution de la fonction **&lt;Zone répétée&gt;.Enregistre** pour tester l'intégrité référentielle.



<a name="NOTE0_6"></a>


### Utilisez la fonction &lt;Zone répétée&gt;.Enregistre pour économiser vos lignes de code
<a name="utilisez_fonction_docparampagetitleshort_pour_economiser_vos_lignes_code_ELTPARAGRAPHE000381"></a>La fonction **&lt;Zone répétée&gt;.Enregistre** économise plusieurs lignes de code. Cette seule ligne remplace l'affectation des variables des rubriques une par une.

Par exemple, le code suivant :

```wl
Client.Nom = ATT_Nom
Client.Prénom = ATT_Prénom
Client.Adresse = ATT_Adresse
Client.CP = ATT_CP
Client.Ville = ATT_Ville
Client.Ajoute()
```
est remplacé par la ligne suivante :

```wl
ZR_ZoneRépétéeClient.Enregistre()
```


<a name="XComposante"></a>

## Composante :
wd280obj.dll
