


## PageVersJSP (Fonction)

***En anglais : PageToJSP***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Envoie les données d'une page actuellement affichée sous le navigateur vers un serveur JSP.
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
// Provoque une validation de la page courante 
// Et envoie le contenu de la page courante au serveur JSP
PageVersJSP("", "http://www.ServeurJSP.com/PageTest")
```

<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`PageVersJSP(<Page> , <URL destination> , <Méthode d'envoi> [, <Destination> [, <Nom de la fenêtre> [, <Options> [, <Largeur> [, <Hauteur> [, <Position horizontale> [, <Position verticale> [, <Paramètres Javascript>]]]]]]]])`
---

**`<Page> : (Nom de page)`**

Nom de la page dont les données doivent être envoyées au serveur JSP. 
Si ce paramètre correspond à chaîne vide (""), la page en cours sera prise en compte. Cette page doit être actuellement affichée sur le navigateur.

**`<URL destination> : (Chaîne de caractères)`**

URL de la page JSP vers laquelle les données de la page WEBDEV doivent être envoyées.

**`<Méthode d'envoi> : (Constante de type chaîne de caractères)`**

Méthode d'envoi des données au serveur JSP :


|   |   |
| --- | --- |
| *GET* | Les données sont envoyées au serveur à travers l'URL. |
| *POST* | Les données sont envoyées à la suite des entêtes HTTP, dans le corps de la requête. |



**`<Destination> : (Chaîne de caractères ou constante optionnelle)`**

Nom de la frame de destination. &lt;Destination&gt; peut également prendre les valeurs suivantes :


|   |   |
| --- | --- |
| *FrameEnCours* | la destination est le cadre en cours (valeur par défaut). |
| *FrameParent* | la destination est le conteneur de la page en cours (frameset parent, navigateur parent). |
| *NavigateurEnCours* | la destination est le navigateur en cours. |
| *NouveauNavigateur* | la destination est un nouveau navigateur (une nouvelle fenêtre de navigateur est ouverte). Les paramètres suivants de la fonction **PageVersJSP** permettent de configurer cette nouvelle fenêtre. |



**`<Nom de la fenêtre> : (Chaîne de caractères optionnelle)`**

Nom de la fenêtre du nouveau navigateur si &lt;Destination&gt; est égal à la constante *NouveauNavigateur*. Ce paramètre permet de ré-afficher une page dans un navigateur portant le même nom (si plusieurs navigateurs sont ouverts sur le poste de l'internaute).

**`<Options> : (Constante ou combinaison de constantes de type entier (optionnelle))`**

Paramètres de la fenêtre du nouveau navigateur si &lt;Destination&gt; est égal la constante *NouveauNavigateur* :


|   |   |
| --- | --- |
| *ONAdresse* | La barre d'adresse sera affichée. |
| *ONAscenseur* | Les barres de défilement seront affichées. |
| *ONComplet* <br>(Valeur par défaut) | La fenêtre du nouveau navigateur sera complète (équivalent à la combinaison de toutes les constantes précédentes). |
| *ONDimension* | La fenêtre du nouveau navigateur sera redimensionnable. |
| *ONLien* | La barre des liens sera affichée. |
| *ONMenu* | La barre de menu sera affichée. |
| *ONMessage* | La barre de message sera affichée. |
| *ONOutils* | La barre d'outils sera affichée. |
| *ONSimple* | La fenêtre du nouveau navigateur sera minimale (aucune combinaison de constantes). |



**`<Largeur> : (Entier optionnel)`**

Largeur en pixels de la fenêtre du nouveau navigateur.

**`<Hauteur> : (Entier optionnel)`**

Hauteur en pixels de la fenêtre du nouveau navigateur.

**`<Position horizontale> : (Entier optionnel)`**

Position horizontale en pixels de la fenêtre du nouveau navigateur (par rapport au coin haut gauche de l'écran).

**`<Position verticale> : (Entier optionnel)`**

Position verticale en pixels de la fenêtre du nouveau navigateur (par rapport au coin haut gauche de l'écran).

**`<Paramètres Javascript> : (Chaîne de caractères optionnelle)`**

Autres paramètres Javascript à utiliser lors de l'ouverture d'un nouveau navigateur si &lt;Destination&gt; est égal à la constante *NouveauNavigateur*.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


### Champs supplémentaires
<a name="champs_supplementaires_ELTPARAGRAPHE000120"></a>La page peut contenir des champs supplémentaires spécifiques à WEBDEV (champs WD_ACTION, WD_BUTTON_CLICK, ...). Ces champs sont nécessaires au bon fonctionnement de WEBDEV. La valeur de ces champs est également renvoyée au serveur JSP.
<a name="NOTE0_2"></a>


### Format d'envoi et optimisation de page
<a name="format_envoi_optimisation_page_ELTPARAGRAPHE000127"></a>Les valeurs sont renvoyées sous la forme de couples de la forme suivante : (&lt;Alias du champ&gt;, &lt;Valeur du champ&gt;).

Il est conseillé d'utiliser l'option "Compresser les noms de champs (..Alias)".

**Rappel** : Cette option est disponible dans les caractéristiques d'optimisation avancée du code HTML :

- Configuration des projets : Onglet "Projet" de la description du projet

- Configuration d'une page : Onglet "Avancé" de la description de la page



<a name="NOTE0_3"></a>


### Attention : une seule action peut être effectuée à la fois sur la même page
<a name="attention_une_seule_action_peut_etre_effectuee_fois_sur_meme_page_ELTPARAGRAPHE000141"></a>La fonction **PageVersJSP** provoque une action sur la page affichée dans le navigateur de l'internaute. Or les navigateurs Internet autorisent uniquement une seule action sur la page par traitement.

**Conséquences** : La fonction **PageVersJSP** ne peut pas être utilisée dans un code provoquant (automatiquement ou non) une action. Cette fonction est ignorée :

- Dans le code de clic d'un bouton de type "envoi au serveur" (ou dans une procédure appelée par le code de clic de ce bouton)

- Dans le code de clic d'un bouton de type "autre" dont l'action est différente de "aucune" (ou dans une procédure appelée par le code de clic de ce bouton)

- Si elle est suivie de la fonction [PageValide](../WDLang2/3058020.md) ou de la fonction [EmailOuvreMessagerie](../WDLang2/3032021.md) (dans le traitement en cours, dans une procédure appelée par le traitement en cours ou dans un autre traitement appelé par la fonction [Exécute](../WDLang1/3013041.md)).




<a name="XComposante"></a>

## Composante :
WDJS.DLL
