


## ZoneRépétéeAjouteFI (Fonction)

***En anglais : LooperAddIW***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Ajoute une répétition sous forme d'une fenêtre interne à la fin d'un champ Zone répétée par programmation. 

Il est ainsi possible par exemple de proposer des répétitions avec un contenu différent ou d'imbriquer des zones répétées.

**Attention** : Pour utiliser cette fonction, l'option "Utiliser une Fenêtre interne par ligne (fonction ZoneRépétéeAjouteFI)" doit être cochée (onglet "Contenu" de la description du champ). 
<a name="Exemple1"></a>
<a name="sample_code"></a>

## Exemple


```wl
ZoneRépétéeAjouteFI(ZR_Composant, FI_PROCESSEUR, "i7", 2) 
ZoneRépétéeAjouteFI(ZR_Composant, FI_DISQUE, "SAMDATA", "SSD", 20 000 000)
```

<a name="XSYNTAXE"></a>

## Syntaxe
<a name="SYNTAXE1"></a>

`<Résultat> = ZoneRépétéeAjouteFI(<Champ Zone répétée> , <Fenêtre interne> [, <Paramètre 1> [... [, <Paramètre N>]]])`
---

**`<Résultat> : (Entier)`**

Numéro de la répétition ajoutée. 

**`<Champ Zone répétée> : (Nom de champ)`**

Nom du champ Zone répétée à manipuler. 

**`<Fenêtre interne> : (Nom de fenêtre)`**

Nom de la fenêtre interne à utiliser pour créer la répétition. 

**`<Paramètre 1> : (Type correspondant au paramètre (optionnel))`**

Premier paramètre à passer à la fenêtre interne. Ce paramètre est passé à l'événement "Déclarations globales" de la fenêtre interne. 



**`<Paramètre N> : (Type correspondant au paramètre (optionnel))`**

Nième paramètre à passer à la fenêtre interne. Ce paramètre est passé à l'événement "Déclarations globales" de la fenêtre interne. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques


- Si l'un des champs de la fenêtre interne est ancré selon son contenu, la hauteur de la répétition sera automatiquement adaptée, sinon la hauteur de la répétition correspondra à celle de la fenêtre interne en édition.

- Le nom de la fenêtre interne utilisée pour une répétition peut être récupéré via la syntaxe suivante : 
	
	```txt
	<Champ Zone répétée>[Répétition/ligne].Nom
	```


- **Paramètres passés à la fenêtre interne** : Les paramètres sont récupérés dans l'événement de "Déclarations globales" de la fenêtre interne. Il suffit de saisir la ligne de code suivante au début du code de l'événement :
	
	```txt
	PROCEDURE <Nom de la fenêtre>(<Paramètre 1> [, ...] [, <Paramètre N>])
	```
Pour plus de détails, consultez [Fenêtre paramétrée](../WDChamp/1010026.md).
	




- Astuce : Pour connaître le numéro de la répétition utilisée (cas par exemple d'un clic sur un bouton de la fenêtre interne), créez un attribut dans le champ Zone répétée et affectez-le avec le résultat de la fonction **ZoneRépétéeAjouteFI**. 

- Attention : Le nombre maximum de champs qui peuvent être créés est limité à 1000 (le nombre de champs par répétition dépend de la fenêtre interne ajoutée).
	Si plus de 1000 champs sont créés, l'erreur suivante est affichée : "Dépassement de capacité : la zone répétée contient plus de 1000 champs dans xxx lignes".





- ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=WMSports.gif) ***Exemples multiplateforme (WINDEV Mobile)*** : **WM Sports** <br>Cet exemple est une application de sport vous permettant d'enregistrer vos performances.<br>L'application calcule la distance parcourue, le temps, la vitesse moyenne et le nombre de calories dépensées en fonction du sport pratiqué. <br>Le parcours réalisé est affiché sur un champ carte grâce à des marqueurs et un tracé d'itinéraire. <br>Si vous disposez d'une montre Apple Watch, vous pourrez piloter WM Sports avec votre montre !<br><br>L'exemple dispose aussi d'une partie serveur qui sert à la synchronisation des données des utilisateurs.<br>Ce webservice est disponible dans l'exemple WEBDEV "WW_Sports".

<a name="XComposante"></a>

## Classification Métier / UI :
Code UI
## Composante :
wd280obj.dll
