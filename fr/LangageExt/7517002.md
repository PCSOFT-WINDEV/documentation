


## J'utilisais le Visual Basic avec WINDEV 5.5. Comment faire en WINDEV 28 ? 
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000123"></a>
Il est possible d'utiliser des langages externes avec WINDEV. Pour plus de détails sur les différentes façons d'interfacer des éléments développés en WINDEV avec un langage externe, consultez les [langages externes en WINDEV](../LangageExt/7510002.md).

Ce paragraphe présente uniquement les différentes manipulations à réaliser pour migrer une application WINDEV 5.5 utilisant le Visual Basic en WINDEV 28.

**Remarque** : Les appels DDE (par AppelDDE) en 16 bits ne sont plus disponibles dans cette version de l'interface externe.


<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Gestion des objets et des fichiers HFSQL en Visual Basic
<a name="gestion_des_objets_des_fichiers_hfsql_visual_basic_ELTTEXTE000153"></a>


### Pour migrer une application WINDEV 5.5 réalisant une gestion des objets en Visual Basic
<a name="pour_migrer_une_application_windev_55_realisant_une_gestion_des_objets_visual_basic_ELTPARAGRAPHE000028"></a>

1. Migrez votre projet WINDEV 5.5 vers WINDEV 7.5 puis ouvrez-le avec WINDEV 28.

2. Générez le squelette de votre application : dans l'éditeur d'analyses, sous le volet "Analyse", dans le groupe "Analyse", déroulez "Génération" et sélectionnez "Génération avancée". Attention : N'écrasez pas le squelette utilisé par votre application

3. Re-créez la bibliothèque de votre application WINDEV : déroulez l'icône de génération et sélectionnez l'option "Autres générations .. Générer la bibliothèque (.wdl)".<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=genererbibliotheque.gif)


4. Supprimez les fichiers WinDevxx.Bas et WDHFxx.Bas du répertoire de vos sources (pour éviter toute confusion).

5. Dans votre projet Visual Basic, supprimez la référence de dépendance aux fichiers WDHF.bas et WinDev.bas.

6. Copiez les fichiers suivants dans le répertoire de votre application.

	- WDHF.bas (présent dans le sous-répertoire "LangagesExternes\\Basic" de WINDEV).

	- WinDev.Bas (présent dans le sous-répertoire "LangagesExternes\\Basic" de WINDEV).

	- &lt;NomAnalyse&gt;.Bas généré par WINDEV (présent dans le répertoire de l'analyse du projet de WINDEV).

	- &lt;NomAnalyse&gt;.gbl généré par WINDEV (présent dans le répertoire de l'analyse du projet de WINDEV).




7. Ajoutez ces 4 fichiers au projet Visual Basic.

8. Supprimez les appels à la fonction APPELDDE de votre application Visual Basic. Cette fonction n'était utilisable que dans les applications en mode 16 bits.

9. La gestion des menus peut utiliser une des méthodes suivantes :

	- Récupération des raccourcis de menus avec WDTOUCHE = "\*M\*" :
			
		```txt
		While WDTouche <> "ESC"
				' on effectue la saisie du menu
				Call appelwd("ECRAN,saisie")
				' le compte-rendu WDTouche vaut *M* lorsque un choix de menu
				' a été sélectionné
				If WDTouche = "*M*" Then
					'---------------------------------------
					' Test de l'option choisie.
					' WDChaine contient la suite des lettres d'appel
					' qui aboutissent au choix de menu sélectionné
					'---------------------------------------
					If WDChaine = "FQ" Then WDTouche = "ESC" ' Sortie>
					If WDChaine = "RN" Then Call RechVille  ' Recherche par Ville
					If WDChaine = "RD" Then Call RechDepar  ' Recherche par Département
					If WDChaine = "DD" Then Call LstDepart  ' Affichage liste.
					If WDChaine = "DI" Then Call LstImprime ' Impression.
					If WDChaine = "DC" Then Call LstIConfig ' Configuration imp
				End If
			Wend
		```


	- Récupération des raccourcis de menus en gérant le raccourcis directement dans l'option :

		1. Dans le code de chaque option de menu à traiter, affecter le raccourci au mot-clé **WDTouche**. Par exemple, pour Fichier .. Ouvrir :
						
			```txt
			WDTouche="FO";
			```


		2. Modifier le code Visual Basic de la manière suivante :
						
			```txt
			' le programme boucle jusqu'à ce que le choix Fichier Quitte
					' soit sélectionné
					While WDTouche <> "ESC"
						' on effectue la saisie du menu
						Call appelwd("ECRAN,saisie")
						'---------------------------------------
						' Test de l'option choisie.
						'---------------------------------------
						If WDTouche = "FQ" Then WDTouche = "ESC" ' Sortie
						If WDTouche = "RN" Then Call RechVille	' Recherche Ville
						If WDTouche = "RD" Then Call RechDepar	' Recherche Département
						If WDTouche = "DD" Then Call LstDepart	' Affichage liste.
						If WDTouche = "DI" Then Call LstImprime ' Impression.
						If WDTouche = "DC" Then Call LstIConfig ' Configuration imp
					Wend
			```





10. Recompilez votre projet Visual Basic. 
	Attention : le fichier .Bas généré par WINDEV contient une procédure "Main". Conservez plutôt votre propre procédure "Main".

11. Copiez les DLL de WINDEV nécessaires dans le répertoire de l'exécutable de votre application. Attention : la DLL wdxxxle.dll est obligatoire.




**Remarque** : Pour connaître la liste des DLL nécessaires, créez sous WINDEV l'exécutable de votre application.


