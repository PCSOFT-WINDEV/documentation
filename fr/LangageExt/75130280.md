
## iImprimeEtat (Langage externe)

***En anglais : iPrintReport***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Imprime un état réalisé avec l'éditeur d'états.
<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`iImprimeEtat(<Nom de l'état> [, <Identifiant de la vue> [, <Paramètre 1 à 4>]])`
---

**`<Nom de l'état> : (Chaîne de caractères)`**

Nom de l'état à imprimer.

**`<Identifiant de la vue> : (Chaîne de caractères (optionnelle))`**

Identifiant de la vue à imprimer.

**`<Paramètre 1 à 4> : (Chaîne de caractères (optionnelle))`**

Paramètres optionnels, attendus par l'état pour son exécution. Ces paramètres ont été définis dans le code d'ouverture de l'état. Ces paramètres peuvent être par exemple un nom de vue, de zone mémoire, etc.

**Attention** : Si l'état comprend des bornes (borne minimale et borne maximale), les deux premiers paramètres doivent correspondre respectivement à la borne minimale et à la borne maximale.  


<a name="SYNTAXE2"></a>

`iImprimeEtat(<Nom de l'état> , <Borne 1> [, <Identifiant de la vue> [, <Paramètre 1 à 4>]])`
---

**`<Nom de l'état> : (Chaîne de caractères)`**

Nom de l'état à imprimer.

**`<Borne 1> : (Chaîne de caractères)`**

 Borne minimale de parcours.

**`<Identifiant de la vue> : (Chaîne de caractères (optionnelle))`**

Identifiant de la vue à imprimer.

**`<Paramètre 1 à 4> : (Chaîne de caractères (optionnelle))`**

Paramètres optionnels, attendus par l'état pour son exécution. Ces paramètres ont été définis dans le code d'ouverture de l'état. Ces paramètres peuvent être par exemple un nom de vue, de zone mémoire, etc.

**Attention** : Si l'état comprend des bornes (borne minimale et borne maximale), les deux premiers paramètres doivent correspondre respectivement à la borne minimale et à la borne maximale.  


<a name="SYNTAXE3"></a>

`iImprimeEtat(<Nom de l'état> , <Borne 2> [, <Identifiant de la vue> [, <Paramètre 1 à 4>]])`
---

**`<Nom de l'état> : (Chaîne de caractères)`**

Nom de l'état à imprimer.

**`<Borne 2> : (Chaîne de caractères)`**

Borne maximale de parcours.

**`<Identifiant de la vue> : (Chaîne de caractères (optionnelle))`**

Identifiant de la vue à imprimer.

**`<Paramètre 1 à 4> : (Chaîne de caractères (optionnelle))`**

Paramètres optionnels, attendus par l'état pour son exécution. Ces paramètres ont été définis dans le code d'ouverture de l'état. Ces paramètres peuvent être par exemple un nom de vue, de zone mémoire, etc.

**Attention** : Si l'état comprend des bornes (borne minimale et borne maximale), les deux premiers paramètres doivent correspondre respectivement à la borne minimale et à la borne maximale.


<a name="SYNTAXE4"></a>

`iImprimeEtat(<Nom de l'état> , <Borne 1> , <Borne 2> [, <Identifiant de la vue> [, <Paramètre 1 à 4>]])`
---

**`<Nom de l'état> : (Chaîne de caractères)`**

Nom de l'état à imprimer.

**`<Borne 1> : (Chaîne de caractères)`**

Borne minimale de parcours.

**`<Borne 2> : (Chaîne de caractères)`**

Borne maximale de parcours.

**`<Identifiant de la vue> : (Chaîne de caractères (optionnelle))`**

Identifiant de la vue à imprimer.

**`<Paramètre 1 à 4> : (Chaîne de caractères (optionnelle))`**

Paramètres optionnels, attendus par l'état pour son exécution. Ces paramètres ont été définis dans le code d'ouverture de l'état. Ces paramètres peuvent être par exemple un nom de vue, de zone mémoire, etc.

**Attention** : Si l'état comprend des bornes (borne minimale et borne maximale), les deux premiers paramètres doivent correspondre respectivement à la borne minimale et à la borne maximale.


<a name="SYNTAXE5"></a>

`iImprimeEtat(<Nom de l'état> , <Zone mémoire> [, <Identifiant de la vue> [, <Paramètre 1 à 4>]])`
---

**`<Nom de l'état> : (Chaîne de caractères)`**

Nom de l'état à imprimer.

**`<Zone mémoire> : (Chaîne de caractères)`**

  Numéros d'enregistrements à imprimer.

**`<Identifiant de la vue> : (Chaîne de caractères (optionnelle))`**

Identifiant de la vue à imprimer.

**`<Paramètre 1 à 4> : (Chaîne de caractères (optionnelle))`**

Paramètres optionnels, attendus par l'état pour son exécution. Ces paramètres ont été définis dans le code d'ouverture de l'état. Ces paramètres peuvent être par exemple un nom de vue, de zone mémoire, etc.

**Attention** : Si l'état comprend des bornes (borne minimale et borne maximale), les deux premiers paramètres doivent correspondre respectivement à la borne minimale et à la borne maximale.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Cas particulier
<a name="cas_particulier_ELTPARAGRAPHE000090"></a>

- Les différentes syntaxes correspondent aux différents cas de figure d'appel d'un état. Le type de l'appel est lié aux choix effectués lors de la définition de l'état (fichier ou zone mémoire, avec ou sans bornes, ...)

- En plus des paramètres nécessaires à l'impression (nom de l'état, borne minimum et borne maximum ou zone mémoire), il est possible d'utiliser 4 paramètres supplémentaires de type chaîne. La valeur de ces paramètres est accessible dans les codes de l'état par les variables _pParam1, _pParam2, _pParam3 et _pParam4.

- En standard l'éditeur d'états ne bloque aucun fichier de données manipulé.
	En mode personnalisé, si les traitements de l'état ne gèrent pas les accès concurrentiels, l'erreur "05" risque de se produire et l'exécution de l'état est abandonnée.
	Pour ne pas avoir cette erreur, en mode personnalisé, il faut changer de mode de blocage avant l'exécution de l'état de la façon suivante : 
	
	```wl
	HFerme("")
	HModeSemiPerso()
	iImprimeEtat(NomEtat)
	HFerme("")
	HModePerso()
	```




<a name="NOTE0_2"></a>




### Exemple
<a name="exemple_ELTPARAGRAPHE000106"></a>Les programmes suivants donnent un exemple simple en VB, Turbo Pascal pour Windows et C. Cet exemple lance deux états utilisant des bornes :

- bornes.wde (bornes numériques)

- bornes2.wde (bornes chaînes de caractères)




Exemple en C :


```txt
int PASCAL WinMain(HANDLE hInst,HANDLE hPrevInst,LPSTR lpCmdLine,int nCmdShow)
{
long Borne1,Borne2;
char valeur1[10],valeur2[10];
// bornes numériques
Borne1=5;
Borne2=8;
APPELWD("iImprimeEtat,bornes.wde,\t%ld\t%ld",Borne1,Borne2);
// bornes texte
strcpy(valeur1,"D");
strcpy(valeur2,"M");
APPELWD("iImprimeEtat,bornes2.wde,\t%s\t%s",valeur1,valeur2);
WDTermine();
return(0);
}
```


Exemple en Turbo Pascal pour Windows:


```txt
Begin
/* bornes numériques */
	Borne1:=5;
	Borne2:=8;
	APPELWD('iImprimeEtat,bornes.wde,'+chr(9)+ITOS(Borne1,1)
	+chr(9)+ITOS(Borne2,1));
 
/* bornes texte */
	valeur1:='D';
	valeur2:='M';
	APPELWD('iImprimeEtat,bornes2.wde,'+chr(9)+valeur1
	+chr(9)+valeur2);
 
	WDTermine;
End.
```


Exemple en VB :


```txt
Sub main()
	' bornes numériques
	Borne1=5
	Borne2=8
	Call APPELWD("iImprimeEtat,bornes.wde,"+chr$(9)+
	str$(borne1)+chr$(9)+str$(borne2))
	' bornes texte
	valeur1$="D"
	valeur2$="M"
	Call APPELWD("iImprimeEtat,bornes2.wde,"+chr$(9)+
	valeur1$+chr$(9)+valeur2$)
 
	call WDTermine
	End
End Sub
```







