
## Langage externe : Programmation en Java
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000147"></a>
Il s'agit ici d'appeler les éléments développés en WINDEV (projet, fenêtres, analyse, ...) depuis le langage Java. Le code WLangage utilisé depuis le langage externe sera compilé dynamiquement et exécuté lors de son appel.

Ce mode est illustré dans le projet Ville.JAVA (au format Java) fourni dans le sous-répertoire "LangagesExternes\\Java" du répertoire d'installation de WINDEV.

**Remarque** : Le langage externe Java ne permet pas d'utiliser le moteur HyperFileSQL. Pour manipuler le moteur HyperFileSQL, réalisez les traitements nécessaires dans WINDEV.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Mise en place
<a name="mise_place_ELTTEXTE000171"></a>


### Inclusion des fichiers de l'interface Java de WINDEV
<a name="inclusion_des_fichiers_interface_java_windev_ELTPARAGRAPHE000023"></a>Le fichier suivant doit être inclus dans votre code Java pour faire appel à l'interface Java de WINDEV : WINDEV.CLASS (code de source disponible dans WINDEV.JAVA)

Les lignes suivantes doivent être placées dans le code du fichier ".JAVA" principal de votre code Java :


```txt
public class ville extends WINDEV
{
...
}
```


Ces lignes permettent de récupérer les déclarations minimales nécessaires pour l'utilisation de l'interface externe.

**Remarque** : Il est également possible d'appeler les méthode de la classe WINDEV en préfixant ces méthodes du mot "WINDEV.". Dans ce cas, les lignes de code précédentes ne sont pas nécessaires.



<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Chargement de la bibliothèque WINDEV (WDL)
<a name="chargement_bibliotheque_windev_wdl_ELTTEXTE000195"></a>
La bibliothèque WINDEV d'extension .WDL contient tous les éléments du projet (fenêtres, états, classes, requêtes, analyse, ...). Il faut donc la charger en mémoire pour faire appel aux composants qu'elle contient.

**Attention** : Si la bibliothèque à charger contient des fenêtres, le code de chacune de ces fenêtres doit être intégré dans le fichier ".WDW" correspondant (option "Intégrer le code compilé" cochée, dans l'onglet "Détail" de la description de chaque fenêtre).


```txt
/* Ouverture de la bibliotheque */
/* si WDEntier n'est pas nul, la bibliothèque n'a pas été trouvée! */
APPELWD("BIBLI,Disque,ville.wdl");
/* équivalent à : Windev.APPELWD("BIBLI,Disque,ville.wdl"); */
if (WDEntier() == 0)
/* équivalent à : if (Windev.WDEntier() == 0) */
{
...
else
{
	/* Bibliothèque non trouvée */
	APPELWD("Erreur, Bibliothèque non trouvée");
	/* équivalent à : Windev.APPELWD("Erreur, Bibliothèque non trouvée"); */
 
}
```




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Exécution de codes WINDEV depuis le langage externe
<a name="execution_codes_windev_depuis_langage_externe_ELTTEXTE000219"></a>


### 1. Appel d'un code WLangage
<a name="1_appel_code_wlangage_ELTPARAGRAPHE000053"></a>Toutes les fonctions WLangage peuvent être appelées depuis le langage externe. Leur comportement et les valeurs retournées par ces fonctions du WLangage sont exactement identiques qu'elles soient appelées :

- depuis WINDEV ou

- depuis l'interface langage externe




Pour connaître les paramètres et les valeur de retour d'une fonction du WLangage, il suffit donc de se reporter à l'aide en ligne ou la documentation papier habituelle relative au WLangage.

L'appel à une procédure du WLangage depuis l'interface externe se fait par la fonction [AppelWD](../LangageExt/7510001.md). Par exemple :


```txt
/* ouverture de la première fenêtre du programme contenant le menu */
	APPELWD("Ouvre,menufc.wdw");
	/* équivalent à : Windev.APPELWD("Ouvre,menufc.wdw"); */
```



### 2. Récupération des événements déclenchés dans les fenêtres WINDEV
<a name="2_recuperation_des_evenements_declenches_dans_les_fenetres_windev_ELTPARAGRAPHE000070"></a>La saisie dans les fenêtres WINDEV rend nécessaire la récupération des événements déclenchés dans ces fenêtres.

Afin de récupérer les événements (clic sur un menu, un bouton, ...) de l'utilisateur, vous devez mettre en place un système basé sur une boucle dans votre programme Java. Cette boucle sera active tant que la fenêtre WINDEV sera ouverte et permettra d'intercepter chaque action de l'utilisateur.

Pour connaître le type d'action de l'utilisateur, vous disposez d'une variable de type chaîne de caractères (en WLangage) nommée **'WDTouche**'. Cette variable sera utilisée dans votre code WLangage pour signaler au programme Java quel bouton a par exemple été actionné.

**Exemple : Code Java**


```txt
/* ouverture de la première fenêtre du programme contenant le menu */
	APPELWD("Ouvre,menufc.wdw");
	/* le programme boucle jusqu'à ce que le choix Fichier Quitte
	soit sélectionné */
	boolean bSaisie = true;
	while (bSaisie)
	{
		/* on effectue la saisie du menu */
		APPELWD("Ecran,Saisie");
		/* le compte-rendu WDTouche vaut *M* lorsque un choix de menu
		a été sélectionné */
		if (WDTouche().equals("*M*"))
		{
		...
		}
	}
	APPELWD("FERME");
```


**Code d'interception de la sélection du menu "Fichier..Quitter" de la fenêtre WINDEV "Menu" :**


```txt
String szOption = WDTouche();
if (szOption.equals("FQ"))
{
	bSaisie = false;
}
```


Lorsque l'utilisateur cliquera sur l'option de menu "Fichier .. Quitter" :

- la fonction **WDTouche** renverra "\*M\*".

- la fonction **WDChaîne** renverra les lettres d'appel dans l'ordre de sélection des menus. Dans notre exemple, **WDChaîne** renvoie "FQ".






<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Mettre fin à l'application
<a name="mettre_fin_application_ELTTEXTE000249"></a>
Pour terminer l'utilisation de l'interface externe, il suffit de saisir les lignes de code suivantes :


```txt
/* Terminer... */
WDTermine();
/* équivalent à : Windev.WDTermine(); */
```





