
## Affiche (Langage externe)

***En anglais : Display***



<a name="XUtilisation"></a>
<a name="Utilisation"></a>
<a name="description"></a>
Affiche une valeur dans un champ ou affecte une valeur dans une variable.

**Remarque** : En WLangage, pour affecter une valeur à un champ, une simple affectation suffit.
<a name="XSYNTAXE"></a>
<a name="SYNTAXE1"></a>

## Syntaxe

`Affiche([<Nom de la fenêtre>, ] <Nom> [, <Indice 1> [, <Indice 2>]] , <Valeur>)`
---

**`<Nom de la fenêtre> : (Chaîne de caractères (optionnelle))`**

Nom de la fenêtre où l'élément doit être affiché. Ce paramètre doit être spécifié uniquement si cette fenêtre est différente de celle en cours. Par exemple, le champ "Nom" appartient à la fenêtre FEN_Fiche qui n'est pas la fenêtre en cours.

**`<Nom> : (Chaîne de caractères)`**

Nom du champ à afficher ou le nom de la variable à affecter dans la fenêtre.

**`<Indice 1> : (Chaîne de caractères (optionnelle))`**

Indice dans le cas d'un champ indicé ou d'une variable indicée.

**`<Indice 2> : (Chaîne de caractères (optionnelle))`**

Indice dans le cas d'une variable indicée à deux dimensions.

**`<Valeur> : (Chaîne de caractères)`**

Valeur du champ à afficher ou de la variable à affecter.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Remarques




### Affectation de variable
<a name="affectation_variable_ELTPARAGRAPHE000036"></a>Lors d'une affectation de variable, le paramètre &lt;Valeur&gt; doit être passé à APPELWD sous forme texte, même si la variable est de type numérique :

AFFICHE,&lt;Nom de variable&gt;[,Indice&gt;]=&lt;Texte&gt;

Le séparateur décimal est le point.

Exemple en C :


```txt
// Affectation de 100.12 dans la variable PrixHT de type réel
APPELWD("AFFICHE,PRIXHT=100.12");
// Affichage de Vendredi dans la variable NomJour de type Chaine
APPELWD("AFFICHE,NOMJOUR=Vendredi");
// Passage de la valeur à afficher par variable
APPELWD("AFFICHE,PRIXHT=%d",Prix);
APPELWD("AFFICHE,NOMJOUR=%s",Jour);
```


Exemple en Pascal :


```txt
(*Affectation de 100.12 dans la variable PrixHT de type réel *)
APPELWD('AFFICHE,PRIXHT=100.12');
(*affichage de Vendredi dans la variable NomJour de type Chaine *)
APPELWD('AFFICHE,NOMJOUR=Vendredi');
(*passage de la valeur à afficher par variable *)
APPELWD('AFFICHE,PRIXHT='+Prix);
APPELWD('AFFICHE,NOM='+NomCli);
```


Exemple en VB :


```txt
'Affectation de 100.12 dans la variable PrixHT de type réel
call APPELWD("AFFICHE,PRIXHT=100.12")
'affichage de Vendredi dans la variable NomJour de type Chaine
call APPELWD("AFFICHE,NOMJOUR=Vendredi")
'passage de la valeur à afficher par variable
call APPELWD("AFFICHE,PRIXHT="+Prix)
call APPELWD("AFFICHE,NOMJOUR="+Jour)
```



<a name="NOTE0_2"></a>




### Champ de saisie
<a name="champ_saisie_ELTPARAGRAPHE000067"></a>&lt;Valeur&gt; doit être passée à APPELWD sous forme texte, même si le champ est de type numérique :

AFFICHE,&lt;Nom du champ&gt;[,&lt;Indice&gt;]=&lt;Texte&gt;

Le séparateur décimal est le point.

Exemple en C :


```txt
// Affichage de la valeur 100,12 dans le champ numérique PRIX
APPELWD("AFFICHE,PRIX=100.12");
// Affichage de Vendredi dans le champ indicé JOUR à l'indice 31
APPELWD("AFFICHE,JOUR,31=Vendredi");
//Passage de la valeur à afficher par variable
APPELWD("AFFICHE,NOM=%s",NomCli);
```


Exemple en Pascal :


```txt
(*Affectation de 100.12 dans la variable PrixHT de type réel *)
APPELWD('AFFICHE,PRIXHT=100.12');
(*affichage de Vendredi dans la variable NomJour de type Chaine *)
APPELWD('AFFICHE,NOMJOUR=Vendredi');
(*passage de la valeur à afficher par variable *)
APPELWD('AFFICHE,PRIXHT='+Prix);
APPELWD('AFFICHE,NOM='+NomCli);
```


Exemple en VB :


```txt
'Affichage de la valeur 100,12 dans le champ numérique PRIX
call APPELWD("AFFICHE,COMPTEUR=100.12")
'Affichage de Vendredi dans champ indicé JOUR à l'indice 31
call APPELWD("AFFICHE,JOUR,31=Vendredi")
'Passage de la valeur à afficher par variable
call APPELWD("AFFICHE,NOM="+NomCli)
```


Note: Pour les textes longs (supérieurs à 200 caractères), utilisez la fonction AfficheTexteLong.


<a name="NOTE0_3"></a>




### Champ Libellé
<a name="champ_libelle_ELTPARAGRAPHE000100"></a>&lt;Valeur&gt; est le nouveau libellé à afficher :

```txt
AFFICHE,<Nom du champ>=<Texte>
```


Le séparateur décimal est le point.

Exemple en C : 

```txt
APPELWD("AFFICHE,LibTexte=Nom du client");
```


Exemple en Pascal :

```txt
APPELWD('AFFICHE,LibTexte=Nom du client');
```


Exemple en VB :

```txt
Call APPELWD("AFFICHE,LibTexte=Nom du client")
```



<a name="NOTE0_4"></a>




### Interrupteur ou case à cocher
<a name="interrupteur_case_cocher_ELTPARAGRAPHE000125"></a>Pour cocher l'interrupteur, &lt;Valeur&gt; peut être égale à la chaîne "O" ou "1" :

```txt
AFFICHE,<Nom du champ>[,<Indice>]="O"
AFFICHE,<Nom du champ>[,<Indice>]="1"
```


Pour décocher l'interrupteur, &lt;Valeur&gt; peut être égale à la chaîne "N" ou "0" :

```txt
AFFICHE,<Nom du champ>[,<Indice>]="N"
AFFICHE,<Nom du champ>[,<Indice>]="0"
```


Exemple en C :

```txt
APPELWD("AFFICHE,INTERR=O");  // Marque
APPELWD("AFFICHE,TABINTERR,2=N"); // Démarque
```


Exemple en Pascal :

```txt
APPELWD('AFFICHE,INTERR=O');(* Marque   *)
APPELWD('AFFICHE,TABINTERR,2=N'); (* Démarque *)
```


Exemple en VB : 

```txt
Call APPELWD("AFFICHE,INTERR,2=O") 'Marque
Call APPELWD("AFFICHE,TABINTERR,2=N") 'Démarque
```



<a name="NOTE0_5"></a>


### Sélecteur ou case d'options
<a name="selecteur_case_options_ELTPARAGRAPHE000151"></a>&lt;Valeur&gt; est le numéro de l'option à sélectionner :

```txt
AFFICHE,<Nom du champ>=<Numéro de l'option>
```


Exemple en C :

```txt
APPELWD("AFFICHE,SELECT=1");   // option 1 en cours
APPELWD("AFFICHE,TYPECLI=3");  // option 3 en cours
```


Exemple en Pascal :

```txt
APPELWD('AFFICHE,SELECT=1');  (*option 1 en cours*)
APPELWD('AFFICHE,TYPECLI=3');  (*option 3 en cours*)
```


Exemple en VB :

```txt
Call APPELWD("AFFICHE,SELECT=1") 'option 1 en cours
Call APPELWD("AFFICHE,TYPECLI=3") 'option 3 en cours
```



<a name="NOTE0_6"></a>




### Bouton texte et bouton graphique
<a name="bouton_texte_bouton_graphique_ELTPARAGRAPHE000174"></a>&lt;Valeur&gt; peut être le nouveau libellé du bouton : 

```txt
AFFICHE,<Nom du champ>=<Libellé du bouton>
```


&lt;Valeur&gt; peut être la nouvelle image du bouton : 

```txt
AFFICHE,<Nom du champ>=<Image du bouton>
```


Exemple en C : 

```txt
APPELWD("AFFICHE,BTOK=Valider");
APPELWD("AFFICHE,BTOK=IMGOK.BMP");
```


Exemple en Pascal :

```txt
APPELWD('AFFICHE,BTOK=VALIDER');
APPELWD('AFFICHE,BTOK=IMGOK.BMP');
```


Exemple en VB :

```txt
call APPELWD("AFFICHE,BTOK=VALIDER")
call APPELWD("AFFICHE,BTOK=IMGOK.BMP")
```



<a name="NOTE0_7"></a>




### Image
<a name="image_ELTPARAGRAPHE000201"></a>&lt;Valeur&gt; peut être le nom du fichier image à afficher. 

```txt
AFFICHE,<Nom du champ>=<Nom du fichier image>
```


Exemple en C :

```txt
APPELWD("AFFICHE,Photo=VIDAL.BMP");
```


Exemple en Pascal :

```txt
APPELWD('AFFICHE,PHOTO=VIDAL.BMP');
```


Exemple en VB :

```txt
Call APPELWD("AFFICHE,PHOTO=VIDAL.BMP")
```



<a name="NOTE0_8"></a>




### Ascenseur ou barre de défilement
<a name="ascenseur_barre_defilement_ELTPARAGRAPHE000224"></a>&lt;Valeur&gt; correspond à la position de l'ascenseur :

```txt
AFFICHE,<Nom du champ>=<Position>
```


Exemple en C :

```txt
APPELWD("AFFICHE,ASCENS=35");  // position 35
```


Exemple en Pascal :

```txt
APPELWD('AFFICHE,ASCENS=35');  (*position 35*)
```


Exemple en VB :

```txt
Call APPELWD("AFFICHE,ASCENS=35")  'position 35
```



<a name="NOTE0_9"></a>




### Liste déroulante ou liste déroulée
<a name="liste_deroulante_liste_deroulee_ELTPARAGRAPHE000247"></a>Si &lt;Indice&gt; est précisé :

```txt
AFFICHE,<Nom du champ>,<Indice>=<Valeur>
```


- si &lt;Indice&gt; est supérieur au nombre d'éléments de la liste, la valeur est ajoutée dans la liste

- si &lt;Indice&gt; est inférieur ou égal au nombre d'éléments de la liste, la valeur est modifiée à l'indice précisé.




Si l'indice n'est pas précisé :

```txt
AFFICHE,<Nom du champ> = <Valeur>
```

L'élément en cours devient l'élément dont l'indice correspond à la valeur passée en paramètre.

Pour les combos avec saisie, la valeur sera affichée dans le champ de saisie.

Exemple en C : 

```txt
APPELWD("AFFICHE,COMBO1,5=DUPOND");  
// DUPOND inséré à l'indice 5
```


Exemple en Pascal :

```txt
APPELWD('AFFICHE,COMBO1,5=DUPOND');
(* DUPOND inséré à l'indice 5 *)
```


Exemple en VB :

```txt
Call APPELWD("AFFICHE,COMBO1,5=DUPOND")
' DUPOND inséré à l'indice 5
```





