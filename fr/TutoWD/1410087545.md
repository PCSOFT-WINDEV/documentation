
## Leçon 6.2. Audits du projet
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Ce que vous allez apprendre dans cette leçon
<a name="que_vous_allez_apprendre_dans_cette_lecon_ELTTEXTE000367"></a>


- Qu'est-ce qu'un audit et à quoi ça sert ? 

- Lancer et analyser l'audit statique.

- Lancer et analyser l'audit dynamique.





|   |   |
| --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=dur%E9e.png)<br> | <br>Durée estimée : 15 mn |

| [Leçon précédente](../TutoWD/1410087544.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087546.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Qu'est-ce qu'un audit ?
<a name="questce_quun_audit_ELTTEXTE000414"></a>
Les audits apportent une série de fonctionnalités permettant :

- d'améliorer automatiquement la qualité et les performances d'un projet.

- de suivre plus précisément ses conditions de mise en exploitation.




Deux types d'audits sont disponibles :

- **L'audit statique**. L'audit statique consiste en une analyse détaillée d'un projet et de ses éléments. Cet audit est effectué directement depuis l'éditeur de projet.

- **L'audit dynamique**. L'audit dynamique est une analyse du comportement d'un projet pendant son exécution. Cet audit peut être réalisé en mode test ou directement dans l'environnement de production.




Nous allons tout de suite tester ces audits sur le projet "WD Optimisation".

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Audit statique
<a name="audit_statique_ELTTEXTE000438"></a>
L'audit statique est une fonctionnalité de l'environnement permettant d'analyser les sources d'un projet pour détecter différents problèmes et proposer des améliorations.



- Pour lancer l'audit statique sur le projet "WD Optimisation" :

	1. Sous le volet "Projet", dans le groupe "Audit et performances", déroulez "Audit statique" et sélectionnez "Déclencher l'audit statique".
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | L'audit statique du projet peut également être lancé depuis le Tableau de bord du projet, via le Widget "Audit statique et Compilation". <br><br>Il suffit de :<br><br>		- activer le Widget si nécessaire (cliquez sur le lien "Cliquez ici pour réactiver").<br><br>		- cliquer sur la flèche. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P6_Audit%20statique%20-%20HC%20N%B0001.jpg)<br><br><br><br> |





	2. L'assistant se lance. Nous allons définir la cible de l'audit statique. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P6_Audit%20statique%20-%20HC%20N%B0002.jpg&type=thumb)


	3. Sélectionnez l'option "Lancer l'audit statique sur le projet complet".

4. Validez l'assistant.

5. Le rapport d'audit est affiché : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P6_Audit%20statique%20-%20HC%20N%B0003.jpg&type=thumb)


L'audit statique se compose de :

- L'audit statique du projet.

- L'audit du contenu de la bibliothèque de l'application.

- L'audit du contenu de l'installation.




- Examinons avec attention les points présentés par ce rapport.



<a name="NOTE3_2A"></a>


### Champ Table (UI)
<a name="champ_table_ELTPARAGRAPHE000087"></a>Dans notre projet, l'audit nous indique qu'un champ Table utilise le mode 'loupe' pour la recherche. Ce mode permet une recherche de type 'Commence par'. L'audit conseille d'utiliser par défaut un filtre de type 'Contient' pour la recherche. 

Les projets développés avec WINDEV ont souvent plusieurs années. Il arrive donc que ces projets utilisent des technologies datant de la création du projet (technologies aujourd'hui dépassées ou remplacées par des technologies plus sécurisées), des options devenues inutiles ou peu performantes. 

Dans cet exemple, le champ Table propose par défaut une recherche de type 'Commence par' qui peut être remplacée par une recherche de type 'Contient', beaucoup plus courante et utile pour les utilisateurs.  

- Pour traiter ce problème :

	1. Cliquez sur le bouton [...] pour obtenir plus de renseignements. La fenêtre listant les améliorations de l'UI est affichée. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P6_Audit%20statique%20-%20HC%20N%B0006.jpg)


	2. Dans la fenêtre "FEN_FenêtreInutilisée", le champ "TABLE_Produit" peut être amélioré. Cette fenêtre permet de :

	- effectuer l'amélioration (bouton "Améliorer"). Dans ce cas, l'amélioration est immédiatement effectuée. 

	- ignorer l'amélioration (bouton "Ignorer"). Dans ce cas, l'amélioration ne sera plus proposée. 




- Dans la fenêtre de l'audit statique, cliquez sur le bouton "Rafraîchir" pour mettre à jour le rapport d'audit.



<a name="NOTE3_2"></a>


### Procédure non exécutée
<a name="procedure_non_executee_ELTPARAGRAPHE000117"></a>Dans notre projet, l'audit nous indique qu'une procédure n'est jamais exécutée.

Il arrive fréquemment dans des projets importants, de créer une ou plusieurs procédures pour réaliser un traitement, puis suite à une réorganisation du code, la procédure n'est plus utilisée mais reste dans le projet. La présence de procédures non utilisées alourdit inutilement les ressources distribuées aux utilisateurs finaux.

- Pour traiter ce problème :

	1. Cliquez sur le bouton [...] pour obtenir plus de renseignements. La fenêtre listant les codes morts apparaît. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P6_Audit%20statique%20-%20HC%20N%B0004.jpg)


	2. La procédure "ProcédureObsolète" n'est jamais appelée. Cette fenêtre permet de :

	- spécifier que la procédure est tout de même utilisée (bouton "Marquer comme utile"). Dans ce cas, la procédure ne sera plus prise en compte lors de l'audit.

	- supprimer la procédure si elle est réellement inutilisée (bouton "Supprimer").

	- voir la procédure (bouton "Voir").

	- rechercher les cas d'utilisation dans les chaînes par exemple (bouton "Rechercher").




- Dans la fenêtre de l'audit statique, cliquez sur le bouton "Rafraîchir" pour mettre à jour le rapport d'audit.



<a name="NOTE3_3"></a>


### Elément orphelin
<a name="element_orphelin_ELTPARAGRAPHE000168"></a>L'audit nous indique que notre projet contient un élément orphelin.

Comme pour les procédures exécutées, il arrive fréquemment de créer des fenêtres, des états afin d'effectuer un test rapide, de les enregistrer et de les oublier. La présence d'éléments orphelins dans l'exécutable alourdit inutilement les ressources distribuées aux utilisateurs finaux.

- Pour traiter ce problème :

	1. Cliquez sur le bouton [...] pour obtenir plus de renseignements. La fenêtre listant les éléments orphelins apparaît. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P6_Audit%20statique%20-%20HC%20N%B0005.jpg)


	2. La fenêtre "FEN_FenêtreInutilisée" n'est jamais appelée. La fenêtre listant les éléments orphelins permet de :

	- spécifier que l'élément est tout de même utilisé (bouton "Marquer comme utile"). Dans ce cas, la fenêtre de notre exemple ne sera plus prise en compte lors de l'audit. Cette option peut être intéressante par exemple dans le cas d'une fenêtre de test spécifique au développement.

	- supprimer l'élément s'il est réellement inutilisé (bouton "Supprimer").

	- voir l'élément (bouton "Voir").

	- rechercher les cas d'utilisation dans les chaînes par exemple (bouton "Rechercher").




- Dans la fenêtre de l'audit statique, cliquez sur le bouton "Rafraîchir" pour mettre à jour le rapport d'audit.



<a name="NOTE3_4"></a>


### Nettoyage du projet
<a name="nettoyage_projet_ELTPARAGRAPHE000218"></a>Notre projet contient plusieurs fichiers inutilisés. Il est possible de nettoyer le projet pour ne conserver que les éléments nécessaires. L'exécutable et l'installation client ne sont pas alourdis avec des images, fichiers externes (ou autres) non utilisés.

- Pour traiter ce problème :

	1. Cliquez sur le bouton [...] pour obtenir plus de renseignements.

	2. L'assistant de nettoyage de projet se lance. Cet assistant indique les fichiers inutilisés qui peuvent être supprimés.

	3. Passez à l'étape suivante.

	4. Indiquez le type de nettoyage à réaliser. Il est possible de :

		- créer un fichier zip avec les fichiers inutiles.

		- déplacer les fichiers inutiles dans un répertoire spécifique.




5. Validez l'option proposée par défaut et passez à l'étape suivante.

6. Terminez l'assistant.




Nous avons optimisé notre projet en suivant tous les conseils de l'audit statique.

L'audit statique permet d'avoir un état général sur les sources de votre projet. Notre conseil : lancez-le régulièrement !

Maintenant, voyons ce qui se passe en exécution en lançant l'audit dynamique.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Audit dynamique
<a name="audit_dynamique_ELTTEXTE000504"></a>
L'audit dynamique permet d'analyser l'exécution de l'application. L'audit permettra de déceler des problèmes tels que :

- Consommation excessive de mémoire,

- Lenteurs des algorithmes utilisés,

- Erreurs "masquées" lors de l'exécution,

- etc.


Un audit dynamique peut être effectué dans un environnement de test ou sur une application en production.

Le projet "WD Optimisation" contient une fenêtre spécifique provoquant des erreurs pouvant être détectées par l'audit dynamique.

Nous allons lancer l'audit dynamique en même temps que le test du projet.

- Pour lancer l'audit dynamique sur le projet "WD Optimisation" :

	1. Sous le volet "Projet", dans le groupe "Mode test", déroulez "Mode test" et sélectionnez "Déboguer le projet avec l'audit activé". Le test du projet se lance.
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | L'audit dynamique du projet peut également être lancé depuis le Tableau de bord du projet, via le Widget "Audit dynamique". Il suffit de :<br><br>		- activer le Widget si nécessaire (cliquez sur le lien "Cliquez ici pour réactiver").<br><br>		- dérouler la flèche et de sélectionner "Go minutieux du projet". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P6_Audit%20dynamique%20-%20HC%20N%B0001.jpg)<br><br><br><br>Remarque : A chaque lancement de l'application par un GO du projet, l'audit dynamique est automatiquement exécuté. Un compte-rendu est automatiquement affiché dans le tableau de bord du projet : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P6_Audit%20dynamique%20-%20HC%20N%B0003.jpg)<br> |





	2. Cliquez sur le bouton "Fenêtre de test de l'audit dynamique".

	3. Cliquez sur les différents boutons présents dans la fenêtre. A la fin de chaque traitement, un message sous forme de toast est affiché pour indiquer que le traitement est terminé. Pour l'option "Assertion et Exception", une assertion est affichée : cliquez sur "Continuer" pour voir apparaître le message sous forme de toast.

	4. Arrêtez le test de l'application.

	5. La fenêtre de compte-rendu de l'audit dynamique s'affiche.






![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P6_Audit%20dynamique%20-%20HC%20N%B0002.jpg&type=thumb)


- Examinons cette fenêtre :

	- La partie haute de cette fenêtre permet de choisir le mode d'affichage des données. Il est possible de :

		- choisir un affichage chronologique (respectant l'ordre d'arrivée des événements) ou un affichage synthétique, permettant de regrouper les différents types de problèmes. Dans ce cas, la frise chronologique permet de voir la position et l'importance des problèmes.

		- choisir le type de problème à afficher (erreur, assertion, etc.). Il est ainsi par exemple possible de se concentrer uniquement sur les erreurs graves, etc.




- La partie basse de cette fenêtre affiche les différents événements survenus pouvant poser problème dans l'application.




- Dans cet exemple, l'audit dynamique détecte plusieurs problèmes :

	- Un libellé trop long affecté par programmation,

	- Une boucle de type SELON dont aucun CAS n'est exécuté,

	- Une assertion déclenchée au lieu d'une exception,

	- L'ouverture d'un fichier qui n'existe pas,

	- L'affectation d'un fichier image qui n'existe pas à un champ Image.


 Pour chaque problème, un bouton "..." permet d'accéder au détail de l'événement enregistré.  Si l'événement est relié à une ligne de code particulière, le bouton ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P6_Audit%20dynamique%20-%20HC%20N%B0002%201.jpg)
 permet d'ouvrir directement l'éditeur de code à l'emplacement correspondant afin de corriger le problème.




- Fermez la fenêtre de l'audit dynamique.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | L'audit dynamique d'un projet peut également être effectué lorsqu'une application est déployée sur les postes clients.<br><br>Il est possible :<br><br>- soit de modifier l'application et d'utiliser la fonction [dbgActiveAudit](../WDLang1/1000018835.md) pour lancer l'audit.<br><br>- soit d'utiliser un fichier texte dans le répertoire de l'application. Cette solution permet de ne pas modifier l'exécutable. Il suffit de créer dans le même répertoire que l'exécutable un fichier portant le même nom que l'exécutable et d'extension ".WX".<br><br><br>L'audit génère un fichier ".wdaudit", ce fichier doit être chargé dans l'environnement de développement pour analyser le résultat.<br><br>Pour plus de détails, consultez [Audit dynamique](../Editeurs/1014502.md).<br><br> |





| [Leçon précédente](../TutoWD/1410087544.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087546.md) |
| --- | --- | --- |




