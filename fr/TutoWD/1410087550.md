
## Leçon 7.3. Manipuler des fichiers externes 
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Ce que vous allez apprendre dans cette leçon
<a name="que_vous_allez_apprendre_dans_cette_lecon_ELTTEXTE000249"></a>


- Manipuler des fichiers texte (CSV , etc.).

- Manipuler des répertoires.

- Manipuler des fichiers XML.

- Manipuler des fichiers XLS.





|   |   |
| --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=dur%E9e.png)<br> | <br>Durée estimée : 20 mn |

| [Leçon précédente](../TutoWD/1410087549.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087551.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000296"></a>
WINDEV permet de manipuler simplement les formats les plus courants de données : 

- fichiers texte (fichiers INI, CSV, etc.),  

- fichiers XML,

- fichiers XLS, etc. 


De nombreuses familles de fonctions WLangage permettent aussi bien de lire ces fichiers que de créer ces fichiers. Vous pouvez ainsi lire facilement dans vos applications WINDEV des données générées par d'autres logiciels ou encore créer des fichiers nécessitant un formatage particulier.

De plus, le WLangage propose également une famille de fonctions permettant de manipuler les répertoires où sont présents les fichiers.

Dans ce chapitre, nous nous consacrerons plus particulièrement :

- aux fichiers Texte (fichiers texte, fichiers INI et fichiers CSV),

- aux fichiers XML,

- aux fichiers XLS,

- à la gestion des répertoires.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Manipulation des fichiers texte ou CSV
<a name="manipulation_des_fichiers_texte_csv_ELTTEXTE000320"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000047"></a>Les fichiers externes sont souvent appelés fichiers texte ou encore fichiers à accès direct. Ce type de fichier contient généralement du texte, mais il peut également contenir des informations binaires telles que des images, des sons, etc.

Dans cette leçon comme dans toute la documentation de WINDEV, nous parlerons de **fichiers externes**.

WINDEV permet de manipuler en programmation les fichiers externes. Les fonctions du WLangage permettent de créer, lire, manipuler des fichiers externes. Toutes les fonctions peuvent être très facilement identifiées : elles commencent toutes par la lettre "f".

Dans un fichier externe, il n'y a pas nécessairement de notion "d'enregistrement". Pour pouvoir manipuler un fichier externe, il faut en connaître la structure, c'est-à-dire connaître l'agencement des données qui se trouvent à l'intérieur du fichier.

Les fichiers CSV sont simplement des fichiers texte utilisant une structure spécifique. Ils sont donc manipulables comme les fichiers textes.

Les fichiers .INI sont également des fichiers texte utilisant une structure spécifique. Pour les manipuler, WINDEV dispose de deux fonctions spécifiques : [INILit](../WDLang1/3013043.md) et [INIEcrit](../WDLang1/3013039.md).
<a name="NOTE3_2"></a>


### Exemple pratique
<a name="exemple_pratique_ELTPARAGRAPHE000070"></a>

- Ouvrez l'exemple unitaire "Manipulation de fichiers texte". 




- Testez la fenêtre "FEN_Fichier_Texte". Cette fenêtre regroupe de nombreuses manipulations possibles sur les fichiers externes avec WINDEV. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P7_Exemple%20Fichiers%20Texte%20-%20HC%20N%B0001.jpg&type=thumb)



Les différents boutons de la fenêtre proposent :

- La création d'un fichier texte.

- La lecture et écriture dans un fichier texte.

- Des manipulations de fichiers existants (copie, suppression, lecture d'informations, etc.). 

- La copie d'un fichier texte.




Pour plus de détails sur les fonctions de gestion des fichiers externes, consultez [Fonctions de gestion des répertoires et des fichiers externes](../WDLang1/3036034.md).

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Manipulation des répertoires
<a name="manipulation_des_repertoires_ELTTEXTE000350"></a>
Pour manipuler les répertoires et leurs fichiers, le WLangage propose de nombreuses fonctions.
<a name="NOTE4_2"></a>


### Exemple pratique
<a name="exemple_pratique_ELTPARAGRAPHE000099"></a>

- Ouvrez si nécessaire l'exemple unitaire "Manipulation des répertoires" et testez la fenêtre correspondante.




- Cette fenêtre regroupe les manipulations possibles sur les disques et les répertoires :

	- créer un répertoire,

	- connaître le répertoire en cours,

	- tester l'existence d'un répertoire,

	- lister des répertoires,

	- copier et supprimer un répertoire, etc.







Pour plus de détails sur les fonctions de gestion des répertoires, consultez [Fonctions de gestion des répertoires et des fichiers externes](../WDLang1/3036034.md).

<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Manipulation des fichiers XML
<a name="manipulation_des_fichiers_xml_ELTTEXTE000380"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000121"></a>XML (Extensible Markup Language, ou Langage Extensible de Balisage) est un langage de balisage, c'est-à-dire un langage qui présente de l'information encadrée par des balises. XML est un **métalangage** qui permet d'inventer de nouvelles balises pour isoler toutes les informations élémentaires que peut contenir une page Web.

XML permet de structurer un document contenant des données. Un fichier de données HFSQL contenant plusieurs rubriques et enregistrements peut, par exemple, être exporté dans un fichier XML (fonctions **XML\***).

WINDEV gère en standard :

- les exportations vers le XML (fonctions [TableVersXML](../WDLang1/3074037.md), [TexteVersXML](../WDLang5/3081006.md), [HExporteXML](../WDLang4/3044069.md)).

- l'import de données XML (fonction [HImporteXML](../WDLang4/3044007.md)).

- la manipulation d'un document XML grâce au type avancé [XMLDocument](../WDLang5/1000018782.md) et aux fonctions WLangage commençant par XML.




Il est également possible de manipuler directement le fichier XML dans l'éditeur de code. Il suffit de :

1. "Dropper" le fichier XML depuis l'explorateur de fichier vers le volet "Explorateur de projet", dossier "Descriptions externes".

2. "Dropper" le fichier XML présent dans le volet "Explorateur de projet" vers l'éditeur de code. La variable de type xmlDocument est alors automatiquement créée de la manière suivante :
	
	```txt
	<Nom de la variable> est un xmlDocument , description =  <Nom du document>
	```


3. Vous pouvez maintenant accéder directement aux noeuds de la variable par leurs noms. Ces noms sont proposés automatiquement par le mécanisme de complétion automatique de l'éditeur de code.



<a name="NOTE5_2"></a>


### Exemple pratique
<a name="exemple_pratique_ELTPARAGRAPHE000159"></a>

- Ouvrez l'exemple unitaire "Lecture et écriture au format XML". 




- Testez la fenêtre "FEN_ManipulationXML". Cette fenêtre permet de :

	- créer un fichier XML. Ce fichier est créé grâce aux fonctions XML. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P7_Exemple%20fichier%20XML%20-%20HC%20N%B0001.jpg&type=thumb)


	- lire un fichier XML.




- Consultez le code associé à chaque bouton.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | Nous ne détaillerons pas ici toutes les fonctionnalités proposées par les fonctions XML. <br>Pour plus de détails, consultez [Fonctions XML](../WDLang5/3081005.md). |





<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Manipulation des fichiers XLS
<a name="manipulation_des_fichiers_xls_ELTTEXTE000428"></a>
Pour manipuler les fichiers Excel, WINDEV met à votre disposition :

- les fonctions xlsXXX. Ces fonctions permettent de lire les données présentes sur les différentes feuilles d'un fichier Excel.

- les variables avancées de type xlsDocument, xlsLigne, xlsColonne, xlsCellule.



<a name="NOTE6_2"></a>


### Exemple pratique
<a name="exemple_pratique_ELTPARAGRAPHE000192"></a>Un test rapide des possibilités de ces fonctions ?



- Pour tester l'utilisation des fonctions xlsXXX, ouvrez l'exemple unitaire "Les fonctions Excel".




- Testez la fenêtre "FEN_FonctionXLS". Cette fenêtre permet :

	- d'importer des données provenant d'une feuille Excel.

	- d'exporter les données d'un champ Table vers Excel.


 Retournez sous l'éditeur pour consulter le code des différents champs Bouton présents dans la fenêtre.




- Pour tester l'utilisation des variables avancées, ouvrez l'exemple unitaire "Type xls". 




- Testez la fenêtre "FEN_Type_xls". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P7_Exemple%20fichier%20XLS%20-%20HC%20N%B0001.jpg&type=thumb)





- Retournez sous l'éditeur pour consulter le code des différents champs Bouton présents dans la fenêtre.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | Nous ne détaillerons pas ici toutes les fonctionnalités proposées par les fonctions XLS et les types avancés. <br>Pour plus de détails, consultez [Fonctions de gestion des fichiers XLS](../WDLang5/3080009.md). |





| [Leçon précédente](../TutoWD/1410087549.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087551.md) |
| --- | --- | --- |




