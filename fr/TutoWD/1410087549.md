
## Leçon 7.2. Gestion automatique des erreurs
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Ce que vous allez apprendre dans cette leçon
<a name="que_vous_allez_apprendre_dans_cette_lecon_ELTTEXTE000161"></a>


- Qu'est-ce que la gestion automatique des erreurs ?

- Utilisation de la gestion automatique des erreurs.





|   |   |
| --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=dur%E9e.png)<br> | <br>Durée estimée : 10 mn |

| [Leçon précédente](../TutoWD/1410087548.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087550.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000208"></a>
WINDEV peut gérer automatiquement les erreurs. Cette fonctionnalité permet à la fois de réduire sensiblement le code d'un projet tout en uniformisant et en centralisant la gestion des erreurs.

L'utilisation de cette fonctionnalité rend également le code plus lisible.
<a name="NOTE2_2"></a>


### Fonctionnement
<a name="fonctionnement_ELTPARAGRAPHE000030"></a>Lorsqu'une fonction du WLangage rencontre une erreur, deux opérations sont réalisées :

- une valeur de retour d'erreur est renvoyée par la fonction (par exemple, la fonction [fOuvre](../WDLang1/3036036.md) renvoie la valeur "-1" si le fichier spécifié n'a pu être ouvert).

- l'erreur est détectée par le WLangage (la variable ***ErreurDétectée*** correspond à <u><u><u><u>Vrai</u></u></u></u>) et il est possible de récupérer des informations sur cette erreur grâce à la fonction [ErreurInfo](../WDLang1/3013008.md).




C'est cette seconde opération qui peut être gérée en automatique grâce à la gestion des erreurs de WINDEV.
<a name="NOTE2_3"></a>


### Mise en place
<a name="mise_place_ELTPARAGRAPHE000052"></a>Le paramétrage de la gestion automatique des erreurs peut s'effectuer :

- soit directement dans l'éditeur de code : il suffit de cliquer sur le lien "Si erreur : Par programme" dans l'éditeur de code : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P7_Gestion%20automatique%20des%20erreurs%20-%20HC%20N%B0004.jpg)


- soit par programmation, avec la fonction [ErreurChangeParamètre](../WDLang1/3034009.md).



<a name="NOTE2_4"></a>


### Types d'erreurs concernées
<a name="types_erreurs_concernees_ELTPARAGRAPHE000066"></a>Le WLangage peut rencontrer deux types d'erreurs :

- les erreurs "non fatales" (appelées également erreurs d'exécution) : ces erreurs sont généralement gérées dans le code et ne provoquent pas l'arrêt de l'application. Par exemple, ouverture d'un fichier inaccessible ou d'une archive inexistante.

- les erreurs "fatales" (appelées également erreurs de programmation) : ces erreurs sont généralement liées à un défaut de conception (accès à un fichier non déclaré, utilisation de champs inexistants, ...). Une erreur "fatale" peut également survenir suite à une erreur "non fatale" mal gérée. Dans ce cas, l'application va s'arrêter.




Le mécanisme de gestion des erreurs permet de gérer de façon bien distincte ces deux types d'erreurs afin de pouvoir spécifier des comportements adaptés aux erreurs rencontrées.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Gestion automatique des erreurs : un exemple didactique
<a name="gestion_automatique_des_erreurs_exemple_didactique_ELTTEXTE000250"></a>


- Pour comprendre les différents cas d'erreurs et leur gestion, nous vous proposons de manipuler un exemple didactique livré en standard avec WINDEV.

	1. Affichez si nécessaire la page d'accueil de WINDEV (Ctrl + &lt;). 

	2. Dans la page d'accueil, cliquez sur "Ouvrir un exemple". La liste des exemples complets, didactiques et unitaires fournis avec WINDEV apparaît.

	3. Dans la zone de recherche, saisissez "Erreur". Seuls les exemples contenant ce mot sont alors listés. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P7_Acc%E8s%20exemples%20-%20HC%20N%B0001.jpg&type=thumb)


	4. Double-cliquez sur "WD Gestion Auto Erreurs". Le projet se charge.




- Ce projet présente la gestion :

	- d'une erreur non fatale (ouverture d'une archive inexistante).

	- d'une erreur fatale (division d'un entier par 0).

	- d'une erreur sur plusieurs niveaux.







- Testez le projet en cliquant sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_Go_Projet_WB_GAF.jpg)
 (parmi les boutons d'accès rapide).

	1. Cliquez sur le choix "Gestion d'une erreur non fatale".

	2. La fenêtre suivante s'affiche. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P7_Gestion%20automatique%20des%20erreurs%20-%20HC%20N%B0001.jpg&type=thumb)


	3. Cliquez sur le bouton "Tester cette gestion d'erreur".

4. Lors de l'exécution de la ligne de code générant l'erreur, un message d'erreur s'affiche et propose à l'utilisateur de réessayer l'opération, d'annuler l'opération ou d'arrêter l'application. L'option "Déboguer" est à utiliser : 

	- en mode test, pour déboguer directement l'application. 

	- en mode exécutable, pour réaliser le débogage d'un exécutable directement depuis WINDEV.




- Cliquez sur le choix "Gestion d'une erreur fatale".

	1. La fenêtre suivante s'affiche. Cette fenêtre permet de tester l'erreur dans le cas de la division d'un entier par 0. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P7_Gestion%20automatique%20des%20erreurs%20-%20HC%20N%B0002.jpg&type=thumb)


	2. Cliquez sur le bouton "Tester cette gestion d'erreur".

3. Lors de l'exécution de la ligne de code générant l'erreur, une procédure est automatiquement appelée. Cette procédure permet d'afficher le message d'erreur et d'arrêter le traitement en cours.

4. Cliquez sur "OK" et fermez la fenêtre.




- Cliquez sur le choix "Gestion d'une erreur sur plusieurs niveaux".

	1. La fenêtre suivante s'affiche. Cette fenêtre permet de tester une erreur sur plusieurs niveaux (traitement appelant une procédure qui ouvre une archive inexistante). 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P7_Gestion%20automatique%20des%20erreurs%20-%20HC%20N%B0003.jpg&type=thumb)


	2. Cliquez sur le bouton "Tester cette gestion d'erreur".

3. Lors de l'exécution de la ligne de code générant l'erreur :

	- la procédure retourne "Faux" au traitement appelant.

	- le traitement appelant affiche un message d'erreur et arrête le traitement.




- Arrêtez le test de l'application.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=exemple-WD.png)<br> | Exemple | WINDEV propose également une gestion automatique des erreurs HFSQL. Pour plus de détails, consultez l'exemple "WD Detection erreurs HFSQL" (exemple didactique), livré en standard avec WINDEV. Cet exemple est accessible depuis la page d'accueil de WINDEV. |





| [Leçon précédente](../TutoWD/1410087548.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087550.md) |
| --- | --- | --- |




