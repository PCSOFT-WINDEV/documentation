
## Leçon 7.4. Compilation dynamique 
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Ce que vous allez apprendre dans cette leçon
<a name="que_vous_allez_apprendre_dans_cette_lecon_ELTTEXTE000098"></a>


- Présentation.

- Tracer une courbe en compilation dynamique.





|   |   |
| --- | --- |
| <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=dur%E9e.png)<br> | <br>Durée estimée : 20 mn |

| [Leçon précédente](../TutoWD/1410087550.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087552.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000145"></a>
La compilation dynamique permet de compiler un code à n'importe quel moment de l'application. Un exemple d'utilisation courant ? Votre application contient une formule paramétrable. Pour changer les paramètres, il n'est pas nécessaire de re-livrer l'exécutable : la modification d'un fichier texte suffit.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Exemple
<a name="exemple_ELTTEXTE000169"></a>
Nous avons choisi de vous présenter la compilation dynamique grâce à l'exemple unitaire "Compilation dynamique".

La fenêtre "Compilation dynamique" montre comment compiler dynamiquement du code WLangage (stocké sous forme de chaîne), exécuter la procédure générée dynamiquement et traiter les éventuelles erreurs d'exécution.

- Pour tester cette fenêtre : 

	1. Ouvrez l'exemple unitaire "Compilation dynamique".

	2. Lancez le test de la fenêtre "FEN_COMPILATION_DYNAMIQUE". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P7_Exemple%20compilation%20dynamique%20-%20HC%20N%B0001.jpg&type=thumb)


	3. Cliquez sur les différents boutons "Exécuter" pour voir les différents cas proposés.

4. Arrêtez le test.




- Retournons sous l'éditeur de code pour étudier le code du premier champ Bouton "Exécuter".

	1. Affichez le code du champ Bouton "Exécuter" (clic droit sur le champ, option "Code"). Ce code appelle la procédure ***CompileCodeDynamique***.

	2. Positionnez le curseur de la souris sur le nom de la procédure et utilisez la touche F2. Le code WLangage de la procédure apparaît automatiquement sous l'éditeur de code.
			Le code de cette procédure peut être décomposé en plusieurs parties :

		1. Initialisation des variables.

		2. Compilation du code.
						
			```wl
			sRésultatCompilation = Compile(PROCEDURE_DYNAMIQUE, SAI_CODE_COMPIL)
			```
Ce code contient plusieurs points à remarquer :

			- La compilation de la fonction est effectuée avec la fonction WLangage [Compile](../WDLang1/3013015.md). Dès que cette fonction est appelée (et si aucune erreur n'est renvoyée), la fonction compilée dynamiquement devient utilisable.

			- Cette fonction admet deux paramètres : le nom de la procédure compilée (ici "PROCEDURE_DYNAMIQUE") et le code à compiler. Ici, le code à compiler est contenu dans le champ de saisie SAI_CODE_COMPIL.

			- Le résultat de la compilation est affecté à une chaîne sRésultatCompilation.




3. Vérification du résultat de la compilation.
						
			```wl
			// Vérifie le résultat de la compilation
			SELON sRésultatCompilation
				// Aucune erreur
				CAS “”
					bRésultatCompilation = Vrai
					LIB_ERREUR_CODE_COMPILE = “”
					
				// Erreur fatale de compilation
				CAS “ERR”
					bRésultatCompilation = Faux
					LIB_ERREUR_CODE_COMPILE = ErreurInfo()
				// Code incorrect
				AUTRE CAS
					bRésultatCompilation = Faux
					LIB_ERREUR_CODE_COMPILE = sRésultatCompilation
			FIN
			```


3. Utilisez la combinaison de touches Ctrl + F2. L'événement "Clic" du champ Bouton "Exécuter" réapparaît sous l'éditeur de code. Dans la suite de ce code, vous pouvez voir que la fonction compilée dynamiquement est exécutée grâce à la fonction [Exécute](../WDLang1/3013041.md).




| [Leçon précédente](../TutoWD/1410087550.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087552.md) |
| --- | --- | --- |




