
## Leçon 4.7. Statistique : champs Graphe et Tableau croisé dynamique
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Ce que vous allez apprendre dans cette leçon
<a name="que_vous_allez_apprendre_dans_cette_lecon_ELTTEXTE000381"></a>


- Afficher les données sous forme de graphe.

- Réaliser des tableaux de synthèse grâce au champ Tableau croisé dynamique.





|   |   |
| --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=dur%E9e.png)<br> | <br>Durée estimée : 30 mn |

| [Leçon précédente](../TutoWD/1410087537.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087539.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000428"></a>
Dans une application de gestion, la présentation de statistiques ou de tableaux récapitulatifs est souvent nécessaire. Ce type de présentation peut être utilisé par exemple pour suivre :

- l'évolution des commandes dans le temps,

- l'évolution du chiffre d'affaires, 

- l'évolution des stocks,

- ...


Tout décideur demande ces informations. 

Pour inclure rapidement et simplement ces informations dans vos applications, WINDEV propose de nombreux champs. Dans cette leçon, nous allons utiliser deux champs spécifiques :

- le champ Graphe.

- le champ Tableau croisé dynamique.




- Ré-ouvrez si nécessaire le projet que vous avez manipulé dans la leçon précédente. 

	1. Affichez la page d'accueil de WINDEV (Ctrl + &lt;).

	2. Dans la page d'accueil, cliquez sur "Tutoriel" puis dans la zone "Partie 4 - Application complète avec données", double-cliquez sur "Application complète - Exercice".

	3. WINDEV vous propose d'ouvrir le projet que vous avez manipulé dans la leçon précédente. Vous pouvez ouvrir le projet présent sur votre poste ou ouvrir le projet original. Choisissez "Ouvrir la copie locale". 





|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=exemple-WD.png)<br> | Corrigé | Un projet corrigé est disponible. Ce projet contient les différents éléments créés dans cette leçon. Pour ouvrir le projet corrigé, dans la page d'accueil, cliquez sur "Tutoriel" puis dans la zone "Partie 4 - Application complète avec données", double-cliquez sur "Application complète - Corrigé". |







<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Affichage de données dans un champ Graphe
<a name="affichage_donnees_dans_champ_graphe_ELTTEXTE000470"></a>
Pour manipuler le champ Graphe en conditions réelles, nous allons réaliser dans l'application "WD Application Complète" un champ Graphe présentant l'état des ventes.

Nous allons tout d'abord réaliser une requête pour sélectionner les données à afficher dans le champ Graphe, puis nous créerons le champ Graphe.
<a name="NOTE3_2"></a>


### Sélection des données à afficher dans le champ Graphe
<a name="selection_des_donnees_afficher_dans_champ_graphe_ELTPARAGRAPHE000059"></a>Pour réaliser notre graphe, nous voulons la somme des commandes effectuées par date.

Nous allons créer une requête qui effectue une somme. En effet, nous allons faire le cumul du montant total des commandes (rubrique TotalTTC dans le fichier de données Commande).

Nous allons calculer le total de toutes les commandes par date (le Chiffre d'Affaires par date).



- Créez une nouvelle requête :

	1. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_Cr%E9er1_GAF.jpg)
 parmi les boutons d'accès rapide.

	2. La fenêtre de création d'un nouvel élément s'affiche : cliquez sur "Requête".

	3. Nous allons réaliser une requête de sélection. Sélectionnez l'option "Sélection (SELECT)". Passez à l'étape suivante.

	4. La fenêtre de description de la requête apparaît.

	5. Ajoutez les rubriques Commande.Date et Commande.TotalTTC à la requête :

		- Sur la gauche, déroulez le fichier de données "Commande".

		- Double-cliquez sur la rubrique Date puis sur la rubrique TotalTTC.

		- Les deux rubriques apparaissent au centre de l'écran (dans la zone "Liste des éléments de votre requête").







- Pour effectuer la somme des valeurs de "Commande.TotalTTC" :

	1. Sélectionnez la rubrique "Commande.TotalTTC" au centre.

	2. Dans les "Actions", sur la droite, cliquez sur "Somme". La fenêtre de description de la somme apparaît. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Graphe%20-%20HC%20N%B0001.jpg&type=thumb)


	3. Validez la description de la somme. La somme des "TotalTTC" a été ajoutée dans la liste du résultat de la requête.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | Au fur et à mesure de la création de la requête, l'éditeur de requêtes de WINDEV crée les requêtes en langage naturel (et également en SQL). <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Graphe%20-%20HC%20N%B0002.jpg)<br>Vous pouvez ainsi vérifier que vous ne vous êtes pas trompé par rapport à l'objectif de votre requête. |







- Nous allons maintenant regrouper les données par année et les trier :

	1. Sélectionnez la rubrique "Commande.Date" au centre.

	2. Dans les "Actions", sur la droite, cliquez sur "Année, département" et sélectionnez "Année". Une fenêtre s'affiche permettant de créer la rubrique Année : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Graphe%20-%20HC%20N%B0003.jpg)


	3. Validez cette fenêtre (bouton "OK").

4. La rubrique "Année" s'affiche au centre de la description de la requête.

5. Sélectionnez la rubrique "Année" et définissez le tri :

	- Affichez le menu contextuel de la rubrique "Année".

	- Sélectionnez l'option "Trier la rubrique .. Trier par ordre croissant".

	- Une flèche indiquant le tri apparaît dans la description de la requête.




- La requête est créée. Nous allons lui donner un nom et la sauvegarder.

	1. En haut de la fenêtre de description de la requête, saisissez : 

		- le nom "REQ_EvolutionsVentes".

		- le libellé "Somme des commandes par date". 




2. Validez la fenêtre de description de la requête. 

3. La fenêtre de sauvegarde apparaît. Validez les informations proposées. 

4. La représentation graphique de la requête est la suivante : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Graphe%20-%20HC%20N%B0004.jpg)



<a name="NOTE3_3"></a>


### Création du champ Graphe
<a name="creation_champ_graphe_ELTPARAGRAPHE000128"></a>Nous allons intégrer le champ Graphe dans un nouveau volet d'onglet de la fenêtre FEN_Menu.

- Pour créer un nouveau volet d'onglet dans la fenêtre "FEN_Menu" :

	1. Affichez si nécessaire la fenêtre "FEN_Menu" sous l'éditeur de fenêtres.

	2. Double-cliquez sur le champ Onglet : la fenêtre de description du champ s'affiche.

	3. Dans l'onglet "Général", sélectionnez le volet d'onglet "Recherche de commandes" et cliquez sur le bouton "Nouveau". Un nouveau volet d'onglet apparaît.

	4. Sélectionnez le nouveau volet d'onglet (nommé "Volet 4").

	5. Dans la partie droite de l'écran, saisissez le libellé du volet d'onglet : "Graphe".

	6. Dans la partie droite de l'écran, sélectionnez une image dans le catalogue d'images :

		- Cliquez sur le bouton ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Multilingue%20-%20HC%20N%B0014%201.jpg)
 à droite du champ "Image". Dans le menu contextuel qui s'affiche, sélectionnez l'option "Catalogue". 

		- La fenêtre du catalogue d'images apparaît.

		- Dans le champ de recherche, saisissez "Graphe". 

		- Lancez la recherche en cliquant sur le bouton avec la loupe.

		- Sélectionnez par exemple l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Graphe%20-%20HC%20N%B0009%201.jpg)
 et validez les différents écrans qui s'affichent.




7. Validez la fenêtre de description du champ Onglet.

8. Un nouveau volet d'onglet apparaît dans la fenêtre.




- Pour créer le champ Graphe :

	1. Dans la fenêtre "FEN_Menu", sélectionnez le volet d'onglet "Graphe" si nécessaire.

	2. Sous le volet "Création", dans le groupe "Champs graphiques", cliquez sur "Graphe". Le champ apparaît sous le curseur de la souris.

	3. Cliquez dans le volet d'onglet "Graphe". L'assistant de création d'un champ Graphe se lance. 

	4. Dans l'assistant, sélectionnez un graphe de type "Histogramme". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Graphe%20-%20HC%20N%B0005.jpg&type=thumb)
Passez à l'étape suivante de l'assistant.

	5. Saisissez les paramètres du graphe :

		- le titre : "Evolution des ventes".

		- la légende : le graphe est sans légende.

		- les étiquettes doivent être affichées. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Graphe%20-%20HC%20N%B0006.jpg&type=thumb)





|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=exemple-WD.png)<br> | Exemple | Pour maîtriser l'utilisation d'un champ Graphe, n'hésitez pas à étudier les exemples fournis avec WINDEV :<br><br>- Exemple unitaire : Le champ Graphe<br><br>- Exemple didactique : WD Graphe<br><br><br>Ces exemples sont disponibles depuis la page d'accueil de WINDEV (Ctrl + &lt;). |





<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Création de tableaux de synthèse grâce au champ Tableau croisé dynamique
<a name="creation_tableaux_synthese_grace_champ_tableau_croise_dynamique_ELTTEXTE000560"></a>
Pour manipuler le champ Tableau croisé dynamique en conditions réelles, nous allons réaliser un champ Tableau croisé dynamique permettant de visualiser les ventes de produits par pays et par an en quantité et en chiffre d'affaires. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20TCD%20-%20HC%20N%B0001.jpg&type=thumb)
Comme pour le champ Graphe, nous allons créer le champ Tableau croisé dynamique dans un nouveau volet d'onglet de la fenêtre FEN_Menu.



- Pour créer un nouveau volet d'onglet dans la fenêtre "FEN_Menu" :

	1. Affichez si nécessaire la fenêtre "FEN_Menu" sous l'éditeur de fenêtres.

	2. Double-cliquez sur le champ Onglet : la fenêtre de description du champ s'affiche.

	3. Dans l'onglet "Général", sélectionnez le volet d'onglet "Graphe" et cliquez sur le bouton "Nouveau". Un nouveau volet d'onglet apparaît.

	4. Sélectionnez le nouveau volet d'onglet (nommé "Volet 5").

	5. Dans la partie droite de l'écran, saisissez le libellé du volet d'onglet : "Tableau croisé dynamique".

	6. Dans la partie droite de l'écran, sélectionnez une image dans le catalogue d'images :

		- Cliquez sur le bouton ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Multilingue%20-%20HC%20N%B0014%201.jpg)
 à droite du champ "Image". Dans le menu contextuel qui s'affiche, sélectionnez l'option "Catalogue". 

		- La fenêtre du catalogue d'images apparaît.

		- Dans le champ de recherche, saisissez "Tableau".

		- Lancez la recherche en cliquant sur le bouton avec la loupe. 

		- Sélectionnez par exemple l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20TCD%20-%20HC%20N%B0001%201.jpg)
 et validez les différents écrans qui s'affichent.




7. Validez la fenêtre de description du champ Onglet.

8. Le nouveau volet d'onglet apparaît dans la fenêtre.



<a name="NOTE4_2"></a>


### Création du champ Tableau croisé dynamique
<a name="creation_champ_tableau_croise_dynamique_ELTPARAGRAPHE000266"></a>

- Pour créer un champ Tableau croisé dynamique :

	1. Dans la fenêtre "FEN_Menu", sélectionnez le volet d'onglet "Tableau croisé dynamique" si nécessaire.

	2. Sous le volet "Création", dans le groupe "Données", déroulez "Table et Liste" et sélectionnez "Tableau croisé dynamique (TCD)". Le champ apparaît sous le curseur de la souris.

	3. Cliquez dans le volet d'onglet "Tableau croisé dynamique". L'assistant de création d'un champ Tableau croisé dynamique se lance.

	4. Passez à l'étape suivante.

	5. **Dans les cellules**, nous voulons afficher deux informations :

		- le total des ventes.

		- la quantité vendue.


 Dans l'assistant, nous allons tout d'abord sélectionner le fichier de données source : LigneCommande.
			Pour la première information, sélectionnez :

- Afficher : "La somme de".

- Source : "TotalTTC".

6. **Dans les entêtes des colonnes**, nous voulons afficher les années. Dans la partie gauche, déroulez le fichier de données Commande et double-cliquez sur la rubrique Date. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20TCD%20-%20HC%20N%B0003.jpg&type=thumb)
Passez à l'étape suivante.

7. L'assistant propose une liaison pour atteindre le fichier de données Commande et propose d'afficher en entête trois niveaux d'informations : les années, les trimestres et les mois. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20TCD%20-%20HC%20N%B0004.jpg)



<a name="NOTE4_3"></a>


### Test du champ Tableau croisé dynamique
<a name="test_champ_tableau_croise_dynamique_ELTPARAGRAPHE000327"></a>

- Testez la fenêtre (![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_GO_Fenetre_WD_GAF.jpg)
 parmi les boutons d'accès rapide). 

	1. Cliquez sur le volet d'onglet "Tableau croisé dynamique" puis sur le champ "Calculer".
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | ATTENTION : Selon la taille de la base de données et le nombre d'entêtes de lignes et de colonnes, les temps de calcul peuvent être plus ou moins longs. Vous pouvez sauvegarder le résultat du tableau croisé dynamique pour éviter le recalcul à chaque interrogation. |





	2. Cliquez sur les "&gt;" pour dérouler les différentes colonnes et lignes.
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20TCD%20-%20HC%20N%B0006.jpg&type=thumb)








- Arrêtez le test. Nous allons faire une petite amélioration dans ce champ Tableau croisé dynamique. En effet, rien n'indique qu'un des chiffres dans les cellules correspond à une quantité. Nous allons utiliser un masque d'affichage spécifique pour cette valeur.




- Pour mettre un masque d'affichage dans une cellule :

	1. Affichez la description du champ Tableau croisé dynamique (double-clic sur le champ).

	2. Dans l'onglet "Contenu", cliquez sur "VAL_SansNom2". La description des valeurs affichées dans les cellules apparaît.

	3. Dans la zone "Masque", ajoutez le préfixe "Qt : ". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20TCD%20-%20HC%20N%B0007.jpg&type=thumb)


	4. Validez la fenêtre de description.

5. Relancez le test de la fenêtre.




| [Leçon précédente](../TutoWD/1410087537.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087539.md) |
| --- | --- | --- |




