
## Leçon 4.11. Consommer un Webservice
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Ce que vous allez apprendre dans cette leçon
<a name="que_vous_allez_apprendre_dans_cette_lecon_ELTTEXTE000187"></a>


- Présentation.

- Importation et consommation d'un Webservice.





|   |   |
| --- | --- |
| <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=dur%E9e.png)<br> | <br>Durée estimée : 10 mn |



| [Leçon précédente](../TutoWD/1410087525.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087527.md) |
| --- | --- | --- |







<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000234"></a>
Un service Web est généralement défini comme une application accessible via des protocoles Internet standard. Les services Web permettent notamment l'interactivité entre plusieurs ordinateurs connectés sur le réseau Internet.

Via les services Web, il est possible de faire exécuter des procédures et des traitements sur un serveur Web (.NET, SOAP ou J2EE) à distance depuis un poste client.

Avec WINDEV, ces services Web sont utilisables en tant que client, via le protocole SOAP sur HTTP (le protocole standard d'Internet pour le transfert des pages HTML), grâce aux fonctions SOAPxx, DotNetxx et J2EExx.

Quelle que soit la plateforme du serveur Web (.NET, J2EE ...), un service Web est accessible via l'utilisation de SOAP.|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png) | Note | Avec WINDEV, il n'est pas nécessaire de maîtriser ces informations. Un assistant se charge de ("presque") tout ! |




<a name="NOTE2_2"></a>


### Exemple pratique
<a name="exemple_pratique_ELTPARAGRAPHE000039"></a>Pour tester et manipuler un Webservice, nous mettons à votre disposition un Webservice spécifique pour ce tutoriel.

Intégré au projet "WD Application Complète", ce Webservice permet d'interroger une base fournisseur pour vérifier la disponibilité (stock) d'un produit à partir de sa référence.

Nous allons dans un premier temps, importer le Webservice dans le projet "WD Application Complète", puis l'utiliser dans l'application pour vérifier à partir d'une fiche Produit, la disponibilité du produit affiché.

- Ré-ouvrez si nécessaire le projet que vous avez manipulé dans la leçon précédente. 

	1. Affichez la page d'accueil de WINDEV (Ctrl + &lt;).

	2. Dans la page d'accueil, cliquez sur "Tutoriel" puis dans la zone "Partie 4 - Application complète avec données", double-cliquez sur "Application complète - Exercice".

	3. WINDEV vous propose d'ouvrir le projet que vous avez manipulé dans la leçon précédente. Vous pouvez ouvrir le projet présent sur votre poste ou ouvrir le projet original. Choisissez "Ouvrir la copie locale".





|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=exemple-WD.png) | Corrigé | **Un projet corrigé est disponible.** Ce projet contient tous les éléments créés ou importés dans cette leçon. Pour ouvrir le projet corrigé, dans la page d'accueil, cliquez sur "Tutoriel" puis dans la zone "Partie 4 - Application complète avec données", double-cliquez sur "Application complète - Corrigé". |







- Si nécessaire, placez-vous sur la configuration de projet "Exécutable Windows 32 bits" : dans le volet "Explorateur de projet", dans le dossier "Configurations", double-cliquez sur "Exécutable Windows 32 bits".




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Importation d'un Webservice
<a name="importation_webservice_ELTTEXTE000300"></a>


- Pour importer un Webservice dans le projet :

	1. Sous le volet "Projet", dans le groupe "Projet", déroulez "Importer" et sélectionnez "Un Webservice".

	2. L'assistant d'importation se lance. Passez à l'étape suivante.

	3. Indiquez l'adresse à laquelle la description WSDL du Webservice doit être importée : 
			
		```txt
		https://exemples.webdev.info/WSAUTOFORMATIONV2_WEB/awws/WSAutoformationV2.awws?wsdl
		```

			Rappel : Ce Webservice permet d'interroger une base fournisseur pour vérifier la disponibilité (stock) d'un produit à partir de sa référence. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Consommation%20WS%20-%20HC%20N%B0001.jpg&type=thumb)


	4. Passez à l'étape suivante. L'importation du Webservice est réalisée. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Consommation%20WS%20-%20HC%20N%B0002.jpg&type=thumb)




Arrêtons-nous un instant sur les informations affichées dans le volet "Explorateur de projet" : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Consommation%20WS%20-%20HC%20N%B0003.jpg)
La structure est constituée de :

- le nom du Webservice (WSAutoformationV2 dans cet exemple),

- le nom de chaque fonction (ProduitEnStock dans cet exemple).




Pour connaître la syntaxe d'appel du Webservice, il suffit de double-cliquer sur le nom de la fonction dans le volet "Explorateur de projet". L'éditeur de code affiche la description de la fonction, avec le prototype de l'appel de la fonction : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Consommation%20WS%20-%20HC%20N%B0004.jpg&type=thumb)


<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Consommation d'un Webservice
<a name="consommation_webservice_ELTTEXTE000324"></a>
Dans notre exemple "WD Application Complète", nous allons intégrer l'appel au Webservice dans l'onglet permettant de voir la liste des produits. Un bouton "En stock ?" permettra de vérifier la disponibilité du produit affiché via le Webservice.



- Pour utiliser le Webservice :

	1. Ouvrez sous l'éditeur la fenêtre "FEN_Menu" (double-cliquez sur son nom dans le volet "Explorateur de projet" par exemple).

	2. Dans le volet d'onglet "Liste des produits", ajoutez un champ Bouton :

		- Sous le volet "Création", dans le groupe "Champs usuels", cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_Bouton_GAF.jpg).

		- Cliquez dans la fenêtre sous le champ Bouton "Modifier".

		- Le champ est automatiquement créé.




3. Modifiez les caractéristiques du champ (option "Description" du menu contextuel) : 

	- Saisissez le nouveau nom de ce champ "BTN_EnStock". 

	- Saisissez le nouveau libellé de ce champ "En stock ?". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Consommation%20WS%20-%20HC%20N%B0005.jpg&type=thumb)




- Nous allons maintenant tester le fonctionnement du Webservice :

	1. Lancez le test du projet (![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_GO_Projet_WD_GAF.jpg) parmi les boutons d'accès rapide).

	2. Cliquez si nécessaire sur l'onglet "Liste des produits".

	3. Sélectionnez un produit au hasard dans le champ Table et cliquez sur "En stock ?". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Consommation%20WS%20-%20HC%20N%B0006.jpg&type=thumb)


	4. Validez la fenêtre d'information et fermez l'application. 




| [Leçon précédente](../TutoWD/1410087525.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087527.md) |
| --- | --- | --- |




