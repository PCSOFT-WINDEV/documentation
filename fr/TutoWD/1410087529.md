
## Leçon 4.14. Diffusez "Etats et Requêtes" avec vos applications
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Ce que vous allez apprendre dans cette leçon
<a name="que_vous_allez_apprendre_dans_cette_lecon_ELTTEXTE000431"></a>


- A quoi sert le logiciel "Etats et Requêtes" ?

- Comment diffuser le logiciel "Etats et Requêtes".

- Comment utiliser le logiciel "Etats et Requêtes". 





|   |   |
| --- | --- |
| <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=dur%E9e.png)<br> | <br>Durée estimée : 10 mn |



|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=vierge.png) | Express | Le logiciel "Etats et Requêtes" n'est pas disponible dans la version Express. |





| [Leçon précédente](../TutoWD/1410087528.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087530.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Présentation du logiciel "Etats et Requêtes"
<a name="presentation_logiciel_etats_requetes_ELTTEXTE000496"></a>
Le logiciel "Etats et Requêtes" permet aux utilisateurs de modifier et de créer à leur convenance les états et les requêtes de vos applications.

Un utilisateur trouve qu'il manque une information sur l'état fourni en standard ? Avec le logiciel "Etat et Requêtes", il peut ajouter l'information directement depuis le visualisateur de rapports. Cette modification peut être intéressante pour d'autres utilisateurs ? L'état peut être mis à disposition de tous les utilisateurs utilisant l'application en réseau. De même pour les requêtes.|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png) | Note | Le logiciel "Etats et Requêtes" est gratuit et librement redistribuable avec vos applications créées avec WINDEV. Consultez la licence pour plus de détails sur les conditions de redistribution. |





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Lancement du logiciel "Etats et Requêtes"
<a name="lancement_logiciel_etats_requetes_ELTTEXTE000538"></a>
Pour que les utilisateurs finaux personnalisent les états de votre application ou créent leurs propres états et leurs propres requêtes, il suffit de lancer le logiciel "Etats et Requêtes".

Pour permettre à vos utilisateurs finaux de lancer le logiciel "Etats et Requêtes" :

- soit affichez vos états dans le visualisateur de rapports. Les utilisateurs finaux pourront lancer le logiciel "Etats et Requêtes" en cliquant sur l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Diffuser%20EtatsRequetes%20-%20HC%20N%B0006%201%202.jpg).

- soit ajoutez le menu d'aide automatique ‘?' dans la fenêtre principale de votre application : sous le volet "Fenêtre", dans le groupe "Barres et menus", déroulez "Menu principal" et sélectionnez l'option "Ajouter le menu ‘?'".
	Dans l'assistant de création de ce menu, cochez les options "Créer, modifier un état" et "Créer, modifier une requête".

- soit utilisez la fonction [LanceEtatsEtRequêtes](../WDLang1/3013067.md) dans votre application.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Diffusez le logiciel "Etats et Requêtes" avec votre application
<a name="diffusez_logiciel_etats_requetes_avec_votre_application_ELTTEXTE000562"></a>
Pour diffuser le logiciel "Etats et Requêtes" avec votre propre application WINDEV, il est nécessaire de :

- indiquer au niveau du projet que l'application autorise le lancement du logiciel "Etats et Requêtes".

- définir si nécessaire au niveau de l'analyse les fichiers et rubriques qui seront utilisables avec le logiciel "Etats et Requêtes".

- définir les états et les requêtes modifiables sous le logiciel "Etats et Requêtes".

- créer l'exécutable et le programme d'installation intégrant le logiciel "Etats et Requêtes".




Nous allons détailler ces différentes étapes en manipulant le projet "WD Application Complète". 

- Ré-ouvrez si nécessaire le projet que vous avez manipulé dans la leçon précédente. 

	1. Affichez la page d'accueil de WINDEV (Ctrl + &lt;).

	2. Dans la page d'accueil, cliquez sur "Tutoriel" puis dans la zone "Partie 4 - Application complète avec données", double-cliquez sur "Application complète - Exercice".

	3. WINDEV vous propose d'ouvrir le projet que vous avez manipulé dans la leçon précédente. Vous pouvez ouvrir le projet présent sur votre poste ou ouvrir le projet original. Choisissez "Ouvrir la copie locale". 





|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=exemple-WD.png) | Corrigé | **Un projet corrigé est disponible. Ce projet permet d'effectuer les manipulations de cette leçon (si vous n'avez pas suivi les leçons précédentes)**. Pour ouvrir le projet corrigé, dans la page d'accueil, cliquez sur "Tutoriel" puis dans la zone "Partie 4 - Application complète avec données", double-cliquez sur "Application complète - Corrigé". |








<a name="NOTE4_2"></a>


### Paramétrage du projet
<a name="parametrage_projet_ELTPARAGRAPHE000097"></a>

- Pour utiliser le logiciel "Etats et Requêtes" à partir de votre application, il est nécessaire de configurer le projet associé à votre application.

	1. Affichez la description du projet "WDApplication complète". 
			Rappel : Pour afficher la description du projet, sous le volet "Projet", dans le groupe "Projet", cliquez sur "Description".

	2. Dans l'onglet "Avancé", cochez l'option "Autoriser le lancement de "Etats et Requêtes"". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Diffuser%20EtatsRequetes%20-%20HC%20N%B0001%201.jpg&type=thumb)


	3. Validez.



<a name="NOTE4_3"></a>


### Paramétrage de l'analyse
<a name="parametrage_analyse_ELTPARAGRAPHE000127"></a>Nous allons maintenant ouvrir l'analyse pour paramétrer les fichiers et rubriques utilisables sous le logiciel "Etats et Requêtes".



- Ouvrez l'analyse de votre projet : cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_Analyse_GAF.jpg) parmi les boutons d'accès rapide du menu de WINDEV.




Par défaut, tous les fichiers de données et toutes leurs rubriques sont visibles et manipulables avec le logiciel "Etats et Requêtes". Si votre application contient des informations sensibles (mots de passe, ...) vous pouvez rendre ces fichiers de données ou ces rubriques invisibles sous le logiciel "Etats et Requêtes".|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png) | Note | A partir du logiciel "Etats et Requêtes", l'utilisateur ne peut pas ajouter, modifier ou supprimer des enregistrements (les fonctions [HAjoute](../WDLang4/3044147.md), [HModifie](../WDLang4/3044042.md) et [HSupprime](../WDLang4/3044018.md) sont interdites). Il n'est également pas possible de créer ou de re-créer des fichiers de données (les fonctions [HCréation](../WDLang4/3044255.md) et [HCréationSiInexistant](../WDLang4/3044254.md) sont interdites). |







- Pour définir un fichier de données invisible sous le logiciel "Etats et Requêtes" :

	1. Sous l'éditeur d'analyses, sélectionnez le fichier de données voulu.

	2. Affichez la fenêtre de description du fichier de données (option "Description du fichier de données" du menu contextuel).

	3. Dans l'onglet "Etats et Requêtes", décochez l'option "Visible par l'utilisateur final dans le logiciel "États et Requêtes"".

	4. Validez.







- Pour définir une rubrique invisible sous le logiciel "Etats et Requêtes" :

	1. Sous l'éditeur d'analyses, sélectionnez le fichier de données voulu.

	2. Affichez la fenêtre de description des rubriques du fichier (option "Description des rubriques" du menu contextuel).

	3. Sélectionnez dans la liste des rubriques, la rubrique voulue.

	4. Dans l'onglet "Etats et Requêtes", décochez l'option "Visible par l'utilisateur final dans le logiciel "États et Requêtes"".

	5. Validez.







- Pour prendre en compte les modifications effectuées dans l'analyse, il est nécessaire de régénérer l'analyse (sous le volet "Analyse" du ruban, dans le groupe "Analyse", cliquez sur "Génération"). Une modification automatique des fichiers de données est proposée pour prendre en compte les modifications effectuées.



<a name="NOTE4_4"></a>


### Paramétrage des états
<a name="parametrage_des_etats_ELTPARAGRAPHE000200"></a>Lors de la création d'un état, il est possible de spécifier si cet état est modifiable sous le logiciel "Etats et Requêtes".



- Pour rendre l'état "ETAT_Liste_des_clients" présent dans le projet "WD Application Complète" modifiable sous le logiciel "Etats & Requêtes" :

	1. Ouvrez l'état "ETAT_Liste_des_clients" sous l'éditeur d'états.

	2. Affichez la description de l'état (option "Description de l'état" du menu contextuel).

	3. Dans l'onglet "Options", cochez "État modifiable sous États et Requêtes".

	4. Cochez ensuite une des deux options suivantes :

		- "Interface modifiable uniquement" pour que l'interface de l'état uniquement soit modifiable sous Etats et Requêtes.

		- "Tout modifiable (interface et code)" pour que l'état soit entièrement modifiable sous Etats et Requêtes. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Diffuser%20EtatsRequetes%20-%20HC%20N%B0002.jpg&type=thumb)






<a name="NOTE4_5"></a>


### Paramétrage des requêtes
<a name="parametrage_des_requetes_ELTPARAGRAPHE000224"></a>Par défaut, une requête est modifiable sous le logiciel "Etats et Requêtes".

- Pour rendre la requête "REQ_BonDeCommande" présente dans le projet "WD Application Complète" modifiable sous le logiciel "Etats et Requêtes" :

	1. Ouvrez la requête "REQ_BonDeCommande" sous l'éditeur de requêtes.

	2. Affichez la description de la requête (option "Description de la requête" du menu contextuel du graphe de la requête).

	3. Cliquez sur le bouton "Avancé" (présent parmi les "Actions").

	4. Dans l'onglet "Etats et Requêtes", cochez "Visible sous 'Etats & Requêtes'".

	5. Validez et enregistrez la requête.






<a name="NOTE4_6"></a>


### Création de l'exécutable et diffusion de l'application
<a name="creation_executable_diffusion_application_ELTPARAGRAPHE000239"></a>La création et la diffusion d'une application utilisant le logiciel "Etats et Requêtes" se fait de la même façon que pour une application classique. Vous pourrez indiquer les paramètres spécifiques au logiciel "Etats et Requêtes" lors de la création de la procédure d'installation. 



- Pour créer le programme d'installation de votre application WD Application Complète :

	1. Sous le volet "Projet", dans le groupe "Génération", cliquez sur "Procédure d'installation". L'assistant de création d'installation se lance. Cliquez sur le lien "Installation" à gauche de l'assistant.

	2. Sélectionnez "Créer l'exécutable maintenant". La création de l'exécutable est réalisée.
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png) | Note | Si l'assistant propose la création du fichier d'aide, validez les différents messages. |





	3. L'assistant de création d'installation se lance.

	4. Choisissez une "Installation individuelle". Passez à l'étape suivante.

	5. Choisissez une "Installation standard". Passez à l'étape suivante.

	6. Validez le répertoire d'installation proposé et passez à l'étape suivante.

	7. Dans l'écran "Fichiers installés", sélectionnez si nécessaire les fichiers de données (.fic, .mmo et .ndx) présents dans le répertoire de l'exécutable. Pour cela, cliquez sur "Ajouter" et sélectionnez ces fichiers. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_D%E9ployer%20l'application%20-%20HC%20N%B0006.jpg&type=thumb)


	8. Cliquez à gauche sur le lien "Compléments".

9. Dans l'écran "Modules complémentaires", vérifiez que l'option "Intégrer l'installation de Etats et Requêtes (attention : volumineux)" est cochée.

10. Passez à l'étape suivante. 

11. Dans l'étape intitulée "Etats et Requêtes" :

	- Spécifiez si vous voulez incorporer l'installation de "Etats et Requêtes" dans votre programme d'installation.
						Dans ce cas, le package d'installation du logiciel "Etats et Requêtes" (présent dans le sous-répertoire "Etats et Requêtes" du répertoire d'installation de WINDEV) sera utilisé.
						Il est possible de : 

		- Proposer l'installation du logiciel "Etats et Requêtes" en même temps que l'application.

		- Proposer l'installation du logiciel "Etats et Requêtes" lors de sa première utilisation.




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Installer et utiliser le logiciel "Etats et Requêtes"
<a name="installer_utiliser_logiciel_etats_requetes_ELTTEXTE000670"></a>


### Installation de l'application
<a name="installation_application_ELTPARAGRAPHE000299"></a>Pour tester l'installation et l'utilisation du logiciel "Etats et Requêtes", nous allons installer l'application "WD Application Complète".

En suivant les étapes du paragraphe précédent, vous avez généré le programme d'installation de cette application. Le programme d'installation a été créé dans le sous-répertoire "Install" du projet en cours.

- Dans la fenêtre de fin de création de l'installation, cliquez sur le bouton "Tester". Si vous avez fermé cette fenêtre, lancez directement le programme "Install.exe" présent dans le répertoire du programme d'installation. L'installation de l'application se lance.




- Nous allons suivre les différentes étapes du programme d'installation de l'application "WD Application Complète".

	1. Si l'UAC est activée, une fenêtre s'affiche demandant l'autorisation d'exécuter le programme. Validez cette fenêtre.

	2. L'assistant d'installation se lance. 
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png) | Note | L'assistant propose de changer la langue de l'installation via une combo en haut à droite de la fenêtre. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_D%E9ployer%20l'application%20-%20HC%20N%B0008.jpg)<br> |




			Deux modes d'installation sont disponibles : 

		- Installation rapide : L'installation est directement réalisée avec les paramètres spécifiés par le fournisseur de l'application. 

		- Installation personnalisée : L'assistant demande à l'utilisateur les paramètres d'installation de l'application. 




3. Choisissez "Installation personnalisée". L'assistant demande le répertoire d'installation de l'application. 

4. Sélectionnez si nécessaire le répertoire d'installation de l'application puis passez à l'étape suivante. 

5. L'étape "Etats et Requêtes" permet d'installer le logiciel "Etats et Requêtes". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Diffuser%20EtatsRequetes%20-%20HC%20N%B0004.jpg&type=thumb)
Sélectionnez l'option "Installer "Etats et Requêtes"" et indiquez le répertoire d'installation de ce logiciel. 
			Remarque : Si une précédente version du logiciel "Etats et Requêtes" est installé sur le poste, il est possible de réaliser une sauvegarde de cette version. 

6. Passez à l'étape suivante.

7. L'étape suivante permet de définir les répertoires utilisés pour l'enregistrement des états et des requêtes (si l'option "Autoriser la modification de ces répertoires lors de l'installation" a été cochée dans l'assistant de création du programme d'installation). <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Diffuser%20EtatsRequetes%20-%20HC%20N%B0005.jpg&type=thumb)



<a name="NOTE5_2"></a>


### Test de l'application
<a name="test_application_ELTPARAGRAPHE000339"></a>Nous allons maintenant nous placer dans la peau de l'utilisateur final de votre application (ce n'est pas évident, mais pourquoi pas).

- Pour tester l'application :

	1. Lancez l'application "WD Application Complète".

	2. Sélectionnez l'option "Etats .. Liste des clients". L'état est affiché dans le visualisateur de rapports. Cliquez sur le volet "Aperçu". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Diffuser%20EtatsRequetes%20-%20HC%20N%B0006.jpg&type=thumb)


	3. Dans cet écran, deux nouvelles icônes font leur apparition :
			




- Nous allons modifier cet état :

	1. Cliquez sur l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Diffuser%20EtatsRequetes%20-%20HC%20N%B0006%201%202.jpg).

	2. L'état apparaît en édition sous le logiciel "Etats et Requêtes". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Diffuser%20EtatsRequetes%20-%20HC%20N%B0007.jpg&type=thumb)


	3. L'utilisateur peut alors faire les modifications qu'il souhaite :

	- sur le style des informations affichées (par exemple changer la couleur d'un champ).

	- sur le contenu de l'état (par exemple ajouter un champ, ...). Si l'état est lié à une requête, l'utilisateur peut modifier cette requête. 

		- Si l'état est lié à une requête intégrée, la modification est effectuée directement dans l'état. 

		- Si l'état est lié à une requête indépendante, la requête est également modifiée. La modification sera prise en compte uniquement dans le cadre de l'exécution de l'état (si une fenêtre utilise également cette requête, la modification ne sera pas prise en compte par la fenêtre).




- Dans cet exemple, nous allons mettre la date en rouge. Pour cela :

	1. Sélectionnez le champ date dans le début de document.

	2. Sous le volet "Modification", dans le groupe "Edition rapide", cliquez sur l'icône "Couleur". Dans la fenêtre qui s'affiche, sélectionnez la couleur rouge et validez. 

	3. Enregistrez votre état. Par défaut, le répertoire proposé est le répertoire d'installation de votre application.

	4. Fermez le logiciel "Etats et Requêtes".

	5. Sélectionnez l'option "Etats .. Liste des clients" dans l'application. L'état apparaît en mode "Visualisateur de rapports" et la modification réalisée est effective.





Dans cet exemple, l'état que vous avez modifié est disponible pour vous seul. Dans le cas d'une application réseau, l'utilisateur a la possibilité de mettre à disposition de tous les utilisateurs un état modifié.

Nous avons fini notre découverte du logiciel "Etats et Requêtes". 
Pour plus de détails, consultez [L'éditeur d'états Utilisateur (logiciel Etats et Requêtes)](../Presentation/3088004.md).

<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Conclusion
<a name="conclusion_ELTTEXTE000718"></a>
Toute la phase de développement de notre application est terminée. Les deux prochaines leçons vont vous permettre de découvrir :

- comment transformer votre application en une application multilingue,

- comment intégrer votre application dans le Gestionnaire de sources (GDS). 




| [Leçon précédente](../TutoWD/1410087528.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087530.md) |
| --- | --- | --- |




