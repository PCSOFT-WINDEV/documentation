
## Leçon 4.2. Recherche simple et parcours des enregistrements
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Ce que vous allez apprendre dans cette leçon
<a name="que_vous_allez_apprendre_dans_cette_lecon_ELTTEXTE000602"></a>


- Gestion de la recherche d'enregistrements.

- Parcours des enregistrements.





|   |   |
| --- | --- |
| <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=dur%E9e.png)<br> | <br>Durée estimée : 30 mn |

| [Leçon précédente](../TutoWD/1410087532.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087534.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000649"></a>
Dans les leçons précédentes, nous avons géré l'ajout et la modification d'enregistrements. Nous allons maintenant compléter notre application en ajoutant la recherche d'un enregistrement (pour le modifier par exemple). 

Nous allons modifier la fenêtre principale de l'application "WD Application Complète" pour utiliser des volets d'onglet.

- Le premier volet d'onglet permettra d'afficher la liste des produits et de gérer l'ajout et la modification des produits (les manipulations ont été réalisées dans les leçons précédentes).

- Le second volet d'onglet proposera la recherche d'un client selon son nom. La fiche du client sera affichée dans le même volet d'onglet.




Nous allons mettre en place deux modes de recherche :

- une recherche à l'identique,

- une recherche générique.

<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%204%20-%20Aper%E7u%20-%20HC%20N%B0001.jpg&type=thumb)
Ensuite, il sera possible de parcourir les enregistrements présents dans le fichier de données à partir du client affiché. 



- Ré-ouvrez si nécessaire le projet que vous avez manipulé dans la leçon précédente. 

	1. Affichez la page d'accueil de WINDEV (Ctrl + &lt;).

	2. Dans la page d'accueil, cliquez sur "Tutoriel" puis dans la zone "Partie 4 - Application complète avec données", double-cliquez sur "Application complète - Exercice".

	3. WINDEV vous propose d'ouvrir le projet que vous avez manipulé dans la leçon précédente. Vous pouvez ouvrir le projet présent sur votre poste ou ouvrir le projet original. Choisissez "Ouvrir la copie locale". 





|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=exemple-WD.png) | Corrigé | Un projet corrigé est disponible. Ce projet contient les différentes fenêtres créées dans cette leçon. Pour ouvrir le projet corrigé, dans la page d'accueil, cliquez sur "Tutoriel" puis dans la zone "Partie 4 - Application complète avec données", double-cliquez sur "Application complète - Corrigé". |







<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Modification de la fenêtre : utilisation d'un champ Onglet
<a name="modification_fenetre_utilisation_champ_onglet_ELTTEXTE000691"></a>
Dans cet exemple, la recherche ne va pas s'effectuer dans une nouvelle fenêtre : nous allons utiliser la fenêtre FEN_Menu. Actuellement, cette fenêtre affiche la liste des produits.

Pour afficher plusieurs données différentes dans cette fenêtre, nous allons utiliser des champs Onglet. Les champs Onglet permettent de regrouper des informations par thème. L'utilisateur peut accéder directement à un thème en cliquant sur l'onglet voulu.

Ce système est utilisé dans toutes les fenêtres de description de WINDEV.
<a name="NOTE3_2"></a>


### Création du champ Onglet
<a name="creation_champ_onglet_ELTPARAGRAPHE000064"></a>

- Pour afficher les données de la fenêtre "FEN_Menu" dans un champ Onglet :

	1. Affichez si nécessaire la fenêtre "FEN_Menu" :

		- soit depuis la barre des documents ouverts.

		- soit en double-cliquant sur son nom dans le volet "Explorateur de projet".




2. Sélectionnez les champs de la fenêtre et déplacez-les dans la zone d'accueil de la fenêtre. Cette manipulation peut sembler "bizarre", mais ainsi il sera plus simple de travailler sur le champ Onglet puis d'associer les champs au volet d'onglet voulu. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Rech%20-%20HC%20N%B0001.jpg&type=thumb)


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png) | Note | **Manipulations de champs dans un champ Onglet**<br><br>- Pour vérifier que tous les champs sont bien associés au volet d'onglet en cours, cliquez sur un autre onglet : tous les champs associés au volet d'onglet disparaissent. <br><br>- Pour redimensionner le champ Onglet sans prendre en compte l'ancrage des champs présents dans le volet, utilisez la touche Maj pendant le redimensionnement.<br><br><br> |


<br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Rech%20-%20HC%20N%B0002.jpg&type=thumb)

<a name="NOTE3_3"></a>


### Modifications du champ Onglet
<a name="modifications_champ_onglet_ELTPARAGRAPHE000107"></a>

- Modifiez le nom du champ Onglet :

	1. Double-cliquez sur le champ Onglet que vous venez de créer : la fenêtre de description du champ s'affiche.

	2. Modifiez le nom du champ. Le champ a pour nom "ONG_Visualisation".

	3. Validez la fenêtre de description du champ.







- Deux volets sont créés par défaut. Nous allons modifier leur libellé directement :

	1. Sélectionnez le champ Onglet.

	2. Cliquez sur "Volet 1". L'onglet passe en édition : saisissez le libellé "Liste des produits". Validez­ avec la touche Entrée. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Rech%20-%20HC%20N%B0003.jpg)


	3. Cliquez sur "Volet 2". Le volet s'affiche. Cliquez à nouveau sur "Volet 2". Saisissez le libellé "Recherche de clients". Validez avec la touche Entrée.




- Nous allons associer une image à chaque onglet du champ Onglet. Pour cela :

	1. Affichez la fenêtre de description du champ Onglet (double-clic sur le champ par exemple). L'onglet "Général" de la fenêtre de description permet de configurer les caractéristiques de chaque volet du champ Onglet. La liste des volets est affichée à gauche. Pour chaque volet sélectionné, ses caractéristiques sont modifiables dans la partie droite de l'écran.

	2. Dans la fenêtre de description, sélectionnez le volet "Liste des produits". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Rech%20-%20HC%20N%B0004.jpg&type=thumb)


	3. Les caractéristiques du volet sont affichées. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Rech%20-%20HC%20N%B0004%201.jpg&type=thumb)




- Nous venons de créer un nouveau champ : il est nécessaire de gérer son ancrage dans la fenêtre. Lorsque la fenêtre va s'agrandir, il est nécessaire que le champ Onglet s'agrandisse également pour occuper tout l'espace disponible. Le champ doit donc s'étirer vers la droite et vers le bas.

	1. Sélectionnez le champ Onglet.

	2. Affichez le menu contextuel (clic droit) et sélectionnez l'option "Ancrage".

	3. Dans la fenêtre de définition de l'ancrage, sélectionnez l'option ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_MP%20-%20Ancrage%20fiche%20-%20HC%20N%B0002%202.jpg) et validez.

	4. Enregistrez la fenêtre en cliquant sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_Enregistrer_GAF.jpg) parmi les boutons d'accès rapide.







<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Mise en place de la recherche
<a name="mise_place_recherche_ELTTEXTE000763"></a>
Nous avons fini de préparer la fenêtre "FEN_Menu". Nous pouvons maintenant nous concentrer sur le contenu du volet du champ Onglet permettant de rechercher des clients.

Ce volet du champ Onglet va être divisé en plusieurs zones :

- Une zone de saisie des éléments à rechercher.

- Une zone d'affichage des informations trouvées.

- Une zone contenant les boutons de parcours.



<a name="NOTE4_2"></a>


### Zone d'affichage des informations trouvées
<a name="zone_affichage_des_informations_trouvees_ELTPARAGRAPHE000184"></a>Nous allons tout d'abord créer les différents champs qui afficheront les informations sur le client trouvé.

Pour créer les champs de saisie dans la fenêtre, nous allons procéder de la même manière que pour la fenêtre fiche du produit : un simple "Drag and Drop" depuis le volet "Analyse".



- Pour créer les différents champs affichant les informations sur le client :

	1. Affichez la fenêtre FEN_Menu sous l'éditeur et cliquez sur le volet d'onglet "Recherche de clients". Le volet d'onglet vide apparaît.

	2. Affichez si nécessaire le volet "Analyse" sous l'éditeur : sous le volet "Accueil", dans le groupe "Environnement", déroulez "Volets" et sélectionnez "Volets" puis "Analyse". Les différents fichiers de données décrits dans l'analyse "WD Application Complète" apparaissent dans le volet.

	3. Cliquez sur l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%202%20-%20Fiche%20produit%20-%20HC%20N%B0001%201.jpg) à gauche du fichier de données "Client" : les rubriques du fichier de données sont listées.

	4. Sélectionnez à l'aide de la souris les rubriques du fichier de données Client affichées dans le volet "Analyse". Vous pouvez par exemple utiliser la multisélection en maintenant la touche Ctrl enfoncée.

	5. Effectuez un "Drag and Drop" (glisser/déplacer) de ces rubriques vers le volet d'onglet "Recherche de clients". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Rech%20-%20HC%20N%B0006.jpg&type=thumb)


	6. Les champs sont automatiquement créés dans le volet du champ Onglet. Ces champs sont automatiquement liés à la rubrique correspondante dans le fichier de données. 

7. Enregistrez la fenêtre (Ctrl + S).




- Nous allons aligner les champs et leur donner la même taille :

	1. Sélectionnez le champ "Ville" puis tous les autres champs de saisie de la fenêtre (par exemple en maintenant la touche Ctrl appuyée et en cliquant sur les différents champs). Le premier champ sélectionné va servir de référence pour la taille des autres champs.

	2. Sous le volet "Alignement", dans le groupe "Interne et externe", cliquez sur l'option "Justifier (Int. et Ext.)". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Rech%20-%20HC%20N%B0007.jpg&type=thumb)








- Testez la fenêtre (![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_GO_Fenetre_WD_GAF.Jpg) parmi les boutons d'accès rapide). Cliquez sur le volet d'onglet "Recherche de clients". La fenêtre apparaît avec tous les champs vides.

- Fermez la fenêtre en cours de test pour revenir sous l'éditeur.



<a name="NOTE4_3"></a>


### Recherche à l'identique
<a name="recherche_identique_ELTPARAGRAPHE000242"></a>Pour effectuer la recherche à l'identique, nous allons sélectionner le nom du client dans un champ Combo. Le champ Bouton "Recherche identique" permettra d'afficher la fiche de la personne correspondante. Une seule personne correspond au nom sélectionné.



- Le champ Combo va venir se placer au-dessus des champs que nous venons de créer. Si vos champs sont placés trop près du bord haut du volet du champ Onglet, il est nécessaire de les déplacer vers le bas. Pour cela :

	1. Sélectionnez l'ensemble des champs présents dans le volet du champ Onglet :

		- Utilisez la combinaison de touches Ctrl + A : tous les champs de la fenêtre et du volet d'onglet en cours sont sélectionnés.

		- Maintenez la touche Ctrl enfoncée et cliquez sur le champ Onglet : seuls les champs présents dans le volet du champ Onglet sont sélectionnés.

		- Relâchez la touche Ctrl.




2. Déplacez un des champs sélectionnés vers le bas à l'aide de la souris. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Rech%20-%20HC%20N%B0008.jpg&type=thumb)




- Pour créer le champ de recherche :

	1. Créez un champ de type Combo : sous le volet "Création", dans le groupe "Champs usuels", cliquez sur "Combo".

	2. Cliquez ensuite dans le volet "Recherche de client" du champ Onglet, dans la zone entre le volet et le champ "Identifiant de Client".

	3. L'assistant de création d'un champ Combo s'affiche. Nous allons créer un champ Combo basé sur le fichier de données "Client". 

	4. Sélectionnez l'option "Afficher des données d'un fichier ou d'une requête existante". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Rech%20-%20HC%20N%B0009.jpg&type=thumb)
Passez à l'étape suivante de l'assistant.

	5. Sélectionnez le fichier de données "Client". Passez à l'étape suivante.

	6. Nous allons afficher le nom et le prénom de la personne. 

		- Désélectionnez la rubrique "IDClient".

		- Sélectionnez la rubrique "NomComplet". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Rech%20-%20HC%20N%B0010.jpg&type=thumb)







- Pour créer le champ Bouton permettant la recherche du client : 

	1. Créez un champ Bouton : sous le volet "Création", dans le groupe "Champs usuels", cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_Bouton_GAF.jpg).

	2. Positionnez le champ Bouton à côté du champ Combo qui vient d'être créé.

	3. Ce champ a pour nom "BTN_RechercheIdentique" et pour libellé "Recherche identique".

	4. Si nécessaire, adaptez la taille du champ pour que le libellé apparaisse correctement dans le champ.

	5. Saisissez le code WLangage suivant dans l'événement "Clic" du champ :
			
		```wl
		// Recherche le client par son identifiant 
		Client.LitRecherchePremier(IDClient, COMBO_Client) 
		SI Client.Trouve() ALORS
			// Affiche les données du client
			Client.VersFenêtre()
		FIN
		```


	6. Examinons ce code WLangage :

		- La fonction [&lt;Fichier de données&gt;.LitRecherchePremier](../WDLang4/1000025034.md) permet de réaliser une recherche à l'identique. Dans cet exemple, la recherche se fait sur le fichier de données Client et sur la rubrique IDClient. La valeur recherchée correspond au dernier paramètre de la fonction. Ici, la valeur recherchée correspond à la valeur sélectionnée dans le champ Combo. Cette valeur est obtenue en utilisant directement le nom du champ Combo (COMBO_Client).

		- La fonction [&lt;Fichier de données&gt;.Trouve](../WDLang4/1000025076.md) permet de tester le résultat de la recherche. Si la fonction [&lt;Fichier de données&gt;.Trouve](../WDLang4/1000025076.md) renvoie <u><u><u><u>Vrai</u></u></u></u>, une valeur a été trouvée, si la fonction [&lt;Fichier de données&gt;.Trouve](../WDLang4/1000025076.md) renvoie <u><u><u><u>Faux</u></u></u></u>, aucune valeur n'a été trouvée. Lorsqu'un enregistrement a été trouvé, cet enregistrement est lu et devient l'enregistrement courant du fichier de données.

		- Dans ce code, si l'enregistrement a été trouvé, il est affiché grâce à la fonction [&lt;Fichier de données&gt;.VersFenêtre](../WDLang4/1000021397.md).
						|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png) | Note | La fonction [&lt;Fichier de données&gt;.VersFenêtre](../WDLang4/1000021397.md) effectue l'opération inverse de la fonction [EcranVersFichier](../WDLang4/3044146.md) : les données présentes dans les rubriques du fichier de données sont affichées dans les champs correspondants. |








7. Fermez l'éditeur de code.

8. Enregistrez la fenêtre (Ctrl + S).




- Réalisons un test de la fenêtre :

	1. Lancez le test de la fenêtre (![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_GO_Fenetre_WD_GAF.jpg) parmi les boutons d'accès rapide).

	2. Cliquez si nécessaire sur le volet d'onglet "Recherche de clients".

	3. Sélectionnez une valeur dans le champ Combo et cliquez sur le champ "Recherche identique". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Rech%20-%20HC%20N%B0014.jpg&type=thumb)


	4. Le résultat est immédiat.

5. Fermez la fenêtre de test pour retourner sous l'éditeur.



<a name="NOTE4_4"></a>


### Recherche générique
<a name="recherche_generique_ELTPARAGRAPHE000372"></a>Nous allons maintenant effectuer une recherche générique. Au lieu de rechercher exactement la valeur saisie, nous allons rechercher tous les éléments qui commencent par la valeur saisie.

Pour effectuer cette recherche, nous allons créer un champ de saisie afin de saisir le nom recherché et un champ Bouton pour lancer la recherche.

- Pour créer le champ de recherche :

	1. Affichez si nécessaire le volet d'onglet "Recherche de clients" de la fenêtre "FEN_Menu" sous l'éditeur.

	2. Créez un champ de saisie : sous le volet "Création", dans le groupe "Champs usuels", cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_Saisie_GAF.jpg).

	3. Cliquez dans la fenêtre sous le champ Combo "Client recherché". Le champ de saisie est créé.

	4. Ce champ a pour nom "SAI_Nom_Recherché" et pour libellé "Nom recherché".







- Pour créer le champ Bouton lançant la recherche générique :

	1. Créez un champ Bouton : sous le volet "Création", dans le groupe "Champs usuels", cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_Bouton_GAF.jpg).

	2. Positionnez le champ à côté du champ de saisie qui vient d'être créé. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Rech%20-%20HC%20N%B0017.jpg&type=thumb)


	3. Ce champ a pour nom "BTN_RechercheGénérique" et pour libellé "Recherche générique".

4. Si nécessaire, adaptez la taille du champ pour que le libellé apparaisse correctement dans le champ.

5. Saisissez le code WLangage suivant dans l'événement "Clic" du bouton :
			
		```wl
		// Recherche un client par son nom
		Client.LitRecherche(NomComplet, SAI_Nom_Recherché)
		SI Client.Trouve() ALORS
			// Affiche les données du client
			Client.VersFenêtre()
		SINON
			Erreur("Aucun client ne correspond")
		FIN
		```

			La fonction [&lt;Fichier de données&gt;.LitRecherche](../WDLang4/1000025023.md) permet de réaliser une recherche générique. Dans cet exemple, la recherche se fait sur le fichier de données "Client" et sur la rubrique "NomComplet". La valeur recherchée correspond à la valeur saisie dans le champ "SAI_Nom_Recherché". Cette valeur est obtenue en utilisant directement le nom du champ.
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png) | Note | Il est possible de faire une recherche à l'identique avec la fonction [&lt;Fichier de données&gt;.LitRecherche](../WDLang4/1000025023.md) : il suffit d'utiliser la constante **hIdentique**. |





6. Fermez la fenêtre de code.

7. Enregistrez la fenêtre (Ctrl + S).




- Réalisons un test de la fenêtre :

	1. Lancez le test de la fenêtre (![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_GO_Fenetre_WD_GAF.jpg) parmi les boutons d'accès rapide).

	2. Cliquez si nécessaire sur le volet d'onglet "Recherche de clients".

	3. Saisissez une valeur dans le champ de saisie (par exemple "BEEF") et cliquez sur "Recherche générique". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Rech%20-%20HC%20N%B0015.jpg&type=thumb)


	4. Le résultat est immédiat. Cependant, si plusieurs enregistrements correspondent, seul le premier est affiché.

5. Arrêtez le test et revenez sous l'éditeur.



<a name="NOTE4_5"></a>


### Parcours des fiches
<a name="parcours_des_fiches_ELTPARAGRAPHE000444"></a>Nous allons maintenant ajouter quatre champs Bouton permettant de parcourir les différents enregistrements du fichier de données "Client". Ces champs sont de type "boutons magnéto". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Rech%20-%20HC%20N%B0017%201.jpg)
Ces champs vont nous permettre à la fois : 

- de parcourir les différents enregistrements du fichier de données, 

- lors d'une recherche générique, de parcourir tous les enregistrements correspondant à cette recherche générique. 


Ils sont constitués uniquement d'une icône et permettent d'afficher :

- le premier enregistrement,

- l'enregistrement précédent,

- l'enregistrement suivant,

- le dernier enregistrement.




- Pour créer le champ Bouton affichant le premier enregistrement du fichier de données :

	1. Si nécessaire, affichez le volet "Recherche de clients" du champ Onglet sous l'éditeur.

	2. Sous le volet "Création", dans le groupe "Champs usuels", cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_Bouton_GAF.jpg).

	3. La forme du champ apparaît sous la souris. Cliquez ensuite dans le volet du champ Onglet, sous le champ "Recherche générique". Le champ Bouton est automatiquement créé.







- Pour uniformiser l'interface des fenêtres d'un projet, nous utilisons un gabarit. Ce gabarit définit le style de tous les champs des fenêtres. Pour chaque champ Bouton de type magnéto, un style spécifique est défini. Pour appliquer ce style :

	1. Sélectionnez si nécessaire le champ Bouton.

	2. Affichez le menu contextuel (clic droit) et sélectionnez l'option "Choisir un style". 

	3. Dans la fenêtre qui s'affiche, tous les styles définis pour les boutons s'affichent. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Rech%20-%20HC%20N%B0016.jpg&type=thumb)
Sélectionnez le style "BTN_Premier".

	4. Validez.







- Modifiez le nom du champ Bouton : 

	1. Affichez la fenêtre de description du champ :

		- Sélectionnez le champ Bouton.

		- Affichez le menu contextuel (clic droit) et sélectionnez l'option "Description".




2. Ce champ a pour nom "BTN_Premier".

3. Validez la fenêtre de description.




- Nous allons maintenant saisir le code WLangage associé à ce champ :

	1. Faites un clic droit sur le champ. Dans le menu qui s'affiche, sélectionnez l'option "Code".

	2. Dans la fenêtre de code qui apparaît, saisissez le code WLangage suivant dans l'événement "Clic sur" :
			
		```wl
		// Lit le premier client
		Client.LitPremier()
		SI Client.EnDehors() ALORS
			// Pas de client
			Info("Aucune fiche à visualiser.")
		SINON
			// Affiche les données du client
			Client.VersFenêtre()
		FIN
		```
La fonction [&lt;Fichier de données&gt;.LitPremier](../WDLang4/1000025022.md) permet de lire le premier enregistrement du fichier de données, selon la clé utilisée pour la dernière recherche (NomComplet dans notre cas).







- De la même manière, créez 3 nouveaux champs Bouton.

	- Ces champs ont pour nom : "BTN_Précédent", "BTN_Suivant" et "BTN_Dernier".

	- Ces champs sont respectivement associés aux styles : "BTN_Précédent", "BTN_Suivant" et "BTN_Dernier".

	- Le code WLangage correspondant à l'événement "Clic" du champ Bouton "BTN_Précédent" est le suivant :
			
		```wl
		// Si aucune recherche en cours
		SI Client.EnDehors() ALORS
			// Lit le dernier client
			Client.LitDernier()
		FIN
		
		// Lit le client précédent
		Client.LitPrécédent()
		// Si le début du fichier de données est dépassé
		SI Client.EnDehors() ALORS
			Info("Début du fichier de données atteint.")
		SINON
			// Affiche les données du client
			Client.VersFenêtre()
		FIN
		```


	- Le code WLangage correspondant à l'événement "Clic" du champ Bouton "BTN_Suivant" est le suivant :
			
		```wl
		// Si aucune recherche en cours
		SI Client.EnDehors() ALORS
			// Lit le premier client
			Client.LitPremier()
		FIN
		
		// Lit le client suivant
		Client.LitSuivant()
		// Si la fin du fichier de données est dépassée
		SI Client.EnDehors() ALORS
			Info("Fin du fichier de données atteinte.")
		SINON
			// Affiche les données du client
			Client.VersFenêtre()
		FIN
		```


	- Le code WLangage correspondant à l'événement "Clic" du champ Bouton "BTN_Dernier" est le suivant :
			
		```wl
		// Lit le dernier client
		Client.LitDernier()
		SI Client.EnDehors() ALORS
			// Pas de client
			Info("Aucune fiche à visualiser.")
		SINON
			// Affiche les données du client
			Client.VersFenêtre()
		FIN
		```



 Dans ces différents codes :

- La fonction [&lt;Fichier de données&gt;.LitDernier](../WDLang4/1000025020.md) permet de lire le dernier enregistrement du fichier de données, selon la clé utilisée pour la dernière recherche.

- La fonction [&lt;Fichier de données&gt;.LitSuivant](../WDLang4/1000025035.md) va lire l'enregistrement qui a la valeur de clé immédiatement supérieure à celle de l'enregistrement en cours.

- La fonction [&lt;Fichier de données&gt;.LitPrécédent](../WDLang4/1000025021.md) va lire l'enregistrement qui a la valeur de clé immédiatement inférieure à celle de l'enregistrement en cours.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png) | Note | Le code des champs Bouton "Suivant" et "Précédent" contient des lignes de code supplémentaires permettant de : <br><br>- Vérifier si une recherche dans le fichier de données Client a déjà été effectuée (test de la fonction [&lt;Fichier de données&gt;.EnDehors](../WDLang4/1000024605.md) pour savoir si la lecture du fichier de données est commencée).<br><br>- Lire le premier ou le dernier enregistrement si nécessaire. En effet, il est impossible de lire l'enregistrement suivant ou précédent si aucune lecture n'a été effectuée dans le fichier de données.  <br><br><br> |







- Enregistrez la fenêtre en cliquant sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_Enregistrer_GAF.jpg) parmi les boutons d'accès rapide.



<a name="NOTE4_6"></a>


### Test de la fenêtre
<a name="test_fenetre_ELTPARAGRAPHE000560"></a>

- Réalisons un test de la fenêtre :

	1. Lancez le test de la fenêtre (![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_GO_Fenetre_WD_GAF.jpg) parmi les boutons d'accès rapide).

	2. Cliquez si nécessaire sur le volet d'onglet "Recherche de clients".

	3. Recherchez un client (par exemple, une recherche générique sur "BEEF").

	4. Parcourez le fichier de données en cliquant sur chacun des boutons de parcours.

	5. Arrêtez le test pour revenir sous l'éditeur.









| [Leçon précédente](../TutoWD/1410087532.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087534.md) |
| --- | --- | --- |




