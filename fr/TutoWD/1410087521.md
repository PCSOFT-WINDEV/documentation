
## Leçon 3.2. Projet et analyse
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Ce que vous allez apprendre dans cette leçon
<a name="que_vous_allez_apprendre_dans_cette_lecon_ELTTEXTE000635"></a>


- Création d'un projet.

- Création d'une analyse.





|   |   |
| --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=dur%E9e.png)<br> | <br>Durée estimée : 40 mn |



| [Leçon précédente](../TutoWD/1410087520.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087532.md) |
| --- | --- | --- |







<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000682"></a>
Pour créer une application avec une base de données, il faut :

- Créer le projet lié à l'application. Ce projet regroupera tous les éléments de l'application (fenêtres, codes, requêtes, états, ...). 

- Créer l'analyse liée au projet. L'analyse permet de décrire tous les fichiers de données manipulés par l'application.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | Cette leçon permet de créer une application avec une base de données HFSQL. Comme nous l'avons vu dans la leçon précédente, WINDEV permet également de créer des applications manipulant d'autres bases de données.<br><br>La leçon ["Annexe 2. Utiliser des données d'une base tierce"](../TutoWD/1410087558.md) présente les manipulations nécessaires pour créer un projet et une analyse basés sur une base de données SQL (via OLE DB ou via un Connecteur Natif). |





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Création du projet
<a name="creation_projet_ELTTEXTE000724"></a>
Nous allons tout d'abord créer un projet. Nous avons déjà vu la création d'un projet rapidement dans la partie sur le WLangage. Dans cette leçon, nous allons voir la création du projet en détail.



- Pour créer le projet :

	1. Lancez WINDEV si ce n'est pas déjà fait. 

	2. Affichez si nécessaire la page d'accueil de WINDEV (Ctrl + &lt;). 

	3. Dans la page d'accueil, cliquez sur "Créer un projet", puis sur l'option "Application Windows ou Linux". L'assistant de création d'un projet se lance. Les différentes étapes de l'assistant vont vous aider à créer votre projet. Tous les renseignements indiqués dans cet assistant pourront être modifiés par la suite.
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=astuce.png)<br> | Astuce | Pour créer un projet, vous pouvez également :<br><br>		1. Cliquer sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_Cr%E9er1_GAF.jpg)<br> parmi les boutons d'accès rapide.<br><br>		2. La fenêtre de création d'un nouvel élément s'affiche : cliquer sur "Projet".<br><br><br> |





	4. La première étape de l'assistant permet de sélectionner le système d'exploitation pour lequel le projet est destiné. Sélectionnez "Plateforme Windows" et passez à l'étape suivante de l'assistant (bouton "Suivant").  

	5. Pour cette leçon, nous allons créer un projet "vierge". Vous avez également la possibilité de créer un projet sur un exemple existant, fourni avec WINDEV. Sélectionnez "Créer un projet vierge" et passez à l'étape suivante de l'assistant. 

	6. WINDEV propose ensuite d'indiquer les informations de description de plateforme. Conservez les options par défaut ("Exécutable Windows 64 bits" et "Exécutable avec fenêtres"). Passez à l'étape suivante de l'assistant.

	7. L'assistant propose de saisir le nom du projet, son emplacement et sa description. Dans notre cas, ce projet va simplement s'appeler "WD Ma Première Base De Données".  

	8. Par défaut, WINDEV propose de créer ce projet dans le répertoire ".\\Mes projets\\WD Ma Première Base De Données". Vous pouvez conserver cet emplacement ou le modifier grâce au bouton [...]. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Cr%E9ation%20-%20HC%20N%B0001.jpg&type=thumb)


	9. Les différentes étapes de l'assistant sont indiquées à gauche de l'assistant. Ces étapes sont directement cliquables. Les autres écrans de l'étape "Description" n'étant pas fondamentaux, cliquez directement sur "Chartes".

10. Cette étape permet de définir la charte de programmation utilisée. Ne modifiez pas les options proposées. Passez à l'étape suivante. 

11. Cette étape permet de définir la charte graphique. Sélectionnez "Phoenix". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Cr%E9ation%20-%20HC%20N%B0002.jpg&type=thumb)
Passez à l'étape suivante. 
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | La charte graphique est définie notamment grâce aux gabarits. Les gabarits permettent d'obtenir rapidement des UI (interfaces) professionnelles. Un gabarit définit le look de la fenêtre mais également le look de tous les champs qui seront utilisés dans cette fenêtre. Ainsi, aucune faute de goût n'est possible. |





12. Cliquez sur l'étape "Base de données". Nous allons maintenant donner les renseignements concernant la base de données.

13. Sélectionnez l'option "Oui, créer une nouvelle base de données" et validez. L'assistant de création de l'analyse se lance.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | Pour suivre les différentes leçons de cette partie et optimiser votre apprentissage de WINDEV, il est conseillé de créer le projet "WD Ma Première Base De Données".<br><br>Un exemple corrigé est disponible à tout moment pour vérifier la validité des opérations effectuées.<br><br>Pour ouvrir ce projet corrigé, dans la page d'accueil de WINDEV (Ctrl + &lt;), cliquez sur "Tutoriel" puis cliquez sur "Ma première base de données - Corrigé". |





<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Création de l'analyse
<a name="creation_analyse_ELTTEXTE000802"></a>


- Les étapes de l'assistant de création d'analyse sont les suivantes :

	1. Indiquez le nom et le répertoire de l'analyse. Par défaut, le nom de l'analyse correspond au nom du projet et le répertoire de l'analyse est un répertoire ".ana" dans le répertoire du projet. Nous allons conserver ces paramètres par défaut. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Cr%E9ation%20-%20HC%20N%B0003.jpg&type=thumb)
Passez à l'étape suivante de l'assistant.

	2. Vous pouvez ensuite choisir le type de bases de données manipulées par le projet. Sélectionnez "HFSQL Classic" (la base de données proposée par défaut avec WINDEV). 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Cr%E9ation%20-%20HC%20N%B0004.jpg&type=thumb)
Passez à l'étape suivante de l'assistant.

	3. Validez. L'assistant de création d'un fichier de données se lance automatiquement.







<a name="NOTE4B"></a>
<a name="NOTE4B_1"></a>


## Vocabulaire lié à l'analyse
<a name="vocabulaire_lie_analyse_ELTTEXTE000826"></a>
Avant de commencer réellement à manipuler l'analyse, revenons sur les termes utilisés dans WINDEV. En effet, si vous avez travaillé avec d'autres outils, de nombreux termes sont spécifiques à WINDEV et ne recouvrent pas toujours la même signification que dans d'autres logiciels.

**Dans l'analyse**, les termes utilisés sont les suivants :

- **Fichier de données** : L'analyse permet de décrire la structure des fichiers de la base de données. Le terme "Fichier de données" correspond dans certaines bases de données à "une table".
	Dans WINDEV, le terme "***Table***" est réservé pour désigner un objet graphique permettant de visualiser le contenu d'un fichier de données sous forme de tableau, et/ou de saisir des lignes. Par exemple, une table peut permettre de saisir le détail d'une commande.

- **Enregistrement** : Un enregistrement est quelquefois également appelé ligne. L'enregistrement d'un fichier de données correspond à l'ensemble des rubriques définies pour le fichier de données.

- **Rubrique** : Dans l'analyse, le terme rubrique désigne une zone d'un fichier de données. L'ensemble des rubriques d'un fichier de données permet de définir la structure d'un enregistrement.

- **Clé/Index** : Avec WINDEV et sa base de données HFSQL, la notion d'index est liée à la notion de clé. La notion de clé fait partie des caractéristiques d'une rubrique. Les clés permettent d'accélérer les accès aux données ou de faciliter les parcours des fichiers de données. En WINDEV, si un fichier de données HFSQL a plusieurs rubriques clés, en exécution, un seul fichier d'index sera créé.




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Création de la description des fichiers de données
<a name="creation_description_des_fichiers_donnees_ELTTEXTE000850"></a>
Notre application de gestion de clients et de commandes va être associée à l'analyse suivante. 
Cette analyse comporte cinq fichiers de données (tables) différents :

- Client,

- Commande,

- ModeRèglement,

- LigneCommande,

- Produit.



![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Liaisons%20-%20HC%20N%B0010.jpg&type=thumb)
Pour créer les différents fichiers de données de cette analyse, nous allons utiliser différentes méthodes disponibles dans WINDEV.
<a name="NOTE5_2"></a>


### Création d'un fichier de données : utilisation d'un fichier de données prédéfini
<a name="creation_fichier_donnees_utilisation_fichier_donnees_predefini_ELTPARAGRAPHE000144"></a>

- Les étapes de l'assistant de création d'un fichier de données sont les suivantes :

	1. Sélectionnez dans l'assistant l'option "Sélectionner une description parmi des fichiers de données prédéfinis". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Client%20-%20HC%20N%B0001.jpg&type=thumb)
Passez à l'étape suivante de l'assistant. 

	2. La liste des fichiers de données prédéfinis est affichée. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Client%20-%20HC%20N%B0002.jpg&type=thumb)
Nous allons créer le fichier de données "Client". Dans la liste des fichiers de données, sélectionnez "Client". Passez à l'étape suivante.

	3. L'assistant propose la liste des rubriques à intégrer dans le fichier de données Client. Cette liste est impressionnante car elle permet de gérer de nombreux types de fichiers de données Client. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Client%20-%20HC%20N%B0003.jpg&type=thumb)


	4. Cliquez sur le bouton "Aucun" puis cochez uniquement les rubriques suivantes : IDClient, Société, Nom, Prénom, Adresse, CodePostal, Ville, EtatDep, Pays, Téléphone, Mobile, Email. 

5. Validez l'assistant (bouton "Terminer").

6. Le fichier de données "Client" est automatiquement créé sous l'éditeur d'analyses. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premiere%20base%20-%202%20-%20Fichier%20Client%20-%20HC%20N%B0004.jpg&type=thumb)



<a name="NOTE5_3"></a>


### Création d'un fichier de données : création du fichier de données et des rubriques
<a name="creation_fichier_donnees_creation_fichier_donnees_des_rubriques_ELTPARAGRAPHE000165"></a>

- Pour créer un fichier de données depuis la fenêtre de création d'un nouvel élément :

	1. Cliquez sur "Données" puis sur "Fichier de données".
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | Il est également possible de créer un fichier de données directement depuis l'éditeur d'analyses : dans le ruban, sous le volet "Analyse", dans le groupe "Création", cliquez sur "Nouveau fichier". |





	2. L'assistant de création d'un nouveau fichier de données se lance.

	3. Sélectionnez dans l'assistant l'option "Créer une nouvelle description d'un fichier de données". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Fichier%20Commande%20-%20HC%20N%B0001.jpg&type=thumb)


	4. Passez à l'étape suivante de l'assistant.

5. Nous allons créer le fichier de données "Commande". Saisissez son nom "Commande" dans l'assistant. Ce nom sera utilisé : 

	- pour manipuler le fichier de données en programmation. La variable associée au fichier de données sera "Commande". 

	- pour construire le nom du fichier de données physique associé (fichier "Commande.fic"). Automatiquement, le libellé et la description des éléments représentés par les enregistrements du fichier de données apparaissent.
						|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | Dans l'assistant, le champ "Un enregistrement représente" permet d'avoir un libellé clair lors de la description des liaisons entre les fichiers de données. Automatiquement, un libellé est proposé à partir du nom du fichier de données.<br><br>Dans notre cas, saisissez "Une commande". |




![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Fichier%20Commande%20-%20HC%20N%B0002.jpg)


Nous allons saisir les rubriques du fichier de données "Commande". Dans la fenêtre de description du fichier de données, vous pouvez déjà voir qu'une rubrique a été automatiquement créée : "IDCommande". Cette rubrique correspond à l'identifiant automatique du fichier de données. Cette rubrique est composée des lettres "ID" et du nom du fichier de données.

Nous allons créer les autres rubriques de ce fichier de données.

- Tout d'abord, nous allons créer la rubrique "Date". Cette rubrique contiendra la date de la commande.

	1. Dans la fenêtre de description des rubriques, double-cliquez dans la colonne "Nom" de la première ligne vide. Cette colonne passe automatiquement en saisie. Saisissez "Date".

	2. Cliquez dans la colonne "Libellé". Automatiquement, le nom de la rubrique apparaît. Nous allons modifier le libellé de la rubrique en cliquant dessus : saisissez "Date de la commande". Dans la colonne "Type", le type "Texte" est automatiquement sélectionné. Déroulez la liste et sélectionnez le type "Date". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Fichier%20Commande%20-%20HC%20N%B0004.jpg)


	3. Cette rubrique va être une clé (un index) de notre fichier de données : les clés permettent d'accélérer les accès aux données et les tris.

	- Dans le cas d'une base de données au format SQL, le moteur utilise au mieux les index.

	- Dans le cas d'un parcours séquentiel d'un fichier de données, il suffit d'indiquer l'index de parcours (c'est-à-dire la clé).
						|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | La notion de clé fait partie des caractéristiques d'une rubrique. En fait, lors de la création d'une rubrique, vous avez la possibilité d'indiquer si elle est :<br><br>			- non clé,<br><br>			- clé unique : la valeur de cette clé sera unique dans l'ensemble du fichier de données (c'est-à-dire dans tous les enregistrements du fichier de données).<br><br>			- clé avec doublons : la valeur de cette clé pourra être présente plusieurs fois dans le fichier de données.<br><br><br> |








- Nous allons maintenant créer la rubrique "Etat" qui permet de connaître l'état de la commande.

	1. Positionnez-vous sur une nouvelle ligne de la table. Saisissez :

		- le nom : Etat

		- le libellé : Etat

		- le type : Sélecteur, Liste, Combo. Dans la fenêtre qui s'ouvre, vous pouvez sélectionner le type de champ créé par défaut pour cette rubrique. Ici, ce sera un sélecteur. Validez la fenêtre.




2. Dans la partie basse de l'écran, cliquez sur le lien pour afficher les paramètres du champ lié à la rubrique sélectionnée. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Fichier%20Commande%20-%20HC%20N%B0005%201.jpg)
Les informations saisies dans la nouvelle fenêtre qui s'affiche seront automatiquement utilisées lors de la création des fenêtres liées au fichier de données. Vous retrouvez ici le type du champ et le libellé.
			Nous allons saisir les options suivantes dans l'onglet "Contenu" :

	- Cliquez sur l'onglet "Contenu".

	- Cliquez sur le bouton "+" pour ajouter la première option.

	- L'option 1 correspond à En attente. Saisissez "En attente" dans le champ de saisie à droite du sélecteur.

	- Cliquez sur le bouton "+" pour ajouter la seconde option.

	- Saisissez "Validée" à la place de "Option 2".

	- Cliquez à nouveau sur le bouton "+".

	- Saisissez "Annulée" à la place de "Option 3". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Fichier%20Commande%20-%20HC%20N%B0006.jpg&type=thumb)



<a name="NOTE5_4"></a>


### Importation d'un fichier CSV
<a name="importation_fichier_csv_ELTPARAGRAPHE000283"></a>Pour créer le fichier de données "ModeRèglement", contenant les caractéristiques du règlement, nous allons utiliser une autre méthode : l'import d'un fichier CSV.|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | Un fichier CSV est un fichier texte utilisant un format spécifique. Ce fichier contient des données sur chaque ligne. Les données sont séparées par un caractère de séparation (généralement une virgule, un point-virgule ou une tabulation). |



A partir du fichier CSV contenant les données, WINDEV­ va créer :

- la description du fichier de données dans l'analyse,

- le fichier de données HFSQL avec les données présentes dans le fichier CSV.




- Pour importer un fichier CSV dans l'analyse :

	1. Dans le ruban, sous le volet "Analyse", dans le groupe "Création", déroulez "Importer" et sélectionnez "Importer des descriptions de fichiers/tables".
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=astuce.png)<br> | Astuce | Pour importer un fichier (CSV ou autre) dans l'analyse, il est également possible de réaliser directement un "Drag and Drop" (glisser/déplacer) du fichier CSV (présent dans l'explorateur de fichiers Windows) vers l'éditeur d'analyses. Nous le verrons dans le paragraphe suivant. |





	2. L'assistant d'importation de fichiers se lance.

	3. Passez à l'étape suivante. 

	4. Sélectionnez le format des fichiers à importer. Ici, sélectionnez "Fichier texte". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Import%20CSV%20-%20HC%20N%B0001.jpg&type=thumb)
Passez à l'étape suivante de l'assistant.

	5. Indiquez le chemin du fichier à importer : "\\Tutoriel\\WD\\Exercices\\WD Ma Première Base De Données\\ModeRèglement.csv" présent dans le répertoire d'installation de WINDEV. 

	6. Passez à l'étape suivante de l'assistant.

	7. Indiquez les paramètres d'importation suivants :

		- Les enregistrements sont délimités par : "&lt;Retour chariot/Saut de ligne&gt;".

		- Les colonnes sont délimitées par : "&lt;Point-virgule&gt;".

		- Les chaînes sont délimitées par : "&lt;Aucun&gt;".

		- Séparateur décimal : "&lt;Automatique : point ou virgule&gt;" 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Import%20CSV%20-%20HC%20N%B0002.jpg&type=thumb)







- Examinons la description du fichier de données importé :

	1. Sélectionnez le fichier de données "ModeRèglement".

	2. Dans le menu contextuel (clic droit), sélectionnez l'option "Description du fichier de données".

	3. Dans la fenêtre qui s'affiche, modifiez le libellé du fichier de données : supprimez "(Importé)".

	4. Validez la fenêtre de description du fichier. 







- Examinons la description des rubriques du fichier de données importé :

	1. Sélectionnez le fichier de données "ModeRèglement".

	2. Dans le menu contextuel (clic droit), sélectionnez l'option "Description des rubriques".

	3. Le fichier de données "ModeRèglement" ne contient pas d'identifiant automatique ni de clé unique. Nous allons passer la rubrique "Code" en clé unique :

		- Positionnez le bandeau de sélection si nécessaire sur la rubrique code.

		- Dans la partie droite de l'écran, cliquez sur "Clé unique". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Import%20CSV%20-%20HC%20N%B0005%201.jpg)






<a name="NOTE5_5"></a>


### Importation directe de fichiers de données existants
<a name="importation_directe_fichiers_donnees_existants_ELTPARAGRAPHE000377"></a>La dernière méthode que nous allons voir pour créer des fichiers de données est la simple importation de fichiers de données HFSQL existants. Nous allons utiliser cette méthode pour créer le fichier de données "Produit".



- Pour importer des fichiers de données HFSQL :

	1. Dans l'explorateur de fichiers de Windows, ouvrez le sous-répertoire de WINDEV suivant : "\\Tutoriel\\WD\\Exercices\\WD Ma Première Base De Données".

	2. Sélectionnez le fichier "Produit.fic".

	3. Effectuez un "Drag and Drop" du fichier "Produit.fic" vers l'éditeur d'analyses de WINDEV.

	4. Le fichier de données apparaît sous l'éditeur d'analyses.





Tous les fichiers de données nécessaires sont maintenant présents dans l'éditeur d'analyses.|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=avertissement.png)<br> | Attention ! | Nous avons uniquement importé la description du fichier de données "Produit" dans l'analyse de notre projet. Les données contenues dans le fichier de données "Produit" n'ont pas été importées dans le projet. |







- Pour manipuler les données du fichier que vous venez d'importer : 

	1. Ouvrez directement l'explorateur de fichiers sur le répertoire de votre projet : sous le volet "Accueil", dans le groupe "Général", cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_Rep_Projet_GAF.jpg)
. ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%205%20-%20Import%20FIC%20-%20HC%20N%B0001.jpg)


	2. Ouvrez un nouvel explorateur de fichiers sur le répertoire "\\Tutoriel\\WD\\Exercices\\WD Ma Première Base De Données".

3. Copiez via l'explorateur de fichiers, les fichiers "Produit.fic", "Produit.mmo" et "Produit.ndx" présents dans le répertoire "\\Tutoriel\\WD\\Exercices\\WD Ma Première Base De Données" vers le sous-répertoire EXE du répertoire de votre projet.
			Remarque : il y a 3 fichiers à copier : 

	- "Produit.fic" : fichier contenant les données, 

	- "Produit.mmo" : fichier mémo contenant les images des produits, 

	- "Produit.ndx" : fichier contenant les index pour optimiser les recherches dans le fichier de données. 




<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Création des liaisons
<a name="creation_des_liaisons_ELTTEXTE001024"></a>
Nous avons créé toutes les descriptions de fichiers de données nécessaires à l'application de gestion de comptes. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%205%20-%20Import%20FIC%20-%20HC%20N%B0002.jpg)


Maintenant nous allons créer les liaisons entre les fichiers de données. Une liaison permet de définir les contraintes d'intégrité (cardinalités) entre deux fichiers de données.

- Créons tout d'abord la liaison entre le fichier de données "Client" et le fichier de données "Commande" : un client peut avoir une ou plusieurs commandes et chaque commande est liée à un client.

	1. Sous le volet "Analyse" (présent dans le ruban), dans le groupe "Création", cliquez sur "Nouvelle liaison". Le curseur de la souris se transforme en crayon.

	2. Cliquez sur le fichier de données "Client" puis sur le fichier de données "Commande".

	3. L'assistant de création de liaison se lance.

	4. Répondez aux questions posées par l'assistant : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Liaisons%20-%20HC%20N%B0001.jpg&type=thumb)


		- Chaque Client a au moins une Commande : Non

- Chaque Client peut avoir plusieurs Commandes : Oui

- Chaque Commande a au moins un Client : Oui

- Chaque Commande peut avoir plusieurs Clients : Non
						|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | Vous pouvez également saisir directement les cardinalités de la liaison dans l'assistant. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Liaisons%20-%20HC%20N%B0001%201.jpg&type=thumb)<br> |





5. Passez à l'étape suivante. L'assistant propose automatiquement la clé utilisée par la liaison (IDClient). 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Liaisons%20-%20HC%20N%B0002.jpg&type=thumb)




- De la même manière, créez une liaison entre le fichier de données ModeRèglement et le fichier de données Commande. Ces deux fichiers de données sont liés de la façon suivante :

	- Une commande doit avoir un mode de règlement.

	- Un mode de règlement peut être utilisé dans plusieurs commandes.


 Dans l'assistant :

- Les cardinalités sont les suivantes : ModeRèglement (0,n), Commande (1,1)

- La clé de liaison correspond à la rubrique "Code".




- Nous allons maintenant créer une liaison entre le fichier de données "Produit" et le fichier de données "Commande". Cette liaison va nous permettre de créer un fichier de liaison, le fichier des lignes de commandes.

	1. Créez de la même manière la liaison entre les fichiers de données.

	2. Répondez aux questions posées par l'assistant :

		- Chaque Produit a au moins une Commande : Non

		- Chaque Produit peut avoir plusieurs Commandes : Oui

		- Chaque Commande a au moins un Produit : Non

		- Chaque Commande peut avoir plusieurs Produits : Oui 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Liaisons%20-%20HC%20N%B0004.jpg&type=thumb)







- Nous allons maintenant modifier le fichier de relation qui a été créé par WINDEV. En effet, ce fichier de relation va contenir les lignes de commande. Nous allons :

	- Modifier le nom du fichier de données.

	- Modifier le nom de ses rubriques.

	- Ajouter des rubriques pour connaître la quantité de produit commandé et le total de la ligne de commande.







- Nous allons tout d'abord renommer le fichier de données. Nous avons déjà réalisé une manipulation similaire lorsque nous avons changé le libellé du fichier de données importé. Mais ici, ce n'est pas juste un libellé qui va être modifié : nous allons également renommer le fichier physique lié à la description du fichier de données.

	1. Sélectionnez le fichier de données "Produit_Commande".

	2. Dans le menu contextuel (clic droit), sélectionnez l'option "Description du fichier de données".

	3. Dans la fenêtre qui s'affiche, modifiez dans l'onglet "Général" :

		- le nom du fichier de données par "LigneCommande".

		- le nom sur le disque par "LigneCommande". 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Liaisons%20-%20HC%20N%B0006.jpg&type=thumb)







- Nous allons maintenant modifier les rubriques de ce fichier de relation.

	1. Cliquez sur l'icône ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_ICO_Fichier_Rubrique.jpg)
 (en bas à gauche de la fenêtre de description du fichier) pour afficher la description des rubriques du fichier de données. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Liaisons%20-%20HC%20N%B0007.jpg)


	2. Ce fichier de relation comporte 3 rubriques. Positionnez le bandeau de sélection sur la rubrique "Référence_IDCommande". Cette rubrique est une clé composée.
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | Une clé composée est un ensemble de rubriques constituant un index.<br><br>Ce type de clé permet de parcourir le fichier de données sur des critères complexes ou de faire des recherches sur plusieurs rubriques simultanément. |





3. Pour renommer cette rubrique :

	- Cliquez dans la colonne "Nom".

	- Remplacez "Référence_IDCommande" par "IDLigneCommande".

	- Cliquez dans la colonne "Libellé".

	- Remplacez le libellé actuel par "Identifiant de LigneCommande".




- Nous allons maintenant ajouter 3 nouvelles rubriques dans ce fichier de relation : Quantité, TotalTTC et TotalHT.

	1. Positionnez-vous sur une nouvelle ligne et créez la rubrique "Quantité". Cette rubrique est de type "Numérique".

	2. Positionnez-vous sur une nouvelle ligne et créez la rubrique "TotalTTC". Cette rubrique est de type "Monétaire".

	3. Une fenêtre s'affiche indiquant que la rubrique existe déjà dans l'analyse et proposant de reprendre ses caractéristiques : ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Liaisons%20-%20HC%20N%B0008.jpg)
Conservez les options sélectionnées par défaut et validez (bouton "OK"). 

	4. Positionnez-vous sur une nouvelle ligne et créez la rubrique "TotalHT". Cette rubrique est de type "Monétaire". Là encore, reprenez la description existante.

	5. La description des rubriques pour le fichier de données "LigneCommande" est la suivante. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Liaisons%20-%20HC%20N%B0009.jpg&type=thumb)


	6. Validez la description des rubriques (bouton "OK") et celle du fichier de données. 




- L'analyse est alors la suivante : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%20Liaisons%20-%20HC%20N%B0010.jpg&type=thumb)





<a name="NOTE7"></a>
<a name="NOTE7_1"></a>


## Génération de l'analyse
<a name="generation_analyse_ELTTEXTE001084"></a>
La génération de l'analyse consiste à valider les modifications de l'analyse (création de fichiers de données, ajout ou suppression de rubriques, ...) et à les propager dans tout le projet (pages, champs reliés, états, ...). Le projet "connaîtra" ainsi tous les fichiers de données, rubriques, liaisons définis dans l'analyse. Il sera ainsi très simple de manipuler ces éléments depuis les différents éditeurs de WINDEV. 

La génération (synchronisation) de l'analyse est automatiquement proposée à la fermeture de l'éditeur d'analyses si des modifications ont été effectuées.

Il est également possible de générer l'analyse manuellement. C'est ce que nous allons faire. 

- Pour générer l'analyse :

	1. Dans le ruban de l'éditeur d'analyses, sous le volet "Analyse", dans le groupe "Analyse", cliquez sur "Génération". 

	2. La génération de l'analyse est automatiquement lancée.





Nous avons modifié les descriptions des fichiers de données présents dans l'analyse.

Pour mettre à jour les fichiers de données de l'application, WINDEV lance automatiquement la procédure de modification des fichiers de données. Cette opération permet de mettre à jour les fichiers de données (fichiers ".fic") en fonction de leur description dans l'analyse.

- L'assistant de modification automatique se lance. Validez les différentes étapes jusqu'à l'écran listant les fichiers de données à prendre en compte.

	- WINDEV détecte que le fichier de données ModeRèglement nécessite une mise à jour. Conservez ce fichier de données sélectionné. 

	- WINDEV détecte que le fichier de données Produit est déphasé. Sélectionnez ce fichier de données. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P3_Ma%20premi%E8re%20base%20-%207%20-%20G%E9n%E9ration%20bis%20-%20HC%20N%B0001.jpg&type=thumb)


	- Passez à l'étape suivante.

- L'assistant propose de réaliser une sauvegarde des fichiers de données existants, ne changez rien et passez à l'étape suivante.

- L'assistant propose de saisir des mots de passe de protection des fichiers de données modifiés par la modification automatique. Conservez les options par défaut et passez à l'étape suivante.

- La liste des fichiers de données à modifier apparaît. Validez l'assistant.

- La mise à jour des fichiers de données est effectuée.




- Fermez l'éditeur d'analyses.




Vous venez de découvrir les principales étapes pour la création d'une analyse.

Lorsque votre analyse est décrite et générée, il est également possible de :

- Créer une application complète grâce au RAD (Rapid Application Development). 

- Créer une application complète entièrement personnalisée. Cette méthode sera utilisée pour développer une application complète basée sur une base de données dans la [partie 4](../TutoWD/1410087532.md) de ce tutoriel. Cette application sera basée sur une analyse correspondant à celle que vous avez créée dans cette partie.




| [Leçon précédente](../TutoWD/1410087520.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087532.md) |
| --- | --- | --- |




