
## Leçon 4.4. Imprimer le contenu d'un champ Table
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Ce que vous allez apprendre dans cette leçon
<a name="que_vous_allez_apprendre_dans_cette_lecon_ELTTEXTE000200"></a>


- Imprimer le contenu d'un champ Table.

- Imprimer un bon de commande.





|   |   |
| --- | --- |
| <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=dur%E9e.png)<br> | <br>Durée estimée : 20 mn |

| [Leçon précédente](../TutoWD/1410087534.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087536.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000247"></a>
WINDEV permet d'imprimer vos données :

- directement par programmation.

- via les états. Un état est le nom donné à la représentation graphique d'une édition. Un état est créé grâce à l'éditeur d'états.




WINDEV propose de nombreux types d'états : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Imprimer%20contenu%20Table%20-%20HC%20N%B0001.jpg&type=thumb)


- Vierge,

- Fiche,

- Tableau,

- Tableau croisé,

- Tableau hiérarchique,

- Diagramme de Gantt,

- Agenda ou planning,

- Tableur,

- Mailing,

- Etiquette,

- Etat sur formulaire,

- Etat multicolonne,

- Etat Composite.




Nous allons maintenant découvrir comment créer différents types d'états dans l'application "WD Application Complète".



- Ré-ouvrez si nécessaire le projet que vous avez manipulé dans la leçon précédente.

	1. Affichez la page d'accueil de WINDEV (Ctrl + &lt;).

	2. Dans la page d'accueil, cliquez sur "Tutoriel" puis dans la zone "Partie 4 - Application complète avec données", double-cliquez sur "Application complète - Exercice".

	3. WINDEV vous propose d'ouvrir le projet que vous avez manipulé dans la leçon précédente. Vous pouvez ouvrir le projet présent sur votre poste ou ouvrir le projet original. Choisissez "Ouvrir la copie locale". 





|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=exemple-WD.png) | Corrigé | Un projet corrigé est disponible. Ce projet contient les différents états créés dans cette leçon. Pour ouvrir le projet corrigé, dans la page d'accueil, cliquez sur "Tutoriel" puis dans la zone "Partie 4 - Application complète avec données", double-cliquez sur "Application complète - Corrigé". |







<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Impression du contenu d'un champ Table
<a name="impression_contenu_champ_table_ELTTEXTE000289"></a>
Dans la leçon précédente, nous avons créé un champ Table permettant d'afficher le résultat d'une recherche multicritère. Nous allons étudier maintenant les différentes possibilités pour imprimer le contenu de ce champ Table.

<a name="NOTE3_2"></a>


### Impression directe via la FAA (Fonctionnalité Automatique de votre Application)
<a name="impression_directe_via_faa_fonctionnalite_automatique_votre_application_ELTPARAGRAPHE000072"></a>Dans les leçons précédentes, nous avons déjà vu que WINDEV proposait de nombreuses fonctionnalités automatiques (appelées FAA). Pour l'impression du contenu d'un champ Table, il existe une FAA.|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png) | Note | La liste des FAA (Fonctionnalités Automatiques de votre Application) les plus courantes est disponible dans le fichier WINDEV FAA 28.PDF. Ce fichier est automatiquement intégré dans votre application si vous choisissez l'option "Aide des FAA" lors de la création du menu automatique. |






- Faisons un test rapide :

	1. Affichez si nécessaire la fenêtre "FEN_Menu" sous l'éditeur de fenêtres.

	2. Cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_GO_Fenetre_WD_GAF.jpg) parmi les boutons d'accès rapide.

	3. Sélectionnez si nécessaire le volet d'onglet "Recherche de commandes".

	4. Définissez les différents paramètres de la recherche :

		- Etat des commandes,

		- Mode de règlement,

		- Fourchette de dates à prendre en compte.




5. Cliquez sur "Rechercher".

6. Lorsque les données sont affichées dans le champ Table, affichez le menu contextuel du champ (icône <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_ICO_MenuCtx_Table.jpg)
 en haut à droite ou clic droit sur le champ). <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Imprimer%20contenu%20Table%20-%20HC%20N%B0002.jpg&type=thumb)




Vous voulez personnaliser l'état proposé par défaut ? Il suffit de créer un état automatique sur le champ Table. Cet état (s'il existe) sera automatiquement utilisé par l'option d'impression du champ Table.
<a name="NOTE3_3"></a>


### Création d'un état automatique sur un champ Table
<a name="creation_etat_automatique_sur_champ_table_ELTPARAGRAPHE000119"></a>Pour créer un état imprimant les données d'un champ Table, il suffit de créer un "Etat sur champ table" : l'état correspondant au champ Table est créé automatiquement.



- Pour créer un "Etat sur champ Table" :

	1. Si nécessaire, sous l'éditeur de fenêtres, affichez le volet d'onglet "Recherche de commandes" (cliquez dessus).

	2. Sous le volet "Création", dans le groupe "Données", déroulez "Table et Liste" et sélectionnez "Etat sur champ Table".

	3. Notre fenêtre contenant 2 champs Table sur des volets d'onglet différents, WINDEV demande de sélectionner le champ Table voulu. Dans notre cas, sélectionnez "TABLE_REQ_RechercheCommandes" et validez.

	4. La forme d'un champ Bouton apparaît sous le curseur de la souris. Ce champ est automatiquement créé et contient le code WLangage permettant de lancer l'impression du contenu du champ Table. 

	5. Cliquez dans la fenêtre à la position où le champ doit être créé (par exemple en dessous du champ Bouton "Rechercher" dans le volet d'onglet "Recherche de commandes").

	6. L'état est immédiatement créé.

	7. Une fenêtre s'affiche proposant de sauvegarder l'état. Validez.

	8. L'éditeur d'états apparaît avec l'état qui a été automatiquement créé. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P4_Application%20compl%E8te%20-%20Imprimer%20contenu%20Table%20-%20HC%20N%B0004.jpg&type=thumb)


	9. Dans cet état, vous retrouvez les titres des colonnes du champ Table présent dans la fenêtre. Nous allons juste faire une petite modification dans cet état : nous allons modifier le titre. 

	- Sélectionnez le champ correspondant au titre de l'état ("Table REQ_RechercheCommandes" est affiché dans le champ) et double-cliquez sur ce champ.

	- Dans la fenêtre de description, modifiez le libellé et saisissez "Commandes recherchées".

	- Validez.




| [Leçon précédente](../TutoWD/1410087534.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087536.md) |
| --- | --- | --- |




