
## Annexe 2. Utiliser des données d'une base de données tierce
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Ce que vous allez apprendre dans cette leçon
<a name="que_vous_allez_apprendre_dans_cette_lecon_ELTTEXTE000182"></a>


- Création d'un projet.

- Création d'une analyse.





|   |   |
| --- | --- |
| <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=dur%E9e.png)<br> | <br>Durée estimée : 40 mn |

| [Leçon précédente](../TutoWD/1410087557.md) | [Sommaire](../TutoWD/1410086886.md) | [Leçon suivante](../TutoWD/1410087559.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000229"></a>
Cette leçon va vous permettre de découvrir comment manipuler des bases de données SQL avec WINDEV. |   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png) | Note | Cette leçon est destinée aux personnes maîtrisant les bases de données SQL. Toutes les manipulations à faire sur la base de données SQL ne seront pas détaillées. |



Pour créer une application utilisant une base de données SQL, il faut :

- Créer le projet lié à l'application. Ce projet regroupera tous les éléments de l'application (fenêtres, codes, requêtes, états, ...). 

- Importer la description des fichiers de données SQL.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png) | Note | Pour réaliser cette leçon, vous devez : <br><br>1. Vous connecter à votre serveur SQL. <br><br>2. Importer sur le serveur SQL les fichiers de script SQL et le répertoire des images (présents dans le répertoire "Exercices\\BaseSQL\\" du répertoire contenant les exemples de ce tutoriel) avec les outils d'importation fournis (MySql, Oracle, SQL Server, ...). Le répertoire des images permet d'obtenir les images du fichier de données Produit. <br><br>3. Exécuter les fichiers de script SQL sur le serveur SQL. <br>	Remarque : Les scripts SQL fournis sont des scripts fonctionnant sur Oracle uniquement.<br><br><br>Votre base de données SQL de travail pour cette leçon est prête. |





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Création du projet
<a name="creation_projet_ELTTEXTE000289"></a>


- Pour créer le projet :

	1. Lancez WINDEV si ce n'est pas déjà fait. 

	2. Affichez la page d'accueil de WINDEV (Ctrl + &lt;). 

	3. Dans la page d'accueil, cliquez sur le bouton "Créer un projet", puis sur l'option "Application Windows ou Linux". L'assistant de création de projet se lance. Les différentes étapes de l'assistant vont vous aider à créer votre projet. Tous les renseignements indiqués dans cet assistant pourront être modifiés par la suite.
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=astuce.png) | Astuce | Astuce : Pour créer un projet, vous pouvez également :<br><br>		1. Cliquer sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_Cr%E9er1_GAF.jpg) parmi les boutons d'accès rapide.<br><br>		2. La fenêtre de création d'un nouvel élément s'affiche : cliquer sur "Projet".<br><br><br> |





	4. La première étape de l'assistant permet de sélectionner le système d'exploitation pour lequel le projet est destiné. Sélectionnez "Plateforme Windows" et passez à l'étape suivante de l'assistant (bouton "Suivant").  

	5. Pour cette leçon, nous allons créer un projet "vierge". Sélectionnez "Créer un projet vierge" et passez à l'étape suivante de l'assistant. 

	6. WINDEV propose ensuite d'indiquer les informations de description de plateforme. Conservez les options par défaut ("Exécutable Windows 64 bits" et "Exécutable avec fenêtres"). Passez à l'étape suivante de l'assistant.

	7. L'assistant propose de saisir le nom du projet, son emplacement et sa description. Dans notre cas, ce projet va simplement s'appeler "basesql".  

	8. Les différentes étapes de l'assistant sont indiquées dans le menu à gauche. Ces étapes sont directement cliquables. Les autres écrans de l'étape "Description" n'étant pas fondamentaux, cliquez directement sur "Chartes". 

	9. Cette étape permet de définir la charte de programmation utilisée. Ne modifiez pas les options proposées. Passez à l'étape suivante. 

	10. Cette étape permet de définir la charte graphique. Sélectionnez "Elegant". Passez à l'étape suivante.

	11. Cliquez sur l'étape "Base de données". Cette étape permet de donner les renseignements concernant la base de données.

	12. Sélectionnez l'option "Oui, utiliser une base de données existante". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P8_Import%20OLEDB%20-%20HC%20N%B0001.jpg&type=thumb)
Passez à l'étape suivante.

	13. Sélectionnez l'option "Importer la description depuis une base de données existante". <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P8_Import%20OLEDB%20-%20HC%20N%B0002.jpg&type=thumb)


	14. L'assistant de création de l'analyse se lance.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Création de l'analyse
<a name="creation_analyse_ELTTEXTE000331"></a>


- Les étapes de l'assistant de création d'analyse sont les suivantes :

	1. Indiquez le nom et le répertoire de l'analyse. Par défaut, le nom de l'analyse correspond au nom du projet et le répertoire de l'analyse est un répertoire ".ana" dans le répertoire du projet. Nous allons conserver ces paramètres par défaut. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P8_Import%20OLEDB%20-%20HC%20N%B0003.jpg&type=thumb)
Passez à l'étape suivante de l'assistant. 

	2. Vous pouvez ensuite choisir le ou les types de bases de données manipulées par le projet. Sélectionnez OLE DB (ou la base de données SQL utilisée si vous possédez le Connecteur Natif correspondant). 
			Remarque : Les Connecteurs Natifs sont listés en premier. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P8_Import%20OLEDB%20-%20HC%20N%B0004.jpg&type=thumb)
Passez à l'étape suivante de l'assistant.

	3. Sélectionnez la source OLE DB correspondant au type de votre base de données.
			Passez à l'étape suivante de l'assistant.

	4. Indiquez dans les étapes suivantes les paramètres de votre connexion OLE DB (si vous avez choisi un Connecteur Natif, les étapes sont identiques) :

		- le nom du serveur de la base de données. 

		- le nom de l'utilisateur et son mot de passe. 

		- le nom de la base de données si nécessaire. 

		- le nom de la connexion (le libellé associé à la connexion est optionnel). 


 Passez à l'étape suivante.

5. Indiquez le mode d'accès aux données. <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P8_Import%20OLEDB%20-%20HC%20N%B0007.jpg&type=thumb)
Il est possible de :

	- accéder directement aux données dans leur format actuel. Seule la description des tables est importée dans l'analyse. Aucune conversion n'est nécessaire.

	- convertir les données dans le format HFSQL Classic. 




- L'analyse est alors la suivante : <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P8_Import%20OLEDB%20-%20HC%20N%B0010.jpg&type=thumb)





<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Génération de l'analyse
<a name="generation_analyse_ELTTEXTE000355"></a>
La génération de l'analyse consiste à valider les modifications de l'analyse (création de fichiers de données, ajout ou suppression de rubriques, ...) et à les propager dans tout le projet (pages, champs reliés, états, ...).

La génération est automatiquement proposée lorsque vous fermez l'éditeur d'analyses et que des modifications ont été effectuées.

Il est également possible de générer l'analyse manuellement. C'est ce que nous allons faire. 

- Pour générer l'analyse :

	1. Sous l'éditeur d'analyses, sous le volet "Analyse" du ruban, dans le groupe "Analyse", cliquez sur "Génération".

	2. La génération de l'analyse est automatiquement lancée.







Lorsque votre analyse est générée, la manipulation des données se fait de la même manière que les données HFSQL. Il n'y a aucune différence. Il est possible de :

- Créer une application complète grâce au RAD (Rapid Application Development). 

- Créer une application complète entièrement personnalisée. Pour plus de détails, consultez la ["Partie 4"](../TutoWD/1410087532.md). 




| [Leçon précédente](../TutoWD/1410087557.md) | [Sommaire](../TutoWD/1410086886.md) | [Leçon suivante](../TutoWD/1410087559.md) |
| --- | --- | --- |




