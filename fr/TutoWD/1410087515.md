
## Leçon 2.4. Les instructions conditionnelles 


<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Ce que vous allez apprendre dans cette leçon
<a name="que_vous_allez_apprendre_dans_cette_lecon_ELTTEXTE000270"></a>


- L'instruction SI.

- L'instruction SELON.





|   |   |
| --- | --- |
| <br>![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=dur%E9e.png)<br> | <br>Durée estimée : 20 mn |

| [Leçon précédente](../TutoWD/1410087587.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087516.md) |
| --- | --- | --- |







<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000317"></a>
Le WLangage est une suite d'instructions manipulant des données. 

Les instructions conditionnelles permettent de comparer des variables et/ou des valeurs entre elles afin de faire des traitements différents. Il existe plusieurs instructions conditionnelles :

- SI... ALORS... SINON... FIN

- SELON ...



<a name="NOTE2_2"></a>


### Exemple pratique
<a name="exemple_pratique_ELTPARAGRAPHE000039"></a>Pour réaliser les manipulations de cette leçon, nous allons reprendre le projet "WLangage" que nous avons utilisé dans la leçon précédente. Le principe est toujours le même : le code exemple va être saisi directement dans l'événement "Initialisation" du projet. 





- Ouvrez si nécessaire le projet "WLangage" que vous avez créé dans la première leçon de cette partie (consultez le paragraphe [Un projet pour découvrir le WLangage](../TutoWD/1410087578.md) de la leçon 2.1).








- Pour afficher les événements WLangage liés au projet : 

	1. Dans la barre des éléments ouverts, faites un clic droit sur le bouton "P". Le menu contextuel s'affiche. 

	2. Sélectionnez l'option "Code de l'élément". 

	3. L'éditeur de code affiche les différents événements associés au projet. 







<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## L'instruction SI
<a name="instruction_ELTTEXTE000347"></a>
Cette instruction permet d'exécuter un traitement ou un autre en fonction du résultat d'une expression. Si l'expression est vérifiée, un traitement est lancé ; si l'expression n'est pas vérifiée, un autre traitement peut être lancé.  

L'instruction SI s'utilise comme ci-dessous : 

```txt
SI <Expression à vérifier> ALORS
   Traitement à exécuter dans le cas où l'expression est vérifiée
SINON
   Traitement à exécuter dans le cas contraire
FIN
```



- Nous allons tester cette instruction grâce à un exemple simple de code WLangage : 

	1. Supprimez si nécessaire le code WLangage présent dans l'événement "Initialisation" du projet et copiez le code suivant. 
			Ce code sélectionne un nombre au hasard et selon la valeur affiche un message. 
			
		```wl
		NombreAléatoire est un entier
		// Initialise le générateur de nombre aléatoire
		InitHasard()
		// Prend un nombre au hasard entre 100 et 4000
		NombreAléatoire = Hasard(100, 4000)
		Trace("Valeur du nombre aléatoire " + NombreAléatoire)
		// Vérifie si ce nombre est supérieur strictement à 2000
		SI NombreAléatoire > 2000 ALORS
			Trace("Nombre supérieur à 2000")
		SINON
			Trace("Nombre inférieur ou égal à 2000")
		FIN
		```
Dans ce code, l'expression à vérifier correspond à "NombreAléatoire&gt;2000".

	2. Testons immédiatement ce code : cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_GO_Projet_WD_GAF.jpg) parmi les boutons d'accès rapide. 

	3. Affichez si nécessaire le volet "Trace du débogueur" pour voir le résultat : sous le volet "Accueil", dans le groupe "Environnement", déroulez "Volets" et sélectionnez "Volets" puis "Trace du débogueur". 

	4. Le volet "Trace du débogueur" contiendra le message correspondant à votre cas (le nombre étant aléatoire, le message peut changer à chaque test !). 







**Remarque** : L'instruction SI peut également être présentée sous forme d'une seule ligne grâce à l'instruction "? ... SINON" (l'instruction est ici sur 2 lignes car elle ne rentre pas dans la page !) : 

```txt
<Expression à vérifier> ? <Traitement si expression vérifiée> 
	SINON <Traitement dans le cas contraire>
```
Cette instruction est une forme abrégée de l'instruction SI ... ALORS ... SINON : elle prend moins de place, mais elle est peut être moins simple à comprendre. 
Pour notre exemple, le code devient : 

```wl
// Instruction conditionnelle monoligne
Trace(NombreAléatoire > 2000 ? "Nombre supérieur à 2000" SINON "Nombre inférieur ou égal à 2000")
```




- Dans une instruction SI, il est également possible de cumuler ou non les conditions grâce aux mots-clés ET et OU. Voici quelques exemples simples que vous pouvez tester directement. 

	- Condition composée avec le mot-clé ET : Permet de savoir si deux conditions sont respectées. Les deux conditions sont évaluées. 
			
		```wl
		// Condition composée (mots-clés ET et OU)
		Condition1 est un booléen = Faux
		Condition2 est un booléen = Vrai
		// - mot-clé ET
		SI Condition1 ET Condition2 ALORS
			Trace("Condition1 ET Condition2 : <vrai>")
		SINON
			Trace("Condition1 ET Condition2 : <faux>")
		FIN
		```

			En lançant à nouveau le test du projet, vous obtiendrez dans le volet "Trace du débogueur" : 
			
		```txt
		Condition1 ET Condition2 : <faux>
		```


	- Condition composée avec le mot-clé OU : Permet de de tester si l'une ou l'autre des conditions sont respectées. Là aussi, les deux conditions sont évaluées. 
			
		```wl
		Condition1 est un booléen = Faux
		Condition2 est un booléen = Vrai
		
		SI Condition1 OU Condition2 ALORS
			Trace("Condition1 OU Condition2 : <vrai>")
		SINON
			Trace("Condition1 OU Condition2 : <faux>")
		FIN
		```

			En lançant à nouveau le test du projet, vous obtiendrez dans le volet "Trace du débogueur" : 
			
		```txt
		Condition1 OU Condition2 : <vrai>
		```

			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png) | Note | Il est possible de ne pas évaluer la seconde condition si la première condition est fausse : il suffit d'utiliser le mot-clé _ET_. Par exemple : <br><br><pre><code>Condition1 est un booléen = Faux<br>		Condition2 est un booléen = Vrai<br>		<br>		SI Condition1 _ET_ Condition2 ALORS<br>			Trace("Condition1 _ET_ Condition2 : <vrai>")<br>		SINON<br>			Trace("Condition1 _ET_ Condition2 : <faux>")<br>		FIN</code></pre><br><br>En lançant à nouveau le test du projet, vous obtiendrez dans le volet "Trace du débogueur" : <br><br><pre><code>Condition1 _ET_ Condition2 : <faux></code></pre><br><br><br>De la même manière, en utilisant le mot-clé _OU_, si la première partie de l'expression est vraie, la suite de l'expression n'est pas évaluée. |











Pour plus de détails, consultez [Instruction SI](../Motscles/1510011.md). 

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## L'instruction SELON
<a name="instruction_selon_ELTTEXTE000389"></a>
Cette instruction permet d'évaluer une expression et d'exécuter un traitement pour chaque valeur possible de l'expression.

L'instruction SELON s'utilise comme ci-dessous :

```txt
SELON <Expression>
CAS Valeur 1 : 
	Traitement 1
CAS Valeur 2 : 
	Traitement 2
...
CAS Valeur N : 
	Traitement N

AUTRES CAS
	Traitement 
FIN
```



- Nous allons écrire un petit code WLangage afin de tester cette instruction : 

	1. Supprimez si nécessaire le code WLangage présent dans l'événement "Initialisation" du projet et copiez le code suivant. Ce code récupère la date du jour et selon sa valeur affiche un message différent. Pour le 1er et le 15 du mois, un message spécifique est affiché. Dans les autres cas, la date du jour est affichée.
			
		```wl
		// Par défaut, la variable de type Date est initialisée avec la date du jour
		LaDateDuJour est une Date
		
		// Teste le jour de la date
		SELON LaDateDuJour.Jour
			// 1er jour du mois
			CAS 1 : Trace("Nous sommes le premier jour du mois.")
			// 15ème jour du mois
			CAS 15 : Trace("Nous sommes le 15 du mois.")
			// Pour toutes les autres jours, affiche la date
			AUTRES CAS : Trace("Nous sommes le : " + LaDateDuJour.VersChaîne())
		FIN
		```

			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png) | Note | Le WLangage est composé de fonctions et de propriétés. Les fonctions peuvent attendre des paramètres et renvoient des résultats. Les propriétés sont directement appliquées aux champs ou aux variables grâce à la syntaxe : <br><br><pre><code><Nom du champ ou de la variable>.<Nom de la propriété></code></pre><br><br><br>Dans notre exemple, la propriété [Jour](../Proprietes/2512043.md) est utilisée sur la variable LaDateDuJour pour obtenir le jour de la date. |





	2. Testons immédiatement ce code : cliquez sur ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=ICO_GO_Projet_WD_GAF.jpg) parmi les boutons d'accès rapide. 

	3. Le volet "Trace du débogueur" contiendra le message correspondant à votre cas (selon la date du jour, le message peut changer !). Par exemple, si le test est lancé le 28/11/2021 : 
			
		```txt
		Nous sommes le : 28/11/2021
		```








**Remarques** :

- Si la ligne de code "CAS 1:..." est exécutée, les autres lignes de code correspondant aux valeurs possibles ne sont pas exécutées. 

- Il est possible de regrouper dans le même cas plusieurs valeurs. Les différentes valeurs sont séparées par une virgule. Par exemple, pour tester le mois de la date, il est possible de compléter notre code WLangage par les lignes suivantes : 
	
	```wl
	SELON LaDateDuJour.Mois
		// Les mois 1, 2 et 3
		CAS 1, 2, 3 : Trace("Nous sommes au premier trimestre de l'année.")
		// Les mois compris entre 4 et 6
		CAS 4 <= * <= 6 : Trace("Nous sommes au deuxième trimestre de l'année.")
		// Les mois après le sixième mois
		CAS > 6 : Trace("Nous sommes au second semestre de l'année.")
	FIN
	```

	En lançant à nouveau le test du projet, vous obtiendrez dans le volet "Trace du débogueur" pour le 28/11/2021 : 
	
	```txt
	Nous sommes le : 28/11/2021
	Nous sommes au second semestre de l'année.
	```





- Dans nos exemples, le traitement correspondant à une valeur de l'expression est composé d'une seule ligne de code, placé directement après l'instruction "CAS X :". Il est également possible d'exécuter plusieurs lignes de code. Dans ce cas, les différentes lignes de code sont placées sous l'instruction "CAS X :". La syntaxe à utiliser est la suivante :
	
	```txt
	SELON <Expression>
	CAS Valeur 1 : 
		Traitement 1 - Ligne de code 1
		Traitement 1 - Ligne de code 2
	CAS Valeur N : 
		Traitement N - Ligne de code 1
		Traitement N - Ligne de code 2
	AUTRES CAS
		Traitement 
	FIN
	```





| [Leçon précédente](../TutoWD/1410087587.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087516.md) |
| --- | --- | --- |




