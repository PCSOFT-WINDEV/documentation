
## Leçon 5.3. Administrer une base de données Client/Serveur
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Ce que vous allez apprendre dans cette leçon
<a name="que_vous_allez_apprendre_dans_cette_lecon_ELTTEXTE000251"></a>


- Le Centre de Contrôle HFSQL.

- Créer un utilisateur dans le Centre de Contrôle HFSQL.

- Sauvegarder la base de données.





|   |   |
| --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=dur%E9e.png)<br> | <br>Durée estimée : 20 mn |

| [Leçon précédente](../TutoWD/1410087541.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087543.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000298"></a>
Maintenant que nous savons créer/adapter une application pour qu'elle fonctionne en mode HFSQL Client/Serveur, nous allons voir comment administrer la base de données associée. 

En effet, une base de données Client/Serveur nécessite :

- une configuration spécifique des postes (installation d'un serveur HFSQL, etc.).

- une administration réalisée grâce au Centre de Contrôle HFSQL.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Configuration des postes
<a name="configuration_des_postes_ELTTEXTE000322"></a>
Pour utiliser une base HFSQL Client/Serveur, il est nécessaire d'installer un serveur HFSQL sur le poste serveur. Il est possible d'utiliser plusieurs serveurs HFSQL sur le même poste, utilisant des ports différents. Sur chaque serveur, une ou plusieurs bases de données peuvent être installées.

Par exemple, il est possible d'installer sur le même poste un serveur HFSQL de tests, avec une base de données de tests et un serveur HFSQL de production, utilisant un port différent.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Le Centre de Contrôle HFSQL
<a name="centre_controle_hfsql_ELTTEXTE000346"></a>
Le Centre de Contrôle HFSQL permet de réaliser toutes les opérations d'administration des serveurs et des bases de données HFSQL Client/Serveur.

Nous allons voir les fonctionnalités les plus importantes.

Nous allons tout d'abord lancer le Centre de Contrôle HFSQL depuis le projet WINDEV, "WD Application complète" que nous avons manipulé dans la leçon précédente.

- Ré-ouvrez si nécessaire le projet que vous avez manipulé dans la leçon précédente. 

	1. Affichez la page d'accueil de WINDEV (Ctrl + &lt;).

	2. Dans la page d'accueil, cliquez sur "Tutoriel" puis dans la zone "Partie 5 - Administrer une base HFSQL Client/Serveur", double-cliquez sur "Application complète - Exercice".

	3. WINDEV vous propose d'ouvrir le projet que vous avez manipulé dans la leçon précédente. Vous pouvez ouvrir le projet présent sur votre poste ou ouvrir le projet original. Choisissez "Ouvrir la copie locale". 





|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | **Pour faire les manipulations de cette leçon sur le projet "WD Application Complète", il est nécessaire d'avoir effectué les manipulations de la leçon précédente sur ce projet**. |







- Pour lancer le Centre de Contrôle HFSQL et accéder aux données :

	1. Dans le menu de WINDEV, sous le volet "Outils", dans le groupe "Base de données", cliquez sur "HFSQL". Le Centre de Contrôle HFSQL apparaît.

	2. La fenêtre de bienvenue dans le Centre de Contrôle HFSQL s'affiche. L'analyse du projet en cours est automatiquement sélectionnée. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P5_Passage%20analyse%20en%20CS%20-%20HC%20N%B0008.jpg&type=thumb)


	3. Validez l'écran. Le Centre de contrôle HFSQL apparaît. Ce mode de lancement permet de voir les différents fichiers liés à l'analyse du projet en cours.

4. Cliquez si nécessaire sur l'onglet vertical "HFSQL C/S". La liste des fichiers de données au format HFSQL Client/Serveur s'affiche. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P5_Passage%20analyse%20en%20CS%20-%20HC%20N%B0009.jpg&type=thumb)
Le Centre de Contrôle liste ici les fichiers de données Client/Serveur trouvés dans l'analyse liée au projet en cours. Aucune connexion n'est réalisée : les fichiers de données apparaissent grisés.

5. Pour visualiser les données des fichiers, double-cliquez sur un des fichiers de données dans la liste à gauche (par exemple "Commande"). Si le Centre de Contrôle HFSQL ne connaît pas tous les paramètres de la connexion, une fenêtre de connexion permet de réaliser la connexion effective au serveur HFSQL Client/Serveur utilisé. Si cette fenêtre s'affiche, indiquez le mot de passe et validez.

6. Les différentes informations sur le fichier de données sélectionné et utilisant cette connexion sont affichées dans un nouveau volet "Commande". Ce volet présente ces informations dans plusieurs onglets verticaux : 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P5_Passage%20analyse%20en%20CS%20-%20HC%20N%B0011.jpg&type=thumb)




**Depuis le Centre de Contrôle HFSQL, il est possible d'administrer toute la base de données HFSQL Client/Serveur**.

<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Créer un compte utilisateur dans le Centre de Contrôle HFSQL
<a name="creer_compte_utilisateur_dans_centre_controle_hfsql_ELTTEXTE000388"></a>
Nous avons vu que lors de l'installation d'un serveur HFSQL et lors de la création d'une base de données, un seul compte utilisateur est créé : le compte de l'administrateur (login "Admin" sans mot de passe).

L'utilisation de compte utilisateur permet de sécuriser l'accès aux données. En effet, tous les utilisateurs de l'application ne sont pas des administrateurs. A chaque utilisateur (ou groupe d'utilisateurs), il est possible d'associer des droits.|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=avertissement.png)<br> | Attention ! | Les droits des utilisateurs spécifiés dans le Centre de Contrôle HFSQL sont des droits de base de données et pas des droits d'application.<br><br>Il ne faut pas confondre la gestion des droits des bases de données Client/Serveur avec le groupware utilisateur. |



Certains utilisateurs peuvent par exemple ne pas avoir le droit d'écrire dans certains fichiers de données.

Pour faire un test simple, nous allons créer un utilisateur et lui permettre de consulter les enregistrements du fichier de données Client.



- Pour se connecter directement à la base de données présente sur le serveur :

	1. Déroulez le menu ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P5_Passage%20analyse%20en%20CS%20-%20HC%20N%B0009%201.jpg)
 situé en haut à gauche du Centre de Contrôle HFSQL et sélectionnez l'option "Se connecter à un serveur HFSQL".

	2. La fenêtre de bienvenue dans le Centre de Contrôle HFSQL s'affiche. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P5_Passage%20analyse%20en%20CS%20-%20HC%20N%B0012.jpg&type=thumb)


	3. L'option "Se connecter à un serveur HFSQL" est sélectionnée par défaut. Indiquez les caractéristiques du serveur installé dans la leçon précédente puis validez. 

4. Les caractéristiques du serveur HFSQL sont affichées :

	- dans le panneau de gauche, le nom du serveur HFSQL ainsi que la liste des bases présentes sur ce serveur apparaissent.

	- dans la partie droite de l'écran, un nouvel onglet est affiché permettant de voir les caractéristiques du serveur HFSQL. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P5_Passage%20analyse%20en%20CS%20-%20HC%20N%B0013.jpg&type=thumb)


Nous allons maintenant attribuer des droits à l'utilisateur : l'utilisateur "Test" peut se connecter à la base de données et consulter le fichier de données Client. 



- Pour donner le droit de connexion à la base de données :

	1. Dans le Centre de Contrôle HFSQL, double-cliquez sur la base de données "WD Application Complète".

	2. Sous le volet "WD Application Complète", dans le groupe "Droits", cliquez sur "Gestion des droits".

	3. Sélectionnez l'utilisateur "Test" dans la liste des utilisateurs.

	4. Dans la liste des droits, pour l'action "Droit de se connecter au serveur (connexion cryptée et non cryptée)", cliquez dans la colonne "Droit défini" et sélectionnez la coche verte. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P5_Passage%20analyse%20en%20CS%20-%20HC%20N%B0016.jpg&type=thumb)


	5. Cliquez sur le bouton "Appliquer" présent en bas de la fenêtre. Le droit devient effectif.

6. Fermez la fenêtre de gestion des droits.




- Pour donner le droit de lire le fichier de données Client :

	1. Dans le Centre de Contrôle HFSQL, déroulez la base de données "WD Application Complète", puis double-cliquez sur le fichier de données Client (à gauche de l'écran).

	2. Sous le volet "Client", dans le groupe "Droits", cliquez sur "Gestion des droits".

	3. Sélectionnez l'utilisateur "Test" dans la liste des utilisateurs.

	4. Dans la liste des droits, pour l'action "Droit de lire les enregistrements d'un fichier", cliquez dans la colonne "Droit défini" et sélectionnez la coche verte. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P5_Passage%20analyse%20en%20CS%20-%20HC%20N%B0017.jpg&type=thumb)


	5. Cliquez sur le bouton "Appliquer" présent en bas de la fenêtre. Le droit devient effectif.

6. Fermez la fenêtre de gestion des droits.




De cette façon, il est possible de définir des droits :

- sur le serveur HFSQL

- sur la base de données

- sur les fichiers de la base de données.




Dans notre exemple, l'utilisateur "Test" pourra uniquement parcourir les enregistrements du fichier de données Client. Si cet utilisateur tente une autre action, un message s'affichera : "L'utilisateur Test n'a pas les droits suffisants pour XXXX" (où XXXX correspond à l'action effectuée).

Une fois le compte créé, il peut être utilisé lors de la connexion de l'application au serveur (quand la fonction [HOuvreConnexion](../WDLang4/3044107.md) est utilisée).|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=note.png)<br> | Note | La gestion des utilisateurs et de leurs droits peut également être effectuée par programmation grâce aux fonctions WLangage. <br> |





<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Sauvegarder la base de données
<a name="sauvegarder_base_donnees_ELTTEXTE000466"></a>
Pour sauvegarder la base de données : 

1. Positionnez-vous sur l'onglet correspondant à la base "WD Application Complète". 

2. Sélectionnez l'onglet vertical "Sauvegardes". 

3. Dans le menu, dans le groupe "Sauvegardes", déroulez "Nouvelle sauvegarde" et sélectionnez "Nouvelle sauvegarde à chaud". 
	Remarque : Cette option est accessible dans le groupe "Sauvegardes" :

	- sur l'onglet correspondant au serveur HFSQL,

	- sur l'onglet correspondant à la base de données. 
![](https://doc.pcsoft.fr/fr-FR/images/image.awp?langid=5&name=P5_Passage%20analyse%20en%20CS%20-%20HC%20N%B0018.jpg&type=thumb)
Remarque : L'assistant permet également de réaliser une sauvegarde d'une sélection de fichiers de données.




4. Validez la sauvegarde. 




<a name="NOTE7"></a>
<a name="NOTE7_1"></a>


## Conclusion
<a name="conclusion_ELTTEXTE000490"></a>
Le Centre de Contrôle HFSQL est un outil complet d'administration de base de données, permettant entre autres :

- d'arrêter ou de redémarrer un serveur en cas de problème,

- de gérer les utilisateurs et leurs droits,

- de réindexer les fichiers de données si nécessaire,

- de faire des sauvegardes de la base.


**Le Centre de Contrôle HFSQL est un outil redistribuable qui peut être installé chez les clients possédant des bases de données HFSQL Client/Serveur. Le Centre de Contrôle HFSQL doit être utilisé par la personne administrant la base de données.**

| [Leçon précédente](../TutoWD/1410087541.md) | [Sommaire](../TutoWD/1410087560.md) | [Leçon suivante](../TutoWD/1410087543.md) |
| --- | --- | --- |




