


## Proveedor de bases de datos OLE para HFSQL
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000376"></a>
El proveedor OLE DB para HFSQL se utiliza para acceder a una base de datos HFSQL (Clásica o Cliente/Servidor) desde un software externo que soporte el acceso vía OLE DB.

El proveedor está disponible en modo de lectura/escritura. Una aplicación escrita en un lenguaje externo puede leer y escribir en archivos de datos HFSQL.

Consulte una documentación específica sobre OLE DB para obtener más detalles.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Instalación
<a name="instalacion_ELTTEXTE000406"></a>
El proveedor OLE DB para HFSQL se suministra como paquete instalación disponible en el directorio "Install\\OLEDB" de WINDEV y WEBDEV.

En Default, el proveedor OLE DB se instala en la carpeta "C:\\Archivos de programa\\Archivos comunes\\PC SOFT\\28.0\\OLEDB".

**Observación**: Para que una aplicación pueda utilizar un proveedor OLE DB, debe instalarse la versión 2.8 o posterior de MDAC Component (Microsoft Data Access Component). Esta Component puede descargarse del sitio de Microsoft. Está incluido en el sistema operativo de Windows 2003 Server y Windows Vista.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Configuración
<a name="configuracion_ELTTEXTE000430"></a>
La aplicación que utiliza un proveedor OLEDB debe proporcionar una cadena de conexión. Esta cadena define el proveedor a utilizar así como los parámetros de conexión que deben darse a este proveedor para establecer la conexión a la base de datos.

Esta cadena (llamada cadena de conexión) puede ser:

- introducido en la programación (en una aplicación en C# o VB.Net por ejemplo).

- construido a través de una asistente (con Crystal Reporte por ejemplo).




El formato de la cadena de conexión es el siguiente:

```txt
<Element1>=<Value1>;<Element2>=<Value2>;...;<ElementN>=<ValueN>
```


Los elementos de la cadena de conexión son los siguientes:

| aspecto | Valor al conectarse a una base de datos HFSQL Client/Server | Valor al conectarse a una base de datos HFSQL Classic |
| --- | --- | --- |
| Proveedor | Este elemento es siempre set a "PCSOFT.HFSQL" |
| Fuente de datos | Nombre (o IP Address) del servidor HFSQL y puerto de conexión.<br>El puerto no puede especificarse si el servidor utiliza el puerto Default (4900).<br>El nombre y el número de puerto deben ir separados por ":" (dos puntos).<br><br>Ejemplo: myserver.mycompany.fr:4910 | ruta completa del análisis de la base de datos (archivo .WDD).<br>Este parámetro es opcional. |
| Catálogo inicial | Nombre de la base de datos. | ruta completa del directorio que contiene los ficheros de datos. |
| identificación de usuario | Nombre de usuario para conectarse al servidor HFSQL. | Este parámetro no se tiene en cuenta. |
| Contraseña | Contraseña para conectarse al servidor HFSQL. | Contraseña del análisis de la base de datos (archivo .WDD).<br>Este parámetro es opcional. |
| Propiedades extendidas | Cadena de caracteres que contiene las propiedades específicas del proveedor OLE DB para HFSQL.<br>Esta cadena tiene el siguiente formato:<br><br><pre><code><Property1>=<Value1>;<Property2>=<Value2>;...;<PropertyN>=<ValueN></code></pre><br><br>El \\(barra invertida), = (signo igual), ; (punto y coma) o: (dos puntos) utilizados en esta cadena deben ir precedidos de \\(barra invertida). |



Las propiedades disponibles para el elemento "Propiedades ampliadas" de la cadena de conexión OLE DB son las siguientes:


|   |   |
| --- | --- |
| **Property** | **Valor** |
| Contraseña | Contraseña de los archivos de datos HFSQL en el siguiente formato:<br><br><pre><code><FileName>:<Password></code></pre><br>**Observaciones**:<br><br>-  representa el nombre lógico del archivo de datos.<br><br>-  puede sustituirse por "\*" (estrella) para especificar que la contraseña se aplica a todos los ficheros de datos.<br><br>- Este Property puede repetirse para especificar las contraseñas de varios archivos de datos.<br>	Ejemplo: Password=MiArchivo1:Contraseña1;Password=MiArchivo2:Contraseña2<br><br><br> |
| Idioma | Lenguaje usado por el proveedor de la OLE DB para HFSQL a Process la cadena (sort, ...).<br>Los valores corresponden a las constantes de [ChangeCharset](../WDLang1/3054001.md).<br><br><br>Los valores disponibles son:<br><br>\ Valor de la propiedad \ Constante WLanguage correspondiente \<br>\ --- \ --- \<br>\ UTF-8 \ *charsetUTF8* \<br>\ ISO-8859-1 or ISO-LATIN-1 \ *charsetOccidental* \<br>\ ISO-8859-2 or ISO-LATIN-2 \ *charsetEastEurope* \<br>\ ISO-8859-3 \ *charsetTurkish* \<br>\ ISO-8859-4 \ *charsetBaltic* \<br>\ ISO-8859-5 or KOI8-R \ *charsetRussian* \<br>\ ISO-8859-6 \ *charsetArabic* \<br>\ ISO-8859-7 \ *charsetGreek* \<br>\ ISO-8859-8 \ *charsetHebrew* \<br>\ ISO-2022-JP \ *charsetJapanese* \<br>\ GB-2312 \ *charsetChinese* \<br>\ VISCII \ *charsetVietnamese* \<br>\ GRANDE5 \ *charsetTraditionalChinese* \<br>\ ISO-2022-KR \ *charsetKorean* \<br>\ ISO-8859-11 \ *charsetThai* \<br><br> |
| Compresión | Los valores de Property son los siguientes:<br><br><br><br>\   \   \<br>\ --- \ --- \<br>\ True \ Los datos enviados están comprimidos. \<br>\ ninguno \ Los datos enviados no están comprimidos. \<br><br><br>Ejemplo:<br><br><pre><code>Compression=true;</code></pre><br> |
| Cifrado | Los valores de Property son los siguientes:<br><br><br><br>\   \   \<br>\ --- \ --- \<br>\ ninguno \ No se realiza ninguna encriptación. \<br>\ rc5_16 \ La conexión entre el servidor y los ordenadores cliente se cifra mediante un algoritmo de cifrado RC5 optimizado de 16 rondas (128 bits). \<br>\ aes128 \ La conexión entre el servidor y los ordenadores cliente se cifra mediante un algoritmo de cifrado AES de 128 bits con el modo de funcionamiento OFB. \<br>\ aes192 \ La conexión entre el servidor y los ordenadores cliente se cifra mediante un algoritmo de cifrado AES de 192 bits con el modo de funcionamiento OFB. \<br>\ aes256 \ La conexión entre el servidor y los ordenadores cliente se cifra mediante un algoritmo de cifrado AES de 256 bits con el modo de funcionamiento OFB. \<br>\ rápido \ La conexión entre el servidor y los ordenadores cliente se encripta mediante un algoritmo de cifrado optimizado de 128 bits. \<br><br><br>Ejemplo:<br><br><pre><code>Encryption=fast;</code></pre><br> |

<a name="NOTE3_2"></a>


### Utilización del análisis en una conexión con una base de datos HFSQL Classic
<a name="utilizacion_del_analisis_una_conexion_con_una_base_datos_hfsql_classic_ELTPARAGRAPHE000270"></a>

Para una conexión con una base de datos HFSQL Classic:

- Si se especifica la ruta del fichero WDD en el parámetro "Fuente de datos" de la cadena de conexión:

	- Sólo los archivos descritos en este análisis serán tenidos en cuenta por la conexión.

	- Los enlaces y las reglas de integridad descritas en el análisis se tienen en cuenta automáticamente.




- Si no se especifica la ruta del fichero WDD en el parámetro "Fuente de datos" de la cadena de conexión:

	- Se tendrán en cuenta todos los archivos que se encuentren en el directorio especificado en el parámetro "Catálogo inicial".

	- No se respeta automáticamente ninguna restricción de integridad entre los archivos.






<a name="NOTE3_3"></a>


### Observaciones
<a name="observaciones_ELTPARAGRAPHE000286"></a>

- Durante un acceso del proveedor OLE DB para HFSQL, las ventanas de asistencia de automatic de HFSQL están desactivadas.

- El proveedor OLE DB devuelve los elementos de "Duración" que se encuentran en los archivos de datos HFSQL como enteros de 8 bytes.. La unidad es el milisegundo.

- Los elementos de array no son soportados por el proveedor OLE DB.

- Se soportan las consultas con parámetros. Esto le permite agregar memos HFSQL (memo binario por ejemplo). 



<a name="NOTE3_4"></a>


### Ejemplos de cadenas de conexión OLE DB
<a name="ejemplos_cadenas_conexion_ole_ELTPARAGRAPHE000303"></a>

- Conexión a una base de datos HFSQL Classic sin especificar el análisis:
	
	```txt
	Provider=PCSOFT.HFSQL;Initial Catalog=c:\My HFSQL Database
	```


- Conexión a una base de datos HFSQL Classic que especifica el análisis:
	
	```txt
	Provider=PCSOFT.HFSQL;Data Source=c:\My HFSQL Database\MyAnalysis.wdd;
		Initial Catalog=c:\My HFSQL Database
	```


- Conexión a una base de datos HFSQL Client/Server:
	
	```txt
	Provider=PCSOFT.HFSQL;Data Source=serverdb.mycompany.fr:4910;
			User ID=admin;Password=secret;Initial Catalog=MyDatabase
	```


- Conexión a una base de datos HFQL Cliente/Servidor con archivos protegidos por contraseña que utilizan el carácter ruso set:
	
	```txt
	Provider=PCSOFT.HFSQL;Data Source=serverdb.mycompany.fr;
		User ID=user;Initial Catalog=MyRussianDatabase;
		Extended Properties="Password=*:secret1;
		Password=Fichier2:secret2;Language=KOI8-R"
	```

	**Observación**: En este ejemplo, todos los ficheros de la base de datos están protected por la contraseña "secret1" excepto "Fichero2", cuya contraseña es "secret2".



<a name="NOTE3_5"></a>


### Jerarquía de los datos 
<a name="jerarquia_los_datos_ELTPARAGRAPHE000323"></a>

La ubicación especificada en la cadena de conexión por **Catálogo inicial** puede contener archivos de datos ubicados en subcarpetas. Estos ficheros de datos son declarados automáticamente por el proveedor OLE DB para HFSQL, sustituyendo el "\\" de la ruta por el carácter "_"..
Por ejemplo, para el archivo "\\Archive\\Product.fic", se puede consultar utilizando "Archive_Product" como nombre de archivo de datos.

