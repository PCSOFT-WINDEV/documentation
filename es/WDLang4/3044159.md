


## HCreateView (Función)




	<B><B>Advertencia</B></B>

	A partir de la versión <B><B>20</B></B>, las vistas SQL y las vistas materializadas están disponibles.
Las vistas manipuladas por esta función corresponden al anterior mecanismo de vistas. No corresponden ni a las vistas SQL ni a las vistas materializadas. 

<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Crea una vista HFSQL.

**Observación**: Para combinar varias vistas, utilice la función [HMergeView](../WDLang4/3044124.md).

**Recordatorio**: Una vista HFSQL corresponde a una "imagen" de un archivo de datos. Una vista se almacena en la memoria, por lo tanto, las modificaciones realizadas en el archivo de datos asociado no la afectan. Una vez creada, se puede manipular como un archivo de datos HFSQL.

<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000003044159&name=hcreateview_funcion&product=WD">Ver ejemplos adicionales</a>

```wl
// Create a view
MyView is Data Source
HCreateView(MyView, CUSTOMER, "*", "NAME,CITY", "NAME]='A'", hViewDefault)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Crear una vista en un archivo de datos (archivo de datos descrito en el análisis o creado mediante programación)

`<Result> = HCreateView(<View to create> , <Data file> [, <Items> [, <Sort items> [, <Selection condition>]]] [, <Creation mode> [, <Page size>]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se creó la vista,

- <u><u><u><u>False</u></u></u></u> si se produce un problema. La función [HError](../WDLang4/3044088.md) permite identificar el error.




**`<View to create>: (Fuente de datos (o cadena de caracteres))`**

Vista a crear. Una variable de tipo Data Source permite optimizar el tiempo de acceso a los elementos (también conocidos como campos) de la vista.

**`<Data file>: (Cadena de caracteres)`**

Nombre del archivo de datos utilizado. Este archivo de datos puede corresponder a un archivo de datos descrito en el análisis o mediante programación (con la función [HDescribeFile](../WDLang4/3044206.md)). También se puede usar una variable de tipo [origen de los datos](../WDLang4/1514053.md).

**`<Items>: (Cadena de caracteres opcional)`**

Lista de elementos en la vista. En esta lista, los elementos están separados por comas o retornos de carro (CR). 
Si no se especifica este parámetro o corresponde a el valor "\*", todos los elementos del archivo de datos se incluirán en la vista.

**`<Sort items>: (Cadena de caracteres opcional)`**

Lista de elementos definidos como criterio de ordenación de la vista. En esta lista, los elementos definidos como criterio de ordenación están separados por comas o retornos de carro (CR). El orden se aplica según la posición de los elementos en la lista.. 
Se puede especificar la dirección de orden para cada elemento: 

- el signo "+" delante del nombre del elemento indica una dirección de orden ascendente. 

- el signo "-" delante del nombre del elemento indica una dirección de orden descendente. 




Si este parámetro no se especifica o es una cadena vacía (""), no se define ninguna clasificación en la vista.
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Solo se debe definir un campo como criterio de ordenación en el parámetro &lt;Criterio de ordenación&gt;.

**`<Selection condition>: (Cadena de caracteres opcional)`**

Condición de selección de registros. Todos los elementos del archivo de datos se pueden incluir en la condición (elementos clave o no clave). 
Si no se especifica este parámetro o corresponde a una cadena vacía, no se aplica ninguna condición de selección. Esta condición de selección puede ser una cadena de caracteres Ansi o Unicode.

**`<Creation mode>: (Constante opcional o combinación de constantes de tipo Integer)`**

Configura el modo de creación de la vista.


|   |   |
| --- | --- |
| *hViewAdd* | Almacena el contenido de la vista la próxima vez que se llame a [HExecuteView](../WDLang4/3044079.md). |
| *hViewBreakable* | Interrumpir la creación de la vista pulsando la tecla ESC.<br>![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) Esta constante no está disponible. |
| *hViewDefault* | Modo de creación de vista predeterminado |
| *hViewDistinct* | La vista se crea y se eliminan los duplicados según la clave de orden (en este caso, los elementos definidos como criterio de ordenación **tienen que especificarse**).<br>Si se especifican varios elementos, los duplicados se eliminan según la composición de los elementos de clasificación especificados.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Si se especifica la constante *hViewDistinct*, no es necesario especificar un campo como criterio de ordenación en el parámetro &lt;Criterio de ordenación&gt;. En este caso, se ignora la constante *hViewDistinct*. |
| *hViewExclusive* | Bloquear todo el archivo fuente para reducir el tiempo de creación de la vista. |
| *hViewLocking* | Los registros leídos en el archivo de datos e incluidos en la vista se bloquean.<br> |
| *hViewPostponed* | La vista se crea, pero se ejecuta más tarde con la función [HExecuteView](../WDLang4/3044079.md). Los datos de la vista serán los datos disponibles al ejecutar la vista. |



**`<Page size>: (Entero opcional)`**

Número de registros por página (para una vista utilizada por acceso remoto).
![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) Este parámetro no se tiene en cuenta.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Condición de selección
<a name="condicion_seleccion_ELTPARAGRAPHE000186"></a>

La sintaxis general de una condición tiene el siguiente formato:

"NomCli&gt;'Duarte' y CódigoPos=34 o CódigoPos=32"

Los operadores soportados dependen del tipo de los elementos utilizados en la condición:


|   |   |   |
| --- | --- | --- |
| &lt;&gt; | No es igual a | Válido para todos los tipos |
| &gt; | Mayor que | Válido para todos los tipos |
| &gt;= | Mayor que o igual a | Válido para todos los tipos |
| &lt; | Menor que | Válido para todos los tipos |
| &lt;= | Menor que o igual a | Válido para todos los tipos |
| = | Estrictamente igual a | Válido para todos los tipos |
| ~= | Casi igual a: ignora espacios a la derecha, acentos, y mayúsculas y minúsculas | Válido solo para cadenas |
| ~~ | Igualdad muy flexible: no distingue entre minúsculas y mayúsculas, ignora los espacios antes y después de la cadena, acentos en minúsculas, espacios y puntuación dentro de las cadenas. | Válido solo para cadenas |
| ] | Contiene: distingue mayúsculas y minúsculas | Válido solo para cadenas |
| ~] | Contiene: no distingue entre mayúsculas y minúsculas | Válido solo para cadenas |
| ]= | Comienza por: distingue mayúsculas y minúsculas | Válido solo para cadenas |


**RMarcas sobre la condición de selección:**

- Las cuerdas constantes deben estar encerradas en comillas simples.

- El nombre del elemento solo debe contener letras, dígitos y guiones bajos ("_"). Si el nombre del elemento contiene otros caracteres (comillas, etc.), debe ir entre comillas dobles. 
	Por ejemplo: "correo_ecectrónico@"]'com'

- Las comparaciones entre cadenas se realizan según el valor ASCII de los caracteres y no según el valor lexicográfico ('a' &gt; 'Z').

- Los memos binarios y las claves compuestas no pueden formar parte de una condición de selección.

- Si una &lt;*constante de cadena&gt;* contiene una comilla simple (o doble), esta debe ir precedida de una barra invertida (\\). 

- Para optimizar la navegación de la vista, utilice la función [HStatCalculate](../WDLang4/3044134.md) en el archivo de datos antes de crear la vista. De hecho, el motor HFSQL analiza la condición de selección y utiliza estas estadísticas para definir los elementos más discriminantes que se utilizarán para optimizar las operaciones de navegación realizadas en los archivos de datos.

- Esta condición de selección puede ser una cadena de caracteres Ansi o Unicode.



<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) 

### Crear una vista en un archivo de datos con filtro
<a name="crear_una_vista_archivo_datos_con_filtro_ELTPARAGRAPHE000292"></a>

**HCreateView** tiene en cuenta el filtro set en el archivo de datos de origen.

Esta característica es soportada por las vistas creadas a partir de archivos de datos HFSQL Classic o Client/Server, Hyper File 5.5 y archivos de datos xBase.
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 

### Versiones anteriores
<a name="versiones_anteriores_ELTPARAGRAPHE000305"></a>

Esta función sustituye a **HCreateView_55**, que se mantiene por compatibilidad con WINDEV 5.5.

<a name="XComponent"></a>

## Componente:
wd280hf.dll
