


## &lt;Fuente&gt;.Write (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Escribe un Record en un archivo de datos sin actualizar los índices correspondientes a todas las claves utilizadas en el archivo de datos. Los memos se añaden si es necesario (si la gestión de memos está activada, [&lt;Fuente&gt;.SetMemo](../WDLang4/1000024987.md)).

Después de la llamada a **&lt;Fuente&gt;.Write**:

- no se comprueba la integridad ni los errores de duplicación.

- si se produce un problema de bloqueo (intentar modificar un registro bloqueado), la función [HErrorLock](../WDLang4/3044099.md) devuelve <u><u><u>True</u></u></u> y el registro no se modifica.

- se modifica el número del actual Record: el actual Record corresponde al Record escrito.




**Observaciones**:

- Para actualizar los índices durante una operación de escritura, utilice [&lt;Fuente&gt;.Add](../WDLang4/1000024187.md) o [&lt;Fuente&gt;.Modify](../WDLang4/1000025038.md). 
	![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) La función **&lt;Fuente&gt;.Write** es equivalente a la función [&lt;Fuente&gt;.Modify](../WDLang4/1000025038.md). Los índices de la base de datos se actualizan.

- Si se modifica el valor de una clave con la función **&lt;Fuente&gt;.Write**, el índice se desincronizará. Hay que reindexar ([&lt;Fuente&gt;.Index](../WDLang4/1000025060.md)).

- Esta función se puede utilizar para escribir un registro en una selección realizada por una consulta (consulta ejecutada con la constante *hWithFilter*).





<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Write a record at the end of a data file
Customer.Write(HNbRec() + 1)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = <Source>.Write([<Record number> [, <Options>]])`
---

**`<Result>: (Booleano)`**



- <u><u><u><u>True</u></u></u></u> si la escritura se realizó en el archivo de datos ,

- <u><u><u><u>False</u></u></u></u> si se produce un error (bloqueo, etc.): el Record no se modifica. La función [HError](../WDLang4/3044088.md) permite identificar el error.




**`<Source>: (Tipo de fuente especificada)`**

Nombre del archivo de datos utilizado. 

**`<Record number>: (Entero opcional)`**

Número de la Record a escribir. El Record cargado en la memoria se reescribe en el Record especificado. 
Si este número es mayor que el número total de registros en el archivo de datos, se crearán registros intermedios borrados para que la lectura secuencial del archivo de datos ([&lt;Fuente&gt;.Read](../WDLang4/1000025019.md)) sea coherente. 
Si no se especifica este parámetro (igual a 0 o a la constante *hCurrentRecNum* ), **&lt;Fuente&gt;.Write** modifica el actual Record en el archivo de datos.
![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) La función **&lt;Fuente&gt;.Write** solo modifica el registro actual. No puede especificar un número Record que no sea el actual (para especificar el número Record actual, utilice la constante *hRecNumCurrent* ).

**`<Options>: (Combinación de constantes opcionales)`**

Configura:

- **el modo para calcular el identificador automatic**: Para más detalles sobre los identificadores automatic para los nuevos registros, véase [Gestión del identificador automático al agregar un registro](../WDLang4/3044183.md).
	


|   |   |
| --- | --- |
| *hForceIdAuto* | El identificador de automatic no se calcula durante la operación de escritura: El valor del identificador es el que se almacena durante la operación de escritura. |
| *hRecalculateIdAuto* | El identificador automático del Record será recalculado durante la operación de escritura. Esta constante tiene prioridad sobre las constantes *hForceIdAuto* y *hSetIdAuto*. |
| *hSetIdAuto* | El identificador de automatic no se calcula durante la operación de escritura: El valor del identificador es el que se almacena durante la operación de escritura.. <br>El siguiente valor del identificador calculado por el motor HFSQL corresponderá al valor más grande del identificador en el archivo +1. |
| *hWriteDefault*<br>(Valor predeterminado) | **Si el Record escrito no es un Record eliminado** , el identificador automático (si existe) del Record en el archivo de datos se reutiliza. <br>**Si el Record escrito es un Record eliminado** , se calcula un nuevo identificador automático para el Record.<br>La constante *hWriteDefault* se ignora si se especifica con una de las otras constantes. |


	Si se utilizan las tres constantes al mismo tiempo (*hForceIdAuto*, *hSetIdAuto* y *hRecalculateIdAuto*) se produce un error WLanguage.

- **el modo de bloqueo aplicado al Record .**
	Si no se especifica una constante de bloqueo, la Record no está bloqueada.
	


|   |   |
| --- | --- |
| *hLockNo* <br>(Valor predeterminado) | Sin bloqeuo: el escrito Record no está bloqueado. |
| *hLockReadWrite* | Bloqueo de lectura y escritura: la Record escrita será bloqueada en lectura/escritura. Este registro no puede ser leído ni modificado por otras aplicaciones. Solo la aplicación actual puede modificarlo, leerlo o desbloquearlo. |
| *hLockWrite* | Bloqueo de escritura: el Record escrito se bloqueará en modo de escritura. Otras aplicaciones pueden leer el registro pero no modificarlo. Solo la aplicación en curso podrá modificarlo o desbloquearlo. |





![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Las opciones de bloqueo no tendrán efecto si el proveedor de OLE DB o Conector Nativo (también llamado Native Access) no admite bloqueos.
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png)  es ignorada.


<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Gestión de los identificadores de automatic
<a name="gestion_los_identificadores_automatic_ELTPARAGRAPHE000391"></a>

Por defecto, el elemento "identificador automático" se actualiza automáticamente cuando se añade una Record en un archivo de datos.

Las constantes *hForceIdAuto* y *hSetIdAuto* permiten modificar el comportamiento predeterminado del identificador automático.

Para más detalles sobre los identificadores automatic para los nuevos registros, véase [Manejo del identificador automatic](../WDLang4/3044183.md).


![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) **Casos especiales**

- Si la base de datos genera un identificador automatic, el motor HFSQL mantiene este valor. Si se especifica la constante *hForceIDAuto* o *hSetIDAuto* , el motor HFSQL reemplaza el valor generado por el valor deseado.
	**Observación**: la constante *hForceIdAuto* equivale a *hSetIdAuto*: el identificador automatic calculado por el motor HFSQL durante la próxima adición será único en el archivo de datos.

- Si la base de datos no genera ningún identificador de automatic, el motor HFSQL genera el valor y lo asigna al identificador automatic.



<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Lenguaje Externo](https://doc.pcsoft.fr/ext/images/us/LE.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) 

### Escribir registros borrados o cruzados
<a name="escribir_registros_borrados_cruzados_ELTPARAGRAPHE000420"></a>

Si el número Record corresponde a un Record cruzado o a un Record borrado, este Record se vuelve a activar.
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Lenguaje Externo](https://doc.pcsoft.fr/ext/images/us/LE.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) 

### La versión del archivo de datos después de una operación de escritura
<a name="version_del_archivo_datos_despues_una_operacion_escritura_ELTPARAGRAPHE000432"></a>

Si el Record fue escrito (sin problemas de bloqueo, etc.), el número de versión de el archivo de datos es modificado. Para get el número de versión, utilice [&lt;Fuente&gt;.Version](../WDLang4/1000025082.md).
<a name="NOTE0_4"></a>


### Gestión de memos binarios
<a name="gestion_memos_binarios_ELTPARAGRAPHE000447"></a>

Cuando se modifica una Record, se modifican los memos si es necesario (si la gestión de los memos está habilitada por [&lt;Fuente&gt;.SetMemo](../WDLang4/1000024987.md)). 
**Recordatorio**: para inicializar un elemento de memoria binario, utilice [&lt;Fuente&gt;.LinkMemo](../WDLang4/1000024194.md).
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Lenguaje Externo](https://doc.pcsoft.fr/ext/images/us/LE.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) 

### Si utiliza &lt;Fuente&gt;.Write con una base de datos Hyper File 5.5
<a name="utiliza_docparampagetitleshort_con_una_base_datos_hyper_file_55_ELTPARAGRAPHE000471"></a>

Los elementos TEXT se rellenan automáticamente con caracteres de espacio.
<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Navegando y escribiendo un Record
<a name="navegando_escribiendo_record_ELTPARAGRAPHE000485"></a>

Si la operación de escritura se realiza durante una búsqueda, el Record escrito será Visible en la búsqueda actual solamente. Si se han definido otras operaciones de navegación en esta base de datos, el Record escrito sólo será Visible una vez que estas operaciones de navegación se hayan reiniciado.

<a name="XComponent"></a>

## Componente:
wd280hf.dll
