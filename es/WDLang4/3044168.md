


## HChangeDir (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>


- Modifica el acceso de ruta a un archivo de datos (que significa el directorio donde se utilizará el archivo de datos). Si el archivo de datos está abierto al utilizar **HChangeDir**, este se cierra automáticamente.
	**Recordatorio**: Por Default, el archivo físico correspondiente a el archivo de datos descrito en el análisis se maneja en el directorio especificado en el análisis.

- Cambia el nombre de la base de datos associated por un tabla. En este caso, el nombre de la base de datos especificado en las propiedades de conexión de tabla (en el editor de análisis) se ignora.
	Para modificar los parámetros de conexión de un archivo de datos que no estén en formato HFSQL, le recomendamos que utilice [HDescribeConnection](../WDLang4/3044205.md) y [HChangeConnection](../WDLang4/3044150.md).


![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta función sólo funciona para conexiones a una base de datos HFSQL.


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) 
```wl
// Create the HFSQL Classic Stat data file in
// "C:\Statistics\January"
HChangeDir(Stat, "C:\Statistics\January")
HCreation(Stat)
```
<a name="Example2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) 
```wl
// Create the HFSQL Client/Server Stat data file in "\January\"
// This directory is at the root 
// of database folder (HFSQL Client/Server connection)
HChangeDir(Stat, ".\January\")
```
<a name="Example3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 
```wl
// Data file associated with a connection by OLE DB. 
// Replace the database that will be used for the "Customers" table
HChangeDir(Customers, "C:\Temp\MyTestDB.mdb")
HCreation(Customers)
// The "Customers" table was created in the "c:\temp\mytestdb.mdb" database
// The "Customers" table of database ("c:\temp\myinitialdb.mdb") was not modified
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Uso con archivos de datos HFSQL

`<Result> = HChangeDir(<Data file> , <New data file path>)`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se realizó la operación,

- <u><u><u><u>False</u></u></u></u> si se produce un problema. La función [HError](../WDLang4/3044088.md) permite identificar el error.




**`<Data file>: (Cadena de caracteres)`**

Nombre lógico del archivo de datos HFSQL (definido en el análisis). 
Si este parámetro es igual a "\*", el cambio de directorio se aplicará a todos los archivos de datos conocidos (descritos en el análisis).. 
Este parámetro también puede corresponder al nombre de un [grupo de archivos (o Carpeta Personal) definido en el análisis](../Editeurs/2011003.md) (no disponible en Android y Android Widget).

**`<New data file path>: (Cadena de caracteres)`**

Nuevo acceso de ruta a el archivo de datos (hasta 260 caracteres). Esta ruta puede contener el nombre de la unidad y los directorios, o puede ser una ruta relativa..
Si la ruta es una ruta relativa, el carácter "." (o "?") se utiliza para especificar el directorio actual y el carácter "..." se utiliza para especificar el directorio principal. 
Si este parámetro corresponde a una cadena vacía (""), el archivo de datos se manejará en el directorio especificado en el análisis.

![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) El acceso de ruta a el archivo de datos debe ser relativo a la base de datos encontrada en el servidor. No se puede especificar un ruta fuera de la base de datos. Un error de WLanguage ocurre cuando se intenta acceder a archivos de datos fuera de la base de datos.. Por ejemplo: 
Válido ruta: 

```wl
HChangeDir(FileName, "SUBDIR")

or 

HChangeDir(FileName, ".\SUBDIR")
```

No válida ruta: 

```wl
HChangeDir(FileName, "C:\DB\SUBDIR")
```

La nueva ruta se creará automáticamente si es válida y si no existe.. 


<a name="SYNTAX2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 
### Uso con un acceso OLE DB o un Conector Nativo (también llamado Acceso Nativo)

`<Result> = HChangeDir(<Data file> , <New database>)`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se realizó la operación,

- <u><u><u><u>False</u></u></u></u> si se produce un problema. La función [HError](../WDLang4/3044088.md) permite identificar el error.




**`<Data file>: (Cadena de caracteres)`**

Nombre lógico de tabla (definido en el análisis). 
Si este parámetro es igual a "\*", se ignora la función **HChangeDir**. 
**Atención**: Si este parámetro es igual a "\*" y uno de los archivos de datos del análisis se asoció a una conexión (función [HChangeConnection](../WDLang4/3044150.md)) antes de llamar a la función **HChangeDir**, la modificación del directorio de este archivo de datos se tendrá en cuenta solo al cerrar la conexión.

**`<New database>: (Cadena de caracteres)`**

Acceso a ruta a la base de datos a utilizar (hasta 260 caracteres). En este caso, se ignora el nombre de la base de datos especificado en las propiedades de conexión de tabla en el análisis..
Esta ruta puede contener el nombre de la unidad y los directorios, o puede ser una ruta relativa..
Si la ruta es una ruta relativa, el carácter "." (o "?") se utiliza para especificar el directorio actual y el carácter "..." se utiliza para especificar el directorio principal.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Múltiples cambios de directorio
<a name="multiples_cambios_directorio_ELTPARAGRAPHE000230"></a>

Se puede llamar a la función **HChangeDir** varias veces con parámetros diferentes. Cuando el ruta se redefine varias veces para el mismo archivo de datos, el último ruta especificado reemplaza a todos los demás.
<a name="NOTE0_2"></a>


### Cambiar el nombre del archivo de datos
<a name="cambiar_nombre_del_archivo_datos_ELTPARAGRAPHE000241"></a>

La función **HChangeDir** solo permite cambiar la ruta de acceso al archivo de datos físico. Para cambiar el nombre físico del archivo de datos, utilice [HChangeName](../WDLang4/3044141.md).
<a name="NOTE0_3"></a>


### Sustitución de directorios
<a name="sustitucion_directorios_ELTPARAGRAPHE000255"></a>

La función **HChangeDir** permite asociar un directorio a un archivo de datos. Para sustituir un directorio por otro, utilice [HSubstDir](../WDLang4/3044028.md).

**Atención**: La sustitución del directorio realizada por [HSubstDir](../WDLang4/3044028.md) se aplica al directorio definido por **HChangeDir**. Por ejemplo:


```wl
HSubstDir("C:\Statistics\January", "C:\New\JanStats")
HChangeDir(Stat, "C:\Statistics\January") 
HCreation(Stat) // Data file created in C:\New\JanStats
```

<a name="NOTE0_4"></a>


### Varios
<a name="varios_ELTPARAGRAPHE000297"></a>

- Si se utiliza el archivo ".REP" ([HSetREP](../WDLang4/3044061.md)), el nuevo ruta se guarda en el archivo ".REP" (véase [gestión de archivos .REP](../WDLang4/3044186.md)). 

- Al cerrar el archivo de datos se almacena el nuevo ruta pero no se almacena una posible contraseña especificada al abrir el archivo de datos.

- **HChangeDir** es equivalente a **HAssign**, disponible en versiones anteriores.

- Esta función se puede utilizar al establecer una conexión con un servidor HFSQL.  **Atención**: El orden en el que se llama a las funciones para conectarse a una base de datos HFSQL Client/Server es importante. Para obtener más información, consulte [Optimizar el tiempo de conexión a las bases de datos HFSQL Client/Server](../WDLang4/9000176.md).

- ![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) **HChangeDir** puede utilizarse con el conector XML nativo.








<a name="XComponent"></a>

## Componente:
wd280hf.dll
