


## Conector xBase/FoxPro nativo
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000277"></a>
WINDEV y WEBDEV proponen un módulo Native xBase/FoxPro Connector (o Native xBase/FoxPro Access). Este Conector Nativo le permite crear archivos de datos manipular xBase/FoxPro desde un programa WLanguage sin utilizar ningún controlador externo.

**Configuración necesaria**: Los siguientes archivos se proporcionan con WINDEV y WEBDEV: wd28 0db.dll. Este archivo es requerido por el Conector Nativo en los archivos xBase/FoxPro para poder operar con un análisis HFSQL Classic.


<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Uso del conector xBase/FoxPro nativo
<a name="uso_del_conector_xbasefoxpro_nativo_ELTTEXTE000307"></a>
Para usar el conector Native xBase/FoxPro en sus aplicaciones WINDEV o WEBDEV: 

1. Importar (si es necesario) la description de los archivos de datos xBase/FoxPro en el análisis WINDEV o WEBDEV.

2. Programa con las funciones HFSQL de WLanguage.  




La gestión de los ficheros de datos xBase/FoxPro es similar a la gestión de los ficheros de datos HFSQL excepto en los casos explicados en esta ayuda Page.

**Observación**: No se olvide de leer el documento [limitaciones con respecto al uso del conector Native xBase/FoxPro](../WDLang4/3044249.md).

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Importación de la estructura de los ficheros de datos
<a name="importacion_estructura_los_ficheros_datos_ELTTEXTE000331"></a>


### Los pasos de importación
<a name="los_pasos_importacion_ELTPARAGRAPHE000040"></a>

1. En la editor de análisis, inicie la importación de la asistente: en la pestaña "Análisis", en el grupo "Creación", amplíe "Importar" y seleccione "Importar archivo/descripciones tabla...".

2. Seleccione el tipo de base de datos: FoxPro/xBase. Se establece automáticamente una conexión con la base de datos xBase/FoxPro y associated con los archivos de datos importados en el análisis. Esta conexión tendrá que ser utilizada para manipular el archivo de datos xBase/FoxPro a través de la programación.

3. Especifique si los datos deben mantenerse en el formato actual (opción necesaria para utilizar el conector Native xBase/FoxPro).

4. Seleccione el modo de acceso a los ficheros de datos (Native xBase Access for WINDEV) y especifique el directorio de los ficheros de datos.

5. Seleccione las tablas que se importarán en el análisis WINDEV. Estas tablas pueden manejarse mediante programación con las funciones HFSQL de WINDEV. Estas tablas se mostrarán en azul en la pantalla de editor de análisis.
	Observación: las bases de datos FoxPro (.dbc extension) no son compatibles. Cada archivo de datos (extensión .dbf) debe ser importado individualmente en el análisis.  

6. Validar. Las tablas se importan en el análisis. En la description de los archivos de datos, se encuentra el subtipo xBase del archivo de datos importado (dBase3+, dBase4, FoxPro/FoxBase, Clipper5, Clipper87).




**Observaciones**:

- Un ítem definido como Numérico en FoxPro puede ser importado como moneda en WINDEV y WEBDEV (si el tamaño del ítem excede el tamaño de un real por ejemplo).

- Los elementos lógicos en xBase/FoxPro se importan como elementos de texto. De hecho, para un booleano en xBase, tiene la posibilidad de especificar True y False con las cadenas 'T' y 'F'.



<a name="NOTE3_2"></a>


### Teniendo en cuenta los cambios de los archivos de datos xBase/FoxPro
<a name="teniendo_cuenta_los_cambios_los_archivos_datos_xbasefoxpro_ELTPARAGRAPHE000071"></a>

Para tener en cuenta las evoluciones de las tablas importadas en el editor de análisis, vaya a la pestaña "Análisis", al grupo "Análisis", amplíe "Sincronización " y seleccione "Actualizar análisis a partir de bases de datos externas".

Una asistente comienza, permitiéndole:

- analizar las diferencias para las tablas importadas,

- analizar las diferencias para todas las tablas xBase/FoxPro.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Los puntos importantes de la programación
<a name="los_puntos_importantes_programacion_ELTTEXTE000361"></a>


### Nuevas funcionalidades para la gestión de los archivos de datos xBase/FoxPro
<a name="nuevas_funcionalidades_para_gestion_los_archivos_datos_xbasefoxpro_ELTPARAGRAPHE000097"></a>

La gestión de los ficheros de datos xBase/FoxPro es similar a la gestión de los ficheros de datos HFSQL excepto en los casos explicados en esta ayuda Page.

**Nuevas funcionalidades para la gestión de archivos de datos xBase desde WINDEV 5.5**:

- Manejando un identificador de automatic.

- Capacidad para utilizar [HIndex](../WDLang4/3044133.md).

- Gestión de expresiones en [HFilter](../WDLang4/3044100.md).

- Capacidad para utilizar [HChangeDir](../WDLang4/3044168.md).

- Uso del acceso nativo a xBase con conjuntos de caracteres no latinos.




**Gestión de archivos de datos FoxPro**:

- Soporte de memos en formato VFP.

- Se soportan todos los formatos de índice (incluyendo los índices en formato VFP correspondientes a la extensión.CDX). Los índices son leídos y modificados.

- Manejando un identificador de automatic.

- Gestión de expresiones en [HFilter](../WDLang4/3044100.md).

- Capacidad para utilizar [HChangeDir](../WDLang4/3044168.md).

- Limitación: ningún archivo FoxPro puede ser reindexado.

- Limitación: no se puede crear ningún archivo FoxPro.



<a name="NOTE4_2"></a>


### description dinámica de un archivo de datos xBase
<a name="description_dinamica_archivo_datos_xbase_ELTPARAGRAPHE000137"></a>

Un archivo de datos xBase puede describirse mediante programación con las siguientes funciones:


|   |   |
| --- | --- |
| [HDBCreation](../WDLang4/3044171.md) | Termina la dinámica estructura de description del archivo de datos. El archivo de datos que se acaba de describir se crea en el disco en el ruta especificado en [HDBDescribeFile](../WDLang4/3044172.md). Los archivos de datos, notas e índices se crean en el disco. |
| [HDBDescribeField](../WDLang4/3044170.md) | Describe dinámicamente cada elemento de la estructura de un archivo de datos xBase descrito por [HDBDescribeFile](../WDLang4/3044172.md). |
| [HDBDescribeFile](../WDLang4/3044172.md) | Describe dinámicamente a un archivo de datos en formato dBase 3 (el formato más común). Esta función se utiliza para especificar el nombre, la abreviatura y el acceso ruta del archivo de datos xBase. |
| [HDBDescribeIndex](../WDLang4/3044166.md) | Describe dinámicamente los diferentes archivos de índice que se crearán.. Se debe describir un archivo de índice para cada clave de búsqueda. El archivo índice creado estará en formato dBase 3. |

Ejemplo:


```wl
// Describe an xBase data file with the following items:
// LASTNAME, string of 20 characters
// FIRSTNAME, string of 20 characters
// AGE, integer on 3 digits
// BALANCE, real on 10 digits and 2 decimals
// MARRIED, boolean
// DOB, date
// INFO, text memo

HDBDescribeFile("DBCUSTOMER", "CD", "C:\FILE\CUSTOMER.DBF")
HDBDescribeField("LASTNAME,C,20")
HDBDescribeField("FIRSTNAME,C,20")
HDBDescribeField("AGE,N,3,0")
HDBDescribeField("BALANCE,N,10,2")
HDBDescribeField("MARRIED,L")
HDBDescribeField("DOB,D")
HDBDescribeField("INFO,M")
HDBCreation()
```
**Observación**: los archivos de datos del FoxPro no pueden ser descritos dinámicamente. Sólo se admite el formato dBase 3.
<a name="NOTE4_3"></a>


### Abrir archivos de datos descritos dinámicamente
<a name="abrir_archivos_datos_descritos_dinamicamente_ELTPARAGRAPHE000176"></a>

Un archivo de datos xBase no se abre automáticamente: este archivo de datos debe ser abierto por [HDBOpen](../WDLang4/3044163.md) antes de ser utilizado por primera vez, excepto si fue creado por [HDBCreation](../WDLang4/3044171.md) (que crea y abre el archivo de datos).
<a name="NOTE4_4"></a>


### Índices de apertura que se describieron dinámicamente
<a name="indices_apertura_que_describieron_dinamicamente_ELTPARAGRAPHE000189"></a>

[HDBOpen](../WDLang4/3044163.md) abre el archivo de datos pero no los archivos de índice. Por lo tanto, debe abrir todos los archivos de índice necesarios para utilizar el archivo de datos con [HDBIndex](../WDLang4/3044165.md).

Si los archivos índice no se abren, no se actualizarán después de una eliminación, modificación o adición.
<a name="NOTE4_5"></a>


### Enlaces entre los archivos de datos de xBase o FoxPro
<a name="enlaces_entre_los_archivos_datos_xbase_foxpro_ELTPARAGRAPHE000203"></a>

Los enlaces no son administrados automáticamente por WINDEV y WEBDEV. Deben gestionarse a través de la programación. Por lo tanto, para acceder a una Record en el archivo de datos relacionado, hay que buscar la Record correspondiente según la clave de enlace ([HReadSeek](../WDLang4/3044050.md)).

Ejemplo: Una ventana muestra los pedidos de un cliente, el archivo de datos "PEDIDOS" contiene el número de producto, el archivo de datos "PRODUCTO" contiene la leyenda del producto y el número de producto. Por ejemplo, la inicialización Process de la ventana es:


```wl
// Read the orders
HReadFirst(ORDERS, Ord_Date)
IF HOut() = False THEN
	// Find the corresponding product
	HReadSeek(PRODUCT, ProNum, ORDERS.ProNum)
	FileToScreen()
END
```

<a name="NOTE4_6"></a>


### Uso del conector xBase/FoxPro nativo con juegos de caracteres no latinos
<a name="uso_del_conector_xbasefoxpro_nativo_con_juegos_caracteres_latinos_ELTPARAGRAPHE000217"></a>

Para utilizar el conector xBase nativo con juegos de caracteres no latinos, Conector Nativo debe realizar una conversión estándar OEM/ANSI.. Para ello, se debe especificar el siguiente string en la información ampliada: 

```txt
OEMTOANSI=WINDOWS;
```


**Ejemplo**:

1. En el código de inicialización del proyecto, añada el código utilizado para modificar el carácter set:
	
	```wl
	ChangeCharset(charsetChinese)
	```


2. Cree una conexión xBase:
	
	```wl
	HDescribeConnection("CntxBase", "", "", fExeDir(), "", hNativeAccessxBase, ...
			hOReadWrite, "OEMTOANSI=WINDOWS;")
	HChangeConnection("*", "CntxBase")
	```






