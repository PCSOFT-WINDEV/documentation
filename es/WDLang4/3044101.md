


## HLast (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Establece la posición en el último registro de un archivo de datos de acuerdo con un elemento de navegación. **TEl Record no se lee**.
El número de la Record actual se modifica sólo cuando es devuelto por [HRecNum](../WDLang4/3044063.md). Para las funciones que manipular el número actual de Record ([HDelete](../WDLang4/3044018.md), [HRead](../WDLang4/3044047.md), [HModify](../WDLang4/3044042.md), etc.), el valor de este número no se actualiza: se debe utilizar la función [HRecNum](../WDLang4/3044063.md)(). Por ejemplo: no hacer: 

```wl
HDelete(Customer)
```
 pero 

```wl
HDelete(Customer, HRecNum())
```
 Los valores de la posición de búsqueda se leen en orden ascendente (ver Observaciones para más detalles).

**Atención**: ***El registro cargado en memoria no se modifica***. Las variables HFSQL (por ejemplo, Cliente.Nombre, es decir el elemento *Nombre* del archivo *Cliente*) no se actualizan.

En la mayoría de los casos, **HLast** establece la posición en el archivo de datos para recorrer los registros que coinciden con una condición. [HNext](../WDLang4/3044027.md) se utiliza para posicionarse en el siguiente Record correspondiente a la condición.

Después de llamar a la función **HLast**, se pueden producir los siguientes casos:

- se encontró un registro que corresponde a la condición: [HFound](../WDLang4/3044104.md) devuelve <u><u><u>True</u></u></u>

- el archivo de datos está vacía o no hay Record correspondiente a la condición: [HOut](../WDLang4/3044094.md) devuelve <u><u><u>True</u></u></u>




**Observaciones**: 

- Mediante Default, [HSeekFirst](../WDLang4/3044125.md) y [HSeekLast](../WDLang4/3044129.md) se realiza una búsqueda de coincidencia exacta.

- Mediante Default, **HLast** se realiza una búsqueda genérica.





Se lee el valor más alto de la posición de búsqueda (para más detalles, véase [observaciones](#NOTE0_1)).

**Atención**: El Record cargado en la memoria no se modifica. Las variables HFSQL (por ejemplo, Nombre.del.cliente, o el elemento *Name* del archivo de datos *Customer*) no se actualizan.

En la mayoría de los casos, **HLast** se utiliza para fijar la posición en el archivo de datos con el fin de realizar un bucle de lectura con [HPrevious](../WDLang4/3044112.md).

Tras la llamada a **HLast**pueden darse varios casos:

- el archivo de datos está vacía o ningún record corresponde al filtro (definido por [HFilter](../WDLang4/3044100.md)): [HOut](../WDLang4/3044094.md) devuelve <u><u><u>True</u></u></u>.

- la función intenta bloquear un registro ya bloqueado en modo de lectura: [HErrorLock](../WDLang4/3044099.md) devuelve <u><u><u>True</u></u></u> y [HOut](../WDLang4/3044094.md) devuelve <u><u><u>True</u></u></u>.
	![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: La gestión de las cerraduras no está disponible para las bases de datos a las que accede el JDBC.
	





<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Browse a data file from the last record
HLast(Customer, Name)
WHILE NOT HOut()
	// Process the record
	HPrevious(Customer, Name)
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = HLast([<Data file>] [, <Search key item> [, <Options>]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si el puesto era set,

- <u><u><u><u>False</u></u></u></u> si se produce un error. Este problema puede ser causado por:

	- un problema de posicionamiento (archivo de datos vacío, ...): [HFound](../WDLang4/3044104.md) devuelve <u><u><u><u>False</u></u></u></u> y [HError](../WDLang4/3044088.md) devuelve 0.

	- un error: [HError](../WDLang4/3044088.md) devuelve un número entero distinto de 0. [HErrorInfo](../WDLang4/3044071.md) devuelve más detalles.







**`<Data file>: (Cadena de caracteres opcional)`**

Nombre del archivo de datos utilizado. Si este parámetro es una cadena vacía (""), **HLast** manipula el último archivo de datos utilizado por la última función HFSQL (función que empieza por "H").

**`<Search key item>: (Cadena de caracteres opcional)`**

Nombre del elemento clave utilizado para el bucle de el archivo de datos. Si no se especifica este nombre, **HLast** utilizará el último elemento de exploración utilizado en este archivo de datos por la última función de gestión HFSQL (función que comienza por "H"). Si este elemento no existe, se utiliza automáticamente el mejor elemento de navegación.

**`<Options>: (Constante opcional)`**

Configura el bloqueo establecido en el Record seleccionado por **HLast**:


|   |   |
| --- | --- |
| *hKeepFilter* | El filtro set de [HFilter](../WDLang4/3044100.md) se tendrá en cuenta, aunque la clave de búsqueda no esté optimizada para el filtro. Recordatorio: la función [HFilter](../WDLang4/3044100.md) devuelve la clave de búsqueda optimizada para el filtro. <br>**Atención**: en este caso, pueden surgir problemas de rendimiento en archivos de datos demasiado grandes.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Esta constante no se puede utilizar. |
| *hLockNo* | Sin bloqeuo: otras aplicaciones pueden leer o modificar el registro. |
| *hLockReadWrite* | Bloqueo de lectura/escritura: el Record seleccionado no puede ser leído o modificado por otra aplicación. |
| *hLockWrite* | Bloqueo de escritura: el Record seleccionado puede ser leído por otra aplicación pero no puede ser modificado por otra aplicación.<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hNoRefresh* | ![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) El contenido de tabla o de la consulta no se actualizará. Todas las posiciones guardadas se almacenan. <br> Si no se especifica este parámetro, la función **HLast** reinicializa la navegación para el elemento especificado: el contenido de tabla o consulta se actualiza con los datos encontrados en la base de datos OLE DB. Todas las posiciones guardadas se pierden. La posición se restablecerá de acuerdo con el valor del mejor elemento.<br>  Observación: La navegación y las posiciones guardadas en los otros elementos no se ven afectadas. |


![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Las opciones de bloqueo no tendrán efecto si los bloqueos no son soportados por el proveedor OLE DB o por Conector Nativo.![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Las opciones de bloqueo se ignoran. Utilice las funciones de bloqueo ([HLockRecNum](../WDLang4/3044152.md)) conservadas para la compatibilidad con el pasado.![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: La gestión de las cerraduras no está disponible para las bases de datos a las que accede el JDBC.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Lectura de la operación según una clave
<a name="lectura_operacion_segun_una_clave_ELTPARAGRAPHE000243"></a>

**HLast** establece la posición en el record con el mayor valor de la clave.

El orden de clasificación es el que se especificó en el análisis para esta clave.

Si se encuentran duplicados, **HLast** fija la posición en el primer "duplicado" Record según la secuencia de números Record.
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) 

### Comprobación de la contraseña
<a name="comprobacion_contrasena_ELTPARAGRAPHE000262"></a>

Si la función **HLast** es la primera función que manipula el archivo de datos especificado, la contraseña se verifica al abrir el archivo de datos.

Si la contraseña es incorrecta, [HErrorPassword](../WDLang4/3044082.md) devuelve <u><u><u><u>True</u></u></u></u> y [HOut](../WDLang4/3044094.md) devuelve <u><u><u><u>True</u></u></u></u>.
<a name="NOTE0_3"></a>


### Varios
<a name="varios_ELTPARAGRAPHE000289"></a>

- El número actual de Record es devuelto por [HRecNum](../WDLang4/3044063.md).

- [HChangeKey](../WDLang4/3044151.md) se utiliza para modificar la clave de búsqueda mientras se mantiene posicionada en el record actual.



<a name="NOTE0_4"></a>


### Comparación de [HReadLast](../WDLang4/3044140.md) y HLast
<a name="comparacion_hreadlastwdlang43044140md_docparampagetitleshort_ELTPARAGRAPHE000304"></a>

**HLast** no lee el record: por lo tanto, **HLast** es más rápido que [HReadLast](../WDLang4/3044140.md).
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Bloqueos
<a name="bloqueos_ELTPARAGRAPHE000326"></a>

Por defecto (&lt;Opciones&gt; no especificadas), la Record no está bloqueada.

Si se solicita un bloqueo (constante *hLockWrite* o *hLockReadWrite*), la posición se fijará en el Record sólo si no está ya bloqueado.

<a name="XComponent"></a>

## Componente:
wd280hf.dll
