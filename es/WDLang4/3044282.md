


## HCopyFile (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Copia un archivo de datos HFSQL (archivos .fic, .ndx, .ftx y .mmo si existen):

- desde el servidor HFSQL al servidor (para realizar una copia de seguridad, por ejemplo).

- desde el servidor HFSQL al cliente (para realizar una copia de seguridad local, por ejemplo).

- del cliente al servidor HFSQL (para actualizar los archivos de datos, por ejemplo).

- de un servidor HFSQL a otro servidor HFSQL. 





<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000021620&name=hcopyfile_funcion&product=WD">Ver ejemplos adicionales</a>
<a name="Example1"></a>

```wl
// Copy the data files from server to server
// while renaming and changing directory
HCopyFile(MyConnection, ".\backup\customerfile_bck.fic", MyConnection, ".\customerfile.fic")
```
<a name="Example2"></a>

```wl
// Copy the data files from the server to the client computer
HCopyFile("", "C:\Data\Customer.fic", MyConnection, "customer.fic")
```
<a name="Example3"></a>

```wl
// Copy the data files from the client computer to the server
HCopyFile(MyConnection, "customer.fic", "", "C:\Data\Customer.fic")
```
<a name="Example4"></a>

```wl
// Copies the data file(s) from a server to another server
HCopyFile("CNT", "customer.fic", "CNT2", "dir\customer.fic", hNoIndex, PROGBAR_MyProgressBar)
```
<a name="Example5"></a>

```wl
// Copy the CUSTOMER data file to itself (save)
sMyDestinationDirectory is string = CompleteDir(fExeDir()) + "TestDirectory"
IF NOT fDirectoryExist(sMyDestinationDirectory) THEN fMakeDir(sMyDestinationDirectory)
HCopyFile("", sMyDestinationDirectory + "CUSTOMER.FIC", "", ...
		CompleteDir(fExeDir()) + "CUSTOMER.FIC", hCopyIndex)
```
<a name="Example6"></a>

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = HCopyFile(<Destination connection> , <Destination data file> , <Source connection> , <Source data file> [, <Copy mode> [, <Progress Bar control> [, <Password>]]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se copió el archivo de datos,

- <u><u><u><u>False</u></u></u></u> si se produce un error. La función [HError](../WDLang4/3044088.md) permite identificar el error.




**`<Destination connection>: (Cadena de caracteres o variable de tipo Connection)`**

Conexión a la que debe copiarse el archivo de datos. Esta conexión corresponde a:

- el nombre de la conexión definida en el editor de análisis o con las funciones [HDescribeConnection](../WDLang4/3044205.md) o [HOpenConnection](../WDLang4/3044107.md).

- el nombre de una variable de tipo [Conexión](../WDLang4/1514073.md).


Si este parámetro corresponde a una cadena vacía, el destino será el ordenador local. 

**`<Destination data file>: (Cadena de caracteres)`**

Nombre y ruta del archivo de datos de destino. El ruta y este archivo de datos se crean automáticamente si no existen en el servidor. 
Si el archivo de datos de destino se encuentra en el servidor, el ruta es relativo a la base de datos.
Atención: la extensión del archivo '.fic' debe ser especificada. 

**`<Source connection>: (Cadena de caracteres o variable de tipo Connection)`**

Conexión de la que debe copiarse el archivo de datos. Esta conexión corresponde a: 

- el nombre de la conexión definida en el editor de análisis o con las funciones [HDescribeConnection](../WDLang4/3044205.md) o [HOpenConnection](../WDLang4/3044107.md).

- el nombre de una variable de tipo [Conexión](../WDLang4/1514073.md).




**`<Source data file>: (Cadena de caracteres)`**

Nombre y ruta del archivo de datos de la fuente (a copy). Si el archivo de datos de la fuente se encuentra en el servidor, el ruta es relativo a la base de datos.
Atención: 

- se debe especificar la extensión del archivo '.fic'.

- el archivo '.mmo', si lo hay, se copiará automáticamente. 




**`<Copy mode>: (Constante opcional de tipo Integer)`**

Modo copy utilizado:



|   |   |
| --- | --- |
| *hCopyIfNotFound* | Copia a el archivo de datos sólo si no existe en el lugar especificado en el ordenador de destino. |
| *hCopyIndex* | Se copian los índices de los archivos (archivo NDX y archivo FTX si existe). |
| *hCreateIndex* | Los índices de archivos no se copian (archivo NDX y archivo FTX si existe). Se recrean automáticamente en el destino mediante una operación de reindexación.. <br>Si el archivo de datos está protegida por una contraseña, debe especificarse el parámetro &lt;Contraseña&gt;. |
| *hNoIndex* | Los índices de archivo no se copian (archivo NDX y archivo FTX si existe). |



**`<Progress Bar control>: (Nombre de control opcional)`**

El nombre de control Barra de progreso que se encuentra en la ventana, se usa para mostrar el progreso de copy.

**`<Password>: (Cadena de caracteres opcional)`**

Contraseña del archivo (si existe). Esta contraseña es necesaria si se utiliza la constante *hCreateIndex*.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Modo de funcionamiento de HCopyFile
<a name="modo_funcionamiento_docparampagetitleshort_ELTPARAGRAPHE000216"></a>

- El archivo de datos copiado está desbloqueado, así como los registros encontrados en el archivo de datos.

- El índice no se copia si no existe o si está dañado.

- La contraseña no es necesaria para copy el archivo de datos. Sin embargo, el archivo de datos copiado sigue protegido por contraseña.

- No es posible copy archivos de datos a un servidor de origen de un servidor de replicación SPARE. 

- Fichero de datos en la operación: antes de copiar a el archivo de datos, le aconsejamos que lo haga:

	- bloquear el archivo de datos en lectura/escritura ([HLockFile](../WDLang4/3044153.md)).

	- Cancel las transacciones interrumpidas ([HTransactionCancel](../WDLang4/3044001.md)).






<a name="NOTE0_2"></a>


### Condiciones de uso
<a name="condiciones_uso_ELTPARAGRAPHE000239"></a>

- También puede copy un archivo de datos desde el ordenador del cliente al mismo ordenador del cliente. En este caso, esta función equivale a [fCopyFile](../WDLang1/3036004.md).

- Esta función se utiliza para enviar archivos copy a un servidor HFSQL (en modo Cliente/Servidor). Esta función no se puede utilizar con un servidor externo (Oracle u otro).

- Para copy un archivo de datos HFSQL de un ordenador local al servidor, todos los usuarios deben haber liberado dicho archivo de antemano. No debe haber ninguna conexión con el archivo de datos en curso, o el copy fallará. Para evitar cualquier nueva conexión con el archivo de datos, puede: 

	- Bloquear el acceso a la base de datos ([HNoDatabaseAccess](../WDLang4/3044286.md)),

	- Desconectar clientes ([HDisconnectClient](../WDLang4/3044339.md)),

	- copy los archivos ([HCopyFile](../WDLang4/3044282.md)),

	- Restaurar el acceso a la base de datos ([HEndNoDatabaseAccess](../WDLang4/3044287.md)). 




- Caso de archivos de datos replicados (replicación entre servidores): Para un archivo de datos replicado, **HCopyFile** no debe utilizarse para copiar un archivo de datos en el servidor: el copy no es posible. Sin embargo, un archivo de datos puede ser copiado del servidor al ordenador cliente. 



<a name="NOTE0_3"></a>


### Nombres de archivos y directorios de datos en el servidor
<a name="nombres_archivos_directorios_datos_servidor_ELTPARAGRAPHE000273"></a>

- El nombre de los archivos de datos (archivos.fic,.ndx,.ftx y.mmo si existen) en el servidor no debe contener caracteres acentuados.

- En un servidor LINUX, el nombre de los archivos de datos debe escribirse en minúsculas.




<a name="XComponent"></a>

## Componente:
wd280hf.dll
