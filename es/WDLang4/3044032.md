


## HTransactionEnd (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Valida la transacción actual:

- se validan las modificaciones realizadas en el archivo de datos desde el inicio de la transacción ([HTransactionStart](../WDLang4/3044002.md) o [HTransaction](../WDLang4/1000023384.md)).

- se borra el fichero de transacción (si esta transacción es la última transacción en curso para una aplicación de red).

- se desbloquean los registros bloqueados en sólo lectura por la transacción.





<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
MyConnection1 is Connection

// Start transaction on data files associated with MyConnection1
HTransactionStart(MyConnection1)

// Code used to prepare the order to added
// ...

WHEN EXCEPTION IN
	// Add the order
	HAdd(Orders) 
	// Validate the addition
	HTransactionEnd(MyConnection1)
DO
	// Delete the order lines
	HTransactionCancel(MyConnection1)
END
```
<a name="Example2"></a>

```wl
// Start transaction on the Orders and OrdLine data files
HTransactionStart("C:\Temp\Transaction.trs", "Orders,OrdLine,-Customer")

// Code used to prepare the order to added
// ...

WHEN EXCEPTION IN
	// Add the order
	HAdd(Orders) 
	// Validate the addition
	HTransactionEnd() 
DO
	// Delete the order lines
	HTransactionCancel() 
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Validar una transacción en curso en una conexión

`<Result> = HTransactionEnd(<Connection>)`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True STRIMEULB</u></u></u></u> si la transacción ha finalizado,

- <u><u><u><u>False</u></u></u></u> si se produce un problema. [HErrorInfo](../WDLang4/3044071.md) devuelve más detalles sobre el error. 




**Atención**: La función no tiene ningún efecto si se inicia una operación global.. Se debe utilizar la sintaxis 2.

**`<Connection>: (Cadena de caracteres o variable de tipo Connection)`**

Conexión a utilizar. Esta conexión corresponde a: 

- el nombre de la conexión definida en el editor de análisis o con las funciones [HDescribeConnection](../WDLang4/3044205.md) o [HOpenConnection](../WDLang4/3044107.md).

- el nombre de una variable de tipo [Conexión](../WDLang4/1514073.md).


Si este parámetro corresponde a la constante *hAccessHF7*, la transacción se realizará en archivos HFSQL ISAM.  


<a name="SYNTAX2"></a>

### Validar una transacción global en curso

`<Result> = HTransactionEnd()`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True STRIMEULB</u></u></u></u> si la transacción ha finalizado,

- <u><u><u><u>False</u></u></u></u> si se produce un problema. [HErrorInfo](../WDLang4/3044071.md) devuelve más detalles sobre el error.  






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Casos de error
<a name="casos_error_ELTPARAGRAPHE000144"></a>

- Operaciones de anidamiento: Las transacciones no se pueden anidar (es decir, no se puede llamar a [HTransactionStart](../WDLang4/3044002.md) o [HTransaction](../WDLang4/1000023384.md) en una transacción). En este caso, se produce el error 70031.

- Se muestra un error fatal en los siguientes casos: 

	- Se inicia una transacción en todas las conexiones mientras haya al menos una conexión en la transacción.. 

	- Se inicia una operación en una conexión mientras que ya se ha iniciado una operación en todas las conexiones.. 

	- Se inicia una transacción en todas las conexiones mientras haya al menos una conexión cuyo modo de aislamiento no sea "Lectura no comprometida".






<a name="NOTE0_2"></a>


### Manipular registros durante una transacción
<a name="manipular_registros_durante_una_transaccion_ELTPARAGRAPHE000166"></a>

Durante una transacción, se deben cumplir algunas reglas al manipular registros. Para obtener más información, consulte [Transacciones: Manipular registros durante una transacción](../WDLang4/3044336.md).
<a name="NOTE0_3"></a>


### Transacciones y contexto HFSQL independiente
<a name="transacciones_contexto_hfsql_independiente_ELTPARAGRAPHE000178"></a>

Al copiar un contexto, si una transacción está en curso en el primer contexto, el nuevo contexto no está en la transacción.. Debe llamar a [HTransactionStart](../WDLang4/3044002.md) (o [HTransaction](../WDLang4/1000023384.md)) para iniciar una transacción en el nuevo contexto.
<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### OLE DB y Conectores Nativos
<a name="ole_conectores_nativos_ELTPARAGRAPHE000189"></a>

Sólo se tienen en cuenta las sintaxis con conexión en la Conectores Nativos (también llamada accesos nativos) que soportan las transacciones. También se puede utilizar la función [SQLTransaction](../WDLang4/3072029.md).

<a name="XComponent"></a>

## Componente:
wd280hf.dll
