


## HInfoServerRights (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Permite conocer los permisos otorgados a un usuario o grupo de usuarios sobre un servidor. El servidor utilizado se definió en la conexión.


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000003044322&name=hinfoserverrights_funcion&product=WD">Ver ejemplos adicionales</a>

```wl
ARight is string
// Retrieves the rights to create the database granted to 
// the usernamed Smith on the server of the CNT connection
ARight = HInfoServerRights("CNT", "Smith", hRightsCreateDB)
SWITCH ARight
	CASE hAllowed
	...
	CASE hForbidden
	... 
	CASE hInherit
	... 
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = HInfoServerRights(<Connection> , <User/Group> , <Rights> [, <Display mode>])`
---

**`<Result>: (Cadena de caracteres)`**



- Información solicitada,

- Cadena vacía ("") si se produce un error, 

- "Usuario desconocido" o "Grupo desconocido" si el usuario actual no tiene permisos para ver a otros usuarios (constante hRightsSeeUser) y desea obtener información sobre otro usuario o grupo.




**En modo hDefault**, &lt;Resultado&gt; es una lista de valores separados por tabulaciones. Cada valor de la lista corresponde al permiso solicitado por el parámetro &lt;Permisos&gt;. Los valores de la lista pueden corresponder a una de las siguientes constantes:


|   |   |
| --- | --- |
| *hAllowed* | El usuario o grupo tiene el permiso correspondiente. |
| *hForbidden* | El usuario o grupo no tiene el permiso correspondiente. |
| *hInherit* | El usuario pertenece al menos a un grupo al que se le otorgó el permiso correspondiente.<br>Esta constante se devuelve solo si el modo de visualización no es *hEffective*. |


**En modo hDetails**, &lt;Resultado&gt; es una lista de valores con el siguiente formato:

```txt
<Relevant rights 1> + TAB + <Value of rights 1> + CR + ... 
<Relevant rights N> + TAB + <Value of rights N> + CR
```

Los permisos corresponden a las constantes utilizadas en el parámetro &lt;Permisos&gt; y los valores de los permisos corresponden a las constantes *hAllowed*, *hForbidden* o *hInherited* (ver cuadro anterior).

**`<Connection>: (Cadena de caracteres o variable de tipo Connection)`**

Conexión para la que deben conocerse los permisos de un usuario o grupo de usuarios. Esta conexión corresponde a: 

- el nombre de la conexión definida en el editor de análisis o con las funciones [HDescribeConnection](../WDLang4/3044205.md) o [HOpenConnection](../WDLang4/3044107.md).

- el nombre de una variable de tipo [Conexión](../WDLang4/1514073.md).




**`<User/Group>: (Cadena de caracteres)`**

Nombre del usuario o grupo cuyos permisos deben conocerse.

**`<Rights>: (Constante o combinación de constantes de tipo Integer)`**

Lista de permisos a buscar:


|   |   |
| --- | --- |
| *hRightsAll* | Lista de todos los permisos.<br>Se recomienda usar esta constante en modo de visualización *hDetails* o *hEffective* + *hDetails*. |
| *hRightsBackup* | Derechos para realizar una copia de seguridad. No se puede utilizar la constante *hRightsAll* con **HInfoServerRights** para get esta información. Utilice *hRightsAll* con [HInfoDatabaseRights](../WDLang4/3044320.md). |
| *hRightsChangePassword* | Derechos para cambiar la contraseña de un usuario en el servidor (el usuario puede cambiar su propia contraseña y el administrador puede cambiar la contraseña de cada usuario). |
| *hRightsChangeRights* | Permiso para cambiar los permisos. |
| *hRightsCreateDB* | Permiso para crear una base de datos. |
| *hRightsDisconnectClient* | Permiso para desconectar equipos cliente. |
| *hRightsManageServer* | Derechos de uso de [HSetServer](../WDLang4/3044359.md). |
| *hRightsManageTask* | Derechos para gestionar las tareas programadas. |
| *hRightsManageUser* | Permiso para eliminar o agregar usuarios o grupos. |
| *hRightsPriority* | Derechos para modificar la prioridad de la aplicación actual ([HPriority](../WDLang4/3044352.md)) o la prioridad de otra aplicación cliente ([HPriorityClient](../WDLang4/3044353.md)). |
| *hRightsReadLogStat* | Permiso para ver las estadísticas de actividad y los registros del servidor. |
| *hRightsSeeUser* | Derechos para ver los diferentes usuarios y grupos. |
| *hRightsSendMessageToClient* | Permiso para enviar mensajes a los equipos cliente. |
| *hRightsServerReplication* | Permiso para definir y realizar una replicación entre dos servidores HFSQL. |
| *hRightsStopServer* | Derechos para detener un servidor ([HStopServer](../WDLang4/3044317.md)). |



**`<Display mode>: (Constante opcional de tipo Integer)`**

Modo de visualización del resultado:


|   |   |
| --- | --- |
| *hDefault*<br>(Valor predeterminado) | El permiso devuelto no tiene en cuenta los permisos heredados (es decir, los permisos otorgados a los grupos a los que pertenece el usuario).<br>Si no se definió el permiso, el valor será *hInherit*.<br>&lt;Resultado&gt; solo contiene los valores de los permisos solicitados (en el mismo orden). |
| *hDetails* | Igual a *hDefault*.<br>&lt;Resultado&gt; contiene el permiso y su valor. |
| *hEffective* | Los derechos devueltos corresponden a los derechos efectivamente concedidos al usuario o al grupo en el servidor.. Los permisos heredados se tienen en cuenta (es decir, los permisos otorgados a los grupos a los que pertenece el usuario). |
| *hEffective + hDetails* | Igual a *hEffective*. <br>&lt;Resultado&gt; contiene el permiso y su valor. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones
Para modificar los derechos concedidos a un usuario o a un grupo en un servidor, utilice [HModifyServerRights](../WDLang4/3044328.md).

<a name="XComponent"></a>

## Componente:
wd280hf.dll
