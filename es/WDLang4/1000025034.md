


## &lt;Fuente&gt;.ReadSeekFirst (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Posiciones en la primera Record de un archivo de datos cuyo valor para un artículo específico es estrictamente igual al valor buscado (búsqueda de coincidencia exacta). Se lee la Record y se actualizan las variables HFSQL correspondientes.

En la mayoría de los casos, **&lt;Fuente&gt;.ReadSeekFirst** establece la posición en el archivo de datos para recorrer los registros que coinciden con una condición. [&lt;Fuente&gt;.ReadNext](../WDLang4/1000025035.md) se utiliza para leer el siguiente Record correspondiente a la condición.

Después de llamar a la función **&lt;Fuente&gt;.ReadSeekFirst**, se pueden producir los siguientes casos:

- ***a Record correspondiente a la condición se encontró***, bloqueado (si es necesario) y cargado en la memoria: [&lt;Fuente&gt;.Found](../WDLang4/1000025076.md) devuelve <u><u><u>True</u></u></u>.

- si no existe ningún registro que corresponda a la condición, pero ***existe un registro de mayor valor***: se lee el registro, la función [&lt;Fuente&gt;.Out](../WDLang4/1000024605.md) devuelve <u><u><u>False</u></u></u> y la función [&lt;Fuente&gt;.Found](../WDLang4/1000025076.md) devuelve <u><u><u>False</u></u></u>.

- ***el archivo de datos está vacío***: no se realiza ninguna operación de lectura, [&lt;Fuente&gt;.Out](../WDLang4/1000024605.md) devuelve <u><u><u>True</u></u></u> y [&lt;Fuente&gt;.Found](../WDLang4/1000025076.md) devuelve <u><u><u>False</u></u></u>.

- la función intenta bloquear un registro ya bloqueado en modo de lectura: no se realiza ninguna operación de lectura, [HErrorLock](../WDLang4/3044099.md) devuelve <u><u><u>True</u></u></u> y [&lt;Fuente&gt;.Out](../WDLang4/1000024605.md) devuelve <u><u><u>True</u></u></u>.
	Observación: Por defecto, se realiza una [gestión automática de errores de bloqueo y de conflictos de modificación](../WDLang4/3044188.md) (excepto en el código de procedimientos almacenados). La gestión automática de errores se puede personalizar o desactivar en cualquier momento con la función [&lt;Fuente&gt;.OnError](../WDLang4/1000025073.md). 




La función **&lt;Fuente&gt;.ReadSeekFirst** puede utilizarse con archivos de datos, vistas HFSQL o consultas.

**Observación**: la búsqueda puede ser cancelada por [&lt;Fuente&gt;.CancelSeek](../WDLang4/1000024193.md).
![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) **Caso especial**: gestión de esclusas:

- ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) **En Java**, durante un acceso por JDBC, la gestión de las cerraduras no está disponible para las bases de datos a las que accede el JDBC.





<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Find the first record for which 
// the Customer name is MOORE
Customer.ReadSeekFirst(Name, "MOORE")
IF Customer.Found() = False THEN
	Error("Customer not found")
	RETURN
ELSE
	// Continue the process on the customer named MOORE
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = <Source>.ReadSeekFirst(<Item> , <Sought value> [, <Options>])`
---

**`<Result>: (Booleano)`**



- <u><u><u><u>True</u></u></u></u> si se encontró el Record (corresponde al valor devuelto por [&lt;Fuente&gt;.Found](../WDLang4/1000025076.md)). 

- <u><u><u><u>False</u></u></u></u> si se produce un problema. Este problema puede ser causado por:

	- un problema de posicionamiento (archivo de datos vacío, etc.): la función [&lt;Fuente&gt;.Found](../WDLang4/1000025076.md) devuelve <u><u><u><u>False</u></u></u></u> y la función [HError](../WDLang4/3044088.md) devuelve 0.

	- un error: la función [HError](../WDLang4/3044088.md) devuelve un número entero distinto de 0. La función [HErrorInfo](../WDLang4/3044071.md) devuelve más detalles.







**`<Source>: (Tipo de fuente especificada)`**

Nombre del archivo de datos HFSQL, vista o consulta utilizada.

**`<Item>: (Cadena de caracteres)`**

Nombre del artículo sobre el que se realizará la búsqueda. Este elemento puede ser o no una clave de búsqueda.
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) La búsqueda sólo puede realizarse en un elemento clave.

**`<Sought value>: (Tipo de valor)`**

Valor del artículo buscado.

**`<Options>: (Constante o combinación de constantes opcional)`**

Permite configurar:

- el modo de bloqueo aplicado al buscado Record

- el tipo de búsqueda realizada.





|   |   |
| --- | --- |
| *hForwardOnly* | ![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Esta constante sólo se puede utilizar con Conectores Nativos.<br><br>Optimiza las iteraciones simples que no utilizan las siguientes características:<br><br>- Leyendo el anterior Record.<br><br>- Modificando un Record.<br><br>- Posición de almacenamiento.<br><br><br>Si se utiliza una de estas características, el resultado puede diferir del esperado.<br><br>Por ejemplo, esta constante puede utilizarse para rellenar una control Tabla de forma programada. |
| *hGeneric* | Búsqueda genérica (ver las Notas)<br>Una búsqueda de coincidencia exacta es realizada por Default (constante no especificada). |
| *hKeepFilter* | El filtro set de [&lt;Fuente&gt;.Filter](../WDLang4/1000024960.md) se tendrá en cuenta, aunque la clave de búsqueda no esté optimizada para el filtro. Recordatorio: la función [&lt;Fuente&gt;.Filter](../WDLang4/1000024960.md) devuelve la clave de búsqueda optimizada para el filtro.<br>**Atención**: en este caso, pueden surgir problemas de rendimiento en archivos de datos demasiado grandes.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Este Variable no puede ser usado. Por Default, la iteración realizada después de **&lt;Fuente&gt;.ReadSeekFirst** ignora el filtro. |
| *hLimitParsing* | La iteración se detendrá cuando se encuentre el último valor buscado o si ningún valor coincide con la búsqueda.<br>El actual Record corresponderá a este último Record encontrado.<br>[&lt;Fuente&gt;.Found](../WDLang4/1000025076.md) devolverá <u><u><u><u>False</u></u></u></u> y [&lt;Fuente&gt;.Out](../WDLang4/1000024605.md) devolverá <u><u><u><u>True</u></u></u></u>.<br>Esta constante se utiliza para optimizar la velocidad de búsqueda en el modo Cliente/Servidor y en las bases de datos externas (accesibles a través de OLE DB o a través de Conectores Nativos). |
| *hLockNo* | Sin bloqeuo: el Record puede ser leído o modificado por otra aplicación durante la lectura.<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hLockReadWrite* | Bloqueo de lectura y escritura: el Record que se lee actualmente no puede ser leído o modificado por otra aplicación.<br>El bloqueo de teclas se ignora si se utiliza una consulta.<br>![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) Bloqueo de solo escritura. Equivale a la constante *hLockWrite*.![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hLockWrite* | Bloqueo de escritura: el registro leído actualmente puede ser leído por otra aplicación, pero no se puede modificar.<br>El bloqueo de teclas se ignora si se utiliza una consulta.<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hNoRefresh* | ![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) La función **&lt;Fuente&gt;.ReadSeekFirst** no actualiza el contenido de la tabla o consulta. Si es posible, la consulta no se vuelve a ejecutar. Se guardan todas las posiciones guardadas. |

![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: La gestión de las cerraduras no está disponible para las bases de datos a las que accede el JDBC.![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Las opciones de bloqueo no tendrán efecto si los bloqueos no son soportados por el proveedor OLE DB o por Conector Nativo.![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) El modo de bloqueo especificado con la función **&lt;Fuente&gt;.ReadSeekFirst** seguirá siendo efectivo al llamar a las funciones [&lt;Fuente&gt;.ReadPrevious](../WDLang4/1000025021.md) y [&lt;Fuente&gt;.ReadNext](../WDLang4/1000025035.md).

Para cambiar el modo de bloqueo, utilice:

- **&lt;Fuente&gt;.ReadSeekFirst** o [&lt;Fuente&gt;.ReadSeekLast](../WDLang4/1000025024.md),

- [&lt;Fuente&gt;.ReadLast](../WDLang4/1000025020.md) o [&lt;Fuente&gt;.ReadFirst](../WDLang4/1000025022.md).






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Búsqueda genérica/búsqueda por coincidencia de datos de salida
<a name="busqueda_genericabusqueda_por_coincidencia_datos_salida_ELTPARAGRAPHE000581"></a>

- **Búsqueda genérica** (principalmente en las posiciones de la cadena de caracteres): ***Busca todos los registros que empiezan con el valor especificado***. 
	Por ejemplo: Cuando se realiza una búsqueda genérica en "Smith" (para el elemento NAME), todos los registros cuyo elemento Name comience con "Smith" coincidirán con la búsqueda. Por lo tanto, la Record que contiene "Smither" coincidirá con la búsqueda ([&lt;Fuente&gt;.Found](../WDLang4/1000025076.md) devuelve <u><u><u><u>True</u></u></u></u>).
	Observación: Para la compatibilidad con WINDEV 5.5, la búsqueda genérica de una cadena vacía ("") es equivalente al uso de la función [&lt;Fuente&gt;.ReadFirst](../WDLang4/1000025022.md).

- **Búsqueda exacta**: ***Busca todos los registros que coinciden exactamente con el valor especificado.***. 
	Por ejemplo: Al realizar una búsqueda exacta en la cadena "Martin" (para el elemento NOMBRE), la función [&lt;Fuente&gt;.Found](../WDLang4/1000025076.md) devuelve <u><u><u><u>True</u></u></u></u> solo para los registros cuyo elemento corresponde exactamente a "Martin".

- **Ejemplos de búsqueda en el fichero de datos de CLIENTES ordenados por nombre:**

<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=hlitrechpremier.gif)



|   |   |   |   |   |   |
| --- | --- | --- | --- | --- | --- |
| Valor buscado | Opciones | **&lt;Fuente&gt;.ReadSeekFirst** fija la posición en el Record. | **[&lt;Fuente&gt;.Found](../WDLang4/1000025076.md)** vuelve | **[&lt;Fuente&gt;.Out](../WDLang4/1000024605.md)** vuelve | Explicaciones |
| De los cuales |   | 1 | True | False | De los cuales existen.<br>El final del archivo de datos no se ha alcanzado todavía. |
| Davo |   | 1 | False | False | Davo no existe. Posición en el primer valor mayor (Davon).<br>El final del archivo de datos no se ha alcanzado todavía. |
| Moro | hGeneric | 8 | True | False | Moor no existe pero la búsqueda es genérica y se encuentra Moore (entre otros).<br>El final del archivo de datos no se ha alcanzado todavía. |
| Moro |   | No se encontró el Record (no hay movimiento, el Record actual no cambia). | False | False | El moro no existe.<br>El final del archivo de datos no se ha alcanzado todavía. |
| Norbert |   | No se encontró el Record (no hay movimiento, el Record actual no cambia). | False | True | Norbert no existe.<br>Posición en el primer valor mayor (este valor no existe): se ha llegado al final del archivo de datos. |


Para más detalles, consulte la página web de [Hyper File 5.5 y 7: ¿Cómo gestionar los caracteres de espacio en las búsquedas?](../WDLang4/3044190.md) tabla
<a name="NOTE0_2"></a>


### Búsqueda realizada sobre un elemento clave o sobre un elemento no clave
<a name="busqueda_realizada_sobre_elemento_clave_sobre_elemento_clave_ELTPARAGRAPHE000717"></a>

La búsqueda se puede realizar en un elemento clave o no clave.

Si la búsqueda se realiza en un elemento clave:

- la búsqueda es rápida y el resultado está ordenado.

- si la operación de iteración es continuada por [&lt;Fuente&gt;.ReadNext](../WDLang4/1000025035.md), los siguientes registros corresponderán a los valores mayores o iguales al valor de búsqueda. En este caso, hay que comprobar [&lt;Fuente&gt;.Out](../WDLang4/1000024605.md) después de cada operación de lectura para saber si se ha alcanzado el final del archivo de datos.




Si la búsqueda se realiza en un elemento no clave:

- el elemento seleccionado aparecerá en rojo en el editor de código y aparecerá una advertencia en el ["Panel"Errores de compilación](../Editeurs/2027031.md).
	**Observación**: La [autocompletado](../Editeurs/2013001.md) propone únicamente los puntos clave.

- si la iteración es continuada por [&lt;Fuente&gt;.ReadNext](../WDLang4/1000025035.md), los próximos registros corresponderán a los valores iguales al valor de búsqueda.



<a name="NOTE0_3"></a>


### Realizar una búsqueda en una clave compuesta
<a name="realizar_una_busqueda_una_clave_compuesta_ELTPARAGRAPHE000760"></a>

Se pueden utilizar varios métodos para realizar una búsqueda en una clave compuesta:

- Usando una lista de valores.

- Llamando a [&lt;Fuente&gt;.BuildKeyValue](../WDLang4/1000024205.md).




**1. Utilizando una lista de valores**.

La siguiente sintaxis se utiliza para realizar una búsqueda en una clave compuesta:


```txt
HReadSeekFirst(<File Name>, <Name of Composite Key>,
	[<Search value of first element of composite key>, 
		<Search value of first element of composite key>, ...])
```
Ejemplo:

```wl
// Find the record
Customer.ReadSeekFirst(LastName_FirstName, ["MOORE", "Vince"])
```

**2. Uso de la función [&lt;Fuente&gt;.BuildKeyValue](../WDLang4/1000024205.md)**

Ejemplo:

```wl
bufSoughtVal is Buffer = Customer.BuildKeyValue(LastName_FirstName, sLastName, sFirstName)
Customer.SeekFirst(LastName_FirstName, bufSoughtVal)
WHILE Customer.Found()
	Customer.Delete()
	Customer.Next(LastName_FirstName)
END
```


![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Para realizar búsquedas genéricas en una clave compuesta, todos los componentes de la clave compuesta deben ser componentes de texto. De lo contrario, se realiza una búsqueda por coincidencia exacta.
<a name="NOTE0_4"></a>


### Buscar en un artículo de array
<a name="buscar_articulo_array_ELTPARAGRAPHE000810"></a>

La búsqueda se realiza en el primer elemento array (elemento con índice 1). Para realizar una búsqueda en los otros elementos de array, utilice los filtros o consultas.
<a name="NOTE0_5"></a>


### Buscar y filtrar
<a name="buscar_filtrar_ELTPARAGRAPHE000820"></a>

Si se activa un filtro ([&lt;Fuente&gt;.Filter](../WDLang4/1000024960.md)), la búsqueda tendrá en cuenta el filtro sólo si la clave utilizada es idéntica.

Para tener en cuenta este filtro en el resto de la navegación (incluso si la clave de búsqueda no está optimizada para el filtro), utilice la constante *hKeepFilter*.
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Si se activa un filtro, la búsqueda lo ignora.
<a name="NOTE0_6"></a>


### Recorrer en bucle los registros que coinciden con una condición
<a name="recorrer_bucle_los_registros_que_coinciden_con_una_condicion_ELTPARAGRAPHE000840"></a>

En la mayoría de los casos, **&lt;Fuente&gt;.ReadSeekFirst** establece la posición en el archivo de datos para recorrer los registros que coinciden con una condición. [&lt;Fuente&gt;.ReadNext](../WDLang4/1000025035.md) y [&lt;Fuente&gt;.ReadPrevious](../WDLang4/1000025021.md) se utilizan para leer los registros coincidentes siguientes y anteriores.

Para ignorar la búsqueda mientras se va a la siguiente o anterior Record, utilice una de las siguientes funciones:

- [&lt;Fuente&gt;.CancelSeek](../WDLang4/1000024193.md)

- [&lt;Fuente&gt;.ReadLast](../WDLang4/1000025020.md)

- [&lt;Fuente&gt;.ReadFirst](../WDLang4/1000025022.md)



<a name="NOTE0_7"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Búsqueda por coincidencia exacta en Access
<a name="busqueda_por_coincidencia_exacta_access_ELTPARAGRAPHE000879"></a>

Para realizar una búsqueda de coincidencia exacta en una base de datos ACCESS, se recomienda utilizar [NoSpace](../WDLang1/3024034.md) si hay caracteres de espacio al final del valor buscado.
<a name="NOTE0_8"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Bloqueos
<a name="bloqueos_ELTPARAGRAPHE000894"></a>

Las cerraduras se aplican sólo cuando se encuentra un Record.

Por defecto (no hay modo de bloqueo especificado en &lt;Opciones&gt;), la Record no está bloqueada.

Si se solicita un bloqueo (constantes *hLockWrite* o *hLockReadWrite*), se leerá el registro solo si este aún no ha sido bloqueado.

Recordatorio: Una Record bloqueada puede ser desbloqueada por [&lt;Fuente&gt;.UnlockRecNum](../WDLang4/1000024212.md).

![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Las opciones de bloqueo no tendrán efecto si el proveedor de OLE DB o Conector Nativo (también llamado Native Access) no admite bloqueos.
<a name="NOTE0_9"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Optimización de las iteraciones
<a name="optimizacion_las_iteraciones_ELTPARAGRAPHE000921"></a>

Para optimizar las primeras iteraciones en un archivo de datos, utilice [&lt;Fuente&gt;.Optimize](../WDLang4/1000025042.md) en este archivo de datos.
<a name="NOTE0_10"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Conector Nativo XML
<a name="conector_nativo_xml_ELTPARAGRAPHE000938"></a>

El comportamiento de la función **&lt;Fuente&gt;.ReadSeekFirst** depende de las funciones [&lt;Fuente&gt;.ActivateAutoFilter](../WDLang4/1000024171.md) y [&lt;Fuente&gt;.DeactivateAutoFilter](../WDLang4/1000024219.md).

[&lt;Fuente&gt;.ActivateAutoFilter](../WDLang4/1000024171.md) está habilitada por Default.

Por lo tanto, para leer el contenido del archivo XML, lea el contenido del archivo principal (el padre) y luego lea el contenido de los archivos relacionado (los hijos).

Por Default, cuando se lee un archivo, se aplica automáticamente un filtro a los archivos de relacionado para leer sólo los registros correspondientes al archivo principal.

Por ejemplo:<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=XML_2.GIF)
 El Email de esta persona puede ser recuperado al recorrer el archivo de Personas. 

Para ello, basta con set la posición en la ficha "Persona" y aplicar **&lt;Fuente&gt;.ReadSeekFirst** a la ficha "Email".

En este caso, la Record leída en el archivo "Correo electrónico" corresponderá al primer correo electrónico asociado con la Record actual en el archivo "Persona".

Si este mecanismo está desactivado ([&lt;Fuente&gt;.DeactivateAutoFilter](../WDLang4/1000024219.md)), el Record leído en el fichero "Email" corresponderá al primer Record encontrado en el fichero Email (y no al hijo del Record leído en el fichero "Persona").

<a name="XComponent"></a>

## Componente:
wd280hf.dll
