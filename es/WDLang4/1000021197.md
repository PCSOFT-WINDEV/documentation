


## HImportXLS (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Importa un archivo XLS o XLSX en un archivo de datos en formato HFSQL Classic o Client/Server (archivo de datos descrito en el editor de análisis, o declarado por las funciones [HDeclare](../WDLang4/3044203.md), [HDeclareExternal](../WDLang4/3044204.md) o [HDescribeFile](../WDLang4/3044206.md)).


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Import "C:\MyFiles\Customer.xls" into the Customer data file. 
// The Customer data file will be overwritten if it already exists (hImpCreation constant)
// A progress bar will be displayed in PROGBAR_ProgBar1
HImportXLS(Customer, "C:\MyFiles\Customer.xls", 1, "", hImpCreation, PROGBAR_ProgBar1)
```

<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX1"></a>

`<Result> = HImportXLS(<Data file> , <Path of the XLS or XLSX file> [, <Worksheet number> [, <List of destination items> [, <Options> [, <Progress Bar>]]]])`
---

**`<Result>: (Booleano)`**



- <u><u><u><u>True</u></u></u></u> si se realizó la operación,

- <u><u><u><u>False</u></u></u></u> si se produce un error. 
	La función [HError](../ErrCompil/1000001036.md) permite identificar el problema.




**`<Data file>: (Cadena de caracteres)`**

Nombre del archivo de datos en formato HFSQL en el que se hará la importación.

Observación: Si el archivo de datos HFSQL manipulado no existe físicamente, se creará automáticamente.

**`<Path of the XLS or XLSX file>: (Cadena de caracteres)`**

Ruta de acceso completo al archivo XLS o XLSX a importar.
![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) Solo se pueden manipular archivos XLSX.

**`<Worksheet number>: (Entero opcional)`**

Número de la hoja del archivo XLS o XLSX a importar. 

Si no se especifica este parámetro, se importará la primera hoja del archivo XLS o XLSX. 

**`<List of destination items>: (Cadena de caracteres opcional)`**

Lista de nombres de campos en el archivo de datos al que se realizará la importación. Los nombres se pueden delimitar con comillas simples y separar con comas o retornos de carro (CR).
Los nombres de elementos de tipo clave compuesta, memo binario y binario se ignoran. 
Los elementos no importados se inicializarán con el valor predeterminado descrito en el análisis.

Si no se especifica este parámetro o corresponde a una cadena vacía, se importan todos los elementos (excepto las claves compuestas, los elementos binarios y los memos binarios) en el orden físico de descripción.

**`<Options>: (Constante o combinación de constantes de tipo Integer (opcional))`**

Configura el tipo de importación a realizar:


|   |   |
| --- | --- |
| *hCopyAutoId* | El identificador automático se copia. No se vuelve a calcular. |
| *hDefaultVal* | Para los elementos no importados, se reinicializan los valores del registro en curso:<br><br>- con el valor predeterminado, si se especifica la constante *hDefaultVal*.<br><br>- con el valor de los elementos correspondientes en el registro en curso antes de llamar a la función **HImportXLS** si no se especifica la constante *hDefaultVal*.<br><br><br> |
| *hImpBreakable* | La importación se puede interrumpir pulsando la tecla Esc del teclado.<br>Si se interrumpe la importación, los registros importados se conservan en el archivo de datos. |
| *hImpCreation* | Si el archivo de datos en el que se realizará la importación existe, se sobrescribirá. |
| *hImpIgnoreEmptyItem* | Si uno o más elementos/campos no se especifican en el archivo XLS, las filas correspondientes se importan. <br>Los elementos que faltan contienen:<br><br>- el valor predeterminado de los elementos si se especifica la constante *hDefaultVal*.<br><br>- el valor de los elementos en el registro en curso antes de llamar a la función **HImportXLS**.<br><br><br> |
| *hImpIgnoreFirstLine* | La primera fila del archivo XLS importado se ignora. |
| *hImpNormal*<br>(valor predeterminado) | Si el archivo de datos en el que se realizará la importación ya existe, se completa con los datos importados; de lo contrario, se crea un archivo de datos.<br>No se gestiona la integridad, ni los duplicados.<br>Los elementos no importados toman el valor del registro en curso.<br>Los identificadores automáticos se vuelven a calcular. <br>![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) La gestión de la integridad y de duplicados siempre está activada. |
| *hImpTestDuplicates* | Activa la gestión de duplicados en las claves únicas durante la importación (la gestión de duplicados solo se activa en las claves únicas y no en todo el registro).<br>![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) La gestión de duplicados siempre está activada. |
| *hImpTestIntegrity* | Prueba la integridad durante la importación.<br>![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) La gestión de la integridad está siempre activada. |



**`<Progress Bar>: (Nombre de control o ventana opcional)`**



- Nombre de la ventana en la que se mostrará la barra de progreso,

- Nombre del control Barra de progreso.






<a name="XComponent"></a>

## Componente:
wd280hf.dll
