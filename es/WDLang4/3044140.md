


## HReadLast (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Establece la posición en el último registro de un archivo de datos de acuerdo con un elemento de navegación. Se lee el registro y se actualizan las variables HFSQL (por ejemplo, Cliente.Nombre, es decir, el campo *Nombre* del archivo de datos *Cliente*).

Se lee el valor más alto de la posición de búsqueda (para más detalles, véase [observaciones](#NOTE0_1)).

En la mayoría de los casos, **HReadLast** se usa para establecer la posición en el archivo de datos para realizar un ciclo de lectura con [HReadPrevious](../WDLang4/3044048.md) 3000300030002f002300 .

Después de llamar a la función **HReadLast**, se pueden producir los siguientes casos:

- el archivo de datos está vacío o ningún registro corresponde al filtro (definido con la función [HFilter](../WDLang4/3044100.md)): no se realiza ninguna lectura y la función [HOut](../WDLang4/3044094.md) devuelve <u><u><u>True</u></u></u>.

- la función intenta bloquear un registro ya bloqueado en modo de lectura: no se realiza ninguna operación de lectura, [HErrorLock](../WDLang4/3044099.md) devuelve <u><u><u>True</u></u></u> y [HOut](../WDLang4/3044094.md) 02f002300 devuelve <u><u><u>True</u></u></u>.
	
	![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: La gestión de las cerraduras no está disponible para las bases de datos a las que accede el JDBC.




Esta función se puede utilizar con archivos de datos, vistas HFSQL o consultas.

<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000003044140&name=hreadlast_funcion&product=WD">Ver ejemplos adicionales</a>

```wl
HReadLast(Customer, Name)
WHILE HOut() = False
	// Process the record
	HReadPrevious(Customer, Name)
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = HReadLast([<Data file> [, <Browse item>] [, <Options>]])`
---

**`<Result>: (booleano)`**

Corresponde a: 

- <u><u><u><u>False</u></u></u></u> si se produce un error. En este caso, [HError](../WDLang4/3044088.md) devuelve un número entero distinto de 0. [HErrorInfo](../WDLang4/3044071.md) devuelve más detalles sobre el error. El registro no se lee. 

- el valor de la función [HFound](../WDLang4/3044104.md) en los demás casos (se puede leer el registro, incluso si &lt;Resultado&gt; devuelve <u><u><u><u>False</u></u></u></u>). 




**`<Data file>: (Cadena de caracteres opcional)`**

Nombre del archivo de datos, vista HFSQL o consulta utilizada. 
Si este parámetro es una cadena vacía (""), **HReadLast** manipula el último archivo de datos utilizado por la última función HFSQL (función que empieza por "H").

**`<Browse item>: (Cadena de caracteres opcional)`**

Nombre del elemento utilizado para recorrer el archivo de datos o la vista. Si no se especifica este nombre, la función **HReadLast** utilizará:

- Para un archivo de datos: el último elemento de búsqueda utilizado en este archivo por la última función para la gestión de HFSQL (empezando por la letra H). Si este campo no existe, el mejor campo de navegación se utiliza automáticamente. 

- For a query: el PEDIDO POR de la consulta (si existe), en caso contrario el último ítem utilizado. 

- Para una vista: el elemento de ordenación de la vista (si existe), en caso contrario el último elemento utilizado.




**`<Options>: (Constante o combinación de constantes opcional)`**

Configura:

- el bloqueo establecido en Record leído por **HReadLast** .

- si se debe tener en cuenta el filtro definido.





|   |   |
| --- | --- |
| *hForwardOnly* | ![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Constante que sólo se puede utilizar con Conectores Nativos (también llamada Accesos Nativos).<br><br>Optimiza las iteraciones simples que no utilizan las siguientes características:<br><br>- Leyendo el anterior Record.<br><br>- Modificando un Record.<br><br>- Posición de almacenamiento.<br><br><br>Si se utiliza una de estas características, el resultado puede diferir del esperado.<br><br>Por ejemplo, esta constante se puede utilizar cuando se realiza un bucle a través de los registros para rellenar una control Tabla de forma programada. |
| *hKeepFilter* | El filtro set de [HFilter](../WDLang4/3044100.md) se tendrá en cuenta, aunque la clave de búsqueda no esté optimizada para el filtro. Recordatorio: la función [HFilter](../WDLang4/3044100.md) devuelve la clave de búsqueda optimizada para el filtro. <br>**Atención**: En este caso, pueden surgir problemas de rendimiento para los archivos de datos de gran tamaño.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Este Variable no puede ser usado. |
| *hLockNo* | Sin bloqeuo: el Record puede ser leído o modificado por otra aplicación durante la lectura.<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hLockReadWrite* | Bloqueo de lectura y escritura: el Record que se lee actualmente no puede ser leído o modificado por otra aplicación.<br><br>![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) Bloqueo de solo escritura. Equivale a la constante *hLockWrite*.<br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hLockWrite* | Bloqueo de escritura: el registro leído actualmente puede ser leído por otra aplicación, pero no se puede modificar.<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hNoRefresh* | ![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) La función **HReadLast** no actualiza el contenido de la tabla o consulta. Si es posible, la consulta no se vuelve a ejecutar. Se guardan todas las posiciones guardadas. |

![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Las opciones de bloqueo no tendrán efecto si el proveedor OLE DB o el Conector Nativo no soporta los bloqueos.![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) El modo de bloqueo especificado con la función **HReadLast** seguirá siendo efectivo al llamar a las funciones [HReadPrevious](../WDLang4/3044048.md) y [HReadNext](../WDLang4/3044037.md).

Para cambiar el modo de bloqueo, utilice:

- [HReadSeekFirst](../WDLang4/3044036.md) o [HReadSeekLast](../WDLang4/3044034.md), 

- las funciones [HReadFirst](../WDLang4/3044051.md) o **HReadLast**.

- [HLockRecNum](../WDLang4/3044152.md) o [HUnlockRecNum](../WDLang4/3044194.md).


![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Para Conector Nativo Oracle, se puede especificar un modo de bloqueo diferente para cada Record. Sin embargo, si [SQLTransaction](../WDLang4/3072029.md) inició una transacción antes de establecer el bloqueo, el bloqueo solo se liberará al final de la transacción ( [SQLTransaction](../WDLang4/3072029.md) con la constante *sqlCommit* o *sqlRollBack* ).![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Las opciones de bloqueo no se tienen en cuenta. Utilice funciones de lectura de bloqueo ( **HReadLastLock** ) guardadas para la compatibilidad con versiones anteriores.![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Los bloqueos no se pueden gestionar en bases de datos a las que se accede mediante JDBC. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Lectura o no de la operación según un elemento clave
<a name="lectura_operacion_segun_elemento_clave_ELTPARAGRAPHE000316"></a>

Si el elemento utilizado es una clave, la función **HReadLast** lee el registro con el valor de clave más alto. El criterio de ordenación que se tiene en cuenta es el especificado en el análisis para esta clave. Si se encuentran duplicados, la función **HReadLast** lee el último registro "duplicado" según el orden de los números de registro.


Si el elemento no es una clave, la función **HReadLast** lee el último registro activo. Al navegar por el archivo de datos, los Record s se ordenarán según su número de Record. 
En este caso, el elemento de navegación seleccionado aparecerá en rojo en el editor de código y se mostrará una advertencia en la pantalla de ["Panel "Código](../Editeurs/2027009.md).

**Observación**: La [autocompletado](../Editeurs/2013001.md) propone únicamente los puntos clave.
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Procedimientos almacenados](https://doc.pcsoft.fr/ext/images/us/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Bloqueos
<a name="bloqueos_ELTPARAGRAPHE000346"></a>

De forma predeterminada (parámetro &lt;Options&gt; no especificado), no se bloquean los registros.

Si se solicita un bloqueo (constantes *hLockWrite* o *hLockReadWrite*), se leerá el registro solo si este aún no ha sido bloqueado.

![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Las opciones de bloqueo no tendrán efecto si el proveedor OLE DB o el Conector Nativo no soporta los bloqueos.
<a name="NOTE0_3"></a>


### Memos
<a name="memos_ELTPARAGRAPHE000361"></a>

Los memos asociados con el Record pueden ser leídos automáticamente (o no) cuando se lee el Record. [HSetMemo](../WDLang4/3044139.md) se utiliza para personalizar esta operación de lectura de automatic.

Si los memos están soportados, los memos de texto asociados se leen cuando se lee la Record. Los memos binarios sólo se leen cuando se utilizan explícitamente ([HExtractMemo](../WDLang4/3044072.md)).
<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![Lenguaje Externo](https://doc.pcsoft.fr/ext/images/us/LE.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Procedimientos almacenados](https://doc.pcsoft.fr/ext/images/us/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Contraseña
<a name="contrasena_ELTPARAGRAPHE000380"></a>

Si **HReadLast** es la primera función que maneja el archivo de datos especificado, la contraseña se verifica cuando se abre el archivo de datos.. Si la contraseña es incorrecta, la función [HErrorPassword](../WDLang4/3044082.md) devuelve <u><u><u><u>True</u></u></u></u> y la función [HOut](../WDLang4/3044094.md) se establece en <u><u><u><u>True</u></u></u></u>.
<a name="NOTE0_5"></a>


### Varios
<a name="varios_ELTPARAGRAPHE000405"></a>

- La función [HRecNum](../WDLang4/3044063.md) devuelve el número de registro actual.

- La función [HChangeKey](../WDLang4/3044151.md) cambia la clave de búsqueda conservando la posición en el registro actual.

- Para optimizar las primeras iteraciones en un archivo de datos, utilice [HOptimize](../WDLang4/3044005.md) en este archivo de datos.

- Esta función reemplaza **HReadLastLock** y **HReadLastNoLock** , que se mantuvieron por compatibilidad con WINDEV 5.5.




<a name="XComponent"></a>

## Componente:
wd280hf.dll
