


## SQLTransaction( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Inicia, compromete o revierte una transacción:

- en los archivos de una base de datos abierta por [SQLConnect](../WDLang4/3072005.md),

- en los archivos de una base de datos abierta por una conexión (OLE DB o Native Access/Conector Nativo) descrita en el editor de análisis o por [HOpenConnection](../WDLang4/3044107.md).




**Observación: Esta función es la única función SQL que se puede utilizar con las funciones HFSQL (para realizar transacciones en una base de datos externa manejada por las funciones HFSQL, por ejemplo).**

<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000003072029&name=sqltransaction_funcion&product=WD">Ver ejemplos adicionales</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) 
```wl
ConnectionNum is int = SQLConnect("MyDatabase", "User", "Password", "", ...
		"OLEDB", "MyProvider")
IF ConnectionNum = 0 THEN
	SQLInfo()
	Error("Error while opening the connection: " + SQL.MesError)
ELSE
	// Put the connection in transaction
	SQLTransaction(sqlStart)
	// Modify the value of all the AFile.AnItem items
	IF SQLExec("UPDATE AFile SET AnItem = 'new value", ...
		"UpdateQuery") = True THEN
		// End the transaction
		SQLTransaction(sqlCommit)
	ELSE
		SQLInfo("UpdateQuery")
		Error("Error while running the query: " + SQL.MesError)
		// Cancel the transaction
		SQLTransaction(sqlRollBack)
		// The content of AFile did not change
	END
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Transacción en los archivos de una base de datos abierta por SQLConnect

`<Result> = SQLTransaction(<Indicator>)`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se realizó la operación,

- <u><u><u><u>False</u></u></u></u> en caso contrario.




**`<Indicator>: (Constante de tipo Integer)`**

Tipo de operación de transacción a realizar:


|   |   |
| --- | --- |
| *sqlCommit* | Finalice la transacción. |
| *sqlRollBack* | Cancela la transacción. |
| *sqlStart* | Inicia la transacción. |

**Observación**: Esta sintaxis no está disponible en Android. 


<a name="SYNTAX2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
### Transacción en los archivos de una base de datos abierta por una conexión descrita en el análisis o por HOpenConnection

`<Result> = SQLTransaction(<Indicator> , <Connection>)`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se realizó la operación,

- <u><u><u><u>False</u></u></u></u> en caso contrario.




**`<Indicator>: (Constante de tipo Integer)`**

Tipo de operación de transacción a realizar:


|   |   |
| --- | --- |
| *sqlCommit* | Finalice la transacción. |
| *sqlRollBack* | Cancela la transacción. |
| *sqlStart* | Inicia la transacción. |



**`<Connection>: (Cadena de caracteres)`**

Nombre de la conexión utilizada para acceder a la base de datos. Este nombre fue definido en la editor de análisis o por la [HOpenConnection](../WDLang4/3044107.md). Esta conexión debió haberse descrito al llamar a la función **SQLTransaction**. Si la conexión no se abre al llamar a la función **SQLTransaction**, la conexión especificada se abre automáticamente.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Sintaxis 2: Realización de una transacción en una conexión
<a name="sintaxis_2_realizacion_una_transaccion_una_conexion_ELTPARAGRAPHE000128"></a>

Para realizar una transacción en una conexión, debe hacerlo:

1. Iniciar la conexión (función **SQLTransaction**(sqlStart)).

2. Realice las operaciones en los archivos de datos con las funciones HFSQL correspondientes.

3. Finalice la transacción:

	- ya sea validando las operaciones realizadas (función **SQLTransaction**(sqlCommit)).

	- anulando las operaciones realizadas (**SQLTransaction**(sqlRollBack)).






<a name="NOTE0_2"></a>


### Operaciones de anidamiento
<a name="operaciones_anidamiento_ELTPARAGRAPHE000148"></a>Las transacciones pueden ser anidadas.
![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Las transacciones no se pueden anidar. Un error de WLanguage ocurre si una transacción se inicia mientras otra transacción está en progreso.
<a name="NOTE0_3"></a>


### Cierres y transacciones
<a name="cierres_transacciones_ELTPARAGRAPHE000158"></a>

**SQLTransaction** no bloquea los archivos o registros de datos. **SQLTransaction** inicia, compromete o revierte una transacción.

Si se inicia una transacción: 

- Las operaciones de escritura en las tablas pueden provocar bloqueos (por ejemplo, en una base de datos HFSQL, las operaciones de escritura bloquean los registros).

- las operaciones de lectura pueden provocar bloqueos en algunas bases de datos si el nivel de aislamiento es "repetible-lectura" o "serializable" (note que este no es el caso en las bases de datos HFSQL). 



<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Conector Nativo MySQL
<a name="conector_nativo_mysql_ELTPARAGRAPHE000176"></a>

[SQLLock](../WDLang4/3072003.md) y **SQLTransaction** se utilizan para gestionar bloqueos y transacciones sólo en tablas MySQL "InnoDB".

<a name="XComponent"></a>

## Componente:
wd280hf.dll
