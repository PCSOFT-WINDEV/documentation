


## Estado de salud (función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Permite conocer el estado de un registro. Un Record puede ser Active, cruzado o borrado.


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000003044081&name=estado_salud_funcion&product=WD">Ver ejemplos adicionales</a>

```wl
IF HState(Customer) = hStateActive THEN
	// Processes
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = HState([<Data file> [, <Record number>]])`
---

**`<Result>: (Constante de tipo Integer)`**

Estado de Record: 


|   |   |
| --- | --- |
| *hStateActive* | El Record es Active. |
| *hStateCrossed* | La Record está cruzada. |
| *hStateDel* | El Record se ha borrado. |
| *hStateInvalid* | Estado de Record no encontrado (error). |



**`<Data file>: (Cadena de caracteres opcional)`**

Nombre del archivo de datos utilizado. Si no se especifica este nombre, la función **Estado de salud** utilizará el último archivo de datos utilizado por la última función HFSQL (que empieza por "H").

**`<Record number>: (Entero opcional)`**

Número de la buscada Record. Si no se especifica este número (o es igual a 0), **Estado de salud** será manipular el actual Record. El actual Record no se lee de nuevo.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Número de Record no especificado
<a name="numero_record_especificado_ELTPARAGRAPHE000113"></a>

Si no se especifica el parámetro &lt;Número de registro&gt;, la función **Estado de salud** no lee el registro.

En una aplicación de red, se recomienda leer el registro antes de llamar a la función **Estado de salud** para asegurarse de que el registro no ha sido eliminado. Con [HRead](../WDLang4/3044047.md), por ejemplo:

```wl
HRead(FileName, hRecNumCurrent)
```

<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) 

### Archivos de datos en formato Hyper File 5.5
<a name="archivos_datos_formato_hyper_file_55_ELTPARAGRAPHE000139"></a>

Con el motor de Hyper File 5, la Record debe ser leída de nuevo para que su estado se refresque. De hecho, si no se lee de nuevo el registro después de las funciones [HDelete](../WDLang4/3044018.md) o [HCross](../WDLang4/3044121.md), la función **Estado de salud** siempre devuelve *hStateActive*.

Este modo de funcionamiento ya no está disponible en el motor HFSQL Classic. Después de utilizar las funciones [HDelete](../WDLang4/3044018.md) o [HCross](../WDLang4/3044121.md) en el registro en curso, la función **Estado de salud** devuelve el estado actual del registro.
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Archivos xBase
<a name="archivos_xbase_ELTPARAGRAPHE000168"></a>

[HDelete](../WDLang4/3044018.md) y [HCross](../WDLang4/3044121.md) tienen el mismo efecto: el Record se cruza pero no se borra. Por lo tanto, la Record puede volver a activarse mediante [HModify](../WDLang4/3044042.md). 

En este caso, **Estado de salud** devuelve la constante *hStateCrossed* para un Record eliminado (en lugar de *hStateDel* 000).

<a name="XComponent"></a>

## Componente:
wd280hf.dll
