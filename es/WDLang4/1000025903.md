
## HSuggestKey( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Devuelve una lista de claves para añadir a los archivos de datos para mejorar el rendimiento de la consulta. 
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
sMyString is string
sMyString = HSuggestKey(MyConnection, ((MyQuery1, MyQuery2, MyQuery3))
Trace(sMyString)
```

<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX1"></a>

`<Result> = HSuggestKey(<Connection> , <Queries> [, <Options>])`
---

**`<Result>: (Cadena de caracteres)`**

Mensaje correspondiente al formato solicitado. 

**`<Connection>: (Cadena de caracteres o variable de tipo Connection)`**

Conexión al servidor HFSQL que contiene las consultas a analizar. Esta conexión corresponde a:

- el nombre de la conexión definida en el editor de análisis o con las funciones [HDescribeConnection](../WDLang4/3044205.md) o [HOpenConnection](../WDLang4/3044107.md).

- el nombre de una variable de tipo [Conexión](../WDLang4/1514073.md).




**`<Queries>: (Lista de valores entre paréntesis, separados por comas)`**

Lista de consultas a analizar (10 consultas como máximo). Esta lista de consultas tiene el siguiente formato: 


```txt
(<Query 1>, ..., <Query N>)
```
donde: 

- &lt;Pregunta 1&gt;: La primera consulta a ser analizada.

- ...

- &lt;Query N&gt;: Es la enésima pregunta que se analiza.




Observación: Es posible analizar las consultas creadas con el editor de consultas, consultas WLanguage o consultas SQL. Los diferentes tipos de consultas se pueden mezclar en la lista. 

**`<Options>: (Constante de tipo Integer)`**

Permite configurar el resultado devuelto: 



|   |   |
| --- | --- |
| *hSKSimplified* especificado | &lt;Resultado&gt; es la lista de claves que faltan. Si no se necesita ninguna clave, &lt;Resultado&gt; es una cadena vacía.. La lista de claves que faltan tiene el siguiente formato: <br><br><pre><code><File 1> + TAB + <Key 1> + <EOT> + <Key 2> + ...<br> + <Key N> + CR + ... + CR + <File N> + TAB + <Key 1> + <br><EOT> + <Key 2> + ... + <Key N></code></pre><br> donde: <br><br>- &lt;Archivo N&gt; es el archivo de datos para ser optimizado. <br><br>- &lt;Clave N&gt; es el nombre de la clave que se va a añadir. <br><br><br> |
| *hSKSimplified* no especificado<br>(Valor predeterminado) | &lt;Resultado&gt; es un mensaje legible para el desarrollador, que contiene la lista de claves que hay que añadir a los archivos de datos para optimizar las consultas. Este texto utiliza RTF. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


- La función toma un máximo de 10 consultas como parámetros. Para aceptar más consultas, se recomienda utilizar [HSuggestKeyStart](../WDLang4/1000025905.md) y [HSuggestKeyEnd](../WDLang4/1000025906.md).

- Para analizar una consulta con un parámetro, debe proporcionar el valor del parámetro antes de ejecutar **HSuggestKey**. Por ejemplo: 
	
	```wl
	MySELECT_PRODUCTqry is SQL Query = 
	[	
	SELECT * FROM PRODUCT
	WHERE PRODUCT.Reference = {pReference}
	]
	MySELECT_PRODUCTqry.pReference = 123
	let sListKey = HSuggestKey(MyConnection, (MySELECT_PRODUCTqry))
	```

	Si no se da un valor a los parámetros de consulta, la condición de consulta no se tendrá en cuenta. En ese caso, no se sugerirá ninguna llave.

- Las claves se sugieren de acuerdo con los datos contenidos en el archivo de datos. Si un archivo de datos no contiene datos, no se sugerirá ninguna clave.




<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Lógica de negocio
## Componente:
wd280hf.dll
