


## &lt;variable Connection&gt;.TransactionStart (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Inicia una transacción en los archivos de datos (HFSQL o accedido a través de una Conector Nativo) y crea el archivo de transacción.

**¿Cuál es la información que se guarda en el archivo de transacciones?** Cuando una función WLanguage modifica un archivo de datos o de índices durante durante una transacción, los anteriores valores del registro y la operación realizada se almacenan en el archivo de transacciones.

![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) La transacción puede iniciarse en una conexión: En este caso, se inicia una transacción sólo para los archivos associated a esta conexión. Este modo es necesario para gestionar el [niveles de aislamiento de las transacciones](../WDLang4/1000017316.md). 

**Observación**: Esta función es equivalente a la función [&lt;Variable Connection&gt;.Transaction](../WDLang4/1000023965.md).
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
MyConnection1 is Connection

// Start transaction on data files associated with MyConnection1
MyConnection1.TransactionStart()

// Code used to prepare the order to added
// ...

WHEN EXCEPTION IN
	// Add the order
	Order.Add() 
	// Validate the addition
	MyConnection1.TransactionEnd()
DO
	// Delete the order lines
	MyConnection1.TransactionCancel()
END
```
<a name="Example2"></a>

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Iniciar una transacción Client/Server en una conexión específica

`<Result> = <Connection>.TransactionStart([<List of data files>])`
---

**`<Result>: (Booleano)`**



- <u><u><u><u>True STRIMEULB</u></u></u></u> si se ha iniciado la transacción,

- <u><u><u><u>False</u></u></u></u> si se produce un problema. [HErrorInfo](../WDLang4/3044071.md) devuelve más detalles sobre el error.




**`<Connection>: (Variable de tipo Connection)`**

Nombre de la variable de tipo [Conexión](../WDLang4/1514073.md) que describe la conexión a utilizar.

**`<List of data files>: (Cadena de caracteres opcional)`**

Lista de los nombres lógicos de uno o varios ficheros de datos a tener en cuenta (o no) en la operación (en este caso, el nombre de el archivo de datos va precedido del signo "-").


|   |   |
| --- | --- |
| **Si no se especifica este parámetro** | Todos los archivos de datos utilizados durante la transacción serán tenidos en cuenta en la transacción. |
| **Si todos los archivos de datos se prefijan con el signo "-"**<br>Por ejemplo: "-Cliente, -Producto" | Todos los archivos de datos especificados en la lista y utilizados durante la transacción no serán tenidos en cuenta por la transacción.<br>Todos los archivos de datos no especificados en la lista serán tenidos en cuenta y utilizados durante la transacción. |
| &lt;b&gt;Si ningún archivo de datos de la lista lleva el prefijo "-"&lt;/b&gt;<br>Por ejemplo: "Cliente, producto" | Todos los archivos de datos especificados en la lista y utilizados durante la transacción serán tenidos en cuenta en la transacción. <br>Todos los archivos de datos no especificados y manipulados durante la transacción serán ignorados en la misma. |
| **Si algunos archivos de datos tienen el prefijo "-" y otros no son**<br>Por ejemplo: "Cliente, Producto" (equivalente a "Producto") | Todos los archivos de datos de la lista con el prefijo "-" y utilizados durante la transacción serán ignorados en la transacción.<br>Todos los archivos de datos de la lista que no lleven el prefijo "-" y que se utilicen durante la transacción se tendrán en cuenta en la transacción.<br>Los archivos no especificados en la lista serán excluidos de la transacción. |

![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Este parámetro no se tiene en cuenta. Todos los archivos de datos de associated con la conexión están en transacción en el servidor nativo.


<a name="SYNTAX2"></a>

### Iniciar una transacción Client/Server en una conexión específica

`<Result> = <Connection>.TransactionStart(<Transaction file> , <List of data files>)`
---

**`<Result>: (Booleano)`**



- <u><u><u><u>True STRIMEULB</u></u></u></u> si se ha iniciado la transacción,

- <u><u><u><u>False</u></u></u></u> si se produce un problema. [HErrorInfo](../WDLang4/3044071.md) devuelve más detalles sobre el error.




**`<Connection>: (Variable de tipo Connection)`**

Nombre de la variable de tipo [Conexión](../WDLang4/1514073.md) que describe la conexión a utilizar.

**`<Transaction file>: (Cadena de caracteres)`**

Nombre completo del archivo de transacciones (utilizado para registrar las operaciones realizadas en la transacción). 

Este parámetro no se tiene en cuenta para las conexiones a un servidor HFSQL.  

**`<List of data files>: (Cadena de caracteres)`**

Lista de los nombres lógicos de uno o varios ficheros de datos a tener en cuenta (o no) en la operación (en este caso, el nombre de el archivo de datos va precedido del signo "-").


|   |   |
| --- | --- |
| **Si no se especifica este parámetro** | Todos los archivos de datos utilizados durante la transacción serán tenidos en cuenta en la transacción. |
| **Si todos los archivos de datos se prefijan con el signo "-"**<br>Por ejemplo: "-Cliente, -Producto" | Todos los archivos de datos especificados en la lista y utilizados durante la transacción no serán tenidos en cuenta por la transacción.<br>Todos los archivos de datos no especificados en la lista serán tenidos en cuenta y utilizados durante la transacción. |
| &lt;b&gt;Si ningún archivo de datos de la lista lleva el prefijo "-"&lt;/b&gt;<br>Por ejemplo: "Cliente, producto" | Todos los archivos de datos especificados en la lista y utilizados durante la transacción serán tenidos en cuenta en la transacción. <br>Todos los archivos de datos no especificados y manipulados durante la transacción serán ignorados en la misma. |
| **Si algunos archivos de datos tienen el prefijo "-" y otros no son**<br>Por ejemplo: "Cliente, Producto" (equivalente a "Producto") | Todos los archivos de datos de la lista con el prefijo "-" y utilizados durante la transacción serán ignorados en la transacción.<br>Todos los archivos de datos de la lista que no lleven el prefijo "-" y que se utilicen durante la transacción se tendrán en cuenta en la transacción.<br>Los archivos de datos no especificados en la lista serán excluidos de la transacción. |

![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Este parámetro no se tiene en cuenta. Todos los archivos de datos de associated con la conexión están en transacción en el servidor nativo.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones
<a name="NOTE0_2"></a>


### Bloqueo de registros
<a name="bloqueo_registros_ELTPARAGRAPHE000480"></a>

Los registros añadidos, modificados o eliminados en una transacción se bloquean en el modo de escritura.
<a name="NOTE0_3"></a>


### Casos de error
<a name="casos_error_ELTPARAGRAPHE000490"></a>

- Operaciones de anidamiento: Las transacciones no se pueden anidar (es decir, no se puede llamar a **&lt;variable Connection&gt;.TransactionStart** en una transacción). En este caso, se produce el error 70031.

- Se muestra un error fatal en los siguientes casos: 

	- Se inicia una transacción en todas las conexiones mientras haya al menos una conexión en la transacción.. 

	- Se inicia una operación en una conexión mientras que ya se ha iniciado una operación en todas las conexiones.. 

	- Se inicia una transacción en todas las conexiones mientras haya al menos una conexión cuyo modo de aislamiento no sea "Read Uncommitted".. 






<a name="NOTE0_4"></a>
<a name="NOTE0_5"></a>


### Manipular registros durante una transacción
<a name="manipular_registros_durante_una_transaccion_ELTPARAGRAPHE000525"></a>

Durante una transacción, se deben cumplir algunas reglas al manipular registros. Para obtener más información, consulte [Transacciones: Manipular registros durante una transacción](../WDLang4/3044336.md).
<a name="NOTE0_6"></a>


### Transacciones y contexto HFSQL independiente
<a name="transacciones_contexto_hfsql_independiente_ELTPARAGRAPHE000538"></a>

Al copiar un contexto, si una transacción está en curso en el primer contexto, el nuevo contexto no está en la transacción.. Se debe llamar a la función **&lt;variable Connection&gt;.TransactionStart** para iniciar una transacción en el nuevo contexto.
<a name="NOTE0_7"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### OLE DB y Conectores Nativos
<a name="ole_conectores_nativos_ELTPARAGRAPHE000552"></a>

Sólo las sintaxis con conexión son tenidas en cuenta por los Accesos Nativos que soportan las transacciones.. También se puede utilizar la función [SQLTransaction](../WDLang4/3072029.md).

<a name="XComponent"></a>

## Componente:
wd280hf.dll
