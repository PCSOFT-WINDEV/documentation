


## Controlador ODBC para HFSQL Classic y para HFSQL Client/Server (Windows)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000235"></a>
El controlador ODBC para HFSQL Classic (monopuesto o multipuesto) se utiliza para acceder a una base de datos HFSQL Classic desde un software de base de datos externo que admita los accesos por ODBC.

El controlador ODBC para HFSQL Client/Server permite acceder a una base de datos HFSQL Client/Server desde un software de base de datos externo que admita el acceso mediante ODBC.

El controlador está disponible en lectura/escritura. Una aplicación escrita en lenguaje externo puede leer y escribir en archivos HFSQL.

El controlador ODBC para HFSQL Classic y HFSQL Client/Server es un controlador ODBC de nivel 3. El controlador ODBC ofrece varias características adicionales, tales como:

- mejor soporte para el estándar UNICODE, 

- apoyo a las transacciones, 

- múltiples marcadores en las mesas, 

- búsqueda por comodín en las tablas de esquemas, 

- gestión de cursores por bloque. 


Consulte una documentación específica para obtener más detalles.



Observación: Esta ayuda Page explica cómo instalar el controlador ODBC para HFSQL Classic y HFSQL Client/Server para Windows. La instalación del controlador ODBC para HFSQL Classic y HFSQL Client/Server para Linux se presenta en la ayuda Page denominada [Controlador ODBC para HFSQL Linux](../WDLang4/9000160.md).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Instalación
<a name="instalacion_ELTTEXTE000265"></a>
El controlador ODBC para HFSQL Classic y HFSQL Client/Server puede instalarse al instalar WINDEV o WEBDEV en el ordenador de desarrollo.

Además, al configurar el programa instalación de sus aplicaciones WINDEV o sitios WEBDEV, tiene la posibilidad de incluir el instalación del controlador ODBC para HFSQL (Clásico o Cliente/Servidor).

**Observaciones**: 

- El controlador ODBC se instala en el directorio "Archivos de programa\\Archivos comunes\\PC Soft\\28.0\\ODBC".

- Si es necesario, el programa instalación del controlador ODBC (WX28 0PACKODBC.EXE) se encuentra en el directorio "Install\\ODBC" de WINDEV o WEBDEV. 




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Configuración
<a name="configuracion_ELTTEXTE000289"></a>


### Utilización del controlador ODBC para HFSQL Classic o Cliente/Servidor
<a name="utilizacion_del_controlador_odbc_para_hfsql_classic_clienteservidor_ELTPARAGRAPHE000069"></a>

Para utilizar el controlador ODBC para HFSQL Classic o Cliente/Servidor: 

1. Inicie el administrador de datos ODBC (ODBCAD32.EXE) en su ordenador. Por ejemplo, utilice la opción "Iniciar .. Ejecutar" de Windows e introduzca "ODBCAD32.EXE"..
	**Observación**: En Windows Vista (o superior) en 64 bits, abra "c:\\windows\\syswow64\\odbcad32.exe".

2. Seleccione la pestaña "Base de datos Usuario".

3. Haga clic en el botón "Agregar".

4. Seleccione el controlador "HyperFileSQL".

5. Haga clic en "Hecho".

6. Introduzca el nombre de la fuente de datos HFSQL. Este nombre se utilizará para identificar la base de datos HFSQL en los programas externos.

7. Haga clic en el botón "Detalles".

8. Utilice los botones de navegación para seleccionar el archivo WDD correspondiente al análisis.

9. En la lista de análisis, seleccione el análisis solicitado y valide.

10. Si la base de datos está en formato "HFSQL Classic", seleccione la opción "HFSQL Classic" y enseguida seleccione el directorio de los archivos de datos correspondiente mediante el botón examinar. En este directorio se agrupan todos los archivos de datos de HFSQL Classic correspondientes al análisis seleccionado. 
	Atención: se debe seleccionar un directorio de archivos para cada análisis. 
	Valide (botón "OK").

11. Si la base de datos está en formato "HFSQL Client/Server", seleccione la opción "HFSQL Client/Server" e indique los parámetros de conexión al servidor:

	- El servidor Address,

	- El puerto,

	- El nombre de la base de datos a utilizar, 

	- El nombre de usuario utilizado para acceder a la base de datos, 

	- La contraseña associated con el usuario. La contraseña se almacena en formato encriptado.




12. Valide (botón "OK").




La base de datos puede utilizarse en lectura/escritura desde los programas externos a través del controlador ODBC para HFSQL Classic o Cliente/Servidor.

La cadena de conexión con el controlador HFSQL Classic debe tener el siguiente formato:


```txt
DRIVER={HFSQL};ANA=<Path of WDD file>;REP=<Data directory>
```

Por ejemplo: 
```txt
Driver={HFSQL};ANA=C:\My Projects\CRM\CRM.wdd;REP=C:\My Projects\CRM\Exe; IntegrityCheck=1
```


La cadena de conexión al controlador HFSQL en modo Cliente/Servidor debe tener el siguiente formato:


```txt
DRIVER={HFSQL};Server Name=127.0.0.1;Server Port=4900;
Database=dbName;UID=username;PWD=password; IntegrityCheck=1
```


**Observaciones**: 

- Para utilizar la base de datos HFSQL con un sitio PHP, debe definirse una fuente de datos ODBC "sistema" y no una fuente de datos "usuario".

- "IntegrityCheck" indica que las reglas de integridad y gestión de duplicados deben comprobarse cuando se modifican, añaden y eliminan datos.



<a name="NOTE3_2"></a>


### Gestión de consultas OPEN FILE
<a name="gestion_consultas_open_file_ELTPARAGRAPHE000119"></a>

Para utilizar las consultas OPEN FILE en archivos HFSQL, debe especificar:

- la palabra clave PATH para cambiar el directorio del archivo.

- la palabra clave USING para especificar la contraseña del archivo.




La sintaxis es la siguiente:


```txt
OPEN FILE <File Name> [PATH <File Directory>] [USING <File Password>]
```
**Ejemplo**:


```sql
OPEN FILE Customer PATH "C:\Temp\My test" USING mypassword
```
**Observación**: Los nombres de los archivos, los nombres de los directorios y las contraseñas se pueden incluir entre comillas si contienen caracteres espaciados.
<a name="NOTE3_3"></a>


### Acceso a los archivos de HFSQL Client/Server
<a name="acceso_los_archivos_hfsql_clientserver_ELTPARAGRAPHE000137"></a>

Las consultas OPEN FILE también le permiten acceder a las bases de datos HFSQL CLient/Server. Para ello, especifique: 

- el servidor a utilizar mediante la palabra clave SERVER.

- la base de datos a utilizar mediante la palabra clave DATABASE.

- el usuario mediante la palabra clave USER.

- el directorio de los archivos mediante la palabra clave PATH.




**Ejemplo**:


```sql
OPEN FILE * SERVER TestServer DATABASE Example USER Admin PATH "MyDatabaseHFCS"
```
**Observación**: Los nombres de los archivos, los nombres de los directorios y las contraseñas se pueden incluir entre comillas si contienen caracteres espaciados.
<a name="NOTE3_4"></a>


### Insertar consulta
<a name="insertar_consulta_ELTPARAGRAPHE000154"></a>

Al ejecutar una consulta INSERT, la variable **SQL.IDAuto** contiene el identificador automatic que se agregó durante el INSERT anterior.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Notas y limitaciones
<a name="notas_limitaciones_ELTTEXTE000331"></a>


### Eliminación de un controlador
<a name="eliminacion_controlador_ELTPARAGRAPHE000163"></a>

Cuando se eliminan las DLL de un controlador, las fuentes de datos que utilizan este controlador deben eliminarse de antemano.. De lo contrario, la aplicación puede estar bloqueada.
<a name="NOTE4_2"></a>


### Uso de la versión más reciente del controlador
<a name="uso_version_mas_reciente_del_controlador_ELTPARAGRAPHE000170"></a>

Para utilizar la versión más reciente de un controlador, se debe eliminar la fuente de datos y volver a crearla utilizando el controlador "HyperFileSQL" propuesto.
<a name="NOTE4_3"></a>


### Access 2000
<a name="access_2000_ELTPARAGRAPHE000177"></a>

Al importar una tabla desde una fuente de datos ODBC a Access 2000, la fuente de datos HFSQL Classic debe definirse como "Fuente de datos equipo" y no como "Fuente de datos archivo".
<a name="NOTE4_4"></a>


### Observación
<a name="observacion_ELTPARAGRAPHE000186"></a>

El controlador ODBC es compatible con el formato Unicode.


