


## &lt;Variable Connection&gt;.AddScheduledOptimization (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Agrega una tarea de optimización de archivos de datos HFSQL Client/Server.




<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Describe the connection
MyConnection is Connection
...
// Recalculate the statistics for the files found in "MyDatabase", 
// every Saturday at 23:00
Optim is hScheduledOptimization
Optim.Description = "Recalculating the statistics for the files" + ...
	" in MyDatabase"

Optim.Scheduling.Month = "*"
Optim.Scheduling.DayOfWeek = "Saturday"
Optim.Scheduling.Hour = "23"
Optim.Scheduling.Minute = "0"

Optim.File[1].Name = "MyDatabase"
Optim.File[1].Option = hOptStat

MyConnection.AddScheduledOptimization(Optim)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = <Connection>.AddScheduledOptimization(<Scheduled optimization task>)`
---

**`<Result>: (Boolean)`**



- <u><u><u><u>True</u></u></u></u> si se agregó la tarea de optimización programada

- <u><u><u><u>False</u></u></u></u> si se produce un error. La función [HErrorInfo](../WDLang4/3044071.md) permite identificar el error.




**`<Connection>: (Variable de tipo Connection)`**

Nombre de la [Conexión](../WDLang4/1514073.md) Variable que describe la conexión para la que hay que añadir una tarea de optimización programada.

**`<Scheduled optimization task>: (Variable de tipo hScheduledOptimization)`**

Nombre de la [hScheduledOptimization](../WDLang4/1000018854.md) Variable utilizada.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Derechos necesarios
<a name="derechos_necesarios_ELTPARAGRAPHE000222"></a>

Para añadir una tarea de optimización programada, debe tener: 

- los permisos correspondientes (constante *hRightsManageTask*) en el servidor,

- los permisos de conexión (constante *hRightsConnection* o *hRightsEncryptedConnection*) para cada base de datos,

- los derechos para ejecutar el comando relacionado en la tarea de optimización programada.


La tarea se ejecutará con la cuenta del usuario que la creó.. 

Para una optimización completa del servidor, el usuario debe ser un superusuario.

**Observación**: La tarea de optimización de programación no se realizará si el servidor está apagado.. La tarea de optimización programada se realizará en la siguiente fecha disponible cuando se encienda el servidor.

Para saber si estos derechos están concedidos a un usuario o a un grupo, utilice [&lt;Variable Connection&gt;.InfoServerRights](../WDLang4/1000022668.md) o [&lt;Variable Connection&gt;.InfoDatabaseRights](../WDLang4/1000022666.md).

Para modificar los derechos concedidos a un usuario o a un grupo de usuarios, utilice [&lt;Variable Connection&gt;.ModifyServerRights](../WDLang4/1000022710.md) o [&lt;Variable Connection&gt;.ModifyDatabaseRights](../WDLang4/1000022707.md).

<a name="XComponent"></a>

## Componente:
wd280hf.dll
