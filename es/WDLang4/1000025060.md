


## &lt;Fuente&gt;.Index (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Reconstruye el índice del archivo (archivo".NDX"). También tiene la capacidad de reindexar los índices de texto completo (extensión "FTX"). Un archivo de datos puede ser reindexado incluso cuando se accede a él por las aplicaciones. Para obtener más información, consulte observaciones.

**Recordatorio**: La operación de reindexación reorganiza los índices. Después de la operación de reindexación, se optimiza el acceso a los índices. La reindexación de un archivo de datos puede ser necesaria tras la pérdida o modificación del archivo de índice. [&lt;Fuente&gt;.CheckIndex](../WDLang4/1000025078.md) se utiliza para comprobar regularmente el estado del archivo de índice.


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
IF AFile.Index(hNdxNormal) = True THEN
	TABLE_MyTable.Display(taStart)
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = <Source>.Index([<Mode> [, <Progress Bar> [, <Density rate>]]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si la operación de reindexación se realizó con éxito,

- <u><u><u><u>False</u></u></u></u> en caso contrario. La función [HError](../WDLang4/3044088.md) permite obtener más detalles sobre el problema.




**`<Source>: (Tipo de fuente especificada)`**

Nombre del archivo de datos utilizado. 

**`<Mode>: (Constante o combinación de constantes de tipo Integer (opcional))`**

Configure la operación de reindexación:


|   |   |
| --- | --- |
| *hChangeCharset* | Reindexación con cambio de carácter set.<br>El nuevo carácter set definido por [ChangeCharset](../WDLang1/3054001.md) se tendrá en cuenta durante la reindexación. El orden, las búsquedas, ... en claves de tipo String (cadenas, caracteres, fecha y hora) se realizarán de acuerdo con este conjunto de caracteres. |
| *hFTX* | Reindexación de índices full-text. |
| *hMmoCompact* | Compresión y desfragmentación de archivos "Mmo".<br><br>**Atención**: Esta constante no puede combinarse con las constantes *hNdxCompact*, *hCheckMemo*, *hFTX*, *hNdxNormal* o *hNdxDelete* . |
| *hNdxCompact* | Reindexación con compresión (sólo mantiene los registros de Active. Todos los demás registros se eliminan de forma permanente). |
| *hNdxMinimal* | Reindexación teniendo en cuenta sólo las claves corruptas. Este parámetro se ignora si las constantes *hNdxDelete* o *hNdxCompact* están activadas. |
| *hNdxSilent* | Reindexación sin visualización |
| *hNdxNormal*<br>(valor predeterminado) | Reindexación estándar (con estadísticas y sin compresión).<br>Las estadísticas se utilizan para optimizar las consultas y los filtros (ver las Notas). Para el cálculo de las estadísticas sólo se tienen en cuenta los registros de Active. |
| *hNdxNoStat* | Reindexar sin calcular las estadísticas. Esta constante aumenta el espacio disponible al reducir el tamaño de los archivos de índice..<br>**Atención**: Las estadísticas son muy importantes para que get corrija los tiempos de ejecución al usar consultas, filtros con condición y vistas con condición. |
| *hNdxDelete* | Reindexar y eliminar los registros dañados |
| *hBackgroundTask* | ![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) La reindexación realizada en la tarea de Background. Las aplicaciones no se bloquean durante la operación de reindexación.<br><br>Esta función sólo está disponible en modo Cliente/Servidor. |
| *hCheckMemo* | Reindexación estándar con comprobación y corrección de memorandos si es necesario (se utiliza para recuperar los memorandos dañados). <br><br>![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) Observación: Antes de reindexar los memos, tiene la posibilidad de comprobar el estado de los memos a través de [&lt;Fuente&gt;.CheckMemo](../WDLang4/1000025079.md). |



**`<Progress Bar>: (Nombre de ventana, control o entero opcional)`**



- Nombre de la ventana en la que se mostrará la barra de progreso,

- Nombre de la control Barra de progreso que muestra el progreso de la reindexación,

- Mango de la ventana que muestra la barra de progreso.




**`<Density rate>: (Entero comprendido entre 1 y 100)`**

Índice de densidad de los índices. Esta tasa es set a 60 por Default.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Condiciones de uso
<a name="condiciones_uso_ELTPARAGRAPHE000364"></a>

- **&lt;Fuente&gt;.Index** reindexa un archivo xBase.

- **&lt;Fuente&gt;.Index** reindexa los archivos de un cluster. En ese caso: 

	- La operación de reindexación se realiza en el nodo al que está conectado el usuario. 

	- Sólo se dispone de una reindexación con tiempo de inactividad cero (constante *hBackgroundTask*). 






<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![Lenguaje Externo](https://doc.pcsoft.fr/ext/images/us/LE.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) 

### Reindexación automática
<a name="reindexacion_automatica_ELTPARAGRAPHE000386"></a>

La reindexación de un archivo de datos puede ser necesaria tras la pérdida o alteración del archivo de índice. Se puede implementar una operación de reindexación de automatic para los archivos de datos.

Para llevar a cabo una operación de reindexación de automatic, debe:

- configurar el valor de la [H.AutoIndexingLimit](../WDLang4/3044024.md) variable. 
	De hecho, si el archivo de datos contiene menos que **H.AutoIndexingLimit** registros, la operación de reindexación se realiza automáticamente si se produce un error de índice. 
	La variable H.AutoIndexingLimit es set a 10000 por Default. La operación de reindexación de automatic se desactiva si este Variable es set a 0.

- configurar el valor de la [H.VisibleAutoIndexing](../WDLang4/3044070.md) variable. 
	Si este valor se establece en <u><u><u><u>True</u></u></u></u> (valor por defecto), se muestra una ventana automatic ally mientras no se complete la operación de reindexación de automatic. Esta ventana contiene una barra de progreso que se utiliza para seguir el progreso de la reindexación actual. Esta ventana se puede personalizar. Para obtener más información, consulte [Gestión asistida de errores HFSQL](../WDLang4/3044188.md). 
	Durante la operación de reindexación, las diferentes aplicaciones que utilizan los datos de los archivos (registros de lectura o escritura) se detendrán y/o bloquearán temporalmente hasta el final de la operación de reindexación..
	![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) Si se usa la constante *hBackgroundTask*, la operación de reindexación se realiza en la tarea de Background y las aplicaciones que usan el archivo de datos no se detienen. 




Si se produce un error durante la operación de reindexación automática (error de bloqueo en el archivo de datos o en el registro, por ejemplo), la operación de reindexación automática se detiene y se muestra un índice fatal Error( corrupto). Este modo de funcionamiento es similar al que se utiliza sin la reindexación de automatic.

Observaciones:

- Durante la reindexación de automatic, la operación de reindexación se realiza en modo normal (constante *hNdxNormal*).

- No hay reindexación de automatic para los archivos de datos en formato Hyper File 5.5.

- Si se realiza una reindexación de automatic, las aplicaciones que utilizan los archivos de datos actualmente reindexados se bloquean temporalmente. Aparece un mensaje indicando que el archivo se está actualizando.

- Al final de la operación de reindexación, el contexto actual de HyperFileSQL se restaura automáticamente (excepto si se ha realizado una operación de reindexación con comprobación de memo).



<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) 

### Reindexación "Cero tiempo de inactividad"
<a name="reindexacion_cero_tiempo_inactividad_ELTPARAGRAPHE000439"></a>

Un archivo de datos puede ser reindexado incluso cuando se accede a él por medio de aplicaciones.

Durante la operación de reindexación, las diferentes aplicaciones que utilizan los datos de los archivos (lectura o escritura de registros) se detendrán/bloquearán temporalmente hasta el final de la operación de reindexación..
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) Aparece una ventana que indica que el archivo de datos está actualmente reindexado (también llamado reorganización). Esta ventana se muestra durante toda la operación de reindexación y no se puede cerrar.. Una barra de progreso indica el estado de la operación de reindexación.<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=HF_Reindexation.gif)
 Esta ventana se puede personalizar y/o ocultar. Para obtener más información, consulte [Gestión asistida de errores HFSQL](../WDLang4/3044188.md).

Para evitar efectos intermitentes, la ventana de indexación sólo se muestra si la operación de indexación puede exceder los 2 segundos.. En este caso, esta ventana se muestra después de 0,7 segundos.

**Observación**: no se puede realizar una reindexación "en vivo" si los registros están bloqueados en modo de lectura/escritura en el archivo de datos para reindexar. Si los registros se bloquean sólo en el modo de escritura, la reindexación con tiempo de inactividad cero todavía puede realizarse.
![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) Si se usa la constante *hBackgroundTask*, la operación de reindexación se realiza en la tarea de Background y las aplicaciones que usan el archivo de datos no se detienen. 
<a name="NOTE0_4"></a>


### Cálculo de estadísticas
<a name="calculo_estadisticas_ELTPARAGRAPHE000468"></a>

Las estadísticas se utilizan para optimizar las consultas y los filtros en el archivo de datos. Para estas estadísticas sólo se tienen en cuenta los registros de Active. [&lt;Fuente&gt;.StatCalculate](../WDLang4/1000025064.md) también devuelve los resultados de este cálculo.

**Observación**: Para calcular eficazmente las estadísticas, deben incluirse todos los archivos de datos. Este es el caso de una consulta de varios archivos, por ejemplo.
<a name="NOTE0_5"></a>


### Directorio de archivos temporales
<a name="directorio_archivos_temporales_ELTPARAGRAPHE000485"></a>

Se pueden crear archivos temporales durante la operación de reindexación. Por Default, estos archivos se crean en el directorio temporal de Windows o en el directorio actual si no hay suficiente espacio.

El [H.TemporaryDirectory](../WDLang4/3044381.md) Variable permite configurar el directorio utilizado para guardar estos archivos temporales. Esta Variable se recomienda cuando se reindexan grandes archivos de datos.
![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) El directorio utilizado para almacenar los archivos temporales en el servidor se puede definir: 

- en el archivo [HFConf.INI](../WDLang4/3044345.md). 

- con la función [&lt;Variable Connection&gt;.SetServer](../WDLang4/1000022664.md). 



<a name="NOTE0_6"></a>


### Gestión de conjuntos de caracteres no latinos
<a name="gestion_conjuntos_caracteres_latinos_ELTPARAGRAPHE000516"></a>

Para modificar el carácter set usado para las búsquedas, el ordena:

1. Especifique el carácter set a utilizar con [ChangeCharset](../WDLang1/3054001.md).

2. Reindexar el archivo de datos con **&lt;Fuente&gt;.Index**. Utilice la constante *hChangeCharset* para utilizar el carácter set especificado por [ChangeCharset](../WDLang1/3054001.md).


Para obtener más información, consulte [Gestionar conjuntos de caracteres específicos en los archivos de datos](../WDLang1/3054017.md).
<a name="NOTE0_7"></a>


### Derechos de acceso a el archivo de datos
<a name="derechos_acceso_archivo_datos_ELTPARAGRAPHE000542"></a>

La operación de reindexación provoca la recreación de del archivo de datos en disco. En un sistema de asignación que gestiona los derechos a nivel de fichero (NTFS...), el archivo de datos después de la operación de reindexación tendrá los derechos del directorio al que pertenece.

Antes de la operación de reindexación, si el archivo de datos tenía derechos específicos diferentes de los derechos de la carpeta, deben ser redefinidos en Windows después de la operación de reindexación.
<a name="NOTE0_8"></a>


### Caso especial: Archivos dañados después de un reinicio del ordenador o un error fatal
<a name="caso_especial_archivos_danados_despues_reinicio_del_ordenador_error_fatal_ELTPARAGRAPHE000554"></a>

Los archivos de datos pueden corromperse cuando el equipo se reinicia inesperadamente. En este caso, los archivos de datos contienen datos no válidos (caracteres ilegibles, por ejemplo).. Para solucionar este problema:

1. Realice una reindexación con borrado.

2. Liberar los registros en transacción con [&lt;Fuente&gt;.TransactionFree](../WDLang4/1000025074.md).

3. Elimine los registros incorrectos con WDMAP.




<a name="XComponent"></a>

## Componente:
wd280hf.dll
