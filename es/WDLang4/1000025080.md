


## &lt;Fuente&gt;.CheckStructure (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Define el modo de comparación de archivos de datos. Esta comparison se realiza cuando se abren los archivos de datos.

Se comparan:

- la estructura del archivo de datos HFSQL descrito en el análisis,

- la estructura real del archivo de datos físicos HFSQL.




Por Default, estas dos estructuras deben ser estrictamente idénticas para poder manipular el archivo de datos.

Dependiendo del modo seleccionado, puede ocurrir un error de WLanguage si se encuentran estructuras incompatibles.. En este caso, debe aplicar la modificación de los archivos de datos de automatic.

**Observación**: El description utilizado por la aplicación siempre corresponde al description del archivo físico HFSQL.

![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta función sólo está disponible para los archivos de datos HFSQL. No está disponible para los archivos de datos a los que accede con JDBC. 
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Allows the opening of "Customer" data file
// Even if the structures are different
Customer.CheckStructure(hNoCheck)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = <Source>.CheckStructure(<Management mode>)`
---

**`<Result>: (Constante de tipo Integer)`**

Anterior modo de gestión de la descripción (antes de utilizar la función **&lt;Fuente&gt;.CheckStructure**).

**`<Source>: (Tipo de fuente especificada)`**

Nombre del archivo de datos utilizado.

**`<Management mode>: (Constante de tipo Integer)`**

Modo de gestión seleccionado:


|   |   |
| --- | --- |
| *hCompatible*<br>(valor predeterminado) | Las estructuras de los ficheros de datos deben ser compatibles. Si se realiza una de las siguientes operaciones, las estructuras se consideran incompatibles:<br><br>- Añadiendo un elemento clave único (excepto un identificador automatic).<br><br>- Cambiar una llave con duplicados a una llave única.<br><br>- Borrar o renombrar un elemento.<br><br>- Cambiar el tipo de un elemento (excepto cambiar de texto a texto Unicode).<br><br>- Reducir el tamaño del artículo.<br><br>- Reducir la parte entera o la parte decimal de un ítem Numérico.<br><br>- Una posición se convierte en una posición no clave.<br><br>- Eliminación de un índice de texto completo.<br><br>- Adición o eliminación de elementos a/desde un índice de texto completo (sin embargo, la creación de un nuevo elemento de texto completo es compatible).<br><br><br> |
| *hIdentical*<br> | Las estructuras deben ser estrictamente idénticas. |
| *hNoCheck* | No se realiza ninguna comprobación, el análisis description puede diferir del description del archivo físico. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Consejos
<a name="consejos_ELTPARAGRAPHE000274"></a>

**&lt;Fuente&gt;.CheckStructure** debe utilizarse: 

- antes de establecer la conexión para evitar las llamadas al servidor. 

- antes de abrir los archivos de datos.



<a name="NOTE0_2"></a>


### hCompatible: condiciones para considerar que las estructuras son incompatibles
<a name="hcompatible_condiciones_para_considerar_que_las_estructuras_son_incompatibles_ELTPARAGRAPHE000289"></a>

Si existe una de las siguientes diferencias entre el archivo description de datos encontrado en el análisis y el description del archivo de datos guardado en el archivo físico, las estructuras son consideradas como incompatibles por el motor HFSQL: se requiere una modificación de automatic.


|   |   |   |
| --- | --- | --- |
| **Estructura en el análisis** | **Estructura leída en el archivo de datos físico** | **Posible consecuencia** |
| - Identificador de automatic<br>o<br>- clave con duplicados<br>o<br>- artículo no clave | Clave única y no el identificador de automatic | Un error de duplicación puede ocurrir cuando se añade un Record. <br><br><br>Observación: No habrá ningún problema si sólo se realizan operaciones de lectura en el archivo de datos. |
| Mediante la posición "XXX | La posición "XXX" no existe | Añadir un valor para un artículo que no existe en el fichero físico. |
| Se ha cambiado el nombre del elemento "XXX". |
| Diferente tipo de artículo | Conversión no válida al asignar el valor al artículo.<br>Valor asignado a la posición truncada. <br><br>Cambio de modo de funcionamiento: <br><br>- Sólo búsqueda por coincidencia exacta<br><br>- La búsqueda realizada en el número de Record<br><br><br> |
| Diferentes tamaños de artículo |
| Campo clave | Posición no clave |


<a name="NOTE0_3"></a>


### Limitación
<a name="limitacion_ELTPARAGRAPHE000352"></a>

Esta función no está disponible cuando se utiliza una base de datos a través de .

<a name="XComponent"></a>

## Componente:
wd280hf.dll
