


## &lt;Fuente&gt;.DeclareExternal (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Importa temporalmente la descripción de un archivo de datos en el análisis actual a partir de un archivo de datos HFSQL existente. El archivo de datos se abre. Para dejar de utilizar este archivo description, llame a [&lt;Fuente&gt;.CancelDeclaration](../WDLang4/1000024192.md).


<a name="XSYNTAX"></a>
<a name="SYNTAX2"></a>

## Sintaxis
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 
### Usar un acceso OLE DB, un Conector Nativo, HFSQL Client/Server o una conexión existente

`<Result> = <Source>.DeclareExternal(<Alias> , <Connection>)`
---

**`<Result>: (Booleano)`**



- <u><u><u><u>True</u></u></u></u> si se realizó la operación,

- <u><u><u><u>False</u></u></u></u> si se produce un problema. La función [HErrorInfo](../WDLang4/3044071.md) permite identificar el error.




**`<Source>: (Tipo de fuente especificada)`**

Nombre del archivo de datos en la base de datos externa.
![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) Este parámetro corresponde al nombre físico del archivo de datos, relativo a la base de datos (extensión incluida). Ejemplo: "myfile.fic" (o si la base de datos tiene subdirectorios: ".\\directorio\\miarchivo.fic"). 
Si el archivo de datos está protegido con una contraseña, esta se debe especificar con la función [&lt;Fuente&gt;.Password](../WDLang4/1000025044.md) antes de utilizar **&lt;Fuente&gt;.DeclareExternal**.

**`<Alias>: (Cadena de caracteres)`**

Nombre lógico del archivo de datos. Este nombre se usará para manipular el archivo de datos en la aplicación actual. El nombre también puede corresponder a una variable de tipo Data Source.

**`<Connection>: (Cadena de caracteres)`**

Conexión a una base de datos. Esta conexión se ha definido en el editor de análisis o se ha descrito programáticamente con el [HDescribeConnection](../WDLang4/3044205.md).




<a name="SYNTAX3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 
### Usar un acceso OLE DB o un Conector Nativo

`<Result> = <Source>.DeclareExternal(<Alias> , <User> [, <Password> [, <Data source> [, <OLE DB provider or Native Connector> [, <Access>]]]])`
---

**`<Result>: (Booleano)`**



- <u><u><u><u>True</u></u></u></u> si se realizó la operación,

- <u><u><u><u>False</u></u></u></u> si se produce un problema. La función [HErrorInfo](../WDLang4/3044071.md) permite identificar el error.




**`<Source>: (Tipo de fuente especificada)`**

Nombre del archivo de datos en la base de datos externa.

**`<Alias>: (Cadena de caracteres)`**

Nombre lógico del archivo de datos. Este nombre se usará para manipular el archivo de datos en la aplicación actual.

**`<User>: (Cadena de caracteres)`**

Nombre del usuario de la fuente de datos.

**`<Password>: (Cadena de caracteres opcional)`**

Contraseña del archivo de datos a abrir (si existe una contraseña).

**`<Data source>: (Cadena de caracteres opcional)`**

Ruta completa de la fuente de datos.

**`<OLE DB provider or Native Connector>: (Cadena de caracteres opcional)`**

Nombre del proveedor de OLE DB o una de las siguientes constantes:


|   |   |
| --- | --- |
| *hNativeAccessAS400* | Conector Nativo AS/400 (módulo opcional) |
| *hNativeAccessDB2* | Conector Nativo DB2 (módulo opcional) |
| *hNativeAccessInformix* | Conector Nativo Informix (módulo opcional) |
| *hNativeAccessMariaDB* | Conector Nativo MariaDB (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessMySQL* | Conector Nativo MySQL (módulo opcional) |
| *hNativeAccessOracle* | Conector Nativo Oracle (módulo opcional) |
| *hNativeAccessPostgreSQL* | Conector Nativo PostgreSQL (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessProgress* | Conector Nativo Progress (módulo opcional) |
| *hNativeAccessSQLAzure* | Conector Nativo SQL Azure (módulo opcional, viene con el Conector Nativo SQL Server) |
| *hNativeAccessSQLite* | Conector Nativo SQLite |
| *hNativeAccessSQLServer* | Conector Nativo SQL Server (módulo opcional) |
| *hNativeAccessSybase* | Conector Nativo Sybase (módulo opcional) |
| *hNativeAccessXBase* | Conector Nativo xBase |
| *hNativeAccessXML* | Conector Nativo XML |
| *hODBC* | Proveedor OLE DB para ODBC. Le permite acceder a una fuente ODBC declarada en las fuentes de datos ODBC de Windows. |
| *hOledbAccess97* | Proveedor OLE DB para Access 97 |
| *hOledbAccess2000* | Proveedor OLE DB para Access 2000 |
| *hOledbAccess2007* | Proveedor OLE DB para Access 2007 |
| *hOledbAccess2010* | Proveedor OLE DB para Access 2010 |
| *hOledbDBase5* | Proveedor OLE DB para dBase 5 |
| *hOledbExcel2000* | Proveedor OLE DB para Excel 2000 |
| *hOledbExcel2007* | Proveedor OLE DB para Excel 2007 |
| *hOledbExcel97* | Proveedor OLE DB para Excel 97 |
| *hOledbLotus4* | Proveedor OLE DB para Lotus 4 |
| *hOledbOracle* | Proveedor OLE DB para Oracle |
| *hOledbSQLServer* | Proveedor OLE DB para SQL Server |

Atención: Para utilizar una conexión OLE DB, es necesario: 


- instalar MDAC versión 2.6 o posterior (instalación realizada con WINDEV/WEBDEV, al crear la versión cliente)

- instalar el proveedor OLE DB que corresponde a la base de datos utilizada.




**`<Access>: (Constante opcional)`**

Configura el tipo de acceso al archivo de datos.


|   |   |
| --- | --- |
| *hORead* | Se puede acceder al archivo de datos en modo de solo lectura. Solo se pueden leer registros. No se pueden agregar o eliminar. |
| *hOReadWrite*<br>(valor predeterminado) | Se puede acceder al archivo de datos en modo de lectura y escritura. Se pueden leer y escribir nuevos registros. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


- Todas las funciones HFSQL se pueden utilizar en el archivo de datos importado, excepto la gestión de la integridad.

- Se pueden importar tantas descripciones como sea necesario.

- Esta función se puede utilizar con archivos de datos en formato XML.

- La primera sintaxis de esta función no se puede utilizar durante un acceso a una base de datos a través del .

- Para utilizar la función **&lt;Fuente&gt;.DeclareExternal** en un procedimiento almacenado:

	- se debe especificar la ruta relativa del archivo de datos con respecto al directorio de la base de datos que contiene el procedimiento almacenado. La ruta debe incluir el nombre y la extensión del archivo de datos.

	- no se debe utilizar ninguna conexión: se utilizará la base de datos en la que se encuentra el procedimiento almacenado.




- Por defecto, si el proyecto actual:

	- está asociado a un análisis, el modo bloqueo aplicado a los archivos de datos es el modo de usuarios múltiples (los archivos no se bloquean cuando se abren y las otras aplicaciones pueden acceder a ellos).

	- no está asociado a un análisis, el modo de bloqueo aplicado a los archivos de datos es el modo de usuario único: los archivos se bloquean en modo de lectura y escritura tan pronto como se abren. Este modo impide que otras aplicaciones accedan a los archivos que ya han sido abiertos por la aplicación actual.







<a name="XComponent"></a>

## Componente:
wd280hf.dll
