


## HModify (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Modifica el registro especificado o el que esta en la memoria en el archivo de datos (consulta o vista). Los índices que corresponden a las claves utilizadas en la archivo de datos se actualizan automáticamente. Los memos se añaden (si es necesario) si la gestión de los memos está activada ([HSetMemo](../WDLang4/3044139.md).

Tras la llamada a **HModify**:

- se recomienda configurar la gestión de errores:
	![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) WINDEV propone una gestión de errores automatic para los siguientes tipos de errores: Error de duplicados, error de integridad, error de contraseña, error de conflicto de modificación, error de estado durante el conflicto de modificación y error de bloqueo. Para obtener más información, consulte [Gestión asistida de errores HFSQL](../WDLang4/3044188.md).
	

- si la gestión de duplicados está activada y el archivo de datos contiene una clave única, la función [HErrorDuplicates](../WDLang4/3044077.md) devuelve <u><u><u>True</u></u></u> si el valor de la clave modificada no es único. El Record no se modifica.

- si se produce un problema de bloqueo (intentar modificar un registro bloqueado), la función [HErrorLock](../WDLang4/3044099.md) devuelve <u><u><u>True</u></u></u> y el registro no se modifica.
	
	![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: La gestión de las cerraduras no está disponible para las bases de datos a las que accede el JDBC. 

- el número del actual Record no se modifica. Por Default, la iteración actual no se ve afectada.




**Observación**: Esta función puede ser usada en un archivo de datos, una vista HFSQL o una consulta.


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000003044042&name=hmodify_funcion&product=WD">Ver ejemplos adicionales</a>

```wl
// Finds the record
HReadSeekFirst(Customer, Name, "Smith")

IF HFound() = True THEN
	// Modify a record in a data file
	// (record described through programming)
	Customer.FirstName = "Vince"
	Customer.City = "San Francisco"
	Customer.Zip = "94102"
	Customer.Country = "USA"
	HModify(Customer)
END
```
<a name="Example2"></a>

```wl
// Modify current record of "Customer"
// displayed in a window
ScreenToFile() 
HModify(Customer)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = HModify([<Data file> [, <Record number> [, <Options>]]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se modificó el registro,

- <u><u><u><u>False</u></u></u></u> si se produce un problema (error de integridad, duplicados, etc.): el Record no se modifica. La función [HError](../WDLang4/3044088.md) permite identificar el error.




**`<Data file>: (Cadena de caracteres opcional)`**

Nombre del archivo de datos, vista HFSQL o consulta utilizada. Si no se especifica este nombre, la función **HModify** utilizará el último archivo de datos utilizado por la última función HFSQL (que empieza por "H").

**`<Record number>: (Entero opcional)`**

Número de la Record a modificar. El Record cargado en la memoria se reescribe en el Record especificado. 
Si este número es mayor que el número total de registros en el archivo de datos, se crearán registros intermedios borrados para que la lectura secuencial del archivo de datos ([HRead](../WDLang4/3044047.md)) sea coherente. 

Si no se especifica este parámetro (igual a 0 o a la constante *hCurrentRecNum*), **HModify** modificará el registro actual en el archivo de datos.

**PRECAUCIÓN: No confundir el número de Record con el identificador automático asociado al Record**. En la mayoría de los casos, estos dos números no son idénticos. El número Record es devuelto por [HRecNum](../WDLang4/3044063.md). 

Para utilizar el parámetro &lt;Opciones&gt;, se debe especificar el parámetro &lt;Número de registro&gt;.
               
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Este parámetro no se tiene en cuenta.   
![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Este parámetro debe corresponder al número del registro activo (constante *hCurrentRecNum*).![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Este parámetro debe corresponder al número del registro activo (constante *hCurrentRecNum*). 

**`<Options>: (Constante opcional)`**

Configura:

- el efecto de la modificación en la iteración actual,

- el modo de cálculo del identificador automático, 

- el modo de bloqueo aplicado a la Record modificada. Si no se especifica ninguna constante de bloqueo, la Record modificada se desbloquea.
	
	![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: La gestión de las cerraduras no está disponible para las bases de datos a las que accede el JDBC.




- la gestión de duplicados, 

- la gestión de la integridad.              


Observación: Para usar este parámetro, &lt;Record número&gt; debe ser necesariamente especificado.
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Este parámetro no se tiene en cuenta.


|   |   |
| --- | --- |
| *hAffectBrowse* | **Efecto de la modificación en la iteración**: La modificación afecta a la iteración. <br>Por ejemplo, al utilizar la función [HReadNext](../WDLang4/3044037.md) después de la función **HModify**, se establece la posición en el registro que se encuentra después del registro modificado (teniendo en cuenta los nuevos valores).<br><br>ATENCIÓN: En todos los casos (utilizando o no la constante *hAffectBrowse*): si se utiliza **HModify** en una iteración y el valor del elemento de navegación cambia, **el record actual puede volver a leerse en el resto de la iteración**. Al modificar el elemento de exploración se actualiza la clave del índice del archivo. Esta modificación se tiene en cuenta al leer los siguientes registros. <br><br>La constante *hAffectBrowse* tiene prioridad sobre la constante *hWriteDefault*. |
| *hCheckDuplicates* | **Modo de gestión de duplicados**: Verifica los duplicados en esta operación, incluso si la verificación de duplicados está desactivada (función [HSetDuplicates](../WDLang4/3044057.md)).<br>Si se utilizan las constantes *hIgnoreDuplicates* y *hCheckDuplicates* al mismo tiempo, se produce un error WLanguage.<br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hCheckIntegrity* | **Modo de gestión de la integridad**: Verifica la integridad de la operación, incluso si la verificación automática de la integridad está desactivada (función [HSetIntegrity](../WDLang4/3044058.md)).<br>Si se utilizan las constantes *hIgnoreIntegrity* y *hCheckIntegrity* al mismo tiempo, se produce un error WLanguage.<br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hFalsifyTimestamp* | **Gestión de los elementos de la marca de tiempo**: Por defecto, un elemento Timestamp contiene la fecha y la hora de creación/modificación de la Record. Esta fecha/hora se calcula automáticamente. <br>Esta constante impide que se actualice el elemento Timestamp: se mantendrá el último valor de la Record. |
| *hForceIdAuto* | **Modo de cálculo del identificador automático**: El identificador automático no se calcula al agregar registros. El identificador corresponde a:<br><br>- el valor asignado al elemento mediante programación (por ejemplo, CUSTOMERID = 7)<br><br>- el valor predeterminado del identificador que se especificó en el editor de análisis (si el archivo de datos acaba de abrirse, sin que se haya leído ningún registro)<br><br>- el valor del identificador en la memoria (valor del identificador del último registro leído en el archivo de datos).<br><br><br>Después de agregar el registro, se calculará el siguiente identificador automático calculado por el motor HFSQL, sin tener en cuenta el valor agregado con *hForceIdAuto*.<br>Si se utilizan las constantes *hSetIdAuto* y *hForceIdAuto* al mismo tiempo, se produce un error WLanguage. |
| *hIgnoreDuplicates* | **Modo de gestión de duplicados**: No comprueba la existencia de duplicados para esta operación, incluso si la verificación automática de duplicados está activada (función [HSetDuplicates](../WDLang4/3044057.md)).<br>Si se utilizan las constantes *hIgnoreDuplicates* y *hCheckDuplicates* al mismo tiempo, se produce un error WLanguage.<br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hIgnoreIntegrity* | **Modo de gestión de la integridad**: Ignora la verificación de la integridad en esta operación, incluso si la verificación automática de la integridad está activada (función [HSetIntegrity](../WDLang4/3044058.md)).<br>Si se utilizan las constantes *hIgnoreIntegrity* y *hCheckIntegrity* al mismo tiempo, se produce un error WLanguage.<br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hLockNo*<br> (valor predeterminado) | **LModo de bloqueo de Record** modificado: Sin bloqeuo: el Record modificado no se bloqueará.<br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hLockReadWrite* | **LModo de bloqueo de Record** modificado: Bloqueo de lectura/escritura: el Record modificado será bloqueado en lectura/escritura. Este registro no puede ser leído ni modificado por otras aplicaciones. Solo la aplicación actual puede modificarlo, leerlo o desbloquearlo.<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hLockWrite* | **LModo de bloqueo de Record** modificado: Bloqueo de escritura: el Record modificado se bloqueará en modo de escritura. Otras aplicaciones pueden leer el registro pero no modificarlo. Solo la aplicación en curso podrá modificarlo o desbloquearlo.<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hRecalculateIdAuto* | **Modo de cálculo del identificador automático**: El identificador automático del Record será recalculado durante la operación de escritura. Esta constante tiene prioridad sobre las constantes *hForceIdAuto* y *hSetIdAuto*.<br> |
| *hSetIdAuto* | **Modo de cálculo del identificador automático**: El identificador automático no se calcula al agregar registros: el valor del identificador será el que se almacena al agregar un registro. <br>El siguiente valor del identificador calculado por el motor HFSQL corresponderá al valor más grande del identificador en el archivo +1.<br>Si se utilizan las constantes *hSetIdAuto* y *hForceIdAuto* al mismo tiempo, se produce un error WLanguage. |
| *hWriteDefault*<br>(valor predeterminado) | **Efecto de la modificación en la iteración**: La modificación no afecta a la iteración actual. <br>Por ejemplo, al utilizar la función [HReadNext](../WDLang4/3044037.md) después de la función **HModify**, se establece la posición en el registro que se encuentra después del registro que estaba activo antes de la modificación.<br><br>ATENCIÓN: Si se utiliza **HModify** en una iteración y el valor del elemento de navegación cambia, **el Record actual puede ser leído de nuevo en el resto de la iteración**. Al modificar el elemento de exploración se actualiza la clave del índice del archivo. Esta modificación se tiene en cuenta al leer los siguientes registros. <br><br>La constante *hAffectBrowse* tiene prioridad sobre la constante *hWriteDefault*. |

![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Las posiciones de texto se rellenan automáticamente con caracteres de espacio.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Lenguaje Externo](https://doc.pcsoft.fr/ext/images/us/LE.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Procedimientos almacenados](https://doc.pcsoft.fr/ext/images/us/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) 

### Gestión de los identificadores de automatic
<a name="gestion_los_identificadores_automatic_ELTPARAGRAPHE000407"></a>

Por defecto, **HModify** no cambia el identificador automatic cuando se utiliza en un Record activo o cruzado (incluso si el identificador automatic fue asignado en el código): se reutiliza el identificador automatic en el archivo de datos.

Las constantes *hForceIdAuto* y *hSetIdAuto* permiten modificar el comportamiento predeterminado del identificador automático.

Para obtener más información, consulte [Gestionar el identificador automatic durante una modificación](../WDLang4/3044183.md).
![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

- *Si la base de datos genera un identificador automatic*, el motor HFSQL mantiene este valor. Si se especifica la constante *hForceIDAuto* o *hSetIDAuto*, el motor HFSQL sustituye el valor generado por el valor deseado.
	**Observación**: la constante *hForceIdAuto* equivale a *hSetIdAuto*: el identificador automatic calculado por HFSQL durante la próxima adición será único en el archivo de datos. 

- *Si la base de datos* no genera ningún identificador de automatic, el motor HFSQL genera el valor y lo asigna al identificador automatic.



<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Lenguaje Externo](https://doc.pcsoft.fr/ext/images/us/LE.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Procedimientos almacenados](https://doc.pcsoft.fr/ext/images/us/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) 

### Modificación de los registros borrados o cruzados
<a name="modificacion_los_registros_borrados_cruzados_ELTPARAGRAPHE000433"></a>

Modificar un Record cruzado o un Record borrado habilita de nuevo el Record.
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Lenguaje Externo](https://doc.pcsoft.fr/ext/images/us/LE.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Procedimientos almacenados](https://doc.pcsoft.fr/ext/images/us/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) 

### Conflicto de modificación o de borrado
<a name="conflicto_modificacion_borrado_ELTPARAGRAPHE000444"></a>

Los errores de conflicto de modificación o borrado sólo aparecen si se utiliza **HModify** en el actual Record. Si se especifica un número de Record, no puede haber conflicto, ya que la Record no fue leída antes de la modificación.

Para obtener más información, consulte [Gestión asistida de errores HFSQL](../WDLang4/3044188.md).
<a name="NOTE0_4"></a>


### Gestión de duplicados e integridad
<a name="gestion_duplicados_integridad_ELTPARAGRAPHE000460"></a>

Las comprobaciones de integridad y duplicación se realizan sobre las claves para las que:

- se habilita una comprobación, 
	
	y

- el valor del artículo se modifica en relación con el Record que se encuentra en el archivo de datos.




Ejemplo:

```wl
...
Customer.LastName = "TUBE"
Customer.FirstName = "Milo"
HAdd(Customer)    // integrity and duplicate check performed on 
				// LastName and FirstName if active management
Customer.FirstName = "Mark"
HModify(Customer)   // integrity and duplicate check performed on 
				// FirstName only if active management
...
```

<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Procedimientos almacenados](https://doc.pcsoft.fr/ext/images/us/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) 

### La versión del archivo de datos después de una modificación
<a name="version_del_archivo_datos_despues_una_modificacion_ELTPARAGRAPHE000485"></a>

Si el Record fue modificado (sin error de duplicación y sin error de integridad), el número de versión del archivo de datos es modificado. Para get el número de versión, utilice [HVersion](../WDLang4/3044020.md).
<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Procedimientos almacenados](https://doc.pcsoft.fr/ext/images/us/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Gestión de memos binarios
<a name="gestion_memos_binarios_ELTPARAGRAPHE000499"></a>

Cuando se modifica una Record, se modifican los memos si es necesario (si la gestión de los memos está habilitada por [HSetMemo](../WDLang4/3044139.md)). 
Recordatorio: para inicializar un elemento de memoria binario, utilice [HLinkMemo](../WDLang4/3044173.md).
<a name="NOTE0_7"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Procedimientos almacenados](https://doc.pcsoft.fr/ext/images/us/PS.png) 

### Modificación de una Record seleccionada en una consulta
<a name="modificacion_una_record_seleccionada_una_consulta_ELTPARAGRAPHE000518"></a>

Se puede realizar la modificación de una Record en una consulta:

- en el resultado de la consulta

- en los archivos de datos tratados por la consulta (*hModifyFile* constante utilizada en [HExecuteQuery](../WDLang4/3044080.md) o [HExecuteSQLQuery](../WDLang4/3044084.md)). En este caso, la constante *hWithFilter* se selecciona automáticamente.


Es necesario distinguir dos casos, dependiendo del modo de ejecución de la consulta (con o sin la constante *hWithFilter*).


|   |   |
| --- | --- |
| Ejecución de la consulta con la constante *hWithFilter* | <br><br>- Sólo se permite la modificación de la actual Record.<br><br>- Si se ejecuta la función para modificar una consulta basada en varios ficheros de datos, la modificación se aplica a los ficheros de datos de relacionado.<br><br>- Se produce un error de WLanguage cuando se modifica el contenido de un elemento calculado.. El contenido de estos artículos se calcula automáticamente al modificar el Record.<br><br><br> |
| Ejecución de la consulta sin la constante *hWithFilter* | <br><br>- Si se ejecuta la función para modificar una consulta basada en varios ficheros de datos, la modificación se aplica a los ficheros de datos de relacionado.<br><br>- Si el Record modificado ya no corresponde a la selección de la consulta, el Record seguirá encontrándose en el resultado de la consulta<br><br>- Se produce un error de WLanguage cuando se modifica el contenido de un elemento calculado.. El contenido de estos artículos se calcula automáticamente al modificar el Record.<br><br><br> |

Atención:

- No se permite ninguna modificación en una consulta que utilice grupos o agregados.

- La gestión de la integridad y de los duplicados no se realiza durante las operaciones en las consultas multiarchivo.: se recomienda utilizar las transacciones para evitar cualquier problema.



<a name="NOTE0_8"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Procedimientos almacenados](https://doc.pcsoft.fr/ext/images/us/PS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Modificación y bucle de una Record
<a name="modificacion_bucle_una_record_ELTPARAGRAPHE000558"></a>

Si la modificación se realiza durante una iteración, la Record modificada será Visible sólo en la iteración actual. Si se han definido otras iteraciones en esta base de datos, la Record modificada será Visible una vez que se hayan reiniciado estas iteraciones. 

La utilización de la constante *hAffectBrowse STRIMEULB* ralentiza la modificación porque se actualiza la consulta o tabla.

ATENCIÓN: Si se utiliza **HModify** en una iteración y el valor del elemento de navegación cambia, **el Record actual puede ser leído de nuevo en el resto de la iteración**. Al modificar el elemento de exploración se actualiza la clave del índice del archivo. Esta modificación se tiene en cuenta al leer los siguientes registros. 
<a name="NOTE0_9"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### xBase
<a name="xbase_ELTPARAGRAPHE000575"></a>

[HDelete](../WDLang4/3044018.md) y [HCross](../WDLang4/3044121.md) tienen el mismo efecto: el Record se cruza pero no se borra. Por lo tanto, la Record puede volver a activarse mediante **HModify**. En este caso, la función [HState](../WDLang4/3044081.md) devuelve la constante *hStateCrossed* en un registro eliminado (y no la constante *hStateDel*).

<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Lógica de negocio
## Componente:
wd280hf.dll
