


## &lt;Fuente&gt;.StatCalculate (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Realiza varios cálculos estadísticos en las claves de un archivo de datos.
Esta función es equivalente a la función [HAccelerateSpeed](../WDLang4/1000019375.md). Estas estadísticas se utilizan al implementar un filtro, crear una consulta o crear una vista en el archivo de datos. El motor HFSQL analiza la condición de selección y luego utiliza estas estadísticas para definir los elementos más discriminantes que se utilizarán para optimizar las iteraciones en los archivos de datos.

Las estadísticas se utilizan para get información sobre el contenido del archivo de datos cuando se calculan. Por lo tanto, cuanto más modificaciones se realizan en el archivo después de este cálculo, menos estas estadísticas representan el contenido de True del archivo de datos. Cuanto más Record s el archivo de datos contiene, menos la modificación de un solo Record impacta las estadísticas generales.

**Atención**: **&lt;Fuente&gt;.StatCalculate** impide escribir en el archivo de datos durante el cálculo de las estadísticas (se realiza una iteración para cada clave en el archivo de datos).
![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) Las estadísticas pueden ser calculadas en la tarea de Background sin bloquear el archivo de datos en modo de escritura. 

**Observación**: Para que el cálculo estadístico sea eficiente, este cálculo debe realizarse en todos los archivos de datos (para una consulta de varios archivos, por ejemplo).


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Statistics on the CustName key of the Customer data file
Customer.StatCalculate(CustName)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = <Source>.StatCalculate([<Key item> [, <Option>]])`
---

**`<Result>: (Booleano)`**



- <u><u><u><u>True</u></u></u></u> si se realizó el cálculo,

- <u><u><u><u>False</u></u></u></u> si se produce un problema (archivo de datos bloqueado por una aplicación, por ejemplo). La función [HError](../WDLang4/3044088.md) permite identificar el error.




**`<Source>: (Tipo de fuente especificada)`**

Nombre del archivo de datos utilizado. 
Atención: Este archivo de datos no debe ser bloqueado por una aplicación.

**`<Key item>: (Cadena de caracteres opcional)`**

Nombre del elemento clave utilizado para calcular las estadísticas. Si no se especifica este nombre o si es igual a "\*", las estadísticas se calcularán para todos los elementos clave que se encuentran en el archivo de datos.

**`<Option>: (Constante de tipo Integer)`**

Opción para el cálculo de las estadísticas. 

- Si no se especifica este parámetro, el cálculo de las estadísticas bloquea a el archivo de datos en modo de escritura. 

- Si este parámetro corresponde a la constante *hBackgroundTask*, las estadísticas se calculan en la tarea Background, sin bloquear el archivo de datos. 


**Importante**: Este parámetro se tiene en cuenta para los ficheros HFSQL Client/Server. En los otros casos, el archivo de datos se bloquea automáticamente mientras se calculan las estadísticas. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


- **&lt;Fuente&gt;.StatCalculate** no cierra el archivo de datos.

- Las estadísticas también pueden ser actualizadas por [&lt;Fuente&gt;.Index](../WDLang4/1000025060.md). Las funciones [&lt;Fuente&gt;.Index](../WDLang4/1000025060.md) y **&lt;Fuente&gt;.StatCalculate** son las dos únicas funciones que permiten actualizar las estadísticas del archivo de datos.

- En los ficheros de datos HFSQL Classic o Cliente/Servidor, el cálculo estadístico sólo puede realizarse sobre las partidas clave.

- La sintaxis **&lt;Fuente&gt;.StatCalculate**(&lt;Archivo de datos&gt;) equivale a **&lt;Fuente&gt;.StatCalculate**(&lt;Archivo de datos&gt;, "\*")

- Para utilizar la función **&lt;Fuente&gt;.StatCalculate** con los archivos de datos de un clúster HFSQL, el parámetro &lt;Opción&gt; debe corresponder a la constante *hBackgroundTask* para no bloquear el clúster. 




<a name="XComponent"></a>

## Componente:
wd280hf.dll
