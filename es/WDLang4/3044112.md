


## HPrevious (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Establece la posición en el registro anterior del archivo de datos de acuerdo con un elemento de navegación. **TEl Record no se lee**.

El número de la Record actual se modifica sólo cuando es devuelto por [HRecNum](../WDLang4/3044063.md). Para las funciones que manipular el número actual de Record ([HDelete](../WDLang4/3044018.md), [HRead](../WDLang4/3044047.md), [HModify](../WDLang4/3044042.md), etc.), el valor de este número no se actualiza: se debe utilizar la función [HRecNum](../WDLang4/3044063.md)(). Por ejemplo: no hacer: 

```wl
HDelete(Customer)
```
 pero 

```wl
HDelete(Customer, HRecNum())
```
 Los valores de la posición de búsqueda se leen en orden ascendente (ver Observaciones para más detalles).

**Atención**: ***El registro cargado en memoria no se modifica***. Las variables HFSQL (por ejemplo, Cliente.Nombre, es decir el elemento *Nombre* del archivo *Cliente*) no se actualizan.

En la mayoría de los casos, **HPrevious** establece la posición en el archivo de datos para recorrer los registros que coinciden con una condición. [HNext](../WDLang4/3044027.md) se utiliza para posicionarse en el siguiente Record correspondiente a la condición.

Después de llamar a la función **HPrevious**, se pueden producir los siguientes casos:

- se encontró un registro que corresponde a la condición: [HFound](../WDLang4/3044104.md) devuelve <u><u><u>True</u></u></u>

- el archivo de datos está vacía o no hay Record correspondiente a la condición: [HOut](../WDLang4/3044094.md) devuelve <u><u><u>True</u></u></u>




**Observaciones**: 

- Mediante Default, [HSeekFirst](../WDLang4/3044125.md) y [HSeekLast](../WDLang4/3044129.md) se realiza una búsqueda de coincidencia exacta.

- Mediante Default, **HPrevious** se realiza una búsqueda genérica.





Los valores de la posición de búsqueda se leen en orden descendente (véase [observaciones](#NOTE0_1) para más detalles).

**Atención**: ***El Record cargado en la memoria no está modificado***. Las variables HFSQL (por ejemplo, Cliente.Nombre, es decir el elemento *Nombre* del archivo *Cliente*) no se actualizan.

En la mayoría de los casos, **HPrevious** se utiliza para posicionar en el archivo de datos durante un bucle de navegación.

Tras la llamada a **HPrevious**pueden darse varios casos:

- el archivo de datos está vacía o ningún record corresponde al filtro (definido por [HFilter](../WDLang4/3044100.md)): [HOut](../WDLang4/3044094.md) devuelve <u><u><u>True</u></u></u>.

- la función intenta bloquear un registro ya bloqueado en modo de lectura: [HErrorLock](../WDLang4/3044099.md) devuelve <u><u><u>True</u></u></u> y [HOut](../WDLang4/3044094.md) devuelve <u><u><u>True</u></u></u>.
	![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: La gestión de las cerraduras no está disponible para las bases de datos a las que accede el JDBC. 



<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
HLast(Customer, Name)
WHILE HOut() = False
	// Process the record
	HPrevious(Customer, Name)
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = HPrevious([<Data file> [, <Search key item>] [, <Options>]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si el puesto era set,

- <u><u><u><u>False</u></u></u></u> si se produce un error. Este problema puede ser causado por:

	- un problema de posicionamiento (archivo de datos vacío, ...): [HFound](../WDLang4/3044104.md) devuelve <u><u><u><u>False</u></u></u></u> y [HError](../WDLang4/3044088.md) devuelve 0.

	- un error: [HError](../WDLang4/3044088.md) devuelve un número entero distinto de 0. [HErrorInfo](../WDLang4/3044071.md) devuelve más detalles.







**`<Data file>: (Cadena de caracteres opcional)`**

Nombre del archivo de datos HFSQL utilizado. Si este parámetro corresponde a una cadena vacía, **HPrevious** utilizará el último archivo de datos utilizado por la última función de gestión HFSQL (función que comienza por "H").

**`<Search key item>: (Cadena de caracteres opcional)`**

Nombre del elemento clave utilizado para el bucle de el archivo de datos. Si no se especifica este nombre, **HPrevious** utilizará el último elemento de exploración utilizado en este archivo por la última función de gestión HFSQL (función que empieza por "H"). Si este elemento no existe, se utiliza automáticamente el mejor elemento de navegación.

**`<Options>: (Constante opcional)`**

Configura el bloqueo y la gestión de duplicados realizados en el registro seleccionado con la función **HPrevious**:


|   |   |
| --- | --- |
| *hDistinct* | Si se encuentran duplicados, se utiliza para posicionar en una sola Record entre los duplicados. Este parámetro sólo se tiene en cuenta si la búsqueda se realiza en un elemento clave. <br>Por Default, todos los duplicados son examinados. |
| *hLockNo* | Sin bloqeuo: otras aplicaciones pueden leer o modificar el registro. |
| *hLockReadWrite* | Bloqueo de lectura/escritura: el Record seleccionado no puede ser leído o modificado por otra aplicación. |
| *hLockWrite* | Bloqueo de escritura: el Record seleccionado puede ser leído por otra aplicación pero no puede ser modificado por otra aplicación. |

![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Este parámetro no se tiene en cuenta.![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Las opciones de bloqueo no tendrán efecto si los bloqueos no son soportados por el proveedor OLE DB o por Conector Nativo.![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) Las opciones de bloqueo especificadas en la función **HPrevious** no se tienen en cuenta. El modo de bloqueo especificado por [HFirst](../WDLang4/3044113.md) o [HLast](../WDLang4/3044101.md) seguirá siendo efectivo durante las llamadas a **HPrevious** y [HNext](../WDLang4/3044027.md).

Para modificar el bloqueo de teclas, debe utilizar:

- [HSeekFirst](../WDLang4/3044125.md) o [HSeekLast](../WDLang4/3044129.md).

- [HFirst](../WDLang4/3044113.md) o [HLast](../WDLang4/3044101.md).

- [HLockRecNum](../WDLang4/3044152.md) o [HUnlockRecNum](../WDLang4/3044194.md).


![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Para Conector Nativo Oracle, se puede especificar un modo de bloqueo diferente para cada Record. Sin embargo, si se inició una transacción mediante [SQLTransaction](../WDLang4/3072029.md) antes de establecer el bloqueo, éste sólo se liberará al final de la transacción ([SQLTransaction](../WDLang4/3072029.md) con la constante *sqlCommit* o *sqlRollBack*).![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Las opciones de bloqueo se ignoran. Utilice las funciones de bloqueo ([HLockRecNum](../WDLang4/3044152.md)) conservadas para la compatibilidad con el pasado.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Lectura de la operación según una clave
<a name="lectura_operacion_segun_una_clave_ELTPARAGRAPHE000251"></a>

**HPrevious** establece la posición en el record con el mayor valor de la clave.

El orden de clasificación es el que se especificó en el análisis para esta clave.
<a name="NOTE0_2"></a>


### comparison entre HPrevious y [HReadPrevious](../WDLang4/3044048.md)
<a name="comparison_entre_docparampagetitleshort_hreadpreviouswdlang43044048md_ELTPARAGRAPHE000264"></a>

**HPrevious** no lee el record: por lo tanto, **HPrevious** es más rápido que [HReadPrevious](../WDLang4/3044048.md).
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![Lenguaje Externo](https://doc.pcsoft.fr/ext/images/us/LE.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Procedimientos almacenados](https://doc.pcsoft.fr/ext/images/us/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Varios
<a name="varios_ELTPARAGRAPHE000286"></a>

El número actual de Record es devuelto por [HRecNum](../WDLang4/3044063.md).

[HChangeKey](../WDLang4/3044151.md) se utiliza para modificar la clave de búsqueda mientras se mantiene posicionada en el record actual.
<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![Lenguaje Externo](https://doc.pcsoft.fr/ext/images/us/LE.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Procedimientos almacenados](https://doc.pcsoft.fr/ext/images/us/PS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Bloqueos
<a name="bloqueos_ELTPARAGRAPHE000304"></a>

Por defecto (&lt;Opciones&gt; no especificadas), la Record no está bloqueada.

Si se solicita un bloqueo (constante *hLockWrite* o *hLockReadWrite*), la posición se fijará en el Record sólo si no está ya bloqueado.

<a name="XComponent"></a>

## Componente:
wd280hf.dll
