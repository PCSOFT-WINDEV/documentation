


## HDescribeConnection( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Describe una nueva conexión a una base de datos externa. Esta conexión se llama. Se pueden definir parámetros específicos como el modo de gestión de los cursores (si la base de datos a la que se accede lo permite).

Para asociar esta conexión a una tabla o un archivo de datos, utilice [HChangeConnection](../WDLang4/3044150.md).

Para abrir la conexión, utilice [HOpenConnection](../WDLang4/3044107.md). Si los parámetros de la conexión descrita con **HDescribeConnection** son incorrectos, la función [HOpenConnection](../WDLang4/3044107.md) devolverá un error.

Con **HDescribeConnection** , una descripción de Oracle tabla importada en el análisis puede ser utilizada directamente por los archivos de datos HFSQL Classic. Simplemente describa una conexión temporal a una base de datos HFSQL Classic y asóciela al archivo description desde en el análisis. Vea los Ejemplos para más detalles.

**Esta función se conserva por motivos de compatibilidad con versiones anteriores**. Le recomendamos que utilice una [Conexión Variable y sus propiedades](../WDLang4/1514073.md) para describir una conexión.



<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000003044205&name=hdescribeconnection_funcion&product=WD">Ver ejemplos adicionales</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 
```wl
HDescribeConnection("MyConnection", "", "", ...
	"Server_SQLServer", "dbo", hNativeAccessSQLServer, hOReadWrite, "")
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Describir una conexión a través de la programación

`<Result> = HDescribeConnection(<Connection> , <User> [, <Password>] , <Data source> , <Database> , <OLE DB provider or Native Connector> [, <Access> [, <Extended information>]] , <Additional options>)`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se realizó la operación,

- <u><u><u><u>False</u></u></u></u> si se produce un problema. La función [HErrorInfo](../WDLang4/3044071.md) permite identificar el error. 




Para establecer esta conexión, utilice [HOpenConnection](../WDLang4/3044107.md) (esta función devolverá un error si los parámetros de conexión son incorrectos). 

Para asignar esta conexión a un archivo de datos, utilice [HChangeConnection](../WDLang4/3044150.md).

**`<Connection>: (Cadena de caracteres)`**

Nombre de la nueva conexión a definir. 

Si este nombre ya es utilizado por una conexión existente, la conexión anterior se sustituye por la nueva. La conexión anterior (así como los archivos de datos que la utilizaban) se cierran automáticamente.

**`<User>: (Cadena de caracteres)`**

Nombre de usuario utilizado para la base de datos. Este parámetro es devuelto por la [CtUserName](../Proprietes/2512026.md) Property.

**`<Password>: (Cadena de caracteres opcional)`**

Contraseña de conexión (si existe). Si no se requiere una contraseña, utilice una cadena vacía ("") o la palabra clave NULL.

**`<Data source>: (Cadena de caracteres)`**

Ruta completa de la fuente de datos. La conexión se creará y abrirá para esta fuente de datos. Este parámetro es devuelto por la [CtDatabase](../Proprietes/2512047.md) Property.
![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) XML: Este parámetro corresponde al nombre del archivo XML.![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) Este parámetro corresponde al nombre del servidor. Se puede especificar el número de puerto utilizado por el servidor HFSQL. De forma predeterminada, se utiliza el puerto 4900. Si el número de puerto del servidor HFSQL es diferente, utilice la siguiente notación: 
&lt;Nombre de equipo&gt;: &lt;Número de puerto&gt; 
Ejemplo: "NombreEquipo:4901".
Para un uso a través de Internet, se deben gestionar los puertos con Firewall. Para obtener más información, consulte [Administrar puertos](../WDLang4/3044334.md).
Tienes la capacidad de especificar una Address IPv6 escribiendo la Address IPv6 entre corchetes. En este caso, el número de puerto debe especificarse después del corchete de cierre.. Por ejemplo: [0154:2145:2155::5554]:4900.  
![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: 

- Este parámetro corresponde a la URL para la conexión a la base de datos.

- Dependiendo del controlador JDBC utilizado, se debe especificar el nombre de la base de datos en la URL de conexión.




**`<Database>: (Cadena de caracteres)`**

Nombre de la base de datos que se utilizará en la fuente de datos, cadena vacía ("") si no se debe especificar ningún nombre.. Este parámetro se puede utilizar si la fuente de datos permite especificar la base de datos que se debe utilizar.. 
Por ejemplo, en SQL Server, la base de datos "Maestra" es la base de datos Default pero se pueden manejar otras bases de datos ("dbo" por ejemplo). 
Para especificar que el acceso se realiza sobre un fichero que se encuentra en la base de datos "dbo" (que no es la base de datos Default),  debe corresponder a "dbo".

Este parámetro es devuelto por la [CtInitialCatalog](../Proprietes/2512018.md) Property.

**`<OLE DB provider or Native Connector>: (Cadena de caracteres o constante)`**



- Nombre del proveedor OLE DB utilizado. Para obtener fácilmente la cadena a utilizar, seleccione la opción "Conexión" en el editor de análisis (ver Notas).
	
	o

- una de las siguientes constantes:
	


|   |   |
| --- | --- |
| *hAccessHF7* | Pseudo-conexión a una base de datos HFSQL Classic |
| *hAccessHFClientServer* | Conector Nativo a una base de datos HFSQL Client/Server. |
| *hNativeAccessAS400* | Conector Nativo AS/400 (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessDB2* | Conector Nativo DB2 (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessInformix* | Conector Nativo Informix (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessMariaDB* | Conector Nativo MariaDB (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessMySQL* | Conector Nativo MySQL (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessOracle* | Conector Nativo Oracle (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessOracleLite* | Conector Nativo Oracle (módulo opcional de WINDEV Mobile) |
| *hNativeAccessPostgreSQL* | Conector Nativo PostgreSQL (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessProgress* | Conector Nativo Progress (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessSQLAzure* | Native SQL Azure Connector (módulo opcional de WINDEV/WEBDEV, proporcionado con Conector Nativo SQL Server) |
| *hNativeAccessSQLite* | Conector SQLite nativo (proporcionado con WINDEV/WEBDEV) |
| *hNativeAccessSQLServer* | Conector Nativo SQL Server (módulo opcional de WINDEV/WEBDEV).<br>El antiguo Conector Nativo es usado por Default. Para utilizar el nuevo Conector Nativo SQL Server, utilice el [H.SQLServerMode](../WDLang4/3044276.md) Variable. |
| *hNativeAccessSQLServerMobile* | Native SQL Server Mobile Connector (módulo opcional de WINDEV Mobile) |
| *hNativeAccessSybase* | Conector Nativo Sybase (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessXBase* | Conector nativo xBase (incluido con WINDEV/WEBDEV) |
| *hNativeAccessXML* | Conector XML nativo (incluido con WINDEV/WEBDEV) |
| *hODBC* | Proveedor OLE DB para ODBC (permite acceder a una fuente de datos ODBC declarada en las fuentes de datos ODBC de Windows) |
| *hOledbAccess97* | Proveedor OLE DB para Access 97 |
| *hOledbAccess2000* | Proveedor OLE DB para Access 2000 |
| *hOledbDBase5* | Proveedor OLE DB para dBase 5 |
| *hOledbExcel97* | Proveedor OLE DB para Excel 97 |
| *hOledbExcel2000* | Proveedor OLE DB para Excel 2000 |
| *hOledbLotus4* | Proveedor OLE DB para Lotus 4 |
| *hOledbOracle* | Proveedor OLE DB para Oracle |
| *hOledbSQLServer* | Proveedor OLE DB para SQL Server |


	
	![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) Atención: Para utilizar una conexión OLE DB, es necesario: 

- instalar MDAC versión 2.6 o posterior (instalación realizada con WINDEV/WEBDEV, al crear la versión cliente)

- instalar el proveedor OLE DB que corresponde a la base de datos utilizada. 
			Este parámetro es devuelto por la [CtOLEDBProvider](../Proprietes/2512033.md) Property.





**`<Access>: (Constante opcional)`**

Configura el tipo de acceso a la base de datos. 



|   |   |
| --- | --- |
| *hORead* | Se puede acceder a la base de datos en modo de solo lectura. Solo se pueden leer registros. No se pueden agregar o eliminar. |
| *hOReadWrite*<br>(valor predeterminado) | Se puede acceder a la base de datos en lectura/escritura. Se pueden leer y escribir nuevos registros. |


Este parámetro es devuelto por la [CtAccess](../Proprietes/2512015.md) Property.


![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Este parámetro no se tiene en cuenta.

**`<Extended information>: (Cadena de caracteres opcional)`**

Información opcional insertada en la cadena de conexión a la base de datos. Si se reconocen palabras clave específicas, la información correspondiente se extrae de la cadena de conexión. El resto de la cadena de conexión se envía a la base de datos. A continuación, los parámetros extraídos son procesados por el Conector Nativo o por el conector OLE DB utilizado.. 
Estas palabras clave deben indicarse de la siguiente manera: "&lt;Palabra clave&gt; = &lt;Valor&gt;;".

Por ejemplo, puede especificar "Trusted_Connection=YES" para utilizar una conexión con autenticación a través del inicio de sesión NT..
![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Las palabras clave reconocidas por OLE DB y el Conectores Nativos se presentan en el [Información opcional de conexión](../WDLang4/9000124.md) Page. 

Ejemplo de cadena a utilizar:


```wl
"WD Cache Size = 10000; Server Port=3306;"
```
![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) **Las palabras clave reconocidas para el acceso mediante HFSQL Client/Server son las siguientes:**


|   |   |
| --- | --- |
| COMPRESSION | Habilita o deshabilita la compresión de los datos intercambiados entre el Cliente y el Servidor.. Esta palabra clave puede corresponder a:<br><br>- TRUE para activar la compresión de datos.<br><br>- FALSE para no comprimir datos.<br><br><br> |
| DB_EXIST | Verifica la existencia de la base de datos. Si la base de datos especificada no existe, la función **HDescribeConnection** devuelve <u><u><u><u>False</u></u></u></u>. |
| ENCRYPTION | Permite el cifrado de los datos intercambiados entre el Cliente y el Servidor. Esta palabra clave puede tomar varios valores:<br><br>- RÁPIDO<br><br>- RC5_16 para utilizar el cifrado RC5 de 16 rondas.<br><br>- AES128 para utilizar el cifrado AES de 128 bits con el modo de funcionamiento OFB.<br><br>- AES192 para utilizar el cifrado AES de 192 bits con el modo de funcionamiento OFB.<br><br>- AES256 para utilizar el cifrado AES de 256 bits con el modo de funcionamiento OFB.<br><br><br> |


Este parámetro es devuelto por la [CtExtendedInfo](../Proprietes/2512017.md) Property.
![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Base de datos HFSQL a la que se puede acceder mediante un servidor RMI: Este parámetro corresponde a la dirección del servidor RMI y al puerto utilizado. Se debe utilizar el siguiente formato: "RMI=&lt;Dirección del servidor&gt;:&lt;Número de puerto&gt;". Por ejemplo: "RMI=192.168.52.148:1099". ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Este parámetro es obligatorio. Debe corresponder al nombre completo del controlador JDBC que se utilizará. Este nombre distingue entre mayúsculas y minúsculas.

**`<Additional options>: (Constante)`**

Si no se especifica este parámetro, el motor HFSQL define automáticamente los parámetros que se deben utilizar en función de la base de datos a la que se accede y del proveedor OLE DB utilizado.

Para forzar algunos parámetros, se pueden combinar las siguientes constantes:

- **Ubicación de los cursores**
	


|   |   |
| --- | --- |
| *hClientCursor* | Cursor utilizado por MDAC. Por lo general, ofrece más funcionalidades que un cursor servidor. Un cursor cliente obligatoriamente es un cursor estático. |
| *hServerCursor* | Cursor utilizado por la base de datos. Este cursor puede aplicar fácilmente las modificaciones realizadas por otros usuarios a los datos. |



- **Tipo de cursor**
	


|   |   |
| --- | --- |
| *hDynamicCursor* | Cursor que ofrece una gran cantidad de funcionalidades pero que consume mucha memoria. Este cursor permite realizar varios movimientos. Permite acceder a todas las modificaciones, adiciones y eliminaciones realizadas por los demás usuarios. |
| *hForwardOnlyCursor* | Cursor rápido que consume poca memoria. El desplazamiento se realiza del primer al último registro. Los datos modificados por otros usuarios no son visibles. |
| *hOpenKeysetCursor* | Cursor que utiliza un conjunto de registros fijo.  Solo se almacenan las claves que corresponden al registro, no los registros (consume menos memoria). No se puede acceder a los registros eliminados. Las modificaciones realizadas por otros usuarios son Visible (pero los registros añadidos no lo son). |
| *hStaticCursor* | Hace una copia de los registros de la consulta en la memoria (alto consumo de memoria). Todos los tipos de desplazamiento están permitidos. |



- **Modo de bloqueo**
	


|   |   |
| --- | --- |
| *hOptimisticCursor* | El registro se bloquea durante la actualización |
| *hPessimisticCursor* | El registro se bloquea tan pronto como entra en modo de edición para ser modificado. |
| *hReadOnlyCursor* | El conjunto de registros utilizado no podrá modificarse. |






Atención: no todos los proveedores OLE DB soportan todos los tipos de cursores.

Este parámetro es devuelto por la [CtCursorOptions](../Proprietes/2512042.md) Property.


<a name="SYNTAX2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
### Describiendo una conexión de una cadena de conexión ADO

`<Result> = HDescribeConnection(<Connection> , <ADO connection string> [, <Access>])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se realizó la operación,

- <u><u><u><u>False</u></u></u></u> si se produce un problema. La función [HErrorInfo](../WDLang4/3044071.md) permite identificar el error.




**`<Connection>: (Cadena de caracteres)`**

Nombre de la nueva conexión a definir. Si este nombre ya es utilizado por una conexión existente, la conexión anterior se sustituye por la nueva. La conexión anterior (así como los archivos de datos que la utilizaban) se cierran automáticamente.

**`<ADO connection string>: (Cadena de caracteres)`**

Cadena de conexión ADO utilizada. Para más detalles sobre la sintaxis de esta cadena de conexión, véase la documentación del proveedor OLE DB utilizado.

**`<Access>: (Constante opcional)`**

Configura el tipo de acceso a la base de datos.


|   |   |
| --- | --- |
| *hORead* | Se puede acceder a la base de datos en modo de solo lectura. Solo se pueden leer registros. No se pueden agregar o eliminar. |
| *hOReadWrite*<br>(valor predeterminado) | Se puede acceder a la base de datos en lectura/escritura. Se pueden leer y escribir nuevos registros. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Sintaxis 1: Utilizar una cadena de caracteres para el proveedor OLE DB
<a name="sintaxis_1_utilizar_una_cadena_caracteres_para_proveedor_ole_ELTPARAGRAPHE000587"></a>

Para encontrar fácilmente la cadena de caracteres que se debe utilizar para definir el proveedor OLE DB, le recomendamos seguir los siguientes pasos:

1. En la editor de análisis, abra la ventana de conexión de la description: en la pestaña "Análisis", en el grupo "Conexiones", haga clic en "Conexiones".

2. Seleccione el proveedor que se utilizará ("Conexión mediante").

3. Enseguida, se muestra la cadena de caracteres que corresponde al proveedor. Esta cadena de caracteres se puede utilizar para definir el proveedor OLE DB utilizado en el parámetro &lt;Proveedor OLE DB&gt;.

<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=HOuvreConnexion.gif)

<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Sintaxis 1: Pseudo-conexión a una base de datos HFSQL Classic
<a name="sintaxis_1_pseudoconexion_una_base_datos_hfsql_classic_ELTPARAGRAPHE000614"></a>

Los archivos de datos OLE DB o nativos se describen en el editor de análisis. Para manipular estas descripciones a través de la programación con una base de datos HFSQL, simplemente especifique la constante *hAccessHF7* como nombre del proveedor.

A continuación, esta conexión puede asignarse a los archivos de datos afectados por [HChangeConnection](../WDLang4/3044150.md).

Los archivos de datos en formato HFSQL correspondientes a la description de la BD OLE o los archivos nativos se crearán (si es necesario) en el directorio definido por . Por Default, estos archivos de datos están vacíos cuando se crean.<a name="NOTE0_3"></a>


### Diferencias entre HOpenConnection y HDescribeConnection
<a name="diferencias_entre_hopenconnection_hdescribeconnection_ELTPARAGRAPHE000630"></a>

**Método 1**: Para abrir una conexión al inicio de la aplicación y cerrarla al final, utilice [HOpenConnection](../WDLang4/3044107.md). Para utilizar esta conexión cuando se manejan archivos o tablas de datos, basta con cambiar esta conexión con [HChangeConnection](../WDLang4/3044150.md).


```wl
HOpenConnection(MyConnection, params)       // open the connection
HChangeConnection(AFile, MyConnection)
```


**Método 2**: Para describir una conexión a través de la programación y abrirla automáticamente al abrir el archivo de datos, debe:

- describir la conexión con la función [HDescribeConnection](../WDLang4/3044205.md).

- asociar esta conexión con el archivo de datos deseado description utilizando [HChangeConnection](../WDLang4/3044150.md). La conexión sólo se abrirá la primera vez que se acceda a el archivo de datos.




Esta solución puede ser useful cuando una aplicación maneja tanto archivos de datos HFSQL como archivos de datos Oracle. Por ejemplo, si la aplicación utiliza un único archivo Oracle, en un Process específico, la conexión a la base de datos Oracle sólo se realizará si es necesario.

Si se elige la primera solución para el mismo tipo de aplicación, la conexión (que puede llevar bastante tiempo) se establecerá cada vez que se inicie la aplicación.

Ejemplo:


```wl
HDescribeConnection(MyConnection, params)
HChangeConnection(AFile, MyConnection)
...
HReadFirst(AFile) // Open the connection
...
HClose(AFile) // Close the connection
```

<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Uso del conector xBase nativo con conjuntos de caracteres no latinos
<a name="uso_del_conector_xbase_nativo_con_conjuntos_caracteres_latinos_ELTPARAGRAPHE000666"></a>

Para utilizar el conector xBase nativo con juegos de caracteres no latinos, Conector Nativo debe realizar una conversión estándar OEM/ANSI.. Para ello, debe especificarse la siguiente cadena en la información ampliada:

OEMTOANSI=VENTANAS;

**Ejemplo**:

1. En el código de inicialización del proyecto, añada el código utilizado para modificar el carácter set:
	
	```wl
	ChangeCharset(charsetChinese)
	```


2. Cree una conexión xBase:
	
	```wl
	HDescribeConnection("CntxBase", "", "", fExeDir(), "", hNativeAccessxBase, hOReadWrite, ...
		"OEMTOANSI=WINDOWS;")
	HChangeConnection("*", "CntxBase")
	```




<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) 

### Archivo UDL
<a name="archivo_udl_ELTPARAGRAPHE000686"></a>

Para crear un archivo UDL:

1. Cree un archivo de texto con la extensión "UDL".

2. Haga doble clic en el archivo. Enseguida, se abre la ventana de propiedades de relaciones de datos.

3. Configure la conexión.

4. Pruebe la conexión.

5. Valide (botón "OK"). Ahora se puede utilizar el archivo UDL.




<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Lógica de negocio
## Componente:
wd280hf.dll
