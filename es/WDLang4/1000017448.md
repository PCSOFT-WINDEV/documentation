


## hScheduledTask (Tipo de Variable)

*** ***
				



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
El tipo **hScheduledTask** se utiliza para gestionar una tarea HFSQL Client/Server programada mediante la programación. Las características de esta tarea de programación pueden ser definidas y modificadas por varios [Propiedades de WLanguage](#NOTE0_1).

**Observación**: Para obtener más información sobre la declaración de este tipo de variable y el uso de propiedades WLanguage, consulte [Declarar una variable](../Motscles/1514032.md).


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
MyTask is hScheduledTask
MyTask.Description = "Scheduled backup"
MyTask.Month = "*"
MyTask.DayOfWeek = "*"
MyTask.DayOfMonth = "*"
MyTime is Time
MyTime = EDT_Time
MyTask.Hour = MyTime.Hour
MyTask.Minute = MyTime.Minute
MyTask.NumberExecution = 1
MyTask.Procedure = "HBackup"
Add(MyTask.Parameter, NameCSDatabase + "/LOG_TASKSFIC")
Add(MyTask.Parameter, NameCSDatabase + ".ScheduledBackup")
Add(MyTask.Parameter, True)
Add(MyTask.Parameter, MyTask.Description)
nID is int = HAddTask(CSConnection, MyTask)
```

<a name="XSYNTAX"></a>
<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Propiedades específicas de la descripción de las variables hScheduledTask
<a name="propiedades_especificas_descripcion_las_variables_hscheduledtask_ELTPARAGRAPHE000039"></a>

Las siguientes propiedades pueden utilizarse para manipular una variable de tipo **hScheduledTask**:

| Nombre de la propiedad | Tipo utilizado | Efecto |
| --- | --- | --- |
| DayOfMonth | Cadena de caracteres | Número del día para el que se debe ejecutar la tarea programada (por ejemplo,"31").. Este número se incluye entre 0 y 31.<br>Este parámetro también puede corresponder a:<br><br>- una lista de números separados por comas: usado para especificar varios meses.<br><br>- a interval. Por ejemplo, "9-13" (la tarea se programa del 9 al 13 del mes).<br><br>- una estrella ("\*" ") para especificar el rango completo.<br><br>- un intervalo regular, por ejemplo "\*/2" para iniciar la tarea los días pares del mes.<br><br><br> |
| DayOfMonthOrDayOfWeek | booleano | Gestionar la ejecución de una tarea programada especificando el número de día de la semana o el número de día del mes. Ejemplo: ejecución cada lunes 1er día del mes.<br>Esta propiedad puede corresponder a:<br><br>- <u><u><u><u>True</u></u></u></u> para ejecutar la tarea programada todos los lunes Y el primer día del mes (condiciones acumuladas).<br><br>- <u><u><u><u>False</u></u></u></u> para ejecutar una tarea solo los lunes 1.º (condiciones exclusivas).<br><br><br> |
| DayOfWeek | Cadena de caracteres | Número del día para el que se debe ejecutar la tarea programada (por ejemplo,"2").. Este número se incluye entre 1 y 7 (1 = Lunes, 2 = Martes, ....). <br>Este parámetro también puede corresponder a:<br><br>- una lista de números separados por comas: usado para especificar varios días.<br><br>- a interval. Por ejemplo, "1-3" (la tarea está programada para el lunes, martes y miércoles).<br><br>- una estrella ("\*" ") para especificar el rango completo.<br><br>- un intervalo regular, por ejemplo "\*/2" para iniciar la tarea los días pares de la semana.<br><br>- el día de la semana en letras ("lunes", "martes", "miércoles", "jueves", "viernes").<br><br><br> |
| description (\*) | Cadena de caracteres | description associated con la tarea programada. La description de la tarea programada corresponde a una cadena vacía de Default.<br>Este Property es opcional. |
| drogadicta | Cadena de caracteres | Usuario que creó la tarea programada.<br>Esta propiedad es de solo lectura. |
| En el inicio | Constante de tipo Integer | Indica si la tarea debe realizarse al iniciar el servidor HFSQL así como su modo de ejecución.: <br><br>- *hBlocking*: La tarea es bloquear. El servidor HFSQL no será accesible durante la ejecución de la tarea.. <br><br>- *hBackgroundTask*: La tarea no es bloquear. El servidor HFSQL será accesible durante la ejecución de la tarea. La tarea se ejecuta en la tarea Background. <br><br>- *No*: La tarea no debe ser ejecutada al iniciar el servidor (valor de Default). <br><br><br> |
| Habilitado | booleano | <br><br>- <u><u><u><u>True</u></u></u></u> si la programación de la tarea está activada,<br><br>- <u><u><u><u>False</u></u></u></u> en caso contrario.<br><br><br> |
| Hora | Cadena de caracteres | <br><br>Tiempo de ejecución de la tarea programada. Si **TimeUTC** es set a <u><u><u><u>True</u></u></u></u>, esta hora estará en UTC.Los valores posibles son:<br><br>- un dígito comprendido entre 0 y 23.<br><br>- una lista de números separados por comas: usado para especificar varias horas.<br><br>- a interval. Por ejemplo, "9-13".<br><br>- una estrella ("\*" ") para especificar el rango completo.<br><br>- un intervalo regular, por ejemplo "\*/2" para iniciar la tarea cada hora par.<br><br><br> |
| Mes | Cadena de caracteres | Número del mes de ejecución de la tarea programada (por ejemplo,"11"). Los valores posibles son:<br><br>- un dígito comprendido entre 1 y 12.<br><br>- una lista de números separados por comas: usado para especificar varios meses.<br><br>- a interval. Por ejemplo, "9-11".<br><br>- una estrella ("\*" ") para especificar el rango completo.<br><br>- un intervalo regular, por ejemplo "\*/2" para iniciar la tarea los meses pares.<br><br><br> |
| Minuto | Cadena de caracteres | <br><br>Minutos del tiempo de ejecución de la tarea programada. Si **TimeUTC** es set a <u><u><u><u>True</u></u></u></u>, esta hora estará en UTC.<br><br>Los valores posibles son:<br><br>- un dígito comprendido entre 0 y 59.<br><br>- una lista de números separados por comas: se utiliza para especificar varios minutos.<br><br>- a interval. Por ejemplo, "9-13".<br><br>- una estrella ("\*" ") para especificar el rango completo.<br><br>- un intervalo regular, por ejemplo "\*/2" para iniciar la tarea cada minuto par.<br><br><br> |
| NúmeroEjecución | Integro | Número de veces que se debe ejecutar la medida. Esta propiedad también puede corresponder a la constante *Infinite*. |
| paramétrico | Array | Parámetros del Procedure almacenado que será ejecutado por la tarea programada. Para obtener más información, consulte ["¿Cómo manipular los parámetros pasados al Procedure almacenado?"](#NOTE0_2). |
| Procedure | Cadena de caracteres | Nombre del Procedure almacenado que será ejecutado por la tarea programada. <br>Este Property tiene el siguiente formato: &lt;Nombre de la base de datos&gt;:&lt;Nombre del conjunto de Procedure s&gt;.&lt;Nombre del Procedure almacenado&gt;&gt;.. <br>Para realizar una copia de seguridad, esta Property debe corresponder a "HBackup". |
| TiempoUTC | booleano | <br><br>- <u><u><u><u>True</u></u></u></u> (valor Default) si la hora está en UTC (propiedades **Hora** y **Minuto**),<br><br>- <u><u><u><u>False</u></u></u></u> en caso contrario.<br><br><br> |

Las propiedades seguidas de una estrella (\*) son opcionales.
<a name="NOTE0_2"></a>


### Cómo manipular los parámetros pasados al Procedure almacenado
<a name="como_manipular_los_parametros_pasados_procedure_almacenado_ELTPARAGRAPHE000243"></a>

La propiedad **Parameter** de la variable **hScheduledTask** es un array de cadenas.

Para definir los parámetros de una Procedure almacenada al activar una tarea programada, utilice [añadir](../WDLang1/1000017348.md) o [ArrayAdd](../WDLang1/3075003.md). Ejemplo:


```wl
Add(MyTask.Parameter, gsNameCSDatabase + ".ScheduledBackup")
```
Para manipular los parámetros, la sintaxis FOR EACH le permite navegar por un array.

Para conocer el número de elementos de array, puede utilizar:

- La función [ArrayCount](../WDLang1/3075012.md)

- La [Conde](../WDLang1/3025009.md) Property



<a name="NOTE0_3"></a>


### Funciones que utilizan variables hScheduledTask
<a name="funciones_que_utilizan_variables_hscheduledtask_ELTPARAGRAPHE000271"></a>

| Nombre de la función | Efecto |
| --- | --- |
| [HAddTask](../WDLang4/1000017091.md) | Agrega una tarea programada en el servidor definido por la conexión. Esta tarea se definió con una variable avanzada de tipo **hScheduledTask**. |
| [HInfoTask](../WDLang4/1000017409.md) | Devuelve las características de una tarea programada en una variable avanzada de tipo **hScheduledTask**. |
| [HModifyTask](../WDLang4/1000017374.md) | Modifica una tarea programada en el servidor definida por la conexión.. Esta tarea está contenida en una variable avanzada de tipo **hScheduledTask**. |


<a name="NOTE0_4"></a>


### Compatibilidad
<a name="compatibilidad_ELTPARAGRAPHE000296"></a>

El tipo **hScheduledTask** sustituye al [estructura global de hScheduledTask](../WDLang4/1000017180.md) disponible en la versión 12. Esta estructura se mantiene para la compatibilidad hacia atrás.


