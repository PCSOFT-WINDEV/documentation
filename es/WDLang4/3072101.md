


## AS/400: Método de desarrollo
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000272"></a>
El conector nativo AS/400 simplifica el acceso a los datos AS/400 desde sus aplicaciones WINDEV y WEBDEV.

En el desarrollo se utiliza el mismo método independientemente del producto utilizado.

En implementación, sólo cambia la plataforma de ejecución: Windows con WINDEV o un navegador con WEBDEV.

Esta página presenta el método de desarrollo en varios pasos:

1. Creación del proyecto y del análisis: importar la estructura de los archivos de datos.

2. Creación de la aplicación (RAD) y programación.

3. Creación del archivo ejecutable (WINDEV).

4. Despliegue de la aplicación.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Proyecto y análisis
<a name="proyecto_analisis_ELTTEXTE000296"></a>


### Importación del DDS (ingeniería inversa)
<a name="importacion_del_dds_ingenieria_inversa_ELTPARAGRAPHE000029"></a>

Si existe una base de datos existente en su AS/400 (o en la de su cliente), todo lo que tiene que hacer es importar el DDS definido en el AS/400 a su producto para explotar estos datos.. Los datos permanecen en el AS/400. Tiene la posibilidad de acceder a los archivos físicos, los archivos lógicos, como cualquier aplicación escrita en RPG (GAP) o en Cobol.

WINDEV recupera automáticamente la estructura de los archivos de datos y crea un repositorio de datos useful para el desarrollo. Los controles AS/400 se convierten al formato Windows. Los datos permanecen en formato AS/400.

Cada uno de los ficheros lógicos se convierte en una clave para WINDEV (clave única o clave múltiple).. WINDEV deduce las relaciones entre los archivos de datos según la Definition de las claves. Se recuperan las restricciones de integridad definidas para el sistema AS/400.

Para importar el DDS: 

1. En la pestaña "Análisis", en el grupo "Creación", despliegue "Importar" y seleccione "Importar descripciones de archivos/tablas...". El asistente se abre. Se crea automáticamente una conexión AS/400 y associated con los archivos importados en el análisis. Esta conexión tendrá que ser utilizada para manipular el archivo de datos del AS/400 a través de la programación.

2. En las diferentes pantallas de asistente, seleccione:

	- Fuente de datos: base de datos externa.

	- Los datos en formato actual serán utilizados por la aplicación.

	- Al seleccionar la base de datos de origen, especifique el modo "Conector Nativo para AS/400", la IP Address o el nombre de la base de datos AS/400, el nombre del perfil y la contraseña associated.




3. Seleccione los objetos AS/400 que desea importar y validar.




Para más detalles, consulte el archivo de ayuda suministrado con el Conector AS/400 nativo.

**Observación**: La información ampliada se recupera automáticamente cuando se importan los archivos AS/400 al análisis.
<a name="NOTE2_2"></a>


### Exportación del DDS
<a name="exportacion_del_dds_ELTPARAGRAPHE000066"></a>

Si desea crear nuevos archivos de datos en el sistema AS/400:

1. Definir los nuevos archivos de datos en el editor de análisis.

2. Exportar el DDS al AS/400: en la pestaña "Análisis", en el grupo "Análisis", amplíe "Sincronización " y seleccione "Sincronizar un AS400 - iSeries (DDS y datos)".

3. En la asistente, seleccione las estructuras de los archivos de datos a exportar. Para cada archivo de datos seleccionado, los DDS son creados y compilados en el AS/400 en la biblioteca de su elección (\*LIBL). Los controles del PC se convierten al formato AS/400.




Para más detalles, consulte el archivo de ayuda suministrado con el Conector AS/400 nativo.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Creación de la aplicación
<a name="creacion_aplicacion_ELTTEXTE000326"></a>
Una vez importados los archivos de datos en el análisis, se puede crear la aplicación WINDEV o WEBDEV. El RAD (Rapid Application Development) también se puede utilizar para crear una aplicación completa en pocos minutos.

La prueba de esta aplicación se puede ejecutar inmediatamente.

**¿Qué ocurre en el servidor AS/400 cuando se ejecuta un programa WINDEV o WEBDEV?**
Una conexión física a un trabajo en el AS/400 corresponde a cada aplicación WINDEV actual.. Este trabajo depende del perfil definido.

**Observación**: El RAD se utiliza para crear rápidamente una aplicación, pero también tiene la posibilidad de crear aplicaciones completas en el editor directamente.. Todos los elementos generados por el RAD pueden ser modificados. Todas las funciones de WLanguage se pueden utilizar en una aplicación para el sistema AS/400.
<a name="NOTE3_2"></a>


### Programación del acceso a los datos
<a name="programacion_del_acceso_los_datos_ELTPARAGRAPHE000106"></a>

**1. Establecimiento de la conexión**

- Para establecer la conexión con la base de datos AS/400, utilice [HOpenConnection](../WDLang4/3044107.md) y especifique el nombre de la conexión a abrir. Este nombre se definió cuando se importó la estructura de los archivos de datos en el análisis.

- Para cambiar los parámetros de esta conexión (nombre de usuario o contraseña, por ejemplo), utilice una Variable de tipo [Conexión](../WDLang4/1514073.md).


**Observación**: Si intenta leer directamente el archivo de datos ([HReadFirst](../WDLang4/3044051.md), ...), se abrirá automáticamente la conexión asociada al fichero description en el análisis.

**2. Ejecución de consultas**
[HExecuteQuery](../WDLang4/3044080.md) y [HExecuteSQLQuery](../WDLang4/3044084.md) se utilizan para ejecutar consultas en la base de datos actual.

- ****[HExecuteQuery](../WDLang4/3044080.md): se usa para ejecutar una consulta preestablecida con el editor de consultas.

- [HExecuteSQLQuery](../WDLang4/3044084.md): se utiliza para ejecutar una consulta especificando el código SQL de la consulta y el nombre que se asignará a este código SQL.




**3. Recuperación del resultado**
El resultado es navegado por las funciones de lectura estándar: [HReadFirst](../WDLang4/3044051.md), [HReadNext](../WDLang4/3044037.md), [HReadSeek](../WDLang4/3044050.md)...

**4. Cierre de la conexión**
[HCloseConnection](../WDLang4/3044095.md) se utiliza para cerrar la conexión con la base de datos una vez que se han ejecutado todas las consultas necesarias.
<a name="NOTE3_3"></a>


### Programación específica
<a name="programacion_especifica_ELTPARAGRAPHE000163"></a>

El Conector Nativo AS/400 permite desarrollar aplicaciones en modo Cliente/Servidor de datos y en modo Cliente/Servidor de procesos. Tienes la habilidad de hacerlo:

- realizar llamadas a batch o CL mientras se pasan parámetros,

- gestionar el DataQueues o DataAreas,

- ejecutar comandos AS/400, ....




Algunos ejemplos de funciones específicas (empezando por AS):


|   |   |
| --- | --- |
| ASRunRPC | Inicia la ejecución de un programa AS/400 y devuelve parámetros (valores devueltos por el programa, variables OutPut, como en el AS/400). |
| ASCallRtv | Ejecuta un comando AS/400 que devuelve variables (tipo RTVJOBA). |
| ASRtvResult | Recupera el resultado del último comando ASCallRtv. |
| ASExec | Llama a todos los comandos del AS/400 en el comando Line, en el contexto de la sesión actual, con el perfil de usuario del AS/400 autentificado, como en una terminal en modo 5250. |
| ASUser | Cambia el perfil de usuario de AS/400 con el que está conectado para iniciar una sesión con privilegios diferentes. |


Para más detalles, consulte el archivo de ayuda suministrado con el Conector AS/400 nativo.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Creación del ejecutable e implementación
<a name="creacion_del_ejecutable_implementacion_ELTTEXTE000362"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 

### Creación del ejecutable
<a name="creacion_del_ejecutable_ELTPARAGRAPHE000204"></a>

Un archivo ejecutable se crea como cualquier aplicación WINDEV a través de la creación de ejecutables asistente: en la pestaña "Proyecto", en el grupo "Generación", haga clic en "Generar". 
<a name="NOTE4_2"></a>


### Desplegando la aplicación
<a name="desplegando_aplicacion_ELTPARAGRAPHE000223"></a>

La aplicación o el sitio se despliega a través del generador instalación del producto utilizado.


