


## &lt;Fuente&gt;.ReadFirst (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Posiciones en el primer archivo Record de acuerdo con un artículo de navegación. Se lee el registro y se actualizan las variables HFSQL (por ejemplo, Cliente.Nombre, es decir, el elemento/campo *Nombre* del archivo de datos *Cliente*).

Los valores de la posición de búsqueda se leen en orden ascendente (véase observaciones para más detalles).

En la mayoría de los casos, **&lt;Fuente&gt;.ReadFirst** se utiliza para fijar la posición en el archivo de datos con el fin de realizar un bucle de lectura con [&lt;Fuente&gt;.ReadNext](../WDLang4/1000025035.md).

Tras la llamada a **&lt;Fuente&gt;.ReadFirst**pueden darse varios casos:

- el archivo de datos está vacía o ningún record corresponde al filtro (definido por [&lt;Fuente&gt;.Filter](../WDLang4/1000024960.md)): no se realiza ninguna lectura y la función [&lt;Fuente&gt;.Out](../WDLang4/1000024605.md) devuelve <u><u><u>True</u></u></u>.

- la función intenta leer una Record que ya está bloqueada en modo de lectura: no se realiza ninguna operación de lectura, [HErrorLock](../WDLang4/3044099.md) devuelve <u><u><u>True</u></u></u> y [&lt;Fuente&gt;.Out](../WDLang4/1000024605.md) devuelve <u><u><u>True</u></u></u>.
	
	![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: La gestión de las cerraduras no está disponible para las bases de datos a las que accede el JDBC.




Esta función se puede utilizar con archivos de datos, vistas HFSQL o consultas.

<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
Customer.ReadFirst(Name)
WHILE Customer.Out() = False
	// Process the record
	Customer.ReadNext(Name)
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = <Source>.ReadFirst([<Browse item> [, <Options>]])`
---

**`<Result>: (Booleano)`**

Corresponde a: 

- <u><u><u><u>False</u></u></u></u> si se produce un error. En este caso, [HError](../WDLang4/3044088.md) devuelve un número entero distinto de 0. [HErrorInfo](../WDLang4/3044071.md) devuelve más detalles sobre el error. El registro no se lee. 

- el valor de la función [&lt;Fuente&gt;.Found](../WDLang4/1000025076.md) en los demás casos (se puede leer el registro, incluso si &lt;Resultado&gt; devuelve <u><u><u><u>False</u></u></u></u>).




**`<Source>: (Tipo de fuente especificada)`**

Nombre del archivo de datos, vista HFSQL o consulta utilizada. 

**`<Browse item>: (Cadena de caracteres opcional)`**

Nombre del elemento utilizado para el bucle de el archivo de datos o la vista (este parámetro es ignorado por las consultas). Si no se especifica este nombre, la función **&lt;Fuente&gt;.ReadFirst** utilizará:

- ***Para un archivo de datos***: el último elemento de búsqueda utilizado en este archivo por la última función para la gestión de HFSQL (empezando por la letra H). Si este elemento no existe, se utiliza automáticamente el mejor elemento de navegación. 

- ***For a query***: el PEDIDO POR de la consulta si existe, en caso contrario el último ítem utilizado. 

- ***Para una vista***: el elemento de ordenación de la vista (si existe), en caso contrario el último elemento utilizado.




**`<Options>: (Constante opcional)`**

Permite configurar:

- el bloqueo establecido en el record leído por **&lt;Fuente&gt;.ReadFirst**

- si se debe tener en cuenta el filtro definido.





|   |   |
| --- | --- |
| *hForwardOnly* | ![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Esta constante sólo se puede utilizar con Conectores Nativos.<br><br>Optimiza las iteraciones simples que no utilizan las siguientes características:<br><br>- Leyendo el anterior Record.<br><br>- Modificando un Record.<br><br>- Posición de almacenamiento.<br><br><br>Si se utiliza una de estas características, el resultado puede diferir del esperado.<br><br>Por ejemplo, esta constante puede utilizarse para rellenar una control Tabla de forma programada. |
| *hKeepFilter* | El filtro set de [&lt;Fuente&gt;.Filter](../WDLang4/1000024960.md) se tendrá en cuenta, aunque la clave de búsqueda no esté optimizada para el filtro. **Recordatorio**: la función [&lt;Fuente&gt;.Filter](../WDLang4/1000024960.md) devuelve la clave de búsqueda optimizada para el filtro.<br>**Atención**: en este caso, pueden surgir problemas de rendimiento en archivos de datos demasiado grandes.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Esta constante no se puede utilizar. |
| *hLockNo* | Sin bloqeuo: el Record puede ser leído o modificado por otra aplicación durante la lectura.<br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hLockReadWrite* | Bloqueo de lectura/escritura: el Record que se lee actualmente no puede ser leído o modificado por otra aplicación.<br>![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) Bloquear en sólo escritura. Equivale a la constante *hLockWrite*.<br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hLockWrite* | Bloqueo de escritura: el Record que se lee actualmente puede ser leído por otra aplicación pero no puede ser modificado por otra aplicación.<br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hNoRefresh* | ![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) La función **&lt;Fuente&gt;.ReadFirst** no actualiza el contenido de la tabla o consulta. Si es posible, la consulta no se vuelve a ejecutar. Se guardan todas las posiciones guardadas. |





![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Las opciones de bloqueo no tendrán efecto si los bloqueos no son soportados por el proveedor OLE DB o por Conector Nativo.![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) El modo de bloqueo especificado con la función **&lt;Fuente&gt;.ReadFirst** seguirá siendo efectivo al llamar a las funciones [&lt;Fuente&gt;.ReadPrevious](../WDLang4/1000025021.md) y [&lt;Fuente&gt;.ReadNext](../WDLang4/1000025035.md).

Para modificar el bloqueo de teclas, debe utilizar:

- [&lt;Fuente&gt;.ReadSeekFirst](../WDLang4/1000025034.md) o [&lt;Fuente&gt;.ReadSeekLast](../WDLang4/1000025024.md), 

- las funciones [&lt;Fuente&gt;.ReadLast](../WDLang4/1000025020.md) o **&lt;Fuente&gt;.ReadFirst**.

- [&lt;Fuente&gt;.LockRecNum](../WDLang4/1000024197.md) o [&lt;Fuente&gt;.UnlockRecNum](../WDLang4/1000024212.md).


![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Para Conector Nativo Oracle, se puede especificar un modo de bloqueo diferente para cada Record. Sin embargo, si se inició una transacción mediante [SQLTransaction](../WDLang4/3072029.md) antes de establecer el bloqueo, éste sólo se liberará al final de la transacción ([SQLTransaction](../WDLang4/3072029.md) con la constante *sqlCommit* o *sqlRollBack*).![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Las opciones de bloqueo se ignoran. Utilizar las funciones de lectura de bloqueo (**HReadFirstLock**) conservadas para la compatibilidad con el pasado.![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: La gestión de las cerraduras no está disponible para las bases de datos a las que accede el JDBC.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Campo de navegación
<a name="campo_navegacion_ELTPARAGRAPHE000498"></a>

Si el elemento de navegación utilizado es una clave, la función **&lt;Fuente&gt;.ReadFirst** lee el registro con el valor de clave más bajo. El orden de clasificación es el que se especificó en el análisis para esta clave. Si se encuentran duplicados, **&lt;Fuente&gt;.ReadFirst** lee el primer registro "duplicado" según el orden de los números de registro.

Si el elemento de navegación no es una clave, la función **&lt;Fuente&gt;.ReadFirst** lee el primer registro activo. Al navegar por el archivo, los Record se ordenarán según su número de Record. 
En este caso, el elemento de navegación seleccionado aparecerá en rojo en el editor de código y se mostrará una advertencia en la pantalla de ["Panel"Código](../Editeurs/2027009.md).

**Observación**: La [autocompletado](../Editeurs/2013001.md) propone únicamente los puntos clave.
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Consultas de navegación
<a name="consultas_navegacion_ELTPARAGRAPHE000528"></a>

Por Default, **&lt;Fuente&gt;.ReadFirst** vuelve a ejecutar la consulta para actualización el resultado. Para evitar la reejecución de la consulta, se recomienda utilizar la constante *hNoRefresh*.

**Browsing a query run with the hQueryWithoutCorrection constant**:

Para examinar los registros en el orden en que fueron devueltos por la base de datos, no es necesario especificar un elemento de búsqueda. Ejemplo:

```wl
MyQuery.ExecuteQuery(hQueryWithoutCorrection)
...
MyQuery.ReadFirst(hNoRefresh)
```
 Si se especifica un elemento de búsqueda, el resultado de la consulta se recupera y se indexa en su totalidad. La iteración se realiza sobre el elemento especificado. Se ignora el orden inicial de la consulta (especificado por ORDER BY).. El índice creado (en formato HFSQL) es sensible al caso, a la puntuación, a los caracteres acentuados y en orden ascendente.

Ejemplo:

```wl
MyQuery.ExecuteQuery(hQueryWithoutCorrection)
...
MyQuery.ReadFirst(MyItem, hNoRefresh)
```
 El índice creado se utiliza para realizar búsquedas en el resultado de la consulta.
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![Lenguaje Externo](https://doc.pcsoft.fr/ext/images/us/LE.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Procedimientos almacenados](https://doc.pcsoft.fr/ext/images/us/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Bloqueos
<a name="bloqueos_ELTPARAGRAPHE000562"></a>

Por defecto (&lt;Opciones&gt; no especificadas), la Record no está bloqueada.

Si se solicita un bloqueo (constantes *hLockWrite* o *hLockReadWrite*), se leerá el registro solo si este aún no ha sido bloqueado.

![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Las opciones de bloqueo no tendrán efecto si los bloqueos no son soportados por el proveedor OLE DB o por Conector Nativo.
<a name="NOTE0_4"></a>


### Memos
<a name="memos_ELTPARAGRAPHE000578"></a>

Los memos asociados con el Record pueden ser leídos automáticamente (o no) cuando se lee el Record. [&lt;Fuente&gt;.SetMemo](../WDLang4/1000024987.md) se utiliza para personalizar esta operación de lectura de automatic.

Si los memos están soportados, los memos de texto asociados se leen cuando se lee la Record. Los memos binarios sólo se leen cuando se utilizan explícitamente ([&lt;Fuente&gt;.ExtractMemo](../WDLang4/1000024957.md)).
<a name="NOTE0_5"></a>


### Contraseña
<a name="contrasena_ELTPARAGRAPHE000600"></a>

Si **&lt;Fuente&gt;.ReadFirst** es la primera función que maneja el archivo de datos especificado, la contraseña se comprueba cuando el archivo de datos de apertura. Si la contraseña es incorrecta, [HErrorPassword](../WDLang4/3044082.md) devuelve <u><u><u><u>True</u></u></u></u> y [&lt;Fuente&gt;.Out](../WDLang4/1000024605.md) devuelve <u><u><u><u>True</u></u></u></u>.
<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![Procedimientos almacenados](https://doc.pcsoft.fr/ext/images/us/PS.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Conector Nativo XML
<a name="conector_nativo_xml_ELTPARAGRAPHE000630"></a>

El comportamiento de la función **&lt;Fuente&gt;.ReadFirst** depende de las funciones [&lt;Fuente&gt;.ActivateAutoFilter](../WDLang4/1000024171.md)/[&lt;Fuente&gt;.DeactivateAutoFilter](../WDLang4/1000024219.md).

[&lt;Fuente&gt;.ActivateAutoFilter](../WDLang4/1000024171.md) está habilitada por default.

Por lo tanto, para leer el contenido del archivo XML, lea el contenido del archivo principal (el padre) y luego lea el contenido de los archivos relacionado (los hijos).

Cuando se lee un archivo de datos, se aplica automáticamente un filtro a los archivos de datos de relacionado para leer sólo los registros correspondientes al archivo principal.

Por ejemplo:<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=XML_2.GIF)
 El Email de esta persona puede ser recuperado al navegar por el archivo de Personas.

Para ello, basta con set la posición en la ficha "Persona" y aplicar **&lt;Fuente&gt;.ReadFirst** a la ficha "Email".

En este caso, la Record leída en el archivo "Correo electrónico" corresponderá al primer correo electrónico asociado con la Record actual en el archivo "Persona".

Si este mecanismo está desactivado ([&lt;Fuente&gt;.DeactivateAutoFilter](../WDLang4/1000024219.md)), el Record leído en el fichero "Email" corresponderá al primer Record encontrado en el fichero Email (y no al hijo del Record leído en el fichero "Persona").
<a name="NOTE0_7"></a>


### Varios
<a name="varios_ELTPARAGRAPHE000679"></a>

- El número actual de Record es devuelto por [&lt;Fuente&gt;.RecNum](../WDLang4/1000025041.md).

- [&lt;Fuente&gt;.ChangeKey](../WDLang4/1000024198.md) se utiliza para modificar la clave de búsqueda mientras se mantiene posicionada en el record actual.

- Para mejorar los primeros tiempos de búsqueda en un archivo, utilice [&lt;Fuente&gt;.Optimize](../WDLang4/1000025042.md) en este archivo de datos.

- Esta función sustituye a **HReadFirstLock** y **HReadFirstNoLock**, que se mantuvieron por compatibilidad con WINDEV 5.5.




<a name="XComponent"></a>

## Componente:
wd280hf.dll
