
## Acceso a una base de datos a través de un servicio web
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000204"></a>
El acceso a una base de datos se puede realizar a través de un Webservice. 

Este modo de funcionamiento se puede utilizar en varios casos: 

- Acceso a las bases de datos limitado a las funciones HTTP. 

- Acceso a una base de datos externa (Oracle, SQL Server, ...) desde un dispositivo móvil iOS o Android. 

- ...




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Aplicación y condiciones de uso
<a name="aplicacion_condiciones_uso_ELTTEXTE000228"></a>
Para acceder a una base de datos a través de un servicio web, debe: 

1. [Instalar el Webservice suministrado por PC SOFT en un servidor](#NOTE2_2). 

2. [Instalar los archivos necesarios para acceder a las bases de datos: Accesos nativos, capa de cliente, fuente ODBC, ....](#NOTE2_3)

3. [Use SQLConnectWS para conectarse a la base de datos](#NOTE2_4). 

4. [Usar las funciones SQL para manipular la base de datos](#NOTE2_5). 



<a name="NOTE2_2"></a>


### Instalar el Webservice suministrado por PC SOFT en un servidor
<a name="instalar_webservice_suministrado_por_soft_servidor_ELTPARAGRAPHE000039"></a>

El programa instalación del servicio web para acceder a las bases de datos se proporciona con WINDEV, WEBDEV y WINDEV Mobile. Este programa está disponible en el subdirectorio "INSTALL" del directorio instalación del producto. 

Para instalar el servicio web: 

1. En el servidor, ejecute WX28 0PACKRSRV.EXE. Este archivo se encuentra en el subdirectorio "Install\\WDServerR" del IDE deseado. 

2. En el asistente: 

	- Acepte los términos de la licencia. 

	- En la pantalla "Elección de módulos", seleccione "Instalar el servicio web para acceder a las bases de datos externas".. 

	- Especificar el directorio instalación de los elementos del servidor reservado. 

	- Especifique la URL para acceder al servidor donde se instalará el Webservice. Tiene la posibilidad de utilizar un secure Address. Este Address se utilizará durante la conexión a través del Webservice mediante [SQLConnectWS](../WDLang4/1000021031.md). 




3. Validar la instalación. 




Observaciones: 

- Este Webservice debe estar instalado en el servidor al que se conectarán las aplicaciones que utilizan las bases de datos externas.. 

- El servidor debe poder acceder a las bases de datos externas. 

- La instalación del Webservice instala una versión específica del WEBDEV servidor de aplicaciones. Esta versión es necesaria para el funcionamiento del Webservice. 



<a name="NOTE2_3"></a>


### Instalar los archivos necesarios para acceder a las bases de datos
<a name="instalar_los_archivos_necesarios_para_acceder_las_bases_datos_ELTPARAGRAPHE000068"></a>

La base de datos a la que se accede a través del Webservice se puede encontrar en cualquier ordenador. Única condición: este ordenador debe ser accesible desde el servidor donde se instaló el Webservice. 

También se deben instalar diferentes elementos según el tipo de base de datos. 

**Acceder a la base de datos mediante un Conector Nativo** 
Si el acceso a la base de datos externa debe realizarse a través de un Native Access, los siguientes elementos deben estar instalados en el mismo ordenador que el Webservice: 

- la capa de cliente correspondiente, si es necesario. 

- las bibliotecas del Native WINDEV o WEBDEV Access utilizadas para acceder a la base de datos. 




**Acceso a la base de datos mediante un controlador OLE DB**
Si el acceso a la base de datos externa debe realizarse a través de una base de datos OLE, se deben instalar los siguientes elementos en el mismo ordenador que el Webservice: 

- MDAC versión 2.6 o posterior. 

- el proveedor de la base de datos OLE correspondiente a la base de datos utilizada. 




**Acceso a la base de datos mediante ODBC**
Si el acceso a la base de datos externa debe realizarse a través de ODBC, la fuente de datos ODBC debe configurarse en el Administrador de ODBC en la computadora instalación del Webservice. Esta fuente de datos debe ser una "fuente de datos del sistema".
<a name="NOTE2_4"></a>


### Use SQLConnectWS para conectarse a la base de datos
<a name="use_sqlconnectws_para_conectarse_base_datos_ELTPARAGRAPHE000095"></a>

Para conectarse a la base de datos a través del Webservice, basta con utilizar [SQLConnectWS](../WDLang4/1000021031.md). Esta función corresponde a [SQLConnect](../WDLang4/3072005.md). Aparece un parámetro adicional: la URL para acceder al servidor donde se instaló el Webservice. Esta URL corresponde a la URL especificada en la asistente para la instalación del Servicio Web. 

**Observación**: [SQLConnectWS](../WDLang4/1000021031.md) no se conecta a la base de datos. Esta función sólo comprueba que el Webservice en la Address especificada está respondiendo. La conexión con la base de datos se establece cada vez que se llama a [SQLExec](../WDLang4/3072007.md). En este modo, para cada consulta: se establece la conexión, se ejecuta la consulta y se cierra la conexión.

**Consejo**: Cómo saber si los parámetros de conexión son correctos: 
Puede crear un pequeño programa de prueba utilizando [SQLConnect](../WDLang4/3072005.md) para conectarse a la base de datos. Simplemente ejecute este programa en el servidor donde está instalado el Webservice. Si el acceso a la base de datos es correcto, los parámetros especificados en [SQLConnect](../WDLang4/3072005.md) pueden reutilizarse en [SQLConnectWS](../WDLang4/1000021031.md), añadiendo el servidor Address. 
<a name="NOTE2_5"></a>


### Usar las funciones SQL para manipular la base de datos
<a name="usar_las_funciones_sql_para_manipular_base_datos_ELTPARAGRAPHE000129"></a>

Una vez conectado a la base de datos, la aplicación puede manipular los datos a través de [las funciones SQL](../WDLang4/3072002.md) de WLanguage. 

**Observaciones**: 

- Las funciones Hxxxx ([HExecuteQuery](../WDLang4/3044080.md) o [HExecuteSQLQuery](../WDLang4/3044084.md), por ejemplo) no están disponibles. 

- [SQLLock](../WDLang4/3072003.md) y [SQLTransaction](../WDLang4/3072029.md) no están disponibles en este momento. 

- Cada llamada a [SQLExec](../WDLang4/3072007.md) abre y cierra la conexión con la base de datos. Dos llamadas sucesivas a [SQLExec](../WDLang4/3072007.md) utilizan diferentes conexiones a la base de datos. 





