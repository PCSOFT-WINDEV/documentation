


## HRestorePosition (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Restablece el contexto previamente guardado de un archivo de datos ([HSavePosition](../WDLang4/3044136.md)): registro actual, filtro, punteros.

La función **HRestorePosition** permite restaurar:

- el número de la Record utilizada,

- los diferentes punteros del índice (la posición en el índice se guarda para cada tecla),

- el filtro actual (solo si se especifica la constante *hRPFilter*).




Esta función se puede utilizar con archivos de datos, vistas HFSQL o consultas.


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Find a record
HReadSeekFirst(Customer, Name, Name)
WHILE HFound(Customer) = True
	// Saves the current context
	nPos = HSavePosition(Customer, Name)
	// Check a customer with another name
	HReadSeek(Customer, Name, Name2)
	IF HFound() = True THEN Counter = Counter + 1
	// Restores the context
	HRestorePosition(nPos)
	HReadNext(Customer, Name)
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Restablecer la posición especificada

`<Result> = HRestorePosition(<Position> [, <Option>])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se restauró la posición especificada,

- <u><u><u><u>False</u></u></u></u> en caso contrario. La función [HError](../WDLang4/3044088.md) permite obtener más detalles sobre el problema.




**`<Position>: (Integro)`**

Posición a restaurar. Valor devuelto por [HSavePosition](../WDLang4/3044136.md).

**`<Option>: (Constante o combinación de constantes opcional)`**

Permite configurar la operación de restauración:


|   |   |
| --- | --- |
| *hRPDefault*<br>(valor predeterminado) | La posición se libera. Se restablece la posición almacenada. |
| *hRPFilter* | Restablece el filtro implementado durante la llamada a [HSavePosition](../WDLang4/3044136.md). |
| *hRPHF5* | Si se ha borrado o modificado la posición memorizada, esta posición se restablece..<br>Si no se especifica la constante *hRPHF5* y se realiza la copia de seguridad en varios elementos, el posicionamiento se establece en el número de registro en curso al momento de llamar a la función [HSavePosition](../WDLang4/3044136.md).<br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está soportada. |
| *hRPKeep* | La posición no se libera (se podrán realizar otras llamadas a la función **HRestorePosition** en esta posición). |

![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Este parámetro no se tiene en cuenta: la posición se guardará para todos los elementos que se recorran en bucle.


<a name="SYNTAX2"></a>

### Restauración de un archivo de datos

`<Result> = HRestorePosition([<Data file>])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si el contexto ha sido restaurado, 

- <u><u><u><u>False</u></u></u></u> en caso contrario. La función [HError](../WDLang4/3044088.md) permite obtener más detalles sobre el problema.




**`<Data file>: (Cadena de caracteres opcional)`**

Nombre del archivo de datos cuyo contexto debe ser restaurado. Si no se especifica este nombre, la función **HRestorePosition** utilizará el último archivo de datos utilizado por la última función HFSQL (que empieza por "H").



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Reiniciación de posiciones
<a name="reiniciacion_posiciones_ELTPARAGRAPHE000192"></a>

Atención: todas las funciones que abren o cierran un archivo de datos reinicializan los números de contexto ([HCreation](../WDLang4/3044255.md), [HClose](../WDLang4/3044073.md), etc.).

Si se eliminó el registro guardado con la función [HSavePosition](../WDLang4/3044136.md), la función **HRestorePosition** conserva el contexto actual pero la posición se establecerá en el registro que se encuentra después del registro eliminado.
![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) Al reiniciar una navegación, las posiciones guardadas en esta navegación se destruyen.. El motor HFSQL está utilizando el valor del mejor elemento para intentar un nuevo posicionamiento. La mejor posición se selecciona en el siguiente orden de preferencia:

1. Identificador de automatic

2. Clave única

3. Primera llave

4. Primer punto


Las siguientes funciones reinicializan la iteración:

- [HReadFirst](../WDLang4/3044051.md)/[HFirst](../WDLang4/3044113.md)

- [HReadLast](../WDLang4/3044140.md)/[HLast](../WDLang4/3044101.md)

- [HSetMemo](../WDLang4/3044139.md)



<a name="NOTE0_2"></a>


### Varios
<a name="varios_ELTPARAGRAPHE000237"></a>

- El número de llamadas a [HSavePosition](../WDLang4/3044136.md) no está limitado.

- Puede anidar [HSavePosition](../WDLang4/3044136.md) y **HRestorePosition** para el mismo archivo de datos.



<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Principio de reposicionamiento para Conectores Nativos (también llamado Native Access)
<a name="principio_reposicionamiento_para_conectores_nativos_tambien_llamado_native_access_ELTPARAGRAPHE000257"></a>

El Record es restaurado desde el caché interno del Conector Nativo.

Atención: Durante la operación de restauración, no se comprueba la existencia de Record en la base de datos (el Record puede haber sido borrado).

Se puede "forzar" la lectura de la base de datos utilizando la función [HRead](../WDLang4/3044047.md) después de la función **HRestorePosition**. En este caso:

- los valores de Record serán leídos de nuevo en la base de datos.

- si el Record ha sido borrado, el Conector Nativo devolverá el error 13: No se puede encontrar el actual Record. Se modificó o eliminó de la fuente de datos.




**Casos especiales: Conectores nativos MySQL, DB2 e Informix**: Tras la llamada a **HRestorePosition**, [HReadNext](../WDLang4/3044037.md) y [HReadPrevious](../WDLang4/3044048.md) se genera una consulta para encontrar el Record siguiente o anterior al Record restaurado.

<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Lógica de negocio
## Componente:
wd280hf.dll
