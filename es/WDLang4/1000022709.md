


## &lt;Variable Connection&gt;.ModifyFileRights (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Modifica los permisos otorgados a un usuario o grupo en un archivo de datos HFSQL Client/Server.

**Observación**: Para conocer los derechos concedidos a un grupo o usuario sobre un fichero de datos HFSQL Client/Server, utilice [&lt;Variable Connection&gt;.InfoFileRights](../WDLang4/1000022667.md). 


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Describe the connection
MyConnection is Connection

// Copy the rights from a user to another one 
sRights is string
sRights = MyConnection.InfoFileRights("Moore", ...
		hRightsRead + hRightsInsert, "MyDatabase", "MyFile.fic")
MyConnection.ModifyFileRights("Doe", hRightsRead + hRightsInsert, ...
		sRights, "MyDatabase", "MyFile.FIC")
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = <Connection>.ModifyFileRights(<User/Group> , <Rights to modify> , <New values> , <Database> , <Data file>)`
---

**`<Result>: (Booleano)`**



- <u><u><u><u>True STRIMEULB</u></u></u></u> si los derechos han sido modificados, 

- <u><u><u><u>False</u></u></u></u> en caso contrario. La función [HErrorInfo](../WDLang4/3044071.md) permite identificar el error. 


No se realiza ninguna modificación si el nuevo valor ya está asignado a los derechos especificados.

**Observación**: [HErrorInfo](../WDLang4/3044071.md) devolverá un error "Usuario desconocido" o "Grupo desconocido" si el usuario actual no tiene los derechos para ver los usuarios (constante *hRightsSeeUser*) y si quiere get información sobre otro usuario u otro grupo.

**`<Connection>: (Variable de tipo Connection)`**

Nombre de la [Conexión](../WDLang4/1514073.md) Variable que describe la conexión para la que hay que modificar los derechos de un usuario o grupo de usuarios.

**`<User/Group>: (Cadena de caracteres)`**

Nombre del usuario o grupo cuyos derechos deben ser modificados.

**`<Rights to modify>: (Constante o combinación de constantes de tipo Integer)`**

Listado de derechos a modificar:


|   |   |
| --- | --- |
| *hRightsAutoModif* | Derechos para realizar la modificación de automatic de los archivos de datos de un archivo de datos. |
| *hRightsChangeLink* | Permiso para modificar las reglas de integridad de un archivo de datos. |
| *hRightsChangeOwner* | Permiso para modificar el propietario de un elemento. |
| *hRightsChangeRights* | Permiso para cambiar los permisos. |
| *hRightsDelete* | Derechos para borrar los registros de un archivo de datos. |
| *hRightsDeleteFile* | Derechos de supresión de un archivo de datos ([&lt;Variable Connection&gt;.DeleteFile](../WDLang4/1000022757.md)). |
| *hRightsInsert* | Permiso para agregar nuevos registros en un archivo de datos. |
| *hRightsLock* | Derechos para bloquear los archivos de datos o los registros de un archivo de datos. |
| *hRightsMaintenance* | Derechos para iniciar una operación de re-indexación o para realizar cálculos estadísticos sobre un archivo de datos. |
| *hRightsManageDuplicate* | Permiso para activar y desactivar la gestión de duplicados. |
| *hRightsRead* | Derechos de lectura de los registros de un archivo de datos. |
| *hRightsUpdate* | Derechos de modificación de los registros de un archivo de datos. |



**`<New values>: (Constantes de tipo Integer)`**

Lista de nuevos valores para los derechos modificados. Se deben asignar nuevos valores a todos los derechos especificados en &lt;Derechos de modificación&gt; (en el mismo orden).

Si se indica un único valor en este parámetro, se asignará a todos los derechos especificados en &lt;Derechos a modificar&gt;.

Los valores posibles son los siguientes:


|   |   |
| --- | --- |
| *hAllowed* | El usuario o grupo tiene el permiso correspondiente. |
| *hForbidden* | El usuario o grupo no tiene el permiso correspondiente. |
| *hInherit* | El usuario heredará del valor de los derechos concedidos al grupo al que pertenece. |



**`<Database>: (Cadena de caracteres)`**

Nombre de la base de datos que contiene el archivo de datos cuyos derechos deben ser modificados. 

- Si la base de datos corresponde a la que se definió en la conexión, este parámetro puede corresponder a una cadena vacía (""). 

- Si no se define ninguna base de datos en la conexión y este parámetro corresponde a una cadena vacía, se produce un error de WLanguage.




**`<Data file>: (Cadena de caracteres)`**

Nombre del archivo de datos para el cual los derechos deben ser modificados.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### ¿Cuándo se modifican los derechos?
<a name="¿cuando_modifican_los_derechos_ELTPARAGRAPHE000346"></a>

El cambio es efectivo desde que se ejecuta **&lt;Variable Connection&gt;.ModifyFileRights**. No es necesario reiniciar el servidor para tener en cuenta los nuevos derechos.

<a name="XComponent"></a>

## Componente:
wd280hf.dll
