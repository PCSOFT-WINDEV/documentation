


## HOptimizeQuery( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Optimiza las consultas de selección mediante el uso de tiempos de inactividad al gestionar una aplicación (período sin procesos).. Optimiza el acceso a los índices de los archivos de datos HFSQL Classic.

<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
HOptimizeQuery(QRY_Customer, 34)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = HOptimizeQuery(<Query name or SQL code> [, <Parameter 1> [... [, <Parameter N>]]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se optimizó el archivo de datos,

- <u><u><u><u>False</u></u></u></u> si se produce un problema. [HErrorInfo](../WDLang4/3044071.md) devuelve más detalles.




**`<Query name or SQL code>: (Cadena de caracteres)`**



- Nombre lógico de la consulta utilizada (Seleccionar sólo la consulta).

- Código SQL de la consulta utilizada (Seleccionar sólo la consulta).




**`<Parameter 1>: (Parámetros opcionales (el tipo corresponde al tipo de parámetro))`**

Valores de los parámetros esperados por la consulta en orden de inicialización (Visible en el editor de la consulta). Cada parámetro debe corresponder al tipo esperado. Los parámetros están separados por una coma. 
Los parámetros de consulta también se pueden pasar antes de **HOptimizeQuery** utilizando la siguiente notación: &lt;NombreDeConsulta&gt;.&lt;NombreDeParámetro&gt; = &lt;Valor&gt;. 
Los parámetros se ignoran si "&lt;nombre de la consulta o código SQL&gt;" corresponde al código SQL de la consulta utilizada.



**`<Parameter N>: (Parámetros opcionales (el tipo corresponde al tipo de parámetro))`**

Valores de los parámetros esperados por la consulta en orden de inicialización (Visible en el editor de la consulta). Cada parámetro debe corresponder al tipo esperado. Los parámetros están separados por una coma. 
Los parámetros de consulta también se pueden pasar antes de **HOptimizeQuery** utilizando la siguiente notación: &lt;NombreDeConsulta&gt;.&lt;NombreDeParámetro&gt; = &lt;Valor&gt;. 
Los parámetros se ignoran si "&lt;nombre de la consulta o código SQL&gt;" corresponde al código SQL de la consulta utilizada.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Diferencias entre HOptimize y HOptimizeQuery
<a name="diferencias_entre_hoptimize_hoptimizequery_ELTPARAGRAPHE000060"></a>

- [HOptimize](../WDLang4/3044005.md) carga la caché del sistema con todo el índice de archivos. Existe el riesgo de sobrecargar los cachés del sistema si el archivo de datos es muy grande o si la aplicación utiliza varios archivos de datos de gran tamaño. 
	Para evitar el riesgo de saturación, evite llamar a [HOptimize](../WDLang4/3044005.md) en demasiados archivos de datos o elementos clave.

- **HOptimizeQuery** carga las cachés del sistema sólo con las secciones de índice requeridas por la consulta especificada, para todos los archivos de datos utilizados por la consulta. Esta función se utiliza para optimizar las consultas.



<a name="NOTE0_2"></a>


### Varios
<a name="varios_ELTPARAGRAPHE000077"></a>

- **HOptimizeQuery** devuelve inmediatamente control al programa y se ejecuta en el background.

- Para evitar el riesgo de overload, evite llamar a **HOptimizeQuery** en un gran número de peticiones.

- Si una optimización está en curso cuando se llama a **HOptimizeQuery**, la optimización actual se detiene automáticamente.




<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Lógica de negocio
## Componente:
wd280hf.dll
