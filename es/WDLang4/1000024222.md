


## &lt;Fuente&gt;.DuplicateRecord (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Duplica un registro leído en un archivo de datos: el registro de la memoria se agrega al archivo de datos (consulta o vista). Los índices que corresponden a las claves utilizadas en la archivo de datos se actualizan automáticamente. Los posibles memos se agregan si la gestión de memos está habilitada (función [&lt;Fuente&gt;.SetMemo](../WDLang4/1000024987.md)).

Tras la llamada a **&lt;Fuente&gt;.DuplicateRecord**:

- Un manejo de errores de automatic está disponible para varios tipos de errores: Error de duplicados, error de integridad, error de contraseña, error de conflicto de modificación, error de estado durante el conflicto de modificación y error de bloqueo, ... Para obtener más información, consulte [Gestión asistida de errores HFSQL](../WDLang4/3044188.md).

- Si la gestión de duplicados está activada y el archivo de datos contiene una clave única, la función [HErrorDuplicates](../WDLang4/3044077.md) devuelve <u><u><u>True</u></u></u> si el valor de la clave agregada no es único. El registro no se agrega.

- El registro agregado se convierte en el registro actual. El identificador automático se completa automáticamente. Por Default, la iteración actual no se ve afectada.




**Observación**: Todo el Record en la memoria (el contenido de Record previamente leído) está escrito en el archivo de datos. 

Observaciones: 

- Esta función también se puede utilizar en una vista o en una consulta.

- **&lt;Fuente&gt;.DuplicateRecord** y [&lt;Fuente&gt;.Add](../WDLang4/1000024187.md) son equivalentes.





<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Duplicates the current record
Customer.DuplicateRecord()
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = <Source>.DuplicateRecord([<Options>])`
---

**`<Result>: (Boolean)`**



- <u><u><u><u>True</u></u></u></u> si se agregó el registro,

- <u><u><u><u>False</u></u></u></u> si se produce un problema (error de integridad, duplicados, etc). La función [HError](../WDLang4/3044088.md) permite identificar el error.




**`<Source>: (Tipo de fuente especificada)`**

Nombre del archivo de datos, vista o consulta utilizada. 

**`<Options>: (Constante opcional)`**

Permite configurar:

- el efecto al agregar un registro en la navegación en curso.

- el modo de cálculo del identificador automático. Para obtener más información, consulte [Gestión del identificador automático al agregar un registro](../WDLang4/3044183.md).

- el modo de bloqueo del registro agregado.

	- ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: La gestión de las cerraduras no está disponible para las bases de datos a las que accede el JDBC.




- la gestión de duplicados.

- la gestión de la integridad.


![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Este parámetro no se tiene en cuenta.


|   |   |
| --- | --- |
| *hAffectBrowse* | **Efecto al agregar registros en la navegación**: Al agregar registros, se altera la navegación. <br>Por ejemplo, [&lt;Fuente&gt;.ReadNext](../WDLang4/1000025035.md) utilizado después de **&lt;Fuente&gt;.DuplicateRecord** posiciones en el Record encontrado después de la Record añadido.<br>La constante *hAffectBrowse* tiene prioridad sobre la constante *hWriteDefault*. |
| *hCheckDuplicates* | **Modo de gestión de duplicados**: Verifica los duplicados en esta operación, incluso si la verificación de duplicados está desactivada (función [&lt;Fuente&gt;.SetDuplicates](../WDLang4/1000024985.md)).<br>Si se utilizan las constantes *hIgnoreDuplicates* y *hCheckDuplicates* al mismo tiempo, se produce un error WLanguage.<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hCheckIntegrity* | **Modo de gestión de la integridad**: Comprueba la integridad de la operación, incluso si la comprobación de integridad de automatic está desactivada ([&lt;Variable Connection&gt;.SetIntegrity](../WDLang4/1000023960.md)).<br>Si se utilizan las constantes *hIgnoreIntegrity* y *hCheckIntegrity* al mismo tiempo, se produce un error WLanguage.<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hForceIdAuto* | **Modo de cálculo del identificador automático**: El identificador automático no se calcula al agregar registros. El identificador corresponde a:<br><br>- el valor asignado al elemento mediante programación (por ejemplo, CUSTOMERID = 7)<br><br>- el valor predeterminado del identificador que se especificó en el editor de análisis (si el archivo de datos acaba de abrirse, sin que se haya leído ningún registro)<br><br>- el valor del identificador en la memoria (valor del identificador del último registro leído en el archivo de datos).<br><br><br>Después de agregar el registro, se calculará el siguiente identificador automático calculado por el motor HFSQL, sin tener en cuenta el valor agregado con *hForceIdAuto*.<br>Si se utilizan las constantes *hSetIdAuto* y *hForceIdAuto* al mismo tiempo, se genera un error WLanguage.<br>![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) SQLServer CE: No se puede utilizar la constante *hForceIdAuto*. |
| *hIgnoreDuplicates* | **Modo de gestión de duplicados**: No comprueba la existencia de duplicados para esta operación, incluso si la verificación automática de duplicados está activada (función [&lt;Fuente&gt;.SetDuplicates](../WDLang4/1000024985.md)).<br>Si se utilizan las constantes *hIgnoreDuplicates* y *hCheckDuplicates* al mismo tiempo, se produce un error WLanguage.<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hIgnoreIntegrity* | **Modo de gestión de la integridad**: Ignora la verificación de la integridad en esta operación, incluso si la verificación automática de la integridad está activada (función [&lt;Variable Connection&gt;.SetIntegrity](../WDLang4/1000023960.md)).<br>Si se utilizan las constantes *hIgnoreIntegrity* y *hCheckIntegrity* al mismo tiempo, se produce un error WLanguage.<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hLockNo* (valor predeterminado) | **Modo de bloqueo del registro agregado**: Sin bloqeuo: el registro agregado no se bloqueará.<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hLockReadWrite* | **Modo de bloqueo del registro agregado**: Bloqueo de lectura/escritura: se aplicará un bloqueo de lectura y escritura en el registro agregado . Este registro no puede ser leído ni modificado por otras aplicaciones. Solo la aplicación actual puede modificarlo, leerlo o desbloquearlo.<br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hLockWrite* | **Modo de bloqueo del registro agregado**: Bloqueo de escritura: el registro agregado se bloqueará contra escritura. Otras aplicaciones pueden leer el registro pero no modificarlo. Solo la aplicación en curso podrá modificarlo o desbloquearlo.<br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hSetIdAuto* | **Modo de cálculo del identificador automático**: El identificador automático no se calcula al agregar registros: el valor del identificador será el que se almacena al agregar un registro. <br><u><u><u><u>El siguiente valor del identificador calculado por el motor HFSQL corresponderá al mayor valor del identificador en el archivo +1. </u></u></u></u><br>Si se utilizan las constantes *hSetIdAuto* y *hForceIdAuto* al mismo tiempo, se genera un error WLanguage.<br>![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) SQLServer CE: No se puede utilizar la constante *hSetIdAuto*. |
| *hWriteDefault*<br>(valor predeterminado) | **Efecto al agregar registros en la navegación**: Al agregar registros, no se altera la navegación. <br>Por ejemplo, [&lt;Fuente&gt;.ReadNext](../WDLang4/1000025035.md) utilizado después de **&lt;Fuente&gt;.DuplicateRecord** posiciones en el Record encontrado después de la actual Record antes de la adición.<br>La constante *hAffectBrowse* tiene prioridad sobre la constante *hWriteDefault*. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Gestión de los identificadores de automatic
<a name="gestion_los_identificadores_automatic_ELTPARAGRAPHE000459"></a>

Por defecto, el elemento "identificador automático" se actualiza automáticamente cuando se añade un Record en un archivo de datos. No hay necesidad de leer el Record de nuevo para averiguar el valor del identificador automatic. Simplemente use la siguiente sintaxis: &lt;Nombre del archivo&gt;.&lt;Nombre del elemento identificador de automatic&gt;.

Las constantes *hForceIdAuto* y *hSetIdAuto* permiten modificar el comportamiento predeterminado del identificador automático.

Para más detalles sobre los identificadores automatic para los nuevos registros, véase [Gestión del identificador automático al agregar un registro](../WDLang4/3044183.md).
![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) **Caso especial**

- Si la base de datos genera un identificador automatic, el motor HFSQL mantiene este valor. Si se especifica la constante *hForceIDAuto* o *hSetIDAuto*, el motor HFSQL sustituye el valor generado por el valor deseado. 
	Observación: la constante *hForceIdAuto* equivale a *hSetIdAuto*: el identificador automatic calculado por el motor HFSQL durante la próxima adición será único en el archivo de datos.

- Si la base de datos no genera ningún identificador de automatic, el motor HFSQL genera el valor y lo asigna al identificador automatic.



<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) 

### Reutilización de los registros borrados o liberados
<a name="reutilizacion_los_registros_borrados_liberados_ELTPARAGRAPHE000486"></a>

Cuando se añade un nuevo Record, el motor HFSQL optimiza el relleno del archivo de datos. El espacio correspondiente a las Record s borradas o liberadas se utiliza primero cuando se añade una nueva Record.

Los registros cruzados no se reutilizan.
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) 

### Versión del archivo de datos después de una adición
<a name="version_del_archivo_datos_despues_una_adicion_ELTPARAGRAPHE000500"></a>

Si el Record fue agregado a el archivo de datos (sin error de duplicación y sin error de integridad), el número de versión del archivo de datos es modificado. Para get el número de versión, utilice [&lt;Fuente&gt;.Version](../WDLang4/1000025082.md).
<a name="NOTE0_4"></a>


### Añadiendo un Record en una consulta
<a name="anadiendo_record_una_consulta_ELTPARAGRAPHE000515"></a>

Se puede añadir una Record a una consulta:

- en el resultado de la consulta.

- en los archivos de datos tratados por la consulta (*hModifyFile* constante utilizada en [&lt;Fuente&gt;.ExecuteQuery](../WDLang4/1000024944.md) o [&lt;Fuente&gt;.ExecuteSQLQuery](../WDLang4/1000024948.md)). En este caso, la constante *hWithFilter* se selecciona automáticamente.




Independientemente del modo de ejecución de la consulta (con o sin la constante *hWithFilter*), solo es posible agregar registros a una consulta de archivo único. Las posiciones calculadas especificadas durante la suma se ignoran. Se calculan automáticamente.

Atención:

- No se permite ninguna adición en una consulta que utilice grupos o agregados.

- La gestión de la integridad y de los duplicados no se realiza durante las operaciones en las consultas multiarchivo.: se recomienda utilizar las transacciones para evitar cualquier problema.



<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) 

### Adición de registros en una vista
<a name="adicion_registros_una_vista_ELTPARAGRAPHE000547"></a>

Tiene la posibilidad de añadir registros en una vista creada sobre archivos de datos en formato HFSQL Classic. Estos registros se añaden sólo en la memoria. Para añadirlos en el archivo de datos relacionado a la vista (vista simple, por ejemplo), debe utilizar [&lt;Fuente&gt;.ViewToFile](../WDLang4/1000025084.md).
<a name="NOTE0_6"></a>


### Navegación y adición de registros
<a name="navegacion_adicion_registros_ELTPARAGRAPHE000562"></a>Es posible configurar el efecto de agregar registros al navegar por un archivo de datos (constantes *hWriteDefault* y *hAffectBrowse*). El modo de funcionamiento de las versiones anteriores puede mantenerse usando la constante *hAffectBrowse*.
![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) **Casos especiales**: Si se añade el Record durante una búsqueda, será Visible sólo en la búsqueda actual.. Si se han definido otras operaciones de navegación en esta base de datos, el nuevo Record sólo será Visible una vez que estas operaciones de navegación se hayan reiniciado.
<a name="NOTE0_7"></a>


### Lentitud al añadir o eliminar una Record por primera vez en un archivo de datos HFSQL
<a name="lentitud_anadir_eliminar_una_record_por_primera_vez_archivo_datos_hfsql_ELTPARAGRAPHE000575"></a>

Acceder por primera vez a un Record en un archivo de datos HFSQL puede llevar mucho tiempo. Para solucionar este problema:

- Desactive el antivirus para los archivos.FIC,.NDX,.MMO y.REP.

- Desactive la opción "Restaurar el sistema" en Windows XP.



<a name="NOTE0_8"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) 

### Adición a una base de datos en formato Hyper File 5.5
<a name="adicion_una_base_datos_formato_hyper_file_55_ELTPARAGRAPHE000590"></a>

**If está utilizando HDuplicateRecord con una base de datos en formato Hyper File 5.5:**

- Las opciones de adición (&lt;Opciones&gt;) se ignoran.

- Los elementos TEXT se rellenan automáticamente con caracteres de espacio.

- **&lt;Fuente&gt;.DuplicateRecord** no puede utilizarse en una vista creada a partir de archivos de datos de Hyper File 5.5.




<a name="XComponent"></a>

## Componente:
wd280hf.dll
