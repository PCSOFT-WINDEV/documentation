


## HFirst (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Establece la posición en el primer registro de un archivo de datos de acuerdo con el elemento de navegación especificado. **TEl Record no se lee**.
El número de la Record actual se modifica sólo cuando es devuelto por [HRecNum](../WDLang4/3044063.md). Para las funciones que manipular el número actual de Record ([HDelete](../WDLang4/3044018.md), [HRead](../WDLang4/3044047.md), [HModify](../WDLang4/3044042.md), etc.), el valor de este número no se actualiza: se debe utilizar la función [HRecNum](../WDLang4/3044063.md)(). Por ejemplo: no hacer: 

```wl
HDelete(Customer)
```
 pero 

```wl
HDelete(Customer, HRecNum())
```
 Los valores de la posición de búsqueda se leen en orden ascendente (ver Observaciones para más detalles).

**Atención**: ***El registro cargado en memoria no se modifica***. Las variables HFSQL (por ejemplo, Cliente.Nombre, es decir el elemento *Nombre* del archivo *Cliente*) no se actualizan.

En la mayoría de los casos, **HFirst** establece la posición en el archivo de datos para recorrer los registros que coinciden con una condición. [HNext](../WDLang4/3044027.md) se utiliza para posicionarse en el siguiente Record correspondiente a la condición.

Después de llamar a la función **HFirst**, se pueden producir los siguientes casos:

- se encontró un registro que corresponde a la condición: [HFound](../WDLang4/3044104.md) devuelve <u><u><u>True</u></u></u>

- el archivo de datos está vacía o no hay Record correspondiente a la condición: [HOut](../WDLang4/3044094.md) devuelve <u><u><u>True</u></u></u>




**Observaciones**: 

- Mediante Default, [HSeekFirst](../WDLang4/3044125.md) y [HSeekLast](../WDLang4/3044129.md) se realiza una búsqueda de coincidencia exacta.

- Mediante Default, **HFirst** se realiza una búsqueda genérica.





Los valores de la posición de búsqueda se leen en orden ascendente (véase [observaciones](#NOTE0_1) para más detalles).

Atención: **El registro cargado en memoria no se modifica.** Las variables HFSQL (por ejemplo, Cliente.Nombre, es decir el elemento *Nombre* del archivo *Cliente*) no se actualizan.

En la mayoría de los casos, **HFirst** se utiliza para fijar la posición en el archivo de datos con el fin de realizar un bucle de lectura con [HNext](../WDLang4/3044027.md).

Tras la llamada a **HFirst**pueden darse varios casos:

- el archivo de datos está vacía o ningún record corresponde al filtro (definido por [HFilter](../WDLang4/3044100.md)): [HOut](../WDLang4/3044094.md) devuelve <u><u><u>True</u></u></u>.

- la función intenta bloquear un registro ya bloqueado en modo de lectura: [HErrorLock](../WDLang4/3044099.md) devuelve <u><u><u>True</u></u></u> y [HOut](../WDLang4/3044094.md) devuelve <u><u><u>True</u></u></u>.
	![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: La gestión de las cerraduras no está disponible para las bases de datos a las que accede el JDBC. 





<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
HFirst(Customer, Name)
WHILE HOut() = False
	// Process the record
	HNext(Customer, Name)
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = HFirst([<Data file> [, <Search key item>] [, <Options>]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si el puesto era set,

- <u><u><u><u>False</u></u></u></u> si se produce un error. Este problema puede ser causado por:

	- un problema de posicionamiento (archivo de datos vacío, ...): [HFound](../WDLang4/3044104.md) devuelve <u><u><u><u>False</u></u></u></u> y [HError](../WDLang4/3044088.md) devuelve 0.

	- un error: [HError](../WDLang4/3044088.md) devuelve un número entero distinto de 0. [HErrorInfo](../WDLang4/3044071.md) devuelve más detalles.







**`<Data file>: (Cadena de caracteres opcional)`**

Nombre del archivo de datos utilizado. Si este parámetro es una cadena vacía (""), **HFirst** manipula el último archivo de datos utilizado por la última función HFSQL (función que empieza por "H").

**`<Search key item>: (Cadena de caracteres opcional)`**

Nombre del elemento clave utilizado para el bucle de el archivo de datos. Si no se especifica este nombre, **HFirst** utilizará el último elemento de exploración utilizado en este archivo de datos por la última función de gestión HFSQL (función que comienza por "H"). Si este elemento no existe, se utiliza automáticamente el mejor elemento de navegación.

**`<Options>: (Constante opcional)`**

Configura el bloqueo establecido en el Record seleccionado por **HFirst**:


|   |   |
| --- | --- |
| *hKeepFilter* | El filtro set de [HFilter](../WDLang4/3044100.md) se tendrá en cuenta, aunque la clave de búsqueda no esté optimizada para el filtro. Recordatorio: la función [HFilter](../WDLang4/3044100.md) devuelve la clave de búsqueda optimizada para el filtro. <br>**Atención**: En este caso, pueden surgir problemas de rendimiento para los archivos de datos de gran tamaño.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Este Variable no puede ser usado. |
| *hLockNo* | Sin bloqeuo: otras aplicaciones pueden leer o modificar el registro.<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hLockReadWrite* | Bloqueo de lectura/escritura: el Record seleccionado no puede ser leído o modificado por otra aplicación.<br>![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) Bloqueo de escritura: el Record seleccionado puede ser leído por otra aplicación pero no puede ser modificado por otra aplicación. Equivale a la constante *hLockWrite*.<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hLockWrite* | Bloqueo de escritura: el Record seleccionado puede ser leído por otra aplicación pero no puede ser modificado por otra aplicación.<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hNoRefresh* | ![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) El contenido de tabla o de la consulta no se actualizará. Todas las posiciones guardadas se almacenan.  Si no se especifica este parámetro, la función **HFirst** reinicializa la navegación para el elemento especificado: el contenido de tabla o consulta se actualiza con los datos encontrados en la base de datos OLE DB. Todas las posiciones guardadas se pierden. La posición se restablecerá de acuerdo con el valor del mejor elemento. <br>Observación: La navegación y las posiciones guardadas en los otros elementos no se ven afectadas. |

![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: La gestión de las cerraduras no está disponible para las bases de datos a las que accede el JDBC.![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Las opciones de bloqueo no tendrán efecto si los bloqueos no son soportados por el proveedor OLE DB o por Conector Nativo.![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) El modo de bloqueo especificado con la función **HFirst** seguirá siendo efectivo al llamar a las funciones [HPrevious](../WDLang4/3044112.md) y [HNext](../WDLang4/3044027.md).

Para modificar el bloqueo de teclas, debe utilizar:

- [HSeekFirst](../WDLang4/3044125.md) o [HSeekLast](../WDLang4/3044129.md), 

- **HFirst** o [HLast](../WDLang4/3044101.md).

- [HLockRecNum](../WDLang4/3044152.md) o [HUnlockRecNum](../WDLang4/3044194.md).


![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Oracle: se puede especificar un modo de bloqueo diferente para cada Record. Sin embargo, si una transacción fue iniciada por [SQLTransaction](../WDLang4/3072029.md) antes de establecer el bloqueo, éste sólo se liberará al final de la transacción ([SQLTransaction](../WDLang4/3072029.md) asociado con *<u><u><u><u>sqlCommit</u></u></u></u>* o *<u><u><u><u>sqlRollBack</u></u></u></u>*).![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Las opciones de bloqueo se ignoran. Utilice las funciones de bloqueo ([HLockRecNum](../WDLang4/3044152.md)) conservadas para la compatibilidad con el pasado.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Lectura de la operación según una clave
<a name="lectura_operacion_segun_una_clave_ELTPARAGRAPHE000293"></a>

La función **HFirst** establece la posición en el registro con el valor de clave más bajo.

El orden de clasificación es el que se especificó en el análisis para esta clave.

Si se encuentran duplicados, **HFirst** fija la posición en el primer "duplicado" Record según la secuencia de números Record.
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) 

### Comprobación de la contraseña
<a name="comprobacion_contrasena_ELTPARAGRAPHE000312"></a>

Si la función **HFirst** es la primera función que manipula el archivo de datos especificado, la contraseña se verifica al abrir el archivo de datos.

Si la contraseña es incorrecta, [HErrorPassword](../WDLang4/3044082.md) devuelve <u><u><u><u>True</u></u></u></u> y [HOut](../WDLang4/3044094.md) devuelve <u><u><u><u>True</u></u></u></u>.
<a name="NOTE0_3"></a>


### Varios
<a name="varios_ELTPARAGRAPHE000339"></a>

- El número actual de Record es devuelto por [HRecNum](../WDLang4/3044063.md).

- [HChangeKey](../WDLang4/3044151.md) se utiliza para modificar la clave de búsqueda mientras se mantiene posicionada en el record actual.



<a name="NOTE0_4"></a>


### comparison entre [HReadFirst](../WDLang4/3044051.md) y HFirst
<a name="comparison_entre_hreadfirstwdlang43044051md_docparampagetitleshort_ELTPARAGRAPHE000354"></a>

**HFirst** no lee el record: por lo tanto, **HFirst** es más rápido que [HReadFirst](../WDLang4/3044051.md).
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Bloqueos
<a name="bloqueos_ELTPARAGRAPHE000376"></a>

Por defecto (&lt;Opciones&gt; no especificadas), la Record no está bloqueada.

Si se solicita un bloqueo (constante *hLockWrite* o *hLockReadWrite*), la posición se fijará en el Record sólo si no está ya bloqueado.

<a name="XComponent"></a>

## Componente:
wd280hf.dll
