


## &lt;Variable Connection&gt;.RegenerateFile (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Vuelve a generar un archivo de datos a partir de su registro.

**Recordatorio**: Cuando un archivo de datos se pierde, puedes regenerarlo a partir de su tronco. Para ello, se recomienda utilizar la herramienta de mantenimiento del registro.


|   |
| --- |
| **Atención**: **&lt;Variable Connection&gt;.RegenerateFile** recrea un archivo de datos del registro description. <br><br>**Esta función se reserva para un uso avanzado.** Si no se utiliza correctamente, puede destruir o dañar los datos. |


<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) 
### Volver a generar un archivo de datos en modo HFSQL Client/Server

`<Result> = <Connection>.RegenerateFile(<Log file> [, <Password> [, <Destination directory>]] [, <Options> [, <Start date and time of restore operation> [, <End date and time of restore operation> [, <Progress bar of restore operation> [, <Reindexing progress bar>]]]]])`
---

**`<Result>: (Booleano)`**



- <u><u><u>True</u></u></u> si se volvió a generar el archivo de datos,

- <u><u><u>False</u></u></u> en caso contrario. La función [HError](../WDLang4/3044088.md) permite identificar el error.




**`<Connection>: (Variable de tipo Connection)`**

Nombre de la variable de tipo [Conexión](../WDLang4/1514073.md) que describe la conexión para la que se volverá a generar la base de datos.

**`<Log file>: (Cadena de caracteres (con comillas))`**

Nombre del archivo de registro a utilizar. La ruta de este archivo es relativa a la base de datos JNL de la conexión (ver [Estructura de los archivos de registro en modo Client/Server](../WDLang4/3044197.md)).

**`<Password>: (Cadena de caracteres opcional (con comillas))`**



- Contraseña del archivo de registro (igual a la contraseña definida para el archivo de datos). Esta contraseña es obligatoria para especificar un directorio de destino. 

- Cadena vacía ("") si no hay ninguna contraseña.




**`<Destination directory>: (Cadena de caracteres opcional (con comillas))`**

Nombre del directorio en el que se volverá a generar el archivo de datos. Este directorio es relativo a la base de datos definida por la conexión. Si no se define este parámetro, el archivo de datos se vuelve a generar en el directorio de origen.

**`<Options>: (Constante o combinación de constantes opcional)`**

Configura la regeneración del archivo de datos. Por defecto (ninguna opción seleccionada), la función no tiene ningún efecto.


|   |   |
| --- | --- |
| *hData* | Todas las operaciones del archivo de registro se aplican al archivo de datos existente. Los datos del archivo se actualizan a partir de los datos del registro. |
| *hStructure* | Se crea un nuevo archivo de datos vacío a partir de la descripción del archivo de datos que se encuentra en el archivo de registro. Si el archivo de datos ya existe, se elimina y vuelve a crear. |



**`<Start date and time of restore operation>: (Cadena de caracteres o variable de tipo DateTime opcional)`**

Fecha y hora (en formato AAAAMMDDHHmmSSCCC: AAAA: año, MM: mes, DD: día, HH: hora, mm: minutos, SS: segundos, CCC: centésimas de segundo) a partir de las que se reproducirán las operaciones del archivo de registro en el archivo de copia de seguridad. El archivo de datos se actualizará. Si no se especifica ninguna fecha y hora, se reproducirán todas las operaciones del archivo de registro.

**`<End date and time of restore operation>: (Cadena de caracteres o variable de tipo DateTime opcional)`**

Fecha y hora (en formato AAAAMMDDHHmmSSCCC: AAAA: año, MM: mes, DD: día, HH: hora, mm: minutos, SS: segundos, CCC: centésimas de segundo) hasta las que se reproducirán las operaciones del archivo de registro en el archivo de copia de seguridad. El archivo de datos se actualizará. Si no se especifica ninguna fecha y hora, se reproducirán todas las operaciones del archivo de registro.

**`<Progress bar of restore operation>: (Nombre de control opcional)`**

Nombre del control Barra de progreso de la ventana actual. Este control se utiliza para ver el progreso de la restauración.

**`<Reindexing progress bar>: (Nombre de control opcional)`**

Nombre del control Barra de progreso de la ventana actual. Este control se utiliza para ver el progreso de la reindexación de datos (una vez restaurados).


<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones
**&lt;Variable Connection&gt;.RegenerateFile** sólo puede utilizarse en archivos de datos HFSQL Classic o Cliente/Servidor que tengan registros.

<a name="XComponent"></a>

## Componente:
wd280hf.dll
