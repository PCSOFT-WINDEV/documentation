


## HSetIntegrity (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Activa o no la gestión de una restricción de integridad en una relación de un archivo de datos.

**Observación**: De forma predeterminada, todas las reglas de integridad definidas en la descripción del análisis están activadas.


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Disable the check for cardinalities on the link between an order and a customer
HSetIntegrity(CustomerOrder, hCardinality, False)
```
<a name="Example2"></a>

```wl
// Disable all integrity rules on all application data files
HSetIntegrity("*", "*", hCardinality + hOnUpdate + hOnDelete, False)
// equivalent to: HSetIntegrity(False)
```
<a name="Example3"></a>

```wl
// Disable integrity rules on the link between an order and a customer
// with use of a connection
CtSourceFile is Connection
CtLinkedFile is Connection

HSetIntegrity(CtSourceFile, CtLinkedFile, CustomerOrder, ... 
	hCardinality + hOnUpdate + hOnDelete, False)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Habilitar o deshabilitar la gestión de una restricción de integridad especificando el nombre del archivo

`<Result> = HSetIntegrity([<Link to use>] [, <Data file>] [, <Integrity constraint>] , <Management mode>)`
---

**`<Result>: (booleano)`**

Anterior gestión de la integridad (antes de llamar a la función **HSetIntegrity**): 

- <u><u><u><u>True</u></u></u></u> si la gestión de la integridad estaba activa,

- <u><u><u><u>False STRIMEULB</u></u></u></u> si la gestión de la integridad está desactivada. 


Si &lt;Relación a usar&gt; = "\*" o &lt;Archivo de datos&gt; = "\*", &lt;Resultado&gt; se establece en <u><u><u><u>True</u></u></u></u> si la integridad estaba activada en al menos una relación o archivo de datos.

**`<Link to use>: (Cadena de caracteres opcional)`**

Nombre del enlace relevante (nombre de los diferentes ficheros de datos implicados en el enlace). 
Si no se especifica este nombre o si es igual a "\*" ", la nueva gestión de la integridad se aplica a todos los enlaces definidos en el análisis.

**`<Data file>: (Cadena de caracteres opcional)`**

Nombre del archivo de datos utilizado. 
Si este parámetro no se especifica o es igual a "\*", la nueva gestión se aplica a todos los ficheros de datos implicados en el enlace (incluidos los alias)..
Si el parámetro &lt;Relación por utilizar&gt; corresponde a "\*", este parámetro también debe corresponder a "\*". De hecho, no se pueden activar o desactivar todas las restricciones de integridad para todos los enlaces que se encuentran en un archivo de datos específico.

**`<Integrity constraint>: (Constante o combinación de constantes de tipo Integer (opcional))`**

Se utiliza para definir las restricciones de integridad que deben gestionarse. Si no se especifica este parámetro, el nuevo modo de gestión se aplica a todas las restricciones de enlace.


|   |   |
| --- | --- |
| *hCardinality* | Comprueba el enlace cardinalidades. |
| *hOnDelete* | Regla de integridad aplicada durante un borrado. |
| *hOnUpdate* | Regla de integridad aplicada durante una modificación. |



**`<Management mode>: (booleano)`**



- <u><u><u><u>True STRIMEULB</u></u></u></u> si la restricción de integridad está activada,

- <u><u><u><u>False STRIMEULB</u></u></u></u> si esta gestión debe ser desactivada. Si sólo se especifica este parámetro, el modo de gestión se aplica a todos los archivos de datos.





<a name="SYNTAX2"></a>

### Activar o desactivar la gestión de una restricción de integridad especificando la conexión del archivo de datos

`<Result> = HSetIntegrity(<Source data file connection> [, <Linked data file connection>] , <Link description> [, <Integrity constraint>] , <Management mode>)`
---

**`<Result>: (booleano)`**

Anterior gestión de la integridad (antes de llamar a la función **HSetIntegrity**): 

- <u><u><u><u>True</u></u></u></u> si la gestión de la integridad estaba activa,

- <u><u><u><u>False STRIMEULB</u></u></u></u> si la gestión de la integridad está desactivada.




**`<Source data file connection>: (Cadena de caracteres o variable de tipo Connection)`**

La conexión a la que pertenece el archivo de datos de la fuente de enlace. Esta conexión corresponde a: 

- el nombre de la conexión definida en el editor de análisis o con las funciones [HDescribeConnection](../WDLang4/3044205.md) o [HOpenConnection](../WDLang4/3044107.md).

- el nombre de una variable de tipo [Conexión](../WDLang4/1514073.md).




**`<Linked data file connection>: (Cadena de caracteres opcional o variable de tipo Connection)`**

Conexión a la que pertenece el archivo de datos relacionado del enlace. Esta conexión corresponde a: 

- el nombre de la conexión definida en el editor de análisis o con las funciones [HDescribeConnection](../WDLang4/3044205.md) o [HOpenConnection](../WDLang4/3044107.md).

- el nombre de una variable de tipo [Conexión](../WDLang4/1514073.md).


Si no se especifica este parámetro, ambos archivos de datos pertenecerán a la misma conexión (&lt;Conexión del archivo de datos de la fuente&gt;).

**`<Link description>: (Variable de tipo Link Description)`**

Nombre de la [Descripción de la relación](../WDLang4/1514039.md) Variable que contiene las características del enlace.

**`<Integrity constraint>: (Constante o combinación de constantes de tipo Integer (opcional))`**

Restricciones de integridad que deben ser gestionadas. Si no se especifica este parámetro, el nuevo modo de gestión se aplica a todas las restricciones de enlace.


|   |   |
| --- | --- |
| *hCardinality* | Comprueba el enlace cardinalidades. |
| *hOnDelete* | Regla de integridad aplicada durante un borrado. |
| *hOnUpdate* | Regla de integridad aplicada durante una modificación. |



**`<Management mode>: (booleano)`**



- <u><u><u><u>True STRIMEULB</u></u></u></u> si la restricción de integridad está activada,

- <u><u><u><u>False STRIMEULB</u></u></u></u> si esta gestión debe ser desactivada. Si sólo se especifica este parámetro, el modo de gestión se aplica a todos los archivos de datos.  






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Permitir la gestión de la integridad
<a name="permitir_gestion_integridad_ELTPARAGRAPHE000248"></a>

Si una operación realizada en un archivo de datos provoca una violación de una restricción de integridad en una regla de Active, la operación no se realiza y provoca el error de la función. En este caso, la función [HErrorIntegrity](../WDLang4/3044086.md) devuelve <u><u><u><u>True</u></u></u></u>.

**Observación**: Sólo [HAdd](../WDLang4/3044147.md), [HModify](../WDLang4/3044042.md), [HDelete](../WDLang4/3044018.md), [HCross](../WDLang4/3044121.md) y [HWrite](../WDLang4/3044092.md) pueden generar un error de integridad.
<a name="NOTE0_2"></a>


### Desactivación de las reglas de integridad
<a name="desactivacion_las_reglas_integridad_ELTPARAGRAPHE000281"></a>

Desactivar una regla de integridad significa la posibilidad de no cumplir con las restricciones especificadas durante la description de los archivos de datos en la editor de análisis. Por lo tanto, la desactivación de una regla de integridad debe hacerse con sumo cuidado: debe usarse con precaución.
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) 

### En modo HFSQL Client/Server
<a name="modo_hfsql_clientserver_ELTPARAGRAPHE000292"></a>

El uso de la sintaxis **HSetIntegrity**(&lt;Gestión&gt;) afecta el comportamiento de todos los servidores HFSQL (independientemente de si la conexión se abre antes o después de llamar a la función **HSetIntegrity**).

Se puede utilizar la función **HSetIntegrity** especificando el nombre de la relación si:

- El vínculo se describe en el análisis del cliente (o por [HDescribeLink](../WDLang4/3044191.md)).

- Los dos archivos de datos relacionado por este enlace se encuentran en el mismo servidor HFSQL.




Si se llama a la función **HSetIntegrity** antes de que los archivos de datos estén en modo Client/Server (por ejemplo, si se utiliza la función [HChangeConnection](../WDLang4/3044150.md)), el servidor activa la regla de integridad.

Los derechos son associated con la gestión de la integridad en la base de datos: *hRightsManageIntegrity*. Se produce un error cuando el usuario intenta no cumplir con la restricción de integridad (cuando se utiliza [HAdd](../WDLang4/3044147.md), [HModify](../WDLang4/3044042.md), ...). 

<a name="XComponent"></a>

## Componente:
wd280hf.dll
