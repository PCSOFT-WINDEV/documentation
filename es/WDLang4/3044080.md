


## HExecuteQuery (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Declara una consulta al motor HFSQL y ejecuta la consulta. Esta consulta puede corresponder a: 

- una consulta creada en el editor de consultas. 

- una variable de tipo SQL Query. 


Se podrá navegar por el resultado de la consulta. Si ya existe una consulta con el mismo nombre, se reemplaza la consulta. El resultado se vuelve a calcular.

**Atención**: Para fijar la posición en la primera Record del resultado de la consulta, utilice [HReadFirst](../WDLang4/3044051.md), por ejemplo.

Para liberar los recursos de una consulta creada en el editor de consultas, utilice: 

- la función [HCancelDeclaration](../WDLang4/3044174.md).

- la función [HFreeQuery](../WDLang4/1000019374.md).




**Observación**: No se podrá iniciar una consulta si:

- el nombre de la consulta ya se utiliza en el análisis en curso (nombre de archivo de datos o nombre definido por una de las siguientes funciones: [HDeclare](../WDLang4/3044203.md), [HDeclareExternal](../WDLang4/3044204.md), [HDescribeFile](../WDLang4/3044206.md)).

- se encuentra un error de sintaxis en la consulta.


![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) No se pueden ejecutar consultas con código SQL que contengan funciones de WLanguage. 
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000003044080&name=hexecutequery_funcion&product=WD">Ver ejemplos adicionales</a>

```wl
// Initialize the "QRY_Customer_84" query
HExecuteQuery(QRY_Customer_84)
```
<a name="Example2"></a>

```wl
// Query on Oracle file: Customer uses the "MyConnection" connection
// QRY_MyQuery = "Select * from customers where CustomerID =?"
HExecuteQuery(QRY_MyQuery, hQueryDefault, 5)
```
<a name="Example3"></a>

```wl
// Runs and displays the data of a query not found in the project
// "QRY_List_Products.WDR" is a query created by "Reports & Queries"
// Declare a data source with the same logical name as the query. 
sQueryFile is string 
sQueryFile = fReportsAndQueriesDir() + ["\"] + "QRY_List_Products.WDR"
QRY_List_Products is Data Source

// Run the query for a family of products:
// FAMILY_CODE is a parameter of the query. 
HExecuteQuery(sQueryFile, hQueryDefault, FAMILY_CODE)

// Loop through the query
FOR EACH QRY_List_Products 
	TableAddLine(TABLE_PRODUCT, sQueryFile.PRODUCT_NAME, ...
		sQueryFile.DESIGNATION, sQueryFile.PriceBT)
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Ejecución de una consulta (sin conexión)

`<Result> = HExecuteQuery(<Query name> [, <Mode> [, <Parameter 1> [... [, <Parameter N>]]]])`
---

**`<Result>: (karaoke)`**



- <u><u><u><u>True</u></u></u></u> si se inició la consulta,

- <u><u><u><u>False</u></u></u></u> en caso contrario. La función [HErrorInfo](../WDLang4/3044071.md) permite obtener más detalles sobre el problema. 




**`<Query name>: (Cadena de caracteres)`**

Nombre de la consulta a ejecutar: 

- Nombre y ruta completa de la consulta (archivo ".WDR") a iniciar.
	![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) No disponible.

- Nombre lógico de la consulta que se va a inicializar.
	Si ya se ha declarado una consulta con el mismo nombre, se reemplaza por la nueva consulta.

- Nombre de una variable de tipo [consulta SQL](../Motscles/1514082.md). 
	




**`<Mode>: (Constante opcional de tipo Integer)`**

Opción para iniciar la consulta:


|   |   |
| --- | --- |
| *hCheckDuplicates* | Activa la gestión de duplicados durante la ejecución de la consulta. Si se detecta un error de duplicados, no se ejecuta la consulta.<br>Esta constante fuerza la constante *hWithTransaction* . Se inicia una transacción, los registros se bloquean durante la ejecución de la consulta y se desbloquean al final de su ejecución, independientemente del resultado de la consulta. Si la aplicación se detiene durante la ejecución de la consulta (corte de energía, por ejemplo), la transacción se cancelará la próxima vez que se utilicen los archivos de datos de la consulta.<br>Observación: La ejecución de la consulta puede ralentizarse.<br>![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) <br><br>- Si no se especifica la constante *hCheckDuplicates*, se desactiva la gestión de duplicados. <br><br>- Se produce un error si se debe realizar una operación de gestión de duplicados, pero el usuario no tiene derechos para activar/desactivar la gestión de duplicados ([HModifyDatabaseRights](../WDLang4/3044326.md)).<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hCheckIntegrity* | Activa la gestión de integridad durante la ejecución de la consulta. Si se detecta un error de integridad, no se ejecuta la consulta.<br>Esta constante fuerza la constante *hWithTransaction* . Se inicia una transacción, los registros se bloquean durante la ejecución de la consulta y se desbloquean al final de su ejecución, independientemente del resultado de la consulta. Si la aplicación se detiene durante la ejecución de la consulta (corte de energía, por ejemplo), la transacción se cancelará la próxima vez que se utilicen los archivos de datos de la consulta.<br>Observación: La ejecución de la consulta puede ralentizarse.<br>![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) <br><br>- Si no se especifica la constante *hCheckIntegrity*, se desactiva la gestión de la integridad. <br><br>- Se produce un error si se debe realizar una operación de gestión de la integridad, pero el usuario no tiene derechos para activar/desactivar la gestión de la integridad ([HModifyDatabaseRights](../WDLang4/3044326.md)).<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hModifyFile*<br>(se puede combinar con otras constantes) | **En archivos de datos HFSQL**: Cuando se modifica el resultado de la consulta ([HAdd](../WDLang4/3044147.md), [HWrite](../WDLang4/3044092.md), [HModify](../WDLang4/3044042.md), [HCross](../WDLang4/3044121.md) y [HDelete](../WDLang4/3044018.md)), estos cambios se propagan a los archivos de datos utilizados en la consulta.<br>Si no se especifica esta opción, solo se modifica el resultado de la consulta. <br>Para más detalles sobre la modificación del resultado de una consulta, véase [Modificar el contenido de una consulta](../WDLang4/3044234.md).<br>**En archivos de datos con un formato distinto a HFSQL**, no es necesario utilizar la función *hModifyFile*: los archivos de datos utilizados en la consulta se modifican automáticamente al modificar el resultado de la consulta.<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hNoHourglass* | Al leer el resultado de la consulta, esta operación de lectura puede bloquearse y aparece un reloj de arena de Default. Esta constante se utiliza para que no se muestre el reloj de arena. <br><br> |
| *hQueryBreakable* | El inicio de la consulta se puede interrumpir con la tecla ESC.<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Esta constante no está disponible.![Procedimientos almacenados](https://doc.pcsoft.fr/ext/images/us/PS.png) Esta constante no se tiene en cuenta.![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible.![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) La tecla Esc debe pulsarse en el equipo cliente. |
| *hQueryDefault*<br>(valor predeterminado) | La consulta se inicia sin interrupción. |
| *hQueryWithoutCorrection* | ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) El motor HFSQL no verifica la consulta. Esta opción debe utilizarse si la consulta contiene comandos específicos de un tipo de conexión (Oracle, SQL Server, etc.).<br><br>Atención: si se utiliza esta constante:<br><br>- se debe especificar el nombre de la conexión (parámetro &lt;Conexión&gt;).<br><br>- no se puede utilizar la función [HFilter](../WDLang4/3044100.md) en la consulta manipulada.<br><br>- no se puede cancelar una condición asignándola a NULL. <br><br>- no se debe especificar ningún elemento de navegación en las siguientes funciones: [HSeekLast](../WDLang4/3044129.md), [HSeekFirst](../WDLang4/3044125.md), [HReadFirst](../WDLang4/3044051.md), [HFirst](../WDLang4/3044113.md), [HLast](../WDLang4/3044101.md), [HReadLast](../WDLang4/3044140.md).<br><br><br> |
| *hQueryWithoutHFCorrection* | ![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png) El motor HFSQL no verifica el formato del archivo de datos (con o sin espacios). <br>Se debe utilizar si la consulta manipula archivos de datos HFSQL con un formato que se completa con espacios y con un formato que no se completa con espacios. |
| *hWithFilter*<br>(se puede combinar con otras constantes) | **Si se especifica este parámetro**:<br><br>- el resultado de la consulta corresponde a una selección de registros de tipo filtro si el motor HFSQL lo permite. De lo contrario, el resultado de la consulta corresponde a una vista HFSQL<br><br>- las siguientes operaciones no están disponibles: buscar en el resultado de la consulta, consulta a partir de una consulta, vista a partir de una consulta, consulta a partir de una vista.<br><br>- los elementos de navegación especificados al recorrer el resultado se ignoran.<br><br>- la lupa no está disponible en las tablas relacionadas con una consulta.<br><br>- no se puede utilizar la función [HNbRec](../WDLang4/3044006.md) en las consultas. <br>	Atención: si se especifica esta opción, la constante *hModifyFile* se utiliza automáticamente.<br><br><br>**Si no se especifica este parámetro (predeterminado)**:<br><br>- el resultado de la consulta corresponde a una vista HFSQL<br><br>- se pueden realizar las siguientes operaciones en las consultas: buscar en el resultado de la consulta, consulta a partir de una consulta, vista a partir de una consulta, consulta a partir de una vista.<br><br>- se tienen en cuenta los elementos de navegación especificados al recorrer el resultado.<br><br>- la lupa está disponible en las mesas relacionado para una consulta.<br><br>- se puede utilizar la función [HNbRec](../WDLang4/3044006.md) en las consultas.<br><br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hWithTransaction* | La consulta se ejecuta en una transacción.<br>Se inicia una transacción, los registros se bloquean durante la ejecución de la consulta y se desbloquean al final de su ejecución, independientemente del resultado de la consulta.<br>Si la consulta no puede terminar correctamente (registros bloqueados, fallo de alimentación, etc.), la transacción se cancela y los archivos de datos se restauran a su estado anterior (antes de la ejecución de la consulta).<br>Observación: La ejecución de la consulta puede ralentizarse.<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante no está disponible. |
| *hYield* | En las consultas UPDATE y DELETE, que se utilizan en un gran número de registros y suelen tomar mucho tiempo, esta constante devuelve el control a las demás aplicaciones que utilizan los archivos de datos.<br>En este caso:<br><br>- la consulta se ejecuta un poco más lento,<br><br>- el servidor de archivos no se satura,<br><br>- los demás usuarios de los archivos de datos pueden continuar accediendo a ellos sin ningún tipo de bloqueo.<br><br><br>![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Esta constante no se tiene en cuenta.![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |

![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Android y Java (acceso con JDBC): Este parámetro solo puede corresponder a las constantes *hQueryDefault* o *hQueryWithoutCorrection*. Si se utiliza otra constante, se ignorará. 

**`<Parameter 1>: (Tipo de parámetro)`**

Valores de los parámetros de la consulta en el orden que se definió al crear la consulta (visible en el editor de consultas). Cada parámetro debe corresponder al tipo esperado. Los parámetros están separados por una coma. 
Observaciones:

- El paso de parámetros en la función HExecuteQuery se conserva por motivos de compatibilidad. Se recomienda pasar los parámetros usando la siguiente notación: &lt;Nombre de la consulta&gt;.&lt;Nombre del parámetro&gt; = &lt;Valor&gt;. 

- Para especificar los parámetros de la consulta, se debe especificar el parámetro &lt;Modo&gt;.

- El valor de cada parámetro se puede especificar o no. 

- Puede especificar una lista de valores o una lista de parámetros. 


Para obtener más información, consulte [Pasar parámetros](#NOTE0_4).
Este parámetro no está disponible si &lt;Nombre de consulta&gt; corresponde a una variable de tipo SQL Query.



**`<Parameter N>: (Tipo de parámetro)`**

Valores de los parámetros de la consulta en el orden que se definió al crear la consulta (visible en el editor de consultas). Cada parámetro debe corresponder al tipo esperado. Los parámetros están separados por una coma. 
Observaciones:

- El paso de parámetros en la función HExecuteQuery se conserva por motivos de compatibilidad. Se recomienda pasar los parámetros usando la siguiente notación: &lt;Nombre de la consulta&gt;.&lt;Nombre del parámetro&gt; = &lt;Valor&gt;. 

- Para especificar los parámetros de la consulta, se debe especificar el parámetro &lt;Modo&gt;.

- El valor de cada parámetro se puede especificar o no. 

- Puede especificar una lista de valores o una lista de parámetros. 


Para obtener más información, consulte [Pasar parámetros](#NOTE0_4).
Este parámetro no está disponible si &lt;Nombre de consulta&gt; corresponde a una variable de tipo SQL Query.


<a name="SYNTAX2"></a>
![Procedimientos almacenados](https://doc.pcsoft.fr/ext/images/us/PS.png) Esta sintaxis no está disponible en los procedimientos almacenados
### Ejecución de una consulta a través de una conexión

`<Result> = HExecuteQuery(<Query name> [, <Connection> [, <Mode> [, <Parameter 1> [... [, <Parameter N>]]]]])`
---

**`<Result>: (karaoke)`**



- <u><u><u><u>True</u></u></u></u> si se inició la consulta,

- <u><u><u><u>False</u></u></u></u> en caso contrario. La función [HErrorInfo](../WDLang4/3044071.md) permite obtener más detalles sobre el problema. 




**`<Query name>: (Cadena de caracteres)`**

Nombre de la consulta a ejecutar: 

- Nombre y ruta completa de la consulta (archivo ".WDR") a iniciar.
	![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) No disponible.

- Nombre lógico de la consulta que se va a inicializar.
	Si ya se ha declarado una consulta con el mismo nombre, se reemplaza por la nueva consulta.

- Nombre de una variable de tipo [consulta SQL](../Motscles/1514082.md). 
	




**`<Connection>: (Cadena de caracteres opcional)`**

Nombre de la conexión, definida en el editor de análisis o dinámicamente con [HDescribeConnection](../WDLang4/3044205.md). La consulta se ejecutará a través de esta conexión.
![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Si no se especifica este parámetro y si la consulta afecta a ficheros de datos a los que se accede por OLE DB o por un acceso nativo, la consulta se ejecuta a través de la conexión utilizada por el primer fichero de datos encontrado en la consulta. Si se modifica la conexión utilizada por un archivo de datos antes de llamar a la función **HExecuteQuery**, se utiliza la nueva conexión.

**`<Mode>: (Constante opcional de tipo Integer)`**

Opción para iniciar la consulta:


|   |   |
| --- | --- |
| *hCheckDuplicates* | Activa la gestión de duplicados durante la ejecución de la consulta. Si se detecta un error de duplicados, no se ejecuta la consulta.<br>Esta constante fuerza la constante *hWithTransaction* . Se inicia una transacción, los registros se bloquean durante la ejecución de la consulta y se desbloquean al final de su ejecución, independientemente del resultado de la consulta. Si la aplicación se detiene durante la ejecución de la consulta (corte de energía, por ejemplo), la transacción se cancelará la próxima vez que se utilicen los archivos de datos de la consulta.<br>Observación: La ejecución de la consulta puede ralentizarse.<br>![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) <br><br>- Si no se especifica la constante *hCheckDuplicates*, se desactiva la gestión de duplicados. <br><br>- Se produce un error si se debe realizar una operación de gestión de duplicados, pero el usuario no tiene derechos para activar/desactivar la gestión de duplicados ([HModifyDatabaseRights](../WDLang4/3044326.md)).<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hCheckIntegrity* | Activa la gestión de integridad durante la ejecución de la consulta. Si se detecta un error de integridad, no se ejecuta la consulta.<br>Esta constante fuerza la constante *hWithTransaction* . Se inicia una transacción, los registros se bloquean durante la ejecución de la consulta y se desbloquean al final de su ejecución, independientemente del resultado de la consulta. Si la aplicación se detiene durante la ejecución de la consulta (corte de energía, por ejemplo), la transacción se cancelará la próxima vez que se utilicen los archivos de datos de la consulta.<br>Observación: La ejecución de la consulta puede ralentizarse.<br>![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) <br><br>- Si no se especifica la constante *hCheckIntegrity*, se desactiva la gestión de la integridad. <br><br>- Se produce un error si se debe realizar una operación de gestión de la integridad, pero el usuario no tiene derechos para activar/desactivar la gestión de la integridad ([HModifyDatabaseRights](../WDLang4/3044326.md)).<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hModifyFile*<br>(se puede combinar con otras constantes) | **En archivos de datos HFSQL**: Cuando se modifica el resultado de la consulta ([HAdd](../WDLang4/3044147.md), [HWrite](../WDLang4/3044092.md), [HModify](../WDLang4/3044042.md), [HCross](../WDLang4/3044121.md) y [HDelete](../WDLang4/3044018.md)), estos cambios se propagan a los archivos de datos utilizados en la consulta.<br>Si no se especifica esta opción, solo se modifica el resultado de la consulta. <br>Para más detalles sobre la modificación del resultado de una consulta, véase [Modificar el contenido de una consulta](../WDLang4/3044234.md).<br>**En archivos de datos con un formato distinto a HFSQL**, no es necesario utilizar la función *hModifyFile*: los archivos de datos utilizados en la consulta se modifican automáticamente al modificar el resultado de la consulta.<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hNoHourglass* | Al leer el resultado de la consulta, esta operación de lectura puede bloquearse y aparece un reloj de arena de Default. Esta constante se utiliza para que no se muestre el reloj de arena. <br><br> |
| *hQueryBreakable* | El inicio de la consulta se puede interrumpir con la tecla ESC.<br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Esta constante no está disponible.![Procedimientos almacenados](https://doc.pcsoft.fr/ext/images/us/PS.png) Esta constante no se tiene en cuenta.![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible.![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) La tecla Esc debe pulsarse en el equipo cliente. |
| *hQueryDefault*<br>(valor predeterminado) | La consulta se inicia sin interrupción. |
| *hQueryWithoutCorrection* | ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) El motor HFSQL no verifica la consulta. Esta opción debe utilizarse si la consulta contiene comandos específicos de un tipo de conexión (Oracle, SQL Server, etc.).<br><br>Atención: si se utiliza esta constante:<br><br>- se debe especificar el nombre de la conexión (parámetro &lt;Conexión&gt;).<br><br>- no se puede utilizar la función [HFilter](../WDLang4/3044100.md) en la consulta manipulada.<br><br>- no se puede cancelar una condición asignándola a NULL. <br><br>- no se debe especificar ningún elemento de navegación en las siguientes funciones: [HSeekLast](../WDLang4/3044129.md), [HSeekFirst](../WDLang4/3044125.md), [HReadFirst](../WDLang4/3044051.md), [HFirst](../WDLang4/3044113.md), [HLast](../WDLang4/3044101.md), [HReadLast](../WDLang4/3044140.md).<br><br><br> |
| *hQueryWithoutHFCorrection* | ![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png) El motor HFSQL no verifica el formato del archivo de datos (con o sin espacios). <br>Se debe utilizar si la consulta manipula archivos de datos HFSQL con un formato que se completa con espacios y con un formato que no se completa con espacios. |
| *hWithFilter*<br>(se puede combinar con otras constantes) | **Si se especifica este parámetro**:<br><br>- el resultado de la consulta corresponde a una selección de registros de tipo filtro si el motor HFSQL lo permite. De lo contrario, el resultado de la consulta corresponde a una vista HFSQL<br><br>- las siguientes operaciones no están disponibles: buscar en el resultado de la consulta, consulta a partir de una consulta, vista a partir de una consulta, consulta a partir de una vista.<br><br>- los elementos de navegación especificados al recorrer el resultado se ignoran.<br><br>- la lupa no está disponible en las tablas relacionadas con una consulta.<br><br>- no se puede utilizar la función [HNbRec](../WDLang4/3044006.md) en las consultas. <br>	Atención: si se especifica esta opción, la constante *hModifyFile* se utiliza automáticamente.<br><br><br>**Si no se especifica este parámetro (predeterminado)**:<br><br>- el resultado de la consulta corresponde a una vista HFSQL<br><br>- se pueden realizar las siguientes operaciones en las consultas: buscar en el resultado de la consulta, consulta a partir de una consulta, vista a partir de una consulta, consulta a partir de una vista.<br><br>- se tienen en cuenta los elementos de navegación especificados al recorrer el resultado.<br><br>- la lupa está disponible en las mesas relacionado para una consulta.<br><br>- se puede utilizar la función [HNbRec](../WDLang4/3044006.md) en las consultas.<br><br><br><br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |
| *hWithTransaction* | La consulta se ejecuta en una transacción.<br>Se inicia una transacción, los registros se bloquean durante la ejecución de la consulta y se desbloquean al final de su ejecución, independientemente del resultado de la consulta.<br>Si la consulta no puede terminar correctamente (registros bloqueados, fallo de alimentación, etc.), la transacción se cancela y los archivos de datos se restauran a su estado anterior (antes de la ejecución de la consulta).<br>Observación: La ejecución de la consulta puede ralentizarse.<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante no está disponible. |
| *hYield* | En las consultas UPDATE y DELETE, que se utilizan en un gran número de registros y suelen tomar mucho tiempo, esta constante devuelve el control a las demás aplicaciones que utilizan los archivos de datos.<br>En este caso:<br><br>- la consulta se ejecuta un poco más lento,<br><br>- el servidor de archivos no se satura,<br><br>- los demás usuarios de los archivos de datos pueden continuar accediendo a ellos sin ningún tipo de bloqueo.<br><br><br>![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Esta constante no se tiene en cuenta.![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Esta constante no está disponible. |

![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Android y Java (acceso con JDBC): Este parámetro solo puede corresponder a las constantes *hQueryDefault* o *hQueryWithoutCorrection*. Si se utiliza otra constante, se ignorará. 

**`<Parameter 1>: (Tipo de parámetro)`**

Valores de los parámetros de la consulta en el orden que se definió al crear la consulta (visible en el editor de consultas). Cada parámetro debe corresponder al tipo esperado. Los parámetros están separados por una coma. 
Observaciones:

- El paso de parámetros en la función HExecuteQuery se conserva por motivos de compatibilidad. Se recomienda pasar los parámetros usando la siguiente notación: &lt;Nombre de la consulta&gt;.&lt;Nombre del parámetro&gt; = &lt;Valor&gt;. 

- Para especificar los parámetros de la consulta, se debe especificar el parámetro &lt;Modo&gt;.

- El valor de cada parámetro se puede especificar o no. 

- Puede especificar una lista de valores o una lista de parámetros. 


Para obtener más información, consulte [Pasar parámetros](#NOTE0_4).
Este parámetro no está disponible si &lt;Nombre de consulta&gt; corresponde a una variable de tipo SQL Query.



**`<Parameter N>: (Tipo de parámetro)`**

Valores de los parámetros de la consulta en el orden que se definió al crear la consulta (visible en el editor de consultas). Cada parámetro debe corresponder al tipo esperado. Los parámetros están separados por una coma. 
Observaciones:

- El paso de parámetros en la función HExecuteQuery se conserva por motivos de compatibilidad. Se recomienda pasar los parámetros usando la siguiente notación: &lt;Nombre de la consulta&gt;.&lt;Nombre del parámetro&gt; = &lt;Valor&gt;. 

- Para especificar los parámetros de la consulta, se debe especificar el parámetro &lt;Modo&gt;.

- El valor de cada parámetro se puede especificar o no. 

- Puede especificar una lista de valores o una lista de parámetros. 


Para obtener más información, consulte [Pasar parámetros](#NOTE0_4).
Este parámetro no está disponible si &lt;Nombre de consulta&gt; corresponde a una variable de tipo SQL Query.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Lectura de datos durante la inicialización de la consulta
<a name="lectura_datos_durante_inicializacion_consulta_ELTPARAGRAPHE000508"></a>

Dependiendo de la consulta (orden, grupos, etc.), los datos se pueden leer o no al iniciar la consulta.

Observación: La propiedad [ExecutionCompleted](../Proprietes/2512117.md) permite saber si se ha completado la consulta (y, por lo tanto, si se pueden realizar lecturas sin bloqueos).. 
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Agregar registros y utilizar la constante hModifyFile
<a name="agregar_registros_utilizar_constante_hmodifyfile_ELTPARAGRAPHE000524"></a>

![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png) Al agregar registros a un archivo de datos mediante una consulta, se tienen en cuenta los registros agregados al archivo de datos independientemente de la condición definida en la consulta. El número de registros de la consulta se modifica sistemáticamente.![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Al agregar registros a un archivo de datos mediante una consulta, se tiene en cuenta la condición definida en la consulta. El número de registros de la consulta se modifica solo si los registros agregados al archivo de datos corresponden a esta condición.
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Uso de la constante hQueryWithoutCorrection
<a name="uso_constante_hquerywithoutcorrection_ELTPARAGRAPHE000540"></a>

Por defecto, WINDEV y WEBDEV interpretan las consultas SQL en OLE DB y ODBC a través del proveedor OLE DB. Para no interpretar la consulta, utilice la constante *hQueryWithoutCorrection*.

La constante *hQueryWithoutCorrection* puede utilizarse si se introduce directamente el código SQL de la consulta en el editor de consultas.

| Si no se especifica hQueryWithoutCorrection | Si se especifica hQueryWithoutCorrection |
| --- | --- |
| La conexión associated con los archivos de datos de la consulta se define automáticamente. | La conexión a utilizar debe especificarse en la función **HExecuteSQLQuery**. |
| Todos los letreros de propiedad de PC SOFT son reemplazados (por ejemplo.: ']=' comienza con) con su equivalente en SQL estándar. | No se realiza ningún reemplazo. Se deben utilizar los símbolos de SQL estándar. |
| Las fechas y horas adoptan el formato utilizado por la base de datos.<br>Por ejemplo, las fechas están en formato 'AAAAMMDD' en WINDEV y WEBDEV mientras que en Access, las fechas están en formato #AAAADDMM# o #AAAAMMDD# dependiendo del idioma del sistema. | No se define ningún formato. Se debe utilizar el formato reconocido por las bases de datos. |
| Los flotadores están formateados (el separador decimal puede ser '.' o ',') | No se define ningún formato para las comas flotantes. |
| Dependiendo de la base de datos utilizada, los alias se reemplazan por los nombres completos de los elementos en las cláusulas Where, Order by y Group by<br>Por ejemplo, el motor JET (Access, dBase, etc.) no acepta ningún alias en la cláusula Where de una consulta | No se realiza ningún reemplazo. Se deben utilizar los nombres completos de los elementos directamente en el código de la consulta, en las cláusulas Where, Order by y Group by. |


<a name="NOTE0_4"></a>


### Pasar parámetros a la consulta
<a name="pasar_parametros_consulta_ELTPARAGRAPHE000583"></a>

Se pueden utilizar varios métodos para pasar parámetros a una consulta: 

1. Pasando los parámetros con la siguiente notación: &lt;Nombre de la consulta&gt;.&lt;Nombre del parámetro&gt; = &lt;Valor&gt; (recomendado)

2. Pasar parámetros directamente a la función **HExecuteQuery** (se conserva por motivos de compatibilidad, compatible con PHP).




Para más detalles sobre las diferentes formas de pasar parámetros a una consulta, sus ventajas y desventajas, véase [Métodos a utilizar para pasar parámetros a una consulta](../Editeurs/2032050.md).

Veamos los dos siguientes métodos: 

1. **Pasar los parámetros con la siguiente notación: &lt;Nombre de la consulta&gt;.&lt;Nombre del parámetro&gt; = &lt;Valor&gt; (recomendado)**
	Para pasar parámetros a una consulta con parámetros antes de ejecutarla, también puede utilizar la siguiente sintaxis:
	
	```txt
	<Query name>.<Name of parameter 1> = xxx
	<Query name>.<Name of parameter 2> = xxx
	<Query name>.<Name of parameter 3> = xxx
	HExecuteQuery(<Query name>)
	IF ErrorOccurred = True THEN ...
	```

	**Observaciones**:

	- Esta sintaxis hace que sea más fácil pasar parámetros. Si los parámetros se pasan directamente a la función **HExecuteQuery**, se debe respetar el orden de los parámetros.

	- La estructura de los parámetros de consulta se restablece cada vez que se ejecuta la consulta.




2. **Pasar parámetros directamente en la función HExecuteQuery (se conserva por motivos de compatibilidad)**
	En este caso, se deben especificar los valores de los parámetros de la consulta en el orden que se definió al crear la consulta (visible en el editor de consultas). Cada parámetro debe corresponder al tipo esperado. Los parámetros están separados por una coma. El valor de cada parámetro se puede especificar o no. 
	Se puede ignorar un parámetro utilizando el valor **Null**. En este caso, se ignorarán las condiciones de selección que utilizan este parámetro.
	
	**Puede especificar una lista de valores o una lista de parámetros.**
	Si la condición de selección para uno de los parámetros de la consulta es "está en la lista" o "no está en la lista", se debe especificar una lista de valores o parámetros.
	Para especificar una lista de valores o una lista de parámetros, los diferentes valores o parámetros deben estar separados por un punto y coma (';'), un retorno de carro ('CR') o una tabulación ('TAB').
	Por ejemplo: 
	
	```wl
	HExecuteQuery(QueryName, hQueryDefault, "34000;34200;34400")
	```
o
	```wl
	HExecuteQuery(QueryName, hQueryDefault, "34000 "+ CR + "34200" + CR + "34400")
	```
o
	```wl
	HExecuteQuery(QueryName, hQueryDefault, "34000" + TAB + "34200" + TAB + "34400")
	```

	**Observación**: Si uno de los valores o parámetros contiene un punto y coma, un retorno de carro o una tabulación, este valor o parámetro debe ir entre comillas. Por ejemplo:
	
	```wl
	HExecuteQuery(QueryName,hQueryDefault, "'A;A';'A;B';'A;C'")
	```

	Observación: No es necesario especificar todos los parámetros de consulta. Las condiciones de la consulta que utilizan parámetros no especificados se ignorarán.. 
	**Ejemplo**: Consideremos la consulta "Cliente_Apellido_Nombre" cuyo código SQL es el siguiente:
	
	```sql
	SELECT * FROM CUSTOMER WHERE LASTNAME = {Param1} AND FIRSTNAME = {Param2}
	```


	- Si se especifican los 2 parámetros:
			
		```wl
		HExecuteQuery(QRY_Customers_LastName_FirstName, hQueryDefault, "Smith", "John")
		```
 ejecutará la consulta
		```sql
		SELECT * FROM CUSTOMER WHERE LASTNAME = 'Smith' AND FIRSTNAME = 'John'
		```


	- Si solo se especifica el apellido: 
			
		```wl
		HExecuteQuery(QRY_Customers_LastName_FirstName, hQueryDefault, "Smith")
		```
 ejecutará la consulta
		```sql
		SELECT * FROM CUSTOMER WHERE LASTNAME= 'Smith'
		```


	- Si solo se especifica el nombre: 
			
		```wl
		sLastName is Variant = Null 
		// Use the mandatory variant for the Null variable (not filled)
		
		HExecuteQuery(QRY_Customers_LastName_FirstName, hQueryDefault, sLastName, "John")
		
		or
		
		HExecuteQuery(QRY_Customers_LastName_FirstName, hQueryDefault, Null, "John")
		```
 ejecutará la consulta
		```sql
		SELECT * FROM CUSTOMER WHERE FIRSTNAME= 'John'
		```







<a name="NOTE0_7"></a>
![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) 

### **HExecuteQuery** y acceso mediante JDBC
<a name="docparampagetitleshort_acceso_mediante_jdbc_ELTPARAGRAPHE000700"></a>

Si el nombre físico de un archivo de datos utilizado en la consulta difiere de su nombre lógico en el código SQL, el nombre de los elementos debe ir precedido del nombre físico del archivo de datos y no del nombre lógico. También es posible no ponerle el prefijo a los nombres de los artículos.
<a name="NOTE0_8"></a>


### Liberar recursos de la consulta
<a name="liberar_recursos_consulta_ELTPARAGRAPHE000711"></a>

Para liberar recursos de una consulta, utilice: 

- la función [HCancelDeclaration](../WDLang4/3044174.md).

- la función [HFreeQuery](../WDLang4/1000019374.md).




Si no se realiza esta operación, la consulta siempre se encuentra en el contexto HFSQL actual y se puede acceder a ella desde cualquier proceso.

**Observaciones**: 

- Los recursos de la consulta no se liberan automáticamente cuando se cierra la ventana que ejecutó la consulta (mediante **HExecuteQuery**).

- La consulta SQL Variable se libera automáticamente al final del alcance de Variable. Para obtener más información, consulte [Consultas SQL en WLanguage](../Motscles/1514082.md).



<a name="NOTE0_9"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) 

### Optimizar consultas en archivos de datos HFSQL
<a name="optimizar_consultas_archivos_datos_hfsql_ELTPARAGRAPHE000747"></a>

- Para optimizar el tiempo de ejecución de la consulta, utilice [HOptimize](../WDLang4/3044005.md) o [HOptimizeQuery](../WDLang4/3044003.md) en los diferentes archivos de datos incluidos en la consulta.

- Para optimizar el tiempo de procesamiento de la consulta, utilice [HStatCalculate](../WDLang4/3044134.md) o [HIndex](../WDLang4/3044133.md) en todos los archivos de datos incluidos en la consulta.



<a name="NOTE0_10"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Ejecución de una consulta y control Tabla basado en esta consulta
<a name="ejecucion_una_consulta_control_tabla_basado_esta_consulta_ELTPARAGRAPHE000771"></a>

Para obtener más información, consulte [Control Tabla archivo de datos y gestión de consultas](../WDChamp/1013203.md).
<a name="NOTE0_11"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Ejecución de una consulta y de una reporte basada en esta consulta
<a name="ejecucion_una_consulta_una_reporte_basada_esta_consulta_ELTPARAGRAPHE000785"></a>

Al imprimir una reporte basada en una consulta, si la consulta ya se ha ejecutado, no se vuelve a ejecutar. Para volver a ejecutar la consulta (para añadir registros, por ejemplo), basta con utilizar **HExecuteQuery** o [iInitReportQuery](../WDLang5/3046021.md).
<a name="NOTE0_12"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Consultas SQL (**HExecuteQuery** o ejecución de consultas SQL creadas en el editor de consultas)
<a name="consultas_sql_docparampagetitleshort_ejecucion_consultas_sql_creadas_editor_consultas_ELTPARAGRAPHE000801"></a>

- Al utilizar las instrucciones DELETE, INSERT o UPDATE en las consultas SQL, por defecto, no se realiza ningún control de integridad ni de duplicados en una base de datos HFSQL.

	- **To realizar un chequeo de integridad automático**, simplemente especifica la constante *hCheckIntegrity*. Esta constante permite activar la gestión de la integridad al ejecutar la consulta. Si se detecta un error de integridad, no se ejecuta la consulta. Se inicia una transacción, los registros se bloquean en escritura durante la ejecución de la consulta y se desbloquean al final de su ejecución, independientemente del resultado de la consulta. Si la aplicación se detiene durante la ejecución de la consulta (corte de energía, por ejemplo), la transacción se cancelará la próxima vez que se utilicen los archivos de datos de la consulta.
			![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) Si no se especifica la constante *hCheckIntegrity*, se desactiva la gestión de la integridad. Sin embargo, se produce un error si se debe realizar una operación de gestión de la integridad, pero el usuario no tiene derechos para desactivar la gestión de la integridad ([HModifyDatabaseRights](../WDLang4/3044326.md)).

	- **To realizar una comprobación automática de los duplicados**, simplemente especifique la constante *hCheckDuplicates*. Esta constante permite activar la gestión de duplicados al ejecutar la consulta. Si se detecta un error de duplicados, no se ejecuta la consulta. Se inicia una transacción, los registros se bloquean en escritura durante la ejecución de la consulta y se desbloquean al final de su ejecución, independientemente del resultado de la consulta. Si la aplicación se detiene durante la ejecución de la consulta (corte de energía, por ejemplo), la transacción se cancelará la próxima vez que se utilicen los archivos de datos de la consulta.
			Nota: Si se detecta un error de duplicados durante la ejecución de una consulta UPDATE, la función **HExecuteQuery** devuelve <u><u><u><u>False</u></u></u></u> y el proceso continúa. El error correspondiente puede conocerse con la función [HErrorInfo](../WDLang4/3044071.md).
			**Observación**: La asistencia automática predeterminada no se llama para los errores de duplicados. Se genera un error simple de duplicados. Si se definió una asistencia con la función [HOnError](../WDLang4/3044017.md), se llama a esta asistencia personalizada.
			![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) Si no se especifica la constante *hCheckDuplicates*, se desactiva la gestión de duplicados. Se produce un error si se debe realizar una operación de gestión de duplicados, pero el usuario no tiene derechos para desactivar la gestión de duplicados ([HModifyDatabaseRights](../WDLang4/3044326.md)).




- Las consultas UPDATE, DELETE e INSERT solo existen durante su ejecución. No se puede utilizar una función WLanguage en este tipo de consulta después de que ha sido ejecutada.

- Las consultas de tipo DELETE no admiten la eliminación en cascada.

- **Al ejecutar una consulta INSERT/UPDATE/DELETE en archivos de datos HFSQL**, el número de registros añadidos, modificados o eliminados es devuelto por el [H.NbRecModificationQuery](../WDLang4/3087002.md) Variable.




<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Lógica de negocio
## Componente:
wd280hf.dll
