


## Cliente/Servidor: Conexión de los ordenadores cliente al servidor
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000279"></a>
Para que la aplicación pueda manipular los ficheros de datos que se encuentran en el servidor HFSQL, la conexión que utilizará la aplicación debe estar definida en el proyecto.. Se puede definir la conexión:

- desde el editor de análisis.

- mediante programación.




También tiene la posibilidad de permitir que una aplicación utilice una base de datos HFSQL Client/Server o una base de datos HFSQL Classic.

Los archivos de datos a los que se accede por un servidor HFSQL son accesibles a través de este servidor solamente. No se puede acceder a ellos directamente por otra aplicación, especialmente a través del motor HFSQL Classic. Se requiere una conexión con el servidor para acceder a estos archivos de datos.

**Observación**: Se pueden definir varias conexiones si la aplicación utiliza varias bases de datos o varios servidores.


<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Definir las conexiones desde el editor de análisis
<a name="definir_las_conexiones_desde_editor_analisis_ELTTEXTE000309"></a>
Para definir una conexión desde el editor de análisis:

1. En la pestaña "Análisis", en el grupo "Conexión", haga clic en "Nueva conexión". Comienza la asistente para definir una nueva conexión.

2. Conserve la opción "HFSQL Client/Server" y pase a la etapa siguiente.

3. En los diferentes pasos de la asistente, introduzca la información solicitada: 

	- nombre del servidor,

	- número del puerto de red,

	- nombre y contraseña del usuario,

	- base de datos,

	- nombre y pie de foto de la conexión. 




4. Valide el asistente.
	Una caja de diálogo le permite asociar los archivos de datos con esta nueva conexión. Aceptar.

5. Seleccionar los archivos de datos a asociar y validar. Los archivos de datos existentes se pueden copiar directamente en el servidor HFSQL. Esta operación se puede realizar más tarde si es necesario.

6. Mostrar la lista de conexiones: en la pestaña "Análisis", en el grupo "Conexión", haga clic en "Conexiones".

	- Ejecute la prueba de esta nueva conexión si es necesario: haga clic en el botón "Ejecutar prueba".

	- Las diferentes pestañas se utilizan para ver y modificar las características de las conexiones: 

		- "Ficha"Propiedades: características de la conexión definida en la asistente (nombre, título, tipo, ...)

		- pestaña "Avanzado": Número de puerto de la conexión, opciones para comprimir y encriptar los datos de conexión. 
						Si los archivos de datos que utilizan la conexión están encriptados, la conexión también debe estar encriptada.. 

		- "Pestaña"Usado por: Lista de archivos de datos que utilizan la conexión. 




7. Cierre la ventana de conexiones definidas.




En tiempo de ejecución, la conexión associated con el archivo de datos utilizada se abrirá automáticamente durante el primer acceso a este archivo de datos.

Los archivos de datos associated con una conexión "HFSQL Client/Server" se transforman automáticamente en archivos de datos "HFSQL Client/Server".

Para identificarlos, en la parte inferior de la descripción gráfica de los archivos de datos aparece la indicación "HF/CS".. Además, el color associated con esta zona se vuelve naranja: <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=PictoHFSQLCS.gif)

<a name="NOTE2_2"></a>


### Encriptación de una conexión
<a name="encriptacion_una_conexion_ELTPARAGRAPHE000089"></a>

Para encriptar una conexión: 

1. Mostrar la description de la conexión: en la pestaña "Análisis", en el grupo "Conexión", haga clic en "Conexiones".

2. Seleccione la conexión que desea cifrar.

3. Vaya a la pestaña "Avanzado".

4. Seleccione el modo de cifrado: Rápido o RC5 (16 rondas).

5. Valide.




Observación: Si los archivos de datos que utilizan la conexión están encriptados, la conexión también debe estar encriptada.. 

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Definir las conexiones a través de la programación
<a name="definir_las_conexiones_traves_programacion_ELTTEXTE000339"></a>
Se pueden utilizar varios métodos para definir una conexión a través de la programación:

- Utilizando las funciones [HDescribeConnection](../WDLang4/3044205.md) o [HOpenConnection](../WDLang4/3044107.md).

- Utilización del tipo [Conexión](../WDLang4/1514073.md) y sus propiedades.



<a name="NOTE3_2"></a>


### Definición de una conexión con HDescribeConnection u HOpenConnection
<a name="definicion_una_conexion_con_hdescribeconnection_hopenconnection_ELTPARAGRAPHE000135"></a>

Para definir una conexión con **HDescribeConexión** o **HOpenConexión**: 


1. Definir la conexión con [HDescribeConnection](../WDLang4/3044205.md) o [HOpenConnection](../WDLang4/3044107.md).
	El parámetro &lt;Fuente de datos&gt; debe corresponder al nombre o IP Address del servidor que será utilizado. Si el puerto de red a utilizar difiere del puerto Default (puerto 4900), &lt;Fuente de datos&gt; debe tener el siguiente formato: 
	"&lt;NombreDirecciónIPDelServidor&gt;:&lt;NúmeroDePuerto&gt;".
	El parámetro &lt;Proveedor OLEDB o Conector Nativo&gt; debe corresponder a la constante *hAccessHFClientServer*.
	Por ejemplo:
	
	```wl
	HDescribeConnection("MyConnection", "Julia", "Password", "MyHFServer", ...
				"MyDatabase", hAccessHFClientServer, HORead)
	```

	o
	
	```wl
	HOpenConnection("ConnectionServer", "Stephen", "", "DataServer:5400", ...
				"MyData", hAccessHFClientServer)
	```


2. Abra la conexión con la función **HOpenConnection**.
	Esta etapa no es necesaria si se definió y abrió la conexión en la etapa anterior con la función **HOpenConnection**.
	

3. Asociar la conexión con los diferentes ficheros de datos mediante [HChangeConnection](../WDLang4/3044150.md).
	Por ejemplo: 
	
	```wl
	HChangeConnection(Customer, "MyConnection")
	```

	o, para asociar todos los archivos de análisis a la conexión: 
	
	```wl
	HChangeConnection("*", "ConnectionServer")
	```



**Observación**: Para cifrar la conexión, solo se debe especificar la información ampliada ("ENCRYPTION = FAST" o "ENCRYPTION = RC5_16"). Para más detalles, consulte la documentación sobre [HDescribeConnection](../WDLang4/3044205.md) o [HOpenConnection](../WDLang4/3044107.md).
<a name="NOTE3_3"></a>


### Definición de una conexión mediante el Tipo de conexión
<a name="definicion_una_conexion_mediante_tipo_conexion_ELTPARAGRAPHE000189"></a>

Para definir una conexión mediante el tipo [Conexión](../WDLang4/1514073.md): 

1. Definir la conexión mediante el tipo [Conexión](../WDLang4/1514073.md) y sus propiedades.
	Por ejemplo:
	
	```wl
	MyConnection is Connection
	// Describe the connection
	MyConnection.User = "USER"
	MyConnection.Password = "PASSWORD"
	MyConnection.Server = "MYSERVER" 
	MyConnection.Database = "Database"
	MyConnection.Provider = hAccessHFClientServer
	MyConnection.Access = hOReadWrite
	MyConnection.ExtendedInfo = "Extended information"
	MyConnection.CursorOptions = hClientCursor
	```


2. Abra la conexión con la función **HOpenConnection**.
	Por ejemplo:
	
	```wl
	MyConnection is Connection
	// Describe the connection
	MyConnection.User = "USER"
	MyConnection.Password = "PASSWORD"
	MyConnection.Server = "MYSERVER" 
	MyConnection.Database = "Database"
	MyConnection.Provider = hAccessHFClientServer
	MyConnection.Access = hOReadWrite
	MyConnection.ExtendedInfo = "Extended information"
	MyConnection.CursorOptions = hClientCursor
	```



**Observación**: Para cifrar la conexión, basta con utilizar el [CryptMethod](../Proprietes/2512102.md) Property en la conexión.
Por ejemplo:

```wl
MyConnection is Connection
// Describe the connection
MyConnection.User = "USER"
MyConnection.Password = "PASSWORD"
MyConnection.Server = "MYSERVER" 
MyConnection.Database = "Database"
MyConnection.CryptMethod = hCryptRC5_16
MyConnection.Provider = hAccessHFClientServer
MyConnection.Access = hOReadWrite
MyConnection.ExtendedInfo = "Extended information"

HOpenConnection(MyConnection)
```


<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Permitir que una aplicación WINDEV utilice una base de datos HFSQL Client/Server o una base de datos HFSQL Classic
<a name="permitir_que_una_aplicacion_windev_utilice_una_base_datos_hfsql_clientserver_una_base_datos_hfsql_classic_ELTTEXTE000377"></a>
Dos funciones de WLanguage permiten utilizar cualquier base de datos elegida en tiempo de ejecución. Independientemente del tipo de archivos de datos especificados en el análisis.

Esto puede ser muy useful para una aplicación instalada en un ordenador portátil:

- conectado a la red, la aplicación utiliza la base de datos HFSQL Client/Server,

- Desconectado, la aplicación utiliza un copy local de la base de datos.




El código que se debe utilizar (al principio del proyecto, antes de utilizar los archivos de datos) es el siguiente:


```wl
ServerAddress is string = "198.168.1.120"

IF Ping(ServerAddress) THEN
	// The server is accessible, HF C/S connection
	HOpenConnection("HFCSConnection", "admin", "", ServerAddress, "CRM", hAccessHFClientServer)
    	HChangeConnection("*", "HFCSConnection")
    	Info("Connected mode to the network database.")
ELSE
   	// The server does not respond, use the local HF database
   	HOpenConnection("LocalHFConnection", "", "", "C:\Data Directory\", "", hAccessHF7)
   	HChangeConnection("*", "LocalHFConnection")
   	Info("Disconnected mode, you are using your data locally.")
END
```



