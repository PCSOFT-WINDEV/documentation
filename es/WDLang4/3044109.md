


## HGetCurrentPosition (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Devuelve la posición aproximada del registro actual en el archivo de datos. Esta posición se da en relación con un punto específico.

**Observación**: La posición se da aproximadamente por razones de rendimiento. La posición se calcula según la posición en el índice.

<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
HSeek(Customer, Name, "Smith")
IF HFound(Customer) = True THEN
	Percentage is int = HGetCurrentPosition(Customer, Name)/10
	Info("The first Smith is at " + Percentage + "% of Customer on the Name key")
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = HGetCurrentPosition([<Data file> [, <Item>] [, <Precision>]])`
---

**`<Result>: (Integro)`**



- Posición actual aproximada, trazada a la [ 1;1000] interval. 

- -1 si se produce un error (archivo de datos vacío, el filtro no devuelve ningún resultado, etc.). La función [HErrorInfo](../WDLang4/3044071.md) permite obtener más detalles sobre el problema.




**`<Data file>: (Cadena de caracteres opcional)`**

Nombre del archivo de datos utilizado. Si no se especifica este nombre, la función **HGetCurrentPosition** utilizará el último archivo de datos utilizado por la última función HFSQL (que empieza por "H").

**`<Item>: (Cadena de caracteres opcional)`**

Nombre del campo utilizado. Si no se especifica este nombre, **HGetCurrentPosition** utilizará el último elemento utilizado por la última función de gestión HFSQL (función que empieza por "H").

**`<Precision>: (Entero opcional)`**

Define la precisión con la que se evalúa la posición. Atención: Cuanto mayor sea la precisión, más tiempo se tarda en evaluar la posición en el archivo.


|   |   |
| --- | --- |
| *hPrecisionHigh* | Alta precisión. |
| *hPrecisionLow* | Baja precisión. |
| *hPrecisionMedium*<br>(valor predeterminado) | Precisión media. |


![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Este parámetro no se tiene en cuenta. El cálculo se realiza siempre con gran precisión.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Posición en relación con un elemento clave o no clave
<a name="posicion_relacion_con_elemento_clave_clave_ELTPARAGRAPHE000133"></a>

Para un elemento clave, la posición devuelta es relativa a la posición de la Record en el índice de este elemento.

Para un elemento no clave, la posición devuelta es relativa al número de Record en el archivo de datos (véase [HRecNum](../WDLang4/3044063.md)).
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Posición en una iteración filtrada
<a name="posicion_una_iteracion_filtrada_ELTPARAGRAPHE000149"></a>

Si se define un filtro con límites ([HFilter](../WDLang4/3044100.md) sin cadena de condición pero con límites inferior y superior), la posición devuelta es relativa a los registros seleccionados por el filtro.

Si se da una cadena de condiciones a [HFilter](../WDLang4/3044100.md), la posición devuelta ignora el filtro.

<a name="XComponent"></a>

## Componente:
wd280hf.dll
