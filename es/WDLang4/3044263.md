
## HConnect( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Redefine uno o más parámetros de conexión a través de Conector Nativo (Access, SQL Server, MySQL u Oracle) o a través de un acceso OLE DB en un tabla o set específico de tablas. A continuación, se abren las tablas (o se crean si no existen). Se ejecuta la operación de prueba especificada.

**Observaciones**:

- La nueva redefinición de la conexión se utilizará hasta que sea cancelada por **HConnect**. Se cancelará automáticamente al final de la solicitud.

- Por Default, las características de conexión se definen en el editor de análisis, para una o más tablas.





|   |
| --- |
| **Importante**<br><br>La función **HConnect** permite definir fácilmente una conexión a una base de datos. Se recomienda utilizar [HDescribeConnection](../WDLang4/3044205.md) y [HChangeConnection](../WDLang4/3044150.md) para:<br><br>- gestionar los parámetros avanzados disponibles para algunas bases de datos (cursores, transacciones,...),<br><br>- manipular una conexión con nombre.<br><br><br> |


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000003044263&name=hconnect_funcion&product=WD">Ver ejemplos adicionales</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 
```wl
HConnect("Salaries", "", "", ...
	"C:\My Documents\MyDatabase.mdb", "Microsoft.JET.OLEDB.4.0", hOReadWrite)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = HConnect(<Table name> [, <User> [, <Password> [, <Database> [, <OLE DB server or Native Connector> [, <Access> [, <Test operation> [, <Optional information>]]]]]]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se realizó la operación,

- <u><u><u><u>False</u></u></u></u> si se produce un problema. La función [HErrorInfo](../WDLang4/3044071.md) permite identificar el error.




**`<Table name>: (Cadena de caracteres)`**

Nombre de la tabla (archivo de datos) a abrir, y para el cual la conexión debe ser redefinida. Si no se especifica ningún otro parámetro, se reinicia el archivo de datos con los parámetros de Default definidos en el análisis.

- Si este parámetro es igual a "\*", el cambio se aplicará a todas las tablas manejadas por el Conector Nativo (también llamado Acceso Nativo). En este caso, se deben especificar todos los parámetros de conexión. 

- Si este parámetro es igual a "\*" y no se especifican otros parámetros, todos los archivos de datos de todos los Conectores Nativos definidos en el análisis se restablecen a los parámetros de Default.




**`<User>: (Cadena de caracteres opcional)`**

Nombre de usuario que se utilizará para abrir el archivo de datos.

**`<Password>: (Cadena de caracteres opcional)`**

Contraseña de conexión (si existe).

**`<Database>: (Cadena de caracteres opcional)`**

Ruta completa de la fuente de datos.

**`<OLE DB server or Native Connector>: (Cadena de caracteres opcional o constante)`**

Nombre del proveedor de OLE DB o una de las siguientes constantes:


|   |   |
| --- | --- |
| *hAccessHF7* | Pseudo-conexión a una base de datos HFSQL Classic |
| *hAccessHFClientServer* | Conector Nativo a una base de datos HFSQL Client/Server |
| *hNativeAccessAS400* | Conector Nativo AS/400 (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessDB2* | Conector Nativo DB2 (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessInformix* | Conector Nativo Informix (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessMariaDB* | Conector Nativo MariaDB (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessMySQL* | Conector Nativo MySQL (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessOracle* | Conector Nativo Oracle (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessOracleLite* | Conector Nativo Oracle (módulo opcional de WINDEV Mobile) |
| *hNativeAccessPostgreSQL* | Conector Nativo PostgreSQL (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessProgress* | Conector Nativo Progress (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessSQLAzure* | Native SQL Azure Connector (módulo opcional de WINDEV/WEBDEV, proporcionado con Conector Nativo SQL Server) |
| *hNativeAccessSQLite* | Conector SQLite nativo (incluido con WINDEV/WEBDEV) |
| *hNativeAccessSQLServer* | Conector Nativo SQL Server (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessSQLServerMobile* | Conector Nativo SQL Server (módulo opcional de WINDEV Mobile) |
| *hNativeAccessSybase* | Conector Nativo Sybase (módulo opcional de WINDEV/WEBDEV) |
| *hNativeAccessXBase* | Conector nativo xBase (incluido con WINDEV/WEBDEV) |
| *hNativeAccessXML* | Conector XML nativo (incluido con WINDEV/WEBDEV) |
| *hODBC* | Proveedor OLE DB para ODBC (permite acceder a una fuente de datos ODBC declarada en las fuentes de datos ODBC de Windows) |
| *hOledbAccess97* | Proveedor OLE DB para Access 97 |
| *hOledbAccess2000* | Proveedor OLE DB para Access 2000 |
| *hOledbAccess2007* | Proveedor OLE DB para Access 2007 |
| *hOledbAccess2010* | Proveedor OLE DB para Access 2010 |
| *hOledbDBase5* | Proveedor OLE DB para dBase 5 |
| *hOledbExcel97* | Proveedor OLE DB para Excel 97 |
| *hOledbExcel2000* | Proveedor OLE DB para Excel 2000 |
| *hOledbExcel2007* | Proveedor OLE DB para Excel 2007 |
| *hOledbLotus4* | Proveedor OLE DB para Lotus 4 |
| *hOledbOracle* | Proveedor OLE DB para Oracle |
| *hOledbSQLServer* | Proveedor OLE DB para SQL Server |





![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) Atención: Para utilizar una conexión OLE DB, es necesario: 


- instalar MDAC versión 2.6 o posterior (instalación realizada por WINDEV/WEBDEV y al crear el programa instalación)

- instalar el proveedor OLE DB que corresponde a la base de datos utilizada. 
	Este parámetro es devuelto por la [CtOLEDBProvider](../Proprietes/2512033.md) Property.




**`<Access>: (Constante opcional)`**

Configura el tipo de acceso al archivo de datos.


|   |   |
| --- | --- |
| *hORead* | Se puede acceder al archivo de datos en modo de solo lectura. Solo se pueden leer registros. No se pueden agregar o eliminar. |
| *hOReadWrite*<br>(valor predeterminado) | Se puede acceder al archivo de datos en modo de lectura y escritura. Se pueden leer y escribir nuevos registros. |



**`<Test operation>: (Constante opcional)`**

Configure el tipo de operación que se realizará en la base de datos para comprobar la conexión.


|   |   |
| --- | --- |
| *hHCreationIfNotFound*<br>(Valor predeterminado) | Comprueba la conexión abriendo o creando un archivo de datos (si el archivo de datos no existe). Esta operación solo es posible en modo *hOReadWrite*. |
| *hHOpen* | Comprueba la conexión abriendo un archivo de datos. Este valor se utiliza por defecto cuando se accede a una base de datos *hORead*. |



**`<Optional information>: (Cadena de caracteres opcional)`**

Información insertada en la cadena para la conexión a la base de datos. 

Por ejemplo, algunas fuentes de datos le permiten especificar la base de datos que se utilizará. Con SQLServer, la base de datos "Master" es la base de datos Default pero se pueden utilizar otras bases de datos, "dbo" por ejemplo. Esta información se especifica en el parámetro &lt;Información opcional&gt; mediante la siguiente sintaxis:
![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) "catálogo inicial = dbo"![ODBC](https://doc.pcsoft.fr/ext/images/us/ODBC.png) "base de datos = dbo"![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) MySQL: "catálogo inicial = dbo"

![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Las palabras clave reconocidas por OLE DB y Conectores Nativos se presentan en la página de [Información opcional de conexión](../WDLang4/9000124.md).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones




### Configuración de la conexión
<a name="configuracion_conexion_ELTPARAGRAPHE000269"></a>

- La descripción de la tabla debe conocerse al llamar a la función **HConnect** (la tabla debe haberse descrito en el análisis, o con las funciones [HDeclare](../WDLang4/3044203.md) o [HDescribeFile](../WDLang4/3044206.md)).

- La función **HConnect** abre la conexión y la tabla. Se crea la tabla si no existe. Para este caso específico, la función **HConnect** equivale a [HCreationIfNotFound](../WDLang4/3044254.md).

- Al redefinir la conexión, sólo se tienen en cuenta los parámetros especificados.. El valor de los parámetros no especificados con la función **HConnect** corresponde al valor definido en el editor de análisis.

- Si sólo se especifica el &lt;nombre de la tabla&gt;, **HConnect** cancela la redefinición de la conexión para las tablas especificadas. Se tendrán en cuenta los parámetros definidos en el editor de análisis.

- Cuando el parámetro &lt;Nombre de la tabla&gt; es igual a "\*", el cambio se aplica a todas las tablas Conector Nativo definidas en el análisis. En este caso, sólo se tienen en cuenta los parámetros &lt;Usuario&gt;, &lt;Contraseña&gt;, &lt;Base de datos&gt; y &lt;Acceso&gt;.

- Para Cancel un cambio de conexión realizado en las tablas, &lt;Nombre de la tabla&gt; debe ser igual a "\*" y no se debe especificar ningún otro parámetro.

- Si se especifica la fuente de datos, la función **HConnect** ignora los posibles [HSubstDir](../WDLang4/3044028.md)/[HChangeDir](../WDLang4/3044168.md).

- Si un tabla está abierto cuando se llama a **HConnect**, el tabla se cierra y se vuelve a abrir con los nuevos parámetros de conexión.




<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Lógica de negocio
## Componente:
wd280hf.dll
