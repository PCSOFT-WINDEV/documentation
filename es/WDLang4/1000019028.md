


## HPrepareQuery (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Inicializa una consulta y la declara al servidor de la base de datos para optimizar las siguientes ejecuciones de dicha consulta. Esta consulta no se ejecuta. A continuación, la consulta puede ser ejecutada por [HExecuteQuery](../WDLang4/3044080.md). Esta función está disponible para consultas con o sin bind. 

Para liberar los recursos de esta consulta, utilice [HCancelDeclaration](../WDLang4/3044174.md).

Se recomienda utilizar esta función cuando la misma consulta se ejecuta sucesivamente y cuando sólo se modifican algunos de los parámetros de la consulta en cada ejecución..

**Esta función es opcional y solo se puede utilizar en bases de datos Cliente/Servidor (disponible actualmente para AS/400).**

**Para las demás bases de datos a las que se accede mediante un Conector Nativo, OLE DB u ODBC, [HPrepareSQLQuery](../WDLang4/3044119.md) ejecuta la consulta.**

Esta función no puede utilizarse en las bases de datos HFSQL (HFSQL Classic o Cliente/Servidor) ni en las bases de datos xBase. 

<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
HPrepareQuery(QRY_MyQry, MyConnection, hQueryWithoutCorrection)

FOR I = 1 TO 10
	QRY_MyQry.lastname = "LastName" + i
	QRY_MyQry.firstname = "FirstName" + i
	QRY_MyQry.age_ = i
	HExecuteQuery(QRY_MyQry)
END
```

<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX1"></a>

`<Result> = HPrepareQuery(<Query> , <Connection> [, <Mode>])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se inició la consulta,

- <u><u><u><u>False</u></u></u></u> en caso contrario. La función [HErrorInfo](../WDLang4/3044071.md) permite obtener más detalles sobre el problema.




**`<Query>: (Cadena de caracteres)`**



- Nombre y ruta completa de la consulta (archivo ".WDR") a iniciar.

- Nombre lógico de la consulta que se va a inicializar. 


Si ya se ha declarado una consulta con el mismo nombre, se sustituye por la nueva consulta.

**`<Connection>: (Cadena de caracteres o variable de tipo Connection)`**

Conexión a través de la cual se ejecutará la consulta. Esta conexión corresponde a: 

- el nombre de la conexión definida en el editor de análisis o con las funciones [HDescribeConnection](../WDLang4/3044205.md) o [HOpenConnection](../WDLang4/3044107.md).

- el nombre de una variable de tipo [Conexión](../WDLang4/1514073.md).




**`<Mode>: (Constante opcional de tipo Integer)`**

Opción para iniciar la consulta: 


|   |   |
| --- | --- |
| *hQueryWithoutCorrection* | ![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) El motor HFSQL no verifica la consulta. Esta opción debe utilizarse si la consulta contiene comandos específicos de un tipo de conexión (Oracle, SQL Server, etc.).<br><br>Atención: si se utiliza esta constante:<br><br>- se debe especificar el nombre de la conexión (parámetro &lt;Conexión&gt;).<br><br>- no se puede utilizar la función [HFilter](../WDLang4/3044100.md) en la consulta manipulada.<br><br>- no se debe especificar ningún elemento de navegación en las siguientes funciones: [HLast](../WDLang4/3044101.md), [HReadLast](../WDLang4/3044140.md), [HReadFirst](../WDLang4/3044051.md), [HFirst](../WDLang4/3044113.md), [HSeekLast](../WDLang4/3044129.md), [HSeekFirst](../WDLang4/3044125.md).<br><br><br> |





<a name="XComponent"></a>

## Componente:
wd280hf.dll
