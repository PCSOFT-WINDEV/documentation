


## &lt;Fuente&gt;.PrepareQuery (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Inicializa una consulta y la declara al servidor de la base de datos para optimizar las siguientes ejecuciones de dicha consulta. Esta consulta no se ejecuta. A continuación, la consulta puede ser ejecutada por [&lt;Fuente&gt;.ExecuteQuery](../WDLang4/1000024944.md). Esta función está disponible para consultas con o sin bind. 

Para liberar los recursos de esta consulta, utilice [&lt;Fuente&gt;.CancelDeclaration](../WDLang4/1000024192.md).

Se recomienda utilizar esta función cuando la misma consulta se ejecuta sucesivamente y cuando sólo se modifican algunos de los parámetros de la consulta en cada ejecución..

**Esta función es opcional y solo se puede utilizar en bases de datos Cliente/Servidor (disponible actualmente para AS/400).**

**Para las demás bases de datos a las que se accede mediante un Conector Nativo, OLE DB u ODBC, [&lt;Fuente&gt;.PrepareSQLQuery](../WDLang4/1000025050.md) ejecuta la consulta.**

Esta función no puede utilizarse en las bases de datos HFSQL (HFSQL Classic o Cliente/Servidor) ni en las bases de datos xBase. 

<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
QRY_MyQry.PrepareQuery(MyConnection, hQueryWithoutCorrection)

FOR I = 1 TO 10
	QRY_MyQry.lastname = "LastName" + i
	QRY_MyQry.firstname = "FirstName" + i
	QRY_MyQry.age_ = i
	QRY_MyQry.ExecuteQuery()
END
```

<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX1"></a>

`<Result> = <Source>.PrepareQuery(<Connection> [, <Mode>])`
---

**`<Result>: (Booleano)`**



- <u><u><u><u>True</u></u></u></u> si se inició la consulta,

- <u><u><u><u>False</u></u></u></u> en caso contrario. La función [HErrorInfo](../WDLang4/3044071.md) permite obtener más detalles sobre el problema.




**`<Source>: (Tipo de fuente especificada)`**

Nombre lógico de la consulta que se va a inicializar. Si ya se ha declarado una consulta con el mismo nombre, se sustituye por la nueva consulta.

**`<Connection>: (Cadena de caracteres)`**

Conexión a través de la cual se ejecutará la consulta. Esta conexión corresponde a: 

- el nombre de la conexión definida en el editor de análisis o con las funciones [HDescribeConnection](../WDLang4/3044205.md) o [&lt;Variable Connection&gt;.OpenConnection](../WDLang4/1000023962.md).

- el nombre de una variable de tipo [Conexión](../WDLang4/1514073.md).




**`<Mode>: (Constante opcional de tipo Integer)`**

Opción para iniciar la consulta: 


|   |   |
| --- | --- |
| *hQueryWithoutCorrection* | ![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) El motor HFSQL no verifica la consulta. Esta opción debe utilizarse si la consulta contiene comandos específicos de un tipo de conexión (Oracle, SQL Server, etc.).<br><br>Atención: si se utiliza esta constante:<br><br>- se debe especificar el nombre de la conexión (parámetro &lt;Conexión&gt;).<br><br>- no se puede utilizar la función [&lt;Fuente&gt;.Filter](../WDLang4/1000024960.md) en la consulta manipulada.<br><br>- no se debe especificar ningún elemento de navegación en las siguientes funciones: [&lt;Fuente&gt;.Last](../WDLang4/1000024217.md), [&lt;Fuente&gt;.ReadLast](../WDLang4/1000025020.md), [&lt;Fuente&gt;.ReadFirst](../WDLang4/1000025022.md), [&lt;Fuente&gt;.First](../WDLang4/1000025048.md), [&lt;Fuente&gt;.SeekLast](../WDLang4/1000025054.md), [&lt;Fuente&gt;.SeekFirst](../WDLang4/1000025055.md).<br><br><br> |





<a name="XComponent"></a>

## Componente:
wd280hf.dll
