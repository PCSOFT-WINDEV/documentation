


## HImportHF55 (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Importa un archivo de datos Hyper File 5.5 en un archivo de datos en formato HFSQL Classic.

- El archivo de datos en formato Hyper File 5.5 debe ser descrito en la editor de análisis.

- El archivo de datos en formato HFSQL Classic debe estar descrito en el editor de análisis, o debe ser declarado por [HDeclare](../WDLang4/3044203.md), [HDeclareExternal](../WDLang4/3044204.md) o [HDescribeFile](../WDLang4/3044206.md).




**Observaciones**: 

- Los dos archivos de datos pueden tener estructuras diferentes.

- Esta función no está disponible cuando se utiliza un ejecutable independiente.. 



<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Imports the name and address of customers,
// ignore the other items
IF NOT HImportHF55("CUSTOMER", "CUSTOMER", "C:\AnExample\CUSTOMER.FIC", ...
			"C:\AnExample\AnExample.wdd", "", "FULLNAME,ADDRESS", ...
			"NAME,ADDR", hDefaultVal + hImpConversion) THEN
		  Error("Unable to import")
ELSE
	// Process
	...
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Importar a un archivo de datos con la misma estructura

`<Result> = HImportHF55(<HFSQL Classic file> , <HF55 File> , <Full path of HF55 File> , <Password of HF55 File> , <Full path of WDD 55 file> , <Password of WDD 55 File> [, <Options> [, <Progress Bar>]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se realizó la operación,

- <u><u><u><u>False</u></u></u></u> si se produce un error. La función [HError](../WDLang4/3044088.md) permite identificar el problema.




**`<HFSQL Classic file>: (Cadena de caracteres)`**

Nombre lógico del fichero de datos en formato HFSQL Classic al que se realizará la importación.

**`<HF55 File>: (Cadena de caracteres)`**

Nombre lógico del archivo de datos en formato Hyper File 5.5 descrito en el análisis WINDEV 5.5 (archivo .WDD) y que contiene los datos a importar.

**`<Full path of HF55 File>: (Cadena de caracteres)`**

Acceso completo a ruta del archivo de datos Hyper File 5.5 para importar.

**`<Password of HF55 File>: (Cadena de caracteres)`**

Contraseña associated con el archivo de datos para importar. Esta contraseña se utilizará para descifrar los datos que se encuentran en el archivo de datos. Si no se ha definido ninguna contraseña, utilice una cadena vacía (""").

**`<Full path of WDD 55 file>: (Cadena de caracteres)`**

Acceder a ruta al fichero de análisis.WDD en formato Hyper File 5.5. Este análisis contiene la description (o estructura) del archivo de datos a importar. Todos los formatos de análisis reconocidos por Hyper File 5.5 pueden ser utilizados (WINDEV 5.5B, 5.5, 5.0 y 4.1).

**`<Password of WDD 55 File>: (Cadena de caracteres)`**

Contraseña associated con el análisis que contiene el archivo de datos para importar. Si no se ha definido ninguna contraseña, utilice una cadena vacía (""").

**`<Options>: (Constante o combinación de constantes de tipo Integer (opcional))`**

Tipo de importación a realizar: 



|   |   |
| --- | --- |
| *hCopyAutoId* | El identificador automático se copia. No se vuelve a calcular.<br>Si el archivo de datos HFSQL Classic contiene un identificador automatic mientras que el archivo de datos Hyper File 5.5 no contiene ningún identificador automatic, el identificador automatic se pone a 0 en el archivo de datos HFSQL Classic. |
| *hDefaultVal* | Para los elementos no importados, los valores de Record (HFSQL Classic) actuales se reinicializan con su valor Default. |
| *hImpBreakable* | La importación se puede interrumpir pulsando la tecla Esc del teclado. Si se interrumpe la importación, los registros importados se guardan en el archivo de datos. Si es necesario, se realiza automáticamente una operación de reindexación (no se puede interrumpir). |
| *hImpConversion* | Los artículos de associated no tienen el mismo tipo ni el mismo tamaño: los datos extraídos del archivo de datos importados se convierten o truncan automáticamente. |
| *hImpCreation* | Si el archivo de datos de importación (HFSQL Classic) existe, se sobrescribe. |
| *hImpIgnoreItem* | Los elementos encontrados en el archivo de datos de importación (HFSQL Classic) sin elementos associated en el archivo de datos de importación (Hyper File 5.5) se rellenan con su valor Default.<br>Se ignoran los elementos del archivo de datos importados (Hyper File 5.5) que no coinciden con el archivo de datos importados. |
| *hImpNormal*<br>(valor predeterminado) | Este modo de importación evita cualquier riesgo de pérdida de datos.. La importación no se realiza y se produce un error en los siguientes casos:<br><br>- elementos encontrados en el archivo de datos Hyper File 5.5 sin correspondencia en el archivo de datos HFSQL Classic.<br><br>- Los elementos de associated en los dos archivos de datos pero con un tamaño y/o formato diferente.<br><br><br>Si el archivo de datos de importación (HFSQL Classic) ya existe, se rellena con los datos importados; en caso contrario, se crea el archivo de datos. <br>No se gestiona la integridad, ni los duplicados.<br>Los elementos no importados toman el valor del registro en curso.<br>Los identificadores automáticos se vuelven a calcular. |
| *hImpNoSpace* | Los caracteres de espacio que se encuentran al final de la cadena se eliminan automáticamente durante la importación. |
| *hImpTestDuplicates* | Verifica los duplicados durante la importación. |
| *hImpTestIntegrity* | Prueba la integridad durante la importación |



**`<Progress Bar>: (Nombre de control o ventana opcional)`**



- Nombre de la ventana donde se mostrará la barra de progreso de la importación. 

- Nombre de la control Barra de progreso donde se mostrará el progreso de la importación.





<a name="SYNTAX2"></a>

### Importar a un archivo con una estructura diferente

`<Result> = HImportHF55(<HFSQL Classic file> , <HF55 File> , <Full path of HF55 File> , <Password of HF55 File> , <Full path of WDD 55 file> , <Password of WDD 55 File> , <List of destination items> , <List of source items> [, <Options> [, <Progress Bar>]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se realizó la operación,

- <u><u><u><u>False</u></u></u></u> si se produce un error. La función [HError](../WDLang4/3044088.md) permite identificar el problema.




**`<HFSQL Classic file>: (Cadena de caracteres)`**

Nombre lógico del fichero de datos en formato HFSQL Classic al que se realizará la importación.

**`<HF55 File>: (Cadena de caracteres)`**

Nombre lógico del archivo de datos en formato Hyper File 5.5 descrito en el análisis WINDEV 5.5 (archivo .WDD) y que contiene los datos a importar.

**`<Full path of HF55 File>: (Cadena de caracteres)`**

Acceso completo a ruta del archivo de datos Hyper File 5.5 para importar.

**`<Password of HF55 File>: (Cadena de caracteres)`**

Contraseña associated con el archivo de datos para importar. Esta contraseña se utilizará para descifrar los datos que se encuentran en el archivo de datos. Si no se ha definido ninguna contraseña, utilice una cadena vacía (""").

**`<Full path of WDD 55 file>: (Cadena de caracteres)`**

Acceder a ruta al fichero de análisis.WDD en formato Hyper File 5.5. Este análisis contiene la description (o estructura) del archivo de datos a importar. Todos los formatos de análisis reconocidos por Hyper File 5.5 pueden ser utilizados (WINDEV 5.5B, 5.5, 5.0 y 4.1).

**`<Password of WDD 55 File>: (Cadena de caracteres)`**

Contraseña associated con el análisis que contiene el archivo de datos para importar. Si no se ha definido ninguna contraseña, utilice una cadena vacía (""").

**`<List of destination items>: (Cadena de caracteres)`**

Lista de nombres de artículos encontrados en el archivo de datos HFSQL Classic. Los nombres se pueden delimitar con comillas simples y separar con comas o retornos de carro (CR). 
Observación: los nombres correspondientes a las claves compuestas no están permitidos: los valores de las claves compuestas se recalcularán automáticamente cuando se añada el Record en el el archivo de datos.

**`<List of source items>: (Cadena de caracteres)`**

Lista de nombres de los elementos que se encuentran en el archivo de datos de Hyper File 5.5. Los nombres se pueden delimitar con comillas simples y separar con comas o retornos de carro (CR). 
Observación: se permiten los nombres correspondientes a las claves compuestas. El número de elementos debe corresponder al número de elementos especificados en &lt;Lista de elementos de destino&gt;.

**`<Options>: (Constante o combinación de constantes de tipo Integer (opcional))`**

Tipo de importación a realizar:


|   |   |
| --- | --- |
| *hCopyAutoId* | El identificador automático se copia. No se vuelve a calcular.<br>Si el archivo de datos HFSQL Classic contiene un identificador automatic mientras que el archivo de datos Hyper File 5.5 no contiene ningún identificador automatic, el identificador automatic se pone a 0 en el archivo de datos HFSQL Classic. |
| *hDefaultVal* | Para los elementos no importados, los valores de Record (HFSQL Classic) actuales se reinicializan con su valor Default. |
| *hImpBreakable* | La importación se puede interrumpir pulsando la tecla ESC. Si se interrumpe la importación, los registros importados se guardan en el archivo de datos. Si es necesario, se realiza automáticamente una operación de reindexación (no se puede interrumpir). |
| *hImpConversion* | Los artículos de associated no tienen el mismo tipo ni el mismo tamaño: los datos extraídos del archivo de datos importados se convierten o truncan automáticamente. |
| *hImpCreation* | Si el archivo de datos de importación (HFSQL Classic) existe, se sobrescribe. |
| *hImpIgnoreItem* | Los elementos encontrados en el archivo de datos de importación (HFSQL Classic) sin elementos associated en el archivo de datos de importación (Hyper File 5.5) se rellenan con su valor Default.<br>Se ignoran los elementos del archivo de datos importados (Hyper File 5.5) que no coinciden con el archivo de datos importados. |
| *hImpNormal*<br>(valor predeterminado) | Este modo de importación evita cualquier riesgo de pérdida de datos.. La importación no se realiza y se produce un error en los siguientes casos:<br><br>- elementos encontrados en el archivo de datos Hyper File 5.5 sin correspondencia en el archivo de datos HFSQL Classic.<br><br>- Los elementos de associated en los dos archivos de datos pero con un tamaño y/o formato diferente.<br><br><br>Si el archivo de datos de importación (HFSQL Classic) ya existe, se rellena con los datos importados; en caso contrario, se crea el archivo de datos.<br>No se gestiona la integridad, ni los duplicados.<br>Los elementos no importados toman el valor del registro en curso.<br>Los identificadores automáticos se vuelven a calcular. |
| *hImpNoSpace* | Los caracteres de espacio que se encuentran al final de la cadena se eliminan automáticamente durante la importación. |
| *hImpTestDuplicates* | Comprueba los duplicados durante la importación. |
| *hImpTestIntegrity* | Prueba la integridad durante la importación. |



**`<Progress Bar>: (Nombre de control o ventana opcional)`**



- Nombre de la ventana donde se mostrará la barra de progreso de la importación. 

- Nombre de la control Barra de progreso donde se mostrará el progreso de la importación.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Archivo de datos codificados
<a name="archivo_datos_codificados_ELTPARAGRAPHE000285"></a>

Si el archivo de datos en formato HFSQL Classic en el que se debe realizar la importación está cifrado, se debe introducir la contraseña antes de utilizar la función **HImportHF55**: utilice la función [HPass](../WDLang4/3044108.md).
<a name="NOTE0_2"></a>


### HFSQL Client/Server
<a name="hfsql_clientserver_ELTPARAGRAPHE000299"></a>

Si se va a realizar la importación en un archivo de datos en formato HFSQL Client/Sever, se debe especificar la conexión antes de utilizar la función **HImportHF55**. Por ejemplo: 

```txt
HChangeConnection(MyCSFile, cntHFCS)
HImportHF55(MyCSFile, My55File, ...)
```


<a name="XComponent"></a>

## Componente:
wd280hf.dll
