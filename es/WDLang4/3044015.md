
## HInfoReplica( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Devuelve información sobre la réplica especificada. Esta función se utiliza para averiguar si la base de datos contiene datos a reproducir.

**Atención**: Esta función no se puede utilizar con la réplica universal. **Tsu función puede ser usada sólo con la "réplica basada en registros".**


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Gray the button if there is no data to synchronize
IF HInfoReplica("", rplMasterIsUpToDate) = True THEN
	BTN_SYNCHRO..State = Grayed
END
```




<a name="Example2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) 
```wl
// If the master was not synchronized for more than 7 days
IF HInfoReplica("", rplMasterIsUpToDate, "PARIS") = False THEN
	NbDays is int
	NbDays = HInfoReplica("", rplDateSynchroToMaster, "PARIS")/(24*60*60)
	IF NbDays > 7 THEN
		 Info("PARIS was not updated since " + ...
			NbDays + " days.")
	END
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = HInfoReplica(<Full path of replica file> , <Sought information> [, <Identifier of subscriber replica>])`
---

**`<Result>: (Tipo según el tipo de información)`**

Información solicitada.

**`<Full path of replica file>: (Cadena de caracteres)`**

ruta completa del archivo de réplica (archivo".RPL" o ".RPM") correspondiente a la réplica a analizar. Para una réplica móvil, corresponde a la ruta del fichero "\*.WDZ".. 
Si este parámetro corresponde a una cadena vacía ("""), la réplica se busca en el directorio actual.

**`<Sought information>: (Constante)`**

La información difiere según el tipo de réplica:

- Réplica maestro:
	


|   |   |
| --- | --- |
| *rplDateSynchroFromSubscriber* | &lt;Resultado&gt; es una cadena de caracteres en formato "AAAAMMDD".<br><br>Fecha de la última sincronización hacia la base de datos maestra. |
| *rplDateSynchroToSubscriber* | &lt;Resultado&gt; es una cadena de caracteres en formato "AAAAMMDD".<br><br>Fecha de la última sincronización hacia la base de datos de suscriptores. |
| *rplNumMovableReplica* | Número de generación de la última réplica móvil generada para la réplica del abonado cuyo identificador es &lt;Identificador de la réplica del abonado&gt;. |
| *rplSubscriberIsUpToDate* | &lt;El resultado es booleano.<br><br>	- <u><u><u><u>True</u></u></u></u> si no se debe enviar ningún dato,<br><br>	- <u><u><u><u>False</u></u></u></u> si se deben enviar datos a un equipo esclavo.<br><br><br> |



- Réplica esclavo:
	


|   |   |
| --- | --- |
| *rplDateSynchroFromMaster* | &lt;Resultado&gt; es una cadena de caracteres en formato "AAAAMMDD".<br><br>Fecha de la última sincronización desde la base de datos maestra. |
| *rplDateSynchroToMaster* | &lt;Resultado&gt; es una cadena de caracteres en formato "AAAAMMDD".<br><br>Fecha de la última sincronización hacia la base de datos maestra. |
| *rplMasterIsUpToDate* | &lt;El resultado es booleano.<br><br>	- <u><u><u><u>True</u></u></u></u> si no se debe enviar ningún dato,<br><br>	- <u><u><u><u>False</u></u></u></u> si se deben enviar los datos al equipo maestro.<br><br><br> |
| *rplNumMovableReplica* | Número de generación de la última réplica móvil que se generó. Este número se incrementa cada vez que se llama a [HCreateMoveableReplica](../WDLang4/3044209.md). |



- Réplica móvil:
	


|   |   |
| --- | --- |
| *rplNumMovableReplica* | Número de generación de la última réplica móvil que se generó. Este número se incrementa cada vez que se llama a [HCreateMoveableReplica](../WDLang4/3044209.md). |






**`<Identifier of subscriber replica>: (Cadena de caracteres opcional o entero opcional)`**

Identifica una réplica de un suscriptor. Este parámetro se tiene en cuenta si &lt;Full ruta of replica file&gt; corresponde a una réplica maestra. Este parámetro puede ser: 

- el valor pasado a [HCreateSubscriberReplica](../WDLang4/3044253.md) para identificar la réplica del abonado

- el valor devuelto por [HCreateSubscriberReplica](../WDLang4/3044253.md).






<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Lógica de negocio
## Componente:
wd280hf.dll
