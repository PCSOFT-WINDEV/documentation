


## HSeekFirst (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Establece la posición en el primer registro que tenga un elemento específico con un valor mayor o igual al valor buscado. ***El registro no se lee***.

El número de la Record actual se modifica sólo cuando es devuelto por [HRecNum](../WDLang4/3044063.md). Para las funciones que manipular el número actual de Record ([HDelete](../WDLang4/3044018.md), [HRead](../WDLang4/3044047.md), [HModify](../WDLang4/3044042.md), etc.), el valor de este número no se actualiza: se debe utilizar la función [HRecNum](../WDLang4/3044063.md). 
Ejemplo de no hacer: 

```wl
// Deletes a record not corresponding to the expected one
HSeekFirst(Customer, CustomerID, 25)
HDelete(Customer)
```
 pero: 

```wl
// Delete the sought record
HSeekFirst(Customer, CustomerID, 25)
HDelete(Customer, HRecNum())
```

Atención: ***El registro cargado en memoria no se modifica***. Las variables HFSQL (por ejemplo, Cliente.Nombre, es decir el elemento *Nombre* del archivo *Cliente*) no se actualizan.

En la mayoría de los casos, **HSeekFirst** establece la posición en el archivo de datos para realizar un bucle a través de los registros que coinciden con una condición.

Después de llamar a la función **HSeekFirst**, se pueden producir los siguientes casos:

- se encontró un registro que corresponde a la condición, se bloqueó (si es necesario) y se cargó en la memoria: [HFound](../WDLang4/3044104.md) devuelve <u><u><u>True</u></u></u>.

- el archivo de datos está vacía o no hay Record correspondiente a la condición: [HOut](../WDLang4/3044094.md) devuelve <u><u><u>True</u></u></u>. 

- la función intenta bloquear un registro ya bloqueado en modo de lectura: las funciones [HErrorLock](../WDLang4/3044099.md) y [HOut](../WDLang4/3044094.md) devuelven <u><u><u>True</u></u></u>. 




**Observación**: la búsqueda puede ser cancelada por [HCancelSeek](../WDLang4/3044157.md).


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Find the first record for which 
// the Customer name is Moore
HSeekFirst(Customer, Name, "Moore")
```
<a name="Example2"></a>

```wl
// The record is not read.
// Finds all the customers with a specific last and first names. 
// The search is performed according to a composite key. 
bufSoughtVal is Buffer = HBuildKeyValue(Customer, LastName_FirstName, sLastName, sFirstName)
HSeekFirst(Customer, LastName_FirstName, bufSoughtVal, hLockWrite)
WHILE HFound(Customer) = True
	HDelete(Customer, HRecNum())
	HNext(Customer, LastName_FirstName, HLockWrite)
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = HSeekFirst(<Data file> , <Key item> , <Sought value> [, <Options>])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si la posición se fijó en el Record (corresponde al valor de [HFound](../WDLang4/3044104.md)). 

- <u><u><u><u>False</u></u></u></u> si se produce un problema. Este problema puede ser causado por:

	- un problema de posicionamiento (archivo de datos vacío, etc.): la función [HFound](../WDLang4/3044104.md) devuelve <u><u><u><u>False</u></u></u></u> y la función [HError](../WDLang4/3044088.md) devuelve 0.

	- un error: la función [HError](../WDLang4/3044088.md) devuelve un número entero distinto de 0. La función [HErrorInfo](../WDLang4/3044071.md) devuelve más detalles.







**`<Data file>: (Cadena de caracteres)`**

Nombre del archivo de datos HFSQL utilizado.

**`<Key item>: (Cadena de caracteres)`**

Nombre del elemento clave sobre el que se realizará la búsqueda.

**`<Sought value>: (Tipo de valor)`**

Valor del artículo buscado.

**`<Options>: (Constante o combinación de constantes opcional)`**

Configura:

- el modo de bloqueo aplicado al buscado Record

- el tipo de búsqueda realizada.





|   |   |
| --- | --- |
| *hGeneric* | Búsqueda genérica (ver las Notas)<br>Una búsqueda de coincidencia exacta es realizada por Default (constante no especificada). |
| *hKeepFilter* | El filtro set de [HFilter](../WDLang4/3044100.md) se tendrá en cuenta, aunque la clave de búsqueda no esté optimizada para el filtro. Recordatorio: la función [HFilter](../WDLang4/3044100.md) devuelve la clave de búsqueda optimizada para el filtro.<br>**Atención**: en este caso, pueden producirse problemas de rendimiento en los archivos grandes.<br>![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Este Variable no puede ser usado. Por Default, la iteración realizada después de **HSeekFirst** ignora el filtro. |
| *hLimitParsing* | La iteración se detendrá cuando se encuentre el último valor buscado. El actual Record corresponderá a este último Record encontrado.<br>[HFound](../WDLang4/3044104.md) devolverá <u><u><u><u>False</u></u></u></u> y [HOut](../WDLang4/3044094.md) devolverá <u><u><u><u>True</u></u></u></u>.<br>Esta constante se utiliza para optimizar la velocidad de búsqueda en el modo Cliente/Servidor. |
| *hLockNo* | Sin bloqeuo: la Record puede ser leída o modificada por otra aplicación durante la lectura. |
| *hLockReadWrite* | Bloqueo de lectura y escritura: el Record que se lee actualmente no puede ser leído o modificado por otra aplicación.<br>![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) Bloqueo de solo escritura. Equivale a la constante *hLockWrite*. |
| *hLockWrite* | Bloqueo de escritura: el Record que se lee actualmente puede ser leído por otra aplicación pero no puede ser modificado por otra aplicación. |

![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Este parámetro no se tiene en cuenta.![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Las opciones de bloqueo no tendrán efecto si los bloqueos no son soportados por el proveedor OLE DB o por Conector Nativo.![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) El modo de bloqueo especificado con la función **HSeekFirst** seguirá siendo efectivo al llamar a las funciones [HPrevious](../WDLang4/3044112.md) y [HNext](../WDLang4/3044027.md).

Para cambiar el modo de bloqueo, utilice:

- **HSeekFirst** o [HSeekLast](../WDLang4/3044129.md),

- [HFirst](../WDLang4/3044113.md) o [HLast](../WDLang4/3044101.md).






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Búsqueda genérica/búsqueda por coincidencia de datos de salida
<a name="busqueda_genericabusqueda_por_coincidencia_datos_salida_ELTPARAGRAPHE000304"></a>

- **Búsqueda genérica** (principalmente en las posiciones de la cadena de caracteres): *Encuentra todos los registros que empiezan con el valor especificado*. 
	Por ejemplo: Cuando se realiza una búsqueda genérica en "Smith" (para el elemento NAME), todos los registros cuyo elemento Name comience con "Smith" coincidirán con la búsqueda. Por lo tanto, el registro que contiene "Martínez" corresponderá a la búsqueda (la función **HFound** devuelve <u><u><u><u>True</u></u></u></u>).

- **Búsqueda exacta**: *Busca todos los registros que coinciden exactamente con el valor especificado.*. 
	Por ejemplo: Al realizar una búsqueda exacta en la cadena "Martin" (para el elemento NOMBRE), la función **HFound** devuelve <u><u><u><u>True</u></u></u></u> solo para los registros cuyo elemento coincide exactamente con "Martin".

- **Ejemplos de búsquedas realizadas en el archivo CLIENTE ordenado por nombre:**

<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=hlitrechpremier.gif)



|   |   |   |   |   |   |
| --- | --- | --- | --- | --- | --- |
| Valor buscado | Opciones | **HSeekFirst** fija la posición en el Record | **[HFound](../WDLang4/3044104.md)** vuelve | **[HOut](../WDLang4/3044094.md)** vuelve | Explicaciones |
| Durand |   | 1 | True | False | Durand existe.<br>El final del archivo de datos no se ha alcanzado todavía. |
| Dupuis |   | 1 | False | False | Dupuis no existe. Posicionamiento sobre el primer valor mayor (Durand).<br>El final del archivo de datos no se ha alcanzado todavía. |
| Moro | hGeneric | 8 | True | False | Moor no existe pero la búsqueda es genérica y se encuentra Moore (entre otros).<br>El final del archivo de datos no se ha alcanzado todavía. |
| Moro |   | El Record no se encontró (no se movió) | False | False | El moro no existe.<br>El final del archivo de datos no se ha alcanzado todavía. |
| Norbert |   | El Record no se encontró (no se movió) | False | True | Norbert no existe.<br>Posición en el primer valor mayor (este valor no existe): Se ha llegado al final del archivo de datos. |


<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Realizar una búsqueda en una clave compuesta
<a name="realizar_una_busqueda_una_clave_compuesta_ELTPARAGRAPHE000414"></a>

Se pueden utilizar varios métodos para realizar una búsqueda en una clave compuesta:

- Usando una lista de valores,

- Llamando a [HBuildKeyValue](../WDLang4/3044258.md).




**Utilizando una lista de valores**

La siguiente sintaxis se utiliza para realizar una búsqueda en una clave compuesta:


```txt
HSeekFirst(<File name>, <Name of composite key>, ...
	[<Search value of first element of composite key>, 
	<Search value of first element of composite key>, ...])
```

Ejemplo:

```wl
// Find the record
HSeekFirst(Customer, LastName_FirstName, ["Moore","Vince"])
```
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Para realizar búsquedas genéricas en una clave compuesta, todos los componentes de la clave compuesta deben ser componentes de texto. De lo contrario, se realiza una búsqueda por coincidencia exacta.
<a name="NOTE0_3"></a>


### Buscar en un artículo de array
<a name="buscar_articulo_array_ELTPARAGRAPHE000446"></a>

La búsqueda se realiza en el primer elemento array (elemento con índice 1). Para realizar una búsqueda en los otros elementos de array, utilice los filtros o consultas.
<a name="NOTE0_4"></a>


### Buscar y filtrar
<a name="buscar_filtrar_ELTPARAGRAPHE000455"></a>

Si se activa un filtro ([HFilter](../WDLang4/3044100.md)), la búsqueda tiene en cuenta el filtro.
![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Si se activa un filtro, la búsqueda lo ignora.
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![Lenguaje Externo](https://doc.pcsoft.fr/ext/images/us/LE.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Bloqueos
<a name="bloqueos_ELTPARAGRAPHE000472"></a>

Las cerraduras se aplican sólo cuando se encuentra un Record.

Por defecto (no hay modo de bloqueo especificado en &lt;Opciones&gt;), la Record no está bloqueada.

Si se solicita un bloqueo (constantes *hLockWrite* o *hLockReadWrite*), se leerá el registro solo si este aún no ha sido bloqueado.

Recordatorio: Una Record bloqueada puede ser desbloqueada por [HUnlockRecNum](../WDLang4/3044194.md).
![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Las opciones de bloqueo no tendrán efecto si los bloqueos no son soportados por el proveedor OLE DB o por Conector Nativo.

<a name="XComponent"></a>

## Componente:
wd280hf.dll
