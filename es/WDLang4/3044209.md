
## HCreateMovableReplica( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Crea una réplica móvil. Este archivo puede utilizarse para **replicar los datos encontrados en la base de datos actual** hacia una base de datos remota (para enviar por Email o FTP por ejemplo).

**Tsu función puede ser utilizada con réplicas basadas en registros o universales.**

**Observación**: Se puede crear una réplica móvil a partir de la base de datos maestra o de la base de datos de suscriptores.. Para crear una réplica portátil destinada a un abonado (réplica de maestro a abonado), los archivos de datos del maestro deben abrirse de antemano.

![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Solo está disponible la replicación universal. 

Nota: La replicación no está disponible al acceder a una base de datos mediante un .






<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) 
```wl
// LOG-BASED REPLICATION
// In Montpellier: Prepare to send messages to Paris
HCreateMovableReplica("P:\MSG\MSG.RPM", "Paris", "C:\Temp\MsgMPL.WDZ")
// Send the file (by FTP for example)
FTPSend("C:\Temp\MsgMPL.WDZ", "FTP.PCSOFT_PARIS.FR\MSG\MsgMPL.WDZ") 
----------------
// In Paris: Retrieve the messages from Montpellier
HSynchronizeReplica("Z:\MSG", "\\FTPSERVER\MSG\MsgMPL.WDZ", rplToMaster)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = HCreateMovableReplica(<Master replica or subscriber replica> , <Identifier of subscriber replica> , <Name of replication file to create> [, <Filter of records to replicate>])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si el archivo correspondiente a la réplica móvil fue creado, 

- <u><u><u><u>False</u></u></u></u> en caso contrario.




**`<Master replica or subscriber replica>: (Cadena de caracteres)`**

Nombre y ruta completa (o relativa) de la réplica maestra (archivo".RPM") o de la réplica del suscriptor (archivo".RPL"). Se permite el uso de un sistema UNC ruta.

Si no se especifica este parámetro o si corresponde a una cadena vacía (""), se buscará el archivo description en el directorio actual.

**Atención**: este directorio debe ser accesible cuando se ejecute **HCreateMovableReplica**.

**`<Identifier of subscriber replica>: (Entero o cadena de caracteres)`**

Identificador de la réplica del suscriptor a utilizar. Este identificador fue devuelto por [HCreateSubscriberReplica](../WDLang4/3044253.md). Este identificador es necesario sólo cuando la replicación se realiza desde la base de datos maestra a la base de datos de suscriptores; de lo contrario, se ignora.

**En replicación universal**este parámetro es necesario en cualquier caso.

**`<Name of replication file to create>: (Cadena de caracteres)`**

Nombre completo correspondiente al fichero físico de replicación a crear. Este archivo contiene los datos requeridos por la replicación remota hacia la réplica (maestro o suscriptor) identificados por su identificador.. Este archivo contiene los datos modificados desde la última replicación exitosa. 
El archivo creado es un archivo comprimido (extensión ".WDZ" predeterminada) que contiene la descripción de la réplica maestro o esclavo, así como secciones de los archivos de datos necesarias para la replicación. Esta extensión puede ser modificada.

**Para la replicación universal**se ignora el contenido de este parámetro. Le recomendamos que utilice una cadena vacía ("""): el nombre del archivo será calculado automáticamente por la función. 
Después de la llamada a **HCreateMovableReplica**, el RPL.File Variable contiene el nombre del archivo de replicación móvil que se ha creado. **Atención**: El valor de este Variable está disponible hasta la próxima llamada a una función de replicación.

**`<Filter of records to replicate>: (Cadena de caracteres opcional)`**

Nombre del procedimiento del filtro WLanguage llamado para cada Record tomada en cuenta por la réplica. 
Esta Procedure se utiliza para filtrar los registros para replicar. Si este procedimiento devuelve <u><u><u><u>False</u></u></u></u>, no se tiene en cuenta el registro: 

- no se copiará en la base de datos de suscriptores durante la primera sincronización,

- se eliminará de la base de datos de suscriptores si se tuvo en cuenta durante una sincronización anterior.


Si este procedimiento devuelve <u><u><u><u>True</u></u></u></u>, la replicación tiene en cuenta el registro. 
En esta Procedure se pueden utilizar varias variables (ver Observaciones).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones




### Nombre de la réplica móvil (réplica universal)
<a name="nombre_replica_movil_replica_universal_ELTPARAGRAPHE000131"></a>

Este nombre se construye automáticamente con la función **HCreateMovableReplica**.

Este nombre tiene el siguiente formato: 

- Réplica creada a partir de la base de datos maestra para actualizar el suscriptor: To_&lt;SubscriberName&gt;_&lt;XXX&gt;.RPA

- Réplica creada a partir de la base de datos de suscriptores para actualizar la base de datos maestra: De_&lt;NombreDelSuscriptor&gt;_&lt;XXX&gt;.RPA
	donde: 

	- Nombre del suscriptor&gt; &lt;Nombre del suscriptor: Nombre del abonado en claro (identificador especificado en [HCreateSubscriberReplica](../WDLang4/3044253.md)).

	- &lt;XXX&gt;&gt;: Número de la réplica (incrementado por suscriptor y por dirección de replicación).







Después de la llamada a **HCreateMovableReplica**, el RPL.File Variable contiene el nombre del archivo de replicación móvil que se ha creado. **Atención**: El valor de este Variable está disponible hasta la próxima llamada a una función de replicación. 
<a name="NOTE0_2"></a>


### Las variables se inicializan automáticamente en el WLanguage Procedure para filtrar los registros
<a name="las_variables_inicializan_automaticamente_wlanguage_procedure_para_filtrar_los_registros_ELTPARAGRAPHE000157"></a>

Las siguientes variables se inicializan automáticamente en el WLanguage Procedure para filtrar los registros (el nombre del Procedure corresponde al parámetro &lt;Filtro de registros a replicar&gt;). 

| Variable | escribir a máquina | description y valores |
| --- | --- | --- |
| Archivo RPL.file | Cadena de caracteres | Nombre del archivo cuyos datos se replicarán. |
| Operación RPL | Constante de tipo Integer | Operación HFSQL que será replicada:<br><br>- **rplHAdd**: replicar una adición.<br><br>- **rplHModify**: replicar una modificación.<br><br>- **rplHDelete**: replicar un borrado.<br><br><br> |
| Conflicto RPL | Constante de tipo Integer | Indica si se ha detectado un conflicto durante la replicación.. Los valores posibles son los siguientes:<br><br>- **rplNoConflict**: no se detectó ningún conflicto.<br><br>- **rplModifyConflict**: El Record fue modificado tanto en la réplica de origen como en la de destino.<br><br>- **rplDeleteConflict**: La Record fue borrada de la réplica de destino y fue modificada o borrada en la réplica de origen.<br><br><br>Para forzar la replicación si se produce un conflicto, inicialice la variable RPL.Conflict con la variable *rplNoConflict*.<br>De lo contrario, la replicación se realizará sólo si el conflicto es un conflicto de modificación y si los datos a replicar provienen de la base de datos maestra. |
| Dirección RPL | Constante de tipo Integer | Indica la dirección de la replicación (useful para una replicación bidireccional):<br><br>- **rplToSubscriber**: replicación de maestro a suscriptor.<br><br>- **rplToMaster**: replicación de suscriptor a maestro.<br><br><br> |
| Número de operación RPL | Integro | Número de la operación actual. Este valor se incluye entre 1 y RPL.OperationMax. Este Variable le permite manejar fácilmente una barra de progreso. |
| Operación RPLMax | Integro | Número total de operaciones a replicar. Este Variable le permite manejar fácilmente una barra de progreso. |
| RPL.SourceAlias | Cadena de caracteres | Nombre del alias de origen del archivo replicado (RPL.File). Este archivo contiene los valores de los elementos que serán copiados ([HModify](../WDLang4/3044042.md)) o añadidos ([HAdd](../WDLang4/3044147.md)) en el archivo de datos actualmente replicados. |
| RPL.TargetAlias | Cadena de caracteres | Nombre del alias de destino del archivo replicado (RPL.File). Este archivo contiene los valores de los elementos anteriores a la copy o la eliminación en el archivo de datos actualmente replicada. |






### Función de replicación y WithSpace
<a name="funcion_replicacion_withspace_ELTPARAGRAPHE000378"></a>

La replicación no es compatible con [WithSpace](../WDLang4/3044142.md) en el código de la aplicación cliente. Esta función cambia el comportamiento de HFSQL. El uso de esta función en la aplicación cliente puede afectar a la eficiencia de la replicación.

A partir de la versión 21 actualización 3 (versión 210065), las funciones de sincronización (replicación universal programada o asistida) devuelven un error a la aplicación cliente si se ha aplicado [WithSpace](../WDLang4/3044142.md) a al menos uno de los archivos replicados. 

<a name="XComponent"></a>

## Componente:
wd280rpl.dll
