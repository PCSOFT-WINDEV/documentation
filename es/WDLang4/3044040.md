
## Bloqueando archivos de datos: correspondencia entre WINDEV 5.5 y las versiones posteriores
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Cerraduras en la versión 5.5
<a name="cerraduras_version_55_ELTTEXTE000182"></a>
Tres modos de gestión de bloqueos estaban disponibles en la red:

- **HModePerso(True)**: Las pruebas de bloqueo tenían que ejecutarse después de cada llamada a una función Hyper File.

- **HModePerso(False)**: Las pruebas de bloqueo deben ejecutarse después de cada llamada a una función Hyper File, excepto en el caso de las funciones de lectura sin bloqueo.

- **HModeSemiPerso()**: La prueba del error de estado de la cerradura se ha ejecutado automáticamente. Si el bloqueo fallaba, se detenía la ejecución del programa.




**HModeAuto** se utilizó en modo de usuario único.

**Observación**: No hay gestión de cerraduras automatic disponible para los elementos de Memo o Memo Binario.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Bloqueo en las versiones posteriores
<a name="bloqueo_las_versiones_posteriores_ELTTEXTE000206"></a>
En las versiones posteriores a la 5.5, la gestión de los cierres es más fácil y potente:

- **Modo H ( hModeMulti )**: gestión de un modo multiusuario (red)

- **Modo H ( hModeMono )**: gestión de un modo monousuario.




**En una nueva aplicación WINDEV 28 , en modo multiusuario, los bloqueos son administrados automáticamente por el motor HFSQL**. Esto puede ser personalizado por [HOnError](../WDLang4/3044017.md).

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Bloquea al migrar un proyecto a una versión posterior
<a name="bloquea_migrar_proyecto_una_version_posterior_ELTTEXTE000230"></a>
Cuando un proyecto se migra a una versión posterior a la versión 5.5, se realizan automáticamente algunas operaciones para mantener el modo de funcionamiento de WINDEV 5.5 al tiempo que se limitan las modificaciones del código.. La siguiente tabla presenta para cada modo de bloqueo de WINDEV 5.5:

- las operaciones realizadas automáticamente durante la migración

- las operaciones que deben realizarse en casos especiales.




**Observación**: Un proyecto migrado a la versión 28 mantendrá su propia gestión de cerraduras. El código se migra para que esta gestión de las cerraduras funcione correctamente.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Observaciones
<a name="observaciones_ELTTEXTE000254"></a>




### Caso HModePerso(True)
<a name="caso_hmodepersotrue_ELTPARAGRAPHE000058"></a>

Tipo de cerradura 5.5: 

```wl
HModePerso(True)
```
Código equivalente:

```wl
HMode(hModeMulti)
HOnError("*", hErrAll, "")
```


- El código equivalente se inserta automáticamente al migrar el proyecto.

- La línea de código **HOnError("\*", hErrAll ,"")** se inserta en el código de inicialización del proyecto.

- Si el código WINDEV 5.5 contenía varias llamadas a la función **HModePerso**(True), se debe copiar la línea de código **HOnError("\*",hErrAll,"")** después de cada llamada.



<a name="NOTE4_2"></a>


### Caso HModePerso(False)
<a name="caso_hmodepersofalse_ELTPARAGRAPHE000074"></a>

Tipo de cerradura 5.5: 

```wl
HModePerso(False)
```
Código equivalente: 

```wl
HMode(hModeMulti)
HOnError("*", hErrAll, "")
```


- El código equivalente se inserta automáticamente al migrar el proyecto.

- El código HOnError("\*",hErrAll,"") se inserta en el código de inicialización del proyecto.

- Si su código WINDEV 5.5 contenía varias llamadas a HModePerso(False), la línea de código HOnError("\*",hErrAll,"") debe copiarse después de cada llamada.

- Atención: Al leer una Record bloqueada en modo lectura/escritura (si se ha llamado a [HLockFile](../WDLang4/3044153.md), por ejemplo):

	- el motor Hyper File 5.5 volvió a intentarlo indefinidamente mientras ignoraba el valor de H.NbRetry.

	- el motor HFSQL Classic reintenta teniendo en cuenta el valor de H.NbRetry.






<a name="NOTE4_3"></a>


### Caso HModeSemiPerso()
<a name="caso_hmodesemiperso_ELTPARAGRAPHE000097"></a>

Tipo de cerradura 5.5: 

```wl
HModeSemiPerso()
```
Código equivalente: 

```wl
HMode(hModeMulti)
HOnError("*",hErrLock, "_LockFailed")
```


Donde "_LockFailed" es una Procedure global del proyecto


```wl
PROCEDURE _LockFailed()
IF YesNo("Lock" + "Do you want to retry or exit from the program") = No THEN
   	RETURN opEndProgram
END
RETURN opRetry
```


- **HModeSemiPerso** se migra automáticamente a HMode ( hModeMulti ).

- El código HOnError("\*",hErrAll,"") se inserta en el código de inicialización del proyecto.

- Operaciones a realizar:

	- Crear un Procedure global al proyecto con el siguiente código.

	- Modificar [HOnError](../WDLang4/3044017.md) para que inicie el Procedure global.




- Si el código WINDEV 5.5 contenía varias llamadas a la función **HModeSemiPerso**, se debe volver a copiar el código para llamar a la función **HOnError** después de llamar a la función HModeSemiPerso.



<a name="NOTE4_4"></a>


### Caso HModeAuto
<a name="caso_hmodeauto_ELTPARAGRAPHE000124"></a>

Tipo de cerradura 5.5: 

```wl
HModeAuto
```
Código equivalente: 

```wl
HMode(hModeMono)
HOnError("*", hErrAll, "")
```


- El código equivalente se inserta automáticamente al migrar el proyecto.

- El código HOnError("\*",hErrAll,"") se inserta en el código de inicialización del proyecto.

- Si su código WINDEV 5.5 contiene varias llamadas a HModeAuto, la línea de código HOnError("\*", hErrAll, "") debe copiarse después de cada llamada.





