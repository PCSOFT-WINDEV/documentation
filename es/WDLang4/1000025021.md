


## &lt;Fuente&gt;.ReadPrevious (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Establece la posición en el registro anterior del archivo de datos de acuerdo con un elemento de navegación. Se lee el registro y se actualizan las variables HFSQL (por ejemplo, Cliente.Nombre, es decir, el elemento/campo *Nombre* del archivo de datos *Cliente*).

Los valores de la posición de búsqueda se leen en orden descendente (véase observaciones para más detalles).

Generalmente, la función **&lt;Fuente&gt;.ReadPrevious** establece la posición al recorrer el archivo de datos.

Después de llamar a la función **&lt;Fuente&gt;.ReadPrevious**, se pueden producir los siguientes casos:

- el archivo de datos está vacío o ningún registro corresponde al filtro (definido con la función [&lt;Fuente&gt;.Filter](../WDLang4/1000024960.md)): no se realiza ninguna lectura y la función [&lt;Fuente&gt;.Out](../WDLang4/1000024605.md) devuelve <u><u><u>True</u></u></u>.

- la función intenta bloquear un registro ya bloqueado en modo de lectura: no se realiza ninguna operación de lectura, [HErrorLock](../WDLang4/3044099.md) devuelve <u><u><u>True</u></u></u> y [&lt;Fuente&gt;.Out](../WDLang4/1000024605.md) devuelve <u><u><u>True</u></u></u>.
	
	![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Los bloqueos no se pueden gestionar en bases de datos a las que se accede mediante JDBC. 




Esta función se puede utilizar con archivos de datos, vistas HFSQL o consultas.

<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
Customer.ReadLast(Name)
WHILE Customer.Out() = False
	// Process the record
	Customer.ReadPrevious(Name)
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = <Source>.ReadPrevious([<Browse item> [, <Options>]])`
---

**`<Result>: (Booleano)`**



- <u><u><u><u>True</u></u></u></u> si se leyó el registro anterior,

- <u><u><u><u>False</u></u></u></u> si se produce un error (bloqueo, fin del archivo de datos, etc.): el registro no se lee. Este problema puede ser causado por:

	- un problema de posicionamiento (archivo vacío, ....): la función [&lt;Fuente&gt;.Found](../WDLang4/1000025076.md) devuelve <u><u><u><u>False</u></u></u></u> y la función [HError](../WDLang4/3044088.md) devuelve 0.

	- un error: la función [HError](../WDLang4/3044088.md) devuelve un número entero distinto de 0. La función [HErrorInfo](../WDLang4/3044071.md) devuelve más detalles.







**`<Source>: (Tipo de fuente especificada)`**

Nombre del archivo de datos, vista HFSQL o consulta utilizada. 

**`<Browse item>: (Cadena de caracteres opcional)`**

Nombre del elemento utilizado para el bucle de el archivo de datos. Si no se especifica este nombre, la función **&lt;Fuente&gt;.ReadPrevious** utilizará:

- *Para un archivo de datos*: el último elemento de búsqueda utilizado en este archivo por la última función para la gestión de HFSQL (empezando por la letra H). Si este campo no existe, el mejor campo de navegación se utiliza automáticamente. 

- *For a query*: el PEDIDO POR de consulta si existe, en caso contrario el último ítem utilizado.

- *Para una vista*: el elemento de ordenación de la vista (si existe), en caso contrario el último elemento utilizado.




**`<Options>: (Constante o combinación de constantes opcional)`**

Permite configurar:

- el bloqueo establecido en el Record leído por **&lt;Fuente&gt;.ReadPrevious**.

- la gestión de duplicados. Por Default, todos los duplicados son examinados.





|   |   |
| --- | --- |
| *hDistinct* | Si se encuentran duplicados, esta constante permite leer una sola Record entre los duplicados. Este parámetro sólo se tiene en cuenta si la búsqueda se realiza en un elemento clave. |
| *hLockNo* | Sin bloqeuo: la Record puede ser leída o modificada por otra aplicación durante la lectura. |
| *hLockReadWrite* | Bloqueo de lectura y escritura: el Record que se lee actualmente no puede ser leído o modificado por otra aplicación. |
| *hLockWrite* | Bloqueo de escritura: el Record que se lee actualmente puede ser leído por otra aplicación pero no puede ser modificado por otra aplicación. |


![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Las opciones de bloqueo no tendrán efecto si los bloqueos no son soportados por el proveedor OLE DB o por Conector Nativo.![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) Las opciones de bloqueo especificadas en la función **&lt;Fuente&gt;.ReadPrevious** no se tienen en cuenta. El modo de bloqueo especificado con la función [&lt;Fuente&gt;.ReadFirst](../WDLang4/1000025022.md) o [&lt;Fuente&gt;.ReadLast](../WDLang4/1000025020.md) seguirá siendo efectivo al llamar a las funciones **&lt;Fuente&gt;.ReadPrevious** y [&lt;Fuente&gt;.ReadNext](../WDLang4/1000025035.md).

Para cambiar el modo de bloqueo, utilice:

- [&lt;Fuente&gt;.ReadSeekFirst](../WDLang4/1000025034.md) o [&lt;Fuente&gt;.ReadSeekLast](../WDLang4/1000025024.md), 

- [&lt;Fuente&gt;.ReadFirst](../WDLang4/1000025022.md) o [&lt;Fuente&gt;.ReadLast](../WDLang4/1000025020.md).

- [&lt;Fuente&gt;.LockRecNum](../WDLang4/1000024197.md) o [&lt;Fuente&gt;.UnlockRecNum](../WDLang4/1000024212.md).


![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png)  Para Conector Nativo Oracle, se puede especificar un modo de bloqueo diferente para cada Record. Sin embargo, si se inició una transacción mediante [SQLTransaction](../WDLang4/3072029.md) antes de establecer el bloqueo, éste sólo se liberará al final de la transacción ([SQLTransaction](../WDLang4/3072029.md) con la constante *sqlCommit* o *sqlRollBack*).![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png) Las opciones de bloqueo no se tienen en cuenta. Utilizar las funciones de lectura de bloqueo (**HReadPreviousLock**) conservadas para la compatibilidad con el pasado.![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Acceso con JDBC: Este parámetro no se tiene en cuenta.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Lectura o no de la operación según un elemento clave
<a name="lectura_operacion_segun_elemento_clave_ELTPARAGRAPHE000429"></a>

Si el elemento utilizado es una clave, la función **&lt;Fuente&gt;.ReadPrevious** lee el registro con el valor de clave más alto. El criterio de ordenación que se tiene en cuenta es el especificado en el análisis para esta clave. 

Si el elemento utilizado es una clave, la función **&lt;Fuente&gt;.ReadPrevious** lee el anterior registro activo. Al navegar por el archivo de datos, los Record s se ordenarán según su número de Record. 
En este caso, el elemento de navegación seleccionado aparecerá en rojo en el editor de código y se mostrará una advertencia en la pantalla de ["Panel"Código](../Editeurs/2027009.md).

**Observación**: La [autocompletado](../Editeurs/2013001.md) propone únicamente los puntos clave.
<a name="NOTE0_2"></a>


### Recorrer en bucle los registros que coinciden con una condición
<a name="recorrer_bucle_los_registros_que_coinciden_con_una_condicion_ELTPARAGRAPHE000455"></a>

En la mayoría de los casos, [&lt;Fuente&gt;.ReadSeek](../WDLang4/1000025023.md), [&lt;Fuente&gt;.ReadSeekFirst](../WDLang4/1000025034.md) y [&lt;Fuente&gt;.ReadSeekLast](../WDLang4/1000025024.md) se utilizan para posicionar en el archivo de datos para realizar un bucle de búsqueda entre los registros correspondientes a una condición. Las funciones [&lt;Fuente&gt;.ReadNext](../WDLang4/1000025035.md) y **&lt;Fuente&gt;.ReadPrevious** permiten leer el anterior o siguiente registro según las siguientes condiciones:

- si el elemento utilizado es una clave, la función **&lt;Fuente&gt;.ReadPrevious** leerá los registros anteriores que corresponden a los valores inferiores o iguales al valor buscado.

- si el elemento utilizado no es una clave, **&lt;Fuente&gt;.ReadPrevious** leerá los siguientes registros correspondientes a los valores iguales al valor buscado.




Para ignorar la búsqueda mientras se va a la siguiente o anterior Record, utilice una de las siguientes funciones:

- [&lt;Fuente&gt;.CancelSeek](../WDLang4/1000024193.md)

- [&lt;Fuente&gt;.ReadLast](../WDLang4/1000025020.md)

- [&lt;Fuente&gt;.ReadFirst](../WDLang4/1000025022.md)



<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png)![HFSQL Classic](https://doc.pcsoft.fr/ext/images/us/HF.png)![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png)![Procedimientos almacenados](https://doc.pcsoft.fr/ext/images/us/PS.png)![Hyper File 5.5](https://doc.pcsoft.fr/ext/images/us/HF55.png)![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Bloqueos
<a name="bloqueos_ELTPARAGRAPHE000511"></a>

Por defecto (&lt;Opciones&gt; no especificadas), la Record no está bloqueada.

Si se solicita un bloqueo (constante *hLockWrite* o *hLockReadWrite*), se leerá el registro solo si aún no ha sido bloqueado.

![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Las opciones de bloqueo no tendrán efecto si los bloqueos no son soportados por el proveedor OLE DB o por Conector Nativo.
<a name="NOTE0_4"></a>


### Memos
<a name="memos_ELTPARAGRAPHE000527"></a>

Los memos asociados con el Record pueden ser leídos automáticamente (o no) cuando se lee el Record. [&lt;Fuente&gt;.SetMemo](../WDLang4/1000024987.md) se utiliza para personalizar esta operación de lectura de automatic.

Si los memos están soportados, los memos de texto asociados se leen cuando se lee la Record. Los memos binarios sólo se leen cuando se utilizan explícitamente ([&lt;Fuente&gt;.ExtractMemo](../WDLang4/1000024957.md)).
<a name="NOTE0_5"></a>


### Varios
<a name="varios_ELTPARAGRAPHE000549"></a>

- La función [&lt;Fuente&gt;.RecNum](../WDLang4/1000025041.md) devuelve el número de registro actual.

- La función [&lt;Fuente&gt;.ChangeKey](../WDLang4/1000024198.md) cambia la clave de búsqueda conservando la posición en el registro actual.

- Para optimizar las primeras iteraciones en un archivo de datos, utilice [&lt;Fuente&gt;.Optimize](../WDLang4/1000025042.md) en este archivo de datos.

- Esta función sustituye a **HReadPreviousLock** y **HReadPrevious**, que se mantuvieron por compatibilidad con WINDEV 5.5.




<a name="XComponent"></a>

## Componente:
wd280hf.dll
