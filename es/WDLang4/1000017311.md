
## Notificaciones de un servidor HFSQL
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000198"></a>
Un servidor HFSQL puede realizar varias operaciones que requieren enviar una Notification: 

- Un servidor puede encontrar problemas sin que ningún usuario (o desarrollador) note nada.. 
	Por ejemplo: 

	- una tarea programada puede fallar. 

	- un respaldo de automatic puede fallar. 

	- un nodo puede convertirse en Inactive en un cluster HFSQL, ...




- Un servidor también puede realizar operaciones automatic ally (actualización de automatic, búsqueda de claves para optimizar las consultas, ...). La implementación y el estatus de reporte de estas operaciones requieren un Notification. 




El Centro HFSQL control se utiliza para: 

- ver el historial de incidentes/notificaciones que ocurrieron en el servidor. Para obtener más información, consulte [Historial de incidentes/notificaciones](#NOTE2_1). 

- ser informado en caso de incidente (por correo electrónico o a través de la mensajería de los Centros control). Para obtener más información, consulte [Recepción de las notificaciones (por Email o WDBal)](#NOTE3_1). 


Observación: Estas operaciones también están disponibles a través de la programación. 



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Historial de incidentes/notificaciones
<a name="historial_incidentesnotificaciones_ELTTEXTE000228"></a>


### Presentación
<a name="presentacion_ELTPARAGRAPHE000043"></a>

Se crea un Notification para cada problema que ocurre en el servidor HFSQL. Las características de esta Notification son las siguientes: 

- Fecha y hora del incidente. 

- Mensaje que presenta el incidente. 

- Categoría de incidente: Información, Advertencia, Crítico, Error. 

	- Información: Información sobre los eventos que ocurrieron en el servidor. 
			Ejemplo: 

		- Actualización de automatic del servidor HFSQL con reinicio. 

		- Sugerencia para añadir claves y claves compuestas para optimizar el tiempo de ejecución de las consultas. 




- Advertencia: Eventos que no desencadenan un fallo pero sobre los que hay que hacer algo.
			Ejemplo: Resolución de un conflicto de modificación para la replicación. Si se producen varias de ellas, es posible que haya que cambiar la arquitectura de la aplicación (de lo contrario, no hay necesidad de preocuparse).

- Crítico: Fallos para los que no se puede devolver ningún error al usuario.
			Ejemplos: Error de idioma en un Procedure almacenado usado por una tarea programada, fallo de la conexión a un servidor replicado, ...

- Error: Problema con respecto a la gestión de la caché de Windows. 




Se puede ver el historial de avisos: 

- desde el Centro de Control HFSQL. 

- mediante programación. 



<a name="NOTE2_2"></a>


### Historial de notificaciones mostradas en el HFSQL control Center
<a name="historial_notificaciones_mostradas_hfsql_control_center_ELTPARAGRAPHE000075"></a>

El Centro HFSQL control le permite ver el historial de los incidentes que ocurrieron en el servidor.

Para ver esta historia: 

1. Iniciar el Centro de Control HFSQL. 

2. Seleccione el servidor deseado. 

3. Visualizar la ficha "Notificaciones. 

4. Se muestra la lista de notificaciones enviadas por el servidor. Es posible: 

	- borrar el Notification. 

	- actualización la lista. 






<a name="NOTE2_3"></a>


### Acceso al historial de notificaciones mediante programación
<a name="acceso_historial_notificaciones_mediante_programacion_ELTPARAGRAPHE000092"></a>

El historial de notificaciones se guarda en un archivo HFSQL que se encuentra en la base de datos del sistema del servidor: "Alerta.fic.". 

Este archivo de datos puede ser manejado mediante la programación de la siguiente manera: 


```wl
PROCEDURE HFCS_RetrieveLastNotifications(sServer, sUser="Admin", sPassword=""): string
// Parameters for connecting to the server whose last notification must be retrieved
ctConnection is Connection
ctConnection.Provider = hAccessHFClientServer
ctConnection.Server = sServer
ctConnection.User = sUser
ctConnection.Password = sPassword
ctConnection.Database = "__System"

// By default, don't return anything
RETURN = ""
// Files of server notifications
dsAlert is Data Source
IF HDeclareExternal("Alert.fic", dsAlert, ctConnection) THEN
	// Last notification in date
	IF HReadLast(sdAlert, Date) THEN
		// Retrieves the record
		RETURN = HRecordToString(sdAlert)
	END
	// Frees the declared file
	HCancelDeclaration(dsAlert)
	// Frees the connection
	HCloseConnection (ctConnection)
ELSE
	// Failure accessing the server
	Error("Error while retrieving the notifications: " + HErrorInfo(hErrFullDetails))
END
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Recepción de las notificaciones (por Email o WDBal)
<a name="recepcion_las_notificaciones_por_email_wdbal_ELTTEXTE000264"></a>


### Presentación
<a name="presentacion_ELTPARAGRAPHE000105"></a>

Por Default, las notificaciones se encuentran en el Centro control de HFSQL. También puede ser notificado en tiempo real cuando ocurre un problema en el servidor HFSQL.. Todo lo que tienes que hacer es configurar el sistema Notification del servidor HFSQL. 

Esta configuración se puede realizar: 

- a través del Centro HFSQL control. 

- mediante programación. 



<a name="NOTE3_2"></a>


### Centro de Control HFSQL
<a name="centro_control_hfsql_ELTPARAGRAPHE000117"></a>

Para configurar el envío de notificaciones HFSQL desde HFSQL control Center: 

1. Iniciar el Centro de Control HFSQL. 

2. Seleccione el servidor deseado. 

3. En la cinta, en el grupo "Parámetros", haga clic en "Configuración del servidor".

4. En la lista de configuraciones posibles, haga clic en "Notificaciones".. Aparece la ventana para configurar los avisos.: <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=CC_HF_Gestion_Serveur%20-%20HC%20N%B0014.gif&type=thumb)


5. Configurar los modos de envío de notificaciones: 

	- en la pestaña "Enviar por Email", especifique las características del servidor SMTP que se utilizará para enviar las notificaciones por Email. 

	- en la sección "Enviar por mensajería (WDBal)", especifique las características de la base de datos de los Centros control que se utilizará para enviar las notificaciones.


 Observaciones: 

- El botón "Recuperar configuración de el equipo" se utiliza para recuperar la configuración del ordenador actual. 

- La base de datos de los Centros control puede estar en modo clásico o en modo cliente/servidor. 

6. Crear los destinatarios de los avisos: 

	- El botón ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Notif_HF_Email.gif) permite añadir un destinatario para el envío por Email. Especificar el correo electrónico Address del destinatario y validar. 

	- El botón ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Notif_HF_Bal.gif) sirve para añadir un destinatario para el envío a través de la mensajería (WDBal) de los Centros control. Seleccione los destinatarios relevantes y valide. 

	- En la lista de destinatarios, seleccione para cada destinatario el nivel mínimo de gravedad de los incidentes para los que desea enviar notificaciones.




7. Haga clic en el botón "Aplicar" para validar la configuración.. 



<a name="NOTE3_3"></a>


### Programación
<a name="programacion_ELTPARAGRAPHE000148"></a>Se pueden utilizar varias funciones de WLanguage para configurar el envío de notificaciones HFSQL programando: 



|   |   |
| --- | --- |
| [HNotifAddCCRecipient](../WDLang4/1000020387.md) | Agrega destinatarios para las notificaciones enviadas a través de los Centros de Control (herramienta de mensajería WDBal). |
| [HNotifAddEmailRecipient](../WDLang4/1000020386.md) | Agrega destinatarios para las notificaciones enviadas por correo electrónico. |
| [HNotifConfigure](../WDLang4/1000020390.md) | Especifica y configura el servidor utilizado para enviar notificaciones por el servidor HFSQL. |
| [HNotifDeleteCCRecipient](../WDLang4/1000020398.md) | Elimina los destinatarios de una notificación enviada a través de los Centros de Control (herramienta de mensajería WDBal). |
| [HNotifDeleteEmailRecipient](../WDLang4/1000020399.md) | Elimina los destinatarios de una notificación por correo electrónico. |
| [HNotifListCCRecipiente](../WDLang4/1000020391.md) | Devuelve la lista de destinatarios de una notificación enviada a través de los Centros de Control (herramienta de mensajería WDBal). |
| [HNotifListEmailRecipient](../WDLang4/1000020388.md) | Devuelve la lista de destinatarios de una notificación por correo electrónico. |






