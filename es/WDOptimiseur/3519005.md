
## Iniciando WDOptimizer en el comando Line
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Sintaxis
<a name="sintaxis_ELTTEXTE000232"></a>


### La siguiente sintaxis permite iniciar WDOptimizer en el comando Line
<a name="siguiente_sintaxis_permite_iniciar_wdoptimizer_comando_line_ELTPARAGRAPHE000011"></a>




```txt
WDOptimizer	 /Fic=<Directory>
	/Pwd=<Password>
	/Option=<Type of action performed>
	/Log=<Log file>
	/Mute=<Yes/No>
	/ExploreSubDir=<Yes/No>
	/CompressIndex=<Yes/No>
	/DelIndex=<Yes/No>
	/GetMemos=<Yes/No>
	/KeepCrossedRec=<Yes/No>
	/Charset=<Character set>
	/Density=<Density rate>
	/Language=<Display language>
	/Bck=<Yes/No>
```


El tabla que se muestra a continuación presenta los diferentes elementos que se pueden encontrar en el comando Line:

| **Parameter** | **Significado** |
| --- | --- |
| /Fic=&lt;Directorio&gt; | A Process un solo archivo de datos: completo ruta del archivo de datos a Process.<br>A Process un set de archivos de datos:<br><br>- ruta de un directorio,<br><br>- Fichero INI en formato de exportación generado por WDOptimizer. <br><br><br>A Process las transacciones: ruta completa del fichero de la transacción.<br>**Ejemplo**: c:\\temp\\fichero.fic |
| /Pwd=&lt;Contraseña&gt;&gt; Contraseña | Contraseña asociada de el archivo de datos a Process (un solo archivo de datos) |
| /Opción=&lt;Tipo de acción a realizar&gt;&gt;Tipo de acción a realizar | Número correspondiente a la opción de inicio de WDOptimizer:<br>1: Verificar índice.<br>2: Optimizar la velocidad de los índices (recalcular las estadísticas en los archivos de datos).<br>3: Volver a construir índices.<br>4: Reconstruir los índices y los memos.<br>5: Compruebe y comprima los índices y los memos. |
| /Log=&lt;Archivo de registro&gt; | ruta completa del fichero log (.log) para crear. Este archivo se crea sólo si se selecciona una opción de 1 a 5. |
| /Mute=&lt;Yes/No&gt; | Sí para validar automáticamente la ventana de reporte (No por Default). |
| /ExploreSubDir=&lt;Yes/No&gt; | Sí para explorar los subdirectorios del directorio especificado en "/Fic" (No por Default). |
| /CompressIndex=&lt;Yes/No&gt; | Sí para borrar los registros de Inactive durante una operación de reindexación (opciones 3 y 4) (No por Default). |
| /DelIndex=&lt;Sí/No&gt; | Sí para borrar los registros dañados (opciones 3 y 4) (No por Default). |
| /GetMemos=&lt;Yes/No&gt; | Sí para intentar recuperar los datos del memorándum si está dañado (opción 5) (No por Default). |
| /KeepCrossedRec=&lt;Yes/No&gt; | Sí para mantener los registros cruzados (opción 5) (No por Default). |
| /Charset=&lt;Charset&gt; | Se utiliza para especificar el carácter set utilizado para la operación de reindexación. Tiene la capacidad de utilizar una de las constantes correspondientes al carácter set a utilizar.<br><br><br>\   \   \<br>\ --- \ --- \<br>\ *charsetArabic* \ Caracteres arábigos \<br>\ *charsetBaltic* \ Caracteres bálticos \<br>\ *charsetChinese* \ Caracteres chinos (República Popular China) \<br>\ *charsetDefault* \ Utiliza el conjunto de caracteres predeterminado del equipo. No se fuerza ningún conjunto de caracteres. \<br>\ *charsetEastEurope* \ Personajes de Europa del Este (polaco,...) \<br>\ *charsetGreek* \ Caracteres griegos \<br>\ *charsetHebrew* \ Caracteres hebreos \<br>\ *charsetJapanese* \ Caracteres japoneses \<br>\ *charsetKorean* \ Caracteres coreanos \<br>\ *charsetOccidental* \ Caracteres romanos en estándar ANSI \<br>\ *charsetRussian* \ Caracteres rusos \<br>\ *charsetThai* \ Caracteres tailandeses \<br>\ *charsetTraditionalChinese* \ Caracteres chino tradicional (República de Taiwán) \<br>\ *charsetTurkish* \ Caracteres turcos \<br>\ *charsetUTF8* \ Se utiliza para gestionar los países con dos caracteres set (Hong Kong) y los países sin carácter set definidos en Windows (georgiano y armenio). \<br>\ *charsetVietnamese* \ Caracteres vietnamitas \<br><br> |
| /Densidad=&lt;Tasa de densidad&gt;&gt; Densidad | Índice de densidad de los índices. Esta tasa es set a 80 por Default. <br>**Cuanto mayor sea esta tasa, mayor será**cuanto más denso y más pequeño es el índice. En este caso, las iteraciones, búsquedas, filtros y consultas serán más rápidas. Las adiciones de registros y las modificaciones de registros pueden ser más lentas. <br>**Cuanto menor sea esta tasa, menor será**cuanto menos denso y mayor será el índice. En este caso, las iteraciones, búsquedas, filtros y consultas serán más lentas. Las adiciones de registros y las modificaciones de registros serán más rápidas. |
| /Idioma=&lt;Visualizar idioma&gt;&gt;Visualizar idioma | "US" para iniciar WDOptimizer en inglés (francés por Default). |
| /Bck=&lt;&lt;No&gt; | Por defecto, los archivos de Process se guardan (sólo se tienen en cuenta si /opción = 5). No, si no desea realizar esta copia de seguridad. |



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Ejemplos
<a name="ejemplos_ELTTEXTE000256"></a>
El comando Line de abajo se usa para reindexar los archivos que se encuentran en "C:\\MyApp\\Data".


```wl
ExeRun("C:\MyDirectory\WDOptimizer.EXE /Fic=C:\MyApp\Data")
```

<a name="NOTE2_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Ejemplo de Procedure para la re-indexación
<a name="ejemplo_procedure_para_reindexacion_ELTPARAGRAPHE000181"></a>




```wl
// Global variables of project 
gsAppName is string = "MyApp"
gsDataDir is string = CompleteDir(fExeDir()) + "Data\"
```

```wl
//Procedure global to the project 
PROCEDURE gWdOptimizeAnalysis(_OptionNum = 5,_bSave = False)
// Control WOPTIMIZER for all the files of an application 
// while taking into account the password, exeActive and 
// WDOptimizer is locking when it is run. 
// After each reindex operation, WDOptimizer displays the message
// "The  'C:\ ...\MyFile.Fic' file was successfully reindexed".
// The user must click "OK".
// The option 5 of WDOptimizer is used by default
// By default, the files are not saved before optimization
// - Required: 
//   - The data files can be relocated in relation to the exe 
// (Global variables gsAppName and gsDataDir)
//  - WDOptimizer is always found beside the executable
//  - The files can have a physical name that differs from the logical name 
// as well as an extension <> ".FIC"
 
// Variables local to the process
sFileList, sFileName are strings
sSave is string = "False"
IF _bSave = True THEN sSave = "True"
	i is int = 1
	sDir is string = CompleteDir(fExeDir())
	 // Physical name of the file (name + extension)
	sPhysicalFileName is string
	// Password of the file 
	sPwd is string 
	sCommandLine is string

	// Check the presence of WDOPTIMIZER
	IF fDir(sDir + "WDOptimizer.EXE", frFile) = "" _OR_ ...
				fDir(sDir + "WDTool.WDK", frFile) = "" THEN 
			Error("WDOptimizer was not installed properly")
		RETURN
	END

	// List the analysis files
	sFileList = HListFile()
	sFileName = ExtractString(sFileList, i, CR)
	WHILE sFileName <> EOT 
		sPhysicalFileName = {sFileName}..PhysicalName + {sFileName}..Extension
		IF fDir(gsDataDir + sPhysicalFileName, frFile) <> "" THEN 
			// Take the passwords of some protected files into account  
		SWITCH Upper(sFileName)
			CASE "TOTO": sPwd = "toto"
			OTHER CASE: sPwd = ""  
		END
		IF sPwd <> "" THEN 
			sCommandLine = 
				sDir + "WDOptimizer.EXE   /File=" + ...
				gsDataDir + sPhysicalFileName + " /Pwd=" + sPwd + " /" + ...
					_OptionNum + " /" + sBackup
		ELSE
				sCommandLine = sDir + "WDOptimizer.EXE   /File=" + ...
					 gsDataDir + sPhysicalFileName + " /5 /" + sBackup
			END
		ExeRun(sCommandLine, exeActive, exeWait)
	END
	i++
	sFileName = ExtractString(sFileList, i, CR)
END
Info("The files found in '" + gsAppName + "' were successfully optimized")
```



