


## Sobrecargar una función WLanguage o utilizar una función WLanguage en una consulta SQL
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000298"></a>
WLanguage propone la palabra clave " **WL.** " para:

- [overload una función de WLanguage](#NOTE2_1).

- [Usar una función WLanguage en una consulta SQL ejecutada por el motor HFSQL](#NOTE3_1).
	Observación: La palabra clave " **WL.** " también le permite usar una constante WLanguage en una consulta SQL que contiene una función WLanguage.






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Sobrecarga de una función WLanguage
<a name="sobrecarga_una_funcion_wlanguage_ELTTEXTE000328"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Presentación
<a name="presentacion_ELTPARAGRAPHE000057"></a>

Sobrecargar una función WLanguage le permite utilizar una función personalizada con el mismo nombre que la función WLanguage.

Por ejemplo, en lugar de usar la función WLanguage estándar [Info](../WDLang1/3021011.md) , puede usar un Procedure personalizado llamado ***Info***. El procedimiento personalizado se ejecutará cada vez que se llame a la función ***Info***.
<a name="NOTE2_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### ¿Cómo overload una función de WLanguage?
<a name="¿como_overload_una_funcion_wlanguage_ELTPARAGRAPHE000071"></a>

Para overload una función de WLanguage: 

1. Crear una nueva Procedure en su proyecto (Procedure local o global). Esta Procedure debe tener las siguientes características:

	- El mismo nombre que la función WLanguage de overload.

	- El mismo número de parámetros que la función WLanguage de overload. Estos parámetros deben tener el mismo tipo que los parámetros de la función WLanguage.




2. La Procedure personalizada se utilizará en lugar de la función WLanguage siempre que se utilice el nombre de la función/Procedure en el proyecto (o en la ventana si la Procedure creada es una Procedure local).




**Observaciones**: 

- La sobrecarga de las funciones WLanguage se ignora durante la compilación dinámica. Por ejemplo, si se ha sobrecargado [rastro](../WDLang1/3013050.md), se llamará a la función WLanguage (no a la función sobrecargada) en un código que se compila dinámicamente.

- Las funciones overload ed WLanguage no se tienen en cuenta en los procesos de una ventana interna, si el overload está en la ventana que contiene el control Ventana interna. 

- Si la función WLanguage tiene varias sintaxis (por ejemplo, [ToastDisplay](../WDLang1/1000019358.md)), la función sobrecargada se ejecutará independientemente de la sintaxis llamada. Si la función de WLanguage tiene múltiples sintaxis con parámetros de diferentes tipos, la nueva Procedure deberá tener [sintaxis múltiple](../Motscles/1514063.md) si se quiere que coincida con todas las posibilidades de llamada.

- Tienes la capacidad de las funciones de overload que las ventanas, páginas o informes de manipular. Basta con utilizar la siguiente notación para definir el parámetro correspondiente al elemento deseado en la Procedure que sobrecarga la función: 

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) Para las ventanas, el parámetro debe definirse mediante la siguiente notación "WindowName es la cadena ". Por ejemplo, para overload [entablar](../WDLang1/3038035.md), el código Procedure será: 
			
		```wl
		PROCEDURE Open(WindowName is string <window name>, *)
		```


	- Para los informes, el parámetro debe definirse mediante la siguiente notación "NombreInforme es la cadena ". Por ejemplo, para overload [iPrintReport](../WDLang5/3046032.md), el código Procedure será: 
			
		```wl
		PROCEDURE iPrintReport(ReportName is string <report name>, *)
		```





Para obtener más información, consulte [Parámetros de un procedimiento](../Motscles/1513001.md). 


<a name="NOTE2_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Diferenciación entre la función WLanguage y la función personalizada
<a name="diferenciacion_entre_funcion_wlanguage_funcion_personalizada_ELTPARAGRAPHE000138"></a>Si se sobrecargó una función WLanguage y desea utilizar la función inicial, el nombre de la función debe tener el prefijo **WL**. Se debe utilizar la siguiente sintaxis:


```txt
WL.<Function name>
```
Por ejemplo, para sobrescribir la función WLanguage ***Trace***, se puede utilizar el siguiente código:


```wl
PROCEDURE Trace(Information1)
Message("Start a trace")
WL.Trace(Information1)
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Uso de las funciones WLanguage en las consultas SQL para HFSQL
<a name="uso_las_funciones_wlanguage_las_consultas_sql_para_hfsql_ELTTEXTE000364"></a>


### Presentación
<a name="presentacion_ELTPARAGRAPHE000152"></a>

Una función WLanguage puede ser usada en una consulta SQL. Esta consulta SQL se puede ejecutar en archivos HFSQL. Por ejemplo, puede utilizar las funciones WLanguage para crear condiciones de selección avanzadas..  

Puedes utilizar las funciones de WLanguage: 

- directamente en el código SQL de una consulta,

- en el editor de consultas (por ejemplo, al crear un elemento de cálculo que utiliza una fórmula matemática),

- con consultas definidas por el tipo [consulta SQL](../Motscles/1514082.md). 





<a name="NOTE3_2"></a>


### ¿Cómo proceder?
<a name="¿como_proceder_ELTPARAGRAPHE000180"></a>

Para utilizar las funciones de WLanguage en las consultas para HFSQL: 

1. Cree una consulta en el editor de consultas.

2. Para utilizar las funciones WLanguage en la consulta, utilice la siguiente anotación: WL.
	Las funciones WLanguage pueden utilizarse, por ejemplo:

	- En el código SQL de la consulta. Ejemplo: 
			
		```sql
		-- Selecting the tasks exceeding 5 days
		SELECT Task.Caption FROM Task WHERE 
		WL.DateDifference(Task.StartDate, Task.EndDate) > 5
		```


	- En una fórmula matemática manejada por un ítem calculado.




3. La consulta puede ser:

	- directamente en el editor de consultas,

	- ejecutado por [HExecuteSQLQuery](../WDLang4/3044084.md) (para una consulta SQL) o por [HExecuteQuery](../WDLang4/3044080.md).





<a name="NOTE3_3"></a>


### Observaciones
<a name="observaciones_ELTPARAGRAPHE000208"></a>

- En las consultas sólo se pueden utilizar las funciones WLanguage. Las propiedades no se pueden utilizar.

- Varias funciones de WLanguage pueden ser anidadas en una consulta.

- Si las funciones WLanguage se utilizan en SELECT, el valor devuelto es una nota de texto.

- Esta sintaxis sólo se puede utilizar con HFSQL Classic, Móvil y Cliente/Servidor.

- Los límites de la función WLanguage son idénticos si la función se utiliza en una consulta.

- Las siguientes funciones están disponibles en las consultas:

	- [funciones para manipular cadenas de caracteres](../WDLang1/3024015.md) (Derecha, Izquierda, StringToDate, etc.).

	- [funciones para la gestión de fechas](../WDLang1/3027029.md) (DateSys, DateToInteger, etc.).

	- funciones para la gestión de enteros (IsOdd, IsEven, Exp, etc.).

	- [funciones para la gestión de archivos de texto](../WDLang1/3036034.md).

	- funciones para gestionar los archivos INI.

	- [funciones para la gestión del registro](../WDLang1/3065004.md).




- Para utilizar [entablar](../WDLang1/3038035.md), [OpenChild](../WDLang1/3038021.md) y [OpenPopup](../WDLang1/3038046.md) en las consultas, el nombre de las ventanas debe pasarse en formato de cadena de caracteres (entre comillas).

- Para utilizar una constante WLanguage en las consultas que contienen funciones WLanguage, utilice la siguiente notación: 
	
	```txt
	WL.<Constant name>
	```

	Por ejemplo, el código SQL de la consulta: 
	
	```sql
	SELECT
		WL.ExtractString('A|B|C',1,'|'),
		WL.ExtractString('A|B|C',1,'|', WL.FromEnd) 
		FROM 
			DUAL
	```








