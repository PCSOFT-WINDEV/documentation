
## Automation object

*** ***
				



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
El **Automatización** la palabra clave se utiliza para declarar un objeto de automatización. Este objeto se asigna durante la declaración. Los objetos de automatización se utilizan para el software manipular como Office 2007 (Word, Excel, ....).

Observación: También puede utilizar un [objeto de automatización dinámica](../Motscles/1514015.md). Se asigna a petición, durante la ejecución del programa.


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Declare an automation object
MyAutomationObject is automation object MyServer
```


<a name="Example2"></a>



```wl
// Call to a method of an automation object
MyAutomationObject>>FileOpen(DocName)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Declarar un objeto de automatización

`<Automation object name> is automation object <Name of automation server>
`
---

**`<Automation object name>: (Cadena de caracteres)`**

Nombre del objeto de automatización a declarar.

**`<Name of automation server>: (Cadena de caracteres)`**

Nombre del servidor para el objeto de automatización.  


<a name="SYNTAX2"></a>

### Llamar a un método de un objeto de automatización

`<Name of automation object>>><Method name>([<Parameters>])
`
---

**`<Automation object name>: (Cadena de caracteres)`**

Nombre del objeto de automatización a utilizar. Este objeto fue declarado de antemano.

**`<Method name>: (Cadena de caracteres)`**

Nombre del método del objeto de automatización a ejecutar. Este método es dado por el servidor.

Observación: La lista de métodos disponibles depende del servidor. Consulte la documentación sobre el servidor para obtener más detalles.

**`<Parameters>: (Cualquier tipo (opcional))`**

Parámetros pasados al método. Para utilizar el valor predeterminado de un parámetro opcional, puede utilizar "\*" o la constante *OLEIgnore*. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones




### Vida útil de un objeto de automatización
<a name="vida_util_objeto_automatizacion_ELTPARAGRAPHE000059"></a>

El objeto de automatización se crea durante su declaración.

El objeto de automatización se destruye automáticamente al final de la Process que contiene su declaración.

Un objeto de automatización declarado "global" en el código:

- **que inicializa una ventana (o página)** será destruida al final de la Process que cierra la ventana (o la página).

- **de inicialización del proyecto** será destruida al final del cierre de Process de la primera ventana/página del proyecto.



<a name="NOTE0_2"></a>




### Asignación de un objeto de automatización
<a name="asignacion_objeto_automatizacion_ELTPARAGRAPHE000074"></a>

- Al asignar un objeto de automatización, el servidor de automatización se inicia automáticamente.

- Para asignar un objeto de automatización con una instancia existente de un servidor de automatización, utilice [GetActiveObject](../WDLang3/3057006.md).



<a name="NOTE0_3"></a>




### Pasar parámetros a un método
<a name="pasar_parametros_metodo_ELTPARAGRAPHE000086"></a>

- Los métodos de los servidores de automatización pueden aceptar uno o más parámetros.

- Cuando se llama a un método, se debe respetar la secuencia de parámetros (ver la documentación sobre el servidor para más detalles).

- En algunos servidores de automatización, algunos parámetros de método no se valoran: sólo es importante la presencia del parámetro. El valor tomado por este parámetro no tiene importancia.
	Por ejemplo, el método "EditReplace" de Word Basic acepta 10 parámetros, el último (ReplaceAll) no siendo valorado.
	En WLanguage, cualquier valor ordinario puede ser pasado a parámetros no valorados.

- Los métodos de algunos servidores de automatización pueden aceptar parámetros opcionales ubicados en cualquier lugar de la lista de parámetros.




En WLanguage, los parámetros opcionales deben encontrarse necesariamente después de los parámetros obligatorios.

Para dar cualquier valor ordinario a un parámetro opcional, asigne el \*carácter al parámetro opcional. Por el contrario, este carácter no será necesario para los parámetros opcionales que se encuentren después del último parámetro obligatorio.




<a name="NOTE0_4"></a>
![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png) 

### Utilización de un objeto de automatización OLE de un servicio
<a name="utilizacion_objeto_automatizacion_ole_servicio_ELTPARAGRAPHE000107"></a>

Algunos de los objetos de automatización OLE no pueden ser utilizados por Default desde un [servicio](../WDLang1/1000017114.md). 

Por ejemplo, la asignación de un objeto de OpenOffice desde una ejecución de servicio con la cuenta del sistema local puede provocar un error como "El objeto de automatización com.sun.star.ServiceManager no está instalado en su sistema".. 


```wl
m_oApplication = new Automation object "com.sun.star.ServiceManager"
```


En este caso, la configuración de Windows debe adaptarse para permitir que se utilice el objeto OLE Automation desde un servicio.. Se deben realizar las siguientes operaciones: 

- Muestra el panel de control de Windows,

- Seleccione "Herramientas de gestión",

- Seleccione "Servicio de componentes",

- Desglose la siguiente estructura de árbol: Configuración de ordenadores/estación de trabajo/COM

- Seleccione el "gestor de servicios de OpenOffice" y muestre sus propiedades ("Propiedades" en el menú contextual)

- En la pestaña "Identidad", seleccione una identidad relevante (la cuenta de usuario que ejecutará la aplicación).









<a name="NOTE0_5"></a>


