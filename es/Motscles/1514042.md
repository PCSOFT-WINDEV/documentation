


## El tipo "Buffer" (Tipo de variable)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000378"></a>
El tipo Buffer corresponde a un área de memoria binaria.

**Con este tipo, un código que manipula formato binario puede ser compartido entre una aplicación WINDE estándar y una aplicación WINDEV Mobile.**

***En WINDEV***, una cadena Variable puede contener tanto caracteres como datos binarios (un Image por ejemplo).

***En WINDEV Mobile***, si una variable de tipo Character string contiene datos binarios, estos datos pueden estar dañados (conversión incorrecta, por ejemplo). Para los datos binarios de manipular, se recomienda utilizar variables Buffer.

El tipo de búfer no tiene un final específico Marker y permite almacenar ceros binarios.

Existen dos tipos de variables:

- **Buffer**: Este tipo permite manipular un área de memoria con tamaño dinámico: este se adapta automáticamente al contenido del buffer.

- **Buffer on**: Este tipo permite manipular un área de memoria cuyo tamaño (en bytes) se define durante la compilación. Este es un tipo avanzado que permite realizar operaciones específicas en la memoria y utilizar algunas API de Windows.




Observación: Las variables de tipo Buffer están codificadas en base64 en JSON y XML.





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## ¿Por qué utilizar el tipo Buffer?
<a name="¿por_que_utilizar_tipo_buffer_ELTTEXTE000402"></a>
En WINDEV, se puede utilizar el siguiente código para manipular bytes como valores binarios:

```wl
S is string = Charact(1) + Charact(0)
```


El área de memoria correspondiente es: 



|   |   |
| --- | --- |
| 0 | 1 |


El mismo código tiene un comportamiento diferente si se ejecuta en Ansi o Unicode.

Para tener el mismo código en ANSI y en UNICODE, la cadena debe ser reemplazada por un buffer. El código ahora es:


```wl
S is Buffer
S[[1]] = 1
S[[2]] = 0
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Tipo Buffer: Sintaxis y uso
<a name="tipo_buffer_sintaxis_uso_ELTTEXTE000426"></a>


### Declarar una variable de tipo Buffer
<a name="declarar_una_variable_tipo_buffer_ELTPARAGRAPHE000122"></a>

- &lt;Nombre de variable&gt; **is** Buffer


**O**

- &lt;Nombre de variable 1&gt;, &lt;Nombre de variable 2&gt; **are** Buffers




**Detalles de la sintaxis**


|   |   |
| --- | --- |
| **&lt;Nombre de variable&gt;:** | Nombre de la variable a declarar. |


Observación: De forma predeterminada, una variable de tipo Buffer está vacía.

Ejemplo:

```wl
MyBuffer is Buffer
```



### Declarar e inicializar una variable de tipo Buffer
<a name="declarar_inicializar_una_variable_tipo_buffer_ELTPARAGRAPHE000163"></a>

Para declarar e inicializar una variable de tipo Buffer, utilice la siguiente sintaxis: 

```txt
<Variable name> is Buffer = [<Hexa value 1>, <Hexa value 2>, ..., <Hexa value N>]
```


**Detalles de la sintaxis**


|   |   |
| --- | --- |
| **&lt;Nombre de variable&gt;:** | Nombre de la variable a declarar. |
| **Valor hexa** | Valor hexadecimal. |


Ejemplo: 


```wl
b is Buffer = [0x01, 0x02, 0x03]
```

<a name="NOTE3_2"></a>


### Uso de variables de tipo Buffer
<a name="uso_variables_tipo_buffer_ELTPARAGRAPHE000188"></a>

Las variables de tipo Buffer pueden utilizarse de la misma manera que las variables de tipo String. 

**Para asignar una variable de tipo Buffer**, utilice una de las siguientes sintaxis:

- asignar una cadena a una variable Buffer: 
	***&lt;Nombre de variable Buffer&gt; = &lt;Mi Cadena&gt;***. 
	Por ejemplo:
	
	```wl
	MyBuffer is Buffer
	MyBuffer = "WINDEV is great"
	// In ANSI, MyBuffer contains: WINDEV is great
	// In UNICODE, MyBuffer contains: 
	// W0i0n0D0e0v0 0i0s0 0gr0e0a0t0
	```


- asignar un byte a una variable Buffer: 
	***&lt;Nombre del buffer Variable&gt; [[&lt;Índice de bytes&gt;]] = &lt;Código ASCII de bytes&gt;***. 
	Por ejemplo: 
	
	```wl
	MyBuffer is Buffer
	MyBuffer[[1]] = 65 // MyBuffer contains "A"
	```





**Uso de funciones**: 

- Las funciones [Izquierda](../WDLang1/3024001.md), [Derecho](../WDLang1/3024016.md) y [Middle](../WDLang1/3024023.md) se pueden utilizar en variables de tipo Buffer. Para más detalles, consulte la ayuda sobre estas funciones. 
	

- La función [Longitud](../WDLang1/3024031.md) permite conocer el tamaño real de los datos de la variable de tipo Buffer (en bytes).




**Uso de operadores**: 
El operador [[ ]] permite acceder a:

- un byte de la variable de tipo Buffer. Por ejemplo: 
	
	```wl
	MyBuffer is Buffer
	MyBuffer = "WINDEV is great"
	MyBuffer[[1]] = "W"
	```


- una parte de la variable de tipo Buffer. Por ejemplo: 
	
	```wl
	MyBuffer is Buffer
	MyBuffer = "WINDEV is great"
	Info(MyBuffer[[8 to 15]])
	```





**Buffer comparison**:

Puede comparar un búfer o una parte de un búfer con valores específicos. 

Por ejemplo, puede escribir: 

```txt
IF MyBuffer = [1,2,3] THEN ...

IF MyBuffer[1 ON 2] = [1,2] THEN ...
```


<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Tipo 'Buffer on': Sintaxis y uso avanzado
<a name="tipo_buffer_sintaxis_uso_avanzado_ELTTEXTE000462"></a>


### Declarar una variable de tipo Buffer On
<a name="declarar_una_variable_tipo_buffer_ELTPARAGRAPHE000276"></a>


```txt
<Variable name> is Buffer on <Buffer size>
```
**O**


```txt
<Variable name 1>, <Variable name 2> are Buffers on <Size of buffers>
```


**Detalles de la sintaxis**


|   |   |
| --- | --- |
| **&lt;Nombre de variable&gt;:** | Nombre de la variable a declarar. |
| **&lt;Tamaño del buffer&gt;:** | Tamaño del buffer en bytes. |


Observaciones:

- Las palabras clave <u><u><u><u>a</u></u></u></u> y <u><u><u><u>an</u></u></u></u> son opcionales: proporcionan una mejor legibilidad.

- Por defecto, el carácter '0' se asigna a un 'Buffer on' Variable.




Ejemplos: 


```wl
MyBuffer is buffer on 4
MyBuffer = "ABCDE" // MyBuffer contains "ABCD"
MyBuffer = "ZZ"    // MyBuffer contains "ZZCD"
```

<a name="NOTE4_2"></a>


### Uso de variables de tipo 'Buffer on' (llamadas Buffers fijos)
<a name="uso_variables_tipo_buffer_llamadas_buffers_fijos_ELTPARAGRAPHE000318"></a>

Los buffers fijos se utilizan de la misma forma que los buffers simples. Sin embargo, deben tenerse en cuenta algunas diferencias.

En tiempo de ejecución, se desconoce el tamaño real de los datos que se encuentran en la variable de tipo Buffer:

- Los datos escritos se truncan si superan el tamaño de la variable de tipo Buffer.

- Al escribir datos más pequeños que el tamaño de la variable de tipo Buffer, la sección no escrita de la variable Buffer conserva su valor anterior.




Para manipular variables de tipo Buffer, se recomienda almacenar el tamaño real del buffer en una variable de tipo Integer.

Recordatorio: el tipo Buffer gestiona automáticamente su tamaño. Cuando se utiliza un buffer fijo, se recomienda copiar rápidamente su valor en un buffer automático.


```txt
// Use an API that returns the size of a buffer
bFixedBuffer is Buffer on 200
nSize is int
// Call the API
nSize = API(<API name>, <Parameters>, bFixedBuffer, 200)
// Copy the buffer
bBuffer is Buffer
bBuffer = Left(bFixedBuffer, nSize)
```



