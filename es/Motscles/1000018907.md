
## Procedure (Tipo de Variable)

*** ***
				



<a name="description"></a>
El tipo **Procedure** se utiliza para manipular:  

- los procedimientos o métodos encontrados en el proyecto. 

- los procedimientos o métodos en una Component interna .

- los procedimientos o métodos en un Component externo. 




Este tipo de Variable es muy useful, especialmente: 

- para optimizar el tiempo de inicio de los procedimientos. La utilización de este tipo de Variable permite sustituir los procedimientos ejecutados por [ExecuteProcess](../WDLang1/3013031.md). 

- para implementar algoritmos avanzados (eventos personalizados, notificaciones, ....). 








Esta página de ayuda presenta: 

- [La simple asignación de un Procedure Variable](#NOTE0_1). 

- [Asignación múltiple de un Procedure Variable](#NOTE0_2). 

- [Orden de ejecución de los procedimientos](#NOTE0_5).

- [Pasando los parámetros de Procedure por reference o por valor](#NOTE0_3).

- [Llamada a las Procedure s encontradas en un Procedure Variable](#NOTE0_4).  



<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
p is Procedure
// Assign the Procedure variable with the "MyProcedure" procedure found in the project
p = MyProcedure
// Run the procedure
p(5)
// Equivalent to MyProcedure(5)
```

<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Asignar un Procedure Variable
<a name="asignar_procedure_variable_ELTPARAGRAPHE000077"></a>

Una variable de tipo **Procedure** puede ser asignada con: 

- **a Procedure conocido en el proyecto**. 
	Se debe utilizar la siguiente sintaxis: 
	
	```txt
	<Name of Procedure variable> = <Procedure>
	```

	Por ejemplo: 
	
	```wl
	p is Procedure
	p = CheckExistence
	```

	Observaciones: 

	- El parámetro &lt;Procedure&gt; debe corresponder a un Procedure encontrado en el proyecto. 

	- El parámetro &lt;Procedure&gt; no debe estar entre comillas. 

	- El parámetro &lt;Procedure&gt; no debe ir seguido de parámetros de llamada. 

	- El parámetro &lt;Procedure&gt; no debe corresponder al nombre de un Procedure interno. 




- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) **un procedimiento compilado dinámicamente con la función [Compilar](../WDLang1/3013015.md)**. 
	Se debe utilizar la siguiente sintaxis: 
	
	```txt
	<Name of Procedure variable> = Compile(<Procedure code>)
	
	or 
	
	<Name of Procedure variable> = 
				Compile(<Procedure Name>, <Procedure Code>)
	```

	Por ejemplo: 
	
	```wl
	p is Procedure
	p = Compile("RESULT n1 + n2")
	```

	Observaciones: 

	- Si se especifica el nombre del Procedure, el Procedure también puede ser ejecutado por [Ejecute](../WDLang1/3013041.md) y [ExecuteProcess](../WDLang1/3013031.md). 

	- Por defecto, el Procedure compilado dinámicamente es un Procedure global. Para definir una Procedure local, debe utilizar la sintaxis que define el nombre de la Procedure para especificar el elemento solicitado en el nombre de la Procedure. 




- **un método de clase**. 
	Se debe utilizar la siguiente sintaxis: 
	
	```txt
	<Name of Procedure variable> = <Method>
	```

	Observaciones: 

	- El parámetro &lt;Método&gt; puede corresponder a un método de la clase actual o de una clase base. 

	- Si &lt;Método&gt; es un método de instancia, se debe utilizar la siguiente notación:
			
		```txt
		<An_Object>.<Method>
		```










**Otras sintaxis posibles**

- También es posible volver a copiar los procedimientos de una variable de tipo **Procedure** en otra variable de tipo **Procedure**. La sintaxis es la siguiente: 
	
	```txt
	<Name of destination Procedure variable> = 
			<Name of Source Procedure Variable>
	```

	Observación: Es una copia de Variable: cualquier modificación hecha a una de las variables no se aplicará a la otra.. 

- También es posible buscar un procedimiento identificado por su nombre y asignarlo a una variable de tipo **Procedure** durante la ejecución. En este caso, se debe utilizar la siguiente sintaxis: 
	
	```txt
	<Name of Procedure variable> = <Procedure name (with quotes)>
	```

	Observación: Usar esta sintaxis para asignar una variable de tipo **Procedure** lleva bastante tiempo porque el nombre del procedimiento se busca en todos los procedimientos del proyecto.  

- **Asignación de reference (&lt;- operador)**
	La asignación tomando reference fuerza al elemento de destino a reference a la misma área de datos que el elemento fuente.
	Por lo tanto, una variable de tipo **Procedure** puede ser manipulada por otra variable de tipo **Procedure**. Para ello, se debe obtener una referencia en la misma variable **Procedure**. Cualquier modificación futura de una de las variables se aplicará a la otra..
	Se debe utilizar la siguiente sintaxis: 
	
	```txt
	<Name of destination Procedure variable> <- <Name of source Procedure variable>
	```




<a name="NOTE0_2"></a>


### Asignación múltiple de un Procedure Variable
<a name="asignacion_multiple_procedure_variable_ELTPARAGRAPHE000165"></a>

Se pueden asignar varios procedimientos o métodos a una variable de tipo **Procedure** mediante el operador "+=". Los diferentes procedimientos serán llamados uno tras otro. 

Por ejemplo: 


```wl
p is procedure
p += Proc1
p += Proc2
```


Observación: Para borrar un Procedure de un **Procedure** Variable, tienes la posibilidad de usar el operador "-=".. 

Por ejemplo: 


```wl
p is procedure
p += Proc1
p += Proc2

...

p -= Proc2
```

<a name="NOTE0_5"></a>


### Orden de ejecución de los procedimientos
<a name="orden_ejecucion_los_procedimientos_ELTPARAGRAPHE000186"></a>

Tiene la posibilidad de sustituir o insertar un Procedure antes o después de los otros Procedure en un elemento **Procedure** mediante [Before](../Proprietes/1000020916.md) y [Después](../Proprietes/1000020917.md). 

Ejemplo: 


```wl
p is Procedure
p = MyProcedure
p.After = MyProcedureCalledAfter
p.Before = MyProcedureCalledBefore

// The order for calling the procedures will be:
// - MyProcedureCalledBefore
// - MyProcedure
// - MyProcedureCalledAfter
p()
```





<a name="NOTE0_3"></a>


### Pasando los parámetros de Procedure por reference o por valor
<a name="pasando_los_parametros_procedure_por_reference_por_valor_ELTPARAGRAPHE000204"></a>

Para manipular un Procedure como parámetro de otro Procedure, debes usar un parámetro tecleado. Se debe utilizar la siguiente sintaxis: 

- para pasar los parámetros de reference: 
	
	```txt
	PROCEDURE <ProcedureName>(MyProcedure is Procedure)
	```


- pasar parámetros por valor: 
	
	```txt
	PROCEDURE <ProcedureName>(LOCAL MyProcedure is Procedure)
	```





Las posibles llamadas al &lt;Procedure Name&gt; Procedure son: 

- **llamar mientras se especifica un Procedure conocido por el proyecto**: se debe utilizar la siguiente sintaxis: 
	
	```txt
	ProcedureName(<Project procedure>)
	```

	Observaciones: 

	- El parámetro &lt;Proyecto Procedure&gt; debe corresponder a un Procedure encontrado en el proyecto. 

	- El parámetro &lt;Project Procedure&gt; no debe estar entre comillas. 

	- El parámetro &lt;Project Procedure&gt; no debe ir seguido de accesos directos. 




- **mientras se especifica un método de clase**: se debe utilizar la siguiente sintaxis: 
	
	```txt
	ProcedureName(<Method>)
	```

	Observaciones: 

	- El parámetro &lt;Método&gt; puede corresponder a un método de la clase actual o de una clase base.

	- Si &lt;Método&gt; es un método de instancia, debe utilizarse la siguiente notación: &lt;Objeto&gt;.&lt;Método&gt;.




- Llamada **con referencia a un Procedure Variable**: se debe utilizar la siguiente sintaxis: 
	
	```txt
	ProcedureName(<Name of Procedure variable>)
	```


- **llamada con búsqueda en tiempo de ejecución de un Procedure identificado por su nombre**: se debe utilizar la siguiente sintaxis: 
	
	```txt
	ProcedureName(<Procedure name (with quotes)>)
	```




<a name="NOTE0_4"></a>


### Llamada a las Procedure s encontradas en un Procedure Variable
<a name="llamada_las_procedure_encontradas_procedure_variable_ELTPARAGRAPHE000246"></a>

La llamada a las Procedure s que se encuentran en una variable de Procedure se realiza por la sintaxis estándar de las Procedure s. Esta sintaxis se usa directamente en el Procedure Variable con paréntesis que contienen 0, 1 o varios parámetros: 


```txt
<Name of Procedure variable> ([<Parameter 1> [, ...[, <Parameter N>]]])
```


Ejemplos: 


```wl
p1 is Procedure
p1 = Proc1
p1()

p2 is Procedure
p2 = Proc2
p2(1,2)
```


Si la variable Procedure contiene varios Procedure s, todos los Procedure s se ejecutan según el orden de las asignaciones. 


```wl
p3 is Procedure
p3 += Proc3_1
p3 += Proc3_2
p3("parameter")	// calls Proc3_1 and Proc3_2
```


**Gestión del valor de retorno**

- Si la variable Procedure contiene un solo Procedure, la llamada devuelve el valor de retorno del Procedure.

- Si la variable Procedure contiene varios Procedure s, la llamada devuelve el valor de retorno del último Procedure llamado.







