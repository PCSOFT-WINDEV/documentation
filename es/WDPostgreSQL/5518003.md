


## Conector Nativo PostgreSQL: Programación con funciones HFSQL
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000241"></a>
Para utilizar una base de datos PostgreSQL con Conector Nativo (también llamada Native Access), la estructura de las tablas PostgreSQL debe ser **importada en el análisis WINDEV o WEBDEV**. 

**Diferencias con respecto a la programación SQL**:
Las consultas no son necesarias para manipular los datos de PostgreSQL. De hecho, las funciones HFSQL se pueden utilizar directamente para leer datos, realizar búsquedas, implementar filtros, ....

Sin embargo, la estructura de los archivos PostgreSQL debe importarse al análisis WINDEV o WEBDEV.

**Observación**: Las consultas realizadas por [HExecuteQuery](../WDLang4/3044080.md) y [HExecuteSQLQuery](../WDLang4/3044084.md) se "corrigen" automáticamente para que sean compatibles con PostgreSQL.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Importación de la estructura de los ficheros
<a name="importacion_estructura_los_ficheros_ELTTEXTE000271"></a>


### Los pasos de importación
<a name="los_pasos_importacion_ELTPARAGRAPHE000034"></a>

Para realizar esta importación: 

1. Inicie la editor de análisis: haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Ico_Analyse.gif) en los botones de acceso rápido.

2. En la pestaña "Importar", en el grupo "Análisis", despliegue "Creación" y seleccione "Importar descripciones de archivos/tablas...".

3. El asistente se abre. Se establece automáticamente una conexión con la base de datos PostgreSQL y se importa associated con los archivos de datos en el análisis. Esta conexión tendrá que ser utilizada para manipular el archivo de datos PostgreSQL a través de la programación.
	En los diferentes pasos de la asistente, elija las siguientes opciones:

	- Tipo de base de datos: PostgreSQL. 

	- Características de la conexión: Servidor de datos, usuario y contraseña, base de datos.  

	- La aplicación accederá a los datos en el formato actual.

	- Una vez establecida la conexión, basta con seleccionar las tablas que se importarán en el análisis WINDEV o WEBDEV.. Estas tablas pueden manejarse mediante programación con las funciones HFSQL de WLanguage. Estas tablas se mostrarán en azul en el editor de análisis.






<a name="NOTE2_2"></a>


### Teniendo en cuenta la evolución de la base de datos PostgreSQL
<a name="teniendo_cuenta_evolucion_base_datos_postgresql_ELTPARAGRAPHE000066"></a>

Para tener en cuenta las evoluciones de las tablas importadas en el editor de análisis, vaya a la pestaña "Sincronización ", al grupo "Análisis", amplíe "Análisis" y seleccione "Actualizar análisis a partir de bases de datos externas".

Una asistente comienza, permitiéndole:

- analizar las diferencias para las tablas importadas,

- analizar las diferencias para todas las tablas de PostgreSQL.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Programación
<a name="programacion_ELTTEXTE000301"></a>


### 1. Establecimiento de la conexión
<a name="1_establecimiento_conexion_ELTPARAGRAPHE000092"></a>

Para establecer la conexión con la base de datos PostgreSQL, llame a [HOpenConnection](../WDLang4/3044107.md) y especifique el nombre de la conexión a abrir. El nombre de la conexión se definió al importar la estructura de los archivos al análisis.

**Atención**: Si está utilizando otra sintaxis, debe especificarse el nombre de la base de datos a utilizar.

Para modificar algunos parámetros de esta conexión (nombre de usuario o contraseña, por ejemplo), llame a [HConnect](../WDLang4/3044263.md).

**Observaciones**:

- Si intenta leer el archivo directamente (función **HReadFirst**, etc.), la conexión asociada a la descripción del archivo en el análisis se abrirá automáticamente.

- Se puede definir el parámetro "***Server Port***" para la conexión al servidor PostgreSQL. Basta con añadir la cadena correspondiente a la información ampliada de la conexión ([HDescribeConnection](../WDLang4/3044205.md) o [HOpenConnection](../WDLang4/3044107.md)).

	- Ejemplo 1: "Server Port=3306;" para conectar en el puerto 3306 del servidor PostgreSQL.

	- Ejemplo 2: "Puerto del servidor=3306; Flag del cliente=0".

	- ...
			Para más detalles, consulte la documentación sobre PostgreSQL.




- El **modo de gestión de los elementos Unicode** puede configurarse durante la conexión. 
	Para utilizar cadenas Unicode, el juego de caracteres "UTF8" debe especificarse al crear la base de datos PostgreSQL.. Atención: en este caso, todas las cadenas serán cadenas Unicode.
	Para gestionar los elementos Unicode, hay que añadir la opción "WD Unicode Support" en la información ampliada de la conexión ([HDescribeConnection](../WDLang4/3044205.md) o [HOpenConnection](../WDLang4/3044107.md)).
	***Si "WD Unicode Support = 0"***la gestión del formato Unicode está desactivada para la conexión. Todos los valores serán convertidos (si es necesario) por el servidor en el carácter por defecto set. En este caso, se mejora el rendimiento pero no se admiten los elementos Unicode.. 
	***Si "WD Unicode Support = 1 "*** (valor Default), la gestión del formato Unicode está habilitada para la conexión. Todos los intercambios con el servidor se realizarán en Unicode. El Conector Nativo gestiona las conversiones necesarias utilizando el carácter set definido por el [ChangeCharset](../WDLang1/3054001.md).
	**Atención**: [ChangeCharset](../WDLang1/3054001.md) debe utilizarse ANTES de abrir la conexión. La conexión debe cerrarse y volver a abrirse después de cada llamada a [ChangeCharset](../WDLang1/3054001.md) para que los datos se conviertan correctamente en el carácter especificado set.



<a name="NOTE3_2"></a>


### 2. Ejecutar las consultas
<a name="2_ejecutar_las_consultas_ELTPARAGRAPHE000152"></a>

[HExecuteQuery](../WDLang4/3044080.md) y [HExecuteSQLQuery](../WDLang4/3044084.md) se utilizan para ejecutar consultas en la base de datos actual.

- **HExecuteQuery**: se usa para ejecutar una consulta preestablecida con el editor de consultas.

- **HExecuteSQLQuery**: se utiliza para ejecutar una consulta especificando el código SQL de la consulta y el nombre que se asignará a este código SQL.



```wl
// Initialize the "CUSTOMER_84" query
HExecuteQuery(CUSTOMER_84, "PostgreSQLDatabase", hQueryWithoutCorrection)
HExecuteSQLQuery(QryCustomer, "PostgreSQLDatabase", hQueryWithoutCorrection, ...
	"SELECT NAME FROM CUSTOMER")
```

<a name="NOTE3_3"></a>


### 3. Recuperación del resultado
<a name="3_recuperacion_del_resultado_ELTPARAGRAPHE000169"></a>

El resultado es navegado por las funciones de lectura estándar: [HReadFirst](../WDLang4/3044051.md), [HReadNext](../WDLang4/3044037.md), [HReadSeek](../WDLang4/3044050.md)...

En esta versión, los registros no pueden bloquearse mediante las opciones de bloqueo de estas funciones. Sólo se admiten los cierres set con [SQLLock](../WDLang4/3072003.md).
<a name="NOTE3_4"></a>


### 4. Cierre de la conexión
<a name="4_cierre_conexion_ELTPARAGRAPHE000190"></a>

[HCloseConnection](../WDLang4/3044095.md) se utiliza para cerrar la conexión con la base de datos una vez que se han ejecutado todas las consultas necesarias.


