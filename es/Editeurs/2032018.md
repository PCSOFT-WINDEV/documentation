


## Se une entre los archivos de datos de una consulta selecta
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000201"></a>
Cuando se utilizan varios archivos de datos en una consulta, el editor de consultas busca automáticamente los vínculos entre estos archivos descritos en el análisis.. Estos enlaces se denominan uniones en el editor de consultas.

Por ejemplo, la siguiente consulta selecciona los números de los pedidos realizados por los clientes que viven en París. A los ficheros de PEDIDOS y de datos del CLIENTE se une el elemento CustomerNum. El editor de consultas define automáticamente las uniones entre estos dos archivos de datos.<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Requete_exemplePlusieursFic.gif)
**Observación**: Los enlaces entre los ficheros de datos aparecen en la representación gráfica de la consulta sólo si los dos ficheros de datos de relacionado son utilizados por la consulta.

En Default, las uniones son creadas automáticamente por el editor de consultas. Sin embargo, estas uniones pueden no corresponder al resultado deseado.. Por lo tanto, tiene la posibilidad de añadir o eliminar uniones. Estas operaciones se describen en los párrafos siguientes.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## ¿Cómo proceder?
<a name="¿como_proceder_ELTTEXTE000225"></a>


### Adición de un enlace a la consulta de selección actual
<a name="adicion_enlace_consulta_seleccion_actual_ELTPARAGRAPHE000024"></a>

Para añadir un join a la consulta select actual:

1. Haga clic con el botón derecho en la unión y seleccione "Editar unión" en el menú contextual. Aparece la ventana de description de las uniones de consulta.

2. Haga clic en el botón "Añadir un enlace. Aparece una ventana para definir una nueva unión.

3. Especifica las características de la unión que se va a añadir.

4. Validar. La unión se añade automáticamente a la consulta.




Esto le da la capacidad de crear múltiples uniones entre dos archivos de datos.
<a name="NOTE2_2"></a>


### Eliminar un ensamblaje de la consulta de selección actual
<a name="eliminar_ensamblaje_consulta_seleccion_actual_ELTPARAGRAPHE000038"></a>

Para eliminar un registro de la consulta seleccionada actual:

1. Haga clic con el botón derecho en la unión y seleccione "Editar unión" en el menú contextual. Aparece la ventana de description de las uniones de consulta.

2. Seleccione la unión que desea eliminar.

3. Haga clic en el botón "Eliminar la unión".. El registro se borra automáticamente. Las uniones entre archivos de datos se optimizan automáticamente para que la consulta funcione correctamente.



<a name="NOTE2_3"></a>


### Noción de unión externa en la consulta de selección actual
<a name="nocion_union_externa_consulta_seleccion_actual_ELTPARAGRAPHE000049"></a>

Cuando se calcula un join entre dos ficheros de datos (fichero "Padre" y ruta"Hijo"), Default sólo conserva los registros con correspondencia en los dos ficheros de datos. Sin embargo, la noción de "unión externa" permite definir una regla para incluir: 

- los registros del expediente "Padre" sin correspondencia en el expediente "Hijo".

- los registros del expediente "Niño" sin correspondencia en el expediente "Padre".




Para definir una unión externa en la consulta de selección actual:

1. Haga clic con el botón derecho en la unión y seleccione "Editar unión" en el menú contextual. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Jointure_Requ%EAte%20-%20HC%20N%B0001.gif)


2. Aparece la ventana de description de las uniones de consulta.

3. Seleccione la unión que desea modificar.

4. Hay dos opciones disponibles en esta unión, lo que le permite definir una unión externa ("Incluir también"). 

5. Seleccione la(s) opción(es) correspondiente(s) al resultado deseado.<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Jointure_Requ%EAte%20-%20HC%20N%B0002.gif&type=thumb)


6. Validar. 



<a name="NOTE2_4"></a>


### Edición de las condiciones de una unión en la consulta de selección actual
<a name="edicion_las_condiciones_una_union_consulta_seleccion_actual_ELTPARAGRAPHE000071"></a>

Para editar las condiciones de una unión en la consulta de selección actual:

1. Haga clic con el botón derecho en la unión y seleccione "Editar unión" en el menú contextual. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Jointure_Requ%EAte%20-%20HC%20N%B0001.gif)


2. Aparece la ventana de description de los query joins. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Jointure_Requ%EAte%20-%20HC%20N%B0002.gif&type=thumb)


3. Seleccione la unión que desea editar.

4. Haga clic en el botón "Editar condiciones de unión".. Aparece la ventana de edición de condiciones.<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Jointure_Requ%EAte%20-%20HC%20N%B0003.gif)


5. Es posible: 

	- Agregar una nueva condición. ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Jointure_Requ%EAte%20-%20HC%20N%B0003%201.gif)

	- Modificar una condición. ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Jointure_Requ%EAte%20-%20HC%20N%B0003%202.gif)

	- Eliminar una condición. ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Jointure_Requ%EAte%20-%20HC%20N%B0003%203.gif)

	- Defina la secuencia lógica de condiciones mediante operadores (**Y**, **O**) y soportes **(** y **)**. Debe utilizar el número que representa la condición en la fórmula. Por ejemplo, con 2 condiciones, la fórmula puede ser: "1 Ó 2". 








### Añadir una condición
<a name="anadir_una_condicion_ELTPARAGRAPHE000093"></a>

Para añadir una condición: 

1. Haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Jointure_Requ%EAte%20-%20HC%20N%B0003%201.gif). Aparece la ventana para crear una condición.<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Jointure_Requ%EAte%20-%20HC%20N%B0004.gif)


2. Seleccione la posición para la que se creará la condición (1). Sólo se proponen los puntos "clave".

3. Seleccione la operación a realizar en la lista (2). 

4. Seleccionar el tipo de elemento a comparar para la operación a realizar (3): 

	- el valor: esta opción se selecciona para un valor estático en la consulta.

	- el parámetro: esta opción se selecciona cuando se pasan parámetros durante la ejecución de la consulta.

	- el campo: esta opción se selecciona cuando se realiza una comparison con un elemento encontrado en otro archivo de consulta. Sólo se proponen los puntos "clave".




5. Validar. La condición se añade a la condición anterior. 

6. No olvide verificar la secuencia lógica de las condiciones creadas. 




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Limitaciones y notas
<a name="limitaciones_notas_ELTTEXTE000273"></a>


### Uniones específicas
<a name="uniones_especificas_ELTPARAGRAPHE000116"></a>

Las uniones como (A Unir B en x=y) Unir C en y=z no están soportadas.

Para ejecutar consultas con este tipo de uniones, debe utilizar [HExecuteQuery](../WDLang4/3044080.md) o [HExecuteSQLQuery](../WDLang4/3044084.md) con la constante *hQueryWithoutCorrection*.
<a name="NOTE3_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png)![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) 

### Sintaxis de SQL Server para uniones
<a name="sintaxis_sql_server_para_uniones_ELTPARAGRAPHE000133"></a>

Se admite la sintaxis SQL para joins (al editar una consulta SQL y al ejecutarla). Para realizar estas consultas, puede utilizar [HExecuteQuery](../WDLang4/3044080.md) o [HExecuteSQLQuery](../WDLang4/3044084.md).
<a name="NOTE3_3"></a>


### Parámetros avanzados
<a name="parametros_avanzados_ELTPARAGRAPHE000146"></a>

En Default, las uniones utilizan la sintaxis ISO (INNER JOIN / LEFT OUTER JOIN / RIGHT OUTER JOIN / FULL JOIN). También tiene la posibilidad de utilizar la sintaxis de las uniones de Oracle.. Sin embargo, esta sintaxis compatible con Oracle 7 no es recomendable.. 

Para usar la sintaxis de Oracle: 

1. Abrir la ventana de consulta description. 

2. Haga clic en el botón "Avanzado. 

3. En la pestaña "Uniones" seleccione el tipo de sintaxis deseado. 





