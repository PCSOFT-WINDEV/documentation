
## Utilizar código Kotlin
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000192"></a>
Kotlin es un lenguaje de programación utilizado principalmente por desarrolladores de Android.
A partir de la versión 28, puede escribir código Kotlin directamente en el editor de código.
El resaltado de sintaxis facilita la escritura y lectura del código en este lenguaje.

Esto permite crear procedimientos globales completamente en Kotlin.

Estos procedimientos Kotlin pueden llamar directamente a procedimientos WLanguage en el proyecto.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## ¿Cómo crear un procedimiento en Kotlin?
<a name="¿como_crear_procedimiento_kotlin_ELTTEXTE000216"></a>


### Escribir un procedimiento global en Kotlin
<a name="escribir_procedimiento_global_kotlin_ELTPARAGRAPHE000024"></a>

Para escribir un procedimiento global en Kotlin: 

1. Cree un nuevo procedimiento global (a través de la opción "Nuevo procedimiento global" del menú contextual de los conjuntos de procedimientos en el panel "Explorador de proyectos"). Especifique el nombre del procedimiento.

2. El procedimiento se crea en el editor de código. 

3. En el encabezado del procedimiento, haga clic en el ícono "WL" para cambiar el tipo de código. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=saisir_code_kotlin%20-%20HC%20N%B0001.gif)


4. En la lista que se abre, seleccione "Kotlin". 

5. El encabezado se muestra en color morado y "Kotlin" aparece a la izquierda del nombre del procedimiento. El código existente está en forma de comentario. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=saisir_code_kotlin%20-%20HC%20N%B0002.gif)


6. Escriba el código Kotlin directamente en el editor de código de WINDEV Mobile.<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=saisir_code_kotlin%20-%20HC%20N%B0003.gif&type=thumb)





**Observación**: Para volver al código WLanguage, haga clic en "Kotlin" en el encabezado del procedimiento y seleccione "WLanguage".
<a name="NOTE2_2"></a>


### Notas importantes
<a name="notas_importantes_ELTPARAGRAPHE000043"></a>

- En los procedimientos Kotlin, los parámetros se pasan automáticamente por valor.

- Los parámetros de los procedimientos escritos en Kotlin deben ser tipos de datos primitivos (integer, real, string, etc.). 
	Atención: No se admite el tipo float, puede reemplazarse por el tipo double.

- Los valores de retorno de los métodos deben ser de un tipo primitivo (integer, real, string, etc.). 
	Atención: No se admite el tipo float, puede reemplazarse por el tipo double.

- Atención: es necesario importar las clases utilizadas en el código Kotlin nativo con la palabra clave "Import". Se recomienda importar estos elementos antes de declarar el método. 

- Kotlin distingue entre mayúsculas y minúsculas: asegúrese de utilizar siempre los mismos caracteres en minúsculas y mayúsculas en los nombres de las funciones.

- Si el código Kotlin introducido requiere permisos específicos, deben definirse explícitamente al generar la aplicación. Para obtener más información, consulte [Generar una aplicación Android](../Editeurs/9000109.md).

- Las clases y métodos del SDK de Android a menudo manipulan una referencia en un objeto de tipo "Context". En un proyecto Android, al escribir código nativo, puede recuperar un objeto de tipo "Context" haciendo referencia a la actividad actual o al contexto de la aplicación mediante los siguientes métodos (estos métodos pueden llamarse directamente en el código del procedimiento):
	
	```txt
	// Get the current activity
	getCurrentActivity()
	
	// Get the current "Context"
	getApplicationContext()
	```


- Para recuperar el objeto de tipo View que corresponde al componente principal del control, debe utilizar el método getView y pasarle el nombre del control.
	Ejemplo: El siguiente código devuelve la instancia de la clase "Button" utilizada por el control: 
	
	```txt
	getView("BTN_Button1")
	```




<a name="NOTE2_3"></a>


### Generar la aplicación
<a name="generar_aplicacion_ELTPARAGRAPHE000070"></a>

Las clases Kotlin utilizadas en el código Kotlin nativo deben especificarse en el asistente de generación de la aplicación Android: 

- etapa "Integrar bibliotecas" para clases incluidas en bibliotecas ".jar" o ".aar". 

- etapa "Integrar dependencias Maven" para las dependencias Maven. 
	 Observación: Estas clases no se pueden probar mediante la opción GO. Es necesario generar la aplicación, y luego ejecutarla. 




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>




## ¿Cómo ejecutar un procedimiento WLanguage?
<a name="¿como_ejecutar_procedimiento_wlanguage_ELTTEXTE000252"></a>


### Ejecutar un procedimiento WLanguage desde código Kotlin
<a name="ejecutar_procedimiento_wlanguage_desde_codigo_kotlin_ELTPARAGRAPHE000087"></a>

Para ejecutar un procedimiento WLanguage desde el código Kotlin, llame a uno de los siguientes métodos en función del tipo de valor devuelto por el procedimiento:

| Nombre del método | Tipo Kotlin devuelto |
| --- | --- |
| callWLProcedure | void (ningún valor de retorno) |
| callWLProcedure_String | String |
| callWLProcedure_int | int |
| callWLProcedure_double | double |
| callWLProcedure_long | long |
| callWLProcedure_boolean | boolean |



En la llamada al método seleccionado: 

- el primer parámetro que se pasa al método es el nombre del procedimiento WLanguage a ejecutar. 

- los otros parámetros corresponden a los parámetros esperados por el procedimiento WLanguage (si es necesario). Puede utilizar parámetros de cualquier tipo simple de Kotlin (string, int, double, long, boolean, etc.). Si el parámetro especificado no corresponde a un tipo simple de Kotlin, se convertirá automáticamente a "string" llamando al método "toString()". 




**Ejemplo**: 

Código del procedimiento WLanguage: 


```wl
GLOBAL PROCEDURE MyProcedure(n is int, b is boolean, s is string)
... 

RESULT s
```


Para llamar al procedimiento MyProcedure desde el código Kotlin, utilice: 


```txt
callWLProcedure_String("MyProcedure",5,false,"test")
```

<a name="NOTE3_2"></a>


### Notas importantes
<a name="notas_importantes_ELTPARAGRAPHE000140"></a>

- Si el procedimiento a ejecutar es un procedimiento local, le recomendamos indicar su nombre completo y especificar el nombre del elemento al que pertenece el procedimiento. Ejemplo: "WIN_Window1.MyProcedure". 

- El nombre del procedimiento a ejecutar solo debe contener caracteres alfanuméricos sin acentos.

- Si el procedimiento a ejecutar devuelve un valor, este valor se convertirá automáticamente al tipo primitivo Kotlin que corresponde al método utilizado para llamar al procedimiento. Si no se puede realizar la conversión, se produce un error fatal.

- Los parámetros del procedimiento se pasan por valor.





