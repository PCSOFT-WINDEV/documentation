


## Utilizar un componente externo en una aplicación
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000291"></a>
Un componente externo puede reutilizarse en cualquier momento en cualquier aplicación: sólo necesita conocer el directorio que contiene los archivos de los componentes externos.

Esta página de ayuda explica cómo hacerlo:

- [Incluir un componente externo en una aplicación](#NOTE2_1).

- [Manejar los elementos de un componente externo mediante programación](#NOTE3_1).

- [Actualizar un componente externo en una aplicación que utiliza un componente](#NOTE4_1).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) [Crear el ejecutable de una aplicación que utiliza un componente externo](#NOTE5_1).

- [Desplegar y actualizar la aplicación que utiliza un componente externo](#NOTE6_1).




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Incluir el componente en el proyecto
<a name="incluir_componente_proyecto_ELTTEXTE000315"></a>


### Incluir el componente en un proyecto
<a name="incluir_componente_proyecto_ELTPARAGRAPHE000038"></a>

Para incluir un componente en un proyecto: 

1. Abra el proyecto en WINDEV, WEBDEV o WINDEV Mobile.

2. En la pestaña "Proyecto", en el grupo "Proyecto", despliegue "Importar" y seleccione "Un componente externo .. Desde un archivo". Un selector de archivos se abre.

3. Seleccione el fichero WDI del componente a importar. Dependiendo del modo de distribución seleccionado, se puede encontrar este archivo:

	- en el directorio de creación del componente si el equipo donde se crea el componente y el equipo donde se utiliza el componente son idénticos,

	- en el directorio donde se han puesto a disposición los archivos de componentes,

	- en el directorio donde la instalación Procedure del componente ha copiado los archivos del componente.
			Para obtener más información, consulte [Distribución de un componente](../Editeurs/2014007.md).




4. Validar. Aparece la ventana de description del componente seleccionado. Esta ventana presenta:

	- el componente description (compañía, versión, ...). 
			Tiene la posibilidad de elegir el modo de carga del componente (al iniciar el proyecto o al utilizar un elemento de componente por primera vez).. Por Default, el componente se carga cuando un elemento del componente se utiliza por primera vez.

	- la documentación del componente. Esta documentación explica cómo utilizar los diferentes elementos del componente.




5. Validar. Los elementos de los componentes accesibles y utilizables se muestran en el panel "Explorador de proyectos. Una Icon específica indica que el elemento proviene de un componente.



<a name="NOTE2_2"></a>


### Archivos copiados automáticamente cuando el componente se incluye en un proyecto
<a name="archivos_copiados_automaticamente_cuando_componente_incluye_proyecto_ELTPARAGRAPHE000077"></a>

Cuando se incluye un componente en el proyecto, todos los archivos requeridos por el componente se copian automáticamente en el directorio del proyecto:

- El archivo *&lt;nombre del componente&gt;.WDI* se copia en el directorio del proyecto.

- El archivo *&lt;nombre del componente&gt;.WDK* se copia en el subdirectorio EXE del proyecto.

- Si se han especificado algunos archivos en el archivo opcional (*&lt;nombre del componente&gt;.WDO*), estos archivos se copian en el directorio EXE del proyecto (respetando la estructura de árbol especificada en el archivo WDO).




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Manejar los elementos de los componentes a través de la programación
<a name="manejar_los_elementos_los_componentes_traves_programacion_ELTTEXTE000345"></a>
Los elementos de Visible de un componente incluido en un proyecto pueden manejarse únicamente mediante programación.

**Para manipular un elemento componente (ventana, etc.) a través de la programación**, manipular el elemento como cualquier otro elemento creado en el proyecto. 

1. Véase la documentación sobre el elemento. 
	Para ello, realice una de las siguientes operaciones: 

	- Haga doble clic en el elemento del panel "Explorador de proyectos".

	- pulsar F2 desde el código del elemento. 




2. La documentación del elemento se visualiza en el editor de código. Esta documentación presenta los parámetros necesarios para la utilización del elemento (parámetros de entrada/salida, ....).

3. Utilizar el elemento según la información especificada en la documentación como si este elemento perteneciera al proyecto.. 

	- Para abrir una ventana, utilice [entablar](../WDLang1/3038035.md) y pase (si es necesario) los parámetros esperados por esta ventana.
			
		```wl
		Open(ComponentWindow [, Param1, Param2])
		```


	- Para imprimir un reporte, utilice [iPrintReport](../WDLang5/3046032.md) y pase (si es necesario) los parámetros esperados por este reporte.
			
		```wl
		iPrintReport(ComponentReport [, Param1, Param2])
		```


	- Para llamar a una Procedure, utilice la sintaxis habitual.
			
		```wl
		ComponentProcedure(Param1,Param2)
		```


	- Para usar una clase, declare una Variable del tipo de clase.
			
		```wl
		MyVariable is object ComponentClass
		```

			La variable se utiliza como cualquier otra variable de objeto.







Si se produce un conflicto con un elemento del proyecto, el nombre del elemento debe ir precedido del nombre del componente. Por ejemplo: 


```wl
Open(MyComponent.MyWindow)
```


Para usar el nombre del elemento en una Variable, el nombre del componente debe ser especificado. Por ejemplo: 


```wl
sWindow is string = "MyComponent.MyWindow"
Open(sWindow)
```


No se requiere ninguna función WLanguage específica para manipular el componente.
<a name="NOTE3_2"></a>


### Observación: la documentación técnica sobre el componente
<a name="observacion_documentacion_tecnica_sobre_componente_ELTPARAGRAPHE000137"></a>

La documentación técnica del componente está disponible:

- al incluir el componente en el proyecto: en la pestaña "Proyecto", en el grupo "Proyecto", despliegue "Importar" y seleccione "Un componente externo .. Desde un archivo".

- en la description de los componentes incluidos en el proyecto: 

	- En el panel "Explorador de proyectos", seleccione la carpeta "Componentes externos. 

	- Abra el menú contextual y seleccione "Lista de componentes externos importados en el proyecto". 

	- El botón [ Descripción] se utiliza para get información y documentación sobre el componente.






<a name="NOTE3_3"></a>


### Conflictos de nombres
<a name="conflictos_nombres_ELTPARAGRAPHE000169"></a>

**Atención**: Si un elemento de proyecto y un elemento de componente tienen el mismo nombre, el elemento de componente debe ir precedido por el nombre del componente.

Por ejemplo, la ventana "Menú" está disponible en el proyecto actual y en el componente "Email" utilizado por el proyecto.. La siguiente sintaxis permite abrir la ventana "Menú" del componente "Email":


```wl
Open("Email.Menu")
```

<a name="NOTE3_4"></a>


### Usando un componente Procedure en la compilación dinámica
<a name="usando_componente_procedure_compilacion_dinamica_ELTPARAGRAPHE000180"></a>

Para usar un componente Procedure en la compilación dinámica: 

1. El componente debe estar necesariamente cargado. El componente puede definirse como "Cargado cuando se inicia la aplicación" o puede ser cargado por [Carga de componentes](../WDLang1/3014023.md).

2. Se debe utilizar el nombre completo para identificar la Procedure y este nombre debe ir seguido de paréntesis para indicar que se debe utilizar una Procedure (en lugar de una Variable global): 
	
	```wl
	ComponentName.SetName.ProcedureName()
	```

	**Observación**: También se puede utilizar la función [Ejecute](../WDLang1/3013041.md):
	
	```wl
	Execute("ComponentName.SetName.ProcedureName")
	```




<a name="NOTE3_5"></a>


### Clases y componentes
<a name="clases_componentes_ELTPARAGRAPHE000202"></a>

Un componente puede contener clases en su interfase. Tienes la capacidad de derivar estas clases en el proyecto anfitrión, a overload los métodos virtuales, para proporcionar polimorfismo. La herencia está disponible entre varios niveles de componentes.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Actualización de un componente
<a name="actualizacion_componente_ELTTEXTE000393"></a>


- ** Cuando una nueva versión de un componente está disponible**, todo lo que tiene que hacer es instalar los nuevos archivos de esta actualización en el directorio instalación del componente (según el modo instalación utilizado). Para obtener más información sobre los diferentes modos para instalar un componente, consulte [Distribución de un componente](../Editeurs/2014007.md).

- **Al abrir un proyecto que utiliza este componente**el cambio de versión de los componentes se detectará automáticamente y se propondrá una actualización del proyecto.. Recomendamos que recompile el proyecto.
	Observación: Puede forzar la actualización de un componente de la lista de componentes encontrados en el proyecto: 

	- En el panel "Explorador de proyectos", seleccione la carpeta "Componentes externos. 

	- Abra el menú contextual y seleccione "Lista de componentes externos importados en el proyecto". 

	- Haga clic en el botón "Actualizar".




- **Si el componente se distribuyó con una aplicación WINDEV**el componente debe actualizarse. Para obtener más información, consulte [Desplegar una aplicación que utiliza un componente](../Editeurs/2014004.md).




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 

## Creación del ejecutable
<a name="creacion_del_ejecutable_ELTTEXTE000417"></a>
El ejecutable (que utiliza el componente) se crea de la misma manera que una aplicación WINDEV. Las DLL necesarias para el componente se detectan automáticamente.

<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Desplegar una aplicación que utiliza un componente
<a name="desplegar_una_aplicacion_que_utiliza_componente_ELTTEXTE000441"></a>
Una aplicación que utiliza uno o más componentes se despliega de la misma manera que una aplicación estándar.

Para obtener más información, consulte [Desplegar una aplicación que utiliza un componente](../Editeurs/2014004.md).


