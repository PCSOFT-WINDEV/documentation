


## Crear y generar un componente externo
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000612"></a>
Un componente externo se crea siguiendo los pasos a continuación:

1. [Crear un componente externo](#NOTE2_1). 

2. [Desarrollar los elementos del componente externo](#NOTE2b_1).

3. [Definir las opciones avanzadas del componente externo](#NOTE4_1). 

4. [Generar el componente externo](#NOTE5_1).




El componente externo puede distribuirse y reutilizarse. Para obtener más información, consulte [Distribuir un componente externo](../Editeurs/2014007.md) y [Utilizar un componente externo en una aplicación](../Editeurs/2014006.md).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Crear un componente externo
<a name="crear_componente_externo_ELTTEXTE000636"></a>
Un componente externo puede crearse: 

- a partir de un proyecto existente, utilizando una configuración de tipo "Componente externo". Esta configuración contiene los elementos del proyecto necesarios para que el componente externo funcione correctamente.  

- a partir de un proyecto de tipo "Componente externo". De forma predeterminada, este proyecto solo contiene una configuración de tipo "Componente externo".




**Para crear un componente externo a partir de un proyecto existente**:

1. Cree una configuración de proyecto para el componente externo: en la pestaña "Proyecto", en el grupo "Configuración del proyecto", despliegue "Nueva configuración" y seleccione "Componente externo (WDK)". 

2. El asistente de creación de una configuración de proyecto se abre y le pide que defina: 

	- el nombre y la descripción de la configuración de proyecto. 

	- las opciones de compatibilidad de la configuración: seleccione las diferentes plataformas en las que se puede utilizar el componente externo. 
			Atención: dependiendo de las plataformas seleccionadas, puede ser necesario utilizar una versión de WINDEV con WEBDEV y WINDEV Mobile. 

	- las opciones de compilación: puede activar y desactivar los errores de compilación para la compatibilidad con 64 bits y Linux, o los errores de compilación relacionados con las sesiones preiniciadas. Los errores de compilación relacionados con las sesiones preiniciadas solo están disponibles en las configuraciones de tipo Sitio.  

	- los elementos que deben integrarse en la configuración de proyecto. 




3. Valide el asistente. La descripción de la configuración de proyecto de tipo "Componente externo" se ha completado. 

4. Puede seleccionar la configuración de proyecto de tipo "Componente" en el panel "Explorador de proyectos" y comenzar a desarrollar el componente externo. 




**Para crear un componente externo a partir de un proyecto de tipo "Componente"**: 

1. Haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ico_nouveau.gif) en los botones de acceso rápido. En la ventana que aparece, haga clic en "Proyecto". El asistente de creación de proyectos se abre.

2. Elija el tipo de generación del proyecto: "Componente". Pase a la etapa siguiente. 

3. Especifique: 

	- las diferentes plataformas en las que se puede utilizar el componente externo. 
			Atención: dependiendo de las plataformas seleccionadas, puede ser necesario utilizar una versión de WINDEV con WEBDEV y WINDEV Mobile. 

	- las opciones de compilación: puede activar y desactivar los errores de compilación para la compatibilidad con 64 bits y Linux, o los errores de compilación relacionados con las sesiones preiniciadas (esta opción solo está disponible cuando se genera una configuración de tipo Sitio). 




4. Pase a la etapa siguiente.

5. Especifique las opciones del proyecto:

	- ***El nombre y la ubicación***. Estas opciones no se pueden modificar. En WINDEV, el proyecto corresponde a un archivo ".WDP". Este archivo se puede abrir con WEBDEV y WINDEV Mobile. Para obtener más información, consulte [Proyecto común](../Editeurs/2030049.md).
			Todos los objetos asociados al proyecto se crearán en el directorio especificado.

	- ***La descripción*** que resume el propósito del proyecto. Esta descripción se utiliza en la documentación del proyecto.




6. Pase a la etapa siguiente. Las etapas que aparecen a continuación son las que permiten crear un proyecto WINDEV, WEBDEV o WINDEV Mobile. 

7. El proyecto se crea. Este proyecto contiene una sola configuración de proyecto. Esta configuración es de tipo "Componente". 




<a name="NOTE2b"></a>
<a name="NOTE2b_1"></a>


## Desarrollar un componente externo
<a name="desarrollar_componente_externo_ELTTEXTE000660"></a>
Los componentes externos se desarrollan como cualquier otro proyecto WINDEV, WEBDEV o WINDEV Mobile. 

**Al desarrollar los diferentes elementos de un componente externo, se deben tener en cuenta los siguientes aspectos**:

1. **Elementos del componente externo**: 
	Verifique si cada elemento del proyecto está asociado a la configuración de tipo "Componente". 

	1. Seleccione el elemento (ventana, reporte, etc.) en el panel "Explorador de proyectos".

	2. Haga clic derecho para abrir el menú contextual y seleccione "Configuraciones". <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Configuration_de_projet2%20-%20HC%20N%B0001.gif&type=thumb)
En el menú que aparece: 

		- las configuraciones seleccionadas son las que están asociadas al elemento. 

		- las configuraciones no seleccionadas son las que no están asociadas al elemento. 

		- la opción "Todas" asocia el elemento a todas las configuraciones. 

		- la opción "Ninguna" disocia el elemento de una configuración. 

		- "Múltiple" le permite elegir las configuraciones a las que desea asociar el elemento. 




2. **Desarrollar un componente externo iOS o Android**
	Puede crear un componente Android o iOS: 

	- a partir de una versión de WINDEV Mobile integrada en WINDEV,

	- a partir de WINDEV Mobile. 




1. Las nuevas ventanas siempre serán de tipo Windows. Para crear una ventana Android o iOS: 

	- Cree una configuración Android o iOS. 

	- Cree la ventana en esta configuración. Si la ventana ya existe en el proyecto, asegúrese de que está asociada a una configuración de iOS o Android. 

	- Asocie la ventana a la configuración del componente. 

3. **Comentarios de código**
	Cuando desarrolle los elementos del componente externo, recuerde insertar **comentarios en el código**. Los comentarios se utilizarán para crear la documentación del componente. Estos comentarios proporcionan una ayuda para los usuarios de los componentes. Para obtener más información, consulte [Documentación automática de componentes](../Editeurs/2014001.md). 
	**si no se encuentran comentarios en el código**, los parámetros de entrada y salida esperados de cada elemento accesible del componente se incluirán automáticamente en la documentación.
	Por ejemplo:
	
	```txt
	Description of input/output parameters of 'Window1':
	Parameters:
	Param1: <specify the role of Param1>
	Return value:
	None
	```


4. **Declaración y visibilidad de los elementos**
	El usuario del componente externo tendrá más o menos acceso a los elementos (clases, procedimientos, conjuntos de procedimientos, etc.) dependiendo de cómo se declaren. Para obtener más información, consulte [Visibilidad de un elemento en un componente externo](../Editeurs/2014009.md).
	Observación: Si un componente externo utiliza un análisis y archivos de datos, las funciones HFSQL manipularán los elementos en un contexto HFSQL independiente. Este modo de funcionamiento se puede modificar en las opciones avanzadas del componente.

5. **Para ejecutar un procedimiento del proyecto que aloja el componente externo,** utilice la función [ExecuteProcess](../WDLang1/3013031.md) con la constante *trtProjectProcedure*.



<a name="NOTE2_2"></a>


### Observación
<a name="observacion_ELTPARAGRAPHE000168"></a>

Un componente externo puede incluir clases en su interfaz. Puede derivar estas clases en el proyecto principal, sobrescribir métodos virtuales y aplicar polimorfismo. La herencia está disponible entre varios niveles de componentes externos.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Opciones avanzadas del componente externo
<a name="opciones_avanzadas_del_componente_externo_ELTTEXTE000690"></a>
Las opciones avanzadas del componente externo permiten definir:

- los permisos de acceso del componente en los elementos de la aplicación que utilizan el componente.

- el modo de gestión de las plantillas en los elementos del componente.



<a name="NOTE4_2"></a>


### Definir y modificar las opciones avanzadas del componente
<a name="definir_modificar_las_opciones_avanzadas_del_componente_ELTPARAGRAPHE000185"></a>

Para modificar las opciones avanzadas del componente: 

1. Abra la ventana de descripción de la configuración de tipo "Componente": 

	- Si la configuración del componente ya está abierta: en la pestaña "Proyecto", en el grupo "Configuración del proyecto", haga clic en "Configuración actual".

	- En el panel "Explorador de proyectos", abra el menú contextual de la configuración del componente y seleccione "Descripción". 




2. Seleccione el componente.

3. En la ventana que aparece, en la pestaña "General", haga clic en "Opciones del componente". 



<a name="NOTE4_3"></a>


### Permisos de acceso del componente en el proyecto cliente
<a name="permisos_acceso_del_componente_proyecto_cliente_ELTPARAGRAPHE000215"></a>

Hay tres opciones:

- **El componente no accederá a los archivos de datos, ventanas, páginas y reportes del proyecto cliente.**
	El componente y su aplicación principal (host) utilizan contextos independientes (opción predeterminada). El componente no puede manipular los archivos de datos ni los elementos del proyecto principal.
	También tiene la posibilidad de definir el contexto de ejecución del componente en el proyecto principal. El contexto de tiempo de ejecución puede ser: 

	- global. En este caso, se utilizará el mismo contexto si el componente externo es cargado por el proyecto y por otro componente externo del proyecto.

	- aislado (predeterminado). En este caso, si el mismo componente es cargado por el proyecto y por un componente del proyecto, cada componente utilizará un contexto específico.


 Si esta opción está seleccionada, se llamará al evento "Inicialización" del proyecto del componente cuando el proyecto principal cargue dicho componente.

- **El componente accederá a los archivos de datos del proyecto cliente.**
	El componente solo puede manipular los archivos de datos de la aplicación principal. En este caso, los contextos HFSQL serán idénticos.
	Si esta opción está seleccionada, se llamará al evento "Inicialización" del proyecto del componente cuando el proyecto principal cargue dicho componente.

- **El componente accederá a los archivos de datos, ventanas, páginas y reportes del proyecto cliente.**
	El componente puede manipular los archivos de datos de la aplicación principal, así como sus elementos (ventanas, reportes, etc.). En este caso, los contextos de ejecución serán idénticos.
	Si esta opción está seleccionada, no se llamará al evento "Inicialización" del proyecto del componente cuando el proyecto principal cargue dicho componente.




**¿Cuándo se debe permitir que el componente manipule los archivos de datos de la aplicación principal?**
Cuando la aplicación final consta de una aplicación principal y de opciones proporcionadas como componentes. En este caso, los componentes manipulan los archivos de datos de la aplicación principal.

**Observación**: Si el componente está autorizado a manipular los archivos de datos y tiene su propio análisis, el análisis del componente se ignorará. El componente utilizará el análisis del proyecto principal.

En este ejemplo, se puede asociar el componente al análisis de la aplicación principal. Por lo tanto, no hay necesidad de utilizar las declaraciones externas para manipular los archivos de datos. Además, aparecerán sugerencias de autocompletado en el editor de código.

Para obtener más información sobre los contextos HFSQL, consulte [Contexto HFSQL](../WDChamp/1010029.md).
<a name="NOTE4_4"></a>


### Estilo: Plantilla de los elementos del componente.
<a name="estilo_plantilla_los_elementos_del_componente_ELTPARAGRAPHE000269"></a>

De forma predeterminada, la plantilla del proyecto principal se puede aplicar a los diferentes elementos del componente externo. Para obtener más información sobre las plantillas, consulte [Plantilla](../Editeurs/2016011.md).

Observaciones: 

- Puede permitir o impedir que el proyecto cliente aplique la plantilla. Para ello, vaya a la pestaña "Estilo" de las opciones avanzadas del componente externo. 

- Para que no se aplique la plantilla del proyecto cliente a una ventana del componente externo: 

	1. Abra la ventana de descripción del componente. 

	2. En la pestaña "Estilo", en la sección "Plantillas", seleccione "Conservar siempre el estilo o plantilla inicial".

	3. Valide. 







<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Generar un componente externo
<a name="generar_componente_externo_ELTTEXTE000732"></a>
Una vez generado, se puede distribuir y reutilizar el componente externo. Todos los archivos necesarios para distribuir el componente externo se generan junto con el componente. 
Esta generación puede realizarse en cualquier momento desde la configuración del proyecto del componente: 

- en la pestaña "Proyecto", en el grupo "Generación", haga clic en "Generar". 

- en los botones de acceso rápido, haga clic en el ícono de generación del componente: <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ico_generation_Composant.gif)





**Observación**: Si se modifica el componente externo, se debe regenerar antes de volver a distribuirlo. Para obtener más información, consulte [Modificar un componente externo](../Editeurs/2014008.md).
<a name="NOTE5_2"></a>


### Generar un componente externo
<a name="generar_componente_externo_ELTPARAGRAPHE000323"></a>

Para generar un componente externo: 

1. Abra la configuración de proyecto del componente a generar, luego vaya a la pestaña "Proyecto", grupo "Generación" y haga clic en "Generar".

2. El asistente de generación del componente externo se abre. 

3. Seleccione "Recompilar proyecto antes de generar el componente" (si es necesario). Pase a la etapa siguiente. 

4. Seleccione los elementos del componente externo a los que se podrá acceder desde el proyecto que lo utiliza. Los desarrolladores podrán utilizar los elementos accesibles como cualquier otro elemento del proyecto. Para obtener más información, consulte [Visibilidad de un elemento en un componente externo](../Editeurs/2014009.md).
	Observación: La lista de elementos accesibles corresponde a los elementos asociados a la configuración de proyecto del componente actual. 
	Pase a la etapa siguiente. 

5. Especifique si se puede traducir el componente externo. Si selecciona la opción "Permitir traducción del componente", elija los elementos del componente que pueden traducirse. Los elementos no seleccionados no estarán disponibles para la traducción. 
	Para obtener más información, consulte [Traducir un componente externo](../Editeurs/2014014.md). 
	Pase a la etapa siguiente. 

6. Si el proyecto contiene componentes, pueden incluirse en el componente que se está generando ("componentes anidados", por ejemplo).
	Pase a la etapa siguiente. 

7. Especifique si el número de versión del componente externo debe cambiarse (cuando se modifica el componente externo). Para obtener más información sobre cómo gestionar las diferentes versiones de un componente externo, consulte [Modificar un componente externo](../Editeurs/2014008.md).
	Pase a la etapa siguiente. 

8. Introduzca la información sobre el componente externo: Propietario, título, copyright, etc. Esta información se mostrará: 

	- al integrar el componente externo en un proyecto WINDEV, WEBDEV o WINDEV Mobile.

	- en las propiedades de los archivos WDI y WDK en el explorador de Windows (pestaña "PC SOFT").


 Pase a la etapa siguiente.

9. Seleccione la imagen del componente externo. Esta imagen se utilizará en el explorador de Windows. 
	Pase a la etapa siguiente.

10. Introduzca la presentación general del componente externo. 
	La presentación general se incluirá automáticamente en la descripción del componente externo.
	Pase a la etapa siguiente.

11. El asistente de generación presenta automáticamente la documentación técnica asociada al componente externo. 
	Para obtener más información sobre las normas de creación de comentarios, consulte [Documentación automática de componentes](../Editeurs/2014001.md).
	Pase a la etapa siguiente.

12. Especifique si desea generar un sistema de ayuda (en formato CHM). Este sistema de ayuda se copiará junto con el componente. El sistema de ayuda contiene la documentación técnica del componente externo.
	Pase a la etapa siguiente.

13. Indique si el componente externo debe publicarse en un directorio del SCM. Esta opción permite poner el componente externo a disposición de los proyectos del SCM. Para obtener más información, consulte [componente externo y SCM](../Editeurs/2038015.md). 

14. Si el componente generado se puede utilizar en una plataforma Android, el asistente de generación de componentes Android se abre. Este asistente permite configurar las características del componente específicas de Android. Para obtener más información sobre las diferentes etapas, consulte [Generar un componente para Android](#NOTE5_3). 

15. Si el componente generado se puede utilizar en una plataforma iOS, el asistente de generación de componentes iOS se abre. Este asistente permite configurar las características del componente específicas de iOS. Para obtener más información sobre las diferentes etapas, consulte [Generar un componente para iOS](#NOTE5_4). 

16. Especifique el nombre físico del componente externo. Este nombre se asignará a los archivos que corresponden al componente externo.

17. Valide. El componente externo se genera. 




Los siguientes archivos se crean en el directorio de generación de la configuración del proyecto:


|   |   |
| --- | --- |
| &lt;Nombre del componente&gt;.WDK | Este archivo contiene todos los elementos que se van a distribuir (ventanas, reportes, etc.).<br><br>Este archivo es necesario cuando se implementan aplicaciones que utilizan el componente externo. |
| &lt;Nombre del componente&gt;.WDI | Interfaz del componente externo. Este archivo contiene:<br><br>- un texto de ayuda sobre cómo utilizar el componente externo cuando se reintegra.<br><br>- los elementos necesarios para utilizar el componente externo en el proyecto (información de compilación, etc.).<br><br><br> |
| &lt;Nombre del componente&gt;.WDZ | Este archivo contiene las dependencias del archivo WDK (solo para los componentes WEBDEV y WINDEV Mobile). Esta información se extrae en el proyecto en el que se integra el componente. <br><br>- En el caso de un componente WEBDEV, este archivo contiene las páginas WEBDEV generadas, las imágenes, etc. <br><br>- En el caso de un componente móvil (iOS o Android), este archivo contiene, por ejemplo, los archivos de generación de Android.<br><br><br> |


**Atención**: La generación del componente externo puede ser bastante larga si el componente externo contiene varios elementos accesibles.
<a name="NOTE5_3"></a>


### Generar un componente externo para Android
<a name="generar_componente_externo_para_android_ELTPARAGRAPHE000447"></a>

Si el componente generado se puede utilizar en una plataforma Android, el asistente mostrará las siguientes etapas adicionales: 

1. El SDK de Android y Gradle son necesarios para generar el componente Android. Es posible: 

	- **Descargar e instalar estas herramientas automáticamente**. En este caso, WINDEV Mobile descarga e instala todas las herramientas necesarias con las opciones deseadas. Solo se requiere una conexión a Internet. 
			**Se recomienda utilizar este método**. Atención: La primera descarga puede ser bastante larga. 

	- **Utilizar las herramientas instaladas automáticamente**. Esta opción solo está disponible si las herramientas se descargaron e instalaron en una generación anterior. 

	- **Utilizar las herramientas ya instaladas en el equipo**. En este caso, se deben especificar las rutas de instalación de Gradle y del SDK de Android. Para obtener más información, consulte [Instalación del SDK de Android](../Editeurs/9000042.md). 


 Si está utilizando un proxy para acceder a Internet, haga clic en el botón "Proxy" para configurar o comprobar la gestión del proxy. Para obtener más información, consulte [Opciones generales de WINDEV, WEBDEV y WINDEV Mobile](../Editeurs/2036001.md).

2. Pase a la etapa siguiente. 

3. Indique el nombre del paquete que corresponde al componente. Este nombre identifica el componente. De forma predeterminada, está compuesto por el nombre de la empresa (o su nombre de dominio en orden inverso) seguido del nombre del componente. El nombre del componente estará en el idioma predeterminado del proyecto. 

4. Pase a la etapa siguiente. 

5. El componente se genera para una flota de dispositivos. Puede limitar el tamaño de la aplicación seleccionando una arquitectura de procesador específica. 
	Nota: Si tiene un dispositivo conectado al PC, utilice la opción "Detectar dispositivo automáticamente". Así, la próxima vez que se genere una aplicación, el dispositivo se seleccionará automáticamente.

6. Pase a la etapa siguiente. 

7. La lista de archivos integrados en el componente aparece. Esta lista se construye a partir de los archivos de la carpeta "Otros" del panel "Explorador de proyectos". Por ejemplo, puede integrar: 

	- recursos específicos: imágenes, ... 

	- archivos de datos HFSQL utilizados por la aplicación, ... 


 De forma predeterminada, los archivos incluidos en el componente son de solo lectura (opción "Lectura" seleccionada). Pueden: 

- utilizarse directamente en el componente en modo de solo lectura. 
			Por ejemplo, si se incluye una imagen de solo lectura en el componente Android, puede asignarse directamente a un control especificando el nombre. Por ejemplo: 
			
		```wl
		IMG_Image = image1
		```


- extraerse mediante programación (con la función [fExtractResource](../WDLang1/1000019509.md)). En este caso, el archivo puede modificarse más adelante. 

8. Pase a la etapa siguiente. 

9. Indique las bibliotecas que deben integrarse en el componente Android. Puede incluir: 

	- bibliotecas Java específicas (archivos \*.jar o \*.aar). 

	- bibliotecas nativas (archivos SO). 

	- la biblioteca HFSQL. 
			Esta biblioteca es necesaria si el componente utiliza archivos de datos HFSQL.




10. Pase a la etapa siguiente. 

11. El asistente le pide que integre las dependencias remotas (por ejemplo, JCenter) en el componente Android. 
	También es posible especificar repositorios adicionales (aparte de JCenter y Google). 

12. Pase a la etapa siguiente. 

13. Seleccione los permisos necesarios para que el componente funcione correctamente. El componente debe indicar a Android a qué servicios necesita acceder para funcionar correctamente (Internet, cámara, etc.). WINDEV Mobile agrega automáticamente los permisos necesarios según las instrucciones utilizadas en el componente. 
	**Observaciones**: 

	- Si se utilizaron procedimientos escritos en código Java nativo, se deben agregar los permisos correspondientes.

	- A partir de Android 6, el permiso se solicita la primera vez que se utiliza la funcionalidad (antes de esta versión, todas las solicitudes de permisos se agregaban durante la instalación).




14. Pase a la etapa siguiente. 

15. Si la aplicación que utiliza el componente está disponible en Google Play, puede hacer que el componente esté disponible solo para los dispositivos que admiten las funcionalidades utilizadas en la aplicación. Por ejemplo, si su componente utiliza el desplazamiento inercial, puede hacer que solo esté disponible para los dispositivos que admiten esa funcionalidad. 
	Puede agregar o eliminar funcionalidades específicas. 

16. Pase a la etapa siguiente. 

17. Especifique la [parámetros de configuración](#NOTE4_1). 

18. El componente se compila y genera. 



<a name="NOTE5_4"></a>


### Generar un componente externo para iOS
<a name="generar_componente_externo_para_ios_ELTPARAGRAPHE000537"></a>

Si el componente generado se puede utilizar en una plataforma iOS, el asistente mostrará las siguientes etapas adicionales: 

1. Indique si hay archivos que deben incluirse en el componente. 
	La lista de archivos integrados en el componente aparece. Los archivos seleccionados están resaltados en azul. Estos archivos se encuentran en la carpeta "Otros" del panel "Explorador de proyectos". Por ejemplo, puede integrar: 

	- recursos específicos.

	- imágenes específicas.

	- archivos de datos. 




2. Especifique las opciones de los archivos: 

	- **Si la opción "Escritura" está seleccionada para los archivos**, se extraerán automáticamente (por ejemplo, los archivos que deben ser modificados por la aplicación). En este caso, especifique el directorio de la aplicación en el que debe extraerse cada archivo ("Documentos" o "Biblioteca"). 

	- **Si la opción "Escritura" no está seleccionada para los archivos**, estos pueden:

		- utilizarse directamente (archivos que solo se van a leer, por ejemplo: archivos de sonido, archivos de imagen, etc.). Estos archivos están incluidos en la aplicación y no serán extraídos. La función [fResourceDir](../WDLang1/1000020166.md) permite acceder a estos archivos en modo de solo lectura.  

		- extraerse mediante programación con la función [fExtractResource](../WDLang1/1000019509.md). 
						**Atención**: el sistema iOS distingue entre mayúsculas y minúsculas. 




3. Pase a la etapa siguiente.

4. **Si publica la aplicación iOS que contiene el componente en App Store**, debe incluir una breve descripción de cada funcionalidad utilizada. La primera vez que el usuario final utilice cualquiera de estas funcionalidades, una ventana de autorización mostrará esta descripción.

5. Valide el asistente. El componente se compila y genera. 





