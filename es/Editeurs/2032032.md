


## Uso de una consulta con parámetros
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000205"></a>
Se puede utilizar una consulta con parámetros:

- Como fuente de datos de control (Tabla, Cuadro de Listas, Combo Box, Looper, etc.).

- Como fuente de datos de reporte.

- Mediante programación.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Usando una consulta con parámetros en una Tabla
<a name="usando_una_consulta_con_parametros_una_tabla_ELTTEXTE000229"></a>
Cuando una control Tabla de navegación está vinculada a una consulta con parámetros (independientes o incrustados), los parámetros deben pasarse a la consulta antes de que se ejecute.

Si estos parámetros no se especifican antes de la primera ejecución de la consulta, ésta no se ejecutará y control Tabla permanecerá vacía.

Para pasar parámetros a la consulta, puede utilizar:

- la siguiente notación:
	
	```txt
	<Query Name>.<Name of Parameter1> = xxx 
	<Query Name>.<Name of Parameter2> = xxx 
	<Query Name>.<Name of Parameter3> = xxx 
	HExecuteQuery(<Query Name>)
	```

	En este caso, la consulta se ejecuta automáticamente al inicializar la control Tabla.

- [HExecuteQuery](../WDLang4/3044080.md) especificando los parámetros en la función.




Caso especial: los parámetros de la consulta pueden ser directamente inicializados en el código de inicialización de control. En este caso, no es necesario utilizar HExecuteQuery para calcular el resultado de la consulta.. La sintaxis será: 

```txt
MySource.<Name of Parameter1> = xxx 
MySource.<Name of Parameter2> = xxx 
MySource.<Name of Parameter3> = xxx
```




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Usando una consulta con parámetros en un reporte
<a name="usando_una_consulta_con_parametros_reporte_ELTTEXTE000257"></a>


### Principio
<a name="principio_ELTPARAGRAPHE000056"></a>

<a name="Qry_Param_Report"></a>
Para utilizar una reporte basada en una consulta con parámetros, la consulta debe ejecutarse antes de abrir la ventana de diálogo reporte. La consulta puede ser realizada por [iInitReportQuery](../WDLang5/3046021.md). Esta función se utiliza para ejecutar la consulta y para especificar los parámetros de la misma.. Se puede llamar a esta función:

- en el código de inicialización de reporte,

- ante [iPrintReport](../WDLang5/3046032.md).



<a name="NOTE3_2"></a>


### Ejemplo
<a name="ejemplo_ELTPARAGRAPHE000073"></a>

El *Formulario WIN_CustomerForm* se utiliza para navegar por las características de los clientes. Para cada cliente, el usuario puede hacer clic en el botón *BTN_PrintOrder* para imprimir el *RPT_CustomerOrdReport* reporte. Esta reporte es associated con la consulta *QRY_CustomerOrd* que selecciona los pedidos de un cliente determinado.

El siguiente código se utiliza para ejecutar la consulta *QRY_CustomerOrd* según el cliente actual e imprimir el reporte:


```wl
// -- Click process of BTN_PrintOrder button
// Run the query according to the current customer
iInitReportQuery(RPT_CustomerOrderReport, CustomerNum)
// Print the report
iPrintReport(RPT_CustomerOrdReport)
```


<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Utilizar una consulta con parámetros mediante programación
<a name="utilizar_una_consulta_con_parametros_mediante_programacion_ELTTEXTE000287"></a>


### Principio
<a name="principio_ELTPARAGRAPHE000086"></a>

Cuando se ejecuta la consulta con parámetros a través de la programación, se pueden pasar los parámetros:

- en la función [HExecuteQuery](../WDLang4/3044080.md) WLanguage.

- utilizando *&lt;nombre de la consulta&gt;.&lt;nombre del parámetro&gt;*, luego [HExecuteQuery](../WDLang4/3044080.md).




Para más detalles sobre cómo pasar parámetros a la consulta, véase [Dos métodos para pasar parámetros a una consulta](../Editeurs/2032050.md).
<a name="NOTE4_2"></a>


### Ejemplo
<a name="ejemplo_ELTPARAGRAPHE000107"></a>Para visualizar la lista de los pedidos realizados en 2018:


```wl
// Execute query
HExecuteQuery(QRY_ParamOrder, hQueryDefault, 2018)
// Similar code: 
// QRY_ParamOrder.Year = 2018
// HExecuteQuery(QRY_ParamOrder, hQueryDefault)
```


<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Consejo
<a name="consejo_ELTTEXTE000317"></a>
Cuando un parámetro de la consulta se inicializa con el valor NULL, la condición associated con este parámetro se ignora al ejecutar la consulta. 

Para más información: Si el valor del parámetro proviene de un control Campo de entrada, la opción "***Devolver NULL si está vacío***" (pestaña "Detalles" de la descripción del control) permite asignar directamente el valor NULL si el control está vacío.
<a name="NOTE5_2"></a>


### Ejemplo
<a name="ejemplo_ELTPARAGRAPHE000125"></a>La ejecución del código SQL es:


```sql
SELECT NameOfItems
FROM NameOfFiles
WHERE Item = {Param1}
```
Para este ejemplo, la tabla a continuación describe el uso de "NULL if empty":

| Valor introducido por el usuario | Opción"NULL if empty" (NULL si está vacío) | Ejecución de código SQL |
| --- | --- | --- |
| Ningún valor | Opción seleccionada |  SELECCIONE Nombres de los artículos <br>FROM NameOfFiles  <br> |
| Ningún valor | Opción no seleccionada |  SELECCIONE Nombres de los artículos <br> FROM NameOfFiles <br>DONDE EL Ítem = ' ' '  <br> |
| Se introduce un valor | Opción marcada o no marcada |  SELECCIONE Nombres de los artículos <br>FROM NameOfFiles<br> DÓNDE Elemento = 'ValueEntered' (valor ingresado)  <br> |




