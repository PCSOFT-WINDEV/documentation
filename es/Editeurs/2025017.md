
## Programación estándar en Windows Vista y posteriores
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000157"></a>
Para aumentar la seguridad contra los gusanos y los virus, Windows Vista/7 implementó el sistema [Mecanismo UAC](../Editeurs/2025014.md) (User Account control). Por Default, este mecanismo considera que todos los usuarios (incluidos los administradores) son usuarios estándar con derechos limitados. Para ejecutar una aplicación que requiere derechos adicionales, el mecanismo UAC solicita confirmación.

Esta página de ayuda presenta varios consejos de programación para crear una aplicación que no requiere privilegios de administrador (no se pedirá confirmación cuando se ejecute) y que cumple con el estándar de programación de Windows Vista (y posterior).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Consejos de programación
<a name="consejos_programacion_ELTTEXTE000181"></a>


### Ubicación de los archivos manejados por la aplicación
<a name="ubicacion_los_archivos_manejados_por_aplicacion_ELTPARAGRAPHE000023"></a>

Para crear y modificar un archivo sin tener privilegios de administrador:

- no escribas en el directorio de "Windows".

- no escribas en el directorio de "Archivos de programa". Sin embargo, las aplicaciones deben ser instaladas en este directorio.




**Consecuencias**: 

- **Si una aplicación debe crear o modificar archivos de datos HyperFileSQL**, estos archivos de datos deben estar ubicados en el directorio correspondiente a la aplicación (devuelto por [SysDir](../WDLang1/3073026.md) asociado a la constante *srCommonAppData*).

- **Si una aplicación debe crear o modificar archivos externos** (archivos .INI, archivos de texto, ...), estos archivos deben estar ubicados en el directorio correspondiente a la aplicación (devuelto por [SysDir](../WDLang1/3073026.md) asociado a la constante *srCommonAppData*). Tenga cuidado al utilizar [INIWrite](../WDLang1/3013039.md) y no olvide especificar todos los parámetros.

- Ejecutables **Stand-alone**: Si se instala un ejecutable autónomo en el directorio "Archivos de programa", framework no se copiará en el directorio. Le recomendamos que utilice un instalación autoextraíble en lugar de un ejecutable independiente.




**Observación**: Si no se realizan estas operaciones, en el modo de 32 bits, el mecanismo de virtualización redirige los archivos hacia una ubicación específica, a la que sólo puede acceder el usuario (C:\\Usuarios\\&lt;LOGIN&gt;AppData\\Local\\Tienda Virtual\\Directorio de Windows _ASLASHE_). El objetivo de esta redirección es garantizar la compatibilidad de las aplicaciones. Para obtener más información, consulte [Mecanismo UAC](../Editeurs/2025014.md).
<a name="NOTE2_2"></a>


### Usando el registro
<a name="usando_registro_ELTPARAGRAPHE000053"></a>

Para escribir en el registro sin tener los privilegios de administrador, no debe escribir en la clave "HKEY_LOCAL_MACHINE\\SOFTWARE".

**Observación**: Si el usuario no tiene los derechos necesarios, el mecanismo UAC realiza una redirección a "HKEY_CURRENT_USER\\Software\\Classes\\VirtualStore\\MACHINE\\SOFTWARE".. El objetivo de esta redirección es garantizar la compatibilidad de las aplicaciones. Las claves escritas en este directorio pueden ser leídas por la aplicación que las ha escrito.. Para obtener más información, consulte [Mecanismo UAC](../Editeurs/2025014.md).

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Adaptación de una aplicación existente a Windows Vista (y más tarde)
<a name="adaptacion_una_aplicacion_existente_windows_vista_mas_tarde_ELTTEXTE000211"></a>
Su aplicación ya se utiliza en Windows Vista/7, pero desea que esta aplicación cumpla con el estándar de programación de Windows Vista/7?

Si su aplicación es una aplicación autónoma que utiliza archivos de datos, debe modificar la ubicación de los archivos de datos en su aplicación para respetar las normas de programación de Vista/7 (véase el párrafo Above).

Pueden darse varios casos para los usuarios finales: 

- Si la aplicación se inició en modo de administrador (mediante un manifiesto de administrador o una casilla de verificación en las propiedades del ejecutable), los archivos de datos de la aplicación se encuentran en el directorio especificado en su aplicación.

- Si la aplicación se inició en modo monousuario, los directorios utilizados fueron virtualizados automáticamente por Windows Vista/7 (si no se permitía al usuario el acceso a estos directorios).. Los archivos de datos de la aplicación se encuentran en: C:\\Usuarios\\&lt;LOGIN&gt;AppData\\Local\\Tienda Virtual\\Windows\\




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Ejemplos de funciones afectadas por la gestión de los derechos de los usuarios en Vista (y más adelante)
<a name="ejemplos_funciones_afectadas_por_gestion_los_derechos_los_usuarios_vista_mas_adelante_ELTTEXTE000235"></a>


### Grupos de funciones que pueden verse afectados por el mecanismo de la UAC
<a name="grupos_funciones_que_pueden_verse_afectados_por_mecanismo_uac_ELTPARAGRAPHE000081"></a>

Las siguientes funciones (o grupos de funciones) pueden verse afectadas por el mecanismo de la UAC (Reminder: el mecanismo de UAC está habilitado por Default en Windows Vista/7):

- Funciones de gestión de archivos externos ([funciones fxxx](../WDLang1/3036034.md)).

- Funciones de gestión del registro ([RegistroXXX](../WDLang1/3065004.md)).

- Funciones de gestión de archivos .INI ([INIRead](../WDLang1/3013043.md) y [INIWrite](../WDLang1/3013039.md))

- Las funciones [ExeRun](../WDLang1/3035006.md) y [ShellExecute](../WDLang1/3035007.md)

- La función [SendKey](../WDLang1/3014014.md)




Esta lista no es exhaustiva.


