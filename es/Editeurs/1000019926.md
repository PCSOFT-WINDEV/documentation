
## implementación en la casa
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000334"></a>
La implementación interna de Apple permite superar la mayoría de las limitaciones de los otros dos modos (App Store implementación y Ad Hoc implementación) y distribuir ampliamente una aplicación sin necesidad de utilizar previamente los dispositivos cliente de reference.

**Beneficia a**:

- implementación a gran escala (sin límite de clientes).

- Aplicaciones distribuidas no comprobadas por Apple.




**D retrocede a**:

- requiere un servidor HTTPS para distribuir la aplicación.

- requiere una membresía más cara de la Cuenta de Desarrollador de Apple. 




Nota: La casa implementación era conocida anteriormente como "Enterprise".... El término "Enterprise" todavía se puede encontrar en alguna documentación.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Etapas a seguir
<a name="etapas_seguir_ELTTEXTE000358"></a>


### Etapa 1: Firmando Certificate
<a name="etapa_1_firmando_certificate_ELTPARAGRAPHE000028"></a>

Este paso debe ser completado sólo una vez. 

La firma Certificate puede ser utilizada para todas las aplicaciones de la empresa.

La firma Certificate identifica la organización que distribuye una solicitud. Se compone de una llave pública y una llave privada:

- la clave privada es mantenida por el desarrollador y se utiliza para firmar los paquetes de instalación de la aplicación.

- la clave pública se distribuye con la aplicación y debe ser firmada por Apple.




**Observación**: Los certificados de distribución son válidos por tres años. Una Certificate caducada no puede ser renovada. Al expirar, debe generarse una nueva Certificate.

Los certificados de firma se crean a través de una cuenta de desarrollador de Apple, en "https://developer.apple.com/".

Esta operación tiene dos etapas: 

1. Creación de la llave privada y pública en el Mac.

2. Enviando la clave pública para ser firmada por Apple, como una Solicitud de Firma de Certificate (CSR).


Observación: se recomienda realizar esta operación en el Mac utilizado para la compilación. Todos los archivos generados se instalarán en el equipo, y estarán listos para ser utilizados por Xcode durante las operaciones de compilación.

**Crear claves en el Mac**
Para crear la clave privada y la RSC, utilice "Acceso a Llaveros", disponible en "Aplicaciones", "Utilidades". 
En el menú principal de la aplicación, seleccione "Asistente Certificate"... Solicitar una Certificate a una autoridad de la Certificate".
Entonces siga los pasos del asistente de Certificate.

**Signar el CSR a través del sitio**
En la página web de "Apple Developer": 

1. Haga clic en "Certificados, identificadores y perfiles" en la barra lateral.

2. Luego haz clic en "+" para crear una nueva Certificate (en la sección "Software", elige "In-House y Ad Hoc").

3. Una vez que se genera la RSC, debe ser enviada a Apple.

4. Haga clic en "Elegir archivo" y seleccione el archivo CSR generado por el asistente.




Apple entonces firmará el CSR y devolverá una firma Certificate que debe ser:

- descargado a través del botón "Descargar",

- instalado en el Mac (haga doble clic en el archivo descargado).




Atención: Es importante señalar que el implementación interno no tiene por objeto comercializar aplicaciones, sino sólo para el implementación interno a gran escala en una organización.


### Etapa 2: Identificador de la aplicación
<a name="etapa_2_identificador_aplicacion_ELTPARAGRAPHE000075"></a>

Este paso debe completarse una sola vez para cada solicitud de distribución, a menos que varíen las condiciones de distribución descritas en el App ID.

Se utiliza un identificador de aplicación (App ID) para identificar de forma exclusiva una aplicación. Diferentes versiones de la misma aplicación tendrán todas el mismo ID de la aplicación.

También se puede crear un identificador de la aplicación desde el sitio web de Apple Developer: 

1. En "Certificados, identificadores y perfiles", seleccione la segunda opción de la barra lateral: "Identificadores", 

2. Haz clic en "+" para crear un nuevo ID de aplicación,

3. En "Registrar un nuevo identificador", seleccione "App ID" y haga clic en "Continuar".

4. Describa la aplicación para crear el App ID.

	- Plataforma: seleccione iOS, tvOS, watchOS para una aplicación WINDEV Mobile.

	- description: este campo permite introducir una description de la aplicación.

	- ID del Bundle: seleccione "Explícito" e introduzca un identificador de paquete. No hay reglas para introducir este identificador. Debe especificarse en la generación de WINDEV Mobile asistente (ver paso 5). Por convención, este identificador suele corresponder a una sintaxis denominada "nombre de dominio inverso".. 
			Por ejemplo, para una aplicación llamada "WMShopping" distribuida por la empresa "precilia.com", el ID del paquete recomendado sería: "com.precilia.wmshopping".
			Nota: Los ID de paquetes de comodines (es decir, con un asterisco en lugar de un nombre de aplicación como "com.precilia.\*") permiten tener un único ID de aplicación para varias aplicaciones, que puede ser useful para distribuir un gran número de aplicaciones. Sin embargo, las notificaciones Push o las compras In-App no pueden ser utilizadas en una aplicación identificada por un ID de paquete Wildcard.




5. En "Capacidades", especifique las funcionalidades utilizadas por la aplicación (por ejemplo, notificaciones push). 

6. Haga clic en "Continuar".

7. En la siguiente página, especifique cómo se desplegará la aplicación (para que el ID de la aplicación generada sea compatible con el implementación interno).

8. Seleccione "Sí. Tengo detalles sobre esta aplicación y planes de distribución".

9. Indique el número aproximado de dispositivos clientes.

10. Entonces seleccione la aplicación método implementación:

	- a través de un sitio web seguro (nuestro caso),

	- a través de una solución MDM (Mobile Device Management, es decir, una infraestructura para gestionar una flota de dispositivos móviles). 
			WINDEV Mobile le permite implementar este tipo de solución. Para obtener más información, consulte [Despliegue a través de un almacén privado](../Editeurs/1410086652.md).




11. A continuación, especifique cómo se asegurará el acceso a la aplicación:

	- a través de un mecanismo de login/contraseña,

	- forzando al usuario a conectarse a una INTRANET o a una VPN específica.




12. Por último, indique los usuarios previstos de la aplicación: 

	- empleados de la empresa,

	- contratistas.




13. No olvides marcar la casilla que confirma que toda la información proporcionada es correcta (al final de la página). 

14. Haz clic en "Continuar" para crear el ID de la aplicación.





### Etapa 3: Perfil de aprovisionamiento
<a name="etapa_3_perfil_aprovisionamiento_ELTPARAGRAPHE000121"></a>

Este paso debe completarse una sola vez para cada solicitud de distribución. 

Un perfil de aprovisionamiento es una description que vincula una aplicación (representada por su App ID) con un distribuidor (representado por una Certificate firmante). Se utiliza para compilar el paquete que se instalará en los dispositivos iOS.

Los perfiles de aprovisionamiento se crean en el sitio "Apple Developper".: 

1. En "Certificados, identificadores y perfiles", haga clic en "Perfiles" y "+" para crear un nuevo perfil,

2. Seleccione "In-House" en "Distribución" y haga clic en "Continuar",

3. En la lista desplegable, seleccione el ID de la aplicación creada para la misma y haga clic en "Continuar".

4. Elija la firma Certificate para usar. En el momento de la compilación, la solicitud debe ser firmada con la clave privada de esta Certificate (ver paso 5). Haga clic en "Continuar".
	Nota: Los usuarios de la aplicación deberán aceptar la clave pública antes de iniciar la aplicación en su iPhone/iPad (véase el paso 7).

5. Introduzca un nombre para el perfil de aprovisionamiento y haga clic en "Generar".

6. Haz clic en "Descargar" para descargar el perfil y haz doble clic en él para instalarlo en Xcode





### Etapa 4: Configuración del servidor web
<a name="etapa_4_configuracion_del_servidor_web_ELTPARAGRAPHE000139"></a>

Para permitir la instalación de aplicaciones internas, una solución sencilla es crear una página web con un enlace que apunte al archivo "manifest.plist" (que será generado por Xcode, en el paso 6).

La sintaxis de este enlace es la siguiente:

```txt
<a href="itms-services://?action=download-manifest&url=
https://wmshopping.precilia.com/manifest.plist" id="text">Download iOS application</a>
```


La Address del servidor web puede adaptarse según su configuración, y usted es libre de definir el texto en la etiqueta.

**MIME type**
Los servidores web no siempre saben cómo manipular archivos ".plist" y ".ipa".. Si estas extensiones son desconocidas para el servidor, la descarga no funcionará.

Para declarar estas extensiones en IIS, use el "Administrador de Servicios de Información de INTERNET (IIS)": 

1. Seleccione el servidor y haga clic en "Tipos de MIME" en la vista derecha (sección "IIS").

2. Si las extensiones ".ipa" y ".plist" no están declaradas en su servidor, añádalas haciendo clic en "Añadir..." (en el menú de la derecha de la ventana): 

	- la extensión ".ipa" es associated con el tipo MIME "application/octet-stream",

	- la extensión ".plist" es associated con el tipo MIME "application/x-plist".










### Etapa 5: Generación de la aplicación
<a name="etapa_5_generacion_aplicacion_ELTPARAGRAPHE000163"></a>

En WINDEV Mobile, inicia la generación de la aplicación iOS asistente: en la pestaña "Proyecto", en el grupo "Proyecto", haga clic en "Generar". 
Los principales pasos son los siguientes:  

- En el primer paso de la asistente, introduzca el ID del paquete de la aplicación. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Applestore_dep1.gif&type=thumb)



Atención: Debe utilizar el mismo Bundle ID especificado cuando se creó el App ID (paso 2).

- En el paso "Firma", especifique los diferentes ajustes de la firma.

	- **Si la cuenta de Apple para desplegar la aplicación está configurada en el Mac utilizado para la compilación**: En este caso, el gestor de cuentas de Apple da todos los permisos al desarrollador cuando compila en el Mac. WINDEV Mobile puede generar automáticamente los elementos necesarios para firmar la aplicación. Para ello, sólo tiene que introducir el identificador de su equipo (prefijo de ID de la aplicación o ID del equipo). Este identificador se muestra en la parte superior derecha de la Corner en todas las páginas del sitio para desarrolladores de Apple cuando está conectado. 
			Otra posibilidad: Puede hacer clic en "Importar" para seleccionar el archivo ".mobileprovision": el identificador del Equipo associated se importará y utilizará automáticamente. 

	- **Si la cuenta de Apple no está configurada en el Mac utilizado para la compilación**: En este caso, el gestor de cuentas de Apple no dará todos los permisos al desarrollador. WINDEV Mobile permite a los desarrolladores "Gestionar la firma manualmente". En este caso, debe importar el "Perfil de distribución" (archivo ".mobileprovision") y el "Perfil de desarrollo" (puede utilizar el mismo archivo ".mobileprovision", o un archivo diferente, dependiendo de su caso).

	- También puede rellenar los detalles de la firma directamente en XCode, en el Mac utilizado para la compilación. 


 Para más detalles sobre la firma de aplicaciones iOS, consulte [Firmar aplicaciones iOS](../Editeurs/1000019923.md). 

- Termina la asistente para generar el proyecto Xcode y la copy el resultado a tu Mac de compilación.







### Etapa 6: Compilación en Xcode
<a name="etapa_6_compilacion_xcode_ELTPARAGRAPHE000201"></a>

Para compilar su proyecto WINDEV Mobile en Xcode: 

1. Cargar el proyecto en Xcode. 

2. Seleccione el objetivo "Dispositivo genérico iOS" en la barra de herramientas. 

3. En el menú "Producto", seleccione "Archivo". 

4. Cuando la creación del archivo de software esté completa, haga clic en "Distribuir aplicación".

5. Para implementación interno, seleccione el método de distribución "Enterprise" y valídelo haciendo clic en "Siguiente"..
	Consejo: En las opciones de distribución, es posible reducir el tamaño del paquete si todos los dispositivos cliente son del mismo modelo. Para ello, elija el modelo en la lista desplegable "App Thinning". 
	Atención: no seleccione "Todas las variantes de dispositivos compatibles". Para una aplicación compatible con todas las variantes de dispositivos, seleccione "Ninguno" (opción Default)

6. Asegúrate de comprobar "Incluir el manifiesto para la instalación en el aire". 

7. Haga clic en "Siguiente".

8. Especifique los detalles en el manifiesto de implementación antes de validar ("Next"): 

	- Nom: especifique el nombre de la aplicación

	- URL de la aplicación: Especifique la Address en la que el paquete de instalación estará disponible. Este paquete es un archivo con extensión .ipa, y un acceso HTTPS es obligatorio.

	- Mostrar URL de Image: especificar la Address de una imagen de 57x57 píxeles que será utilizada como la instalación Icon para la aplicación. El protocolo debe ser HTTPS.

	- URL de Image en tamaño completo: especificar la Address de un Image de 512x512 píxeles que se utilizará como el Icon grande para la aplicación. El protocolo debe ser HTTPS.




9. Para la distribución interna, el paquete de instalación debe ser firmado de nuevo después de la generación. 
	En este paso, puede dejar que Xcode gestione la firma automáticamente (basándose en la información especificada en el perfil de aprovisionamiento).
	Si usted maneja el canto manualmente, un paso adicional requiere que usted confirme la firma Certificate a utilizar (creado en el paso 1) y el perfil de aprovisionamiento (creado en el paso 3).

10. Después de validar ("Siguiente"), Xcode construye el archivo de instalación de la aplicación, luego firma este archivo con la clave privada de la firma Certificate.
	Observación: esta operación puede llevar algún tiempo (varios minutos).

11. Una vez creado el archivo de distribución, Xcode propone exportar el resultado de la generación. Xcode genera entonces varios archivos en este directorio. Dos de ellos son necesarios para distribuir la aplicación:

	- manifiestos,

	- el archivo .ipa (nombre elegido en la creación del archivo asistente).


 Atención: si hay varios archivos .ipa en la exportación, significa que no se ha seleccionado correctamente una de las opciones anteriores: reinicie la generación de archivos, y asegúrese de que "Ninguno" está seleccionado en "App Thinning".

12. copy estos dos archivos al servidor Web (configurado en el paso 4) en la URL especificada durante la generación.







### Etapa 7: Instalación de la aplicación
<a name="etapa_7_instalacion_aplicacion_ELTPARAGRAPHE000239"></a>

Para instalar la aplicación en un iPhone/iPad: 

1. Abre la página de Safari y haz clic en el enlace de instalación.

2. Safari mostrará un cuadro de confirmación indicando que el sitio web quiere instalar una aplicación: ...haga clic en "Instalar".




La primera vez que se lanza la aplicación, puede aparecer un mensaje de error que indica que la empresa que firmó esta aplicación no es de confianza para el usuario. 
Confiar en una Certificate en un dispositivo:

1. Ve a "Ajustes", "General",

2. Toca "Perfiles y Manejo de Dispositivos",

3. Toca el nombre de la firma Certificate en "Enterprise App" (esta es la Certificate que se creó en el primer paso),

4. Toca "Confianza..." y valídalo.


Entonces será posible instalar y ejecutar todas las aplicaciones internas firmadas por este desarrollador (es decir, con la misma firma Certificate) en este dispositivo.




### Etapa 8: Emulando Xcode (opcional)
<a name="etapa_8_emulando_xcode_opcional_ELTPARAGRAPHE000259"></a>

Puede emular Xcode a través de líneas de comando para desencadenar la generación a través de la programación (por ejemplo en SSH desde un plan de acción en la Fábrica de Software).

Las principales líneas de mando de useful en este caso son:

- Limpiar el caché de compilación: 
	
	```txt
	xcodebuild clean
	```


- Archivo: 
	```txt
	xcodebuild -scheme <my_scheme>-sdk iphoneos-archivePath <archive_path> archive
	```

	Los parámetros son los siguientes:

	- &lt;mi_esquema&gt;: de un esquema de proyecto (ver los esquemas de su aplicación en Xcode).

	- &lt;ruta_archivo&gt;: ruta de destino.




- IPA construir: 
	
	```txt
	xcodebuild -exportArchive-archivePath <my_scheme>.xarchive
	-exportOptionsPlist exportOptions.plist-exportPath <export_path>
	```

	Los parámetros son los siguientes:

	- &lt;mi_esquema&gt;: valor de un esquema de proyecto.

	- &lt;export_ruta&gt;: ruta de destino.





Para más detalles sobre xcode build y el comando Line, por favor, consulta la documentación de Apple: "[https://developer.apple.com/library/archive/technotes/tn2339/_index.html](https://developer.apple.com/library/archive/technotes/tn2339/_index.html)".


