


## Personalizar el programa instalación (Plug-in)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000349"></a>
En un programa de instalación, puede que quieras personalizar algunas acciones, añadir pasos a la asistente, añadir nuevos procesos, etc.

Hasta la versión 21, había que modificar el código fuente del programa instalación utilizando el proyecto "WDSetup" suministrado con el producto. Para cada nueva versión, las modificaciones debían aplicarse a la nueva versión de WDSetup. Para obtener más información, consulte [Modificación de WDSetup para gestionar idiomas adicionales](../Editeurs/2028037.md). 

En la versión 21, tiene la posibilidad de crear un plug-in y modificar el programa estándar de instalación. Este plug-in se crea a partir del ejemplo "WD WDSETUP Plugin" suministrado con WINDEV. 

Esto le permite beneficiarse de las evoluciones de la instalación estándar mientras realiza las personalizaciones. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## ¿Cómo proceder?
<a name="¿como_proceder_ELTTEXTE000373"></a>


### Principio
<a name="principio_ELTPARAGRAPHE000027"></a>

1. [Abrir el proyecto "WD WDSETUP Plugin](#NOTE2_2). 

2. [Modificar el proyecto](#NOTE2_3). 

3. [Generar biblioteca](#NOTE2_4). 

4. [Modificar el programa instalación de su aplicación](#NOTE2_5). 




Observación: Vaya a [Interacciones con el plug-in según los tipos de instalación](#NOTE3_1) para ver el orden de ejecución de los procedimientos en función del tipo de instalación. 
<a name="NOTE2_2"></a>


### 1. Apertura del proyecto "WD WDSETUP Plugin
<a name="1_apertura_del_proyecto_wdsetup_plugin_ELTPARAGRAPHE000050"></a>

1. Abrir el proyecto "WD WDSETUP Plugin. Este proyecto está disponible en los ejemplos de formación de WINDEV. 
	Observación: Le aconsejamos que realice una copia de seguridad copy de este ejemplo para personalizarlo sin riesgo de sobrescribirlo al instalar una nueva versión. 

2. Este proyecto de ejemplo se utiliza para crear un plugin de ejemplo: asociar el archivo WDINFO con la aplicación. 

3. Este proyecto contiene: 

	- **Una ventana interna llamada "IW_INSTALLCUSTOMPLANE".**. Esta ventana interna corresponde a la nueva información mostrada por el plug-in. Cada plano de la ventana interna corresponde a un nuevo paso de la asistente. Para ver los diferentes planos en el editor, pulse [Re Pág] o [Av Pág]. El primer plano corresponde al ejemplo (asociando el archivo WDINFO con la aplicación). 

	- **A set de procedimientos llamados "set_WDset UPPLUGIN"**. Esta set de procedimientos contiene el prototipo de procedimientos a modificar para el plug-in. 

	- **A set de procedimientos llamados "set_SHELL_ASSOCIATION"**. Esta set de procedimientos contiene los procedimientos utilizados por el ejemplo del plug-in.  






<a name="NOTE2_3"></a>


### 2. Adaptación del proyecto "WD WDSETUP Plugin
<a name="2_adaptacion_del_proyecto_wdsetup_plugin_ELTPARAGRAPHE000071"></a>

Para crear un plug-in, el proyecto debe contener: 

- El set de procedimientos llamado "set_WDset UPPLUGIN". 

- Una ventana interna. 

- Una set de procedimientos que contiene los procedimientos de enchufe. 




**Conjunto de procedimientos "SET_WDSETUPPLUGIN"**

La set de procedimientos llamada "set_WDset UPPLUGIN" contiene el prototipo de funciones que serán llamadas por el programa principal de instalación. El nombre de estas funciones no debe modificarse.

El código de estas funciones debe ser llenado de acuerdo a la Process que se agregará al plugin.

Estas funciones son (en orden alfabético): 

- **Antes deAutoModif**: Procedimiento llamado antes de la modificación de los datos de automatic. 

- **Después de AutoModificar**: Procedimiento llamado después de la modificación de datos de automatic.

- **Antes de la instalación**: Procedure llamó al iniciar la instalación.

- **Después de la instalación**: Procedure se llama así por la instalación.

- **Inicio**: Procedure para inicializar el plug-in, llamado al iniciar la instalación.

- **Antes de la carga**: Procedimiento llamado antes de enviar por FTP (HTTP reference instalación). 

- **Después de la carga**: Llamada a Procedure tras el envío por FTP (HTTP reference instalación).

- **sCustomPlane**: Procedure solía declarar una ventana interna para mostrar en el instalación asistente.
	Este Procedure debe:

	- devuelve una cadena vacía si no hay ninguna ventana interna que mostrar,

	- devolver el nombre de la ventana interna a mostrar durante la llamada al plugin ("IW_INSTALLCUSTOMPLANE" en el ejemplo). 







Para ver el orden de ejecución de las funciones según el tipo de instalación, vaya a [Interacciones con el plug-in según los tipos de instalación](#NOTE3_1). 



**La ventana interna**

Esta ventana interna contiene los diferentes pasos personalizados de la instalación asistente. Cada nuevo paso corresponde a un plano de la ventana interna. Los planos de esta ventana interna se mostrarán en la instalación asistente, antes del paso de finalización de la instalación. 
El nombre de esta ventana interna no es importante. Debe ser usado en el **sCustomPlane** Procedure. 
La ventana interna debe contener:

- uno o más planos. Estos planos corresponden a la información mostrada por el plug-in. 

- 3 procedimientos locales. Estos procedimientos locales se utilizan para gestionar la inicialización de planos, realizar comprobaciones e indicar la secuencia de planos.. Los 3 procedimientos deben respetar los siguientes prototipos:  

	- **Init**: Procedure utilizaba para inicializar los controles que se encontraban en los diferentes aviones. 

	- **bControl**: Procedure solía validar (o no) el paso al siguiente plano (secuencia de planos.

	- **nNextPlane**: Procedure solía devolver el número del avión a mostrar (avión 1 de Default).






<a name="NOTE2_4"></a>


### 3. Generación de la biblioteca de proyectos "WD WDSETUP Plugin
<a name="3_generacion_biblioteca_proyectos_wdsetup_plugin_ELTPARAGRAPHE000128"></a>

Para generar la biblioteca del proyecto, en la pestaña "Proyecto", en el grupo "Generación", haga clic en "Generar". La creación de la biblioteca asistente comienza. Siga los diferentes pasos de la asistente. La biblioteca se genera en el directorio Exe del proyecto. 
<a name="NOTE2_5"></a>


### 4. Modificando el programa instalación
<a name="4_modificando_programa_instalacion_ELTPARAGRAPHE000147"></a>

Para incluir el plug-in: 

1. Abrir el proyecto deseado en WINDEV. 

2. Iniciar la creación del programa instalación asistente: en la pestaña "Proyecto", en el grupo "Generación", despliegue "Procedimiento de instalación" y seleccione "Crear procedimiento de instalación". 

3. Crear el ejecutable y seguir los diferentes pasos de la asistente. 

4. En el paso "Setup media", haga clic en el botón "Opciones avanzadas del instalador".. 

5. En la ventana que se muestra, muestre la pestaña "Plug-in" y seleccione el archivo correspondiente a la biblioteca de plug-ins que se ha creado previamente (archivo wdl).. 

6. Fin de la creación del programa instalación asistente. 




Observación: Las características del plug-in también se pueden definir en el editor de instalación WDInst ("Parámetros de configuración .. Opciones del instalador"). 

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Interacciones con el plug-in según los tipos de instalación
<a name="interacciones_con_plugin_segun_los_tipos_instalacion_ELTTEXTE000421"></a>
Este párrafo presenta las diferentes interacciones entre la instalación y el plug-in. Los tipos de instalación disponibles son los siguientes: 

- [Instalación simple.](#NOTE3_2)

- [Configuración con actualización de automatic en la red local.](#NOTE3_3)

- [Configuración con actualización de automatic por HTTP.](#NOTE3_4)

- [Configuración con actualización de automatic en 2 niveles (HTTP y luego LAN).](#NOTE3_5)



<a name="NOTE3_2"></a>


### Instalación simple
<a name="instalacion_simple_ELTPARAGRAPHE000191"></a>

Los pasos para crear e instalar una aplicación con instalación simple son los siguientes: 

- **Creación de la configuración asistente/WDInst**

	1. Elección de las diferentes opciones: directorios, herramientas, modificación de datos de automatic, ...

	2. Posibilidad de añadir un plug-in de personalización a través de una librería (.wdl) basado en el proyecto "WD WDSETUP Plugin" (opcional). 

	3. Generando instalación. 




- **Iniciando la instalación en la computadora del usuario** 

	1. Si se utiliza el plug-in, llamar al método "Startup".. 

	2. Mostrando el primer paso de la instalación (primer plano). 

	3. Mostrando los diferentes pasos de la instalación (planos correspondientes a los directorios de destino, ...). 

	4. Si se utiliza el plug-in, llame al método "sCustomPlane".. 
			En el caso de los planos personalizados, la ventana interna llama a los procedimientos "Init", "bControl" y "nNextPlane".

	5. En caso de sincronización de los datos desplegados (SDD/Modificación automática): 

		- Si se utiliza el plug-in, llamar al método "BeforeAutoModif".. 

		- Inicio de la sincronización de los datos implementados (SDD/Modificación automática). 

		- Si se utiliza el plug-in, llamar al método "AfterAutoModif".. 




6. Si se utiliza el plug-in, llame al método "BeforeInstall".. 

7. Instalación de la actualización de la aplicación

8. Si se utiliza el plug-in, llame al método "AfterInstall".. 

9. Actualizar el registro si es necesario. 

10. Actualizar el archivo ini si es necesario. 

11. Iniciar el ejecutable al final de instalación si se solicitó esta opción. 



<a name="NOTE3_3"></a>


### Configuración con actualización de automatic en la red local
<a name="configuracion_con_actualizacion_automatic_red_local_ELTPARAGRAPHE000223"></a>

Los pasos para crear e instalar una aplicación con la actualización de automatic en la red local son los siguientes: 

- **Creación de la configuración asistente/WDInst**

	1. Elección de las diferentes opciones: directorios, herramientas, modificación de datos de automatic, ...

	2. Posibilidad de añadir un plug-in de personalización a través de una librería (.wdl) basado en el proyecto "WD WDSETUP Plugin" (opcional). 

	3. Generación de instalación.




- **Iniciando la instalación para actualizar el servidor local de reference**

	1. Si se utiliza el plug-in, llamar al método "Startup".. 

	2. Mostrando el primer paso de la instalación (primer plano). 

	3. Mostrando los diferentes pasos de la instalación (planos correspondientes a los directorios de destino, ...). 

	4. Si se utiliza el plug-in, llame al método "sCustomPlane".. 
			En el caso de los planos personalizados, la ventana interna llama a los procedimientos "Init", "bControl" y "nNextPlane".

	5. En caso de sincronización de los datos desplegados (SDD/Modificación automática): 

		- Si se utiliza el plug-in, llamar al método "BeforeAutoModif".. 

		- Inicio de la sincronización de los datos implementados (SDD/Modificación automática). 

		- Si se utiliza el plug-in, llamar al método "AfterAutoModif".. 




6. Si se utiliza el plug-in, llame al método "BeforeInstall".. 

7. Instalando la actualización de la versión de reference.

8. Si se utiliza el plug-in, llame al método "AfterInstall".. 

9. Actualizar el registro si es necesario. 

10. Actualizar el archivo ini si es necesario. 

- **Iniciar el reference instalación en el ordenador del usuario** (o pulsar o actualizar la aplicación): consulte ["Instalación simple"](#NOTE3_2). 



<a name="NOTE3_4"></a>


### Configuración con actualización de automatic por HTTP
<a name="configuracion_con_actualizacion_automatic_por_http_ELTPARAGRAPHE000258"></a>

Los pasos para crear e instalar una aplicación con la actualización de automatic por HTTP son los siguientes: 

- **Creación de la configuración asistente/WDInst**

	1. Elección de las diferentes opciones: directorios, herramientas, modificación de datos de automatic, ...

	2. Posibilidad de añadir un plug-in de personalización a través de una librería (.wdl) basado en el proyecto "WD WDSETUP Plugin" (opcional). 

	3. Generación de instalación.




- **Iniciando la instalación para actualizar el servidor HTTP de reference**

	1. Si se utiliza el plug-in, llamar al método "Startup".. 

	2. Visualización del paso (plano) para actualizar el servidor HTTP por FTP. 

	3. Subir la actualización en el servidor HTTP de reference. 

	4. Si se utiliza el plug-in, llame al método "AfterInstall".. 




- **Arrancar el HTTP instalación desde el ordenador de usuario** (o actualización de la aplicación): consulte ["Instalación simple"](#NOTE3_2). 



<a name="NOTE3_5"></a>


### Configuración con actualización de automatic en 2 niveles (HTTP y luego LAN)
<a name="configuracion_con_actualizacion_automatic_2_niveles_http_luego_lan_ELTPARAGRAPHE000281"></a>

Los pasos para crear e instalar una aplicación con la actualización de automatic en 2 niveles (HTTP y luego LAN) son los siguientes: 

- **Creación de la configuración asistente/WDInst**

	1. Elección de las diferentes opciones: directorios, herramientas, modificación de datos de automatic, ...

	2. Posibilidad de añadir un plug-in de personalización a través de una librería (.wdl) basado en el proyecto "WD WDSETUP Plugin" (Opcional). 

	3. Generación de instalación.




- **Iniciando la instalación para actualizar el servidor HTTP de reference**

	1. Si se utiliza el plug-in, llamar al método "Startup".. 

	2. Visualización del paso (plano) para actualizar el servidor HTTP por FTP. 

	3. Si se utiliza el plug-in, llame al método "BeforeInstall".. 

	4. Si se utiliza el plug-in, llame al método "BeforeUpload".. 

	5. Subir la actualización en el servidor HTTP de reference. 

	6. Si se utiliza el plug-in, llame al método "AfterUpload".. 

	7. Si se utiliza el plug-in, llame al método "AfterInstall".. 




- **Arrancar el HTTP instalación desde un servidor de referencia local** (o actualizar automatic a través de la tarea programada si ya está instalado): consulte ["Configuración con la actualización de automatic en la red local"](#NOTE3_3). 





