


## Creación de un ensamblaje.NET a partir de WINDEV
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000219"></a>
Antes de crear un ensamblaje.NET, hay que comprobar que el [configuración del ordenador de desarrollo](../Editeurs/2012006.md).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Creación de un ensamblaje.NET a partir de un proyecto WINDEV
<a name="creacion_ensamblajenet_partir_proyecto_windev_ELTTEXTE000243"></a>
Para crear un ensamblaje.NET:

1. Abra el proyecto WINDEV a partir del cual se debe crear el ensamblaje.NET.
	Este proyecto debe contener todos los elementos requeridos por el ensamblaje.NET. Este proyecto puede contener, por ejemplo, uno o más procedimientos globales y/o clases, que contengan varios métodos. Estos métodos y/o procedimientos serán los puntos de entrada de la asamblea.
	**Observación**: Los ensamblajes.NET destinados a ser utilizados en otros entornos deben estar documentados.. Esta documentación es generada automáticamente por WINDEV.

2. En los botones de acceso rápido, seleccione el modo de generación "Generar un ensamblaje .NET": <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ico_generation_NET.gif)

	**Observación**: Si no se ha creado una configuración de proyecto específica para la creación de un ensamblaje .NET, la asistente para crear una configuración de proyecto se inicia. Para optimizar la organización de sus proyectos, le aconsejamos que utilice las configuraciones de proyecto. Para obtener más información, consulte [Configuración del proyecto](../Editeurs/9000030.md). 
	En este caso, la asistente solicita:

	- el nombre y la descripción de la configuración de proyecto. 

	- los elementos incluidos en la configuración del proyecto. 
			Entonces, la asistente para generar un ejecutable .NET se inicia.




3. Comienza la asistente para la creación de un ensamblaje .NET.

4. Especifique las propiedades del ensamblaje.NET que se creará: nombre de archivo, empresa, description, derechos de autor, ... 
	El botón "Advanced" se utiliza para definir las propiedades adicionales específicas del ensamblaje.NET.

5. Especifique el número de versión. Hay dos formatos disponibles para los números de versión:

	- **Formato estándar.** Este formato es el formato estándar gestionado por Windows. Este formato corresponde a una set de 4 números separados por puntos. 

		- El primer grupo de 4 dígitos corresponde al número de cambios importantes realizados en la aplicación.

		- El segundo grupo de 4 dígitos corresponde al número de cambios menores realizados en la aplicación.

		- El tercer grupo de 4 dígitos corresponde al número de generación. 
						Le aconsejamos que incremente automáticamente este número en cada generación. Esta operación de incremento se realiza automáticamente si se selecciona la opción "Incrementar automáticamente la versión en cada generación".

		- El último grupo de 4 dígitos corresponde al número de revisiones (ramas en la SCM por ejemplo).
						




- **Formato para la compatibilidad.** Este formato se utilizó hasta la versión 12 para las aplicaciones WINDEV.
			**Observación**: Todos los caracteres (dígitos y letras) están permitidos. Por ejemplo: "1.01A".
			Si se selecciona "Incrementar automáticamente la versión en cada generación", el número de versión se modificará en cada generación.: el número de versión "1.01A" se convertirá en "1.01B" y el número de versión "A14Z" en "A15A".

6. Seleccione los diferentes elementos WINDEV (proyecto, ventanas, clases,...) que se incluirán en el ensamblaje.NET.

	- El botón "Add" se utiliza para añadir un elemento al ensamblaje.NET: imágenes, archivos de texto, etc.

	- El botón "Eliminar" se utiliza para eliminar un elemento del ensamblaje.NET. Los archivos correspondientes y sus dependencias no se incluirán en el ensamblaje.NET.

	- El botón "WDU" permite visualizar los elementos encontrados en una biblioteca creada previamente..
			**Observación**: Si se selecciona el proyecto WINDEV (archivo".WDP"):

		- el análisis del proyecto será associated con el ensamblaje del .NET.

		- la inicialización Process del proyecto se ejecutará cuando se inicialice el ensamblaje .NET.

		- el final Process del proyecto se ejecutará al cerrar el montaje .NET.




7. Seleccione las clases WINDEV (archivos".WDC") y los conjuntos de procedimientos (archivo".WDG") que serán accesibles.. Estas clases y estos conjuntos de procedimientos pueden ser manejados desde la aplicación que utilizará el ensamblado.NET.
	Una clase pública del conjunto debe tener un constructor sin parámetro (o con parámetros opcionales).
	Todas las clases que se instancian en una clase pública del conjunto también deben ser públicas..
	**Observación**: Se genera una clase .NET con el nombre de la set de procedimientos. Esta clase.NET contiene:

	- una función estática correspondiente a cada función de la set de procedimientos.

	- un miembro estático que corresponde a cada variable de los procedimientos de la set de WINDEV.




8. Seleccione la versión de .NET Framework que desea utilizar, así como el Framework WINDEV (32 bits o 64 bits) que se suministrará con el ensamblaje.NET.. Seleccione las librerías del Framework WINDEV necesarias para el funcionamiento de su ensamblador. 
	Observaciones:

	- Las bibliotecas de WINDEV Framework correspondientes a .NET (wd28 0netx.dll, por ejemplo) no pueden renombrarse.

	- Se deben utilizar algunas configuraciones de proyecto si el mismo proyecto permite generar varias versiones del mismo ensamblaje.

	- Deben generarse dos ensamblados .NET en WINDEV si un ensamblado .NET debe ejecutarse en una versión de 32 bits y otra de 64 bits. El mismo ensamblado no puede ejecutarse en versiones de 32 y 64 bits.




9. Configure el mensaje de error si es necesario. Este mensaje se mostrará si se produce un error al utilizar el ensamblaje.NET.. 
	El botón "Default" permite configurar un mensaje de error de Default.

10. Seleccione las opciones específicas del conjunto:

	- El **"Opciones de compilación"** se utiliza para seleccionar un compilador de C# específico y para especificar algunas opciones de compilación adicionales.

	- El **"Propiedades avanzadas"** se utiliza para definir si el ensamblaje.NET debe ser accesible por un programa que utilice la tecnología COM. Para obtener más información, consulte [Creación de un ensamblado .NET accesible mediante COM](../Editeurs/2012003.md).




11. Valide.




El ensamblaje .Net se genera en el directorio EXE del proyecto así como un XML Document que contiene el Document ation sobre el ensamblaje.

**Observaciones**: 

- Los ensamblajes generados por WINDEV pueden ser utilizados como cualquier otro ensamblaje.NET. Sin embargo, el WINDEV framework y el ensamblaje deben encontrarse en el mismo directorio.

- Limitación: Los informes y las consultas no funcionan en los ensamblajes.NET.

- Los ensamblajes .Net generados por WINDEV tienen un único contexto de ejecución: por lo tanto, pueden ser dirigidas por un solo Thread. 




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Generación de clases C# a partir de clases WINDEV
<a name="generacion_clases_partir_clases_windev_ELTTEXTE000267"></a>


### Consejos para optimizar el código de las clases
<a name="consejos_para_optimizar_codigo_las_clases_ELTPARAGRAPHE000117"></a>

A continuación se presentan consejos para optimizar el código de las clases generadas. En tus clases de WINDEV:

- Escriba los parámetros de los métodos y los valores de retorno.

- Utilice la palabra clave "LOCAL" para que los parámetros de los métodos no sean parámetros de "Entrada/Salida".

- Reemplace las palabras reservadas de C#.

- Elimina las múltiples herencias.



<a name="NOTE4_2"></a>


### Tipos de parámetros y tipos de valores de retorno
<a name="tipos_parametros_tipos_valores_retorno_ELTPARAGRAPHE000129"></a>

Los tipos disponibles son los de WLanguage.

Si los tipos de parámetros no están especificados en el prototipo del método, son definidos automáticamente por WINDEV.. En este caso, el generador del ensamblaje.NET utiliza el tipo "Object".
<a name="NOTE4_3"></a>


### "Parámetros de"Entrada/Salida
<a name="parametros_deentradasalida_ELTPARAGRAPHE000138"></a>

Si la palabra clave LOCAL no se utiliza en la declaración de parámetros en el prototipo de función, el parámetro se considera en "Entrada/Salida" (el generador de ensamblaje utiliza la palabra clave "ref").
<a name="NOTE4_4"></a>


### Consecuencia: un código ensamblador más fácil
<a name="consecuencia_codigo_ensamblador_mas_facil_ELTPARAGRAPHE000145"></a>

Cuando se exporta una clase estándar de WLanguage, todos los parámetros son no mecanografiados y están en Input/Output.

**Si no se realizan las optimizaciones mencionadas de Above, el generador de ensamblaje genera funciones que aceptan parámetros de "objeto ref", lo que hace que el programa que utiliza el ensamblaje sea más complejo.**

De hecho, para pasar un parámetro "ref object" a una función (en C# por ejemplo), debe hacerlo:

1. Cree un "objeto".

2. Copie el tipo Variable de C# en este "objeto".

3. Pasa por reference un "Objeto" en parámetro al método de la clase WLanguage.




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Creando el programa instalación de un ensamblaje .NET
<a name="creando_programa_instalacion_ensamblaje_net_ELTTEXTE000309"></a>
El programa instalación para el ensamblaje de a.NET se crea como cualquier otro programa instalación para una aplicación estándar de WINDEV.

Para crear el programa instalación de un ensamblado .NET: 

1. En los botones de acceso rápido, seleccione el modo de generación "Crear la instalación Procedure del conjunto": <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ico_generation_NET.gif)


2. Siga las instrucciones dadas por la asistente.




**Observación**: Los ensamblajes generados por WINDEV pueden ser utilizados como cualquier otro ensamblaje.NET. Sin embargo, el WINDEV framework y el ensamblaje deben encontrarse en el mismo directorio.




