


## Creación de una consulta en código SQL
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000182"></a>
<a name="SQL_query"></a>
El editor de consultas también le permite crear una consulta escribiendo código SQL (si está familiarizado con este lenguaje).|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ER.png) | Importante | [Reports & Queries](../Presentation/3088004.md)no puede utilizarse para crear consultas en código SQL utilizando los comandos [INSERTAR](../Editeurs/2034001.md), [ACTUALIZACIÓN](../Editeurs/2034001.md) o [BORRAR](../Editeurs/2034001.md). |



Para más detalles sobre el SQL, véase la página web de [Comandos SQL disponibles en una consulta SQL](../Editeurs/2034006.md).


<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## ¿Cómo proceder?
<a name="¿como_proceder_ELTTEXTE000230"></a>


### Creación de una consulta en código SQL
<a name="creacion_una_consulta_codigo_sql_ELTPARAGRAPHE000039"></a>

Para crear una consulta en código SQL: 

1. Haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ico_nouveau.gif) en los botones de acceso rápido. 

	- Aparece la ventana de creación: haga clic en "Consulta".

	- El asistente de creación de consultas se abre.




2. Especifique que desea crear una consulta introduciendo el código SQL directamente (opción"Código SQL").

3. Si su proyecto es relacionado a ningún análisis, especifique el análisis al que se adjuntará la consulta.
	Valide la pantalla de asistente.

4. Escriba el nombre de la consulta (nombre del archivo ".WDR" correspondiente a la consulta). Este nombre se utilizará para identificar la consulta en sus programas.

5. Especifique el título de la consulta describiendo brevemente el propósito de la consulta. Este epígrafe se utilizará en la documentación del proyecto..
	Observación: El nombre de la consulta se define automáticamente a partir de la leyenda escrita.

6. Validar la creación de la consulta. Aparece una ventana de código.

7. Escriba el código SQL de su consulta. Puede insertar en la consulta:

	- **comentarios** escribiendo el carácter "--" o "//" delante de ellos. Durante la ingeniería inversa de la consulta sólo se tendrán en cuenta los comentarios sobre las condiciones de selección.: los otros comentarios serán borrados automáticamente. Los comentarios sobre las condiciones de selección con parámetros no aparecerán cuando se pruebe la consulta (mediante "GO").

	- **Funciones WLanguage**. Las funciones WLanguage deben ir precedidas por "WL.". La entrada asistida está disponible. Las funciones de WLanguage pueden ser anidadas. Ejemplo: 
			
		```sql
		SELECT Customer.CustomerNum FROM Customer
		WHERE WL.Left(Customer.ZipCode,2)=75
		```

			![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) No se pueden ejecutar consultas con código SQL que contengan funciones de WLanguage. 




8. Guarde el código SQL (![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ico_Enregistrer.gif)).




Observación: Al hacer clic en un identificador (nombre de archivo, nombre de elemento, nombre de parámetro) en el código SQL de la consulta, se destacan todas las apariciones de este identificador. 
<a name="NOTE2_2"></a>


### Ingeniería inversa de consulta en código SQL
<a name="ingenieria_inversa_consulta_codigo_sql_ELTPARAGRAPHE000079"></a>

El retroanálisis de la consulta en código SQL permite representar gráficamente la consulta a partir de los archivos de datos encontrados en el código SQL y en el análisis del proyecto.

Para realizar la ingeniería inversa de una consulta en código SQL:

1. Mostrar código SQL de la consulta.

2. Para crear una representación gráfica de la consulta, en la pestaña "Consulta", en el grupo "Analizar", haga clic en "Ingeniería Inversa".




**Limitaciones**:

- Esta función está disponible para las consultas SELECT, UPDATE, DELETE e INSERT.

- Las subconsultas no se importan.

- No se admiten consultas de consultas.  

- Las consultas UNION no son compatibles.

- Esta característica sólo está disponible si los comandos SQL utilizados en la consulta son reconocidos por el motor HFSQL.. Para obtener más información, consulte [Comandos SQL disponibles en una consulta SQL](../Editeurs/2034006.md).




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Modos de ejecución de una consulta en código SQL
<a name="modos_ejecucion_una_consulta_codigo_sql_ELTTEXTE000260"></a>
El editor de consultas permite ejecutar fácilmente consultas en código SQL. Estas consultas pueden ser:

- escrito en el editor de consultas. A continuación, la consulta se ejecuta con [HExecuteQuery](../WDLang4/3044080.md).

- escrito directamente en la función [HExecuteSQLQuery](../WDLang4/3044084.md) en el editor de código.




**Existen dos modos de ejecución para las consultas SQL**:

- **Ejecución de una consulta SQL mientras se comprueba el código SQL**: Esta opción está disponible en Default para todas las consultas SQL ejecutadas desde WINDEV. El código SQL de la consulta debe utilizar los siguientes comandos. En este caso, el motor HFSQL comprueba el código SQL de la consulta.

- **Ejecución de una consulta SQL sin comprobar el código SQL** (con la constante *hQueryWithoutCorrection*): Esta opción se recomienda para las consultas ejecutadas a través de un acceso nativo o OLE DB. En este caso, el motor HFSQL no comprueba la consulta. Esta opción debe utilizarse si la consulta contiene comandos específicos de un tipo de conexión (Oracle, SQL Server, etc.). Se pueden utilizar todos los comandos SQL soportados por la base de datos a la que se ha accedido.




**Observación**: La constante *hQueryWithoutCorrection* también está disponible al probar una consulta desde el editor de consultas:

- **para una consulta de selección**: haga clic en "Avanzado" en la ventana de descripción y marque "Ejecutar con hQueryWithoutCorrection en modo de prueba" en la pestaña "hQueryWithoutCorrection".

- **para una consulta de inserción, una consulta de actualización o una consulta de eliminación**: vaya a la pestaña "General" de la ventana de descripción y marque "Ejecutar hQueryWithoutCorrection en modo de prueba".





