


## Creación de una consulta combinada
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000148"></a>
<a name="Combining_query"></a>
A ***combinando query*** (declaración SQL correspondiente: [UNION](../Editeurs/2034004.md)) se utiliza para combinar varias consultas selectas. Cada consulta seleccionada debe basarse en archivos de datos de estructura idéntica.

Por ejemplo, seleccione los clientes cuyo apellido comienza con la letra 'A' y los clientes potenciales que viven en París.. Para realizar esta selección, se deben combinar las dos consultas siguientes:

- seleccionar los clientes cuyo apellido empieza por la letra 'A'.. Esta consulta se basa en el archivo de datos del "Cliente".

- seleccionando a los prospectos que viven en Londres. Esta consulta se basa en el archivo de datos de "Prospect".




Los archivos de datos "Cliente" y "Prospecto" tienen la misma estructura en el análisis.

Los registros que son comunes a ambos archivos de datos ("Cliente" y "Prospecto") pueden:

- aparecen una sola vez en el resultado de la consulta (operador [UNION](../Editeurs/2034004.md))

- aparecen dos veces en el resultado de la consulta (operador [UNION ALL](../Editeurs/2034004.md))




Para combinar consultas, debe saber:

- el nombre de las consultas a combinar.

- si los registros comunes deben aparecer una o varias veces en el resultado de la consulta.




**Observación**: Los elementos que aparecen en el resultado de la consulta combinada corresponden a los elementos de la primera consulta realizada. Por lo tanto, en nuestro ejemplo, las personas que son tanto clientes como clientes potenciales, cuyo nombre comienza con la letra 'A' y que viven en Londres sólo aparecerán una vez en el resultado de la consulta.. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Requete_RequeteComposee.gif)
 El editor de consultas genera automáticamente el código SQL de esta consulta. 

**Para ver el código SQL de una consulta**: 

1. Abrir el menú contextual del gráfico de consulta.

2. Seleccione "Código SQL".




También tiene la posibilidad de presionar la tecla F2. 

Por ejemplo:


```sql
SELECT 
	CUSTOMER.CustomerName AS CustomerName
FROM 
	CUSTOMER
WHERE 
	CUSTOMER.CustomerName LIKE 'A%'

UNION

SELECT 
	PROSPECT.CustomerName AS CustomerName
FROM 
	PROSPECT
WHERE 
	PROSPECT.CITY = 'London'
```
Para que las personas que son a la vez cliente y cliente potencial, cuyo apellido comienza con la letra 'A' y que viven en Londres, aparezcan varias veces en el resultado de la consulta, el código SQL debe ser: 


```sql
SELECT 
	CUSTOMER.CustomerName AS CustomerName
FROM 
	CUSTOMER
WHERE 
	CUSTOMER.CustomerName LIKE 'A%'

UNION ALL

SELECT 
	PROSPECT.CustomerName AS CustomerName
FROM 
	PROSPECT
WHERE 
	PROSPECT.CITY = 'London'
```


<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## ¿Cómo proceder?
<a name="¿como_proceder_ELTTEXTE000172"></a>
Para crear una nueva consulta combinada:

1. Haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ico_nouveau.gif) en los botones de acceso rápido. 

	- En la ventana que se muestra, haga clic en "Query".

	- El asistente de creación de consultas se abre.




2. Elija "Unión" y valide.

3. Si su proyecto es relacionado a ningún análisis, especifique el análisis al que se adjuntará la consulta.

4. La ventana de descripción de la consulta se abre.

5. Introduzca el nombre y el título de la consulta.

6. Seleccione las diferentes consultas a combinar (casilla izquierda).

7. Seleccione esta opción para guardar o eliminar los registros comunes a las consultas combinadas (botón"Guardar los duplicados/Borrar los duplicados").

8. Ordene el resultado de la consulta si es necesario (botón"Ordenar").

9. Valide la ventana de descripción de la consulta. La representación gráfica de la consulta se muestra automáticamente en el editor de consultas.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Notas
<a name="notas_ELTTEXTE000196"></a>


- Para modificar las características de una consulta, en la pestaña "Consulta", en el grupo "Edición", haga clic en "Descripción". Para obtener más información, consulte [Descripción de una consulta](../Editeurs/2032038.md).

- Para generar el código SQL correspondiente a esta consulta, seleccione "Código SQL" en el menú contextual de la consulta. Si se realizan cambios en la consulta description, estos cambios se reflejarán automáticamente en el código SQL correspondiente.





