


## Dos métodos para pasar parámetros a una consulta
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000172"></a>
<a name="Two_methods"></a>
Se pueden utilizar dos métodos para pasar parámetros a una consulta con parámetros utilizados en una ventana o en una control (List Box, Combo Box o control Tabla por ejemplo):

- pasar los parámetros en [HExecuteQuery](../WDLang4/3044080.md).

- utilice *&lt;nombre de la consulta&gt;.&lt;nombre del parámetro&gt;*, luego [HExecuteQuery](../WDLang4/3044080.md).




Esta página de ayuda presenta el modo de funcionamiento y las ventajas de cada uno de estos métodos.

**Observación**: El método para pasar parámetros difiere si la consulta con parámetros se utiliza en un reporte. Para obtener más información, consulte [Cómo utilizar una consulta con parámetros en una reporte](../Editeurs/2032032.md).



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Usando HExecuteQuery para pasar parámetros a una consulta
<a name="usando_hexecutequery_para_pasar_parametros_una_consulta_ELTTEXTE000202"></a>


### Sintaxis a utilizar
<a name="sintaxis_utilizar_ELTPARAGRAPHE000037"></a>

Cuando una consulta es ejecutada por [HExecuteQuery](../WDLang4/3044080.md), los últimos parámetros pasados a la función corresponden a los parámetros de la consulta.

Se utiliza la siguiente sintaxis:


```txt
<Result> = HExecuteQuery(<Query Name> [, <Connection>] [, <Mode> [, <Parameters> [, ...]]])
```

Atención: En este caso:

- Los valores de los parámetros de la consulta deben ser especificados en su orden de inicialización (Visible en el editor de la consulta). Cada parámetro debe corresponder al tipo esperado. Los parámetros están separados por una coma.

- Para especificar los parámetros de la consulta, debe especificar el modo de inicialización de la consulta.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Usando la notación &lt;Query name&gt;.&lt;Parameter name&gt; (Nombre del parámetro)
<a name="usando_notacion_nombre_del_parametro_ELTTEXTE000226"></a>


### Sintaxis a utilizar
<a name="sintaxis_utilizar_ELTPARAGRAPHE000058"></a>

Para pasar parámetros a una consulta, todos los parámetros de la consulta pueden ser especificados al motor HFSQL antes de ejecutar la consulta.. Este método permite especificar los parámetros en cualquier orden (useful para las consultas que requieren varios parámetros).

Se debe utilizar la siguiente sintaxis:


```txt
<Query name>.<Name of parameter 1> = <Value of parameter 1>
<Query name>.<Name of parameter 2> = <Value of parameter 2>
...
<Query name>.<Name of parameter N> = <Value of parameter N>

<Result> = HExecuteQuery(<Query name> 
	[ , <Connection>] [, <Mode>])
```

Atención:

- El nombre del parámetro debe ser el nombre especificado cuando se creó la consulta en el editor de consultas.. Este nombre debe diferir del nombre de una posición.

- La [operadores indirectos](../Motscles/1512005.md) o la compilación dinámica ([Compilar](../WDLang1/3013015.md)) no pueden utilizarse con esta sintaxis.

- Los valores de los parámetros se restablecen cada vez que se ejecuta la consulta con [HExecuteQuery](../WDLang4/3044080.md).

- Si se especifica al menos un parámetro en [HExecuteQuery](../WDLang4/3044080.md), se ignoran todos los parámetros especificados anteriormente.

- El valor del parámetro puede corresponder a NULL.

- Si no se especifica uno de los parámetros, se ignora la condición correspondiente.






<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Evitar especificar todos los parámetros
<a name="evitar_especificar_todos_los_parametros_ELTTEXTE000250"></a>


### Parámetros de consulta no especificados
<a name="parametros_consulta_especificados_ELTPARAGRAPHE000096"></a>

Independientemente del método utilizado para pasar parámetros a la consulta, no es necesario especificar todos los parámetros de la consulta.. Las condiciones de la consulta que utilizan parámetros no especificados se ignorarán..



Ejemplo: Consideremos la consulta "QRY_Customer_LastName_FirstName" con el siguiente código SQL:


```sql
SELECT * FROM CUSTOMER WHERE LASTNAME = {Param1} AND FIRSTNAME = {Param2}
```


- Si se especifican los 2 parámetros: 
	
	```wl
	HExecuteQuery(QRY_Customers_LastName_FirstName, hQueryDefault, "Smith", "John")
	```
ejecutará la consulta 
	
	```sql
	SELECT * FROM CUSTOMER WHERE LASTNAME = 'Smith' AND FIRSTNAME = 'John'
	```


- Si solo se especifica el apellido: 
	
	```wl
	HExecuteQuery(QRY_Customers_LastName_FirstName, hQueryDefault, "Smith" )
	```
ejecutará la consulta 
	
	```sql
	SELECT * FROM CUSTOMER WHERE LASTNAME= 'Smith'
	```


- Si solo se especifica el nombre. Sin embargo, el nombre debe ser especificado y debe corresponder a Null. 
	
	```wl
	sLastName is Variant = Null 
	// Use of variant required 
	// for the Null variable (not filled)
	
	HExecuteQuery(QRY_Customers_LastName_FirstName, hQueryDefault, sLastName, "John")
	
	// OR
	
	HExecuteQuery(QRY_Customers_LastName_FirstName, hQueryDefault, Null, "John")
	```
ejecutará la consulta: 
	
	```sql
	SELECT * FROM CUSTOMER WHERE FIRSTNAME= 'John'
	```






