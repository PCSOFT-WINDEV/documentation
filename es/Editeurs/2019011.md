


## Prueba de una consulta
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000261"></a>
<a name="Test_Query"></a>
El editor de consultas permite probar el resultado de la consulta (![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Ico_Go_Fenetre_WD_bl.gif) o "Probar consulta" en el menú contextual de la consulta).

Durante la prueba de la consulta, se ejecuta el código de inicialización del proyecto..<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Requete_ResultatTestRequete.gif)
**Notas**:

- Se pueden ejecutar varias pruebas de consulta al mismo tiempo.

- La última prueba (ventana, consulta, reporte,...) se puede volver a ejecutar desde cualquier elemento del proyecto a través de "GO... Vuelva a ejecutar la última prueba" que se encuentra en los botones de acceso rápido. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=GO_Relancer_le_dernier_test%20-%20HC%20N%B0001.gif)


- Durante la prueba de un [consulta con parámetros](../Editeurs/2032045.md), una ventana permite especificar los diferentes parámetros. 
	En esta ventana, tiene la posibilidad de seleccionar un valor existente a través de ![Valor existente](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=OrdreAffichage.gif). Aparece el siguiente menú:<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Requete_MenuVisuValeur.gif)
 Puede:

	- seleccionar uno de los valores posibles entre los valores encontrados en el archivo,

	- ver el archivo completo. 
			**Atención**: Esta opción sólo está disponible si está activada la opción Datos en vivo.. 




- El botón ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=IconeCalculette.gif) sirve para mostrar automáticamente la media, el total, el mínimo y el máximo de los elementos de resultados numéricos.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ER.png) | Importante | [Reports & Queries](../Presentation/3088006.md)no se puede utilizar para verificar:<br><br>- insertar consultas,<br><br>- consultas de actualización,<br><br>- delete queries. <br><br><br>Cuando se prueba la consulta en [el editor de consultas del usuario](../Presentation/3088006.md), se ejecuta la "Inicialización del proyecto" Event. |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Consulta del resultado de la prueba
<a name="consulta_del_resultado_prueba_ELTTEXTE000303"></a>


### Resultado de la prueba
<a name="resultado_prueba_ELTPARAGRAPHE000073"></a>

El resultado de la prueba depende del tipo de consulta:

- El resultado de una *seleccione la consulta* corresponde a los registros seleccionados por la consulta.

- El resultado de una consulta de *insert* corresponde al Record que se insertará. Durante la prueba, la Record se inserta directamente en el archivo.

- El resultado de una *consulta de actualización* corresponde a los registros que serán modificados. Durante la prueba, usted puede:

	- ver los registros que serán modificados,

	- modificar los registros en el archivo.




- El resultado de una *eliminar consulta* corresponde a los registros que serán borrados. Durante la prueba, usted puede:

	- ver los registros que serán eliminados,

	- borrar los registros del archivo.






<a name="NOTE2_2"></a>


### Manejo del resultado
<a name="manejo_del_resultado_ELTPARAGRAPHE000091"></a>

Entonces, el resultado de la consulta puede ser:

- Exportado a un archivo de texto.

- Exportado a un archivo XML.

- Exportado a un archivo de Excel.

- Exportado a un archivo HFSQL.

- Impreso.




Una Record encontrada en el resultado de la consulta también puede copiarse en el portapapeles.

Para obtener más información, consulte [Resultado de una consulta en modo de test](../Editeurs/2032017.md).

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Notas
<a name="notas_ELTTEXTE000333"></a>


### Gestión de las contraseñas de los archivos de datos
<a name="gestion_las_contrasenas_los_archivos_datos_ELTPARAGRAPHE000113"></a>

Si uno de los ficheros de datos que intervienen en la consulta está protegido por contraseña, durante la prueba de la consulta:

- Si la contraseña se especifica en el código de inicialización del proyecto ([HPass](../WDLang4/3044108.md)), se ejecuta la consulta.

- Si la gestión de los errores HFSQL no se ha personalizado ([HOnError](../WDLang4/3044017.md)) y si la contraseña no se especifica mediante programación, se muestra la ventana estándar para la introducción de la contraseña. 
	**Observación**: si se personaliza la gestión de errores en el código de inicialización del proyecto, se utilizará esta gestión de errores.



<a name="NOTE3_2"></a>


### Consideración de la constante hQueryWithoutCorrection durante la prueba (consulta que utiliza una conexión)
<a name="consideracion_constante_hquerywithoutcorrection_durante_prueba_consulta_que_utiliza_una_conexion_ELTPARAGRAPHE000131"></a>

Por defecto, WINDEV y WEBDEV interpretan las consultas SQL en OLE DB y ODBC a través del proveedor OLE DB.

Para evitar que la consulta sea interpretada durante una prueba en el editor de consultas:

- *Seleccionar consulta*:

	1. Visualizar la consulta description ("Consulta description" en el menú contextual de la consulta).

	2. En la sección derecha, haga clic en el botón "Avanzado. Aparece la ventana de parámetros avanzados.

	3. Mostrar la pestaña "hQueryWithoutCorrection".

	4. Seleccione "Ejecutar con hQueryWithoutCorrection en modo de prueba".

	5. En la lista, seleccione la conexión que desea utilizar. La lista presenta las diferentes conexiones definidas en la editor de análisis. También se puede introducir directamente el nombre de una conexión dinámica (definida programáticamente con [HDescribeConnection](../WDLang4/3044205.md)).
			**Atención**: Si está utilizando una conexión dinámica, debe definirse esta conexión:

		- en el código de inicialización del proyecto,

		- en una ejecución de código desde el código de inicialización del proyecto.




- *Consulta de inserción, modificación o eliminación*: 

	1. Visualice la consulta description ("Consulta description" en el menú contextual de la consulta, pestaña "General").

	2. Seleccione "Ejecutar con hQueryWithoutCorrection en modo de prueba".

	3. En la lista, seleccione la conexión que desea utilizar. La lista presenta las diferentes conexiones definidas en la editor de análisis. También se puede introducir directamente el nombre de una conexión dinámica (definida programáticamente con [HDescribeConnection](../WDLang4/3044205.md)).
			**Atención**: Si está utilizando una conexión dinámica, debe definirse esta conexión:

		- en el código de inicialización del proyecto

		- en una ejecución de código desde el código de inicialización del proyecto.







Este modo se puede utilizar si escribe directamente el código SQL de su consulta en el editor de consultas..
**Observación**: En tiempo de ejecución, la constante *hQueryWithoutCorrection* puede especificarse directamente en [HExecuteQuery](../WDLang4/3044080.md).

**Efectos de la constante hQueryWithoutCorrection**


| Si no se especifica hQueryWithoutCorrection | Si se especifica hQueryWithoutCorrection |
| --- | --- |
| La conexión associated con los archivos de datos de la consulta se define automáticamente. | La conexión a utilizar debe especificarse en la función **HExecuteSQLQuery**. |
| Todos los letreros de propiedad de PC SOFT son reemplazados (por ejemplo.: ']=' comienza con) con su equivalente en SQL estándar. | No se realiza ningún reemplazo. Se deben utilizar los símbolos de SQL estándar. |
| Formatear las fechas y horas de acuerdo con el formato utilizado por la base de datos..<br>Por ejemplo, las fechas WINDEV están en formato'AAAAMMDD' mientras que en Access, las fechas están en formato #AAAAMMDDMM# o #AAAMMDD# dependiendo del idioma del sistema. | No se define ningún formato. Se debe utilizar el formato reconocido por las bases de datos. |
| Los flotadores están formateados (el separador decimal puede ser '.' o ',') | No se define ningún formato para las comas flotantes. |
| Dependiendo de la base de datos utilizada, los nombres de los alias se sustituyen por los nombres completos de los elementos en WHERE, ORDER BY y GROUP BY.<br>Por ejemplo, el motor JET (Access, dBase, etc.) no acepta ningún alias en la cláusula Where de una consulta | No se realiza ningún reemplazo. Los nombres completos de los artículos deben ser utilizados en el código de consulta para DÓNDE, PEDIDO POR y GRUPO POR. |




