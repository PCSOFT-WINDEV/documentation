


## Uso de ensamblajes.NET en un proyecto
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000280"></a>
La tecnología .NET es la nueva plataforma de desarrollo de Microsoft. Esta plataforma .NET simplifica el desarrollo de aplicaciones de objetos distribuidos cuyos módulos se comunican a través de INTERNET.

Esta ayuda explica globalmente cómo utilizar la tecnología.NET en WINDEV, WINDEV Mobile y WEBDEV.. Para más detalles, consulte una documentación específica.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Integración de un ensamblado .NET en un proyecto WINDEV o WEBDEV
<a name="integracion_ensamblado_net_proyecto_windev_webdev_ELTTEXTE000304"></a>
Para integrar ensamblados .NET en el proyecto actual:

1. En la pestaña "Proyecto", en el grupo "Proyecto", despliegue "Importar" y seleccione "Un ensamblado .NET".<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Utiliser_Assemblage%20-%20HC%20N%B0001.gif&type=thumb)


2. En la ventana que aparece, seleccione los ensamblados .NET que desea integrar en el proyecto actual. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Utiliser_Assemblage%20-%20HC%20N%B0002.gif&type=thumb)


	- Un área de "Búsqueda" le permite encontrar fácilmente el montaje deseado. 

- El botón "Seleccionar del disco" permite seleccionar un montaje que no aparece en la lista. El montaje seleccionado mediante el botón "Seleccionar del disco" se selecciona automáticamente y aparece en la parte superior de la lista.

- El botón "Rellenar lista automáticamente" busca todos los montajes disponibles en el equipo. 

- Si es necesario, especifique el objetivo .NET framework. La lista muestra las diferentes versiones de Microsoft. De forma predeterminada, la opción "Automático" está seleccionada. 
			Observación: La lista de ensamblados puede variar en función de la aplicación .Net framework.

3. Validar. Se importan los conjuntos seleccionados.




Utilizar un ensamblaje .NET es equivalente a utilizar una clase en WLanguage.

**Recordatorio**: Las clases son Visible en el panel "Explorador de proyectos. Las clases .NET están agrupadas por "Namespace".
<a name="NOTE2_2"></a>


### Utilización de elementos del ensamblaje .NET
<a name="utilizacion_elementos_del_ensamblaje_net_ELTPARAGRAPHE000056"></a>

Los siguientes elementos importados en el ensamblaje.NET pueden ser manejados en WLanguage:

- Delegados: los delegados pueden ser manejados por [DotNetDelegados](../WDLang3/1000017052.md).
	También tiene la posibilidad de añadir un delegado con el operador +=:


	```wl
	clDotNet is ClassEventManagement
	// Branch the event
	clDotNet:m_LogHandler += Proc_Test
	// ...
	// Triggers the event
	clDotNet:SendAMessage("String sent")
	```

	```wl
	//-------------------------------------------------
	// Manage the event
	PROCEDURE Proc_Test(src, args)
	Info("The string passed as parameter via the delegate is " + args:get_Message())
	```


- NestedType con más de 1 nivel

- reference

- Propiedades

- Array con más de una dimensión

- Estructuras.

- enums.
	Se pueden combinar los Enum que provienen de ensamblados .Net mediante los operadores &, | , ||, ~ . Tienes la habilidad de convertir los enums en enteros o de construirlos a partir de enteros.

- Clases internas: se debe utilizar la siguiente sintaxis: 
	
	```txt
	<Object name> is "<Class name>"
	```

	La sintaxis sin comillas también está disponible: 
	
	```txt
	<Object name> is <Class name>
	```

	Ejemplo:
	
	```wl
	O is "ExternalClass.InternalClass"
	```

	
	```wl
	O is ExternalClass.InternalClass
	```


- Genérico:
	La siguiente sintaxis se utiliza para instanciar un genérico:


	```txt
	<Object name> is "<Generic name><<Concrete type>>"
	```
Ejemplo de instanciación de un genérico:


	```wl
	MyList is "List<CMyObject>"
	```


- Métodos genéricos:
	La siguiente sintaxis se utiliza para llamar a un método genérico:


	```txt
	<Object name>."<Name of generic method><<Concrete type>>"(<parameters>)
	```
Ejemplo de llamada a un método genérico:


	```wl
	// Prototype of the generic CloneList method of CClone class
	// CloneList(List<T>)
	// ...
	MyList is "List<int>"
	// ...
	clClone is CClone
	MyListCopy is "List<int>" <- clClone."CloneList<int>"(MyList)
	```


- Métodos extension: 
	Los métodos de extension pueden ser llamados como los métodos del objeto.




Cuando sea posible, los tipos de WLanguage se convierten implícitamente en tipos.net.
Ejemplo:


```wl
clDotNetString is "String" dynamic
sWLString is string = "string"
clDotNetString = sWLString
```

<a name="NOTE2_3"></a>


### Limitaciones
<a name="limitaciones_ELTPARAGRAPHE000130"></a>

- Una clase WLanguage no puede derivarse de una clase.NET.

- Se soportan los siguientes tipos:

	- Date/Time

	- Monedas WINDEV. En la salida, las monedas WINDEV se convierten a números decimales.

	- Números decimales
			Un parámetro decimal pasado de un ensamblaje.NET a una función WLanguage se convierte en moneda si es posible.. Si esta conversión no es posible, el parámetro se convierte en doble.

	- Estructuras




- Los objetos derivados en.NET de una clase WLanguage exportada no están soportados.. Si se pasa un objeto de este tipo a una función WLanguage como parámetro, se "casted" al tipo WLanguage base.

- No se soportan los parámetros de paso de puntero entre WLanguage y .NET.

- Los miembros "estructura" que se encuentran en las clases y/o en los conjuntos no son Visible en .NET porque las estructuras WLanguage no son Visible en .NET. Para solucionar este problema, cree una clase que contenga el código de la estructura.

- Los miembros "de clase" que se encuentran en las clases y/o en los conjuntos son Visible en .NET sólo si la clase también se exporta.

- Atención: Los componentes creados con la versión 11 (o anterior) que utilizan .NET ya no funcionarán con la versión 28. Es necesario volver a generar los componentes con la versión 28.



![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 

### Incompatibilidad entre ActiveX de IE (y oAuth2) y el uso de ensamblados .NET
<a name="incompatibilidad_entre_activex_oauth2_uso_ensamblados_net_ELTPARAGRAPHE000344"></a>

Cuando se utiliza un control HTML en WINDEV, este control utiliza el sistema ActiveX "Microsoft Web browser". WINDEV también utiliza ActiveX para todas las autenticaciones OAuth2 (Facebook, Twitter, Google, etc.) que requieren una validación de la conexión mediante código HTML.

Si utiliza un control HTML (o la autenticación OAuth2) y un ensamblado ".Net" en el mismo proyecto, puede encontrar problemas de compatibilidad entre las capas .NET de Microsoft y el entorno de software ActiveX.

Se puede utilizar una API para gestionar ambas tecnologías. Para ello, escriba la siguiente línea de código en el código de inicialización del proyecto o en el código de inicialización de una clase o procedimiento global si el objeto ".Net" se inicializa en una clase o en un conjunto de procedimientos:


```wl
// Used to manage the cohabitation between IE ActiveX and .NET
API("OLE32", "CoInitializeEx", Null, 2)
```


<a name="NOTE3A"></a>
<a name="NOTE3A_1"></a>


## Utilización de ensamblajes estándar de .NET Framework 4 (e inferiores)
<a name="utilizacion_ensamblajes_estandar_net_framework_4_inferiores_ELTTEXTE000361"></a>


### Utilización de ensamblajes estándar de .NET Framework 4 (e inferiores)
<a name="utilizacion_ensamblajes_estandar_net_framework_4_inferiores_ELTPARAGRAPHE000158"></a>

Para utilizar los ensamblajes estándar de .NET Framework 4 (e inferiores): 

1. Seleccione la carpeta ".NET assemblies" en el panel "Project Explorer".. 

2. Abra el menú contextual y seleccione "Usar un ensamblado .NET". 

3. En la ventana que aparece, haga clic en "Rellenar automáticamente una lista con los ensamblados .NET del disco.
Atención: Este proceso puede durar mucho tiempo.". 

4. Seleccione los ensamblajes estándar a utilizar (mscorlib.dll u otro ensamblaje). 

5. Validar. 





### Uso de los ensamblajes estándar del SDK de .NET 5
<a name="uso_los_ensamblajes_estandar_del_sdk_net_5_ELTPARAGRAPHE000175"></a>

Para utilizar los ensamblajes estándar del SDK de .NET 5: 

1. Seleccione la carpeta ".NET assemblies" en el panel "Project Explorer".. 

2. Abra el menú contextual y seleccione "Usar un ensamblado .NET". 

3. En la ventana que aparece, haga clic en "Seleccionar los ensamblados .NET en el disco...".

4. Seleccione el directorio de instalación del SDK .NET 5. Por ejemplo: 
	"C:\\Archivos de programa\\dotnet\\paquetes\\Microsoft.NETCore.App.Ref\\5.0.0\\ref\\net5.0". 

5. Seleccione los ensamblajes estándar a utilizar (System.Runtime.dll u otro ensamblaje).
	**Precaución** , este directorio contiene el archivo mscorlib.dll. Este archivo no debe seleccionarse si se utiliza el SDK de .NET 5.   

6. Validar. 




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Usando un ensamblaje.NET creado con WINDEV
<a name="usando_ensamblajenet_creado_con_windev_ELTTEXTE000391"></a>
Los ensamblajes generados por WINDEV pueden ser utilizados como cualquier otro ensamblaje.NET. Sin embargo, el WINDEV framework y el ensamblaje deben encontrarse en el mismo directorio.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Lista de ensamblajes de red utilizados en el proyecto
<a name="lista_ensamblajes_red_utilizados_proyecto_ELTTEXTE000415"></a>
Para visualizar la lista de conjuntos de red utilizados en el proyecto, puede hacerlo:

- En la pestaña "Proyecto", en el grupo "Proyecto", despliegue "Lista de elementos" y seleccione "Lista de ensamblados .NET utilizados".

- En el panel "Explorador de proyectos", seleccione "Lista de ensamblados .NET utilizados en el proyecto" en el menú contextual de ".NET assemblies".




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Recarga de los ensamblajes.NET
<a name="recarga_los_ensamblajesnet_ELTTEXTE000439"></a>
Puede recargar los ensamblajes .NET utilizados en el proyecto para tener en cuenta un cambio realizado en un ensamblaje desde que se abrió el proyecto.

1. En el panel "Explorador de proyectos", seleccione ".NET assemblies"..  

2. En el menú contextual de este elemento, seleccione "Recargar ensamblados .NET".







