


## EmailSeekFirst (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Encuentra uno o más correos electrónicos según los criterios especificados en el software de mensajería (Outlook, software de mensajería que utiliza el protocolo IMAP, ....).

Esta búsqueda se realiza en la carpeta actual de Outlook.

**Recordatorio**: Esta función no se puede utilizar para encontrar uno o más correos electrónicos en el software de mensajería Outlook Express.


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000021555&name=emailseekfirst_funcion&product=WD">Ver ejemplos adicionales</a>

```wl
MySession is emailIMAPSession
MyEmail is Email
...

// Find the emails containing "PC Soft" 
// in the message subject or body
// Only the incoming emails are taken into account
IF EmailSeekFirst(MySession, MyEmail, emailSubject + emailBody, ...
			"PC Soft") = True THEN
	// Enumerate the emails found
	WHILE MyEmail.Out = False
		// Displays the sender and subject in a Table control
		TableAdd(TABLE_EmailFound, Email.Sender + ...
			TAB + MyEmail.Subject)
		// Next email found
		EmailReadNext(MySession, MyEmail)
	END
ELSE
	Info("No email was found")
END
```

<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX2"></a>

### Buscando en un correo electrónico Variable

`<Result> = EmailSeekFirst(<Session> , <Email> , <Email section> , <Sought value> [, <Read mode>])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se encontró uno o más correos electrónicos,

- <u><u><u><u>False</u></u></u></u> en caso contrario. Si se produce un error, la variable [ErrorOccurred](../WDLang1/3087001.md) se pone en <u><u><u><u>True</u></u></u></u>. Para obtener más información sobre el error, utilice la función [ErrorInfo](../WDLang1/3013008.md) con la constante *errMessage*.




Si no se ha encontrado ningún correo electrónico, [ErrorOccurred](../WDLang1/3087001.md) sigue siendo set a <u><u><u><u>False</u></u></u></u> y el Email.Out Variable es set a <u><u><u><u>True</u></u></u></u>.

**`<Session>: (Entero, o emailOutlookSession o emailIMAPSession Variable)`**

La sesión puede ser:

- un número entero devuelto por [EmailStartOutlookSession](../WDLang3/3032128.md) o [OutlookStartSession](../WDLang3/3032123.md).

- una variable de tipo [emailOutlookSession](../WDLang3/1000018767.md).

- una variable de tipo [emailIMAPSession](../WDLang3/1000018957.md).




**`<Email>: (Envía un correo electrónico a Variable)`**

Mensaje en el que se realizará la búsqueda.

**`<Email section>: (Constante o combinación de constantes de tipo Integer)`**

La sección de Email donde se buscará el &lt;Valor buscado&gt;:


|   |   |
| --- | --- |
| *emailBody* | Cuerpo de correos electrónicos. |
| *emailMessageID* | Identificador de correos electrónicos. |
| *emailRecipient* | Destinatarios de los correos electrónicos. |
| *emailSender* | Remitentes de correos electrónicos. |
| *emailSubject* | Temas de los correos electrónicos. |


Estas constantes se pueden combinar.

**`<Sought value>: (Cadena de caracteres)`**

Valor buscado en los correos electrónicos.

**`<Read mode>: (Constante opcional o cadena de caracteres)`**

Indica los mensajes que se leerán:


|   |   |
| --- | --- |
| *emailAll* o "TODOS"<br>(Valor predeterminado) | La búsqueda se realiza en los correos electrónicos leídos y en los no leídos. |
| *emailUnread* o "NO LEÍDOS" | La búsqueda se realiza únicamente en los correos electrónicos no leídos. |




<a name="SYNTAX1"></a>

### Buscando en la estructura de Email

`<Result> = EmailSeekFirst(<Session> , <Email section> , <Sought value> [, <Read mode>])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se encontró uno o más correos electrónicos,

- <u><u><u><u>False</u></u></u></u> en caso contrario. Si se produce un error, la variable [ErrorOccurred](../WDLang1/3087001.md) se pone en <u><u><u><u>True</u></u></u></u>. Para obtener más información sobre el error, utilice la función [ErrorInfo](../WDLang1/3013008.md) con la constante *errMessage*.




Si no se ha encontrado ningún correo electrónico, [ErrorOccurred](../WDLang1/3087001.md) sigue siendo set a <u><u><u><u>False</u></u></u></u> y el Email.Out Variable es set a <u><u><u><u>True</u></u></u></u>.

**`<Session>: (Cadena de caracteres, entero, o emailOutlookSession o emailIMAPSession Variable)`**

La sesión puede ser:

- un número entero devuelto por [EmailStartOutlookSession](../WDLang3/3032128.md) o [OutlookStartSession](../WDLang3/3032123.md).




- una variable de tipo [emailOutlookSession](../WDLang3/1000018767.md).

- una variable de tipo [emailIMAPSession](../WDLang3/1000018957.md).

- el nombre de usuario pasado a [EmailStartIMAPSession](../WDLang3/1000019189.md).




**`<Email section>: (Constante o combinación de constantes de tipo Integer)`**

La sección de Email donde se buscará el &lt;Valor buscado&gt;:


|   |   |
| --- | --- |
| *emailBody* | Cuerpo de correos electrónicos. |
| *emailMessageID* | Identificador de correos electrónicos. |
| *emailRecipient* | Destinatarios de los correos electrónicos. |
| *emailSender* | Remitentes de correos electrónicos. |
| *emailSubject* | Temas de los correos electrónicos. |


Estas constantes se pueden combinar.

**`<Sought value>: (Cadena de caracteres)`**

Valor buscado en los correos electrónicos.

**`<Read mode>: (Constante opcional o cadena de caracteres)`**

Indica los mensajes que se leerán:


|   |   |
| --- | --- |
| *emailAll* o "TODOS"<br>(Valor predeterminado) | La búsqueda se realiza en los correos electrónicos leídos y en los no leídos. |
| *emailUnread* o "NO LEÍDOS" | La búsqueda se realiza únicamente en los correos electrónicos no leídos. |





<a name="NOTE0"></a>
<a name="XComponent"></a>

## Componente:
wd280com.dll
