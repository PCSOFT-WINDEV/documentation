


## zipAddFileList (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Añade una lista de archivos (de cualquier tipo) a un archivo comprimido en formato ZIP, CAB, WDZ o 7z, TAR o TGZ (TAR.GZ) y lo comprime.. Esta función es más rápida que la ejecución de [zipAddFile](../WDLang3/3082008.md) para cada archivo.


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
```wl
// Create an archive and add an element
// With progress bar displayed in a Progress Bar control 
MyArchive is zipArchive
NumZipErr is int

NumZipErr = zipCreate(MyArchive,"C:\Doc\Archive\ArchiveFile.zip")
IF NumZipErr = 0 THEN
	NumZipErr = zipAddFileList(MyArchive, "C:\doc\Image\House.BMP" + CR +  ...
			"C:\My Projects\WDStock\WDStock.wdp", zipDrive, PROGBAR_Progress)
	IF NumZipErr <> 0 THEN
		Error(zipMsgError(NumZipErr))
	END
	zipClose(MyArchive)
ELSE
	Error(zipMsgError(NumZipErr))
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Añadir una lista de archivos (archivos separados por CR)

`<Result> = zipAddFileList(<Archive> , <Path of files to add> [, <Path section to store> [, <Progress>]])`
---

**`<Result>: (Integro)`**



- 0 si se realizó la suma, 

- Un código de error (valor superior a 0) en caso contrario. Para más detalles sobre estos códigos de error, consulte la página web de [Observaciones](#NOTE0_2).




**`<Archive>: (Cadena de caracteres o zipArchive Variable)`**

Nombre del archivo al que se añadirán los archivos.
Este nombre puede corresponder a:

- un nombre de archivo definido con [zipOpen](../WDLang3/3082044.md) o [zipCreate](../WDLang3/3082003.md).

- el nombre de una variable de tipo [zipArchive](../WDLang3/1000018679.md). 
	![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Las variables [zipArchive](../WDLang3/1000018679.md) no están disponibles en Java.




**`<Path of files to add>: (Cadena de caracteres)`**

Nombre y ruta de los archivos a añadir en el archivo, separados por caracteres CR. Estas rutas pueden ser rutas completas o rutas relativas al directorio actual. El tamaño de cada ruta no debe superar los 260 caracteres..
El tamaño de cada archivo no debe exceder los 4 GB. De lo contrario, se produce un error.
No se pueden utilizar caracteres comodín. 
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) Este parámetro tiene la siguiente forma: 

```txt
<File path> [ + TAB + <Path to store> ] + RC
```
Si se especifica la ruta a almacenar, la adición será equivalente a una adición de archivo seguida de una llamada a [zipChangePath](../WDLang3/3082027.md).![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) El acceso ruta al fichero es un ruta completo o un ruta relativo al directorio de trabajo de la aplicación (devuelto por [fDataDir](../WDLang1/3036001.md)). Sólo los archivos encontrados en el directorio de trabajo pueden ser añadidos al archivo.. 

**`<Path section to store>: (Constante opcional)`**

Indica la sección de las rutas de los archivos que deben almacenarse en el archivo comprimido.. Este parámetro se tiene en cuenta para los ficheros para los que no se ha especificado  . 


|   |   |
| --- | --- |
| *zipDirectory* | Almacena los diferentes directorios encontrados en el fichero ruta así como el nombre del fichero y extension. Por ejemplo: \\Directory\\Files\\NombreArchivo.pdf |
| *zipDrive*<br>(Valor predeterminado) | Almacenar la ruta completa y absoluta de archivo (nombre de disco, nombre de directorios, nombre de archivo y archivo extension). Por ejemplo: C:\\Directory\\Files\\NombreArchivo.pdf<br>**Para el formato ZIP**: Esta constante no tiene ningún efecto.<br>**Para el formato 7z**: Esta constante y *zipDirectory* tendrán el mismo efecto<br><br>![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) Esta constante no está disponible ya que no hay raíz para la Drive.![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante y la constante *zipDirectory* tendrán el mismo efecto. |
| *zipNone* | Almacena el nombre del archivo y extension. Por ejemplo: NombreDeArchivo.pdf |


**Si utiliza un archivo en formato .CAB**, solo se tiene en cuenta la constante *zipNone*. De hecho, el formato.CAB no puede utilizarse para almacenar las rutas dentro del archivo.

![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Este parámetro no está disponible: sólo se almacenan el nombre del archivo y extension.

**`<Progress>: (Nombre de control o nombre de Procedure)`**

Modo de gestión de la barra de progreso. Este parámetro puede corresponder a: 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) el nombre de un control Barra de progreso encontrado en una ventana. La barra de progreso mostrará el progreso relativo a la adición y compresión de todos los archivos utilizados.

- el nombre de un WLanguage Procedure. Para obtener más información sobre este procedimiento, consulte [Parámetros del procedimiento utilizado por la función zipAddFileList](../WDLang3/1000025731.md). 




**Si usa un archivo TAR o TGZ (TAR.GZ)** , la barra de progreso se actualiza solo después de agregar el archivo. 

![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Este parámetro no está disponible.

<a name="SYNTAX2"></a>

### Añadiendo una lista de archivos encontrados en un array

`<Result> = zipAddFileList(<Archive> , <List of files> [, <Progress>])`
---

**`<Result>: (Integro)`**



- 0 si se realizó la suma, 

- Un código de error (valor superior a 0) en caso contrario. Para más detalles sobre estos códigos de error, consulte la página web de [Observaciones](#NOTE0_2).




**`<Archive>: (Cadena de caracteres o zipArchive Variable)`**

Nombre del archivo al que se añadirán los archivos.
Este nombre puede corresponder a:

- un nombre de archivo definido con [zipOpen](../WDLang3/3082044.md) o [zipCreate](../WDLang3/3082003.md).

- el nombre de una variable de tipo [zipArchive](../WDLang3/1000018679.md). 
	![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Las variables [zipArchive](../WDLang3/1000018679.md) no están disponibles en Java.




**`<List of files>: (Array de variables zipArchivedFile)`**

Variables Array de [zipArchivedFile](../WDLang3/1000019044.md) utilizadas para conocer las características de los ficheros a añadir.  

**`<Progress>: (Nombre de control o nombre de Procedure)`**

Modo de gestión de la barra de progreso. Este parámetro puede corresponder a: 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) el nombre de un control Barra de progreso encontrado en una ventana. La barra de progreso mostrará el progreso con respecto a la adición y compresión de todos los archivos utilizados..  

- el nombre de un WLanguage Procedure. Para obtener más información sobre este procedimiento, consulte [Parámetros del procedimiento utilizado por la función zipAddFileList](../WDLang3/1000025731.md). 




**Si usa un archivo TAR o TGZ (TAR.GZ)** , la barra de progreso se actualiza solo después de agregar el archivo. 





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Condición de uso
<a name="condicion_uso_ELTPARAGRAPHE000326"></a>

La adición de archivos en un archivo comprimido se puede realizar si:

- El archivo existe (los archivos se crean con [zipCreate](../WDLang3/3082003.md)).

- El archivo es accesible en lectura/escritura.

- El archivo es un archivo de una sola parte.

- El tamaño del archivo es inferior a 4 GB.




**Atención**:

- La ruta completa de cada archivo se almacena en los archivos en formato ZIP o WDZ.

- **Archivos en formato CAB**: Los ficheros deben añadirse inmediatamente después de la creación del archivo.. Este formato no se puede utilizar para añadir archivos a un archivo comprimido existente.

- **Archivos en formato RAR**: Esta función no está disponible.

- **Archivos en formato 7z**: El archivo se comprime completamente cada vez que se llama **zipAddFileList**. 




El número máximo de archivos que se pueden incluir:

- en un archivo WDZ: 232-1. 

- en un archivo ZIP: 65535. 

- en un archivo CAB: 65535. 


Recordatorio: 

- ![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Sólo están disponibles los archivos ZIP, TAR y TGZ (TAR.GZ).

- ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Sólo están disponibles los archivos ZIP.



<a name="NOTE0_2"></a>


### Nivel de compresión
<a name="nivel_compresion_ELTPARAGRAPHE000393"></a>

Los ficheros añadidos en un archivo zip son comprimidos por Default. El nivel de compresión de los ficheros añadidos a un archivo puede ser modificado por [zipCompressionLevel](../WDLang3/3082054.md).
<a name="NOTE0_3"></a>


### Códigos de error
<a name="codigos_error_ELTPARAGRAPHE000405"></a>

Se devuelven los siguientes códigos de error:

- 1: La ruta pasada como parámetro no existe.

- 2: Acceso denegado: el usuario no tiene suficientes derechos o el archivo se está utilizando actualmente. Si el archivo a insertar es un archivo de datos HFSQL, debe cerrarse con el siguiente código: 
	
	```txt
	HClose(<File name>)
	Multitask(<Timeout>) // Waits for the effective closing of the file
	```


- 3: El archivo está corrupto.

- 4: La ruta no existe en el archivo.

- 5: No se puede escribir en el archivo.

- 7: El archivo ya se encuentra en el archivo.

- 8: No se puede añadir un archivo comprimido a sí mismo. Por ejemplo, "MiArchivo" no puede añadirse a "MiArchivo".




El mensaje correspondiente al código de error es devuelto por [zipMsgError](../WDLang3/3082034.md).
<a name="NOTE0_4"></a>


### Añadir un fichero que ya se encuentra en el archivo
<a name="anadir_fichero_que_encuentra_archivo_ELTPARAGRAPHE000429"></a>

Se produce un error al añadir un fichero que ya se encuentra en el archivo comprimido.. Un fichero se identifica por su ruta almacenado. Por lo tanto, dos archivos con el mismo nombre y con el mismo relativo ruta no se pueden añadir a un archivo comprimido.
<a name="NOTE0_5"></a>


### Índice de ficheros en el archivo
<a name="indice_ficheros_archivo_ELTPARAGRAPHE000438"></a>

Cuando se añade un fichero a un archivo, se le asigna automáticamente un índice. Este índice corresponde al orden de inclusión de los ficheros en el archivo. Para seleccionar un fichero en el archivo comprimido, puede utilizar:

- La índice del elemento (note: el índice de un elemento es devuelto por [zipFindFile](../WDLang3/3082002.md)).

- La ruta almacenada del elemento.




<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Lógica de negocio
## Componente:
wd280zip.dll
