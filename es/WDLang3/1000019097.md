


## <zipArchive Variable>Abrir (función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Abre un archivo existente. 

Para los archivos en formato "CAB" o "RAR", el archivo se crea si no existe.. 

El archivo puede ser:

- en formato WinZip o PKZip (extensión.ZIP).

- en formato WINDEV (.WDZ extension).

- en formato de archivo Cabinet (extensión.CAB).

- en formato RAR (.RAR extension). 

- en formato 7z (.7z extension). 

- en formato TAR (.TAR extension). 

- en formato TGZ (.TGZ extension). 

- en formato TAR.GZ (.TAR.GZ extension). 

- un ejecutable (.EXE) correspondiente a un archivo.WDZ convertido en un archivo autoextraíble. 







<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
```wl
MyArchive is zipArchive
// Open an archive
ResOpenArchive = MyArchive.Open("C:\MyArchives\Archive.zip")

// Display an error message if the archive was not opened
IF ResOpenArchive <> 0 THEN
	Error(zipMsgError(ResOpenArchive))
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = <Archive>.Open(<Archive path> [, <Opening mode>])`
---

**`<Result>: (Integro)`**



- 0 si se ha abierto el archivo comprimido,

- Un código de error (valor superior a 0) en caso contrario. Para más detalles sobre estos códigos de error, consulte la página web de Observaciones.




**`<Archive>: (Variable de tipo zipArchive)`**

Nombre de una Variable de tipo [zipArchive](../WDLang3/1000018679.md) correspondiente al archivo a utilizar.

El archivo se crea si no existe (excepto para los formatos "CAB" o "RAR")..

**`<Archive path>: (Cadena de caracteres)`**

Ruta y nombre del archivo comprimido (hasta 260 caracteres). Se puede especificar el archivo extension. Si no se especifica el archivo extension, el extension por defecto es .WDZ.
![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Si no se especifica la extension, la extension será ".ZIP".![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) El archivo ruta es un ruta completo o un ruta relativo al directorio de trabajo de la aplicación (devuelto por [fDataDir](../WDLang1/3036001.md)). 

**`<Opening mode>: (Constante o combinación de constantes opcional)`**

Modo de apertura de archivos: 


|   |   |
| --- | --- |
| *zipCreateIfNotFound* | Crea el archivo si no existe<br>(no disponible para archivos.CAB y.RAR) |
| *zipHeader64* | Permite crear un archivo de más de 4 GB en el que se puede utilizar [.ChangePath](../WDLang3/1000026329.md).<br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante no está disponible.<br><br>Archivo TAR o TGZ (TAR.GZ): Esta constante no está disponible. |
| *zipRead* | Apertura en modo de sólo lectura |
| *zipWrite* | Apertura en lectura/escritura<br>(no disponible para archivos.CAB y.RAR) |


El modo de apertura de la Default es: *zipCreateIfNotFound* + *zipWrite*.  
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Este parámetro no está disponible: el modo de apertura utilizado corresponde a *zipCreateIfNotFound* + *zipWrite*.


<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Códigos de error
<a name="codigos_error_ELTPARAGRAPHE000345"></a>

Se devuelven los siguientes códigos de error:

- 1: La ruta pasada como parámetro no existe.

- 2: Acceso denegado: el usuario no tiene suficientes derechos.

- 3: El archivo está corrupto.

- 6: Los archivos de los subarchivos no están ordenados (al abrir un archivo de varias partes).


El mensaje correspondiente al código de error es devuelto por [zipMsgError](../WDLang3/3082034.md).
Recordatorio: 

- ![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) Sólo están disponibles los archivos ZIP, TAR y TGZ (TAR.GZ).

- ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Sólo están disponibles los archivos ZIP.





### Caso especial del .GZ extension
<a name="caso_especial_del_extension_ELTPARAGRAPHE000373"></a>

Los archivos '.tar.gz' generados por GitHub no deben confundirse con los archivos comprimidos '.gz'..
Los contenidos comprimidos en formato gzip pueden descomprimirse con [Descomprimir](../WDLang1/3024009.md).

<a name="XComponent"></a>

## Componente:
wd280zip.dll
