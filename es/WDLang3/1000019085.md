


## <zipArchive Variable>.ExtractAll (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Extrae todos los archivos de un archivo comprimido y los descomprime.

El archivo utilizado puede estar en formato CAB, RAR, ZIP, WDZ, 7z, TAR o TGZ (TAR.GZ)..

<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
```wl
Archive is zipArchive

// Open an archive
ResOpenArchive = Archive.Open("C:\Archives\Archive.zip")

IF ResOpenArchive = 0 THEN
	...
	// Extract all files from the archive
	ResExtractAll = Archive.ExtractAll(zipDrive)
	...
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = <Archive>.Extractall([<Destination of files> [, <Options> [, <WLanguage procedure> [, <Progress>]]]])`
---

**`<Result>: (Integro)`**



- 0 si los archivos han sido extraídos,

- Un código de error (valor superior a 0) en caso contrario. Para más detalles sobre estos códigos de error, consulte la página web de Observaciones.




**`<Archive>: (Variable de tipo zipArchive)`**

Nombre de una Variable de tipo [zipArchive](../WDLang3/1000018679.md) correspondiente al archivo a utilizar.

**`<Destination of files>: (Cadena de caracteres opcional o constante)`**

Destino ruta de los archivos extraídos:

- Cadena de caracteres opcional: Los archivos se extraen en la ruta especificada a la que se añade la estructura de árbol de cada archivo (el disco no se almacena).. Se crea la ruta especificada si no existe.
	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) El destino ruta del archivo extraído debe corresponder al directorio de trabajo de la aplicación (devuelto por [fDataDir](../WDLang1/3036001.md)) o a uno de sus subdirectorios.

- Constante opcional:
	


|   |   |
| --- | --- |
| *zipDirectory* | Extracción en el directorio actual mientras se restaura la estructura de árbol del archivo (si estaba almacenado). |
| *zipDrive* | Extracción:<br><br>	- a la ubicación inicial del archivo si estaba almacenado y si la unidad existe.<br><br>	- mientras restaura la estructura de árbol del archivo en la unidad actual si la unidad o el directorio almacenado no existe.<br><br>	- en el directorio actual si sólo se han almacenado el nombre y la extensión del archivo.<br><br><br>**Observación**: Si se utiliza la constante *zipDrive*, el formato WDZ conserva la ruta completa del archivo (incluida la letra de unidad), mientras que el formato ZIP no conserva la letra de unidad.<br><br>![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) Esta constante no está disponible. Los directorios no tienen raíz.<br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante y la constante *zipDirectory* tienen el mismo efecto<br><br>**Archivos en formato 7z**: Esta constante y la constante *zipDirectory* tendrán el mismo efecto. |
| *zipOverwrite* | Durante la extracción, los archivos de sólo lectura existentes se sobrescriben automáticamente con los archivos extraídos.. Esta constante puede combinarse con las constantes *zipDrive* y *zipDirectory*.<br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante no está disponible. |





![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Estas constantes no se pueden utilizar.

**`<Options>: (Constante opcional)`**

Configure la extracción (si &lt;Destino de archivos&gt; corresponde a una cadena de caracteres):



|   |   |
| --- | --- |
| *zipOverwrite* | Durante la extracción, los archivos de sólo lectura existentes se sobrescriben automáticamente con los archivos extraídos.<br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante no está disponible. |



**`<WLanguage procedure>: (Nombre de procedimiento opcional)`**

Nombre del WLanguage Procedure que se llamará si se produce un error al extraer los archivos. 
**ATENCIÓN**: Este parámetro sólo puede utilizarse si &lt;Archivo&gt; corresponde a un [zipArchive](../WDLang3/1000018679.md) Variable.

Este procedimiento tiene el siguiente formato: 


```txt
PROCEDURE <Procedure name>(<Error code>, <File name>)
```


donde: 

- &lt;Código de error&gt; es un número entero correspondiente al código del error que se produjo al extraer el archivo.

- &lt;Nombre de archivo&gt; es una cadena de caracteres que contiene la ruta del archivo procesado por **<zipArchive Variable>.ExtractAll**.




La Procedure puede devolver una de las siguientes constantes: 


|   |   |
| --- | --- |
| *zipCancel* | Cancela la extracción de archivos del archivo comprimido.  |
| *zipIgnore* | Ignora el archivo por error. |
| *zipRetry* | Reintenta la extracción de archivos. |


![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Este parámetro no está permitido.

**`<Progress>: (Nombre de control o nombre de Procedure)`**

Modo de gestión de la barra de progreso. Este parámetro puede corresponder a: 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) el nombre de un control Barra de progreso encontrado en una ventana. La barra de progreso mostrará el progreso de la extracción de todos los archivos utilizados..  

- el nombre de un WLanguage Procedure. Este procedimiento tiene el siguiente formato: 
	
	```txt
	PROCEDURE <Procedure name> (<Current file>, 
	<Global progress percentage>, <File progress percentage>)
	```

	donde: 

	- &lt;El archivo actual&gt; corresponde al nombre del archivo actualmente procesado.. 

	- &lt;El porcentaje de progreso global corresponde al porcentaje de progreso de la extracción de archivos del archivo.. 

	- &lt;El porcentaje de progreso del archivo corresponde al porcentaje de progreso del archivo que se está extrayendo del archivo.







**Si está utilizando un archivo**: 

- **en formato TAR o TGZ (TAR.GZ)**la barra de progreso se actualiza al final de la extracción de cada archivo. 

- **en formato CAB y RAR**la barra de progreso se actualiza al final de la extracción de cada archivo. 

- **en formato 7z**, sólo se especifica &lt;Porcentaje de progreso general&gt;. &lt;El porcentaje de progreso del archivo tendrá el mismo valor.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Códigos de error
<a name="codigos_error_ELTPARAGRAPHE000393"></a>

Se devuelven los siguientes códigos de error:

- 1: La ruta pasada como parámetro no existe.

- 2: Acceso denegado: el usuario no tiene suficientes derechos.

- 3: El archivo está corrupto.

- 4: La ruta no existe en el archivo.

- 6: Los archivos de los subarchivos no están ordenados (cuando se extraen de un archivo de varias partes).




El mensaje correspondiente al código de error es devuelto por [zipMsgError](../WDLang3/3082034.md).

Recordatorio: 

- ![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Sólo están disponibles los archivos ZIP, TAR y TGZ (TAR.GZ).

- ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Sólo están disponibles los archivos ZIP.

- RAR es compatible hasta la versión 4 inclusive.



<a name="NOTE0_2"></a>


### Archivo extraído
<a name="archivo_extraido_ELTPARAGRAPHE000424"></a>

Los archivos extraídos no se eliminan del archivo. Para eliminar un fichero o todos los ficheros del archivo, utilice [.DeleteFile](../WDLang3/1000019152.md) o [.DeleteAll](../WDLang3/1000019154.md).
<a name="XComponent"></a>

## Componente:
wd280zip.dll
