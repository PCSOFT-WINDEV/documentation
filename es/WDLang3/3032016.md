


## EmailReadMessage (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Lee un Email recibido:

- a través del protocolo POP3 o IMAP: el Email se encuentra en la bandeja de entrada del servidor de mensajería.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) a través del software de mensajería Lotus Notes o Outlook: el Email entrante se encuentra en el ordenador local en el buzón de entrada de Lotus Notes o Outlook.


Esta función no modifica la posición actual.

Los Variable s de la estructura del correo electrónico (o Email Variable) están llenos.

Si no se encuentra ningún correo electrónico, la variable Email.Out se establece en <u><u><u>True</u></u></u>.

**Recordatorio**: Antes de leer un Email, es necesario abrir una sesión con [EmailStartSession](../WDLang3/3032028.md), [EmailStartNotesSession](../WDLang3/3032121.md) o [EmailStartOutlookSession](../WDLang3/3032128.md).

![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) El protocolo POP3 sólo se puede utilizar para leer correos electrónicos.






<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000003032016&name=emailreadmessage_funcion&product=WD">Ver ejemplos adicionales</a>

```wl
// Use with the POP3 protocol 
I is int
nbMSG is int = EmailNbMessage(UserName)
FOR I = 1 TO nbMSG
	IF EmailReadMessage(UserName, I) = True THEN
		IF Email.Out <> True THEN
			CU.NAME = Email.Sender
			CU.MESSAGE_TXT = Email.Message
			...
		ELSE
			Info("This message was deleted")
		END
	END
END
```
<a name="Example2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 
```wl
// Use with the Outlook messaging software 
// TABLE_EmailTable table contains all the incoming emails
// COL_Sender contains the sender name (Email.Sender variable)
// COL_Subject contains the email subject (Email.Sujet variable)
// COL_ID contains the email identifier (Email.ID variable)
// Read the selected email in the Table control
EmailReadMessage(SessionID, COL_ID)
// Retrieve the email content
Info("Message of the email: " + Email.Message)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### La lectura de un Email gestionado por el protocolo POP3 o IMAP

`<Result> = EmailReadMessage(<Session> [, <Email>] , <Message number>)`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se leyó el mensaje. En este caso, la estructura de Email se actualiza automáticamente.

- <u><u><u><u>False</u></u></u></u> en caso contrario. Para obtener más información sobre el error, utilice la función [ErrorInfo](../WDLang1/3013008.md) con la constante *errMessage*.




La variable Email.Out se establece en <u><u><u><u>True</u></u></u></u> si no se encontró ningún mensaje (ningún correo electrónico).

**`<Session>: (Cadena de caracteres, o emailPOP3Session o emailIMAPSession Variable)`**

Identifica la sesión de usuario. Corresponde a:

- el nombre de usuario que se utilizó para iniciar la sesión de Email ([EmailStartSession](../WDLang3/3032028.md)).

- una variable de tipo [emailPOP3Session](../WDLang3/1000018759.md).

- una variable de tipo [emailIMAPSession](../WDLang3/1000018957.md).


![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Las variables de tipo [emailPOP3Session](../WDLang3/1000018759.md) y [emailIMAPSession](../WDLang3/1000018957.md) no son compatibles.

**`<Email>: (Correo electrónico opcional Variable)`**

Nombre de la [Email](../WDLang3/1000018713.md) Variable que se va a inicializar con el contenido del mensaje.
![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Este parámetro no está disponibleSi no se especifica este parámetro, se utiliza la estructura [Email](../WDLang3/3032029.md).

**`<Message number>: (Integro)`**



- Índice de mensaje a leer en POP3 

- Identificador (UID) del mensaje en IMAP. 





<a name="SYNTAX2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
### Lectura de un Email gestionado a través de Lotus Notes o Outlook

`<Result> = EmailReadMessage(<Session> [, <Email>] , <Message identifier>)`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se leyó el mensaje. En este caso, la estructura de Email se actualiza automáticamente.

- <u><u><u><u>False</u></u></u></u> en caso contrario. Para obtener más información sobre el error, utilice la función [ErrorInfo](../WDLang1/3013008.md) con la constante *errMessage*.




La variable Email.Out se establece en <u><u><u><u>True</u></u></u></u> si no se encontró ningún mensaje (ningún correo electrónico).

**`<Session>: (Entero, o emailOutlookSession o emailNotesSession Variable)`**

Identificador del actual período de sesiones de Email. Este identificador puede ser:

- un número entero devuelto por [EmailStartOutlookSession](../WDLang3/3032128.md) o [OutlookStartSession](../WDLang3/3032123.md). En este caso, no debe especificarse el parámetro  . 

- una variable de tipo [emailOutlookSession](../WDLang3/1000018767.md).

- una variable de tipo [emailNotesSession](../WDLang3/1000018768.md).

- una variable de tipo [emailIMAPSession](../WDLang3/1000018957.md).




**`<Email>: (Correo electrónico opcional Variable)`**

Nombre de la [Email](../WDLang3/1000018713.md) Variable que se va a inicializar con el contenido del mensaje.

Si no se especifica este parámetro, se utiliza la estructura [Email](../WDLang3/3032029.md).

**`<Message identifier>: (Cadena de caracteres)`**

Identificador del mensaje a leer. Este identificador se encuentra en la variable **Email.ID** al leer los correos electrónicos.  


<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Número de mensajes encontrados en el buzón (protocolo POP3)
<a name="numero_mensajes_encontrados_buzon_protocolo_pop3_ELTPARAGRAPHE000224"></a>

El número total de mensajes recibidos es devuelto por [EmailNbMessage](../WDLang3/3032024.md).

Si un mensaje fue borrado por [EmailDeleteMessage](../WDLang3/3032027.md) en la misma sesión de Email:

- [EmailNbMessage](../WDLang3/3032024.md) devuelve el número de mensajes encontrados en el servidor Email antes del borrado. 

- los números de los mensajes borrados no se reasignan.




Por ejemplo: Durante la conexión, se encuentran cuatro mensajes en el servidor. Estos mensajes están numerados del 1 al 4. Si se borra el mensaje nº 1:

- [EmailNbMessage](../WDLang3/3032024.md) vuelve 4.

- **EmailReadMessage** no se puede leer el mensaje: el mensaje ya no existe. La variable Email.Out devuelve <u><u><u><u>True</u></u></u></u>. Sólo existen los mensajes 2, 3 y 4.




Los números de mensaje se reasignan durante la siguiente conexión.
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 

### Número de mensajes encontrados en el buzón de correo (mensajería de Outlook)
<a name="numero_mensajes_encontrados_buzon_correo_mensajeria_outlook_ELTPARAGRAPHE000261"></a>

El número total de mensajes recibidos es devuelto por [EmailNbMessage](../WDLang3/3032024.md).

Si un mensaje fue borrado por [EmailDeleteMessage](../WDLang3/3032027.md) en la misma sesión de Email, [EmailNbMessage](../WDLang3/3032024.md) devuelve el número real de mensajes en la carpeta de entrada.
<a name="NOTE0_4"></a>


### Los archivos adjuntos
<a name="los_archivos_adjuntos_ELTPARAGRAPHE000279"></a>

Al leer un mensaje, los archivos adjuntos pueden copiarse en el disco local (o en el disco del servidor) mediante [EmailSaveAttachment](../WDLang3/3032020.md).

**Consejo**: Recomendamos que guardes los mensajes y sus archivos adjuntos en el disco local (o en un disco del servidor), y luego los borres del servidor Email. Esta operación está acostumbrada a:

- reducir el tamaño del buzón de correo en el servidor, 

- mejorar y acelerar las comunicaciones en los servidores POP3: sólo los nuevos mensajes serán leídos en el servidor.



<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Barra de progreso
<a name="barra_progreso_ELTPARAGRAPHE000296"></a>

Para seguir el progreso de la Email, utilice [EmailProgressBar](../WDLang3/3032017.md).
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 

### Mensajería de Outlook
<a name="mensajeria_outlook_ELTPARAGRAPHE000451"></a>

Las funciones WLanguage **EmailReadxxx** funcionan sólo con el archivo de datos de Outlook (.pst). Los otros archivos de datos no son compatibles.

<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Lógica de negocio
## Componente:
wd280com.dll
