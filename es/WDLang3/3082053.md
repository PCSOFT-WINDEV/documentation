


## zipPassword( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Define la contraseña utilizada para añadir archivos al archivo especificado y para extraer archivos del archivo especificado (formatos RAR, ZIP y WDZ).. La contraseña es associated con cada archivo.




<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
MyArchive is zipArchive

ArchivePath is string = CompleteDir(fCurrentDir()) + "Archive.ZIP"
IF fExtractPath(ArchivePath, fExtension) ~= ".zip" THEN
	IF zipOpen(MyArchive, ArchivePath) = 0 THEN
		 // Encrypt the archive
		 zipPassword(MyArchive, "Password")
		 zipAddFile(MyArchive, "C:\MyFile.txt")
		 // Add the file. The file is encrypted by the password
	END
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = zipPassword(<Archive> , <Password>)`
---

**`<Result>: (Integro)`**



- 0 si la contraseña se ha definido correctamente, 

- Un código de error (valor mayor que 0).




**`<Archive>: (Cadena de caracteres o zipArchive Variable)`**

Nombre del archivo que se va a utilizar.
Este nombre puede corresponder a:

- un nombre de archivo definido con [zipOpen](../WDLang3/3082044.md) o [zipCreate](../WDLang3/3082003.md).

- el nombre de una variable de tipo [zipArchive](../WDLang3/1000018679.md). 
	![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Las variables [zipArchive](../WDLang3/1000018679.md) no están disponibles en Java.




**`<Password>: (Cadena de caracteres)`**

Contraseña utilizada para cifrar los archivos añadidos o para descifrar los archivos extraídos. Esta contraseña debe utilizar caracteres con un código ASCII entre 1 y 127. Esta contraseña no puede exceder los 255 caracteres.

Para evitar cifrar los archivos añadidos o los archivos extraídos, tiene la posibilidad de utilizar una cadena vacía ("").  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Condiciones de uso
<a name="condiciones_uso_ELTPARAGRAPHE000108"></a>

- Los formatos RAR, ZIP y WDZ no protegen el archivo cuando se abre.. La contraseña es necesaria para extraer los archivos del archivo comprimido y para añadirlos al archivo comprimido.

- **Archivos en formato 7z**: Esta función no está disponible. 

- **Archivos en formato TAR y TGZ (TAR.GZ)**: Esta función no está disponible. 




![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Recordatorio: Sólo están disponibles los archivos ZIP, TAR y TGZ (TAR.GZ).
<a name="NOTE0_2"></a>


### Uso de un archivo comprimido cifrado con una contraseña
<a name="uso_archivo_comprimido_cifrado_con_una_contrasena_ELTPARAGRAPHE000121"></a>

La contraseña se define con **zipPassword**. Una vez definida la contraseña, se utiliza para todas las siguientes operaciones de archivo:  

- **Adición de archivos**: los archivos añadidos se cifrarán con esta contraseña

- **Extracción de archivos**: la contraseña se utilizará para descifrar todos los archivos extraídos.




La contraseña es Active para el archivo en el que se definió. La contraseña se pierde cuando se borra el archivo ([zipClose](../WDLang3/3082005.md)). Debe especificarse de nuevo después de [zipOpen](../WDLang3/3082044.md) o [zipCreate](../WDLang3/3082003.md).
<a name="NOTE0_3"></a>


### Varios
<a name="varios_ELTPARAGRAPHE000144"></a>

- Se puede especificar una contraseña diferente para cada archivo agregado o extraído en el mismo archivo comprimido.. Cada vez que se agrega o extrae un archivo, use **zipPassword** y especifique la contraseña que espera el archivo que se agregará o extraerá.

- No se puede modificar directamente la contraseña de un archivo encontrado en un archivo comprimido.. Debe extraer el fichero, borrarlo del archivo comprimido y volver a añadirlo al archivo comprimido con la nueva contraseña.

- [zipInfoFile](../WDLang3/3082040.md) se utiliza para saber si un fichero del archivo está encriptado (+) o Normal (N).



<a name="NOTE0_4"></a>


### Códigos de error
<a name="codigos_error_ELTPARAGRAPHE000157"></a>

Se devuelven los siguientes códigos de error:

- 23: Característica no disponible para este formato de archivo.


El mensaje correspondiente al código de error es devuelto por [zipMsgError](../WDLang3/3082034.md).

<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Lógica de negocio
## Componente:
wd280zip.dll
