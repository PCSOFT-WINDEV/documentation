
## Integre la autenticación de dos factores en sus aplicaciones
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000116"></a>
En la versión 26, WINDEV, WEBDEV y WINDEV Mobile permiten configurar un inicio de sesión por verificación de dos pasos.
Puede set la autenticación de dos factores a través de una aplicación estándar (Google Authenticator, Microsoft Authenticator u otra). Esta aplicación, para ser descargada en un teléfono móvil, devuelve un código personal bajo demanda (válido por 30 segundos) que debe ingresarse al iniciar sesión (protocolo TOTP).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## ¿Cómo proceder?
<a name="¿como_proceder_ELTTEXTE000140"></a>


### Principio
<a name="principio_ELTPARAGRAPHE000018"></a>

El principio es el siguiente: 

- La aplicación o el sitio con autenticación de dos factores requiere los siguientes elementos: 

	- el par nombre de usuario/contraseña

	- un identificador específico, generado por una aplicación de autenticación instalada en el móvil Phone. 




- La primera vez que el usuario intenta iniciar sesión a través de la autenticación de dos factores, la aplicación o el sitio genera un código (que puede aparecer como un código QR). Este código es una clave TOTP que debe ser almacenada: este código QR (o el código correspondiente) debe ser almacenado en la aplicación de autenticación en el Phone. La aplicación de autenticación proporciona al usuario un código de autenticación que debe utilizarse en la aplicación o el sitio para validar la conexión. 

- En los siguientes intentos de inicio de sesión, el usuario tendrá que facilitar el código proporcionado por la aplicación de autenticación. Este código es diferente cada vez y es válido por un periodo de tiempo limitado. 





### Implementación
<a name="implementacion_ELTPARAGRAPHE000030"></a>

Para implementar la autenticación de dos factores en una aplicación, debe crear: 

- una interfaz para el primer intento de inicio de sesión, para mostrar el código y/o el código QR requerido por la aplicación de autenticación. Para ello: 

	- generar la clave TOTP ([TwoFactorAuthenticationGenerateTOTPKey](../WDLang3/1000025974.md)). Esta clave debe ser almacenada en la aplicación. 

	- mostrar el código de barras necesario para registrar la aplicación/sitio en la aplicación de autenticación móvil ([TwoFactorAuthenticationGenerateLink](../WDLang3/1000025975.md)). 
			Observación: Este paso es opcional. También puede proporcionar la clave TOTP directamente al usuario, que introducirá la clave en la aplicación de autenticación móvil. 


 Ejemplo de código: 
	
	```wl
	// User unique identifier
	sAddress is string = Customer.CustomerID + "myaddress@mycompany.com"
	// Generate TOTP key
	sMobileAppKey is ANSI string = TwoFactorAuthenticationGenerateTOTPKey(sAddress)
	// Display the TOTP key in a bar code
	BAC_QR_Autenticator = TwoFactorAuthenticationGenerateLink(sMobileAppKey, ...
		sAddress, "My App")
	```


- una interfaz para permitir al usuario introducir el código de autenticación proporcionado por la aplicación de autenticación. Esta interfaz debe incluir: 

	- a 6 dígitos Editar control. 
			Atención, la control debe ser de tipo texto, porque la secuencia de 6 dígitos puede empezar por un cero. También es posible utilizar seis controles separados que acepten un número cada uno. Los controles utilizan entonces la opción "Fin de entrada automático" (pestaña "Detalles" de la ventana del control description).

	- a control Botón, por ejemplo, para comprobar el código proporcionado con [TwoFactorAuthenticationCheckCode](../WDLang3/1000025976.md).. Este es un ejemplo de código: 
			
		```wl
		sAddress is string = Customer.CustomerID + "myaddress@mycompany.com"
		sMobileAppKey is ANSI string = TwoFactorAuthenticationGenerateTOTPKey(sAddress) // Or stored key
		IF TwoFactorAuthenticationCheckCode(EDT_Code, sMobileAppKey) THEN ...
		```








<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Funciones de gestión de la autenticación de dos factores
<a name="funciones_gestion_autenticacion_dos_factores_ELTTEXTE000170"></a>
Las siguientes funciones de WLanguage se utilizan para la autenticación de dos factores de manipular: 



|   |   |
| --- | --- |
| [TwoFactorAuthenticationCheckCode](../WDLang3/1000025976.md) | Verifica el código dado por una aplicación de autenticación. |
| [TwoFactorAuthenticationGenerateLink](../WDLang3/1000025975.md) | Genera un enlace para registrar una cuenta en una aplicación de autenticación. Cuando se asocia a una control Código de barras, este enlace mostrará un código QR que se puede escanear en la app de autenticación instalada en la Phone. |
| [TwoFactorAuthenticationGenerateTOTPKey](../WDLang3/1000025974.md) | Genera una clave TOTP para un usuario de la aplicación. |








