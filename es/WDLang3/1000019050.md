


## <zipArchive Variable>.AddFile (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Añade un archivo (de cualquier tipo) a un archivo comprimido en formato CAB, ZIP, WDZ y 7z, TAR o TGZ (TAR.GZ) y lo comprime.. Esta función no se puede utilizar en los archivos RAR.

Para añadir los archivos encontrados en un directorio, utilice [.AddDirectory](../WDLang3/1000019078.md).



<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
MyArchive is zipArchive
ResCreate is int
ResAddFile is int
// Create the archive 
ResCreate = MyArchive.Create("C:\Temp\Archive.zip")
IF ResCreate = 0 THEN
	// Add a file into an archive
	ResAddFile = MyArchive.AddFile(...
			"C:\MyDirectory\MyFiles\File.pdf", zipDrive)
END
// Display an error message if the file was not added
IF ResAddFile <> 0 THEN 
	Error(zipMsgError(ResAddFile))
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Añadiendo un archivo mientras se especifica la sección ruta para mantener

`<Result> = <Archive>.AddFile(<File path> [, <Path section to keep> [, <Progress>]])`
---

**`<Result>: (Integro)`**



- 0 si se realizó la suma,

- un código de error (valor superior a 0) De lo contrario. Para más detalles sobre estos códigos de error, consulte la página web de observaciones.




**`<Archive>: (Variable de tipo zipArchive)`**

Nombre de un Variable de tipo [zipArchive](../WDLang3/1000018679.md) correspondiente al archivo en el que debe añadirse el fichero.

**`<File path>: (Cadena de caracteres)`**

Ruta del archivo que se va a añadir al archivo (260 caracteres como máximo, 90 como máximo para archivos TAR o TGZ (TAR.GZ)). Esta ruta puede ser una ruta completa o una ruta relativa al directorio actual.. Los caracteres comodín (\*,?) no están permitidos en el nombre del archivo.
Este archivo no debe superar los 4 GB. De lo contrario, se produce un error.

![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) El acceso ruta al fichero es un ruta completo o un ruta relativo al directorio de trabajo de la aplicación (devuelto por [fDataDir](../WDLang1/3036001.md)). Sólo los archivos encontrados en el directorio de trabajo pueden ser añadidos al archivo.. 

**`<Path section to keep>: (Constante opcional)`**

Indica la sección del fichero ruta que se guardará en el archivo:


|   |   |
| --- | --- |
| *zipDirectory*<br>(Valor predeterminado) | Guarda los diferentes directorios del fichero ruta así como el nombre del fichero y extension. Por ejemplo: \\Directory\\Files\\NombreArchivo.pdf |
| *zipDrive* | Guarda el archivo completo y absoluto ruta (nombre del disco, nombre de los directorios, nombre del archivo y archivo extension). Por ejemplo: C:\\Directory\\Files\\NombreArchivo.pdf<br>**Para el formato ZIP**: Esta constante no tiene ningún efecto.<br>**Para el formato 7z**: Esta constante y *zipDirectory* tendrán el mismo efecto<br><br>![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) Esta constante no está disponible ya que no hay raíz para la Drive.![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante y la constante *zipDirectory* tendrán el mismo efecto. |
| *zipNone* | Mantiene el nombre del archivo y extension. Por ejemplo: NombreDeArchivo.pdf |


**Si utiliza un archivo en formato .CAB**, solo se tiene en cuenta la constante *zipNone*. De hecho, el formato.CAB no puede utilizarse para guardar las rutas dentro del archivo.
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Este parámetro no está disponible: sólo se conservan el nombre del fichero y extension.

**`<Progress>: (Nombre de control o nombre de Procedure)`**

Modo de gestión de la barra de progreso. Este parámetro puede corresponder a: 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) el nombre de un control Barra de progreso encontrado en una ventana. La barra de progreso mostrará el progreso de adición y compresión del archivo que se está gestionando..  

- el nombre de un WLanguage Procedure. Para obtener más información sobre este procedimiento, consulte [Parámetros del procedimiento utilizado por la función <zipArchive Variable>.AddFile](../WDLang3/1000025730.md). 




**Si está utilizando un archivo en formato TAR o TGZ (TAR.GZ)** , la barra de progreso se actualiza solo al final de la adición del archivo. 



![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Este parámetro no está disponible.


<a name="SYNTAX2"></a>

### Añadiendo un archivo mientras se especifica la ruta a ignorar 

`<Result> = <Archive>.AddFile(<File path> [, <Path section to ignore> [, <Progress>]])`
---

**`<Result>: (Integro)`**



- 0 si se realizó la suma, 

- un código de error (valor superior a 0) De lo contrario. Para más detalles sobre estos códigos de error, consulte la página web de Observaciones.




**`<Archive>: (Variable de tipo zipArchive)`**

Nombre de un Variable de tipo [zipArchive](../WDLang3/1000018679.md) correspondiente al archivo en el que debe añadirse el fichero.

**`<File path>: (Cadena de caracteres)`**

Ruta del archivo que se va a añadir al archivo (260 caracteres como máximo, 90 como máximo para archivos TAR o TGZ (TAR.GZ)). Esta ruta puede ser una ruta completa o una ruta relativa al directorio actual.. Los caracteres comodín (\*,?) no están permitidos en el nombre del archivo.
Este archivo no debe superar los 4 GB. De lo contrario, se produce un error.

**`<Path section to ignore>: (Cadena de caracteres opcional)`**

Indica la sección del fichero ruta que no debe almacenarse en el archivo.. 
Por ejemplo, en WINDEV, si la ruta completa del fichero añadido al archivo es: "C:\\Mis Documentos\\Trabajo\\Reporte.doc" y si  es set a "C:\\Mis Documentos\\", sólo se conservará la sección "Trabajo\\Reporte.doc"..

**`<Progress>: (Nombre de control o nombre de Procedure)`**

Modo de gestión de la barra de progreso. Este parámetro puede corresponder a: 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) el nombre de un control Barra de progreso encontrado en una ventana. La barra de progreso mostrará el progreso de adición y compresión del archivo que se está gestionando..  

- el nombre de un WLanguage Procedure. Para obtener más información sobre este procedimiento, consulte [Parámetros del procedimiento utilizado por la función <zipArchive Variable>.AddFile](../WDLang3/1000025730.md). 




**Si está utilizando un archivo en formato TAR o TGZ (TAR.GZ)** , la barra de progreso se actualiza solo al final de la adición del archivo.



![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Este parámetro no está disponible.

<a name="SYNTAX3"></a>

### Añadiendo un archivo encontrado en un buffer (sólo en formato WDZ y ZIP)

`<Result> = <Archive>.AddFile(<File to add> , <Buffer management> , <Path to keep> [, <Progress>])`
---

**`<Result>: (Integro)`**



- 0 si se realizó la suma,

- un código de error (valor superior a 0) De lo contrario. Para más detalles sobre estos códigos de error, consulte la página web de Observaciones.




**`<Archive>: (Variable de tipo zipArchive)`**

Nombre de un Variable de tipo [zipArchive](../WDLang3/1000018679.md) correspondiente al archivo en el que debe añadirse el fichero.

**`<File to add>: (Buffer)`**

Buffer que corresponde al contenido del archivo que se añadirá al archivo comprimido.

**`<Buffer management>: (Constante)`**

Modo de gestión del búfer: 


|   |   |
| --- | --- |
| *zipInMemory* | Guarda el contenido del búfer (es decir, el archivo) en el archivo comprimido. |



**`<Path to keep>: (Cadena de caracteres)`**

Archivo ruta o nombre de archivo associated con el buffer que se mantendrá en el archivo.

**`<Progress>: (Nombre de control o nombre de Procedure)`**

Modo de gestión de la barra de progreso. Este parámetro puede corresponder a: 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) el nombre de un control Barra de progreso encontrado en una ventana. La barra de progreso mostrará el progreso de adición y compresión del archivo que se está gestionando..  

- el nombre de un WLanguage Procedure. Para obtener más información sobre este procedimiento, consulte [Parámetros del procedimiento utilizado por la función <zipArchive Variable>.AddFile](../WDLang3/1000025730.md). 




**Si está utilizando un archivo en formato TAR o TGZ (TAR.GZ)** , la barra de progreso se actualiza solo al final de la adición del archivo.




<a name="SYNTAX4"></a>

### Añadir un archivo usando un zipArchivedFile Variable

`<Result> = <Archive>.AddFile(<File> [, <Progress>])`
---

**`<Result>: (Integro)`**



- 0 si se realizó la suma,

- un código de error (valor superior a 0) De lo contrario. Para más detalles sobre estos códigos de error, consulte la página web de Observaciones.




**`<Archive>: (Variable de tipo zipArchive)`**

Nombre de un Variable de tipo [zipArchive](../WDLang3/1000018679.md) correspondiente al archivo en el que debe añadirse el fichero.

**`<File>: (Variable de tipo zipArchivedFile)`**

Nombre de la [zipArchivedFile](../WDLang3/1000019044.md) Variable que contiene información sobre el archivo a añadir (incluyendo su contenido).
El archivo no tiene que existir necesariamente en el disco: sólo se tiene en cuenta la información de este parámetro.

**`<Progress>: (Nombre de control o nombre de Procedure)`**

Modo de gestión de la barra de progreso. Este parámetro puede corresponder a: 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) el nombre de un control Barra de progreso encontrado en una ventana. La barra de progreso mostrará el progreso de adición y compresión del archivo que se está gestionando.

- el nombre de un WLanguage Procedure. Para obtener más información sobre este procedimiento, consulte [Parámetros del procedimiento utilizado por la función <zipArchive Variable>.AddFile](../WDLang3/1000025730.md).  




**Si está utilizando un archivo en formato TAR o TGZ (TAR.GZ)** , la barra de progreso se actualiza solo al final de la adición del archivo.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Condición de uso
<a name="condicion_uso_ELTPARAGRAPHE000664"></a>

La adición de archivos en un archivo comprimido se puede realizar si:

- El archivo existe (los archivos se crean con [.Create](../WDLang3/1000019160.md)).

- El archivo es accesible en lectura/escritura.

- El archivo es un archivo de una sola parte.

- El tamaño del archivo es inferior a 4 GB.




**Atención**: 

- **Archivos en formato CAB**: Los ficheros deben añadirse inmediatamente después de la creación del archivo.. Este formato no se puede utilizar para añadir archivos a un archivo comprimido existente..  

- **Archivos en formato 7z**: El archivo se comprime completamente cada vez que se llama **<zipArchive Variable>.AddFile**. Esta función se recomienda cuando se agrega un solo archivo. Si hay que añadir varios ficheros en el archivo, utilice [.AddFileList](../WDLang3/1000019159.md) o [.AddDirectory](../WDLang3/1000019078.md). 




El número máximo de archivos que se pueden incluir:

- en un archivo WDZ: 2 32 -1.

- en un archivo ZIP: 65535. 

- en un archivo CAB: 65535. 


Recordatorio: 

- ![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Sólo están disponibles los archivos en formato ZIP, TAR o TGZ (TAR.GZ).


<a name="NOTE0_2"></a>


### Nivel de compresión de archivos ZIP o 7z
<a name="nivel_compresion_archivos_zip_7z_ELTPARAGRAPHE000752"></a>

Los archivos añadidos en un archivo en formato ZIP o 7z están comprimidos por Default. El nivel de compresión de los ficheros añadidos a un archivo puede ser modificado por [zipCompressionLevel](../WDLang3/3082054.md).
<a name="NOTE0_3"></a>


### Códigos de error
<a name="codigos_error_ELTPARAGRAPHE000765"></a>

Se devuelven los siguientes códigos de error:

- 1: La ruta pasada como parámetro no existe.

- 2: Acceso denegado: el usuario no tiene suficientes derechos o el archivo se está utilizando actualmente. Si el archivo a insertar es un archivo de datos HFSQL, debe cerrarse con el siguiente código:
	
	```wl
	HClose(FileName)
	Multitask() // Waits for the effective file closing
	```


- 3: El archivo está corrupto.

- 4: La ruta no existe en el archivo.

- 5: No se puede escribir en el archivo.

- 7: El archivo ya se encuentra en el archivo.

- 8: No se puede añadir un archivo comprimido a sí mismo. Por ejemplo, "MiArchivo" no puede añadirse a "MiArchivo".




El mensaje correspondiente al código de error es devuelto por [zipMsgError](../WDLang3/3082034.md).
<a name="NOTE0_4"></a>


### Añadir un fichero que ya se encuentra en el archivo
<a name="anadir_fichero_que_encuentra_archivo_ELTPARAGRAPHE000790"></a>

Se produce un error al añadir un fichero que ya se encuentra en el archivo comprimido.. Se identifica un fichero según el ruta guardado en el archivo. Por lo tanto, dos archivos con el mismo nombre y con el mismo relativo ruta no se pueden añadir a un archivo comprimido.

Por ejemplo, la constante *zipNone* no se puede usar para agregar dos archivos con el mismo nombre que se encuentran en directorios diferentes.
<a name="NOTE0_5"></a>


### Índice de ficheros en el archivo
<a name="indice_ficheros_archivo_ELTPARAGRAPHE000802"></a>

Cuando se añade un fichero a un archivo, se le asigna automáticamente un índice. Este índice corresponde al orden de inclusión de los ficheros en el archivo. Para seleccionar un fichero en el archivo comprimido, puede utilizar:

- el elemento índice (observación: el índice de un elemento es devuelto por [.FindFile](../WDLang3/1000026330.md)).

- o la ruta del elemento guardado en el archivo.


<a name="NOTE0_6"></a>


### Ruta guardada (archivos en formato WDZ o ZIP)
<a name="ruta_guardada_archivos_formato_wdz_zip_ELTPARAGRAPHE000821"></a>

A continuación, array muestra las rutas que se guardan en el archivo de acuerdo con:

- el acceso ruta al fichero,

- la sección ruta para guardarla.


![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) El directorio actual es: "C:\\Temp":


|   |   |   |   |   |
| --- | --- | --- | --- | --- |
| **zipAddFile** | **Ubicación del archivo** | *zipNone* | *zipDirectory* | *zipDrive* |
| zipAddFile<br>("Archi", "Archivo.txt") | C:\\Temp\\Archivo.txt | Archivo.txt | Archivo.txt | Archivo.txt |
| zipAddFile<br>("Arcos", "Datos\\Archivo.txt") | C:\\Temp\\Data\\Archivo.txt | Archivo.txt | Data\\Archivo.txt | Data\\Archivo.txt |
| zipAddFile<br>("Arcos", "D:\\Datos\\Archivo.txt") | D:\\Data\\Archivo.txt | Archivo.txt | Data\\Archivo.txt | D:\\Data\\Archivo.txt |


**Observación**: Si se utiliza la constante *zipDrive*, el formato WDZ conserva la ruta completa del archivo (incluida la letra de unidad) mientras que el formato ZIP no conserva la letra de unidad.


 
![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) El disco no se guarda en el archivo ruta.

![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) El directorio y el disco no se guardan en el archivo ruta. Sólo se conservan el nombre del fichero y extension. 

<a name="XComponent"></a>

## Componente:
wd280zip.dll
