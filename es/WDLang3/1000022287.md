


## <Email Variable>.ImportHTML (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Importa el contenido de un archivo HTML a un correo electrónico de Variable para enviarlo por Email. Las imágenes que se encuentran en el archivo HTML se incluyen automáticamente en el correo electrónico Variable. 

La actual [Email](../WDLang3/1000018713.md) Variable está llena: las propiedades **NbAttach**, **Attach**[...] y **HTML** se inicializan según el contenido HTML.
Observación: Se procesan las imágenes integradas mediante codificación en el archivo HTML.

Observación: El contenido HTML sólo es compatible con POP3/SMTP: esta función debe ser utilizada sólo si la Email se envía en SMTP.


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
MyEmail is Email
MyHTMLText is ANSI string
MyHTMLText = fLoadText("C:\Email\MyEmail.htm")
MyEmail.ImportHTML(MyHTMLText"C:\Email")

MyEmail.Recipient = "contact@gmail.com"
MyEmail.Subject = "Test"
EmailSendMessage(MySMTPSessionSMTP,MyEmail)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Email>.ImportHTML(<HTML content to send> , <Directory>)`
---

**`<Email>: (Envía un correo electrónico a Variable)`**

Nombre de la variable [Email](../WDLang3/1000018713.md) correspondiente al correo electrónico en el que se importará el HTML Document.

**`<HTML content to send>: (Cadena de caracteres ANSI)`**

Contenido de Email en formato HTML.

**`<Directory>: (Cadena de caracteres)`**

Directorio reference para las imágenes (caso de rutas relativas en el contenido HTML).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Modo de funcionamiento de las imágenes y archivos adjuntos
<a name="modo_funcionamiento_las_imagenes_archivos_adjuntos_ELTPARAGRAPHE000254"></a>

Si el contenido &lt;HTML a enviar&gt; se refiere a imágenes:

- estas imágenes se adjuntan automáticamente al correo electrónico en el [Email](../WDLang3/1000018713.md) variable.

- el código HTML del mensaje es modificado para reference los archivos adjuntos.




**Atención**: Los anexos se "añaden" a la Email. Por ejemplo, si el **NbAttach** Property es set a 2 antes de la llamada a la función **<Email Variable>.ImportHTML** y si el contenido HTML hace referencia a una imagen, esta imagen se incluirá en el **Attach[3]** Property y el **NbAttach** será set a 3.

Los archivos adjuntos adicionales deben agregarse antes de utilizar la función **<Email Variable>.ImportHTML**.

El orden de envío de los anexos no se respeta necesariamente cuando se recibe la Email.
El identificador de las imágenes es un identificador único.Observación: Al importar en una [Email](../WDLang3/1000018713.md) Variable, también se procesan las imágenes integradas por codificación en el archivo HTML de origen.



<a name="XComponent"></a>

## Componente:
wd280com.dll
