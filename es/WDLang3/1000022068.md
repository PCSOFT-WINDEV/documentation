


## BTLEConnectionStatus (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Devuelve el estado actual de la conexión a un dispositivo Bluetooth de bajo consumo de energía o pide que se le notifique cuando cambia el estado de la conexión.. 

**Observación**: Las funciones de Bluetooth no están disponibles en el emulador de Android.


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
myDevice is btleDevice
BTLEConnect(myDevice)
...
SWITCH BTLEConnectionStatus(myDevice)
	CASE btleStatusConnected
	// Process
	OTHER CASE
	...
END
```

<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX1"></a>

### Averiguar el estado actual de la conexión

`<Result> = BTLEConnectionStatus(<Device>)`
---

**`<Result>: (Constante de tipo Integer)`**

Estado de la conexión: 


|   |   |
| --- | --- |
| *btleStatusConnected* | El dispositivo está conectado al dispositivo Bluetooth especificado. |
| *btleStatusDisconnected* | El dispositivo no está conectado al dispositivo Bluetooth especificado. |



**`<Device>: (btleDevice Variable)`**

Nombre de la [btleDevice](../WDLang3/1000022054.md) Variable correspondiente al dispositivo a utilizar.


<a name="SYNTAX2"></a>

### Habilitar el Notification cuando la activación del Bluetooth cambia

`BTLEConnectionStatus(<WLanguage procedure>)`
---

**`<WLanguage procedure>: (Nombre de Procedure)`**

Nombre de WLangage Procedure ("callback" Procedure) al que se llamará cuando cambie el estado de la conexión Bluetooth en el dispositivo. Este procedimiento tiene el siguiente formato : 


```txt
PROCEDURE <Procedure name> (<Device>, <Status>)
```
donde: 

- &lt;Device&gt; es un [btleDevice](../WDLang3/1000022054.md) Variable correspondiente al dispositivo Bluetooth cuyo estado se recupera. 

- &lt;Status&gt; es un número entero que corresponde al estado de la conexión Bluetooth en el dispositivo.: 
	


|   |   |
| --- | --- |
| *btleStatusConnected* | El dispositivo está conectado al dispositivo Bluetooth especificado. |
| *btleStatusDisconnected* | El dispositivo no está conectado al dispositivo Bluetooth especificado. |




No hay necesidad de pasarle parámetros a este Procedure. De hecho, estos parámetros se rellenan automáticamente durante cada llamada.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


**Versiones necesarias**


- ![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png) **Aplicaciones WEBDEV**: 

	- Las funciones de Bluetooth Low Energy WLanguage sólo están disponibles en:  

		- PCs que soportan al menos Bluetooth Low Energy 5. 

		- PCs que utilicen un dispositivo Bluetooth que soporte al menos Bluetooth Low Energy 5. 




- Si es necesario, puede comprobar la versión de Bluetooth de un PC en el administrador de dispositivos de Windows: [https://support.microsoft.com/en-us/windows/what-bluetooth-version-is-on-my-pc-f5d4cff7-c00d-337b-a642-d2d23b082793](https://support.microsoft.com/en-us/windows/what-bluetooth-version-is-on-my-pc-f5d4cff7-c00d-337b-a642-d2d23b082793)

- El emparejamiento debe hacerse a través de Windows. Por lo tanto, [BTLEListDevice](../WDLang3/1000021882.md) sólo listará los dispositivos que sean Visible y associated en la configuración de Bluetooth de Windows.




<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Lógica de negocio
## Componente:
wd280com.dll
