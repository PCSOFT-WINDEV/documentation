


## Desarrollo de un sitio SaaS
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000343"></a>
Un sitio SaaS se desarrolla como un sitio WEBDEV estándar. 

Se deben realizar algunas operaciones adicionales:

- [Permitir la implementación de SaaS a nivel de proyecto](#NOTE2_1).

- [Definir la página de conexión (si no se utiliza el mecanismo de conexión de automatic)](#NOTE3_1).

- [Llamando al Webservice para comprobar las autorizaciones de acceso a los diferentes servicios del sitio](#NOTE4_1).

- [Personalización del sitio según la cuenta de cliente utilizada](#NOTE5_1).

- [Configuración del modo de prueba](#NOTE6_1). 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Habilitación de la implementación de SaaS
<a name="habilitacion_implementacion_saas_ELTTEXTE000367"></a>
Para permitir la implementación de las características SaaS en el proyecto: 

1. En la pestaña "Proyecto", en el grupo "Proyecto", haga clic en "Descripción".

2. En la pestaña "Proyecto", marque "Sitio SaaS (Software as a Service)": <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ConfigSaaSProjet.gif)


3. Especifique (si es necesario) el nombre del Servidor de Aplicación (o el Address completo del Servicio Web SaaS) que se utilizará para el modo de prueba. 
	Para usar el servidor SaaS local, no se debe especificar Address. 
	Para obtener más información, consulte [Configuración del modo de prueba](#NOTE5_1). 

4. Especifique el modo de conexión: 

	- Marque "Utilizar el modo "Conexión automática"" para utilizar el modo de conexión integrado de WEBDEV. 

	- Desmarque esta casilla si desea personalizar la página para conectarse a la aplicación.. 





Para obtener más información, consulte [Modo de conexión](#NOTE3_1). 

<a name="NOTE3"></a>


## Modo de conexión
<a name="modo_conexion_ELTTEXTE000391"></a>
<a name="NOTE3_1"></a>


### Página para la conexión con automatic
<a name="pagina_para_conexion_con_automatic_ELTPARAGRAPHE000087"></a>

Cuando un sitio SaaS utiliza la página para la conexión de automatic, el servidor de aplicaciones WEBDEV genera una página que permite al usuario conectarse al sitio.

Esta página tiene en cuenta las siguientes operaciones:

- Escribiendo el nombre de usuario y la contraseña.

	- Un enlace se utiliza para administrar la contraseña olvidada. En este caso, se envía un Email al usuario con el código de seguridad correspondiente. 
			Atención: Para utilizar esta función, se debe rellenar el Email Address del usuario y configurar el administrador SaaS para enviar Email por SMTP.

	- Después de 3 intentos de introducir la contraseña, se solicita la entrada de un captcha además de la contraseña para la identificación.. 




- Llamada a [SaaSConnect](../WDLang3/1000018959.md) para comprobar la información de autentificación.

- Comprobar si el usuario posee una licencia para al menos un servicio suministrado por el sitio.

- Cambio automático de la conexión de todos los archivos de datos para el análisis del sitio.
	Este cambio es equivalente al siguiente código:
	
	```wl
	HChangeConnection("*", SaaSClientConnection())
	```





**Beneficios de este método**:

- Si el sitio define un solo servicio, no hay nada que programar.

- Prueba rápida para cambiar un sitio a SaaS.

- Posibilidad de mejorar el resultado de las llamadas automatic utilizando [HChangeConnection](../WDLang4/3044150.md) o [Servicio SaaSCheckService](../WDLang3/1000018961.md) en el sitio.



<a name="NOTE3_2"></a>


### Página para conexión personalizada
<a name="pagina_para_conexion_personalizada_ELTPARAGRAPHE000129"></a>

Si no se utiliza el mecanismo de conexión de automatic, se debe implementar un mecanismo en una de las páginas del sitio para permitir la autenticación del usuario hacia el Servicio Web SaaS. 

La página de conexión debe:

1. Llame a [SaaSConnect](../WDLang3/1000018959.md) para establecer la conexión con el servicio web SaaS.

2. Compruebe los servicios que puede utilizar el usuario ([Servicio SaaSCheckService](../WDLang3/1000018961.md)).

3. Cambiar la conexión de los archivos de datos del análisis mediante [HChangeConnection](../WDLang4/3044150.md). La información de conexión del usuario actual de SaaS puede ser recuperada por [Acceso a SaaSClientLogin](../WDLang3/1000019016.md).




**Beneficios de este método:**

- Posibilidad de personalizar la página de conexión.

- La página de conexión no es necesariamente la primera página del sitio. Puede tener una sección "pública" Visible por todos y una sección "privada" accesible a los usuarios autentificados.



<a name="NOTE3_3"></a>


### Observaciones
<a name="observaciones_ELTPARAGRAPHE000159"></a>

- Incluso la sección pública de un sitio puede requerir una llamada a [SaaSConnect](../WDLang3/1000018959.md) (utilizando un identificador de "invitado") para permitir la personalización de la interfaz de usuario a través de los parámetros associated con la cuenta de cliente SaaS. Para obtener más información, consulte [Personalización de un sitio SaaS](#NOTE5_1).

- Le aconsejamos que acceda a la página de conexión utilizando el protocolo HTTPS para evitar que la información de autenticación se desplace por la red.

- Para aumentar la seguridad del sitio SaaS, el Webservice puede instalarse en un ordenador al que no se puede acceder públicamente, sino sólo desde el servidor de aplicaciones WEBDEV que aloja el sitio SaaS.. Por lo tanto, las peticiones hechas al Webservice no pueden ser interceptadas.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Verificación de las autorizaciones
<a name="verificacion_las_autorizaciones_ELTTEXTE000427"></a>
Puede segmentar las diferentes prestaciones que ofrece un sitio SaaS declarando los servicios en la [Administrador SaaS](../SaaSAdminWeb/1600000.md). Estos servicios se ponen a disposición de los usuarios a través de un sistema de precios.. Una determinación de precio agrupa uno o más servicios. Las cuentas de usuario se suscriben a los precios y distribuyen las licencias a sus usuarios.

Llama a [Servicio SaaSCheckService](../WDLang3/1000018961.md) para comprobar si el usuario conectado tiene una licencia para una funcionalidad del sitio.

Por ejemplo, puede visualizar un mensaje de error y redirigir al usuario. [Servicio SaaSCheckService](../WDLang3/1000018961.md) se utiliza en el código de inicialización de una página de la siguiente manera: 


```wl
// Checks whether the user is allowed to add new incidents into the database
IF SaaSCheckService("Adding incidents") = False THEN
	Error("Your subscription level does not allow you to add new incidents.")
	PageDisplay(PAGE_BugList)
END
```


También puede ocultar los elementos a los que el usuario no puede acceder:


```wl
// Hides the chart of statistics 
// if the subscription of the current user does not include the "statistics" service
CHART_Stat.Visible = SaaSCheckService("statistics")
```



### Observación
<a name="observacion_ELTPARAGRAPHE000198"></a>

Incluso en los sitios que ofrecen un número limitado de servicios, siempre es useful declarar constantes que correspondan a los nombres de los servicios, para evitar errores tipográficos en las llamadas a [Servicio SaaSCheckService](../WDLang3/1000018961.md).

<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Personalización de un sitio SaaS
<a name="personalizacion_sitio_saas_ELTTEXTE000457"></a>
La interfaz gráfica de usuario y el modo de funcionamiento de un sitio SaaS se pueden personalizar para cada cuenta de cliente.. Esta personalización se puede hacer de la siguiente manera:

- Leyenda dependiendo de la cuenta del cliente.

- Imágenes específicas para cada cuenta de cliente.

- Modo de funcionamiento interno (algoritmos del sitio) en función de la cuenta del cliente.




La mayor parte del ajuste según el cliente se basa en el uso de [SaaSReadSiteParameter](../WDLang3/1000019037.md).

El administrador del sistema SaaS puede definir uno o varios parámetros para cada sitio declarado en el [Administrador SaaS](../SaaSAdminWeb/1600000.md). Estos parámetros (identificados por sus nombres) pueden ser leídos de nuevo en el código del sitio a través de [SaaSReadSiteParameter](../WDLang3/1000019037.md) para cambiar el comportamiento del sitio.

Por ejemplo:

- **Configurar el logotipo y el título de las páginas del sitio**
	Este código puede ser utilizado en una página modelo, que se encuentra en la página de cada sitio..
	
	```wl
	// Configure the GUI of the SaaS site
	IMG_Logo = SaaSReadSiteParameter("LogoImage")
	EDT_Title = SaaSReadSiteParameter("ClientTitle")
	```

	En este ejemplo, todo lo que tiene que hacer es declarar "LogoImage" y "ClientTitle" como parámetros del sitio y personalizar su valor para cada cuenta de cliente.




- **Configuración del algoritmo del sitio**
	
	```wl
	bIsAPro is boolean
	bIsAPro = SaaSReadSiteParameter("ProAccount")
	
	IF bIsAPro = True THEN
		ApplyProDiscount()
	ELSE
		ApplyRewardCardDiscount()
	END
	```

	En este ejemplo, el parámetro "ProAccount" especifica si la cuenta del cliente hace referencia a un usuario profesional o a un usuario estándar y se llama a un Process específico de acuerdo con esta información.




<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Configuración del modo de prueba
<a name="configuracion_del_modo_prueba_ELTTEXTE000481"></a>
Se pueden utilizar varias configuraciones para iniciar un sitio SaaS en modo de prueba:

- Uso de un servidor de aplicaciones WEBDEV.

- Uso de un servidor de aplicaciones WEBDEV para la prueba (limitado a 10 conexiones). 

- Uso de un servidor SaaS local.  





### Uso de un servidor de aplicaciones WEBDEV (limitado o no a 10 conexiones)
<a name="uso_servidor_aplicaciones_webdev_limitado_10_conexiones_ELTPARAGRAPHE000257"></a>

Para utilizar un servidor de aplicación WEBDEV en modo de test, debe especificar:

- su nombre (o dirección IP) en el campo correspondiente de la ventana del proyecto description (pestaña "Proyecto", grupo "Proyecto", "Descripción").

- la URL completa del servicio web (si desea utilizar el protocolo HTTPS, por ejemplo). 





### Uso de un servidor SaaS local
<a name="uso_servidor_saas_local_ELTPARAGRAPHE000279"></a>Para utilizar un servidor de aplicación WEBDEV local en modo de prueba, no se debe especificar ninguna dirección para el servidor SaaS en el proyecto description. 
Para iniciar el administrador local de SaaS, vaya a la pestaña "Herramientas", grupo "Web utilities" y haga clic en "WDAdminSaaS".




