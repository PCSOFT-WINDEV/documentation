
## emailSMTPSession (Tipo de Variable)

*** ***
				



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
El tipo **emailSMTPSession** permite acceder a un servidor de mensajería utilizando el protocolo SMTP (Simple Mail Transfer Protocol) para enviar correos electrónicos. Las características de la conexión pueden definirse y modificarse mediante diferentes propiedades de WLanguage.

**Observaciones**:

- Para obtener más información sobre la declaración de este tipo de variable y el uso de propiedades WLanguage, consulte [Declarar una variable](../Motscles/1514032.md).

- En la mayoría de los casos, el servidor SMTP a utilizar es el servidor SMTP del proveedor INTERNET (y no el de la cuenta Email). Por ejemplo, si tienes acceso a INTERNET a través de Orange y una cuenta de Email Libre, debes usar el servidor SMTP de Orange (y no el de Libre). Para utilizar un servidor SMTP diferente, debe utilizar un servidor SMTP autenticado, que requiere una conexión segura en la mayoría de los casos.







<a name="XExample1"></a>
<a name="sample_code"></a>

## Ejemplo

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 
```wl
// Connection with authentication 
// SMTP session with TLS
MySMTPSession is emailSMTPSession
OAuthGoogleCnt is OAuth2Parameters

// OAuth connection parameters
OAuthGoogleCnt.ClientID = "Application ID"
OAuthGoogleCnt.ClientSecret = "Secret application ID"
OAuthGoogleCnt.AuthURL = "https://accounts.google.com/o/oauth2/auth"
OAuthGoogleCnt.TokenURL = "https://accounts.google.com/o/oauth2/token"
OAuthGoogleCnt.Scope = "https://mail.google.com/"
OAuthGoogleCnt.RedirectionURL = "http://localhost:9000"
OAuthGoogleCnt.ResponseType = oauth2ResponseTypeCode

// OAuth authentication
MySMTPSession.ServerAddress = "smtp.gmail.com"
MySMTPSession.Name = "user@gmail.com"
MySMTPSession.Password = "secret"
MySMTPSession.Port = 587
MySMTPSession.Option = emailOptionSecuredTLS
MySMTPSession.AuthToken = AuthIdentify(OAuthGoogleCnt)

// If the authentication was successful, log in to email inbox
IF MySMTPSession.AuthToken <> Null THEN
	IF EmailStartSession(MySMTPSession) = False THEN
		// Error while starting the session
		Error("Unable to start the SMTP session.", ErrorInfo(), ...
			"In case of timeout, check the parameters of the " + ...
			"""Firewall"" on the port used (" + ...
			MySMTPSession.Port + ")")
		RETURN
	END
	// Send a message
	MyEmail is Email
	...
	EmailSendMessage(MySMTPSession, MyEmail)
	...
	EmailCloseSession(MySMTPSession)
ELSE
	// Authentication error
END
```

<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Propiedades específicas de las variables emailSMTPSession
<a name="propiedades_especificas_las_variables_emailsmtpsession_ELTPARAGRAPHE000058"></a>

Las siguientes propiedades se pueden utilizar para manipular una variable de tipo **emailSMTPSession**:

| Nombre de la propiedad | Tipo utilizado | Efecto |
| --- | --- | --- |
| Asíncrono | Constante booleana o entera | <br><br>- *emailAsynchronous* (o <u><u><u><u>True</u></u></u></u>) si los correos electrónicos enviados durante la sesión iniciada con la función [EmailStartSMTPSession](../WDLang3/3032025.md) deben transmitirse en modo asíncrono.<br><br>- *emailSynchronous* (o <u><u><u><u>False</u></u></u></u>) en caso contrario (valor predeterminado).<br><br><br><br><br><br><br><br><br>![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Esta propiedad no está disponible: la operación de envío se realiza siempre en modo síncrono. |
| AuthToken | Variable de tipo [AuthToken](../WDLang3/1000022220.md) | Acceso al servidor Email Token que se utilizará si se utiliza el protocolo OAuth 2.0 (autenticación de dos factores). Este acceso Token es recuperado por [AuthIdentify](../WDLang3/1000022219.md).<br><br>![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Esta propiedad no está disponible. |
| Contraseña | Cadena de caracteres | Contraseña de usuario. Esta contraseña es proporcionada por el proveedor de servicios o por el administrador de la red.. Esta contraseña se utiliza para iniciar una sesión SMTP autenticada. |
| denominar | Cadena de caracteres | Nombre de usuario que se utilizará para las sesiones SMTP autenticadas. |
| Opción | Constante de tipo Integer | Opciones de conexión SMTP. Los valores posibles son:<br><br>- *emailOptionDefault* (valor de Default): Iniciar una sesión SMTP no segura. En este caso, el puerto estándar es el puerto 25.<br><br>- *emailOptionSecuredTLS*: Iniciar una sesión SMTP protegida por el protocolo TLS. En este caso, el puerto estándar es el puerto 587.<br><br>- *optionSSL*: Iniciar una sesión SMTP protegida por el protocolo SSL. En este caso, el puerto estándar es el puerto 465. <br><br><br><br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Este Property no se apoya. |
| Puerto | Integro | Identifica el puerto utilizado para el protocolo SMTP (25 por Default). |
| ServerAddress | Cadena de caracteres | Nombre DNS o IP Address del servidor Email (protocolo de salida). Este Address es suministrado por el proveedor de servicios o por el administrador de la red.<br><br>**Atención**: Debe utilizar el servidor SMTP del proveedor de la conexión de INTERNET. Este servidor SMTP puede no tener ningún vínculo con el servidor SMTP associated con la cuenta Email. |


<a name="NOTE0_3"></a>


### Funciones que utilizan las variables de emailSMTPSession
<a name="funciones_que_utilizan_las_variables_emailsmtpsession_ELTPARAGRAPHE000155"></a>




|   |   |
| --- | --- |
| [EmailCloseSession](../WDLang3/3032006.md) | Cierra una sesión de gestión de Email en función del modo seleccionado (SMTP/POP3, IMAP, MS Exchange o Lotus Notes). |
| [EmailSendMessage](../WDLang3/3032005.md) | Envía un Email utilizando un protocolo determinado (SMTP, MS Exchange, Lotus Notes, Outlook). |
| [EmailStartSession](../WDLang3/3032028.md) | Inicia una sesión de gestión de Email en función del modo de gestión seleccionado (POP3, SMTP, IMAP o MS Exchange). |








