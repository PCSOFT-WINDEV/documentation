


## FTPConnect (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Conecta el ordenador actual a un servidor FTP (File Transfer Protocol).

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png) Los modos de conexión segura disponibles son los siguientes: 

- FTPS: FTP asegurado según el protocolo SSL con encriptación implícita. 

- FTPES: FTP asegurado según el protocolo SSL con encriptación explícita. 

- SFTP: FTP asegurado por un canal SSH.



<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Connect the current computer to the FTP server
ResConnect = FTPConnect("192.54.12.8")
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = FTPConnect(<Server> [, <User name> [, <Password> [, <Port number> [, <Type of connection> [, <Connection timeout> [, <Private key> [, <Key password>]]]]]]])`
---

**`<Result>: (Integro)`**



- Identificador de la conexión,

- 0 durante la primera conexión.

- -1 si se produce un error. Los detalles del error son devueltos por [ErrorInfo](../WDLang1/3013008.md) con la constante *errCode* o *errMessage*. 
	Si se produce un error de identificación, [ErrorInfo](../WDLang1/3013008.md) con la constante *errCode* devuelve la constante *ftpErrorAuthentification*.






**`<Server>: (Cadena de caracteres (con comillas))`**

Nombre del servidor FTP ("ftp.cdrom.com" por ejemplo) o dirección IP del servidor FTP ("192.54.12.8" por ejemplo).

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png) Este parámetro se utiliza para definir el protocolo utilizado: 

- si el nombre del servidor empieza por "ftp://", la conexión se establece en modo no seguro. 

- si el nombre del servidor comienza por "ftps://", la conexión se establece en modo seguro según el protocolo FTPS (FTP protegido por SSL con encriptación implícita). 

- si el nombre del servidor comienza por "ftpes://", la conexión se establece en modo seguro según el protocolo FTPES (FTP protegido por SSL con cifrado explícito). 

- si el nombre del servidor empieza por "sftp://", la conexión se establece en modo seguro a través de un canal SSH según el protocolo SFTP. 




**`<User name>: (Cadena de caracteres opcional (con comillas))`**



- Nombre del usuario que intenta realizar una conexión con nombre (autenticación de usuario en el servidor FTP). Este parámetro es dado por el administrador del servidor FTP.

- Cadena vacía (""") para realizar una conexión anónima.




**`<Password>: (Cadena de caracteres opcional (con comillas))`**

Contraseña del usuario: usado para identificar al usuario en el servidor FTP. Este parámetro es dado por el administrador del servidor FTP.

Esta contraseña corresponde a:

- la &lt;Contraseña&gt; especificada si este parámetro no es una cadena vacía ("""), 

- la dirección de correo electrónico del usuario si &lt;Nombre de usuario&gt; no se especifica o es igual a una cadena vacía ("""), 

- una cadena vacía (""") si no se especifica este parámetro y si &lt;Nombre de usuario&gt; no corresponde a una cadena vacía (""").




**`<Port number>: (Entero opcional)`**

Número del puerto en el que se ejecutará el servidor. Este parámetro es dado por el administrador del servidor FTP.

Por defecto: 

- para una conexión no segura, este puerto es el puerto 21.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png) para una conexión segura en modo FTPS, este puerto es el puerto 990. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png) para una conexión segura en modo FTPES, este puerto es el puerto 21.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png) para una conexión segura en modo SFTP, este puerto es el puerto 22.




**`<Type of connection>: (Constante opcional de tipo Integer)`**

Tipo de conexión a establecer: 



|   |   |
| --- | --- |
| *ftpActiveMode* (o <u><u><u><u>False</u></u></u></u> para compatibilidad) | **Conexión activa** al servidor FTP. <br><br>Durante la transferencia de un archivo, el cliente toma la iniciativa de la transferencia. Este tipo de conexión puede ser rechazada por algunos servidores FTP protegidos. |
| *ftpPassiveMode* (o <u><u><u><u>True</u></u></u></u> para compatibilidad)<br>(Valor predeterminado) | **Conexión pasiva** al servidor FTP (modo PASV). <br><br>Al transferir archivos, el servidor toma la iniciativa para la transferencia. Este tipo de conexión se utiliza para pasar por encima de algunos "firewalls".<br><br>Observación: Si la conexión al servidor es en IPV6, la conexión se realizará en modo pasivo extendido (porque el modo pasivo no soporta IPV6).. |
| *ftpExtendedPassiveMode* | **Conexión pasiva extendida** al servidor FTP (modo EPSV). <br><br>Al transferir archivos, el servidor toma la iniciativa para la transferencia. Este tipo de conexión se utiliza para pasar por encima de algunos "firewalls".. <br><br>Si el servidor no soporta el modo pasivo extendido (el comando FEAT se envía al servidor para averiguar la capacidad), la conexión se interrumpe en modo pasivo simple.. <br><br>Limitaciones: <br><br>- Este modo no se soporta cuando se utiliza el módulo "wininet" de Windows (ver [Parámetros FTP](../WDLang3/1000020947.md)): la conexión se realiza en *ftpPassiveMode*. <br><br>- ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Constante no disponible.<br><br><br> |



**`<Connection timeout>: (Entero o duración opcional)`**

Número de segundos después de los cuales se cancela la solicitud de conexión al servidor FTP (20 por defecto). Este tiempo de espera se aplica a todas las operaciones FTP realizadas en esta conexión.. Si no se recibe ninguna respuesta del servidor durante el tiempo de espera de conexión especificado, **FTPConnect** devuelve -1.
Observación: Este parámetro puede corresponder a: 

- un número entero correspondiente al número de segundos,

- una variable de tipo Duration,

- la indicación directa de la duración (por ejemplo, "1s"). 




**`<Private key>: (Cadena de caracteres opcional (con comillas))`**

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png) Nombre y ruta del archivo correspondiente a la clave privada utilizada durante una conexión en modo SFTP. Este fichero debe haber sido generado en formato OpenSSH. 
Si no se especifica este parámetro, la conexión segura utiliza una autenticación mediante &lt;Nombre de usuario&gt;/&lt;Contraseña&gt;.. 

**`<Key password>: (Cadena de caracteres ANSI opcional (con comillas))`**

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png) Contraseña del archivo que contiene la clave privada utilizada durante una conexión en modo SFTP. Si no se especifica este parámetro, la conexión segura utiliza una autenticación mediante &lt;Nombre de usuario&gt;/&lt;Contraseña&gt;.. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Navegador de Internet
<a name="navegador_internet_ELTPARAGRAPHE000197"></a>

La función **FTPConnect** requiere Internet Explorer en versión 3 o posterior.

Las modificaciones realizadas en &lt;Timeout&gt; no tienen efecto con algunas versiones de Internet Explorer. Es un problema conocido de los componentes de Microsoft que se corrige en las versiones más recientes de Internet Explorer (versión 5.1 y posteriores).
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) 

### Error de seguridad en una conexión FTPS segura
<a name="error_seguridad_una_conexion_ftps_segura_ELTPARAGRAPHE000212"></a>

Durante una transacción segura, la función puede fallar debido a errores de seguridad:

- certificado no válido o certificado procedente de una empresa desconocida.

- nombre del sitio que se encuentra en el certificado que no corresponde a un servidor.

- fecha del certificado inválido o caducado.




Usted tiene la capacidad de conectarse mientras ignora estos errores. Para ello, utilice la función **FTP.IgnorarError** variable:

| Valor de FTP.IgnoreError<br>(estos valores se pueden combinar) | Descripción |
| --- | --- |
| *ftpIgnoreInvalidCertificate* | El certificado se ignora. |
| *ftpIgnorarCertificadoVencido* | Se ignora la fecha del certificado. |
| *ftpIgnoreInvalidCertificateName* | Se ignora el nombre del sitio especificado en el certificado. |
| *ftpIgnorarRevocación* | Se ignora la revocación del certificado. |


```wl
// Example for error management

xnum is int
FTP.IgnoreError = ftpIgnoreExpiredCertificate + ftpIgnoreInvalidCertificate + ...
	ftpIgnoreInvalidCertificateName + ftpIgnoreRevocation
xnum = FTPConnect("ftpes://My_Server_IP", "My_User", "My_Password", 21, True)
IF xnum =-1  THEN
       Info(ErrorInfo(errMessage))
ELSE
       Info("OK")
END
```

<a name="NOTE0_4"></a>



<a name="XComponent"></a>

## Componente:
wd280com.dll
