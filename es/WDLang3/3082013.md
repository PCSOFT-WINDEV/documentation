


## zipCreateExe (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Crea un archivo autoextraíble como ejecutable de 32 bits (.EXE). Cuando se ejecuta este ejecutable, los archivos encontrados en el archivo comprimido se descomprimen automáticamente en el equipo actual.
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000003082013&name=zipcreateexe_funcion&product=WD">Ver ejemplos adicionales</a>

```wl
// Declare the variables
MyArchive is zipArchive
ResOpenArchive is int
ResArchiveExe = is int

// Open the archive "MyArchive"
ResOpenArchive = zipOpen(MyArchive, "D:\Backups\Backup.WDZ")
IF ResOpenArchive = 0 THEN
	// Create a self-extracting archive
	ResArchiveExe = zipCreateExe(MyArchive, "C:\Directories\Archive.EXE")
	...
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = zipCreateExe(<Archive> , <Executable path> [, <Extraction options> [, <Executable icon> [, <Default extraction directory> [, <Translation of self-extracting program>]]]])`
---

**`<Result>: (Integro)`**



- 0 si se ha creado el ejecutable,

- Un código de error (valor superior a 0) en caso contrario. Para más detalles sobre estos códigos de error, consulte la página web de [Observaciones](#NOTE0_1).




**`<Archive>: (Cadena de caracteres o zipArchive Variable)`**

Nombre del archivo que se va a utilizar.
Este nombre puede corresponder a:

- el nombre de un archivo, definido por [zipOpen](../WDLang3/3082044.md) o [zipCreate](../WDLang3/3082003.md).

- el nombre de una variable de tipo [zipArchive](../WDLang3/1000018679.md).




**`<Executable path>: (Cadena de caracteres)`**

Ruta del ejecutable a crear (hasta 260 caracteres). Esta ruta puede ser una ruta relativa al directorio actual o una ruta completa.. 
El .EXE extension es obligatorio.

**`<Extraction options>: (Constante opcional)`**

Opciones de extracción a utilizar: 


|   |   |
| --- | --- |
| *zipAdministrator* | Obliga al ejecutable creado a ejecutarse como administrador. Este modo se utiliza para evitar la virtualización de archivos desde Windows Vista. |
| *zipCurrentDirectory* | Todos los archivos de almacenamiento se extraerán al directorio actual. |
| *zipDefaultDir* | Utiliza el directorio Default (&lt;directorio de extracción Default). |
| *zipSelectRestorePath* | El programa autoextraíble mostrará la casilla de verificación "Mantener la estructura de árbol" en el cuadro de diálogo. |
| *zipTempDirectory*<br>(Valor predeterminado) | Los archivos serán extraídos del directorio temporal de el equipo donde se ejecuta el ejecutable.. Todos los archivos se extraen en la misma ubicación. |
| *zipTree* | Los archivos de almacenamiento se extraerán de acuerdo con la estructura de árbol de los directorios que se encuentran en el almacenamiento. |
| *zipWithUI* | El programa autoextraíble mostrará un cuadro de diálogo que permite al usuario elegir el directorio de destino. |



**`<Executable icon>: (Cadena de caracteres opcional)`**

Ruta del archivo Icon que representa el ejecutable creado. Esta ruta puede corresponder a una ruta relativa a la ruta actual o a una ruta completa.. 
Si no se especifica este parámetro, se asignará un Default Icon al ejecutable.

**`<Default extraction directory>: (Cadena de caracteres opcional)`**

Directorio propuesto de forma predeterminada por la ventana de descompresión (si se propone la constante *zipWithGUI*). Si no se propone una interfaz de extracción, este directorio será utilizado por Default para extraer los archivos.

**`<Translation of self-extracting program>: (Cadena de caracteres opcional)`**

ruta completa del archivo (formato INI) que contiene la traducción de los mensajes para el programa autoextraíble. El formato de este fichero se presenta en detalle en las Notas.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Condición de uso
<a name="condicion_uso_ELTPARAGRAPHE000132"></a>

Un archivo autoextraíble sólo puede ser creado si:

- El archivo existe (los archivos se crean con [zipCreate](../WDLang3/3082003.md)).

- El archivo es accesible en lectura/escritura.

- El archivo es un archivo de una sola parte.




**Atención**: 

- **Archivos en formato "CAB**: Esta función no está disponible.

- **Archivos en formato "RAR**: Esta función no está disponible.

- **Archivos en formato "7z**: Esta función no está disponible.

- **Archivos en formato "TAR" y "TARGZ**: Esta función no está disponible.



<a name="NOTE0_2"></a>


### Códigos de error
<a name="codigos_error_ELTPARAGRAPHE000155"></a>

Se devuelven los siguientes códigos de error:

- 10: No hay espacio suficiente para crear el ejecutable o el usuario no tiene derechos de escritura en el archivo inicial (.WDZ).

- 11: Error al convertir el archivo en un archivo autoextraíble.

- 12: No hay espacio suficiente para crear el ejecutable o el usuario no tiene derechos de lectura en el archivo inicial (.WDZ).




El mensaje correspondiente al código de error es devuelto por [zipMsgError](../WDLang3/3082034.md).
<a name="NOTE0_3"></a>


### ruta almacenada de ficheros de archivo
<a name="ruta_almacenada_ficheros_archivo_ELTPARAGRAPHE000173"></a>

Cuando los archivos se extraen de un archivo autoextraíble, no se guarda la ruta almacenada de los archivos.. Sólo se almacenan el nombre y la extension de los archivos.
<a name="NOTE0_4"></a>


### Archivo autoextraíble
<a name="archivo_autoextraible_ELTPARAGRAPHE000182"></a>

Un archivo autoextraíble de un archivo WINDEV puede abrirse con [zipOpen](../WDLang3/3082044.md) y utilizarse como cualquier otro archivo.

El archivo de origen (.WDZ o.ZIP) no se puede reconstruir a partir de un archivo autoextraíble.

No se puede definir ninguna contraseña para un archivo autoextraíble.

**Atención**: 

- Un archivo autoextraíble en formato ZIP no puede ser abierto por [zipOpen](../WDLang3/3082044.md).

- Si el archivo autoextraíble contiene subdirectorios vacíos y no vacíos, al descomprimir el archivo, sólo se vuelven a crear los directorios que contienen un archivo.. 



<a name="NOTE0_5"></a>


### Cierre del archivo
<a name="cierre_del_archivo_ELTPARAGRAPHE000206"></a>

Después de utilizar la función **zipCreateExe** en un archivo comprimido, este archivo no se cierra. Debe llamar a [zipClose](../WDLang3/3082005.md) para cerrar el archivo fuente.
<a name="NOTE0_6"></a>


### Traducir la interfaz del programa de autoextracción (parámetro &lt;Traducción del programa de autoextracción&gt;)
<a name="traducir_interfaz_del_programa_autoextraccion_parametro_ELTPARAGRAPHE000220"></a>

Por Default, el programa autoextraíble viene en tres idiomas: español, inglés y francés. El programa autoextraíble utilizará el idioma del ejecutable o el idioma especificado por [Nación](../WDLang1/3054014.md).  

La interfaz del programa autoextraíble puede utilizar un lenguaje distinto al lenguaje Default (inglés).<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=zipcreeExe%20-%20HC%20N%B0001.gif)
 Para ello, cree un archivo .INI que contenga la siguiente información:


```txt
[GENERAL]
NATIONDEFAUT=1
[WDAUTOEX01]
R000=Self-extracting PC SOFT archive
R001=Extract the content of the archive in the directory:
R002=Keep the tree structure
R003=Extract
R004=Close
```
Por ejemplo, a get una interfaz en francés:


```txt
[GENERAL]
NATIONDEFAUT=1
[WDAUTOEX01]
R000=Archive Autoextractible PC SOFT
R001=Extraire le contenu de l'archive dans le repertoire:
R002=Conserver l'arborescence 
R003=Extraire
R004=Fermer
```
**Atención**: Las primeras tres líneas de este archivo no deben ser modificadas.

En las siguientes líneas, especifique la traducción deseada.

El parámetro "Traducción de un programa autoextraíble" debe corresponder al ruta del archivo.INI que contiene la traducción de la interfaz.
<a name="NOTE0_7"></a>


### El ejecutable se encuentra en un medio del que no se pueden extraer los archivos de almacenamiento.
<a name="ejecutable_encuentra_medio_del_que_pueden_extraer_los_archivos_almacenamiento_ELTPARAGRAPHE000246"></a>El ejecutable puede encontrarse en un medio (CD por ejemplo) del cual no se pueden extraer los archivos archivados.. En este caso, ejecute el ejecutable y especifique en el comando Line:


```txt
/DIR=<Directory>
```
El parámetro &lt;Directorio&gt; especifica la ubicación de la que deben extraerse los archivos de almacenamiento.. Si el parámetro &lt;Directorio&gt; contiene espacios en blanco, la cadena de caracteres debe estar entre comillas.

Este parámetro tiene prioridad sobre el parámetro &lt;Directorio de extracción&gt;.
<a name="NOTE0_8"></a>


### El archivo autoextraíble contiene ficheros ejecutables
<a name="archivo_autoextraible_contiene_ficheros_ejecutables_ELTPARAGRAPHE000260"></a>

Si el último fichero archivado es un ejecutable (.EXE), este fichero se ejecutará automáticamente una vez se hayan extraído todos los ficheros de archivo.
<a name="NOTE0_9"></a>


### Comando los parámetros de Line de un archivo autoextraíble
<a name="comando_los_parametros_line_archivo_autoextraible_ELTPARAGRAPHE000269"></a>

Los siguientes parámetros se utilizan para lanzar un archivo autoextraíble desde el comando Line: 


|   |   |
| --- | --- |
| /DIR=&lt;Directorio&gt; | Se utiliza para especificar de dónde se deben extraer los archivos archivados.. Si el &lt;Directorio&gt; contiene caracteres de espacio, la cadena de caracteres debe estar entre comillas.<br><br>Atención: Este parámetro tiene prioridad sobre el parámetro &lt;Directorio de extracción&gt; especificado con la función **zipCreateExe**. |
| /TIT=&lt;Título&gt; | &lt;Título&gt; corresponde al título de la ventana autoextraíble. |
| /PID=&lt;Num PID&gt; | Solía esperar al final del &lt;PID Num&gt; Process antes de comenzar la extracción. |
| /SILENCIOSO | Se utiliza para iniciar la extracción sin una barra de progreso o un diálogo.. |
| /WAIT | Si el archivo autoextraíble inicia un ejecutable, la primera ventana permanecerá abierta hasta el final del ejecutable.. |
| /RELANCIA | Extracción con derechos de administrador. |



<a name="XComponent"></a>

## Componente:
wd280zip.dll
