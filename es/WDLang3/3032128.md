


## EmailStartOutlookSession( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Le permite acceder a los datos gestionados por el software de mensajería de Outlook (correos electrónicos, contactos, grupos de contactos, tareas, citas y carpetas).. Esta función es equivalente a la función [OutlookStartSession](../WDLang3/3032123.md).

**Atención**: Esta función no se puede utilizar para acceder a los datos que maneja el software de mensajería Outlook Express.

**Observación**: Cuando se utiliza **EmailStartOutlookSession**, el directorio actual es modificado automáticamente por Outlook.
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Start the session 
IF EmailStartOutlookSession("MyProfile") <> 0 THEN
	Info("Session started")
ELSE
	ErrorInfo()
END
```

```wl
nOutlookSessionID is int
// Start the Outlook session with the default profile 
nOutlookSessionID = EmailStartOutlookSession("")
// Session started?
IF nOutlookSessionID = 0 THEN
	// Failure starting the session
	Error("Failure starting the Outlook session", ErrorInfo())
ELSE
	// Process
	Info("List of email folders of Outlook:", ...
			EmailListFolder(nOutlookSessionID))
	// Close the session
	EmailCloseSession(nOutlookSessionID)
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Iniciando la sesión de Outlook

`<Result> = EmailStartOutlookSession(<Profile>)`
---

**`<Result>: (Integro)`**



- Identificador de sesión.

- 0 (o <u><u><u><u>False</u></u></u></u>) si se produce un error. La variable [ErrorOccurred](../WDLang1/3087001.md) se establece en <u><u><u><u>True</u></u></u></u>. Para obtener más información sobre el error, utilice la función [ErrorInfo](../WDLang1/3013008.md) con la constante *errMessage*.




**`<Profile>: (Cadena de caracteres)`**

Identifica el perfil de conexión (véase Notas).

Si este parámetro corresponde a una cadena vacía ("""):

- si hay varios perfiles definidos en el ordenador actual, **EmailStartOutlookSession** muestra una ventana con todos los perfiles entre los que el usuario puede elegir el suyo.

- si se define un único perfil en el ordenador actual, **EmailStartOutlookSession** selecciona automáticamente este perfil.





<a name="SYNTAX2"></a>

### Iniciar la sesión de Outlook especificando el modo de gestión de los contactos/participantes

`<Result> = EmailStartOutlookSession(<Profile> , <Asynchronous> [, <Start options>])`
---

**`<Result>: (Integro)`**



- Identificador de sesión.

- 0 (o <u><u><u><u>False</u></u></u></u>) si se produce un error. La variable [ErrorOccurred](../WDLang1/3087001.md) se establece en <u><u><u><u>True</u></u></u></u>. Para obtener más información sobre el error, utilice la función [ErrorInfo](../WDLang1/3013008.md) con la constante *errMessage*.




**`<Profile>: (Cadena de caracteres)`**

Identifica el perfil de conexión (véase Notas).

Si este parámetro corresponde a una cadena vacía ("""):

- si hay varios perfiles definidos en el ordenador actual, **EmailStartOutlookSession** muestra una ventana con todos los perfiles entre los que el usuario puede elegir el suyo.

- si se define un único perfil en el ordenador actual, **EmailStartOutlookSession** selecciona automáticamente este perfil.




**`<Asynchronous>: (Constante o booleana)`**

Modo de envío de los correos electrónicos: 


|   |   |
| --- | --- |
| *emailAsynchronous* o <u><u><u><u>True</u></u></u></u> | Los correos electrónicos salientes deben ser transmitidos en modo asíncrono (ver las Notas). |
| *emailSynchronous* o <u><u><u><u>False</u></u></u></u><br>(Valor predeterminado) | Los correos electrónicos salientes deben ser transmitidos en modo sincrónico (ver las Notas). |

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) Este parámetro debe corresponder a *emailSynchronous* o <u><u><u><u>False</u></u></u></u>. 

**`<Start options>: (Constante opcional de tipo Integer)`**

Modo para iniciar la sesión de Outlook: 


|   |   |
| --- | --- |
| *outlookAPTWithContact*<br>(Valor predeterminado) | Las funciones de AppointmentXXX listarán los contactos asociados a las citas en el Variable de mAppointment.Participant (ver [Estructura de Appointment](../WDLang3/1000011010.md)). |
| *outlookAPTWithParticipant* | Las funciones de NombramientoXXX listarán a los participantes associated con los nombramientos en las siguientes variables:<br><br>- Nombramiento del Participante<br><br>- Nombramiento del Participante<br><br>- Nombramiento del ParticipanteBcc<br><br><br>Para obtener más información, consulte [Estructura de Appointment](../WDLang3/1000011010.md). |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Crear de un perfil
<a name="crear_perfil_ELTPARAGRAPHE000152"></a>

Para iniciar una nueva sesión con Outlook, se debe definir un "perfil".. Este "perfil" se define en la configuración de la conexión de INTERNET con Outlook.

Para crear un perfil:

1. Inicie Outlook.

2. En la ventana "Elegir un perfil", haga clic en [ New].

3. Seleccione el servicio "Microsoft Exchange Server".

4. Dar un nombre al perfil.

5. Introduzca el nombre del servidor Microsoft Exchange.



<a name="NOTE0_2"></a>


### Timeout
<a name="timeout_ELTPARAGRAPHE000173"></a>

El tiempo de espera puede ser set utilizando [EmailSetTimeOut](../WDLang3/3032001.md).
<a name="NOTE0_3"></a>

<a name="XComponent"></a>

## Componente:
wd280com.dll
