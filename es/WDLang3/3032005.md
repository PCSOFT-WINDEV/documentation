


## EmailSendMessage (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Envía un Email:

- utilizando el **protocolo SMTP**: el Email se envía directamente al servidor. **La Email se envía realmente cuando se desconecta del servidor SMTP** (es decir, cuando se cierra la sesión).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) mediante el **MS Exchange** mandante: la Email se coloca en la bandeja de salida de MS Exchange. Para enviar realmente la Email, use la [EmailUpdate](../WDLang3/3032036.md). 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) mediante el software **Lotus Notes**: la Email se coloca en la bandeja de salida del software de mensajería. El Email es enviado automáticamente por el bobinador de Domino. 
	Atención: Lotus Notes debe instalarse en modo conectado (y no en modo local).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) mediante el **Perspectiva** aplicación informática: la Email se coloca en la bandeja de salida del software de mensajería. El Email se envía realmente desde Outlook. Para más detalles, véase [Acceso a Outlook](../WDLang3/3032137.md).




**Atención**: Antes de enviar el Email, debes hacerlo:

- Inicie una sesión con una de las siguientes funciones: [EmailStartSession](../WDLang3/3032028.md), [EmailStartOutlookSession](../WDLang3/3032128.md) o [EmailStartNotesSession](../WDLang3/3032121.md) según el protocolo que se vaya a utilizar.

- Llenar una [Envía un correo electrónico a Variable](../WDLang3/1000018713.md) o la [Estructura de Email](../WDLang3/3032029.md) con el mensaje (remitente, destinatario, ...).


![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) En esta versión, los correos electrónicos sólo se pueden enviar a través del protocolo SMTP.






<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) **Envío de un mensaje por SMTP**


```wl
// Start an SMTP session
MySession is emailSMTPSession
MySession.ServerAddress = "smtp.mycompany.us"
EmailStartSession(MySession)

// Build an email
MyMessage is Email
MyMessage.Sender = "ordering_department@mycompany.fr"
Add(MyMessage.Recipient, "customer@company.com")
MyMessage.Subject = EDT_EmailSubject
MyMessage.Message = "EDT_EmailText"

// Send the message
EmailSendMessage(MySession, MyMessage)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Enviando una Email usando SMTP

`<Result> = EmailSendMessage(<Session> [, <Email> [, <Advanced options>]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se envió el mensaje al servidor SMTP,

- <u><u><u><u>False</u></u></u></u> en caso contrario. Para obtener los detalles del error, utilice [ErrorInfo](../WDLang1/3013008.md) con la constante *errMessage*.


![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Si se produce un error, el contenido de Email.Error Variable debe ser comprobado.

**`<Session>: (Cadena de caracteres o emailSMTPSession Variable)`**

Identifica la sesión de usuario. Corresponde a:

- el nombre de usuario que se utilizó para iniciar la sesión de Email ([EmailStartSession](../WDLang3/3032028.md) o [EmailStartSMTPSession](../WDLang3/3032025.md)).

- una variable de tipo [emailSMTPSession](../WDLang3/1000018765.md).




**`<Email>: (Correo electrónico opcional Variable)`**

Nombre de la [Email](../WDLang3/1000018713.md) Variable correspondiente al Email a enviar. Si no se especifica este parámetro, se utiliza la información que se encuentra en la [Estructura de Email](../WDLang3/3032029.md).
![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Este parámetro no está disponible.

**`<Advanced options>: (Constante opcional de tipo Integer)`**

Combinación de las siguientes constantes:


|   |   |
| --- | --- |
| *emailOptionEncodeHeader* | Codifica las cabeceras de los mensajes en Quoted-Printable si es necesario.. <br>Los encabezados de los mensajes no están codificados por Default. Esta constante impide la recepción de Email con caracteres acentuados mal decodificados. |
| *emailOptionMessageID* | Tiene en cuenta el **Email.MessageID** Variable para generar el Email. Esta opción se ignora si no se especifica esta Variable.<br><br>Esta opción es una opción avanzada. |
| *emailOptionReference* | Tiene en cuenta la variable **Email.Reference** para generar el correo electrónico. Esta opción se ignora si no se especifica esta Variable.<br><br>Esta opción es una opción avanzada. |




<a name="SYNTAX2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
### Envío de un Email a través de MS Exchange, Lotus Notes o Outlook

`<Result> = EmailSendMessage(<Session ID> [, <Email> [, <Display> [, <Type>]]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si el mensaje se colocó en la bandeja de salida de MS Exchange, Lotus Notes o Outlook,

- <u><u><u><u>False</u></u></u></u> en caso contrario. Para obtener los detalles del error, utilice [ErrorInfo](../WDLang1/3013008.md) con la constante *errMessage*.




**`<Session ID>: (Entero o emailOutlookSession Variable)`**

Identifica la sesión actual de Email. Este parámetro puede ser:

- un número entero devuelto por una de las siguientes funciones: [EmailStartSession](../WDLang3/3032028.md), [EmailStartNotesSession](../WDLang3/3032121.md) o [EmailStartOutlookSession](../WDLang3/3032128.md).

- una variable de tipo [emailOutlookSession](../WDLang3/1000018767.md).

- una variable de tipo [emailNotesSession](../WDLang3/1000018768.md).




**`<Email>: (Correo electrónico opcional Variable)`**

Nombre del Variable de tipo [Email](../WDLang3/1000018713.md) correspondiente al Email a enviar.

Si no se especifica este parámetro, se utiliza la información que se encuentra en la [Estructura de Email](../WDLang3/3032029.md).

**`<Display>: (Booleano opcional)`**



- <u><u><u><u>True</u></u></u></u> para mostrar el mensaje en un cuadro de diálogo antes de enviarlo,

- <u><u><u><u>False</u></u></u></u> (predeterminado) para no mostrar ningún cuadro de diálogo.




Este parámetro sólo se tiene en cuenta si la sesión de Email fue iniciada por [EmailStartSession](../WDLang3/3032028.md), utilizando la sintaxis de MS Exchange con un nombre de perfil. En los demás casos, no se visualiza la ventana de diálogo.

**Observación**: Este parámetro no está disponible para Lotus Notes. 

**`<Type>: (Cadena de caracteres opcional (con comillas))`**

Describe el tipo de mensaje a enviar. Por defecto, &lt;Tipo&gt; = "IPM" (Inter Personal Message).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones
<a name="NOTE0_2"></a>
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Barra de progreso
<a name="barra_progreso_ELTPARAGRAPHE000446"></a>

Para seguir el progreso del envío, utilice [EmailProgressBar](../WDLang3/3032017.md).



<a name="XComponent"></a>

## Componente:
wd280com.dll
