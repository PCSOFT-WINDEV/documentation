


## EmailSeekFirstNotes( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Busca uno o más correos electrónicos de acuerdo con los criterios especificados, en una base de datos Lotus Notes o Domino local o remota.

Esta búsqueda se puede realizar:

- en una o más secciones de la Email.

- mediante una fórmula de selección de Lotus Notes.



<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Start a Lotus Notes session
SessionID is int
SessionID = EmailStartNotesSession("Password", "MarsServer", ...
		"email/julia.nsf", "C:\Lotus Notes\julia.id")
...
// Find the emails containing "PC Soft" 
// in the message subject or body
// Only the incoming emails are taken into account
IF EmailSeekFirst(SessionID, emailSubject + emailBody, ...
			"PC Soft", notesReceived) = True THEN
	// Enumerate the emails found
	WHILE Email.Out = False
		// Displays the sender and subject in a Table control
		TableAdd(TABLE_EmailFound, Email.Sender + ...
				TAB + Email.Subject)
		// Next email found
		EmailReadNext(SessionID)
	END
ELSE
	Info("No email was found")
END
```
<a name="Example2"></a>

```wl
// Start a Lotus Notes session
SessionID is int
SessionID = EmailStartNotesSession("Password", "MarsServer", ...
			"email/julia.nsf", "C:\Lotus Notes\julia.id")
...
// Search performed via a selection formula of Lotus Notes
// Find the emails containing "pc soft" 
// in the message subject or body
// and containing WINDEV in the category
// Only the incoming and unread emails are taken into account
IF EmailSeekFirst(SessionID, emailSubject + emailBody, ...
	"PC Soft", "@contains(@lowercase(categories);'WinDev')", ...
	notesReceived, emailUnread) = True THEN
	// Enumerate the emails found
	WHILE Email.Out = False
		// Displays the sender and subject in a Table control
		TableAdd(TABLE_EmailFound, Email.Sender + ...
			TAB + Email.Subject)
		// Next email found
		EmailReadNext(SessionID)
	END
ELSE
	Info("No email was found")
END
```

<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX1"></a>

### Buscando en una o más secciones de un correo electrónico Variable

`<Result> = EmailSeekFirstNotes(<Session> , <Email> , <Email section> , <Sought value> [, <Type of email> [, <Read mode>]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se encontró uno o más correos electrónicos,

- <u><u><u><u>False</u></u></u></u> en caso contrario. 


Si se produce un error, la variable [ErrorOccurred](../WDLang1/3087001.md) se pone en <u><u><u><u>True</u></u></u></u>. Para obtener más información sobre el error, utilice la función [ErrorInfo](../WDLang1/3013008.md) con la constante *errMessage*. 

Si no se ha encontrado ningún correo electrónico, el [ErrorOccurred](../WDLang1/3087001.md) Variable se queda en <u><u><u><u>False</u></u></u></u> y el Email.Out Variable es set a <u><u><u><u>True</u></u></u></u>.

**`<Session>: (Entero o emailNotesSession Variable)`**

La sesión puede ser:

- un número entero devuelto por una de las siguientes funciones: [EmailStartSession](../WDLang3/3032028.md), [EmailStartNotesSession](../WDLang3/3032121.md) o [NotasOpenConnection](../WDLang3/1000005102.md).

- una variable de tipo [emailNotesSession](../WDLang3/1000018768.md).




**`<Email>: (Envía un correo electrónico a Variable)`**

Nombre de la [Email](../WDLang3/1000018713.md) Variable correspondiente al Email donde se realizará la búsqueda.

**`<Email section>: (Constante o combinación de constantes de tipo Integer)`**

La sección de Email donde se buscará el &lt;Valor buscado&gt;:



|   |   |
| --- | --- |
| *emailBody* | Cuerpo de correos electrónicos. |
| *emailRecipient* | Destinatarios de los correos electrónicos. |
| *emailSender* | Remitentes de correos electrónicos. |
| *emailSubject* | Temas de los correos electrónicos. |


Estas constantes se pueden combinar.

**`<Sought value>: (Cadena de caracteres)`**

Valor buscado en los correos electrónicos.

**`<Type of email>: (Constante o combinación de constantes de tipo Integer (opcional))`**

Tipo de Email donde se realizará la búsqueda:



|   |   |
| --- | --- |
| *notesAll*<br>(Valor predeterminado) | Todos los correos electrónicos. |
| *notesDraft* | Borrador de correos electrónicos. |
| *notesFollowUp* | Emails marcados como "Follow up". |
| *notesReceived* | Correo electrónico entrante. |
| *notesSent* | Correos electrónicos salientes. |


Estas constantes se pueden combinar.

**`<Read mode>: (Constante opcional o cadena de caracteres)`**

Especifica los mensajes que se leerán: 



|   |   |
| --- | --- |
| *emailAll* o "TODOS"<br>(Valor predeterminado) | La búsqueda se realiza en los correos electrónicos leídos y en los no leídos. |
| *emailUnread* o "NO LEÍDOS" | La búsqueda se realiza únicamente en los correos electrónicos no leídos. |




<a name="SYNTAX2"></a>

### Buscando a través de una fórmula de selección de Lotus Notes en un correo electrónico Variable

`<Result> = EmailSeekFirstNotes(<Session> , <Email> , <Email section> , <Sought value> , <Lotus Notes formula> [, <Type of email> [, <Read mode>]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se encontró uno o más correos electrónicos,

- <u><u><u><u>False</u></u></u></u> en caso contrario. 


Si se produce un error, la variable [ErrorOccurred](../WDLang1/3087001.md) se pone en <u><u><u><u>True</u></u></u></u>. Para obtener más información sobre el error, utilice la función [ErrorInfo](../WDLang1/3013008.md) con la constante *errMessage*. 

Si no se ha encontrado ningún correo electrónico, el [ErrorOccurred](../WDLang1/3087001.md) Variable se queda en <u><u><u><u>False</u></u></u></u> y el Email.Out Variable es set a <u><u><u><u>True</u></u></u></u>.

**`<Session>: (Entero o emailNotesSession Variable)`**

La sesión puede ser:

- un número entero devuelto por [EmailStartSession](../WDLang3/3032028.md), [EmailStartNotesSession](../WDLang3/3032121.md) o [NotasOpenConnection](../WDLang3/1000005102.md).

- una variable de tipo [emailNotesSession](../WDLang3/1000018768.md).




**`<Email>: (Envía un correo electrónico a Variable)`**

Email donde se realizará la búsqueda.

**`<Email section>: (Constante o combinación de constantes de tipo Integer)`**

La sección de Email donde se buscará el &lt;Valor buscado&gt;:



|   |   |
| --- | --- |
| *emailBody* | Cuerpo de correos electrónicos. |
| *emailNone* | Búsqueda realizada mediante una fórmula de selección de Lotus Notes. En este caso, &lt;Valor buscado&gt; corresponde a una cadena vacía (""").<br>Esta constante no se puede combinar. |
| *emailRecipient* | Destinatarios de los correos electrónicos. |
| *emailSender* | Remitentes de correos electrónicos. |
| *emailSubject* | Temas de los correos electrónicos. |


Estas constantes se pueden combinar.

**`<Sought value>: (Cadena de caracteres)`**



- Valor buscado en los correos electrónicos,

- Cadena vacía ("") si el parámetro &lt;Sección del correo electrónico&gt; corresponde a la constante *emailNone*.




**`<Lotus Notes formula>: (Cadena de caracteres)`**

Fórmula para seleccionar los correos electrónicos en Lotus Notes. Consulte la documentación sobre Lotus Notes para obtener más detalles.

**`<Type of email>: (Constante o combinación de constantes de tipo Integer (opcional))`**

Tipo de Email donde se realizará la búsqueda:



|   |   |
| --- | --- |
| *notesAll*<br>(predeterminado) | Todos los correos electrónicos. |
| *notesDraft* | Borrador de correos electrónicos. |
| *notesFollowUp* | Emails marcados como "Follow up". |
| *notesReceived* | Correo electrónico entrante. |
| *notesSent* | Correos electrónicos salientes. |


Estas constantes se pueden combinar.

**`<Read mode>: (Constante opcional o cadena de caracteres)`**

Indica los mensajes que se leerán:



|   |   |
| --- | --- |
| *emailAll* o "TODOS"<br>(Valor predeterminado) | La búsqueda se realiza en los correos electrónicos leídos y en los no leídos. |
| *emailUnread* o "NO LEÍDOS" | La búsqueda se realiza únicamente en los correos electrónicos no leídos. |




<a name="SYNTAX3"></a>

### Buscando en una o más secciones de la estructura de Email

`<Result> = EmailSeekFirstNotes(<Session> , <Email section> , <Sought value> [, <Type of email> [, <Read mode>]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se encontró uno o más correos electrónicos,

- <u><u><u><u>False</u></u></u></u> en caso contrario. 


Si se produce un error, la variable [ErrorOccurred](../WDLang1/3087001.md) se pone en <u><u><u><u>True</u></u></u></u>. Para obtener más información sobre el error, utilice la función [ErrorInfo](../WDLang1/3013008.md) con la constante *errMessage*. 

Si no se ha encontrado ningún correo electrónico, el [ErrorOccurred](../WDLang1/3087001.md) Variable se queda en <u><u><u><u>False</u></u></u></u> y el Email.Out Variable es set a <u><u><u><u>True</u></u></u></u>.

**`<Session>: (Entero o emailNotesSession Variable)`**

La sesión puede ser:

- un número entero devuelto por una de las siguientes funciones: [EmailStartSession](../WDLang3/3032028.md), [EmailStartNotesSession](../WDLang3/3032121.md) o [NotasOpenConnection](../WDLang3/1000005102.md).

- una variable de tipo [emailNotesSession](../WDLang3/1000018768.md).




**`<Email section>: (Constante o combinación de constantes de tipo Integer)`**

La sección de Email donde se buscará el &lt;Valor buscado&gt;:



|   |   |
| --- | --- |
| *emailBody* | Cuerpo de correos electrónicos. |
| *emailRecipient* | Destinatarios de los correos electrónicos. |
| *emailSender* | Remitentes de correos electrónicos. |
| *emailSubject* | Temas de los correos electrónicos. |


Estas constantes se pueden combinar.

**`<Sought value>: (Cadena de caracteres)`**

Valor buscado en los correos electrónicos.

**`<Type of email>: (Constante o combinación de constantes de tipo Integer (opcional))`**

Tipo de Email donde se realizará la búsqueda:



|   |   |
| --- | --- |
| *notesAll*<br>(Valor predeterminado) | Todos los correos electrónicos. |
| *notesDraft* | Borrador de correos electrónicos. |
| *notesFollowUp* | Emails marcados como "Follow up". |
| *notesReceived* | Correo electrónico entrante. |
| *notesSent* | Correos electrónicos salientes. |


Estas constantes se pueden combinar.

**`<Read mode>: (Constante opcional o cadena de caracteres)`**

Indica los mensajes que se leerán:



|   |   |
| --- | --- |
| *emailAll* o "TODOS"<br>(Valor predeterminado) | La búsqueda se realiza en los correos electrónicos leídos y en los no leídos. |
| *emailUnread* o "NO LEÍDOS" | La búsqueda se realiza únicamente en los correos electrónicos no leídos. |




<a name="SYNTAX4"></a>

### Buscando a través de una fórmula de selección de Lotus Notes en la estructura de Email

`<Result> = EmailSeekFirstNotes(<Session> , <Email section> , <Sought value> , <Lotus Notes formula> [, <Type of email> [, <Read mode>]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se encontró uno o más correos electrónicos,

- <u><u><u><u>False</u></u></u></u> en caso contrario. 


Si se produce un error, la variable [ErrorOccurred](../WDLang1/3087001.md) se pone en <u><u><u><u>True</u></u></u></u>. Para obtener más información sobre el error, utilice la función [ErrorInfo](../WDLang1/3013008.md) con la constante *errMessage*. 

Si no se ha encontrado ningún correo electrónico, [ErrorOccurred](../WDLang1/3087001.md) sigue siendo set a <u><u><u><u>False</u></u></u></u> y el Email.Out Variable es set a <u><u><u><u>True</u></u></u></u>.

**`<Session>: (Entero o emailNotesSession Variable)`**

La sesión puede ser:

- un número entero devuelto por una de las siguientes funciones: [EmailStartSession](../WDLang3/3032028.md), [EmailStartNotesSession](../WDLang3/3032121.md) o [NotasOpenConnection](../WDLang3/1000005102.md).

- una variable de tipo [emailNotesSession](../WDLang3/1000018768.md).




**`<Email section>: (Constante o combinación de constantes de tipo Integer)`**

La sección de Email donde se buscará el &lt;Valor buscado&gt;:



|   |   |
| --- | --- |
| *emailBody* | Cuerpo de correos electrónicos. |
| *emailNone* | Búsqueda realizada mediante una fórmula de selección de Lotus Notes. En este caso, &lt;Valor buscado&gt; corresponde a una cadena vacía (""").<br>Esta constante no se puede combinar. |
| *emailRecipient* | Destinatarios de los correos electrónicos. |
| *emailSender* | Remitentes de correos electrónicos. |
| *emailSubject* | Temas de los correos electrónicos. |


Estas constantes se pueden combinar.

**`<Sought value>: (Cadena de caracteres)`**



- Valor buscado en los correos electrónicos,

- Cadena vacía ("") si el parámetro &lt;Sección del correo electrónico&gt; corresponde a la constante *emailNone*.




**`<Lotus Notes formula>: (Cadena de caracteres)`**

Fórmula para seleccionar los correos electrónicos en Lotus Notes. Consulte la documentación sobre Lotus Notes para obtener más detalles.

**`<Type of email>: (Constante o combinación de constantes de tipo Integer (opcional))`**

Tipo de Email donde se realizará la búsqueda:



|   |   |
| --- | --- |
| *notesAll*<br>(Valor predeterminado) | Todos los correos electrónicos. |
| *notesDraft* | Borrador de correos electrónicos. |
| *notesFollowUp* | Emails marcados como "Follow up". |
| *notesReceived* | Correo electrónico entrante. |
| *notesSent* | Correos electrónicos salientes. |


Estas constantes se pueden combinar.

**`<Read mode>: (Constante opcional o cadena de caracteres)`**

Indica los mensajes que se leerán:



|   |   |
| --- | --- |
| *emailAll* o "TODOS"<br>(Valor predeterminado) | La búsqueda se realiza en los correos electrónicos leídos y en los no leídos. |
| *emailUnread* o "NO LEÍDOS" | La búsqueda se realiza únicamente en los correos electrónicos no leídos. |





<a name="NOTE0"></a>
<a name="XComponent"></a>

## Componente:
wd280com.dll
