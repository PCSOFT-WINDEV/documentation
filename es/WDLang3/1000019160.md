


## <zipArchive Variable>.Create (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Crea un archivo. El archivo creado se crea automáticamente:

- abierto en lectura/escritura. Si el archivo está en formato CAB, el archivo creado se abre en formato de sólo escritura.

- un archivo de una sola parte.




El archivo creado puede ser: 

- en formato estándar WinZip o PKZip (extensión.ZIP).

- en formato "Cabinet files" (.CAB extension).

- en formato WINDEV (.WDZ extension).

- en formato 7z (.7z extension). 

- en formato TAR (.TAR extension).

- en formato TGZ (TAR.GZ) (extensión.TGZ o.TAR.GZ).No se puede crear ningún archivo en formato "RAR"..



<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
MyArchive is zipArchive
ResCreate is int
ResAddFile is int
// Create the archive 
ResCreate = MyArchive.Create("C:\Temp\Archive.zip")
IF ResCreate = 0 THEN
	// Add a file into an archive
	ResAddFile = MyArchive.AddFile(...
			"C:\MyDirectory\MyFiles\File.pdf", zipDrive)
END
// Display an error message if the file was not added
IF ResAddFile <> 0 THEN 
	Error(zipMsgError(ResAddFile))
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = <Archive>.Create(<Archive path> [, <Options>])`
---

**`<Result>: (Integro)`**



- 0 si la creación se ha realizado. En este caso, el archivo se abre. Para que este archivo pueda ser manejado por el usuario antes de cerrar la aplicación, no olvide cerrar el archivo ([Cerrar](../WDLang3/1000019086.md)). 

- Un código de error (valor superior a 0) en caso contrario. Para más detalles sobre estos códigos de error, consulte la página web de Observaciones.




**`<Archive>: (Variable de tipo zipArchive)`**

Nombre de una Variable de tipo [zipArchive](../WDLang3/1000018679.md) correspondiente al archivo a utilizar.

**`<Archive path>: (Cadena de caracteres)`**

Ruta y nombre del archivo comprimido (hasta 260 caracteres). Debe especificarse el archivo extension:

- ".WDZ" para crear un archivo WINDEV.

- ".ZIP" para crear un archivo en formato WinZip o PKZip.

- ".CAB" para crear un archivo en formato "Cabinet Files".

- ".7z" para crear un archivo en formato 7Z. 

- ".TAR" para crear un archivo en formato TAR. 

- ".TAR.GZ" para crear un archivo en formato TAR.GZ. 

- ".TGZ" para crear un archivo en formato TGZ. 


Si no se especifica ninguna extensión, se crea un archivo en formato WDZ. 

Atención: 

- ![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Sólo están disponibles los archivos ZIP, TAR y TGZ (TAR.GZ).

- ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Sólo están disponibles los archivos ZIP.

- ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Si se especifica la extensión.WDZ, el archivo comprimido creado estará en formato ZIP, pero con una extensión.WDZ.

- Si el mismo archivo comprimido ya existe en el directorio especificado, el nuevo archivo comprimido lo sobrescribe.




![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) El archivo ruta es un ruta completo o un ruta relativo al directorio de trabajo de la aplicación (devuelto por [fDataDir](../WDLang1/3036001.md)). 

**`<Options>: (Constante opcional)`**

Opciones para la gestión de los archivos comprimidos:


|   |   |
| --- | --- |
| *zipAnsi* | Se utiliza para forzar la copia de seguridad de los nombres de archivos en formato Ansi en el archivo Archive.<br><br>Esta constante es utilizada por Default en una aplicación que utiliza el modo Ansi.<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante no está disponible. |
| *zipHeader64* | Permite crear un archivo de más de 4 GB en el que se puede utilizar [.ChangePath](../WDLang3/1000026329.md).<br><br>Por Default, esta opción no se utiliza.<br>**Archivo en formato TAR o TGZ (TAR.GZ)**: Esta constante no está disponible. <br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante no está disponible. |
| *zipUncompressed* | El contenido del archivo no se comprimirá.<br><br>Utilizada con los archivos CAB, esta constante permite utilizar únicamente la función de archivar el formato CAB.<br><br>En Default, esta opción no se utiliza.<br><br>**Archivo en formato TAR o TGZ (TAR.GZ)**: Esta constante no está disponible. |
| *zipUnicode* | Guarda los nombres de los ficheros Unicode en el fichero de Archivo.<br><br>Esta constante es utilizada por Default en una aplicación que utiliza Unicode.<br><br>**Archivo en formato TAR o TGZ (TAR.GZ)**: Si se utiliza esta constante, los nombres de archivos Unicode no se guardan en Unicode en el archivo. ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante no está disponible. |


**Archivar en formato 7z**: Este parámetro no está disponible. 
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Este parámetro no está disponible.


<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Nivel de compresión
<a name="nivel_compresion_ELTPARAGRAPHE000406"></a>

Los ficheros añadidos en un archivo zip son comprimidos por Default. El nivel de compresión de los ficheros añadidos a un archivo puede ser modificado por [zipCompressionLevel](../WDLang3/3082054.md).
<a name="NOTE0_2"></a>


### Códigos de error
<a name="codigos_error_ELTPARAGRAPHE000419"></a>

Se devuelven los siguientes códigos de error:

- 1: La ruta pasada como parámetro no existe.

- 2: Acceso denegado: el usuario no tiene suficientes derechos.




El mensaje correspondiente al código de error es devuelto por [zipMsgError](../WDLang3/3082034.md).
<a name="NOTE0_3"></a>


### Condición de uso
<a name="condicion_uso_ELTPARAGRAPHE000437"></a>

El número máximo de archivos que se pueden incluir:

- en un archivo WDZ: 2 32 -1. 

- en un archivo ZIP: 65535. 

- en un archivo CAB: 65535. 


Formatos disponibles: 

- ![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Sólo están disponibles los archivos ZIP, TAR y TGZ (TAR.GZ).

- ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Sólo están disponibles los archivos ZIP.


El tamaño de un archivo incluido en un archivo comprimido (independientemente de su formato) debe ser inferior a 4 GB.

No se puede crear ningún archivo en formato "RAR".

<a name="XComponent"></a>

## Componente:
wd280zip.dll
