


## <zipArchive Variable>.ExtractFile (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Extrae un archivo de un archivo comprimido y lo descomprime automáticamente en una ubicación física o en la memoria..



<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
```wl
Archive is zipArchive
// Open an archive
ResOpenArchive = Archive.Open("C:\Archives\Archive.zip")

IF ResOpenArchive = 0 THEN
	...
	 // Extract a file to its initial location
	 ResExtractFile = Archive.ExtractFile("File.txt", zipDrive)
	...
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Extraer un archivo identificado por su índice

`<Result> = <Archive>.ExtractFile(<File index> [, <File destination> [, <Progress>]])`
---

**`<Result>: (Entero o tampón)`**



- 0 si el archivo fue extraído,

- Un código de error (valor superior a 0) en caso contrario. Para más detalles sobre estos códigos de error, consulte la página web de Observaciones.




Cuando se extrae "en memoria", corresponde a la memoria intermedia que contiene el fichero extraído.

**`<Archive>: (Variable de tipo zipArchive)`**

Nombre de una Variable de tipo [zipArchive](../WDLang3/1000018679.md) correspondiente al archivo a utilizar.

**`<File index>: (Integro)`**

Índice del fichero a extraer del archivo.  [.FindFile](../WDLang3/1000026330.md) devuelve este índice.

**`<File destination>: (Cadena de caracteres opcional o constante)`**

Destino ruta del archivo extraído:

- Cadena de caracteres opcional: El archivo se extrae en la ruta especificada a la que se añade la estructura de árbol almacenada del archivo (la Drive no se almacena). Se crea la ruta especificada si no existe.
	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) El destino ruta del archivo extraído debe corresponder al directorio de trabajo de la aplicación (devuelto por [fDataDir](../WDLang1/3036001.md)) o a uno de sus subdirectorios.

- Constante opcional:
	


|   |   |
| --- | --- |
| *zipDirectory*<br>(Valor predeterminado) | Extracción en el directorio actual mientras se restaura la estructura de árbol del archivo (si estaba almacenado). |
| *zipDrive* | Extracción:<br><br>	- a la ubicación inicial del archivo si se almacenó y si la Drive existe.<br><br>	- mientras se restaura la estructura de árbol del archivo en la Drive actual si la Drive o el directorio almacenado no existen.<br><br>	- en el directorio actual si sólo se han almacenado el nombre del archivo y extension.<br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) Esta constante no está disponible. Los directorios no tienen raíz.<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante y la constante *zipDirectory* tendrán el mismo efecto. **Archivos en formato 7z**: Esta constante y la constante *zipDirectory* tendrán el mismo efecto. |
| *zipInMemory* | Extrae el archivo de la memoria. El contenido del archivo es devuelto directamente por la función. Puede asignarse a un Buffer Variable por ejemplo.<br>Esta característica está disponible sólo para los archivos ZIP y WDZ. |
| *zipNone* | Extracción en el directorio actual sin restaurar la estructura de árbol del archivo (si estaba almacenado). |


	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Estas constantes no se pueden utilizar.




**`<Progress>: (Nombre de control o nombre de Procedure)`**

Modo de gestión de la barra de progreso. Este parámetro puede corresponder a: 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) el nombre de un control Barra de progreso encontrado en una ventana. La barra de progreso mostrará el progreso de la extracción de archivos.  

- el nombre de un WLanguage Procedure. Este procedimiento tiene el siguiente formato: 
	
	```txt
	<Procedure name> (<Current file>, <Progress percentage>)
	```

	donde: 

	-  corresponde al nombre del fichero actualmente procesado. 

	-  corresponde al porcentaje de progreso del fichero que se está extrayendo del archivo. 







Atención: La barra de progreso se actualiza al final de la extracción de archivos para los siguientes tipos de archivos comprimidos: 

- TAR o TGZ (TAR.GZ), 

- RAR, 

- CAB.




<a name="SYNTAX2"></a>

### Extrayendo un archivo identificado por su ruta

`<Result> = <Archive>.ExtractFile(<File path> [, <File destination> [, <Progress>]])`
---

**`<Result>: (Entero o tampón)`**



- 0 si el archivo fue extraído,

- Un código de error (valor superior a 0) en caso contrario. Para más detalles sobre estos códigos de error, consulte la página web de Observaciones.




Cuando se extrae "en memoria", corresponde a la memoria intermedia que contiene el fichero extraído.

**`<Archive>: (Variable de tipo zipArchive)`**

Nombre de una Variable de tipo [zipArchive](../WDLang3/1000018679.md) correspondiente al archivo a utilizar.

**`<File path>: (Cadena de caracteres)`**

ruta almacenada del archivo a extraer del archivo. Realiza una búsqueda de coincidencias exactas en la ruta del archivo en el archivo.

**`<File destination>: (Cadena de caracteres opcional o constante)`**

Destino ruta del archivo extraído:

- Cadena de caracteres opcional: El archivo se extrae en la ruta especificada a la que se añade la estructura de árbol almacenada del archivo (la Drive no se almacena). Se crea la ruta especificada si no existe.
	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) El destino ruta del archivo extraído debe corresponder al directorio de trabajo de la aplicación (devuelto por [fDataDir](../WDLang1/3036001.md)) o a uno de sus subdirectorios.

- Constante opcional:
	


|   |   |
| --- | --- |
| *zipDirectory*<br>(Valor predeterminado) | Extracción en el directorio actual mientras se restaura la estructura de árbol del archivo (si estaba almacenado). |
| *zipDrive* | Extracción:<br><br>	- a la ubicación inicial del archivo si se almacenó y si la Drive existe.<br><br>	- mientras se restaura la estructura de árbol del archivo en la Drive actual si la Drive o el directorio almacenado no existen.<br><br>	- en el directorio actual si sólo se han almacenado el nombre del archivo y extension.<br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) Esta constante no está disponible. Los directorios no tienen raíz.<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante y la constante *zipDirectory* tendrán el mismo efecto. **Archivos en formato 7z**: Esta constante y la constante *zipDirectory* tendrán el mismo efecto. |
| *zipInMemory* | Extrae el archivo de la memoria. El contenido del archivo es devuelto directamente por la función. Puede asignarse a un Buffer Variable por ejemplo.<br>Esta característica está disponible sólo para los archivos ZIP y WDZ. |
| *zipNone* | Extracción en el directorio actual sin restaurar la estructura de árbol del archivo (si estaba almacenado). |


	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Estas constantes no se pueden utilizar.




**`<Progress>: (Nombre de control o nombre de Procedure)`**

Modo de gestión de la barra de progreso. Este parámetro puede corresponder a: 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) el nombre de un control Barra de progreso encontrado en una ventana. La barra de progreso mostrará el progreso de la extracción de archivos. 

- el nombre de un WLanguage Procedure. Este procedimiento tiene el siguiente formato: 
	
	```txt
	<Procedure name> (<Current file>, <Progress percentage>)
	```

	donde: 

	-  corresponde al nombre del fichero actualmente procesado. 

	-  corresponde al porcentaje de progreso del fichero que se está extrayendo del archivo. 







Atención: La barra de progreso se actualiza al final de la extracción de archivos para los siguientes tipos de archivos comprimidos: 

- TAR o TGZ (TAR.GZ), 

- RAR, 

- CAB.





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Códigos de error
<a name="codigos_error_ELTPARAGRAPHE000530"></a>

Se devuelven los siguientes códigos de error:

- 1: La ruta pasada como parámetro no existe.

- 2: Acceso denegado: el usuario no tiene suficientes derechos.

- 3: El archivo está corrupto.

- 4: La ruta no existe en el archivo.

- 6: Los archivos de los subarchivos no están ordenados (cuando se extraen de un archivo de varias partes).

- 21: La contraseña especificada no es correcta.




El mensaje correspondiente al código de error es devuelto por [zipMsgError](../WDLang3/3082034.md).
Recordatorio: 

- ![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Sólo están disponibles los archivos ZIP, TAR y TGZ (TAR.GZ).

- ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Sólo están disponibles los archivos ZIP.

- RAR es compatible hasta la versión 4 inclusive.



<a name="NOTE0_2"></a>


### Archivo extraído
<a name="archivo_extraido_ELTPARAGRAPHE000561"></a>

El archivo extraído no se elimina del archivo comprimido. Para eliminar un fichero o todos los ficheros del archivo, utilice [.DeleteFile](../WDLang3/1000019152.md) o [.DeleteAll](../WDLang3/1000019154.md).<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Extracción y contraseña
<a name="extraccion_contrasena_ELTPARAGRAPHE000585"></a>

Si el archivo no está encriptado y si se utilizó [zipPassword](../WDLang3/3082053.md):

- Archivo en formato WDZ: El archivo se sigue extrayendo.

- Archivo en formato ZIP: Se produce un error.



<a name="NOTE0_4"></a>


### Índice de ficheros en el archivo
<a name="indice_ficheros_archivo_ELTPARAGRAPHE000601"></a>

Cuando se añade un fichero a un archivo, se le asigna automáticamente un índice. Este índice corresponde al orden de inclusión de los ficheros en el archivo. Para seleccionar un fichero en el archivo comprimido, puede utilizar:

- el índice del elemento (el índice de un elemento es devuelto por [.FindFile](../WDLang3/1000026330.md)).

- la ruta almacenada del elemento.


<a name="NOTE0_5"></a>


### ruta almacenada
<a name="ruta_almacenada_ELTPARAGRAPHE000620"></a>

A continuación, tabla presenta las rutas almacenadas en el archivo según:

- el acceso ruta al fichero,

- la sección ruta almacenada.




El directorio actual es: "C:\\Temp".


|   |   |   |   |   |
| --- | --- | --- | --- | --- |
| **zipAddFile** | **Ubicación del archivo** | *zipNone* | *zipDirectory* | *zipDrive* |
| zipAddFile("Archi",...<br>"Archivo.txt") | C:\\Temp\\Archivo.txt | Archivo.txt | Archivo.txt | Archivo.txt |
| zipAddFile("Archi",...<br>"Data\\Archivo.txt") | C:\\Temp\\Data\\Archivo.txt | Archivo.txt | Data\\Archivo.txt | Data\\Archivo.txt |
| zipAddFile("Archi",...<br>"D:\\Data\\Archivo.txt") | D:\\Data\\Archivo.txt | Archivo.txt | Data\\Archivo.txt | D:\\Data\\Archivo.txt |


**Observación**: Si se usa la constante *zipDrive*: 

- el formato WDZ almacena la ruta completa del archivo (incluida la letra Drive). 

- el formato ZIP no almacena la letra Drive.

- el formato 7z almacena sólo los directorios.


![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) La constante *zipDrive* es equivale a la constante *zipDirectory*.![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) El directorio y el disco no se almacenan en el archivo ruta. Sólo se almacenan el nombre del archivo y extension. 

<a name="XComponent"></a>

## Componente:
wd280zip.dll
