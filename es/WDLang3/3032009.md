


## EmailStatus( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Devuelve el estado de un Email enviado a través de una sesión SMTP iniciada en modo asíncrono.


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Send an email via the SMTP protocol
IF EmailStartSession(USER, PASSWORD, "pop3.ifrance.fr", ...
	"smtp.ifrance.fr", 110, 25, True) = True THEN
		UserName = USER
ELSE
	UserName = ""
	Error("Unable to establish the connection")
END

// Initialize the email structure
Email.Recipient = "support@pcsoft.fr"
Email.Sender = "Tartampion@box.net.eu"
Email.Message = "Auto Email Test"
Email.NbRecipient = 1

// Send the email
IF EmailSendMessage(UserName) = False THEN
	Error("EMailSendMessage failed '" + ErrorInfo(errMessage) + "'")
ELSE
	Info("EmailSendMessage was successful")
END
...
// Track the email
SWITCH EmailStatus(Email.MailIdentifier)
	CASE emailSent: Trace("The email was sent")
	CASE emailPending: Trace("The email is currently processed")
	CASE emailError: Trace("Error: " + ErrorInfo(errMessage))
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = EmailStatus(<Email Identifier>)`
---

**`<Result>: (Constante)`**

Estado de salida de la Email especificada:


|   |   |
| --- | --- |
| *emailError* | Se produjo un error. Los detalles del error son devueltos por [ErrorInfo](../WDLang1/3013008.md)(*errMessage*). |
| *emailPending* | El Email está esperando ser enviado. Está en la bobinadora. |
| *emailSent* | El Email fue enviado. |



**`<Email Identifier>: (Integro)`**

Identificador del correo electrónico (variable **Email.MailIdentifier** o **ID** Property del [Envía un correo electrónico a Variable](../WDLang3/1000018713.md) inicializado al enviar el correo electrónico con [EmailSend](../WDLang3/3032003.md) y [EmailSendMessage](../WDLang3/3032005.md)).  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Gestión de correos electrónicos en modo asíncrono
<a name="gestion_correos_electronicos_modo_asincrono_ELTPARAGRAPHE000065"></a>

Las funciones de correo electrónico son funciones de bloqueo de Default. Lo que significa que no se puede ejecutar ningún otro código durante su ejecución.. El programa se reanudará sólo cuando se hayan ejecutado las funciones Email actuales.

**WEBDEV le ofrece la posibilidad de gestionar los correos electrónicos en modo asíncrono.** Este modo permite a sus sitios enviar correos electrónicos sin bloquear la ejecución de otros procesos.

Para utilizar el modo asíncrono, es necesario:

1. Desmarca "Deshabilitar el spooler de Email" en el administrador de WEBDEV (pestaña "Avanzado").

2. Activar el modo asíncrono al iniciar la sesión SMTP (con [EmailStartSMTPSession](../WDLang3/3032025.md) o [EmailStartSession](../WDLang3/3032028.md)).

3. Todos los correos electrónicos salientes serán transmitidos a un "spooler". Los correos electrónicos se ponen en cola antes de ser enviados.




La ejecución de las funciones de Email ya no bloquea el resto del programa. **EmailStatus** determina el estado de un email.

**Observación**: Si el administrador de WEBDEV está cerrado, el spooler de Email se borra.: los correos electrónicos pendientes no se envían y se eliminan del spooler.

Si hay Email s pendientes, y la opción "Deshabilitar el spooler de Email" está marcada, las Email s no se perderán: el administrador continúa enviándolos, pero el spooler no aceptará nuevos correos electrónicos.

**Atención**: El modo asíncrono solo puede utilizarse al iniciar una sesión en un servidor SMTP (función [EmailStartSMTPSession](../WDLang3/3032025.md) para enviar correos electrónicos o función [EmailStartSession](../WDLang3/3032028.md)). El modo asíncrono es ignorado en todos los demás casos.

<a name="XComponent"></a>

## Componente:
wd280com.dll
