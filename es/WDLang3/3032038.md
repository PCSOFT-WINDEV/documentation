


## EmailImportHTML (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Importa, en la estructura del correo electrónico o en un correo electrónico Variable, el contenido de un archivo HTML para enviarlo por Email. Las imágenes que se encuentran en el archivo HTML se incluyen automáticamente en la estructura del correo electrónico o en el correo electrónico Variable. 

- En la estructura de [Email](../WDLang3/3032029.md): La estructura de correo electrónico que maneja la actual Thread está llena: el Email.HTML Variable así como el Email.Attach[...] y el Email.NbAttach Variable s se inicializan según el contenido HTML.

- En el [Email](../WDLang3/1000018713.md) Variable: El actual correo electrónico Variable está lleno: las propiedades **NbAttach**, **Attach**[...] y **HTML** se inicializan según el contenido HTML.
	Observación: Se procesan las imágenes integradas mediante codificación en el archivo HTML.




Observación: El contenido HTML sólo es compatible con POP3/SMTP: esta función debe utilizarse sólo si el Email se envía en SMTP. 


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
MyHTMLText is ANSI string 
MyHTMLText = fLoadText("C:\Email\MyEmail.htm")
EmailImportHTML(MyHTMLText, "C:\Email")
Email.Recipient = "flop-fr@gmail.com"
Email.Subject = "Test"
EmailSendMessage("User")
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`EmailImportHTML([<Email>, ] <HTML content to send> , <Directory> [, <Options>])`
---

**`<Email>: (Correo electrónico opcional Variable)`**

Nombre de la variable [Email](../WDLang3/1000018713.md) correspondiente al correo electrónico en el que se importará el HTML Document.

Si no se especifica este parámetro, [Email.HTML](../WDLang3/3032029.md) (Variable de la estructura Email) se rellena con el contenido &lt;HTML a enviar&gt;.

**`<HTML content to send>: (Cadena de caracteres ANSI)`**

Contenido de Email en formato HTML.

**`<Directory>: (Cadena de caracteres)`**

Directorio reference para las imágenes (caso de rutas relativas en el contenido HTML).

**`<Options>: (Constante opcional de tipo Integer)`**

Opciones de importación (sólo cuando se utiliza la estructura Email): 


|   |   |
| --- | --- |
| *emailOptionDefault*<br>(Valor predeterminado) | Se genera un identificador único para identificar cada Image encontrada en el archivo HTML. **Este identificador es único independientemente del archivo HTML importado**.<br><br>Modo de operación de Default. |
| *emailOptionNoCID* | Se genera un identificador para las imágenes en el archivo HTML. **Este identificador no es único. Si se importan varios archivos HTML, pueden utilizar el mismo identificador Image**. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Modo de funcionamiento de las imágenes y archivos adjuntos
<a name="modo_funcionamiento_las_imagenes_archivos_adjuntos_ELTPARAGRAPHE000153"></a>

Si el contenido &lt;HTML a enviar&gt; se refiere a imágenes:

- estas imágenes se añaden automáticamente como archivos adjuntos al correo electrónico (en el [Email](../WDLang3/3032029.md) o en el [Email](../WDLang3/1000018713.md) variable).

- el código HTML del mensaje es modificado para reference los archivos adjuntos.




**Atención**: Los anexos se "añaden" a la Email. Por ejemplo, si el valor de la variable **Email.NbAttach** es 2 antes de llamar a la función **EmailImportHTML** y si el contenido HTML hace referencia a una imagen, esta imagen se incluirá en la variable **Email.Attach[3]** y el valor de la variable **Email.NbAttach** será 3.

Los archivos adjuntos adicionales deben agregarse antes de utilizar la función **EmailImportHTML**.

El orden de envío de los anexos no se respeta necesariamente cuando se recibe la Email.
El identificador de las imágenes es un identificador único.Observación: Si la importación se realiza en un [Email](../WDLang3/1000018713.md) Variable, se procesan las imágenes integradas por codificación en el archivo HTML de origen.



<a name="XComponent"></a>

## Componente:
wd280com.dll
