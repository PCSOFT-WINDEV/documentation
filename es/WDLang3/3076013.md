


## tapiDial( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Marca un número Phone para una voz Line.
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) **Observación**: Por Default, el dispositivo utilizado es el primer dispositivo compatible con TAPI 3.1 encontrado. [tapiDispositivo](../WDLang3/3076032.md) puede seleccionar un dispositivo específico. En este caso, se utilizará este dispositivo específico.![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) **Aplicación PABX**: Con una aplicación PABX, cada Line aparece como un dispositivo. Por lo tanto, para marcar en un Phone Line, debes:

1. Elija la Phone actual Line ([tapiDispositivo](../WDLang3/3076032.md)).

2. Número ([tapiDial](../WDLang3/3076013.md)).


Para ello, utilice la función [tapiLineDial](../WDLang3/3076012.md).

**Observación**: Dependiendo del sistema operativo y del controlador del módem, puede aparecer una ventana para realizar llamadas al utilizar la función **tapiDial**. Esta ventana se utiliza para terminar automáticamente la llamada actual.
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
IF tapiDial(EDT_PhoneNumber, "LineStatus")=True THEN 
	Info("Click OK to hang up") 
	tapiHangUp() 
END
```

```wl
PROCEDURE TestLineStatus(ValueLineStatus is int) 
SWITCH ValueLineStatus 
	CASE tapiLineBusy: Message("The line is busy") 
	CASE tapiLineConnected: Message("OK, connected")
	CASE tapiLineDialing: Message("Dialing in progress") 
	CASE tapiLineDialTone: Message("Dial tone")
	CASE tapiLineDisconnected: Message("The correspondent has hung up")
	CASE tapiLineProceeding: Message("Searching for your correspondent")
	CASE tapiLineRingBack: Message("Ringing")
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = tapiDial(<Number to dial> [, <WLanguage procedure> [, <Duration> [, <Custom parameter>]]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si la línea está abierta: puedes levantar el auricular y hablar,

- <u><u><u><u>False</u></u></u></u> en caso contrario. Para obtener más información sobre el error, utilice la función [tapiError](../WDLang3/3076020.md). 




**`<Number to dial>: (Cadena de caracteres)`**

Número de Phone a marcar. Para especificar un prefijo (0 para un Line externo por ejemplo), use una coma en el número. Por ejemplo: "0,0467789066".

**`<WLanguage procedure>: (Nombre de la Procedure opcional)`**

Nombre de WLanguage Procedure usado para manejar el progreso de la marcación. Este procedimiento tiene el siguiente formato:

```txt
PROCEDURE <Procedure name> (<Line status>, <Parameter>)
```

El primer parámetro del procedimiento (&lt;Estado de la línea&gt;) es un entero que puede tomar los siguientes valores: 



|   |   |
| --- | --- |
| *tapiLineBusy* | El Line está actualmente ocupado. |
| *tapiLineConnected* | El Line está conectado. |
| *tapiLineDialing* | Marcación en curso.<br><br>Observación: Si se utiliza la tecnología TAPI 3.1, esta constante ya no se devuelve. |
| *tapiLineDialTone* | El Line recibe un tono de llamada. |
| *tapiLineDisconnected* | El corresponsal ha colgado. |
| *tapiLineProceeding* | La llamada se marca: buscando al corresponsal. |
| *tapiLineRingBack* | Timbre en progreso. |

El segundo parámetro del procedimiento (&lt;Parámetro&gt;) es el parámetro personalizado pasado a la función **tapiDial**.

**Atención**: Esta Procedure no debe contener ninguna llamada al depurador (ni punto de interrupción, ni palabra clave STOP, ni expresión de autodetención, etc.).

**`<Duration>: (Entero o duración opcional)`**

Duración máxima de espera (en segundos). Cuando se supera este tiempo de espera, la función asume que no hay respuesta (nadie ha contestado). 
Este parámetro puede corresponder a: 

- un número entero correspondiente al número de segundos,

- una variable de tipo Duration,

- la duración en un formato legible (por ejemplo, 1 s o 10 ms). 




**`<Custom parameter>: (Cualquier tipo, opcional)`**

El parámetro pasó al WLanguage Procedure.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Diferencias entre tapiDial y tapiLineDial
<a name="diferencias_entre_tapidial_tapilinedial_ELTPARAGRAPHE000124"></a>

- La función **tapiDial** se utiliza cuando solo hay una llamada saliente. El identificador de la presente convocatoria no está disponible.

- [tapiLineDial](../WDLang3/3076012.md) se utiliza en un contexto en el que puede haber varias llamadas simultáneas. [tapiLineDial](../WDLang3/3076012.md) devuelve el identificador de llamada. Por lo tanto, puede manejarse fácilmente (por ejemplo, para transferir una llamada).



<a name="NOTE0_2"></a>


### Limitación
<a name="limitacion_ELTPARAGRAPHE000139"></a>

No se puede llamar a la función **tapiDial** en el procedimiento de detección de llamadas (definido con la función [tapiEscuchar](../WDLang3/3076029.md)).
<a name="NOTE0_3"></a>


### Configuración necesaria
<a name="configuracion_necesaria_ELTPARAGRAPHE000295"></a>

Las funciones de telefonía utilizan tecnología TAPI 2.0 y/o tecnología TAPI 3.1. Estas tecnologías pueden utilizarse en todos los sistemas.

<a name="XComponent"></a>

## Componente:
wd280com.dll
