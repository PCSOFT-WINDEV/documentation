


## HTTPRequest( Función)

<DIV class="specObsolete">
	<IMG style="float:left;margin-right:10px;" src="https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=warning_big.png"><B>Advertencia</B><BR>
	A partir de la versión <B>28</B>, esta función se mantiene sólo por compatibilidad (especialmente para la programación PHP). Se recomienda utilizar una Variable de tipo [httpRequest](../WDLang3/1000021158.md) con la función [HTTPSend](../WDLang3/1000021183.md). 
</DIV><a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Inicia una petición HTTP en un servidor. El resultado de la consulta (buffer) puede ser: 

- guardado en un archivo de copia de seguridad con [HTTPDestino](../WDLang3/1000017094.md)

- recuperado por [HTTPGetResult](../WDLang3/3043001.md).


![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) **Consejo**: Utilizar [HTTPSend](../WDLang3/1000021183.md) para ejecutar una petición HTTP. Esta función utiliza una [httpRequest](../WDLang3/1000021158.md) Variable para describir con precisión la petición HTTP. 

**Observaciones**: 

- Se soportan dos tipos de solicitudes: POST y get. Las peticiones del GET son automatic. Si no se especifica el "Mensaje por enviar", se trata de una solicitud GET (ver sintaxis). Para gestionar los formularios, se recomienda utilizar funciones específicas para los mismos ([HTTPCreateForm](../WDLang3/1000017119.md), [HTTPSendForm](../WDLang3/1000017190.md), etc.). 





<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000003043007&name=httprequest_funcion&product=WD">Ver ejemplos adicionales</a>

```wl
// Retrieve the HTML code of "www.windev.com" Web page
ResStart = HTTPRequest("http://www.windev.com")
```
<a name="Example2"></a>

```wl
// Retrieve an HTML page that uses a protected URL
ResStart = HTTPRequest("http://www.windev.com", ...
	"", "", "", "", "Julia", "Password")
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = HTTPRequest(<URL to contact> [, <User agent> [, <Additional HTTP header> [, <Message to send> [, <Message type> [, <Username> [, <Password>]]]]]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se inició la solicitud,

- <u><u><u><u>False</u></u></u></u> si se produce un error. Para obtener más información sobre el error, utilice la función [ErrorInfo](../WDLang1/3013008.md) con la constante *errMessage*.
	El resultado de la solicitud puede ser guardado en un archivo de respaldo por [HTTPDestino](../WDLang3/1000017094.md) o puede ser recuperado por [HTTPGetResult](../WDLang3/3043001.md).
	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Los errores relativos a la seguridad de las transacciones no son devueltos por [ErrorInfo](../WDLang1/3013008.md): la conexión es rechazada.




**`<URL to contact>: (Cadena de caracteres)`**

Dirección del servidor de Contact (URL Address). Este parámetro puede contener:

- el número de puerto para conectarse al servidor. El valor de Default es 80 (corresponde a un servidor de páginas web). Para especificar un número de puerto, utilice el siguiente formato: "&lt;URL del servidor&gt;**:**&lt;N° del puerto&gt;". Por ejemplo: http://www.windev.com:80.

- parámetros adicionales. Estos parámetros se pueden utilizar para realizar una búsqueda o para rellenar un formulario. Por ejemplo, para buscar "windev" en "http://www.google.com", la URL será: "http://www.google.com/search?q=windev". 




**Observaciones**:

- Para especificar tanto el número de puerto como los parámetros adicionales, utilice el siguiente formato: "&lt;URL del servidor&gt;**:**&lt;N° del puerto>/&lt;Parámetros adicionales>".

- Para realizar una transacción segura, la URL debe comenzar por "https://". En este caso, el modo de gestión de las solicitudes lo realiza siempre INTERNET Explorer (para más detalles, véase [HTTPConfigurar](../WDLang3/1000018985.md)). 




**`<User agent>: (Cadena de caracteres opcional)`**

Identifica al cliente. El nombre de la solicitud es devuelto por Default.  
El contenido de la respuesta puede depender del agente de usuario (por ejemplo, una solicitud realizada desde un dispositivo móvil y una solicitud realizada desde un navegador de PC requieren páginas diferentes).. En este caso, para más detalles, consulte la documentación del agente de usuario.

**`<Additional HTTP header>: (Cadena de caracteres opcional)`**



- Cabecera HTTP adicional que se añadirá al mensaje HTTP, 

- Cadena vacía ("") si se debe agregar ninguna solicitud HTTP.




**`<Message to send>: (Cadena de caracteres opcional)`**

Mensaje HTTP que se enviará al servidor. Este parámetro puede especificarse sólo para una solicitud de envío de mensajes (solicitud Post). El mensaje a enviar debe cumplir con el protocolo HTTP utilizado. Si se especifica este parámetro y si no está vacío, es una petición POST; de lo contrario, es una petición GET (todo lo demás es automatic).

**`<Message type>: (Cadena de caracteres opcional)`**

Tipo de contenido del mensaje HTTP que se enviará al servidor. Este parámetro puede especificarse sólo para una solicitud de envío de mensajes (solicitud Post). Este parámetro corresponde a "Content-Type". 
Por Default, el tipo de mensaje corresponde a: "application/x-www-form-urlencoded".
Sin embargo, tiene la posibilidad de utilizar cualquier valor, por ejemplo: "text/xml", "application/javascript", "application/json", "application/xml", "image/jpeg", ...
Para enviar datos en bruto que serán leídos de una vez por el servidor de aplicaciones WEBDEV, utilice los siguientes tipos: 

- "application/octet-stream".

- "text/xml".




**`<Username>: (Cadena de caracteres opcional)`**

Nombre utilizado para acceder a una página con una URL protected (cadena vacía por Default). Este nombre se utiliza para identificar al usuario.

Observación: Cuando se especifican los parámetros  y , se genera automáticamente la correspondiente cabecera de solicitud "Authorization:Basic"..


**`<Password>: (Cadena de caracteres opcional)`**

Contraseña associated con el nombre de usuario (cadena vacía por Default). Permite acceder a una página con una URL protected. **Atención**: La contraseña no se encripta cuando se envía a través de INTERNET.

Observación: Cuando se especifican los parámetros  y , se genera automáticamente la correspondiente cabecera de solicitud "Authorization:Basic"..



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Error de seguridad en una transacción segura
<a name="error_seguridad_una_transaccion_segura_ELTPARAGRAPHE000187"></a>

Durante una transacción segura, la solicitud puede fallar debido a errores de seguridad:

- Certificate o Certificate inválidos que vienen de una compañía desconocida.

- el nombre del sitio especificado en la Certificate no corresponde a un servidor.

- fecha inválida o caducada de Certificate.

- redirección a un servidor no seguro.

- ...




Estos errores son devueltos por [ErrorInfo](../WDLang1/3013008.md).

Si se produce uno de estos errores, puede volver a ejecutar la orden ignorando los errores.. Para hacerlo, use **HTTP.IgnoreError** Variable. 

El **HTTP.IgnoreError** Variable también se puede usar para administrar casos especiales durante las transacciones seguras (ignorando la lista de certificados revocados, por ejemplo). 

| Error devuelto por [ErrorInfo](../WDLang1/3013008.md)<br> (con la constante *errCode*) | Valor de HTTP.IgnoreError <br>(estos valores se pueden combinar) | description |
| --- | --- | --- |
| *httpErrorInvalidCertificate*<br>Certificate o Certificate inválidos que vienen de una compañía desconocida | *httpIgnoreInvalidCertificate* | El Certificate es ignorado. |
| *httpErrorInvalidCertificateName*<br>El nombre del sitio especificado en la Certificate no corresponde a un servidor | *httpIgnoreInvalidCertificateName* | El nombre del sitio especificado en la Certificate es ignorado. |
| *httpErrorExpiredCertificate*<br>Inválido o caducado Certificate fecha | *httpIgnoreExpiredCertificate* | La fecha de Certificate es ignorada |
| *httpErrorRedirectToHTTP*<br>Redirección a un servidor no seguro | *httpIgnoreRedirectToHTTP* | La redirección a un servidor no seguro está permitida. |
| *httpIgnoreRedirectToHTTPS*<br>Redirección a un servidor seguro | *httpIgnoreRedirectToHTTPS* | La redirección a un servidor seguro está permitida. |
|   | *httpIgnoreRedirection* | La redirección a una Page se ignora. |
|   | *httpIgnoreRevocation* | La Certificate que se encuentra en la lista de las Certificate revocadas no está marcada. |

Por ejemplo:


```wl
// Start a request on a secure server
ResStart = HTTPRequest("https://www.MyServer.com")
// If an error occurs
IF ResStart = False THEN
	// According to the type of error
	SWITCH ErrorInfo(errCODE)
		// Invalid certificate 
		// or coming from an unknown company
		CASE HTTPErrorInvalidCertificate: 
			// Ignore the certificate?
			IF YesNo("Security alert detected!", ...
				"Invalid certificate.", ...
				"Ignore this certificate?") = Yes THEN
				HTTP.IgnoreError = HTTPIgnoreInvalidCertificate
				// Start the request again 
				// while ignoring this error
				HTTPRequest("https://www.MyServer.com")
			END
		// Invalid or expired certificate date
		CASE HTTPErrorExpiredCertificate: 
			// Ignore the certificate date?
			IF YesNo("Security alert detected!", ...
				"Certificate date invalid or expired.", ...
				"Ignore this date?") = Yes THEN
				HTTP.IgnoreError = HTTPIgnoreExpiredCertificate
				// Start the request again 
				// while ignoring this error
				HTTPRequest("https://www.MyServer.com")
			END
	END
END
```
Observaciones: 

- Cuando las consultas HTTP se ejecutan en varios Thread , **HTTP.IgnoreError** Variable tiene un valor específico para cada Thread .

- ![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Se ignoran los errores relativos a la seguridad de las transacciones.. El **HTTP.IgnoreError** Variable no está disponible.

- ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) 
	**Antes de la versión 200057**, se ignoraban los errores de seguridad de las transacciones.. El **HTTP.IgnoreError** Variable no estaba disponible.
	**A partir de la versión 200057**, se soportan los siguientes errores: *httpIgnoreExpiredCertificate*, *httpIgnoreInvalidCertificate*, *httpIgnoreInvalidCertificateName*, *httpIgnoreRevocation*. Se ignoran los otros errores. Para la compatibilidad con versiones anteriores, todos los errores se ignoran en los proyectos existentes.. Estos errores sólo se soportan en los nuevos proyectos.
	



<a name="NOTE0_2"></a>


### Recuperación del resultado
<a name="recuperacion_del_resultado_ELTPARAGRAPHE000292"></a>

[HTTPGetResult](../WDLang3/3043001.md) se utiliza para recuperar el resultado de la última petición HTTP ejecutada.

Cuando se especifica un archivo de destino mediante [HTTPDestino](../WDLang3/1000017094.md):

- cuando se usa [HTTPGetResult](../WDLang3/3043001.md) con la constante *httpResult* , siempre devuelve una cadena vacía ("").

- la función [HTTPGetResult](../WDLang3/3043001.md) con la constante *httpHeader* siempre devuelve el encabezado de la respuesta HTTP. Este encabezado no se guarda en el archivo de destino: sólo se guardan los datos.




Una vez finalizada la solicitud, el destino se cancela y [HTTPRequest](../WDLang3/3043007.md) funciona como de costumbre.
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Acceder a una URL con contraseña protected
<a name="acceder_una_url_con_contrasena_protected_ELTPARAGRAPHE000322"></a>

Para acceder a una URL con contraseña protected, puede:

- utilizar los parámetros &lt;Nombre de usuario&gt; y &lt;Contraseña&gt; de la sintaxis de la función **HTTPRequest**.

- especificar el nombre de usuario y la contraseña directamente en el parámetro &lt;URL a contactar&gt;. Por ejemplo:
	
	```txt
	<Res> = HTTPRequest("http://<user>:<password>@<URL to contact>")
	```




<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Uso de un proxy
<a name="uso_proxy_ELTPARAGRAPHE000338"></a>

Para acceder a la URL especificada en la función **HTTPRequest** mediante un proxy, utilice la función [Proxy](../WDLang3/3043002.md).
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Cabeceras de autenticación
<a name="cabeceras_autenticacion_ELTPARAGRAPHE000352"></a>

Las cabeceras de autenticación se generan automáticamente en los siguientes casos:

- Si **HTTPRequest** usa la sintaxis con nombre de usuario y contraseña.

- Si la URL del servidor es la contraseña protected.

- Si se utiliza [Proxy](../WDLang3/3043002.md).



<a name="NOTE0_7"></a>
<a name="NOTE0_8"></a>
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) 

### Limitaciones
<a name="limitaciones_ELTPARAGRAPHE000383"></a>

- El proxy utilizado es el de INTERNET Explorer. 

- Los certificados no pueden ignorarse. 



<a name="NOTE0_9"></a>
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) 

### Funcionalidad de aplicación requerida
<a name="funcionalidad_aplicacion_requerida_ELTPARAGRAPHE000395"></a>

Cuando se utiliza esta función, se debe declarar una funcionalidad de la aplicación en el asistente de generación de aplicaciones.

Característica necesaria: Internet y redes públicas (saliente).

Esta función permite a las aplicaciones utilizar los accesos a INTERNET y a las redes public. 

<a name="XComponent"></a>

## Componente:
wd280com.dll
