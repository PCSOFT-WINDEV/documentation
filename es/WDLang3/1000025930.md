


## ModbusConnectTCP( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Conecta un cliente a un servidor Modbus mediante el protocolo de transmisión control (TCP).
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Create a session and connect to the Modbus server at address 192.168.1.18 on port 3275.
Session is modbusSession
Session = ModbusConnectTCP("192.168.1.18",3275)

// If the connection fails, display the error
IF ErrorOccurred = True THEN
	Trace(ErrorInfo())
ELSE
	// Write a value to register 0x42 on the server.
	ModbusWriteRegister(Session, 0x42,0xCAFE)
END

// Disconnect server
ModbusDisconnect(Session)
```

<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX1"></a>

`<Session> = ModbusConnectTCP(<Address> [, <Port> [, <Slave ID> [, <Connection timeout>]]])`
---

**`<Session>: (modbusSession Variable)`**

[modbusSession](../WDLang3/1000025924.md) Variable utilizado para comunicarse con el servidor Modbus.

**`<Address>: (Cadena de caracteres)`**

Servidor Modbus Address. Esta Address puede corresponder a: 

- una Address IPv4 o IPv6 ,

- un nombre de dominio (por ejemplo, "modbusserver.com").




**`<Port>: (Entero opcional)`**

Número de puerto que se utilizará para la conexión TCP. 
Por defecto, este parámetro es set a 502, el puerto estándar para Modbus TCP.

**`<Slave ID>: (Entero opcional)`**

Número entre 0 y 255 que indica a qué esclavo conectarse si está detrás de una pasarela (por ejemplo, una pasarela de Modbus TCP a Modbus RTU). 
Por defecto, este parámetro es set a 255 (difusión Address).

**`<Connection timeout>: (Entero opcional)`**

Tiempo de espera para conectarse al servidor Modbus, expresado en milisegundos. Este parámetro puede corresponder a: 

- un número entero que corresponde al número de milisegundos,

- una variable de tipo Duration,

- la duración en un formato legible (por ejemplo, 20s o 10 ms). 






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


- Después de llamar a **ModbusConnectTCP**, se recomienda comprobar el [ErrorOccurred](../WDLang1/3087001.md) Variable para asegurarse de que no hay errores.

- **ModbusConnectTCP** bloquea la aplicación hasta que se establece una conexión o se supera el tiempo de espera de la misma.

- El identificador del esclavo está en el [modbusSession](../WDLang3/1000025924.md) Variable. Si una operación debe realizarse en varios esclavos diferentes, puede cambiar el identificador del esclavo en la [modbusSession](../WDLang3/1000025924.md) Variable para evitar la reapertura de la sesión. 




<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Lógica de negocio
## Componente:
wd280com.dll
