
## NotifPushSend( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Envía un push Notification a un dispositivo móvil (iOS o Android). Esta función puede utilizarse en una aplicación WINDEV o en un sitio WEBDEV.. 
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Send a push notification on iOS
TokensSend is array of Buffers
MyPassword is ANSI string = "Password"

FOR i = 1 TO nbTokens
	Add(TokensSend, tokens[i])
END 

MyNotification is Notification
MyNotification.Message = "New notification"

MyResult is boolean 
MyResult = NotifPushSend(MyNotification, TokensSend, ...
		"applecertif.cer", MyPassword, BundleIDName, typeServiceIOSRelease)

IF MyResult = False THEN
	Trace(ErrorInfo())
END
```

<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX1"></a>

### iPhone/iPad: Envío de una Notification

`<Result> = NotifPushSend(<Notification> , <Tokens> , <Identification> , <Password> , <TopicID> , <Server type>)`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si el envío se realizó correctamente,

- <u><u><u><u>False</u></u></u></u> en caso contrario. [ErrorInfo](../WDLang1/3013008.md) se utiliza para identificar el error devuelto por el servicio Notification. 




**`<Notification>: (Notification)`**

Nombre de la variable [Notification](../WDLang3/1000019441.md) correspondiente al Notification a enviar. 

**`<Tokens>: (Array de los amortiguadores)`**

Nombre de la variable Array que contiene la lista de fichas que representan los dispositivos a los que se enviará el Notification. 

**`<Identification>: (Cadena de caracteres)`**

ruta completa del archivo que contiene la Certificate para las notificaciones de empuje de la aplicación (obtenido de Apple). Para obtener más información, consulte [Condiciones necesarias para las notificaciones Push en iOS](../WDLang3/1000021032.md). 

**`<Password>: (Cadena de caracteres ANSI)`**

Contraseña del archivo que contiene la Certificate para las notificaciones Push. Si el fichero no tiene contraseña, utilice una cadena vacía (""). Este parámetro debe corresponder a una cadena de caracteres ANSI. 

**`<TopicID>: (Cadena de caracteres)`**

Identificador del paquete especificado en la sección "General" de la generación del proyecto Xcode asistente. 

**`<Server type>: (Constante de tipo Integer)`**

Tipo de servidor al que se enviará el Notification: 


|   |   |
| --- | --- |
| *typeServiceIOSRelease* | Servidor de lanzamiento de IOS (APN). |
| *typeServiceIOSTest* | Servidor de pruebas IOS (APN). |








<a name="SYNTAX2"></a>

### Android: Enviando un Notification 

`<Result> = NotifPushSend(<Notification> , <Tokens> , <Identification> , <Invalid tokens> [, <Platform>])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si el envío se realizó correctamente,

- <u><u><u><u>False</u></u></u></u> en caso contrario. [ErrorInfo](../WDLang1/3013008.md) se utiliza para identificar el error devuelto por el servicio Notification. Estos errores pueden contener una lista de Token inválidos que deben ser eliminados de la base de datos de Token.




**`<Notification>: (Notification)`**

Nombre de la variable [Notification](../WDLang3/1000019441.md) correspondiente al Notification a enviar. 

**`<Tokens>: (Array de los amortiguadores)`**

Nombre de la variable Array que contiene la lista de fichas que representan los dispositivos a los que se enviará el Notification. 

**`<Identification>: (Cadena de caracteres)`**

Parámetro de identificación de la aplicación: 

- en GCM: Clave de autenticación de Google. 
	Se requiere una configuración específica para get esta llave. Para obtener más información, consulte [Configuración necesaria para las notificaciones Push en Android](../WDLang3/1000021022.md). 

- en Firebase, con la mensajería en la nube API: Clave de autenticación de Google. 
	Se requiere una configuración específica para get esta llave. Para obtener más información, consulte [Configuración necesaria para las notificaciones Push en Android](../WDLang3/1000022215.md). 

- en Firebase, con Firebase Cloud Messaging API( V1): contenido del fichero JSON con la clave private de la cuenta de servicio. 
	Se requiere una configuración específica para get este archivo JSON. Para obtener más información, consulte [Configuración necesaria para las notificaciones Push en Android](../WDLang3/1000022215.md). 




**`<Invalid tokens>: (Array de los amortiguadores)`**

Nombre de la Array de Buffers Variable. Este parámetro se rellena con la lista de tokens no válidos devueltos por el servidor. 



**`<Platform>: (Constante opcional de tipo Integer)`**

Plataforma que se utilizará para enviar el Notification. La aplicación Android que recibirá las notificaciones debe estar configurada para este tipo de plataforma.



|   |   |
| --- | --- |
| *npeFirebase* | Plataforma Firebase que utiliza la mensajería en la nube API. <br>Plataforma Push Notification disponible en WINDEV 22 Actualización 1. Esta plataforma está disponible: <br><br>- para los proyectos Firebase existentes que ya utilizan esta solución. <br><br>- para nuevos proyectos Firebase, si esta API esta activada. <br><br><br> |
| *npeFirebaseCM_v1* | plataforma Firebase utilizando la mensajería en la nube Firebase API( V1). <br>Nueva plataforma push Notification habilitada por Default para nuevos proyectos Firebase. <br>A partir de WINDEV 28 Actualización 2, esta plataforma debe ser utilizada para proyectos que utilicen Firebase Cloud Messaging API( V1). |
| *npeGCM*<br>(Valor predeterminado) | Plataforma de mensajería Google Cloud Messaging. <br>Antigua solución de Google para el envío de notificaciones push. <br>Esta plataforma sólo debe utilizarse para los proyectos existentes que ya utilizan las notificaciones push (proyectos creados con versiones anteriores a WINDEV 22 Update 1) |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


- El push Notification se envía a un servicio Notification (Apple o Google) que redistribuye este Notification a un set de dispositivos móviles. 

- Los servicios soportados son: 

	- Google Firebase (Google GCM se admite para la compatibilidad con versiones anteriores. Firebase es recomendado por Google).

		- Firebase Cloud Messaging API (V1)

		- Mensajería en la nube API




- Manzana APN. 

- Las notificaciones enviadas a los dispositivos Android tienen en cuenta el proxy definido por [Proxy](../WDLang3/3043002.md). 

- **A partir de Android 8** , Notification s enviados a dispositivos Android tenga en cuenta el Notification 3006100740069006f006e00 categoría (también llamada "Canal"). 

- **Características específicas para iOS**: 

	- Las notificaciones enviadas a los dispositivos que ejecutan iOS son directas (no transitan por el proxy).

	- El servicio de Apple permite 256 bytes de datos por Notification solamente. Por lo tanto, preste atención a la cantidad de datos enviados en el [Notification](../WDLang3/1000019441.md) Variable (el mensaje por ejemplo) para evitar superar este límite. Se producirá un error si se excede el límite.

	- La conexión con el servidor APN puede fallar si se envían dos notificaciones en muy poco tiempo interval (si el servidor sigue procesando el primer mensaje).

	- Para enviar notificaciones push en los dispositivos iOS, la aplicación debe poder acceder a los puertos 2195 y 2196 en TCP. 











<a name="XComponent"></a>

## Componente:
wd280device.dll
