


## &lt;Variable emailSMTPSession&gt;.SendMessage (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Envía una Email usando **SMTP**: el Email se envía directamente al servidor. **La Email se envía realmente cuando se desconecta del servidor SMTP** (es decir, cuando se cierra la sesión).

**Atención**: Antes de enviar el Email, debes hacerlo:

- Iniciar una sesión con [&lt;emailSMTPSession Variable&gt;.StartSession](../WDLang3/1000022306.md).

- Llenar una [Envía un correo electrónico a Variable](../WDLang3/1000018713.md) o la [Estructura de Email](../WDLang3/3032029.md) con el mensaje (remitente, destinatario, ...).




![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) En esta versión, los correos electrónicos sólo se pueden enviar a través del protocolo SMTP.






<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) **Envío de un mensaje por SMTP**


```wl
// Start an SMTP session
MySession is emailSMTPSession
MySession.ServerAddress = "smtp.mycompany.us"
MySession.StartSession()

// Build an email
MyMessage is Email
MyMessage.Sender = "ordering_department@mycompany.fr"
MyMessage.Recipient.Add("customer@company.com")
MyMessage.Subject = EDT_EmailSubject
MyMessage.Message = "EDT_EmailText"

// Send the message
MySession.SendMessage(MyMessage)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Enviando una Email usando SMTP

`<Result> = <Session>.SendMessage([<Email> [, <Advanced options>]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se envió el mensaje al servidor SMTP,

- <u><u><u><u>False</u></u></u></u> en caso contrario. Para obtener los detalles del error, utilice [ErrorInfo](../WDLang1/3013008.md) con la constante *errMessage*.


![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Si se produce un error, el contenido de Email.Error Variable debe ser comprobado.

**`<Session>: (Nombre del control)`**

Identifica la sesión de usuario. Corresponde a:

- el nombre de usuario que se utilizó para iniciar la sesión de Email ([&lt;emailSMTPSession Variable&gt;.StartSession](../WDLang3/1000022306.md) o [EmailStartSMTPSession](../WDLang3/3032025.md)).

- una variable de tipo [emailSMTPSession](../WDLang3/1000018765.md).




**`<Email>: (Correo electrónico opcional Variable)`**

Nombre de la [Email](../WDLang3/1000018713.md) Variable correspondiente al Email a enviar. Si no se especifica este parámetro, se utiliza la información que se encuentra en la [Estructura de Email](../WDLang3/3032029.md).
![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Este parámetro no está disponible.

**`<Advanced options>: (Constante opcional de tipo Integer)`**

Combinación de las siguientes constantes:


|   |   |
| --- | --- |
| *emailOptionEncodeHeader* | Codifica las cabeceras de los mensajes en Quoted-Printable si es necesario.. <br>Los encabezados de los mensajes no están codificados por Default. Esta constante impide la recepción de Email con caracteres acentuados mal decodificados. |
| *emailOptionMessageID* | Tiene en cuenta el **Email.MessageID** Variable para generar el Email. Esta opción se ignora si no se especifica esta Variable.<br><br>Esta opción es una opción avanzada. |
| *emailOptionReference* | Tiene en cuenta la variable **Email.Reference** para generar el correo electrónico. Esta opción se ignora si no se especifica esta Variable.<br><br>Esta opción es una opción avanzada. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones
<a name="NOTE0_2"></a>
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Barra de progreso
<a name="barra_progreso_ELTPARAGRAPHE000461"></a>

Para seguir el progreso del envío, utilice [EmailProgressBar](../WDLang3/3032017.md).

<a name="XComponent"></a>

## Componente:
wd280com.dll
