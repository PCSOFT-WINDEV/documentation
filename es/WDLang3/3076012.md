


## tapiLineDial( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Marca un número de Phone para una voz Line y elige el dispositivo a utilizar.

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) **Aplicación PABX**: Con una aplicación PABX, cada Line aparece como un dispositivo. Por lo tanto, para marcar en un Phone Line, debes:

1. Elija la Phone actual Line ([tapiDispositivo](../WDLang3/3076032.md)).

2. Número ([tapiDial](../WDLang3/3076013.md)).


Estas son las acciones realizadas por la función **tapiLineDial**.
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Retrieves the list of TAPI devices 
sTAPIList is string = tapiDeviceList() 
// Displays the list in a Combo Box control 
ListAdd(COMBO_TAPI, sTAPIList) 
... 
// Selects the TAPI device 
IF tapiLineDial(COMBO_TAPI[COMBO_TAPI], EDT_PhoneNumber, "TestLineStatus") <> 0 THEN 
	Info("Click OK to hang up") 
	tapiHangUp() 
END
```

```wl
PROCEDURE TestLineStatus(ValueLineStatus is int) 
SWITCH ValueLineStatus 
	CASE tapiLineBusy: Message("The line is busy") 
	CASE tapiLineConnected: Message("OK, connected") 
	CASE tapiLineDialing: Message("Dialing in progress") 
	CASE tapiLineDialTone: Message("Dial tone") 
	CASE tapiLineDisconnected: Message("The correspondent has hung up") 
	CASE tapiLineProceeding: Message("Searching for your correspondent") 
	CASE tapiLineRingBack: Message("Ringing") 
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = tapiLineDial(<Line to use> , <Number to dial> [, <WLanguage procedure> [, <Duration> [, <Custom parameter>]]])`
---

**`<Result>: (Integro)`**



- Identificador de llamada marcada. 

- 0 si se produce un error. Los detalles del error son devueltos por [ErrorInfo](../WDLang1/3013008.md).




**`<Line to use>: (Cadena de caracteres)`**

Line o dispositivo para usar. 

Recordatorio: La lista de dispositivos de telefonía es devuelta por [tapiDeviceList](../WDLang3/3076024.md).

**`<Number to dial>: (Cadena de caracteres)`**

Número de Phone a marcar.

**`<WLanguage procedure>: (Nombre de la Procedure opcional)`**

Nombre de WLanguage Procedure usado para manejar el progreso de la marcación. Este procedimiento tiene el siguiente formato:

```txt
PROCEDURE <Procedure name>(<Line status>, <Parameter>)
```

El primer parámetro del procedimiento (&lt;Estado de la línea&gt;) es un entero que puede tomar los siguientes valores: 


|   |   |
| --- | --- |
| *tapiLineBusy* | El Line está actualmente ocupado. |
| *tapiLineConnected* | El Line está conectado. |
| *tapiLineDialing* | Marcación en curso.<br><br>Observación: Si se utiliza la tecnología TAPI 3.1, esta constante ya no se devuelve. |
| *tapiLineDialTone* | El Line recibe un tono de llamada. |
| *tapiLineDisconnected* | El corresponsal ha colgado. |
| *tapiLineProceeding* | La llamada se marca: buscando al corresponsal. |
| *tapiLineRingBack* | Timbre en progreso. |

El segundo parámetro del procedimiento (&lt;Parámetro&gt;) es el parámetro personalizado pasado a la función **tapiLineDial**.

**Atención**: este Procedure no debe contener ninguna llamada al depurador (ningún punto de interrupción, ninguna palabra clave STOP, ninguna expresión de auto-stop, ...).

**`<Duration>: (Entero o duración opcional)`**

Duración máxima de espera (en segundos). Más allá de esta duración, la función asume que no hay respuesta (nadie contesta).. Este parámetro puede corresponder a: 

- un número entero correspondiente al número de segundos,

- una variable de tipo Duration,

- la duración en un formato legible (por ejemplo, 1 s o 10 ms). 


Este parámetro corresponde a 15 segundos por Default. 

**`<Custom parameter>: (Cualquier tipo, opcional)`**

El parámetro pasó al WLanguage Procedure.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Diferencias entre tapiDial y tapiLineDial
<a name="diferencias_entre_tapidial_tapilinedial_ELTPARAGRAPHE000120"></a>

- [tapiDial](../WDLang3/3076013.md) se utiliza en un contexto de una sola llamada saliente. El identificador de la presente convocatoria no está disponible.

- **tapiLineDial** se utiliza cuando se realizan varias llamadas simultáneas. La función **tapiLineDial** devuelve el identificador de la llamada. Por lo tanto, puede manejarse fácilmente (por ejemplo, para transferir una llamada).



<a name="NOTE0_2"></a>


### Limitación
<a name="limitacion_ELTPARAGRAPHE000134"></a>

No se puede llamar a la función **tapiLineDial** en el procedimiento de detección de llamadas (definido con la función [tapiEscuchar](../WDLang3/3076029.md)).
<a name="NOTE0_3"></a>


### Configuración necesaria
<a name="configuracion_necesaria_ELTPARAGRAPHE000279"></a>

Las funciones de telefonía utilizan tecnología TAPI 2.0 y/o tecnología TAPI 3.1. Estas tecnologías pueden utilizarse en todos los sistemas.

<a name="XComponent"></a>

## Componente:
wd280com.dll
