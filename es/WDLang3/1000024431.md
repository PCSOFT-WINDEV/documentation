
## Aplicación en modo kiosco
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000239"></a>
Una aplicación en modo kiosco es una aplicación de la que el usuario no puede salir. Cuando una aplicación está en modo kiosco, el usuario no puede abrir otras aplicaciones, no tiene acceso a la configuración del dispositivo, y no ve ni recibe notificaciones ni llamadas.

Se utiliza en diferentes casos: aplicación de demostración, aplicación de kiosco digital, aplicación para niños, aplicación diseñada para una tarea en particular, etc.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Android y el modo kiosco
<a name="android_modo_kiosco_ELTTEXTE000263"></a>


### Presentación
<a name="presentacion_ELTPARAGRAPHE000018"></a>

Desde Android 5.0, existen dos opciones para crear una aplicación en modo kiosco: 

- modo kiosco 'simple' (funcionalidad "Screen Pinning").

- modo kiosco 'completo'.





### Modo kiosco simple
<a name="modo_kiosco_simple_ELTPARAGRAPHE000026"></a>

Esta funcionalidad permite, sin permisos especiales, mostrar solo una aplicación en la pantalla: 

- la barra de estado aparece vacía,

- los íconos de las notificaciones se ocultan,

- los botones "Inicio" y "Aplicaciones recientes" se desactivan,

- las otras aplicaciones no pueden iniciar nueva actividades.




Esta funcionalidad puede utilizarse, por ejemplo, cuando se presta el teléfono a niños u otras personas sin que los datos personales queden expuestos. 

Sin embargo, esta funcionalidad no es suficiente en la mayoría de los demás casos. De hecho: 

- se solicita una confirmación del usuario antes de pasar a este modo. 

- el usuario puede salir de este modo en cualquier momento pulsando simultáneamente las teclas "Atrás" y "Aplicaciones recientes". 





### Modo kiosco completo
<a name="modo_kiosco_completo_ELTPARAGRAPHE000043"></a>

A diferencia del modo kiosco simple: 

- el modo kiosco completo no requiere confirmación. 

- el usuario no puede salir de modo kiosco completo.




Sin embargo, este modo requiere privilegios específicos. Estos privilegios solo se pueden obtener: 

- cuando la aplicación es propietaria del dispositivo ("Device owner")

- cuando una aplicación "device owner" otorga estos privilegios a la aplicación. 




Una aplicación "Device owner" puede realizar operaciones normalmente reservadas a aplicaciones del sistema (siempre que se declaren): crear usuarios, modificar la configuración global (acceso a wifi, Bluetooth), definir políticas de seguridad, ocultar aplicaciones, y en el caso del modo kiosco: bloquear la aplicación para evitar que el usuario salga de ella. 

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## ¿Cómo utilizar el modo kiosco simple en una aplicación WINDEV Mobile?
<a name="¿como_utilizar_modo_kiosco_simple_una_aplicacion_windev_mobile_ELTTEXTE000299"></a>


### ¿Cómo proceder?
<a name="¿como_proceder_ELTPARAGRAPHE000062"></a>

Para utilizar el modo kiosco simple: 

1. Utilice la función [KioskEnable](../WDLang3/1000024425.md). 

2. Se muestra un mensaje de confirmación al usuario para activar o desactivar el modo kiosco. 





### Observaciones
<a name="observaciones_ELTPARAGRAPHE000073"></a>

- Para saber si el modo kiosco está activado, utilice la función [InKioskMode](../WDLang1/1000024427.md). 

- Para salir del modo kiosco, utilice la función [KioskDisable](../WDLang3/1000024426.md). 








<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## ¿Cómo utilizar el modo kiosco completo en una aplicación WINDEV Mobile?
<a name="¿como_utilizar_modo_kiosco_completo_una_aplicacion_windev_mobile_ELTTEXTE000329"></a>


### ¿Cómo proceder?
<a name="¿como_proceder_ELTPARAGRAPHE000090"></a>

Para utilizar el modo kiosco completo: 

1. Pase la aplicación al modo "Device owner": 

	- Seleccione la opción "Aplicación de administración de dispositivos (puede convertirse en "device owner" para el modo kiosco)" en la descripción de la configuración del proyecto Android. 

	- Ejecute la línea de comandos para activar el modo kiosco completo (ver más abajo). 




2. Utilice la función [KioskEnable](../WDLang3/1000024425.md) en la aplicación para activar el modo kiosco. 





### Línea de mandos para activar el modo kiosco completo
<a name="linea_mandos_para_activar_modo_kiosco_completo_ELTPARAGRAPHE000108"></a>

**Después de instalar la aplicación en el dispositivo Android**, ejecute el siguiente comando ADB en el dispositivo en el que está instalada la aplicación: 

```txt
adb shell dpm set-device-owner 
<package>/fr.pcsoft.wdjava.core.application.WDDeviceAdminReceiver
```
donde:  
&lt;Paquete&gt; corresponde al nombre del paquete de la aplicación Android.
Este comando crea una entrada en el archivo "/data/system/ device_owner.xml" que define la aplicación como "Device owner". 
 **Observación**: Solo puede haber una aplicación en modo "Device owner" por dispositivo y esta operación solo es posible si no se ha configurado ningún usuario en el dispositivo. De lo contrario, se deben eliminar todos los usuarios antes de ejecutar el comando.


### ¿Cómo probar una aplicación usando el modo kiosco completo?
<a name="¿como_probar_una_aplicacion_usando_modo_kiosco_completo_ELTPARAGRAPHE000122"></a>

Para probar una aplicación Android usando el modo kiosco completo, se recomienda realizar una prueba en el emulador. Después, se puede reiniciar el emulador para probar otras aplicaciones. 

**A partir de Android 7.0**, se puede indicar que la aplicación solo se utiliza con fines de prueba al generar la aplicación Android. 
WINDEV Mobile propone esta opción en el asistente de generación de aplicaciones Android si: 

- se seleccionó la opción "Aplicación de administración de dispositivos (puede convertirse en "device owner" para el modo kiosco)" en la ventana de descripción de la configuración Android. 

- no se firmó la aplicación para la tienda durante la generación. 


Esta opción consiste en utilizar "android:testOnly=true" en el manifiesto de la aplicación. 

En este caso, después de realizar las pruebas en el dispositivo móvil, se puede desactivar el modo "Device owner" con la siguiente línea de comandos: 

```txt
adb shell dpm remove-active-admin <package>/fr.pcsoft.wdjava.core.application.WDDeviceAdminReceiver
```
Se recomienda activar esta opción durante la fase de pruebas de la aplicación. No se puede implementar una aplicación de pruebas en el Play Store. 


### Observaciones sobre el modo kiosco completo
<a name="observaciones_sobre_modo_kiosco_completo_ELTPARAGRAPHE000145"></a>

- Una vez que se ha definido una aplicación como "Device owner", no se puede desactivar este modo, ni eliminar la aplicación. Solo al restablecer la configuración de fábrica (factory reset), se puede eliminar la aplicación.  

- Para actualizar una aplicación en modo "Device owner", es necesario firmarla con la misma clave utilizada cuando se activó el modo.

- La función [InDeviceOwnerMode](../WDLang1/1000024428.md) permite saber si la aplicación es "Dvice owner".

- Para saber si el modo kiosco está activado, utilice la función [InKioskMode](../WDLang1/1000024427.md). 

- Para salir del modo kiosco, utilice la función [KioskDisable](../WDLang3/1000024426.md). 




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Consejos y programación
<a name="consejos_programacion_ELTTEXTE000371"></a>


### Consejos
<a name="consejos_ELTPARAGRAPHE000167"></a>

- Se recomienda definir una manera para salir del modo kiosco (opción de menú accesible mediante una contraseña, etc.). 

- Si se reinicia el sistema (problema de batería, etc.), el modo kiosco no se mantendrá la próxima vez que se inicie la aplicación. Recuerde :  

	- Reiniciar automáticamente la aplicación: seleccione la opción "Iniciar automáticamente la aplicación al iniciar el dispositivo" en el asistente de generación de la aplicación Android. 

	- Guardar el modo de la aplicación (modo kiosco o no) para que la próxima vez que se inicie la aplicación, este modo esté configurado de forma predeterminada (utilice las funciones [SaveParameter](../WDLang1/3025046.md) y [LoadParameter](../WDLang1/3025047.md) en el evento "Inicialización" del proyecto). 

	- Si es necesario, vuelva a activar el modo kiosco (función [KioskEnable](../WDLang3/1000024425.md) en el evento "Inicialización" del proyecto). 








### Funciones WLanguage relacionadas con el uso del modo kiosco
<a name="funciones_wlanguage_relacionadas_con_uso_del_modo_kiosco_ELTPARAGRAPHE000190"></a>




|   |   |
| --- | --- |
| [InDeviceOwnerMode](../WDLang1/1000024428.md) | Indica si la aplicación Android está en modo "Device owner". |
| [InKioskMode](../WDLang1/1000024427.md) | Indica si la aplicación Android está en modo kiosco. |
| [KioskDisable](../WDLang3/1000024426.md) | Desactiva el modo kiosco para la aplicación actual. |
| [KioskEnable](../WDLang3/1000024425.md) | Cambia la aplicación Android en curso a modo kiosco. |






