


## SocketConnectSSL( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Se utiliza para establecer una conexión segura con un servidor SSL.  


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
IF SocketConnectSSL("Server", 8000, "150.134.20") = False THEN
	Error("Connection error" + ErrorInfo(errMessage))
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = SocketConnectSSL(<Socket name> , <Port number> , <Address> [, <SSL option> [, <Maximum timeout> [, <Client certificate>]]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se estableció la conexión,

- <u><u><u><u>False</u></u></u></u> en caso contrario. Si se produce un error, puede get más detalles sobre el error con [ErrorInfo](../WDLang1/3013008.md).




**`<Socket name>: (Cadena de caracteres)`**

Nombre que se le dará a la conexión abierta en el socket del servidor. Este nombre será utilizado por todas las funciones del socket.

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) Atención: el nombre del socket distingue entre mayúsculas y minúsculas.

**`<Port number>: (Integro)`**

Número de puerto de la toma de corriente. Si utiliza un zócalo associated con un protocolo preestablecido, utilice el número de puerto associated con el protocolo.
Si el socket fue creado por una aplicación WINDEV, este número debe incluirse entre 5 000 y 65 000. En este caso, el número debe ser idéntico al número de puerto especificado en [SocketCreateSSL](../WDLang3/1000017041.md).

**`<Address>: (Cadena de caracteres)`**

Dirección del servidor. Si no se especifica este parámetro, se busca el servidor en el ordenador actual.. Esta Address se puede dar en el siguiente formato:

- IP Address en formato XXX.XXX.XXX.XXX (125.5.110.100 por ejemplo).

- URL que contiene el nombre del servidor (www.windev.com por ejemplo). Se recomienda esta sintaxis.




![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) La Address también puede corresponder a la IP Address devuelta por [NetIPAddress](../WDLang3/3056023.md).

**`<SSL option>: (Combinación opcional de constantes de tipo integer)`**

Permite elegir el protocolo y el modo de identificación: 



|   |   |
| --- | --- |
| *ProtocolSSL2* | SSL2 protocol<br><br>![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) Este protocolo no es compatible. |
| *ProtocolSSL3* | Protocolo SSL3<br><br>![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) Este protocolo no es compatible. |
| *ProtocolTLS1* | Protocolo TLS1 |
| *ProtocolTLS1 _1* | TLS 1.1 protocol |
| *ProtocolTLS1 _2* | TLS 1.2 protocol |
| *ProtocolTLS1 _3* | TLS 1.3 protocol |


Por Default, la combinación utilizada es: *ProtocolTLS1* + *ProtocolTLS1_1* + *ProtocoleTLS1_2*.

**`<Maximum timeout>: (Entero o duración opcional)`**

Tiempo máximo de espera (en milisegundos) para establecer la conexión. Este tiempo de espera se utilizará si el servidor rechaza la conexión ([SocketDeny](../WDLang3/3070010.md)). En este caso, la conexión no se bloqueará.
Este parámetro puede ser: 

- un número entero que corresponde al número de milisegundos,

- una variable de tipo Duration,

- la duración en un formato legible (por ejemplo, 1 s o 10 ms). 


Esta espera es igual a 10 milisegundos de Default.

**`<Client certificate>: (Variable de tipo Certificate)`**

Nombre de la [Certificate](../WDLang1/1000019287.md) Variable que permite al servidor autentificar al cliente que quiere conectarse y comprobar si este cliente está autorizado a acceder al servidor. Este Certificate debe ser reconocido en el servidor. 
![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) Este parámetro no está disponible. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Optimizando las conexiones para una IP Address
<a name="optimizando_las_conexiones_para_una_address_ELTPARAGRAPHE000160"></a>

Cuando se pasa una dirección IP a la función **SocketConnectSSL**, se puede optimizar la conexión utilizando el siguiente código:  


```wl
Socket.Option = SocketOptimizeIPConnection
```


Esta opción no está habilitada por Default porque la conexión puede fallar en algunas configuraciones. Sin embargo, puede ser useful en algunas aplicaciones para las que el rendimiento es crítico.

**Observación**: Para restaurar el comportamiento predeterminado, simplemente use la constante *SocketOptionDefault*:


```wl
Socket.Option = SocketOptionDefault
```

<a name="NOTE0_2"></a>


### Timeout
<a name="timeout_ELTPARAGRAPHE000177"></a>

El tiempo de espera especificado por  agrupa el tiempo de espera de dos pasos:

- el tiempo de espera para la resolución de Address: este tiempo de espera no puede ser configurado y puede ser optimizado (ver abajo).

- el tiempo máximo de espera para que la conexión sea aceptada por el servidor. Pueden darse varios casos:

	- el servidor rechaza la conexión.

	- el servidor acepta la conexión dentro del tiempo de espera

	- el servidor no está disponible.

	- la Address especificada es inválida.







Para optimizar el tiempo de resolución de Address (tiempo necesario para encontrar el Address), le aconsejamos que:

- usar un DNS en la red. Por lo tanto, esta Address se buscará hacia este servidor y no para cada ordenador (1 búsqueda en lugar de x búsquedas donde x representa el número de ordenadores). Cada computadora debe estar registrada hacia este servidor.

- para una dirección IP, use Socket.Option = SocketOptimizeIPConnection.


<a name="NOTE0_4"></a>

<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Lógica de negocio
## Componente:
wd280com.dll
