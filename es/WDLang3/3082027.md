


## zipChangePath (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Modifica la ruta almacenada de un archivo en un archivo comprimido (en formato ZIP, WDZ o 7z).. Permite configurar la extracción ruta del archivo.






<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000003082027&name=zipchangepath_funcion&product=WD">Ver ejemplos adicionales</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
```wl
MyArchive is zipArchive
// Open an archive
ResOpenArchive = zipOpen(MyArchive, "C:\MyArchives\Archive.zip")
IF ResOpenArchive = 0 THEN
	...
	// Modify the stored path of File.doc
	ResChangePath = zipChangePath(MyArchive, "File.doc", "Backup.doc")
	...
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Modificación de la ruta almacenada de un fichero identificado por su índice

`<Result> = zipChangePath(<Archive name> , <File index> , <New file path>)`
---

**`<Result>: (Integro)`**



- 0 si se ha realizado la modificación,

- Un código de error (valor superior a 0) en caso contrario. Para más detalles sobre estos códigos de error, consulte la página web de [Observaciones](#NOTE0_1).




**`<Archive name>: (Cadena de caracteres)`**

Nombre del archivo que contiene el fichero a modificar (definido por [zipOpen](../WDLang3/3082044.md) o [zipCreate](../WDLang3/3082003.md)).

**`<File index>: (Integro)`**

Índice del fichero a modificar. [zipFindFile](../WDLang3/3082002.md) devuelve este índice. 

**`<New file path>: (Cadena de caracteres)`**

Nueva ruta para almacenar para el archivo (hasta 260 caracteres).  


<a name="SYNTAX2"></a>

### Modificar la ruta almacenada de un archivo identificado por su ruta

`<Result> = zipChangePath(<Archive> , <File path> , <New file path>)`
---

**`<Result>: (Integro)`**



- 0 si se ha realizado la modificación,

- Un código de error (valor superior a 0) en caso contrario. Para más detalles sobre estos códigos de error, consulte la página web de [Observaciones](#NOTE0_1).




**`<Archive>: (Cadena de caracteres o zipArchive Variable)`**

Nombre del archivo donde se debe modificar el fichero ruta.
Este nombre puede corresponder a:

- un nombre de archivo definido con [zipOpen](../WDLang3/3082044.md) o [zipCreate](../WDLang3/3082003.md).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) el nombre de una variable de tipo [zipArchive](../WDLang3/1000018679.md).




**`<File path>: (Cadena de caracteres)`**

ruta almacenada del archivo a modificar.

**`<New file path>: (Cadena de caracteres)`**

Nueva ruta para almacenar para el archivo (hasta 260 caracteres).  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Condiciones de uso
<a name="condiciones_uso_ELTPARAGRAPHE000164"></a>

La ruta de un fichero de archivo puede modificarse si:

- El archivo existe (los archivos se crean con [zipCreate](../WDLang3/3082003.md)).

- El archivo es accesible en lectura/escritura.

- El archivo es un archivo de una sola parte.




Atención: 

- **Archivos en formato CAB**: Esta función no está disponible. Este formato no se puede utilizar para almacenar la ruta de un archivo.

- **Archivos en formato RAR**: Esta función no está disponible. 

- **Archivos en formato TAR y TGZ (TAR.GZ)**: Esta función no está disponible. 

- **Archivos en formato 7z**: El archivo se comprime completamente al llamar a la función **zipChangePath**.

- ![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) Sólo están disponibles los archivos ZIP, TAR y TGZ (TAR.GZ).

- ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Sólo están disponibles los archivos ZIP.



<a name="NOTE0_2"></a>


### Códigos de error
<a name="codigos_error_ELTPARAGRAPHE000195"></a>

Se devuelven los siguientes códigos de error:

- 1: La ruta pasada como parámetro no existe.

- 3: El archivo está corrupto.




El mensaje correspondiente al código de error es devuelto por [zipMsgError](../WDLang3/3082034.md).
<a name="NOTE0_3"></a>


### ruta almacenada de ficheros de archivo
<a name="ruta_almacenada_ficheros_archivo_ELTPARAGRAPHE000212"></a>

Cuando se añade un fichero a un archivo ([zipAddFile](../WDLang3/3082008.md) y [zipAddDirectory](../WDLang3/3082014.md)), se especifica la sección del fichero ruta que debe almacenarse en el archivo.

La ruta modificada no contiene necesariamente las mismas secciones que la ruta inicial.. Por ejemplo, si las rutas de los ficheros contienen los diferentes directorios así como el nombre y extension del fichero, el nuevo ruta puede contener sólo el nombre y extension del fichero.
<a name="NOTE0_4"></a>


### Archivos Zip de más de 4 GB
<a name="archivos_zip_mas_4_ELTPARAGRAPHE000229"></a>

Para usar **zipChangePath** en archivos de más de 4 GB, el archivo debe haber sido creado por [zipCreate](../WDLang3/3082003.md) 00 con la constante *zipHeader64* .
<a name="NOTE0_5"></a>


### Índice de ficheros en el archivo
<a name="indice_ficheros_archivo_ELTPARAGRAPHE000245"></a>

Cuando se añade un fichero a un archivo, se le asigna automáticamente un índice. Este índice corresponde al orden de inclusión de los ficheros en el archivo. Para seleccionar un fichero en el archivo comprimido, puede utilizar:

- el índice del elemento (el índice de un elemento es devuelto por [zipFindFile](../WDLang3/3082002.md)).

- la ruta almacenada del elemento.




<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Lógica de negocio
## Componente:
wd280zip.dll
