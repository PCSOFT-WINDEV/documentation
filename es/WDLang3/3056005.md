
## NetSendFile( Función)

<DIV class="specObsolete">
	<IMG style="float:left;margin-right:10px;" src="https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=warning_big.png"><B>Advertencia</B><BR>
	 está funcionalidad no estará disponible.
</DIV><a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Transmite un archivo a un servidor FTP (File Transfer Protocol) alimentado por WINDEV.. Este archivo puede ser recuperado en el servidor FTP por [NetGetFile](../WDLang3/3056025.md).

**Observación**: Para permitir (o no) el uso de esta función en un servidor FTP/RPC, llame a [NetServerOpción](../WDLang3/3056022.md).
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000003056005&name=netsendfile_funcion&product=WD">Ver ejemplos adicionales</a>

```wl
IF NetSendFile(ConnectFTP, "C:\autoexec.bat", ...
	"C:\autoexec.cli", "SendFile", 10) = False THEN
	Info("The transfer failed")
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = NetSendFile(<Connection identifier> , <File on client computer> , <File on server> [, <Event> [, <Event frequency>]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se realizó la transferencia,

- <u><u><u><u>False</u></u></u></u> en caso contrario. La función devuelve inmediatamente un status reporte y la transferencia se realiza en paralelo en otra tarea de Windows.




**`<Connection identifier>: (Integro)`**

Identificador de conexión (devuelto por [NetConnect](../WDLang3/3056004.md)).

**`<File on client computer>: (Cadena de caracteres ANSI)`**

Nombre completo (nombre y ruta) del archivo de copy, encontrado en el ordenador del cliente.

**`<File on server>: (Cadena de caracteres ANSI)`**

Nombre completo (nombre y ruta) del archivo copiado en el servidor.

**`<Event>: (Cadena de caracteres o entero (opcional))`**

Evento personalizado o evento de Windows enviado al cliente para seguir el progreso de la Transfer( ver las Notas).

**`<Event frequency>: (Entero opcional)`**

Frecuencia (en porcentaje del tamaño del archivo) con la que se envía el mensaje  al cliente..  


<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones




### Progreso de la transferencia de archivos
<a name="progreso_transferencia_archivos_ELTPARAGRAPHE000065"></a>

El progreso de la transferencia de archivos se gestiona únicamente en el programa cliente FTP.

**NetSendFile** no es una función de bloqueo: la transferencia de archivos se realiza en la tarea de Background. Sin embargo, usted tiene la capacidad de transferir un solo archivo a la vez.

**Para transferir varios archivos** , debe esperar a que se transfiera cada archivo antes de transferir el siguiente.
En este caso, se pueden usar dos parámetros con **NetSendFile**:

- un mensaje de progresión (parámetro ), 

- una frecuencia (parámetro &lt;Frecuencia evento&gt;).




**NetSendFile** envía el mensaje especificado para seguir el progreso de la transferencia. Este mensaje debe ser interceptado por [Event](../WDLang1/3015011.md). El mensaje contiene dos parámetros:

- _EVE.wParam indica el tamaño transferido (indicador de progreso), 

- _EVE.lParam indica el tamaño total del archivo.




El mensaje de progreso se procesa en el Procedure llamado por [Event](../WDLang1/3015011.md). En este procedimiento, es posible:

- mostrar una barra de progreso utilizando los parámetros del mensaje (_EVE.lParam y _EVE.wParam), 

- averiguar si se ha completado la transferencia de archivos (en este caso, _EVE.lParam = _EVE.wParam).


<a name="NOTE0_2"></a>




### Frecuencia de la Event
<a name="frecuencia_event_ELTPARAGRAPHE000105"></a>

El parámetro &lt;Frecuencia evento&gt; permite definir la frecuencia mínima de envío de mensajes. Por ejemplo, para un archivo de 1 MB y una frecuencia del 10%, se recibirá un mensaje cada vez que se transfieran 100 KB.

La frecuencia define el número máximo de mensajes que se pueden recibir. El número de mensajes recibidos se reduce cuando la transferencia es rápida.

Por ejemplo, para un archivo de 100 KB y una frecuencia del 10%, se recibirán alrededor de 10 mensajes: 1 mensaje cada vez que se transfieren 10 KB. De hecho, el número de mensajes será menor porque la transferencia es rápida.

Consejos sobre la elección de la frecuencia:

- Si no se muestra ninguna barra de progresión, la mejor opción para la frecuencia es set a 100%. Se recibirá un único mensaje cuando se complete la transferencia de archivos.

- Si la velocidad de transferencia es lenta (transferencia por módem), le aconsejamos que muestre una barra de progreso.. Una frecuencia del 10% es apropiada en la mayoría de los casos.

- Si la velocidad de transferencia es rápida (red local), no recomendamos que utilice una frecuencia pequeña (1% por ejemplo) porque la cantidad de mensajes recibidos podría saturar el sistema.. En este caso, una frecuencia del 10% es apropiada en la mayoría de los casos.




<a name="XComponent"></a>

## Componente:
wd280com.dll
