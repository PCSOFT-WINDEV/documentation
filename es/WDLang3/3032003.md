


## EmailSend( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Envía un Email a través del protocolo SMTP mientras controla el "buffer" del Email.

**Esta función es una función avanzada que se utiliza para configurar por completo el Email enviado.** Esta función sólo debe utilizarse para gestionar los Email específicos no gestionados por [EmailSendMessage](../WDLang3/3032005.md). Para obtener más información, consulte [Escribir un Email](../WDLang3/3032002.md).

**Observación**: Todo el correo electrónico description se puede encontrar en los documentos reference del estándar INTERNET: RFC822 y RFC2045 a RFC2049. Estos documentos están disponibles en INTERNET (utilice un motor de búsqueda con las referencias de los documentos).

También tiene la posibilidad de utilizar las variables [emailSMTPSession](../WDLang3/1000018765.md) y [Email](../WDLang3/1000018713.md), así como [EmailImportSource](../WDLang3/1000017226.md), para enviar un mensaje mientras controla el origen del mismo.




<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000003032003&name=emailsend_funcion&product=WD">Ver ejemplos adicionales</a>

```wl
// Initialize the email structure
Email.NbRecipient = 1
Email.Recipient = "support_test@pcsoft_test.fr"
Email.Sender = "customer@company.fr"
Email.Message = "Auto Email Test"

// Build the message
IF EmailBuildSource() = False THEN
	Error(ErrorInfo())
	RETURN
END

IF fSaveText("C:\MyEmails\EmailContent.txt", Email.Source) = False THEN
	Error(ErrorInfo())
	ELSE
		EmailSend("SMTPSession", "C:\MyEmails\EmailContent.txt")
		IF ErrorOccurred = True THEN
			Error(ErrorInfo())
		END 
	END
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = EmailSend(<Username> , <File name>)`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si la función se ejecutó correctamente,

- <u><u><u><u>False</u></u></u></u> en caso contrario. Para obtener más información sobre el error, utilice la función [ErrorInfo](../WDLang1/3013008.md) con la constante *errMessage*.




**`<Username>: (Cadena de caracteres)`**

Identifica la sesión de usuario. Corresponde al nombre de usuario que se utilizó para iniciar la sesión de Email ([EmailStartSession](../WDLang3/3032028.md)).

**`<File name>: (Cadena de caracteres)`**

Identifica el archivo que contiene todo el Email formateado según los parámetros esperados por el servidor SMTP.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### La estructura de Email
<a name="estructura_email_ELTPARAGRAPHE000089"></a>

Cuando se envía el Email, sólo se tienen en cuenta las variables de la estructura Email requeridas por el protocolo SMTP. Las otras variables son ignoradas.

**Observación**: Para obtener más información, consulte [La estructura de Email](../WDLang3/3032029.md).
<a name="NOTE0_2"></a>

<a name="XComponent"></a>

## Componente:
wd280com.dll
