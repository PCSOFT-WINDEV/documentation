
## Estructura de LDAPSession
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000142"></a>
El **Sesión LDAP** es una estructura preestablecida de WLanguage (no se requiere declaración). Esta estructura se utiliza para definir las características de una sesión LDAP.

**Observación**: Para restablecer todas las variables de la estructura **LDAPSession** con los valores Default, utilice [LDAPReset](../WDLang3/3032103.md).

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Los diferentes miembros de la estructura de LDAPSession
<a name="los_diferentes_miembros_estructura_ldapsession_ELTTEXTE000166"></a>
La estructura contiene los siguientes miembros:


|   |   |
| --- | --- |
| Host | Cadena de caracteres.<br>Dirección del servidor:<br><br>- IP Address del servidor en formato xxx.xxx.xxx.xxx<br><br>- Nombre del servidor<br><br><br> |
| Contraseña | Cadena de caracteres.<br>Contraseña associated con el usuario. Corresponde a una cadena vacía ("") de Default. |
| Opción | Constante de tipo Integer<br>Modo de gestión de SSL: <br><br>- *ldapDefaultOption*: LDAP estándar, sin gestión SSL.<br><br>- *optionSSL*: LDAP con gestión de la conexión SSL de secure. <br><br>- *optionSSL* + *auNegotiate*: LDAP con gestión de la conexión y autentificación secure SSL: <br><br>	- Si no se especifica el nombre de usuario, se utiliza el nombre de usuario de conexión de Windows.. <br><br>	- Si se especifica el nombre de usuario y la contraseña, la conexión se establece a través de "Generic Security Services" (GSS) (Snego).. El método de autenticación utilizado es el más apropiado que se encuentra en una lista de posibles autenticaciones.<br><br><br><br><br><br><br><br>Observación: El modo de conexión utilizado debe ser soportado por el servidor LDAP. |
| Puerto | Integro.<br>Puerto del servidor (389 por Default). |
| Usuario | Cadena de caracteres.<br>Autenticación del usuario. Esta cadena puede corresponder a cualquier modo de identificación reconocido por el servidor. Corresponde a una cadena vacía ("") de Default. |
| variante | Integro<br>Versión del servidor LDAP (2 o 3). Corresponde al 3 de Default. |







## Observaciones
<a name="observaciones_ELTTEXTE000190"></a>
Para establecer conexiones LDAP de secure (LDAP sobre SSL), debe:

- Modificar el número de parte de la estructura de LDAPSession: 636 de Default

- Instalar el Certificate de la autoridad de confianza que firmó el servidor Certificate en el el equipo desde el que se llama a [LDAPConnect](../WDLang3/3032100.md).

- Utiliza el mismo nombre de host que el de la Certificate SSL instalada en el servidor.








## Ejemplo
<a name="ejemplo_ELTTEXTE000214"></a>
Ejemplo de conexión al servidor: 


```wl
// Initialization
LDAPReset()
LDAPSession.Host = "domain.local"
LDAPSession.Port = 389
LDAPSession.Version = 3
LDAPSession.User = "user@domain.local"
LDAPSession.Password = "pwd"
LDAPSession.Option = ldapDefaultOption
// Check box used to choose the secure SSL connection
IF CBOX_Options[1] = True THEN
	LDAPSession.Option += optionSSL
END
// Check box used to choose the "Negotiate" mode
IF CBOX_Options[2] = True
	LDAPSession.Option += auNegotiate
END

// Connection
LDAPConnect("MySession")
```





