


## &lt;Variable emailNotesSession&gt;.SendMessage (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Envía una Email usando **Lotus Notes**: la Email se coloca en la bandeja de salida del software de mensajería. El Email es enviado automáticamente por el bobinador de Domino. 
Atención: Lotus Notes debe instalarse en modo conectado (y no en modo local).

**Atención**: Antes de enviar el Email, debes hacerlo:

- Iniciar una sesión con [&lt;emailNotesSession Variable&gt;.StartSession](../WDLang3/1000022303.md).

- Llenar una [Envía un correo electrónico a Variable](../WDLang3/1000018713.md) o la [Estructura de Email](../WDLang3/3032029.md) con el mensaje (remitente, destinatario, ...).









<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Start a Notes session
MySession is emailNotesSession
MySession.StartSession()

// Build an email
MyMessage is Email
MyMessage.Sender = "ordering_department@mycompany.fr"
MyMessage.Recipient.Add("customer@company.com")
MyMessage.Subject = EDT_EmailSubject
MyMessage.Message = "EDT_EmailText"

// Send the message
MySession.SendMessage(MyMessage)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX2"></a>

## Sintaxis
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
### Envío de un Email a través de MS Exchange, Lotus Notes o Outlook

`<Result> = EmailSendMessage(<Session ID> [, <Email> [, <Display> [, <Type>]]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si el mensaje se colocó en la bandeja de salida de MS Exchange, Lotus Notes o Outlook,

- <u><u><u><u>False</u></u></u></u> en caso contrario. Para obtener los detalles del error, utilice [ErrorInfo](../WDLang1/3013008.md) con la constante *errMessage*.




**`<Session ID>: (Variable de tipo emailNotesSession)`**

Identifica la sesión actual de Email. Este parámetro es un número entero devuelto por [EmailStartNotesSession](../WDLang3/3032121.md).

- una variable de tipo [emailNotesSession](../WDLang3/1000018768.md).




**`<Email>: (Correo electrónico opcional Variable)`**

Nombre del Variable de tipo [Email](../WDLang3/1000018713.md) correspondiente al Email a enviar.

Si no se especifica este parámetro, se utiliza la información que se encuentra en la [Estructura de Email](../WDLang3/3032029.md).

**`<Display>: (Booleano opcional)`**



- <u><u><u><u>True</u></u></u></u> para mostrar el mensaje en un cuadro de diálogo antes de enviarlo,

- <u><u><u><u>False</u></u></u></u> (predeterminado) para no mostrar ningún cuadro de diálogo.




Este parámetro sólo se tiene en cuenta si la sesión de Email fue iniciada por [&lt;emailNotesSession Variable&gt;.StartSession](../WDLang3/1000022303.md), utilizando la sintaxis de MS Exchange con un nombre de perfil. En los demás casos, no se visualiza la ventana de diálogo.

**Observación**: Este parámetro no está disponible para Lotus Notes.

**`<Type>: (Cadena de caracteres opcional)`**

Describe el tipo de mensaje a enviar. Por defecto, &lt;Tipo&gt; = "IPM" (Inter Personal Message).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones
<a name="NOTE0_2"></a>
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Barra de progreso
<a name="barra_progreso_ELTPARAGRAPHE000483"></a>

Para seguir el progreso del envío, utilice [EmailProgressBar](../WDLang3/3032017.md).



<a name="XComponent"></a>

## Componente:
wd280com.dll
