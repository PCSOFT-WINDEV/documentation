
## LDAPAddAttribute( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Añade un atributo o añade un nuevo valor a un atributo existente.

Esta función se puede utilizar al crear un nuevo objeto y al modificar un objeto en un servidor LDAP.
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Add a Test user into an "Active Directory"
LDAPStartAdd("MyLDAPSession")
LDAPAddAttribute("MyLDAPSession", "objectClass", "top")
LDAPAddAttribute("MyLDAPSession", "objectClass", "person")
LDAPAddAttribute("MyLDAPSession", "objectClass", "organizationalPerson")
LDAPAddAttribute("MyLDAPSession", "objectClass", "user")
LDAPAddAttribute("MyLDAPSession", "objectCategory", ...
	"CN=Person,CN=Schema,CN=Configuration,DC=company,DC=fr")
LDAPAddAttribute("MyLDAPSession", "instanceType", "4")
LDAPAddAttribute("MyLDAPSession", "cn", "Test")
LDAPAddAttribute("MyLDAPSession", "sAMAccountName", "Test")
LDAPValidateAdd("MyLDAPSession", "cn=Test,cn=Users,dc=company,dc=us")
```


<a name="Example2"></a>



```wl
// Adds a value to an attribute. The attribute is created if it does not exist. 
// The value is added to the existing values for this attribute
// The new value is found in sNewValue
LDAPStartModify("SessionName")
LDAPAddAttribute("SessionName", "AttributeName", sNewValue)
LDAPValidateModify("SessionName", "DN")
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = LDAPAddAttribute(<LDAP session> , <Attribute name> , <Attribute value>)`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se realizó la adición,

- <u><u><u><u>False</u></u></u></u> en caso contrario. [ErrorInfo](../WDLang1/3013008.md) devuelve más detalles sobre el error. 


La adición real se realizará durante la llamada a [LDAPValidateAdd](../WDLang3/3032111.md) o a [LDAPValidateModify](../WDLang3/3032117.md).

**`<LDAP session>: (Cadena de caracteres)`**

Nombre de la sesión LDAP utilizada.

**`<Attribute name>: (Cadena de caracteres)`**

Nombre del atributo a añadir. Este atributo se añade automáticamente si no existe.

**`<Attribute value>: (Cadena de caracteres ANSI)`**

Valor del atributo añadido o nuevo valor del atributo.

**Observación**: Para algunos atributos (definidos por la Diagram del servidor LDAP), se pueden definir varios valores para el mismo atributo. El nuevo valor se añadirá si ya existe un valor para este atributo.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones




### Añadir un nuevo objeto a un servidor LDAP
<a name="anadir_nuevo_objeto_servidor_ldap_ELTPARAGRAPHE000063"></a>

Para añadir un nuevo objeto a un servidor LDAP, debe definir los diferentes atributos de este objeto así como sus valores.

Para optimizar la velocidad de creación de los objetos, los atributos y sus valores se definen localmente: se establece una comunicación única con el servidor al validar la adición. Los pasos son:

1. Inicializar la adición ([LDAPStartAdd](../WDLang3/3032109.md))

2. Añadir atributos y sus valores (**LDAPAddAttribute**). Esta operación se puede realizar tantas veces como sea necesario.

3. Asociar los atributos y sus valores a un objeto mediante [LDAPValidateAdd](../WDLang3/3032111.md).




**Atención**: 

- Al realizarse estas operaciones localmente y luego en el servidor, debe respetarse el orden lógico de las modificaciones (no se puede, por ejemplo, modificar un atributo que ya fue borrado por la Line de código anterior).  

- Para agregar un atributo a un "user" del Active Directory, se debe haber declarado previamente en los parámetros del Active Directory como un atributo que se puede utilizar en la base de datos LDAP.




<a name="XComponent"></a>

## Componente:
wd280com.dll
