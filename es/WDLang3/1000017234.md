


## zipExtractFileList (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Extrae y descomprime una lista de archivos encontrados en un archivo a una ubicación física.








<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
```wl
Archive is zipArchive
// Open an archive
ResOpenArchive = zipOpen(Archive, "C:\Archives\Archive.zip")
IF ResOpenArchive = 0 THEN
	...
	 // Extract a file to its initial location
	 ResExtractFile = zipExtractFileList(Archive, "\Temp\File.doc" + ...
		CR + "\Temp\File2.doc", zipDrive)
	...
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = zipExtractFileList(<Archive> , <List of paths> [, <Destination> [, <Options> [, <WLanguage procedure> [, <Progress>]]]])`
---

**`<Result>: (Integro)`**



- 0 si los archivos han sido extraídos,

- Un código de error (valor superior a 0) en caso contrario. Para más detalles sobre estos códigos de error, consulte la página web de [Observaciones](#NOTE0_1).




**`<Archive>: (Cadena de caracteres o zipArchive Variable)`**

Nombre del archivo que se va a utilizar.
Este nombre puede corresponder a:

- el nombre de un archivo, definido por [zipOpen](../WDLang3/3082044.md) o [zipCreate](../WDLang3/3082003.md).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) el nombre de una variable de tipo [zipArchive](../WDLang3/1000018679.md).




**`<List of paths>: (Cadena de caracteres)`**

Lista de rutas almacenadas de los archivos que se extraerán del archivo comprimido. Las diferentes trayectorias están separadas por caracteres CR (Carriage Return). 
Realiza una búsqueda exacta en cada ruta de los archivos encontrados en el archivo.

**`<Destination>: (Cadena de caracteres opcional o constante)`**

Destino ruta de los archivos extraídos:

- Cadena de caracteres opcional: Los archivos se extraen en la ruta especificada a la que se añade la estructura de árbol del archivo (el disco no se almacena).. Se crea la ruta especificada si no existe.
	![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) El destino ruta del archivo extraído debe corresponder al directorio de trabajo de la aplicación (devuelto por [fDataDir](../WDLang1/3036001.md)) o a uno de sus subdirectorios.

- Constante opcional:
	


|   |   |
| --- | --- |
| *zipDirectory*<br>(Valor predeterminado) | Extracción en el directorio actual sin restaurar la estructura de árbol de los archivos (si se ha almacenado). |
| *zipDrive* | Extracción:<br><br>	- a la ubicación inicial de los archivos si se almacenó y si la unidad existe.<br><br>	- mientras restaura la estructura de árbol de los archivos en la unidad actual si la unidad o el directorio almacenado no existe.<br><br>	- en el directorio actual si sólo se han almacenado el nombre y la extensión de los archivos.<br><br><br>![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) Esta constante no está disponible. Los directorios no tienen raíz.<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante y la constante *zipDirectory* tendrán el mismo efecto.**Archivos en formato 7z**: Esta constante y la constante *zipDirectory* tendrán el mismo efecto. |
| *zipNone* | Extracción en el directorio actual sin restaurar la estructura de árbol de los archivos (si se ha almacenado). |




![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Estas constantes no se pueden utilizar.

**`<Options>: (Constante opcional de tipo Integer)`**

Configure la extracción (si &lt;Destinos&gt; corresponde a una cadena de caracteres):



|   |   |
| --- | --- |
| *zipOverwrite* | Durante la extracción, los archivos de sólo lectura existentes se sobrescriben automáticamente con los archivos extraídos..<br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante no está disponible. |



**`<WLanguage procedure>: (Nombre opcional de Procedure)`**

Nombre del WLanguage Procedure que se llamará si se produce un error al extraer los archivos. Este procedimiento tiene el siguiente formato: 


```txt
PROCEDURE ProcedureName (<Error Code>, <File Name>)
```


donde: 

- &lt;Código de error&gt; es un número entero correspondiente al código del error que se produjo al extraer el archivo.

- &lt;Nombre de archivo&gt; es una cadena de caracteres que contiene la ruta del archivo procesado por **zipExtractFileList**.




La Procedure puede devolver una de las siguientes constantes: 


|   |   |
| --- | --- |
| *zipCancel* | Cancela la extracción de archivos del archivo comprimido. |
| *zipIgnore* | Ignora el archivo por error. |
| *zipRetry* | Reintenta la extracción de archivos. |

![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Este parámetro no está permitido.

**`<Progress>: (Nombre de control o nombre de Procedure)`**

Modo de gestión de la barra de progreso. Este parámetro puede corresponder a: 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) el nombre de un control Barra de progreso encontrado en una ventana. La barra de progreso mostrará el progreso de la extracción de todos los archivos utilizados..  

- el nombre de un WLanguage Procedure. Este procedimiento tiene el siguiente formato: 
	
	```txt
	<Procedure name> (<Current file>, <Global progress percentage>, 
	<File progress percentage >)
	```

	donde: 

	- &lt;El archivo actual&gt; corresponde al nombre del archivo actualmente procesado.. 

	- &lt;El porcentaje de progreso global corresponde al porcentaje de progreso de la extracción de archivos del archivo.. 

	- &lt;El porcentaje de progreso del archivo corresponde al porcentaje de progreso del archivo que se está extrayendo del archivo.







**Si está utilizando un archivo**: 

- **en formato TAR o TGZ (TAR.GZ)**la barra de progreso se actualiza al final de la extracción de cada archivo. 

- **en formato CAB y RAR**la barra de progreso se actualiza al final de la extracción de cada archivo. 

- **en formato 7z**, sólo se especifica &lt;Porcentaje de progreso general&gt;. &lt;El porcentaje de progreso del archivo tendrá el mismo valor.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Códigos de error
<a name="codigos_error_ELTPARAGRAPHE000265"></a>

Se devuelven los siguientes códigos de error:

- 1: La ruta pasada como parámetro no existe.

- 2: Acceso denegado: el usuario no tiene suficientes derechos.

- 3: El archivo está corrupto.

- 4: La ruta no existe en el archivo.

- 6: Los archivos de los subarchivos no están ordenados (cuando se extraen de un archivo de varias partes).

- 21: La contraseña especificada no es correcta.




El mensaje correspondiente al código de error es devuelto por [zipMsgError](../WDLang3/3082034.md).

Observaciones: 

- ![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Sólo están disponibles los archivos ZIP, TAR y TGZ (TAR.GZ).

- ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Sólo están disponibles los archivos ZIP.



<a name="NOTE0_2"></a>


### Archivo extraído
<a name="archivo_extraido_ELTPARAGRAPHE000295"></a>

Los archivos extraídos no se eliminan del archivo. Para eliminar un fichero o todos los ficheros del archivo, utilice [zipDeleteFile](../WDLang3/3082041.md) o [zipDeleteAll](../WDLang3/3082051.md).
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Extracción y contraseña
<a name="extraccion_contrasena_ELTPARAGRAPHE000312"></a>

Si el archivo no está encriptado y si se utilizó [zipPassword](../WDLang3/3082053.md):

- Archivo en formato WDZ: El archivo se sigue extrayendo.

- Archivo en formato ZIP: Se produce un error.



<a name="NOTE0_4"></a>


### ruta almacenada
<a name="ruta_almacenada_ELTPARAGRAPHE000327"></a>

A continuación, tabla presenta las rutas almacenadas en el archivo según:

- el acceso ruta al fichero,

- la sección ruta almacenada.




El directorio actual es: "C:\\Temp".


|   |   |   |   |   |
| --- | --- | --- | --- | --- |
| **zipAddFile** | **Ubicación del archivo** | *zipNone* | *zipDirectory* | *zipDrive* |
| zipAddFile("Archi", <br>"Archivo.txt") | C:\\Temp\\Archivo.txt | Archivo.txt | Archivo.txt | Archivo.txt |
| zipAddFile("Archi", <br>"Data\\Archivo.txt") | C:\\Temp\\Data\\Archivo.txt | Archivo.txt | Data\\Archivo.txt | Data\\Archivo.txt |
| zipAddFile("Archi", <br>"D:\\Data\\Archivo.txt") | D:\\Data\\Archivo.txt | Archivo.txt | Data\\Archivo.txt | D:\\Data\\Archivo.txt |



**Observación**: Si se utiliza la constante *zipDrive*: 

- el formato WDZ almacena la ruta completa del archivo (incluyendo la letra de la unidad). 

- el formato ZIP no almacena la letra de la unidad.

- el formato 7z almacena sólo los directorios.


![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) La constante *zipDrive* es equivale a la constante *zipDirectory*.![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) El directorio y el disco no se almacenan en el archivo ruta. Sólo se almacenan el nombre y la extensión del archivo. 
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Extracción de un archivo de varias partes en disquetes
<a name="extraccion_archivo_varias_partes_disquetes_ELTPARAGRAPHE000405"></a>

Si los archivos a extraer se encuentran en disquetes diferentes, se solicita automáticamente el disquete correspondiente.

<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Lógica de negocio
## Componente:
wd280zip.dll
