


## EmailReadPreviousHeader (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Lee el encabezado de la Email que se encuentra antes de la actual Email:

- a través del protocolo POP3 o IMAP: el Email se encuentra en la bandeja de entrada del servidor de mensajería.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) a través del software de mensajería Lotus Notes o Outlook: el Email entrante se encuentra en el ordenador local en el buzón de entrada de Lotus Notes o Outlook.




Se rellenan los diferentes Variable de la estructura del correo electrónico (o Variable del correo electrónico) correspondientes al encabezamiento del mensaje.

Esta función es útil cuando se lee el Email es relacionado al tamaño del mensaje, por ejemplo.

Si no se encuentra ningún correo electrónico, la variable Email.Out se establece en <u><u><u>True</u></u></u>.

**Recordatorio**: Antes de leer un Email, es necesario abrir una sesión con [EmailStartSession](../WDLang3/3032028.md), [EmailStartNotesSession](../WDLang3/3032121.md) o [EmailStartOutlookSession](../WDLang3/3032128.md).

![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) El protocolo POP3 sólo se puede utilizar para leer correos electrónicos.






<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Deletes the emails sent by "black-listed" senders 
// Browse the emails
// Read the header only 
// (to save bandwidth)
// If the email is "black-listed", delete it
// Then, the "authorized" emails can be read 
// later on
IF EmailReadLastHeader(MyPOPSession) THEN
	LOOP
	// Is the sender "black listed"?
	IF BlackListedSender(Email.SenderAddress) OR ...
			BlackListedSender(Email.Sender) THEN
		EmailDeleteMessage(MyPOPSession)
	END
	DO WHILE EmailReadPreviousHeader(MyPOPSession)
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Lectura de la cabecera de la Email anterior gestionada a través de POP3 o IMAP

`<Result> = EmailReadPreviousHeader(<Session> [, <Email>])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se leyó el encabezado del mensaje. En este caso, la estructura de Email se actualiza automáticamente.

- <u><u><u><u>False</u></u></u></u> en caso contrario. Para obtener más información sobre el error, utilice la función [ErrorInfo](../WDLang1/3013008.md) con la constante *errMessage*.




La variable Email.Out se establece en <u><u><u><u>True</u></u></u></u> si no se encontró ningún mensaje (ningún correo electrónico).

**`<Session>: (Cadena de caracteres, o emailPOP3Session o emailIMAPSession Variable)`**

Identifica la sesión de usuario. Corresponde a:

- el nombre de usuario que se utilizó para iniciar la sesión de email ([EmailStartSession](../WDLang3/3032028.md)).

- una variable de tipo [emailPOP3Session](../WDLang3/1000018759.md).

- una variable de tipo [emailIMAPSession](../WDLang3/1000018957.md).


![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Las variables de tipo [emailPOP3Session](../WDLang3/1000018759.md) y [emailIMAPSession](../WDLang3/1000018957.md) no son compatibles.

**`<Email>: (Correo electrónico opcional Variable)`**

Nombre de la [Email](../WDLang3/1000018713.md) Variable que se va a inicializar con el contenido del mensaje.
![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Este parámetro no está disponible Si no se especifica este parámetro, se utiliza la estructura [Email](../WDLang3/3032029.md).


<a name="SYNTAX2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
### Lectura de la cabecera de la Email anterior gestionada a través de Lotus Notes o Outlook

`<Result> = EmailReadPreviousHeader(<Session> [, <Email> [, <Read mode>]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se leyó el encabezado del mensaje. En este caso, la estructura de Email se actualiza automáticamente.

- <u><u><u><u>False</u></u></u></u> en caso contrario. Para obtener más información sobre el error, utilice la función [ErrorInfo](../WDLang1/3013008.md) con la constante *errMessage*.




La variable Email.Out se establece en <u><u><u><u>True</u></u></u></u> si no se encontró ningún mensaje (ningún correo electrónico).

**`<Session>: (Integro)`**

Identificador del actual período de sesiones de Email. Este identificador puede ser:

- un número entero devuelto por [EmailStartOutlookSession](../WDLang3/3032128.md) o [OutlookStartSession](../WDLang3/3032123.md).

- una variable de tipo [emailOutlookSession](../WDLang3/1000018767.md).

- una variable de tipo [emailNotesSession](../WDLang3/1000018768.md).

- una variable de tipo [emailIMAPSession](../WDLang3/1000018957.md).




**`<Email>: (Correo electrónico opcional Variable)`**

Nombre de la [Email](../WDLang3/1000018713.md) Variable que se va a inicializar con el contenido del mensaje.

Si no se especifica este parámetro, se utiliza la estructura [Email](../WDLang3/3032029.md).

**`<Read mode>: (Constante opcional o cadena de caracteres)`**

Indica los mensajes que se leerán:


|   |   |
| --- | --- |
| *emailAll* o "TODOS"<br>(Valor predeterminado) | Todos los mensajes serán leídos. |
| *emailUnread* o "NO LEÍDOS" | Sólo se leerán los mensajes no leídos. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### La estructura de Email y las variables de Email
<a name="estructura_email_las_variables_email_ELTPARAGRAPHE000225"></a>

Se pueden utilizar dos métodos para los correos electrónicos de manipular:

- [La estructura de Email](../WDLang3/3032029.md)es una estructura global que se utiliza para facilitar el envío de un mensaje a manipular.

- [Las variables Email](../WDLang3/1000018713.md)ofrecen características más avanzadas (databinding, serialización, instancias múltiples).



![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 

### Mensajería de Outlook
<a name="mensajeria_outlook_ELTPARAGRAPHE000366"></a>

Las funciones WLanguage **EmailReadxxx** funcionan sólo con el archivo de datos de Outlook (.pst). Los otros archivos de datos no son compatibles.

<a name="XComponent"></a>

## Componente:
wd280com.dll
