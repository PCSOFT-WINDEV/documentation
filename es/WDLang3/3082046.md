


## zipMerge (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Fusiona los diferentes subarchivos que se encuentran en un archivo de varias partes para crear un archivo de una sola parte.




<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
```wl
MyArchive is zipArchive
// Open a multi-part archive
ResOpenArchive = zipOpen(MyArchive, "C:\MyArchives\Archive.zip") 
IF ResOpenArchive = 0 THEN
	...
	// Merge the sub-archives found in a multi-part archive
	ResMerge = zipMerge(MyArchive,...
			 "C:\MyArchives\SingleArchive.WDZ")
	...
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = zipMerge(<Archive> , <Archive destination> [, <Progress bar management>])`
---

**`<Result>: (Integro)`**



- 0 si los subarchivos se han fusionado,

- un código de error (valor superior a 0) De lo contrario. Para más detalles sobre estos códigos de error, consulte la página web de [Observaciones](#NOTE0_1).




**`<Archive>: (Cadena de caracteres o zipArchive Variable)`**

Nombre del archivo que se va a utilizar.
Este nombre puede corresponder a:

- el nombre de un archivo, definido por [zipOpen](../WDLang3/3082044.md) o [zipCreate](../WDLang3/3082003.md).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) el nombre de una variable de tipo [zipArchive](../WDLang3/1000018679.md).




**`<Archive destination>: (Cadena de caracteres)`**

ruta física del nuevo archivo de una sola parte (hasta 260 caracteres). Esta ruta debe contener el nombre del archivo de una sola parte para crear. Si no se especifica la extensión (.WDZ o.ZIP), la extensión corresponde a la extensión inicial. Tiene la capacidad de especificar el mismo ruta y nombre que el archivo comprimido dividido.: el archivo dividido será sobrescrito por el archivo fusionado.

**`<Progress bar management>: (Cadena de caracteres opcional)`**

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Nombre de la control Barra de progreso en una ventana. La barra de progreso mostrará el progreso de la agrupación.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Condiciones de uso
<a name="condiciones_uso_ELTPARAGRAPHE000129"></a>

**Observación**: La operación de fusión se puede realizar si:

- El archivo existe (los archivos se crean con [zipCreate](../WDLang3/3082003.md)).

- El archivo es un archivo de varias partes.

- El archivo no está en formato "CAB", ni en formato "RAR", ni en formato "TAR" o TARGZ".




Recordatorio: 

- ![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Sólo están disponibles los archivos ZIP, TAR y TGZ (TAR.GZ).

- ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Sólo están disponibles los archivos ZIP.



<a name="NOTE0_2"></a>


### Códigos de error
<a name="codigos_error_ELTPARAGRAPHE000154"></a>

Se devuelven los siguientes códigos de error:

- 1: La ruta pasada como parámetro no existe.

- 2: Acceso denegado: el usuario no tiene suficientes derechos.

- 3: El archivo está corrupto.

- 6: Los subarchivos no están organizados en orden.




El mensaje correspondiente al código de error es devuelto por [zipMsgError](../WDLang3/3082034.md).
<a name="NOTE0_3"></a>


### Cierre del archivo
<a name="cierre_del_archivo_ELTPARAGRAPHE000173"></a>

Después de utilizar la función **zipMerge** en un archivo comprimido, este archivo no se cierra. Debes consumir:

- [zipClose](../WDLang3/3082005.md)para cerrar el archivo de varias partes.

- [zipOpen](../WDLang3/3082044.md)para abrir el nuevo archivo de una sola parte.



<a name="NOTE0_4"></a>


### Número de piezas
<a name="numero_piezas_ELTPARAGRAPHE000191"></a>

[zipNbPart](../WDLang3/3082029.md) se utiliza para determinar el número de subarchivos en un archivo de varias partes.
<a name="NOTE0_5"></a>


### Acciones que se pueden realizar en un archivo de varias partes
<a name="acciones_que_pueden_realizar_archivo_varias_partes_ELTPARAGRAPHE000202"></a>

Algunas funciones de archivo sólo se pueden utilizar con archivos de una sola parte (agregar y eliminar archivos, crear un ejecutable autoextraíble, etc.).. Para realizar estas operaciones, basta con fusionar los subarchivos (**zipMerge**) para get un archivo de una sola parte.

Desde un archivo de varias partes, sólo se puede:

- Combinar las diferentes partes (función **zipMerge**).

- get información sobre el archivo y los ficheros del archivo ([zipExtractPath](../WDLang3/3082023.md), [zipInfoFile](../WDLang3/3082040.md), [zipListFile](../WDLang3/3082031.md), etc.).

- Extraiga los archivos ([zipExtractFile](../WDLang3/3082019.md), [zipExtractAll](../WDLang3/3082011.md)).



<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### El archivo de varias partes se encuentra en disquetes
<a name="archivo_varias_partes_encuentra_disquetes_ELTPARAGRAPHE000238"></a>

Si los diferentes subarchivos se encuentran en disquetes, el siguiente disquete se solicitará automáticamente a través de un cuadro de diálogo cuando se fusionen los subarchivos.. Se producirá un error si el usuario cancela la operación de fusión (no se encuentra el archivo de varias partes).

<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Lógica de negocio
## Componente:
wd280zip.dll
