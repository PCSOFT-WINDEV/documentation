


## PageToEmail( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Envía por correo electrónico los datos encontrados en una página que actualmente se muestra en el navegador.

**Observación**: Esta función está usando la actual Address del usuario de la Web. El navegador le pedirá una o más confirmaciones.
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Sends the content of controls to an email address
PageToEmail("", "someone@somewhere.earth")
```
<a name="Example2"></a>

```wl
// Use the name of the form controls to send the emails
// EDT_Recipient, EDT_Subject, EDT_Request are edit controls
PageToEmail(PAGE_Form, EDT_Recipient, EDT_Subject, EDT_Request, pteAttachment)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`PageToEmail(<Page> , <Destination email address> [, <Message subject> [, <Message body> [, <Encoding>]]])`
---

**`<Page>: (Nombre de la página)`**

Nombre de la página cuyos datos deben ser enviados por correo electrónico. Si este parámetro corresponde a una cadena vacía ("""), se tendrá en cuenta la página actual.. Esta página debe mostrarse actualmente en el navegador.

**`<Destination email address>: (Cadena de caracteres)`**

Envíe un correo electrónico a Address al que se le enviarán los datos que se encuentran en la página WEBDEV.

**`<Message subject>: (Cadena de caracteres opcional)`**

Sujeto de Email.

**`<Message body>: (Cadena de caracteres opcional)`**

Cuerpo de la Email.

**`<Encoding>: (Constante de cadena de caracteres opcional)`**

Tipo de codificación a utilizar:


|   |   |
| --- | --- |
| *pteAttachment* | Los valores de los controles se escriben en un archivo adjunto. |
| *pteBody* <br>(valor predeterminado) | Los valores de los controles se escriben en el cuerpo del mensaje. <br>En este caso, se ignora &lt;Message Body&gt;. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Controles adicionales
<a name="controles_adicionales_ELTPARAGRAPHE000055"></a>

La página puede contener controles adicionales específicos de WEBDEV (WD_ACTION, WD_BUTTON_CLICK, ....). Estos controles son requeridos por WEBDEV para que funcionen correctamente. El valor de estos controles también se devuelve al servidor ASP.
<a name="NOTE0_2"></a>


### Optimización del formato de salida y de la página
<a name="optimizacion_del_formato_salida_pagina_ELTPARAGRAPHE000062"></a>

Los valores se devuelven por pares en el siguiente formato: (&lt;alias control&gt;, &lt;valor control>).

Le recomendamos que utilice "Comprimir los nombres de los controles (...Alias)".

**Recordatorio**: Esta opción está disponible en las características para la optimización avanzada del código HTML:

- Configuración de proyectos: Pestaña "Proyecto" del proyecto description.

- Configuración de una página: Pestaña "Avanzado" de la página description.



<a name="NOTE0_3"></a>


### Atención: se puede realizar una sola acción a la vez en la misma página
<a name="atencion_puede_realizar_una_sola_accion_vez_misma_pagina_ELTPARAGRAPHE000076"></a>

La función **PageToEmail** provoca una acción en la página que se muestra en el navegador del usuario. Sin embargo, los navegadores de Internet permiten una única acción en la página por Process.

**Consecuencias**: **PageToEmail** no se puede utilizar en un código que desencadena una acción (automáticamente o no). Esta función se ignora:

- En el código de clic de un botón "submit" (o en un Procedure llamado por el código de clic de este botón)

- En el código de clic de un botón "otro" cuya acción difiere de "ninguno" (o en un Procedure llamado por el código de clic de este botón)

- Si va seguido de [PageSubmit](../WDLang2/3058020.md) o de [EmailOpenMail](../WDLang2/3032021.md) (en el Process actual, en un Procedure llamado por el Process actual o en otro Process llamado por [Ejecute](../WDLang1/3013041.md)).




<a name="XComponent"></a>

## Componente:
WDJS.DLL
