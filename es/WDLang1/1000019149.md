


## API description (Tipo de Variable)

*** ***
				



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Un **API description** Variable se utiliza para describir un API, sus parámetros, su valor de retorno y sus opciones de llamada mediante programación. 

Las características de este tipo se pueden definir y cambiar mediante diferentes propiedades WLanguage. 

**Observación**: Para obtener más información sobre la declaración de este tipo de variable y el uso de propiedades WLanguage, consulte [Declarar una variable](../Motscles/1514032.md).
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
GetModuleHandle is API Description
GetModuleHandle.DLLName = "kernel32"
GetModuleHandle.FunctionName = "GetModuleHandleA"
GetModuleHandle.ReturnType = apiSystemInt
GetModuleHandle.Parameter[1].Type = apiAnsiString
```



```wl
// Call a fictitious DLL for calculating the distance between 2 points on the surface of the Earth
CalculateDistance is API Description
CalculateDistance.DLLName = "GEO.DLL"
CalculateDistance.FunctionName = "CalculateDistance"
CalculateDistance.Parameter[1].Type = apiReal_8
CalculateDistance.Parameter[2].Type = apiReal_8
CalculateDistance.Parameter[3].Type = apiReal_8
CalculateDistance.Parameter[4].Type = apiReal_8
CalculateDistance.ReturnType = apiReal_8

distance is real = CalculateDistance(Latitude1, Longitude1, Latitude2, Longitude2)
```

<a name="NOTE0"></a>

## Observaciones
<a name="NOTE0_1"></a>


### Usando las variables de la API description
<a name="usando_las_variables_api_description_ELTPARAGRAPHE000032"></a>

Las variables **API description** pueden ser utilizadas: 

- directamente, especificando los valores de los diferentes parámetros si es necesario. Por ejemplo: 
	
	```wl
	GetModuleHandle is API Description
	GetModuleHandle.DLLName = "kernel32"
	GetModuleHandle.FunctionName = "GetModuleHandleA"
	GetModuleHandle.ReturnType = apiSystemInt
	GetModuleHandle.Parameter[1].Type = apiAnsiString
	
	// Direct use
	GetModuleHandle(Null)
	```


- con la función [API](../WDLang1/3014005.md). Por ejemplo: 
	
	```wl
	GetModuleHandle is API Description
	GetModuleHandle.DLLName = "kernel32"
	GetModuleHandle.FunctionName = "GetModuleHandleA"
	GetModuleHandle.ReturnType = apiSystemInt
	GetModuleHandle.Parameter[1].Type = apiAnsiString
	
	// Use of the API function
	API(GetModuleHandle, Null)
	```




<a name="NOTE0_2"></a>


### Propiedades específicas de las variables API description
<a name="propiedades_especificas_las_variables_api_description_ELTPARAGRAPHE000049"></a>

Las siguientes propiedades pueden ser utilizadas para manipular y API description:

| **Nombre de la propiedad** | **Tipo utilizado** | **Efecto** |
| --- | --- | --- |
| Address | Entero del sistema | Address de la función. <br><br>Si se asigna un valor a este Property, el **FunctionName** Property contiene la dirección de la función, el **Number** Property es set a -1 y el **DLLName** Property es set a "" (cadena vacía). |
| DLLNombre | Cadena de caracteres | Nombre DLL. |
| LlamadaConvención | Constante de tipo Integer | Método para llamar a la DLL. Existen tres convenciones de llamada disponibles a través de las siguientes constantes: <br><br>- *CDECL*<br><br>- *STDCALL*<br><br>- *THISCALL*<br><br><br> |
| Nombre de la función | Cadena de caracteres | Nombre de la función que se encuentra en la DLL. <br><br>Si se especifica este Property, también debe especificarse el **DLLName** Property. En este caso, el valor de la propiedad **Number** es -1 y el de la propiedad **Address** es 0. |
| Número | Integro | Número de la función.<br><br>Si se especifica este Property, también debe especificarse el **DLLName** Property. En este caso, el **NombreFunción** Property contiene el número y el **Address** se pone a 0. |
| Opción | Constante de tipo Integer | Opciones para llamar a la API. Esta Property puede corresponder a una de las siguientes constantes: <br><br>- *apiLockThreads*: Si se utiliza esta constante, la llamada a la API bloquea todos los hilos de rosca actuales.. Esto se utiliza para proteger el DLL externo de las llamadas multi-Thread. <br><br>- *apiFreeDLL*: Si la DLL se cargó para llamar a la API, se descargará. Esta constante se ignora si la DLL ya estaba cargada durante la llamada a la API. <br><br>- *apiRestoreSystemSettings*: Si se utiliza esta constante, los parámetros del sistema se restablecerán después de la llamada al API. De hecho, algunas APIs modifican los parámetros del sistema. <br><br><br>Las opciones predeterminadas son *apiRestoreSystemSettings* + *apiFreeDLL*. |
| paramétrico | Array | La propiedad **Type** de cada elemento del array indica el tipo de cada parámetro de la API. Esta propiedad puede corresponder a: <br><br>- un nombre de estructura en forma de cadena si el parámetro es una estructura pasada como parámetro por valor,<br><br>- una de las siguientes constantes: <br><br>	- *apiBoolean*: el parámetro es un booleano. <br><br>	- *apiBuffer*: el parámetro es un búfer. <br><br>	- *apiCharacter*: el parámetro es un carácter Ansi si el proyecto está en modo Ansi, el parámetro es un carácter Unicode si el proyecto está en modo Unicode. <br><br>	- *apiAnsiCharacter*: el parámetro es un carácter Ansi.<br><br>	- *apiUnicodeCharacter*: el parámetro es un carácter Unicode<br><br>	- *apiString*: el parámetro es una cadena de caracteres Ansi si el proyecto está en modo Ansi, el parámetro es una cadena de caracteres Unicode si el proyecto está en modo Unicode. <br><br>	- *apiAnsiString*: el parámetro es una cadena de caracteres Ansi.<br><br>	- *apiUnicodeString*: el parámetro es una cadena de caracteres Unicode.<br><br>	- *apiInt_1*: el parámetro es un entero de 1 byte. <br><br>	- *apiInt_2*: el parámetro es un entero de 2 bytes. <br><br>	- *apiInt_4*: el parámetro es un entero de 4 bytes. <br><br>	- *apiInt_8*: el parámetro es un entero de 8 bytes. <br><br>	- *apiUnsignedInt_1*: el parámetro es un entero de 1 byte sin signo. <br><br>	- *apiUnsignedInt_2*: el parámetro es un entero de 2 bytes sin signo. <br><br>	- *apiUnsignedInt_4*: el parámetro es un entero de 4 bytes sin signo. <br><br>	- *apiUnsignedInt_8*: el parámetro es un entero de 8 bytes sin signo. <br><br>	- *apiSystemInt*: el parámetro es un entero del sistema. <br><br>	- *apiReal_4*: el parámetro es un real de 4 bytes. <br><br>	- *apiReal_8*: el parámetro es un real de 8.- bytes<br><br><br><br><br><br> |
| Tipo de devolución | Entero o cadena | Tipo devuelto por la API. Este Property corresponde a: <br><br>- *apiBoolean*: el API devuelve un booleano. <br><br>- *apiBuffer*: el API devuelve un buffer. <br><br>- *apiCharacter*: el API devuelve un carácter Ansi si el proyecto está en modo Ansi, un carácter Unicode si el proyecto está en modo Unicode. <br><br>- *apiAnsiCharacter*: el API devuelve un carácter Ansi. <br><br>- *apiUnicodeCharacter*: el API devuelve un carácter Unicode. <br><br>- *apiString*: el API devuelve una cadena de caracteres Ansi si el proyecto está en modo Ansi, una cadena de caracteres Unicode si el proyecto está en modo Unicode. <br><br>- *apiAnsiString*: el API devuelve una cadena de caracteres Ansi.<br><br>- *apiUnicodeString*: el API devuelve una cadena de caracteres Unicode.<br><br>	- *apiInt_1*: la API devuelve un entero de 1 byte. <br><br>	- *apiInt_2*: la API devuelve un entero de 2 bytes. <br><br>	- *apiInt_4*: el API devuelve un entero de 4 bytes. <br><br>	- *apiInt_8*: el API devuelve un entero de 8 bytes. <br><br>	- *apiUnsignedInt_1*: la API devuelve un entero de 1 byte. <br><br>	- *apiUnsignedInt_2*: la API devuelve un entero de 2 bytes. <br><br>	- *apiUnsignedInt_4*: el API devuelve un entero de 4 bytes. <br><br>	- *apiUnsignedInt_8*: el API devuelve un entero de 8 bytes. \* *apiSystemInt*: el API devuelve un entero del sistema. <br><br><br><br><br>- *apiReal_4*: el API devuelve un real de 4 bytes. <br><br>- *apiReal_8*: el API devuelve un real de 8.- bytes<br><br><br> |


<a name="NOTE0_3"></a>


### Casos especiales
<a name="casos_especiales_ELTPARAGRAPHE000211"></a>

- Se debe declarar una API **description** Variable para cada función utilizada. 

- El DLL se carga una sola vez, y no por cada Variable. 



<a name="NOTE0_4"></a>


### Funciones que utilizan las variables de la API description
<a name="funciones_que_utilizan_las_variables_api_description_ELTPARAGRAPHE000219"></a>Las siguientes funciones pueden utilizarse para las variables manipular **API description**:



|   |   |
| --- | --- |
| [API](../WDLang1/3014005.md) | Ejecuta una función que se encuentra en una DLL externa. |
| [CallDLL32](../WDLang1/3014003.md) | Ejecuta una función que se encuentra en una DLL externa. |






