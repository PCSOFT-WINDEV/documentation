
## fCopyFile( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Copia uno o más archivos (independientemente de sus atributos).




<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000003036004&name=fcopyfile_funcion&product=WD">Ver ejemplos adicionales</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
```wl
// Copy "File.doc" to "FileCopy.doc"
Res = fCopyFile("C:\Directories\File.doc", "D:\Documents\FileCopy.doc")
```


<a name="Example2"></a>




![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
```wl
// Copy the files found in the "C:\MyImages" directory
// The subdirectories and their files are taken into account (frRecursive constant)
ResCopy = fCopyFile("C:\MyImages\*.*", "D:\MyFiles\", frRecursive)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Copiar un archivo o un directorio

`<Result> = fCopyFile(<Source file> , <Destination file or directory> [, <Copy indicator>])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si los archivos se han copiado,

- <u><u><u><u>False</u></u></u></u> en caso contrario. Para obtener más información sobre el error, utilice la función [ErrorInfo](../WDLang1/3013008.md) con la constante *errMessage*.




**`<Source file>: (Cadena de caracteres)`**

Archivo a copy (hasta 260 caracteres). Este parámetro puede ser: 

- un nombre de archivo. Este archivo se buscará automáticamente en el directorio actual (devuelto por la función [fCurrentDir](../WDLang1/3036022.md)).

- un nombre de archivo con la ruta completa o relativa. Se puede utilizar una ruta de tipo UNC.




Casos especiales según las plataformas: 

- ![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) Este parámetro puede estar en formato Ansi o Unicode.




**Gestión de caracteres comodín (\*,?)**: Por Default, los caracteres comodín están permitidos en el nombre del archivo.
Caso especial según la plataforma: 

- ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Si se utiliza la expresión "\*.\*", solo se buscarán los archivos con extensión.




**`<Destination file or directory>: (Cadena de caracteres)`**

Fichero y/o directorio de destino (hasta 260 caracteres). Este parámetro puede corresponder a:

- un nombre de archivo. Este archivo se creará automáticamente en el directorio actual (devuelto por [fCurrentDir](../WDLang1/3036022.md)).

- un nombre de archivo con la ruta completa o relativa. Se puede utilizar una ruta UNC. 

- un ruta completo o relativo, sólo para un copy con caracteres comodines.


Si este parámetro corresponde al nombre de un directorio, este nombre puede (o no) terminar con "\\".

Casos especiales según las plataformas: 

- ![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) Este parámetro puede estar en formato Ansi o Unicode.




**`<Copy indicator>: (Constante opcional)`**

Tipo de copy:


|   |   |
| --- | --- |
| *frConfirm* | copy un archivo y pedir confirmación antes de sobrescribir un archivo con el mismo nombre.<br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Esta constante no está disponible. |
| *frProgress* | Aparece una ventana de progreso. Si el archivo es pequeño (unos pocos bytes), no se muestra la barra de progreso.. <br><br>![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante no está disponible. |
| *frRecursive* | copy recursivo de los archivos. Se tienen en cuenta los subdirectorios y sus archivos. |


 está vacía por Default. No se selecciona ninguna de estas opciones.

<a name="SYNTAX2"></a>

<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Gestión de errores
<a name="gestion_errores_ELTPARAGRAPHE000369"></a>

La función **fCopyFile** genera un error en los siguientes casos:

- el archivo de copy no existe, 

- el archivo de copy está bloqueado, 

- es inválido, 

-  es una cadena vacía, 

-  y  son idénticos.


<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Modo de funcionamiento en Windows Vista (y posterior)
<a name="modo_funcionamiento_windows_vista_posterior_ELTPARAGRAPHE000540"></a>

Si esta función no funciona correctamente en Windows Vista (y posterior), compruebe si el archivo o directorio utilizado no está en ninguno de los directorios del sistema (directorio de Windows o directorio "Archivos de programa").

**En Windows Vista (y posteriores), con el [Mecanismo UAC](../Editeurs/2025014.md) (Cuenta de usuario control) habilitado**, debe tener privilegios de administrador para manipular y/o modificar los archivos o directorios en los directorios del sistema (directorio de Windows o directorio "Archivos de programa").

**Consejo de programación**: A manipular y/o modificar los archivos o directorios sin privilegios de administrador, debería:

- evite escribir en el directorio de Windows o en el de "Archivos de programa",

- utilizar el directorio del sistema de la aplicación (devuelto por [SysDir](../WDLang1/3073026.md) con la constante *srAppDataCommun*, por ejemplo).



<a name="NOTE0_3"></a>


### Creación de directorios durante el copy
<a name="creacion_directorios_durante_copy_ELTPARAGRAPHE000395"></a>

- Si uno de los directorios del destino ruta no existe, se crea automáticamente.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) Si el archivo de origen corresponde a todos los archivos que se encuentran en un directorio (por ejemplo, C:\\Temp\\\*.\*), se debe utilizar la constante *frRecursive* para crear los subdirectorios en el destino (y para copy su contenido).


**Observación**: Para los directorios copy, también tiene la posibilidad de utilizar [fCopyDir](../WDLang1/3036041.md).





<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Lógica de negocio
## Componente:
wd280std.dll
