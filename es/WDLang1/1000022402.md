


## TableAddLineWithAnimation (función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Añade una fila a una Tabla o control Tabla TreeView con una animación. La duración de esta animación se puede configurar: 

- en la pestaña "Estilo" de la ventana de control description de la tabla (o de la tabla de vista de árbol): 

	- En la pestaña "Estilo", seleccione el elemento "Animación de control".

	- En la lista de animaciones, seleccione "Modification by TableXXXWithAnimation()" y haga clic en el botón "Parameters"..  




- en la ventana de description del proyecto: 

	- En la pestaña "avanzado", haga clic en "Animación de controles". 

	- En la sección "Control Tabla y Looper", seleccione "Modificación por TableXXXWithAnimation()" y haga clic en el botón "Parámetros".  







Si la fila agregada es la primera fila del control, esta fila se convierte en la fila activa.

**Observaciones**: 

- Esta función es equivalente a la función [TableAddLine](../WDLang1/3074006.md). La única diferencia es la gestión de la animación. 

- Para añadir una fila en una posición concreta, utilice [TableInsertLine](../WDLang1/3074026.md) o [TableInsertLineWithAnimation](../WDLang1/1000022401.md). 



<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Add "Moore" and "Vince" 
// in the last row of the "TABLE_ProductTable" control
TableAddLineWithAnimation(TABLE_ProductTable, "Moore", "Vince")
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = TableAddLineWithAnimation(<Table control> [, <Element column 1> [... [, <Element column N>]]])`
---

**`<Result>: (Integro)`**



- Índice de la fila añadida,

- -1 si se produce un error. 




**`<Table control>: (Nombre del control)`**

Nombre del control a manipular. Este control puede corresponder a: 

- un control Tabla.

- un control Tabla TreeView.


Si este parámetro corresponde a una cadena vacía (""), se utilizará el control al que pertenece el evento actual.

**`<Element column 1>: (Tipo de columna associated (opcional))`**

Elementos de la fila que serán añadidos en la control especificada. Cada elemento corresponde a una columna control. El tipo del elemento agregado debe ser compatible con el tipo de la columna asociada..
Si no se especifica ninguno de estos parámetros, se añade un fila vacío en el control. Para un control basado en un archivo de datos, se tienen en cuenta los valores predeterminados definidos en el archivo de datos relacionado.



**`<Element column N>: (Tipo de columna associated (opcional))`**

Elementos de la fila que serán añadidos en la control especificada. Cada elemento corresponde a una columna control. El tipo del elemento agregado debe ser compatible con el tipo de la columna asociada..
Si no se especifica ninguno de estos parámetros, se añade un fila vacío en el control. Para un control basado en un archivo de datos, se tienen en cuenta los valores predeterminados definidos en el archivo de datos relacionado.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Condiciones de uso
<a name="condiciones_uso_ELTPARAGRAPHE000102"></a>

La función **TableAddLineWithAnimation** puede utilizarse en:

- una Tabla o control Tabla TreeView basada en un archivo de datos.

- una Tabla o control Tabla TreeView rellenada programáticamente.

- un control de selección única o de selección múltiple. 




La animación no se reproduce en los siguientes casos: 

- si las animaciones están desactivadas ([AnimaciónPermitida](../WDLang1/1000017399.md)).

- si la función se utiliza en los siguientes eventos de ventana: "Declaraciones globales", "Fin de inicialización" o "Cierre".. 

- si la aplicación está en modo TSE. 

- si la adición se realiza fuera del área de Visible (abajo o Above). En este caso, la adición se realiza y la función devuelve a control inmediatamente.


La función devuelve a control sólo al final de la animación.
<a name="NOTE0_2"></a>


### Características de los elementos fila
<a name="caracteristicas_los_elementos_fila_ELTPARAGRAPHE000129"></a>

- Para no especificar ningún valor para un elemento, utilice una cadena vacía ("") o 0 (según el tipo de columna).

- Si un elemento corresponde al resultado de un cálculo, la expresión numérica debe estar entre paréntesis.. 
	Por ejemplo: 
	
	```wl
	TableAddLineWithAnimation(TABLE_CalculationTable, (53+29), (83-21))
	```




<a name="NOTE0_3"></a>


### Posición de la fila agregada
<a name="posicion_fila_agregada_ELTPARAGRAPHE000377"></a>

De forma predeterminada, la fila se agrega al final de las filas que se muestran en el control.

Caso especial: 

- Si se ordena el control con la función [TableSort](../WDLang1/3074035.md), la fila agregada se posiciona en el control de acuerdo con el orden que se haya definido.

- Si es el usuario quien ordena el control, el orden no se tiene en cuenta al insertar la fila.. La fila se agrega al final del control.



<a name="NOTE0_4"></a>


### Limitaciones: Número máximo de filas mostradas
<a name="limitaciones_numero_maximo_filas_mostradas_ELTPARAGRAPHE000395"></a>

El número máximo de filas que se pueden mostrar en un control Tabla o Tabla TreeView está limitado por la cantidad de memoria disponible (máximo teórico: 2 mil millones de filas).

Sin embargo, no se recomienda utilizar controles Tabla o Tabla TreeView con un gran número de filas por motivos de rendimiento y facilidad de uso (por ejemplo, el tiempo necesario para rellenar el control).
<a name="NOTE0_5"></a>


### Control Tabla o Tabla TreeView basado en un archivo de datos : Modificaciones en el archivo de datos relacionado
<a name="control_tabla_tabla_treeview_basado_archivo_datos_modificaciones_archivo_datos_relacionado_ELTPARAGRAPHE000162"></a>

- **Si la entrada en cascada está habilitada**, el archivo de datos relacionado con el control se modifica automáticamente cuando el usuario pasa a la siguiente fila.

- **Si la entrada en cascada no está habilitada**, el archivo de datos relacionado al control Tabla basado en un archivo de datos no se modifica. Para escribir el contenido de la nueva fila en el archivo de datos relacionado, utilice la función [TableSave](../WDLang1/3074008.md) después de la función **TableAddLineWithAnimation**.




**Observación**: La opción "Entrada en cascada (Agregar)" puede seleccionarse en la pestaña "Detalles" de la descripción del control.
<a name="NOTE0_6"></a>


### Control Tabla o Tabla TreeView basado en un archivo de datos : Agregar varias filas
<a name="control_tabla_tabla_treeview_basado_archivo_datos_agregar_varias_filas_ELTPARAGRAPHE000183"></a>

Cada vez que se llama a la función **TableAddLineWithAnimation** en un control Tabla o Tabla TreeView basado en un archivo de datos, se crea una fila virtual en el control. La información se guardará en el archivo de datos de relacionado durante la llamada a [TableSave](../WDLang1/3074008.md).

Si se llama a la función **TableAddLineWithAnimation** sucesivamente en el mismo proceso sin llamar a la función [TableSave](../WDLang1/3074008.md), solo la PRIMERA llamada es efectiva (las siguientes llamadas son ignoradas). Sólo se añade una fila a la control.
<a name="NOTE0_7"></a>


### Añadir registros a una control Tabla basada en un archivo de datos y en un Trigger
<a name="anadir_registros_una_control_tabla_basada_archivo_datos_trigger_ELTPARAGRAPHE000204"></a>

Se puede liberar un disparador cuando se añade una Record en una control Tabla basada en un archivo de datos. Para obtener más información, consulte la documentación de [HDescribeTrigger](../WDLang4/3044074.md).
<a name="NOTE0_8"></a>


### Control Tabla/Tabla TreeView en edición
<a name="control_tablatabla_treeview_edicion_ELTPARAGRAPHE000216"></a>

Si se llama a la función **TableAddLineWithAnimation**:

- En un evento del control, el cursor se posiciona automáticamente en la primera columna editable de la nueva fila.

- En un evento que no pertenece al control (o en otro proceso), utilice la función [SetFocusAndReturnToUserInput](../WDLang1/1410088107.md) para reanudar la entrada en el control Tabla o Tabla TreeView.



<a name="NOTE0_9"></a>


### Agregar imágenes
<a name="agregar_imagenes_ELTPARAGRAPHE000233"></a>

Para añadir un Image a una Tabla o control Tabla TreeView, especifique el nombre y el ruta completo del Image a añadir. Por ejemplo:

```wl
TableAddLineWithAnimation(TABLE_MyTable, "C:\MyDocuments\MyImage.BMP")
```


**Observación**: La columna debe ser de tipo Imagen, de lo contrario, la imagen agregada no se mostrará correctamente.

<a name="XComponent"></a>

## Componente:
wd280obj.dll
