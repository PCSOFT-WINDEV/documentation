
## Gestión de acciones con Deshacer/Rehacer
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000118"></a>
WINDEV le permite manejar fácilmente la función Deshacer/Reiniciar en sus aplicaciones con las funciones ActionXXX. Para ello, el usuario puede pulsar Ctrl + Z y Ctrl + Y para deshacer o rehacer fácilmente una acción.. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## ¿Cómo proceder?
<a name="¿como_proceder_ELTTEXTE000142"></a>
Para administrar la función Deshacer/Rehacer en sus aplicaciones WINDEV: 

1. Declarar las acciones a guardar en la pila de acciones realizadas por [ActionDo](../WDLang1/1000022676.md). Esta función espera como parámetro el nombre de la Procedure que corresponde a la acción. Este procedimiento puede ser local, global o interno. 

2. En el código de la Procedure correspondiente a la acción a realizar, utilice [ActionDeclareUndo](../WDLang1/1000022678.md) para definir el código que se ejecutará para Cancel la acción. Esta función espera como parámetro que el nombre de la Procedure se ejecute. Este procedimiento puede ser local, global o interno.

3. Utilice las siguientes funciones si es necesario: 

	- [ActionRedo](../WDLang1/1000022608.md) para ejecutar la última acción cancelada. 

	- [ActionUndo](../WDLang1/1000022677.md) a Cancel la última acción realizada. 







Observaciones: 

- No se pueden apilar varias veces las MISMAS acciones definidas por [ActionDo](../WDLang1/1000022676.md). Cada acción solicitada por [ActionDo](../WDLang1/1000022676.md) borra la acción idéntica anterior. Por lo tanto, sólo se puede cancelar la última acción SAME.

- En el menú contextual de un control, la opción "Cancel" propuesta por Default no tiene el mismo efecto que [ActionUndo](../WDLang1/1000022677.md) o Ctrl + Z.





### Ejemplo
<a name="ejemplo_ELTPARAGRAPHE000050"></a>El siguiente ejemplo sirve para modificar el fondo color de dos controles de edición. Esta acción se puede deshacer con Ctrl + Z:


```wl
ActionDo(WIN_ACTION, Color)

	INTERNAL PROCEDURE Color
	EDT_LastName.BackgroundColor = PastelGreen
	EDT_FirstName.BackgroundColor = PastelRed
	
	ActionDeclareUndo(GoBack)
		INTERNAL PROCEDURE GoBack
		EDT_LastName.BackgroundColor = DefaultColor
		EDT_FirstName.BackgroundColor = DefaultColor
		END
	END
```


Para permitir al usuario deshacer varias acciones, basta con llamar a [ActionDo](../WDLang1/1000022676.md) varias veces con diferentes procedimientos. Por ejemplo: 


```wl
ActionDo(WIN_ACTION, Color)
ActionDo(WIN_ACTION, StoreValue)

	INTERNAL PROCEDURE Color
	EDT_LastName.BackgroundColor = PastelGreen
	EDT_FirstName.BackgroundColor = PastelRed
	
	ActionDeclareUndo(GoBack)
		INTERNAL PROCEDURE GoBack
		EDT_LastName.BackgroundColor = DefaultColor
		EDT_FirstName.BackgroundColor = DefaultColor
		END
	END
	
	INTERNAL PROCEDURE StoreValue()
	EDT_LastName.Note = EDT_LastName
	EDT_FirstName.Note = EDT_FirstName
	
	ActionDeclareUndo(GoBack)
		INTERNAL PROCEDURE GoBack
		EDT_LastName = EDT_LastName.Note
		EDT_FirstName = EDT_FirstName.Note
		END
	END
```


En este ejemplo, el primer Ctrl + Z deshará el almacenamiento de valores y el segundo deshará la coloración de los controles. 

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Funciones WLanguage
<a name="funciones_wlanguage_ELTTEXTE000172"></a>
Las siguientes funciones de WLanguage se utilizan para gestionar las acciones: 



|   |   |
| --- | --- |
| [ActionDeclareUndo](../WDLang1/1000022678.md) | Declara cómo Cancel una acción que fue añadida por [ActionDo](../WDLang1/1000022676.md). Esta función **MUST** debe ser llamada cuando se ejecuta el Procedure suministrado a [ActionDo](../WDLang1/1000022676.md). |
| [ActionDo](../WDLang1/1000022676.md) | Crea y ejecuta una acción personalizada (definida mediante programación) con soporte de "Deshacer/Rehacer". |
| [ActionRedo](../WDLang1/1000022608.md) | Ejecuta la última acción cancelada. |
| [ActionUndo](../WDLang1/1000022677.md) | Cancela la última acción realizada por el usuario final. |






