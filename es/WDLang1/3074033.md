


## TableToExcel (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Crea un archivo Excel con los datos de una Tabla o control Tabla TreeView. 

**Observación**: Este archivo puede ser abierto por Excel o por OpenOffice Calc (dependiendo del software instalado en el ordenador actual).




<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
```wl
sFile is string
// Asks for the file name
sFile = fSelect("", "", "Choose the export file", ...
	"Excel files (*.xls) *.xls", "xls", fSelCreate + fSelExist)
// If the name was not specified, cancels the export
// Otherwise, exports the content of TABLE_TABLE1
IF sFile <> "" THEN TableToExcel(TABLE_TABLE1, sFile, taNoTitle)
```
<a name="Example2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
```wl
sFileName is string
...
// Generate an Excel file on the desktop
sFileID is string
sFileID = CompleteDir(SysDir(srDesktop) + fDir() + sFileName)
IF sFileID <> "" THEN
	IF TableToExcel(TABLE_Product, sFileID, aaNoTile) = False THEN
		Info(ErrorInfo())
	ELSE
		ToastDisplay("File generated")
	END
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Seleccionando todas las filas o las primeras N filas que se encuentran en la Tabla o control Tabla TreeView

`<Result> = TableToExcel(<Table control> , <XLS file to create> [, <Options> [, <Number of exported rows>]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se creó el archivo,

- <u><u><u><u>False</u></u></u></u> en caso contrario. Para obtener más información sobre el error, utilice la función [ErrorInfo](../WDLang1/3013008.md).




**`<Table control>: (Nombre del control)`**

Nombre del control a manipular. Este control puede corresponder a: 

- un control Tabla. 

- un control Tabla TreeView.




**`<XLS file to create>: (Cadenas de caracteres)`**

Nombre y ruta completa del archivo Excel a crear. El archivo se sustituye por el nuevo si ya existe.

**`<Options>: (Opcional Constante entera o combinación de constantes)`**

Configura el archivo XLS para crear.


|   |   |
| --- | --- |
| *taColumnDisplayedOrder* | Exporta las columnas según el orden de las columnas que aparecen actualmente en la control (y no según el orden de las columnas definido en el editor).<br> |
| *taColumnsTitles*<br>(valor predeterminado) | El título de las columnas se inserta en el archivo. |
| *taMerge* | Si el archivo XLS ya existe, fusiona el contenido existente con el nuevo contenido: las fórmulas, el formato, ... de las células existentes se mantiene. Los datos existentes no se almacenan. Sólo se conservan los datos de las columnas y filas encontradas en el archivo XLS existente. |
| *taNoTitle* | Sólo se copian los datos en el archivo. |
| *taNoTotal* | No exporta: <br><br>- las filas que contienen los totales, la media y la automática Count( estas filas son exportadas por Default).<br><br>- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) las filas que contienen cálculos personalizados (estas filas son exportadas por Default).<br><br><br> |
| *taSelectedLines* | Exporta sólo las filas seleccionadas (todas las filas son exportadas por Default). No exporta los totales. |
| *taWithInvisibleColumns* | También exporta las columnas de Invisible control.<br><br>![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) Las columnas definidas como no imprimibles y no exportables se exportan. Estas columnas se definen: <br><br>- mediante programación: La propiedad [VisibleInExportAndPrint](../Proprietes/1000022320.md) se establece en <u><u><u><u>False</u></u></u></u>. <br><br>- en la pestaña "General" de la columna de la ventana de description: "Exportar e imprimir" set a "Nunca".<br><br><br> |
| *taWithLayout* | Exporta la color y la fuente utilizada en la control. |



**`<Number of exported rows>: (Entero opcional)`**

Número de filas a exportar. Sólo se exportarán las filas que se encuentren entre 1 y &lt;Número de filas exportadas&gt;.

Todas las filas encontradas en la control Tabla se exportarán si no se especifica este parámetro..  


<a name="SYNTAX2"></a>

### Seleccionando las filas que se encuentran en la Tabla o en la control Tabla TreeView

`<Result> = TableToExcel(<Table control> , <XLS file to create> [, <Options> [, <Start row> [, <End row> [, <Password>]]]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se creó el archivo,

- <u><u><u><u>False</u></u></u></u> en caso contrario. Para obtener más información sobre el error, utilice la función [ErrorInfo](../WDLang1/3013008.md).




**`<Table control>: (Nombre del control)`**

Nombre del control a manipular. Este control puede corresponder a: 

- un control Tabla. 

- un control Tabla TreeView.




**`<XLS file to create>: (Cadenas de caracteres)`**

Nombre y ruta completa del archivo Excel a crear. El archivo se sustituye por el nuevo si ya existe.

**`<Options>: (Opcional Constante entera o combinación de constantes)`**

Configuración del archivo XLS a crear.


|   |   |
| --- | --- |
| *taColumnDisplayedOrder* | Exporta las columnas según el orden de las columnas que aparecen actualmente en la control (y no según el orden de las columnas definido en el editor).<br> |
| *taMerge* | Si el archivo XLS ya existe, fusiona el contenido existente con el nuevo contenido: las fórmulas, el formato, ... de las células existentes. |
| *taNoTitle* | Sólo se copian los datos en el archivo. |
| *taNoTotal* | No exporta: <br><br>- las filas que contienen los totales, la media y la automática Count( estas filas son exportadas por Default).<br><br>- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) las filas que contienen cálculos personalizados (estas filas son exportadas por Default).<br><br><br> |
| *taSelectedLines* | Exporta sólo las filas seleccionadas (todas las filas son exportadas por Default).<br>No exporta los totales. |
| *taWithInvisibleColumns* | También exporta las columnas de Invisible control.<br>![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) Las columnas definidas como no imprimibles y no exportables se exportan. Estas columnas se definen: <br><br>- mediante programación: La propiedad [VisibleInExportAndPrint](../Proprietes/1000022320.md) se establece en <u><u><u><u>False</u></u></u></u>. <br><br>- en la pestaña "General" de la columna de la ventana de description: "Exportar e imprimir" set a "Nunca".<br><br><br> |
| *taWithLayout* | Exporta la color y la fuente utilizada en la control. |



**`<Start row>: (Entero opcional)`**

Número de la fila donde se iniciará la exportación. Todas las filas de control serán exportadas si este parámetro y &lt;End fila&gt; no se especifican.

**`<End row>: (Entero opcional)`**

Número de la fila donde terminará la exportación. Todas las filas de control serán exportadas si este parámetro y &lt;Iniciar fila&gt; no se especifican.  

**`<Password>: (Cadena de caracteres opcional)`**

Contraseña del archivo Excel generado (sólo para archivos XLSX). Esta contraseña es necesaria para abrir el archivo Excel generado.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Condiciones de uso
<a name="condiciones_uso_ELTPARAGRAPHE000279"></a>

La función **TableToExcel** puede utilizarse en: 

- controles Tabla o Tabla TreeView basados en un archivo de datos.

- controles Tabla o Tabla TreeView rellenados mediante programación.

- controles de selección única o múltiple. 



<a name="NOTE0_2"></a>


### Varios
<a name="varios_ELTPARAGRAPHE000294"></a>

- Los ficheros Excel no pueden superar las 65536 filas y 256 columnas si el extension utilizado es ".xls". Este límite puede ser excedido utilizando la extensión ".xlsx" para crear archivos en formato Excel 2007.. Atención: en este caso, las versiones anteriores de Excel deben estar equipadas con el "paquete de compatibilidad de Office 2007", que puede descargarse desde el sitio de Microsoft para abrir los documentos generados.

- El archivo creado puede ser abierto por Excel 97 (o posterior) o por OpenOffice Calc 2 (o posterior).

- Es posible crear archivos XLSX: Basta con especificar la extensión en el parámetro &lt;Archivo XLS a crear&gt;.

- Las columnas "numéricas de alta precisión" (38 dígitos significativos) se exportarán como números exponenciales.

- Se ignora la operación de fusión realizada en las columnas control Tabla.

- Las columnas Unicode se exportan en formato Unicode a Excel.

- Las columnas de casillas de verificación se exportan como casillas de verificación.

- Las columnas RTF se exportan sin formato.

- Los siguientes elementos no se exportan al fichero Excel: 

	- Las imágenes, 

	- Los gráficos,

	- Los códigos de barras.






<a name="NOTE0_3"></a>


### Impresión en un archivo XLS
<a name="impresion_archivo_xls_ELTPARAGRAPHE000315"></a>

Es posible imprimir directamente en un archivo XLS: 

- con la función [iDestination](../WDLang5/3046074.md), 

- del espectador de reporte. 


El archivo XLS creado es configurado por [iParameterXLS](../WDLang5/1000017224.md).



<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Código UI
## Componente:
wd280xls.dll
