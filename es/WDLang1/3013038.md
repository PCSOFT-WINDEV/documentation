
## Hasp( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Interroga una llave electrónica HASP (HASP-3, HASP-4, MemoHasp o NetHasp). La función **Hasp** se utiliza para proteger las aplicaciones desarrolladas con WINDEV o WEBDEV mediante llaves Hasp.

**Observaciones**:

- Para utilizar la función **Hasp**, debe conocer el modo de funcionamiento de llaves Hasp y disponer de la documentación correspondiente.

- La función **Hasp** no está disponible en el modo de 64 bits. Recomendamos que utilice las funciones HaspHLxxx.



<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Test for reading the cell 10 of key:
// the numbering starts from 0
FuncNum = 3	// READ_WORD function
Int1 = 10
Hasp(FuncNum, SeedCode, Lpt, Pass1, Pass2, ...
	&Int1, &Int2, &Int3, &Int4)
IF Int3 = 0 THEN
	Info("Content address memory 10 of key>" + Int2 + "<")
ELSE
	Info("Error: return code = " + Int3)
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`Hasp(<FunctionNum> , <SeedC> , <LPT> , <Pass1> , <Pass2> , <Int1> , <Int2> , <Int3> , <Int4>)`
---

**`<FunctionNum>: (Integro)`**

Número de la función HASP a ejecutar:

- 1: Comprueba la llave HASP.

- 2: &lt;Se utiliza para ejecutar un programa en la clave que devolverá 4 enteros diferentes por cada valor pasado.. Se utiliza para comprobar la presencia de la clave y si no está simulada.

- 3: Lea el contenido clave.

- 4: Escriba el contenido clave.

- 5: Devuelve el contenido clave y la información sobre el puerto paralelo.

- 6: Devuelve el identificador de la clave.

- 50: Lee un bloque de datos en la tecla.

- 51: Escribe un bloque de datos en la tecla.




Para las funciones utilizadas para leer y escribir una cadena fija (Str) en la tecla: &lt;Int3&gt; = 0, &lt;Int4> = &Ch.

**`<SeedC>: (Integro)`**

Se utiliza sólo si &lt;FunctionNum> = 2.

**`<LPT>: (Integro)`**

Número de puerto. Si &lt;LPT&gt; = 0, **Hasp** busca la llave en el puerto paralelo "correcto" (sin tener que especificar el número).

**`<Pass1>: (Integro)`**

Parámetro suministrado por el fabricante de la llave. Este parámetro garantiza la seguridad de los datos almacenados en la clave.

**`<Pass2>: (Integro)`**

Parámetro suministrado por el fabricante de la llave. Este parámetro garantiza la seguridad de los datos almacenados en la clave.

**`<Int1>: (Integro)`**

Valores pasados por reference (con el & operador). Estos valores se pueden leer en la entrada y/o modificar en la salida.

**`<Int2>: (Integro)`**

Valores pasados por reference (con el & operador). Estos valores se pueden leer en la entrada y/o modificar en la salida.

**`<Int3>: (Integro)`**

Valores pasados por reference (con el & operador). Estos valores se pueden leer en la entrada y/o modificar en la salida.

**`<Int4>: (Integro)`**

Valores pasados por reference (con el & operador). Estos valores pueden ser leídos en la entrada y/o modificados en la salida..  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Resumen de los parámetros necesarios
<a name="resumen_los_parametros_necesarios_ELTPARAGRAPHE000071"></a>

El siguiente tabla resume los parámetros necesarios según &lt;FunctionNum&gt;


|   |   |   |   |   |   |   |   |   |   |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| &lt;Número de función | E/S | SeedC | Lpt | Pase1 | Pase2 | Int1 | Int2 | Int3 | Int4 |
| 1 | E |   |   | x |   |   |   |   |   |
| 1 | S |   |   |   |   |   | 0/1 |   |   |
| 2 | E | x | x | x | x |   |   |   |   |
| 2 | S |   |   |   |   | r1 | r2 | r3 | r4 |
| 3 | E |   | x | x | x | dirección |   |   |   |
| 3 | S |   |   |   |   |   | Datos | Estado |   |
| 4 | E |   | x | x | x | dirección | Datos |   |   |
| 4 | S |   |   |   |   |   |   | Estado |   |
| 5 | E |   | x | x | x |   |   |   |   |
| 5 | S |   |   |   |   | M/S | escribir a máquina | Lpt |   |
| 6 | E |   | x | x | x |   |   |   |   |
| 6 | S |   |   |   |   | Idlow | IdHigh | Estado |   |
| 50 | E |   | x | x | x | dirección | Fila | segm | OffSet |
| 50 | S |   |   |   |   |   |   | Estado |   |
| 51 | E |   | x | x | x | dirección | Fila | segm | OffSet |
| 51 | S |   |   |   |   |   |   | Estado |   |





Leyenda: 

- dirección: Address de una célula clave

- M/S: tamaño de la memoria de la llave

- escribir a máquina: tipo de clave

- Datos: datos para leer o escribir

- Fila: longitud de los datos a leer/escribir en la clave

- segm: 0

- OffSet: &Texto donde Texto es una cadena que contiene la información para leer o escribir

- Idlow: para reconstruir el identificador de la clave id = idHigh\*\*65536+idLow

- IdHigh: para reconstruir el identificador de la clave id = idHigh\*\*65536+idLow

- Estado: status reporte de la ejecución de la función

- r1...r4: que contiene los valores mágicos según un código y una clave de Semilla determinada.




<a name="XComponent"></a>

## Componente:
wd280rtf.dll
