
## Llamar a una DLL escrita en Visual Basic
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000167"></a>
Le Visual Basic (comme beaucoup d'autres langages) permet de créer des DLL personnalisées. WINDEV permet simplement d'utiliser ces DLL depuis vos applications.

Une DLL écrite en Visual Basic est généralement une classe contenue dans un module Visual Basic et compilée en tant que DLL ActiveX. Cette classe dispose de :

- certaines fonctionnalités (méthodes, fonctions, ...).

- membres. Ces membres sont généralement accessibles grâce à des propriétés de sérialisation. Deux types de propriétés existent :

	- propriétés de type "Get" pour la récupération de la valeur d'un membre.

	- propriétés de type "Set" ou "Let" pour l'affectation d'un membre (en fonction du type du membre on utilisera l'une ou l'autre propriété).







**Attention** : Dans une application WINDEV, ces DLL particulières **ne peuvent pas** être appelées avec les fonctions [API](../WDLang1/3014005.md) ou [AppelDLL32](../WDLang1/3014003.md). En effet, ces DLL ne répondent pas au standard WINAPI de Windows. Ces DLL s'utilisent dans les projets WINDEV comme des objets automation. Pour plus de détails, consultez [objets Automation](../Motscles/1514014.md).



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Utilisation
<a name="utilisation_ELTTEXTE000191"></a>


### Utiliser une DLL Visual Basic
<a name="utiliser_une_dll_visual_basic_ELTPARAGRAPHE000038"></a>Pour utiliser une DLL écrite en Visual Basic dans un projet WINDEV :

1. Enregistrez si nécessaire la DLL.

2. Déclarez la DLL dans un traitement WLangage.

3. Manipulez la DLL comme un objet OLE.

4. Libérez la DLL.





<a name="NOTE2_2"></a>


### Etape 1 : Enregistrement de la DLL
<a name="etape_1_enregistrement_dll_ELTPARAGRAPHE000051"></a>Si la DLL écrite en Visual Basic a été développée :

- sur le poste sur lequel est exécuté le projet WINDEV : il n'est pas nécessaire d'enregistrer la DLL auprès de Windows.

- sur un poste différent de celui sur lequel est exécuté le projet WINDEV : il est nécessaire d'enregistrer la DLL auprès de Windows en exécutant la ligne de commande *"regsvr32 &lt;NomDeLaDLL&gt;"*.





<a name="NOTE2_3"></a>


### Etape 2 : Déclaration de la DLL
<a name="etape_2_declaration_dll_ELTPARAGRAPHE000062"></a>Pour utiliser une DLL écrite en Visual Basic dans votre projet WINDEV, déclarez cette DLL dans le traitement qui l'utilise. Cette DLL doit être déclarée en tant qu'objet Automation. Pour plus de détails, consultez [objet Automation](../Motscles/1514014.md).

```txt
<NomVariable> est un objet OLE "<nomduprojetVB>.<nomdumoduleVB>"
```


Par exemple :

```wl
MaDLLVisualBasic est un objet OLE "MonProjet.MonModule"
```



<a name="NOTE2_4"></a>


### Etape 3 : Manipulation de la DLL
<a name="etape_3_manipulation_dll_ELTPARAGRAPHE000079"></a>La DLL se manipule ensuite comme un objet automation (pour plus de détails, consultez [objet Automation](../Motscles/1514014.md)). Les appels aux méthodes et propriétés se font de la manière suivante :

Sans paramètres :

```txt
[ValeurRetour = ] NomVariable>>Fonction()
```


Avec paramètres :

```txt
[ValeurRetour = ] NomVariable>>Fonction(paramètre1 [, paramètres [, ...]])
```


Par exemple :

```wl
// Appel de la méthode QueryUser 
Valeur est une chaîne = MaDLLVisualBasic>>QueryUser()

// Appel de la méthode DisplayInfo 
MaDLLVisualBasic>>DisplayInfo("Ceci est un test")
```



<a name="NOTE2_5"></a>


### Etape 4 : Libération de la DLL
<a name="etape_4_liberation_dll_ELTPARAGRAPHE000102"></a>La libération de la DLL s'effectue comme la libération d'un objet automation, avec le mot-clé [Libérer](../Motscles/1511012.md). Pour plus de détails, consultez [objet Automation](../Motscles/1514014.md).

Cette étape n'est pas obligatoire. En effet, à la fermeture de l'application ou de la fenêtre manipulant la DLL, la DLL sera automatiquement libérée.

Pour libérer la DLL, utilisez la syntaxe suivante :

```txt
libérer <NomVariable>
```


Par exemple :

```wl
// Libération de la DLL VB
libérer MaDLLVisualBasic
```



