


## OpenPopupAsynchronous (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Abre una ventana emergente cuyo resultado se obtendrá mediante un procedimiento WLanguage ("callback").
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Open a popup window without passing parameters 
OpenPopupAsynchronous(WIN_SelectColor, popBelow + popAlignedRight + popAccordingToControl, 
		"BTN_ActionColor", CloseColorSelect)
INTERNAL PROCEDURE CloseColorSelect(SelectedColor)
	IMG_PRODUCT.Color = SelectedColor
END
```

```wl
// Open a popup window with parameters 
OpenPopupAsynchronous(WIN_SelectColor, popBelow + popAlignedRight + popAccordingToControl, 
		"BTN_ActionColor", CloseColorSelect, DarkRed)
INTERNAL PROCEDURE CloseColorSelect(SelectedColor)
	IF SelectedColor <> -1 THEN
		IMG_PRODUCT.Color = SelectedColor
	END
END
```

<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX1"></a>

`OpenPopupAsynchronous(<Window> [, <Parameters> [, <Opening mode> [, <Reference control>]]] [, <WLanguage procedure>])`
---

**`<Window>: (Nombre de ventana)`**

Nombre de la ventana a abrir.

**`<Parameters>: (Cadena de caracteres)`**

Lista de parámetros a pasar a la ventana. La lista de parámetros tiene el siguiente formato: 

```txt
(<Parameter 1>, ..., <Parameter N>)
```

donde:

- &lt;Parameter 1&gt;: Primer parámetro que se pasará al evento "Declaraciones globales" de la ventana a abrir. Este parámetro se pasa por valor y se considera como una variable global de la ventana.
	Este parámetro no puede corresponder a una variable de tipo array (los arrays solo se pueden pasar por referencia).

- &lt;Parameter N&gt;: Enésimo parámetro que se pasará al evento "Declaraciones globales" de la ventana que se abrirá. Este parámetro se pasa por valor y se considera como una variable global de la ventana.
	Este parámetro no puede corresponder a una variable de tipo array (los arrays solo se pueden pasar por referencia).


Si la ventana no espera ningún parámetro, este parámetro debe establecerse como "()". 

**`<Opening mode>: (Combinación de constantes)`**

Especifica la posición y el modo de apertura de la ventana emergente. Las constantes son las siguientes:


|   |   |
| --- | --- |
| *popAbove* | La ventana emergente se abre sobre el control que hace la llamada. |
| *popAccordingToControl* | Abre la ventana emergente con respecto a la posición de un control distinto al control que hace la llamada. En este caso:<br><br>- se debe especificar el nombre del control (parámetro &lt;Control name>).<br><br>- el nombre del control se obtendrá automáticamente con la palabra clave [MyPopupControl](../Motscles/1511005.md).<br><br><br> |
| *popAlignedLeft* | El borde izquierdo de la ventana emergente se alinea con el borde izquierdo del control. La ventana emergente se expande hacia la derecha. |
| *popAlignedRight* | El borde derecho de la ventana emergente se alinea con el borde derecho del control. La ventana emergente se expande hacia la izquierda. |
| *popBelow* | La ventana emergente se abre debajo del control que hace la llamada. |
|  *popCenteredHorizontally* | La ventana emergente se centra horizontalmente con el control que hace la llamada. |
| *popCenteredWindow* | La ventana emergente se centra con respecto a la ventana principal. |
| *popDefault* <br>(Valor predeterminado) | De forma predeterminada, se utilizan las constantes *popAlignedLeft* + *popBelow*. |
| *popDisableAutoRepositioning* | Desactiva el posicionamiento automático si hay riesgo de que la ventana emergente no se muestre completamente en la pantalla. <br><br> |



**`<Reference control>: (Nombre de control opcional)`**

Nombre del control debajo del que se debe abrir la ventana emergente. Este parámetro debe especificarse solo si se utilizó la constante *popAccordingToControl*.

**`<WLanguage procedure>: (Nombre del procedimiento o procedimiento lambda opcional)`**

Nombre del procedimiento WLangage ("callback") al que se llama después de cerrar la ventana. Para obtener más información sobre este procedimiento, consulte [Parámetros del procedimiento utilizado por la función OpenPopupAsynchronous](../WDLang1/1410087854.md). 

Este procedimiento WLanguage puede corresponder a: 

- el nombre de un procedimiento global,

- el nombre de un procedimiento interno,

- un procedimiento lambda. 






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Abrir la ventana emergente
<a name="abrir_ventana_emergente_ELTPARAGRAPHE000134"></a>

- La función **OpenPopupAsynchronous** abre la ventana en modo modal y asíncrono: 

	- la ejecución del código continúa sin esperar a que se cierre la ventana emergente,

	- el procedimiento WLanguage se llama cuando se cierra la ventana emergente. 

	- si el usuario hace clic en otra ventana, se cierra la ventana emergente.






<a name="NOTE0_2"></a>


### Características de la ventana emergente (popup)
<a name="caracteristicas_ventana_emergente_popup_ELTPARAGRAPHE000149"></a>

- La ventana emergente se cierra automáticamente si pierde el foco, o cuando se llama a la función [Close](../WDLang1/3038018.md). 

- Las ventanas abiertas con la función **OpenPopupAsynchronous** adoptan el estilo de las ventanas emergentes. Si se definió una barra de título en el editor, la barra de título se reduce y la ventana no se puede maximizar o minimizar.

- De forma predeterminada, la ventana emergente se abre debajo del control que llama a la función **OpenPopupAsynchronous**. Si no hay suficiente espacio para abrir la ventana, ésta se abrirá por encima del control o por debajo del control a la izquierda.



<a name="NOTE0_4"></a>


### Limitaciones
<a name="limitaciones_ELTPARAGRAPHE000167"></a>

- La función **OpenPopupAsynchronous** debe ejecutarse desde el código de un control.

- El control que llama a la función **OpenPopupAsynchronous** debe ser visible.

- Una ventana no modal no puede abrirse desde una ventana emergente. Para abrir una ventana, se debe utilizar la función [Open](../WDLang1/3038035.md). Cuando se abre una ventana modal desde una ventana emergente, la ventana emergente no se cierra automáticamente.. En este caso, se debe procesar el valor de retorno de la función [Open](../WDLang1/3038035.md) y utilizar la función [Close](../WDLang1/3038018.md) para cerrar la ventana emergente.

- Una ventana emergente no puede abrirse desde otra ventana emergente.




<a name="XComponent"></a>

## Componente:
wd280obj.dll
