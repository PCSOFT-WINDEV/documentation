


## OpenPopupPosition (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Abre una ventana emergente especificando su posición de apertura y espera hasta que se cierra.

Esta función debe ser utilizada en el código de una Control (clic en el código del botón por ejemplo).
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Open the window for color selection
MyColor is int 
MyColor = OpenPopupPosition(WIN_ColorSelectionWin, poBottom + poRight + poAccordingToControl, ...
	BTN_ActionColor, CurrentColor)
// If a color was selected 
// (MyColor <= 0 if the window is canceled)
IF MyColor > 0 THEN
	// Keep the new selected color
	CurrentColor = MyColor
	// Change the color of the button rectangle
	BTN_Color..Caption = gRectangle(0, 0, 72, 16, CurrentColor, 0)
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = OpenPopupPosition(<Window name> , <Opening mode> [, <Control name>] [, <Parameter 1> [... [, <Parameter N>]]])`
---

**`<Result>: (Tipo correspondiente al valor recuperado (opcional))`**

Valor devuelto por la ventana popup al cerrarla. Este valor es devuelto:

- por la palabra clave [RESULTADO](../Motscles/1510007.md) que se encuentra en el código de cierre de la ventana,

- por [Cerrar](../WDLang1/3038018.md),

- por [..ReturnedValue](../Proprietes/2510134.md) antes de cerrar la ventana.




**`<Window name>: (Cadena de caracteres (con o sin comillas))`**

Nombre de la ventana a abrir.

**`<Opening mode>: (Combinación de constantes)`**

Especificar la posición y el modo de apertura de la ventana emergente. Estas constantes son las siguientes:


|   |   |
| --- | --- |
| *poBottom* | La ventana emergente se abrirá debajo de la llamada control |
| *poRight* | La Border izquierda de la ventana emergente se alineará con la Control izquierda Border. La ventana emergente se extiende hacia la derecha. |
| *poLeft* | El borde derecho de la ventana emergente se alineará con el borde derecho de la Control. La ventana emergente se extiende hacia la izquierda. |
| *poTop* | La ventana emergente se abrirá Above la llamada Control |
| *poFixedPosition* | Desactiva la posición de automatic si la ventana emergente puede no ser completamente Visible en la pantalla |
| *poAccordingToControl* | Abre la ventana emergente de acuerdo con la posición de una Control que no sea la Control que llama.. En este caso:<br><br>- se debe especificar el nombre de control (&lt;nombre de control).<br><br>- el nombre de Control será recuperado automáticamente por [MiPopupControl](../Motscles/1511005.md).<br><br><br> |



**`<Control name>: (Cadena de caracteres opcional)`**

Nombre de la control bajo la cual debe abrirse la ventana emergente. Este parámetro debe especificarse solo si se ha utilizado la constante *poAccordingToControl*

**`<Parameter 1>: (Tipo de valor enviado a la ventana (opcional))`**

Primer parámetro que se pasará al evento "Declaraciones globales" de la ventana a abrir. Estos parámetros son pasados por reference y son considerados como variables globales a la ventana.



**`<Parameter N>: (Tipo de valor enviado a la ventana (opcional))`**

Enésimo parámetro que se pasará al evento "Declaraciones globales" de la ventana que se abrirá. Estos parámetros son pasados por reference y son considerados como variables globales a la ventana.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Características de la ventana emergente
<a name="caracteristicas_ventana_emergente_ELTPARAGRAPHE000086"></a>

- La ventana se cierra automáticamente cuando pierde el foco o durante la llamada a [Cerrar](../WDLang1/3038018.md).. El valor actual se devuelve al control que abrió la ventana emergente por uno de los siguientes métodos:

	- por la palabra clave [RESULTADO](../Motscles/1510007.md) que se encuentra en el código de cierre de la ventana,

	- por [Cerrar](../WDLang1/3038018.md),

	- por [..ReturnedValue](../Proprietes/2510134.md) antes de cerrar la ventana.




- El estilo de las ventanas popup se aplica a la ventana abierta por la función **OpenPopupPosition**. Si se definió una barra de título en el editor, esta barra de título se reduce y la ventana no se puede maximizar o minimizar.

- De manera predeterminada, la ventana popup se abre debajo del control que ejecuta la función **OpenPopupPosition**. Si no hay suficiente espacio para abrir la ventana, la ventana se abrirá o bien Above el control, o bien debajo del control a la izquierda.



<a name="NOTE0_2"></a>


### Parámetros pasados a la ventana a abrir
<a name="parametros_pasados_ventana_abrir_ELTPARAGRAPHE000115"></a>Los parámetros se obtienen en el evento "Declaraciones globales" de la ventana. Simplemente escriba la siguiente Line de código al principio:


```txt
PROCEDURE <Window name> (<Parameter1> [, <Parameter2> [, ...]])
```
Para obtener más información, consulte [Ventana con parámetros](../WDChamp/1010026.md).
<a name="NOTE0_3"></a>


### ¿Qué modo de apertura elegir?
<a name="¿que_modo_apertura_elegir_ELTPARAGRAPHE000128"></a>
<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ouvrepopupPosition.gif)


**Observaciones**:

- Si utiliza solo la constante *poBottom*, la ventana popup se abrirá en la posición *poRight* + *poBottom*.

- Si utiliza solo la constante *poBottom*, la ventana popup se abrirá en la posición *poRight* + *poTop*.



<a name="NOTE0_4"></a>


### Límites
<a name="limites_ELTPARAGRAPHE000141"></a>

- La función **OpenPopupPosition** debe ejecutarse desde el código de un control.

- El control desde el que se ejecuta la función **OpenPopupPosition** debe ser visible.

- No se puede abrir una ventana que no sea una ventana modal desde una ventana emergente.. [Abrir](../WDLang1/3038035.md) debe utilizarse para abrir una ventana. Abrir una ventana modal desde una ventana emergente no cierra automáticamente la ventana emergente.. En este caso, debes Process el valor de retorno de [Abrir](../WDLang1/3038035.md) y debes usar [Cerrar](../WDLang1/3038018.md) para cerrar la ventana emergente.

- No se puede abrir una ventana emergente desde una ventana emergente.




<a name="XComponent"></a>

## Componente:
wd280obj.dll
