
## EndService( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Finaliza la ejecución del servicio actual.

**Observación**: Esta función sólo afecta a la "Ejecución del servicio (llamada en bucle)" Event
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// --- Running the service (called in loop)

// Run the service
ServiceExecution()	
// Pause during 60 seconds
ServiceWait(6000)

CASE EXCEPTION:
	// In case of exception, adds an error into the log of events
	ServiceWriteEventLog(ExceptionInfo, elError)
	// Stops the service
	EndService(esFailure)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`EndService([<Ending option>])`
---

**`<Ending option>: (Constante opcional de tipo Integer)`**

Las opciones para terminar un servicio son:



|   |   |
| --- | --- |
| *esFailure* | Los diferentes códigos de terminación no se ejecutan y el servicio se detiene mientras se produce un fallo..<br>![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png) En Windows, la gestión de los fallos se realiza según los parámetros especificados en la instalación del servicio. Para más detalles, consulte la función [Departamento](../WDLang1/1000017118.md) Variable y la función [ServicioInstalar](../WDLang1/1000017099.md). |
| *esStop*<br>(valor predeterminado) | Se ejecutan los diferentes códigos de terminación y el servicio se detiene. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones




### Funciones EndService y EndProgram
<a name="funciones_endservice_endprogram_ELTPARAGRAPHE000055"></a>

En un servicio: 

- **EndService** termina la ejecución del servicio realizando las siguientes operaciones: 

	- configurando la ejecución de los códigos de cierre

	- Simular un fallo de servicio, que desencadena acciones de recuperación de fallos del sistema operativo (reinicio de automatic, o reinicio en Windows, por ejemplo). 




- [EndProgram](../WDLang1/3013033.md) puede utilizarse con las siguientes características específicas:

	- el mensaje es ignorado.

	- Los códigos de cierre se ejecutan (o no) dependiendo del booleano especificado como último parámetro.

	- el servicio finaliza normalmente y no se simula ningún fallo.







En una aplicación, la función **EndService** puede utilizarse con las siguientes características específicas:

- no se muestra ningún mensaje al salir de la aplicación. 

- los códigos de cierre se ejecutan (o no) dependiendo de la opción de cierre especificada. 

- la opción de fallo no tiene ningún efecto. 








<a name="XComponent"></a>

## Componente:
wd280vm.dll
