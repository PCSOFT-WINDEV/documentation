
## ExeRun( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Inicia la ejecución de un programa (un ejecutable, por ejemplo) desde la aplicación actual.. 

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) Esto le permite recuperar:

- el valor de retorno del ejecutable con la constante *exeReturnValue*.

- el identificador del proceso, también llamado PID con la constante *exePID*.




![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) **Observaciones**:

- Desde Windows Vista, es posible que las aplicaciones no se inicien si el mecanismo UAC está activado.. Para obtener más información, consulte [observaciones](#NOTE0_5).

- En Windows de 64 bits, el acceso a un directorio del sistema desde un ejecutable de 32 bits se puede realizar en un directorio diferente al esperado.. Para obtener más información, consulte [Nativo de 64 bits y nativo de 32 bits](../Editeurs/2030048.md).





<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 
```wl
// Start Notepad in default mode
ExeRun("NOTEPAD.EXE Readme.txt")
```


<a name="Example2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 
```wl
// Start a program with long name containing space characters
// For example: Word with "My documents" as working directory

// Solution 1: Using the syntax specific to the multiline strings
// (to avoid doubling or tripling the quotes)
IF ExeRun([
	"C:\Program Files\Microsoft Office\Office12\WINWORD.EXE"
	], ...
	exeActive, exeDontWait, SysDir(srMyDocuments)) = False THEN
		Error(ErrorInfo())
END

// Solution 2: Doubling the quotes
ExeRun("""C:\Program Files\Microsoft Office\Office12\WINWORD.EXE""", ...
	exeActive, exeDontWait, SysDir(srMyDocuments))
```
<a name="Example3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 
```wl
// Start applications with a file in command line
// Name of application to start
sAppName is string = "C:\Program Files\Adobe\Photoshop 6.0\Photoshp.exe"
// Name of the image to open
sImageName is string = "C:\Users\My Name\Pictures\Buildings\IMGP0993.JPG"

// Equivalent to "Start Run" 
// We must get a character string containing "" such as: 
// "C:\Program Files\Adobe\Photoshop 6.0\Photoshp.exe" 
// "C:\Users\My Name\Pictures\Buildings\IMGP0993.JPG"
IF ExeRun(StringBuild([
"%1" "%2"
], sAppName, sImageName)) = False THEN
	Error(ErrorInfo())
END
```
<a name="Example4"></a>





<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Ejecutar un ejecutable (en modo de bloqueo o no bloqueo)

`<Result> = ExeRun(<Program name> [, <Mode> [, <Wait for end> [, <Working directory>]]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se inició el programa,

- <u><u><u><u>False</u></u></u></u> en caso contrario. [ErrorInfo](../WDLang1/3013008.md) devuelve más detalles sobre el error.






**`<Program name>: (Cadena de caracteres)`**

Nombre del programa a iniciar con su ruta y/o los parámetros que deben pasarse al programa (si es necesario). 

- **If no ruta se especifica**, el programa se busca en el directorio actual, luego en el directorio de Windows y en los directorios accesibles por PATH. 

- **Si el ejecutable corresponde a un nombre largo con espacios**, debe utilizarse la siguiente sintaxis:
	
	```txt
	<Program name> = " " " Long_name_with_spaces" " Command_line"
	```







**`<Mode>: (Constante opcional de tipo Integer)`**

Modo de inicio de programa (sin acción sobre los programas de DOS): 


|   |   |
| --- | --- |
| *exeActive*<br>(Valor predeterminado) | El programa que se ejecuta es Active, "toma control" sobre el programa actual. |
| *exeIconize* | El programa que se ejecuta es Inactive y se minimiza.<br><br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante no está disponible. |
| *exeInactive* | El programa que se ejecuta es Inactive: se ejecuta mientras el programa actual mantiene el foco. <br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante no está disponible. |
| *exeMaximize* | El programa que se ejecuta es Active, "toma control" sobre el programa actual (la ventana de ejecución se maximiza).<br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante no está disponible. |
| *exeNoHandleInheritance* | Indica que el ejecutable no debe heredar los manejadores del padre (se aplica a TODOS los manejadores, incluidos los archivos). El ejecutable es independiente de la aplicación que lo lanzó.  <br><br>Esta constante puede combinarse con otras constantes de lanzamiento de la aplicación. <br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante no está disponible. |



![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) El programa que se ejecuta es siempre Active: está dirigido por "tomar control" sobre el programa actual. 

**`<Wait for end>: (Constante opcional de tipo Boolean)`**

Configura el tiempo de espera antes de reanudar la ejecución del programa actual: 


|   |   |
| --- | --- |
| *exeDontWait*<br>(Valor predeterminado) | El programa actual y el programa lanzado se ejecutan en paralelo. |
| *exeWait* | El programa actual continúa su ejecución cuando finaliza la ejecución del programa.<br><br> |



**`<Working directory>: (Cadena de caracteres opcional)`**

Directorio de trabajo de la aplicación a iniciar.




<a name="SYNTAX2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
### Iniciando un programa y recuperando un valor

`<Result> = ExeRun(<Program name> [, <Mode> [, <Element to return> [, <Working directory>]]])`
---

**`<Result>: (Integro)`**

Valor buscado:

- Valor de retorno del ejecutable si &lt;Elemento por devolver&gt; corresponde a la constante *exeReturnValue*.

- PID del ejecutable si &lt;Elemento por devolver&gt; corresponde a la constante *exePID*.




[ErrorInfo](../WDLang1/3013008.md) se utiliza para saber si se ha producido un error.

**`<Program name>: (Cadena de caracteres)`**

Nombre del programa a iniciar con su ruta y/o los parámetros que deben pasarse al programa (si es necesario). 

- **If no ruta se especifica**, el programa se busca en el directorio actual, luego en el directorio de Windows y en los directorios accesibles por PATH. 

- **Si el ejecutable corresponde a un nombre largo con espacios**, debe utilizarse la siguiente sintaxis:
	&lt;Nombre del programa&gt; = " " " Nombre largo con espacios" " Comando_Line"




**`<Mode>: (Constante opcional de tipo Integer)`**

Modo de inicio del programa (no hay acción en los programas de DOS).


|   |   |
| --- | --- |
| *exeActive*<br>(Valor predeterminado) | El programa que se ejecuta es Active, "toma control" sobre el programa actual |
| *exeIconize* | El programa que se ejecuta es Inactive y se minimiza |
| *exeInactive* | El programa que se ejecuta es Inactive: se ejecuta mientras el programa actual mantiene el foco |
| *exeMaximize* | El programa que se ejecuta es Active, "toma control" sobre el programa actual (la ventana de ejecución se maximiza) |

![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Este parámetro no se tiene en cuenta. El programa que se ejecuta es Active, "toma control" sobre el programa actual. 

**`<Element to return>: (Constante opcional)`**

Configura el resultado de la función:


|   |   |
| --- | --- |
| *exePID* | El programa actual y el programa lanzado se ejecutan en paralelo. &lt;Resultado&gt; corresponde al identificador del Process creado (también llamado PID) si el ejecutable se ejecutó con éxito, 0 si se produjo un error. <br>Este identificador puede utilizarse, por ejemplo, en algunas APIs.<br><br>![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta constante no está disponible. |
| *exeReturnValue* | El programa actual reanuda su ejecución cuando finaliza la ejecución del programa.. &lt;Resultado&gt; es el valor de retorno del ejecutable. |



**`<Working directory>: (Cadena de caracteres opcional)`**

Directorio de trabajo de la aplicación a iniciar.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Usando un comando Line
<a name="usando_comando_line_ELTPARAGRAPHE000265"></a>

Para pasar parámetros en el comando Line a la ejecución del ejecutable, debe especificar el nombre y el ruta completo del ejecutable a ejecutar.

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) Si el programa ejecutado fue desarrollado con WINDEV o WINDEV Mobile, puede get el comando Line utilizando [CommandLine](../WDLang1/3013051.md).
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Uso de la constante exeActive
<a name="uso_constante_exeactive_ELTPARAGRAPHE000281"></a>

Si el proceso en el que se ejecuta la aplicación (con la constante *exeActive*) ejecuta un código que permite al programa llamador recuperar el foco, el programa llamado pierde el control.

Para que el programa llamado se mantenga enfocado, debe evitar:

- llamar a otra ventana o cuadro de diálogo después de llamar a la función **ExeRun**,

- llamar a la función [SetFocusAndReturnToUserInput](../WDLang1/1410088107.md) después de la función **ExeRun**.




Además, el control Botón (si existe) cuyo evento "Click" asociado contiene una llamada a **ExeRun** no debe ser "Tab Stop" ("Acceder al control con TAB" en la pestaña "UI" del control description).
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Valor de retorno de un ejecutable WINDEV
<a name="valor_retorno_ejecutable_windev_ELTPARAGRAPHE000310"></a>

Un ejecutable WINDEV puede devolver un valor. Para ello:

1. Crear un entero Variable global al proyecto.

2. Inicie este Variable con el valor a devolver.

3. Devuelve esta Variable con la palabra clave [RETURN](../Motscles/1510007.md) en el código de cierre del proyecto.



<a name="NOTE0_4"></a>
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Iniciar una aplicación en Windows Vista (y posterior)
<a name="iniciar_una_aplicacion_windows_vista_posterior_ELTPARAGRAPHE000341"></a>

Si UAC (User Account control) está activado, la aplicación que utiliza **ExeRun** para iniciar otra aplicación debe tener permisos más altos que la aplicación que se inicia.

Por ejemplo, una primera aplicación iniciada con los derechos de administrador puede iniciar una segunda aplicación que no requiera derechos específicos.. 

Si la segunda solicitud requiere más derechos que la solicitud que la inicia, la segunda solicitud puede no iniciarse. Windows propone permitir la gestión de la compatibilidad con Windows Vista. Si la gestión de la compatibilidad está habilitada, la segunda aplicación se ejecutará durante su próximo inicio.. También se puede utilizar la función [ShellExecute](../WDLang1/3035007.md). 
<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Varios
<a name="varios_ELTPARAGRAPHE000359"></a>

- La función **ExeRun** no modifica el directorio actual. El directorio actual antes de ejecutar **ExeRun** es idéntico al directorio actual después de ejecutar **ExeRun**. 

- Si el programa ejecutado ignora el modo de ejecución especificado, el programa se ejecuta en modo *exeActive* de forma predeterminada.



<a name="NOTE0_9"></a>

<a name="XComponent"></a>

## Componente:
wd280std.dll
