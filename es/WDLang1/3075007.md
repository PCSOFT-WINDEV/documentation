


## ArraySort (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Clasifica un WLanguage array. Se pueden realizar las siguientes clasificaciones:

- Clasificar una array unidimensional de elementos simples.

- Clasificar una array bidimensional de elementos simples según una o más columnas.

- Clasificar una array unidimensional de clases o estructuras de acuerdo a 1 o más miembros.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) Ordenar un array de registros de acuerdo a 1 o más ítems.

- Ordena una array unidimensional especificando una comparison Procedure.




**Observación**: Esta función es equivalente a la función [clasificar](../WDLang1/1000017364.md).






<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000003075007&name=arraysort_funcion&product=WD">Ver ejemplos adicionales</a>

```wl
// Sort a one-dimensional array
MyArray is array of 2 int
MyArray[1] = 4
MyArray[2] = 1
ArraySort(MyArray, asAscending)
Trace(MyArray[1], MyArray[2])
// Displays "1" then "4"
```
<a name="Example2"></a>

```wl
// Sort a two-dimensional array on the 2nd column
ArraySort(MyArray, asAscending, 2)
```
<a name="Example3"></a>

```wl
// Sort a two-dimensional array on the 2nd column
// (ascending) and the 3rd column (descending)
ArraySort(MyArray, asColumn, "2;-3")
```
<a name="Example4"></a>

```wl
// Sort an array by using a comparison procedure
ArraySort(MyArray, asFunction, Compare)

// Comparison procedure
INTERNAL PROCEDURE Compare(Element1, Element2)
IF Element1.Member < Element2.Member THEN RESULT -1
IF Element1.Member > Element2.Member THEN RESULT 1
RESULT 0
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Clasificar una array unidimensional de elementos simples

`ArraySort(<WLanguage array> [, <Type of sort>])`
---

**`<WLanguage array>: (Array)`**



- Nombre de la variable de tipo Array a utilizar. Este array debe ser unidimensional.
	Este array también puede corresponder a un array de elementos simples de una variable avanzada (por ejemplo, array "Grupo" en las variables de tipo [gglContact](../WDLang5/1000017434.md)).

- Nombre del asociativo Array Variable a utilizar.
	![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) El asociativo arrays no puede ser clasificado en esta versión.




**`<Type of sort>: (Constante opcional de tipo Integer)`**

Tipo de ordenación a realizar:


|   |   |
| --- | --- |
| *asAscending* <br>(Valor predeterminado) | Orden ascendente.<br><br>**Para un array asociativo**: Clasificando los elementos de la array asociativa:<br><br>- **si se especifica la constante *asKey***: La clasificación se realiza en orden ascendente según las claves. En el caso de equality entre dos claves, los valores se ordenan según el valor ascendente si los valores pueden ser comparados. Si los valores no se pueden comparar, se mantiene el orden inicial.<br><br>- **si no se especifica la constante *asKey***: La clasificación se realiza en orden ascendente según los valores. En el caso de equality entre dos valores, los valores se ordenan según la clave ascendente.<br><br><br> |
| *asDescending* | Orden descendente.<br><br>**Para un array asociativo**: Clasificando los elementos de la array asociativa:<br><br>- **si se especifica la constante *asKey***: La clasificación se realiza en orden descendente según las claves. En el caso de equality entre dos claves, los valores se ordenan según el valor descendente si los valores pueden ser comparados. Si los valores no se pueden comparar, se mantiene el orden inicial.<br><br>- **si no se especifica la constante *asKey***: La clasificación se realiza en orden descendente según los valores. En el caso de equality entre dos valores, los valores se ordenan según la clave descendente.<br><br><br> |


El tipo de clasificación se puede combinar con una o más opciones de clasificación:


|   |   |
| --- | --- |
| *asKey* | array asociativa ordenada según el orden clave. Si no se especifica esta constante, la array asociativa se ordena según el orden de los valores. <br>Esta función es useful en el asociativo arrays solamente. |
| *tccIgnorar la puntuación y el espacio* | Array ordenado sin tener en cuenta los caracteres de espacio y los caracteres de puntuación.<br>Esta opción es useful para arrays de cadenas.<br> |
| *tccIgnoreAccent* | Array ordenado ignorando los caracteres acentuados.<br>Esta opción es useful para arrays de cadenas.<br> |
| *tccIgnoreCase* | Array ordenada ignorando el caso.<br>Esta opción es useful para el arrays de las cadenas de caracteres. |
| *tccIgnoreInsideSpace* | Array ordenado sin tener en cuenta los caracteres de espacio que se encuentran dentro de las cadenas de texto.<br>Esta opción es useful para el arrays de las cadenas de caracteres. |
| *tccIgnoreSpace* | Array ordenado sin tener en cuenta los caracteres de espacio que se encuentran al principio y al final de las cadenas de texto..<br>Esta opción es useful para el arrays de las cadenas de caracteres. |
| *tccLexicographicOrder* | Array ordenada según el orden lingüístico.<br>Esta opción es useful para arrays de cadenas.<br> |
| *tccRespectNumeric* | Array ordenada según el orden de los valores numéricos.<br>Esta opción es useful para arrays de cadenas.<br> |


![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Las constantes utilizadas para especificar las opciones de clasificación no están disponibles.


<a name="SYNTAX2"></a>

### Clasificando una array bidimensional de elementos simples según una columna

`ArraySort(<WLanguage array> [, <Type of sort>] , <Column>)`
---

**`<WLanguage array>: (Array)`**

Nombre de la variable de tipo Array a utilizar. Este array debe ser bidimensional.

Este array también puede corresponder a un array bidimensional de un tipo avanzado (por ejemplo, ordenar una variable de tipo [xlsDocument](../WDLang5/1000017464.md) según los valores de una columna).

**`<Type of sort>: (Constante opcional de tipo Integer)`**

Tipo de ordenación a realizar:


|   |   |
| --- | --- |
| *asAscending* <br>(Valor predeterminado) | Orden ascendente |
| *asDescending* | Orden descendente |


El tipo de clasificación se puede combinar con una o más opciones de clasificación:


|   |   |
| --- | --- |
| *tccIgnorar la puntuación y el espacio* | Array ordenado sin tener en cuenta los caracteres de espacio y los caracteres de puntuación.<br>Esta opción es useful para arrays de cadenas.<br> |
| *tccIgnoreAccent* | Array ordenado ignorando los caracteres acentuados.<br>Esta opción es useful para arrays de cadenas.<br> |
| *tccIgnoreCase* | Array ordenada ignorando el caso.<br>Esta opción es useful para el arrays de las cadenas de caracteres. |
| *tccIgnoreInsideSpace* | Array ordenado sin tener en cuenta los caracteres de espacio que se encuentran dentro de las cadenas de texto.<br>Esta opción es useful para el arrays de las cadenas de caracteres. |
| *tccIgnoreSpace* | Array ordenado sin tener en cuenta los caracteres de espacio que se encuentran al principio y al final de las cadenas de texto..<br>Esta opción es useful para el arrays de las cadenas de caracteres. |
| *tccLexicographicOrder* | Array ordenada según el orden lingüístico.<br>Esta opción es useful para arrays de cadenas.<br> |
| *tccRespectNumeric* | Array ordenada según el orden de los valores numéricos.<br>Esta opción es useful para arrays de cadenas.<br> |


![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Las constantes utilizadas para especificar las opciones de clasificación no están disponibles.

**`<Column>: (Integro)`**

Índice de la columna donde se realizará la ordenación.  


<a name="SYNTAX3"></a>

### Clasificando una array bidimensional de elementos simples según varias columnas

`ArraySort(<WLanguage array> , <asColumn> , <Columns>)`
---

**`<WLanguage array>: (Array)`**

Nombre de la variable de tipo Array a utilizar. Este array debe ser bidimensional.

Este array también puede corresponder a un array bidimensional de tipo avanzado (ordenación realizada sobre un Variable de tipo [xlsDocument](../WDLang5/1000017464.md) según los valores de una o varias columnas, por ejemplo).

**`<asColumn>: (Constante)`**

*asColumn*: Constante utilizada para clasificar una array bidimensional de elementos simples según varias columnas.

La constante *asColumn* se puede combinar con una o más opciones de clasificación:


|   |   |
| --- | --- |
| *tccIgnorar la puntuación y el espacio* | Array ordenado sin tener en cuenta los caracteres de espacio y los caracteres de puntuación.<br>Esta opción se aplica a todas las columnas en las que se realiza la clasificación.<br>Esta opción es useful para arrays de cadenas.<br> |
| *tccIgnoreAccent* | Array ordenado ignorando los caracteres acentuados.<br>Esta opción se aplica a todas las columnas en las que se realiza la clasificación.<br>Esta opción es useful para arrays de cadenas.<br> |
| *tccIgnoreCase* | Array ordenada ignorando el caso.<br>Esta opción se aplica a todas las columnas en las que se realiza la clasificación.<br>Esta opción es useful para el arrays de las cadenas de caracteres. |
| *tccIgnoreInsideSpace* | Array ordenado sin tener en cuenta los caracteres de espacio que se encuentran dentro de las cadenas de texto.<br>Esta opción se aplica a todas las columnas en las que se realiza la clasificación.<br>Esta opción es useful para el arrays de las cadenas de caracteres. |
| *tccIgnoreSpace* | Array ordenado sin tener en cuenta los caracteres de espacio que se encuentran al principio y al final de las cadenas de texto..<br>Esta opción se aplica a todas las columnas en las que se realiza la clasificación.<br>Esta opción es useful para el arrays de las cadenas de caracteres. |
| *tccLexicographicOrder* | Array ordenada según el orden lingüístico.<br>Esta opción se aplica a todas las columnas en las que se realiza la clasificación.<br>Esta opción es useful para arrays de cadenas.<br> |
| *tccRespectNumeric* | Array ordenada según el orden de los valores numéricos.<br>Esta opción se aplica a todas las columnas en las que se realiza la clasificación.<br>Esta opción es useful para arrays de cadenas.<br> |


![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Las constantes utilizadas para especificar las opciones de clasificación no están disponibles.

**`<Columns>: (Cadena de caracteres)`**

Lista de columnas en las que se debe realizar la clasificación. Las diferentes columnas deben estar separadas por punto y coma. Para especificar la dirección de clasificación, la índice de la columna debe ir precedida de:   

- "+" (o nada) para una ordenación ascendente.   

- "-" para una clasificación descendente. 
	Por ejemplo: "2,-3" para realizar una ordenación ascendente en la segunda columna y una ordenación descendente en la tercera columna.  





<a name="SYNTAX4"></a>

### Clasificar una array unidimensional de clases, estructuras o registros

`ArraySort(<WLanguage array> , <asMember> , <Members>)`
---

**`<WLanguage array>: (Array)`**



- Nombre de la variable de tipo Array a utilizar. Este array debe ser unidimensional. Esta array puede ser: 

	- una array de clases,

	- el array de las estructuras,

	- una array de tipos avanzados,

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) una array de registros.




- Nombre del asociativo Array Variable a utilizar. Esta array puede ser: 

	- una array asociativa de clases,

	- una array asociativa de estructuras,

	- una array asociativa de tipos avanzados,
			![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) El asociativo arrays no puede ser clasificado en esta versión.

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) una array asociativa de registros.







**`<asMember>: (Constante)`**

*asMember*: Constante utilizada para clasificar un array unidimensional de clases, estructuras o registros.

**Para un array asociativo**: Los elementos de la array asociativa se clasifican según el orden de valores para los miembros especificados. En el caso de equality entre dos valores, los valores se ordenan según la clave ascendente o descendente (según la dirección de ordenación del primer miembro).

La constante *asMember* se puede combinar con una o más opciones de clasificación:


|   |   |
| --- | --- |
| *tccIgnorar la puntuación y el espacio* | Array ordenado sin tener en cuenta los caracteres de espacio y los caracteres de puntuación.<br>Esta opción se aplica a todos los miembros en los que se realiza la ordenación.<br>Esta opción es useful para los miembros de la "cadena de caracteres"..<br> |
| *tccIgnoreAccent* | Array ordenado ignorando los caracteres acentuados.<br>Esta opción se aplica a todos los miembros en los que se realiza la ordenación.<br>Esta opción es useful para los miembros de la "cadena de caracteres"..<br> |
| *tccIgnoreCase* | Array ordenada ignorando el caso.<br>Esta opción se aplica a todos los miembros en los que se realiza la ordenación.<br>Esta opción es useful para los miembros "cadena de caracteres". |
| *tccIgnoreInsideSpace* | Array ordenado sin tener en cuenta los caracteres de espacio que se encuentran dentro de las cadenas de texto.<br>Esta opción se aplica a todos los miembros en los que se realiza la ordenación.<br>Esta opción es useful para los miembros "cadena de caracteres". |
| *tccIgnoreSpace* | Array ordenado sin tener en cuenta los caracteres de espacio que se encuentran al principio y al final de las cadenas de texto..<br>Esta opción se aplica a todos los miembros en los que se realiza la ordenación.<br>Esta opción es useful para los miembros "cadena de caracteres". |
| *tccLexicographicOrder* | Array ordenada según el orden lingüístico.<br>Esta opción se aplica a todos los miembros en los que se realiza la ordenación.<br>Esta opción es useful para los miembros de la "cadena de caracteres"..<br> |
| *tccRespectNumeric* | Array ordenada según el orden de los valores numéricos.<br>Esta opción se aplica a todos los miembros en los que se realiza la ordenación.<br>Esta opción es useful para los miembros de la "cadena de caracteres"..<br> |


![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Las constantes utilizadas para especificar las opciones de clasificación no están disponibles.

**`<Members>: (Cadena de caracteres)`**

Nombre de los miembros utilizados como criterios de clasificación. Si la clasificación se realiza en varios miembros, sus nombres deben estar separados por un punto y coma.. Para especificar la dirección de ordenación, el nombre del miembro debe ir precedido de:   

- "+" (o nada) para una ordenación ascendente.   

- "-" para una clasificación descendente.   

- "." o ":" para realizar una ordenación en propiedades encadenadas.  
	Por ejemplo: 
	- "Miembro1;-Miembro3" para realizar una ordenación ascendente en el miembro Miembro1 y una ordenación descendente en el miembro Miembro3.. 
	- "Fuente.URL" para realizar una ordenación en la URL Property de la Fuente Property. 




![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) **Ordenando un array de registros**: Nombre de las posiciones utilizadas como criterios de clasificación. 


<a name="SYNTAX5"></a>

### Clasificar un array unidimensional con una especie de Procedure

`ArraySort(<WLanguage array> , <asFunction> , <WLanguage sorting procedure>)`
---

**`<WLanguage array>: (Array)`**



- Nombre de la variable de tipo Array a utilizar. Este array debe ser unidimensional. Esta array puede ser una array de tipos avanzados.

- Nombre del asociativo Array Variable a utilizar.
	![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) El asociativo arrays no puede ser clasificado en esta versión.




**`<asFunction>: (Constante)`**

*asFunction*: Constante utilizada para clasificar un array unidimensional con una especie de Procedure.

**`<WLanguage sorting procedure>: (Nombre de Procedure)`**

Nombre de la Procedure utilizada para ordenar los elementos de array. 

- **Para un array unidimensional**: WLanguage Procedure en el siguiente formato: 
	
	```txt
	PROCEDURE MyProcedure(Element1, Element2)
	```

	El mecanismo de orden llama automáticamente a este procedimiento para comparar los elementos entre sí, de dos en dos.
	Si el elemento 1 debe encontrarse antes que el elemento 2 en el orden de clasificación, la Procedure debe regresar -1.
	Si el elemento 1 debe encontrarse después del elemento 2 en el orden de clasificación, la Procedure debe devolver 1.
	Si el elemento 1 y el elemento 2 son idénticos, la Procedure debe devolver 0.  

- **Para un array asociativo**: WLanguage Procedure en el siguiente formato:
	
	```txt
	PROCEDURE MyProcedure(Value1, Key1, Value2, Key2)
	```

	El mecanismo de orden llama automáticamente a este procedimiento para comparar los elementos entre sí, de dos en dos. La comparison se puede realizar en la clase Procedure según los valores o según las claves.
	Si el elemento 1 debe encontrarse antes que el elemento 2 en el orden de clasificación, la Procedure debe regresar -1.
	Si el elemento 1 debe encontrarse después del elemento 2 en el orden de clasificación, la Procedure debe devolver 1.
	Si el elemento 1 y el elemento 2 son idénticos, la Procedure debe devolver 0.  






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Varios
<a name="varios_ELTPARAGRAPHE000630"></a>

- Esta función no se puede utilizar con la arrays fija.

- array dinámica de variantes: Sólo se puede utilizar una clase personalizada (con una clase Procedure).

- Esta función no se puede utilizar con la arrays de las cadenas UNICODE.

- Para añadir un elemento en una array ordenada, utilice [ArrayAddSorted](../WDLang1/1000017013.md).

- Esta función se puede utilizar en la arrays de variables avanzadas. 

- Esta función está disponible para la función asociativa arrays.
	![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Esta funcionalidad no está disponible.



<a name="NOTE0_2"></a>


### Ejemplos de procedimientos de clasificación personalizados
<a name="ejemplos_procedimientos_clasificacion_personalizados_ELTPARAGRAPHE000653"></a>

Ejemplo de Procedure usado para comparar 2 números enteros:


```wl
PROCEDURE MyProcedure(nInt1, nInt2)
If nInt1 > nInt2 THEN RESULT 1
IF nInt1 < nInt2 THEN RESULT -1
RESULT 0
```


Ejemplo de una Procedure utilizada para comparar dos elementos en una array de estructuras:


```wl
PROCEDURE MyProcedure(stVar1, stVar2)
IF stVar1:nInt > stVar2:nInt THEN RESULT 1 
IF stVar1:nInt < stVar2:nInt THEN RESULT -1 
RESULT 0
```


<a name="XComponent"></a>

## Componente:
wd280vm.dll
