


## Comprobación a distancia: Personalizar con un Procedure
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000129"></a>
Para personalizar el control remoto realizado en una aplicación WINDEV multiusuario, puede activar la ejecución de un Procedure que se encuentra en la aplicación.

Este Procedure se usará en lugar de la ventana de mensajes estándar. Este Procedure le permite personalizar completamente la gestión remota de la parada de la aplicación.

Este Procedure puede ser usado por ejemplo:

- para comprobar el nombre del usuario conectado (para el groupware): sólo se muestra un mensaje si el usuario corresponde a un administrador.

- para las aplicaciones sin interfaz, se ejecutan en la tarea de Background.

- para abrir una ventana específica.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Programación
<a name="programacion_ELTTEXTE000153"></a>


### Procedure a medida
<a name="procedure_medida_ELTPARAGRAPHE000026"></a>

El Procedure personalizado debe ser un Procedure global del proyecto. En esta Procedure, tiene la capacidad de recuperar y Process la diferente información relativa al modo actual.

La declaración de Procedure debe ser tal que:


```txt
PROCEDURE <Procedure name> ([<Mode>[, <Message>[ <Display duration>]]])
```
donde los parámetros son los siguientes:


|   |   |
| --- | --- |
| &lt;Modo&gt; | Recupera como constantes el modo actual para el remoto control:<br><br>- *acForbidden*: acceso denegado a la solicitud<br><br>- *acWarning*: advertencia de parada inminente<br><br>- *acStop*: desconexión de aplicaciones<br><br><br> |
| &lt;Mensaje&gt; | Recupera el mensaje correspondiente al modo actual (este mensaje debe aparecer en la ventana). |
| &lt;Duración de la pantalla&gt; | Duración máxima de visualización de la ventana (en segundos) |


```wl
// -- Procedure ProcessMessage
PROCEDURE ProcessMessage(AccessMode, MessageToDisplay, DispDuration)
SWITCH AccessMode
	CASE acForbidden
		IF UserName  "ADMIN" THEN Open(WIN_UnableToConnect)
	CASE acWarning
		IF UserName <>  "ADMIN" THEN Info(MessageToDisplay)
	CASE acStop
		IF UserName <> "ADMIN" THEN EndProgram()
END
```

<a name="NOTE2_2"></a>


### Iniciando la costumbre Procedure
<a name="iniciando_costumbre_procedure_ELTPARAGRAPHE000057"></a>

Para utilizar el Procedure personalizado para comprobar automáticamente su aplicación, se debe llamar a [AppControl](../WDLang1/3013003.md) en el código de inicialización de su proyecto:


```wl
AppliControl("U:\MyApp\WDUPDATE.NET", WIN_ProcessMessage)
```
donde WIN_ProcessMsg es el nombre de la ventana personalizada,

y "WDUPDATE.NET" es el archivo de la aplicación control.

**Consejo**: La llamada a [AppControl](../WDLang1/3013003.md) debe ser la primera sentencia que se encuentre en el código de inicialización del proyecto.
<a name="NOTE2_3"></a>


### Detener la aplicación
<a name="detener_aplicacion_ELTPARAGRAPHE000077"></a>

Al utilizar un procedimiento personalizado, el modo de interrupción de la aplicación (constante *acStop*) no detiene la aplicación automáticamente . La convocatoria de [EndProgram](../WDLang1/3013033.md) debe incluirse en su solicitud.


