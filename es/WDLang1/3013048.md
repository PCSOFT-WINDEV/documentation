
## ExecutionMode (función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Solía hacerlo:

- averiguar y/o modificar el comportamiento de la aplicación o sitio cuando se generan algunos errores. Según el modo de tiempo de ejecución seleccionado, estos errores pueden ignorarse o pueden generar algunos mensajes de error. En algunos casos, la función **ExecutionMode** permite restaurar el comportamiento de WINDEV 5.5.

- optimizar las llamadas a las funciones declaradas externamente. Se utiliza para optimizar la velocidad de ejecución de la aplicación en 2 casos:

	- Procedimientos declarados externamente

	- Los códigos compilados dinámicamente, llaman a un procedimiento global o local del proyecto.




- averiguar y/o modificar el uso de la [JITc](../Editeurs/2020009.md) por parte de la aplicación. La aplicación utiliza JITc por defecto. Sólo se puede desactivar.

- averiguar y/o modificar el modo de gestión de las referencias bajas para todos los objetos instanciados. 







<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Test mode?
IF InTestMode() = True THEN
	ExecutionMode(NormalMode)
ELSE
	// Apply the operating mode of WINDEV 5.5  
	// to avoid displaying some errors
	ExecutionMode(PermissiveMode)
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Recuperando el modo de ejecución actual

`<Result> = Modo de ejecución()`
---

**`<Result>: (Combinación de constantes enteras)`**

Modo de ejecución actual de la aplicación o del sitio:


|   |   |
| --- | --- |
| *Llamadas ExternasOptimizadas* | Optimiza la gestión de llamadas externas a los procedimientos. Este parámetro está asociado a una de las dos constantes siguientes. <br> |
| *DisableOptimizedExecution* | JITc (Just In Time compilation) está desactivado. |
| *ForceDestructorNonDynamicObject* | Fuerza la destrucción de objetos no dinámicos (incluso si se ha tomado una referencia fuerte). |
| *modeFormerOperatingModeDuration* | Las propiedades de Duración mantienen el modo de funcionamiento utilizado en la versión 12. |
| *Modo normal* | Los errores que se han producido generan mensajes de error. |
| *Modo Permisivo* | Se ignoran los errores que se han producido (modo WINDEV 5.5 o WEBDEV 1.5). |




<a name="SYNTAX2"></a>

### Modificar el modo de ejecución actual

`<Result> = Modo de ejecución(<New runtime mode>)`
---

**`<Result>: (Constante de tipo Integer)`**

Modo de ejecución de la aplicación o sitio después de la modificación.


|   |   |
| --- | --- |
| *Llamadas ExternasOptimizadas* | Optimiza la gestión de llamadas externas a los procedimientos. Este parámetro está asociado a una de las dos constantes siguientes. <br> |
| *DisableOptimizedExecution* | JITc (Just In Time compilation) está desactivado. |
| *ForceDestructorNonDynamicObject* | Fuerza la destrucción de objetos no dinámicos (incluso si se ha tomado una referencia fuerte). |
| *modeFormerOperatingModeDuration* | Las propiedades de Duración mantienen el modo de funcionamiento utilizado en la versión 12. |
| *Modo normal* | Los errores que se han producido generan mensajes de error. |
| *Modo Permisivo* | Se ignoran los errores que se han producido (modo WINDEV 5.5 o WEBDEV 1.5). |



**`<New runtime mode>: (Constante de tipo Integer)`**

Nuevo modo de tiempo de ejecución a aplicar.


|   |   |
| --- | --- |
| *Llamadas ExternasOptimizadas* | Optimiza la gestión de llamadas externas a los procedimientos. Este parámetro está asociado a una de las dos constantes siguientes. <br> |
| *DisableOptimizedExecution* | Desactiva la JITc (compilación de Just In Time). |
| *ForceDestructorNonDynamicObject* | Fuerza la toma de baja referencia para todos los objetos. |
| *modeFormerOperatingModeDuration* | Las propiedades de Duración mantienen el modo de funcionamiento utilizado en la versión 12. |
| *Modo normal* | Los errores que se han producido generan mensajes de error. |
| *Modo Permisivo* | Se ignoran los errores que se han producido (modo WINDEV 5.5 o WEBDEV 1.5). |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Desactivando el JITc
<a name="desactivando_jitc_ELTPARAGRAPHE000172"></a>

Para desactivar la tecnología JIT en una aplicación, se recomienda utilizar **ExecutionMode** con la constante *DisableOptimizedExecution* en el código de inicialización del proyecto. En este caso, sólo los elementos cargados antes de ejecutar el código de inicialización del proyecto (componentes, conjuntos de procedimientos, clases) utilizarán el JITc.

Para desactivar JITc para una aplicación WINDEV (por ejemplo, el problema causado por JITc), se recomienda modificar (o crear) el archivo &lt;Nombre ejecutable&gt;.WX. Este fichero debe encontrarse junto al ejecutable de la aplicación y debe contener la siguiente información:


```txt
[WD_EXECUTION]
OPTIM_EXECUTION=0
```

<a name="NOTE0_2"></a>




### Optimización de las llamadas externas
<a name="optimizacion_las_llamadas_externas_ELTPARAGRAPHE000186"></a>

**Atención**: Cuando se migra un proyecto de la versión 5.5, el modo permisivo se añade automáticamente al código de inicialización del proyecto durante la migración.. La siguiente línea de código le permite tener en cuenta la optimización de las llamadas externas:


```wl
ExecutionMode(PermissiveMode + ExternalCallsOptimized)
```

<a name="NOTE0_3"></a>




### Gestión de errores
<a name="gestion_errores_ELTPARAGRAPHE000196"></a>

El tabla a continuación presenta el comportamiento de la aplicación de acuerdo a los errores ocurridos:

| Caso de error | Modo Permisivo | Modo normal |
| --- | --- | --- |
| Lectura de un índice fuera del rango de una Tabla, List Box o control Combo Box.<br><br>**Ejemplos**:<br><br>s = ListaA[-1] <br><br>n = Lista B[56]...Color  | El programa devuelve '0' o una cadena vacía (""") dependiendo de la propiedad utilizada. | Se visualiza un error de ejecución.<br><br>**Ejemplo**:<br>"índice inválido: [-1]". |
| Escribir en una índice negativa de un List Box, Tabla o control Combo Box.<br><br>**Ejemplo**:<br>  Lista[-1] = "Smith"   | La línea de código es ignorada | Se visualiza un error de ejecución.<br><br>**Ejemplo**:<br>"índice inválido: [-1]" |
| Escribir en una índice demasiado grande de un List Box, Tabla o control Combo Box.<br><br>**Ejemplo**:<br>  LIST[54] = "Smith"   | Un elemento vacío se inserta al final de la control List Box y toma el valor especificado. | Se visualiza un error de ejecución.<br><br>**Ejemplo**:<br>"índice inválido: [ 54]" |
| <br><br>Usando [Abrir](../WDLang1/3038035.md), [OpenMobileWindow](../WDLang1/1000021018.md), [OpenChild](../WDLang1/3038021.md), [OpenSister](../WDLang1/3038045.md) con un nombre de ventana que contiene caracteres de espacio adicionales.<br><br>**Ejemplo**:<br>  Abierto ("WIN1")  | Los caracteres de espacio adicionales se eliminan. | Se visualiza un error de ejecución.<br><br>**Ejemplo**:<br>"La ventana de'WIN1' no se encuentra" |
| Usando la [funciones para la gestión de menús emergentes y desplegables](../WDLang1/3038016.md) con un número de menú que no existe.<br><br>**Ejemplo**:<br>  MenúMark(WIN1, 54645)  | La función devuelve '0' y [ErrorInfo](../WDLang1/3013008.md) está llena. | Se visualiza un error de ejecución.<br><br>**Ejemplo**:<br>"La opción especificada [ 54645] no existe en el menú" |
| Usando a [Right](../WDLang1/3024016.md) y [Left](../WDLang1/3024001.md) con un número negativo de caracteres para extraer.<br><br>**Ejemplo**:<br>  Left("abcdef", -1)  | La función devuelve una cadena vacía ("""). | La función devuelve EOT y [ErrorInfo](../WDLang1/3013008.md) se llena. |
| Usando [Middle](../WDLang1/3024023.md) con una posición de inicio que es negativa y / o con un número negativo de caracteres para extraer.<br><br>**Ejemplo**:<br>  Middle("abcdef", -2, -4)  | La función:<br><br>- inicia la extracción desde el principio de la cadena si la posición inicial es negativa.<br><br>- devuelve la cadena completa de la fuente.<br><br><br> | La función devuelve EOT y [ErrorInfo](../WDLang1/3013008.md) se llena. |



<a name="XComponent"></a>

## Componente:
wd280vm.dll
