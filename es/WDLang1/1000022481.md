
## AAFExportSecurity (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Asegura la exportación de datos confidenciales en los AAF (Automatic Application Features) que se utilizan para exportar, imprimir o guardar datos.. Es posible: 

- prohibir la exportación. En este caso, no se propone la opción AAF correspondiente.. 

- solicitar una contraseña. En este caso: 

	- se muestra un candado en la opción de menú de AAF. 
			Observación: Para las versiones anteriores a Windows 8, el símbolo que se muestra es una estrella (' '\*). 

	- aparece una ventana pidiendo una contraseña antes de realizar la acción. Si la contraseña no es válida, la acción no se realiza.






<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Allow exports
AAFExportSecurity(aafExportFree)
```

<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX1"></a>

### Asegurando la exportación a través de las FFA para toda la aplicación

`AAFExportSecurity(<Security level> [, <Password> [, <Message>]])`
---

**`<Security level>: (Integer constant)`**

Nivel de seguridad que se utilizará para todas las posibles exportaciones de las FAA:


|   |   |
| --- | --- |
| *aafExportForbidden* | No se permiten las exportaciones de los FAA de exportación. |
| *aafExportFree* | Las exportaciones se autorizan a partir de los FAA de exportación. |
| *aafExportPwd* | Las exportaciones de los AAFs de exportación requieren una contraseña. <br>Un candado (o una estrella ' '\*) se muestra en la opción de menú de AAF para informar al usuario de que la opción está asegurada.. <br><br>Se pueden especificar los parámetros &lt;Contraseña&gt; y &lt;Mensaje&gt;.. |
| *aafExportPwdScreenShotFree* | <br><br>- Las exportaciones de los AAFs de exportación requieren una contraseña. <br>	Un candado (o una estrella ' '\*) se muestra en la opción de menú de AAF para informar al usuario de que la opción está asegurada.. <br><br>- La captura de pantalla mediante la tecla [ PRNT SCREEN] o por programación no requiere contraseña.. <br><br><br><br><br>Se pueden especificar los parámetros &lt;Contraseña&gt; y &lt;Mensaje&gt;.. |



**`<Password>: (Optional character string (with quotes))`**

Contraseña que deberá ser introducida por el usuario para poder exportar los datos. Esta contraseña debe ser tecleada en una ventana propuesta automáticamente por WINDEV. 
Si este parámetro corresponde a una cadena vacía (""") o si no se especifica, la seguridad se desactiva.. 

**`<Message>: (Optional character string (with quotes))`**

Mensaje que aparece en la ventana para solicitar la contraseña. 
Si este parámetro corresponde a una cadena vacía ("") o si no se especifica, se visualiza un mensaje Default (en francés si la aplicación se ejecuta en francés, en inglés en caso contrario).


<a name="SYNTAX2"></a>

### Asegurando la exportación a través de los AAF para el control o una ventana

`AAFExportSecurity(<Control or window> , <Security level> [, <Password> [, <Message>]])`
---

**`<Control or window>: (Character string (with or without quotes))`**

Nombre de control o ventana a utilizar. Se produce un error de WLanguage si esta control o ventana no existe.

**`<Security level>: (Integer constant)`**

Nivel de seguridad que se utilizará para todas las posibles exportaciones de las FAA:


|   |   |
| --- | --- |
| *aafExportForbidden* | No se permiten las exportaciones de los FAA de exportación. Las opciones correspondientes no se muestran en el menú contextual. |
| *aafExportFree* | Las exportaciones se autorizan a partir de los FAA de exportación. |
| *aafExportPwd* | Las exportaciones de los AAFs de exportación requieren una contraseña. Un candado (o una estrella ' '\*) se muestra en la opción de menú de AAF para informar al usuario de que la opción está asegurada.. <br><br>Los parámetros &lt;Password&gt; y &lt;Message&gt; pueden ser especificados. |
| *aafExportPwdScreenShotFree* | <br><br>- Las exportaciones de los AAFs de exportación requieren una contraseña. <br>	Un candado (o una estrella ' '\*) se muestra en la opción de menú de AAF para informar al usuario de que la opción está asegurada.. <br><br>- Las capturas de pantalla realizadas con "Imprimir pantalla" o por programación no requieren contraseña.. <br><br><br><br><br>Se pueden especificar los parámetros &lt;Contraseña&gt; y &lt;Mensaje&gt;..  |



**`<Password>: (Optional character string (with quotes))`**

Contraseña que deberá ser introducida por el usuario para poder exportar los datos. Esta contraseña debe ser tecleada en una ventana propuesta automáticamente por WINDEV. 
Si esta contraseña corresponde a una cadena vacía (""") o si no se especifica, la seguridad se desactiva.. 

**`<Message>: (Optional character string (with quotes))`**

Mensaje que aparece en la ventana para solicitar la contraseña. Si no se especifica este mensaje, se muestra un mensaje Default (en francés si la aplicación se ejecuta en francés, en inglés en caso contrario). 







<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Tipos de exportación que se tienen en cuenta
<a name="tipos_exportacion_que_tienen_cuenta_ELTPARAGRAPHE000118"></a>

Esta función se aplica a: 

- las exportaciones (a Word, Excel, XML, ...) disponibles en el menú contextual de AAFS para los controles de Tabla, Tabla TreeView y Looper. 

- la opción "Imprimir" disponible en el menú contextual de los AAF para los controles de la Tabla, la Tabla TreeView, el Organizador, el Planificador, el Gráfico de Gantt, .... 
	Atención: si se crea un botón "Reporte en tabla", sólo se asegura la opción que se encuentra en el menú contextual. 

- la opción "Guardar como" que se encuentra en el menú contextual de controles como Image, Organigrama, Hoja de cálculo, Tablero de control, ...

- la opción "Copiar" si se selecciona más de un Line o más de 100 caracteres.

- la opción "Copiar todo" o "Copiar el contenido"' disponible en el menú contextual de AAF para los controles de la Tabla, Tabla TreeView, Organizador, Planificador, Gantt Chart, ... 

- las capturas de pantalla realizadas (excepto si se utiliza la constante *aafExportPwdScreenShotFree*): 

	- con la tecla Imprimir pantalla.

	- por programación ([dCopyWindowImage](../WDLang1/1000019912.md) por ejemplo).


 Si se define una opción de seguridad (contraseña o restricción), la captura de pantalla será Black. 







### Múltiples valores
<a name="multiples_valores_ELTPARAGRAPHE000140"></a>

Si se aplican varios valores a un elemento, los valores se tienen en cuenta según el siguiente orden: 

1. La seguridad definida para el control.  

2. Seguridad definida para la ventana.

3. Seguridad definida para la aplicación.




La seguridad definida para el control tiene prioridad. Por lo tanto, si la exportación está prohibida en la aplicación pero si está permitida en un control, el usuario podrá exportar los datos de control. 




### Gestionar contraseñas
<a name="gestionar_contrasenas_ELTPARAGRAPHE000152"></a>

Si se solicita una contraseña: 

- la opción del menú muestra una indicación para informar al usuario de que se requiere una acción específica: 

	- un candado en Windows 8 y posteriores. 

	- el signo**\*en Windows 7 y anteriores. 




- la introducción de la contraseña se realiza en una ventana específica. Esta ventana: 

	- utiliza el tema de plantilla definido para la aplicación si la opción "Aplicar tema de la plantilla a los componentes integrados en el proyecto y a las ventanas de las FAA" está marcada (pestaña "Estilo" en la ventana del proyecto description). 

	- muestra por Default el siguiente mensaje en inglés: "Estos datos son confidenciales. Escriba una contraseña para continuar". Este mensaje se puede modificar mediante el parámetro &lt;Mensaje&gt;.. Para las aplicaciones multilingües, si no se definió un mensaje multilingüe personalizado, el mensaje Default se muestra en inglés. 

	- tiene por título el título de la ventana actual. 

	- contiene una contraseña control Campo de entrada para introducir la contraseña. Si la contraseña introducida no corresponde a la esperada, no se realiza la exportación.. 










### Caso especial: ActiveX control
<a name="caso_especial_activex_control_ELTPARAGRAPHE000173"></a>

La prohibición de capturas de pantalla puede limitar las capacidades de visualización de algunos ActiveX. En este caso, si no se puede mostrar el ActiveX en su versión más reciente, se debe permitir la captura de pantalla en la ventana correspondiente con la constante *aafExportPwdScreenShotFree*.





<a name="XComponent"></a>

## Componente:
wd280obj.dll
