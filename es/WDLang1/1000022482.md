


## docFragment (Tipo de Variable)

*** ***
				



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
El tipo **docFragment** se utiliza para definir las características de un fragmento encontrado en un "docx" Document. Las características de este fragmento pueden definirse y modificarse mediante diferentes propiedades de WLanguage. 

Un fragmento se define por su posición inicial y final. Por lo tanto, puede:

- se extienden en varios párrafos,

- empiezan en medio de cualquier palabra ordinaria,

- terminan en medio de cualquier palabra ordinaria.




**Observación**: Para obtener más información sobre la declaración de este tipo de variable y el uso de propiedades WLanguage, consulte [Declarar una variable](../Motscles/1514032.md).
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Change the selection color
// Get the current selection
MySelection is docFragment(WP_MyDocument, WP_MyDocument.Cursor, ...
		WP_MyDocument.SelectionLength)
// Change the color
MySelection.Formatting.TextColor = PastelRed
```
<a name="Example2"></a>

```wl
// Load the document
MyDoc is Document = "c:\temp\doc.docx"

// Adds text at the end of document
FragmentEnd is docFragment(MyDoc, -1 , 0)
FragmentEnd.Text += "End of document"
```


## Sintaxis
<a name="SYNTAX1"></a>

### Declarando un fragmento de Document que no está descrito

`MyVariable is docFragment`
---

En este caso, el fragmento de Document no está descrito. La Variable tendrá que ser asignada con un fragmento existente o con el resultado de una de las funciones de tratamiento de documentos ([DocSeek](../WDLang1/1000022388.md) por ejemplo). 


<a name="SYNTAX2"></a>

### Declarar y describir un fragmento

`MyVariable is docFragment([<Document> [, <Start of fragment> [, <Length>]]])`
---

**`<Document>: (Documento opcional Variable o cadena de caracteres)`**

Document de la que se extraerá un fragmento. Este documento corresponde a: 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) el nombre de un control Procesador de texto. 

- una variable de tipo [Document](../WDLang1/1000022461.md). 




**`<Start of fragment>: (Entero opcional)`**

Posición inicial del fragmento de Document a utilizar. Esta posición se da en número de caracteres: 

- desde el comienzo de Document (número positivo). 

- desde el final de Document (número negativo). 




**`<Length>: (Entero opcional)`**

Longitud del fragmento a utilizar, expresada en número de caracteres. 
Observación: un número negativo le permite tomar un número de caracteres empezando desde el final: -1' = el final, '-2' = 1 carácter antes del final, etc.



<a name="NOTE0"></a>

## Observaciones
<a name="NOTE0_1"></a>


### Propiedades específicas de las variables docFragment
<a name="propiedades_especificas_las_variables_docfragment_ELTPARAGRAPHE000071"></a>Las siguientes propiedades se pueden utilizar para manipular una variable de tipo **docFragment**:


   | --- |
| --- | --- | --- |
| **Nombre de la propiedad** | Tipo utilizado | Efecto |
| aspecto | Array de [docElement](../WDLang1/1000022484.md) | Los elementos que componen el fragmento de Document utilizado. Los elementos de los fragmentos se pueden navegar a través de la sentencia FOR EACH. |
| Rango | Integro | Número de caracteres en el fragmento. Corresponde a la posición final menos la posición inicial. <br>La extensión puede corresponder a un valor positivo, negativo o cero.. <br><br>Observaciones:<br><br>- Si el fragmento contiene un tabla o una sección de un tabla, se cuentan todos los caracteres que contiene.. <br><br>- Si el fragmento contiene una Image o un área de texto, cada una corresponde a 1 carácter. <br><br><br> |
| SubdocumentoIdentificador | Integro | Identificador correspondiente al subdocumento associated con el fragmento. Esta Property está destinada a un uso avanzado. <br><br> |
| LanguageSpelling | Cadena de caracteres | El lenguaje del fragmento. La notación utilizada corresponde a la norma 639-1. Por ejemplo "FR-fr". <br><br>En modo de lectura, esta Property devuelve una información válida sólo si el fragmento corresponde a un solo idioma. <br><br>**Observación**: Para realizar la corrección ortográfica correspondiente al idioma del fragmento, el diccionario de este idioma debe ser cargado por [DictionaryLoad](../WDLang1/1000022958.md).<br><br> |
| Formato | Variable de tipo [docFormatting](../WDLang1/1000022817.md) | Formateo de la información de todos los elementos que componen el fragmento de Document utilizado.<br><br> |
| PageLayout |   | Disposición del fragmento actual. <br><br> |
|   | PageLayout.BackgroundColor | Integro | Fondo color de fragmento. Este color puede corresponder a:<br><br>- un color RGB (devuelto por la función [RGB](../WDLang1/3029012.md)),<br><br>- [un color predefinido](../WDLang5/3010002.md). <br><br><br> |
|   | PageLayout.BackgroundPattern | Variable de tipo [Background](../WDLang1/1000022038.md) | Características del fragmento Background. <br><br> |
| Palabra | Array de **docFragment** | Las palabras que conforman el fragmento de Document utilizado. Las palabras fragmentadas pueden ser hojeadas a través de la sentencia FOR EACH. |
| Párrafo | Array de [docParagraph](../WDLang1/1000022483.md) | Párrafos afectados por el fragmento (si un fragmento incluye varios párrafos). Los párrafos se pueden consultar a través de la sentencia FOR EACH. |
| Posición de inicio | Integro | Posición inicial del fragmento. Esta posición es relativa a toda la Document. |
| Posición final | Integro | Posición final del fragmento. Esta posición es relativa a toda la Document. |
| StyleID | Cadena de caracteres | Identificador de estilo aplicado al fragmento. Este identificador debe existir entre los estilos relacionado al Document. <br><br>Observación: Al cambiar el estilo de párrafo o de fragmento se aplica automáticamente el estilo de párrafo y el estilo de carácter de relacionado, si existen. |
| texto | Cadena de caracteres | Texto en bruto correspondiente al contenido del fragmento utilizado. |
| TypeSubDocument | Constante de tipo Integer | Sección de Document a la que pertenece el fragmento. <br> Los valores posibles son: <br><br>- *typeSubDocCanvas*: Contenedor Image<br><br>- *typeSubDocBody*: Document cuerpo. <br><br>- *typeSubDocHeaderOddPage*: Encabezado de página impar. <br><br>- *typeSubDocHeaderEvenPage*: Encabezado de página par. <br><br>- *typeSubDocHeaderFirstPage*: Cabecera de la primera Page. <br><br>- *typeSubDocFooterOddPage*: Pie de página impar. <br><br>- *typeSubDocFooterEvenPage*: Pie de página par. <br><br>- *typeSubDocFooterFirstPage*: Pie de la primera Page. <br><br>- *typeSubDocTextArea*: Área de texto.<br><br><br><br><br>Esta propiedad es de solo lectura. |


<a name="NOTE0_2"></a>


### Funciones WLanguage que utilizan variables docFragment
<a name="funciones_wlanguage_que_utilizan_variables_docfragment_ELTPARAGRAPHE000430"></a>

Las variables de **docFragment** son manejadas por varias funciones WLanguage: 

- Funciones WLanguage que utilizan sintaxis estándar: 
	


|   |   |
| --- | --- |
| [DocAdd](../WDLang1/1000022919.md) | Agrega: <br><br>	- al final de un tratamiento de palabras Document: un elemento, una Document, un párrafo, un texto, una Image o un fragmento.<br><br>	- al final de un fragmento: un elemento, un texto o un Image.<br><br><br> |
| [DocFind](../WDLang1/1000022388.md) | Encuentra una cadena de caracteres: <br><br>	- en un procesador de textos completo Document.<br><br>	- en un fragmento.<br><br><br> |
| [DocInsert](../WDLang1/1000022732.md) | Inserta un objeto en un procesador de textos Document o sustituye el contenido del fragmento actual. Los objetos que se pueden utilizar son: <br><br>	- un elemento,<br><br>	- a Document, <br><br>	- a paragraph, <br><br>	- un texto, <br><br>	- una imagen, etc, <br><br>	- un fragmento.<br><br><br> |
| [DocInsertTable](../WDLang1/1000022967.md) | Inserta una tabla en un procesador de textos Document. |
| [DocSelect](../WDLang1/1000022391.md) | Selecciona un fragmento de un control Procesador de texto. |

- Funciones de WLanguage que utilizan la sintaxis de los prefijos: 
	


|   |   |
| --- | --- |
| [&lt;docFragment Variable&gt;.Añadir](../WDLang1/1000024505.md) | Añade un elemento, texto o imagen al final de una docFragment Variable. |
| [&lt;docFragment Variable&gt;.Insertar](../WDLang1/1000024512.md) | Reemplaza el contenido del fragmento actual. Los objetos que se pueden utilizar son: <br><br>	- un elemento,<br><br>	- a Document, <br><br>	- a paragraph, <br><br>	- un texto, <br><br>	- una imagen, etc, <br><br>	- un fragmento.<br><br><br> |
| [&lt;docFragment Variable&gt;.InsertTable](../WDLang1/1000024514.md) | Sustituye el fragmento especificado por un tabla. |





