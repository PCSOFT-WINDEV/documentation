


## TableCollapseExpand (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Contrae o expande un elemento de un control Tabla o Tabla TreeView.

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) Control Tabla TreeView: 

- Contrae la rama si está expandida. Los nodos "Hijo" no son visibles en el control Tabla TreeView. Los nodos hijo permanecen en su estado anterior (contraído o expandido).

- Expande la rama si está contraída. Los nodos "Hijo" son visibles en el control Tabla TreeView.




Control Tabla: 

- Contrae la ruptura si está expandida. Los elementos de la ruptura no son visibles en el control Tabla.

- Expande la ruptura si está contraída. Los elementos de la ruptura son visibles en el control Tabla.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) contrae o expande una ventana de detalles de una fila (Para obtener más información, consulte [Gestionar los detalles de una fila de un control Tabla](../WDChamp/1013200.md)):

	- Contrae la ventana si está expandida.

	- Expande la ventana si está contraída.






<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Collapses or expands the selected branch in the TreeView Table control 
SWITCH TableCollapseExpand(TVT_Schedule)
	CASE taCollapse
	Info(" Branch expanded. ")
	CASE taExpand
	Info(" Branch collapsed. ")
	CASE taError
	Info(" Branch not found. ")
END
```
<a name="Example2"></a>

```wl
// Expands or collapses the the first row of "TVT_Schedule"
TableCollapseExpand(TVT_Schedule, 1)
```
<a name="Example3"></a>

```wl
// Collapses or expands the specified branch in the TreeView Table control
TableCollapseExpand(TVT_Schedule, "MyRoot" + TAB + "MyBranch")
```
<a name="Example4"></a>

```wl
// Collapses or expands the break of the current row in "TABLE_Break"
TableCollapseExpand(TABLE_Break, TABLE_Break)
```

<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX1"></a>

### Tabla TreeView: Contraer o expandir una rama especificando el número de la fila

`<Result> = TableCollapseExpand(<TreeView Table control> [, <Row used>])`
---

**`<Result>: (Entero)`**

Estado de la rama especificada antes de llamar a la función:


|   |   |
| --- | --- |
| *taCollapse* | Rama contraída. |
|  *taError* | Rama inexistente. |
| *taExpand* | Rama expandida. |



**`<TreeView Table control>: (Nombre del control)`**

Nombre del control Tabla TreeView a manipular.

**`<Row used>: (Entero opcional)`**

Número de la fila que contiene la rama a contraer o expandir. Si no se especifica este parámetro, se manipula la rama de la fila actual.


<a name="SYNTAX2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 
### Tabla TreeView: Contraer o expandir una rama especificando el nombre

`<Result> = TableCollapseExpand(<TreeView Table control> [, <Branch used>])`
---

**`<Result>: (Entero)`**

Estado de la rama especificada antes de llamar a la función:


|   |   |
| --- | --- |
| *taCollapse* | Rama contraída. |
|  *taError* | Rama inexistente. |
| *taExpand* | Rama expandida. |



**`<TreeView Table control>: (Nombre del control)`**

Nombre del control Tabla TreeView a manipular.

**`<Branch used>: (Cadena de caracteres opcional)`**

Nombre de la rama a contraer o expandir. Este parámetro tiene el siguiente formato:

```txt
"<Root name>" + TAB + ["<Name of 1st node>" + TAB + ...
["<Name of 2nd node>" + TAB + [...]]]"<Branch name>"
```


Si este parámetro no corresponde a una rama existente, se produce un error WLanguage.

Si no se especifica este parámetro, se manipula la rama de la fila actual.  

Si dos ramas corresponden a la ruta especificada, solo se manipula la primera. 


<a name="SYNTAX3"></a>

### Tabla con rupturas: Contraer o expandir una ruptura

`<Result> = TableCollapseExpand(<Table control> [, <Row used> [, <Break>]])`
---

**`<Result>: (Entero)`**

Estado de la ruptura especificada antes de llamar a la función:


|   |   |
| --- | --- |
| *taCollapse* | Rama contraída. |
|  *taError* | Rama inexistente. |
| *taExpand* | Rama expandida. |



**`<Table control>: (Nombre del control)`**

Nombre de control Tabla a manipular. Este control debe tener una o más rupturas. De lo contrario, esta función no tiene ningún efecto.

**`<Row used>: (Entero opcional)`**

Número de fila de la ruptura a contraer o expandir. Este número debe corresponder al número de la fila actual o al número de la primera fila de la ruptura a contraer o expandir. Si no se especifica este parámetro, se manipula la ruptura de la fila actual.

**`<Break>: (Cadena de caracteres opcional)`**

Nombre de la ruptura a contraer o expandir. Este parámetro debe especificarse en rupturas anidadas. Permite definir la ruptura que se contraerá o expandirá. Por defecto, no se manipula ninguna ruptura si están anidadas.  


<a name="SYNTAX4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 
### Tabla y tabla TreeView: contraer una ventana de detalles

`<Result> = TableCollapseExpand(<Table control> [, <Row used>])`
---

**`<Result>: (Entero)`**

Estado de la ventana de detalles especificada antes de llamar a la función:


|   |   |
| --- | --- |
| *taCollapse* | Rama contraída. |
|  *taError* | Rama inexistente. |
| *taExpand* | Rama expandida. |



**`<Table control>: (Nombre del control)`**

Nombre del control Tabla o Tabla TreeView a manipular.

**`<Row used>: (Entero opcional)`**

Número de la fila cuyos detalles se deben contraer o expandir. Si no se especifica este parámetro, se manipulan los detalles de la fila actual.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Condiciones de uso
<a name="condiciones_uso_ELTPARAGRAPHE000188"></a>

La función **TableCollapseExpand** puede utilizarse en: 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) un control Tabla TreeView.

- un control Tabla basado en un archivo de datos.

- un control Tabla rellenado mediante programación.  




Esta función no se puede utilizar en controles Tabla archivo de datos (acceso directo). 
<a name="NOTE0_2"></a>


### Rama a contraer o expandir
<a name="rama_contraer_expandir_ELTPARAGRAPHE000213"></a>

La función **TableCollapseExpand** no tiene ningún efecto:


|   |   |
| --- | --- |
| Control Tabla TreeView | Control Tabla con rupturas |
| <br><br>- si no se encuentra la rama a manipular.<br><br>- si la rama a manipular es una hoja.<br><br>- si la rama a manipular ya está contraída.<br><br><br> | <br><br>- si el control Tabla no tiene rupturas.<br><br>- si el control Tabla contiene varias rupturas y no se especifica la ruptura a manipular.<br><br>- si no se selecciona ninguna fila en el control Tabla y no se especifica el parámetro &lt;Número de fila&gt;.<br><br><br> |


**Observación para los controles Tabla TreeView**: 

- Si el parámetro &lt;Fila manipulada&gt; o &lt;Rama manipulada&gt; corresponde a la rama de la primera fila, la jerarquía del control Tabla TreeView se contrae (equivalente a la función [TableCollapseAll](../WDLang1/1000010003.md)) o expande (equivalente a la función [TableExpandAll](../WDLang1/1000010001.md)).

- Cuando se llama a la función **TableCollapseExpand**, si la rama especificada está expandida y tiene un procedimiento asociado mediante la propiedad [AddChildDelayed](../Proprietes/1000020927.md), se ejecutará el procedimiento. 



<a name="NOTE0_3"></a>


### Gestión de la banda de selección al contraer
<a name="gestion_banda_seleccion_contraer_ELTPARAGRAPHE000254"></a>

**Para los controles Tabla TreeView**:

- Si la banda de selección estaba sobre un elemento del nodo a contraer, la banda se posiciona en el nodo contraído o expandido después de llamar a la función **TableCollapseExpand**.

- El código de modificación se llama cada vez que se mueve la banda de selección. Si dos niveles están contraídos y la banda de selección ser posiciona en el nodo superior, se ejecutan los códigos de modificación de cada nivel.




**Para los controles Tabla con rupturas**, no se modifica la banda de selección. Se mantiene en el elemento actual incluso si la ruptura está contraída.
<a name="NOTE0_4"></a>


### Gestión de la banda de selección al expandir
<a name="gestion_banda_seleccion_expandir_ELTPARAGRAPHE000270"></a>

La función **TableCollapseExpand** no cambia la posición de la banda de selección.
<a name="NOTE0_5"></a>


### Velocidad de ejecución para controles Tabla TreeView
<a name="velocidad_ejecucion_para_controles_tabla_treeview_ELTPARAGRAPHE000281"></a>

La velocidad de ejecución de la sintaxis 1 es más rápida que la de la sintaxis 2.

<a name="XComponent"></a>

## Componente:
wd280obj.dll
