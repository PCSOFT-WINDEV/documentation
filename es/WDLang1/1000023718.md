


## &lt;Hoja de cálculo&gt;.ControlFormula (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Permite utilizar un control para crear una barra de fórmula personalizada para el control Hoja de cálculo.
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// -- Initialization code of Spreadsheet control
// Removes the default formula bar
PSHEET_MySpreadsheet.FormulaBarVisible = False
// Defines the control used to view 
// the coordinates of selected cell in the Spreadsheet control
PSHEET_MySpreadsheet.ControlFormula(psheetfSelection, STC_Selection)
// Defines the control used to enter the formulas in the Spreadsheet control
PSHEET_MySpreadsheet.ControlFormula(psheetfFormula, EDT_Formula)
```

```wl
// -- Click code of button used to validate the formula
// Use of AAFExecute
AAFExecute(PSHEET_MySpreadsheet, aafValidateInputFunc)
```

```wl
// -- Click code of button used to cancel the formula
// Use of AAFExecute
AAFExecute(PSHEET_MySpreadsheet, aafCancelInputFunc)
```

<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX1"></a>

`<Spreadsheet control>.ControlFormula(<Type> , <Control to use>)`
---

**`<Spreadsheet control>: (Nombre del control)`**

Nombre del control Hoja de cálculo a utilizar.

**`<Type>: (Constante de tipo Integer)`**

Uso del control: 


|   |   |
| --- | --- |
| *psheetfFormula* | El control permite introducir la fórmula de la celda actual en el control Hoja de cálculo. <br><br>Atención: el control usado DEBE ser un control Campo de entrada. |
| *psheetfSelection* | El control muestra la selección actual (célula o rango de células) en el control Hoja de cálculo. |



**`<Control to use>: (Nombre del control)`**

Nombre de la ventana control que se utilizará para personalizar la visualización de la fórmula o la selección.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


- Después de la ejecución de esta función, los controles que se encuentran en la barra de fórmulas de Default ya no se utilizan más. Le aconsejamos que desactive la visualización de la barra de fórmulas Default con [FormulaBarVisible](../Proprietes/1000021334.md). 

- Para validar la entrada en la barra de fórmulas personalizadas, debe ejecutar [AAFExecute](../WDLang1/1000022099.md) asociada a la constante *aafValidateInputFunc*.

- Para cancelar la entrada en la barra de fórmulas personalizadas, debe ejecutar [AAFExecute](../WDLang1/1000022099.md) asociada a la constante *aafCancelInputFunc*.

- Esta función sólo se puede utilizar en un control Hoja de cálculo que se encuentre en una ventana..




<a name="XComponent"></a>

## Componente:
wd280obj.dll
