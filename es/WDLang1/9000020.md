


## UMC: Implementación y gestión de los "Macro-Códigos de Usuario".
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000216"></a>
Independientemente de la habilidad del equipo de desarrollo, el usuario final siempre querrá hacer algo que no ha sido planeado.

Para permitir a los usuarios avanzados personalizar sus aplicaciones, **WINDEV propone el modo UMC**: el usuario final tiene la posibilidad de introducir el código de WLanguage e "injertarlo" en una aplicación existente.

Esta función no está disponible en Default: tiene la posibilidad de activar o desactivar esta función en cualquier momento.

**Atención**: La modificación de una aplicación por parte del usuario final puede provocar un comportamiento inesperado de la aplicación.. Debe tener cuidado al utilizar esta funcionalidad.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## ¿Cómo implementar el UMC?
<a name="¿como_implementar_umc_ELTTEXTE000240"></a>


### Principio
<a name="principio_ELTPARAGRAPHE000024"></a>

Para implementar el UMC en una aplicación WINDEV, todo lo que tiene que hacer es permitir la entrada de los Macro-Códigos de Usuario:

- al describir el proyecto,

- al crear el ejecutable.




Si el UMC fue implementado por una de estas dos opciones, la entrada de Macro-Códigos de Usuario será permitida por Default en todas las ventanas de su aplicación.

Para cada ventana de su aplicación, puede especificar si la entrada de códigos de macro de usuario está permitida o no en esta ventana.

Cuando se utiliza la aplicación, los diferentes Macro-Códigos de Usuario se guardan en archivos.MCU. Estos Macro-Códigos de Usuario pueden ser importados al proyecto para modificar la aplicación de acuerdo a los requerimientos del usuario final.. Para obtener más información, consulte [Importación de Macro-Códigos de Usuario en el proyecto](#NOTE5_1).

**Observación: ¿Dónde se almacena el código de macro de usuario?**
Cuando el usuario introduce un nuevo Macro-Código de Usuario, esta información se almacena en un archivo.MCU. Hasta la versión 160047, este archivo.MCU se encontraba en el directorio ejecutable. A partir de ahora, este archivo se guarda en el directorio de datos del usuario (devuelto por [fDataDirUser](../WDLang1/3036071.md)). Cualquier modificación de un macro-código de usuario existente desencadena el movimiento del archivo UMC correspondiente.. 
Para una aplicación de red, si el ejecutable se instala en un directorio de red compartido, el archivo .MCU se guardará en el directorio "MyDocuments\\Application Data\\&lt;Nombre del proyecto&gt;.
<a name="NOTE2_2"></a>


### Configuración del proyecto
<a name="configuracion_del_proyecto_ELTPARAGRAPHE000052"></a>

Al describir el proyecto, el UMC puede configurarse para todo el proyecto: 

1. En la pestaña "Proyecto", en el grupo "Proyecto", haga clic en "Descripción". 

2. En la pestaña "Avanzado" haga clic en el botón "Código de macro de usuario. 

<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=MCU_Projet.gif)
En esta pantalla:

- Puede permitir (o no) la entrada de UMC en las ventanas del proyecto.

- Si la entrada de UMC está permitida en las ventanas del proyecto, puede hacerlo:

	- ***Restringir la entrada de UMC a los usuarios que conocen la contraseña especificada.***. Por lo tanto, algunos usuarios no podrán modificar la aplicación.

	- ***Permitir el uso de comandos de lectura HFSQL***. Si esta opción está seleccionada, el usuario final podrá leer y navegar por los registros que se encuentran en los archivos de datos HFSQL de la aplicación.. En cualquier caso, el usuario final no podrá modificar o crear nuevos registros o nuevos archivos de datos.

	- ***Aceptar las sugerencias de los usuarios***. Si esta opción está marcada, tiene la posibilidad de introducir el correo electrónico Address al que se enviarán las sugerencias de los usuarios (es decir, los macrocódigos escritos por los usuarios).






<a name="NOTE2_3"></a>


### Describir las ventanas
<a name="describir_las_ventanas_ELTPARAGRAPHE000084"></a>

Al describir cada ventana, puede prohibir la entrada de códigos de macro de usuario para esta ventana.

Para ello, marque "Prohibir el uso de UMC" en la pestaña "Detalles" de la ventana description.<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=MCU_Fenetre.GIF)

<a name="NOTE2_4"></a>


### Creación del ejecutable
<a name="creacion_del_ejecutable_ELTPARAGRAPHE000094"></a>

Al crear el ejecutable, también tiene la capacidad de habilitar (o no) la entrada de los Macro-Códigos de Usuario.. La información introducida es idéntica a la información introducida al configurar el proyecto.. Esta información se incluirá automáticamente en el proyecto description.
<a name="NOTE2_5"></a>


### Consejos
<a name="consejos_ELTPARAGRAPHE000101"></a>

- Para mover el botón UMC, cree un nuevo botón, asociado a la acción preestablecida "Abrir la ventana de edición del Macro-Código de usuario". En este caso, el botón de Default no se mostrará más. El nuevo botón se puede colocar en cualquier lugar de la ventana. 

- Para hacer un control Invisible en la ventana de configuración de UMC (un control oculto por ejemplo), su nombre debe comenzar con. El nombre de la control no se propondrá a los usuarios.  




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Funciones específicas de la gestión de UMC
<a name="funciones_especificas_gestion_umc_ELTTEXTE000288"></a>
Varias funciones de WLanguage se utilizan para definir la entrada de códigos de macro de usuario en una aplicación


|   |   |
| --- | --- |
| [InUMCMode](../WDLang1/1000017027.md) | Indica si el código se ejecuta desde un código escrito en un Macro-Código de Usuario. Por ejemplo, en el código de un Procedure, permite averiguar si el Procedure fue ejecutado desde un Macro-Código de Usuario o no. |
| [UMCActive](../WDLang1/3030020.md) | Permite conocer y modificar la gestión de UMC del proyecto o componente actual. |
| [UMCOpen](../WDLang1/3030021.md) | Permite abrir la ventana que permite al usuario introducir un nuevo "User Macro-Code". |



<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Uso del UMC en una aplicación
<a name="uso_del_umc_una_aplicacion_ELTTEXTE000312"></a>
La introducción de nuevos Macro-Códigos de Usuario en una aplicación es un juego de niños. Si la ventana permite introducir un macrocódigo de usuario, aparece la ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=MCU_Icone.gif) Icon junto a la minimización Icon de la ventana. Al hacer clic en esta Icon se abre una asistente, que permite al usuario final crear y utilizar sus propios Códigos Macro de Usuario.

Para obtener más información, consulte [Uso del UMC](../WDLang1/9000021.md).

<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Importación de códigos de macros de usuario
<a name="importacion_codigos_macros_usuario_ELTTEXTE000336"></a>
Para importar Macro-Códigos de Usuario a su proyecto: 

1. En la pestaña "Proyecto", en el grupo "Proyecto", despliegue "Importar" y seleccione "Macro-Códigos de Usuario".

2. Seleccione el archivo.MCU correspondiente al Macro-Código a importar. Valide.

3. Seleccione los Macro-Códigos de Usuario a importar.
	El botón ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=MCU_Import_diff.gif) permite ver las modificaciones realizadas por el usuario en relación con el código existente.

4. Validar. La importación se realiza automáticamente. Los comentarios se utilizan para ver la sección de código importado.





