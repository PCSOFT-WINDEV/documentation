


## TableSearch (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Realiza una búsqueda en: 

- un control Tabla, 

- un control Tabla TreeView, 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) una tabla que se muestra en un control Combo Box.


Hay dos modos de búsqueda disponibles:  

- Búsqueda de un elemento en una columna. 

- Búsqueda de un elemento en el valor almacenado del control. 



<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Searches for the "Shirt" element in the "COL_Product" column
// Generic search performed from row 5
let ResSearch = TableSearch(COL_Product, "Shirt", searchStartsWith, 5)
```
<a name="Example3"></a>

```wl
// Used to list all occurrences of a sought value.
Result1 is int
Result1 = TableSearch(COL_ColumnName, "SoughtValue", searchExactMatch)
WHILE Result1 <> -1
	Trace(Result1)
	Result1 = TableSearch(COL_ColumnName, "SoughtValue", ...
		searchExactMatch, Result1 + 1)
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Buscar un elemento en una columna

`<Result> = TableSearch(<Column name> , <Search element> [, <Type of search> [, <Source row>]])`
---

**`<Result>: (Entero)`**



- Índice del elemento encontrado,

- -1 si ningún elemento corresponde con la búsqueda.




Si se realiza la búsqueda:

- en un control Tabla rellenado mediante programación, no se selecciona el elemento encontrado. Para seleccionar el elemento encontrado, utilice la función [TableSelectPlus](../WDLang1/3074031.md).

- en un control Tabla basado en un archivo de datos, no se selecciona el elemento encontrado, las filas del control Tabla se desplazan hasta el elemento buscado.




**`<Column name>: (Cadena de caracteres)`**

Nombre de la columna en la que se realiza la búsqueda. 
Si este parámetro corresponde a una cadena vacía (""), se utilizará la columna a la que pertenece el proceso actual.

**En un control Tabla o Tabla TreeView basado en un archivo de datos**, la columna de búsqueda debe estar enlazada a un campo clave. No se pueden realizar búsquedas en una columna que no esté enlazada a un campo.

**`<Search element>: (Tipo del elemento buscado)`**

Elemento que debe buscarse en la columna especificada. Si el tipo de elemento buscado es de tipo:

- "Fecha" u "Hora": la búsqueda se realiza en el valor devuelto.

- "Monetario + Euro": la búsqueda se realiza en la divisa almacenada.




**`<Type of search>: (Constante opcional de tipo Integer)`**

Tipo de búsqueda que se realizará: 



|   |   |
| --- | --- |
| *searchContains* | **Búsqueda genérica de tipo "Contiene"**<br><br>Se devuelven los elementos cuyo valor contiene &lt;Search element&gt;. <br><br> |
| *searchDefault* | **Búsqueda predeterminada**. Para esta función, la búsqueda predeterminada es una búsqueda exacta (de tipo es "Igual a").  <br><br>Se devuelven los elementos cuyo valor es estrictamente igual a &lt;Search element&gt;.<br><br>Atención: En un control Tabla rellenado mediante programación, se ignoran los espacios iniciales. <br><br> |
| *searchExactMatch* (o <u><u><u><u>True</u></u></u></u> para compatibilidad)<br>(Valor predeterminado) | **Búsqueda exacta** ("Igual a")<br><br>Se devuelven los elementos cuyo valor es estrictamente igual a &lt;Search element&gt;.<br><br>Atención: En un control Tabla rellenado mediante programación, se ignoran los espacios iniciales. |
| *searchStartsWith* (o <u><u><u><u>False</u></u></u></u> para compatibilidad) | **Búsqueda genérica de tipo "Comienza por"**<br><br>Se devuelven los elementos cuyo valor empieza por &lt;Search element&gt;. <br><br>Atención: En un control Tabla rellenado mediante programación, se ignoran los espacios iniciales. |



**`<Source row>: (Entero opcional)`**

Número de la fila de origen de la búsqueda en la columna. 
Si no se especifica este parámetro, la búsqueda se realiza en toda la columna. 
Este parámetro se usa para encontrar todas las instancias de una cadena en una columna.
Este parámetro se ignora en controles Tabla basados en un archivo de datos.  


<a name="SYNTAX2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
### Buscar un elemento en un control Tabla (valor almacenado)

`<Result> = TableSearch(<Table control> , <Sought value>)`
---

**`<Result>: (Entero)`**



- Índice del elemento encontrado,

- -1 si ningún elemento corresponde con la búsqueda.




**`<Table control>: (Nombre del control)`**

Nombre del control a manipular. Este control puede corresponder a: 

- un control Tabla.

- un control Tabla TreeView.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) un control Combo Box con tabla.




El control Tabla debe estar vinculado a un archivo de datos o variable.. 

**`<Sought value>: (Tipo del elemento buscado)`**

Valor del elemento buscado. Este valor se busca en el valor almacenado del control.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Condiciones de uso
<a name="condiciones_uso_ELTPARAGRAPHE000179"></a>

**Sintaxis 1**: **La búsqueda de elementos en una columna** está disponible para:

- controles Tabla o Tabla TreeView basados en un archivo de datos.

- controles Tabla o Tabla TreeView rellenados mediante programación.

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) tablas que se muestran en un control Combo Box, 

- controles de selección única o múltiple.
	




Para un control Tabla o Tabla TreeView basado en un archivo de datos: 

- el modo de iteración debe ser automático. 

- la columna debe estar enlazada a un campo clave.


![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) **Sintaxis 2**: **La búsqueda de elementos en valores almacenados** está disponible para: 

- controles Tabla o Tabla TreeView basados en un archivo de datos. 

- controles Tabla o Tabla TreeView basados en variables. 

- controles de selección única o múltiple.
	



<a name="NOTE0_2"></a>


### Tipo de búsqueda
<a name="tipo_busqueda_ELTPARAGRAPHE000219"></a>

- ***Búsqueda exacta***: Solo los elementos cuyo valor es estrictamente igual a &lt;Search element&gt; son devueltos por la función TableSearch. Por ejemplo:
	
	```wl
	// Return all customers whose name is "Smith" from "COL_NameColumn"
	TableSearch(COL_NameColumn, "Smith")
	```
Atención: En un control Tabla rellenado mediante programación, se ignoran los espacios iniciales. 

- ***Búsqueda genérica***: Los elementos que comienzan por &lt;Search element&gt; son devueltos por la función TableSearch. 
	Por ejemplo: 
	
	```wl
	// Return all customers whose name starts with "SMI"
	TableSearch(COL_NameColumn, "SMI", searchStartsWith)
	```




<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Control Tabla basado en un archivo de datos
<a name="control_tabla_basado_archivo_datos_ELTPARAGRAPHE000240"></a>

- En una tabla archivo de datos, se puede utilizar la siguiente sintaxis para buscar un elemento en una columna:
	
	```txt
	TableName = SearchElement
	```


- En controles Tabla basados en un archivo de datos con acceso directo a la fuente de datos, cuando se llama a la función **TableSearch**: 

	- se desplaza la visualización del control Tabla.

	- el índice devuelto corresponde a un índice "aproximado" porque este tipo de control Tabla puede gestionar miles de millones de registros.  






<a name="NOTE0_4"></a>


### Varios
<a name="varios_ELTPARAGRAPHE000255"></a>

- **En un control Tabla rellenado mediante programación**, la búsqueda realizada con la función **TableSearch**: 

	- no distingue entre mayúsculas y minúsculas.

	- ignora los espacios iniciales. 




- **En un control Tabla basado en un archivo de datos**, la búsqueda realizada con la función **TableSearch** tiene en cuenta las características de búsqueda definidas en el análisis para el campo enlazado a la columna de búsqueda (distinguir o no entre mayúsculas y minúsculas, etc.).




<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Código UI
## Componente:
wd280obj.dll
