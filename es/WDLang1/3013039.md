
## INIWrite( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Escribe un valor específico en un archivo INI (o en un archivo estructurado como un archivo.INI). Es posible:

- escribir el valor de una palabra clave encontrada en una sección específica,

- crear o borrar una palabra clave,

- crear o borrar una sección.





<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Store the selected product in the .INI
INIWrite("USER", "LastProd", ...
	NumToString(ListSelect(LIST_Product)), ...
	fCurrentDir() + "\Port.INI")
```


<a name="Example2"></a>


![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
Ejemplo de archivo.INI:


```txt
[WD examples]
Name1 = WDInstall
Name2 = WDBench
[Description of WDInstall]
Caption = Use the control panel of Windows
LST = 43
Page = 12
```



```wl
// Write into the [WD examples] section
INIWrite("WD examples", "Name3", "WDExample", "C:\Temp\ExamplesLST.INI")
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = INIWrite(<Section> [, <Keyword> [, <Value> [, <File>]]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se realizó la operación,

- <u><u><u><u>False</u></u></u></u> en caso contrario.




**`<Section>: (Cadena de caracteres)`**

Nombre de la sección donde se realizará la operación de escritura. La sección se crea automáticamente si no existe.

**Observación**: Este nombre no puede contener el carácter "-".

**`<Keyword>: (Cadena de caracteres opcional)`**

Nombre de la palabra clave que contiene la información a escribir. Esta palabra clave se crea automáticamente si no existe.
La sección se borrará si este parámetro es una cadena vacía (""") o si corresponde a NULL.



**`<Value>: (Cadena de caracteres opcional)`**

Texto a escribir para la palabra clave y la sección especificada. La palabra clave se eliminará si este parámetro es una cadena vacía (""") o si ti corresponde a NULL.

**Observación**: Este nombre no puede contener el carácter TAB.


**`<File>: (Cadena de caracteres opcional)`**

Nombre completo del archivo a completar (con su extensión). 

- El archivo WIN.INI se utilizará si no se especifica este parámetro. 

- Si sólo no se especifica la ruta, el archivo se buscará en el directorio de Windows. 

- El directorio no se creará si no existe. 

- El archivo se creará si no existe en el directorio especificado.




![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Nombre completo del archivo a completar (con su extensión). 

- Si no se especifica este parámetro, el archivo utilizado será el que se llame como el proyecto y se encuentre en el directorio de ejecución de la aplicación.. El archivo se creará si no existe. 

- Si sólo no se especifica la ruta, el fichero se buscará en el directorio de ejecución de la aplicación.


![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Este parámetro es obligatorio. Este parámetro puede corresponder a una ruta completa o a una ruta relativa en relación con el directorio actual.. El directorio actual corresponde al directorio de datos de la aplicación.
**Recordatorio**: Sólo se pueden manejar los archivos que se encuentran en el directorio de datos associated con la aplicación.







<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Escritura en un archivo INI en modo Unicode
<a name="escritura_archivo_ini_modo_unicode_ELTPARAGRAPHE000162"></a>

Su aplicación funciona en modo Unicode ("Usar cadenas UNICODE en tiempo de ejecución" marcado en la pestaña "Unicode" de la configuración de description).

En este caso, para escribir en un fichero INI, este fichero INI debe estar en formato Unicode, lo que significa que debe tener una cabecera de lista de materiales Unicode.. 

Ejemplo: 


```wl
fCreate(gsINIFile, foUnicode) // creates gsINIFile with BOM UNICODE
INIWrite("French", "Country", "French",gsINIFile)
INIWrite("??","??", "??", gsINIFile)
```



<a name="NOTE0_2"></a>




### Varios
<a name="varios_ELTPARAGRAPHE000176"></a>

- No le aconsejamos que escriba en el archivo WIN.INI.  

- Para escribir en el registro, utilice las funciones específicas del registro: [RegistrySetValue](../WDLang1/3065006.md), etc.

- Los archivos INI están limitados a 64 KB (en Windows 98).



<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Windows Vista (y posterior)
<a name="windows_vista_posterior_ELTPARAGRAPHE000190"></a>

Los estándares de programación de Windows no aconsejan escribir:

- en el archivo WIN.INI

- en los directorios de sistema (directorio Windows, directorio "Archivos de programa", ....).




**En Windows Vista (y posterior) con el mecanismo UAC activado**los privilegios de administrador son necesarios para realizar estas operaciones. Si la aplicación no tiene los privilegios de administrador necesarios, el [Mecanismo UAC](../Editeurs/2025014.md) redirigirá los archivos (llamados de virtualización) a un directorio propio del usuario que está utilizando la aplicación (C:\\Usuarios\\&lt;LOGIN&gt;AppData\\Local\\VirtualStore\\Windows\\). Los archivos pueden volver a ser leídos por [INIRead](../WDLang1/3013043.md) en la misma aplicación. Este mecanismo de virtualización de archivos es propuesto por Windows Vista (y posterior) para su compatibilidad y no está disponible en 64 bits.

**Atención**: Si el archivo INI se virtualiza automáticamente con Windows Vista (y posterior), el archivo INI no se puede compartir entre varias aplicaciones (especialmente si estas aplicaciones utilizan privilegios diferentes).

**Consejo de programación**: Para crear un archivo INI sin tener los privilegios de administrador: 

- no utilice el archivo WIN.INI (debe especificarse el parámetro &lt;Archivo&gt;), 

- evite escribir en el directorio de Windows o en el de "Archivos de programa",

- utilizar el directorio del sistema de la aplicación (devuelto por [SysDir](../WDLang1/3073026.md) con la constante *srAppDataCommun*, por ejemplo).








<a name="XComponent"></a>

## Componente:
wd280std.dll
