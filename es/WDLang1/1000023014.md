
## ExecuteJS (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Ejecuta código JavaScript en el contexto de la página web mostrada por una pantalla HTML control. 

**Atención**: La opción "Prohíbe la ejecución de scripts JavaScript" debe estar desmarcada en la pestaña "General" de la ventana del control de visualización HTML description. 
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
JSCode is string = [
var Now = new Date();
alert( 'Today is: ' + Now);
]
ExecuteJS(HTM_MyHTMLControl, CodeJS)
```


<a name="Example2"></a>

```wl
JSCode is string = [
var Now = new Date();
var result = '' + Now;
''+Now;
]

ExecuteJS(HTM_MyControl, JSCode, ExecuteJS_Callback)

INTERNAL PROCEDURE ExecuteJS_Callback(bSuccess is boolean, ReturnValue is string)
	IF NOT bSuccess
		Error(ErrorInfo())
		RETURN
	END
	Info(ReturnValue)
END
```





<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX1"></a>

`<Result> = ExecuteJS(<HTML Display control> , <JavaScript code> [, <WLanguage procedure>])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se transmitió el código JavaScript al control para ser ejecutado,

- <u><u><u><u>False</u></u></u></u> en caso contrario. 




**`<HTML Display control>: (Nombre del control)`**

Nombre de la pantalla HTML control en la que se ejecutará el script JavaScript. 

**`<JavaScript code>: (Cadena de caracteres)`**

Código JavaScript para ejecutar. Este código se ejecuta en modo asíncrono. El resultado de la ejecución del código se puede obtener mediante el parámetro &lt;Procedimiento WLanguage&gt;. 

El valor devuelto por el código JavaScript corresponde al valor de la expresión encontrada en la última Line del código. No utilice "retorno". La expresión a recuperar debe ser una cadena.

**`<WLanguage procedure>: (Nombre opcional de Procedure)`**

WLanguage Procedure ("callback") utilizado para averiguar el resultado de la ejecución del código. Este procedimiento tiene el siguiente formato: 

```txt
PROCEDURE <Procedure name>(bSuccess is boolean, ReturnValue is string)
```
Esta Procedure se llama una vez que el código JavaScript ha sido ejecutado. Los parámetros de esta Procedure son: 

- &lt;bSuccess&gt;: 

	- <u><u><u><u>True</u></u></u></u> si el código JavaScript fue ejecutado con éxito,

	- <u><u><u><u>False</u></u></u></u> si la ejecución del código JavaScript generó un Error( por ejemplo, error en el código JavaScript). En ese caso, para get más detalles sobre el error, utilice [ErrorInfo](../WDLang1/3013008.md). 
			




- &lt;ReturnValue&gt; contiene el valor de la última expresión del código JavaScript (valor devuelto).






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones
<a name="NOTE0_2"></a>


### Llamada al código WLanguage desde el código JavaScript
<a name="llamada_codigo_wlanguage_desde_codigo_javascript_ELTPARAGRAPHE000119"></a>

Puede llamar al código WLanguage desde un código JavaScript ejecutado a través de **ExecuteJS** o a través del código HTML contenido en la pantalla HTML control. Se deben realizar las siguientes operaciones: 

1. En la pestaña "General" de la pantalla HTML control, marque "Permitir llamar al WLanguage desde el código HTML (función JavaScript WL.Execute)". 

2. En el código HTML del control, utilice **WL.Execute** para ejecutar un procedimiento WLanguage. Se debe utilizar la siguiente sintaxis: 
	
	```txt
	WL.Execute(<WLanguage procedure name>, <Parameter 1>) [, ... [, <Parameter N>]]] )
	```
 donde: 

	- &lt;WLanguage Nombre de Procedure&gt; corresponde al nombre del Procedure que se va a ejecutar. 

	- &lt;Parámetro N&gt; corresponde a los diferentes parámetros que se pasarán a la Procedure: 

		- Número de parámetros: 

			- ![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png) entre 0 y N.




- Tipo de parámetros: 

	- ![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png) Los parámetros del lenguaje WLanguage Procedure se pasarán según su tipo: booleano, cadena, número, null. 




Ejemplo: 

- Procedimiento WLanguage 
	
	```wl
	PROCÉDURE ProcFromJS(t)
	ToastDisplay("Called from JS: " + t)
	```


- Código de HTML control: 
	
	```wl
	s is string = [
		<html>
		<head>
		<title> A simple example 
		</title>
		<script>	
		function myFunction() 
		{
			WL.Execute("ProcFromJS","titaa");
		}
		</script>
		</head>
		<body>
		<h1> This is an HTML page </h1>
		<p id="demo">A paragraph</p>
		<button type="button" onclick="myFunction()">Try</button>
		</body>
		</html>
	]
	HTM_NoName1 = s
	```









<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Código UI
## Componente:
wd280obj.dll
