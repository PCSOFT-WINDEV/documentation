


## ListSeek (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Busca un elemento en una control List Box (cuadro de lista estándar o listview) o en una control Combo Box (incluyendo los valores descritos por [gStoredValue](../WDLang1/1410088363.md)).



**Observación**: La función **ListSeek** puede utilizarse en:

- Controles de la caja de lista basados en un archivo de datos o rellenados mediante programación,

- Controles de cuadro de lista de selección única o de selección múltiple.











<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Find the element "Moore" in the List Box control "LIST_CustomerList"
ResSeek = ListSeek(LIST_CustomerList, "Moore")
```


<a name="Example2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
```wl
// Find "Moore" in the "LIST_CustomerList" List Box control based on a data file
// Exact-match search from element 5
ResFind = ListSeek(LIST_CustomerList, "Moore", True, 5)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = ListSeek(<List Box control> , <Search element> [, <Type of search> [, <Start of search>]])`
---

**`<Result>: (Integro)`**



- Índice del elemento encontrado. 

- -1 si ningún elemento corresponde con la búsqueda.


El elemento encontrado no está seleccionado. Para seleccionar el elemento encontrado, utilice la función [ListSelectPlus](../WDLang1/3049012.md).
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) En una control List Box basada en un archivo de datos, el elemento encontrado se muestra si no es Visible.

**`<List Box control>: (Nombre del control)`**

Nombre de la casilla de la lista (o Combo Box) control a utilizar.

Si este parámetro corresponde a una cadena vacía (""), el elemento se busca en el control al que pertenece el actual Event.


**`<Search element>: (Cadena de caracteres)`**

Elemento que se encuentra en el cuadro de lista especificado (o Combo Box) control.

**`<Type of search>: (Booleano opcional)`**



- <u><u><u><u>True</u></u></u></u> (valor predeterminado) para una búsqueda exacta,

- <u><u><u><u>False</u></u></u></u> para una búsqueda genérica.




**`<Start of search>: (Entero opcional)`**

Índice a partir del cual se iniciará la búsqueda en el cuadro de lista o control Combo Box. 
Si no se especifica este parámetro, la búsqueda se realiza en toda la control. Este parámetro se ignora para los controles que se manejan mediante programación.




<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Tipo de búsqueda
<a name="tipo_busqueda_ELTPARAGRAPHE000162"></a>

- **Búsqueda exacta**: 
	Solo los elementos cuyo valor es estrictamente igual al &lt;Elemento buscado&gt; son devueltos por la función ListSeek. Por ejemplo: 
	
	```wl
	// Return all the customers named "Doe" found in "LIST_Name"
	ListSeek(LIST_Name, "Doe")
	```


- **Búsqueda genérica**: 
	Los elementos que comienzan por &lt;Elemento buscado&gt; son devueltos por la función ListSeek. Por ejemplo:
	
	```wl
	// Return all customers whose name starts with "SMI"
	ListSeek(LIST_Name, "SMI", False)
	```




<a name="NOTE0_2"></a>


### &lt;Inicio de la búsqueda&gt; parámetro
<a name="parametro_ELTPARAGRAPHE000194"></a>

El parámetro &lt;Start of search&gt; se utiliza para encontrar todas las ocurrencias de una cadena en un List Box o control Combo Box.

Por ejemplo, para contar el número de nombres que comienzan con "SMI" en la "LIST_CustomerList" control:

```wl
Index is int
Cnt is int = 0
// Position on the first corresponding element
Subscript = ListSeek(LIST_CustomerList, "SMI", False)
WHILE Index <> -1
	Cnt++
	// Find the next name starting with "SMI"
	Subscript = ListSeek(LIST_CustomerList, "SMI", False, Subscript + 1)
END
```

<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Caracteres en mayúsculas/minúsculas
<a name="caracteres_mayusculasminusculas_ELTPARAGRAPHE000213"></a>

- Si la control es una control List Box rellenada programáticamente, la búsqueda ignora los caracteres en mayúsculas y minúsculas.

- Si el control es un control List Box basado en un archivo de datos, la búsqueda realizada en los elementos "Clave" tiene en cuenta las opciones de búsqueda definidas en el editor de análisis (pestaña "General" del elemento description).

<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ListeCherche%20-%20HC%20N%B0001.gif)

<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Buscar y seleccionar un elemento en un List Box o control Combo Box
<a name="buscar_seleccionar_elemento_list_box_control_combo_box_ELTPARAGRAPHE000233"></a>Para buscar y/o seleccionar un elemento en una Caja de Listas o control Combo Box basada en un archivo de datos, puede utilizar la siguiente sintaxis:

```wl
LIST_OrderList.StoredItem = "CustomerID"
// Find and select the element whose CustomerID is "135"
LIST_OrderList = 135
// If the element sought is not found, LIST_OrderList will be set to -1
```
![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Se selecciona el elemento buscado.
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Búsqueda de un elemento en un cuadro de lista o control Combo Box basado en un archivo de datos: buscar el valor almacenado o el valor visualizado
<a name="busqueda_elemento_cuadro_lista_control_combo_box_basado_archivo_datos_buscar_valor_almacenado_valor_visualizado_ELTPARAGRAPHE000248"></a>

**Caso 1: La Caja de Listas o control Combo Box se rellena con los datos de un archivo de datos (opción "Acceso directo")**: 
La búsqueda se realiza en función del valor de [gStoredValueEnable](../WDLang1/1410088364.md):

- Si gStoredValueEnable(Control, True) (por Default): La función **ListSeek** realiza la búsqueda en el "elemento de búsqueda" declarado en la pestaña "Contenido" de la descripción del control.

- Si gStoredValueEnable(control, False): La función **ListSeek** realiza la búsqueda en el "elemento que se muestra" declarado en la pestaña "Contenido" de la descripción del control.




**Caso 2: El cuadro de lista o control Combo Box se rellena con los datos de un archivo de datos (opción "Cargado en memoria")**: 
La función **ListSeek** realiza la búsqueda en el "elemento que se muestra" declarado en la pestaña "Contenido" de la descripción del control.
<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Búsqueda y selección en un control List Box
<a name="busqueda_seleccion_control_list_box_ELTPARAGRAPHE000277"></a>Si las opciones utilizadas para rellenar el control List Box se definen en la ventana description del control (pestaña "Contenido"), se puede utilizar la siguiente sintaxis para buscar y seleccionar un elemento en un control List Box:


```txt
ListBoxName = SoughtElement
```


Las opciones utilizadas para rellenar la control List Box son:

- Archivo recorrido, 

- Elemento mostrado,

- Buscar en el artículo.

<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ListeCherche%20-%20HC%20N%B0002.gif)

<a name="NOTE0_7"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Varios
<a name="varios_ELTPARAGRAPHE000298"></a>

- Para realizar una búsqueda en un control Tabla o en un control Combo Box con tabla, utilice [TableSearch](../WDLang1/3074015.md).

- **ListSeek** puede utilizarse en una columna "Combo Box" tabla.




<a name="XComponent"></a>

## Componente:
wd280obj.dll
