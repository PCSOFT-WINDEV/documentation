
## ServiceWaitStatus( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Espera a que un servicio se encuentre en un estado específico.. Este servicio se puede encontrar en el ordenador local o en un ordenador remoto.
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1001000017101&name=servicewaitstatus_funcion&product=WD">Ver ejemplos adicionales</a>

```wl
// Wait for the service in TABLE_Service to start
Res is int
ServiceStart(COL_Name[TABLE_Service])
Res = ServiceWaitStatus(COL_Name[TABLE_Service], serviceStatusStarted, 10)
IF Res = -1 THEN
	Error(ErrorInfo())
ELSE
	Info("Status at the end of timeout: " + StatusInText(Res))
END
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = ServiceWaitStatus(<Service name> , <Expected status> [, <Timeout> [, <Remote computer>]])`
---

**`<Result>: (Constante de tipo Integer)`**



- Situación actual del servicio, 
	


|   |   |
| --- | --- |
| *serviceStatusPaused* | El servicio está en pausa. |
| *serviceStatusPausing* | El servicio recibió un comando de pausa pero aún no ha sido pausado. |
| *serviceStatusRestarting* | El servicio recibió un comando para reiniciar pero aún no ha sido reiniciado. |
| *serviceStatusStarted* | El servicio está actualmente en funcionamiento. |
| *serviceStatusStarting* | El servicio ha recibido una orden de inicio, pero aún no se ha iniciado. |
| *serviceStatusStopped* | El servicio está interrumpido. |
| *serviceStatusStopping* | El servicio recibió la orden de detenerse, pero aún no se ha detenido. |
| *serviceStatusTimeout* | El servicio no ha alcanzado el estado solicitado al final del tiempo de espera. |



- -1 si se produce un error. Para obtener más información sobre el error, utilice la función [ErrorInfo](../WDLang1/3013008.md).




**`<Service name>: (Cadena de caracteres)`**

Nombre del servicio a utilizar.

**`<Expected status>: (Constante de tipo Integer)`**

Estado esperado del servicio:


|   |   |
| --- | --- |
| *serviceStatusPaused* | El servicio está en pausa. |
| *serviceStatusPausing* | El servicio recibió un comando de pausa pero aún no ha sido pausado. |
| *serviceStatusRestarting* | El servicio recibió un comando para reiniciar pero aún no ha sido reiniciado. |
| *serviceStatusStarted* | El servicio está actualmente en funcionamiento. |
| *serviceStatusStarting* | El servicio ha recibido una orden de inicio, pero aún no se ha iniciado. |
| *serviceStatusStopped* | El servicio está interrumpido. |
| *serviceStatusStopping* | El servicio recibió la orden de detenerse, pero aún no se ha detenido. |



**`<Timeout>: (Entero o duración opcional)`**

Tiempo máximo de espera (en segundos). Este parámetro puede corresponder a: 

- un número entero correspondiente al número de segundos,

- una variable de tipo Duration,

- la duración en un formato legible (por ejemplo, 1 s). 


Si no se especifica este parámetro, el tiempo de espera es de set a 10 segundos. 

**`<Remote computer>: (Cadena de caracteres opcional)`**



- IP Address del ordenador remoto en formato xxx.xxx.xxx.xxx (devuelta por [NetIPAddress](../WDLang3/3056023.md)),

- Nombre del ordenador remoto (devuelto por [NetMachineName](../WDLang3/3056014.md)). 


Este parámetro se utiliza para manipular un servicio en otro ordenador.. Para utilizar esta opción, el usuario debe ser administrador del equipo remoto.. 
Si este parámetro no se especifica o si corresponde a una cadena vacía ("""), el servicio se gestiona localmente..  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>


<a name="XComponent"></a>

## Componente:
wd280std.dll
