


## Tipo de hoja de cálculo y selección de máscara (función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Devuelve o modifica el tipo y la máscara de las celdas seleccionadas en un control Hoja de cálculo encontrado en una ventana.

**Observación**: Esta función se puede utilizar, por ejemplo, para crear una barra de formato para un control Hoja de cálculo. 
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// CLICK on [NUMBER] - Change of mask 
SpreadsheetTypeAndMaskSelection(PSHEET_Spreadsheet, typInputNum, "999 999 999,99")

// CLIC on [Long DATE]. 
// Change of mask: for example 19 -> "Sunday 19 January 1900"
SpreadsheetTypeAndMaskSelection(PSHEET_Spreadsheet, typInputDate, "DDD D MMMM YYYY")
```

```wl
// Returns the selection mask
sRes is string 
nType is int
sMask is string
sRes = SpreadsheetTypeAndMaskSelection(PSHEET_Spreadsheet)
nType = Val(ExtractString(sRes, 1, TAB))
sMask = Val(ExtractString(sRes, 2, TAB))
```

<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX1"></a>

### Averiguar el tipo y la máscara de las células seleccionadas

`<Result> = SpreadsheetTypeAndMaskSelection(<Spreadsheet control>)`
---

**`<Result>: (Cadena de caracteres)`**

Máscara de células seleccionadas. Esta máscara tiene el siguiente formato: 


```txt
<Type> + TAB + <Mask>
```
donde: 

- El tipo&gt; corresponde a una de las siguientes constantes: 
	


|   |   |
| --- | --- |
| *typInputCurrency* | Tipo de moneda |
| *typInputDate* | Tipo de fecha |
| *typInputDuration* | Tipo de duración |
| *typInputNum* | Tipo numérico (entero, real, ...) |
| *typInputText* | Tipo de texto |
| *typInputTime* | Tipo de tiempo |



- &lt;Máscara&gt; corresponde a la máscara utilizada. 




**`<Spreadsheet control>: (Nombre del control)`**

Nombre del control Hoja de cálculo a utilizar. 


<a name="SYNTAX2"></a>

### Modificar el tipo y la máscara de las células seleccionadas

`SpreadsheetTypeAndMaskSelection(<Spreadsheet control> , <Type> , <Mask>)`
---

**`<Spreadsheet control>: (Nombre del control)`**

Nombre del control Hoja de cálculo a utilizar. 

**`<Type>: (Constante de tipo Integer)`**

Nuevo tipo para la celda seleccionada: 


|   |   |
| --- | --- |
| *typInputCurrency* | Tipo de moneda |
| *typInputDate* | Tipo de fecha |
| *typInputDuration* | Tipo de duración |
| *typInputNum* | Tipo numérico (entero, real, ...) |
| *typInputText* | Tipo de texto |
| *typInputTime* | Tipo de tiempo |



**`<Mask>: (Cadena de caracteres)`**

Nueva máscara a utilizar (la máscara depende del tipo seleccionado).  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Máscaras disponibles
<a name="mascaras_disponibles_ELTPARAGRAPHE000131"></a>

Las máscaras disponibles dependen del tipo de máscara. Todas las máscaras que pueden utilizarse con [InputMask](../Proprietes/2510033.md) están disponibles. Para más detalles, consulte la ayuda de [InputMask](../Proprietes/2510033.md) Property. 

Por ejemplo: 

- en una cita: tiene la posibilidad de utilizar la máscara "DD/MM/YYYYY".. 

- en un número: tienes la habilidad de usar la máscara "999 999".




Observaciones: 

- (typInputText, "") significa "sin máscara". 

- La máscara definida por la función **Tipo de hoja de cálculo y selección de máscara** puede modificarse con la propiedad [InputMask](../Proprietes/2510033.md). 
	Atención: sólo la máscara puede ser modificada, el tipo de célula no se modifica. 



<a name="NOTE0_2"></a>


### Definir una máscara en una columna
<a name="definir_una_mascara_una_columna_ELTPARAGRAPHE000163"></a>

Para definir una máscara en una columna, sólo hay que seleccionar la columna y aplicar la máscara solicitada. Ejemplo: 

```wl
SpreadsheetSelectPlus(PSHEET_NoName1, "A")
SpreadsheetTypeAndMaskSelection(PSHEET_NoName1, typInputDate, "DD-MM-YY")
```

<a name="NOTE0_3"></a>


### Varios
<a name="varios_ELTPARAGRAPHE000179"></a>

- La operación de modificación se añade a la lista de operaciones de Cancel: el usuario puede deshacer esta operación a través del menú contextual o pulsando Ctrl + Z.

- Esta función sólo puede utilizarse en una control Hoja de cálculo que se encuentre en una ventana.






<a name="XComponent"></a>

## Componente:
wd280obj.dll
