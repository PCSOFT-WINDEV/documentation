


## Cita previa (función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Añade un nuevo Appointment en un control Planificador. Si el control Planificador es relacionado a una fuente de datos, el Appointment también se añade a la fuente de datos. 



![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) En el modo Universal Windows 10 App, esta función sólo se puede utilizar para manipular los controles del Programador que se encuentran en un reporte. 
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Adds a 1-hour appointment for tonight
MyResource is string
MyTitle is string
StartAPT is DateTime

MyResource = "Vince"
MyTitle = "Sales meeting"
StartAPT = DateSys() + "17000000"

SchedulerAddAppointment(SCH_Schedule, MyResource, MyTitle, StartAPT)
```

<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX1"></a>

### Añadir una Appointment especificando sus características

`<Result> = SchedulerAddAppointment(<Scheduler control> , <Resource> , <Title> , <Start date> [, <End date> [, <Category>]])`
---

**`<Result>: (Integro)`**



- Índice de agregado Appointment,

- -1 si se produce un error. La función [ErrorInfo](../WDLang1/3013008.md) permite identificar el error.


**Observación**: El elemento añadido puede ser manejado directamente a través de su índice utilizando la siguiente notación: 

```txt
<Scheduler control>[<Index>]
```
Puede modificar las propiedades de este elemento. 

**`<Scheduler control>: (Nombre del control)`**

Nombre de control Planificador en el que se añadirá el Appointment. Este control puede corresponder a: 

- el control Planificador de una ventana, 

- la control Planificador de un Page,

- la control Planificador de un reporte.




**`<Resource>: (Cadena de caracteres)`**

Nombre del recurso asociado a la Appointment. 
Si los horarios Resource s han sido creados con [SchedulerAddResource](../WDLang1/1000019279.md) utilizando [gStoredValue](../WDLang1/1410088363.md), este parámetro debe corresponder al valor especificado en [gStoredValue](../WDLang1/1410088363.md) para este Resource.
El Resource se crea automáticamente si no existe. 

**`<Title>: (Cadena de caracteres)`**

Título de Appointment.

**`<Start date>: (Cadena de caracteres o variable de tipo DateTime)`**

Fecha y hora de inicio de la Appointment.

**`<End date>: (Cadena de caracteres opcional o DateTime opcional Variable)`**

Fecha y hora de finalización de la Appointment. Si no se especifica este parámetro, la duración por defecto de la Appointment será set a 1 hora.

**`<Category>: (Cadena de caracteres opcional)`**

Nombre de la categoría asociada a la Appointment. Si no se especifica este parámetro, el Appointment es associated sin categoría. La categoría se crea automáticamente si no existe.


<a name="SYNTAX2"></a>

### Añadir un Appointment en un control Planificador usando el tipo Appointment

`<Result> = SchedulerAddAppointment(<Scheduler control> , <Appointment>)`
---

**`<Result>: (Entero opcional)`**



- Índice de agregado Appointment,

- -1 si se produce un error. La función [ErrorInfo](../WDLang1/3013008.md) permite identificar el error.


**Observación**: El elemento añadido puede ser manejado directamente a través de su índice utilizando la siguiente notación: 

```txt
<Scheduler control>[<Index>]
```
Puede modificar las propiedades de este elemento. 

**`<Scheduler control>: (Nombre del control)`**

Nombre de control Planificador en el que se añadirá el Appointment. Este control puede corresponder a: 

- el control Planificador de una ventana, 

- la control Planificador de un Page,

- la control Planificador de un reporte.




**`<Appointment>: (Appointment Variable)`**

Variable [Appointment](../WDLang1/1000019244.md) que describe las características del Appointment a añadir.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Asociar una Appointment a varios recursos
<a name="asociar_una_appointment_varios_recursos_ELTPARAGRAPHE000155"></a>

**Cita previa** asocia un Appointment con un solo Resource. To associate one Appointment with multiple Resource s, call **Cita previa** for each Resource .



<a name="XComponent"></a>

## Componente:
wd280mdl.dll
