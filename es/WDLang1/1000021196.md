


## TablaRefreshVisible (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Modifica o devuelve el estado de visibilidad de la barra actualización en una Tabla o control Tabla TreeView.

Esta función se puede utilizar cuando control Tabla soporta la opción "Pull-to-actualización".. Para habilitar esta opción en una control Tabla: 

1. Abra la ventana de descripción del control Tabla. 

2. En la pestaña "Detalles", en la sección "Desplazamientos y gestos", seleccione la opción "Deslizar hacia abajo para actualizar (Pull to refresh)".

3. Validar. 


![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) Esta función está disponible en WINDEV y sólo se utiliza en modo simulador. En una aplicación WINDEV, esta función no tiene ningún efecto. 


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Event "Pull to refresh" of the Table control
// ---------------------------------------------------------
// Check the display of selection bar because the refresh of
// Table control data will be performed in a secondary thread. 
// Otherwise, the refresh bar would be automatically hidden at the
// end of process execution.
TableRefreshVisible(TABLE_Data, True)
// Refreshes the data of Table control in a secondary thread
ThreadExecute("ThreadUpdTable", threadNormal, ProcThreadUpdTable)
```

```wl
//----------------------------------------------------
// Procedure used to update the data in the Table control
PROCEDURE ProcThreadTableUpdate()
// Run an HTTP request
HTTPRequest(...)
// Goes back to the main thread to add the request content into the Table control
ExecuteMainThread(ProcUpdTable, HTTPGetResult())
END
```

```wl
// ---------------------------------------------------
// Procedure for filling data in the Table control
PROCEDURE ProcUpdateTable(sData is string)
// Process the received data in order to populate the Table control
...
// The Table control data is updated, hide the refresh bar
TableRefreshVisible(TABLE_Data, False)
END
```

<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX1"></a>

### Cambiar el estado de la barra de actualización

`TableRefreshVisible(<Table control> , <Visible>)`
---

**`<Table control>: (Nombre del control)`**

Nombre del control a manipular. Este control puede corresponder a: 

- un control Tabla.

- un control Tabla TreeView.




**`<Visible>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> para mostrar la barra de actualización,

- <u><u><u><u>False</u></u></u></u> para ocultarla.





<a name="SYNTAX2"></a>

### Conseguir el estado del bar actualización

`<Result> = TableRefreshVisible(<Table control>)`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se muestra la barra de actualización,

- <u><u><u><u>False</u></u></u></u> si la barra de actualización está oculta.




**`<Table control>: (Nombre del control)`**

Nombre del control a manipular. Este control puede corresponder a: 

- un control Tabla.

- un control Tabla TreeView.






<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


- Durante una "Pull to actualización", la barra actualización corresponde al área mostrada sobre las filas del control Tabla durante los datos actualización.

- La función **TablaRefreshVisible** permite, por ejemplo, controlar la visualización de la barra de actualización cuando los datos del control Tabla se actualizan en un hilo secundario. Esto evita que la aplicación se congele (el ejemplo utiliza este método). 

- Cuando **TablaRefreshVisible** hace visible la barra actualización, el "Pull to actualización" Event del control Tabla no se ejecuta.
	Observación: Puede forzar la ejecución de este evento utilizando [ExecuteProcess](../WDLang1/3013031.md) con la constante *trtPullToRefresh*.

- Para ocultar la barra de actualización, se debe llamar a la función **TablaRefreshVisible(False)** tantas veces como se haya ejecutado **TablaRefreshVisible(True)**.




<a name="XComponent"></a>

## Componente:
wd280java.dll
