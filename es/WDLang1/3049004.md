


## ListAdd (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Añade un elemento a: 

- a control List Box poblada programáticamente,

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) a control ListView poblada programáticamente,

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) y control Carrusel,

- a control Combo Box poblada programáticamente.




**Observaciones**:

- Para añadir un elemento en una posición concreta, utilice [ListInsert](../WDLang1/3049002.md).

- La función **ListAdd** puede utilizarse en los controles List Box de selección única y selección múltiple.

- Para añadir una Image a una control List Box estándar, utilice [gImage](../WDLang1/3029042.md).

- Para añadir elementos a una control Combo Box que se encuentra en una columna contenedora de una control Tabla, utilice [Contenido](../Proprietes/1000017242.md).











<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Add the customer named "Moore" into "LIST_CustomerList"
ListAdd(LIST_CustomerList, "Moore")
```


<a name="Example2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
```wl
// Add the customers named "Clark" and "Smith" into "LIST_CustomerList"
ListAdd(LIST_CustomerList, "Clark" + CR + "Smith")
```


<a name="Example3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
```wl
// Add the "C:\MyImages\CoralReef.JPG" image into the "LSV_Diving" listview control
// The caption of this image will be "Nice coral"
ListAdd(LSV_Diving, "Nice coral", "C:\MyImages\CoralReef.JPG")
```


<a name="Example4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
```wl
// The "COMBO_Title" Combo Box displays personal titles:
// "Mister", "Madam" and "Miss".
// An integer representing a gender will be returned to the language.
ListeAdd(COMBO_Title, "Mister" + gStoredValue("1"))
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = ListAdd(<Control to use> [, <Element> [, <Path of image to display>]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se agregó el elemento,

- <u><u><u><u>False</u></u></u></u> en caso contrario.




**`<Control to use>: (Nombre del control)`**

Nombre del control a manipular: 

- control List Box se rellenó de forma programada,

- control ListView se rellenó de forma programada,

- control Combo Box se rellenó de forma programada.


Si este parámetro corresponde a una cadena vacía (""), el elemento se añade a la control List Box (o Combo Box) a la que pertenece la Event actual.


**`<Element>: (Cadena de caracteres opcional)`**

Elemento que se añadirá en la control especificada. Si no se especifica este parámetro, se añade un fila vacío en el List Box o control Combo Box. 
Este parámetro puede contener:

- Caracteres de retorno de carro (CR) para añadir varios elementos.

- (TAB) para obtener una control List Box multi-elemento (ver Notas).

- [gStoredValue](../WDLang1/1410088363.md) para indicar el valor que se devolverá cuando se seleccione el elemento. 


![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) **Para un control Carrusel**, el contenido de este parámetro se muestra al pasar el cursor sobre el elemento en la esquina superior izquierda del control Carrusel.![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) **Para un control ListView,** este parámetro corresponde a la leyenda Image. Este parámetro puede contener caracteres de retorno de carro (CR) para añadir varios elementos. En ese caso: 

- si no se especifica &lt;Ruta de la imagen a mostrar&gt;, los elementos añadidos se asociarán a la imagen por defecto (definida en la pestaña "Detalles" de la ventana description de control).

- si se especifica &lt;Ruta de Image a mostrar&gt;, sólo se añadirá el primer elemento. Este elemento será associated con el Image especificado.


![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) Se admiten los caracteres de retorno de carro (CR), mientras que no se admiten las tabulaciones (TAB).

**`<Path of image to display>: (Cadena de caracteres opcional)`**

Nombre y ruta de la imagen que se añadirá a un control ListView. También tiene la posibilidad de utilizar una partida de notas de Image. 
Este parámetro se tiene en cuenta sólo para los controles ListView visualizados en modo ListView.. 
Si no se especifica este parámetro, se utilizará la imagen por defecto (definida en la pestaña "Detalles" de la ventana description de control).
![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png) Este parámetro no está disponible.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### List Boxes que contienen más de 10 000 elementos
<a name="list_boxes_que_contienen_mas_10_000_elementos_ELTPARAGRAPHE000213"></a>

El número máximo de elementos de una control List Box sólo está limitado por la memoria disponible (máximo teórico: 2 mil millones de filas). Sin embargo, llenar un control List Box con un número importante de elementos (más de 10 000) afecta al rendimiento

Para añadir muchos elementos a un control List Box, se recomienda utilizar un control List Box basado en un archivo de datos (es decir, una lista directamente relacionado a un archivo de datos HFSQL).
<a name="NOTE0_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Visibilidad/Invisibilidad de los elementos en un List Box o control Combo Box
<a name="visibilidadinvisibilidad_los_elementos_list_box_control_combo_box_ELTPARAGRAPHE000226"></a>

Para que un elemento sea Invisible en un cuadro de lista o control Combo Box, utilice [gStoredValue](../WDLang1/1410088363.md).
<a name="NOTE0_3"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Equivalencia
<a name="equivalencia_ELTPARAGRAPHE000240"></a>Las dos sintaxis siguientes son equivalentes:

```txt
ListAdd(<Control name> [<Element>])
```


y


```txt
<Control name>[Index] = <Element>
```

<a name="NOTE0_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Universal Windows 10 App](https://doc.pcsoft.fr/ext/images/us/UNIVERSALAPP.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### control List Box clasificada/sin clasificar
<a name="control_list_box_clasificadasin_clasificar_ELTPARAGRAPHE000261"></a>

- Si se clasifica el control List Box, el nuevo elemento se inserta según el orden de clasificación.

- Si el control List Box no está clasificado, el nuevo elemento se añade al final de la lista.




El tipo de control (ordenado o no) se elige durante el control description (pestaña "Detalles").

Utilice **ListAdd** en lugar de [ListInsert](../WDLang1/3049002.md) para añadir un elemento a un control List Box ordenado.

<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Personalizar los elementos que se encuentran en un List Box o control Combo Box
<a name="personalizar_los_elementos_que_encuentran_list_box_control_combo_box_ELTPARAGRAPHE000286"></a>

Para personalizar los elementos de un cuadro de lista o control Combo Box (color de fondo, imagen, diseño), utilice [Funciones de gestión de cadenas gráficas](../WDLang1/3029028.md).
<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Tabulaciones: Multi-elemento control List Box
<a name="tabulaciones_multielemento_control_list_box_ELTPARAGRAPHE000300"></a>Para gestionar las tabulaciones en un control List Box (alineación de columnas), utilice la constante *TAB*. Por ejemplo:

```wl
ListAdd(LIST_Customer, LastName + TAB + FirstName)
```
En este ejemplo, todos los nombres comienzan en la misma posición y están alineados uno debajo del otro.<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=LISTETABULATION.gif)
**Observación**: La posición de las tabulaciones se define al llamar a la función **ListAdd** por primera vez. Estas posiciones se tomarán como reference para todos los valores añadidos a partir de entonces. Del mismo modo, si se han tecleado valores introducidos en el editor, las posiciones de estos valores se toman como reference. Durante la primera llamada a **ListAdd**, se aconseja definir el ancho de las columnas con [Complete](../WDLang1/3024010.md). Por ejemplo, para fijar el ancho de las columnas que se encuentran en "CLIENTES" en 10 caracteres:

```wl
ListAdd(LIST_Customer, Complete(LastName, 10) + TAB + Complete(FirstName, 10))
```

<a name="NOTE0_7"></a>
<a name="NOTE0_8"></a>


### Varios
<a name="varios_ELTPARAGRAPHE000364"></a>

- Para añadir elementos a una control Tabla, utilice [TableAdd](../WDLang1/3074017.md).

- La función **ListAdd** puede utilizarse en:

	- una columna de tipo "Combo Box" en una control Tabla. 

	- a "Mesa" control Combo Box.







<a name="XComponent"></a>

## Componente:
wd280obj.dll
