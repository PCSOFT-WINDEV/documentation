


## TableAdd (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Agrega una fila en: 

- un control Tabla, 

- un control Tabla TreeView, 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) un control Combo Box "con tabla" (control Tabla mostrado en un control Combo Box).




**Observación**: Se recomienda utilizar la función [TableAddLine](../WDLang1/3074006.md). La función [TableAddLine](../WDLang1/3074006.md) permite agregar:

- TAB en las columnas, 

- todo tipo de valores en las columnas, 

- datos UNICODE de forma automática y sin conversión.





<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Add "Moore", "Vince" and "06/21/72"
// at the end of the "TABLE_CustomerTable" control
ResAdd = TableAdd(TABLE_CustomerTable, "Moore" + TAB + "Vince" + TAB + "06/21/72")
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = TableAdd(<Table control> [, <Row>])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se agregó el elemento,

- <u><u><u><u>False</u></u></u></u> en caso contrario.




**`<Table control>: (Nombre del control)`**

Nombre del control a manipular. Este control puede corresponder a: 

- un control Tabla.

- un control Tabla TreeView. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) un control Combo Box con tabla.


Si este parámetro corresponde a una cadena vacía (""), se utilizará el control al que pertenece el evento actual.

**`<Row>: (Cadena de caracteres opcional)`**

Fila a agregar. Esta fila tiene el siguiente formato: 

```txt
<Element of column 1> + TAB + <Element of column 2> + TAB + ...
```

Si no se especifica este parámetro, se agregará una fila vacía en el control.. Para un control basado en un archivo de datos, se tienen en cuenta los valores predeterminados definidos en el archivo de datos relacionado.  



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Condiciones de uso
<a name="condiciones_uso_ELTPARAGRAPHE000124"></a>

La función **TableAdd** puede utilizarse en:

- una Tabla o control Tabla TreeView basada en un archivo de datos.

- una Tabla o control Tabla TreeView rellenada programáticamente.

- un control de selección única o de selección múltiple.
	



<a name="NOTE0_2"></a>


### Características de una fila
<a name="caracteristicas_una_fila_ELTPARAGRAPHE000165"></a>

- Cada elemento agregado se convierte en el tipo de columna relacionada.

- Para no especificar ningún valor para un elemento, utilice una cadena vacía ("") o 0 (según el tipo de columna).. Por ejemplo:
	
	```wl
	TableAdd(TABLE_CustomerTable, "Moore" + TAB + "Vince" + TAB + "" + TAB + "06/21/72")
	```


- Si un elemento corresponde al resultado de un cálculo, la expresión numérica debe estar entre paréntesis.. Por ejemplo:
	
	```wl
	TableAdd(TABLE_CalcTable, (53+29) + TAB + (83-21))
	```




<a name="NOTE0_3"></a>


### Posición de la fila agregada
<a name="posicion_fila_agregada_ELTPARAGRAPHE000190"></a>

De forma predeterminada, la fila se agrega al final de las filas que se muestran en el control.

Caso especial: 

- Si se ordena el control con la función [TableSort](../WDLang1/3074035.md), la fila agregada se posiciona en el control de acuerdo con el orden que se haya definido.

- Si es el usuario quien ordena el control, el orden no se tiene en cuenta al insertar la fila.. La fila se agrega al final del control.



<a name="NOTE0_4"></a>


### Limitaciones: Número máximo de filas mostradas
<a name="limitaciones_numero_maximo_filas_mostradas_ELTPARAGRAPHE000207"></a>

El número máximo de filas que se pueden mostrar en un control Tabla o Tabla TreeView está limitado por la cantidad de memoria disponible (máximo teórico: 2 mil millones de filas).

Sin embargo, no se recomienda utilizar controles Tabla o Tabla TreeView con un gran número de filas por motivos de rendimiento y facilidad de uso (por ejemplo, el tiempo necesario para rellenar el control).
<a name="NOTE0_5"></a>


### Varios
<a name="varios_ELTPARAGRAPHE000218"></a>

- Para agregar una fila en una posición específica de un control Tabla o Tabla TreeView, utilice la función [TableInsertLine](../WDLang1/3074026.md).

- Si la fila agregada es la primera fila del control, esta fila se convierte en la fila activa.



<a name="NOTE0_6"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) 

### Agregar filas
<a name="agregar_filas_ELTPARAGRAPHE000233"></a>

La propiedad [NewLine](../Proprietes/2510073.md) permite determinar si la fila actual se creó con la función **TableAdd** (NewLine = <u><u><u><u>True</u></u></u></u>).
<a name="NOTE0_7"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) 

### Entrada en cascada
<a name="entrada_cascada_ELTPARAGRAPHE000253"></a>

Para realizar una entrada en cascada, utilice la función **TableAdd** en el evento "Salida de una fila" del control Tabla de la siguiente manera:

```wl
IF TABLE_CustomerTable.NewLine THEN
	TableAdd(TABLE_CustomerTable)
END
```

<a name="NOTE0_8"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) 

### Control Tabla o Tabla TreeView basado en un archivo de datos : Modificaciones en el archivo de datos relacionado
<a name="control_tabla_tabla_treeview_basado_archivo_datos_modificaciones_archivo_datos_relacionado_ELTPARAGRAPHE000276"></a>

- **Si la entrada en cascada está habilitada**, el archivo de datos relacionado con el control se modifica automáticamente cuando el usuario pasa a la siguiente fila.

- **Si la entrada en cascada no está habilitada**, el archivo de datos relacionado con el control no se modifica. Para escribir el contenido de la nueva fila en el archivo de datos relacionado, utilice la función [TableSave](../WDLang1/3074008.md) después de la función **TableAdd**.




**Observaciones**: 

- La opción "Entrada en cascada (Agregar)" puede seleccionarse en la pestaña "Detalles" de la descripción del control.

- ![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) La entrada en cascada no está disponible en controles Tabla basados en un archivo de datos con acceso directo. Esta opción solo está disponible para controles Tabla rellenado mediante programación y controles Tabla basados en un archivo de datos cargado en memoria.



<a name="NOTE0_9"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png) 

### Control Tabla o Tabla TreeView basado en un archivo de datos : Agregar varias filas
<a name="control_tabla_tabla_treeview_basado_archivo_datos_agregar_varias_filas_ELTPARAGRAPHE000309"></a>

Cada vez que se llama a la función **TableAdd** en un control Tabla o Tabla TreeView basado en un archivo de datos, se crea una fila virtual en el control. La información se guardará en el archivo de datos relacionado solo cuando se llame a la función [TableSave](../WDLang1/3074008.md).

Si se llama a la función **TableAdd** sucesivamente en el mismo proceso sin llamar a la función [TableSave](../WDLang1/3074008.md), solo la PRIMERA llamada es efectiva (las siguientes llamadas son ignoradas). Solo se agrega una fila al control Tabla/Tabla TreeView basado en un archivo de datos.

<a name="NOTE0_10"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Agregar un registro en un control Tabla basado en un archivo de datos y ejecutar un trigger
<a name="agregar_registro_control_tabla_basado_archivo_datos_ejecutar_trigger_ELTPARAGRAPHE000335"></a>

Se puede liberar un disparador cuando se añade una Record en una control Tabla basada en un archivo de datos. Para obtener más información, consulte la documentación de [HDescribeTrigger](../WDLang4/3044074.md).

<a name="NOTE0_11"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Java](https://doc.pcsoft.fr/ext/images/us/JAVA.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 

### Control Tabla\\Tabla TreeView basado en un archivo de datos en modo de edición
<a name="control_tablatabla_treeview_basado_archivo_datos_modo_edicion_ELTPARAGRAPHE000352"></a>

Si se llama a la función **TableAdd**:

- En un evento del control, el cursor se posiciona automáticamente en la primera columna editable de la nueva fila.

- En un evento que no pertenece al control (o en otro proceso), utilice la función [SetFocusAndReturnToUserInput](../WDLang1/1410088107.md) para reanudar la entrada en el control Tabla o Tabla TreeView.



<a name="NOTE0_12"></a>


### Agregar imágenes
<a name="agregar_imagenes_ELTPARAGRAPHE000369"></a>

Para agregar una imagen a una Tabla o Tabla TreeView: 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) indique directamente el nombre y la ruta completa de la imagen que se agregará.
	Por ejemplo:
	
	```wl
	TableAdd(TABLE_MyTable, "C:\MyDocuments\MyImage.BMP")
	```



**Observación**: La columna debe ser de tipo Imagen, de lo contrario, la imagen agregada no se mostrará correctamente.
<a name="NOTE0_13"></a>


### Gestión de Unicode
<a name="gestion_unicode_ELTPARAGRAPHE000596"></a>

Puede definir cómo se gestionará Unicode en la configuración del proyecto (pestaña "Unicode" de la ventana de configuración de description): 

- Si se selecciona la opción "Utilizar cadenas ANSI en ejecución".: los datos se convierten utilizando el carácter actual set. 
	Recordatorio: [ChangeCharset](../WDLang1/3054001.md) cambia el carácter actual set.

- Si se selecciona "Utilizar cadenas UNICODE en ejecución", los datos se insertan sin ser convertidos.




<a name="XComponent"></a>

## Componente:
wd280obj.dll
