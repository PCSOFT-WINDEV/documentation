


## TableInsertLineWithAnimation (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Inserta un fila en un control Tabla o en un control Tabla TreeView con una animación.. La duración de esta animación se puede configurar: 

- en la pestaña "Estilo" de la ventana de control Tabla description: 

	- En la pestaña "Estilo", seleccione el elemento "Animación de control".

	- En la lista de animaciones, seleccione "Modification by TableXXXWithAnimation()" y haga clic en el botón "Parameters"..  




- en la ventana de description del proyecto: 

	- En la pestaña "avanzado", haga clic en "Animación de controles". 

	- En la sección "Control Tabla y Looper", seleccione "Modificación por TableXXXWithAnimation()" y haga clic en el botón "Parámetros".







**Observaciones**: 

- Para añadir elementos al final de una control Tabla, utilice [TableAddLine](../WDLang1/3074006.md) o [TableAddLineWithAnimation](../WDLang1/1000022402.md).

- Para agregar filas dentro de una jerarquía (control Tabla TreeView), utilice la función [TableInsertChild](../WDLang1/1000010005.md).



<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Insert the "Vince" and "Moore" elements into the fifth
// row of  the Table control "TABLE_CustomerTable"
TableInsertLineWithAnimation(TABLE_CustomerTable, 5, "Vince", "Moore")
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`TableInsertLineWithAnimation(<Table control> [, <Index> [, <Element column 1> [... [, <Element column N>]]]])`
---

**`<Table control>: (Nombre del control)`**

Nombre del control a manipular. Este control puede corresponder a: 

- un control Tabla.

- un control Tabla TreeView. 


Si este parámetro corresponde a una cadena vacía (""), el control utilizado será el control al que pertenece el actual Event.

**`<Index>: (Entero opcional)`**

Índice de la fila en la que se insertarán los elementos. El índice de la primera fila es 1.


|   |   |
| --- | --- |
| Índice no especificado | La fila se inserta antes de la fila seleccionada. Si no se selecciona fila, el fila se inserta en la parte inferior del control. |
| Índice mayor que el número de filas de control | La fila se inserta al final del control. |
| Índice igual a 0 | La fila se inserta al inicio del control. |
| Índice igual a -1 | La fila se inserta antes de la fila seleccionada. |



**`<Element column 1>: (Tipo de columna associated (opcional))`**

Los primeros elementos de fila que se insertarán en el control especificado. Cada elemento corresponde a una columna control. El tipo de elemento insertado debe ser compatible con el tipo de columna relevante..
Si no se especifica ninguno de estos parámetros, se añade un fila vacío en el control. Para un control basado en un archivo de datos, se tienen en cuenta los valores predeterminados definidos en el archivo de datos relacionado.



**`<Element column N>: (Tipo de columna associated (opcional))`**

Nth fila elementos que se insertarán en el control especificado. Cada elemento corresponde a una columna control. El tipo de elemento insertado debe ser compatible con el tipo de columna relevante..
Si no se especifica ninguno de estos parámetros, se añade un fila vacío en el control. Para un control basado en un archivo de datos, se tienen en cuenta los valores predeterminados definidos en el archivo de datos relacionado.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Condiciones de uso
<a name="condiciones_uso_ELTPARAGRAPHE000116"></a>

La función **TableInsertLineWithAnimation** puede utilizarse en:

- una Tabla o control Tabla TreeView basada en un archivo de datos.

- una Tabla o control Tabla TreeView rellenada programáticamente.

- un control de selección única o de selección múltiple. 




La animación no se reproduce en los siguientes casos: 

- si las animaciones están desactivadas ([AnimaciónPermitida](../WDLang1/1000017399.md)).

- si la función se utiliza en los siguientes procesos de ventana: "Declaraciones globales", "Fin de la inicialización" o "Cierre".

- si la aplicación está en modo TSE. 

- si la inserción se realiza fuera del área de Visible (abajo o Above). En este caso, la inserción se realiza y la función devuelve a control inmediatamente.


La función devuelve a control sólo al final de la animación.
<a name="NOTE0_2"></a>


### Características de los elementos fila
<a name="caracteristicas_los_elementos_fila_ELTPARAGRAPHE000143"></a>

- Para especificar ningún valor para uno de los elementos, utilice una cadena vacía ("") o 0 (dependiendo del tipo de columna).

- Si un elemento corresponde al resultado de un cálculo, la expresión numérica debe estar entre paréntesis.. Por ejemplo:
	
	```wl
	TableInsertLineWithAnimation(TABLE_CustomerTable, 3, (53+29), (83-21))
	```




<a name="NOTE0_3"></a>


### Posición de la fila insertada
<a name="posicion_fila_insertada_ELTPARAGRAPHE000160"></a>

De manera predeterminada, la fila se inserta en la posición indicada.

Casos especiales: 

- Si el control está ordenado con [TableSort](../WDLang1/3074035.md), el nuevo fila se posiciona según la ordenación actual y no el índice especificado.

- Si es el usuario quien ordena el control, el orden no se tiene en cuenta al insertar la fila.. La fila se inserta en la posición indicada.



<a name="NOTE0_4"></a>


### Limitaciones: Número máximo de filas mostradas
<a name="limitaciones_numero_maximo_filas_mostradas_ELTPARAGRAPHE000395"></a>

El número máximo de filas que se pueden mostrar en un control Tabla o Tabla TreeView está limitado por la cantidad de memoria disponible (máximo teórico: 2 mil millones de filas). 

Sin embargo, no se recomienda utilizar controles Tabla o Tabla TreeView con un gran número de filas por motivos de rendimiento y facilidad de uso (por ejemplo, el tiempo necesario para rellenar el control).
<a name="NOTE0_5"></a>


### Control Tabla o Tabla TreeView basado en un archivo de datos : Modificaciones en el archivo de datos relacionado
<a name="control_tabla_tabla_treeview_basado_archivo_datos_modificaciones_archivo_datos_relacionado_ELTPARAGRAPHE000184"></a>

- **Si la entrada en cascada está activada**, el contenido del archivo de datos relacionado con el control se modifica automáticamente cuando el usuario pasa a la siguiente fila.

- **Si la entrada en cascada no está activada**, el contenido del archivo de datos relacionado con el control no se modifica.. Para escribir el contenido de la fila insertada en el archivo de datos relacionado, se debe utilizar la función [TableSave](../WDLang1/3074008.md) después de la función **TableInsertLineWithAnimation**. 




**Observación**: La opción "Entrada en cascada (Agregar)" puede seleccionarse en la pestaña "Detalles" de la descripción del control.
<a name="NOTE0_6"></a>


### Control Tabla o Tabla TreeView basado en un archivo de datos : Insertar varias filas
<a name="control_tabla_tabla_treeview_basado_archivo_datos_insertar_varias_filas_ELTPARAGRAPHE000205"></a>

Cada vez que se llama a la función **TableInsertLineWithAnimation** en un control Tabla o Tabla TreeView basado en un archivo de datos, se crea una fila virtual en el control. La información se guardará en el archivo de datos al llamar a la función [TableSave](../WDLang1/3074008.md).

Si se llama a la función **TableInsertLineWithAnimation** sucesivamente en el mismo proceso sin llamar a la función [TableSave](../WDLang1/3074008.md), solo la PRIMERA llamada es efectiva (las siguientes llamadas son ignoradas). Solo se agrega una fila al control Tabla/Tabla TreeView basado en un archivo de datos.
<a name="NOTE0_7"></a>


### Control Tabla/Tabla TreeView en edición
<a name="control_tablatabla_treeview_edicion_ELTPARAGRAPHE000226"></a>

Si se llama a la función **TableInsertLineWithAnimation**:

- En un control Event, el cursor se posiciona automáticamente en la primera columna a editar en el fila insertado.

- En un evento que no pertenece al control (o en otro proceso), utilice la función [SetFocusAndReturnToUserInput](../WDLang1/1410088107.md) para reanudar la entrada en el control Tabla o Tabla TreeView.



<a name="NOTE0_8"></a>


### Inserción de imágenes
<a name="insercion_imagenes_ELTPARAGRAPHE000243"></a>

Para insertar una Image en una Tabla o control Tabla TreeView, especifique el nombre y la ruta completa de la Image a insertar.
Por ejemplo:

```wl
TableInsertLineWithAnimation(TABLE_MyTable, 5, "C:\MyDocuments\MyImage.BMP")
```


**Observación**: La columna debe ser una columna Image, de lo contrario el Image insertado no se mostrará correctamente.

<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Código UI
## Componente:
wd280obj.dll
