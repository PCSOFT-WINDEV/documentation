


## &lt;Vista de árbol&gt;.add (función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Añade un elemento "hoja" (y todos los nodos necesarios) a una control TreeView.

Ejemplo de control TreeView: <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Arbre_Vocabulaire.gif)

<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Add the "Ice cream" leaf into the "TREE_TVRecipe" control
Res = TREE_TVRecipe.Add("Recipes" + TAB + ...
		"Desserts" + TAB + "Ice creams", ...
		tvDefault, tvDefault, LeafID)
```

```wl
// Initialize the TreeView control
TREE_TreeView1.Add("Root", tvDefault, tvDefault, "")
TREE_TreeView1.Add("Root" + TAB + "Leaf 1", tvDefault, tvDefault, "1")
TREE_TreeView1.Add("Root" + TAB + "Leaf 2", tvDefault, tvDefault, "2")
TREE_TreeView1.Add("Root" + TAB + "Leaf 3", tvDefault, tvDefault, "3")
TREE_TreeView1.Add("Root" + TAB + "Leaf 4", tvDefault, tvDefault, "4")
TREE_TreeView1.Add("Root" + TAB + "Leaf 2" + TAB + ...
		"Sub Leaf 2-1", tvDefault, tvDefault, "5")
TREE_TreeView1.Add("Root" + TAB + "Leaf 2" + TAB + ...
		"Sub Leaf 2-2", tvDefault, tvDefault, "6")
TREE_TreeView1.Add("Root" + TAB + "Leaf 2" + TAB + ...
		"Sub Leaf 2-3", tvDefault, tvDefault, "7")
TREE_TreeView1.Add("Root" + TAB + "Leaf 2" + TAB + ...
		"Sub Leaf 2-4", tvDefault, tvDefault, "8")
TREE_TreeView1.Add("Root" + TAB + "Leaf 2" + TAB + ...
		"Sub Leaf 2-5", tvDefault, tvDefault, "9")

// Select a TreeView row
TREE_TreeView1.SelectPlus("Root" + TAB + "Leaf 2" + TAB + ...
		"Sub Leaf 2-5")
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = <TreeView control>.Add(<Leaf path> [, <Collapsed image> [, <Expanded image> [, <Leaf identifier> [, <Addition mode> [, <Tooltip text>]]]]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si la hoja se añadió al control TreeView,

- <u><u><u><u>False</u></u></u></u> en caso contrario.




**`<TreeView control>: (Nombre del control)`**

Nombre de la control TreeView a utilizar.

**`<Leaf path>: (Cadena de caracteres)`**

ruta completa de la hoja que se añadirá al control TreeView. Este parámetro tiene el siguiente formato: 

```txt
"<Root name>" + TAB + ["<Name of 1st node>" + TAB + ...
["<Name of 2nd node>" + TAB + [...]]]"<Leaf name>"
```
En caso de duplicados en un elemento ruta, este ruta puede contener el identificador del elemento (especificado después del nombre de la hoja por [TreeID](../WDLang1/3018027.md)).

**`<Collapsed image>: (Cadena de caracteres opcional o constante)`**

Imagen associated con el elemento. Esta Image se muestra cuando el elemento es un nodo colapsado (ver las Notas). En tiempo de ejecución, la leyenda de un nodo colapsado es precedida por "+".

Este parámetro corresponde a:

- el nombre y el apellido completo (o relativo) ruta de Image. Se puede utilizar una ruta de tipo UNC.

- la constante:
	


|   |   |
| --- | --- |
| *nulo* | Ninguna imagen |
| *tvDefault*<br>(Valor predeterminado) | Default Image (carpeta cerrada):![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=imageEnroule.gif) |






**`<Expanded image>: (Cadena de caracteres opcional o constante)`**

Imagen associated con el elemento. Esta Image se muestra cuando el elemento es un nodo expandido (ver Notas). En tiempo de ejecución, el título de un nodo expandido va precedido de "-". 

Este parámetro corresponde a:

- el nombre y el apellido completo (o relativo) ruta de Image. Se puede utilizar una ruta de tipo UNC.

- la constante:
	


|   |   |
| --- | --- |
| *nulo* | Ninguna imagen |
| *tvDefault*<br>(Valor predeterminado) | Default Image (carpeta abierta): ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=imagederoulee.gif) |






**`<Leaf identifier>: (Cadena de caracteres o entero (opcional))`**

Identificar a associated con un elemento específico del control TreeView. Este parámetro corresponde a una cadena vacía ("") de Default. Para asociar un identificador a un elemento ya creado, utilice [&lt;Modificar](../WDLang1/1000023763.md).

**Atención**: El carácter TAB no está permitido en los identificadores de elementos.

**`<Addition mode>: (Constante o combinación de constantes opcional)`**

Posición del elemento añadido (la hoja) en relación con los elementos del mismo nivel en la control TreeView.


|   |   |
| --- | --- |
| *tvAcceptDuplicate* | Los duplicados son aceptados (dos elementos en el mismo nivel pueden tener el mismo nombre). La hoja añadida se inserta en orden alfabético, entre los elementos del mismo nivel. |
| *tvAlphaSort*<br>(Valor predeterminado) | La hoja añadida se inserta en orden alfabético, entre los elementos del mismo nivel. |
| *tvFirst* | La hoja se añade en primera posición de nivel. |
| *tvLast* | La hoja se añade en la última posición de nivelación. |



**`<Tooltip text>: (Cadena de caracteres opcional)`**

Si se especifica este parámetro, su contenido se mostrará en un tooltip cuando el elemento se mueva sobre el cursor del ratón.. Este parámetro corresponde a una cadena vacía ("") de Default. Si no hay un tooltip associated con el elemento, el tooltip associated con el control TreeView se mostrará automáticamente.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Rama de la hoja
<a name="rama_hoja_ELTPARAGRAPHE000299"></a>

Si uno de los niveles superiores para la hoja añadida no existe y si no es associated con un identificador (gestión de duplicados), este nivel se añade automáticamente. Las características de este nuevo nivel (o rama del elemento) son las siguientes:

- imagen colapsada e imagen expandida por defecto (constante *tvDefault*).

- identificador igual a *Nulo*,

- modo de adición correspondiente a la constante *tvLast*.




Se produce un error de WLanguage si uno de los niveles superiores de la hoja es associated con un identificador y si este nivel no existe o si no es associated con este identificador. De hecho, los niveles superiores deben crearse con sus respectivos identificadores antes de que puedan tratarse.
<a name="NOTE0_2"></a>


### Orden de prioridad para la clasificación
<a name="orden_prioridad_para_clasificacion_ELTPARAGRAPHE000315"></a>

El orden de prioridad de los parámetros para el modo Añadir es el siguiente:

- *tvFirst*

- *tvLast*

- *tvAlphaSort*




Por ejemplo, en *tvFirst* + *tvLast* + *tvAlphaSort*, sólo se tiene en cuenta la constante *tvFirst*.
<a name="NOTE0_3"></a>


### Duplicados
<a name="duplicados_ELTPARAGRAPHE000331"></a>

La aceptación de duplicados debe hacerse con mucho cuidado (constante <em><em><em><em>tvAcceptDuplicate</em></em></em></em>. De hecho, debe gestionarse un identificador específico para identificar el nivel en el que debe realizarse la adición.. Para obtener más información, consulte [Gestión de duplicados en los controles de la vista de árbol](../WDChamp/1013325.md).

Pueden ocurrir algunas inconsistencias si no se realiza este manejo.

Por ejemplo: Si existen dos "Nivel 2", ¿a cuál de ellos se añadirá el "Nivel 3"? No hay forma de averiguar qué "Nivel 2" debe utilizarse.. Por Default, la operación de adición se realizará en el primer elemento encontrado.<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=TVDoub.gif)
 Si se añade un elemento que ya existe en un nivel, **&lt;Vista de árbol&gt;.add** devuelve <u><u><u><u>False</u></u></u></u> si el modo de definir el elemento no fue definido con la constante *tvAcceptDuplicate*. El elemento no se añade.
<a name="NOTE0_4"></a>


### Formato de imágenes colapsadas/expandidas
<a name="formato_imagenes_colapsadasexpandidas_ELTPARAGRAPHE000360"></a>

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) Los siguientes formatos de Image están soportados en Windows:

- Mapa de bits (\*.BMP)

- Formato de intercambio de gráficos (\*.gif)

- Grupo Mixto de Expertos en Fotografía (\*.jpg \*;.jpeg)

- CD de fotos Kodak (\*.pcd)

- Pincel de pintura (\*.pcx)

- Formato Adobe Photoshop (\*.psd)

- TrueVision TARGA (\*.tga)

- Etiquetado en el formato de archivo Image (\*.tif ; \*.Tiff)
	Observación: la opción "tiff de mosaico" del estándar tiff 6.0 no está soportada. En este caso, le aconsejamos que guarde el Image en el estándar Tiff 5.0. 

- Gráficos de red portátiles (\*.png)

- MetaFicheros de Windows (\*.emf;\*.wmf)

- Iconos (\*.ico \*;.icw)
	Observaciones: 

	- Pantalla HQ (High Quality) disponible.

	- Manejo de hojas en formato Transparent BMP (32 bits).




- Cursores (\*.cur)

- Formato portátil de Document (\*.pdf)

- Gráficos vectoriales escalables (\*.svg)

- WINDEV Image s (generado por el editor de Image, \*.WDPic).





### Tipo de imágenes colapsadas/expandidas
<a name="tipo_imagenes_colapsadasexpandidas_ELTPARAGRAPHE000406"></a>

Las imágenes utilizadas pueden ser:

- Archivos de Image,

- elementos de un archivo de datos HFSQL "Binary Memo" que contiene un archivo Image.

- dibujos creados por la [funciones de gestión de cadenas gráficas](../WDLang1/3029028.md).




La Image especificada se redimensiona proporcionalmente a 16 x 16 píxeles: en la mayoría de los casos, la altura de la Image corresponde a la altura del TreeView fila.
**Observación**: El tamaño de las imágenes debe ser de set a 16 x 16 píxeles (tamaño de los iconos pequeños).
<a name="NOTE0_5"></a>


### Consejo sobre las imágenes de las ramas
<a name="consejo_sobre_las_imagenes_las_ramas_ELTPARAGRAPHE000432"></a>

Atención: Si el nombre de Image no cambia entre dos llamadas a **&lt;Vista de árbol&gt;.add**, el Image no se recarga en memoria (aunque su contenido haya cambiado).

**Ejemplo**: El siguiente código crea una Image con el mismo nombre y con un contenido diferente, y utiliza esta Image para cada llamada a **&lt;Vista de árbol&gt;.add**: en este caso, siempre se usará el mismo Image.

```wl
FOR I = 1 TO 10
	// Procedure used to create an xx.BMP image file
	// The content changes at each iteration
	CreateImage(I)
	TREE_MyTreeView.Add("xx", "xx.BMP")
END
```


**Solución**: Para usar la Image adecuada, debes dar un nuevo nombre cada vez que se crea un nuevo Image. Por ejemplo:

```wl
FOR I = 1 TO 10
	// Procedure used to create an image file 
	// whose type is "xx" + I + ".BMP"
	// The content changes at each iteration
	CreateImage(I)
	TREE_MyTreeView.Add("xx", "xx" + I + ".BMP")
END
```


<a name="XComponent"></a>

## Componente:
wd280obj.dll
