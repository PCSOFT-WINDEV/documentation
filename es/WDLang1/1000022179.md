


## &lt;Tabla dinámica&gt;.CalculateUpdate (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Actualiza algunos de los datos encontrados en un control Tabla dinámica a partir de una fecha determinada.. 

**Observaciones**: 

- El contenido de la control Tabla dinámica se ha cargado previamente en la memoria mediante [&lt;Tabla dinámica&gt;.Load](../WDLang1/1000022181.md). 

- La control Tabla dinámica incluye una columna Fecha, fila o filtro de visualización..



<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Builds the file name
sFile = SysDir(srAppData) + ["\"] + "StatsByCountry.tcd"

// The file exists?
IF fFileExist(sFile) THEN
	// Yes, load it 
	PVT_Statistics.Load(sFile)
	// Update the Pivot Table control from the last calculation date
	// (we assume that the records associated with an earlier date
	// have not been modified)
	PVT_Statistics.CalculateUpdate(LoadParameter(DATE_LAST_CALCULATION))
ELSE
	// The file does not exist, calculate it
	PVT_Statistics.CalculateAll()
END
```

<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX1"></a>

`<Pivot Table control>.CalculateUpdate([<Start date>])`
---

**`<Pivot Table control>: (Nombre del control)`**

Nombre del control Tabla dinámica a utilizar.

**`<Start date>: (Cadena de caracteres opcional o Fecha Variable)`**

Fecha a partir de la cual se debe volver a calcular el contenido de la control Tabla dinámica. Esta fecha debe estar en formato "AAAAMMDD".. Se tendrán en cuenta todos los registros associated con un ítem de Fecha cuyo contenido corresponda a una fecha mayor que &lt;Fecha de inicio&gt;.

Si no se especifica este parámetro, la fecha que se tiene en cuenta corresponde a la fecha máxima del último resultado calculado o leído por [&lt;Tabla dinámica&gt;.Load](../WDLang1/1000022181.md).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Modo de cálculo
<a name="modo_calculo_ELTPARAGRAPHE000189"></a>

Los registros que se tienen en cuenta para el recálculo tienen las siguientes características: 

- Los registros incluyen un elemento Fecha. 

- El contenido del elemento Fecha es mayor o igual que el valor de &lt;Fecha de inicio&gt;.. 




Los valores anteriores encontrados en el control Tabla dinámica (si los hay) se borran del control Tabla dinámica desde &lt;Start date&gt;.

El cálculo puede ser bastante largo si se debe leer un volumen importante de datos.. En este caso, se muestra una barra de progreso en la control.

Al final del cálculo, se muestra la nueva tabla dinámica. A continuación, el resultado puede ser guardado por [&lt;Pivot tabla&gt;.Save](../WDLang1/1000022189.md).
<a name="NOTE0_2"></a>


### ¿Cuándo utilizar la función **&lt;Tabla dinámica&gt;.CalculateUpdate**?
<a name="¿cuando_utilizar_funcion_docparampagetitleshort_ELTPARAGRAPHE000213"></a>

**&lt;Tabla dinámica&gt;.CalculateUpdate** debe utilizarse cuando los datos son fijos: facturas, por ejemplo. Sólo tiene la posibilidad de añadir nuevas facturas. En este caso, la fecha de recálculo coincide con la fecha en la que se grabó el contenido de la control Tabla dinámica.. 

Si los datos visualizados en el control Tabla dinámica son modificables (una cantidad, un precio, etc.), debe hacerlo:: 

- recalcular completamente el control Tabla dinámica. 

- recalcular el control Tabla dinámica a partir de la fecha correspondiente al Record modificado.




<a name="XComponent"></a>

## Componente:
wd280obj.dll
