
## Centro de Control HFSQL: HFSQL Client/Server copias de seguridad
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000190"></a>
El HFSQL control Center se utiliza para gestionar las copias de seguridad de los archivos de datos de HFSQL Client/Server.

Las copias de seguridad pueden ser:

- completo: en este caso, todos los elementos seleccionados (servidor completo, bases de datos o archivos) se guardan por completo. Esta copia de seguridad es más segura porque es suficiente para restaurar los elementos. Es más largo de realizar porque todo está guardado.

- diferencial: en este caso, sólo se guardan las diferencias en relación con una copia de seguridad completa. Esta copia de seguridad es más rápida de realizar y menos voluminosa. Debe almacenarse con la copia de seguridad completa que le corresponde.






<a name="NOTE2B"></a>
<a name="NOTE2B_1"></a>


## ¿Cómo proceder?
<a name="¿como_proceder_ELTTEXTE000220"></a>


### Realización de una copia de seguridad
<a name="realizacion_una_copia_seguridad_ELTPARAGRAPHE000027"></a>

**Observación**: Las copias de seguridad realizadas según este método son necesariamente copias de seguridad completas. Las copias de seguridad diferenciales sólo se pueden realizar mediante copias de seguridad programadas.

Para realizar una copia de seguridad: 

1. Conectarse (si es necesario) a un servidor HFSQL. 

2. Haga doble clic en el nombre del servidor HFSQL en la estructura de árbol. 

3. La sección derecha del Centro control muestra una pestaña con el nombre del servidor. 

4. Haga clic en la pestaña "Copias de seguridad".

5. En la cinta, en el grupo "Copias de seguridad", expanda "Nueva copia de seguridad" y seleccione "Nueva copia de seguridad en caliente".. Comienza la asistente para crear una copia de seguridad.

6. Especifique el contenido de la copia de seguridad:

	- Todo el contenido del servidor.

	- Una base de datos específica.

	- Una selección de bases de datos y/o archivos de datos.




7. Ir al siguiente paso de la asistente y especificar las opciones de copia de seguridad: 

	- si el resultado de la copia de seguridad debe comprimirse en un archivo zip. 

	- si la copia de seguridad debe contener los archivos de índice (archivos de índice NDX y archivos de índice de texto completo FTX). Si no se guardan los archivos índice, el tamaño de la copia de seguridad se reducirá, pero el tiempo de restauración será mayor.. Observación: si los archivos de índice no se guardan, las contraseñas de los archivos deben especificarse durante la operación de restauración para permitir su reindexación.




8. Pase a la etapa siguiente del asistente. 

9. Indique la ubicación de la copia de seguridad indicando el directorio de copia de seguridad. Si este nombre corresponde a un ruta relativo, la copia de seguridad se realizará en el subdirectorio "Backup" del servidor HFSQL. La asistente se utiliza para definir un subdirectorio de "backup" ("Backups" de Default). La fecha y la hora (en formato "Año\\Mes\\Día\\Tiempo-Minuto") se pueden añadir al nombre del directorio para identificar fácilmente la copia de seguridad..
	Observación: Las copias de seguridad se realizan en un subdirectorio numerado ("backup\\Backups\\1" por ejemplo). Por lo tanto, si se realizan varias copias de seguridad, los archivos correspondientes no serán sobrescritos por una nueva copia de seguridad.

10. Pase a la etapa siguiente del asistente. 

11. Especificar las acciones associated con la copia de seguridad: 

	- Almacena Procedure antes o después de la copia de seguridad: En este caso, el siguiente paso de la asistente es especificar:

		- el nombre de la base de datos que contiene el Procedure almacenado para ejecutarlo,

		- el nombre del conjunto de Procedure s que contiene el Procedure almacenado para ejecutar,

		- el nombre del procedimiento a ejecutar.




- Webhook ejecutado después de la copia de seguridad: En este caso, el siguiente paso de la asistente es especificar la URL del webhook (servicio REST) a la que se debe enviar el resultado de la copia de seguridad. 

12. Déle un description a su copia de seguridad y valídelo.

13. La copia de seguridad se inicia automáticamente. El progreso de la copia de seguridad se puede supervisar en el HFSQL control Center.




**Observación**: También tiene la posibilidad de realizar una copia de seguridad desde la pestaña "Copias de seguridad" de una base de datos seleccionada en la vista en árbol a la izquierda de la pantalla.


### Realización de una copia de seguridad programada
<a name="realizacion_una_copia_seguridad_programada_ELTPARAGRAPHE000070"></a>

Para realizar una copia de seguridad programada: 

1. Conectarse (si es necesario) a un servidor HFSQL. 

2. Haga doble clic en el nombre del servidor HFSQL en la estructura de árbol. 

3. La sección derecha del Centro control muestra una pestaña con el nombre del servidor. 

4. Haga clic en la pestaña "Copias de seguridad".

5. En la cinta, en el grupo "Copias de seguridad", expanda "Nueva copia de seguridad" y seleccione "Nueva copia de seguridad programada".. Comienza la asistente para crear una copia de seguridad.

6. Especifique el contenido de la copia de seguridad: todo el contenido del servidor, una base de datos específica, una selección de bases de datos y/o archivos.

7. Ir al siguiente paso de la asistente y especificar las opciones de copia de seguridad: 

	- si el resultado de la copia de seguridad debe comprimirse en formato zip.

	- si la copia de seguridad debe contener los archivos de índice (archivos de índice NDX y archivos de índice de texto completo FTX). Si no se guardan los archivos índice, el tamaño de la copia de seguridad se reducirá, pero el tiempo de restauración será mayor.. Observación: si los archivos de índice no se guardan, las contraseñas de los archivos deben especificarse durante la operación de restauración para permitir su reindexación.




8. Pase a la etapa siguiente del asistente. 

9. Seleccione un escenario de programación entre los escenarios predefinidos. También puede elegir una programación personalizada. En este caso, los siguientes pasos de la asistente le guiarán a través de la Definition del programa.

10. Pase a la etapa siguiente del asistente. 

11. Indique la ubicación de la copia de seguridad indicando el directorio de copia de seguridad. Si este nombre corresponde a un ruta relativo, la copia de seguridad se realizará en el subdirectorio "Backup" del servidor HFSQL. La asistente se utiliza para definir un subdirectorio de "backup" ("Backups" de Default). La fecha y la hora (en formato "Año\\Mes\\Día\\Tiempo-Minuto") se pueden añadir al nombre del directorio para identificar fácilmente la copia de seguridad..
	Observación: Las copias de seguridad se realizan en un subdirectorio numerado ("backup\\Backups\\1" por ejemplo). Por lo tanto, si se realizan varias copias de seguridad, los archivos correspondientes no serán sobrescritos por una nueva copia de seguridad.

12. Pase a la etapa siguiente del asistente. 

13. Especificar las acciones associated con la copia de seguridad: 

	- Almacena Procedure antes o después de la copia de seguridad: En este caso, el siguiente paso de la asistente es especificar:

		- el nombre de la base de datos que contiene el Procedure almacenado para ejecutarlo,

		- el nombre del conjunto de Procedure s que contiene el Procedure almacenado para ejecutar,

		- el nombre del procedimiento a ejecutar.




- Webhook ejecutado después de la copia de seguridad: En este caso, el siguiente paso de la asistente es especificar la URL del webhook (servicio REST) a la que se debe enviar el resultado de la copia de seguridad. 

14. Especifique si desea limitar el número de copias de seguridad almacenadas en el servidor.

15. Déle un description a su copia de seguridad y valídelo.

16. La copia de seguridad se iniciará automáticamente de acuerdo con la programación especificada.. El progreso de la copia de seguridad se puede supervisar en el HFSQL control Center.



<a name="NOTE2B_2"></a>


### Operaciones en las copias de seguridad
<a name="operaciones_las_copias_seguridad_ELTPARAGRAPHE000110"></a>

El Centro control de HFSQL le permite manipular las copias de seguridad existentes. Es posible:

- Realice una copia de seguridad.

- Restaurar una copia de seguridad.

- Restaurar una copia de seguridad encontrada en un directorio específico.

- Eliminar una copia de seguridad. Para eliminar una copia de seguridad, debe ser un "superusuario".

- Reiniciar una copia de seguridad (opción disponible en "Otras acciones"). 

- Recuperar una copia de seguridad en el ordenador cliente (opción disponible en "Otras acciones"). 




Para realizar estas operaciones: 

1. Conectarse (si es necesario) a un servidor HFSQL. 

2. Haga doble clic en el nombre del servidor HFSQL en la estructura de árbol. 

3. La sección derecha del Centro control muestra una pestaña con el nombre del servidor.

4. Seleccione la pestaña "Copias de seguridad".

5. Seleccione la copia de seguridad a manipular. 

6. Las opciones específicas de la gestión de copias de seguridad se encuentran en el grupo "Copias de seguridad" de la cinta.. Se utilizan para: 

	- crear una nueva copia de seguridad (copia de seguridad en caliente o programada),

	- reiniciar una copia de seguridad,

	- restaurar una copia de seguridad,

	- eliminar una copia de seguridad,

	- recuperar una copia de seguridad. Esta opción está disponible para las copias de seguridad realizadas en el formato de un archivo ZIP solamente.. Todo lo que tiene que hacer es especificar la ubicación donde se guardará el archivo de copia de seguridad. 







<a name="NOTE3"></a>
<a name="NOTE3_1"></a>




## Observaciones
<a name="observaciones_ELTTEXTE000291"></a>


### Características de la copia de seguridad
<a name="caracteristicas_copia_seguridad_ELTPARAGRAPHE000257"></a>

La copia de seguridad realizada corresponderá al estado de la base de datos al inicio de la copia de seguridad.

Durante la copia de seguridad, no se le permite hacerlo:

- borrar los archivos de datos y las bases de datos,

- actualizar los procedimientos almacenados.   



<a name="1000017308_NOTE4_2"></a>


### Gestión de un Procedure antes y/o después
<a name="gestion_procedure_antes_despues_ELTPARAGRAPHE000269"></a>

Es posible llamar a un Procedure almacenado antes o después de la copia de seguridad. Estos procedimientos pueden tomar parámetros. 

**Gestión de un procedimiento antes**: 
El Procedure almacenado llamado ANTES de la copia de seguridad puede tomar parámetros. Este procedimiento tiene el siguiente formato: 


```txt
PROCEDURE <Procedure name>(<Data to back up>, ...
		<Backup destination>, <Description>)
```
Estos parámetros son opcionales. Le permitirán a manipular las siguientes indicaciones en el código del Procedure almacenado:

- ***&lt;Datos para respaldar&gt;**'STRIMEULD: Cadena de caracteres correspondiente a la información a respaldar. Corresponde a la propiedad **Source**. Los valores posibles son los siguientes:
	


|   |   |
| --- | --- |
| *\** | Hace una copia de seguridad copy de todas las bases de datos del servidor, los registros, las bases de datos del sistema (usuarios, grupos, derechos). |
| *Nombre de la base de datos1/Nombre Archivo1 + TAB + Nombre de la base de datos 2/Nombre Archivo2 +...* | Lista de elementos a respaldar. El separador puede ser la tabulación (TAB) o el punto y coma (";"). |
| *Nombre de la base de datos/\** | Hace una copia de seguridad de toda la base de datos de copy: archivos, enlaces, procedimientos almacenados, disparadores. |
| *Nombre de la base de datos/Nombre Archivo1* | Hace una copia de seguridad de copy de &lt;Nombre del archivo1&gt; que se encuentra en &lt;Nombre de la base de datos&gt; |
| *sistema* | Hace una copia de seguridad copy de las bases de datos del sistema (usuarios, grupos, derechos). |



- ******&lt;Destino de la copia de seguridad&gt;**'HTRIMEULCHTRIMEULTRIMEULB: Nombre y destino de la copia de seguridad. Corresponde a la propiedad **Destination**. La copia de seguridad se realizará en el servidor, en una ubicación definida por este nombre. Si este nombre corresponde a un ruta relativo, la copia de seguridad se colocará en el subdirectorio "Backup" del servidor HFSQL. Para especificar:

	- el directorio del servicio Manta, utilice la cadena de caracteres "%%EXE%%".

	- el año, utilice la cadena de caracteres "%%YEAR%%" (2008, por ejemplo).

	- el mes en 2 dígitos, utilice la cadena de caracteres "%%MONTH%%" (03 por ejemplo).

	- el día, utilice la cadena de caracteres "%%DAY%%%".

	- la hora, utilice la cadena de caracteres "%%HOUR%%".

	- los minutos, utilice la cadena de caracteres "%%MINUTE%%".




- ***&lt;description&gt;***: Copia de seguridad de description. Corresponde al **description** Property.




**Manejo de un Procedure después de**: 
El Procedure almacenado llamado DESPUÉS de la copia de seguridad puede tomar parámetros. Este procedimiento tiene el siguiente formato: 


```txt
PROCEDURE <Procedure name>(<Data to back up>, <Backup destination>, ...
			<Description>, <Status>, <Error message>)
```
Estos parámetros son opcionales. Le permitirán a manipular las siguientes indicaciones en el código del Procedure almacenado:

- ***&lt;Datos para respaldar&gt;**'STRIMEULD: Cadena de caracteres correspondiente a la información a respaldar. Corresponde a la propiedad **Source**. Los valores posibles son los siguientes:
	


|   |   |
| --- | --- |
| *\** | Hace una copia de seguridad copy de todas las bases de datos del servidor, los registros, las bases de datos del sistema (usuarios, grupos, derechos). |
| *Nombre de la base de datos1/Nombre Archivo1 + TAB + Nombre de la base de datos 2/Nombre Archivo2 +...* | Lista de elementos a respaldar. El separador puede ser la tabulación (TAB) o el punto y coma (";"). |
| *Nombre de la base de datos/\** | Hace una copia de seguridad de toda la base de datos de copy: archivos, enlaces, procedimientos almacenados, disparadores. |
| *Nombre de la base de datos/Nombre Archivo1* | Hace una copia de seguridad de copy de &lt;Nombre del archivo1&gt; que se encuentra en &lt;Nombre de la base de datos&gt; |
| *sistema* | Hace una copia de seguridad copy de las bases de datos del sistema (usuarios, grupos, derechos). |



- ******&lt;Destino de la copia de seguridad&gt;**'HTRIMEULCHTRIMEULTRIMEULB: Nombre y destino de la copia de seguridad. Corresponde a la propiedad **Destination**. La copia de seguridad se realizará en el servidor, en una ubicación definida por este nombre. Si este nombre corresponde a un ruta relativo, la copia de seguridad se colocará en el subdirectorio "Backup" del servidor HFSQL. Para especificar:

	- el directorio del servicio Manta, utilice la cadena de caracteres "%%EXE%%".

	- el año, utilice la cadena de caracteres "%%YEAR%%" (2008, por ejemplo).

	- el mes en 2 dígitos, utilice la cadena de caracteres "%%MONTH%%" (03 por ejemplo).

	- el día, utilice la cadena de caracteres "%%DAY%%%".

	- la hora, utilice la cadena de caracteres "%%HOUR%%".

	- los minutos, utilice la cadena de caracteres "%%MINUTE%%".




- ***&lt;description&gt;***: Copia de seguridad de description. Corresponde al **description** Property.

- ***Estado&gt; &lt;Estado***:  integer (o constante Integer) usado para averiguar el estado de la copia de seguridad:
	


|   |   |   |
| --- | --- | --- |
| *hBackupCanceled* | 2 | Copia de seguridad cancelada |
| *hBackupCompleted* | 1 | Copia de seguridad completada |
| *hBackupError* | 3 | Error durante la copia de seguridad |
| *hBackupInProgress* | 0 | Creando copia de seguridad |



- ***&lt;Mensaje de error&gt;***: Mensaje de error (si existe) en formato de string.



<a name="1000017308_NOTE4_3"></a>


### Gestión de un gancho web
<a name="gestion_gancho_web_ELTPARAGRAPHE000284"></a>

Un webhook permite activar un Process automáticamente a través de un servicio de REPOSO. Simplemente introduzca la URL del servicio REST.  

Una solicitud de Post se realizará en el URL proporcionado. El URL recibe un contenido de "aplicación/JSON" correspondiente a la información de la copia de seguridad. Por ejemplo: 
```txt
{
	"identifier": "283",
	"destination": "c:\backup\283\mybackup.zip",
	"state": "completed"
}
```
donde: 

- El"identificador" corresponde al identificador de la copia de seguridad. 

- "destino" corresponde al destino de la copia de seguridad. 

- el"estado" corresponde al estado de la copia de seguridad. Hay diferentes estados: "completado", "cancelado" o "error".





