


## Conector Nativo SQL Server: Características y observaciones específicas
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000287"></a>
Los siguientes párrafos presentan los principales aspectos y características específicas de Conector Nativo SQL Server. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Características específicas de la Conector Nativo SQL Server
<a name="caracteristicas_especificas_conector_nativo_sql_server_ELTTEXTE000311"></a>


### control Tabla basado en un archivo de datos cargado en memoria
<a name="control_tabla_basado_archivo_datos_cargado_memoria_ELTPARAGRAPHE000018"></a>

Los nuevos registros añadidos en una control Tabla basada en un archivo de datos cargada en memoria no pueden ser modificados de inmediato. Para modificar estos nuevos registros directamente en el control Tabla, debe utilizar el [TableDisplay](../WDLang1/3074003.md) con la constante *taInit* después de las adiciones.
<a name="NOTE2_2"></a>


### El bloqueo de un archivo de datos (tabla) en una transacción
<a name="bloqueo_archivo_datos_tabla_una_transaccion_ELTPARAGRAPHE000028"></a>

[HLockFile](../WDLang4/3044153.md) inicia una transacción y bloquea la tabla en modo exclusivo. [HUnlockFile](../WDLang4/3044160.md) valida la transacción y desbloquea el tabla.
<a name="NOTE2_3"></a>


### Número de registro
<a name="numero_registro_ELTPARAGRAPHE000040"></a>

No se puede especificar un número de Record distinto de cero en [HWrite](../WDLang4/3044092.md) y [HRead](../WDLang4/3044047.md). De hecho, "cero" corresponde al número actual de Record.

Del mismo modo, [HLockRecNum](../WDLang4/3044152.md) y [HUnlockRecNum](../WDLang4/3044194.md) sólo pueden utilizarse en el Record actual.
<a name="NOTE2_4"></a>


### Recuperación de los tipos DATETIME
<a name="recuperacion_los_tipos_datetime_ELTPARAGRAPHE000061"></a>

- La precisión de los valores leídos y escritos se limita a la precisión de WLanguage : el milisegundo. 
	**Caso especial**: La clase de fecha y hora: La precisión está limitada por SQLServer a 0,00333 segundos.

- Los nuevos tipos de fecha y hora de SQLServer 2008 sólo son compatibles con SQLnCLI para SQL Server 2008.. Para las capas de clientes anteriores, estos artículos se consideran como artículos de "texto unicode".



<a name="NOTE2_5"></a>


### Opciones del análisis
<a name="opciones_del_analisis_ELTPARAGRAPHE000071"></a>

- Tanto si las opciones "Sensible a las mayúsculas", "Sensible a la acentuación", "Sensible a la puntuación" están marcadas o no en la editor de análisis, la búsqueda siempre será sensible a las mayúsculas, a la acentuación y a la puntuación.

- Las opciones de análisis relativas a los índices de texto completo no están soportadas por Conector Nativo.

- Las opciones de análisis relativas a la indexación de los memorandos de texto de Partial no están soportadas por el Conector Nativo.



<a name="NOTE2_6"></a>


### Campos de tipo Array
<a name="campos_tipo_array_ELTPARAGRAPHE000080"></a>

Los artículos de array no están soportados por el Conector Nativo. Si está utilizando un elemento array, sólo el valor del índice 1 en la array será manejado por las funciones HFSQL (lectura/escritura).
<a name="NOTE2_7"></a>


### Cifrado mediante SSL
<a name="cifrado_mediante_ssl_ELTPARAGRAPHE000087"></a>

El cifrado por SSL (Secure Socket Layer) no está soportado en esta versión.
<a name="NOTE2_8"></a>


### Procedimientos almacenados
<a name="procedimientos_almacenados_ELTPARAGRAPHE000094"></a>

**Limite**: No se puede utilizar [HPrepareSQLQuery](../WDLang4/3044119.md) para preparar un Procedure almacenado que devuelva:

- registros.

- columnas.


Se debe utilizar la función [HExecuteSQLQuery](../WDLang4/3044084.md).
<a name="NOTE2_9"></a>


### Valores de Default de los artículos
<a name="valores_default_los_articulos_ELTPARAGRAPHE000114"></a>

Los valores de los artículos de la Default son gestionados por la Conector Nativo SQL Server. Los valores de Default pueden ser: 

- un valor, 

- una fórmula SQL. En este caso, la expresión SQL debe ser reconocida por el motor HFSQL y por la base de datos SQL Server.. 



<a name="NOTE2_10"></a>


### Características específicas para las funciones HFSQL
<a name="caracteristicas_especificas_para_las_funciones_hfsql_ELTPARAGRAPHE000124"></a>

Las características específicas para utilizar las funciones HFSQL con Conector Nativo SQL Server son las siguientes:  

| Características específicas | Funciones afectadas |
| --- | --- |
| La constante ***hDistinct*** no se tiene en cuenta: todos los registros (incluyendo los duplicados) serán examinados. | [HForward](../WDLang4/3044154.md), [HBackward](../WDLang4/3044126.md)<br>[HReadPrevious](../WDLang4/3044048.md), [HReadNext](../WDLang4/3044037.md), etc<br>[HPrevious](../WDLang4/3044112.md), [HNext](../WDLang4/3044027.md), etc |
| **Consulta multiarchivo** <br>Las funciones **HAdd**, **HModify** y **HDelete** no están soportadas. | [HAdd](../WDLang4/3044147.md), [HModify](../WDLang4/3044042.md)<br>[HDelete](../WDLang4/3044018.md) |
| Si se produce un error duplicado en **HModify**, **HRead** (con la constante *** hCurrentRecNum***) no lee el Record solicitado .<br>Este problema se solucionará en una próxima versión. | [HRead](../WDLang4/3044047.md) |
| La constante ***hForceIDAuto*** es ignorada por **HModify**. Una columna "IDENTITY" no puede modificarse en SQL Server. | [HModify](../WDLang4/3044042.md) |
| Las opciones de bloqueo de las funciones de lectura ([HReadSeek](../WDLang4/3044050.md), etc.) se ignoran. | Funciones de lectura ([HReadFirst](../WDLang4/3044051.md), etc.) |
| Un Record bloqueado por [HLockRecNum](../WDLang4/3044152.md) se desbloquea cuando se vuelve a leer. | Funciones de lectura ([HReadFirst](../WDLang4/3044051.md), etc.) |
| [HCreation](../WDLang4/3044255.md) crea elementos de FECHA y HORA si la versión del servidor y de la capa cliente corresponden a SQL Server 2008 (o posterior). | [HCreation](../WDLang4/3044255.md) |




### Problemas de funcionamiento
<a name="problemas_funcionamiento_ELTPARAGRAPHE000208"></a>

Al usar la Conector Nativo SQL Server, algunas características como Arrastrar y Soltar, ActiveX o .NET pueden no funcionar. 
Para restablecer un modo de funcionamiento correcto, deben añadirse las siguientes líneas de código en el código de inicialización del proyecto: 


```wl
LoadDLL("ole32")
API("ole32", "CoInitializeEx", 0, 2)
```

<a name="NOTE4_2"></a>


### Caso especial: SQL Azure
<a name="caso_especial_sql_azure_ELTPARAGRAPHE000221"></a>

SQL Azure requiere la presencia de un "índice agrupado" en los archivos.

- Si los archivos de datos son creados por [HCreation](../WDLang4/3044255.md), el Conector Nativo automatic crea el "índice agrupado" si la descripción del archivo de datos contiene un identificador automatic.

- Si se crean los archivos de datos con consultas SQL (o para añadir un "índice agrupado" a un archivo de datos existente), véase la documentación de SQL Azure para conocer la sintaxis a utilizar.



<a name="NOTE4_3"></a>


### Manejo de elementos calculados
<a name="manejo_elementos_calculados_ELTPARAGRAPHE000236"></a>

Los elementos calculados se pueden utilizar en los archivos de datos. 

La gestión de los elementos calculados está disponible en SQL Server 2005 (o posterior) con una Conector Nativo SQL Server a través de OLE DB o ODBC. 


