


## Configuración de la conexión con WDSQSINS
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000180"></a>
Para la compatibilidad con las versiones anteriores del Conector Nativo SQL Server (también llamado Native SQL Server Access), la conexión se puede seguir configurando en WDSQSINS (suministrado con el Conector Nativo SQL Server).

Este software se suministra: 

- en 32 bits: WDSQSINS.EXE

- en 64 bits: WDSQSINS64.EXE




**Recordatorio**: La configuración de la conexión a través de WDSQSINS debe definirse una sola vez.

Esta Page presenta:

- [la configuración de una conexión](#NOTE2_1).

- [la Definition de las opciones de conexión](#NOTE3_1).

- [la prueba de una conexión](#NOTE4_1).




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Configuración de una conexión
<a name="configuracion_una_conexion_ELTTEXTE000204"></a>
Para configurar la conexión:

1. Inicie WDSQSINS.EXE.

2. En la ventana que se abre (utilizada para listar las conexiones existentes), pulse el botón "Añadir" para crear una nueva conexión. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Parametrage_1.gif)


3. Especifique la configuración de la conexión: <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Connexion_1.gif)





- Seleccione el nombre de la fuente de datos. Este nombre se pasará como parámetro a [SQLConnect](../WDLang4/3072005.md) para conectarse a la base de datos. Si la conexión se definió en el editor de análisis de WINDEV o WEBDEV, especifique el nombre de la conexión correspondiente.

- Añade una leyenda de description.

- Especifique una cadena de conexión. **La cadena de conexión** es el nombre del servidor donde está instalado SQL Server. Se utiliza para encontrar la base de datos. Ejemplo de cadena de conexión: CSNT

- Especifique si el formato de las fechas debe seguir siendo compatible con 5.5. 
	Recordatorio: Entre la versión 5.5 y la versión 5.5B, el formato de fecha fue modificado. Si marca la casilla, restaurará el formato de fecha devuelto antes de la versión 5.5B (véase el párrafo siguiente).

- Especifique las opciones que desea utilizar:

	- **Utilizar una consulta count(\*) con SQLFirst**: Durante una navegación realizada por [SQLFirst](../WDLang4/3072017.md) , [SQLInfo](../WDLang4/3072028.md) COMPLETA DEL *SQL.NBLINE* Variable. 
			De forma predeterminada, se genera una consulta **COUNT** para completar esta variable ("Usar una Count( \*) con SQLFirst" está marcada). Esta consulta aumenta el número de intercambios en la red pero optimiza la ejecución de [SQLFirst](../WDLang4/3072017.md). 
			Para no aumentar el número de intercambios en la red, desmarque "Utilizar una consulta Count(\*) con SQLFirst".. En este caso, la ejecución de [SQLFirst](../WDLang4/3072017.md) puede verse ralentizada.

	- **set ANSI_NULLS**: Abre la conexión en modo 'set ANSI_NULLS ON*. Si esta opción no está marcada, se utilizan los ajustes de conexión de Default (ajustes definidos en el servidor). Esta opción es necesaria para acceder a un servidor remoto (llamado servidor relacionado).

	- **set ANSI_ADVERTENCIAS**: Abre la conexión en modo "set ANSI_WARNINGS ON".. Si esta opción no está marcada, se utilizan los ajustes de conexión de Default (ajustes definidos en el servidor). Esta opción es necesaria para acceder a un servidor remoto (llamado servidor relacionado).




- La conexión se añade a la lista una vez validados los parámetros.



<a name="NOTE2_2"></a>


### Observaciones
<a name="observaciones_ELTPARAGRAPHE000082"></a>

- La información sobre la configuración se almacena en el archivo **Wdsqsins.ini** en el directorio de Windows ("C:\\Windows\\" o "C:\\Users\\LOGIN\\AppData\\Local\\VirtualStore\\Windows\\" en Windows Vista/7).

- WDSQL se utiliza para comprobar si la conexión a la base de datos es correcta.



<a name="NOTE2_3"></a>


### Formato de fecha devuelto por el controlador nativo de SQL Server
<a name="formato_fecha_devuelto_por_controlador_nativo_sql_server_ELTPARAGRAPHE000090"></a>

**En la versión 5.5**: La fecha devuelta por el controlador nativo de SQL Server al leer un elemento de fecha era: JJ-MM-AAAAA

**En la versión 5.5B**: La fecha devuelta por el controlador nativo de SQL Server al leer un elemento Fecha es ahora: AAAAMMDD.

**Razones detrás de esta modificación**: Armoniza la gestión de las fechas en WINDEV. Simplifica la asignación de la fecha leída por el controlador de SQL Server en una WINDEV control de tipo DATE. No se requiere ninguna Process específica para convertir la fecha en un formato reconocido por WINDEV.

**¿Cómo mantener el modo de funcionamiento anterior?**
Configurar el formato de fecha en WDSQSINS: marque "Devolver las fechas en formato 'AAAA-MM-DD' (para SQLCol y SQLGetCol) " cuando describa la base de datos utilizada.

**Recordatorio**: Cuando escriba en una base de datos a través del controlador nativo de SQL Server, utilice el formato ODBC estándar {d 'AAAA-MM-DD'} (con un espacio entre d y ' ). El controlador convierte automáticamente la fecha al formato utilizado por la base de datos.

Ejemplo:


```sql
INSERT INTO TABLE(DATE) VALUES ({d '1999-12-25'})
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Opciones de conexión
<a name="opciones_conexion_ELTTEXTE000240"></a>


### Opciones para las cerraduras
<a name="opciones_para_las_cerraduras_ELTPARAGRAPHE000113"></a>

**SQLLock** espera dos parámetros:

- el tiempo de espera: la espera al llamar a **SQLLock** puede ser infinita o no (deadlock). El tiempo de espera es de set a 1 minuto por Default, pero puede ser modificado.

- el bloqueo de teclas. Consulte la documentación sobre el servidor para obtener más detalles.

<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=options_1.gif)


<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Prueba conexión
<a name="prueba_conexion_ELTTEXTE000264"></a>
Para ejecutar la prueba de una conexión desde WDSQSINS:

1. Seleccione la conexión cuya prueba debe ejecutarse.

2. Haz clic en el botón "Probar".

3. Especifique el nombre y la contraseña del usuario.

4. Haga clic en "Probar conexión".. Enseguida, se muestra el informe. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=test_1.gif)






