
## Gestión del XSD
			



## Presentación
<a name="presentacion_ELTTEXTE000124"></a>
WINDEV, WINDEV Mobile y WEBDEV incluyen varias funciones para manejar el código XML. El código XML utilizado debe cumplir con el estándar XML. Para más detalles, consulte la documentación específica de XML. Para más detalles sobre las funciones de WLanguage, véase [XML](../WDLang5/3081018.md).

WINDEV, WEBDEV y WINDEV Mobile le permiten importar archivos en formato XSD. Un archivo XSD contiene la description del archivo XML del mismo nombre. Conocer la estructura de un Document XML permite comprobar la validez de este Document. El lenguaje description para el contenido de un XSD Document también está en formato XML.

Un ejemplo de archivo XSD:


```xml
<?xml version="1.0" encoding="UTF-8"?>
  <xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">
   <xsd:element name="person">
      <xsd:complexType>
         <xsd:sequence>
            <xsd:element name="lastname" type="xsd:string"/>
            <xsd:element name="firstname" type="xsd:string"/>
            <xsd:element name="dob" type="xsd:date"/>
            <xsd:element name="email" type="xsd:string" minOccurs="0" maxOccurs="unbounded" />
         </xsd:sequence>
      </xsd:complexType>
   </xsd:element>
 </xsd:schema>
```


Seguido de un archivo XML válido:


```xml
<?xml version="1.0" encoding="UTF-8"?>
 <person xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xsi:noNamespaceSchemaLocation="person.xsd">
   <lastname>Johnson</lastname>
   <firstname>John</firstname>
   <dob>1967-08-13</dob>
   <email>test@yahoo.com</email>
 </person>
```


<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Importar un archivo XSD a un proyecto
<a name="importar_archivo_xsd_proyecto_ELTTEXTE000148"></a>
Para importar un archivo XSD a un proyecto:

1. En el panel "Explorador de proyectos", seleccione "Descripciones externas".

2. Haga clic con el botón derecho y seleccione "Importar un XSD a este proyecto". El asistente de importación se abre automáticamente. Es posible: 

	- Importar un archivo XSD de INTERNET. 

	- Importar un archivo XSD local. 




3. Especifique las características del archivo XSD a importar. 

4. Validar. El archivo XSD se añade automáticamente en el explorador de proyectos (rama "Descripciones externas"). Está listo para su uso.




Atención: 

- Para que funcione en tiempo de ejecución, el archivo XSD no debe estar presente en un subdirectorio del proyecto o del ejecutable.

- Sólo se admiten archivos XSD con esquemas de la versión 1.0. 








## Usando un description importado en el proyecto
<a name="usando_description_importado_proyecto_ELTTEXTE000172"></a>
Para utilizar la description del XML Document, basta con utilizar las variables generadas automáticamente por la importación.

1. Declarar un documento XML en el formato del description importado. Por ejemplo, si la description importada se llama "persona":
	
	```wl
	cMyDoc is xmlDocument <description="person">
	```

	Observación: Puede especificar la extensión de archivo durante la declaración. Por ejemplo: 
	
	```wl
	cMyDoc is xmlDocument <description="person.xsd">
	```


2. Inicializar las diferentes variables que se incluyen en el description del XML Document. Por ejemplo, si la Document incluye el apellido y el nombre de una persona:
	
	```wl
	cMyDoc.person.lastname = "MOORE"
	cMyDoc.person.firstname = "VINCE"
	```

	Observaciones: 

	- Cada elemento está separado por un punto **.** .

	- Se propone una ayuda al introducir los nombres de las variables.

	- Si el nombre de un elemento contiene un carácter especial (guión, por ejemplo), debe estar entre comillas simples:
			
		```wl
		cMyDoc.person.'id-person' = "ValueId"
		```





3. Se pueden utilizar varias funciones para manipular el archivo XSD para validar el description del archivo XML: 
	


|   |   |
| --- | --- |
| [XMLSave](../WDLang5/1000019026.md) | Guarda un XML Document en un archivo. |
| [XMLValidDocument](../WDLang5/1000019272.md) | Valida una Document XML de un esquema XSD. |
| [XMLValidNode](../WDLang5/1000019280.md) | Valida un nodo XML, sus hijos y sus atributos desde su description en el esquema XSD relacionado hasta el XML Document. |





### Ejemplo: Creación completa de un archivo según el XSD description dado en el ejemplo: 
<a name="ejemplo_creacion_completa_archivo_segun_xsd_description_dado_ejemplo_ELTPARAGRAPHE000074"></a>




```wl
cMyDoc is xmlDocument <description="person.xsd">

cMyDoc.person.lastname = "Moore"
cMyDoc.person.firstname = "Vince"
cMyDoc.person.dob = "19710211"
cMyDoc.person.email[1] = "vince.moore@mydomain.com"
cMyDoc.person.email[2] = "vince.moore@otherdomain.com"

XMLSave(cMyDoc, fExeDir() + ["\"] + "test.xml")

// Or with an intermediate check: 
IF XMLValidDocument(cMyDoc) = True THEN
	XMLSave(cMyDoc, fExeDir() + ["\"] + "test.xml")
	IF ErrorOccurred = True THEN
		Error("Unable to save the XML document", ErrorInfo())
	ELSE
		Info("OK", fExeDir() + ["\"] + "test.xml")
	END
ELSE
	Error("The XML document is invalid", ErrorInfo()) 
END
```



