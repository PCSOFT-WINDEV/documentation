


## iInitReportQuery (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Inicializa la consulta relacionado al reporte (para una consulta con parámetros).. Se puede llamar a esta función:

- en el "Iniciando" Event del reporte,

- ante [iPrintReport](../WDLang5/3046032.md).




**Observaciones**:

- Si el reporte es relacionado a una consulta sin parámetro, utilice [iPrintReport](../WDLang5/3046032.md).

- Si el reporte es relacionado a una consulta (con o sin parámetros) que utiliza una conexión específica (conexión a una base de datos a través de un proveedor OLE DB, por ejemplo), utilice [iInitReportQueryConnection](../WDLang5/3046028.md).

- Si el reporte se encuentra en un reporte compuesto, se debe llamar a la función **iInitReportQuery** en el evento "Inicialización" del reporte. 


![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) **Atención**: Se requiere una configuración específica para usar esta función en Linux. Para obtener más información, consulte [Imprimir en Linux](../Editeurs/9000078.md). 

|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ER.png) | Importante | Si la consulta se crea con Reports & Queries, no es necesario utilizar la función **iInitReportQuery** para especificar los parámetros de la consulta. De hecho, cuando se ejecuta un reporte basado en una consulta con parámetros desde Reports & Queries, una ventana le permite introducir los parámetros de la consulta. |




<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000003046021&name=iinitreportquery_funcion&product=WD">Ver ejemplos adicionales</a>

```wl
iInitReportQuery(RPT_SchoolReport, "Doe", "2020")
iPrintReport(RPT_SchoolReport)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`iInitReportQuery(<Report used> [, <Parameter 1 of query> [... [, <Parameter N of query>]]])`
---

**`<Report used>: (Nombre de un reporte)`**

Nombre lógico de reporte a imprimir.

**`<Parameter 1 of query>: (Tipo de parámetro de consulta (opcional))`**

Primer parámetro de consulta definido como fuente reporte (si la consulta espera un parámetro).



**`<Parameter N of query>: (Tipo de parámetro de consulta (opcional))`**

Último parámetro de consulta definido como fuente reporte (si la consulta espera un parámetro).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Reporte interna control: reporte basado en una consulta con parámetros
<a name="reporte_interna_control_reporte_basado_una_consulta_con_parametros_ELTPARAGRAPHE000120"></a>

Si el reporte asociado a un control "Reporte interno" está basado en una consulta con parámetros, utilice la función **iInitReportQuery** para pasar los parámetros a la consulta. Esta función debe utilizarse en el "Antes de imprimir" Event del bloque que contiene el "reporte interno" control.

Para obtener más información, consulte [Reporte interna control](../WDChamp/1013044.md).
<a name="NOTE0_2"></a>


### Ejecución de una consulta y de una reporte basada en esta consulta
<a name="ejecucion_una_consulta_una_reporte_basada_esta_consulta_ELTPARAGRAPHE000136"></a>

Al imprimir una reporte basada en una consulta, si la consulta ya se ha ejecutado, no se vuelve a ejecutar. Para forzar la reejecución de la consulta (añadir registros, por ejemplo), basta con utilizar [HExecuteQuery](../WDLang4/3044080.md) o **iInitReportQuery**.
<a name="NOTE0_3"></a>


### Liberar la consulta
<a name="liberar_consulta_ELTPARAGRAPHE000150"></a>

Al imprimir un reporte basado en una consulta inicializada con la función **iInitReportQuery**, la consulta se libera después de imprimir el reporte (mismo comportamiento que la función [HCancelDeclaration](../WDLang4/3044174.md)).
<a name="NOTE0_4"></a>


### Varios
<a name="varios_ELTPARAGRAPHE000164"></a>

- Si no se especifican algunos de los parámetros esperados por la consulta (valor correspondiente a NULL por ejemplo), se ignorarán las condiciones de selección correspondientes a estos parámetros.

- Los parámetros adicionales se ignorarán, si el número de parámetros definido en la función **iInitReportQuery** es superior al número de parámetros esperado por la consulta.




<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Código neutro
## Componente:
wd280etat.dll
