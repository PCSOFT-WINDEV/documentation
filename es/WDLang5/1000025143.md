


## &lt;Reporte&gt;.InitQuery (Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Inicializa la consulta relacionado al reporte (para una consulta con parámetros).. Se puede llamar a esta función:

- en el "Iniciando" Event del reporte,

- ante [&lt;Reporte&gt;.Print](../WDLang5/1000024554.md).




**Observaciones**:

- Si el reporte es relacionado a una consulta sin parámetro, utilice [&lt;Reporte&gt;.Print](../WDLang5/1000024554.md).

- Si el reporte es relacionado a una consulta (con o sin parámetros) que utiliza una conexión específica (conexión a una base de datos a través de un proveedor OLE DB, por ejemplo), utilice [&lt;Reporte&gt;.InitQueryConnection](../WDLang5/1000025144.md).

- Si el reporte se encuentra en un reporte compuesto, se debe llamar a la función **&lt;Reporte&gt;.InitQuery** en el evento "Inicialización" del reporte. 


![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) **Atención**: Se requiere una configuración específica para usar esta función en Linux. Para obtener más información, consulte [Imprimir en Linux](../Editeurs/9000078.md). 

|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ER.png) | Importante | Si la consulta se crea con Reports & Queries, no es necesario utilizar la función **&lt;Reporte&gt;.InitQuery** para especificar los parámetros de la consulta. De hecho, cuando se ejecuta un reporte basado en una consulta con parámetros desde Reports & Queries, una ventana le permite introducir los parámetros de la consulta. |




<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
RPT_SchoolReport.InitQuery("Doe", "2020") 
RPT_SchoolReport.Print()
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Report used>.InitQuery([<Parameter 1 of query> [... [, <Parameter N of query>]]])`
---

**`<Report used>: (Report name)`**

Nombre lógico de reporte a imprimir.

**`<Parameter 1 of query>: (Type of query parameter (optional))`**

Primer parámetro de consulta definido como fuente reporte (si la consulta espera un parámetro).



**`<Parameter N of query>: (Type of query parameter (optional))`**

Último parámetro de consulta definido como fuente reporte (si la consulta espera un parámetro).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Reporte interna control: reporte basado en una consulta con parámetros
<a name="reporte_interna_control_reporte_basado_una_consulta_con_parametros_ELTPARAGRAPHE000278"></a>

Si el reporte asociado a un control "Reporte interno" está basado en una consulta con parámetros, utilice la función **&lt;Reporte&gt;.InitQuery** para pasar los parámetros a la consulta. Esta función debe utilizarse en el "Antes de imprimir" Event del bloque que contiene el "reporte interno" control.

Para obtener más información, consulte [Reporte interna control](../WDChamp/1013044.md).
<a name="NOTE0_2"></a>


### Ejecución de una consulta y de una reporte basada en esta consulta
<a name="ejecucion_una_consulta_una_reporte_basada_esta_consulta_ELTPARAGRAPHE000295"></a>

Al imprimir una reporte basada en una consulta, si la consulta ya se ha ejecutado, no se vuelve a ejecutar. Para forzar la reejecución de la consulta (añadir registros, por ejemplo), basta con utilizar [&lt;Fuente&gt;.ExecuteQuery](../WDLang4/1000024944.md) o **&lt;Reporte&gt;.InitQuery**.
<a name="NOTE0_3"></a>


### Liberar la consulta
<a name="liberar_consulta_ELTPARAGRAPHE000312"></a>

Al imprimir un reporte basado en una consulta inicializada con la función **&lt;Reporte&gt;.InitQuery**, la consulta se libera después de imprimir el reporte (mismo comportamiento que la función [&lt;Fuente&gt;.CancelDeclaration](../WDLang4/1000024192.md)).
<a name="NOTE0_4"></a>


### Varios
<a name="varios_ELTPARAGRAPHE000329"></a>

- Si no se especifican algunos de los parámetros esperados por la consulta (valor correspondiente a NULL por ejemplo), se ignorarán las condiciones de selección correspondientes a estos parámetros.

- Los parámetros adicionales se ignorarán, si el número de parámetros definido en la función **&lt;Reporte&gt;.InitQuery** es superior al número de parámetros esperado por la consulta.




<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Código neutro
## Componente:
wd280etat.dll
