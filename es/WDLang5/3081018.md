


## Gestión de XML
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000271"></a>
WINDEV, WINDEV Mobile y WEBDEV incluyen varias funciones para manejar el código XML. El código XML utilizado debe cumplir con el estándar XML. Consulte la documentación específica de XML para obtener más detalles.

Por ejemplo, se utiliza el código XML:

- en los sistemas de información (INTRANET, ...).

- en los diálogos con los Webservices. Para obtener más información, consulte [Importación de servicios Web XML](../WDLang3/3086001.md) y [Generación de un servicio web XML](../WDLang3/3086002.md).






<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Definition
<a name="definition_ELTTEXTE000295"></a>
XML es un lenguaje que contiene etiquetas y atributos (llamados "elementos" en esta ayuda).

La estructura de un código XML corresponde a una estructura de árbol: la información está organizada jerárquicamente.

Los siguientes términos se utilizan para describir las diferentes partes de un código XML:

![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=schema_xml.gif)

El código XML (o contenido) corresponde a:

- el contenido de un archivo XML.

- una respuesta de un servicio web XML.




Las funciones XML le permiten:

- leer, encontrar y analizar el contenido de un archivo XML.

- modificar el contenido de un archivo XML.

- formatear el contenido de un archivo XML.

- ejecutar una consulta XPATH en el contenido de un archivo XML.

- analizar las respuestas recibidas de los Webservices XML.

- importar datos ([HImportXML](../WDLang4/3044007.md)).




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Principio
<a name="principio_ELTTEXTE000319"></a>


### Dos métodos
<a name="dos_metodos_ELTPARAGRAPHE000076"></a>

Se pueden utilizar dos métodos para manipular y Document XML: 

1. [Usando un xmlDocument Variable](#NOTE3_2) (**Método recomendado**). Este método le permite usar un archivo XSD.

2. [Usando una cadena Variable para almacenar el XML Document](#NOTE3_3). Entonces, el Document XML puede ser manejado por las diferentes funciones XML. 



<a name="NOTE3_2"></a>


### Usando un xmlDocument Variable
<a name="usando_xmldocument_variable_ELTPARAGRAPHE000090"></a>

Las variables de tipo **xmlDocument** se pueden declarar indicando un documento de ejemplo (archivo XML) o un documento modelo (archivo XSD). La estructura del documento será leída por WINDEV, WEBDEV y WINDEV Mobile. Así, el autocompletado estará disponible para los nombres de los nodos en el editor de código.

Declarar un xmlDocument Variable con una muestra de Document:

1. Añade el XML Document al proyecto a través de uno de los siguientes métodos: 

	- en la pestaña "Proyecto", en el grupo "Proyecto", despliegue "![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ico_listeprojet.gif) Lista de elementos" y haga clic en "Lista de elementos del proyecto". La lista de elementos del proyecto aparece en pantalla. Pulse el botón "Añadir" y seleccione el XML Document.

	- arrastre y suelte el archivo en la carpeta "Descripciones externas" del panel "Explorador de proyectos".

	- En el panel "Explorador de proyectos", seleccione la carpeta "Descripciones externas" y, a continuación: 

		- "Importar un XML o JSON en este proyecto" en el menú contextual.

		- "Importar un XSD a este proyecto" en el menú contextual.




2. El XML Document aparece en la carpeta "Descripciones externas" del explorador del proyecto. Se puede ver su estructura.

3. Declare la variable de la siguiente manera:
	
	```txt
	<Variable name> is xmlDocument, description =  <Document name>
	```

	&lt;Nombre del documento&gt; puede corresponder al nombre del documento muestra (con o sin extension) o al nombre del documento modelo (con o sin extension). 
	**Observaciones**: 

	- Esta declaración puede obtenerse automáticamente "soltando" el nombre del XML Document directamente desde el panel "Project Explorer". 

	- Cuando se utiliza una muestra de Document, también se puede utilizar la siguiente sintaxis: 
			
		```txt
		<Variable name> is xmlDocument
		<Variable name> = XMLOpen(<Document name>)
		```





4. Ahora puede acceder directamente a los nodos de la variable por sus nombres. El mecanismo de autocompletado del editor de código propone estos nombres automáticamente.




Observación: [XMLSave](../WDLang5/1000019026.md) se utiliza para guardar el XML Document. Si se ha utilizado un archivo XSD, se tendrá en cuenta automáticamente.
<a name="NOTE3_3"></a>


### Usando una cuerda Variable
<a name="usando_una_cuerda_variable_ELTPARAGRAPHE000097"></a>

A manipular un código XML:

1. Almacenar el código XML en una cadena Variable ([fLoadText](../WDLang1/3036006.md)). Este código puede provenir de un archivo XML o de un servicio Web XML.

2. Crear un XML Document ([XMLDocument](../WDLang5/3081008.md)). Esta Document se almacena en memoria y contiene todo el código XML a utilizar.

3. Maneje su Document XML con las funciones de WLanguage. Es posible:

	- Examinar el código XML ([XMLLast](../WDLang5/3081013.md), [XMLOut](../WDLang5/3081009.md), [XMLChild](../WDLang5/3081012.md), [XMLParent](../WDLang5/3081022.md), [XMLPrevious](../WDLang5/3081023.md), [XMLFirst](../WDLang5/3081024.md), [XMLRoot](../WDLang5/3081019.md), [XMLNext](../WDLang5/3081030.md), [XMLFound](../WDLang5/3081020.md)).

	- Realizar búsquedas ([XMLFind](../WDLang5/3081025.md), [XMLCancelSearch](../WDLang5/3081001.md), [XMLExtractString](../WDLang5/3081017.md)).

	- Recuperar la información sobre los elementos (etiquetas o atributos) que se encuentran en la Document. ([XMLData](../WDLang5/3081004.md), [XMLElementName](../WDLang5/3081026.md), [XMLParentName](../WDLang5/3081035.md), [XMLElementType](../WDLang5/3081031.md)).

	- Modificar el XML Document ([XMLAddAttribute](../WDLang5/3081011.md), [XMLAddChild](../WDLang5/3081002.md), [XMLInsertDocument](../WDLang5/3081014.md), [XMLInsertElement](../WDLang5/3081007.md), [XMLModify](../WDLang5/3081037.md), [XMLRename](../WDLang5/3081021.md), [XMLDelete](../WDLang5/3081036.md)).

	- Ejecuta una consulta XPath en un XML Document ([XMLExecuteXPath](../WDLang5/3081015.md), [XMLPath](../WDLang5/3081028.md), [XMLResultado](../WDLang5/3081027.md)).

	- Convertir una cadena de caracteres de ANSI a XML y viceversa ([TextToXML](../WDLang5/3081006.md) o [XMLToText](../WDLang5/3081029.md)).




4. Guarde las modificaciones si es necesario ([XMLBuildString](../WDLang5/3081016.md) y [fSaveText](../WDLang1/3036046.md)).

5. Cierre el XML Document ([XMLClose](../WDLang5/3081034.md)).




Observación: También tiene la capacidad de crear un XML Document:

- con los datos encontrados en un tabla ([TableToXML](../WDLang1/3074037.md)).

- a partir de una sección de un XML Document ([XMLExtractDocument](../WDLang5/3081010.md)) existente.







