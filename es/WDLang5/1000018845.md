


## iParameterDuplicate( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Configura la creación de automatic del duplicado de copy generado durante la siguiente impresión (impresión en una impresora física): 

- nombre del archivo duplicado.

- para la creación de duplicados.

- contraseña de duplicado.

- firma de duplicado.




Esta función debe utilizarse antes de iniciar el trabajo de impresión para el que debe almacenarse un duplicado de copy. Esta configuración sólo se tiene en cuenta para esta impresión..   

Las copias duplicadas están disponibles para los informes programados (creados por las funciones iXXX) y para los informes generados por el editor de reportes.
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Configure the duplicate copy of invoice
iParameterDuplicate(iDplPrintout, "C:\Temp", "MyDuplicate_%d_%h", ...
	"DDDD DD MMMM YYYY", "HH.MM.SS")

// Print with duplicate from report viewer
iDestination(iViewer)
iPrintReport(RPT_Invoice)
```


<a name="Example2"></a>

```wl
// Configure the signed duplicate of invoice 
MyCertificate is Certificate
CertificateSelection is boolean
CertificateSelection = CertificateSelect(MyCertificate)

// Cancelation or error
IF CertificateSelection = False THEN RETURN

// Checks whether the selected certificate is valid for signing
IF MyCertificate.ValidForSignature = False THEN
	Info("The selected certificate cannot be used to generate a signature.")
	RETURN
END

iParameterDuplicate(iDplPrintout, "C:\Temp", "MyDuplicate_%d_%h", ...
		"DDDD DD MMMM YYYY", "HH.MM.SS")
iParameterDuplicate(iDplCertificate, MyCertificate)

// Print with duplicate from report viewer
iDestination(iViewer)
iPrintReport(RPT_Invoice)
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Configurar el archivo duplicado para crear: directorio, nombre, contraseña, ...

`iParameterDuplicate(<Options> [, <Creation directory> [, <Name of file to print> [, <Date format> [, <Time format> [, <Password>]]]]])`
---

**`<Options>: (Constante de tipo Integer)`**

Opciones para crear las copias duplicadas: 


|   |   |
| --- | --- |
| *iDplNone* | No se crea ningún duplicado de copy. |
| *iDplPrintout* | Se crea automáticamente un duplicado para cada impresión realizada en una impresora.<br><br>**Observación**: El duplicado no se genera si el usuario utiliza una de las opciones de exportación (pdf, Email, etc.) del visor reporte |



**`<Creation directory>: (Cadena de caracteres opcional)`**

Ruta del directorio para la creación de duplicados. Este parámetro corresponde al directorio actual de Default.

**`<Name of file to print>: (Cadena de caracteres opcional)`**

Nombre del archivo a imprimir (con su extensión). Este nombre puede contener la fecha y hora de creación del duplicado de copy a través de las siguientes etiquetas: 

- para especificar la fecha de creación del duplicado de copy. 

- %h para especificar la hora de creación del duplicado de copy. 




**Ejemplo**: "MyDuplicate_%d_%h.dpl" dará "MyDuplicate_04092009_1426.dpl".

Por Default, el nombre del archivo duplicado creado corresponde a "Dupli_YYYYMMDD_HHMMSS.dpl".

**`<Date format>: (Cadena de caracteres opcional)`**

Formato de la fecha utilizada en el nombre del archivo. Este parámetro puede contener una palabra, una frase, etc., ... Los caracteres específicos que representan los diferentes elementos de la fecha (YYYY, YY, MM o DD) se sustituirán automáticamente por su valor. En esta cadena:

- YYYY representa el año,

- M representa el mes (sin cero a la izquierda), 

- MM representa un mes de dos dígitos, 

- MMM representa el mes abreviado en 3 letras (p. ej., ene) 

- MMMM representa el mes como un nombre completo (p. ej., enero) 

- D representa el día (sin cero a la izquierda),

- DD representa un día de dos dígitos,

- DDD representa el día abreviado en 3 letras (p. ej., lun) 

- DDDD representa el día como un nombre completo (p. ej., lunes).




Si este parámetro corresponde a la constante *maskDateSystem*, el formato utilizado corresponde al formato definido en el proyecto description para el lenguaje actual. Para definir este formato: 
**1.** En la pestaña "Proyecto", en el grupo "Proyecto", haga clic en "Descripción". 
**2.** Visualizar la pestaña "Idiomas".

Si no se especifica este parámetro, se utiliza el formato DD/MM/AAAA de forma predeterminada.

**`<Time format>: (Cadena de caracteres opcional)`**

El formato de tiempo utilizado en el nombre del archivo. Este parámetro corresponde a un string (una frase, por ejemplo). Los caracteres específicos que representan los diferentes elementos de la hora (HH, MM, SS, CC o AP) se sustituirán automáticamente por su valor. En esta cadena:

- HH representa el número de horas,

- MM representa el número de minutos,

- SS representa el número de segundos,

- CC representa el número de centésimas de segundo,

- AP representa "AM" o "PM" (si se utiliza "AM", la hora se muestra en formato de 12 horas).




Si no se especifica este parámetro, el formato del resultado es HH:MM:SS:CC.

**`<Password>: (Cadena de caracteres opcional)`**

Contraseña de los archivos duplicados generados.


<a name="SYNTAX2"></a>

### Configurando la firma del duplicado de copy

`iParameterDuplicate(<Options> , <Certificate>)`
---

**`<Options>: (Constante de tipo Integer)`**

Opciones de duplicado de copy: 


|   |   |
| --- | --- |
| *iDplCertificate* | Utiliza el Certificate especificado para firmar el duplicado de copy.<br><br>**Observación**: Desde el visor de reporte, se utilizará esta firma: <br><br>- si la reporte se imprime a través de la opción de exportación "Duplicado" : ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ico_duplicata.gif)<br><br>- si el reporte se imprime a través de la opción de impresión en una impresora.<br><br><br> |



**`<Certificate>: (Variable de tipo Certificate)`**

Nombre de la variable [Certificate](../WDLang1/1000019287.md) correspondiente al Certificate que se utilizará para firmar el duplicado.



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Imprimiendo un duplicado de copy del visor de reporte
<a name="imprimiendo_duplicado_copy_del_visor_reporte_ELTPARAGRAPHE000135"></a>

Si se ha solicitado un duplicado antes de visualizar la reporte en el visor reporte, el duplicado se generará cuando se inicie el trabajo de impresión desde el visor reporte. 

Si se modifica una anotación o una control Campo de entrada en el visor de reporte, se generará un nuevo duplicado de copy durante la siguiente impresión física. 

Si el trabajo de impresión se realiza en varias impresoras, se generará un duplicado de copy para cada impresora. 

La configuración definida con la función **iParameterDuplicate** se usa para: 

- duplicados generados durante el trabajo de impresión

- duplicados generados por la opción "Duplicados" (![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ico_duplicata.gif)) en el visor de reporte. 




**Observaciones**: 

- La lista de archivos duplicados creados para la última impresión realizada es devuelta por [iLastFile](../WDLang5/3046068.md). 

- Para dejar de crear duplicados automatic desde el visor reporte, utilice **iParameterDuplicate** con la constante *iDplNone*. 

- Para no proponer la impresión de duplicados desde el visor de reporte (![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ico_duplicata.gif)), utilice [iParameterViewer](../WDLang5/1000024634.md). 

- Las copias duplicadas se generan cuando se imprime sólo en una impresora.. Los duplicados no se generan si el usuario utiliza una de las opciones de exportación (pdf, Email, etc.) disponibles en el visor de reporte. 




<a name="XComponent"></a>

## Componente:
wd280prn.dll
