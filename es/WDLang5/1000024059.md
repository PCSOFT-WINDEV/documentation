
## iAddAttachment( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Agrega un archivo adjunto en un archivo PDF generado por una exportación de impresión PDF.. Debe exportarse : 

- con la función [iDestination](../WDLang5/3046074.md) (constante *iPDF* o *iGenericPDF*). 

- del espectador de reporte (también llamado "vista previa de impresión"). 

- desde la mini vista preliminar de impresión.  





<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// PDF destination
iDestination(iGenericPDF, "c:\path\pdf.pdf")

// Add an attachment
iAddAttachment("c:\path\pj.xls", "Example spreadsheet", "application/vnd.ms-excel")

// Positions a bookmark and a text at 5 cm from the top of the page
iYPos(50)
iAddBookmark("page 1 line 1", "First line of the first page", "page1")
iPrint("First line of the first page")

// End of print
iEndPrinting()
```

<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX1"></a>

### Agregar un archivo adjunto (como un archivo) a un archivo PDF

`iAddAttachment(<File to add> [, <Description> [, <MIME type>]])`
---

**`<File to add>: (Cadena de caracteres)`**

ruta completa o relativa del archivo en disco que se agregará después de la generación de la impresión del archivo PDF. 

**`<Description>: (Cadena de caracteres opcional)`**

Breve description del archivo para agregar. 

**`<MIME type>: (Cadena de caracteres opcional o constante de cadena)`**

Mime tipo associated al archivo agregado : 

- Nombre del tipo MIME a utilizar. Más de 150 tipos están definidos en el estándar de comunicación MIME (disponible en INTERNET). Los valores más comunes reconocidos por la mayoría de los navegadores son:

	- "solicitud/pdf" : Document en formato PDF (\*.pdf)

	- "text/html" : Página HTML (\*.htm,\*.html)

	- "text/plain": archivo de texto (\*.txt)

	- "Image/gif" : Image en formato GIF (\*.gif)

	- "Image/jpeg" : Image en formato JPEG (\*.jpg, \*.jpeg)

	- "video/mpeg" : vídeo en formato MPEG (\*.mpg,\*.mpeg)




- Tipo MIME correspondiente a una de las siguientes constantes : 
	


|   |   |
| --- | --- |
| *typeMimeXMLApplication* | XML content. |
| *typeMimeBinary* | Contenido binario (byte stream). |
| *typeMimeDOC* | Contenido como archivo Word (\*.doc) |
| *typeMimeDOCX* | Contenido como archivo Word (\*.docx) |
| *typeMimeGIF* | Contenidos como Image en formato GIF (\*.gif) |
| *typeMimeHTML* | Contenido como página HTML (\*.htm,\*.html) |
| *typeMimeJPEG* | Contenido como Image en formato JPEG (\*.jpg, \*.jpeg) |
| *typeMimeJSON* | Contenido de JSON. |
| *typeMimePDF* | Contenido como PDF Document (\*.pdf) |
| *typeMimePNG* | Contenido como Image en formato JPEG (\*.png) |
| *typeMimeSOAP* | Contenido SOAP en formato XML. |
| *typeMimeText* | Contenido en formato de texto (\*.txt) |
| *typeMimeXMLText* | Contenido del texto en formato XML |
| *typeMimeXLS* | Contenido en formato Excel (\*.xls) |
| *typeMimeXLSX* | Contenido en formato Excel (\*.xlsx) |
| *typeMimeZIP* | Contenido en formato ZIP (\*.zip) |







<a name="SYNTAX2"></a>

### Añadir un archivo adjunto (como un buffer) a un archivo PDF

`iAddAttachment(<Buffer to add> , <Attachment name> [, <Description> [, <MIME type> [, <Creation date> [, <Modification date>]]]])`
---

**`<Buffer to add>: (Buffer)`**

Contenido que se agregará después de la generación de la impresión del archivo PDF.

**`<Attachment name>: (Cadena de caracteres)`**

Nombre del archivo adjunto que se mostrará en el archivo PDF. 
Atención : debe especificarse la extensión del archivo adjunto.

**`<Description>: (Cadena de caracteres opcional)`**

Breve description del contenido a añadir. 

**`<MIME type>: (Cadena de caracteres opcional o constante de cadena)`**

El tipo de mimo associated con el contenido añadido : 

- Nombre del tipo MIME a utilizar. Más de 150 tipos están definidos en el estándar de comunicación MIME (disponible en INTERNET). Los valores más comunes reconocidos por la mayoría de los navegadores son:

	- "solicitud/pdf" : Document en formato PDF (\*.pdf)

	- "text/html" : Página HTML (\*.htm,\*.html)

	- "text/plain": archivo de texto (\*.txt)

	- "Image/gif" : Image en formato GIF (\*.gif)

	- "Image/jpeg" : Image en formato JPEG (\*.jpg, \*.jpeg)

	- "video/mpeg" : vídeo en formato MPEG (\*.mpg,\*.mpeg)




- Tipo MIME correspondiente a una de las siguientes constantes : 
	


|   |   |
| --- | --- |
| *typeMimeXMLApplication* | XML content. |
| *typeMimeBinary* | Contenido binario (byte stream). |
| *typeMimeDOC* | Contenido como archivo Word (\*.doc) |
| *typeMimeDOCX* | Contenido como archivo Word (\*.docx) |
| *typeMimeGIF* | Contenidos como Image en formato GIF (\*.gif) |
| *typeMimeHTML* | Contenido como página HTML (\*.htm,\*.html) |
| *typeMimeJPEG* | Contenido como Image en formato JPEG (\*.jpg, \*.jpeg) |
| *typeMimeJSON* | Contenido de JSON. |
| *typeMimePDF* | Contenido como PDF Document (\*.pdf) |
| *typeMimePNG* | Contenido como Image en formato JPEG (\*.png) |
| *typeMimeSOAP* | Contenido SOAP en formato XML. |
| *typeMimeText* | Contenido en formato de texto (\*.txt) |
| *typeMimeXMLText* | Contenido del texto en formato XML |
| *typeMimeXLS* | Contenido en formato Excel (\*.xls) |
| *typeMimeXLSX* | Contenido en formato Excel (\*.xlsx) |
| *typeMimeZIP* | Contenido en formato ZIP (\*.zip) |






**`<Creation date>: (Opcional DateTime)`**

Fecha de creación del anexo UTC. 

**`<Modification date>: (Opcional DateTime)`**

Fecha de modificación del anexo UTC. 



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Formato del archivo PDF
<a name="formato_del_archivo_pdf_ELTPARAGRAPHE000092"></a>

**iAddAttachment** sólo permite añadir archivos a PDF y PDF/A-3b. 

Recordatorio : El formato en el que se generará el PDF se puede elegir a través de [iParameterPDF](../WDLang5/3046007.md). 

Atención : El formato PDF/A-1b no permite añadir archivos adjuntos. : en este caso la función **iAddAttachment** genera un error fatal.

<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Código neutro
## Componente:
wd280prn.dll
