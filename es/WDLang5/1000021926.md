


## Utilizar la autenticación de Facebook
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000352"></a>
Facebook es la red social más popular del mundo. Las empresas la utilizan comúnmente para acercarse a sus clientes. Facebook incluye una API completa para aprovechar al máximo la plataforma. 

WINDEV, WEBDEV y WINDEV Mobile incluyen dos modos para utilizar Facebook para aplicaciones iOS y Android: 

- un modo sencillo que permite a los usuarios usar sus credenciales de Facebook para iniciar sesión en la aplicación WINDEV o WINDEV Mobile, o en el sitio WEBDEV. Los usuarios no necesitan establecer una nueva contraseña. 

- un modo avanzado de interconexión con Facebook para utilizar la API de Facebook desde una aplicación WINDEV o WINDEV Mobile, o desde un sitio WEBDEV. 




El principio es el mismo independientemente del modo de uso seleccionado. Es necesario: 

- Registrar la aplicación WINDEV o WINDEV Mobile, o el sitio WEBDEV en Facebook. 

- Utilizar las credenciales de inicio de sesión de Facebook en la aplicación WINDEV o WINDEV Mobile, o en el sitio WEBDEV. 

- Iniciar sesión en Facebook desde la aplicación WINDEV o WINDEV Mobile, o desde el sitio WEBDEV para autenticarse. 




Para el modo avanzado, puede utilizar diferentes funciones WLanguage que le permiten interactuar con Facebook a través de su API. 

Atención: Esta funcionalidad no está disponible para aplicaciones WINDEV en Linux. 



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Elementos disponibles en WLanguage
<a name="elementos_disponibles_wlanguage_ELTTEXTE000391"></a>
Los siguientes elementos WLanguage permiten interactuar con Facebook: 

- el tipo [fbSession](../WDLang5/1000021851.md). Este tipo de variable contiene todos los elementos necesarios para implementar la conexión y autenticación de Facebook.

- varias funciones: 
	


|   |   |
| --- | --- |
| [FBGetUserInformation](../WDLang5/1000021837.md) | Recupera la información de Facebook del usuario conectado. |
| [FBRequest](../WDLang5/1000021838.md) | Realiza una petición de comunicación (petición HTTP) al Facebook Graph API. |
| [FBSessionStatus](../WDLang5/1000021852.md) | Comprueba el estado de una sesión de Facebook. |
| [FBStartSession](../WDLang5/1000021835.md) | Permite autenticarse e iniciar sesión en Faceboook. |
| [FBStopSession](../WDLang5/1000021836.md) | Detiene la sesión de Facebook que se inició con [FBStartSession](../WDLang5/1000021835.md). |




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Registrar la aplicación en Facebook
<a name="registrar_aplicacion_facebook_ELTTEXTE000455"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 

### Registrar una aplicación WINDEV en Facebook
<a name="registrar_una_aplicacion_windev_facebook_ELTPARAGRAPHE000068"></a>

Primero, es necesario crear una aplicación Windows en WINDEV que utilice la autenticación de Facebook y/o la API de Facebook. 

Veamos los pasos a seguir (válidos al momento de escribir esta página): 

1. Vaya a "https://developers.facebook.com/". 

2. Inicie sesión. 

3. Regístrese si es necesario y siga los pasos. 

4. En "Mis apps", haga clic en "Crear app". 

5. En la página que aparece, seleccione "Consumidor". 

6. Haga clic en "Siguiente". 

7. En la página que aparece, especifique: 

	- El nombre de la aplicación en "Agrega un nombre para la app". 

	- Una dirección de correo electrónico válida en "Correo electrónico de contacto de la app". 




8. Confirme la creación de la aplicación (y valide el control de seguridad, si es necesario).   

9. La página de la nueva aplicación aparece.  

10. A continuación, haga clic en el menú "Configuración" y elija "Básica".  

11. Conserve el "Identificador de la app" y la "Clave secreta de la app". 

12. En el campo "Dominios de la app", introduzca "localhost". 

13. En la parte inferior de la página, haga clic en "Agregar plataforma" y seleccione "Website". 

14. Introduzca la URL del sitio: "http://localhost/". 

15. A continuación, haga clic en "Guardar cambios". 


La aplicación de Facebook está lista para las pruebas. 

En este punto, puede iniciar sesión en la aplicación con el usuario de Facebook que registró la aplicación (de forma predeterminada, el administrador).

Si desea incluir otros usuarios para las pruebas, haga clic en el menú "Roles" y agregue los usuarios con los permisos deseados (desarrolladores, evaluadores, etc.). También puede crear usuarios de prueba (opción "Usuarios de prueba") para no utilizar cuentas de Facebook existentes.

Para poder utilizar realmente la aplicación, debe establecerla como pública y enviarla a Facebook si es necesario (opción "Revisión de la app"). Para más información, consulte la documentación de Facebook. 

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Configurar la autenticación de Facebook en WINDEV, WINDEV Mobile y WEBDEV
<a name="configurar_autenticacion_facebook_windev_windev_mobile_webdev_ELTTEXTE000497"></a>


### Establecer la conexión
<a name="establecer_conexion_ELTPARAGRAPHE000217"></a>

Para iniciar sesión en Facebook, debe: 

1. Configurar una sesión de Facebook (variable de tipo [fbSession](../WDLang5/1000021851.md)). En las diferentes propiedades de esta variable se debe especificar: 

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) el "Identificador de la app" y la "Clave secreta de la app" proporcionados al registrar la aplicación en Facebook. 




2. Establecer la conexión con la función [FBStartSession](../WDLang5/1000021835.md).




Por ejemplo: 

```wl
MyConnection is fbSession
// Configure the session
MyConnection.AppID = "1664XXXXXXXXXXXX"
MyConnection.AppSecret = "c6e7XXXXXXXXXXXXXXXXX"
// Define the rights:
// - Read the email
// - Manage the pages
MyConnection.Permission = [fbEmail, "manage_pages", "publish_pages", "publish_actions"]
// Connection
FBStartSession(MyConnection)
```

Si la conexión es permanente, la función no muestra una pantalla de inicio de sesión y abre la sesión directamente.

Observaciones: 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) Una página Web se muestra en el navegador predeterminado para permitir a los usuarios introducir sus credenciales de inicio de sesión.

- Una sesión de Facebook iniciada es una sesión persistente: permanecerá abierta: 

	- hasta que se cierre la aplicación. 

	- hasta que se llame a la función [FBStopSession](../WDLang5/1000021836.md).








### Usar la API de Facebook
<a name="usar_api_facebook_ELTPARAGRAPHE000275"></a>

La función [FBRequest](../WDLang5/1000021838.md) permite enviar solicitudes a Facebook.

El siguiente ejemplo devuelve la lista de páginas y grupos administrados por el usuario actual:

```wl
sURL is ANSI string = GRAPHAPI + "me/accounts?local=en_US"
sJSON is ANSI string
vJSON is Variant

// Retrieves the pages managed by the user
sJSON = FBRequest(MyConnection, sURL)
vJSON = JSONToVariant(sJSON)
```

La función devuelve la respuesta JSON de Facebook.

A continuación, solo tiene que leer y acceder a los miembros de la API de Facebook: "[https://developers.facebook.com/docs/graph-api/reference](https://developers.facebook.com/docs/graph-api/reference)".

```wl
FOR i = 1 _TO_ vJSON.data..Count 
	ListAdd(LIST_PAGES, gStoredValue(i) + vJSON.data[i].name)
END
```



