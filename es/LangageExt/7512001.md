
## Lenguaje externo: Programación en C#
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000151"></a>
Vamos a llamar a los elementos desarrollados en WINDEV (proyecto, ventanas, análisis,...) desde el lenguaje C#.

**Recordatorio**: C# es un lenguaje de la plataforma.NET.

El código del lenguaje WLanguage usado desde el lenguaje externo será compilado dinámicamente y ejecutado durante su llamada.

Este modo es ilustrado por el proyecto City.cs (en formato C#) incluido en el subdirectorio "ExternalLanguages\\C#" del directorio WINDEV instalación.

**Observaciones**: 

- C# no le permite usar el motor HFSQL. Para manipular el motor HFSQL, realice los procesos necesarios en WINDEV.

- Compatible con las versiones 4.2 y 6.0 y posteriores de Visual C++.. 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Implementación
<a name="implementacion_ELTTEXTE000175"></a>


### Incluyendo los archivos de la interfaz C# de WINDEV
<a name="incluyendo_los_archivos_interfaz_windev_ELTPARAGRAPHE000029"></a>

El siguiente archivo debe encontrarse en el directorio de ejecución de su programa C# para poder llamar a la interfaz C# de WINDEV:

- WINDEV.CS

- wdxxxle.dll

- wdXXXICS.DLL




Los métodos de la clase WINDEV deben ser llamados y prefijados por "**WinDev.**":


```txt
WINDEV.CALLWD("LIBRA,Disk,city.wdl");
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Carga de la biblioteca WINDEV (WDL)
<a name="carga_biblioteca_windev_wdl_ELTTEXTE000199"></a>
La biblioteca WINDEV (.WDL) contiene todos los elementos del proyecto (ventanas, informes, clases, consultas, análisis,...). Por lo tanto, debe ser cargado en la memoria para que sus componentes puedan ser llamados.

**Atención**: Si hay que cargar ventanas fuera de la biblioteca, el código de cada una de estas ventanas debe incluirse en el correspondiente archivo ".WDW" ("Incluir el código compilado" debe marcarse en la pestaña "Detalles" de la description de cada ventana).


```txt
// Opening the library
// if WDInt is not null, the library was not found!
WINDEV.CALLWD("LIBRA,Disk,city.wdl");
if (WINDEV.WDInt() == 0)
{
	...
}
else 
{
	// Library not found 
	WINDEV.CALLWD("Error, Library not found");
}
// Terminate... 
WINDEV.WDEnd();
```


<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Ejecutar códigos WINDEV desde el idioma externo
<a name="ejecutar_codigos_windev_desde_idioma_externo_ELTTEXTE000223"></a>


### 1. Llamar a un código de WLanguage
<a name="1_llamar_codigo_wlanguage_ELTPARAGRAPHE000057"></a>

Todas las funciones WLanguage se pueden llamar desde el idioma externo. El comportamiento de estas funciones WLanguage, así como los valores devueltos, son idénticos tanto si se llaman:

- de WINDEV o

- desde la interfaz del lenguaje externo




Para conocer los parámetros y los valores de retorno de una función WLanguage, consulte la ayuda en línea o la documentación sobre WLanguage.

Puede utilizar [LLAMADA](../LangageExt/7510001.md) para llamar a un Procedure WLanguage desde la interfaz externa. Por ejemplo:


```txt
// Open the first window of the program that contains the menu
WINDEV.CALLWD("OPEN,menufc.wdw");
```

<a name="NOTE4_2"></a>


### 2. Recuperación de los eventos lanzados en las ventanas WINDEV
<a name="2_recuperacion_los_eventos_lanzados_las_ventanas_windev_ELTPARAGRAPHE000076"></a>

La entrada en las ventanas WINDEV requiere recuperar los eventos desencadenados en estas ventanas.

Para recuperar los eventos del usuario (clic en un menú, en un botón, etc.), debe implementar un sistema basado en un bucle en su programa C#. Este bucle permanecerá Active mientras se abra la ventana WINDEV y se utilizará para interceptar cada acción del usuario.

Para averiguar el tipo de acción que realiza el usuario, tiene la posibilidad de utilizar una cadena de caracteres Variable (en WLanguage) llamada **'WDKey**'. Esta Variable se usará en su código WLanguage para señalar al programa C# el botón que fue presionado por ejemplo.

Ejemplo: Código C


```txt
// Open the first window of the program that contains the menu
	WINDEV.CALLWD("OPEN,menufc.wdw");
	// the program loops until the File Exit option
	// is selected
	while (bInput)
	{
		// perform the input of the menu 
		WINDEV.CALLWD("Screen,Input");
		// the status report WDKey is set to *M* when a menu choice
		//was selected
		string szOption = WINDEV.WDKey();
		if (szOption = "*M*")
		{
			...
		}
	}
	WINDEV.APPELWD("FERME");
```


Código para interceptar la selección de "File...Exit" de la ventana "Menu" de WINDEV:


```txt
// cancelation 
	if (WINDEV.WDKey() == "FE")
	{
		bInput = false;
	}
```


Cuando el usuario selecciona "Archivo... Salir":

- **WDKey** regresará "\*M\*".

- **WDString** devolverá las letras de acceso directo en el orden en que se seleccionen los menús. En nuestro ejemplo, **WDString** devuelve "FE".




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Finalización de la aplicación
<a name="finalizacion_aplicacion_ELTTEXTE000253"></a>
Para finalizar el uso de la interfaz externa, escriba las siguientes líneas de código:


```txt
// Terminate... 
WINDEV.WDEnd();
```



