
## Lección 4.6. Imprimir una lista de clientes
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Esta lección abarcará los siguientes temas
<a name="esta_leccion_abarcara_los_siguientes_temas_ELTTEXTE000277"></a>


- Crear un reporte con rupturas.

- Imprimir un reporte.





|   |   |
| --- | --- |
| <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=dur%E9e.png)<br> | <br>Tiempo estimado: 20 min |

| [Lección anterior](../TutoWD/1410087536.md) | [Tabla de contenido](../TutoWD/1410087560.md) | [Siguiente lección](../TutoWD/1410087538.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000324"></a>
Esta lección le mostrará cómo imprimir una lista de clientes, agrupados por país y por departamento o provincia. 

Para ello, vamos a utilizar un reporte de tipo tabla que permite mostrar una lista de datos de forma clara.

- Abra de nuevo el proyecto en el que trabajó en la lección anterior. 

	1. Vaya a la página de inicio de WINDEV (Ctrl + &lt;).

	2. En la página de inicio, haga clic en "Tutorial", luego en "Part 4 - Full application with data" haga doble clic en "Full application - Exercise".

	3. Un cuadro de diálogo le pide que abra el proyecto en el que trabajó en la lección anterior. Puede abrir la copia local o el proyecto original. Seleccione "Abrir la copia local". 





|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=exemple-WD.png) | Corregido | Hay un proyecto completado disponible. Este proyecto contiene los diferentes reportes creados en esta lección. Para abrir el proyecto completado, vaya a la página de inicio y haga clic en "Tutorial", luego en "Part 4 - Full application with data", haga doble clic en "Full application - Answers". |





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Crear un reporte
<a name="crear_reporte_ELTTEXTE000366"></a>


- Para crear un reporte: 

	1. Haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ICO_Cr%E9er1_GAF.jpg) en los botones de acceso rápido.

	2. La ventana de creación de nuevos elementos se abre: haga clic en "Reporte", y luego en "Reporte". El asistente de creación de reportes se abre. El asistente muestra varios tipos de reportes:  <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Appli%20compl%E8te%20-%20Imprimer%20liste%20clients%20-%20HC%20N%B0001.jpg&type=thumb)


	3. Seleccione "Tabla". Pase a la etapa siguiente.

4. Seleccione la fuente de datos del reporte. El reporte se basará en el archivo de datos Customer. Seleccione "Un archivo de datos o una consulta existente". <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Appli%20compl%E8te%20-%20Imprimer%20liste%20clients%20-%20HC%20N%B0002.jpg&type=thumb)
Pase a la etapa siguiente.

5. En la lista de archivos de datos y consultas, seleccione "Customer".. Pase a la etapa siguiente.

6. Defina la clave de búsqueda del archivo de datos. En nuestro caso, el archivo de datos Customer se recorrerá utilizando el nombre completo del cliente. Seleccione la clave de búsqueda "FullName". <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Appli%20compl%E8te%20-%20Imprimer%20liste%20clients%20-%20HC%20N%B0003.jpg&type=thumb)
Pase a la etapa siguiente.

7. A continuación, definiremos las opciones para ordenar los datos en el reporte. De forma predeterminada, el asistente propone el elemento utilizado como clave de búsqueda del archivo de datos. Como vamos a crear un reporte con una lista de clientes por país y provincia (departamento), vamos a definir estos dos campos como criterio de ordenación.

8. Para definir el país como criterio de ordenación:

	- Haga clic en el botón "Agregar" y seleccione "Criterio de ordenación" para agregar un campo de ordenación.

	- En la ventana que se muestra, seleccione el campo Customer.Country.  <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Appli%20compl%E8te%20-%20Imprimer%20liste%20clients%20-%20HC%20N%B0004.jpg)


Hemos terminado de crear el reporte. Vamos a probar el reporte para ver el resultado.



- Ejecute el reporte haciendo clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ICO_GO_Fenetre_WD_GAF.jpg) en los botones de acceso rápido. Puede seleccionar uno de los siguientes destinos:  <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Appli%20compl%E8te%20-%20Imprimer%20liste%20clients%20-%20HC%20N%B0011.jpg)





- Seleccione "Visor de reportes" y valide. El reporte se ejecuta y muestra en el visor de reportes.  <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Appli%20compl%E8te%20-%20Imprimer%20liste%20clients%20-%20HC%20N%B0012%201.jpg&type=thumb)





Puede imprimir directamente la página actual o todo el documento haciendo clic en la impresora (pestaña "Imprimir").

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Imprimir el reporte mediante programación
<a name="imprimir_reporte_mediante_programacion_ELTTEXTE000426"></a>
Una vez que el reporte esté completo, crearemos un menú en la ventana "WIN_Menu" para imprimirlo directamente.

- Para insertar un menú en la ventana "WIN_Menu":

	1. Abra la ventana "WIN_Menu" en el editor (haga doble clic en ella en el panel "Explorador de proyectos").

	2. En la pestaña "Menú principal", en el grupo "Barras y menús", despliegue "Ventana" y seleccione "Agregar menú principal".

	3. Un menú se inserta en la ventana, debajo de la barra de título. Este menú contiene una opción llamada "Menú".

	4. Seleccione la opción "Menú":

		- Haga clic derecho para abrir el menú contextual.

		- Seleccione la opción "Agregar después".




5. En el área de entrada, escriba "Reports".  <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Appli%20compl%E8te%20-%20Imprimer%20liste%20clients%20-%20HC%20N%B0013.jpg)




- Para escribir el código WLanguage de la opción "List of customers":

	1. Seleccione la opción "List of customers".

	2. Haga clic derecho para abrir el menú contextual.

	3. Seleccione "Código". El editor de código se abre.

	4. Escriba el siguiente código en el evento "Selección del menú":
			
		```wl
		// The report is displayed in the report viewer
		iDestination(iViewer)
		
		// Prints the report
		RPT_list_of_customers.Print()
		```
Analicemos este código:

		- La función [iDestination](../WDLang5/3046074.md) permite configurar el destino de la impresión. Puede generar un reporte para imprimirlo:

			- en un archivo de texto,

			- en formato HTML,

			- en formato PCL,

			- en formato PDF, RTF, XLS o XML,

			- en un fax.


En este caso, el reporte se generará en la ventana del visor de reportes.

- La función [&lt;Reporte&gt;.Print](../WDLang5/1000024554.md) permite imprimir el reporte.




- Pruebe la ventana y sus opciones de menú haciendo clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ICO_GO_Fenetre_WD_GAF.jpg) en los botones de acceso rápido.




- Vamos a una agregar una opción de menú para salir de la aplicación.

	1. En el editor, seleccione la opción "Menu".

	2. Haga clic derecho para abrir el menú contextual y seleccione la opción "Transformar para expandir un submenú".

	3. En el área de entrada que aparece, escriba "Exit".

	4. Vamos a asociar esta opción de menú con el método abreviado de teclado "Alt + F4":

		- Seleccione la opción "Exit".

		- Haga clic derecho para abrir el menú contextual y seleccione la opción "Descripción de la opción".

		- En la pestaña "General", en la sección "Atajo de teclado", seleccione "F4" y marque la casilla "Alt".  <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Appli%20compl%E8te%20-%20Imprimer%20liste%20clients%20-%20HC%20N%B0015.jpg)


		- Valide.

5. Abra el código WLanguage de la opción y escriba el siguiente código en el evento "Selección del menú":
			
		```wl
		// Requires user confirmation to exit the application
		IF YesNo(No, "Exit application?") = Yes THEN
			// End of application
			EndProgram()
		END
		```
Analicemos este código WLanguage:

	- La función [YesNo](../WDLang1/3021005.md) establece un diálogo con el usuario mediante una pregunta. El usuario puede responder a la pregunta haciendo clic en uno de los botones: sí o no.

	- La función [EndProgram](../WDLang1/3013033.md) (llamada si el usuario hace clic en "Sí") permite finalizar la aplicación.




- Pruebe la ventana haciendo clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ICO_GO_Fenetre_WD_GAF.jpg) en los botones de acceso rápido.




| [Lección anterior](../TutoWD/1410087536.md) | [Tabla de contenido](../TutoWD/1410087560.md) | [Siguiente lección](../TutoWD/1410087538.md) |
| --- | --- | --- |




