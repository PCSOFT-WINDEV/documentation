
## Lección 4.14. Distribuir "Reports and Queries" con las aplicaciones
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Esta lección abarcará los siguientes temas
<a name="esta_leccion_abarcara_los_siguientes_temas_ELTTEXTE000431"></a>


- ¿Para que sirve el programa "Reports and Queries"?

- Cómo distribuir "Reports and Queries".

- Cómo utilizar "Reports and Queries". 





|   |   |
| --- | --- |
| <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=dur%E9e.png)<br> | <br>Tiempo estimado: 10 min |



|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=vierge.png) | Express | "Reports & Queries" no está disponible en la versión Express. |





| [Lección anterior](../TutoWD/1410087528.md) | [Tabla de contenido](../TutoWD/1410087560.md) | [Siguiente lección](../TutoWD/1410087530.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Presentación de "Reports and Queries"
<a name="presentacion_reports_and_queries_ELTTEXTE000496"></a>
"Reports and Queries" permite a los usuarios modificar y crear reportes y consultas en sus aplicaciones.

¿Falta alguna información en el reporte estándar? " Reports and Queries" permite a los usuarios añadir información desde el visor de reportes. ¿Este cambio puede ser útil para otros usuarios? El reporte puede ponerse a disposición de todos los usuarios que utilicen la aplicación en la red. El mismo principio se aplica a las consultas.|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=note.png) | Nota | "Reports and Queries" es gratuito y puede distribuirse con las aplicaciones desarrolladas con WINDEV. Para obtener más información sobre las condiciones de distribución y uso, consulte la licencia. |





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Iniciar "Reports and Queries"
<a name="iniciar_reports_and_queries_ELTTEXTE000538"></a>
Para que los usuarios puedan personalizar los reportes de su aplicación o crear sus propios reportes y consultas, inicie "Reports and Queries".

Para que los usuario finales abran "Reports and Queries":

- abra los reportes en el visor de reportes. Los usuarios finales podrán iniciar "Reports and Queries" haciendo clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Diffuser%20EtatsRequetes%20-%20HC%20N%B0006%201%202.jpg).

- agregue el menú de ayuda automática '?' a la ventana principal de la aplicación: en la pestaña "Ventana", en el grupo "Barras y menús", despliegue "Menú principal" y seleccione "Agregar menú '?'".
	En el asistente de creación del menú, seleccione las opciones "Crear, modificar un reporte" y "Crear, modificar una consulta".

- utilice la función [RunReportsAndQueries](../WDLang1/3013067.md) en su aplicación.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Distribuir "Reports and Queries" con las aplicaciones
<a name="distribuir_reports_and_queries_con_las_aplicaciones_ELTTEXTE000562"></a>
Para distribuir "Reports and Queries" con una aplicación WINDEV, es necesario:

- indicar en el proyecto que la aplicación permite ejecutar "Reports and Queries".

- definir en el análisis los archivos y campos que se pueden utilizar en "Reports and Queries".

- definir los reportes y consultas que se pueden modificar en "Reports and Queries".

- crear el ejecutable y el programa de instalación que contienen "Reports and Queries".




Vamos a ver estas etapas con más detalle utilizando el proyecto "WD Full Application". 

- Abra de nuevo el proyecto en el que trabajó en la lección anterior. 

	1. Vaya a la página de inicio de WINDEV (Ctrl + &lt;).

	2. En la página de inicio, haga clic en "Tutorial", luego en "Part 4 - Full application with data" haga doble clic en "Full application - Exercise".

	3. Un cuadro de diálogo le pide que abra el proyecto en el que trabajó en la lección anterior. Puede abrir la copia local o el proyecto original. Seleccione "Abrir la copia local". 





|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=exemple-WD.png) | Corregido | **Hay un proyecto completado disponible. Este proyecto le permite realizar las diferentes operaciones de esta lección (si no ha seguido las lecciones anteriores)**. Para abrir el proyecto completado, vaya a la página de inicio y haga clic en "Tutorial", luego en "Part 4 - Full application with data", haga doble clic en "Full application - Answers". |








<a name="NOTE4_2"></a>


### Configuración del proyecto
<a name="configuracion_del_proyecto_ELTPARAGRAPHE000097"></a>

- Para utilizar "Reports and Queries" desde su aplicación, debe configurar el proyecto asociado a su aplicación.

	1. Abra la descripción del proyecto "WD Full Application". 
			Recordatorio: Para abrir la descripción del proyecto, en la pestaña "Proyecto", en el grupo "Proyecto", haga clic en "Descripción".

	2. En la pestaña "Avanzado", haga clic en "Habilitar "Reports and Queries"".  <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Diffuser%20EtatsRequetes%20-%20HC%20N%B0001%201.jpg&type=thumb)


	3. Valide.



<a name="NOTE4_3"></a>


### Configuración del análisis
<a name="configuracion_del_analisis_ELTPARAGRAPHE000127"></a>

Vamos a abrir el análisis para configurar los archivos de datos y campos que se pueden utilizar en "Reports and Queries".



- Abra el análisis de su proyecto: haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ICO_Analyse_GAF.jpg) en los botones de acceso rápido del menú de WINDEV.




De forma predeterminada, todos los archivos de datos y campos se pueden ver y manipular en "Reports and Queries". Si su aplicación contiene datos sensibles (contraseñas, etc.), los archivos de datos o campos pueden definirse como invisibles en "Reports and Queries".|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=note.png) | Nota | "Reports and Queries" no permite a los usuarios agregar, modificar o eliminar registros (las funciones [HAdd](../WDLang4/3044147.md), [HModify](../WDLang4/3044042.md) y [HDelete](../WDLang4/3044018.md) no están permitidas). Asimismo, no es posible crear o volver a crear archivos de datos (las funciones [HCreation](../WDLang4/3044255.md) y [HCreationIfNotFound](../WDLang4/3044254.md) no están permitidas). |







- Para definir como invisible un archivo de datos en "Reports and Queries":

	1. En el editor de análisis, seleccione el archivo de datos deseado.

	2. Abra la ventana de descripción del archivo de datos (seleccione "Descripción del archivo de datos" en el menú contextual).

	3. En la pestaña "Reports and Queries", deseleccione la opción "Visible para el usuario final en "Reports and Queries"".

	4. Valide.







- Para definir como invisible un campo en "Reports and Queries":

	1. En el editor de análisis, seleccione el archivo de datos deseado.

	2. Abra la ventana de descripción de los campos del archivo de datos (seleccione "Descripción de los campos" en el menú contextual).

	3. Seleccione el campo deseado en la lista de campos.

	4. En la pestaña "Reports and Queries", deseleccione la opción "Visible para el usuario final en "Reports and Queries"".

	5. Valide.







- Para tener en cuenta las modificaciones realizadas en el análisis, debe regenerar el análisis (en la pestaña "Análisis", en el grupo "Análisis", haga clic en "Generación"). A continuación, se abre una ventana para guardar los cambios realizados en los archivos de datos.



<a name="NOTE4_4"></a>


### Configuración de reportes
<a name="configuracion_reportes_ELTPARAGRAPHE000200"></a>

Al crear un reporte, puede especificar si se puede modificar en "Reports and Queries".



- Para permitir que se modifique el reporte "RPT_List_of_customers" del proyecto "WD Full Application" en "Reports and Queries":

	1. Abra el reporte "RPT_List_of_customers" en el editor de reportes.

	2. Abra la descripción del reporte (seleccione "Descripción del reporte" en el menú contextual).

	3. En la pestaña "Opciones", seleccione "Permitir la edición del reporte en Reports and Queries".

	4. A continuación, seleccione una de las siguientes opciones:

		- "Editar interfaz únicamente" para permitir que solo se edite la interfaz del reporte en Reports and Queries.

		- "Editar todo (interfaz y código)" para que el reporte sea totalmente editable en Reports and Queries.  <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Diffuser%20EtatsRequetes%20-%20HC%20N%B0002.jpg&type=thumb)






<a name="NOTE4_5"></a>


### Configuración de consultas
<a name="configuracion_consultas_ELTPARAGRAPHE000224"></a>

De forma predeterminada, una consulta se puede modificar en "Reports and Queries".

- Para permitir que la consulta "QRY_OrderForm" del proyecto "WD Full Application" se pueda modificar en "Reports and Queries":

	1. Abra la consulta "QRY_OrderForm" en el editor de consultas.

	2. Abra la descripción de la consulta (seleccione "Descripción de la consulta" en el menú contextual del esquema de la consulta).

	3. Haga clic en el botón "Avanzado" (en las "Acciones").

	4. En la pestaña "Reports and Queries", seleccione la opción "Visible en Reports & Queries".

	5. Valide y guarde la consulta.






<a name="NOTE4_6"></a>


### Crear el ejecutable y distribuir la aplicación
<a name="crear_ejecutable_distribuir_aplicacion_ELTPARAGRAPHE000239"></a>

Una aplicación que utiliza "Reports and Queries" se distribuye como cualquier otra aplicación. Puede especificar los parámetros específicos de "Reports and Queries" al crear el procedimiento de instalación. 



- Para crear el programa de instalación de WD Full Application:

	1. En la pestaña "Proyecto", en el grupo "Generación", haga clic en "Procedimiento de instalación". El asistente de creación de instalaciones se abre. Haga clic en "Instalación" a la izquierda de asistente.

	2. Seleccione "Crear ejecutable ahora". El ejecutable se crea.
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=note.png) | Nota | Si el asistente propone crear el archivo de ayuda, valide los diferentes mensajes. |





	3. El asistente de creación de instalaciones se abre.

	4. Seleccione "Instalación individual". Pase a la etapa siguiente.

	5. Seleccione "Instalación estándar". Pase a la etapa siguiente.

	6. Valide el directorio de instalación predeterminado y pase a la etapa siguiente.

	7. En la etapa "Archivos instalados", seleccione (si es necesario) los archivos de datos (.fic, .mmo y .ndx) que se encuentran en el directorio del ejecutable. Para ello, haga clic en "Agregar" y seleccione los archivos correspondientes.  <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_D%E9ployer%20l'application%20-%20HC%20N%B0006.jpg&type=thumb)


	8. Haga clic en "Complementos" a la izquierda.

9. En la ventana "Módulos adicionales", asegúrese de que la opción "Incluir instalación de Reports and Queries (atención: voluminoso)" está seleccionada.

10. Pase a la etapa siguiente. 

11. En la etapa "Reports and Queries":

	- Especifique si desea incluir la instalación de "Reports and Queries" en el programa de instalación.
						En este caso, se utilizará el paquete de instalación de "Reports and Queries" (ubicado en el subdirectorio "Reports and Queries" del directorio de instalación de WINDEV).
						Es posible: 

		- Proponer instalar "Reports and Queries" con la aplicación.

		- Proponer instalar "Reports and Queries" cuando se utilice por primera vez.




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Instalar y utilizar "Reports and Queries"
<a name="instalar_utilizar_reports_and_queries_ELTTEXTE000670"></a>


### Instalar la aplicación
<a name="instalar_aplicacion_ELTPARAGRAPHE000299"></a>

Para probar la instalación y "Reports and Queries", instalaremos la aplicación "WD Full Application".

El programa de instalación de la aplicación se generó siguiendo las etapas del párrafo anterior. La instalación se creó en el subdirectorio "Install" del proyecto actual.

- En la última ventana de creación de la instalación, haga clic en el botón "Probar". Si cerró esta ventana, ejecute el programa "Install.exe" ubicado en el directorio del programa de instalación. La instalación de la aplicación se abre.




- Vamos a seguir las diferentes etapas del programa de instalación de la aplicación "WD Full Application".

	1. Si el UAC está habilitado, aparece una ventana para autorizar la ejecución del programa. Valide la ventana.

	2. El asistente de instalación se abre. 
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=note.png) | Nota | Puede cambiar el idioma de instalación mediante el cuadro combinado ubicado en la esquina superior derecha del asistente.  <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_D%E9ployer%20l'application%20-%20HC%20N%B0008.jpg)<br> |




			Existen dos modos de instalación: 

		- Instalación rápida: La instalación utiliza los parámetros definidos por el proveedor de la aplicación. 

		- Instalación personalizada: El asistente permite al usuario seleccionar los parámetros de instalación de la aplicación. 




3. Seleccione "Instalación personalizada". El asistente indica que se debe especificar el directorio de instalación de la aplicación. 

4. Si es necesario, seleccione el directorio de instalación de la aplicación y pase a la etapa siguiente. 

5. La etapa "Reports and Queries" permite instalar el programa "Reports and Queries". <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Diffuser%20EtatsRequetes%20-%20HC%20N%B0004.jpg&type=thumb)
Seleccione la opción "Instalar 'Reports and Queries'" y especifique el directorio de instalación. 
			Observación: Si hay una versión anterior de "Reports and Queries" instalada en el equipo, puede hacer una copia de seguridad de dicha versión. 

6. Pase a la etapa siguiente.

7. La etapa siguiente permite definir los directorios en los que se guardarán los reportes y consultas (si se seleccionó la opción "Permitir que estos directorios se modifiquen durante la instalación" en el asistente de creación del programa de instalación).  <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Diffuser%20EtatsRequetes%20-%20HC%20N%B0005.jpg&type=thumb)



<a name="NOTE5_2"></a>


### Prueba de la aplicación
<a name="prueba_aplicacion_ELTPARAGRAPHE000339"></a>

Ahora vamos a probar la aplicación desde la perspectiva del usuario.

- Para probar la aplicación:

	1. Abra la aplicación "WD Full Application".

	2. Seleccione la opción "Reports .. List of customers". El reporte se muestra en el visor de reportes. Haga clic en la pestaña "Vista previa".  <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Diffuser%20EtatsRequetes%20-%20HC%20N%B0006.jpg&type=thumb)


	3. En la vista previa se muestran dos nuevos íconos:
			




- Vamos a modificar el reporte:

	1. Haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Diffuser%20EtatsRequetes%20-%20HC%20N%B0006%201%202.jpg).

	2. El reporte se muestra en modo de edición en "Reports and Queries".  <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Diffuser%20EtatsRequetes%20-%20HC%20N%B0007.jpg&type=thumb)


	3. Los usuarios pueden hacer sus propios cambios:

	- cambiar el estilo de la información que se muestra (el color de un control, por ejemplo).

	- cambiar el contenido del reporte (agregar un control, por ejemplo). Si el reporte está relacionado con una consulta, el usuario puede modificar dicha consulta. 

		- Si el reporte está relacionado con una consulta incrustada, la modificación se realiza directamente en el reporte. 

		- Si el reporte está relacionado con una consulta independiente, la consulta también se modifica. Los cambios se tendrán en cuenta únicamente al ejecutar el reporte (si una ventana también utiliza esta consulta, no tendrá en cuenta los cambios).




- En este ejemplo, vamos a resaltar la fecha en rojo. Para ello:

	1. Seleccione el control de fecha en el inicio de documento.

	2. En la pestaña "Modificación", en el grupo "Edición rápida", haga clic en el ícono "Color". En la ventana que aparece, seleccione el color rojo y valide. 

	3. Guarde el reporte. El directorio predeterminado corresponde al directorio de instalación de la aplicación.

	4. Cierre "Reports and Queries".

	5. Seleccione la opción "Reports .. List of customers". La modificación se realizó correctamente y el reporte se muestra en "Reports and Queries".





En este ejemplo, el reporte modificado solo está disponible para usted. En el caso de una aplicación en la red, el usuario puede compartir un reporte modificado con otros usuarios.

Ya hemos visto cómo utilizar "Reports and Queries". 
Para obtener más información, consulte [Editor de reportes del usuario (Reports and Queries)](../Presentation/3088004.md).

<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Conclusión
<a name="conclusion_ELTTEXTE000718"></a>
La fase de desarrollo de nuestra aplicación ha concluido. Las siguientes lecciones le permitirán descubrir:

- cómo transformar una aplicación en una aplicación multilingüe,

- cómo integrar la aplicación en el Administrador de Código Fuente (SCM). 




| [Lección anterior](../TutoWD/1410087528.md) | [Tabla de contenido](../TutoWD/1410087560.md) | [Siguiente lección](../TutoWD/1410087530.md) |
| --- | --- | --- |




