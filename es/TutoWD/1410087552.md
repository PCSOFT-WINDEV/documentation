
## Lección 7.5. Evento de Windows
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Esta lección abarcará los siguientes temas
<a name="esta_leccion_abarcara_los_siguientes_temas_ELTTEXTE000164"></a>


- Programación de eventos de Windows.





|   |   |
| --- | --- |
| <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=dur%E9e.png)<br> | <br>Tiempo estimado: 10 min |



| [Lección anterior](../TutoWD/1410087551.md) | [Tabla de contenido](../TutoWD/1410087560.md) | [Siguiente lección](../TutoWD/1410087553.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Introducción
<a name="introduccion_ELTTEXTE000211"></a>
Cada acción realizada por Windows corresponde a un evento de Windows. Pueden ocurrir diferentes tipos de eventos, por ejemplo:

- El cursor pasa por encima de una ventana,

- El sistema se detiene,

- Se muestra una ventana de diálogo,

- Un error de software,

- Etc.




Cuando se producen estos eventos, es posible interceptarlos para preparar o ejecutar un proceso específico.

WINDEV puede gestionar automáticamente los eventos más comunes. Por ejemplo, los siguientes eventos están disponibles de forma predeterminada para los controles Campo de entrada:

- Inicialización del control,

- Entrada en el control,

- Modificación del control,

- Salida del control.




Para utilizar eventos adicionales, es posible:

- utilizar los eventos opcionales disponibles en WINDEV.

- utilizar los eventos de Windows.



<a name="NOTE2_2"></a>


### Ejemplo práctico
<a name="ejemplo_practico_ELTPARAGRAPHE000048"></a>

La gestión de eventos se presentará a través del ejemplo unitario "The Event function".



- Abra el ejemplo unitario "The Event function". 




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Eventos opcionales disponibles en WINDEV
<a name="eventos_opcionales_disponibles_windev_ELTTEXTE000241"></a>
WINDEV incluye varios eventos opcionales para cada elemento (ventana, control, etc.).



- Para añadir un evento opcional:

	1. Abra los eventos WLanguage asociados al control List Box en la ventana del ejemplo unitario:

		- Seleccione el control List Box.

		- Presione F2.

		- El editor de código se abre.




2. Haga clic en el enlace "Agregar otros eventos...": <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P7_Exemple%20Ev%E9nement%20-%20HC%20N%B0001%201.jpg)




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Eventos de Windows
<a name="eventos_windows_ELTTEXTE000265"></a>
Para añadir eventos más "específicos", puede utilizar la función [Event](../WDLang1/3015011.md) de WLanguage. La función [Event](../WDLang1/3015011.md) permite asociar un procedimiento WLanguage a un evento de Windows.|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=note.png) | Nota | Para utilizar la función [Event](../WDLang1/3015011.md), debe estar familiarizado con la programación de Windows, especialmente con los eventos de Windows. |




Para obtener la lista (no exhaustiva) de eventos de Windows, consulte [Valor de las constantes de la API de Windows de 32 bits](../AppelDLL/6510001.md).
<a name="NOTE4_2"></a>


### Ejemplo : Detectar el clic en un control List Box
<a name="ejemplo_detectar_clic_control_list_box_ELTPARAGRAPHE000104"></a>

- Pruebe la ventana "WIN_Event_Function". Esta ventana detecta si el control List Box se manipula con el ratón o con el teclado.

	1. Haga clic en el control List Box.

	2. Use el ratón para mover la banda de selección.

	3. Un mensaje aparece indicando si se utilizó el ratón o el teclado. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P7_Exemple%20Ev%E9nement%20-%20HC%20N%B0002.jpg)


	4. Detenga la prueba y vuelva al editor.




- Veamos el código utilizado:

	1. Haga clic en la ventana.

	2. Abra los eventos de la ventana (pulse F2).

	3. Veamos el evento "Declaraciones globales" de "WIN_Event_Function".

		- Primero, la siguiente línea de código:
						
			```wl
			EXTERN "WINCONST.WL"
			```
Esta línea de código permite incluir el contenido del archivo WINCONST.WL en el código de la aplicación mediante la palabra clave EXTERN. Este archivo contiene la declaración y los valores de las constantes de Windows. Durante la compilación, el código del archivo WINCONST.WL se incluirá automáticamente en el código de la aplicación. 

		- A continuación, se declaran todos los eventos admitidos:
						
			```wl
			// Events on the LIST_Months control
			// Keyboard key down
			Event(MouseOrKeyboard, LIST_Months.FullName, WM_KEYDOWN) 
			// Left mouse click
			Event(MouseOrKeyboard, LIST_Months.FullName, WM_LBUTTONDOWN)
			```
El procedimiento ***MouseOrKeyboard*** se llama cuando se utiliza el teclado en el control List Box (evento de Windows correspondiente: WM_KEYDOWN) o cuando se pulsa el botón izquierdo del ratón (evento de Windows correspondiente: WM_LBUTTONDOWN). 




4. El procedimiento ***MouseOrKeyboard*** es un procedimiento interno. El código de este procedimiento se encuentra justo después del evento "Declaraciones globales". Este código es muy sencillo:

	- Si se utiliza el teclado, el texto que aparece debajo del control List Box contiene "Selection with the keyboard".

	- Si se utiliza el ratón, el texto que aparece debajo del control List Box contiene "Selection with the mouse".
						
			```wl
			INTERNAL PROCEDURE MouseOrKeyboard()
			// The _EVE.wMessage variable contains the message number
			SWITCH _EVE.wMessage
				// Keyboard
				CASE WM_KEYDOWN
					// Message indicating that the keyboard is used
					STC_SelectionType = "Selection with the keyboard"
					STC_SelectionType.Color = LightRed
					
				// It's the mouse
				CASE WM_LBUTTONDOWN	
					// Message indicating that the mouse is used
					STC_SelectionType = "Selection with the mouse"
					STC_SelectionType.Color = LightBlue	
			END
			```





| [Lección anterior](../TutoWD/1410087551.md) | [Tabla de contenido](../TutoWD/1410087560.md) | [Siguiente lección](../TutoWD/1410087553.md) |
| --- | --- | --- |




