
## Lección 7.3. Manipular archivos externos
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Esta lección abarcará los siguientes temas
<a name="esta_leccion_abarcara_los_siguientes_temas_ELTTEXTE000249"></a>


- Manipular archivos de texto (CSV, etc.).

- Manipular directorios.

- Manipular archivos XML.

- Manipular archivos XLS.





|   |   |
| --- | --- |
| <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=dur%E9e.png)<br> | <br>Tiempo estimado: 20 min |

| [Lección anterior](../TutoWD/1410087549.md) | [Tabla de contenido](../TutoWD/1410087560.md) | [Siguiente lección](../TutoWD/1410087551.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000296"></a>
WINDEV le permite manipular fácilmente los formatos de datos más comunes: 

- archivos de texto (INI, CSV, etc.),

- archivos XML, 

- archivos XLS, etc. 


Se pueden utilizar varias familias de funciones WLanguage para leer y crear estos archivos. Esto le permite leer fácilmente los datos generados por otro software en sus aplicaciones WINDEV o crear archivos que requieren un formato específico.

Además, puede utilizar varias funciones WLanguage para manipular los directorios que contienen los archivos.

En este capítulo, nos centraremos en:

- archivos de texto (archivos de texto, archivos INI y archivos CSV),

- archivos XML, 

- archivos XLS,

- la gestión de directorios.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Manipular archivos de texto o CSV
<a name="manipular_archivos_texto_csv_ELTTEXTE000320"></a>


### Presentación
<a name="presentacion_ELTPARAGRAPHE000047"></a>

Los archivos externos también se denominan archivos de texto o archivos con acceso directo. En la mayoría de los casos, este tipo de archivos contienen texto, pero también pueden contener información binaria como imágenes, sonidos, etc.

En esta lección, al igual que en toda la documentación de WINDEV, nos referiremos a ellos como **archivos externos**.

WINDEV le permite manipular archivos externos mediante programación. Algunas funciones WLanguage permiten crear, leer y manipular archivos externos. Estas funciones se pueden identificar fácilmente: todas comienzan con la letra "f".

En un archivo externo, no necesariamente existe la noción de "registro". Para manipular un archivo externo, hay que conocer su estructura, es decir, cómo están organizados los datos dentro del archivo.

Los archivos CSV son archivos de texto que utilizan una estructura específica. Por lo tanto, pueden manipularse como archivos de texto.

Los archivos .INI también son archivos de texto que utilizan una estructura específica. Para manipularlos, WINDEV incluye dos funciones específicas: [INIRead](../WDLang1/3013043.md) y [INIWrite](../WDLang1/3013039.md).
<a name="NOTE3_2"></a>


### Ejemplo práctico
<a name="ejemplo_practico_ELTPARAGRAPHE000070"></a>

- Abra el ejemplo unitario "Handling text files". 




- Pruebe la ventana "WIN_Text_File". Esta ventana agrupa las diferentes operaciones que se pueden realizar en los archivos externos con WINDEV. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P7_Exemple%20Fichiers%20Texte%20-%20HC%20N%B0001.jpg&type=thumb)



Los diferentes botones de la ventana le permiten:

- Crear un archivo de texto.

- Leer y escribir en un archivo de texto.

- Manipular archivos existentes (copiar, eliminar, leer información, etc.). 

- Copiar un archivo de texto.




Para obtener más información sobre las funciones de manejo de archivos externos, consulte [Funciones para manipular directorios y archivos externos](../WDLang1/3036034.md).

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Manipular directorios
<a name="manipular_directorios_ELTTEXTE000350"></a>
WLanguage incluye varias funciones para manipular directorios y archivos.
<a name="NOTE4_2"></a>


### Ejemplo práctico
<a name="ejemplo_practico_ELTPARAGRAPHE000099"></a>

- Abra el ejemplo unitario "Handling directories" y pruebe la ventana correspondiente.




- Esta ventana agrupa las operaciones que se pueden realizar en discos y directorios:

	- crear un directorio,

	- obtener el directorio actual,

	- comprobar la existencia de un directorio,

	- mostrar la lista de directorios,

	- copiar y eliminar directorios, etc.







Para obtener más información sobre las funciones de gestión de directorios, consulte [Funciones para manipular directorios y archivos externos](../WDLang1/3036034.md).

<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Manipular archivos XML
<a name="manipular_archivos_xml_ELTTEXTE000380"></a>


### Presentación
<a name="presentacion_ELTPARAGRAPHE000121"></a>

XML (Extensible Markup Language) es un lenguaje de marcado, es decir, un lenguaje que presenta información contenida en etiquetas. XML es un **metalenguaje** que permite inventar nuevas etiquetas para aislar la información esencial que puede contener una página Web.

XML define la estructura de un documento que contiene datos. Por ejemplo, un archivo de datos HFSQL con varios campos y registros se puede exportar a un archivo XML (funciones **XML\***).

WINDEV admite:

- exportación de archivos a XML (funciones [TableToXML](../WDLang1/3074037.md), [TextToXML](../WDLang5/3081006.md) y [HExportXML](../WDLang4/3044069.md)).

- importación de datos XML (función [HImportXML](../WDLang4/3044007.md)).

- el uso de un documento XML mediante el tipo avanzado [XMLDocument](../WDLang5/1000018782.md) y las funciones WLanguage que comienzan con XML.




El archivo XML también se puede manipular directamente en el editor de código. Para ello:

1. Arrastre el archivo XML desde el explorador de archivos y suéltelo en el panel "Explorador de proyectos", en la carpeta "Descripciones externas".

2. Arrastre el archivo XML desde el panel "Explorador de proyectos" y suéltelo en el editor de código. La variable xmlDocument se crea automáticamente de la siguiente manera:
	
	```txt
	<Variable name> is xmlDocument, description =  <Document name>
	```


3. Ahora puede acceder directamente a los nodos de la variable por sus nombres. El mecanismo de autocompletado del editor de código propone estos nombres automáticamente.



<a name="NOTE5_2"></a>


### Ejemplo práctico
<a name="ejemplo_practico_ELTPARAGRAPHE000159"></a>

- Abra el ejemplo unitario "Reading and writing in XML format". 




- Pruebe la ventana "WIN_HandleXML". Esta ventana permite:

	- crear un archivo XML. Este archivo se crea con las funciones XML. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P7_Exemple%20fichier%20XML%20-%20HC%20N%B0001.jpg&type=thumb)


	- leer un archivo XML.




- Consulte el código asociado a cada botón.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=note.png) | Nota | No vamos a entrar en detalle sobre todas las funcionalidades de las funciones XML. <br>Para obtener más información, consulte [Funciones XML](../WDLang5/3081005.md). |





<a name="NOTE6"></a>
<a name="NOTE6_1"></a>


## Manipular archivos XLS
<a name="manipular_archivos_xls_ELTTEXTE000428"></a>
WINDEV incluye las siguientes opciones para manipular archivos Excel:

- funciones xlsXXX. Estas funciones permiten leer los datos de las diferentes hojas de trabajo de un archivo Excel.

- variables avanzadas (xlsDocument, xlsRow, xlsColumn, xlsCell).



<a name="NOTE6_2"></a>


### Ejemplo práctico
<a name="ejemplo_practico_ELTPARAGRAPHE000192"></a>

Vamos a probar rápidamente estas funciones.



- Para probar las funciones xlsXXX, abra el ejemplo unitario "The Excel functions".




- Pruebe la ventana "WIN_XLSFunction". Esta ventana permite:

	- importar datos de una hoja de Excel.

	- exportar datos de un control Tabla a Excel.


 Vuelva al editor para ver el código de los diferentes controles Botón de la ventana.




- Para probar las variables avanzadas, abra el ejemplo unitario "XLS type". 




- Pruebe la ventana "WIN_XLS_Type". <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P7_Exemple%20fichier%20XLS%20-%20HC%20N%B0001.jpg&type=thumb)





- Vuelva al editor para ver el código de los diferentes controles Botón de la ventana.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=note.png) | Nota | No entraremos en detalle sobre todas las funcionalidades de las funciones XLS y los tipos avanzados. <br>Para obtener más información, consulte [Funciones de gestión de archivos XLS](../WDLang5/3080009.md). |





| [Lección anterior](../TutoWD/1410087549.md) | [Tabla de contenido](../TutoWD/1410087560.md) | [Siguiente lección](../TutoWD/1410087551.md) |
| --- | --- | --- |




