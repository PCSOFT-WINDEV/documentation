
## Lección 6.2. Auditorías del proyecto
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Esta lección abarcará los siguientes temas
<a name="esta_leccion_abarcara_los_siguientes_temas_ELTTEXTE000365"></a>


- ¿Qué es una auditoría y cuál es su propósito?

- Iniciar y analizar la auditoría estática.

- Iniciar y analizar la auditoría dinámica.





|   |   |
| --- | --- |
| <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=dur%E9e.png)<br> | <br>Tiempo estimado: 15 min |

| [Lección anterior](../TutoWD/1410087544.md) | [Tabla de contenido](../TutoWD/1410087560.md) | [Siguiente lección](../TutoWD/1410087546.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## ¿Qué es una auditoría?
<a name="¿que_una_auditoria_ELTTEXTE000412"></a>
Las auditorías proporcionan un conjunto de funcionalidades que permiten:

- mejorar automáticamente la calidad y el rendimiento de un proyecto.

- controlar cómo se pone en producción.




Hay dos tipos de auditorías disponibles:

- **La auditoría estática**. La auditoría estática analiza un proyecto y sus elementos. Esta auditoría se realiza desde el editor del proyecto.

- **La auditoría dinámica**. La auditoría dinámica analiza el comportamiento de un proyecto durante su ejecución. Esta auditoría puede realizarse en modo de prueba o en el entorno de producción.




Realizaremos estas auditorías en el proyecto "WD Optimization".

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Auditoría estática
<a name="auditoria_estatica_ELTTEXTE000436"></a>
La auditoría estática es una funcionalidad del entorno que permite analizar el código fuente de un proyecto con el fin de detectar diferentes problemas y proponer mejoras.



- Inicie la auditoría estática en el proyecto "WD Optimization":

	1. En la pestaña "Proyecto", en el grupo "Auditoría y rendimiento", despliegue "Auditoría estática" y seleccione "Iniciar auditoría estática".
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=note.png) | Nota | La auditoría estática del proyecto también puede iniciarse desde el cuadro de mando del proyecto, a través del widget "Auditoría estática y Compilación". <br><br>Para ello:<br><br>		- active el widget si es necesario (haga clic en el enlace "Haga clic para reactivar").<br><br>		- haga clic en la flecha. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P6_Audit%20statique%20-%20HC%20N%B0001.jpg)<br><br><br><br> |





	2. El asistente se abre. Vamos a definir el objetivo de la auditoría estática. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P6_Audit%20statique%20-%20HC%20N%B0002.jpg&type=thumb)


	3. Seleccione "Ejecutar auditoría estática en todo el proyecto".

4. Valide el asistente.

5. El reporte de auditoría se abre: <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P6_Audit%20statique%20-%20HC%20N%B0003.jpg&type=thumb)


La auditoría estática incluye:

- La auditoría estática del proyecto.

- La auditoría del contenido de la biblioteca de la aplicación.

- La auditoría del contenido de la instalación.




- Veamos con más detalle los puntos presentados en el reporte.



<a name="NOTE3_2A"></a>


### Control Tabla (UI)
<a name="control_tabla_ELTPARAGRAPHE000087"></a>

En nuestro proyecto, la auditoría indica que un control Tabla utiliza el modo de búsqueda estándar. Este modo ('Comienza por') busca los elementos que empiezan por los caracteres especificados. La auditoría recomienda utilizar un filtro de tipo 'Contiene' para la búsqueda predeterminada. 

El ciclo de vida de algunos proyectos WINDEV dura varios años. A menudo, estos proyectos utilizan características útiles en el momento en que se creó el proyecto (tecnologías que ahora están obsoletas, o que han sido reemplazadas por alternativas más seguras), opciones que se han vuelto inútiles o ineficientes. 

En este ejemplo, el control Tabla utiliza una búsqueda de tipo 'Comienza por' que puede reemplazarse por una búsqueda de tipo 'Contiene', que es mucho más común y práctica para los usuarios.  

- Para solucionar este problema:

	1. Haga clic en el botón [...] para obtener más información. Una ventana con sugerencias para mejorar la UI se abre. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P6_Audit%20statique%20-%20HC%20N%B0006.jpg)


	2. En la ventana "WIN_UnusedWindow", el control "TABLE_Product" puede mejorarse. Esta ventana permite:

	- realizar la mejora ("Mejorar"). En este caso, la mejora se realiza inmediatamente. 

	- ignorar la mejora ("Ignorar"). En este caso, la sugerencia de mejora no volverá a mostrarse. 




- En la ventana de auditoría estática, haga clic en el botón "Actualizar" para actualizar el reporte de auditoría.



<a name="NOTE3_2"></a>


### Procedimiento no ejecutado
<a name="procedimiento_ejecutado_ELTPARAGRAPHE000117"></a>

En nuestro proyecto, la auditoría indica que un procedimiento nunca se ejecuta.

En proyectos grandes, es posible que desee crear uno o varios procedimientos para realizar un proceso y que, tras una reorganización del código, el procedimiento ya no se utilice pero permanezca en el proyecto. Los procedimientos no utilizados sobrecargan innecesariamente los recursos distribuidos a los usuarios finales.

- Para solucionar este problema:

	1. Haga clic en el botón [...] para obtener más información. La ventana que contiene la lista de código muerto se abre. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P6_Audit%20statique%20-%20HC%20N%B0004.jpg)


	2. Nunca se llama al procedimiento "ObsoleteProcedure". Esta ventana permite:

	- especificar que el procedimiento se sigue utilizando (botón "Marcar como útil"). En este caso, el procedimiento no se volverá a tener en cuenta en la auditoría.

	- eliminar el procedimiento si no se utiliza (botón "Eliminar").

	- ver el procedimiento (botón "Ver").

	- buscar usos en las cadenas (botón "Buscar").




- En la ventana de auditoría estática, haga clic en el botón "Actualizar" para actualizar el reporte de auditoría.



<a name="NOTE3_3"></a>


### Elemento huérfano
<a name="elemento_huerfano_ELTPARAGRAPHE000168"></a>

La auditoría indica que nuestro proyecto contiene un elemento huérfano.

Al igual que con los procedimientos, puede que se creen ventanas o reportes para realizar una prueba rápida, y luego se guarden y se olviden. La presencia de elementos huérfanos en el ejecutable consume de manera innecesaria los recursos distribuidos a los usuarios finales.

- Para solucionar este problema:

	1. Haga clic en el botón [...] para obtener más información. La ventana que muestra los elementos huérfanos se abre. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P6_Audit%20statique%20-%20HC%20N%B0005.jpg)


	2. Nunca se llama a la ventana "WIN_UnusedWindow". La ventana que muestra la lista de elementos huérfanos permite:

	- especificar que el elemento se sigue utilizando (botón "Marcar como útil"). En este caso, la ventana no se volverá a tener en cuenta en la auditoría. Esta opción puede ser útil cuando se utiliza una ventana de prueba específica para el desarrollo, por ejemplo.

	- eliminar el elemento si realmente no se utiliza (botón "Eliminar").

	- ver el elemento (botón "Ver").

	- buscar usos en las cadenas (botón "Buscar").




- En la ventana de auditoría estática, haga clic en el botón "Actualizar" para actualizar el reporte de auditoría.



<a name="NOTE3_4"></a>


### Limpiar el proyecto
<a name="limpiar_proyecto_ELTPARAGRAPHE000218"></a>

Nuestro proyecto contiene varios archivos que no se utilizan. Puede limpiar el proyecto para conservar solo los elementos necesarios. El ejecutable y la instalación cliente no se sobrecargan con imágenes no utilizadas, archivos externos (u otros).

- Para solucionar este problema:

	1. Haga clic en el botón [...] para obtener más información.

	2. El asistente de limpieza del proyecto se abre. Este asistente muestra los archivos no utilizados que se pueden eliminar.

	3. Pase a la etapa siguiente.

	4. Seleccione el tipo de limpieza. Es posible:

		- crear un archivo zip con los archivos no utilizados.

		- mover los archivos no utilizados a un directorio específico.




5. Valide la opción propuesta de forma predeterminada y vaya a la etapa siguiente.

6. Finalice el asistente.




El proyecto se ha optimizado siguiendo todos los consejos de la auditoría estática.

La auditoría estática permite obtener el estado general del código fuente del proyecto. Nuestro consejo: ¡realícela de forma regular!

Veamos qué ocurre en tiempo de ejecución cuando se inicia la auditoría dinámica.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Auditoría dinámica
<a name="auditoria_dinamica_ELTTEXTE000502"></a>
La auditoría dinámica permite analizar la ejecución de la aplicación. La auditoría detecta problemas como:

- Consumo excesivo de la memoria,

- Lentitud de los algoritmos utilizados,

- Errores "ocultos" en tiempo de ejecución,

- etc.


Una auditoría dinámica puede realizarse en un entorno de pruebas o en una aplicación real.

El proyecto "WD Optimization" contiene una ventana específica que provoca errores que pueden ser detectados por la auditoría dinámica.

Vamos a iniciar la auditoría dinámica y la prueba del proyecto al mismo tiempo.

- Para iniciar la auditoría dinámica en el proyecto "WD Optimization":

	1. En la pestaña "Proyecto", en el grupo "Modo de prueba", despliegue "Modo de prueba" y seleccione "Depurar proyecto con la auditoría activada". La prueba del proyecto inicia.
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=note.png) | Nota | La auditoría dinámica del proyecto también puede iniciarse desde el cuadro de mando del proyecto, a través del widget "Auditoría dinámica". Para ello:<br><br>		- active el widget si es necesario (haga clic en el enlace "Haga clic para reactivar").<br><br>		- despliegue la flecha y seleccione "Prueba detallada del proyecto (Go)". <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P6_Audit%20dynamique%20-%20HC%20N%B0001.jpg)<br><br><br><br>Observación: La auditoría dinámica se ejecuta automáticamente cada vez que se prueba la aplicación mediante la opción GO. Un reporte se muestra automáticamente en el cuadro de mando del proyecto: <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P6_Audit%20dynamique%20-%20HC%20N%B0003.jpg)<br> |





	2. Haga clic en el botón "Test window of dynamic audit".

	3. Haga clic en los diferentes botones de la ventana. Al final de cada proceso, se muestra un mensaje toast para indicar que el proceso ha terminado. Para la opción "Aserción  y Excepción", se muestra una aserción: haga clic en "Continuar" para ver el mensaje como un toast.

	4. Detenga la prueba de la aplicación.

	5. La ventana de reporte de la auditoría dinámica se abre.




<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P6_Audit%20dynamique%20-%20HC%20N%B0002.jpg&type=thumb)


- Analicemos esta ventana:

	- La parte superior de la ventana le permite elegir las opciones de visualización de los datos. Es posible:

		- seleccionar una visualización cronológica (basada en el orden en que ocurrieron los eventos), o una visualización general para agrupar los diferentes tipos de problemas. En este caso, la línea de tiempo permite ver la posición e importancia de los problemas.

		- seleccionar el tipo de problema que se mostrará (error, aserción, etc.). Esto le permite centrarse en los errores más graves, etc.




- La parte inferior de la ventana muestra los diferentes eventos que ocurrieron y que pueden causar problemas en la aplicación.




- En este ejemplo, la auditoría dinámica detecta varios problemas:

	- Un texto excesivamente largo asignado mediante programación,

	- Un bucle SWITCH para el que no se ejecuta ningún CASE,

	- Se desencadena una aserción en lugar de una excepción,

	- Apertura de un archivo que no existe,

	- La asignación de un archivo de imagen que no existe a un control Imagen.


 Por cada problema, un botón "... " permite acceder a los detalles del evento. Si el evento está relacionado con una línea de código específica, el botón ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P6_Audit%20dynamique%20-%20HC%20N%B0002%201.jpg) le permite abrir el editor de código directamente en el lugar correspondiente para solucionar el problema.




- Cierre la ventana de la auditoría dinámica.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=note.png) | Nota | La auditoría dinámica de un proyecto también se puede realizar cuando se implementa una aplicación en los equipos de los usuarios.<br><br>Es posible:<br><br>- modificar la aplicación y utilizar la función [dbgEnableAudit](../WDLang1/1000018835.md) para iniciar la auditoría.<br><br>- utilizar un archivo de texto en el directorio de la aplicación. Esta solución le permite no modificar el ejecutable. Simplemente cree un archivo en el mismo directorio y con el mismo nombre que el ejecutable, pero con una extensión ".WX".<br><br><br>La auditoría genera un archivo ".wdaudit", este archivo debe cargarse en el entorno de desarrollo para analizar el resultado.<br><br>Para obtener más información, consulte [Auditoría dinámica](../Editeurs/1014502.md). |





| [Lección anterior](../TutoWD/1410087544.md) | [Tabla de contenido](../TutoWD/1410087560.md) | [Siguiente lección](../TutoWD/1410087546.md) |
| --- | --- | --- |




