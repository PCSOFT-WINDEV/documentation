
## Lección 4.7. Estadísticas: controles Gráfico y Tabla dinámica
<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Esta lección abarcará los siguientes temas
<a name="esta_leccion_abarcara_los_siguientes_temas_ELTTEXTE000380"></a>


- Mostrar datos en un gráfico.

- Crear tablas de resumen mediante el control Tabla dinámica.





|   |   |
| --- | --- |
| <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=dur%E9e.png)<br> | <br>Tiempo estimado: 30 min |

| [Lección anterior](../TutoWD/1410087537.md) | [Tabla de contenido](../TutoWD/1410087560.md) | [Siguiente lección](../TutoWD/1410087539.md) |
| --- | --- | --- |





<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000427"></a>
En una aplicación de gestión, a menudo es necesario presentar estadísticas o tablas de resumen. Este tipo de presentación se puede utilizar para hacer un seguimiento de:

- la evolución de los pedidos a lo largo del tiempo,

- la evolución del volumen de negocio,

- la evolución de las existencias,

- ...


Los gerentes recurren frecuentemente a este tipo de información. 

WINDEV propone diferentes controles para incluir fácilmente esta información en sus aplicaciones. En esta lección se utilizarán dos controles específicos:

- el control Gráfico.

- el control Tabla dinámica.




- Abra de nuevo el proyecto en el que trabajó en la lección anterior. 

	1. Vaya a la página de inicio de WINDEV (Ctrl + &lt;).

	2. En la página de inicio, haga clic en "Tutorial", luego en "Part 4 - Full application with data" haga doble clic en "Full application - Exercise".

	3. Un cuadro de diálogo le pide que abra el proyecto en el que trabajó en la lección anterior. Puede abrir la copia local o el proyecto original. Seleccione "Abrir la copia local". 





|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=exemple-WD.png) | Corregido | Hay un proyecto completado disponible. Este proyecto contiene los diferentes elementos creados en esta lección. Para abrir el proyecto completado, vaya a la página de inicio y haga clic en "Tutorial", luego en "Part 4 - Full application with data", haga doble clic en "Full application - Answers". |





<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Visualización de datos en un control Gráfico
<a name="visualizacion_datos_control_grafico_ELTTEXTE000469"></a>
Para manipular el control Gráfico en condiciones reales, vamos a crear un control Gráfico que muestre el estado de las ventas en la aplicación "WD Full Application".

Primero, crearemos una consulta para seleccionar los datos que se mostrarán en el control Gráfico.
<a name="NOTE3_2"></a>


### Seleccionar los datos que se mostrarán en el control Gráfico
<a name="seleccionar_los_datos_que_mostraran_control_grafico_ELTPARAGRAPHE000058"></a>

En el gráfico, obtendremos la suma de los pedidos por fecha.

Vamos a crear una consulta para hacer una suma. Calcularemos el monto total de los pedidos (campo TotalIOT en el archivo de datos Order).

Vamos a calcular el total de todos los pedidos por fecha (es decir, el volumen de negocio por fecha).



- Cree una nueva consulta:

	1. Haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ICO_Cr%E9er1_GAF.jpg) en los botones de acceso rápido.

	2. La ventana de creación de nuevos elementos se abre: haga clic en "Consulta".

	3. Vamos a crear una consulta de selección. Elija la opción "Selección (SELECT)". Pase a la etapa siguiente.

	4. La ventana de descripción de la consulta se abre.

	5. Agregue los campos Order.Date y Order.TotalIOT a la consulta:

		- A la izquierda, expanda el archivo de datos "Order".

		- Haga doble clic en el campo Date y luego en TotalIOT.

		- Los dos campos se muestran en el centro de la pantalla (en la parte "Lista de elementos en la consulta").







- Para calcular la suma de valores de "Order.TotalIOT":

	1. Seleccione el campo "Order.TotalIOT" en el centro de la pantalla.

	2. En las "Acciones", a la derecha, seleccione "Suma". La ventana de descripción de la suma se abre.  <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Application%20compl%E8te%20-%20Graphe%20-%20HC%20N%B0001.jpg&type=thumb)


	3. Valide la descripción de la suma. La suma de "TotalIOT" se agregó a la lista del resultado de la consulta.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=note.png) | Nota | El editor de consultas de WINDEV crea las consultas en lenguaje natural y en SQL. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Application%20compl%E8te%20-%20Graphe%20-%20HC%20N%B0002.jpg)<br>Esto le permite comprobar el objetivo de la consulta. |







- Ahora vamos a agrupar los datos por año y a ordenarlos:

	1. Seleccione el campo "Order.Date" en el centro de la pantalla.

	2. En las "Acciones", a la derecha, haga clic en "Año, mes" y seleccione "Año". En seguida, se abre una ventana que le permite crear el campo Year:  <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Application%20compl%E8te%20-%20Graphe%20-%20HC%20N%B0003.jpg)


	3. Valide la ventana (botón "OK").

4. El campo "Year" aparece en el centro de la descripción de la consulta.

5. Seleccione "Year" y defina un orden:

	- Abra el menú contextual del campo "Year".

	- Seleccione "Ordenar campo .. Orden ascendente".

	- Una flecha se muestra a la derecha para indicar la dirección del orden.




- Se ha creado la consulta. Vamos a darle un nombre y a guardarla.

	1. En la parte superior de la ventana de descripción de la consulta, introduzca: 

		- el nombre "QRY_SalesEvolutions".

		- el título "Sum of orders by date". 




2. Valide la ventana de descripción de la consulta. 

3. La ventana para guardar el elemento se abre. Valide la información predeterminada. 

4. La representación gráfica de la consulta es la siguiente:  <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Application%20compl%E8te%20-%20Graphe%20-%20HC%20N%B0004.jpg)



<a name="NOTE3_3"></a>


### Crear un control Gráfico
<a name="crear_control_grafico_ELTPARAGRAPHE000127"></a>

Vamos a crear un control Gráfico en una nueva pestaña de la ventana WIN_Menu.

- Para crear una nueva pestaña en la ventana "WIN_Menu":

	1. Abra la ventana "WIN_Menu" en el editor.

	2. Haga doble clic en el control Pestaña: la ventana de descripción del control se abre.

	3. En la pestaña "General", seleccione "Find orders" y haga clic en "Nuevo". Una nueva pestaña se agrega.

	4. Seleccione la nueva pestaña ("Pestaña 4").

	5. En la sección derecha de la pantalla, introduzca el nombre de la pestaña: "Chart".

	6. En la sección derecha de la pantalla, seleccione una imagen del catálogo de imágenes:

		- Haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Multilingue%20-%20HC%20N%B0014%201.jpg) a la derecha de "Imagen". Seleccione "Catálogo" en el menú contextual que aparece. 

		- La ventana del catálogo de imágenes se abre.

		- Escriba "Chart" en la barra de búsqueda. 

		- Inicie la búsqueda haciendo clic en la lupa.

		- Seleccione la imagen ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Application%20compl%E8te%20-%20Graphe%20-%20HC%20N%B0009%201.jpg) y valide las ventanas que aparecen.




7. Valide la ventana de descripción del control Pestaña.

8. Una nueva pestaña aparece en la ventana.




- Para crear el control Gráfico:

	1. En la ventana "WIN_Menu", seleccione la pestaña "Chart".

	2. En la pestaña "Creación", en el grupo "Controles gráficos", haga clic en "Gráfico". La forma del control aparece bajo el cursor.

	3. Haga clic en el panel de pestañas "Chart". El asistente para crear el control Gráfico se abre. 

	4. En el asistente, seleccione un gráfico de columnas. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Application%20compl%E8te%20-%20Graphe%20-%20HC%20N%B0005.jpg&type=thumb)
Pase a la etapa siguiente del asistente.

	5. Introduzca los parámetros del gráfico:

		- el título: "Sales evolution".

		- la leyenda: el gráfico no tiene leyenda.

		- seleccione "Mostrar etiquetas".  <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Application%20compl%E8te%20-%20Graphe%20-%20HC%20N%B0006.jpg&type=thumb)





|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=exemple-WD.png) | Ejemplo | Para aprender más sobre el uso del control Gráfico, explore los ejemplos que vienen con WINDEV:<br><br>- Ejemplo unitario: The Chart control<br><br>- Ejemplo didáctico: WD Chart<br><br><br>Estos ejemplos están disponibles en la página de inicio de WINDEV (Ctrl + &lt;). |





<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Crear tablas de resumen con el control Tabla dinámica
<a name="crear_tablas_resumen_con_control_tabla_dinamica_ELTTEXTE000559"></a>
Para manipular este control en condiciones reales, vamos a crear un control Tabla dinámica para mostrar las ventas de productos por país y por año en cantidad e ingresos. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Application%20compl%E8te%20-%20TCD%20-%20HC%20N%B0001.jpg&type=thumb)
Al igual que el control Gráfico, vamos a crear el control Tabla dinámica en una nueva pestaña de la ventana WIN_Menu.



- Para crear una nueva pestaña en la ventana "WIN_Menu":

	1. Abra la ventana "WIN_Menu" en el editor.

	2. Haga doble clic en el control Pestaña: la ventana de descripción del control se abre.

	3. En la pestaña "General", seleccione la pestaña "Chart" y haga clic en el botón "Nuevo". Una nueva pestaña se agrega.

	4. Seleccione la nueva pestaña ("Pestaña 5").

	5. En la sección derecha de la pantalla, introduzca el nombre de la pestaña: "Pivot Table".

	6. En la sección derecha de la pantalla, seleccione una imagen del catálogo de imágenes:

		- Haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Multilingue%20-%20HC%20N%B0014%201.jpg) a la derecha de "Imagen". Seleccione "Catálogo" en el menú contextual que aparece. 

		- La ventana del catálogo de imágenes se abre.

		- Escriba "Array" en la barra de búsqueda.

		- Inicie la búsqueda haciendo clic en la lupa. 

		- Seleccione la imagen ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Application%20compl%E8te%20-%20TCD%20-%20HC%20N%B0001%201.jpg) y valide las ventanas que aparecen.




7. Valide la ventana de descripción del control Pestaña.

8. Una nueva pestaña aparece en la ventana.



<a name="NOTE4_2"></a>


### Crear un control Tabla dinámica
<a name="crear_control_tabla_dinamica_ELTPARAGRAPHE000265"></a>

- Para crear un control Tabla dinámica:

	1. En la ventana "WIN_Menu", seleccione la pestaña "Pivot Table".

	2. En la pestaña "Creación", en el grupo "Datos", despliegue "Tabla y List Box" y seleccione "Tabla dinámica". La forma del control aparece bajo el cursor.

	3. Haga clic en el panel de pestañas "Pivot Table". El asistente de creación del control Tabla dinámica se abre.

	4. Pase a la etapa siguiente.

	5. **En las celdas**, se mostrará la siguiente información:

		- el total de las ventas.

		- la cantidad vendida.


 En el asistente, vamos a seleccionar el archivo de datos fuente: OrderLine.
			Para el primer valor seleccione:

- Mostrar: "La suma de".

- Fuente: "TotalIOT".

6. Los años se mostrarán **en los encabezados de las columnas**. A la izquierda, despliegue el archivo de datos Order y haga doble clic en el campo Date. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Application%20compl%E8te%20-%20TCD%20-%20HC%20N%B0003.jpg&type=thumb)
Pase a la etapa siguiente.

7. El asistente propone establecer una relación con el archivo de datos Order, y que se muestren tres niveles de datos en los encabezados: los años, trimestres y meses.  <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Application%20compl%E8te%20-%20TCD%20-%20HC%20N%B0004.jpg)



<a name="NOTE4_3"></a>


### Prueba del control Tabla dinámica
<a name="prueba_del_control_tabla_dinamica_ELTPARAGRAPHE000326"></a>

- Pruebe la ventana (haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ICO_GO_Fenetre_WD_GAF.jpg) en los botones de acceso rápido). 

	1. Haga clic en la pestaña "Pivot Table" y, a continuación, en el botón "Calculate".
			|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=note.png) | Nota | ATENCIÓN: El tiempo del cálculo depende del tamaño de la base de datos y del número de encabezados de filas y columnas. El resultado de la tabla dinámica se puede guardar para no tener que volver a calcular los valores. |





	2. Haga clic en "&gt;" para expandir las diferentes columnas y filas.<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Application%20compl%E8te%20-%20TCD%20-%20HC%20N%B0006.jpg&type=thumb)








- Detenga la prueba. Vamos a hacer un cambio en el control Tabla dinámica. Hasta ahora, nada indica que uno de los números de las celdas corresponde a una cantidad. Vamos a utilizar una máscara de visualización específica para este valor.




- Para definir una máscara de visualización en una celda:

	1. Abra la descripción del control Tabla dinámica (haga doble clic en el control).

	2. En la pestaña "Contenido" haga clic en "VAL_NoName2". La descripción de los valores que se muestran en las celdas aparece en la ventana.

	3. En la opción "Máscara", agregue el prefijo "Qt": ".  <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=P4_Application%20compl%E8te%20-%20TCD%20-%20HC%20N%B0007.jpg&type=thumb)


	4. Valide la ventana de descripción.

5. Vuelva a probar la ventana.




| [Lección anterior](../TutoWD/1410087537.md) | [Tabla de contenido](../TutoWD/1410087560.md) | [Siguiente lección](../TutoWD/1410087539.md) |
| --- | --- | --- |




