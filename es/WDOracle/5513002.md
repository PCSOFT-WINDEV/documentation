
## Conector Nativo Oracle: Programación con funciones SQL
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000142"></a>
Las funciones SQL pueden utilizarse para manipular la base de datos ORACLE, independientemente de que se utilice o no WDORAINS para configurar la base de datos a la que se accede. Para más detalles sobre WDORAINS, véase [Configurar la conexión con WDORAINS](../WDOracle/5513001.md).

**Diferencias con respecto a la programación HFSQL**: El uso de funciones SQL para los datos de manipular Oracle no requiere la importación de la estructura de archivos en el análisis. Sin embargo, los datos sólo deben tratarse mediante consultas.. El contenido de los archivos Oracle no se puede leer directamente.

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Programación
<a name="programacion_ELTTEXTE000166"></a>


### 1. Abrir la conexión
<a name="1_abrir_conexion_ELTPARAGRAPHE000023"></a>

[SQLConnect](../WDLang4/3072005.md) abre una conexión a una base de datos Oracle a través de Conector Nativo. El tipo de base de datos utilizada (ORACLE en este caso) debe pasarse como parámetro a [SQLConnect](../WDLang4/3072005.md).

El nombre de la base de datos corresponde a:

- el nombre definido en WDORAINS.

- el nombre dado en SQL\*NET.





```wl
ConnectionNum = SQLConnect("OracleDatabase", "", "", "", "ORACLE")
```


Observación: Tiene la capacidad de realizar una autenticación externa de la conexión.. Para más detalles, consulte la ayuda sobre [SQLConnect](../WDLang4/3072005.md).
<a name="NOTE2_2"></a>


### 2. Ejecución de las consultas
<a name="2_ejecucion_las_consultas_ELTPARAGRAPHE000049"></a>

Las consultas son realizadas por [SQLExec](../WDLang4/3072007.md). [SQLExec](../WDLang4/3072007.md) espera el texto de la consulta SQL como parámetro, así como el nombre que se le dará a esta consulta.


```wl
SQLExec("SELECT LASTNAME, FIRSTNAME, EXTENSION, PHOTO FROM CUSTOMER", "QRY1")
```

<a name="NOTE2_3"></a>


### 3. Recuperación del resultado
<a name="3_recuperacion_del_resultado_ELTPARAGRAPHE000064"></a>

Se pueden utilizar varios métodos para recuperar el resultado:

- [SQLFirst](../WDLang4/3072017.md): Obtiene el resultado e inicia una iteración con [SQLFirst/SQLCol](../WDLang4/3072025.md).

- [SQLTable](../WDLang4/3072031.md): Recupera el resultado de la consulta en una control Tabla poblada programáticamente en la aplicación WINDEV o en el sitio WEBDEV. El resultado de la consulta puede ser recuperado por Partial Fetch.

- [SQLFetch](../WDLang4/3072011.md): Se utiliza para leer las diferentes líneas del resultado de la consulta. La iteración sobre el resultado de la consulta se realiza con [SQLFetch/SQLGetCol](../WDLang4/3072025.md).




[SQLLock](../WDLang4/3072003.md) se utiliza para bloquear los registros de tabla o los registros seleccionados por la consulta.
<a name="NOTE2_4"></a>


### 4. Cierre de la conexión
<a name="4_cierre_conexion_ELTPARAGRAPHE000091"></a>

[SQLClose](../WDLang4/3072015.md) se utiliza para cerrar la conexión con la base de datos una vez que se han ejecutado todas las consultas necesarias.


