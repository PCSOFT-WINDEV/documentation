


## Acceso nativo a SAP
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000144"></a>
SAP es un ERP muy utilizado. Muchos usuarios de SAP implementan aplicaciones complementarias a su software.

El soporte nativo de SAP por WINDEV y WEBDEV le permite implementar fácilmente estas aplicaciones.

Una "BAPI" (Business API) es una función que le permite interactuar con un sistema SAP.. Algunas BAPI se proporcionan con SAP, otras están escritas por otros desarrolladores o editores de software.

Se pueden utilizar varias funciones de WLangage para establecer una conexión con la autenticación y para llamar BAPIs pasando parámetros.

Una asistente le ayuda a importar las estructuras utilizadas.

No es necesario instalar el módulo SAP GUI. Sólo se requiere el mandante SAP o el fichero librfc32.dll (biblioteca suministrada por SAP y encontrada en el directorio ejecutable).

Esto le permite crear ventanas WINDEV y utilizarlas en lugar de SAP GUI.. Además, "Reports & Queries" puede utilizarse para crear informes y consultas sobre los datos encontrados en la base de datos SAP.

**Observación**: No puede conectarse a SAP Business Object mediante el protocolo de SAP BO (UI API y DI API) mediante el acceso SAP nativo.. En este caso, debe usar una DLL (C# o Visual Basic) llamada por un código de WLanguage. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Una asistente para utilizar las funciones de SAP
<a name="una_asistente_para_utilizar_las_funciones_sap_ELTTEXTE000168"></a>
Para utilizar las funciones de SAP, recomendamos que utilice la asistente para importar las funciones de SAP. Esta asistente genera el código WLangage necesario en una set de procedimientos (para una mejor reutilización). Se crea una Procedure global para cada función importada. Esta Procedure contiene un ejemplo de llamada con parámetros vacíos. Para utilizar la función, basta con copy este ejemplo de llamada en el código solicitado e introducir el valor de los diferentes parámetros.

**Utilizar la asistente para importar el módulo de funciones/BAPI**: 

1. En la pestaña "Proyecto", en el grupo "Proyecto", amplíe "Importar" y seleccione "Una función SAP".

2. El asistente se abre. Pase a la etapa siguiente.

3. Especificar los parámetros para conectarse al SAP servidor de aplicaciones:

	- la servidor de aplicaciones.

	- el número del sistema.

	- el número de cliente.

	- el usuario.

	- la contraseña associated con el usuario.




4. El paso siguiente se utiliza para seleccionar el módulo de funciones a importar. Es posible:

	- recuperar la lista completa de funciones disponibles para seleccionar la función solicitada. Esta operación puede llevar bastante tiempo.

	- filtrar las funciones para recuperar las correspondientes al filtro (las funciones de usuario que empiezan por "Z" por ejemplo).
			El botón "Iniciar la búsqueda" sirve para visualizar las funciones encontradas.




5. El siguiente paso le permite seleccionar la función solicitada.

6. Ahora puede seleccionar los parámetros que se deben pasar a la función. Para cada parámetro, la asistente indica:

	- el nombre del parámetro.

	- si el parámetro es un parámetro de entrada o de salida.

	- si el parámetro es opcional.

	- el valor Default del parámetro. Este valor se utilizará si el parámetro no se pasa a la función.




7. Especifique el nombre del conjunto de Procedure s que albergará el SAP Procedure. Esta set de procedimientos es denominada "SAP" por Default. Puede elegir otro nombre. Este nombre se propondrá automáticamente durante la próxima importación de una función SAP..
	Observación: La set de procedimientos se crea automáticamente si no existe.

8. En el código del global creado Procedure, un ejemplo de código utilizado para llamar al global creado Procedure está disponible en los comentarios. Para ello:

	- copy este código al lugar solicitado.

	- eliminar los comentarios.

	- dan un valor a los diferentes parámetros esperados por la función.







Observación: la conexión y la desconexión de la aplicación hacia/desde el SAP servidor de aplicaciones debe ser gestionada por [SAPConnect](../WDLang6/1000017120.md) y [SAPDisconnect](../WDLang6/1000017121.md).
<a name="NOTE2_2"></a>


### Asistente de la función SAPExecute
<a name="asistente_funcion_sapexecute_ELTPARAGRAPHE000090"></a>

El método presentado en el párrafo anterior es el método que se debe utilizar para los BAPIs de manipular SAP.. Sin embargo, también tiene la posibilidad de utilizar la asistente de [SAPExecute](../WDLang6/1000017122.md), disponible en el editor de código. Esta asistente se utiliza para generar el código para llamar a la función BAPI solicitada.




