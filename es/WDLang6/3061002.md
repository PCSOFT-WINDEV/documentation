


## BurnerAddDirectory( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Añade todos los archivos encontrados en un directorio a la compilación.. Una vez añadidos todos los archivos deseados a la compilación, se puede grabar el CD o DVD ([BurnerSave](../WDLang6/3061006.md)).

Por cada archivo agregado, la función **BurnerAddDirectory** llama automáticamente a un procedimiento específico escrito en WLanguage. Este Procedure se utiliza para manipular el archivo actual.

**Observación**: Para añadir un archivo a la compilación, utilice [QuemadorAñadirArchivo](../WDLang6/3061001.md).
<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo
<a class="notetitle" target="_blank" href="$DOC$=1000003061002&name=burneradddirectory_funcion&product=WD">Ver ejemplos adicionales</a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Código de Usuario (UMC)](https://doc.pcsoft.fr/ext/images/us/MCU.png) 
```wl
// Burn a data CD 
BurnerMediaType(mediaType_CD_ROM_XA) 
// Add the files located in "C:\MyDirectory" and in its subdirectories
// The addition can be interrupted by pressing the Esc key
ResAdd is boolean 
ResAdd = BurnerAddDirectory("C:\MyDirectory", ...
	burnerRecursiveAddition + burnerInterruptibleAddition)
```
<a name="Example2"></a>

```wl
// Burn a data CD 
BurnerMediaType(mediaType_CD_ROM_XA) 
// Add the files found in "C:\MyDirectory"
// The ProcAddFile procedure will be automatically called for each added file
ResAdd is boolean 
ResAdd = BurnerAddDirectory("C:\MyDirectory", "", ProcAddFile)
// To view the entire example, click the "Example" link
```
<a name="Example3"></a>

```wl
// Burn an audio CD
BurnerMediaType(mediaType_CDDA_CDROM) 
// Add the ".WAV" files found in "C:\MyMusic"
ResAdd is boolean 
ResAdd = BurnerAddDirectory("C:\MyMusic\*.WAV")  
// To view the entire example, click the "Example" link
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

`<Result> = BurnerAddDirectory(<Directory to add> [, <Directory on CD or DVD> [, <WLanguage procedure> [, <Pointer>]]] [, <Options>])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si los archivos del directorio se agregaron a la compilación,

- <u><u><u><u>False</u></u></u></u> en caso contrario. Para obtener más información sobre el error, utilice la función [ErrorInfo](../WDLang1/3013008.md).


**Observación**: Un CD o DVD debe encontrarse en la grabadora.. Este CD o DVD debe tener suficiente espacio para grabar una nueva sesión.

**`<Directory to add>: (Cadena de caracteres)`**

Ruta y nombre genérico de los ficheros que se añadirán a la compilación (hasta 260 caracteres). La ruta puede ser una ruta completa, relativa o UNC.
Los caracteres genéricos (\* y?) están permitidos.
Para una compilación de audio, estos archivos deben corresponder al archivo ".WAV" (44100 Hz, 16 bits).


**`<Directory on CD or DVD>: (Cadena de caracteres opcional)`**

Ruta del directorio en el CD o DVD. Esta ruta debe comenzar con un carácter de barra invertida ("\\"). Por Default, la estructura de árbol del directorio será recreada a partir de la raíz del CD/DVD.
Este parámetro se ignora para una compilación de audio. De hecho, todos los archivos se añadirán automáticamente en la raíz del CD/DVD.

**`<WLanguage procedure>: (Nombre de la Procedure opcional)`**

El nombre de WLanguage Procedure ("callback") llamado para cada archivo añadido. Este Procedure se utiliza para manipular el archivo actual.
Este procedimiento tiene el siguiente formato:

```txt
PROCEDURE <Procedure name>(<Path>, <File name>, <Change>, 
<Procedure pointer>)
```

Los parámetros de este Procedure son opcionales.
No hay necesidad de pasarle parámetros a este Procedure. De hecho, estos parámetros se rellenan automáticamente cada vez que se procesa un fichero.
El archivo se añadirá (o no) a la compilación según el valor devuelto por esta Procedure (ver las Notas.

**`<Pointer>: (Entero opcional)`**

Puntero pasado al procedimiento &lt;Nombre de procedimiento>.

**`<Options>: (Combinación de constantes enteras, parámetro opcional)`**

Tipo de búsqueda realizada para añadir los archivos encontrados en los directorios:


|   |   |
| --- | --- |
| *burnerInterruptibleAddition* | La navegación se puede interrumpir pulsando la tecla ESC.<br> |
| *burnerNonRecursiveAddition* | La navegación es una navegación no recursiva. Los subdirectorios son ignorados. |
| *burnerRecursiveAddition*<br>(Valor predeterminado) | La exploración es recursiva. Los subdirectorios se tienen en cuenta automáticamente. |





<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Procedure para la gestión de cada archivo añadido
<a name="procedure_para_gestion_cada_archivo_anadido_ELTPARAGRAPHE000109"></a>

Por cada archivo agregado, la función **BurnerAddDirectory** llama automáticamente al procedimiento &lt;Nombre de procedimiento&gt;. Este Procedure es un Procedure local o global.

Esta Procedure debe ser declarada de la siguiente manera:

```txt
PROCEDURE <Procedure name> (<Path>, <File name>, <Change>, <Procedure pointer>)
```


- &lt;Ruta&gt; es la ruta del archivo manipulado (siempre termina con una barra invertida "\\"; por ejemplo "C:Archivos\\").

- &lt;Nombre de archivo&gt; es una cadena de caracteres que contiene el nombre del archivo encontrado.

- &lt;Cambio&gt; es una constante set a:

	- *flFirstFile*cuando el archivo es el primero listado en &lt;Ruta&gt;,

	- *flChangeDir* cuando el archivo es el primer archivo listado en un subdirectorio de &lt;Path&gt; (lo que significa que el directorio ha cambiado),

	- *flFile* en los demás casos.


 Los diferentes valores que puede tomar &lt;Change&gt; son los siguientes:
	

| Archivo actual | &lt;Cambiar&gt; |
| --- | --- |
| Dir\\Archivo 1 | *flFirstFile* |
| Dir\\Archivo n | *flFile* |
| Dir\\SubDir 1\\Archivo 1 | *flChangeDir* |
| Dir\\SubDir 1\\Archivo m | *flFile* |
| Dir\\SubDir 2\\Archivo 1 | *flChangeDir* |
| Dir\\SubDir 2\\Archivo x | *flFile* |



- &lt;Puntero Procedure&gt; es un entero cuyo valor es el que se pasa al parámetro &lt;Puntero&gt; de **BurnerAddDirectory**. Si no se especifica &lt;Pointer&gt;, &lt;Pointer&gt; es set a 0.




Para obtener el valor de &lt;puntero Procedure&gt;, su valor debe asignarse al valor de &lt;puntero&gt; en la Procedure con [Transferir](../WDLang1/3014015.md).

**Observación**: Los parámetros de este Procedure son opcionales: tiene la posibilidad de especificar el nombre y el ruta por ejemplo.

Especifique (si es necesario) el valor de retorno de la Procedure mediante la palabra clave [RETURN](../Motscles/1510007.md). Los valores posibles son los siguientes:

- **0**: el archivo no se agrega a la compilación y la enumeración de archivos se detiene.

- **1**: el fichero se añade a la compilación y la enumeración del fichero continúa.

- ** 2**: el archivo no se añade a la compilación y la enumeración del archivo continúa.




Ejemplo:


```wl
PROCEDURE AddElement(Directory, Name, Change)
Trace(Directory + TAB, Name + TAB, Change + TAB)
// Burn the file and continue the enumeration
RESULT 1
// Don't burn the file and stop
// RESULT 0
// Don't burn the file and continue
// RESULT 2
```

<a name="NOTE0_2"></a>


### Tener en cuenta los archivos listados
<a name="tener_cuenta_los_archivos_listados_ELTPARAGRAPHE000184"></a>

Para cada archivo listado, puede hacerlo:

- añadir el archivo a la compilación y continuar la enumeración de los archivos. Utilice la siguiente línea de código en el &lt;nombre de Procedure&gt; Procedure:
	
	```wl
	RESULT 1
	```


- no añadir ningún archivo a la compilación y continuar la enumeración de los archivos. Utiliza la siguiente línea de código en &lt;nombre de la Procedure&gt;: 
	
	```wl
	RESULT 2
	```


- no añadir ningún archivo a la compilación y detener la enumeración de los archivos. Utiliza la siguiente línea de código en &lt;nombre de la Procedure&gt;: 
	
	```wl
	RESULT 0
	```





Si &lt;Procedure nombre&gt; Procedure no devuelve ningún valor, el archivo se añade a la compilación y la enumeración de los archivos continúa.
<a name="NOTE0_3"></a>


### Recopilación
<a name="recopilacion_ELTPARAGRAPHE000203"></a>

Una compilación corresponde a la set de archivos que deben ser grabados en un CD o DVD. Esta recopilación se tendrá en cuenta la próxima vez que se llame a [BurnerSave](../WDLang6/3061006.md).

Una compilación se crea automáticamente al llamar por primera vez a la función [QuemadorAñadirArchivo](../WDLang6/3061001.md) o **BurnerAddDirectory**. Se puede crear una sola compilación a la vez.

Una compilación se elimina automáticamente:

- al cambiar el tipo de CD/DVD a grabar ([BurnerMediaTipo](../WDLang6/3061013.md)).

- al seleccionar el quemador default ([QuemadorSeleccionar](../WDLang6/3061012.md)).

- después de llamar a la función [BurnerSave](../WDLang6/3061006.md) (solo si se inició la grabación, &lt;Resultado&gt; se establece en <u><u><u><u>True</u></u></u></u>).

- al cancelar la grabación process ([QuemadorCancelar](../WDLang6/3061003.md)).

- al cerrar la aplicación WINDEV o el sitio WEBDEV actual.



<a name="NOTE0_4"></a>


### Añadir varios archivos idénticos
<a name="anadir_varios_archivos_identicos_ELTPARAGRAPHE000244"></a>

Si el mismo archivo se añade varias veces a la compilación:

- para un CD/DVD de audio: este archivo se encontrará en el CD/DVD tantas veces como se agregó.

- para un CD/DVD de datos: sólo el último archivo añadido (mismo nombre, mismo directorio de destino) se encontrará en el CD/DVD.



<a name="NOTE0_5"></a>


### Configuración necesaria 
<a name="configuracion_necesaria_ELTPARAGRAPHE000254"></a>

![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) La grabación de CD está disponible para Windows XP y versiones posteriores. La grabación de DVDs está disponible para Windows Vista y para Windows XP cuando se utiliza la actualización KB932716 para Windows XP (esta actualización debe descargarse desde el sitio de Microsoft e instalarse manualmente porque no se tiene en cuenta en el mecanismo de Live Update).. 

<a name="XComponent"></a>

## Componente:
wd280grv.dll
