


## gpwOpenConnection( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Abre una conexión a una base de datos específica Cliente/Servidor para gestionar los archivos de User Groupware en modo Cliente/Servidor. La conexión permanece abierta hasta el final de la aplicación.

**gpwOpenConnection** establece y abre una conexión con los archivos de datos de User Groupware. Para utilizar la misma conexión para todos los archivos de datos de la aplicación, utilice [HChangeConnection](../WDLang4/3044150.md). A continuación, se utiliza [gpwOpen](../WDLang6/3041002.md) para especificar la ubicación de los archivos de datos para la gestión de los derechos, así como la ubicación de los archivos de datos para la identificación de los usuarios.


<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Use User Groupware files with a MySQL database 
IF gpwOpenConnection("gpwCt", "Test", "PasswordMySQL", ... 
	"Apollon_server", "TEST", hNativeAccessMySQL) = False THEN 
	Error(HErrorInfo()) 
ELSE 
	// The data files of user groupware 
	// are automatically created 
	// if the user has rights on MySQL. 
	nRes is int = gpwOpen() 
	// If the login failed 
	IF nRes <> gpwOK THEN 
		SWITCH nRes 
			CASE gpwError: 
				Error("Error at initialization.", ErrorInfo()) 
			CASE gpwUnknownUser: 
				Error("Unknown user.") 
			CASE gpwInvalidPassword: 
				Error("Invalid password") 
		END 
	END 
	// Use the same connection for all data files 
	HChangeConnection("*", "gpwCt") 
	Trace(HNbRec(CEDEX)) 
END
```
<a name="Example2"></a>

```wl
// Change the password of user groupware data files 
// through programming
// Example with GPWUSER
gpwInitAnalysis()
GPWUSER is Data Source
CNT_GPWu_HFCS is Connection
sPasswordGPWu is string = "PCSGPW2001"

// Connection parameters
CNT_GPWu_HFCS.Provider = hAccessHFClientServer
CNT_GPWu_HFCS.User = "UserHFServer"
CNT_GPWu_HFCS.Password = "PasswordHFServer"
CNT_GPWu_HFCS.Server = "HFServer"
CNT_GPWu_HFCS.Database = "GPWu"
CNT_GPWu_HFCS.CryptMethod = hCryptNo

// Open the connection
gpwOpenConnection(CNT_GPWu_HFCS)
HChangeConnection(GPWUSER, CNT_GPWu_HFCS)
HPass(GPWUSER, sPasswordGPWu)
HCreationIfNotFound(GPWUSER)
HChangePassword(GPWUSER, "TEST")

CASE ERROR:
Error(HErrorInfo() + CR + ErrorInfo())
```

<a name="XSYNTAX"></a>
<a name="SYNTAX1"></a>

## Sintaxis

### Definición y apertura de una conexión

`<Result> = gpwOpenConnection(<Connection name> , <User name> [, <Password>] , <Data source> [, <Database>] , <OLE DB provider or Native Connector> [, <Access> [, <Extended information>]] , <Additional options>)`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se realizó la operación,

- <u><u><u><u>False</u></u></u></u> si se produce un problema. La función [HErrorInfo](../WDLang4/3044071.md) permite identificar el error. 


La apertura real de la conexión no se realiza con la función **gpwOpenConnection**. La función puede devolver <u><u><u><u>True</u></u></u></u> incluso si los valores pasados como parámetro son incorrectos. 

Utilice [gpwOpen](../WDLang6/3041002.md) para especificar la ubicación de los archivos de datos para la gestión de los derechos, así como la ubicación de los archivos de datos para la identificación de los usuarios. Los directorios deben especificarse en relación con el directorio del servidor.

**`<Connection name>: (Cadena de caracteres)`**

Nombre de la nueva conexión a definir y abrir. Este nombre no debe ser utilizado por otra conexión (definida en el análisis, o con [HOpenConnection](../WDLang4/3044107.md) o [HDescribeConnection](../WDLang4/3044205.md)).

**`<User name>: (Cadena de caracteres)`**

Nombre del usuario que se conecta a la base de datos Cliente/Servidor. Este parámetro es devuelto por la [CtUserName](../Proprietes/2512026.md) Property.

**`<Password>: (Cadena de caracteres opcional)`**

Contraseña definida para la conexión a la base de datos Cliente/Servidor (si existe esta contraseña). Si no se requiere una contraseña, utilice una cadena vacía ("") o la palabra clave NULL.

**`<Data source>: (Cadena de caracteres)`**

Ruta completa de la fuente de datos. La conexión se creará y abrirá para esta fuente de datos. Este parámetro es devuelto por la [CtDatabase](../Proprietes/2512047.md) Property.

**`<Database>: (Cadena de caracteres opcional)`**

Nombre de la base de datos que se utilizará en la fuente de datos. Si no se requiere este parámetro, utilice una cadena vacía (""). Este parámetro es devuelto por la [CtInitialCatalog](../Proprietes/2512018.md) Property.

**`<OLE DB provider or Native Connector>: (Cadena de caracteres o constante)`**



- Nombre del proveedor OLE DB utilizado. Para obtener fácilmente la cadena a utilizar, seleccione la opción "Conexión" en el editor de análisis (ver Notas).
	
	o




- una de las siguientes constantes:
	


|   |   |
| --- | --- |
| *hAccessHF7* | Pseudoconexión a una base de datos HFSQL Classic (monopuesto o multipuesto) |
| *hAccessHFClientServer* | Conexión a una base de datos HFSQL Client/Server |
| *hNativeAccessAS400* | Acceso/conector nativo AS/400 (módulo opcional) |
| *hNativeAccessDB2* | Acceso/conector nativo DB2 (módulo opcional) |
| *hNativeAccessInformix* | Acceso/Conector de Informix nativo (módulo opcional) |
| *hNativeAccessMySQL* | Acceso/conector nativo de MySQL (módulo opcional) |
| *hNativeAccessOracle* | Acceso/conector nativo de Oracle (módulo opcional) |
| *hNativeAccessPostgreSQL* | Acceso/conector PostgreSQL nativo (módulo opcional) |
| *hNativeAccessProgress* | Acceso a Native Progress (módulo opcional) |
| *hNativeAccessSQLServer* | Acceso/conector del servidor SQL nativo (módulo opcional) |
| *hNativeAccessSybase* | Conector/acceso a la base nativa Sybase (módulo opcional) |
| *hNativeAccessxBase* | Nativo xBase Acceso/Conector |
| *hODBC* | Proveedor OLE DB para ODBC. <br>Permite acceder a una fuente ODBC declarada en las fuentes de datos ODBC de Windows. |
| *hOledbAccess97* | Proveedor OLE DB para Access 97 |
| *hOledbAccess2000* | Proveedor OLE DB para Access 2000 |
| *hOledbDBase5* | Proveedor OLE DB para dBase 5 |
| *hOledbExcel97* | Proveedor OLE DB para Excel 97 |
| *hOledbExcel2000* | Proveedor OLE DB para Excel 2000 |
| *hOledbLotus4* | Proveedor OLE DB para Lotus 4 |
| *hOledbOracle* | Proveedor OLE DB para Oracle |
| *hOledbSQLServer* | Proveedor OLE DB para SQL Server |




![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) Atención: Para utilizar una conexión OLE DB, es necesario: 


- instalar MDAC versión 2.6 o posterior (instalación realizada por WINDEV o WEBDEV y al crear el programa instalación)

- instalar el proveedor OLE DB que corresponde a la base de datos utilizada. 
	Este parámetro es devuelto por la [CtOLEDBProvider](../Proprietes/2512033.md) Property.




**`<Access>: (Constante opcional)`**

Configura el tipo de acceso a la base de datos.


|   |   |
| --- | --- |
| *hORead* | Se puede acceder a la base de datos en modo de solo lectura. Solo se pueden leer registros. No se pueden agregar o eliminar. |
| *hOReadWrite*<br>(valor predeterminado) | Se puede acceder a la base de datos en lectura/escritura. Se pueden leer y escribir nuevos registros. |


Este parámetro es devuelto por la [CtAccess](../Proprietes/2512015.md) Property.

**`<Extended information>: (Cadena de caracteres opcional)`**

Información opcional insertada en la cadena de conexión a la base de datos. Si se reconocen palabras clave específicas, la información correspondiente se extrae de la cadena de conexión. El resto de la cadena de conexión se envía a la base de datos. A continuación, los parámetros extraídos son procesados por el acceso Conector Nativo u OLE DB utilizado. 
Estas palabras clave deben indicarse de la siguiente manera: "&lt;Palabra clave&gt; = &lt;Valor>".

![Conectores Nativos](https://doc.pcsoft.fr/ext/images/us/AN.png) Palabras clave reconocidas para el Conector Nativo de MySQL: 


|   |   |
| --- | --- |
| Puerto del servidor | Consulte la documentación sobre MySQL (palabra clave = 'mysql_real_connect') para más detalles. |
| Enchufe Unix |
| Flag Cliente |



![OLE DB](https://doc.pcsoft.fr/ext/images/us/OLEDB.png) Palabras clave reconocidas para el acceso a través de un proveedor OLE DB:


|   |   |
| --- | --- |
| Tiempo de espera de comandos WD | Define el tiempo máximo de espera (en segundos) para ejecutar un comando (tiempo de espera del comando). No se puede utilizar con el Conector Nativo de MySQL. |
| Tiempo de espera de conexión WD | Define el tiempo máximo de espera (en segundos) para establecer la conexión (tiempo de espera de la conexión).. No se puede utilizar con el Conector Nativo de MySQL. |

 


![HFSQL Client/Server](https://doc.pcsoft.fr/ext/images/us/HFCS.png) Las palabras clave reconocidas para el acceso mediante HFSQL Client/Server son las siguientes:


|   |   |
| --- | --- |
| ENCRYPTION | Permite el cifrado de los datos intercambiados entre el Cliente y el Servidor. Esta palabra clave puede tomar dos valores:<br><br>- RÁPIDO<br><br>- RC5_16 para utilizar un cifrado RC5 de 16 vueltas.<br><br><br> |

 Este parámetro puede ser recuperado mediante la función [CtExtendedInfo](../Proprietes/2512017.md) Property.

**`<Additional options>: (Constante)`**

Si no se especifica este parámetro, el motor HFSQL define automáticamente los parámetros que se deben utilizar en función de la base de datos a la que se accede y del proveedor OLE DB utilizado.

Para forzar algunos parámetros, se pueden combinar las siguientes constantes:

- **Ubicación de los cursores**
	


|   |   |
| --- | --- |
| *hClientCursor* | Cursor utilizado por MDAC. Por lo general, ofrece más funcionalidades que un cursor servidor. Un cursor cliente obligatoriamente es un cursor estático. |
| *hServerCursor* | Cursor utilizado por la base de datos. Este cursor puede aplicar fácilmente las modificaciones realizadas por otros usuarios a los datos. |






- **Tipo de cursor**
	


|   |   |
| --- | --- |
| *hDynamicCursor* | Cursor que ofrece una gran cantidad de funcionalidades pero que consume mucha memoria. Este cursor permite realizar varios movimientos. Permite acceder a todas las modificaciones, adiciones y eliminaciones realizadas por los demás usuarios. |
| *hForwardOnlyCursor* | Cursor rápido que consume poca memoria. El desplazamiento se realiza del primer al último registro. Los datos modificados por otros usuarios no son visibles. |
| *hOpenKeysetCursor* | Cursor que utiliza un conjunto de registros fijo.  Solo se almacenan las claves que corresponden al registro, no los registros (consume menos memoria). No se puede acceder a los registros eliminados. Las modificaciones realizadas por otros usuarios son Visible (pero los registros añadidos no lo son). |
| *hStaticCursor* | Hace una copia de los registros de la consulta en la memoria (alto consumo de memoria). Todos los tipos de desplazamiento están permitidos. |






- **Modo de bloqueo**
	


|   |   |
| --- | --- |
| *hOptimisticCursor* | El registro se bloquea durante la actualización |
| *hPessimisticCursor* | El registro se bloquea tan pronto como entra en modo de edición para ser modificado. |
| *hReadOnlyCursor* | El conjunto de registros utilizado no podrá modificarse. |




Atención: no todos los proveedores OLE DB soportan todos los tipos de cursores.

Este parámetro es devuelto por la [CtCursorOptions](../Proprietes/2512042.md) Property.  


<a name="SYNTAX2"></a>

### Abrir una conexión definida por una Conexión Variable

`<Result> = gpwOpenConnection(<Connection used>)`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se realizó la operación,

- <u><u><u><u>False</u></u></u></u> si se produce un problema. La función [HErrorInfo](../WDLang4/3044071.md) permite identificar el error. 




La apertura real de la conexión no se realiza con la función **gpwOpenConnection**. La función puede devolver <u><u><u><u>True</u></u></u></u> incluso si los valores pasados como parámetro son incorrectos. 
Utilice [gpwOpen](../WDLang6/3041002.md) para especificar la ubicación de los archivos de datos para la gestión de los derechos, así como la ubicación de los archivos de datos para la identificación de los usuarios. Los directorios deben especificarse en relación con el directorio del servidor.

**`<Connection used>: (Variable de tipo Connection)`**

Nombre de la [Conexión](../WDLang4/1514073.md) Variable a abrir. Este nombre no debe ser utilizado por otra conexión (definida en el análisis, o con [HOpenConnection](../WDLang4/3044107.md) o [HDescribeConnection](../WDLang4/3044205.md)).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones


### Utilizar una cadena de caracteres para el proveedor OLE DB
<a name="utilizar_una_cadena_caracteres_para_proveedor_ole_ELTPARAGRAPHE000368"></a>

Para encontrar fácilmente la cadena de caracteres que se debe utilizar para definir el proveedor OLE DB, le recomendamos seguir los siguientes pasos:

1. En el editor de análisis, mostrar la ventana de conexiones del description: en la pestaña "Análisis", en el grupo "Conexión", haga clic en "Conexiones".

2. Seleccione el proveedor que se utilizará ("Conexión mediante").

3. Enseguida, se muestra la cadena de caracteres que corresponde al proveedor. Esta cadena de caracteres se puede utilizar en la sintaxis 2 en lugar de las constantes. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=HOuvreConnexion.gif)




<a name="NOTE0_2"></a>


### Si se produce un error, no se conserva la descripción de la conexión
<a name="produce_error_conserva_descripcion_conexion_ELTPARAGRAPHE000392"></a>

Si la conexión no se abre, no se valida la descripción de la conexión. Por lo tanto, es posible redefinir una conexión con el mismo nombre.

Por ejemplo, si no se puede establecer la conexión con la contraseña predeterminada, se puede realizar un nuevo intento con otra contraseña.
<a name="NOTE0_3"></a>


### Se abren dos conexiones en el servidor
<a name="abren_dos_conexiones_servidor_ELTPARAGRAPHE000401"></a>

Dos contextos HFSQL son utilizados por el User Groupware. En el Centro HFSQL control, notará dos conexiones para una sola instancia de la aplicación.
<a name="NOTE0_4"></a>


### Validez de la conexión
<a name="validez_conexion_ELTPARAGRAPHE000408"></a>

La función **gpwOpenConnection** se comporta como [HDescribeConnection](../WDLang4/3044205.md): esta función no establece la conexión inmediatamente. 

La función **gpwOpenConnection** identifica los parámetros de conexión que se utilizarán para establecer la conexión. 

Para validar esta conexión, se puede llamar a la función [HOpenConnection](../WDLang4/3044107.md) antes de **gpwOpenConnection** con los mismos parámetros. Por lo tanto, los parámetros de conexión ya se comprobarán cuando se llame a **gpwOpenConnection**.
<a name="NOTE0_5"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png)![Linux](https://doc.pcsoft.fr/ext/images/us/LX.png) 

### Pseudo-conexión a una base de datos HFSQL Classic
<a name="pseudoconexion_una_base_datos_hfsql_classic_ELTPARAGRAPHE000435"></a>

Los archivos de datos OLE DB o nativos se describen en el editor de análisis. Para manipular estas descripciones con una base de datos HFSQL Classic, &lt;proveedor de DBOLE o Conector Nativo&gt; debe corresponder a la constante *hAccessHF7*.

Los ficheros de datos en formato HFSQL Classic correspondientes al description de la BD OLE o los ficheros nativos se crearán (si es necesario) en el directorio definido por &lt;Fuente de datos&gt;.

<a name="XComponent"></a>

## Componente:
wd280gpu.dll
