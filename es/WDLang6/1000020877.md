


## TwainToPDF( Función)



<a name="XUse"></a>
<a name="Use"></a>
<a name="description"></a>
Permite:

- guardar el Document que viene del dispositivo Twain en un archivo PDF.

- ver la Document procedente del dispositivo Twain en la [dispositivo UI](../WDLang6/3078007.md). El usuario tendrá la posibilidad de realizar una de las acciones propuestas por esta interfaz (por ejemplo: guardar el Document, modificar los parámetros del Default del dispositivo). Las acciones disponibles dependen del dispositivo utilizado.

- guardar el Document procedente del dispositivo Twain directamente en la memoria en formato PDF (en un buffer). 



<a name="Example1"></a>
<a name="sample_code"></a>

## Ejemplo


```wl
// Acquisition as long as there are pages to load
TwainToPDF("File.PDF")
```


<a name="Example2"></a>



```wl
// Save the document found in the scanner in memory
// The document will be saved in black and white
IMG_MyImage = TwainToPDF(inMemory, False, TwainBlackWhite)
```

<a name="XSYNTAX"></a>

## Sintaxis
<a name="SYNTAX1"></a>

### Guardar y mostrar el Document que viene del dispositivo Twain en un archivo PDF

`<Result> = TwainToPDF([<PDF file> [, <User interface> [, <Type of image> [, <Number of bits per pixel> [, <Image resolution> [, <Image contrast> [, <Image brightness> [, <Duplex mode> [, <Automatic load>]]]]]]]]])`
---

**`<Result>: (booleano)`**



- <u><u><u><u>True</u></u></u></u> si se guardó o mostró el documento,

- <u><u><u><u>False</u></u></u></u> si no se guardó el documento. La función [ErrorInfo](../WDLang1/3013008.md) devuelve el mensaje de error correspondiente.




**`<PDF file>: (Cadena de caracteres opcional)`**

Nombre y ruta completa (o relativa) del archivo (hasta 260 caracteres). La extensión del archivo es opcional. Se puede utilizar una ruta UNC.
Si no se especifica este parámetro o si corresponde a una cadena vacía (""), el usuario tendrá que introducir el nombre completo del archivo PDF en un selector de archivos.

**`<User interface>: (Booleano opcional)`**



- <u><u><u><u>True</u></u></u></u> si se debe mostrar la interfaz de usuario del dispositivo Twain. Al guardar una Document, la  será propuesta por Default.

- <u><u><u><u>False</u></u></u></u> (valor predeterminado) si no se debe mostrar la interfaz de usuario del dispositivo Twain.




**`<Type of image>: (Constante o combinación de constantes de tipo Integer (opcional))`**

Tipo de imagen utilizada para guardar la Document (clasificada por orden de gestión de color):


|   |   |   |
| --- | --- | --- |
| Orden para la gestión de los colores |   |   |
|   | 0 (Valor predeterminado) | Dispositivo Default Image. |
| 1 | *TwainPalette* | Imagen cuyos colores son emitidos por un Palette. |
| 2 | *TwainRGB* | RGB Image. |
| 3 | *TwainGrayScale* | Escala de grises Image. |
| 4 | *TwainBlackWhite* | Imagen en blanco y negro. |
| - | *TwainAnyType* | Cualquier tipo de Image. |


Si se combinan estas constantes, se seleccionará el mejor tipo de imagen soportado por el dispositivo (según el orden de gestión de color). Para obtener más información, consulte [los comentarios](#NOTE0_2).

Se utilizará el tipo de Default de Image:


- si este parámetro no se especifica o si corresponde a 0.

- si el tipo especificado de Image no es soportado por el dispositivo.

- si el valor del parámetro &lt;Interfaz de usuario&gt; es <u><u><u><u>True</u></u></u></u>.




**`<Number of bits per pixel>: (Entero opcional)`**

Cantidad de información sobre los colores (para mostrar o imprimir cada píxel en una Image). Cuanto mayor sea el número de bits por píxel, más nítida será la representación de Color. 
Los posibles valores de este parámetro dependen del tipo de Image utilizado:


|   |   |
| --- | --- |
| Tipo de Image | Valores posibles |
| Imagen coloreada emitida desde una paleta (constante *TwainPalette*). | 1, 4 u 8 |
| Imagen RGB (constante *TwainRGB*). | 8, 10 o 16 |
| Imagen en escala de grises (constante *TwainGrayScale*). | 8 o 16 |
| Imagen en blanco y negro (constante *TwainBlackWhite*). | 1 |


Si no se especifica este parámetro, se usará el número de bits por píxel de Default.

**`<Image resolution>: (Real opcional)`**

Número de píxeles por pulgada (los valores posibles dependen del dispositivo utilizado). 
Se utilizará la resolución Default Image:


- si este parámetro no se especifica o si corresponde a 0.

- si la resolución especificada no es compatible con el dispositivo.

- si el valor del parámetro &lt;Interfaz de usuario&gt; es <u><u><u><u>True</u></u></u></u>.




**`<Image contrast>: (Real opcional)`**

Contraste de la Image (valor incluido entre -1000 y 1000). 
Se usará el contraste Default Image:


- si este parámetro no se especifica o si corresponde a 0.

- si el dispositivo no admite el contraste especificado.

- si el valor del parámetro &lt;Interfaz de usuario&gt; es <u><u><u><u>True</u></u></u></u>.




**`<Image brightness>: (Real opcional)`**

Brillo de la Image (valor incluido entre -1000 y 1000). 
Se utilizará el brillo de Default Image:


- si este parámetro no se especifica o si corresponde a 0.

- si el dispositivo no soporta el brillo especificado.

- si el valor del parámetro &lt;Interfaz de usuario&gt; es <u><u><u><u>True</u></u></u></u>.




**`<Duplex mode>: (Booleano opcional)`**



- <u><u><u><u>True</u></u></u></u> para escanear un documento por lado y lado,

- <u><u><u><u>False</u></u></u></u> (predeterminado) para escanear el documento por un solo lado.




**`<Automatic load>: (Booleano opcional)`**

<u><u><u><u>True</u></u></u></u> para cargar automáticamente las páginas en el dispositivo. Todas las páginas que se encuentran en el cargador de Scanner se escanean en un único archivo PDF.

Observación: Sin un alimentador, para escanear varias páginas y agregarlas a un solo archivo PDF, debe escanear y agregar cada página a un archivo PDF y luego utilizar la función [PDFMerge](../WDLang6/1000019712.md).

<a name="SYNTAX2"></a>

### Guardando el Document del dispositivo Twain en la memoria en formato PDF

`<Result> = TwainToPDF(<InMemory> [, <User interface> [, <Type of image> [, <Number of bits per pixel> [, <Image resolution> [, <Image contrast> [, <Image brightness> [, <Duplex mode> [, <Automatic load>]]]]]]]])`
---

**`<Result>: (Buffer)`**

Cadena de bytes que contiene la Document en formato PDF.
A continuación, esta cadena de bytes puede asignarse a una control Imagen, guardarse en un archivo ([fSaveBuffer](../WDLang1/1000019412.md)), enviarse a través de una red (con las funciones de Socket), etc.

**`<InMemory>: (Constante)`**




|   |   |
| --- | --- |
| *inMemory* | Guarda en la memoria el Document del dispositivo Twain. |



**`<User interface>: (Booleano opcional)`**



- <u><u><u><u>True</u></u></u></u> si se debe mostrar la interfaz de usuario del dispositivo Twain. 

- <u><u><u><u>False</u></u></u></u> (valor predeterminado) si no se debe mostrar la interfaz de usuario del dispositivo Twain.




**`<Type of image>: (Constante o combinación de constantes de tipo Integer (opcional))`**

Tipo de imagen utilizada para guardar la Document (clasificada por orden de gestión de color):


|   |   |   |
| --- | --- | --- |
| Orden para la gestión de los colores |   |   |
|   | 0 (Valor predeterminado) | Dispositivo Default Image. |
| 1 | *TwainPalette* | Imagen cuyos colores son emitidos por un Palette. |
| 2 | *TwainRGB* | RGB Image. |
| 3 | *TwainGrayScale* | Escala de grises Image. |
| 4 | *TwainBlackWhite* | Imagen en blanco y negro. |
| - | *TwainAnyType* | Cualquier tipo de Image. |


Si se combinan estas constantes, se seleccionará el mejor tipo de imagen soportado por el dispositivo (según el orden de gestión de color). Para obtener más información, consulte los comentarios.

Se utilizará el tipo de Default de Image:


- si este parámetro no se especifica o si corresponde a 0.

- si el tipo especificado de Image no es soportado por el dispositivo.

- si el valor del parámetro &lt;Interfaz de usuario&gt; es <u><u><u><u>True</u></u></u></u>.




**`<Number of bits per pixel>: (Entero opcional)`**

Cantidad de información sobre los colores (para mostrar o imprimir cada píxel en una Image). Cuanto mayor sea el número de bits por píxel, más nítida será la representación de Color. 
Los posibles valores de este parámetro dependen del tipo de Image utilizado:


|   |   |
| --- | --- |
| Tipo de Image | Valores posibles |
| Imagen coloreada emitida desde una paleta (constante *TwainPalette*). | 1, 4 u 8 |
| Imagen RGB (constante *TwainRGB*). | 8, 10 o 16 |
| Imagen en escala de grises (constante *TwainGrayScale*). | 8 o 16 |
| Imagen en blanco y negro (constante *TwainBlackWhite*). | 1 |


Si no se especifica este parámetro, se usará el número de bits por píxel de Default.

**`<Image resolution>: (Real opcional)`**

Número de píxeles por pulgada (los valores posibles dependen del dispositivo utilizado). 
Se utilizará la resolución Default Image:


- si este parámetro no se especifica o si corresponde a 0.

- si la resolución especificada no es compatible con el dispositivo.

- si el valor del parámetro &lt;Interfaz de usuario&gt; es <u><u><u><u>True</u></u></u></u>.




**`<Image contrast>: (Real opcional)`**

Contraste de la Image (valor incluido entre -1000 y 1000). 
Se usará el contraste Default Image:


- si este parámetro no se especifica o si corresponde a 0.

- si el dispositivo no admite el contraste especificado.

- si el valor del parámetro &lt;Interfaz de usuario&gt; es <u><u><u><u>True</u></u></u></u>.




**`<Image brightness>: (Real opcional)`**

Brillo de la Image (valor incluido entre -1000 y 1000). 
Se utilizará el brillo de Default Image:


- si este parámetro no se especifica o si corresponde a 0.

- si el dispositivo no soporta el brillo especificado.

- si el valor del parámetro &lt;Interfaz de usuario&gt; es <u><u><u><u>True</u></u></u></u>.




**`<Duplex mode>: (Booleano opcional)`**



- <u><u><u><u>True</u></u></u></u> para escanear un documento por lado y lado,

- <u><u><u><u>False</u></u></u></u> (predeterminado) para escanear el documento por un solo lado.




**`<Automatic load>: (Booleano opcional)`**

<u><u><u><u>True</u></u></u></u> para cargar automáticamente las páginas en el dispositivo. Todas las páginas que se encuentran en el cargador de Scanner se escanean en un único archivo PDF.

Observación: Sin un alimentador, para escanear varias páginas y agregarlas a un solo archivo PDF, debe escanear y agregar cada página a un archivo PDF y luego utilizar la función [PDFMerge](../WDLang6/1000019712.md).



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>

## Observaciones




### Document procedente del dispositivo Twain
<a name="document_procedente_del_dispositivo_twain_ELTPARAGRAPHE000199"></a>

La "Document procedente del dispositivo Twain" corresponde a:

- el Document en el Scanner cuando **TwainToPDF** se llama. En este caso, se tienen en cuenta los parámetros especificados en [TwainScanArea](../WDLang6/3078014.md).

- el Image transmitido por una "cámara web" cuando se llama **TwainToPDF** .

- la primera foto guardada en una cámara digital. 
	**Observación**: Si se utiliza la [interfaz de usuario](../WDLang6/3078007.md), la Document recuperada corresponderá a la foto seleccionada por el usuario. Si se seleccionan varias fotos, sólo se recuperará la primera foto seleccionada.



<a name="NOTE0_2"></a>


### Manejar el tipo de Image
<a name="manejar_tipo_image_ELTPARAGRAPHE000572"></a>

Si se combinan varias constantes en &lt;Tipo de imagen&gt;, se seleccionará el mejor tipo de imagen soportada por el dispositivo (según el orden de gestión de Color).

Por ejemplo: Si este parámetro corresponde a *TwainBlackWhite* + *TwainRGB*, el tipo de la imagen será:

- RGB si este tipo es soportado por el dispositivo.

- negro y White de otra manera.



<a name="NOTE0_3"></a>


### Dúplex Scanner
<a name="duplex_scanner_ELTPARAGRAPHE000587"></a>

Si el Scanner admite el modo dúplex, tiene la posibilidad de realizar un escaneo a doble cara. El Document generado contiene ambos lados del Document escaneado.

**Observación**: Dependiendo del hardware utilizado, el controlador Twain puede no ser suficiente para soportar un escaneo de doble cara.. Es posible que tenga que instalar controladores adicionales suministrados por el fabricante.


### Modo de funcionamiento en las aplicaciones de 64 bits
<a name="modo_funcionamiento_las_aplicaciones_64_bits_ELTPARAGRAPHE000594"></a>

En una aplicación de 64 bits, esta función utilizará automáticamente el controlador Twain de 64 bits.. No se puede utilizar el TWAIN si este controlador no está instalado.. 





<a name="XComponent"></a>

## Clasificación Lógica de negocio / UI:
Lógica de negocio
## Componente:
wd280std.dll
