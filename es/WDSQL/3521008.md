
## WDSQL: Creación de una consulta SQL
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000215"></a>
Una vez establecida la conexión a la base de datos, WDSQL le permite crear diferentes tipos de consultas SQL:

- ***Seleccionar consulta*** (Comando SELECT): mostrar una selección de registros en la base de datos.

- ***Consulta de inserción*** (instrucción INSERT): añadir registros a un archivo de base de datos.

- ***Actualizar consulta*** (Comando UPDATE): modificar los registros encontrados en un archivo de base de datos.

- ***Consulta de eliminación*** (instrucción DELETE): eliminar registros de un archivo de base de datos.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Creación de una consulta SQL
<a name="creacion_una_consulta_sql_ELTTEXTE000239"></a>
Tiene la posibilidad de crear consultas:

- Desde la ventana principal de WDSQL.<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=WDSQL%20-%20HC%20N%B0007.gif)


- De la asistente para la creación de la consulta.




Una vez creadas, estas consultas pueden serlo:

- Guardado ("Archivo .. Guardar una consulta" o F4 o ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=WDSQL%20-%20HC%20N%B0006%201.gif)). La extensión del archivo creado es ".SQL".

- [Corre](../WDSQL/3521014.md).

- Impreso (haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=WDSQL%20-%20HC%20N%B0006%202.gif)).

- Modificado en WDSQL directamente.




**Atención**: Una consulta creada en WDSQL no se puede modificar en WINDEV. Para usar una consulta creada en WDSQL, todo lo que tienes que hacer es copy/pegar el código SQL:

- a una ventana de código SQL en WINDEV,

- en el parámetro "Texto de consulta en SQL" de la función **HExecuteSQLQuery**.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Creación de una consulta SQL desde la ventana principal de WDSQL
<a name="creacion_una_consulta_sql_desde_ventana_principal_wdsql_ELTTEXTE000263"></a>


### Para crear una consulta desde la ventana principal de WDSQL
<a name="para_crear_una_consulta_desde_ventana_principal_wdsql_ELTPARAGRAPHE000052"></a>

WDSQL propone diferentes métodos para ayudarle a crear la consulta en SQL:

- Visualización y/o uso de los elementos que se encuentran en la base de datos actual: haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=WDSQL%20-%20HC%20N%B0006%204.gif). Para obtener más información, consulte [Estructura de la base de datos](../WDSQL/3521012.md).

- Visualización y/o uso de las diferentes palabras clave SQL: haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=WDSQL%20-%20HC%20N%B0006%208.gif).




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Creando una consulta SQL desde la asistente
<a name="creando_una_consulta_sql_desde_asistente_ELTTEXTE000287"></a>
Para la siguiente operación, consideramos que se ha establecido la conexión con la base de datos.

**Para crear una consulta Select con el asistente**:

1. Seleccione "Archivo .. Crear una consulta" (o haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=WDSQL%20-%20HC%20N%B0006%205.gif)).

2. En la asistente, seleccione "A Select query" y vaya al siguiente paso.

3. Seleccione los diferentes elementos de consulta.
	**Observación**: Si la base de datos actual es una base de datos Oracle o una base de datos SQL Server, tiene la posibilidad de ver las tablas creadas por un usuario específico. Para ello, seleccione el usuario en la lista desplegable "Usuario".

4. Defina las condiciones de selección para cada posición.

5. Ordenar los registros según uno o más elementos:

	- ***En orden ascendente***: haga clic en la columna "Clasificar" correspondiente a las posiciones de clasificación. Aparece la ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=TriCroissant.gif) Icon.

	- ***En orden descendente***: haga clic en la columna "Clasificar" correspondiente a las posiciones de clasificación. Aparece la ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=TriDecroissant.gif) Icon.




6. Si se marca la casilla "No mostrar los duplicados", cada Record que se encuentre en el resultado de la consulta será único. 
	Por ejemplo, si se utiliza una consulta para mostrar a todos los clientes que hicieron al menos un pedido, los clientes que hicieron varios pedidos aparecerán una sola vez en el resultado de la consulta.

7. Si se han definido posiciones de clasificación, especifique la secuencia de estas posiciones de clasificación. Para obtener más información, consulte [Definición de varias posiciones de clasificación](#NOTE5_1).

8. Validar. El código SQL de la consulta creada se muestra automáticamente en la ventana principal de WDSQL.



<a name="NOTE4_2"></a>
Para la siguiente operación, consideramos que se ha establecido la conexión con la base de datos.

**Para crear una consulta de Inserción con el asistente**: 

1. Seleccione "Archivo .. Crear una consulta" (o haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=WDSQL%20-%20HC%20N%B0006%205.gif)).

2. En la asistente, seleccione "Una consulta de inserción" y vaya al siguiente paso.

3. Seleccione el archivo de datos en el que se insertarán los datos. Se visualiza automáticamente la lista de posiciones de fichero.
	**Observación**: Si la base de datos actual es una base de datos Oracle o una base de datos SQL Server, tiene la posibilidad de ver las tablas creadas por un usuario específico. Para ello, seleccione el usuario en la lista desplegable "Usuario".

4. Introduzca los nuevos valores a insertar en la columna "Valor" y valide. El código SQL de la consulta creada se muestra automáticamente en la ventana principal de WDSQL.



<a name="NOTE4_3"></a>
Para la siguiente operación, consideramos que se ha establecido la conexión con la base de datos.

**Para crear una consulta de actualización con el asistente**: 

1. Seleccione "Archivo .. Crear una consulta" (o haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=WDSQL%20-%20HC%20N%B0006%205.gif)).

2. En la asistente, seleccione "Una consulta de actualización" y vaya al siguiente paso.

3. Seleccione el archivo de datos en el que los datos serán modificados. Se visualiza automáticamente la lista de posiciones de fichero.
	**Observación**: Si la base de datos actual es una base de datos Oracle o una base de datos SQL Server, tiene la posibilidad de ver las tablas creadas por un usuario específico. Para ello, seleccione el usuario en la lista desplegable "Usuario".

4. Introduzca los nuevos valores en la columna "Valor".

5. Definir las condiciones de selección de cada Record para modificar y validar. El código SQL de la consulta creada se muestra automáticamente en la ventana principal de WDSQL.



<a name="NOTE4_4"></a>
Para la siguiente operación, consideramos que se ha establecido la conexión con la base de datos.

**Para crear una consulta de Borrado con el asistente**: 

1. Seleccione "Archivo .. Crear una consulta" (o haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=WDSQL%20-%20HC%20N%B0006%205.gif)).

2. En la asistente, seleccione "A Borrar consulta" y vaya al siguiente paso.

3. Seleccione el archivo de datos de la que se borrarán los datos. Se visualiza automáticamente la lista de posiciones de fichero.
	**Observación**: Si la base de datos actual es una base de datos Oracle o una base de datos SQL Server, tiene la posibilidad de ver las tablas creadas por un usuario específico. Para ello, seleccione el usuario en la lista desplegable "Usuario".

4. Definir las condiciones de selección de cada Record para borrar y validar. El código SQL de la consulta creada se muestra automáticamente en la ventana principal de WDSQL.




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Definición de varias posiciones de clasificación
<a name="definicion_varias_posiciones_clasificacion_ELTTEXTE000329"></a>
Cuando se definen varias posiciones de clasificación, las clasificaciones se anidan. La clasificación comienza a partir de la primera posición encontrada en el tabla de posiciones de clasificación.

Por ejemplo, al crear la consulta, en la ventana de abajo, se ordena el resultado de la consulta:

- por cantidad total de pedidos (orden ascendente),

- luego por ciudad de clientes (orden descendente),

- por último, por nombre de los clientes (orden ascendente).



<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=WDSQL%20-%20HC%20N%B0005.gif)


En el siguiente paso de asistente, las flechas que se encuentran a la derecha de la ventana se utilizan para modificar la secuencia de los elementos de clasificación.

El código SQL correspondiente a este ejemplo será el siguiente:


```sql
SELECT CUSTOMER.CustomerLName, CUSTOMER.City, ORDERS.TotalIOT
	FROM CUSTOMER, ORDERS
	WHERE CUSTOMER.City LIKE 'Paris'
	ORDER BY TotalIOT ASC, City DESC, CustomerName ASC
```



