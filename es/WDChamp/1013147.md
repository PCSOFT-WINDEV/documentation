


## Programar controles Tabla basados en un archivo de datos
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000265"></a>
Esta página explica cómo programar controles Tabla basados en un archivo de datos. Existen varias funciones WLanguage para manipular este tipo de controles Tabla mediante programación.

Para saber más sobre estas funciones, consulte la documentación. Para obtener más información, consulte: [Lista de funciones específicas de los controles Tabla](../WDLang1/3074009.md).



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Seleccionar, agregar y modificar una fila en un control Tabla basado en un archivo de datos
<a name="seleccionar_agregar_modificar_una_fila_control_tabla_basado_archivo_datos_ELTTEXTE000289"></a>
Una fila se puede seleccionar con la función [TableSelectPlus](../WDLang1/3074031.md).

Si no define ningún campo almacenado para el control Tabla, utilice la siguiente sintaxis:


```txt
<Table control> = <Number of row to select>
```

<a name="NOTE2_2"></a>
Para agregar y modificar filas en el control Tabla (o registros en el archivo de datos), siga los siguientes pasos:

1. Agregue o modifique el registro en el archivo de datos (a través de una ventana o página de formulario, por ejemplo).

2. Vuelva a cargar el control Tabla:

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) actualice el control Tabla.







<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Eliminar una fila de un control Tabla basado en un archivo de datos
<a name="eliminar_una_fila_control_tabla_basado_archivo_datos_ELTTEXTE000319"></a>
Para eliminar una fila del control Tabla basado en un archivo de datos, utilice la función [TableDelete](../WDLang1/3074032.md). La función [TableDelete](../WDLang1/3074032.md) elimina el registro correspondiente del archivo de datos.
**Importante**: Para eliminar un registro del archivo de datos, no utilice la función [HDelete](../WDLang4/3044018.md), de lo contrario podría perder los datos.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Gestión de columnas calculadas
<a name="gestion_columnas_calculadas_ELTTEXTE000343"></a>
La fórmula de cálculo de una columna calculada debe definirse en el evento "Visualización de una fila" de un control Tabla.

Ejemplo de código en el evento "Visualización de una fila" del control Tabla: 

```wl
// COL_AlertMsg: a calculated column 
// The COL_AlertMsg column displays "Alert" if COL_Stock<200
IF COL_Stock < 200 THEN
	COL_AlertMsg = "Alert"
ELSE
	COL_AlertMsg = ""
END
```

De forma predeterminada, una columna calculada no está enlazada a un campo: el valor asignado en el código de visualización de una fila se pierde al desplazarse verticalmente por las filas de un control Tabla. 

Por ejemplo, no se puede utilizar la instrucción "FOR EACH LINE" para asignar u obtener el valor de una columna calculada en todas las filas del control Tabla. 

Si el control Tabla utiliza una fuente de datos en memoria (opción "Cargado en memoria" seleccionada en la pestaña "Contenido" de la ventana de descripción del control), el valor de las columnas calculadas no se perderá en tiempo de ejecución. 

<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Obtener el contenido de una fila, columna o celda
<a name="obtener_contenido_una_fila_columna_celda_ELTTEXTE000367"></a>


### Importante
<a name="importante_ELTPARAGRAPHE000112"></a>

El contenido de una fila de un control Tabla basado en un archivo de datos puede obtenerse:

- recuperando toda la fila. 

- celda por celda. 



<a name="NOTE5_2"></a>


### Valor de la celda en la fila actual
<a name="valor_celda_fila_actual_ELTPARAGRAPHE000124"></a>La celda se identifica con el nombre de la columna. Se debe utilizar la siguiente sintaxis:


```txt
<Value> = <Column name>
```


Ejemplo: 

```wl
// COL_QTY is a column of the Table control
IF COL_QTY < 10 THEN
	INFO("Insufficient quantity")
END
```

<a name="NOTE5_3"></a>


### Valor de una celda en una fila específica
<a name="valor_una_celda_una_fila_especifica_ELTPARAGRAPHE000139"></a>

La celda se identifica con el nombre de la columna. Se debe utilizar la siguiente sintaxis:

```txt
<Value> = <Column name>[<Row index>]
```
Ejemplo: 

```wl
// Adds the price found in the COL_PBT column  
// for all the order lines displayed
TotalPrice = 0
FOR Index = 1 TO TABLE_ORDER.Count
	TotalPrice = TotalPrice + COL_PBT[Index]
END
```

<a name="NOTE5_4"></a>


### Contenido de la fila actual
<a name="contenido_fila_actual_ELTPARAGRAPHE000153"></a>

Se debe utilizar la siguiente sintaxis:

```txt
<Value> = <Table control>
```
También puede usar la siguiente sintaxis: 

```txt
<Value> = <Table control>[<Table control>]
```

<a name="NOTE5_5"></a>


### Contenido de la fila X
<a name="contenido_fila_ELTPARAGRAPHE000167"></a>

Se debe utilizar la siguiente sintaxis:

```txt
<Value>=<Table control>[<Row index>]
```


**Observación**: La función [TableSelect](../WDLang1/3074020.md) devuelve el índice de la fila.

```wl
// Retrieves the current row in TABLE_CUSTOMER
CurrentRow = TABLE_CUSTOMER

// Name of the selected customer
CustName = COL_NAME[TableSelect(TABLE_CUSTOMER)]
```

<a name="NOTE5_6"></a>


### Contenido de las filas seleccionadas en una selección múltiple
<a name="contenido_las_filas_seleccionadas_una_seleccion_multiple_ELTPARAGRAPHE000189"></a>Se debe utilizar la siguiente sintaxis:


```txt
<Value>=<Table control>[<Row index>]
```


**Observación**: Para obtener los índices de las filas seleccionadas, utilice las funciones [TableSelectCount](../WDLang1/3074030.md) y [TableSelect](../WDLang1/3074020.md).

```wl
// Traces the content of the selected rows
i is int
NbSelected is int = TableSelectCount(TABLE_Product) 
FOR i = 1 TO NbSelected 
	Trace("Selected row: " + ...
			TABLE_Product[TableSelect(TABLE_Product, i)]) 
END 

// Equivalent to:
// FOR EACH SELECTED ROW OF TABLE_Product
//	Trace("Selected row: " + TABLE_Product[TableSelect(TABLE_Product, i)])
// END
```

**Observación**: Los controles Tabla de selección múltiple basados en un archivo de datos no están disponibles:

- Si el control Tabla contiene barras de desplazamiento proporcionales.

- Si el control Tabla es "Compatible con la versión 5.5".

- En controles Tabla que se muestran en un Combo Box.




**Observación**: La propiedad [Multiselection](../Proprietes/1000017054.md) permite obtener el modo de selección de un control Tabla.


