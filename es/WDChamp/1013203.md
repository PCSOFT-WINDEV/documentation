
## Controles de tabla, cuadro de lista y Combo Box vinculados a consultas
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000267"></a>
Se puede utilizar una tabla, un cuadro de lista o una control Combo Box para mostrar el contenido de un archivo de datos o la consulta.

Se puede vincular una tabla, un cuadro de lista o una control Combo Box:

- un ***consulta independiente***. Esta consulta ya existe en el proyecto: solo tiene que seleccionar la consulta deseada en las consultas del proyecto.

- una consulta ***incluida en el control***: esta consulta se creará en el asistente para crear el control (tabla, List Box o Combo Box). Esta consulta estará disponible sólo para esta control y se guardará con la ventana (o con la página) que la utilice. En este caso, la ventana (o la página) contiene todos los elementos necesarios.

- una consulta con ***parámetros***: esta consulta (independiente o incrustada) requiere parámetros para ejecutarse y mostrar el resultado en la Tabla, Cuadro de lista o Cuadro combinado control.




**Observación**: Esta página de ayuda presenta el caso de controles Tabla, pero sería lo mismo para los controles List Box o Combo Box.



<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## control Tabla basada en una consulta independiente (sin parámetros)
<a name="control_tabla_basada_una_consulta_independiente_sin_parametros_ELTTEXTE000291"></a>


### Principio
<a name="principio_ELTPARAGRAPHE000037"></a>

Una control Tabla basada en una consulta independiente (sin parámetros) muestra los registros de esta consulta.

Por Default, la consulta se ejecuta y se carga en la memoria durante su primer uso. El resultado de una consulta utilizada en una control Tabla basada en un archivo de datos permanece en memoria cuando se cierra la ventana de associated. Esta consulta no se volverá a ejecutar cuando se vuelva a utilizar.

Para volver a ejecutar esta consulta, debe utilizar:

- la función [HFreeQuery](../WDLang4/1000019374.md).

- la función [HCancelDeclaration](../WDLang4/3044174.md).

- [TableDisplay](../WDLang1/3074003.md) (o [ListDisplay](../WDLang1/3049005.md) para una Caja de Listas o control Combo Box).



<a name="NOTE2_2"></a>


### Uso de las funciones HCancelDeclaration/HFreeQuery
<a name="uso_las_funciones_hcanceldeclarationhfreequery_ELTPARAGRAPHE000065"></a>

- Si no se llama a [HCancelDeclaration](../WDLang4/3044174.md), la consulta no se ejecutará la próxima vez que se inicialice control Tabla (la próxima vez que se abra la ventana, por ejemplo). Se utilizarán los datos recuperados durante la última consulta.. Si el control Tabla se basa en una consulta con parámetros, véase "control Tabla basado en una consulta con parámetros (incrustados o no)".

- Si se llama a [HCancelDeclaration](../WDLang4/3044174.md), la consulta se ejecutará la próxima vez que se inicialice control Tabla (la próxima vez que se abra la ventana, por ejemplo).




**Observación**: [HFreeQuery](../WDLang4/1000019374.md) se basa en [HCancelDeclaration](../WDLang4/3044174.md). Su modo de funcionamiento es idéntico. 

**Ejemplo**: 


```wl
// Closing code of the window
HCancelDeclaration(TABLE_MyTable.BrowsedFile)
```

<a name="NOTE2_3"></a>


### Actualizar el contenido de la consulta
<a name="actualizar_contenido_consulta_ELTPARAGRAPHE000093"></a>

La consulta puede volver a ejecutarse utilizando la función [TableDisplay](../WDLang1/3074003.md) (o [ListDisplay](../WDLang1/3049005.md) para un control List Box o Combo Box) con la constante ***taReExecuteQuery***.

<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## control Tabla basada en una consulta incrustada (sin parámetros)
<a name="control_tabla_basada_una_consulta_incrustada_sin_parametros_ELTTEXTE000327"></a>


### Principio
<a name="principio_ELTPARAGRAPHE000108"></a>

Una control Tabla basada en una consulta incrustada (sin parámetros) muestra los registros de esta consulta.

Por Default, la consulta se ejecuta y se carga en la memoria cuando se muestra el control Tabla. El resultado de una consulta incrustada utilizada en una control Tabla basada en un archivo de datos se borra automáticamente de la memoria al cerrar la ventana de associated. Esta consulta se volverá a ejecutar cuando se vuelva a utilizar.
<a name="NOTE3_2"></a>


### Actualizar el contenido de la consulta
<a name="actualizar_contenido_consulta_ELTPARAGRAPHE000117"></a>

La consulta puede volver a ejecutarse utilizando la función [TableDisplay](../WDLang1/3074003.md) (o [ListDisplay](../WDLang1/3049005.md) para un control List Box o Combo Box) con la constante ***taReExecuteQuery***.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## control Tabla basada en una consulta con parámetros (consulta independiente o incrustada)
<a name="control_tabla_basada_una_consulta_con_parametros_consulta_independiente_incrustada_ELTTEXTE000357"></a>


### Principio
<a name="principio_ELTPARAGRAPHE000132"></a>

Cuando una control Tabla está vinculada a una consulta con parámetros (independientes o incrustados), los parámetros deben pasarse a la consulta antes de que se ejecute.

Si estos parámetros no se especifican antes de la primera ejecución de la consulta, ésta no se ejecutará y control Tabla permanecerá vacía.

Para pasar parámetros a la consulta, puede hacerlo:

- especifique los parámetros uno por uno usando:

	- la siguiente notación: 
			
		```txt
		<Query Name>.<Name of Parameter1> = xxx
		<Query Name>.<Name of Parameter2> = xxx
		<Query Name>.<Name of Parameter3> = xxx
		```

			En este caso, la consulta se ejecuta automáticamente al inicializar la control Tabla.

	- la palabra clave [MiFuente](../Motscles/1511001.md):
			
		```txt
		MySource.<Name of Parameter1> = xxx
		MySource.<Name of Parameter2> = xxx
		MySource.<Name of Parameter3> = xxx
		```


	- la indirección:
			
		```txt
		{"<Query Name>.<Name of Parameter 1>"} = xxx
		or
		{"<Query Name>"}.<Name of Parameter 1> = xxx
		```





- especificar los parámetros de una vez con [HExecuteQuery](../WDLang4/3044080.md).




Este método para pasar parámetros se puede utilizar en el código de declaración de variables globales de la ventana o en el código de inicialización de control Tabla por ejemplo.

Para tener en cuenta estos parámetros, debe utilizar [TableDisplay](../WDLang1/3074003.md) (o [ListDisplay](../WDLang1/3049005.md) para un cuadro de lista o control Combo Box).

Para reejecutar la consulta con parámetros diferentes, basta con especificar estos nuevos parámetros y, a continuación, utilizar [TableDisplay](../WDLang1/3074003.md) (o [ListDisplay](../WDLang1/3049005.md) para un cuadro de lista o control Combo Box).
<a name="NOTE4_2"></a>


### Pasar parámetros a la consulta: &lt;Nombre de la pregunta&gt;.&lt;Nombre del parámetro1&gt;&gt;. 
<a name="pasar_parametros_consulta_ELTPARAGRAPHE000182"></a>

No es necesario especificar todos los parámetros de consulta. Las condiciones de la consulta que utilizan parámetros no especificados se ignorarán.. Para obtener más información, consulte [Métodos a utilizar para pasar parámetros a una consulta](../Editeurs/2032050.md).

**Observación**: Si no se especifica ningún parámetro de consulta antes de la primera ejecución de la consulta, ésta no se ejecutará.. El control Tabla associated con la consulta permanecerá vacío.

**Atención**: Todos los parámetros de la consulta se reinicializan cada vez que se ejecuta la consulta. Los valores que se han utilizado con anterioridad no se almacenan.. Debe redefinir los parámetros de consulta para que se pueda ejecutar de nuevo.
<a name="NOTE4_3"></a>


### Casos especiales: Inicializar un control Tabla o usar TableDisplay sin la constante taReExecuteQuery
<a name="casos_especiales_inicializar_control_tabla_usar_tabledisplay_sin_constante_tareexecutequery_ELTPARAGRAPHE000196"></a>

- Si no se ha modificado ningún parámetro de consulta desde la última ejecución de la consulta, ésta no se volverá a ejecutar.. El control Tabla mostrará los registros correspondientes a la última ejecución de la consulta.

- Una vez modificados los parámetros de la consulta, se utiliza [TableDisplay](../WDLang1/3074003.md) (o [ListDisplay](../WDLang1/3049005.md) para un cuadro de lista o control Combo Box) para volver a ejecutar la consulta. El control Tabla muestra todos los registros correspondientes a los parámetros especificados.



<a name="NOTE4_4"></a>


### Caso especial: Usando TableDisplay con la constante taReExecuteQuery
<a name="caso_especial_usando_tabledisplay_con_constante_tareexecutequery_ELTPARAGRAPHE000210"></a>

Para forzar la ejecución de una consulta, utilice [TableDisplay](../WDLang1/3074003.md) (o [ListDisplay](../WDLang1/3049005.md) para un cuadro de lista o Combo Box) con la constante *taReExecuteQuery*.

**Recordatorio**: La estructura de los parámetros de consulta que se reinician cada vez que se ejecuta la consulta, no olvide redefinir los parámetros solicitados antes de utilizar esta función.


