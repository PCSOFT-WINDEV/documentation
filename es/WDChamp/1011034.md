


## Reporte basada en una fuente de datos programada
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000248"></a>
En un reporte sobre una fuente de datos programada, la lectura de los registros que se mostrarán en el reporte requiere una programación completa en WLanguage.. La fuente de datos puede tener cualquier tipo (archivo HFSQL, consulta, archivo de texto, archivo de una base de datos externa, etc.).

La creación de una reporte basada en una fuente de datos programada es realizada por la asistente para la creación de la reporte.

Cuando se crea la reporte basada en una fuente de datos programada, puede hacerlo:

- modificar la fuente de datos del reporte (pestaña "Datos" en el reporte description).

- añadir o borrar Controles de posición relacionado a la fuente de datos del reporte.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ER.png) | Importante | [Reports & Queries](../Presentation/3088004.md) no permite crear informes basados en una fuente de datos programada. Sin embargo, tiene la posibilidad de personalizar los informes sobre una fuente de datos programada creada en el estándar editor de reportes (Color, fuentes, tamaño, ...). |







<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Creación de una reporte sobre una fuente de datos programada
<a name="creacion_una_reporte_sobre_una_fuente_datos_programada_ELTTEXTE000296"></a>


### Presentación
<a name="presentacion_ELTPARAGRAPHE000054"></a>

Se requieren dos pasos para crear una reporte basada en una fuente de datos programada:

1. Creando la reporte con la creación de la asistente.

2. Programación de la lectura de registros.



<a name="NOTE2_2"></a>


### Creación de una reporte sobre una fuente de datos programada
<a name="creacion_una_reporte_sobre_una_fuente_datos_programada_ELTPARAGRAPHE000064"></a>

Para crear una reporte en una fuente de datos programada:

1. Haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ico_nouveau.gif) en los botones de acceso rápido. 

	- Aparece la ventana de creación: haga clic en "Reporte", y luego en "Reporte".

	- El asistente de creación de reportes se abre.




2. Elija el diseño de su reporte (tabla, formulario, etiqueta,...). Para obtener más información, consulte [Diferentes tipos de reportes](../WDChamp/1011054.md).

3. Seleccione la fuente de datos de la reporte ("Otros (programación, archivo de texto, zona de memoria, vista HFSQL)"). A continuación, seleccione "Programar la lectura de mi fuente de datos".

4. Para cada tipo de reporte, especifique las opciones específicas correspondientes.
	

| Tipo de reporte | Opciones específicas |
| --- | --- |
| Mesa reporte | <br><br>	- especifique el número de columnas que se encuentran en el tabla.<br><br>	- para cada columna, especifique el título y el tipo de valor impreso.<br><br>	- modificar (si es necesario) el orden de las diferentes columnas.<br><br><br> |
| Reporte en forma | Formulario Image, imprimiendo el formulario Image, ...<br>Opciones presentadas en detalle en [Reporte en forma](../WDChamp/1011067.md). |
| reporte Label | Formato de las etiquetas, número de copias idénticas, ...<br>Opciones presentadas en detalle en [reporte Label](../WDChamp/1011050.md). |



5. Especificar el formato de la hoja en la que se imprimirá el reporte. El reporte se imprime en formato A4 por Default.

6. Selecciona la plantilla de la reporte si es necesario.

7. Introduzca el nombre y el título de la reporte. Este nombre (".WDE". archivo correspondiente a la reporte) se utilizará para identificar la reporte en sus programas.

8. Validar la creación de reporte. 

9. Si el reporte contiene un tabla, el editor de reportes propone automáticamente cambiar el formato del reporte y/o reducir el tamaño del tabla si algunas de las columnas tabla no se pueden imprimir en el reporte.

10. Especifique (si es necesario) el modo para reducir el tamaño de reporte:

	- Imprimir la reporte en varias páginas. En este caso, el usuario final tendrá que agrupar las páginas. Para obtener más información, consulte [Impresión de varias páginas](../WDChamp/1011065.md). 

	- Utilizar el modo horizontal. 

	- Reducir el tamaño de reporte. Atención: según el porcentaje de reducción, la reporte impresa puede volverse ilegible. 




11. La reporte creada actualmente se visualiza en el editor de reportes.



<a name="NOTE2_3"></a>


### Programación de la lectura de registros
<a name="programacion_lectura_registros_ELTPARAGRAPHE000130"></a>

La programación necesaria para leer los registros se presenta en el siguiente ejemplo:|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=exemple-WD.png) | Ejemplo | La información a imprimir está en el archivo de datos HFSQL llamado "Cliente". Los datos se visualizan en los controles de posición. |



Se utiliza el siguiente método ** para programar la lectura de los registros**:

1. Lectura del primer registro del archivo de datos "Customer" en el evento "Apertura del reporte" ([HReadFirst](../WDLang4/3044051.md)).
	
	```wl
	// Read the first record of "Customer" data file 
	HReadFirst(Customer, CustomerNum)
	```


2. El evento "Lectura de datos" del reporte permite gestionar el final del archivo de datos. Los siguientes valores se devuelven según el caso:

	- <u><u><u><u>True</u></u></u></u>: no se ha alcanzado el final del archivo (se ejecuta el paso 3).

	- <u><u><u><u>False</u></u></u></u>: fin del archivo alcanzado (el paso 3 no se ejecuta).
			
		```wl
		// End of "Customer" data file reached?
		IF HOut() = True THEN
			// Stop printing the Body block 
			RESULT False
		ELSE
			// Print the Body block and run its events
			RETURN True
		END
		```





3. El Event "Antes de imprimir" del bloque del Cuerpo se utiliza para manejar los registros del archivo de datos:

	- Asignar los valores de los ítems en los controles reporte.

	- Leyendo el próximo Record.
			
		```wl
		// Assign the values of items in the report controls
		ITEM_Company = Customer.Company
		ITEM_Name = Customer.CustomerName
		ITEM_Address = Customer.Address
		ITEM_ZC = Customer.ZC
		ITEM_City = Customer.City
		
		// Read the next record 
		HReadNext(Customer)
		```





4. La Event "Después de la impresión" del bloque Cuerpo se utiliza para gestionar un salto de página, en caso de que cada página contenga un único bloque Cuerpo. 
	**Observación**: En la ventana description del bloque Cuerpo, la opción "Salto de página después del bloque" no se aplica para un reporte basado en una fuente de datos programada.
	
	```wl
	// Page break as long as records are still found 
	IF HOut() = False THEN
		iPageEnd()
	END
	```




<a name="NOTE2_4"></a>


### Orden de ejecución de los diferentes eventos de WLanguage
<a name="orden_ejecucion_los_diferentes_eventos_wlanguage_ELTPARAGRAPHE000176"></a>

El orden en el que se ejecutan los diferentes eventos de WLanguage para leer los registros se presenta en el siguiente tabla:

| Orden de ejecución de los eventos reporte | Programación necesaria para la lectura de los datos |
| --- | --- |
| **1.** Apertura del reporte | Leer la primera Record ([HReadFirst](../WDLang4/3044051.md) por ejemplo). |
| **2.** Lectura de los datos de reporte | Manejando el final del archivo de datos. |
| **3.** Antes de imprimir el bloque *Body* | Asignación de los valores de los elementos de los controles reporte y lectura del siguiente Record ([HReadNext](../WDLang4/3044037.md) por ejemplo). |




