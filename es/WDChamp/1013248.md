


## Programando los cálculos de automatic en las columnas de un control Tabla
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## ¿Cuándo se realizan los cálculos?
<a name="¿cuando_realizan_los_calculos_ELTTEXTE000281"></a>
Se realizan los cálculos:

- al inicializar la control Tabla. 

- cuando un Process realiza una adición o modificación en un control Tabla con cálculos:

	- los totales se recalculan al final de Process (o cuando se utiliza [Multitask](../WDLang1/3015004.md)).

	- si se solicita el valor de un cálculo (véase el párrafo siguiente), el cálculo se vuelve a ejecutar instantáneamente.







[TotalsEnabled](../Proprietes/2510122.md) se utiliza para prohibir o forzar los cálculos realizados en un control Tabla. 

**Atención**: Si la propiedad [DisplayEnabled](../Proprietes/2510015.md) se utiliza en el control Tabla y se establece como <u><u><u><u>False</u></u></u></u>, los cálculos de automatic no se actualizan. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Recuperación del resultado del cálculo
<a name="recuperacion_del_resultado_del_calculo_ELTTEXTE000305"></a>
El resultado de los cálculos realizados en una control Tabla puede manejarse mediante programación.

Se utilizan varias constantes para identificar el cálculo fila de una columna:



|   |   |
| --- | --- |
| *rowAverage* | Fila que contiene el resultado de una media. |
| *rowCount* | Fila que contiene el resultado del recuento. |
| *rowMaximum* | Fila que contiene el valor máximo de las celdas de columna. |
| *rowMinimum* | Fila que contiene el valor mínimo de las celdas de columna. |
| *rowTotal* | Fila que contiene el resultado de un total. |


**Para recuperar el valor de un cálculo, utilice la siguiente sintaxis**:


```txt
<Column name>[<Type of calculation>]
```

Ejemplo:


```wl
// Retrieve the result for the average calculated in the COL_GRADE column
Trace(COL_GRADE[RowAverage])
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Modificar las características de los cálculos mediante la programación
<a name="modificar_las_caracteristicas_los_calculos_mediante_programacion_ELTTEXTE000329"></a>
WINDEV permite modificar las características (tipo de letra, color, ...) del resultado de una columna mediante programación con varias propiedades WLanguage. Las propiedades WLanguage permiten modificar la color del resultado, su fondo color, su fuente, ... Sin embargo, el contenido de la celda de resultados no puede modificarse mediante programación.

**To utilizar un WLanguage Property en el resultado de una columna**, se debe utilizar la siguiente sintaxis:


```txt
<Column name>[<Type of calculation>].<Property>
```

Ejemplo:


```wl
// Color the mean result in red. The background is colored in blue
COL_GRADE[RowAverage].Color = LightRed
COL_GRADE[RowAverage].BackgroundColor = LightBlue
```

<a name="NOTE3_2"></a>


### Propiedades que se pueden utilizar en las celdas de cálculo de las columnas
<a name="propiedades_que_pueden_utilizar_las_celdas_calculo_las_columnas_ELTPARAGRAPHE000105"></a>




|   |   |
| --- | --- |
| [Altura](../Proprietes/2510050.md) | Permite conocer y modificar la altura de una celda de cálculo. |
| [anchura](../Proprietes/2510059.md) | Permite conocer y modificar el ancho de una celda de cálculo. |
| [BackgroundColor](../Proprietes/2510022.md) | Permite conocer y modificar la color de fondo de una celda de cálculo. |
| [Color](../Proprietes/2510071.md) | Permite conocer y modificar la color del texto que aparece en una celda de cálculo. |
| [denominar](../Proprietes/2510082.md) | Se usa para encontrar el nombre de una celda de cálculo. |
| [Estado](../Proprietes/2510039.md) | Obtiene y cambia el estado de visualización de la fila que contiene la celda de cálculo. |
| [FontBold](../Proprietes/2510103.md) | Permite conocer y modificar el atributo "Negrita" de los elementos de la columna. |
| [FontCondensed](../Proprietes/2510096.md) | Se utiliza para averiguar si los caracteres de los elementos de columna son condensados o no, y para condensar (o no) los caracteres de los elementos de columna. |
| [FontExtended](../Proprietes/2510104.md) | Se utiliza para averiguar si los caracteres de los elementos de columna están extendidos o no, y para extender (o no) los caracteres de los elementos de columna. |
| [FontItalic](../Proprietes/2510102.md) | Permite conocer y modificar el atributo "Cursiva" de los elementos de la columna. |
| [FontLarge](../Proprietes/2510101.md) | Se utiliza para averiguar si los caracteres de los elementos de las columnas están ampliados o no, y para ampliar (o no) los caracteres de los elementos de las columnas. |
| [FontName](../Proprietes/2510100.md) | Permite conocer y modificar el tipo de letra de los elementos de la columna. |
| [FontSize](../Proprietes/2510072.md) | Permite conocer y modificar el tamaño de la fuente utilizada para los elementos de la columna. |
| [FontStrikeOut](../Proprietes/2510091.md) | Permite conocer y modificar el atributo "StrikeOut" de una celda de cálculo. |
| [FontUnderlined](../Proprietes/2510099.md) | Permite conocer y modificar el atributo "Underline" de los elementos de la columna. |
| [Nota](../Proprietes/2510085.md) | Se utiliza para averiguar y modificar las notas associated con una celda de cálculo. |
| [Pie de foto](../Proprietes/2510053.md) | Permite conocer y modificar la leyenda del fila que contiene una celda de cálculo. |
| [tipo de letra](../Motscles/1514045.md) | Permite conocer y modificar la fuente utilizada en una celda de cálculo. |
| [Visible](../Proprietes/2510138.md) | Se utiliza para averiguar si una columna es visible y para hacerla visible/Invisible. |



<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Exportación de los resultados de los cálculos
<a name="exportacion_los_resultados_los_calculos_ELTTEXTE000359"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png) 

### Exportación a través de la AAF (automatic Application Features) de control Tabla
<a name="exportacion_traves_aaf_automatic_application_features_control_tabla_ELTPARAGRAPHE000214"></a>

El menú contextual de Table y TreeView controles Tabla contiene varias opciones para exportar el contenido de control. 

Durante esta exportación, los resultados de los cálculos de automatic se exportan. 

**Observaciones**: 

- Sólo se exporta el valor, no la leyenda. 

- Durante la exportación en Excel, la celda correspondiente al cálculo contiene la fórmula de Excel correspondiente. 





### Exportación a través de las funciones WLanguage
<a name="exportacion_traves_las_funciones_wlanguage_ELTPARAGRAPHE000228"></a>

Se pueden utilizar varias funciones de WLanguage para exportar el contenido de un control Tabla en un formato específico (Word, Excel, XML, ....). Durante esta exportación, las filas correspondientes a los cálculos también son exportadas por Default.

Para no exportar las filas de cálculo, solo debe especificar la constante *taNoTotal* en las siguientes funciones:



|   |   |
| --- | --- |
| [TablaToWord](../WDLang1/3074036.md) | Crea un archivo Word (.RTF) a partir de los datos encontrados en una Tabla o control Tabla TreeView. |
| [TableToClipboard](../WDLang1/1000017062.md) | Copia el contenido de una Tabla o control Tabla TreeView al portapapeles. |
| [TableToExcel](../WDLang1/3074033.md) | Crea un archivo Excel con los datos de una Tabla o control Tabla TreeView. |
| [TableToText](../WDLang1/1000017061.md) | Crea un string a partir de los datos encontrados en una Tabla o control Tabla TreeView. |
| [TableToXML](../WDLang1/3074037.md) | Crea un archivo XML a partir de los datos encontrados en una Tabla o control Tabla TreeView. |






