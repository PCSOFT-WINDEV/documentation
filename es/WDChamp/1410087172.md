
## Manejo de un editor Diagram control mediante programación
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Présentation
<a name="presentation_ELTTEXTE000271"></a>
WINDEV et WEBDEV permettent de manipuler un champ Editeur de diagrammes par programmation. Il suffit d'utiliser directement la variable du champ dans le code.

Un champ Editeur de diagrammes peut également être manipulé par programmation grâce aux [Fonctions Diagramme](../WDLang1/1410088562.md).  

Cette page d'aide détaille comment manipuler un champ Editeur de diagrammes par programmation. 





## Manipuler le champ Editeur de diagrammes par programmation
<a name="manipuler_champ_editeur_diagrammes_par_programmation_ELTTEXTE000295"></a>


### Présentation
<a name="presentation_ELTPARAGRAPHE000022"></a>Un champ Editeur de diagrammes permet de créer et d'afficher des diagrammes par programmation. Pour cela, le WLangage met à votre disposition : 

- Les [fonctions Diagramme](../WDLang1/1410088562.md). 

- Plusieurs types de variables spécifiques, permettant de manipuler les diagrammes et les formes du diagramme. Pour plus de détails, consultez [Variables de gestion des diagrammes](../WDLang1/1410088562.md). 







### Exporter un diagramme sous forme d'image
<a name="exporter_diagramme_sous_forme_image_ELTPARAGRAPHE000037"></a>Pour exporter un diagramme sous forme d'image, il est possible d'utiliser la fonction [DiagrammeVersImage](../WDLang1/1410088144.md). Cette fonction permet d'exporter le diagramme sous forme d'une variable de type [Image](../WDLang1/1000019650.md). Il suffit ensuite d'utiliser une des fonctions suivantes pour obtenir l'image du diagramme dans le format voulu : 



|   |   |
| --- | --- |
| [dSaveImageBMP](../WDLang1/3029026.md) | Guarda una imagen:<br><br>- en un archivo en formato BMP.<br><br>- en la memoria.<br><br><br> |
| [dSaveImageGIF](../WDLang1/3029040.md) | Guarda una imagen:<br><br>- en un archivo en formato GIF.<br><br>- en la memoria.<br><br><br> |
| [dSaveImageICO](../WDLang1/1000020798.md) | Guarda una imagen en formato de ícono en un archivo o en la memoria. |
| [dSaveImageJPEG](../WDLang1/3029038.md) | Guarda una imagen:<br><br>- en un archivo JPEG.<br><br>- en la memoria.<br><br><br> |
| [dSaveImagePNG](../WDLang1/3029027.md) | Guarda una imagen:<br><br>- en un archivo PNG.<br><br>- en la memoria.<br><br><br><br><br> |
| [dSaveImageTIFF](../WDLang1/1000020852.md) | Guarda una imagen en formato TIFF en un archivo o en la memoria. |








### Gestion des bibliothèques de formes
<a name="gestion_des_bibliotheques_formes_ELTPARAGRAPHE000050"></a>Par défaut, des bibliothèques de formes sont fournies avec le champ Editeur de diagrammes. 

Il est possible de créer sa propre bibliothèque de formes. Une bibliothèque de formes correspond à un diagramme chargé en tant que bibliothèque. Ce diagramme peut être créé : 

- via le champ Editeur de diagrammes : 

	1. Créez un diagramme. 

	2. Importez les images correspondant aux formes voulues. 

	3. Enregistrez le diagramme créé dans un fichier au format ".wddiag". 




- par programmation :

	1. Créez une variable de type [Diagramme](../WDLang1/1410088055.md). Cette variable correspondra à la bibliothèque de formes. 

	2. Créez les différentes formes personnalisées. 

	3. Ajoutez les formes au diagramme "Bibliothèque". 

	4. Enregistrez le diagramme "Bibliothèque" dans un fichier ".wddiag". 







Une fois le diagramme "Bibliothèque" créé :  

1. Chargez le diagramme créé en tant que bibliothèque (fonction [DiagrammeChargeBibliothèque](../WDLang1/1410088356.md)). 

2. Ajoutez la bibliothèque au tableau des bibliothèques du diagramme final. 




Exemple de création d'une bibliothèque par programmation : 


Remarque : Si vous souhaitez utiliser uniquement vos propres bibliothèques, pensez à supprimer les bibliothèques proposées par défaut par PC SOFT. Pour cela, utilisez la fonction [TableauSupprimeTout](../WDLang1/3075010.md) sur le tableau des bibliothèques de votre diagramme. 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Astuces de programmation
<a name="astuces_programmation_ELTTEXTE000388"></a>


### Comment récupérer les caractéristiques de la sélection dans un champ Editeur de diagrammes ? 
<a name="comment_recuperer_les_caracteristiques_selection_dans_champ_editeur_diagrammes_ELTPARAGRAPHE000093"></a>Les caractéristiques de la sélection effectuée dans un champ Editeur de diagrammes peuvent être récupérées via la propriété [Sélection](../Proprietes/1000023033.md) utilisée sur le champ. Si la sélection comprend plusieurs formes, il est possible de parcourir le tableau des formes. 

Exemple : 



### Utilisation de la propriété Note des différentes formes
<a name="utilisation_propriete_note_des_differentes_formes_ELTPARAGRAPHE000104"></a>Les différentes variables de type [diagForme](../WDLang1/1410088082.md) ([diagOvale](../WDLang1/1410088135.md), [diagRectangle](../WDLang1/1410088083.md), ...) possèdent une propriété **Note**. Cette propriété peut être utilisée pour enregistrer tout type d'informations : numéro de la forme, type de la forme, information métier, ... Si le diagramme est enregistré sous forme d'un fichier "wddiag", les informations précisées à l'aide de la propriété **Note** sont également enregistrées. Il est ainsi possible de les relire et de les traiter lors du parcours des différentes formes d'un diagramme.

Cette astuce est utilisée dans l'exemple de [mise en place d'un diagramme interactif](../WDChamp/1410087174.md). 




### Comment connaître le type d'une forme ? 
<a name="comment_connaitre_type_une_forme_ELTPARAGRAPHE000124"></a>Pour connaître le type d'une forme, il suffit d'affecter la forme aux différentes variables disponibles.  

Exemple : 

```txt
POUR TOUTE forme DE EDIAG_MonDiagramme.Forme
	FormeImage est un diagImage <- forme
	SI FormeImage <> Null ALORS
   		// La forme est une image
	FIN
FIN
```




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Propriétés WLangage associées
<a name="proprietes_wlangage_associees_ELTTEXTE000460"></a>


### Propriétés spécifiques à la gestion d'un champ Editeur de diagrammes
<a name="proprietes_specifiques_gestion_champ_editeur_diagrammes_ELTPARAGRAPHE000214"></a>Les propriétés suivantes sont spécifiques à la gestion des caractéristiques d'un champ Editeur de diagrammes par programmation : 



|   |   |
| --- | --- |
| [EditMode](../Proprietes/1410089005.md) | La propiedad **EditMode** obtiene y establece el modo de edición del control Editor de diagramas: selección o dibujo a mano alzada. |
| [GridlinesVisible](../Proprietes/1000023117.md) | El **GridlinesVisible** Property se utiliza para: <br><br>- Determina si las líneas de la cuadrícula son o no Visible en un control. <br><br>- Mostrar u ocultar las líneas de la cuadrícula en un control.<br><br><br> |
| [Library](../Proprietes/1410088357.md) | La propiedad **Library** permite manipular las diferentes bibliotecas predefinidas asociadas a un control Editor de diagramas. Esta propiedad accede al array de bibliotecas del control Editor de diagramas. |
| [LibraryPanelVisible](../Proprietes/1410088468.md) | La propiedad **LibrayPanelVisible** permite: <br><br>- determinar si el panel "Biblioteca" se muestra en un control Editor de diagramas.  <br><br>- mostrar u ocultar el panel "Biblioteca" en un control Editor de diagramas.<br><br><br> |
| [ModifierPanelVisible](../Proprietes/1410088522.md) | La propiedad **ModifierPanelVisible** permite: <br><br>- determinar si el panel "Modificador" se muestra en un control Editor de diagramas.  <br><br>- mostrar u ocultar el panel "Modificador" en un control Editor de diagramas.<br><br><br> |
| [PageBorderVisible](../Proprietes/1410088623.md) | La propiedad **PageBorderVisible** permite:<br><br>- determinar si los bordes de página se muestran en un control Editor de diagramas.  <br><br>- mostrar u ocultar los bordes de página en un control Editor de diagramas.<br><br><br> |
| [Selection](../Proprietes/1000023033.md) | El **Selección** Property se utiliza para get las características de la selección (o del cursor): <br><br>- en un control Procesador de texto.<br>	Observación: Esta selección se encuentra en la sección que se está editando en la control (cuerpo, cabecera o pie de página). <br><br>- en un control Hoja de cálculo.<br><br>- en un editor HTML control. <br><br>- en un editor de Diagram control.<br><br><br> |





Pour connaître la liste complète des propriétés du WLangage pouvant être utilisées avec un champ de type Editeur de diagrammes, consultez [Propriétés associées au champ Editeur de diagrammes](../WDChamp/1410087170.md).




