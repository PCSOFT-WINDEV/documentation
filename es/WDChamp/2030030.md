


## Cambio de los sitios de AWP al modo de sesión SEO-ready
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000271"></a>
A partir de la versión 27, WEBDEV incluye un modo de sesión con páginas preparadas para SEO. Este modo permite habilitar el SEO para las páginas deseadas mientras se aprovecha el modo de sesión: 

- entre dos llamadas, la sesión permanece en la memoria del servidor, lo que hace que las páginas sean más rápidas

- no es necesario gestionar manualmente las variables de sesión, lo que facilita la programación. 


No es necesario habilitar el SEO para todas las páginas en modo Sesión, lo que mejora la seguridad: el desarrollador decide qué páginas estarán preparadas para el SEO.

El cambio de AWP al modo de sesión SEO-ready no se recomienda para sitios con un gran número de conexiones.

**Reminder: Hasta la versión 27, el modo AWP era la solución preferida para hacer que cualquier página de un sitio WEBDEV estuviera preparada para el SEO.** 
Sin embargo, este modo tiene algunas limitaciones:

- Para cada página, es necesario volver a conectarse a la base de datos, recargar las variables de estado del sitio, etc..: las páginas tardan un poco más en inicializarse, lo que aumenta la carga del servidor de la base de datos.

- Los datos de autentificación del usuario, así como la sesión actual, deben mantenerse en el "contexto AWP" utilizando la función WLanguage DeclareAWPContext. Algunas variables complejas requieren la serialización de datos, lo que hace que los procesos sean aún más lentos.

- Como cada página puede ser dirigida directamente, es difícil secure páginas "privadas" dentro del sitio. Por lo tanto, es necesario comprobar si un usuario está conectado y si tiene acceso a la página.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## ¿Cómo proceder?
<a name="¿como_proceder_ELTTEXTE000295"></a>


### Presentación
<a name="presentacion_ELTPARAGRAPHE000033"></a>

Esta página de ayuda presenta paso a paso un método para convertir un sitio AWP en modo "sesión lista para SEO".

El ejemplo de tienda online "WW_TamesShop" incluido en WEBDEV se utiliza como soporte en esta página.

Los diferentes pasos son los siguientes: 

1. Cambiar el tipo de sitio. 

2. Elegir las páginas que estarán listas para el SEO. 

3. Eliminación del código de gestión del contexto AWP. 

4. Elegir las imágenes que estarán listas para el SEO. 

5. Modificación del código de generación de URLs. 

6. Borrar el código de verificación de la conexión. 



<a name="NOTE2_2"></a>


### 1. Cambiar el tipo de sitio
<a name="1_cambiar_tipo_sitio_ELTPARAGRAPHE000051"></a>

Como el sitio está en modo AWP, el primer paso consiste en cambiar el tipo de sitio a modo Sesión: 

1. Abra la ventana de descripción del proyecto: en la pestaña "Proyecto", en el grupo "Proyecto", haga clic en "Descripción". 

2. En la pestaña "Proyecto" de la ventana del proyecto description, en "Tipo de sitio", seleccione "Sesión". <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Page_session_reference%20-%20HC%20N%B0001.gif&type=thumb)


3. En la pestaña "Avanzado", asegúrese de que la opción "No desconectar a los usuarios de Inactive" esté desmarcada. Esta opción no es compatible con las páginas en modo de sesión SEO-ready.

4. Valide la ventana de descripción del proyecto. 



<a name="NOTE2_3"></a>


### 2. Elegir las páginas que estarán listas para el SEO
<a name="2_elegir_las_paginas_que_estaran_listas_para_seo_ELTPARAGRAPHE000064"></a>

En el sitio en el modo de sesión, debe elegir qué páginas estarán listas para el SEO. No es necesario activar el SEO para cada página de un sitio. Esto también puede denominarse páginas "indexables".: estas páginas se pueden encontrar por su dirección, y si el contexto associated todavía existe, se puede mostrar el contenido. 

Por ejemplo, en "WW_TamesShop": 

- todas las páginas de la tienda deben ser directamente accesibles y estar preparadas para el SEO.

- este no es el caso de las páginas del componente interno "CustomerSectionPage" ya que es una parte privada del sitio. Esta parte del sitio debe ser accesible a los usuarios sólo después de que se conecten.

- las páginas del componente interno "EcommercePage" conforman el embudo de conversión (páginas utilizadas para gestionar el carrito de la compra y el pago). Asimismo, no es necesario que estas páginas estén preparadas para el SEO.




Cada página del sitio debe cambiarse al modo de sesión. Cuando sea necesario, indique qué páginas deben estar preparadas para el SEO. Para cada página: 

1. Abra la ventana de descripción de la página: en la pestaña "Página", en el grupo "description", haga clic en "description". 

2. En la pestaña "General: 

	- Seleccione el tipo de página: "Sesión. 

	- Si la página está preparada para el SEO, marque "SEO-ready". Si es necesario, cambie el nombre que se utilizará en el URI. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Page_session_reference%20-%20HC%20N%B0002.gif&type=thumb)





3. Valide.




Observación: El cambio de las páginas al modo de sesión SEO-ready cambia la extensión del archivo en la URL. Las páginas se convertirán en archivos '.wb'.
<a name="NOTE2_4"></a>


### 3. Eliminación del código de gestión del contexto AWP
<a name="3_eliminacion_del_codigo_gestion_del_contexto_awp_ELTPARAGRAPHE000089"></a>

**En el modo AWP**, las variables que deben mantenerse entre dos llamadas de página se almacenan en el "contexto AWP". 

1. El contexto se inicializa con [ConfigurarAWPContext](../WDLang2/1000017066.md). Por ejemplo: 
	
	```wl
	// Declare an AWP context
	ConfigureAWPContext(ctxDisk, ctxIDCookieURL)
	```


2. Las variables que se almacenan en el contexto AWP se especifican con [DeclareAWPContext](../WDLang2/3058028.md).
	
	```wl
	// Is there a logged-in client? 
	DeclareAWPContext(gnCurrentClient)
	```





**En el modo de sesión SEO-ready**, este mecanismo ya no es necesario.
Por lo tanto, es esencial encontrar las llamadas a [ConfigurarAWPContext](../WDLang2/1000017066.md) y [DeclareAWPContext](../WDLang2/3058028.md) y eliminar el código correspondiente.
<a name="NOTE2_5"></a>


### 4. Elegir y configurar las imágenes que estarán listas para el SEO
<a name="4_elegir_configurar_las_imagenes_que_estaran_listas_para_seo_ELTPARAGRAPHE000119"></a>

También debe especificar qué imágenes deben estar preparadas para el SEO. 

Para que una control Imagen esté preparada para el SEO, es necesario comprobar y/o modificar diferentes puntos: 

1. El control Imagen no debe utilizar ningún modo de compatibilidad. Para comprobar el modo control Imagen: 

	- Abrir la ventana control Imagen description. 

	- En la pestaña "Detalles", vaya a la opción "Modo de compatibilidad" y cámbiela, si es necesario. Esta opción debe ser set a "Ninguna".




2. Si la control Imagen utiliza un modo de visualización específico (estirado, homotético, etc.), el navegador debe calcular la Image para que esté preparada para el SEO. A la inversa, para que una Image no sea SEO-ready, debe ser calculada por el servidor en la sesión actual.

	- Si es necesario, abra la ventana control Imagen description. 

	- En la pestaña "General", marque el modo de visualización Image utilizado. Si es necesario, cambie el modo de transformación de Image para que el Image se transforme en el lado del navegador. 







**Atención**: el modo de cálculo (servidor o navegador) cambia la forma en que la Image debe asignarse en el código.

- **Image calculado en el lado del servidor**: El Image debe ser asignado al control especificando el ruta al archivo Image en el disco. Para get el directorio Image, utilice [fDataDir](../WDLang1/3036001.md) o [fWebDir](../WDLang1/3036052.md).
	**Recordatorio**: en este caso, la Image no estará preparada para el SEO porque la calcula el servidor en la sesión actual.

- **Image calculado en el lado del navegador**: El Image debe ser asignado especificando la URL. Es posible utilizar: 

	- una URL absoluta. Una URL absoluta es una URL que empieza por "http://", "https://" o sólo "://" (para utilizar el mismo protocolo que la página).

	- una URL relativa. En este caso, WEBDEV interpreta la URL como relativa al directorio "_WEB" del proyecto. Por lo tanto, las imágenes deben almacenarse en este directorio (o en un subdirectorio).
			En una aplicación multilingüe, puede tener un subdirectorio Image por idioma. 







**Observación**: en el modo AWP, las imágenes suelen almacenarse en el subdirectorio de cada idioma. En la mayoría de los casos, tendrá que modificar el código o mover las imágenes.
<a name="NOTE2_6"></a>


### 5. Modificación del código de generación de URLs
<a name="5_modificacion_del_codigo_generacion_urls_ELTPARAGRAPHE000157"></a>

**En el modo AWP**, puede utilizar el identificador de contexto AWP para construir una URL mediante programación. Este identificador es devuelto por [Identificar el contexto deAWPC](../WDLang2/1000017144.md).
Este es un ejemplo de código: 

```wl
sLink is string = gsURLPageViewProduct +"?P1="+ nProductID + ...
	"&P2="+nProductVariationID+["&"] + IdentifierAWPContext()
```


**En el modo de sesión listo para SEO**: 

- La función [Identificar el contexto deAWPC](../WDLang2/1000017144.md) ya no sirve para nada.

- El identificador de la sesión actual sigue siendo necesario. Si este identificador no está presente en la URL, se creará una nueva sesión en el servidor. 




En el modo de sesión, el identificador de sesión se divide en dos partes:

- una primera parte almacenada y transferida automáticamente en un Cookie,

- una segunda parte almacenada en la URL, en un parámetro llamado "REFID". Para permanecer en la misma sesión, este parámetro no debe cambiar. 


En este caso, utilice [PáginaDirección](../WDLang2/3058010.md) para construir la URL de una página.
Esta función añade automáticamente el valor actual del parámetro REFID a la URL de la página.

**En nuestro ejemplo de AWP "para convertir "**, es necesario: 

- comprobar si el código contiene URLs de páginas construidas mediante programación. Estos son los casos más comunes:

	- se asigna un valor al [URL](../Proprietes/1000017972.md) Property de ciertos controles (TreeView, Link, etc.).

	- se especifica el código de la control Migas de pan.

	- [ScriptDisplay](../WDLang2/3012017.md) se llama. 


Este código debe ser modificado para utilizar [PáginaDirección](../WDLang2/3058010.md).

- asegurarse de que los enlaces construidos conducen a páginas "aptas para el SEO"..
	Cuando la opción "SEO-ready" no está activada, no se puede acceder a la página a través de un enlace: esto debe hacerse a través de [PageDisplay](../WDLang2/3058008.md).



<a name="NOTE2_7"></a>


### 6. Borrar el código de verificación de la conexión
<a name="6_borrar_codigo_verificacion_conexion_ELTPARAGRAPHE000214"></a>

En el modo AWP, si el sitio tiene una parte que requiere que los usuarios se registren (por ejemplo, el perfil de un cliente), debe asegurarse de que un usuario determinado se ha registrado realmente antes de mostrar cada página de esta parte.
A menudo se utiliza el siguiente código: 

```wl
IF bIsLoggedIn() = False THEN
	ScriptDisplay(gsURLLoginPage)
END
```
  
En el modo de sesión SEO-ready, simplemente indique que estas páginas no están pensadas para el SEO.
Por lo tanto, el código que verifica que un cliente está conectado puede ser eliminado.


