


## Manejo de una control Hoja de cálculo mediante programación (en una ventana)
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000322"></a>
Una control Hoja de cálculo encontrada en una ventana puede ser manejada a través de la programación. 

Para manipular a control Hoja de cálculo mediante programación, WINDEV propone el [Funciones Hoja de cálculo](../WDLang1/1000021433.md). 

Esta ayuda Page explica cómo manipular un control Hoja de cálculo encontrado en una ventana mediante programación. 

**Observación**: El método de entrega de una control Hoja de cálculo que se encuentra en un reporte es diferente. Para obtener más información, consulte [Manejar una control Hoja de cálculo mediante programación (en una reporte)](../WDChamp/1000033010.md). 

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Manejo de la control Hoja de cálculo mediante programación
<a name="manejo_control_hoja_calculo_mediante_programacion_ELTTEXTE000346"></a>
<a name="NOTE2_4"></a>


### Inicialización de una control Hoja de cálculo
<a name="inicializacion_una_control_hoja_calculo_ELTPARAGRAPHE000036"></a>

La control Hoja de cálculo se puede inicializar con valores, fórmulas, ... tan pronto como se muestra de acuerdo a diferentes métodos: 

- Mediante la programación, a través de las siguientes funciones: 


|   |   |
| --- | --- |
| [Hoja de cálculoAñadir Fórmula](../WDLang1/1000021373.md) | Añade una fórmula de cálculo a un control Hoja de cálculo que se encuentra en una ventana. |
| [Hoja de cálculoPermitirProcedimiento](../WDLang1/1000021473.md) | Permite el uso de una función WLanguage/Procedure en una fórmula de una control Hoja de cálculo. |
| [SpreadsheetAddData](../WDLang1/1000021365.md) | Añade un dato a un control Hoja de cálculo que se encuentra en una ventana. |

- Al cargar un archivo de Excel (en formato XLSX) al inicializar el control ([Hoja de cálculoCarga](../WDLang1/1000021340.md)). 

- A través de la entrada directa en el editor de la ventana. Para obtener más información, consulte [Inicialización de control Hoja de cálculo en el editor de ventanas](../WDChamp/1000033008.md). 







### Manejo de la control Hoja de cálculo
<a name="manejo_control_hoja_calculo_ELTPARAGRAPHE000055"></a>

Para manipular un control Hoja de cálculo mediante programación, basta con especificar su nombre. 

Por ejemplo: 


```wl
// Displays the formula bar
PSHEET_Spreadsheet.FormulaBarVisible = True
```

Se pueden utilizar varios [Funciones de WLanguage](../WDLang1/1000021433.md) y [propiedades](../WDChamp/1000033003.md) para manipular el control Hoja de cálculo. 

<a name="NOTE3"></a>


## Manejo de las celdas de una control Hoja de cálculo mediante programación
<a name="manejo_las_celdas_una_control_hoja_calculo_mediante_programacion_ELTTEXTE000399"></a>
<a name="NOTE2_2"></a>


### Manipulación de las células de la control Hoja de cálculo
<a name="manipulacion_las_celulas_control_hoja_calculo_ELTPARAGRAPHE000079"></a>**Para manipular una celda de un control Hoja de cálculo mediante la programación** , utilice las siguientes notaciones: 


```txt
<Spreadsheet control name>[<Row>, <Column>]
```
o 


```txt
<Spreadsheet control name>["<CellName>"]
```


Ejemplos: 


```wl
// Colors the C1 cell in red
PSHEET_Spreadsheet[1,3].BackgroundColor = LightRed

// Colors the B1 cell in green
PSHEET_Spreadsheet["B1"].BackgroundColor = LightGreen
```


**Para asignar un valor a una celda mediante la programación de**, puede utilizar: 

- la función [Hoja de cálculoAddData](../WDLang1/1000021365.md). 
	Ejemplo: Añadiendo un valor en la celda "A2"...: 
	
	```wl
	SpreadsheetAddData(PSHEET_Spreadsheet, 2, 1, 12)
	```


- la asignación directa: 

	- a través de la célula. 
			Ejemplo: Añadiendo un valor en la celda "A2"...: 
			
		```wl
		PSHEET_Spreadsheet["A2"] = 12
		```


	- a través de la columna y fila de la celda. 
			Ejemplo: Añadiendo un valor en la celda "A2"...: 
			
		```wl
		PSHEET_Spreadsheet["A"][2] = 12
		```






Observaciones: 

- Asignando un valor en formato 'YYYYMMDD' a una celda en formato de fecha automáticamente cambia el valor a fecha. 

- Asignar un valor en formato 'HHMM' a una celda en formato de tiempo cambia automáticamente el valor en tiempo. 


**Ejemplo**: Examinar las células de un control Hoja de cálculo: 


```wl
// Browse the cells of a Spreadsheet control
sMyString is string
FOR I = 1 TO PSHEET_MySpreadsheet.NumberRow
	FOR y = 1 TO PSHEET_MySpreadsheet.NumberColumn
		sMyString += PSHEET_MySpreadsheet[i][y] + TAB
	END
	Trace(sMyString + CR)
	sMyString = ""
END
```

<a name="NOTE2_3"></a>


### Consejo: Fusión de celdas mediante programación
<a name="consejo_fusion_celdas_mediante_programacion_ELTPARAGRAPHE000136"></a>

El usuario final puede combinar las celdas seleccionadas usando la cinta (o la barra de herramientas) de la control Hoja de cálculo. 

Para combinar las celdas seleccionadas mediante programación, utilice la función [EjecutarAAF](../WDLang1/3013060.md) con la constante *aafSpreadsheetMerge*: 

```wl
SpreadsheetSelectPlus(PSHEET_MySpreadsheet, "A1", "C5")
ExecuteAAF(PSHEET_MySpreadsheet, aafSpreadsheetMerge)
```
Observación: [Hoja de cálculoGetMerge](../WDLang1/1000021740.md) se utiliza para averiguar si una celda está fusionada con otras y para recuperar el rango de celdas fusionadas. 
<a name="NOTE2_5"></a>


### Gestionar los nombres de las celdas de un control Hoja de cálculo
<a name="gestionar_los_nombres_las_celdas_control_hoja_calculo_ELTPARAGRAPHE000164"></a>La control Hoja de cálculo propone varias funciones para manejar los nombres de las celdas: 



|   |   |
| --- | --- |
| [SpreadsheetAddName](../WDLang1/1000022523.md) | Especifica un nombre para identificar una celda que se encuentra en una control Hoja de cálculo. |
| [SpreadsheetDeleteName](../WDLang1/1000023447.md) | Borra uno de los nombres usados para identificar una celda encontrada en una control Hoja de cálculo. |
| [SpreadsheetListName](../WDLang1/1000023448.md) | Devuelve la lista de nombres que identifican una celda en una control Hoja de cálculo. |
| [SpreadsheetModifyName](../WDLang1/1000023464.md) | Modifica el nombre utilizado para identificar una celda en una control Hoja de cálculo. |




<a name="NOTE2_6"></a>


### Gestionar los comentarios en un control Hoja de cálculo
<a name="gestionar_los_comentarios_control_hoja_calculo_ELTPARAGRAPHE000176"></a>

La control Hoja de cálculo le permite: 

- añadir comentarios,

- mostrar los comentarios existentes en un archivo XLSX. 




Los comentarios pueden ser gestionados: 

- a través de la **comment** avanzada Property. Esta Property se utiliza para conocer y modificar los comentarios associated a una celda mediante las siguientes propiedades: 
	


|   |   |
| --- | --- |
| Rectangle | Variable de tipo [Rectangle](../Motscles/1514079.md). <br><br>Define el rectángulo en el que se muestra la comment. Las propiedades **Anchura** y **Altura** determinan el tamaño del rectángulo (en milímetros), mientras que **X** y **Y** determinan la posición del comment (en milímetros con respecto al inicio de la hoja actual. |
| texto | Texto del comentario. |
| ubicación | Nombre de la célula associated. <br><br>Esta propiedad es de solo lectura. |
| Visible | <br><br>	- <u><u><u><u>True</u></u></u></u> para mostrar el comment, <br><br>	- <u><u><u><u>False</u></u></u></u> para hacer el comment Invisible. En este caso, un triángulo rojo en la esquina superior derecha de la celda permitirá al usuario saber que la celda está asociada a una comment. <br><br><br> |


	Ejemplo: 
	
	```wl
	// Create a comment
	PSHEET_MySpreadsheet["B1"].Comment.Text = "Text of my comment"
	PSHEET_MySpreadsheet["B1"].Comment.Visible = True
	PSHEET_MySpreadsheet["B1"].Comment.Rectangle.Height = 50
	PSHEET_MySpreadsheet["B1"].Comment.Rectangle.Width = 50
	PSHEET_MySpreadsheet["B1"].Comment.Rectangle.X = 50
	PSHEET_MySpreadsheet["B1"].Comment.Rectangle.Y = 50
	```


- a través de diferentes funciones de WLanguage: 
	


|   |   |
| --- | --- |
| [SpreadsheetListComment](../WDLang1/1000024881.md) | Crea una lista de todos los comentarios de la hoja actual de un control Hoja de cálculo. |
| [SpreadsheetSelectComment](../WDLang1/1000024883.md) | Permite: <br><br>	- saber si se seleccionó un comentario en un control Hoja de cálculo, <br><br>	- seleccionar o deseleccionar un comentario en un control Hoja de cálculo.<br><br><br> |




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## control Hoja de cálculo: Manejar un archivo que contenga varias hojas de trabajo a través de la programación
<a name="control_hoja_calculo_manejar_archivo_que_contenga_varias_hojas_trabajo_traves_programacion_ELTTEXTE000490"></a>
Para permitir la gestión de varias hojas de trabajo: 

- En el editor: En la pestaña "Detalles" de la ventana del control description, marque "Permitir varias hojas de trabajo".

- A través de la programación, utilice el [MultiWorksheet](../Proprietes/1000021639.md) Property. 




Una vez que se habilitó la gestión de varias hojas de trabajo: 

- Tiene la posibilidad de cargar las diferentes hojas de trabajo de un archivo XLSX ([Hoja de cálculoCarga](../WDLang1/1000021340.md)). 

- Se utilizan varias funciones para manipular las diferentes hojas de trabajo: 
	


|   |   |
| --- | --- |
| [Hoja de cálculoAñadir Hoja de trabajo](../WDLang1/1000021642.md) | Añade una hoja de trabajo a un control Hoja de cálculo que se encuentra en una ventana. |
| [Hoja de cálculoSeleccionar Hoja de trabajo](../WDLang1/1000021649.md) | Selecciona una hoja de trabajo (identificada por su nombre) en una control Hoja de cálculo. |
| [SpreadsheetDeleteWorksheet](../WDLang1/1000021643.md) | Elimina una hoja de trabajo de un control Hoja de cálculo encontrado en una ventana. |
| [SpreadsheetInsertWorksheet](../WDLang1/1000021648.md) | Inserta una hoja de trabajo en un control Hoja de cálculo que se encuentra en una ventana. |
| [SpreadsheetListWorksheet](../WDLang1/1000023450.md) | Devuelve la lista de hojas de trabajo que se encuentran en una control Hoja de cálculo. |

- Varias propiedades se utilizan para manipular las diferentes hojas de trabajo: 
	


|   |   |
| --- | --- |
| [CurrentWorksheet](../Proprietes/1000021640.md) | El **Hoja de trabajo actual** Property se utiliza para get y cambiar la hoja de trabajo actual en un control Hoja de cálculo. |
| [MultiWorksheet](../Proprietes/1000021639.md) | La propiedad **MultiWorksheet** permite: <br><br>	- Averigua si un control Hoja de cálculo maneja varias hojas de trabajo. <br><br>	- Cambiar el modo de gestión de las hojas de trabajo de un control Hoja de cálculo.<br><br><br> |
| [NbWorksheet](../Proprietes/1000021641.md) | La propiedad **NbWorksheet** permite obtener el número de hojas de trabajo en un control Hoja de cálculo. |
| [WorksheetName](../Proprietes/1000021646.md) | El **Nombre de la hoja de trabajo** Property se utiliza para get o cambiar el nombre de la hoja de trabajo actual en un control Hoja de cálculo. |

- Varias AAF (Características de la Aplicación automatic) permiten al usuario gestionar las diferentes hojas de trabajo. 




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Propiedades específicas de los controles de la hoja de cálculo
<a name="propiedades_especificas_los_controles_hoja_calculo_ELTTEXTE000584"></a>
Las siguientes propiedades se utilizan para gestionar una control Hoja de cálculo a través de la programación.



|   |   |
| --- | --- |
| [CurrentWorksheet](../Proprietes/1000021640.md) | El **Hoja de trabajo actual** Property se utiliza para get y cambiar la hoja de trabajo actual en un control Hoja de cálculo. |
| [FilePath](../Proprietes/1000023104.md) | El **FilePath** Property se utiliza para identificar: <br><br>- el nombre del archivo xlsx associated con un control Hoja de cálculo.<br><br>- el nombre del archivo associated con un editor de imágenes control. <br><br>- el nombre del archivo PDF associated con un lector de PDF control. <br><br>- el nombre del archivo DOCX associated con un control Procesador de texto. <br><br>- el nombre del archivo wddiag asociado a un editor Diagram control. <br><br><br> |
| [FormulaBarVisible](../Proprietes/1000021334.md) | El **FormulaBarVisible** Property se utiliza para: <br><br>- Averigüe si se muestra una barra de fórmulas en un control Hoja de cálculo. <br><br>- Muestra (o no) una barra de fórmulas en un control Hoja de cálculo.<br><br><br> |
| [GridlinesVisible](../Proprietes/1000023117.md) | El **GridlinesVisible** Property se utiliza para: <br><br>- Determina si las líneas de la cuadrícula son o no Visible en un control. <br><br>- Mostrar u ocultar las líneas de la cuadrícula en un control.<br><br><br> |
| [HeaderVisible](../Proprietes/1000021335.md) | La propiedad **HeaderVisible** permite: <br><br>- Determina si el fila y las cabeceras de las columnas se muestran en un control Hoja de cálculo. <br><br>- Mostrar u ocultar el fila y las cabeceras de las columnas en un control Hoja de cálculo.<br><br><br> |
| [InputFormula](../Proprietes/1000021337.md) | La **InputFormula** Property se utiliza para: <br><br>- averigua si el usuario final puede introducir o modificar fórmulas en un control Hoja de cálculo. <br><br>- permiten o impiden que el usuario final introduzca o modifique fórmulas en un control Hoja de cálculo.<br><br><br> |
| [InputValue](../Proprietes/1000021336.md) | El **InputValue** Property se utiliza para: <br><br>- averigua si el usuario final puede introducir o modificar valores en un control Hoja de cálculo. <br><br>- permiten o impiden que el usuario final introduzca o modifique valores en un control Hoja de cálculo.<br><br><br> |
| [MultiWorksheet](../Proprietes/1000021639.md) | La propiedad **MultiWorksheet** permite: <br><br>- Averigua si un control Hoja de cálculo maneja varias hojas de trabajo. <br><br>- Cambiar el modo de gestión de las hojas de trabajo de un control Hoja de cálculo.<br><br><br> |
| [NbWorksheet](../Proprietes/1000021641.md) | La propiedad **NbWorksheet** permite obtener el número de hojas de trabajo en un control Hoja de cálculo. |
| [ToolbarVisible](../Proprietes/1000021333.md) | La propiedad **ToolbarVisible** permite: <br><br>- saber si la barra de herramientas o la cinta se muestra en un control.  <br><br>- mostrar u ocultar la barra de herramientas o la cinta de opciones en un control.<br><br><br> |
| [WorksheetName](../Proprietes/1000021646.md) | El **Nombre de la hoja de trabajo** Property se utiliza para get o cambiar el nombre de la hoja de trabajo actual en un control Hoja de cálculo. |





Para obtener una lista completa de las propiedades de WLanguage que pueden utilizarse con una control Hoja de cálculo y con sus celdas, véase [Propiedades associated con controles de hoja de cálculo](../WDChamp/1000033003.md).




