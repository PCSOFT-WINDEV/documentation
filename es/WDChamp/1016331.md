


## Eventos control Upload
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Eventos predeterminados
<a name="eventos_predeterminados_ELTTEXTE000175"></a>
WEBDEV gestiona los siguientes eventos por Default (en orden de aparición en el editor de código) en el control Upload:

| Event | Condición de ejecución |
| --- | --- |
| Inicialización<br>(Código Servidor) | Se ejecuta al abrir la página. \* |
| Cada vez que se modifica la lista de archivos seleccionados <br>(Código Navegador) | Ejecutar al modificar la lista de archivos a cargar. <br>Para un control Upload de un solo archivo, este Event se ejecuta cuando se selecciona un archivo. <br>En el caso de un control Upload de varios archivos, este Event se ejecuta cuando se añade un archivo a la lista. |
| Progreso de la transferencia <br>(Código Navegador) | Ejecutar al enviar los archivos al servidor. <br>Este Event se llama regularmente durante la carga para actualizar una barra de progreso, si está disponible.<br><br><br><br>Para más detalles, consulte el ejemplo de unidad "Cargar o descargar un archivo" proporcionado con WEBDEV. |
| Recepción de los archivos cargados <br>(Código Servidor) | Ejecutar al recibir los archivos cargados por el servidor. <br>**ATENCIÓN**: Si se utilizan los controles Upload preestablecidos (de un solo archivo o de varios archivos), se debe modificar el código del evento para indicar la ubicación del servidor en la que se copiarán los archivos.<br><br>La Event "Recibir ficheros cargados" se ejecuta en AJAX. Puede utilizar todas las funciones soportadas en el código del servidor AJAX. Estos eventos permiten, una vez finalizada la carga, actualizar la Page sin volver a comunicarse con el servidor. |
| Después de recibir los archivos cargados<br>(Código Navegador) | Ejecutar cuando todos los archivos hayan sido cargados en el servidor.<br><br>Le permite ejecutar un navegador Process cuando la carga se completa, sin comunicarse con el servidor de nuevo. |



(\*) Por defecto, el Event de "Inicialización" de cada control se ejecuta según el orden de creación de los control en el Page. Para cambiar este orden de ejecución: 

1. En la pestaña "Página", en el grupo "Edición", despliegue "Orden de tabulación" y seleccione "Editar".

2. En la ventana que aparece, utilice las flechas de la derecha para cambiar el orden en el que se inicializan los controles.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Event para la recepción de los archivos
<a name="event_para_recepcion_los_archivos_ELTTEXTE000199"></a>
La función Event "Recibir archivos cargados" permite gestionar la ubicación de los archivos cargados en el servidor. Esta Event también se utiliza para gestionar los parámetros pasados por [SubirIniciar](../WDLang2/1000018793.md). 

De hecho, [SubirIniciar](../WDLang2/1000018793.md) se utiliza para iniciar la carga de archivos. Si se llama a [SubirIniciar](../WDLang2/1000018793.md) con parámetros adicionales, estos parámetros se transmiten a la Event "Recibir ficheros cargados" al final de la carga. Para recuperar estos parámetros, se debe declarar un procedimiento en esta Event( a través de la declaración de la Procedure).

Este procedimiento tiene el siguiente formato: 


```txt
PROCEDURE ProcedureName(<Parameter 1> [, ... [, <Parameter N>]])
```


La función "Recibir archivos cargados" de Event también puede utilizarse para cargar las imágenes cargadas en un elemento memo de un archivo HFSQL, a través de [HLinkMemo](../WDLang4/3044173.md).

La Event "Recibir ficheros cargados" se ejecuta en AJAX. Puede utilizar todas las funciones soportadas en el código del servidor AJAX.

Ejemplo de código utilizado en la "Recepción de ficheros cargados" Event: 


```wl
// Insert the code for processing uploaded files
// Code sample:
// Copies the uploaded file into a specific directory
// UploadCopyFile(MySelf, sDestinationDirectory, "")

// Process each file to upload
FOR subscript = 1 TO NbFilesToUpload
	Trace(UploadFileName(UPL_Upload, False, Subscript))
	Trace(UploadFileName(UPL_Upload, True, Subscript))
	UploadCopyFile(UPL_Upload, "c:\temp2", "", Subscript)
END
```


<a name="Example2"></a>


## Ejemplo
<a name="ejemplo_ELTTEXTE000223"></a>
Muestra de código utilizada para cargar las imágenes cargadas desde un control Upload multi-fichero en un elemento de memo.


```wl
// For each uploaded image 
FOR I = 1 _TO_ UPL_UploadControl.Occurrence
	// Add into the database		
	HReset(Photo)
	ScreenToFile()

	// UploadFileName(UPL_UploadControl, True, i):
	// is used to retrieve the path of the nth file uploaded on the server
	// This file is a temporary file created on the server
	// This file is automatically deleted at the end of the event
	// "Receiving the uploaded files"
	HLinkMemo(Photo, Image, UploadFilename(UPL_UploadControl, True, i))

	HAdd(Photo)
END
```





