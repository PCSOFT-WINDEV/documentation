


## Reporte basada en un control Looper
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000389"></a>
Un reporte basado en un control Looper se utiliza para imprimir directamente la información mostrada en el control (basado en el un archivo de datos o poblado programáticamente):

- en una ventana o Page de la aplicación. Esta ventana o Page debe aparecer al imprimir el reporte.

- en una ventana interna o en una Page interna. La ventana (o el Page) que muestra la ventana interna (o el Page interno ) debe aparecer.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ER.png) | Importante | [**Reports & Queries**](../Presentation/3088004.md) no puede utilizarse para crear informes basados en un control Looper. Sin embargo, puede personalizar los informes a partir de una control Looper creada en la editor de reportes estándar (Color, fuentes, tamaño, etc.). |



Una reporte basada en una control Looper puede contener:

- todas las filas que se muestran en el control Looper.

- las filas seleccionadas por el usuario (para los controles Looper de selección múltiple en los que las filas se seleccionan con la tecla Ctrl). Esta opción no está disponible en WEBDEV.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Características de una reporte basada en una control Looper
<a name="caracteristicas_una_reporte_basada_una_control_looper_ELTTEXTE000431"></a>
Si la reporte se basa en un control Looper: 

- Cada fila que se encuentra en el control Looper corresponde a un Record. 

- Cada atributo de la control Looper se corresponde con una control Estático (incluso los atributos que no se corresponden con un valor).




Para un tabla reporte, el orden en que se muestran las columnas en el reporte corresponde por Default al orden de los atributos en la ventana actualmente editada. 

Se puede crear una reporte basada en una control Looper:

- desde el editor de ventanas. El reporte creado corresponde a un tabla reporte.

- de la editor de reportes. Se inicia el asistente de creación de reporte, que permite elegir el tipo de reporte a crear (tabla, formulario, etc.).




Una vez creada la reporte basada en la control Looper, puede:

- cambiar la fuente de datos del reporte (pestaña "Datos" en el reporte description).

- añadir o eliminar los controles estáticos relacionado al control Looper associated con el reporte.




**Atención**: Un reporte basado en un control Looper no puede probarse desde el editor de reportes porque la ventana o el Page que contiene el control Looper deben estar abiertos. Para probar una reporte basada en una control Looper, debes:

- crear (si es necesario) un botón en la ventana o en la Page de control Looper. Este botón permite imprimir la reporte con los datos de la control Looper ([iPrintReport](../WDLang5/3046032.md)). 
	Caso de las ventanas interiores: Si la control Looper se encuentra en una ventana interna, el botón debe crearse en la ventana interna (y no en la ventana del host).

- Ejecutar la prueba de la ventana que contiene la control Looper y luego ejecutar la prueba reporte (mediante el botón)..
	Caso de las ventanas interiores: la prueba debe ejecutarse desde la ventana que alberga la ventana interna.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Creación de una reporte basada en una control Looper desde el editor de ventanas
<a name="creacion_una_reporte_basada_una_control_looper_desde_editor_ventanas_ELTTEXTE000455"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) El editor de ventanas permite crear automáticamente una reporte a partir de los datos de una control Looper y un botón para imprimir la reporte. No hay nada por programar. 

**Observación** : El editor de ventanas sólo puede ser usado para crear un tabla reporte. Para crear otro tipo de reporte, utilice el [editor de reportes](../Editeurs/2029004.md).
<a name="NOTE3_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 

### Creación automática de un reporte y de un botón para imprimir el reporte
<a name="creacion_automatica_reporte_boton_para_imprimir_reporte_ELTPARAGRAPHE000079"></a>

Para crear automáticamente un reporte y un botón utilizado para imprimir el reporte:

1. Abre la ventana que contiene la control Looper en la que se basará la reporte.

2. Seleccione el control Looper.

3. En la pestaña "Creación", en el grupo "Datos", haga clic en "Looper" y seleccione "Reporte basado en un Looper". 

4. El cursor del ratón cambia y la forma del botón aparece debajo del cursor. Haga clic en su ventana para crear y posicionar el botón. Este botón se utiliza para imprimir la reporte basada en una control Looper. 

5. Se crea automáticamente un tabla reporte basado en el control Looper seleccionado en la ventana de diálogo editor de reportes. Para obtener más información, consulte [Características de la reporte creada](#NOTE3_4).

6. Confirme que el reporte creado debe ser añadido al proyecto actual.

7. Grabe la reporte creada y la ventana que contiene el control Looper.



<a name="NOTE3_4"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 

### Características de la reporte basada en una control Looper
<a name="caracteristicas_reporte_basada_una_control_looper_ELTPARAGRAPHE000111"></a>

Por Default:

- la reporte creada es una Tabla reporte. Para obtener más información, consulte [Los diferentes tipos de informes](../WDChamp/1011054.md).

- la reporte creada se llama "Reporte_&lt;CaptionLooperControl&gt;".

- que contiene la reporte creada:

	- un tabla que contiene tantas columnas como el número de atributos encontrados en el control Looper (incluso si estos atributos no muestran ningún valor). 
			Por defecto, el ancho de las columnas de este tabla corresponde al ancho de los controles associated con los atributos.
			Si la tabla no ocupa todo el ancho de reporte, las columnas tabla se amplían proporcionalmente para que la tabla alcance su tamaño máximo.

	- una control Estático que muestra la leyenda de control Looper.

	- cuatro controles predefinidos utilizados para mostrar la fecha de hoy, el número de la Page actual , el número total de Page s en el reporte y el número total de líneas impresas en el reporte.




- el plantilla de reporte creado corresponde al plantilla del proyecto actual.

- la reporte imprime todas las líneas que se encuentran en la control Looper.




Todas estas características pueden ser modificadas en la editor de reportes.

<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Creación de un reporte a partir de un control Looper del editor de reportes
<a name="creacion_reporte_partir_control_looper_del_editor_reportes_ELTTEXTE000491"></a>
El editor de reportes permite crear cualquier tipo de reporte a partir de un control Looper (tabla, formulario, etc.).

Una vez creada la reporte, la impresión debe programarse en WLanguage. Para obtener más información, consulte [Impresión de una reporte basada en una control Looper](#NOTE5_1).
<a name="NOTE4_2"></a>


### Creación de un reporte a partir de un control Looper del editor de reportes
<a name="creacion_reporte_partir_control_looper_del_editor_reportes_ELTPARAGRAPHE000149"></a>

Para crear una reporte a partir de una control Looper del editor de reportes:

1. Haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ico_nouveau.gif) en los botones de acceso rápido. 

	- La ventana de creación de nuevos elementos se abre: haga clic en "Reporte", y luego en "Reporte". }

	- El asistente de creación de reportes se abre.




2. Elija el diseño de su reporte (tabla, formulario, etiqueta,...). Para obtener más información, consulte [Los diferentes tipos de informes](../WDChamp/1011054.md).

3. Seleccione (si es necesario) el reporte modelo a utilizar. Un reporte modelo se utiliza para cumplir con una disposición específica Page. Para más detalles sobre las plantillas reporte, véase [Modelos de reportes](../WDChamp/9000105.md). 

4. Seleccione la fuente de datos del reporte (opción "De un control Tabla o Looper").

5. Seleccione la control Looper en la que se basará la reporte. Sólo aparecerán los controles de Tabla y Looper en las ventanas o páginas del proyecto actual.

6. ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) Para imprimir:

	- todas las filas que se muestran en el control Looper: seleccione "Todas las filas de control".

	- las líneas seleccionadas por el usuario: seleccione "Las filas seleccionadas en la control".
			**Observación**: Esta opción puede modificarse mediante programación con el programa [SelectionOnly](../Proprietes/2511017.md) Property.




7. Para cada atributo de la control Looper mostrada en el reporte:

	- especifique si la columna debe imprimirse o no mediante la marca de verificación. 

	- escriba la leyenda correspondiente. Este título aparecerá en la pantalla:

		- antes de que la control. Por ejemplo:
						<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=etatLibelleFiche.gif)


		- en la cabecera de columna (para los informes de tabla). Por ejemplo:
						<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=etatLibelleTable.gif)

						Esta leyenda puede ser modificada en la editor de reportes.

- seleccione el bloque en el que se imprimirá el control associated con el atributo del control Looper. Las posiciones de los diferentes mandos se pueden modificar en el editor de reportes. Para más detalles sobre los diferentes bloques y su posición en un reporte, véase [Bloques de reporte](../WDChamp/1011040.md).

8. Modifique (si es necesario) el orden de visualización de los controles en la reporte con los botones de flecha que se encuentran a la derecha de tabla.

9. Si la control Looper asociada a la reporte contiene al menos un ítem numérico, se pueden realizar cálculos sobre estos ítems. Especifique el cálculo realizado para cada posición (suma, media,...). Existen dos tipos de cálculos disponibles:

	- **cálculo general**: se creará un control calculado en el bloque *End of Document*.

	- **cálculo en ruptura**: se creará un control calculado en el bloque *Break footer*. En los cálculos en pausa, el resultado del cálculo se reinicia después de cada pausa. Para realizar un cálculo sobre la ruptura, debe encontrarse una ruptura en la reporte actualmente creada.




10. Dependiendo del tipo de reporte creado actualmente, indique las opciones específicas.
	

| Tipo de reporte | Opciones específicas |
| --- | --- |
| Reporte basado en un formulario | Formulario Image, imprimiendo el formulario Image, ...<br>Opciones presentadas en detalle en [Reporte basado en un formulario](../WDChamp/1011067.md) |
| reporte Label | Formato de las etiquetas, número de copias idénticas, ...<br>Opciones presentadas en detalle en [reporte Label](../WDChamp/1011050.md) |



11. Especificar el formato de la hoja en la que se imprimirá el reporte. El reporte se imprime en formato A4 por Default.
	Observación: Por Default, los controles de reporte se muestran en una sola columna. Para crear una reporte multicolumna, simplemente especifique el número de columnas deseado en la pestaña "Formato" de la ventana de reporte description.

12. Selecciona la plantilla de la reporte si es necesario.

13. Escriba el nombre y el título del reporte (nombre del archivo ".WDE" correspondiente al reporte). Este nombre se utilizará para identificar la reporte en sus programas..
	![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) También puede especificar si el reporte puede ser modificado por el usuario final en "Informes y consultas". 

14. Validar la creación de reporte. 

15. La editor de reportes propone automáticamente cambiar el formato reporte si se cumplen las siguientes condiciones:

	- el reporte creado actualmente incluye un tabla.

	- el formato reporte no permite visualizar todas las columnas de tabla.




16. Especificar (si es necesario) el modo para reducir el tamaño de reporte: 

	- Imprimir la reporte en varias páginas. En este caso, el usuario final tendrá que agrupar las páginas. Para obtener más información, consulte [Estampado Multi-Page](../WDChamp/1011065.md).

	- Utilizar el modo horizontal. 

	- Reducir el tamaño de reporte. Atención: según el porcentaje de reducción, la reporte impresa puede volverse ilegible. 




17. La reporte creada actualmente se visualiza en el editor de reportes.




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Impresión de una reporte basada en una control Looper
<a name="impresion_una_reporte_basada_una_control_looper_ELTTEXTE000521"></a>


### Impresión de una reporte basada en una control Looper
<a name="impresion_una_reporte_basada_una_control_looper_ELTPARAGRAPHE000254"></a>

Un reporte basado en un control Looper debe imprimirse desde la ventana que contiene el control Looper cuyos datos se imprimirán. Si el pulsador no se ha creado automáticamente, debe hacerlo usted:

1. Crear un botón en la ventana (o Page) que contiene el control Looper.

2. set el destino de impresión de reporte con [iDestination](../WDLang5/3046074.md) (archivo PDF, HTML, etc.).
	Para obtener más información, consulte [Modos de impresión de un reporte](../WDChamp/1011031.md).

3. Especifique el nombre de la reporte a imprimir con [iPrintReport](../WDLang5/3046032.md).




**Observaciones**:

- Si hay que pasar parámetros adicionales a la reporte, estos parámetros deben especificarse en [iPrintReport](../WDLang5/3046032.md), después del nombre de la reporte a imprimir. Para obtener más información, consulte [Reporte con parámetros](../WDChamp/1011008.md).

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) Si la ventana que contiene la fuente control Looper se abre varias veces (apertura no modal por [OpenChild](../WDLang1/3038021.md)), el nombre completo del control a imprimir debe pasarse como parámetro al reporte. Por ejemplo: 
	
	```wl
	// The FullName property will contain the name of the window 
	// that must be opened with an alias 
	// to distinguish between each window
	iPrintReport(RPT_LOOP_Customer, LOOP_Customer.FullName)
	```

	
	```wl
	// Opening code of the report: 
	PROCEDURE RPT_LOOP_Customer(sNameSourceLOOP)
	MyReport.SourceName = NameSourceLOOP
	```


- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) El [SelectionOnly](../Proprietes/2511017.md) Property se utiliza para get y cambiar los registros que se imprimirán en el reporte: imprimir todos los registros o sólo los registros seleccionados.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ER.png) | Importante | En [Reports & Queries](../Presentation/3088004.md), puede imprimir un reporte:<br><br>- iniciando un trabajo de impresión (![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Ico_Imprimer.gif)). <br><br>- probando el reporte (![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Ico_Go_Fenetre_WD_bl.gif)). <br><br><br>Por lo tanto, no se requiere programación para imprimir la reporte. |




<a name="NOTE5_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 

### Ejemplo de WINDEV
<a name="ejemplo_windev_ELTPARAGRAPHE000319"></a>

La información a imprimir se encuentra en el control Looper llamado "LOOP_Customer" que se encuentra en la ventana "WIN_Customer".

El reporte to print se llama "RPT_LOOPCustomer" y se imprime al pulsar el botón "BTN_Print".

En este ejemplo, el código de clic del botón "BTN_Print" es el siguiente:


```wl
// Open report viewer
iDestination(iViewer)
// Print the report based on the "LOOP_Customer" control 
iPrintReport(RPT_LOOPCustomer)
```

<a name="NOTE5_3"></a>


