


## Manejo programático de los controles del Organizador
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000331"></a>
Una control Agenda puede ser: 

- manipular mediante programación. 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) [vincular a un archivo de datos](../WDChamp/1016325.md). 

- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) [enlazar a una variable](../WDChamp/1016325.md). 




WINDEV y WEBDEV incluyen las funciones [OrganizadorXXX](../WDLang1/1000019021.md) a los controles del organizador manipular. 

Esta ayuda Page explica cómo programar manipular un control Agenda en una ventana o Page. El ejemplo utilizado en la ilustración permite almacenar las citas en una base de datos HFSQL. 







## Manejo programático de los controles del Organizador
<a name="manejo_programatico_los_controles_del_organizador_ELTTEXTE000361"></a>


### Añadir una Appointment
<a name="anadir_una_appointment_ELTPARAGRAPHE000065"></a>

Puede añadir una Appointment a una control Agenda utilizando [OrganizerAddAppointment](../WDLang1/1000018877.md). Esta función acepta dos sintaxis: 

- sintaxis utilizada para especificar las características de la Appointment: título, descripción, etc.
	
	```wl
	// Adds an appointment to the Organizer control
	OrganizerAddAppointment(ORG_MyOrganizer, "Sales meeting", "201003220845", ...
			"201003221230", "Sales")
	```


- sintaxis que manipula una variable de tipo [Appointment](../WDLang1/1000019244.md).
	
	```wl
	// Declares an Appointment variable
	MyAppointment is Appointment
	
	// Fills the appointment
	MyAppointment.Title = "Sales meeting"
	MyAppointment.Content = "Meeting to discuss the weekly objectives."
	MyAppointment.StartDate = "201003220845"
	MyAppointment.EndDate = "201003221230"
	MyAppointment.Category = "Sales"
	MyAppointment.ID = 1
	
	// Adds the appointment into the control
	OrganizerAddAppointment(ORG_Organizer, MyAppointment)
	```



La propiedad **BackgroundColor** de la variable [Appointment](../WDLang1/1000019244.md) se utiliza para definir un color de visualización para un Appointment. Si no se define ningún color de fondo, la control Agenda utilizará automáticamente el color asociado a la categoría Appointment. 


### Rellenar un control Agenda con los datos encontrados en un archivo de datos HFSQL
<a name="rellenar_control_agenda_con_los_datos_encontrados_archivo_datos_hfsql_ELTPARAGRAPHE000100"></a>

Los registros se almacenan en un archivo de datos HFSQL. El control Agenda se puede rellenar inicialmente recorriendo el el archivo de datos mediante la sintaxis FOR EACH y añadiendo cada Appointment mediante [OrganizerAddAppointment](../WDLang1/1000018877.md).

```wl
// Appointment variable
MyAppointment is Appointment

// Browse through the appointments stored in the database
FOR EACH APT 
	// Fills the information of the variable
	MyAppointment.Title = APT.Title
	MyAppointment.Content = APT.Content
	MyAppointment.StartDate = APT.StartDate
	MyAppointment.EndDate = APT.EndDate
	MyAppointment.Category = APT.Category
	MyAppointment.ID = APT.APTID
	
	// Adds the appointment to the Organizer control
	OrganizerAddAppointment(ORG_MyOrganizer, MyAppointment)
	
END
```
**Recordatorio**: También tiene la posibilidad de utilizar un control Agenda relacionado a un archivo de datos. Para obtener más información, consulte [control Agenda relacionado a un archivo de datos](../WDChamp/1016325.md).


### Recuperación de una lista de citas
<a name="recuperacion_una_lista_citas_ELTPARAGRAPHE000124"></a>

La función [OrganizerListAppointment](../WDLang1/1000018880.md) permite obtener: 

- la lista de todos los nombramientos en la control Agenda: 
	
	```wl
	// Array containing a list of Appointment
	arrAppointmentList is array of Appointment
	
	// Lists of appointments
	arrAppointmentList = OrganizerListAppointment(ORG_MyOrganizer)
	```


- la lista de citas incluidas entre dos fechas: 
	
	```wl
	// List of appointments for January 2010
	arrAppointmentList is array of Appointment
	
	// Lists of appointments
	arrAppointmentList = OrganizerListAppointment(ORG_MyOrganizer, "20100101", "20100131")
	```


- el Appointment actualmente seleccionado o suspendido: 
	
	```wl
	// Selected appointment
	arrAppointmentList is array of Appointment
	
	arrAppointmentList = OrganizerListAppointment(ORG_MyOrganizer, orgAptSelected)
	```






### Visualización de un control Agenda a partir de una fecha específica
<a name="visualizacion_control_agenda_partir_una_fecha_especifica_ELTPARAGRAPHE000159"></a>

Para visualizar la control Agenda a partir de una fecha determinada, utilice [OrganizerPosition](../WDLang1/1000018889.md).

```wl
// Position the Organizer control on today's date
OrganizerPosition(ORG_Organizer1, Today())

// Position the Organizer control on December 20, 2012
OrganizerPosition(ORG_Organizer1, "20121220")
```



### Borrar una Appointment
<a name="borrar_una_appointment_ELTPARAGRAPHE000170"></a>

[OrganizerDeleteAppointment](../WDLang1/1000018881.md) permite eliminar: 

- el Appointment seleccionado en el control. 

- una Appointment específica. 
	
	```wl
	// Deletes the first appointment
	OrganizerDeleteAppointment(ORG_MyOrganizer, 1)
	```



[OrganizerDeleteAll](../WDLang1/1000018882.md) borra todas las citas de la control Agenda. 


### Modificando la visualización de la control
<a name="modificando_visualizacion_control_ELTPARAGRAPHE000193"></a>

La visualización actual de una control Agenda se puede modificar mediante las siguientes funciones: 

- [OrganizerDisplayPreviousPeriod](../WDLang1/1000018886.md) y [OrganizerDisplayNextPeriod](../WDLang1/1000018885.md): Estas dos funciones se utilizan para modificar el período de visualización (igual que el botón de giro que se encuentra en la parte superior de control Agenda).. 

- [OrganizerChangeMode](../WDLang1/1000019497.md): Esta función cambia el modo de visualización del control: día, semana, mes.

- [OrganizerTimeDisplayed](../WDLang1/1000018888.md): Esta función se utiliza para definir el período de tiempo visualizado. 






## Uso del menú contextual (AAF)
<a name="uso_del_menu_contextual_aaf_ELTTEXTE000422"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 

### Posibilidades del menú contextual
<a name="posibilidades_del_menu_contextual_ELTPARAGRAPHE000216"></a>

El menú contextual de control Agenda sirve para: 

- cambiar el modo de visualización de control,

- añadir, modificar o borrar un Appointment. 




Para grabar las operaciones realizadas, debe utilizar los eventos de control Agenda. 

En el caso correspondiente, simplemente recupera el Appointment usado actualmente y realiza el Process correspondiente. 

**Ejemplo**: Para almacenar una Appointment añadida por el usuario a través del menú contextual en un fichero de datos APT, basta con escribir lo siguiente en la "Entrada en edición en una Appointment" Event: 


```wl
PROCEDURE Edit(aptEdited is Appointment)

// Store the data
APT.Title = aptEdited.Title
APT.StartDate = aptEdited.StartDate
APT.EndDate = aptEdited.EndDate
...
HAdd(APT)
```
El mismo tipo de código puede ser utilizado para los diferentes eventos de la control Agenda. En efecto, el control Agenda ha declarado automáticamente un procedimiento para cada evento en el control que maneja un Appointment. 

Estos procedimientos toman como parámetro una [Appointment](../WDLang1/1000019244.md) Variable. Esta variable contiene las características de la Appointment utilizada por la Event. 
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) 

### Uso avanzado de eventos con procedimientos
<a name="uso_avanzado_eventos_con_procedimientos_ELTPARAGRAPHE000242"></a>

También puede permitir al usuario definir con más precisión las características de su Appointment durante una adición o una modificación. Para ello, cree una ventana con la información a especificar. 

En el código, basta con abrir la ventana en la "Entrada en edición en un Appointment" Event. Para bloquear la entrada directa mediante el menú contextual de la agenda, el evento debe devolver <u><u><u><u>False</u></u></u></u>. 

Este principio puede aplicarse a todos los eventos llamados por el menú contextual de control Agenda. 

Ejemplo: 


```wl
PROCEDURE Edit(aptEdited is Appointment)

// Opens the window for entering an appointment 
// with the selected appointment (in Creation or Modification mode)
Open(WIN_InputAPT_HFSQL, aptEdited)

// Returns False to lock the direct input in the Organizer control
RESULT False
```




## Gestión de los días festivos
<a name="gestion_los_dias_festivos_ELTTEXTE000452"></a>
Los días festivos pueden ser programados por set. Varias funciones de WLanguage (empezando por BankHolidayXXX) están disponibles.

Para definir los días festivos que aparecen en los controles del Organizador y en los controles de Calendar, debe utilizar [BankHolidayAdd](../WDLang1/1000017304.md). Esta función permite definir la lista de días festivos que se utilizarán. Esta función permite personalizar los días festivos según la Country y la normativa local. Esta función debe utilizarse al principio de la aplicación porque tiene un efecto global sobre la aplicación.

Los días festivos se colorearán de verde en la control Agenda. 

Ejemplo:

```wl
// Delete all public holidays
BankHolidayDeleteAll()
// Initialize the 11 public holidays common to the French regions and territories
BankHolidayAdd("0101")		// 1st of January
BankHolidayAdd(bhEasterMonday)	// Easter Monday
BankHolidayAdd("0501")		// 1st of May
BankHolidayAdd("0508")		// 8th of May
BankHolidayAdd(bhAscensionDay)	// Ascension day
BankHolidayAdd(bhWhitMonday)	// Whit Monday
BankHolidayAdd("0714")		// 14th of July
BankHolidayAdd("0815")		// 15th of August (Assumption)
BankHolidayAdd("1101")		// All Saints' Day
BankHolidayAdd("1111")		// 11th of November
BankHolidayAdd("1225")		// Christmas

// Add 2 additional public holidays for the regions of Moselle and Alsace
BankHolidayAdd("1226" + CR + bhGoodFriday)
```




## Propiedades específicas de los controles del Organizador
<a name="propiedades_especificas_los_controles_del_organizador_ELTTEXTE000478"></a>
Las siguientes propiedades pueden utilizarse para los controles del Organizador manipular.



|   |   |
| --- | --- |
| [DirectInputAPT](../Proprietes/1000019995.md) | La propiedad **DirectInputAPT** se utiliza para determinar y especificar si el usuario puede cambiar directamente el título de un Appointment en un Programador o control Agenda. |
| [GranularityAppointment](../Proprietes/1000019100.md) | El **GranularityAppointment** obtiene y cambia la precisión de la cuadrícula utilizada para definir las citas en los controles del Organizador o del Programador. <br>Property conservada para compatibilidad con versiones anteriores. |
| [GranularityDuration](../Proprietes/1000019643.md) | El **GranularidadDuración** Property se utiliza para get y cambiar el tamaño de la cuadrícula a redimensionar:<br>Citas de \* en un control Agenda. <br>Citas de \* en un control Planificador.<br>Eventos \* en una control Línea de tiempo.<br>Tareas de \* en una columna del diagrama de Gantt. |
| [GranularityMovement](../Proprietes/1000019642.md) | El **GranularidadMovimiento** Property se utiliza para get y cambiar el tamaño de la cuadrícula para moverse:  <br>Citas de \* en un control Agenda. <br>Citas de \* en un control Planificador.<br>Eventos \* en una control Línea de tiempo.<br>Tareas de \* en una columna del diagrama de Gantt. |
| [MaskTitleDate](../Proprietes/1000019463.md) | La **MaskTitleDate** Property se utiliza para identificar y cambiar la máscara de entrada utilizada para las columnas de título del día en los controles del Organizador o del Programador |
| [ModificationDurationAPT](../Proprietes/1000019994.md) | La propiedad **ModificationDurationAPT** se utiliza para determinar y especificar si el usuario puede modificar la duración de un Appointment en un Programador o control Agenda. |
| [MovementAPT](../Proprietes/1000019993.md) | La propiedad **MovementAPT** permite saber y especificar si los usuarios pueden mover citas en un control Planificador o Agenda. |
| [Num1stDayOfTheWeek](../Proprietes/1000019004.md) | **Num1stDayOfTheWeek** se utiliza para averiguar y modificar el 1er día de la semana mostrado en:<br><br>- a control Calendario.<br><br>- un control Agenda.<br><br>- un control Planificador. <br><br>- y control Campo de entrada en formato Date con Calendar.<br><br><br> |
| [PeriodSelection](../Proprietes/1000019996.md) | El **PeriodSelection** Property se utiliza para determinar y especificar si el usuario puede seleccionar un periodo de tiempo en un Programador o control Agenda. |
| [WorkingHourEnd](../Proprietes/1000019056.md) | El **WorkingHourEnd** Property se utiliza para identificar y modificar la hora de finalización de las horas de trabajo utilizadas:<br><br>- por un control Agenda.<br><br>- por un control Planificador.<br><br>- mediante una columna de diagrama de Gantt (en una tabla o control Tabla TreeView).<br><br><br> |
| [WorkingHourStart](../Proprietes/1000018958.md) | El **WorkingHourStart** Property se utiliza para get y cambiar la hora de inicio de las horas de trabajo utilizadas: <br><br>- por un control Agenda.<br><br>- por un control Planificador.<br><br>- mediante una columna de diagrama de Gantt (en una tabla o control Tabla TreeView). <br><br><br> |





Para obtener una lista completa de las propiedades de WLanguage que pueden utilizarse con un control Agenda, consulte [Propiedades associated con controles Organizador](../WDChamp/1016322.md).


