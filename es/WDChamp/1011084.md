
## Diagrama de Gantt reporte
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000246"></a>
El editor de reportes le ofrece la posibilidad de crear informes "Gantt Chart".. Este tipo de reporte se basa en una tabla o control Tabla TreeView que muestra una columna de diagrama de Gantt.. 

Ejemplo: <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Etat_gantt%20-%20HC%20N%B0002.gif&type=thumb)


<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Creación de un diagrama de Gantt reporte
<a name="creacion_diagrama_gantt_reporte_ELTTEXTE000270"></a>


### Crear un reporte
<a name="crear_reporte_ELTPARAGRAPHE000020"></a>

Para crear un "Gantt Chart" reporte: 

1. Haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ico_nouveau.gif) en los botones de acceso rápido.

2. La ventana de creación de nuevos elementos se abre: haga clic en "Reporte", y luego en "Reporte". 

3. El asistente de creación de reportes se abre automáticamente. 

4. Seleccione un "diagrama de Gantt" reporte. Pase a la etapa siguiente. 

5. Selecciona la tabla o control Tabla TreeView que se utilizará para crear el diagrama de Gantt reporte. Especifique si sólo deben imprimirse las líneas seleccionadas en los controles.. Pase a la etapa siguiente. 

6. Especificar los elementos a imprimir (lo que significa las columnas de la Tabla o Treeview control Tabla). Para cada elemento, puede especificar la leyenda del elemento y el bloque en el que debe colocarse el elemento.. Pase a la etapa siguiente. 

7. Si es necesario, indique los cálculos a realizar en las diferentes partidas numéricas de su reporte. Seleccione "Sin cálculo" para continuar sin integrar los cálculos en el reporte. Pase a la etapa siguiente.

8. Especificar el formato de la hoja en la que se imprimirá el reporte. La reporte se imprime en formato A4 por defecto. Pase a la etapa siguiente. 

9. Si es necesario, seleccione la plantilla de la reporte. Pase a la etapa siguiente.

10. Escriba el nombre y el título del reporte (nombre del archivo ".WDE" correspondiente al reporte). Este nombre se utilizará para identificar la reporte en sus programas.. También puede especificar si el reporte puede ser modificado por el usuario final en "Informes y consultas". 

11. Validar la creación de reporte. 

12. Especificar (si es necesario) el modo para reducir el tamaño de reporte: 

	- Imprimir la reporte en varias páginas. En este caso, el usuario final tendrá que agrupar las páginas. Este tipo de impresión se recomienda para un diagrama de Gantt reporte. Para obtener más información, consulte [Impresión de varias páginas](../WDChamp/1011065.md). 

	- Utilizar el modo horizontal. 

	- Reducir el tamaño de reporte. Atención: según el porcentaje de reducción, la reporte impresa puede volverse ilegible. 




13. El reporte creado actualmente se muestra en el editor de reportes. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Etat_gantt%20-%20HC%20N%B0001.gif&type=thumb)








<a name="NOTE2_2"></a>


### Observaciones
<a name="observaciones_ELTPARAGRAPHE000052"></a>

- Los parámetros relativos al estilo de las tareas encontradas en el diagrama de Gantt del reporte se recuperan automáticamente del control (color de fondo, color de progreso,....).. 

- Se crea automáticamente una tabla reporte a partir de la tabla o control Tabla TreeView. La columna del diagrama de Gantt que se encuentra en la ventana se cambia en la editor de reportes en una columna del diagrama de Gantt.  



<a name="NOTE2_3"></a>


### Ejecución del test de un diagrama de Gantt reporte
<a name="ejecucion_del_test_diagrama_gantt_reporte_ELTPARAGRAPHE000060"></a>

El test de un diagrama de Gantt reporte no se puede ejecutar desde el editor de reportes porque se debe abrir la ventana que contiene la tabla o el control Tabla TreeView.. Para ejecutar el test de un diagrama de Gantt reporte, debe:

- crear (si es necesario) un botón en la ventana que contiene el botón control Diagrama de Gantt. Este botón permite imprimir el diagrama de Gantt reporte ([iPrintReport](../WDLang5/3046032.md)). 
	Caso de las ventanas interiores: Si la control Diagrama de Gantt se encuentra en una ventana interna, el botón debe crearse en la ventana interna (y no en la ventana del host).

- Ejecutar la prueba de la ventana que contiene la control Diagrama de Gantt y luego ejecutar la prueba reporte (mediante el botón)..
	Caso de las ventanas interiores: la prueba debe ejecutarse desde la ventana que alberga la ventana interna.




|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ER.png) | Importante | [**Reports & Queries**](../Presentation/3088004.md) no se puede utilizar para crear informes de diagrama de Gantt. Sin embargo, tiene la posibilidad de personalizar los informes del diagrama de Gantt creados en el editor de reportes estándar (color, fuentes, tamaño,....). |





<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## control Diagrama de Gantt en un reporte
<a name="control_diagrama_gantt_reporte_ELTTEXTE000324"></a>
Se crea automáticamente una tabla en un diagrama de Gantt reporte. Esta tabla contiene un control Diagrama de Gantt. 

La ventana de descripción de control Diagrama de Gantt permite configurar las siguientes características: 

- **Visualización de tareas** (pestaña "General"): es posible elegir: 

	- El rango para la selección de tareas (desde la primera hasta la última o en un número específico de días).. 

	- el número de días visualizados.

	- la granularidad de las líneas de grilla.

	- el período de tiempo visible.




- **The custom reporte para visualizar las tareas**. 

	- Si la opción seleccionada es "Ninguno", se utiliza la visualización por defecto. 

	- Si se selecciona "Preset reporte", se añade automáticamente un preset reporte al proyecto.. Esta reporte se denomina por defecto "RPT_WinDevViewGanttTask" y se utiliza automáticamente para mostrar las tareas. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Etat_WinDevvueGantt.gif)
 Esta reporte se puede personalizar, renombrar, ...

	- Si la opción seleccionada corresponde a un reporte del proyecto, este reporte se utilizará para mostrar las tareas.
			Le aconsejamos personalizar el reporte propuesto por defecto. 




- **Máscara para las fechas** (pestaña "General").
	 La máscara es "Automática" por defecto. Es posible utilizar: 

	- una de las máscaras preestablecidas.

	- una máscara personalizada. Por ejemplo, la máscara "MMMM AAAA||" permite que no se muestren los días.  




- **Máscara para los horarios** ("Ficha general").
	 La máscara es "Automática" por defecto. Es posible utilizar: 

	- una de las máscaras preestablecidas.

	- una máscara personalizada. Por ejemplo, puede utilizar la máscara "HH" para ocultar los minutos.  




- **Modo de división del gráfico** (pestaña "UI"): Esta opción le permite configurar cómo se presentará el gráfico cuando se imprima. Puede seleccionar una de las siguientes opciones: 

	- Diagrama de Gantt continuo (por defecto): El diagrama de Gantt se imprimirá de forma continua en varias páginas. Esta opción permite realizar impresiones lineales, sin pausas. 

	- Columnas en cada página:  Las columnas de "descripción" del diagrama de Gantt (Título, duración, etc.) aparecerán en cada página. 




- **Ancla en control** (pestaña "UI"): mediante esta opción, se puede tensar un control reporte y el control Diagrama de Gantt en consecuencia. En efecto, la control Diagrama de Gantt se estira en función de los datos impresos. La opción "Anclaje en control" es útil si se deben imprimir controles o columnas a la derecha del control Diagrama de Gantt: se estirarán como la control Diagrama de Gantt.

- **Estilo** de los diferentes elementos del diagrama de Gantt (pestaña "Estilo"). 




<a name="NOTE5"></a>
<a name="NOTE5_1"></a>


## Impresión de un diagrama de Gantt reporte
<a name="impresion_diagrama_gantt_reporte_ELTTEXTE000348"></a>
Un Diagrama de Gantt reporte (sobre una Tabla o Árbol control Tabla) sólo puede imprimirse desde la ventana que muestra el control. Para esto:

1. Cree un botón en la ventana que contiene el control.

2. Configurar el destino de la impresión reporte con [iDestination](../WDLang5/3046074.md) (visor reporte, impresión en un archivo HTML, etc.).

3. Especifique el nombre de la reporte a imprimir con [iPrintReport](../WDLang5/3046032.md).




**Observaciones**:

- Si hay que pasar parámetros adicionales a la reporte, estos parámetros deben especificarse en [iPrintReport](../WDLang5/3046032.md), después del nombre de la reporte a imprimir. Para obtener más información, consulte [Reporte con parámetros](../WDChamp/1011008.md).

- Si la ventana que contiene el control de origen se abre varias veces (apertura no modal por parte de [OpenChild](../WDLang1/3038021.md)), el nombre completo del control a imprimir debe pasarse como parámetro al reporte. 
	Por ejemplo: 
	
	```wl
	// The FullName property will contain the name of the window
	// that must be opened with an alias to distinguish between each window
	iPrintReport(RPT_Gantt, TVT_Schedule.FullName)
	```

	```wl
	// Opening code of the report: 
	PROCEDURE RPT_Gantt(sNameSourceTVTable)
	MyReport.SourceName = NameSourceTVTable
	```


- La propiedad [SelectionOnly](../Proprietes/2511017.md) se utiliza para obtener y modificar los registros que se imprimirán en la reporte: imprimir todos los registros o sólo los registros seleccionados.

- Si el reporte se basa en un control Tabla TreeView, la propiedad [KeepVisibleHierarchy](../Proprietes/1000021055.md) puede utilizarse para obtener y cambiar el modo de impresión de la estructura del árbol: imprimir toda la jerarquía o imprimir la jerarquía visible en el control.




|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ER.png) | Importante | En [Reports & Queries](../Presentation/3088004.md), puede imprimir un reporte:<br><br>- iniciando un trabajo de impresión ( ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Icone_Imprimer.gif) ). <br><br>- probando el reporte ( ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ICO_GO_Fenetre_WD.gif) ). <br><br><br>Por lo tanto, no se requiere programación para imprimir la reporte. |








### Ejemplo
<a name="ejemplo_ELTPARAGRAPHE000191"></a>

La información a imprimir está en el control Tabla TreeView llamado "TVT_Schedule" que se encuentra en la ventana "WIN_Gantt".

El reporte a imprimir se llama "RPT_Gantt" y se imprime cuando se hace clic en "BTN_Print".

En este ejemplo, el código de clic de "BTN_Print" es el siguiente:


```wl
// Open report viewer
iDestination(iViewer)
// Print the report based on the "TVT_Schedule" TreeView Table control 
iPrintReport(RPT_Gantt)
```



