


## control Hoja de cálculo en una ventana
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Creación de una control Hoja de cálculo en una ventana
<a name="creacion_una_control_hoja_calculo_una_ventana_ELTTEXTE000303"></a>


### Crear control
<a name="crear_control_ELTPARAGRAPHE000011"></a>

Para crear una control Hoja de cálculo: 

1. En la pestaña "Creación", en el grupo "Controles gráficos", despliegue "Ofimática" y seleccione "Hoja de cálculo".

2. Haga clic en la ubicación en la que desea crear el control.




Observación: Las dimensiones del control que se creó se optimizan para ocupar el espacio disponible en la ubicación indicada. Si el tamaño del control no es el indicado, pulse Ctrl+Z: el control volverá al tamaño predeterminado.

Para ver las características del control, seleccione la opción "Descripción en el menú contextual.


### Observaciones
<a name="observaciones_ELTPARAGRAPHE000035"></a>

- Los datos visualizados por un control Hoja de cálculo pueden: 

	- definirse mediante programación.

	- introducirse en el editor de ventanas. 

	- proceder de una variable. Este Variable debe ser un buffer Variable y debe contener la hoja de cálculo de Excel.

	- vienen de un archivo de datos o consulta. En este caso, la partida relacionado a la control puede corresponder a una partida memo que contenga la hoja de cálculo Excel deseada. 




- Un menú específico de AAF es automáticamente associated con el control Hoja de cálculo. Para obtener más información, consulte [Características de la aplicación automatic (AAF) de control Hoja de cálculo](../WDChamp/1000033006.md). 

- Los valores máximos de control Hoja de cálculo son: 

	- 16384 columnas.

	- 1048576 filas.

	- 4096 hojas de trabajo. 







<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Características de control Hoja de cálculo en una ventana
<a name="caracteristicas_control_hoja_calculo_una_ventana_ELTTEXTE000337"></a>
En el editor de ventanas, puede: 

- describir las diferentes características de la control Hoja de cálculo a través de su ventana description.  

- inicializar el control Hoja de cálculo escribiendo los valores encontrados en las diferentes celdas. 



<a name="NOTE2_2"></a>


### Ventana de control Hoja de cálculo description
<a name="ventana_control_hoja_calculo_description_ELTPARAGRAPHE000066"></a>

Las principales opciones de la control Hoja de cálculo se pueden definir en la pestaña "Detalles" de la ventana de control de la description. 

Las opciones son las siguientes: 

- Opciones de entrada: 

	- **Permitir entrada de valores**: El usuario final podrá introducir valores en las celdas de control Hoja de cálculo. Esta opción puede modificarse en el código mediante la propiedad [InputValue](../Proprietes/1000021336.md). 

	- **Permitir entrada de fórmulas**: El usuario final podrá introducir fórmulas en las celdas de control Hoja de cálculo. Esta opción puede modificarse en el código mediante la propiedad [Fórmula de entrada](../Proprietes/1000021337.md). 




- Opciones de visualización: 

	- **Mostrar encabezados de filas y columnas** (3): Los nombres de las celdas se muestran en el control Hoja de cálculo (letras para las columnas, dígitos para las filas).. Esta opción puede modificarse en el código mediante la propiedad [HeaderVisible](../Proprietes/1000021335.md). 

	- **Con barra de fórmulas** (2): Una barra de cálculo se muestra en la parte superior de control. Esta barra se utiliza para escribir fórmulas. Esta opción puede modificarse en el código mediante la propiedad [FormulaBarVisible](../Proprietes/1000021334.md). 

	- **barra de herramientas** (1): Se utiliza para mostrar una barra de herramientas en la parte superior de control. Esta barra de herramientas se usa para formatear las celdas seleccionadas. Tiene la capacidad de visualizar: 

		- Ninguna barra. 

		- Una barra de herramientas (compatibilidad con la versión 22): Muestra el menú en formato de barra de herramientas. Esta opción puede modificarse en el código mediante la propiedad [ToolbarVisible](../Proprietes/1000021333.md). Esta barra de herramientas puede personalizarse (véase [Personalizar la barra de herramientas](#NOTE3_1)). 

		- Una cinta (de Default para un control creado a partir de la versión 23). Esta cinta se puede personalizar (ver [Personalización de la cinta](#NOTE3_3)). 




- Otros parámetros: 

	- **Alto de la fila**: Usó para set la altura de una fila en la hoja de trabajo. El botón "Márgenes" permite definir los márgenes de la celda, si es necesario. 

	- **Permitir varias hojas de trabajo** (4): Esta opción se utiliza para gestionar varias hojas de trabajo en el control Hoja de cálculo. Las pestañas para administrar las hojas de trabajo se muestran en la parte inferior izquierda de control Hoja de cálculo. Un menú emergente permite al usuario administrar las hojas de trabajo. Esta opción puede ser modificada por el [MultiWorksheet](../Proprietes/1000021639.md) Property. 




<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Tableur%20Execution%20-%20HC%20N%B0001.gif)

<a name="NOTE2_3"></a>


### Inicialización de control Hoja de cálculo en el editor de ventanas
<a name="inicializacion_control_hoja_calculo_editor_ventanas_ELTPARAGRAPHE000149"></a>

Para inicializar el control Hoja de cálculo en el editor de ventanas: 

1. Seleccione la control Hoja de cálculo. 

2. Haga dos veces clic en control o abra el menú contextual de control y seleccione "Editar el contenido".. 

3. Un Border amarillo aparece alrededor del control Hoja de cálculo para indicar que el contenido del control está en edición. 

4. Escriba los diferentes valores en las celdas de control. Tiene la posibilidad de escribir valores o fórmulas, de utilizar todas las opciones que se encuentran en la barra de herramientas de formato o en la cinta.

5. Los valores tecleados se guardan automáticamente con la control. 




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Personalización de una control Hoja de cálculo
<a name="personalizacion_una_control_hoja_calculo_ELTTEXTE000373"></a>


### Personalizar la barra de herramientas
<a name="personalizar_barra_herramientas_ELTPARAGRAPHE000164"></a>

Para personalizar la barra de herramientas de control Hoja de cálculo, debe utilizar ventanas internas específicas. 

Para personalizar la barra de herramientas: 

1. En la pestaña "Proyecto", en el grupo "Proyecto", despliegue "Importar" y seleccione "Elementos WINDEV y dependencias". 

2. Seleccione el directorio "Programas\\Datos\\Ventanas predefinidas\\AAF".

3. Seleccione las ventanas: 

	- WinDevAaf_SelBorderPSHEET.wdw: Ventana utilizada para seleccionar las opciones de Border para las celdas encontradas en el control Hoja de cálculo. 

	- WinDevAaf_ColorSel.wdwdw: Ventana utilizada para seleccionar la Color de la fuente. 

	- IW_WinDevAaf_BarPSHEET.wdwdw: Ventana correspondiente a la barra de herramientas. 




4. Validar. 

5. Personalice la ventana "IW_WinDevAaf_BarPSHEET.wdw" según sus necesidades.
	Atención: no deben modificarse los nombres de los controles. 




Si el control Hoja de cálculo utiliza una barra de herramientas (opción "Con barra de herramientas" en la pestaña "Detalles" del control description o [ToolbarVisible](../Proprietes/1000021333.md)), se utilizará la barra de herramientas personalizada. 
<a name="NOTE3_2"></a>


### Personalizar la barra de fórmulas
<a name="personalizar_barra_formulas_ELTPARAGRAPHE000202"></a>

Para personalizar la barra de la fórmula, simplemente recrearla. 

Para crear una barra de fórmulas personalizada: 

1. Crear dos controles: 

	- Un control Estático por ejemplo, usado para ver las coordenadas de la celda seleccionada (o rango de celdas).. 

	- Un control Campo de entrada usado para escribir la fórmula. 




2. Crear dos botones: 

	- Un botón para validar la entrada de la fórmula. 

	- Un botón utilizado para Cancel la entrada de la fórmula. 




3. Mediante programación: 

	- Indique la función de los dos primeros controles (ver las coordenadas o escribir la fórmula) mediante [Hoja de cálculoControlFórmula](../WDLang1/1000021647.md). Por ejemplo: 
			
		```wl
		// -- Initialization code of Spreadsheet control
		// Removes the default formula bar
		PSHEET_MySpreadsheet.FormulaBarVisible = False
		// Defines the control used to view 
		// the coordinates of selected cell in the Spreadsheet control
		SpreadsheetControlFormula(PSHEET_MySpreadsheet, psheetfSelection, STC_Selection)
		// Defines the control used to enter the formulas in the Spreadsheet control
		SpreadsheetControlFormula(PSHEET_MySpreadsheet, psheetfFormula, EDT_Formula)
		```


	- Defina las acciones de estos dos botones con [AAFExecute](../WDLang1/1000022099.md). Por ejemplo:
		```wl
		// -- Click code of button used to validate the formula
		// Use of AAFExecute
		AAFExecute(PSHEET_MySpreadsheet, aafValidateInputFunc)
		```

		```wl
		// -- Click code of button used to cancel the formula
		// Use of AAFExecute
		AAFExecute(PSHEET_MySpreadsheet, aafCancelInputFunc)
		```








**Atención**: Para usar una barra de fórmula personalizada, la barra de fórmula de Default debe estar desactivada: 

- en el editor: "Con barra de entrada de fórmula" en la pestaña "Detalles" del control description. 

- mediante programación: propiedad [FormulaBarVisible](../Proprietes/1000021334.md).



<a name="NOTE3_3"></a>


### Personalización de la cinta
<a name="personalizacion_cinta_ELTPARAGRAPHE000243"></a>

Para personalizar la cinta de control Hoja de cálculo, debe utilizar ventanas internas específicas. 

Para personalizar la cinta: 

1. Vaya a la pestaña "Detalles" en la ventana de control Hoja de cálculo description. 

2. En el área "Barra de herramientas", asegúrese de que la opción "Cinta" está seleccionada.. 

3. En el área "IW source of ribbon", seleccione la ventana preestablecida Default. 

4. La ventana "IW_WinDevAAF_SpreadsheetBar" se incluye automáticamente en su proyecto.. Esta ventana interna (disponible en inglés y francés) puede modificarse según sus necesidades. Esta ventana contiene el código necesario para gestionar el control Hoja de cálculo. Le recomendamos comprobar los errores de UI y asegurarse de que la ventana funciona correctamente después de realizar cualquier cambio. 




Observación: También tiene la posibilidad de utilizar una ventana interna para proponer una cinta específica.. Cualquier ventana interna de su proyecto puede ser utilizada para crear esta barra.




