
## Reporte basada en una consulta SQL con datos a los que se accede a través de una conexión (ODBC, etc.)
			

<DIV class="specObsolete">
	<IMG style="float:left;margin-right:10px;" src="https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=warning_big.png"><B>Advertencia</B><BR>
	A partir de la versión <B>19</B>, este tipo de reporte ya no está disponible en la creación. Los informes existentes siguen funcionando y pueden ser modificados.. 
</DIV><a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000294"></a>
Un reporte basado en una consulta SQL con datos accedidos a través de una conexión puede imprimir registros de una base de datos accesible a través de un controlador ODBC específico o a través de un Conector Nativo. Esta consulta se define al crear la reporte.

**Characteristics of a reporte based on an SQL query via a connection:**

- los ***parámetros de conexión*** (nombre de la conexión, nombre del usuario, ....). Estos parámetros le permiten acceder a los registros que se imprimirán en el reporte.
	Para una conexión ODBC, los parámetros se definen en el administrador de ODBC (en el panel control de Windows).
	Para una conexión a través de la Conector Nativo, los parámetros se definen al configurar la base de datos.

- el ***código SQL de la consulta*** asociada al reporte. Este código debe corresponder a una consulta Select ("SELECT"). Esta consulta se utiliza para especificar los elementos que se imprimirán en la reporte.




**Atención**: El código SQL debe ser reconocido por la base de datos a la que se accede.

La creación de una reporte basada en una consulta SQL a través de una conexión es realizada por la asistente para la creación de reporte. 

Una vez creada la reporte basada en una consulta SQL, se puede:

- modificar el código SQL de la consulta (pestaña "Datos" en el reporte description).

- modificar los parámetros de la conexión (pestaña "Datos" de la reporte description).

- Agregar o eliminar Controles de elementos relacionado a la consulta SQL asociada con reporte.




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Creación de una reporte basada en una consulta SQL con datos a los que se accede a través de una conexión
<a name="creacion_una_reporte_basada_una_consulta_sql_con_datos_los_que_accede_traves_una_conexion_ELTTEXTE000318"></a>
Para crear una reporte basada en una consulta SQL con datos a los que se accede a través de una conexión:

1. Haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ico_nouveau.gif) en los botones de acceso rápido.

	- La ventana de creación de nuevos elementos se abre: haga clic en "Reporte", y luego en "Reporte". 

	- El asistente de creación de reportes se abre.




2. Elija el diseño de su reporte (tabla, formulario, etiqueta,...). Para obtener más información, consulte [Los diferentes tipos de informes](../WDChamp/1011054.md).

3. Seleccione la fuente de datos de la reporte ("De una consulta SQL por conexión").

4. Seleccione el tipo de conexión a utilizar (ODBC o acceso nativo)

5. Especifique los parámetros de conexión:

	- el nombre de la conexión.

	- el nombre de usuario.

	- la contraseña de usuario.

	- el nombre de la base de datos a la que se accede (si hay más de una).




6. Introduzca el código SQL de la consulta associated con el reporte. 
	**Atención**: El código SQL debe ser reconocido por la base de datos a la que se accede.

7. Para agrupar los registros, puede crear rupturas en las posiciones de clasificación. Para crear rupturas, responda "Sí" a la pregunta "¿Desea agregar rupturas al reporte?".
	El paso siguiente se utiliza para seleccionar las posiciones de clasificación correspondientes a las pausas. Para más detalles sobre las pausas, véase [Rompimientos en un reporte](../WDChamp/1011028.md).

8. Para cada elemento de consulta mostrado en el reporte:

	- escriba la leyenda correspondiente. Este título aparecerá en la pantalla:

		- antes de la posición. Por ejemplo:<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=etatLibelleFiche.gif)


		- en la cabecera de columna (para los informes de tabla). Por ejemplo:<br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=etatLibelleTable.gif)
 Esta leyenda puede ser modificada en el editor de reportes.

- seleccionar el bloque donde se imprimirá el control associated con el elemento. Las posiciones de los diferentes mandos se pueden modificar en el editor de reportes. Para más detalles sobre los diferentes bloques y su posición en un reporte, véase [Bloques de reporte](../WDChamp/1011040.md).

9. Modifique (si es necesario) el orden de visualización de los controles en la reporte con los botones de flecha que se encuentran a la derecha de tabla.

10. Dependiendo del tipo de reporte creado actualmente, indique las opciones específicas.
	

| Tipo de reporte | Opciones específicas |
| --- | --- |
| Reporte basado en un formulario | Formulario Image, imprimiendo el formulario Image, ...<br>Opciones presentadas en detalle en [Reporte basado en un formulario](../WDChamp/1011067.md) |
| reporte Label | Formato de las etiquetas, número de copias idénticas, ...<br>Opciones presentadas en detalle en [reporte Label](../WDChamp/1011050.md) |



11. Especificar el formato de la hoja en la que se imprimirá el reporte. El reporte se imprime en formato A4 por Default.

12. Selecciona la plantilla de la reporte si es necesario.

13. Escriba el nombre y el título del reporte (nombre del archivo ".WDE" correspondiente al reporte). Este nombre identificará la reporte en sus programas.

14. Validar la creación de reporte. 

15. La editor de reportes propone automáticamente cambiar el formato reporte si se cumplen las siguientes condiciones:

	- el reporte creado actualmente incluye un tabla.

	- el formato reporte no permite visualizar todas las columnas de tabla.




16. Especificar (si es necesario) el modo para reducir el tamaño de reporte: 

	- Imprimir la reporte en varias páginas. En este caso, el usuario final tendrá que agrupar las páginas. Para obtener más información, consulte [Estampado Multi-Page](../WDChamp/1011065.md).

	- Utilizar el modo horizontal. 

	- Reducir el tamaño de reporte. Atención: según el porcentaje de reducción, la reporte impresa puede volverse ilegible. 




17. La reporte creada actualmente se visualiza en el editor de reportes.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Impresión de una reporte basada en una consulta SQL a través de una conexión
<a name="impresion_una_reporte_basada_una_consulta_sql_traves_una_conexion_ELTTEXTE000342"></a>
Para imprimir una reporte basada en una consulta SQL a través de una conexión, debe:

1. Configura el destino de la impresión de reporte:

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) En WINDEV, con [iPreview](../WDLang5/3046069.md) (vista previa, impresión en un archivo HTML, ...).

	- 
			Para obtener más información, consulte [Modos de impresión de un reporte](../WDChamp/1011031.md).




2. Especifique el nombre de la reporte a imprimir con [iPrintReport](../WDLang5/3046032.md).




**Observaciones**:

- [ODBCPassword](../Proprietes/2511031.md), [ODBCDatabaseName](../Proprietes/2511034.md), [ODBCConnectionName](../Proprietes/2511033.md) y [ODBCUserName](../Proprietes/2511019.md) utilizados en el código reporte permiten conocer y modificar los parámetros de conexión.

- [ODBCSQLCode](../Proprietes/2511028.md) utilizado en el código de reporte permite averiguar y modificar el código SQL de la consulta SQL.


|   |   |   |
| --- | --- | --- |
| ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ER.png) | Importante | En [Reports & Queries](../Presentation/3088004.md), puede imprimir un reporte:<br><br>- iniciando un trabajo de impresión (![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Ico_Imprimer.gif)). <br><br>- probando el reporte (![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Ico_Go_Fenetre_WD_bl.gif)). <br><br><br>Por lo tanto, no se requiere programación para imprimir la reporte. |




<a name="NOTE3_2"></a>
![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png)![Windows](https://doc.pcsoft.fr/ext/images/us/WINDOWS.png) 

### Ejemplo de WINDEV y WEBDEV
<a name="ejemplo_windev_webdev_ELTPARAGRAPHE000205"></a>

El "RPT_Customer" reporte se basa en una consulta SQL realizada en la base de datos Access "Customer".. Se accede a esta base de datos a través del controlador ODBC de Access. Por Default, este reporte se utiliza para imprimir todas las características de los clientes.

El usuario puede:

- haga clic en el botón "BTN_CustomerCharacteristics" para imprimir todas las características del cliente. El código SQL de la consulta no se modificará.

- haga clic en el botón "BTN_CustomerNames" para imprimir el nombre y el apellido de los clientes. Se modificará el código SQL de la consulta.




Para saber si el código SQL de la consulta debe ser modificado o no, se pasa un parámetro a reporte:

- "True": ninguna modificación del código SQL.

- "False": modificación del código SQL.




**En este ejemplo**:

- el código de clic del botón "BTN_CustomerCharacteristics" es el siguiente

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) Código WINDEV:
			
		```wl
		// Open the preview window
		iPreview()
		// Print the report with parameters
		iPrintReport(RPT_Customer, "True")
		```





- el código de clic del botón "BTN_CustomerFNameLNameLName" es el siguiente:

	- ![WINDEV](https://doc.pcsoft.fr/ext/images/us/WD.png) Código WINDEV:
			
		```wl
		// Open the preview window
		iPreview()
		// Print the report with parameters
		iPrintReport(RPT_Customer, "False")
		```





- el código de la Event "Apertura" de la reporte "RPT_Cliente" es el siguiente
	
	```wl
	// Retrieve the parameter passed to the report
	PROCEDURE RPT_Customer(Choice)
	IF Choice = "False" THEN
		// Modify the SQL code
		RPT_Customer..ODBCSQLCode = "Select LastName, FirstName FROM Customer"
	END
	```






