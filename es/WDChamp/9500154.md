
## Entrada obligatoria o no válida en WINDEV
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000238"></a>
WINDEV y WINDEV Mobile incluyen varias opciones para gestionar las entradas obligatorias o no válidas, tanto en el editor de ventanas como mediante programación.

Estas opciones están disponibles para los siguientes controles: 

- Control Campo de entrada, 

- Control Combo Box estándar o con entrada,

- Control Casilla de verificación y Botón de opción,

- Control Valoración. 




Puede indicar la entrada obligatoria: 

- En el texto de ayuda (si el control está vacío),

- Cambiando el estilo de control,

- Con un ícono de entrada obligatoria,

- Con un texto de explicación. 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Características de un control: entrada obligatoria
<a name="caracteristicas_control_entrada_obligatoria_ELTTEXTE000262"></a>
WINDEV y WINDEV Mobile incluyen dos modos de gestión de entrada obligatoria: 

- entrada obligatoria con bloqueo,

- entrada obligatoria sin bloqueo. 





### Entrada obligatoria con bloqueo
<a name="entrada_obligatoria_con_bloqueo_ELTPARAGRAPHE000036"></a>

La entrada obligatoria con bloqueo impide que el usuario salga de los controles requeridos. 

Para configurar la entrada obligatoria con bloqueo en un control: 

1. Abra la ventana de descripción del control. 

2. En la pestaña "Detalles", en "Entrada obligatoria/no válida": <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Saisie_obligatoire_WD%20-%20HC%20N%B0001.gif)


	- Seleccione la opción "Entrada obligatoria".

- Seleccione la opción "Impedir salir del control". 

3. Valide la ventana de descripción del control. 





### Entrada obligatoria sin bloqueo
<a name="entrada_obligatoria_sin_bloqueo_ELTPARAGRAPHE000052"></a>

La entrada obligatoria sin bloqueo permite comprobar al final si algún control requerido ha quedado vacío. Esto evita que el usuario permanezca bloqueado mientras introduce los datos.  

Para configurar la entrada obligatoria sin bloqueo en un control: 

1. Abra la ventana de descripción del control. 

2. En la pestaña "Detalles", en "Entrada obligatoria/no válida": <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Saisie_obligatoire_WD%20-%20HC%20N%B0002.gif)


	- Seleccione la opción "Entrada obligatoria".

- Seleccione "Utilizar InvalidInputDetect". 

3. Valide la ventana de descripción del control. 

4. En el código de validación de la ventana (por ejemplo, en el botón utilizado para agregar datos a una base de datos), utilice la función [InvalidInputDetect](../WDLang1/1000026180.md). Esta función comprueba si se han rellenado todos los controles de entrada obligatoria en la ventana actual. Los controles que no cumplan con los requisitos se resaltarán, según las opciones definidas en "Textos y opciones de visualización".




Observación: En el evento opcional "Autorización para cerrar" también se pueden validar los diferentes elementos de una ventana y llamar a la función [InvalidInputDetect](../WDLang1/1000026180.md). Si este evento devuelve False, la ventana actual no se cerrará.  


### Textos y opciones de visualización: ajustes de la entrada obligatoria
<a name="textos_opciones_visualizacion_ajustes_entrada_obligatoria_ELTPARAGRAPHE000077"></a>

El botón "Textos y opciones de visualización" en la pestaña "Detalles" de la ventana de descripción permite definir cambios en la apariencia del control. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Saisie_obligatoire_WD%20-%20HC%20N%B0003.gif&type=thumb)


Hay dos modos de visualización disponibles: 

- mostrar una indicación: resalta el control de entrada obligatoria si está vacío ANTES de que se ejecute la función [InvalidInputDetect](../WDLang1/1000026180.md). 

- mostrar un error: resalta el control de entrada obligatoria si está vacío DESPUÉS de que se ejecute la función [InvalidInputDetect](../WDLang1/1000026180.md). 




En ambos casos, hay varias opciones disponibles: 

- Modificar estilo del control: Esta opción cambia el estilo del control. El estilo de la indicación y el error se puede establecer en la pestaña "Estilo" del control. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Saisie_obligatoire_WD%20-%20HC%20N%B0005.gif&type=thumb)


- Mostrar ícono de entrada obligatoria: Esta opción muestra un ícono específico en el control. El ícono y su posición en relación con el área de entrada se pueden definir en la pestaña "Estilo" del control ("Entrada obligatoria (texto de ayuda/error): Explicación e ícono", botón "Ícono". <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Saisie_obligatoire_WD%20-%20HC%20N%B0006.gif&type=thumb)
Si se selecciona esta opción, se puede introducir el texto de explicación. Este texto se mostrará al pasar por encima del control y al hacer clic en el ícono. Observación: Si no se especifica el texto de explicación, se mostrará un texto predeterminado. 

- Mostrar texto de explicación: Muestra el texto de explicación debajo del control. Si no se especifica el texto de explicación, se mostrará un texto predeterminado. Atención: Esta opción modifica la interfaz. Si se selecciona esta opción, el texto de ayuda seleccionado se muestra directamente debajo del control en la ventana en modo de edición. Puede que necesite adaptar la interfaz para que el control se muestre en su totalidad. 








<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Características de un control: entrada no válida
<a name="caracteristicas_control_entrada_valida_ELTTEXTE000304"></a>
WINDEV y WINDEV Mobile permiten comprobar si la entrada corresponde a una máscara definida con una variable de tipo [InputMask](../WDLang1/1000024886.md). Si no corresponde, la entrada se considera no válida cuando se llama a la función [InvalidInputDetect](../WDLang1/1000026180.md). 


### Configurar la verificación de la entrada
<a name="configurar_verificacion_entrada_ELTPARAGRAPHE000117"></a>

Para configurar la verificación de la entrada en un control: 

1. Defina una variable de tipo [InputMask](../WDLang1/1000024886.md) que corresponde a la máscara de entrada que se aplicará al control. 
	 Atención: No olvide definir el procedimiento WLanguage llamado por la propiedad **CheckIfValidInput** de la variable [InputMask](../WDLang1/1000024886.md). Este procedimiento se llamará automáticamente cuando se utilice la función [InvalidInputDetect](../WDLang1/1000026180.md) para determinar si el texto introducido es válido. 

2. Defina la máscara de entrada mediante la propiedad [InputMask](../Proprietes/2510033.md) en el código del control.

3. Abra la ventana de descripción del control. 

4. En la pestaña "Detalles", en "Entrada obligatoria/no válida": <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Saisie_obligatoire_WD%20-%20HC%20N%B0007.gif)


	- Seleccione "Utilizar InvalidInputDetect". 

- Configure las opciones para indicar la entrada obligatoria en "Textos y opciones de visualización". 

5. Valide la ventana de descripción del control. 

6. En el código de validación de la ventana (por ejemplo, en el botón utilizado para agregar datos a una base de datos), utilice la función [InvalidInputDetect](../WDLang1/1000026180.md). Esta función perite comprobar si hay entradas no válidas o vacías. 





### Textos y opciones de visualización: ajustes de la entrada no válida
<a name="textos_opciones_visualizacion_ajustes_entrada_valida_ELTPARAGRAPHE000150"></a>

El botón "Textos y opciones de visualización" en la pestaña "Detalles" de la ventana de descripción permite definir cambios en la apariencia del control. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Saisie_obligatoire_WD%20-%20HC%20N%B0004.gif&type=thumb)


Si la entrada no es válida, existen varias opciones: 

- Modificar estilo del control: Modifica el estilo de control. El estilo de los diferentes elementos de la entrada no válida puede definirse en la pestaña "Estilo" del control. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Saisie_obligatoire_WD%20-%20HC%20N%B0005.gif&type=thumb)


- Mostrar ícono de entrada obligatoria: Muestra un ícono específico en el control. El ícono y su posición en relación con el área de entrada se pueden definir en la pestaña "Estilo" del control ("Entrada no válida: Explicación e ícono", botón "Ícono". <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=Saisie_obligatoire_WD%20-%20HC%20N%B0006.gif&type=thumb)
Si se selecciona esta opción, se puede introducir el texto de explicación. Este texto se mostrará al pasar por encima del control y al hacer clic en el ícono. Observación: Si no se especifica el texto de explicación, se mostrará un texto predeterminado. 

- Mostrar texto de explicación: Muestra el texto de explicación debajo del control. Si no se especifica el texto de explicación, se mostrará un texto predeterminado. Atención: Esta opción modifica la interfaz. Si se selecciona esta opción, el texto de ayuda seleccionado se muestra directamente debajo del control en la ventana en modo de edición. Puede que necesite adaptar la interfaz para que el control se muestre en su totalidad. 





### Ejemplo
<a name="ejemplo_ELTPARAGRAPHE000165"></a>

Este ejemplo incluye un control de Campo de entrada (utilizado para introducir un número de teléfono) y un botón de verificación. 

- El evento "Salida" contiene el siguiente código: 
	
	```wl
	MySelf.InputMask = gMaskPhone
	```


- El código de inicialización del proyecto contiene el siguiente código, el cual define la variable de tipo InputMask: 
	
	```wl
	gsMaskPhone is string = "99 99 99 99 99"
	gMaskPhone is InputMask
	
	gMaskPhone.CheckIfValidInput = CheckIfValidInput
	gMaskPhone.ValidateDuringInput = ValidateDuringInput
	gMaskPhone.FormatDuringInput = FormatDuringInput
	gMaskPhone.FormatDuringExit = FormatDuringExit
	gMaskPhone.FormatDuringEntry = FormatDuringEntry
	gMaskPhone.FormatDuringAssignment = FormatDuringAssignment
	
		INTERNAL PROCEDURE CheckIfValidInput(sText is string): boolean
		RETURN MatchRegularExpression(sText , "[0-9 ]*") _AND_ 
				Length(StringFormat(sText, ccIgnoreInsideSpace)) = 10
		END
	
		INTERNAL PROCEDURE FormatDuringInput(LOCAL sTextBefore is string, 
				LOCAL nCursorBefore is int, 
				LOCAL nEndCursorBefore is int, sTextAfter is string, 
					nCursorAfter is int, 
					nEndCursorAfter is int)
		IF Length(sTextBefore) > Length(sTextAfter) THEN RESULT
		//No action if deleting
		// if at the end
		IF nEndCursorAfter = Length(sTextAfter) +1 THEN
			// include " " if needed at this location
			IF Middle(gsMaskPhone, nEndCursorAfter, 1) = " " THEN
				sTextAfter += " "
				nEndCursorAfter ++
				nCursorAfter = nEndCursorAfter
			END
		END
		END
	
		INTERNAL PROCEDURE ValidateDuringInput(sText string): boolean
		RETURN MatchRegularExpression(sText , "[0-9 ]*")
		END
	
		INTERNAL PROCEDURE ValidateDuringExit(sText string): boolean
		RETURN MatchRegularExpression(sText , "[0-9 ]*")
		END
	
		INTERNAL PROCEDURE FormatDuringExit(sText_INOUT is string)
		FormatStringToPhoneNumber(sText_INOUT)
		END
	
		INTERNAL PROCEDURE FormatDuringEntry(sText_INOUT is string)
		FormatStringToPhoneNumber(sText_INOUT)
		END
		INTERNAL PROCEDURE FormatDuringAssignment(sText_INOUT is string)
		FormatStringToPhoneNumber(sText_INOUT)
		END
	
		INTERNAL PROCEDURE FormatStringToPhoneNumber(sText_INOUT is string)
		sOut is string = ""
		sText_INOUT = StringFormat(sText_INOUT, ccIgnoreInsideSpace + ccIgnoreSpace)
		let nText = 1
		FOR n = 1 _TO_ Length(gsMaskPhone)
			IF nText > Length(sText_INOUT) THEN BREAK
			IF gsMaskPhone [n] = " " THEN
				sOut += " "
			ELSE
				sOut += sText_INOUT[nText]
				nText ++
			END
		END
		sText_INOUT = sOut
		END
	```


- El botón de verificación contiene el siguiente código: 
	
	```wl
	InvalidInputDetect()
	```





<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Gestión de la entrada obligatoria y no válida mediante programación
<a name="gestion_entrada_obligatoria_valida_mediante_programacion_ELTTEXTE000346"></a>
WINDEV y WINDEV Mobile incluyen diferentes propiedades y funciones para gestionar la entrada obligatoria y no válida mediante programación: 

- Propiedades disponibles: 
	


|   |   |
| --- | --- |
| [InvalidInputMessage](../Proprietes/1000026245.md) | El **InvalidInputMessage** Property se utiliza para identificar y set el mensaje que se mostrará si el control contiene datos no válidos (máscara de entrada o valor fuera de los límites). |
| [InvalidInputPreventExit](../Proprietes/1000026175.md) | El **InvalidInputPreventExit** Property se utiliza para determinar si es posible salir del control en caso de entrada no válida. |
| [MandatoryInput](../Proprietes/1000026174.md) | El **MandatoryInput** Property se utiliza para determinar si se requiere un control y para activar o desactivar la entrada de datos requerida. |
| [MandatoryInputMessage](../Proprietes/1000026176.md) | El **MandatoryInputMessage** Property se utiliza para identificar y establecer el mensaje que se mostrará si el control se deja vacío (cuando el [MandatoryInput](../Proprietes/1000026174.md) Property está activado). |

- Funciones disponibles: 
	


|   |   |
| --- | --- |
| [InvalidInputDetect](../WDLang1/1000026180.md) | Detecta y señala un error en los controles requeridos que quedan vacíos y/o en los controles con datos no válidos. |
| [InvalidInputListControl](../WDLang1/1000026244.md) | Construye una lista de controles que requieren entrada de datos/contienen datos no válidos. |
| [InvalidInputShowMessage](../WDLang1/1000026247.md) | Muestra un error de entrada no válido para la control especificada. |





