
## ¿Cómo gestionar una selección múltiple en un control List Box?
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000131"></a>
Un **List Box** control se utiliza para seleccionar y recuperar un solo elemento entre los elementos disponibles. La lista está en selección única. 

Sin embargo, puede configurar el control List Box para que se convierta en multiselección. En este caso, el usuario tendrá la posibilidad de seleccionar varios elementos y recuperar los elementos seleccionados mediante programación.

La opción "Selección múltiple" del control List Box está disponible en la pestaña "UI" de la ventana de descripción del control.

El usuario puede realizar una selección múltiple mediante las teclas estándar Shift y Ctrl, las flechas y/o el ratón.

Se pueden utilizar dos métodos para recuperar los elementos seleccionados: 

- [Navegar por los elementos seleccionados con ListSelect](#NOTE2_1). 

- [Navegar por los elementos seleccionados a través de la sentencia FOR EACH](#NOTE3_1).




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Método 1: Utilización de la función ListSelect
<a name="metodo_1_utilizacion_funcion_listselect_ELTTEXTE000155"></a>
Este método consiste en realizar un bucle de navegación con [ListSelect](../WDLang1/3049011.md). 

Una Variable que represente el rango del elemento seleccionado se incrementará desde el valor 1. 

- Si [ListSelect](../WDLang1/3049011.md) devuelve -1: no hay ningún otro elemento seleccionado.

- Si [ListSelect](../WDLang1/3049011.md) devuelve un valor superior a 0: este valor representa la posición del elemento seleccionado en la control List Box.




Para recuperar el valor del elemento seleccionado, utilice la siguiente sintaxis: 


```txt
NameListBoxControl[Subscript]
```


Nota: Para conocer el número de elementos seleccionados, utilice [ListSelectCount](../WDLang1/3049010.md). Esto permite realizar un bucle con una sentencia [FOR](../Motscles/1510001.md) en lugar de una sentencia [WHILE](../Motscles/1510010.md).


### Ejemplo
<a name="ejemplo_ELTPARAGRAPHE000067"></a>


```wl
Rank is int
ElementPosition is int
ElementValue is string

Rank = 1
ElementPosition = ListSelect(ListName, Rank)
WHILE ElementPosition<>-1
	ElementValue = ListName[ElementPosition]
	Rank++
	ElementPosition = ListSelect(ListName, Rank)
END
```


<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Método 2: Uso de la sentencia FOR EACH
<a name="metodo_2_uso_sentencia_for_each_ELTTEXTE000185"></a>
Este método se utiliza para recorrer la lista de elementos seleccionados con una declaración [FOR EACH](../Motscles/1510017.md) específica. 


### Ejemplo
<a name="ejemplo_ELTPARAGRAPHE000082"></a>


```wl
ElementValue is string
FOR EACH SELECTED ROW OF ListName
	ElementValue = ListName..DisplayedValue
END
```



