
## ¿Cómo elegir la fuente de datos de un control?
			



<a name="NOTE0"></a>
<a name="NOTE0_1"></a>
Una fuente de datos permite rellenar fácilmente un control con poca o ninguna programación.
Existen diferentes tipos de fuentes de datos: 

- Fuente de datos de tipo [Archivo de datos](#NOTE1_1).

- Fuente de datos de tipo [Consulta](#NOTE2_1).

- Fuente de datos de tipo [Array](#NOTE3_1).

- [Ninguna fuente de datos](#NOTE4_1): en este caso, el control se rellena mediante programación.







<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Fuente de datos de tipo Archivo de datos
<a name="fuente_datos_tipo_archivo_datos_ELTTEXTE000194"></a>
Si la fuente de datos de un control es un archivo de datos, el control se relaciona con ese archivo de datos en el análisis.

Por ejemplo, las columnas de un control Tabla, List Box o Combo Box o los atributos de un control Looper se enlazan a los campos del archivo de datos.

**Este método de relleno no requiere ningún código**: el archivo de datos se recorre automáticamente en la dirección de la clave de búsqueda seleccionada.

**Existen dos tipos de acceso**: 

- Acceso directo a la fuente de datos: sin límite para el volumen de datos (número de registros). Los registros se muestran por página. Solo se leen los registros que corresponden a las filas que se muestran en los controles.

- Fuente de datos en memoria: se debe especificar el número máximo de filas para limitar el uso de la memoria. El tiempo de carga en la memoria puede ser bastante largo si se superan las 100 000 filas.




**Características específicas de los controles Tabla**:

- Solo se pueden ordenar y filtrar las columnas enlazadas a campos clave en el archivo de datos,

- No se requiere programación.




Para obtener más información, consulte: 

- [Control Tabla basado en un archivo de datos](../WDChamp/1013177.md)

- [Control Looper basado en un archivo de datos](../WDChamp/1013085.md)




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Fuente de datos de tipo Consulta
<a name="fuente_datos_tipo_consulta_ELTTEXTE000218"></a>
Se pueden utilizar dos métodos para definir una consulta como fuente de datos:

- Definir la consulta en el editor de consultas y asociarla al control (como con un archivo de datos),

- Utilizar una consulta incrustada: la consulta se crea al crear el control. En este caso, la consulta no se puede utilizar en otro control.




Las columnas de un control Tabla, List Box o Combo Box o los atributos de un control Looper se enlazan a los campos de la consulta.

Este método de relleno no requiere ningún código. La consulta se recorre automáticamente. Se recomienda conservar el orden en modo automático ya que los datos ya están ordenados en la consulta (más rápido). Puede elegir un criterio de orden diferente: en este caso, el proceso más largo será la carga de la consulta. 

Para una consulta con parámetros, se debe utilizar el código de inicialización del control para inicializar los valores de los diferentes parámetros.

Modo de relleno: 

- **Si elige un acceso directo a la fuente de datos**, no hay límite en cuanto al volumen de datos que se pueden cargar (número de registros). Los registros se muestran por página. Solo se leen los registros que corresponden a las filas que se muestran en los controles.




- **Si elige la fuente de datos en memoria**, debe especificar el número máximo de filas para limitar el uso de la memoria. El tiempo de carga en la memoria puede ser bastante largo si se superan las 100 000 filas. En este caso, se recomienda definir condiciones de selección en la consulta para evitar tiempos de carga demasiado largos.




Información útil sobre el control Tabla:

- Todas las columnas se pueden ordenar y filtrar.

- No se requiere programación.




<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Fuente de datos de tipo Array
<a name="fuente_datos_tipo_array_ELTTEXTE000242"></a>
Un Array define una variable de tipo Array. El Array puede ser:

- simple: cadena, fecha, numérico, etc. 

- basado en una estructura. En este caso, la estructura es similar a la de un registro de un archivo de datos.
	El Array debe rellenarse previamente mediante programación.
	Los datos pueden venir de:

	- un archivo de datos, 

	- varios archivos de datos,

	- una consulta.





La variable Array debe ser global al proyecto, a la ventana o a la página para poder asociarse al control.

Al igual que en el caso de un archivo de datos o consulta, las columnas de un control Tabla, List Box o Combo Box o los atributos de un control Looper se enlazan a los miembros de la estructura del Array.
Este método de relleno no requiere ningún código. El Array se recorre automáticamente del primer al último elemento (dependiendo de cómo está ordenado). 

Información útil sobre el control Tabla:

- Todas las columnas se pueden ordenar y filtrar.

- Poca programación.




<a name="NOTE4"></a>
<a name="NOTE4_1"></a>


## Ninguna fuente de datos

<a name="ninguna_fuente_datos_ELTTEXTE000266"></a>
En este modo, el control no está enlazado a una fuente de datos. El método de relleno debe programarse recorriendo el archivo de datos, consulta o variable de tipo Array con diferentes funciones WLanguage:

- HRead, ... FOR EACH ...   para archivos de datos o consultas,

- FOR ... , FOR EACH ELEMENT OF... para Arrays.




Debe llamar a las funciones WLanguage que permiten escribir en el control correspondiente: 

- Control Tabla: TableAdd, TableAddLine...

- Control List Box: ListAdd...

- Control Combo Box: ListAdd...

- Control Looper: LooperAdd, LooperAddLine, ... 




Este método de relleno permite que los desarrolladores definan todo mediante programación. Por lo tanto, es necesario estar familiarizado con las diferentes funciones WLanguage de gestión de archivos de datos, consultas, arrays y estructuras.


