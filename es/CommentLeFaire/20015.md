
## ¿Cómo leer los correos electrónicos a través del protocolo IMAP?
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Principio
<a name="principio_ELTTEXTE000106"></a>
Para leer correos electrónicos a través del protocolo IMAP sin utilizar un software de mensajería: 

1. Recuperar los parámetros para conectarse a su servidor de mensajería. Estos parámetros son suministrados por su proveedor de servicio INTERNET o por su administrador de red. 

2. Declarar una [emailIMAPSession](../WDLang3/1000018957.md) Variable e inicializarla con los parámetros recuperados previamente. 

3. Conectar con el servidor de mensajería con [EmailStartIMAPSession](../WDLang3/1000019189.md). 

4. Realiza un bucle para leer los correos electrónicos desde el principio hasta el final utilizando [EmailReadFirst](../WDLang3/3032014.md) y [EmailReadNext](../WDLang3/3032004.md). El valor de la variable **Email.Out** es: 

	- <u><u><u><u>True</u></u></u></u> si no hay más mensajes por leer.

	- <u><u><u><u>False</u></u></u></u> en caso contrario. 




5. Utilizar una [Email](../WDLang3/1000018713.md) Variable para recuperar el contenido de Email que fue leído. 

6. Cerrar la sesión IMAP mediante [EmailCloseSession](../WDLang3/3032006.md). 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Ejemplos
<a name="ejemplos_ELTTEXTE000130"></a>


### Navegación de correos electrónicos a través de un bucle FOR EACH
<a name="navegacion_correos_electronicos_traves_bucle_for_each_ELTPARAGRAPHE000051"></a>


```wl
MyMessage is Email
MyIMAPSession is emailIMAPSession

// Start a simple IMAP session
MyIMAPSession.ServerAddress = "imap.mycompany.us"
MyIMAPSession.Name = "user"
MyIMAPSession.Password = "secret"

// Start the IMAP session
IF NOT EmailStartSession(MyIMAPSession) THEN
	// Error starting the IMAP session
	Error("Unable to start the IMAP session.", ErrorInfo()
ELSE
	// Read the messages
	FOR EACH MyMessage NOT READ OF MyIMAPSession
		// Process the message read
		Trace(MyMessage.Subject, MyMessage.Sender, MyMessage.Message)
	END
	// Disconnect from the session
	EmailCloseSession(MyIMAPSession)
END
```





### Navegación de correos electrónicos a través de un bucle WHILE
<a name="navegacion_correos_electronicos_traves_bucle_while_ELTPARAGRAPHE000057"></a>


```wl
MyMessage is Email
MyIMAPSession is emailIMAPSession

// Start a simple IMAP session
MyIMAPSession.ServerAddress = "imap.mycompany.us"
MyIMAPSession.Name = "user"
MyIMAPSession.Password = "secret"

// Start the IMAP session
IF NOT EmailStartSession(MyIMAPSession) THEN
	// Error starting the IMAP session
	Error("Unable to start the IMAP session.", ErrorInfo()
ELSE
	
	// Read the messages
	EmailReadFirst(MyIMAPSession, MyMessage)
	WHILE NOT Email.Out
		// Process the message read
		Trace(MyMessage.Subject, MyMessage.Sender, MyMessage.Message)
		// Read the next message
		EmailReadNext(MyIMAPSession, MyMessage)
	END
	// Disconnect from the session
	EmailCloseSession(MyIMAPSession)
END
```



