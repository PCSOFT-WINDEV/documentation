
## ¿Cómo ordenar el resultado de una consulta?
			

<a name="NOTE1"></a>
<a name="NOTE1_1"></a>
Para ordenar (o clasificar) los registros procedentes de un archivo de datos, tienes la posibilidad de realizar un bucle de navegación en el archivo utilizando un elemento clave. En este caso, la clasificación se realizará sólo en los puntos clave. 

El mejor método para realizar este tipo (o clasificación) consiste en utilizar una consulta SQL.

Veamos cómo realizar una ordenación utilizando: 

- [Método 1: una consulta SQL creada con el editor de consultas](#NOTE2_1).

- [Método 2: una consulta creada mediante programación](#NOTE3_1). 




<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## Consulta SQL con una ordenación realizada en el editor de consultas
<a name="consulta_sql_con_una_ordenacion_realizada_editor_consultas_ELTTEXTE000158"></a>
La consulta se utiliza para ordenar (clasificar) los registros encontrados en un archivo de datos según un elemento. 

En este ejemplo, vamos a crear una consulta SQL para ordenar los registros encontrados en el archivo CUSTOMER según el nombre del cliente.

Los diferentes pasos para crear esta consulta SQL con ordenación son los siguientes: 

1. Haga clic en ![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=ico_nouveau.gif) en los botones de acceso rápido. 

	- En la ventana que se muestra, haga clic en "Consultas". 

	- El asistente de creación de consultas se abre.




2. Seleccione crear una consulta de selección (opción "Selección (SELECT)"). <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=CLF_Requ%EAte_tri-%20HC%20N%B0001.gif&type=thumb)

	Pase a la etapa siguiente del asistente.

3. La ventana de descripción de la consulta se abre.

4. Dar un nombre y una leyenda a la consulta: <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=CLF_Requ%EAte_Tri%20-%20HC%20N%B0002.gif&type=thumb)


5. En la sección izquierda de la ventana de description, elija los elementos de archivo que se utilizarán. En nuestro ejemplo, vamos a seleccionar los ítems CustomerName, Company, ZipCode y City del archivo CUSTOMER. 

6. Haga doble clic en los nombres de los elementos para añadirlos a la lista de elementos de consulta: <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=CLF_Requ%EAte_Tri%20-%20HC%20N%B0003.gif)


7. Para realizar una clasificación, seleccione la posición que desea clasificar en la sección central. En nuestro ejemplo, este ítem corresponde a "CustomerName".. 

8. En la sección derecha del editor, haga clic en el botón "Ordenar. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=CLF_Requ%EAte_Tri%20-%20HC%20N%B0004.gif)


9. Seleccione "Ordenar por el elemento seleccionado" en el menú que aparece. La siguiente ventana se abre: <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=CLF_Requ%EAte_Tri%20-%20HC%20N%B0005.gif)


10. Seleccione el orden de clasificación (ascendente en nuestro ejemplo).

11. Validar. La ventana de consulta description se actualiza: se visualiza una flecha con el número de clasificación. <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=CLF_Requ%EAte_Tri%20-%20HC%20N%B0006.gif)


12. Valide la ventana de descripción de la consulta. La consulta se muestra en el editor: <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=CLF_Requ%EAte_Tri%20-%20HC%20N%B0007.gif)


13. Guardar la consulta (Ctrl + S). 

14. Presione F2 para ver el código SQL: <br>![](https://doc.pcsoft.fr/en-US/images/image.awp?langid=7&name=CLF_Requ%EAte_Tri%20-%20HC%20N%B0008.gif)


15. Ejecutar la prueba de consulta (GO en los botones de acceso rápido). 

16. La consulta se puede ejecutar en el programa por [HExecuteQuery](../WDLang4/3044080.md).








<a name="NOTE3"></a>
<a name="NOTE3_1"></a>


## Consultas SQL con programación de ordenación
<a name="consultas_sql_con_programacion_ordenacion_ELTTEXTE000182"></a>
Las consultas SQL pueden escribirse directamente mediante programación en el código WLanguage. Para ello, es necesario: 

1. Crear una Variable de tipo [Fuente de datos](../WDLang4/1514053.md) para representar la consulta en tiempo de ejecución. 

2. Crear una cadena de caracteres Variable para contener el código SQL de la consulta y escribir el código SQL en este Variable. 

3. Ejecute la consulta SQL con [HExecuteSQLQuery](../WDLang4/3044084.md).

4. Explore el resultado con las funciones HReadXXX.




**Ejemplo de código**: 


```wl
Src1 is Data Source
sSQLCode is string

// List of orders sorted by descending Date and Time ...
sSQLCode = [
SELECT ORDERS.OrderNum,	
	ORDER.ORDDATE,	
	ORDER.ORDTime
FROM ORDERS
ORDER BY ORDDATE DESC, ORDTime DESC
]

HExecuteSQLQuery(Src1, hQueryDefault, sSQLCode)
FOR EACH Src1
	TRACE(Src1.OrderNum, Src1.ORDDATE, Src1.ORDTime)

END
```



