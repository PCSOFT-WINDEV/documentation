
## Conector Nativo Sybase: Ejecutar el mismo Procedure almacenado varias veces
			



<a name="NOTE1"></a>
<a name="NOTE1_1"></a>


## Presentación
<a name="presentacion_ELTTEXTE000138"></a>
En algunos casos, puede ser interesante ejecutar el mismo Procedure almacenado varias veces mientras se modifican uno o más parámetros.

Se pueden implementar varias soluciones:

1. Ejecute la consulta (con [HExecuteSQLQuery](../WDLang4/3044084.md)) tantas veces como sea necesario mientras modifica los parámetros deseados.

2. Preparar la consulta a ejecutar ([HPrepareSQLQuery](../WDLang4/3044119.md)) así como los diferentes parámetros para modificar y ejecutar la consulta tantas veces como sea necesario con [HExecuteSQLQuery](../WDLang4/3044084.md).. Esta segunda solución es mucho más rápida y optimiza el tiempo necesario para navegar por el resultado de la consulta (para una consulta Select).




**Esta página de ayuda explica cómo se puede implementar esta segunda solución.**

<a name="NOTE2"></a>
<a name="NOTE2_1"></a>


## ¿Cómo proceder?
<a name="¿como_proceder_ELTTEXTE000162"></a>


### Etapas
<a name="etapas_ELTPARAGRAPHE000034"></a>

Para preparar y ejecutar una consulta varias veces:

1. Declarar una fuente de datos. Esta fuente de datos contendrá el resultado de la consulta SQL.

2. Declarar los tipos de variables de consulta.
	Las variables se recuperan en el tipo especificado en WLanguage. Las variables son variables de texto de Default.
	Por lo tanto, pueden ocurrir conversiones entre el tipo nativo de la base de datos y el tipo WLanguage, causando errores inesperados de redondeo o formato (la fecha se transforma en cadena, por ejemplo)..
	Por lo tanto, le aconsejamos que especifique los tipos de WLanguage de las variables con mucho cuidado antes de ejecutar la consulta. Para esto:

	- inicializar el valor de la Variable (tipos simples: entero, string, float). 

	- especificar el tipo esperado con [escribir a máquina](../Proprietes/2510131.md) (no soportado en esta versión). 
			
			El nombre de estas variables debe corresponder al nombre de los parámetros de esta Procedure en Sybase.
			**Observación**: En algunos casos, el servidor no acepta realizar una conversión implícita. Se visualiza un error de conversión. En este caso, debe inicializar el tipo definiendo cualquier valor ordinario en el tipo seleccionado..
			Por ejemplo, para definir un tipo numérico, utilice MyQuery.Parameter=0.




3. Prepare la consulta con [HPrepareSQLQuery](../WDLang4/3044119.md).

4. Especifique el valor de los diferentes parámetros a tener en cuenta y ejecute la consulta con [HExecuteSQLQuery](../WDLang4/3044084.md). Sólo se debe especificar el nombre de la fuente de datos que corresponde a la consulta.


Este último paso debe repetirse tantas veces como sea necesario.
<a name="NOTE2_2"></a>


### Observaciones
<a name="observaciones_ELTPARAGRAPHE000073"></a>

- [HPrepareSQLQuery](../WDLang4/3044119.md) debe utilizarse con:

	- el nombre de la conexión,

	- la constante **hQueryWithoutCorrection**




- Las variables declaradas deben ser idénticas a las utilizadas. De lo contrario, se produce un error WLanguage.

- En la llamada a la Procedure almacenada, se debe utilizar la sintaxis específica de la base de datos utilizada, incluso para la sintaxis de los parámetros. Para Sybase, los parámetros se especifican con la siguiente sintaxis: **@NombreParam**.
	Atención: el carácter "@" debe ir seguido de al menos una letra (la sintaxis @1 no está permitida). 
	El mismo parámetro se puede utilizar varias veces. En este caso, la Variable correspondiente será reutilizada.

- El valor de retorno del Procedure almacenado se devuelve en un Variable definido automáticamente por el Native Sybase Connector. Este Variable se llama RETURN_VALUE.

- Para ejecutar una consulta sin habilitar el enlace, utilice la constante ***hNoBind*** en [HExecuteSQLQuery](../WDLang4/3044084.md).  





